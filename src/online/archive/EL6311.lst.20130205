* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63******************************************************************
    64
    65 ENVIRONMENT DIVISION.
    66
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   3
* EL6311.cbl
    68 DATA DIVISION.
    69 WORKING-STORAGE SECTION.
    70 01  DFH-START PIC X(04).
    71 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    72 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    73 77  FILLER  PIC X(32)  VALUE '********************************'.
    74 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    75 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    76 77  A1                          PIC S999 COMP-3 VALUE +0.
    77 77  N1                          PIC S999 COMP-3 VALUE +0.
    78 77  N2                          PIC S999 COMP-3 VALUE +0.
    79 77  N3                          PIC S999 COMP-3 VALUE +0.
    80 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    81 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    82 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    83     88  REVERSAL                    VALUE 'Y'.
    84 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    85 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    86 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    87 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    88 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    89     88  ERMAIL-FOUND                 VALUE 'Y'.
    90 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    91 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    92 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    93 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    94     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    95
    96*    COPY ELCSCTM.
    97******************************************************************
    98*                                                                *
    99*                                                                *
   100*                            ELCSCTM                             *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-MESSAGE.
   107     12  FILLER                          PIC X(30)
   108            VALUE '** LOGIC SECURITY VIOLATION -'.
   109     12  SM-READ                         PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' PGM='.
   112     12  SM-PGM                          PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' OPR='.
   115     12  SM-PROCESSOR-ID                 PIC X(4).
   116     12  FILLER                          PIC X(6)
   117            VALUE ' TERM='.
   118     12  SM-TERMID                       PIC X(4).
   119     12  FILLER                          PIC XX   VALUE SPACE.
   120     12  SM-JUL-DATE                     PIC 9(5).
   121     12  FILLER                          PIC X    VALUE SPACE.
   122     12  SM-TIME                         PIC 99.99.
   123
   124
   125*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   4
* EL6311.cbl
   126******************************************************************
   127*                                                                *
   128*                                                                *
   129*                            ELCSCRTY                            *
   130*                            VMOD=2.001                          *
   131*                                                                *
   132*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   133*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   134*        SAVED IN PI-SECURITY-ADDRESS.                           *
   135*                                                                *
   136******************************************************************
   137 01  SECURITY-CONTROL.
   138     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   139     12  FILLER                       PIC XX    VALUE 'SC'.
   140     12  SC-CREDIT-CODES.
   141         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   142             20  SC-CREDIT-DISPLAY    PIC X.
   143             20  SC-CREDIT-UPDATE     PIC X.
   144     12  SC-CLAIMS-CODES.
   145         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   146             20  SC-CLAIMS-DISPLAY    PIC X.
   147             20  SC-CLAIMS-UPDATE     PIC X.
   148
   149 01  WS-VA-NO-COMM-MESS.
   150     12  FILLER                  PIC X(41) VALUE
   151        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   152 01  WS-OC-MESSAGE.
   153     12  FILLER                  PIC X(43) VALUE
   154        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   155     12  WS-OC-DIS-AMT           PIC -----9.99.
   156     12  FILLER                  PIC X(4) VALUE ' ON '.
   157     12  WS-OC-DATE              PIC X(10).
   158 01  WS-DATE-AREA.
   159     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   160     12  WS-CURRENT-DT.
   161         16  FILLER              PIC X(6)    VALUE SPACES.
   162         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   163     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   164     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   165     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   166
   167 01  STANDARD-AREAS.
   168     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   169     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   170     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   171     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   172     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   173     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   174     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   175     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   176     12  PGM-NAME                PIC X(8).
   177     12  TIME-IN                 PIC S9(7).
   178     12  TIME-OUT-R  REDEFINES TIME-IN.
   179         16  FILLER              PIC X.
   180         16  TIME-OUT            PIC 99V99.
   181         16  FILLER              PIC XX.
   182     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   183     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   5
* EL6311.cbl
   184     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   185     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   186     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   187     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   188     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   189     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   190     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   191     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   192     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   193     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   194     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   195     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   196     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   197     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   198     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   199     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   200     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   201     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   202     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   203     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   204     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   205     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   206     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   207     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   208     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   209     12  FILE-ID                 PIC X(8).
   210     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   211     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   212     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   213     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   214     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   215     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   216     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   217     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   218     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   219     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   220     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   221     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   222     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   223     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   224     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   225
   226 01  WS-PASS-AREA.
   227     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   228     05  WS-PASS-VADS-REC    PIC X(350).
   229*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   230*                                COPY ELCZREC.
   231******************************************************************
   232*                                                                *
   233*                                                                *
   234*                            ELCZREC.                            *
   235*                                                                *
   236*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   237*                                                                *
   238******************************************************************
   239*-----------------------------------------------------------------
   240*                   C H A N G E   L O G
   241*
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   6
* EL6311.cbl
   242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   243*-----------------------------------------------------------------
   244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   245* EFFECTIVE    NUMBER
   246*-----------------------------------------------------------------
   247* 122011    2011022800001  AJRA  NEW FILE
   248* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   249* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   250*-----------------------------------------------------------------
   251 01  W-Z-CONTROL-DATA.
   252     05  W-NUMBER-OF-COPIES      PIC  9.
   253     05  FILLER                  PIC  X.
   254     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   255     05  FILLER                  PIC  X.
   256     05  W-DAYS-TO-RESEND        PIC  999.
   257     05  FILLER                  PIC  X.
   258     05  W-FORM-TO-RESEND        PIC  X(4).
   259     05  FILLER                  PIC  X.
   260     05  W-PROMPT-LETTER         PIC  X.
   261     05  FILLER                  PIC  X.
   262     05  W-ENCLOSURE-CD          PIC  XXX.
   263     05  FILLER                  PIC  X.
   264     05  W-AUTO-CLOSE-IND        PIC  X.
   265     05  FILLER                  PIC  X.
   266     05  W-LETTER-TO-BENE        PIC  X.
   267     05  FILLER                  PIC  X.
   268     05  W-LETTER-TO-ACCT        PIC  X.
   269     05  FILLER                  PIC  X.
   270     05  W-LETTER-TYPE           PIC  X.
   271     05  FILLER                  PIC  X.
   272     05  W-PRINT-CERTIFICATE     PIC  X.
   273     05  FILLER                  PIC  X.
   274     05  W-REFUND-REQUIRED       PIC  X.
   275     05  FILLER                  PIC  X.
   276     05  W-ONBASE-CODE           PIC  XX.
   277     05  FILLER                  PIC  X.
   278     05  W-ACCT-SUMM             PIC  X.
   279     05  FILLER                  PIC  X.
   280     05  W-CSO-SUMM              PIC  X.
   281     05  FILLER                  PIC  X.
   282     05  W-REASONS-REQUIRED      PIC  X.
   283     05  FILLER                  PIC  X(29).
   284******************************************************************
   285*                                                                *
   286*              A C C E S S   K E Y S                             *
   287*                                                                *
   288******************************************************************
   289
   290 01  ACCESS-KEYS.
   291     12  ERPYAJ-KEY.
   292         16  ERPYAJ-COMPANY-CD       PIC X.
   293         16  ERPYAJ-CARRIER          PIC X.
   294         16  ERPYAJ-GROUPING         PIC X(6).
   295         16  ERPYAJ-FIN-RESP         PIC X(10).
   296         16  ERPYAJ-ACCOUNT          PIC X(10).
   297         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   298         16  ERPYAJ-TYPE             PIC X.
   299     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   7
* EL6311.cbl
   300     12  ELCERT-KEY.
   301         16  ELCERT-COMPANY-CD       PIC X.
   302         16  ELCERT-CARRIER          PIC X.
   303         16  ELCERT-GROUPING         PIC X(6).
   304         16  ELCERT-STATE            PIC XX.
   305         16  ELCERT-ACCOUNT          PIC X(10).
   306         16  ELCERT-CERT-EFF-DT      PIC XX.
   307         16  ELCERT-CERT-NO.
   308             20  ELCERT-CERT-PRIME   PIC X(10).
   309             20  ELCERT-CERT-SFX     PIC X.
   310
   311     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   312     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   313     12  ELCRTO-KEY.
   314         16  ELCRTO-COMPANY-CD       PIC X.
   315         16  ELCRTO-CARRIER          PIC X.
   316         16  ELCRTO-GROUPING         PIC X(6).
   317         16  ELCRTO-STATE            PIC XX.
   318         16  ELCRTO-ACCOUNT          PIC X(10).
   319         16  ELCRTO-CERT-EFF-DT      PIC XX.
   320         16  ELCRTO-CERT-NO.
   321             20  ELCRTO-CERT-PRIME   PIC X(10).
   322             20  ELCRTO-CERT-SFX     PIC X.
   323         16  ELCRTO-RECORD-TYPE      PIC X.
   324         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   325
   326     12  ELCRTT-KEY.
   327         16  ELCRTT-PRIMARY          PIC X(33).
   328         16  ELCRTT-REC-TYPE         PIC X(1).
   329     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   330     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   331
   332     12  ERPNDB-KEY.
   333         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   334         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   335         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   336         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   337             ERPNDB-BATCH-SEQ-NO     PIC XX.
   338         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   339
   340     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   341     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   342     12  ELLETR-KEY.
   343         16  LETR-COMPANY-CD     PIC X.
   344         16  LETR-LETTER-ID      PIC X(4).
   345         16  LETR-FILLER         PIC X(8).
   346         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   347     12  ERPNDM-KEY.
   348         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   349         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   350         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   351         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   352
   353*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   354     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   355*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   356     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   357
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   8
* EL6311.cbl
   358     12  ERPNDB-ALT-KEY.
   359         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   360         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   361         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   362         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   363         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   364         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   365         16  ERPNDB-CERT-NO.
   366             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   367             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   368         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   369         16  ERPNDB-RECORD-TYPE      PIC X.
   370
   371      12  ERPNDB-CSR-KEY.
   372          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   373          20  ERPNDB-CSR-ID                PIC X(4).
   374          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   375          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   376          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   377
   378     12  ERNOTE-KEY.
   379         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   380         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   381         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   382         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   383         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   384         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   385         16  ERNOTE-CERT-NO.
   386             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   387             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   388
   389     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   390     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   391
   392     12  ERCNOT-KEY.
   393         16  ERCNOT-PART-KEY.
   394             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   395             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   396             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   397             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   398             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   399             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   400             20  ERCNOT-CERT-NO.
   401                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   402                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   403         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   404         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   405
   406     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   407     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   408
   409     12  ERMAIL-KEY.
   410         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   411         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   412         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   413         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   414         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   415         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page   9
* EL6311.cbl
   416         16  ERMAIL-CERT-NO.
   417             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   418             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   419
   420     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   421     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   422
   423     12  ERRQST-KEY.
   424         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   425         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   426
   427     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   428     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   429
   430     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   431
   432     12  ERLOFC-KEY.
   433         16  ERLOFC-COMPANY-CD          PIC  X.
   434         16  ERLOFC-CARRIER             PIC  X.
   435         16  ERLOFC-GROUPING            PIC  X(6).
   436         16  ERLOFC-STATE               PIC  XX.
   437         16  ERLOFC-ACCOUNT             PIC  X(10).
   438         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   439*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   440
   441     12  ERACCT-KEY.
   442         16  ERACCT-COMPANY-CD          PIC  X.
   443         16  ERACCT-CARRIER             PIC  X.
   444         16  ERACCT-GROUPING            PIC  X(6).
   445         16  ERACCT-STATE               PIC  XX.
   446         16  ERACCT-ACCOUNT             PIC  X(10).
   447         16  ERACCT-EXP-DT.
   448             20  ERACCT-DT              PIC  XX.
   449             20  ERACCT-FILL            PIC  X(4).
   450
   451     12  ERENDT-KEY.
   452         16  ENDT-COMPANY-CD       PIC X.
   453         16  ENDT-CARRIER          PIC X.
   454         16  ENDT-GROUPING         PIC X(6).
   455         16  ENDT-STATE            PIC XX.
   456         16  ENDT-ACCOUNT          PIC X(10).
   457         16  ENDT-CERT-EFF-DT      PIC XX.
   458         16  ENDT-CERT-PRIME       PIC X(10).
   459         16  ENDT-CERT-SFX         PIC X.
   460         16  ENDT-RECORD-TYPE      PIC X.
   461         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   462
   463 01  WS-ELMSTR-WORK.
   464     12  ELMSTR-KEY.
   465         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   466         16  MSTR-CERT-NO.
   467             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   468             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   469     12  W-CLAIM-KEY.
   470         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   471         16  W-CL-CERT-NO.
   472             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   473             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  10
* EL6311.cbl
   474      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   475 01  CANCEL-GEN-PASS-AREA.
   476     05  CG-OPTION-CODE          PIC X.
   477         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   478         88  CG-FLAT-CANCEL        VALUE '1'.
   479         88  CG-CANCEL             VALUE '2'.
   480         88  CG-CANCEL-REISSUE     VALUE '3'.
   481     05  CG-ERROR-CODE           PIC 99.
   482         88  CG-SUCCESS            VALUE 00.
   483         88  CG-DATE-ERROR         VALUE 01.
   484         88  CG-CERT-NOT-FOUND     VALUE 02.
   485         88  CG-AMOUNT-ERROR       VALUE 04.
   486         88  CG-OPTION-ERROR       VALUE 05.
   487         88  CG-PREV-CAN           VALUE 06.
   488         88  CG-INVALID-DATA       VALUE 07.
   489         88  CG-NO-ACCT-MSTR       VALUE 08.
   490         88  CG-SFX-A-EXIST        VALUE 09.
   491         88  CG-MISC-ERROR         VALUE 99.
   492     05  CG-COMPANY-ID           PIC XXX.
   493     05  CG-PROC-ID              PIC XXXX.
   494     05  CG-CURRENT-DT           PIC XX.
   495     05  CG-MONTH-END-DT         PIC XX.
   496     05  CG-CERT-KEY.
   497         10  CG-CERT-COMPANY-CD  PIC X.
   498         10  CG-CERT-CARRIER     PIC X.
   499         10  CG-CERT-GROUP       PIC X(6).
   500         10  CG-CERT-STATE       PIC XX.
   501         10  CG-CERT-ACCOUNT     PIC X(10).
   502         10  CG-CERT-EFF-DT      PIC XX.
   503         10  CG-CERT-CERT-NO     PIC X(11).
   504     05  CG-LF-CAN-DATA.
   505         10  CG-LF-CAN-DT        PIC XX.
   506         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   507     05  CG-AH-CAN-DATA.
   508         10  CG-AH-CAN-DT        PIC XX.
   509         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   510     05  CG-CERT-PROFILE-DATA.
   511         10  CG-INS-LNAME        PIC X(15).
   512         10  CG-INS-FNAME        PIC X(10).
   513         10  CG-INS-MID-INIT     PIC X.
   514         10  CG-INS-AGE          PIC 99.
   515         10  CG-JNT-LNAME        PIC X(15).
   516         10  CG-JNT-FNAME        PIC X(10).
   517         10  CG-JNT-MID-INIT     PIC X.
   518         10  CG-JNT-AGE          PIC 99.
   519     05  CG-LF-ISS-DATA.
   520         10  CG-LF-BENCD         PIC XX.
   521         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   522         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   523     05  CG-AH-ISS-DATA.
   524         10  CG-AH-BENCD         PIC XX.
   525         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   526     05  CG-BATCH-NO             PIC X(6).
   527     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   528     05  FILLER                  PIC X(306).
   529******************************************************************
   530*                                                                *
   531*            G E N E R A L   W O R K   A R E A                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  11
* EL6311.cbl
   532*                                                                *
   533******************************************************************
   534
   535 01  WORK-AREA.
   536     12  WS-RESPONSE             PIC S9(8)   COMP.
   537         88  RESP-NORMAL                  VALUE +00.
   538         88  RESP-NOTFND                  VALUE +13.
   539         88  RESP-DUPREC                  VALUE +14.
   540         88  RESP-DUPKEY                  VALUE +15.
   541         88  RESP-NOTOPEN                 VALUE +19.
   542         88  RESP-ENDFILE                 VALUE +20.
   543     12  DEEDIT-FIELD            PIC X(15).
   544     12  FILLER          REDEFINES DEEDIT-FIELD.
   545         16  FILLER              PIC X(4).
   546         16  DEEDIT-FIELD-X11    PIC X(11).
   547     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   548                                 PIC S9(15).
   549     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   550                                 PIC S9(13)V99.
   551     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   552                                 PIC S9(11)V9999.
   553     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   554     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   555     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   556         16  WS-CALC-TERM-WHOLE  PIC S999.
   557         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   558
   559     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   560     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   561         16  WS-HR-MINS          PIC 99V99.
   562         16  FILLER              PIC XX.
   563
   564     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   565     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   566
   567     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   568     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   569
   570     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   571     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   572     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   573     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   574     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   575     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   576     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   577
   578     12  QID.
   579         16  QID-TERM            PIC X(4).
   580         16  FILLER              PIC X(4)    VALUE '607B'.
   581
   582     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   583         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   584
   585     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   586         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   587
   588     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   589         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  12
* EL6311.cbl
   590
   591     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   592
   593     12  WS-NUMERIC-SW           PIC X.
   594        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   595
   596     12  WS-EDIT-CSO-FIELD.
   597         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   598                                 PIC X.
   599
   600     12  WS-SAVE-INPUT-FIELDS.
   601         16  WS-BAGE             PIC 99       VALUE ZERO.
   602*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   603         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   604         16  FILLER REDEFINES WS-BAPR.
   605             20  WS-APR-WHOLE-NUM    PIC 99.
   606             20  WS-APR-DEC          PIC 9999.
   607         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   608         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   609
   610         16  WS-B-COVERAGE OCCURS 2 TIMES.
   611             20  WS-TERM-IN-DAYS-SW  PIC X.
   612                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   613             20  WS-BTERM        PIC 999       COMP-3.
   614             20  WS-BALT-TERM    PIC 999       COMP-3.
   615             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   616             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   617             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   618             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   619             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   620             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   621
   622         16  WS-C-FIELDS COMP-3.
   623             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   624             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   625             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   626
   627         16  WS-D-FIELDS COMP-3.
   628             20  WS-DRISS        PIC S9(5)    VALUE +0.
   629             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   630             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   631             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   632             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   633             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   634
   635     12  WS-SAVE-BIRTH-DATE.
   636         16  FILLER              PIC X(4)   VALUE SPACES.
   637         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   638
   639     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   640     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   641     12  FILLER REDEFINES WS-WORK-BIN-RED.
   642         16  FILLER              PIC X(02).
   643         16  WS-WORK-BIN-DT      PIC X(02).
   644     12  WS-SW-1                 PIC X     VALUE SPACE.
   645     12  WS-SW-2                 PIC X     VALUE SPACE.
   646     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   647         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  13
* EL6311.cbl
   648     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   649         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   650
   651     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   652     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   653     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   654     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   655     12  WS-CONVERTED-CANCEL-DATES.
   656         16  WS-CONVERTED-CANDT1                  PIC XX.
   657         16  WS-CONVERTED-CANDT2                  PIC XX.
   658
   659     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   660
   661     12  WS-REC-FOUND-SW         PIC X.
   662         88  RECORD-NOT-FOUND    VALUE 'N'.
   663
   664     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   665         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   666         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   667
   668     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   669         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   670         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   671
   672     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   673         88  BROWSE-STARTED      VALUE 'Y'.
   674
   675     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   676         88  FIRST-TIME          VALUE 'Y'.
   677
   678     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   679         88  FIRST-ENTRY         VALUE 'Y'.
   680
   681     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   682         88  REC-BILLED          VALUE 'Y'.
   683
   684     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   685         88  NO-CURSOR-SET       VALUE +0.
   686         88  CURSOR-SET          VALUE +1.
   687
   688     12  WS-ERR-SW               PIC X.
   689         88  STD-ERRORS          VALUE 'S'.
   690         88  TRN-ERRORS          VALUE 'T'.
   691
   692     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   693         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   694
   695     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   696         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   697
   698     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   699         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   700
   701     12  WS-ERR-CODE.
   702         16  FILLER              PIC 99.
   703         16  WS-ERROR-SUB        PIC 99.
   704
   705     12  WS-DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  14
* EL6311.cbl
   706         16  WS-WORK-MM          PIC XX.
   707         16  WS-WORK-DD          PIC XX.
   708         16  WS-WORK-YY          PIC XX.
   709
   710     12  WS-MM-YY.
   711         16  WS-MM               PIC XX.
   712         16  FILLER              PIC X     VALUE '/'.
   713         16  WS-YY               PIC XX.
   714
   715     12  WS-CERT-EFF-DT          PIC XX.
   716
   717     12  WS-MEMBER-NO            PIC X(12).
   718     12  FILLER  REDEFINES  WS-MEMBER-NO.
   719         16  WS-MEMBER-NO-1-8    PIC 9(8).
   720         16  FILLER              PIC X(4).
   721
   722     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   723
   724     12  WS-ERPNDB-ALT-KEY.
   725         16  WS-PB-COMPANY-CD-A1         PIC X.
   726         16  WS-PB-CARRIER               PIC X.
   727         16  WS-PB-GROUPING              PIC X(6).
   728         16  WS-PB-STATE                 PIC XX.
   729         16  WS-PB-ACCOUNT               PIC X(10).
   730         16  WS-PB-CERT-EFF-DT           PIC XX.
   731         16  WS-PB-CERT-NO.
   732             20  WS-PB-CERT-PRIME        PIC X(10).
   733             20  WS-PB-CERT-SFX          PIC X.
   734         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   735         16  WS-PB-RECORD-TYPE           PIC X.
   736
   737     12  WS-SHOW-SAVE-AREAS.
   738         16  WS-NEW-CERT-NO.
   739             20  WS-NEW-PRIME    PIC X(10).
   740             20  WS-NEW-SUFFIX   PIC X.
   741         16  WS-NEW-CERT-EFF-DT  PIC XX.
   742         16  WS-NEW-RECORD-TYPE  PIC X.
   743         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   744             88   SHOW-RECORD            VALUE 'Y'.
   745
   746     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   747
   748     12  WS-BATCH-NO.
   749         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   750         16  FILLER              PIC X(5) VALUE SPACES.
   751
   752     12  WS-FIRST-NAME.
   753         16  WS-1ST-INIT         PIC X.
   754         16  FILLER              PIC X(9).
   755
   756     12  WS-INITIALS.
   757         16  WS-INITIAL-1        PIC X.
   758         16  WS-INITIAL-2        PIC X.
   759
   760     12  WS-C-HDG.
   761         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   762         16  FILLER              PIC X(4) VALUE '-REF'.
   763
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  15
* EL6311.cbl
   764     12  WS-D-PREM-HDG.
   765         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   766         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   767
   768     12  WS-D-REFUND-HDG.
   769         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   770         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   771
   772     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   773
   774     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   775     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   776     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   777     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   778     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   779     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   780     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   781
   782     12  WS-01-CANCEL-ERR        PIC X(25)
   783         VALUE 'CANCEL DATE ERROR'.
   784     12  WS-02-CANCEL-ERR        PIC X(25)
   785         VALUE 'CERT NOT FOUND'.
   786     12  WS-04-CANCEL-ERR        PIC X(25)
   787         VALUE 'CANCEL AMOUNT ERROR'.
   788     12  WS-05-CANCEL-ERR        PIC X(25)
   789         VALUE 'CANCEL OPTION ERROR'.
   790     12  WS-06-CANCEL-ERR        PIC X(25)
   791         VALUE 'PREVIOUSLY CANCELLED'.
   792     12  WS-07-CANCEL-ERR        PIC X(25)
   793         VALUE 'INVALID DATA'.
   794     12  WS-08-CANCEL-ERR        PIC X(25)
   795         VALUE 'NO ACCOUNT MASTER'.
   796     12  WS-09-CANCEL-ERR        PIC X(25)
   797         VALUE 'SUFFIX ALREADY EXISTS'.
   798     12  WS-99-CANCEL-ERR        PIC X(25)
   799         VALUE 'MISC CANCEL ERROR'.
   800
   801     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   802     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   803
   804     12  WS-AGE-FIELDS.
   805         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   806         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   807         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   808         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   809
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  16
* EL6311.cbl
   811
   812******************************************************************
   813*                                                                *
   814*                 B A T C H   T O T A L S                        *
   815*                                                                *
   816******************************************************************
   817
   818     12  WS-BATCH-RECORD.
   819         16  FILLER                       PIC X(10).
   820         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   821         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   822         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   823         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   824         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   825         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   826         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   827         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   828         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   829         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   830         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   831         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   832         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   833         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   834         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   835         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   836         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   837         16  WS-ACCOUNT-NAME              PIC X(30).
   838         16  FILLER                       PIC X.
   839         16  WS-REFERENCE                 PIC X(12).
   840         16  FILLER                       PIC X(197).
   841
   842     12  WS-BATCH-TOTALS.
   843         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   844         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   845         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   846         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   847         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   848         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   849         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   850         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   851         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   852         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   853         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   854         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   855         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   856         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   858         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   859         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   861         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   862
   863     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   864
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  17
* EL6311.cbl
   866
   867******************************************************************
   868*                                                                *
   869*                E R R O R   M E S S A G E S                     *
   870*                                                                *
   871******************************************************************
   872
   873 01  ERROR-MESSAGES.
   874     12  ER-0004                 PIC  9(4) VALUE 0004.
   875     12  ER-0008                 PIC  9(4) VALUE 0008.
   876     12  ER-0023                 PIC  9(4) VALUE 0023.
   877     12  ER-0029                 PIC  9(4) VALUE 0029.
   878     12  ER-0033                 PIC  9(4) VALUE 0033.
   879     12  ER-0070                 PIC  9(4) VALUE 0070.
   880     12  ER-0220                 PIC  9(4) VALUE 0220.
   881     12  ER-0248                 PIC  9(4) VALUE 0248.
   882     12  ER-0280                 PIC  9(4) VALUE 0280.
   883     12  ER-0348                 PIC  9(4) VALUE 0348.
   884     12  ER-0582                 PIC  9(4) VALUE 0582.
   885     12  ER-0877                 PIC  9(4) VALUE 0877.
   886     12  ER-1236                 PIC  9(4) VALUE 1236.
   887     12  ER-1570                 PIC  9(4) VALUE 1570.
   888     12  ER-1575                 PIC  9(4) VALUE 1575.
   889     12  ER-1609                 PIC  9(4) VALUE 1609.
   890     12  ER-1819                 PIC  9(4) VALUE 1819.
   891     12  ER-2129                 PIC  9(4) VALUE 2129.
   892     12  ER-2188                 PIC  9(4) VALUE 2188.
   893     12  ER-2192                 PIC  9(4) VALUE 2192.
   894     12  ER-2196                 PIC  9(4) VALUE 2196.
   895     12  ER-2197                 PIC  9(4) VALUE 2197.
   896     12  ER-2198                 PIC  9(4) VALUE 2198.
   897     12  ER-2200                 PIC  9(4) VALUE 2200.
   898     12  ER-2212                 PIC  9(4) VALUE 2212.
   899     12  ER-2218                 PIC  9(4) VALUE 2218.
   900     12  ER-2220                 PIC  9(4) VALUE 2220.
   901     12  ER-2222                 PIC  9(4) VALUE 2222.
   902     12  ER-2223                 PIC  9(4) VALUE 2223.
   903     12  ER-2224                 PIC  9(4) VALUE 2224.
   904     12  ER-2225                 PIC  9(4) VALUE 2225.
   905     12  ER-2226                 PIC  9(4) VALUE 2226.
   906     12  ER-2227                 PIC  9(4) VALUE 2227.
   907     12  ER-2228                 PIC  9(4) VALUE 2228.
   908     12  ER-2240                 PIC  9(4) VALUE 2240.
   909     12  ER-2241                 PIC  9(4) VALUE 2241.
   910     12  ER-2242                 PIC  9(4) VALUE 2242.
   911     12  ER-2243                 PIC  9(4) VALUE 2243.
   912     12  ER-2244                 PIC  9(4) VALUE 2244.
   913     12  ER-2245                 PIC  9(4) VALUE 2245.
   914     12  ER-2246                 PIC  9(4) VALUE 2246.
   915     12  ER-2247                 PIC  9(4) VALUE 2247.
   916     12  ER-2251                 PIC  9(4) VALUE 2251.
   917     12  ER-2252                 PIC  9(4) VALUE 2252.
   918     12  ER-2253                 PIC  9(4) VALUE 2253.
   919     12  ER-2254                 PIC  9(4) VALUE 2254.
   920     12  ER-2255                 PIC  9(4) VALUE 2255.
   921     12  ER-2256                 PIC  9(4) VALUE 2256.
   922     12  ER-2257                 PIC  9(4) VALUE 2257.
   923     12  ER-2258                 PIC  9(4) VALUE 2258.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  18
* EL6311.cbl
   924     12  ER-2259                 PIC  9(4) VALUE 2259.
   925     12  ER-2260                 PIC  9(4) VALUE 2260.
   926     12  ER-2261                 PIC  9(4) VALUE 2261.
   927     12  ER-2287                 PIC  9(4) VALUE 2287.
   928     12  ER-2336                 PIC  9(4) VALUE 2336.
   929     12  ER-2337                 PIC  9(4) VALUE 2337.
   930     12  ER-2437                 PIC  9(4) VALUE 2437.
   931     12  ER-2471                 PIC  9(4) VALUE 2471.
   932     12  ER-2530                 PIC  9(4) VALUE 2530.
   933     12  ER-2531                 PIC  9(4) VALUE 2531.
   934     12  ER-2532                 PIC  9(4) VALUE 2532.
   935     12  ER-2533                 PIC  9(4) VALUE 2533.
   936     12  ER-2547                 PIC  9(4) VALUE 2547.
   937     12  ER-2591                 PIC  9(4) VALUE 2591.
   938     12  ER-2592                 PIC  9(4) VALUE 2592.
   939     12  ER-2593                 PIC  9(4) VALUE 2593.
   940     12  ER-2600                 PIC  9(4) VALUE 2600.
   941     12  ER-2601                 PIC  9(4) VALUE 2601.
   942     12  ER-2604                 PIC  9(4) VALUE 2604.
   943     12  ER-2605                 PIC  9(4) VALUE 2605.
   944     12  ER-2606                 PIC  9(4) VALUE 2606.
   945     12  ER-2607                 PIC  9(4) VALUE 2607.
   946     12  ER-2622                 PIC  9(4) VALUE 2622.
   947     12  ER-2625                 PIC  9(4) VALUE 2625.
   948     12  ER-2626                 PIC  9(4) VALUE 2626.
   949     12  ER-2627                 PIC  9(4) VALUE 2627.
   950     12  ER-2628                 PIC  9(4) VALUE 2628.
   951     12  ER-2629                 PIC  9(4) VALUE 2629.
   952     12  ER-2630                 PIC  9(4) VALUE 2630.
   953     12  ER-2631                 PIC  9(4) VALUE 2631.
   954     12  ER-2632                 PIC  9(4) VALUE 2632.
   955     12  ER-2633                 PIC  9(4) VALUE 2633.
   956     12  ER-2634                 PIC  9(4) VALUE 2634.
   957     12  ER-2635                 PIC  9(4) VALUE 2635.
   958     12  ER-2636                 PIC  9(4) VALUE 2636.
   959     12  ER-2639                 PIC  9(4) VALUE 2639.
   960     12  ER-2640                 PIC  9(4) VALUE 2640.
   961     12  ER-2647                 PIC  9(4) VALUE 2647.
   962     12  ER-2648                 PIC  9(4) VALUE 2648.
   963     12  ER-2649                 PIC  9(4) VALUE 2649.
   964     12  ER-2650                 PIC  9(4) VALUE 2650.
   965     12  ER-2653                 PIC  9(4) VALUE 2653.
   966     12  ER-2654                 PIC  9(4) VALUE 2654.
   967     12  ER-2655                 PIC  9(4) VALUE 2655.
   968     12  ER-2656                 PIC  9(4) VALUE 2656.
   969     12  ER-2657                 PIC  9(4) VALUE 2657.
   970     12  ER-2660                 PIC  9(4) VALUE 2660.
   971     12  ER-2662                 PIC  9(4) VALUE 2662.
   972     12  ER-2663                 PIC  9(4) VALUE 2663.
   973     12  ER-2664                 PIC  9(4) VALUE 2664.
   974     12  ER-2667                 PIC  9(4) VALUE 2667.
   975     12  ER-2668                 PIC  9(4) VALUE 2668.
   976     12  ER-2669                 PIC  9(4) VALUE 2669.
   977     12  ER-2670                 PIC  9(4) VALUE 2670.
   978     12  ER-2671                 PIC  9(4) VALUE 2671.
   979     12  ER-2672                 PIC  9(4) VALUE 2672.
   980     12  ER-2673                 PIC  9(4) VALUE 2673.
   981     12  ER-2677                 PIC  9(4) VALUE 2677.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  19
* EL6311.cbl
   982     12  ER-2678                 PIC  9(4) VALUE 2678.
   983     12  ER-2679                 PIC  9(4) VALUE 2679.
   984     12  ER-2680                 PIC  9(4) VALUE 2680.
   985     12  ER-2681                 PIC  9(4) VALUE 2681.
   986     12  ER-2682                 PIC  9(4) VALUE 2682.
   987     12  ER-2683                 PIC  9(4) VALUE 2683.
   988     12  ER-2684                 PIC  9(4) VALUE 2684.
   989     12  ER-2686                 PIC  9(4) VALUE 2686.
   990     12  ER-2689                 PIC  9(4) VALUE 2689.
   991     12  ER-2690                 PIC  9(4) VALUE 2690.
   992     12  ER-2693                 PIC  9(4) VALUE 2693.
   993     12  ER-2695                 PIC  9(4) VALUE 2695.
   994     12  ER-2701                 PIC  9(4) VALUE 2701.
   995     12  ER-2720                 PIC  9(4) VALUE 2720.
   996     12  ER-2709                 PIC  9(4) VALUE 2709.
   997     12  ER-2704                 PIC  9(4) VALUE 2704.
   998     12  ER-2725                 PIC  9(4) VALUE 2725.
   999     12  ER-2726                 PIC  9(4) VALUE 2726.
  1000     12  ER-2728                 PIC  9(4) VALUE 2728.
  1001     12  ER-2729                 PIC  9(4) VALUE 2729.
  1002     12  ER-2731                 PIC  9(4) VALUE 2731.
  1003     12  ER-2732                 PIC  9(4) VALUE 2732.
  1004     12  ER-2733                 PIC  9(4) VALUE 2733.
  1005     12  ER-2735                 PIC  9(4) VALUE 2735.
  1006     12  ER-2738                 PIC  9(4) VALUE 2738.
  1007     12  ER-2742                 PIC  9(4) VALUE 2742.
  1008     12  ER-2743                 PIC  9(4) VALUE 2743.
  1009     12  ER-2744                 PIC  9(4) VALUE 2744.
  1010     12  ER-2747                 PIC  9(4) VALUE 2747.
  1011     12  ER-2749                 PIC  9(4) VALUE 2749.
  1012     12  ER-2753                 PIC  9(4) VALUE 2753.
  1013     12  ER-2755                 PIC  9(4) VALUE 2755.
  1014     12  ER-2757                 PIC  9(4) VALUE 2757.
  1015     12  ER-2771                 PIC  9(4) VALUE 2771.
  1016     12  ER-2774                 PIC  9(4) VALUE 2774.
  1017     12  ER-2775                 PIC  9(4) VALUE 2775.
  1018     12  ER-2776                 PIC  9(4) VALUE 2776.
  1019     12  ER-2777                 PIC  9(4) VALUE 2777.
  1020     12  ER-2794                 PIC  9(4) VALUE 2794.
  1021     12  ER-2799                 PIC  9(4) VALUE 2799.
  1022     12  ER-2900                 PIC  9(4) VALUE 2900.
  1023     12  ER-2902                 PIC  9(4) VALUE 2902.
  1024     12  ER-2945                 PIC  9(4) VALUE 2945.
  1025     12  ER-3000                 PIC  9(4) VALUE 3000.
  1026     12  ER-3006                 PIC  9(4) VALUE 3006.
  1027     12  ER-3224                 PIC  9(4) VALUE 3224.
  1028     12  ER-3831                 PIC  9(4) VALUE 3831.
  1029     12  ER-3834                 PIC  9(4) VALUE 3834.
  1030     12  ER-3835                 PIC  9(4) VALUE 3835.
  1031     12  ER-4005                 PIC  9(4) VALUE 4005.
  1032     12  ER-7401                 PIC  9(4) VALUE 7401.
  1033     12  ER-7402                 PIC  9(4) VALUE 7402.
  1034     12  ER-7403                 PIC  9(4) VALUE 7403.
  1035     12  ER-7404                 PIC  9(4) VALUE 7404.
  1036     12  ER-7423                 PIC  9(4) VALUE 7423.
  1037     12  ER-7424                 PIC  9(4) VALUE 7424.
  1038     12  ER-7433                 PIC  9(4) VALUE 7433.
  1039     12  ER-7450                 PIC  9(4) VALUE 7450.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  20
* EL6311.cbl
  1040     12  ER-7451                 PIC  9(4) VALUE 7451.
  1041     12  ER-7530                 PIC  9(4) VALUE 7530.
  1042     12  ER-7573                 PIC  9(4) VALUE 7573.
  1043     12  ER-7631                 PIC  9(4) VALUE 7631.
  1044     12  ER-7632                 PIC  9(4) VALUE 7632.
  1045     12  ER-7633                 PIC  9(4) VALUE 7633.
  1046     12  ER-7537                 PIC  9(4) VALUE 7537.
  1047     12  ER-7538                 PIC  9(4) VALUE 7538.
  1048     12  ER-7574                 PIC  9(4) VALUE 7574.
  1049     12  ER-7997                 PIC  9(4) VALUE 7997.
  1050     12  ER-7998                 PIC  9(4) VALUE 7998.
  1051     12  ER-8148                 PIC  9(4) VALUE 8148.
  1052     12  ER-9841                 PIC  9(4) VALUE 9841.
  1053
  1054*                                COPY ELCTEXT.
  1055******************************************************************
  1056*                                                                *
  1057*                                                                *
  1058*                            ELCTEXT.                            *
  1059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1060*                            VMOD=2.008                          *
  1061*                                                                *
  1062*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1063*                                     FORM LETTERS,              *
  1064*                                     CERT FORM DISPLAY.
  1065*                                                                *
  1066*   FILE TYPE = VSAM,KSDS                                        *
  1067*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1068*                                                                *
  1069*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1070*       ALTERNATE INDEX = NONE                                   *
  1071*                                                                *
  1072*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1073*       ALTERNATE INDEX = NONE                                   *
  1074*                                                                *
  1075*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1076*       ALTERNATE INDEX = NONE                                   *
  1077*                                                                *
  1078*   LOG = NO                                                     *
  1079*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1080******************************************************************
  1081 01  TEXT-FILES.
  1082     12  TEXT-FILE-ID                PIC XX.
  1083         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1084         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1085         88  HELP-FILE-TEXT             VALUE 'TH'.
  1086
  1087     12  TX-CONTROL-PRIMARY.
  1088         16  TX-COMPANY-CD           PIC X.
  1089             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1090         16  TX-ACCESS-CD-GENL       PIC X(12).
  1091
  1092         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1093             20  TX-LETTER-NO        PIC X(4).
  1094             20  FILLER              PIC X(8).
  1095
  1096         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1097             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  21
* EL6311.cbl
  1098
  1099         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1100             20  TX-HELP-TYPE        PIC X.
  1101                 88  HELP-FOR-GENERAL   VALUE ' '.
  1102                 88  HELP-BY-SCREEN     VALUE 'S'.
  1103                 88  HELP-BY-ERROR      VALUE 'E'.
  1104             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1105                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1106             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1107                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1108             20  FILLER              PIC X(4).
  1109
  1110         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1111
  1112     12  TX-PROCESS-CONTROL          PIC XX.
  1113         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1114
  1115     12  TX-TEXT-LINE                PIC X(70).
  1116
  1117     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1118         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1119         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1120         88  TX-VALID-FORM-SQUEEZE-VALUE
  1121                                        VALUE 'Y' ' '.
  1122
  1123     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1124         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1125         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1126         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1127         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1128         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1129         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1130         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1131                                              'K' 'N' ' '
  1132                                              'Z'.
  1133
  1134     12  TX-ARCHIVE-SW               PIC X.
  1135         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1136         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1137         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1138
  1139     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1140     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1141
  1142     12  TX-BSR-CODE                 PIC X.
  1143         88  TX-BSR-LETTER              VALUE 'B'.
  1144         88  TX-NON-BSR-LETTER          VALUE ' '.
  1145
  1146     12  FILLER                      PIC X.
  1147*****************************************************************
  1148*                                COPY ELCCRTO.
  1149******************************************************************
  1150*                                                                *
  1151*                            ELCCRTO.                            *
  1152*                                                                *
  1153*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1154*                                                                *
  1155*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  22
* EL6311.cbl
  1156*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1157*                                                                *
  1158*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1159*                                                                *
  1160*   LOG = YES                                                    *
  1161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1162******************************************************************
  1163*                   C H A N G E   L O G
  1164*
  1165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1166*-----------------------------------------------------------------
  1167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1168* EFFECTIVE    NUMBER
  1169*-----------------------------------------------------------------
  1170* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1171* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1172* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1173* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1174******************************************************************
  1175 01  ORIGINAL-CERTIFICATE.
  1176     12  OC-RECORD-ID                      PIC XX.
  1177         88  VALID-OC-ID                      VALUE 'OC'.
  1178     12  OC-CONTROL-PRIMARY.
  1179         16  OC-COMPANY-CD                 PIC X.
  1180         16  OC-CARRIER                    PIC X.
  1181         16  OC-GROUPING                   PIC X(6).
  1182         16  OC-STATE                      PIC XX.
  1183         16  OC-ACCOUNT                    PIC X(10).
  1184         16  OC-CERT-EFF-DT                PIC XX.
  1185         16  OC-CERT-NO.
  1186             20  OC-CERT-PRIME             PIC X(10).
  1187             20  OC-CERT-SFX               PIC X.
  1188         16  OC-RECORD-TYPE                PIC X.
  1189         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1190     12  OC-LAST-MAINT-DT                  PIC XX.
  1191     12  OC-LAST-MAINT-BY                  PIC X(4).
  1192     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1193     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1194     12  FILLER                            PIC X(49).
  1195     12  OC-ORIG-REC.
  1196         16  OC-INS-LAST-NAME              PIC X(15).
  1197         16  OC-INS-FIRST-NAME             PIC X(10).
  1198         16  OC-INS-MIDDLE-INIT            PIC X.
  1199         16  OC-INS-AGE                    PIC S999     COMP-3.
  1200         16  OC-JNT-LAST-NAME              PIC X(15).
  1201         16  OC-JNT-FIRST-NAME             PIC X(10).
  1202         16  OC-JNT-MIDDLE-INIT            PIC X.
  1203         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1204         16  OC-LF-BENCD                   PIC XX.
  1205         16  OC-LF-TERM                    PIC S999      COMP-3.
  1206         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1207         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1208         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1209         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1210         16  OC-LF-EXP-DT                  PIC XX.
  1211         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1212         16  OC-LF-CANCEL-DT               PIC XX.
  1213         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  23
* EL6311.cbl
  1214         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1215         16  OC-AH-BENCD                   PIC XX.
  1216         16  OC-AH-TERM                    PIC S999      COMP-3.
  1217         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1218         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1219         16  OC-AH-EXP-DT                  PIC XX.
  1220         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1221         16  OC-AH-CP                      PIC 99.
  1222         16  OC-AH-CANCEL-DT               PIC XX.
  1223         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1224         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1225         16  OC-CRED-BENE-NAME             PIC X(25).
  1226         16  OC-1ST-PMT-DT                 PIC XX.
  1227         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1228         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1229         16  FILLER                        PIC X(213).
  1230
  1231     12  FILLER                            PIC X(50).
  1232******************************************************************
  1233*                                COPY ERCACCT.
  1234******************************************************************
  1235*                                                                *
  1236*                                                                *
  1237*                            ERCACCT                             *
  1238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1239*                            VMOD=2.031                          *
  1240*                                                                *
  1241*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1242*                                                                *
  1243*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1244*   VSAM ACCOUNT MASTER FILES.                                   *
  1245*                                                                *
  1246*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1247*                                                                *
  1248*   FILE TYPE = VSAM,KSDS                                        *
  1249*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1250*                                                                *
  1251*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1252*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1253*                                                                *
  1254*   LOG = NO                                                     *
  1255*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1256*                                                                *
  1257*                                                                *
  1258******************************************************************
  1259*                   C H A N G E   L O G
  1260*
  1261* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1262*-----------------------------------------------------------------
  1263*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1264* EFFECTIVE    NUMBER
  1265*-----------------------------------------------------------------
  1266* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1267* 092705    2005050300006  PEMA  ADD SPP LEASES
  1268* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1269* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1270* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1271* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  24
* EL6311.cbl
  1272* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1273******************************************************************
  1274
  1275 01  ACCOUNT-MASTER.
  1276     12  AM-RECORD-ID                      PIC XX.
  1277         88  VALID-AM-ID                      VALUE 'AM'.
  1278
  1279     12  AM-CONTROL-PRIMARY.
  1280         16  AM-COMPANY-CD                 PIC X.
  1281         16  AM-MSTR-CNTRL.
  1282             20  AM-CONTROL-A.
  1283                 24  AM-CARRIER            PIC X.
  1284                 24  AM-GROUPING.
  1285                     28 AM-GROUPING-PREFIX PIC XXX.
  1286                     28 AM-GROUPING-PRIME  PIC XXX.
  1287                 24  AM-STATE              PIC XX.
  1288                 24  AM-ACCOUNT.
  1289                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1290                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1291             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1292                                           PIC X(19).
  1293             20  AM-CNTRL-B.
  1294                 24  AM-EXPIRATION-DT      PIC XX.
  1295                 24  FILLER                PIC X(4).
  1296             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1297                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1298
  1299     12  AM-CONTROL-BY-VAR-GRP.
  1300         16  AM-COMPANY-CD-A1              PIC X.
  1301         16  AM-VG-CARRIER                 PIC X.
  1302         16  AM-VG-GROUPING                PIC X(6).
  1303         16  AM-VG-STATE                   PIC XX.
  1304         16  AM-VG-ACCOUNT                 PIC X(10).
  1305         16  AM-VG-DATE.
  1306             20  AM-VG-EXPIRATION-DT       PIC XX.
  1307             20  FILLER                    PIC X(4).
  1308         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1309                                           PIC 9(11)      COMP-3.
  1310     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1311         16  FILLER                        PIC X(10).
  1312         16  AM-VG-KEY3.
  1313             20  AM-VG3-ACCOUNT            PIC X(10).
  1314             20  AM-VG3-EXP-DT             PIC XX.
  1315         16  FILLER                        PIC X(4).
  1316     12  AM-MAINT-INFORMATION.
  1317         16  AM-LAST-MAINT-DT              PIC XX.
  1318         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1319         16  AM-LAST-MAINT-USER            PIC X(4).
  1320         16  FILLER                        PIC XX.
  1321
  1322     12  AM-EFFECTIVE-DT                   PIC XX.
  1323     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1324
  1325     12  AM-PREV-DATES  COMP-3.
  1326         16  AM-PREV-EXP-DT                PIC 9(11).
  1327         16  AM-PREV-EFF-DT                PIC 9(11).
  1328
  1329     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  25
* EL6311.cbl
  1330     12  AM-REPORT-CODE-2                  PIC X(10).
  1331
  1332     12  AM-CITY-CODE                      PIC X(4).
  1333     12  AM-COUNTY-PARISH                  PIC X(6).
  1334
  1335     12  AM-NAME                           PIC X(30).
  1336     12  AM-PERSON                         PIC X(30).
  1337     12  AM-ADDRS                          PIC X(30).
  1338     12  AM-CITY.
  1339         16  AM-ADDR-CITY                  PIC X(28).
  1340         16  AM-ADDR-STATE                 PIC XX.
  1341     12  AM-ZIP.
  1342         16  AM-ZIP-PRIME.
  1343             20  AM-ZIP-PRI-1ST            PIC X.
  1344                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1345             20  FILLER                    PIC X(4).
  1346         16  AM-ZIP-PLUS4                  PIC X(4).
  1347     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1348         16  AM-CAN-POSTAL-1               PIC XXX.
  1349         16  AM-CAN-POSTAL-2               PIC XXX.
  1350         16  FILLER                        PIC XXX.
  1351     12  AM-TEL-NO.
  1352         16  AM-AREA-CODE                  PIC 999.
  1353         16  AM-TEL-PRE                    PIC 999.
  1354         16  AM-TEL-NBR                    PIC 9(4).
  1355     12  AM-TEL-LOC                        PIC X.
  1356         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1357         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1358
  1359     12  AM-COMM-STRUCTURE.
  1360         16  AM-DEFN-1.
  1361             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1362                 24  AM-AGT.
  1363                     28  AM-AGT-PREFIX     PIC X(4).
  1364                     28  AM-AGT-PRIME      PIC X(6).
  1365                 24  AM-COM-TYP            PIC X.
  1366                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1367                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1368                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1369                 24  AM-RECALC-LV-INDIC    PIC X.
  1370                 24  AM-RETRO-LV-INDIC     PIC X.
  1371                 24  AM-GL-CODES           PIC X.
  1372                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1373                 24  FILLER                PIC X(01).
  1374         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1375             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1376                 24  FILLER                PIC X(11).
  1377                 24  AM-L-COMA             PIC XXX.
  1378                 24  AM-J-COMA             PIC XXX.
  1379                 24  AM-A-COMA             PIC XXX.
  1380                 24  FILLER                PIC X(6).
  1381
  1382     12  AM-COMM-CHANGE-STATUS             PIC X.
  1383         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1384
  1385     12  AM-CSR-CODE                       PIC X(4).
  1386
  1387     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  26
* EL6311.cbl
  1388         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1389         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1390     12  AM-AUTO-REFUND-SW                 PIC X.
  1391         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1392         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1393     12  AM-GPCD                           PIC 99.
  1394     12  AM-IG                             PIC X.
  1395         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1396         88  AM-HAS-GROUP                     VALUE '2'.
  1397     12  AM-STATUS                         PIC X.
  1398         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1399         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1400         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1401         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1402         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1403         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1404     12  AM-REMIT-TO                       PIC 99.
  1405     12  AM-ID-NO                          PIC X(11).
  1406
  1407     12  AM-CAL-TABLE                      PIC XX.
  1408     12  AM-LF-DEVIATION                   PIC XXX.
  1409     12  AM-AH-DEVIATION                   PIC XXX.
  1410     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1411     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1412     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1413     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1414     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1415     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1416
  1417     12  AM-USER-FIELDS.
  1418         16  AM-FLD-1                      PIC XX.
  1419         16  AM-FLD-2                      PIC XX.
  1420         16  AM-FLD-3                      PIC XX.
  1421         16  AM-FLD-4                      PIC XX.
  1422         16  AM-FLD-5                      PIC XX.
  1423
  1424     12  AM-1ST-PROD-DATE.
  1425         16  AM-1ST-PROD-YR                PIC XX.
  1426         16  AM-1ST-PROD-MO                PIC XX.
  1427         16  AM-1ST-PROD-DA                PIC XX.
  1428     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1429     12  AM-CERTS-PURGED-DATE.
  1430         16  AM-PUR-YR                     PIC XX.
  1431         16  AM-PUR-MO                     PIC XX.
  1432         16  AM-PUR-DA                     PIC XX.
  1433     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1434     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1435     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1436     12  AM-INACTIVE-DATE.
  1437         16  AM-INA-MO                     PIC 99.
  1438         16  AM-INA-DA                     PIC 99.
  1439         16  AM-INA-YR                     PIC 99.
  1440     12  AM-AR-HI-CERT-DATE                PIC XX.
  1441
  1442     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1443     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1444
  1445     12  AM-OB-PAYMENT-MODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  27
* EL6311.cbl
  1446         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1447         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1448         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1449         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1450
  1451     12  AM-AH-ONLY-INDICATOR              PIC X.
  1452         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1453         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1454
  1455     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1456
  1457     12  AM-OVER-SHORT.
  1458         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1459         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1460
  1461     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1462     12  AM-DCC-CLP-STATE                  PIC XX.
  1463
  1464     12  AM-RECALC-COMM                    PIC X.
  1465     12  AM-RECALC-REIN                    PIC X.
  1466
  1467     12  AM-REI-TABLE                      PIC XXX.
  1468     12  AM-REI-ET-LF                      PIC X.
  1469     12  AM-REI-ET-AH                      PIC X.
  1470     12  AM-REI-PE-LF                      PIC X.
  1471     12  AM-REI-PE-AH                      PIC X.
  1472     12  AM-REI-PRT-ST                     PIC X.
  1473     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1474     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1475     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1476     12  AM-REI-GROUP-A                    PIC X(6).
  1477     12  AM-REI-MORT                       PIC X(4).
  1478     12  AM-REI-PRT-OW                     PIC X.
  1479     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1480     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1481     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1482     12  AM-REI-GROUP-B                    PIC X(6).
  1483
  1484     12  AM-TRUST-TYPE                     PIC X(2).
  1485
  1486     12  AM-EMPLOYER-STMT-USED             PIC X.
  1487     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1488
  1489     12  AM-STD-AH-TYPE                    PIC XX.
  1490     12  AM-EARN-METHODS.
  1491         16  AM-EARN-METHOD-R              PIC X.
  1492             88 AM-REF-RL-R78                 VALUE 'R'.
  1493             88 AM-REF-RL-PR                  VALUE 'P'.
  1494             88 AM-REF-RL-MEAN                VALUE 'M'.
  1495             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1496         16  AM-EARN-METHOD-L              PIC X.
  1497             88 AM-REF-LL-R78                 VALUE 'R'.
  1498             88 AM-REF-LL-PR                  VALUE 'P'.
  1499             88 AM-REF-LL-MEAN                VALUE 'M'.
  1500             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1501         16  AM-EARN-METHOD-A              PIC X.
  1502             88 AM-REF-AH-R78                 VALUE 'R'.
  1503             88 AM-REF-AH-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  28
* EL6311.cbl
  1504             88 AM-REF-AH-MEAN                VALUE 'M'.
  1505             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1506             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1507             88 AM-REF-AH-NET                 VALUE 'N'.
  1508
  1509     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1510     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1511     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1512
  1513     12  AM-RET-Y-N                        PIC X.
  1514     12  AM-RET-P-E                        PIC X.
  1515     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1516     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1517     12  AM-RET-GRP                        PIC X(6).
  1518     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1519         16  AM-POOL-PRIME                 PIC XXX.
  1520         16  AM-POOL-SUB                   PIC XXX.
  1521     12  AM-RETRO-EARNINGS.
  1522         16  AM-RET-EARN-R                 PIC X.
  1523         16  AM-RET-EARN-L                 PIC X.
  1524         16  AM-RET-EARN-A                 PIC X.
  1525     12  AM-RET-ST-TAX-USE                 PIC X.
  1526         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1527         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1528     12  AM-RETRO-BEG-EARNINGS.
  1529         16  AM-RET-BEG-EARN-R             PIC X.
  1530         16  AM-RET-BEG-EARN-L             PIC X.
  1531         16  AM-RET-BEG-EARN-A             PIC X.
  1532     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1533     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1534
  1535     12  AM-USER-SELECT-OPTIONS.
  1536         16  AM-USER-SELECT-1              PIC X(10).
  1537         16  AM-USER-SELECT-2              PIC X(10).
  1538         16  AM-USER-SELECT-3              PIC X(10).
  1539         16  AM-USER-SELECT-4              PIC X(10).
  1540         16  AM-USER-SELECT-5              PIC X(10).
  1541
  1542     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1543
  1544     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1545
  1546     12  AM-RPT045A-SWITCH                 PIC X.
  1547         88  RPT045A-OFF                   VALUE 'N'.
  1548
  1549     12  AM-INSURANCE-LIMITS.
  1550         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1551         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1552
  1553     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1554         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1555
  1556     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1557         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1558         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1559
  1560     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1561
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  29
* EL6311.cbl
  1562     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1563     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1564     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1565     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1566     12  AM-DCC-UEF-STATE                  PIC XX.
  1567     12  FILLER                            PIC XXX.
  1568     12  AM-REPORT-CODE-3                  PIC X(10).
  1569*    12  FILLER                            PIC X(22).
  1570
  1571     12  AM-RESERVE-DATE.
  1572         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1573         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1574         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1575
  1576     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1577     12  AM-NOTIFICATION-TYPES.
  1578         16  AM-NOTIF-OF-LETTERS           PIC X.
  1579         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1580         16  AM-NOTIF-OF-REPORTS           PIC X.
  1581         16  AM-NOTIF-OF-STATUS            PIC X.
  1582
  1583     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1584         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1585         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1586         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1587         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1588
  1589     12  AM-BENEFIT-CONTROLS.
  1590         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1591             20  AM-BENEFIT-CODE           PIC XX.
  1592             20  AM-BENEFIT-TYPE           PIC X.
  1593             20  AM-BENEFIT-REVISION       PIC XXX.
  1594             20  AM-BENEFIT-REM-TERM       PIC X.
  1595             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1596             20  FILLER                    PIC XX.
  1597         16  FILLER                        PIC X(80).
  1598
  1599     12  AM-TRANSFER-DATA.
  1600         16  AM-TRANSFERRED-FROM.
  1601             20  AM-TRNFROM-CARRIER        PIC X.
  1602             20  AM-TRNFROM-GROUPING.
  1603                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1604                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1605             20  AM-TRNFROM-STATE          PIC XX.
  1606             20  AM-TRNFROM-ACCOUNT.
  1607                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1608                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1609             20  AM-TRNFROM-DTE            PIC XX.
  1610         16  AM-TRANSFERRED-TO.
  1611             20  AM-TRNTO-CARRIER          PIC X.
  1612             20  AM-TRNTO-GROUPING.
  1613                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1614                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1615             20  AM-TRNTO-STATE            PIC XX.
  1616             20  AM-TRNTO-ACCOUNT.
  1617                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1618                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1619             20  AM-TRNTO-DTE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  30
* EL6311.cbl
  1620         16  FILLER                        PIC X(10).
  1621
  1622     12  AM-SAVED-REMIT-TO                 PIC 99.
  1623
  1624     12  AM-COMM-STRUCTURE-SAVED.
  1625         16  AM-DEFN-1-SAVED.
  1626             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1627                 24  AM-AGT-SV             PIC X(10).
  1628                 24  AM-COM-TYP-SV         PIC X.
  1629                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1630                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1631                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1632                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1633                 24  FILLER                PIC X.
  1634                 24  AM-GL-CODES-SV        PIC X.
  1635                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1636                 24  FILLER                PIC X.
  1637         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1638             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1639                 24  FILLER                PIC X(11).
  1640                 24  AM-L-COMA-SV          PIC XXX.
  1641                 24  AM-J-COMA-SV          PIC XXX.
  1642                 24  AM-A-COMA-SV          PIC XXX.
  1643                 24  FILLER                PIC X(6).
  1644
  1645     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1646         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1647            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1648            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1649            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1650
  1651     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1652     12  FILLER                            PIC X(120).
  1653
  1654     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1655         16  AM-CONTROL-NAME               PIC X(30).
  1656         16  AM-EXECUTIVE-ONE.
  1657             20  AM-EXEC1-NAME             PIC X(15).
  1658             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1659                                                          COMP-3.
  1660             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1661                                                          COMP-3.
  1662         16  AM-EXECUTIVE-TWO.
  1663             20  AM-EXEC2-NAME             PIC X(15).
  1664             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1665                                                          COMP-3.
  1666             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1667                                                          COMP-3.
  1668
  1669     12  AM-RETRO-ADDITIONAL-DATA.
  1670         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1671         16  AM-RETRO-PREM-P-E             PIC X.
  1672         16  AM-RETRO-CLMS-P-I             PIC X.
  1673         16  AM-RETRO-RET-BRACKET-LF.
  1674             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1675                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1676                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1677             20  AM-RETRO-RET-BASIS-LF     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  31
* EL6311.cbl
  1678                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1679                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1680             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1681                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1682                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1683         16  AM-RETRO-RET-BRACKET-AH.
  1684             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1685                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1686                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1687                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1688             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1689                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1690                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1691             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1692                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1693                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1694
  1695     12  AM-COMMENTS.
  1696         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1697
  1698     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1699         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1700         16  AM-FLI-BILLING-CODE           PIC X.
  1701         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1702         16  AM-FLI-UNITED-IDENT           PIC X.
  1703         16  AM-FLI-INTEREST-LOST-DATA.
  1704             20  AM-FLI-BANK-NO            PIC X(5).
  1705             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1706             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1707             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1708         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1709             20  AM-FLI-AGT                PIC X(9).
  1710             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1711             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1712         16  FILLER                        PIC X(102).
  1713
  1714     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1715         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1716             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1717             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1718             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1719             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1720             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1721         16  FILLER                          PIC X(10).
  1722******************************************************************
  1723*                                COPY ELCVADS.
  1724******************************************************************
  1725*                                                                *
  1726*                                                                *
  1727*                            ELCVADS.                            *
  1728*                                                                *
  1729*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1730*   ELVADS                  LENGTH = 350                         *
  1731******************************************************************
  1732******************************************************************
  1733*                   C H A N G E   L O G
  1734*
  1735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  32
* EL6311.cbl
  1736*-----------------------------------------------------------------
  1737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1738* EFFECTIVE    NUMBER
  1739*-----------------------------------------------------------------
  1740* 100111    2011022800001  AJRA  NAPERSOFT
  1741******************************************************************
  1742
  1743 01  VIRGINIA-DISCLOSURE.
  1744     12  VD-COMPANY-CD              PIC X.
  1745     12  VD-CARRIER                 PIC X.
  1746     12  VD-GROUPING.
  1747         20  VD-GROUPING-PREFIX     PIC XXX.
  1748         20  VD-GROUPING-PRIME      PIC XXX.
  1749     12  VD-STATE                   PIC XX.
  1750     12  VD-ACCOUNT.
  1751         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1752         20  VD-ACCOUNT-PRIME       PIC X(6).
  1753     12  VD-CERT-EFF-DT             PIC XX.
  1754     12  VD-CERT-NO.
  1755         20  VD-CERT-PRIME          PIC X(10).
  1756         20  VD-CERT-SFX            PIC X.
  1757     12  VD-ENTRY-BATCH             PIC X(6).
  1758     12  VD-CSR-ID                  PIC X(4).
  1759     12  VD-NAME.
  1760         20  VD-INSURED-LAST-NAME   PIC X(15).
  1761         20  VD-INSURED-FIRST-NAME.
  1762             24  VD-INSURED-1ST-INIT PIC X.
  1763             24  FILLER             PIC X(9).
  1764         20  VD-INSURED-MIDDLE-INIT PIC X.
  1765     12  VD-JOINT-INSURED.
  1766         20 VD-JOINT-LAST-NAME      PIC X(15).
  1767         20 VD-JOINT-FIRST-NAME.
  1768            24  VD-JOINT-FIRST-INIT PIC X.
  1769            24  FILLER              PIC X(9).
  1770         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1771     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1772     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1773     12  VD-INSURED-CITY-STATE.
  1774         20  VD-INSURED-CITY        PIC X(28).
  1775         20  VD-INSURED-STATE       PIC XX.
  1776     12  VD-INSURED-ZIP-CODE.
  1777         20  VD-INSURED-ZIP-PRIME.
  1778             24  VD-INSURED-ZIP-1   PIC X.
  1779                 88  VD-CANADIAN-POST-CODE
  1780                                       VALUE 'A' THRU 'Z'.
  1781             24  FILLER             PIC X(4).
  1782         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1783     12  VD-BENEFICIARY-NAME        PIC X(30).
  1784     12  VD-ACCOUNT-NAME            PIC X(30).
  1785     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1786     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1787     12  VD-1ST-PMT-DT              PIC XX.
  1788     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1789         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1790         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1791                                             '90' THRU '99'.
  1792     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1793                                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  33
* EL6311.cbl
  1794     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1795     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1796     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1797     12  VD-LF-TERM                 PIC S999   COMP-3.
  1798     12  VD-AH-BENEFIT-CD           PIC XX.
  1799         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1800         88  VD-INVALID-AH             VALUE '  ' '00'
  1801                                             '90' THRU '99'.
  1802     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1803     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1804     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1805     12  VD-AH-TERM                 PIC S999   COMP-3.
  1806     12  VD-LETTER-ID               PIC X(4).
  1807     12  VD-PROC-ID                 PIC X(4).
  1808     12  VD-COMP-ID                 PIC X(3).
  1809     12  VD-CURRENT-DATE            PIC XX.
  1810     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1811     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1812     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  34
* EL6311.cbl
  1814*    COPY ELCDATE.
  1815******************************************************************
  1816*                                                                *
  1817*                                                                *
  1818*                            ELCDATE.                            *
  1819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1820*                            VMOD=2.003
  1821*                                                                *
  1822*                                                                *
  1823*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1824*                 LENGTH = 200                                   *
  1825******************************************************************
  1826
  1827 01  DATE-CONVERSION-DATA.
  1828     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1829     12  DC-OPTION-CODE                PIC X.
  1830         88  BIN-TO-GREG                VALUE ' '.
  1831         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1832         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1833         88  YMD-GREG-TO-BIN            VALUE '3'.
  1834         88  MDY-GREG-TO-BIN            VALUE '4'.
  1835         88  JULIAN-TO-BIN              VALUE '5'.
  1836         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1837         88  FIND-CENTURY               VALUE '7'.
  1838         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1839         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1840         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1841         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1842         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1843         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1844         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1845         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1846         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1847         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1848         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1849         88  BIN-3-TO-GREG              VALUE 'I'.
  1850         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1851         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1852         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1853         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1854         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1855         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1856         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1857         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1858         88  THREE-CHARACTER-BIN
  1859                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1860         88  GREGORIAN-TO-BIN
  1861                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1862         88  BIN-TO-GREGORIAN
  1863                  VALUES ' ' '1' 'I' '8' 'G'.
  1864         88  JULIAN-TO-BINARY
  1865                  VALUES '5' 'C' 'E' 'F'.
  1866     12  DC-ERROR-CODE                 PIC X.
  1867         88  NO-CONVERSION-ERROR        VALUE ' '.
  1868         88  DATE-CONVERSION-ERROR
  1869                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1870         88  DATE-IS-ZERO               VALUE '1'.
  1871         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  35
* EL6311.cbl
  1872         88  DATE-IS-INVALID            VALUE '3'.
  1873         88  DATE1-GREATER-DATE2        VALUE '4'.
  1874         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1875         88  DATE-INVALID-OPTION        VALUE '9'.
  1876         88  INVALID-CENTURY            VALUE 'A'.
  1877         88  ONLY-CENTURY               VALUE 'B'.
  1878         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1879         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1880     12  DC-END-OF-MONTH               PIC X.
  1881         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1882     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1883         88  USE-NORMAL-PROCESS         VALUE ' '.
  1884         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1885         88  ADJUST-UP-100-YRS          VALUE '2'.
  1886     12  FILLER                        PIC X.
  1887     12  DC-CONVERSION-DATES.
  1888         16  DC-BIN-DATE-1             PIC XX.
  1889         16  DC-BIN-DATE-2             PIC XX.
  1890         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1891         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1892                       DC-GREG-DATE-1-EDIT.
  1893             20  DC-EDIT1-MONTH        PIC 99.
  1894             20  SLASH1-1              PIC X.
  1895             20  DC-EDIT1-DAY          PIC 99.
  1896             20  SLASH1-2              PIC X.
  1897             20  DC-EDIT1-YEAR         PIC 99.
  1898         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1899         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1900                     DC-GREG-DATE-2-EDIT.
  1901             20  DC-EDIT2-MONTH        PIC 99.
  1902             20  SLASH2-1              PIC X.
  1903             20  DC-EDIT2-DAY          PIC 99.
  1904             20  SLASH2-2              PIC X.
  1905             20  DC-EDIT2-YEAR         PIC 99.
  1906         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1907         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1908                     DC-GREG-DATE-1-YMD.
  1909             20  DC-YMD-YEAR           PIC 99.
  1910             20  DC-YMD-MONTH          PIC 99.
  1911             20  DC-YMD-DAY            PIC 99.
  1912         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1913         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1914                      DC-GREG-DATE-1-MDY.
  1915             20  DC-MDY-MONTH          PIC 99.
  1916             20  DC-MDY-DAY            PIC 99.
  1917             20  DC-MDY-YEAR           PIC 99.
  1918         16  DC-GREG-DATE-1-ALPHA.
  1919             20  DC-ALPHA-MONTH        PIC X(10).
  1920             20  DC-ALPHA-DAY          PIC 99.
  1921             20  FILLER                PIC XX.
  1922             20  DC-ALPHA-CENTURY.
  1923                 24 DC-ALPHA-CEN-N     PIC 99.
  1924             20  DC-ALPHA-YEAR         PIC 99.
  1925         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1926         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1927         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1928         16  DC-JULIAN-DATE            PIC 9(05).
  1929         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  36
* EL6311.cbl
  1930                                       PIC 9(05).
  1931         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1932             20  DC-JULIAN-YEAR        PIC 99.
  1933             20  DC-JULIAN-DAYS        PIC 999.
  1934         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1935         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1936         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1937     12  DATE-CONVERSION-VARIBLES.
  1938         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1939         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1940             20  FILLER                PIC 9(3).
  1941             20  HOLD-CEN-1-CCYY.
  1942                 24  HOLD-CEN-1-CC     PIC 99.
  1943                 24  HOLD-CEN-1-YY     PIC 99.
  1944             20  HOLD-CEN-1-MO         PIC 99.
  1945             20  HOLD-CEN-1-DA         PIC 99.
  1946         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1947             20  HOLD-CEN-1-R-MO       PIC 99.
  1948             20  HOLD-CEN-1-R-DA       PIC 99.
  1949             20  HOLD-CEN-1-R-CCYY.
  1950                 24  HOLD-CEN-1-R-CC   PIC 99.
  1951                 24  HOLD-CEN-1-R-YY   PIC 99.
  1952             20  FILLER                PIC 9(3).
  1953         16  HOLD-CENTURY-1-X.
  1954             20  FILLER                PIC X(3)  VALUE SPACES.
  1955             20  HOLD-CEN-1-X-CCYY.
  1956                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1957                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1958             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1959             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1960         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1961             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1962             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1963             20  HOLD-CEN-1-R-X-CCYY.
  1964                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1965                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1966             20  FILLER                PIC XXX.
  1967         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1968         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1969         16  DC-JULIAN-DATE-1          PIC 9(07).
  1970         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1971             20  DC-JULIAN-1-CCYY.
  1972                 24  DC-JULIAN-1-CC    PIC 99.
  1973                 24  DC-JULIAN-1-YR    PIC 99.
  1974             20  DC-JULIAN-DA-1        PIC 999.
  1975         16  DC-JULIAN-DATE-2          PIC 9(07).
  1976         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1977             20  DC-JULIAN-2-CCYY.
  1978                 24  DC-JULIAN-2-CC    PIC 99.
  1979                 24  DC-JULIAN-2-YR    PIC 99.
  1980             20  DC-JULIAN-DA-2        PIC 999.
  1981         16  DC-GREG-DATE-A-EDIT.
  1982             20  DC-EDITA-MONTH        PIC 99.
  1983             20  SLASHA-1              PIC X VALUE '/'.
  1984             20  DC-EDITA-DAY          PIC 99.
  1985             20  SLASHA-2              PIC X VALUE '/'.
  1986             20  DC-EDITA-CCYY.
  1987                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  37
* EL6311.cbl
  1988                 24  DC-EDITA-YEAR     PIC 99.
  1989         16  DC-GREG-DATE-B-EDIT.
  1990             20  DC-EDITB-MONTH        PIC 99.
  1991             20  SLASHB-1              PIC X VALUE '/'.
  1992             20  DC-EDITB-DAY          PIC 99.
  1993             20  SLASHB-2              PIC X VALUE '/'.
  1994             20  DC-EDITB-CCYY.
  1995                 24  DC-EDITB-CENT     PIC 99.
  1996                 24  DC-EDITB-YEAR     PIC 99.
  1997         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1998         16  DC-GREG-DATE-CYMD-R REDEFINES
  1999                              DC-GREG-DATE-CYMD.
  2000             20  DC-CYMD-CEN           PIC 99.
  2001             20  DC-CYMD-YEAR          PIC 99.
  2002             20  DC-CYMD-MONTH         PIC 99.
  2003             20  DC-CYMD-DAY           PIC 99.
  2004         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2005         16  DC-GREG-DATE-MDCY-R REDEFINES
  2006                              DC-GREG-DATE-MDCY.
  2007             20  DC-MDCY-MONTH         PIC 99.
  2008             20  DC-MDCY-DAY           PIC 99.
  2009             20  DC-MDCY-CEN           PIC 99.
  2010             20  DC-MDCY-YEAR          PIC 99.
  2011    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2012        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2013    12  DC-EL310-DATE                  PIC X(21).
  2014    12  FILLER                         PIC X(28).
  2015
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  38
* EL6311.cbl
  2017*    COPY ELCLOGOF.
  2018******************************************************************
  2019*                                                                *
  2020*                                                                *
  2021*                            ELCLOGOF.                           *
  2022*                            VMOD=2.001                          *
  2023*                                                                *
  2024*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2025*                                                                *
  2026******************************************************************
  2027 01  CLASIC-LOGOFF.
  2028     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2029     12  LOGOFF-TEXT.
  2030         16  FILLER          PIC X(5)    VALUE SPACES.
  2031         16  LOGOFF-MSG.
  2032             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2033             20  FILLER      PIC X       VALUE SPACES.
  2034             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2035         16  FILLER          PIC X(80)
  2036           VALUE '* YOU ARE NOW LOGGED OFF'.
  2037         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2038         16  FILLER          PIC X       VALUE QUOTE.
  2039         16  LOGOFF-SYS-MSG  PIC X(17)
  2040           VALUE 'S CLAS-IC SYSTEM '.
  2041     12  TEXT-MESSAGES.
  2042         16  UNACCESS-MSG    PIC X(29)
  2043             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2044         16  PGMIDERR-MSG    PIC X(17)
  2045             VALUE 'PROGRAM NOT FOUND'.
  2046
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  39
* EL6311.cbl
  2048*    COPY ELCATTR.
  2049******************************************************************
  2050*                                                                *
  2051*                            ELCATTR.                            *
  2052*                            VMOD=2.001                          *
  2053*                                                                *
  2054*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2055*                                                                *
  2056*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2057*                                                                *
  2058*                   POS 1   P=PROTECTED                          *
  2059*                           U=UNPROTECTED                        *
  2060*                           S=ASKIP                              *
  2061*                   POS 2   A=ALPHA/NUMERIC                      *
  2062*                           N=NUMERIC                            *
  2063*                   POS 3   N=NORMAL                             *
  2064*                           B=BRIGHT                             *
  2065*                           D=DARK                               *
  2066*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2067*                           OF=MODIFIED DATA TAG OFF             *
  2068*                                                                *
  2069*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2070******************************************************************
  2071 01  ATTRIBUTE-LIST.
  2072     12  AL-PABOF            PIC X       VALUE 'Y'.
  2073     12  AL-PABON            PIC X       VALUE 'Z'.
  2074     12  AL-PADOF            PIC X       VALUE '%'.
  2075     12  AL-PADON            PIC X       VALUE '_'.
  2076     12  AL-PANOF            PIC X       VALUE '-'.
  2077     12  AL-PANON            PIC X       VALUE '/'.
  2078     12  AL-SABOF            PIC X       VALUE '8'.
  2079     12  AL-SABON            PIC X       VALUE '9'.
  2080     12  AL-SADOF            PIC X       VALUE '@'.
  2081     12  AL-SADON            PIC X       VALUE QUOTE.
  2082     12  AL-SANOF            PIC X       VALUE '0'.
  2083     12  AL-SANON            PIC X       VALUE '1'.
  2084     12  AL-UABOF            PIC X       VALUE 'H'.
  2085     12  AL-UABON            PIC X       VALUE 'I'.
  2086     12  AL-UADOF            PIC X       VALUE '<'.
  2087     12  AL-UADON            PIC X       VALUE '('.
  2088     12  AL-UANOF            PIC X       VALUE ' '.
  2089     12  AL-UANON            PIC X       VALUE 'A'.
  2090     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2091     12  AL-UNBON            PIC X       VALUE 'R'.
  2092     12  AL-UNDOF            PIC X       VALUE '*'.
  2093     12  AL-UNDON            PIC X       VALUE ')'.
  2094     12  AL-UNNOF            PIC X       VALUE '&'.
  2095     12  AL-UNNON            PIC X       VALUE 'J'.
  2096
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  40
* EL6311.cbl
  2098*    COPY ELCEMIB.
  2099******************************************************************
  2100*                                                                *
  2101*                                                                *
  2102*                            ELCEMIB.                            *
  2103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2104*                            VMOD=2.005                          *
  2105*                                                                *
  2106*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2107*                                                                *
  2108******************************************************************
  2109 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2110     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2111     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2112     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2113     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2114     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2115     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2116     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2117     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2118     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2119         88  EMI-NO-ERRORS                    VALUE '1'.
  2120         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2121         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2122     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2123         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2124     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2125         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2126         88  EMI-AREA1-FULL                   VALUE '2'.
  2127     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2128         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2129         88  EMI-AREA2-FULL                   VALUE '2'.
  2130     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2131         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2132         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2133         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2134         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2135         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2136     12  EMI-ERROR-LINES.
  2137         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2138         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2139         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2140         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2141             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2142                 24  EMI-ERR-NUM         PIC X(4).
  2143                 24  EMI-FILLER          PIC X.
  2144                 24  EMI-SEV             PIC X.
  2145                 24  FILLER              PIC X.
  2146             20  FILLER                  PIC X(02).
  2147     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2148         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2149             20  EMI-ERROR-NUMBER    PIC X(4).
  2150             20  EMI-FILL            PIC X.
  2151             20  EMI-SEVERITY        PIC X.
  2152             20  FILLER              PIC X.
  2153             20  EMI-ERROR-TEXT.
  2154                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2155                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  41
* EL6311.cbl
  2156     12  EMI-SEVERITY-SAVE           PIC X.
  2157         88  EMI-NOTE                    VALUE 'N'.
  2158         88  EMI-WARNING                 VALUE 'W'.
  2159         88  EMI-FORCABLE                VALUE 'F'.
  2160         88  EMI-FATAL                   VALUE 'X'.
  2161     12  EMI-MESSAGE-FLAG            PIC X.
  2162         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2163         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2164     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2165     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2166         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2167         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2168         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2169     12  FILLER                      PIC X(137)  VALUE SPACES.
  2170     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2171     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2172     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2173     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2174
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  42
* EL6311.cbl
  2176*    COPY ELCINTF.
  2177******************************************************************
  2178*                                                                *
  2179*                                                                *
  2180*                            ELCINTF.                            *
  2181*                            VMOD=2.017                          *
  2182*                                                                *
  2183*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2184*                                                                *
  2185*       LENGTH = 1024                                            *
  2186*                                                                *
  2187******************************************************************
  2188*                   C H A N G E   L O G
  2189*
  2190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2191*-----------------------------------------------------------------
  2192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2193* EFFECTIVE    NUMBER
  2194*-----------------------------------------------------------------
  2195* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2196******************************************************************
  2197 01  PROGRAM-INTERFACE-BLOCK.
  2198     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2199     12  PI-CALLING-PROGRAM              PIC X(8).
  2200     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2201     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2202     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2203     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2204     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2205     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2206     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2207     12  PI-COMPANY-ID                   PIC XXX.
  2208     12  PI-COMPANY-CD                   PIC X.
  2209
  2210     12  PI-COMPANY-PASSWORD             PIC X(8).
  2211
  2212     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2213
  2214     12  PI-CONTROL-IN-PROGRESS.
  2215         16  PI-CARRIER                  PIC X.
  2216         16  PI-GROUPING                 PIC X(6).
  2217         16  PI-STATE                    PIC XX.
  2218         16  PI-ACCOUNT                  PIC X(10).
  2219         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2220                                         PIC X(10).
  2221         16  PI-CLAIM-CERT-GRP.
  2222             20  PI-CLAIM-NO             PIC X(7).
  2223             20  PI-CERT-NO.
  2224                 25  PI-CERT-PRIME       PIC X(10).
  2225                 25  PI-CERT-SFX         PIC X.
  2226             20  PI-CERT-EFF-DT          PIC XX.
  2227         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2228             20  PI-PLAN-CODE            PIC X(2).
  2229             20  PI-REVISION-NUMBER      PIC X(3).
  2230             20  PI-PLAN-EFF-DT          PIC X(2).
  2231             20  PI-PLAN-EXP-DT          PIC X(2).
  2232             20  FILLER                  PIC X(11).
  2233         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  43
* EL6311.cbl
  2234             20  PI-OE-REFERENCE-1.
  2235                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2236                 25  PI-OE-REF-1-SUFF    PIC XX.
  2237
  2238     12  PI-SESSION-IN-PROGRESS          PIC X.
  2239         88  CLAIM-SESSION                   VALUE '1'.
  2240         88  CREDIT-SESSION                  VALUE '2'.
  2241         88  WARRANTY-SESSION                VALUE '3'.
  2242         88  MORTGAGE-SESSION                VALUE '4'.
  2243         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2244
  2245
  2246*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2247
  2248     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2249     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2250
  2251     12  PI-CREDIT-USER                  PIC X.
  2252         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2253         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2254
  2255     12  PI-CLAIM-USER                   PIC X.
  2256         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2257         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2258
  2259     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2260         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2261         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2262         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2263         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2264         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2265
  2266     12  PI-PROCESSOR-ID                 PIC X(4).
  2267
  2268     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2269
  2270     12  PI-MEMBER-CAPTION               PIC X(10).
  2271
  2272     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2273         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2274
  2275     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2276     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2277     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2278     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2279
  2280     12  PI-AH-OVERRIDE-L1               PIC X.
  2281     12  PI-AH-OVERRIDE-L2               PIC XX.
  2282     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2283     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2284
  2285     12  PI-NEW-SYSTEM                   PIC X(2).
  2286
  2287     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2288     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2289         88  PI-USES-PAID-TO                 VALUE '1'.
  2290     12  PI-CRDTCRD-SYSTEM.
  2291         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  44
* EL6311.cbl
  2292             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2293             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2294         16  PI-CC-MONTH-END-DT          PIC XX.
  2295     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2296
  2297     12  PI-OE-REFERENCE-2.
  2298         16  PI-OE-REF-2-PRIME           PIC X(10).
  2299         16  PI-OE-REF-2-SUFF            PIC X.
  2300
  2301     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2302
  2303     12  PI-LANGUAGE-TYPE                PIC X.
  2304             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2305             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2306             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2307
  2308     12  PI-POLICY-LINKAGE-IND           PIC X.
  2309         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2310         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2311                                                   LOW-VALUES.
  2312
  2313     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2314     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2315         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2316         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2317
  2318     12  PI-PROCESSOR-CSR-IND            PIC X.
  2319         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2320         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2321
  2322     12  FILLER                          PIC X(3).
  2323
  2324     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2325
  2326     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2327         PI-SYSTEM-LEVEL.
  2328
  2329         16  PI-ENTRY-CODES.
  2330             20  PI-ENTRY-CD-1           PIC X.
  2331             20  PI-ENTRY-CD-2           PIC X.
  2332
  2333         16  PI-RETURN-CODES.
  2334             20  PI-RETURN-CD-1          PIC X.
  2335             20  PI-RETURN-CD-2          PIC X.
  2336
  2337         16  PI-UPDATE-STATUS-SAVE.
  2338             20  PI-UPDATE-BY            PIC X(4).
  2339             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2340
  2341         16  PI-LOWER-CASE-LETTERS       PIC X.
  2342             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2343
  2344*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2345*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2346*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2347
  2348         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2349             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  45
* EL6311.cbl
  2350             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2351             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2352             88  ACCNT-CNTL                  VALUE '3'.
  2353             88  CARR-ACCNT-CNTL             VALUE '4'.
  2354
  2355         16  PI-PROCESSOR-CAP-LIST.
  2356             20  PI-SYSTEM-CONTROLS.
  2357                24 PI-SYSTEM-DISPLAY     PIC X.
  2358                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2359                24 PI-SYSTEM-MODIFY      PIC X.
  2360                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2361             20  FILLER                  PIC XX.
  2362             20  PI-DISPLAY-CAP          PIC X.
  2363                 88  DISPLAY-CAP             VALUE 'Y'.
  2364             20  PI-MODIFY-CAP           PIC X.
  2365                 88  MODIFY-CAP              VALUE 'Y'.
  2366             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2367                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2368             20  PI-FORCE-CAP            PIC X.
  2369                 88  FORCE-CAP               VALUE 'Y'.
  2370
  2371         16  PI-PROGRAM-CONTROLS.
  2372             20  PI-PGM-PRINT-OPT        PIC X.
  2373             20  PI-PGM-FORMAT-OPT       PIC X.
  2374             20  PI-PGM-PROCESS-OPT      PIC X.
  2375             20  PI-PGM-TOTALS-OPT       PIC X.
  2376
  2377         16  PI-HELP-INTERFACE.
  2378             20  PI-LAST-ERROR-NO        PIC X(4).
  2379             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2380
  2381         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2382             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2383
  2384         16  PI-CR-CONTROL-IN-PROGRESS.
  2385             20  PI-CR-CARRIER           PIC X.
  2386             20  PI-CR-GROUPING          PIC X(6).
  2387             20  PI-CR-STATE             PIC XX.
  2388             20  PI-CR-ACCOUNT           PIC X(10).
  2389             20  PI-CR-FIN-RESP          PIC X(10).
  2390             20  PI-CR-TYPE              PIC X.
  2391
  2392         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2393
  2394         16  PI-CR-MONTH-END-DT          PIC XX.
  2395
  2396         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2397             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2398             88  PI-ZERO-CARRIER             VALUE '1'.
  2399             88  PI-ZERO-GROUPING            VALUE '2'.
  2400             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2401
  2402         16  PI-CARRIER-SECURITY         PIC X.
  2403             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2404
  2405         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2406             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2407             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  46
* EL6311.cbl
  2408
  2409         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2410             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2411                                         INDEXED BY PI-ACCESS-NDX
  2412                                         PIC X.
  2413
  2414         16  PI-GA-BILLING-CONTROL       PIC X.
  2415             88  PI-GA-BILLING               VALUE '1'.
  2416
  2417         16  PI-MAIL-PROCESSING          PIC X.
  2418             88  PI-MAIL-YES                 VALUE 'Y'.
  2419
  2420         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2421
  2422         16  PI-AR-SYSTEM.
  2423             20  PI-AR-PROCESSING-CNTL   PIC X.
  2424                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2425             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2426             20  PI-AR-MONTH-END-DT      PIC XX.
  2427
  2428         16  PI-MP-SYSTEM.
  2429             20  PI-MORTGAGE-USER            PIC X.
  2430                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2431                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2432             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2433                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2434                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2435                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2436                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2437                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2438             20  PI-MP-MONTH-END-DT          PIC XX.
  2439             20  PI-MP-REFERENCE-NO.
  2440                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2441                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2442
  2443         16  PI-LABEL-CONTROL            PIC X(01).
  2444             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2445             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2446
  2447         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2448             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2449
  2450         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2451             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2452             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2453
  2454         16  FILLER                      PIC X(14).
  2455
  2456     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2457******************************************************************
  2458
  2459     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2460*    COPY ELC631PI.
  2461******************************************************************
  2462*                                                                *
  2463*                                                                *
  2464*                            ELC631PI                            *
  2465*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  47
* EL6311.cbl
  2466*                                                                *
  2467*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2468*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2469*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2470*                                                                *
  2471*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2472*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2473*    BETWEEN PROGRAMS.                                           *
  2474*                                                                *
  2475*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2476*                                                                *
  2477*               EL631 - EL6311 - EL6312 - EL6313                 *
  2478*                                                                *
  2479******************************************************************
  2480
  2481         16  PI-631-DATA.
  2482             20  PI-ERPNDB-KEY.
  2483                 24  PI-PB-COMPANY-CD     PIC X.
  2484                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2485                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2486                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2487
  2488             20  PI-ERPNDB-ALT-KEY.
  2489                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2490                 24  PI-PB-CARRIER        PIC X.
  2491                 24  PI-PB-GROUPING       PIC X(6).
  2492                 24  PI-PB-STATE          PIC XX.
  2493                 24  PI-PB-ACCOUNT        PIC X(10).
  2494                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2495                 24  PI-PB-CERT-NO.
  2496                     28  PI-PB-CERT-PRIME PIC X(10).
  2497                     28  PI-PB-CERT-SFX   PIC X.
  2498                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2499                 24  PI-PB-RECORD-TYPE    PIC X.
  2500
  2501             20  PI-ERPNDB-CSR-KEY.
  2502                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2503                 24  PI-PB-CSR-ID             PIC X(4).
  2504                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2505                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2506                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2507
  2508             20  PI-BROWSE-TYPE               PIC X.
  2509                 88  PI-FILE-BROWSE             VALUE ' '.
  2510                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2511                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2512                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2513                 88  PI-CSR-BROWSE              VALUE '4'.
  2514
  2515             20  PI-MAINT-FUNCTION            PIC X.
  2516                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2517                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2518                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2519                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2520                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2521                 88  PI-PF5-FUNCTION            VALUE '5'.
  2522                 88  PI-PF6-FUNCTION            VALUE '6'.
  2523
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  48
* EL6311.cbl
  2524             20  PI-FILE-SWITCHES.
  2525                 24  PI-ALL-ISSUES-SW         PIC X.
  2526                     88  ALL-ISSUES             VALUE 'Y'.
  2527                 24  PI-ALL-CANCELS-SW        PIC X.
  2528                     88  ALL-CANCELS            VALUE 'Y'.
  2529                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2530                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2531                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2532                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2533                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2534                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2535                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2536                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2537                 24  PI-HOLD-REC-SW           PIC X.
  2538                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2539                 24  PI-CHANGE-REC-SW         PIC X.
  2540                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2541                 24  PI-CHK-REQ-REC-SW        PIC X.
  2542                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2543                 24  PI-ISSUE-WARNING-SW      PIC X.
  2544                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2545                 24  PI-CANCEL-WARNING-SW     PIC X.
  2546                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2547             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2548                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2549             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2550                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2551
  2552             20  PI-MAP-NAME                  PIC X(8).
  2553
  2554             20  PI-CURSOR                    PIC S9(4) COMP.
  2555
  2556             20  PI-PREV-ALT-KEY              PIC X(36).
  2557             20  PI-PREV-CSR-KEY              PIC X(15).
  2558             20  PI-PREV-KEY.
  2559                 24  PI-PREV-COMPANY-CD       PIC X.
  2560                 24  PI-PREV-BATCH            PIC X(6).
  2561                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2562                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2563             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2564             20  PI-BROWSE-SW                 PIC X.
  2565                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2566                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2567             20  PI-SV-CARRIER                PIC X.
  2568             20  PI-SV-GROUPING               PIC X(6).
  2569             20  PI-SV-STATE                  PIC XX.
  2570             20  PI-EDIT-SW                   PIC X.
  2571             20  PI-DISPLAY-SW                PIC XX.
  2572                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2573                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2574             20  PI-CRITERIA-DATA             PIC X(350).
  2575             20  PI-BMODE                     PIC X.
  2576             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2577             20  PI-BPMTS                     PIC S999     COMP-3.
  2578             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2579             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2580             20  PI-CSR-SESSION-SW            PIC X.
  2581                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  49
* EL6311.cbl
  2582             20  PI-ERRORS-SW                 PIC X.
  2583                 88  FATAL-ERRORS               VALUE 'X'.
  2584*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2585             20  FILLER                       PIC X(5).
  2586
  2587        16  FILLER             PIC X(94).
  2588
  2589 01  W-LETTER-COMMUNICATION-AREAS.
  2590*    COPY ELC1042.
  2591******************************************************************
  2592*                                                                *
  2593*                                                                *
  2594*                           ELC1042                              *
  2595*                            VMOD=2.002                          *
  2596*                                                                *
  2597*    NOTE                                                        *
  2598*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2599*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2600*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2601*        TO THESE PROGRAMS.                                      *
  2602*                                                                *
  2603*    NOTE                                                        *
  2604*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2605*        USE ONLY!                                               *
  2606*                                                                *
  2607******************************************************************
  2608
  2609         16  PI-1042-WA.
  2610             20  PI-ACTION       PIC  X(01).
  2611                 88 PI-SHOW-MODE           VALUE '1'.
  2612                 88 PI-CLEAR-MODE          VALUE '2'.
  2613                 88 PI-CREATE-MODE         VALUE '3'.
  2614             20  PI-COMM-CONTROL PIC  X(12).
  2615             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2616             20  PI-EOF-SW       PIC  X(01).
  2617                 88  PI-FILE-EOF           VALUE 'Y'.
  2618             20  PI-FILETYP      PIC  X(01).
  2619             20  PI-FORM-SQUEEZE-CONTROL
  2620                                 PIC  X(01).
  2621                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2622                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2623             20  PI-LAST-CONTROL PIC  X(12).
  2624             20  PI-TEMP-STOR-ITEMS
  2625                                 PIC S9(04) COMP.
  2626             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2627             20  PI-UPDATE-SW    PIC  9(01).
  2628                 88 ANY-UPDATES            VALUE 1.
  2629             20  PI-104-SCREEN-SENT-IND
  2630                                 PIC  X(01).
  2631                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2632                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2633             20  PI-1042-SCREEN-SENT-IND
  2634                                 PIC  X(01).
  2635                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2636                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2637             20  PI-1042-ARCHIVE-IND
  2638                                 PIC  X(01).
  2639                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  50
* EL6311.cbl
  2640             20  FILLER          PIC  X(29).
  2641*    COPY ELC689PI.
  2642******************************************************************
  2643*                                                                *
  2644*                            ELC689PI                            *
  2645*                            VMOD=2.003                          *
  2646*                                                                *
  2647*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2648*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2649*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2650*                                                                *
  2651*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2652*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2653*    BETWEEN PROGRAMS.                                           *
  2654*                                                                *
  2655*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2656*                                                                *
  2657*               EL631 - EL689  - EL6891 - EL6892                 *
  2658*                                                                *
  2659******************************************************************
  2660*                   C H A N G E   L O G
  2661*
  2662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2663*-----------------------------------------------------------------
  2664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2665* EFFECTIVE    NUMBER
  2666*-----------------------------------------------------------------
  2667* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2668* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2669* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2670******************************************************************
  2671
  2672
  2673         16  PI-689-WORK-AREA.
  2674             20  PI-689-ALT-PRINTER-ID
  2675                                 PIC  X(04).
  2676             20  PI-689-ARCHIVE-NUMBER
  2677                                 PIC  9(08).
  2678             20  PI-689-ARCHIVE-SW
  2679                                 PIC  X(01).
  2680                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2681             20  PI-689-DATA-SOURCE
  2682                                 PIC  X(01).
  2683                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2684                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2685                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2686                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2687                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2688             20  PI-689-ERROR-IND
  2689                                 PIC  X(01).
  2690                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2691             20  PI-689-ERROR    PIC  9(04).
  2692                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2693                 88  PI-689-FATAL-ERROR
  2694                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2695                            0042 0047 0051 0066 0067 0070
  2696                            0168 0169 0174 0175 0176 0177 0179
  2697                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  51
* EL6311.cbl
  2698                            0191
  2699                            0215 0279 0280
  2700                            0412 0413 0454
  2701                            0533 0537
  2702                            2055 2114 2208 2209 2216 2232 2369
  2703                            2398 2433 2908 2999
  2704                            3000 3770 3771 3775
  2705                            7250 7365 7367 7368 7369 7370 7371
  2706                            7272 7373 7374 7376 7377 7378 7379
  2707                            7381 7388 7390 7393 7395 7396 7398
  2708                            9095 9096 9281 9298 9299 9320 9327
  2709                            9426 9427.
  2710                 88  PI-689-STOP-ERROR
  2711                     VALUES 0004 0008 0013 0023 0029 0033
  2712                            0042 0047 0066 0067 0070
  2713                            0168 0169 0174 0175 0176 0177
  2714                            0181 0182 0184 0185 0189 0190
  2715                            0279 0280
  2716                            0412 0413 0454
  2717                            2055 2208 2209 2216 2232
  2718                            2398 2999
  2719                            3000 3770 3771 3775
  2720                            7250 7365 7369 7370 7371
  2721                            7272 7373 7374 7376 7377 7378 7379
  2722                            7381 7388 7390 7393 7396 7398
  2723                            9095 9096 9299 9320 9426.
  2724             20  PI-689-FOLLOW-UP-DATE
  2725                                 PIC  X(02).
  2726             20  PI-689-FORM-NUMBER
  2727                                 PIC  X(04).
  2728             20  PI-689-LABEL-SOURCE
  2729                                 PIC X(01).
  2730                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2731                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2732                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2733                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2734                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2735                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2736                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2737             20  PI-689-NUMBER-COPIES
  2738                                 PIC  9(01).
  2739             20  PI-689-NUMBER-LABEL-LINES
  2740                                 PIC  9(01).
  2741             20  PI-689-NUMBER-TEXT-RECORDS
  2742                                 PIC  9(03).
  2743             20  PI-689-PRINT-ORDER-SW
  2744                                 PIC  X(01).
  2745                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2746                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2747                 88  PI-689-PRINT-LATER     VALUE '3'.
  2748                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2749             20  PI-689-PRINT-RESTRICTION
  2750                                 PIC  X(01).
  2751                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2752                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2753                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2754             20  PI-689-PRINT-SW PIC  X(01).
  2755                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  52
* EL6311.cbl
  2756             20  PI-689-RESEND-DATE-1
  2757                                 PIC  X(02).
  2758             20  PI-689-RESEND-LETR-1
  2759                                 PIC X(4).
  2760             20  PI-689-TEMP-STOR-ID
  2761                                 PIC  X(08).
  2762             20  PI-689-USE-SCREEN-IND
  2763                                 PIC  X(01).
  2764                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2765             20  PI-689-ARCH-POINTER
  2766                                 PIC S9(08) COMP.
  2767                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2768             20  PI-689-ARCT-POINTER
  2769                                 PIC S9(08) COMP.
  2770                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2771             20  PI-689-VARIABLE-DATA-GRP.
  2772                 24  PI-689-VARIABLE-DATA-1
  2773                                 PIC  X(30).
  2774                 24  PI-689-VARIABLE-DATA-2
  2775                                 PIC  X(30).
  2776                 24  PI-689-VARIABLE-DATA-3
  2777                                 PIC  X(30).
  2778                 24  PI-689-VARIABLE-DATA-4
  2779                                 PIC  X(30).
  2780
  2781         16  PI-689-KEY-DATA-FIELDS.
  2782             20  PI-689-ACCOUNT  PIC  X(10).
  2783             20  PI-689-CARRIER  PIC  X(01).
  2784             20  PI-689-CERT-NO.
  2785                 24  PI-689-CERT-PRIME
  2786                                 PIC  X(10).
  2787                 24  PI-689-CERT-SFX
  2788                                 PIC  X(01).
  2789             20  PI-689-CHG-SEQ-NO
  2790                                 PIC S9(04)    COMP.
  2791             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2792                                 PIC  X(02).
  2793             20  PI-689-ENTRY-BATCH
  2794                                 PIC  X(06).
  2795             20  PI-689-EFF-DATE PIC  X(02).
  2796             20  PI-689-EXP-DATE PIC  X(02).
  2797             20  PI-689-GROUPING PIC  X(06).
  2798             20  PI-689-RESP-PERSON
  2799                                 PIC  X(10).
  2800             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2801             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2802                                 PIC  X(04).
  2803             20  PI-689-STATE    PIC  X(02).
  2804             20  PI-689-TYPE     PIC  X(01).
  2805             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2806             20  PI-689-ALT-SEQ-NO
  2807                                 PIC S9(04)    COMP.
  2808         16  PI-689-DATE-EDIT    PIC  X(08).
  2809         16  PI-689-FOLLOW-UP-EDIT
  2810                                 PIC  X(08).
  2811         16  PI-689-RESEND1-EDIT PIC  X(08).
  2812         16  PI-689-SEQ-EDIT     PIC  X(08).
  2813         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  53
* EL6311.cbl
  2814         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2815             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2816         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2817         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  54
* EL6311.cbl
  2819
  2820 01  WS-EL6315-PASS-AREA.
  2821        16  PI-6315-ISS-CAN-SW      PIC X.
  2822        16  FILLER                  PIC X(120).
  2823        16  PI-RES-REF-CLM-TYPE     PIC X.
  2824        16  FILLER                  PIC X.
  2825        16  PI-6315-PASS-AREA.
  2826            20 FILLER               PIC X(236).
  2827            20 PI-6315-FINALIZED    PIC X.
  2828            20 FILLER               PIC X(280).
  2829
  2830 01  WS-EL6316-PASS-AREA.
  2831        16  PI-ISS-CAN-SW           PIC X.
  2832        16  FILLER                  PIC X(121).
  2833        16  PI-CLM-RESC-IND         PIC X.
  2834        16  PI-6316-PASS-AREA.
  2835            20 FILLER               PIC X(236).
  2836            20 PI-6316-FINALIZED    PIC X.
  2837            20 FILLER               PIC X(280).
  2838
  2839******************************************************************
  2840*                                                                *
  2841*         P A S S   A R E A   F O R   E D I T                    *
  2842*                                                                *
  2843******************************************************************
  2844
  2845 01  PASSED-RECORD.
  2846     12  RECORD-SAVE                  PIC X(585).
  2847* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2848*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2849*                    BY  WK-CURRENT-DATE.
  2850******************************************************************
  2851*                                                                *
  2852*                                                                *
  2853*                             ELC50W1                            *
  2854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2855*                            VMOD=2.004                          *
  2856*                                                                *
  2857*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2858*                                                                *
  2859*                                                                *
  2860******************************************************************
  2861
  2862     12  WK-WORK-AREA.
  2863         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2864         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2865         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2866         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2867         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2868         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2869         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2870         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2871         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2872         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2873         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2874         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2875         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2876         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  55
* EL6311.cbl
  2877         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2878         16  WK-CREDIT-EDIT-CONTROLS.
  2879             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2880             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2881             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2882             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2883             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2884             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2885         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2886         16  WK-SAVE-REIN-DATA.
  2887             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2888             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2889             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2890         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2891             88  ENTRY-FROM-EL6311       VALUE '6'.
  2892         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2893         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2894     12  WK-RECORD-ADDRESSES.
  2895         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2896         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2897         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2898         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2899         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2900         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2901         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2902         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2903     12  WK-OVER-SHORT-AREA.
  2904         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2905         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2906         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2907             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2908         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  56
* EL6311.cbl
  2910
  2911*    COPY ELCEDITC.
  2912******************************************************************
  2913*                                                                *
  2914*                                                                *
  2915*                            ELCEDITC                            *
  2916*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2917*                            VMOD=2.012                          *
  2918*                                                                *
  2919*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2920*                     EL6313, EL050 AND EL517.                   *
  2921*                                                                *
  2922******************************************************************
  2923******************************************************************
  2924*                   C H A N G E   L O G
  2925*
  2926* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2927*-----------------------------------------------------------------
  2928*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2929* EFFECTIVE    NUMBER
  2930*-----------------------------------------------------------------
  2931* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2932******************************************************************
  2933
  2934     12  EDIT-CRITERIA-DATA.
  2935         16  EC-CO-MONTH-END-DT       PIC XX.
  2936         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2937         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2938         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2939         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2940         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2941         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2942         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2943         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2944         16  EC-CO-REM-TERM-CALC      PIC X.
  2945               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2946               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2947               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2948               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2949
  2950         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2951               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2952               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2953               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2954               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2955               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2956               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2957               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2958               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2959               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2960               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2961
  2962         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2963               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2964               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2965               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2966               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2967               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  57
* EL6311.cbl
  2968               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2969               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2970               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2971
  2972         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2973                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2974                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2975
  2976         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2977                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2978                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2979                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2980                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2981                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  2982                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  2983                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  2984                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  2985
  2986         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  2987               88  EC-BR-REDUCING                   VALUE 'R'.
  2988               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  2989
  2990         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  2991         16  EC-BR-LF-DESC             PIC X(10).
  2992         16  EC-BR-AH-DESC             PIC X(10).
  2993         16  EC-BR-LF-COMMENT          PIC X(10).
  2994         16  EC-BR-AH-COMMENT          PIC X(10).
  2995
  2996         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  2997               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  2998               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  2999               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3000               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3001
  3002         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3003               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3004               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3005               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3006               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3007
  3008         16  EC-BR-LF-REFUND-CALC      PIC X.
  3009                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3010                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3011                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3012                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3013                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3014                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3015                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3016
  3017         16  EC-BR-AH-REFUND-CALC      PIC X.
  3018                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3019                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3020                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3021                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3022                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3023                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3024                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3025                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  58
* EL6311.cbl
  3026
  3027         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3028                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3029                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3030                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3031
  3032         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3033                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3034                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3035                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3036
  3037         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3038         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3039         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3040         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3041
  3042         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3043         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3044                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3045                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3046                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3047                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3048
  3049         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3050               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3051               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3052               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3053               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3054               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3055
  3056         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3057               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3058               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3059               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3060               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3061               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3062
  3063         16  EC-ST-LF-REFUND-CALC      PIC X.
  3064                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3065                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3066                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3067                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3068                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3069                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3070                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3071                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3072
  3073         16  EC-ST-AH-REFUND-CALC      PIC X.
  3074                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3075                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3076                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3077                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3078                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3079                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3080                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3081                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3082
  3083         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  59
* EL6311.cbl
  3084         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3085         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3086         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3087         16  EC-AM-EXPIRATION-DT       PIC XX.
  3088         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3089         16  EC-AM-CLASS-CD            PIC XX.
  3090         16  EC-AM-LF-DEVIATION        PIC XXX.
  3091         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3092         16  EC-AM-AH-DEVIATION        PIC XXX.
  3093         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3094         16  EC-AM-PHONE-NO            PIC X(10).
  3095
  3096         16  EC-AM-LF-REFUND-CALC      PIC X.
  3097                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3098                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3099                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3100                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3101                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3102                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3103                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3104
  3105         16  EC-AM-AH-REFUND-CALC      PIC X.
  3106                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3107                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3108                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3109                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3110                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3111                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3112                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3113
  3114         16  EC-AM-BEN-I-G-CD          PIC X.
  3115                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3116                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3117                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3118
  3119         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3120         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3121         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3122         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3123         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3124         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3125         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3126         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3127         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3128
  3129         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3130         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3131         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3132         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3133         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3134         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3135         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3136         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3137         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3138         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3139         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3140         16  EC-RT-LF-NSP-ST           PIC XX.
  3141         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  60
* EL6311.cbl
  3142         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3143         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3144
  3145         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3146             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3147                                             'M' '5' '9' '2'.
  3148             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3149             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3150             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3151             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3152             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3153             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3154             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3155             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3156             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3157             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3158
  3159         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3160             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3161                                             'M' '5' '9' '2'.
  3162             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3163             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3164             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3165             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3166             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3167             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3168             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3169             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3170             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3171             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3172
  3173         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3174         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3175         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3176         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3177         16  EC-CM-DEATH-DT            PIC XX.
  3178
  3179*DMD CUSTOM CODING FIELDS BELOW
  3180*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3181         16  EC-BR-DMD-RATING-SW       PIC X.
  3182                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3183                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3184                 88  NO-DMD-RATING               VALUE 'N'.
  3185
  3186         16  EC-NEW-CERT               PIC X(11).
  3187         16  EC-NEW-STATE              PIC XX.
  3188         16  FILLER                    PIC X.
  3189*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3190         16  OVER-SHORT-EDIT-FIELDS.
  3191             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3192             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3193             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3194             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3195             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3196             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3197             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3198             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3199             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  61
* EL6311.cbl
  3200         16  FILLER                    PIC X(71).
  3201
  3202******************************************************************
  3203
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  62
* EL6311.cbl
  3205
  3206*    COPY ELCJPFX.
  3207******************************************************************
  3208*                                                                *
  3209*                                                                *
  3210*                            ELCJPFX.                            *
  3211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3212*                            VMOD=2.002                          *
  3213*                                                                *
  3214*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3215*                                                                *
  3216*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3217*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3218*        ELCNTL - CONTROL FILE                                   *
  3219*        ELMSTR - CLAIM MASTERS                                  *
  3220*        ELTRLR - ACTIVITY TRAILERS                              *
  3221*        ELCHKQ - CHECK QUE                                      *
  3222******************************************************************
  3223 01  JOURNAL-RECORD.
  3224     12  JP-USER-ID                  PIC X(4).
  3225     12  JP-FILE-ID                  PIC X(8).
  3226     12  JP-PROGRAM-ID               PIC X(8).
  3227     12  JP-RECORD-TYPE              PIC X.
  3228         88 JP-ADD              VALUE 'A'.
  3229         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3230         88 JP-AFTER-CHANGE     VALUE 'C'.
  3231         88 JP-DELETE           VALUE 'D'.
  3232         88 JP-GENERIC-DELETE   VALUE 'G'.
  3233         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3234         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3235     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3236     12  JP-RECORD-AREA
  3237
  3238
  3239                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  63
* EL6311.cbl
  3241*    COPY ELCAID.
  3242******************************************************************
  3243*                                                                *
  3244*                            ELCAID.                             *
  3245*                            VMOD=2.001                          *
  3246*                                                                *
  3247*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3248*                                                                *
  3249*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3250*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3251******************************************************************
  3252
  3253 01  DFHAID.
  3254   02  DFHNULL   PIC  X  VALUE  ' '.
  3255   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3256   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3257   02  DFHPEN    PIC  X  VALUE  '='.
  3258   02  DFHOPID   PIC  X  VALUE  'W'.
  3259   02  DFHPA1    PIC  X  VALUE  '%'.
  3260   02  DFHPA2    PIC  X  VALUE  '>'.
  3261   02  DFHPA3    PIC  X  VALUE  ','.
  3262   02  DFHPF1    PIC  X  VALUE  '1'.
  3263   02  DFHPF2    PIC  X  VALUE  '2'.
  3264   02  DFHPF3    PIC  X  VALUE  '3'.
  3265   02  DFHPF4    PIC  X  VALUE  '4'.
  3266   02  DFHPF5    PIC  X  VALUE  '5'.
  3267   02  DFHPF6    PIC  X  VALUE  '6'.
  3268   02  DFHPF7    PIC  X  VALUE  '7'.
  3269   02  DFHPF8    PIC  X  VALUE  '8'.
  3270   02  DFHPF9    PIC  X  VALUE  '9'.
  3271   02  DFHPF10   PIC  X  VALUE  ':'.
  3272   02  DFHPF11   PIC  X  VALUE  '#'.
  3273   02  DFHPF12   PIC  X  VALUE  '@'.
  3274   02  DFHPF13   PIC  X  VALUE  'A'.
  3275   02  DFHPF14   PIC  X  VALUE  'B'.
  3276   02  DFHPF15   PIC  X  VALUE  'C'.
  3277   02  DFHPF16   PIC  X  VALUE  'D'.
  3278   02  DFHPF17   PIC  X  VALUE  'E'.
  3279   02  DFHPF18   PIC  X  VALUE  'F'.
  3280   02  DFHPF19   PIC  X  VALUE  'G'.
  3281   02  DFHPF20   PIC  X  VALUE  'H'.
  3282   02  DFHPF21   PIC  X  VALUE  'I'.
  3283*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3284   02  DFHPF22   PIC  X  VALUE  '['.
  3285   02  DFHPF23   PIC  X  VALUE  '.'.
  3286   02  DFHPF24   PIC  X  VALUE  '<'.
  3287   02  DFHMSRE   PIC  X  VALUE  'X'.
  3288   02  DFHSTRF   PIC  X  VALUE  'h'.
  3289   02  DFHTRIG   PIC  X  VALUE  '"'.
  3290
  3291 01  FILLER    REDEFINES DFHAID.
  3292     12  FILLER              PIC X(8).
  3293     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3294
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  64
* EL6311.cbl
  3296*    COPY EL6311S.
  3297 01  EL631BI.
  3298     05  FILLER            PIC  X(0012).
  3299*    -------------------------------
  3300     05  BDATEL PIC S9(0004) COMP.
  3301     05  BDATEF PIC  X(0001).
  3302     05  FILLER REDEFINES BDATEF.
  3303         10  BDATEA PIC  X(0001).
  3304     05  BDATEI PIC  X(0008).
  3305*    -------------------------------
  3306     05  BTIMEL PIC S9(0004) COMP.
  3307     05  BTIMEF PIC  X(0001).
  3308     05  FILLER REDEFINES BTIMEF.
  3309         10  BTIMEA PIC  X(0001).
  3310     05  BTIMEI PIC  X(0005).
  3311*    -------------------------------
  3312     05  BHEADL PIC S9(0004) COMP.
  3313     05  BHEADF PIC  X(0001).
  3314     05  FILLER REDEFINES BHEADF.
  3315         10  BHEADA PIC  X(0001).
  3316     05  BHEADI PIC  X(0038).
  3317*    -------------------------------
  3318     05  BNCERTLL PIC S9(0004) COMP.
  3319     05  BNCERTLF PIC  X(0001).
  3320     05  FILLER REDEFINES BNCERTLF.
  3321         10  BNCERTLA PIC  X(0001).
  3322     05  BNCERTLI PIC  X(0008).
  3323*    -------------------------------
  3324     05  BNCERTL PIC S9(0004) COMP.
  3325     05  BNCERTF PIC  X(0001).
  3326     05  FILLER REDEFINES BNCERTF.
  3327         10  BNCERTA PIC  X(0001).
  3328     05  BNCERTI PIC  X(0011).
  3329*    -------------------------------
  3330     05  BNSTATLL PIC S9(0004) COMP.
  3331     05  BNSTATLF PIC  X(0001).
  3332     05  FILLER REDEFINES BNSTATLF.
  3333         10  BNSTATLA PIC  X(0001).
  3334     05  BNSTATLI PIC  X(0009).
  3335*    -------------------------------
  3336     05  BNSTATL PIC S9(0004) COMP.
  3337     05  BNSTATF PIC  X(0001).
  3338     05  FILLER REDEFINES BNSTATF.
  3339         10  BNSTATA PIC  X(0001).
  3340     05  BNSTATI PIC  X(0002).
  3341*    -------------------------------
  3342     05  BCHGTL PIC S9(0004) COMP.
  3343     05  BCHGTF PIC  X(0001).
  3344     05  FILLER REDEFINES BCHGTF.
  3345         10  BCHGTA PIC  X(0001).
  3346     05  BCHGTI PIC  X(0004).
  3347*    -------------------------------
  3348     05  BCHGL PIC S9(0004) COMP.
  3349     05  BCHGF PIC  X(0001).
  3350     05  FILLER REDEFINES BCHGF.
  3351         10  BCHGA PIC  X(0001).
  3352     05  BCHGI PIC  X(0004).
  3353*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  65
* EL6311.cbl
  3354     05  BMAINTL PIC S9(0004) COMP.
  3355     05  BMAINTF PIC  X(0001).
  3356     05  FILLER REDEFINES BMAINTF.
  3357         10  BMAINTA PIC  X(0001).
  3358     05  BMAINTI PIC  X(0001).
  3359*    -------------------------------
  3360     05  BMANTBYL PIC S9(0004) COMP.
  3361     05  BMANTBYF PIC  X(0001).
  3362     05  FILLER REDEFINES BMANTBYF.
  3363         10  BMANTBYA PIC  X(0001).
  3364     05  BMANTBYI PIC  X(0004).
  3365*    -------------------------------
  3366     05  BCHGHDGL PIC S9(0004) COMP.
  3367     05  BCHGHDGF PIC  X(0001).
  3368     05  FILLER REDEFINES BCHGHDGF.
  3369         10  BCHGHDGA PIC  X(0001).
  3370     05  BCHGHDGI PIC  X(0003).
  3371*    -------------------------------
  3372     05  BMANTDTL PIC S9(0004) COMP.
  3373     05  BMANTDTF PIC  X(0001).
  3374     05  FILLER REDEFINES BMANTDTF.
  3375         10  BMANTDTA PIC  X(0001).
  3376     05  BMANTDTI PIC  X(0008).
  3377*    -------------------------------
  3378     05  BMANTATL PIC S9(0004) COMP.
  3379     05  BMANTATF PIC  X(0001).
  3380     05  FILLER REDEFINES BMANTATF.
  3381         10  BMANTATA PIC  X(0001).
  3382     05  BMANTATI PIC  X(0005).
  3383*    -------------------------------
  3384     05  BCSRL PIC S9(0004) COMP.
  3385     05  BCSRF PIC  X(0001).
  3386     05  FILLER REDEFINES BCSRF.
  3387         10  BCSRA PIC  X(0001).
  3388     05  BCSRI PIC  X(0004).
  3389*    -------------------------------
  3390     05  BBATCHL PIC S9(0004) COMP.
  3391     05  BBATCHF PIC  X(0001).
  3392     05  FILLER REDEFINES BBATCHF.
  3393         10  BBATCHA PIC  X(0001).
  3394     05  BBATCHI PIC  X(0006).
  3395*    -------------------------------
  3396     05  BSEQL PIC S9(0004) COMP.
  3397     05  BSEQF PIC  X(0001).
  3398     05  FILLER REDEFINES BSEQF.
  3399         10  BSEQA PIC  X(0001).
  3400     05  BSEQI PIC  X(0004).
  3401*    -------------------------------
  3402     05  BMOENDTL PIC S9(0004) COMP.
  3403     05  BMOENDTF PIC  X(0001).
  3404     05  FILLER REDEFINES BMOENDTF.
  3405         10  BMOENDTA PIC  X(0001).
  3406     05  BMOENDTI PIC  X(0008).
  3407*    -------------------------------
  3408     05  BCARRL PIC S9(0004) COMP.
  3409     05  BCARRF PIC  X(0001).
  3410     05  FILLER REDEFINES BCARRF.
  3411         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  66
* EL6311.cbl
  3412     05  BCARRI PIC  X(0001).
  3413*    -------------------------------
  3414     05  BGROUPL PIC S9(0004) COMP.
  3415     05  BGROUPF PIC  X(0001).
  3416     05  FILLER REDEFINES BGROUPF.
  3417         10  BGROUPA PIC  X(0001).
  3418     05  BGROUPI PIC  X(0006).
  3419*    -------------------------------
  3420     05  BSTATEL PIC S9(0004) COMP.
  3421     05  BSTATEF PIC  X(0001).
  3422     05  FILLER REDEFINES BSTATEF.
  3423         10  BSTATEA PIC  X(0001).
  3424     05  BSTATEI PIC  X(0002).
  3425*    -------------------------------
  3426     05  BACCTL PIC S9(0004) COMP.
  3427     05  BACCTF PIC  X(0001).
  3428     05  FILLER REDEFINES BACCTF.
  3429         10  BACCTA PIC  X(0001).
  3430     05  BACCTI PIC  X(0010).
  3431*    -------------------------------
  3432     05  BVINHL PIC S9(0004) COMP.
  3433     05  BVINHF PIC  X(0001).
  3434     05  FILLER REDEFINES BVINHF.
  3435         10  BVINHA PIC  X(0001).
  3436     05  BVINHI PIC  X(0004).
  3437*    -------------------------------
  3438     05  BVINL PIC S9(0004) COMP.
  3439     05  BVINF PIC  X(0001).
  3440     05  FILLER REDEFINES BVINF.
  3441         10  BVINA PIC  X(0001).
  3442     05  BVINI PIC  X(0017).
  3443*    -------------------------------
  3444     05  BREFHDGL PIC S9(0004) COMP.
  3445     05  BREFHDGF PIC  X(0001).
  3446     05  FILLER REDEFINES BREFHDGF.
  3447         10  BREFHDGA PIC  X(0001).
  3448     05  BREFHDGI PIC  X(0004).
  3449*    -------------------------------
  3450     05  BREFL PIC S9(0004) COMP.
  3451     05  BREFF PIC  X(0001).
  3452     05  FILLER REDEFINES BREFF.
  3453         10  BREFA PIC  X(0001).
  3454     05  BREFI PIC  X(0012).
  3455*    -------------------------------
  3456     05  BAGEDEFL PIC S9(0004) COMP.
  3457     05  BAGEDEFF PIC  X(0001).
  3458     05  FILLER REDEFINES BAGEDEFF.
  3459         10  BAGEDEFA PIC  X(0001).
  3460     05  BAGEDEFI PIC  X(0004).
  3461*    -------------------------------
  3462     05  BCERTNOL PIC S9(0004) COMP.
  3463     05  BCERTNOF PIC  X(0001).
  3464     05  FILLER REDEFINES BCERTNOF.
  3465         10  BCERTNOA PIC  X(0001).
  3466     05  BCERTNOI PIC  X(0010).
  3467*    -------------------------------
  3468     05  BSUFIXL PIC S9(0004) COMP.
  3469     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  67
* EL6311.cbl
  3470     05  FILLER REDEFINES BSUFIXF.
  3471         10  BSUFIXA PIC  X(0001).
  3472     05  BSUFIXI PIC  X(0001).
  3473*    -------------------------------
  3474     05  BEFFDTL PIC S9(0004) COMP.
  3475     05  BEFFDTF PIC  X(0001).
  3476     05  FILLER REDEFINES BEFFDTF.
  3477         10  BEFFDTA PIC  X(0001).
  3478     05  BEFFDTI PIC  X(0008).
  3479*    -------------------------------
  3480     05  BLSTNML PIC S9(0004) COMP.
  3481     05  BLSTNMF PIC  X(0001).
  3482     05  FILLER REDEFINES BLSTNMF.
  3483         10  BLSTNMA PIC  X(0001).
  3484     05  BLSTNMI PIC  X(0015).
  3485*    -------------------------------
  3486     05  B1STNML PIC S9(0004) COMP.
  3487     05  B1STNMF PIC  X(0001).
  3488     05  FILLER REDEFINES B1STNMF.
  3489         10  B1STNMA PIC  X(0001).
  3490     05  B1STNMI PIC  X(0010).
  3491*    -------------------------------
  3492     05  BINITL PIC S9(0004) COMP.
  3493     05  BINITF PIC  X(0001).
  3494     05  FILLER REDEFINES BINITF.
  3495         10  BINITA PIC  X(0001).
  3496     05  BINITI PIC  X(0001).
  3497*    -------------------------------
  3498     05  BSEXL PIC S9(0004) COMP.
  3499     05  BSEXF PIC  X(0001).
  3500     05  FILLER REDEFINES BSEXF.
  3501         10  BSEXA PIC  X(0001).
  3502     05  BSEXI PIC  X(0001).
  3503*    -------------------------------
  3504     05  BAGEL PIC S9(0004) COMP.
  3505     05  BAGEF PIC  X(0001).
  3506     05  FILLER REDEFINES BAGEF.
  3507         10  BAGEA PIC  X(0001).
  3508     05  BAGEI PIC  X(0002).
  3509*    -------------------------------
  3510     05  BBIRTHL PIC S9(0004) COMP.
  3511     05  BBIRTHF PIC  X(0001).
  3512     05  FILLER REDEFINES BBIRTHF.
  3513         10  BBIRTHA PIC  X(0001).
  3514     05  BBIRTHI PIC  X(0008).
  3515*    -------------------------------
  3516     05  B1STPMTL PIC S9(0004) COMP.
  3517     05  B1STPMTF PIC  X(0001).
  3518     05  FILLER REDEFINES B1STPMTF.
  3519         10  B1STPMTA PIC  X(0001).
  3520     05  B1STPMTI PIC  X(0008).
  3521*    -------------------------------
  3522     05  BDAYSL PIC S9(0004) COMP.
  3523     05  BDAYSF PIC  X(0001).
  3524     05  FILLER REDEFINES BDAYSF.
  3525         10  BDAYSA PIC  X(0001).
  3526     05  BDAYSI PIC  X(0003).
  3527*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  68
* EL6311.cbl
  3528     05  BLNTRML PIC S9(0004) COMP.
  3529     05  BLNTRMF PIC  X(0001).
  3530     05  FILLER REDEFINES BLNTRMF.
  3531         10  BLNTRMA PIC  X(0001).
  3532     05  BLNTRMI PIC  X(0003).
  3533*    -------------------------------
  3534     05  BLNOFCRL PIC S9(0004) COMP.
  3535     05  BLNOFCRF PIC  X(0001).
  3536     05  FILLER REDEFINES BLNOFCRF.
  3537         10  BLNOFCRA PIC  X(0001).
  3538     05  BLNOFCRI PIC  X(0005).
  3539*    -------------------------------
  3540     05  BMODEL PIC S9(0004) COMP.
  3541     05  BMODEF PIC  X(0001).
  3542     05  FILLER REDEFINES BMODEF.
  3543         10  BMODEA PIC  X(0001).
  3544     05  BMODEI PIC  X(0001).
  3545*    -------------------------------
  3546     05  BFREQL PIC S9(0004) COMP.
  3547     05  BFREQF PIC  X(0001).
  3548     05  FILLER REDEFINES BFREQF.
  3549         10  BFREQA PIC  X(0001).
  3550     05  BFREQI PIC  X(0002).
  3551*    -------------------------------
  3552     05  BPMTSL PIC S9(0004) COMP.
  3553     05  BPMTSF PIC  X(0001).
  3554     05  FILLER REDEFINES BPMTSF.
  3555         10  BPMTSA PIC  X(0001).
  3556     05  BPMTSI PIC  999.
  3557*    -------------------------------
  3558     05  BPMTAMTL PIC S9(0004) COMP.
  3559     05  BPMTAMTF PIC  X(0001).
  3560     05  FILLER REDEFINES BPMTAMTF.
  3561         10  BPMTAMTA PIC  X(0001).
  3562     05  BPMTAMTI PIC  9(7)V99.
  3563*    -------------------------------
  3564     05  BAPRL PIC S9(0004) COMP.
  3565     05  BAPRF PIC  X(0001).
  3566     05  FILLER REDEFINES BAPRF.
  3567         10  BAPRA PIC  X(0001).
  3568     05  BAPRI PIC  X(7).
  3569*    -------------------------------
  3570     05  BLIVESL PIC S9(0004) COMP.
  3571     05  BLIVESF PIC  X(0001).
  3572     05  FILLER REDEFINES BLIVESF.
  3573         10  BLIVESA PIC  X(0001).
  3574     05  BLIVESI PIC  X(0009).
  3575*    -------------------------------
  3576     05  BMEMCAPL PIC S9(0004) COMP.
  3577     05  BMEMCAPF PIC  X(0001).
  3578     05  FILLER REDEFINES BMEMCAPF.
  3579         10  BMEMCAPA PIC  X(0001).
  3580     05  BMEMCAPI PIC  X(0011).
  3581*    -------------------------------
  3582     05  BORIGHDL PIC S9(0004) COMP.
  3583     05  BORIGHDF PIC  X(0001).
  3584     05  FILLER REDEFINES BORIGHDF.
  3585         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  69
* EL6311.cbl
  3586     05  BORIGHDI PIC  X(0009).
  3587*    -------------------------------
  3588     05  DMDBILL PIC S9(0004) COMP.
  3589     05  DMDBILF PIC  X(0001).
  3590     05  FILLER REDEFINES DMDBILF.
  3591         10  DMDBILA PIC  X(0001).
  3592     05  DMDBILI PIC  X(0006).
  3593*    -------------------------------
  3594     05  BFORCEL PIC S9(0004) COMP.
  3595     05  BFORCEF PIC  X(0001).
  3596     05  FILLER REDEFINES BFORCEF.
  3597         10  BFORCEA PIC  X(0001).
  3598     05  BFORCEI PIC  X(0001).
  3599*    -------------------------------
  3600     05  BENTRYL PIC S9(0004) COMP.
  3601     05  BENTRYF PIC  X(0001).
  3602     05  FILLER REDEFINES BENTRYF.
  3603         10  BENTRYA PIC  X(0001).
  3604     05  BENTRYI PIC  X(0001).
  3605*    -------------------------------
  3606     05  BREINL PIC S9(0004) COMP.
  3607     05  BREINF PIC  X(0001).
  3608     05  FILLER REDEFINES BREINF.
  3609         10  BREINA PIC  X(0001).
  3610     05  BREINI PIC  X(0001).
  3611*    -------------------------------
  3612     05  BBILCDL PIC S9(0004) COMP.
  3613     05  BBILCDF PIC  X(0001).
  3614     05  FILLER REDEFINES BBILCDF.
  3615         10  BBILCDA PIC  X(0001).
  3616     05  BBILCDI PIC  X(0001).
  3617*    -------------------------------
  3618     05  BUNWRITL PIC S9(0004) COMP.
  3619     05  BUNWRITF PIC  X(0001).
  3620     05  FILLER REDEFINES BUNWRITF.
  3621         10  BUNWRITA PIC  X(0001).
  3622     05  BUNWRITI PIC  X(0001).
  3623*    -------------------------------
  3624     05  BSKPCDL PIC S9(0004) COMP.
  3625     05  BSKPCDF PIC  X(0001).
  3626     05  FILLER REDEFINES BSKPCDF.
  3627         10  BSKPCDA PIC  X(0001).
  3628     05  BSKPCDI PIC  X(0001).
  3629*    -------------------------------
  3630     05  BINDGRPL PIC S9(0004) COMP.
  3631     05  BINDGRPF PIC  X(0001).
  3632     05  FILLER REDEFINES BINDGRPF.
  3633         10  BINDGRPA PIC  X(0001).
  3634     05  BINDGRPI PIC  X(0001).
  3635*    -------------------------------
  3636     05  BSIGL PIC S9(0004) COMP.
  3637     05  BSIGF PIC  X(0001).
  3638     05  FILLER REDEFINES BSIGF.
  3639         10  BSIGA PIC  X(0001).
  3640     05  BSIGI PIC  X(0001).
  3641*    -------------------------------
  3642     05  BRTCLSL PIC S9(0004) COMP.
  3643     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  70
* EL6311.cbl
  3644     05  FILLER REDEFINES BRTCLSF.
  3645         10  BRTCLSA PIC  X(0001).
  3646     05  BRTCLSI PIC  X(0002).
  3647*    -------------------------------
  3648     05  BCHGCNTL PIC S9(0004) COMP.
  3649     05  BCHGCNTF PIC  X(0001).
  3650     05  FILLER REDEFINES BCHGCNTF.
  3651         10  BCHGCNTA PIC  X(0001).
  3652     05  BCHGCNTI PIC  X(0003).
  3653*    -------------------------------
  3654     05  BMEMBERL PIC S9(0004) COMP.
  3655     05  BMEMBERF PIC  X(0001).
  3656     05  FILLER REDEFINES BMEMBERF.
  3657         10  BMEMBERA PIC  X(0001).
  3658     05  BMEMBERI PIC  X(0012).
  3659*    -------------------------------
  3660     05  BORGNOL PIC S9(0004) COMP.
  3661     05  BORGNOF PIC  X(0001).
  3662     05  FILLER REDEFINES BORGNOF.
  3663         10  BORGNOA PIC  X(0001).
  3664     05  BORGNOI PIC  X(0006).
  3665*    -------------------------------
  3666     05  BORGSEQL PIC S9(0004) COMP.
  3667     05  BORGSEQF PIC  X(0001).
  3668     05  FILLER REDEFINES BORGSEQF.
  3669         10  BORGSEQA PIC  X(0001).
  3670     05  BORGSEQI PIC  X(0004).
  3671*    -------------------------------
  3672     05  BBILLEDL PIC S9(0004) COMP.
  3673     05  BBILLEDF PIC  X(0001).
  3674     05  FILLER REDEFINES BBILLEDF.
  3675         10  BBILLEDA PIC  X(0001).
  3676     05  BBILLEDI PIC  9(9).
  3677*    -------------------------------
  3678     05  BKIND1L PIC S9(0004) COMP.
  3679     05  BKIND1F PIC  X(0001).
  3680     05  FILLER REDEFINES BKIND1F.
  3681         10  BKIND1A PIC  X(0001).
  3682     05  BKIND1I PIC  X(0002).
  3683*    -------------------------------
  3684     05  BTYPE1L PIC S9(0004) COMP.
  3685     05  BTYPE1F PIC  X(0001).
  3686     05  FILLER REDEFINES BTYPE1F.
  3687         10  BTYPE1A PIC  X(0001).
  3688     05  BTYPE1I PIC  X(0003).
  3689*    -------------------------------
  3690     05  BTERM1L PIC S9(0004) COMP.
  3691     05  BTERM1F PIC  X(0001).
  3692     05  FILLER REDEFINES BTERM1F.
  3693         10  BTERM1A PIC  X(0001).
  3694     05  BTERM1I PIC  X(0003).
  3695*    -------------------------------
  3696     05  BBEN1L PIC S9(0004) COMP.
  3697     05  BBEN1F PIC  X(0001).
  3698     05  FILLER REDEFINES BBEN1F.
  3699         10  BBEN1A PIC  X(0001).
  3700     05  BBEN1I PIC  X(0012).
  3701*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  71
* EL6311.cbl
  3702     05  BPREM1L PIC S9(0004) COMP.
  3703     05  BPREM1F PIC  X(0001).
  3704     05  FILLER REDEFINES BPREM1F.
  3705         10  BPREM1A PIC  X(0001).
  3706     05  BPREM1I PIC  X(0011).
  3707*    -------------------------------
  3708     05  BEXPIR1L PIC S9(0004) COMP.
  3709     05  BEXPIR1F PIC  X(0001).
  3710     05  FILLER REDEFINES BEXPIR1F.
  3711         10  BEXPIR1A PIC  X(0001).
  3712     05  BEXPIR1I PIC  X(0008).
  3713*    -------------------------------
  3714     05  BCP1L PIC S9(0004) COMP.
  3715     05  BCP1F PIC  X(0001).
  3716     05  FILLER REDEFINES BCP1F.
  3717         10  BCP1A PIC  X(0001).
  3718     05  BCP1I PIC  X(0002).
  3719*    -------------------------------
  3720     05  BALTBN1L PIC S9(0004) COMP.
  3721     05  BALTBN1F PIC  X(0001).
  3722     05  FILLER REDEFINES BALTBN1F.
  3723         10  BALTBN1A PIC  X(0001).
  3724     05  BALTBN1I PIC  X(0012).
  3725*    -------------------------------
  3726     05  BALTPR1L PIC S9(0004) COMP.
  3727     05  BALTPR1F PIC  X(0001).
  3728     05  FILLER REDEFINES BALTPR1F.
  3729         10  BALTPR1A PIC  X(0001).
  3730     05  BALTPR1I PIC  X(0011).
  3731*    -------------------------------
  3732     05  BBNCD1L PIC S9(0004) COMP.
  3733     05  BBNCD1F PIC  X(0001).
  3734     05  FILLER REDEFINES BBNCD1F.
  3735         10  BBNCD1A PIC  X(0001).
  3736     05  BBNCD1I PIC  X(0003).
  3737*    -------------------------------
  3738     05  BCPRM1L PIC S9(0004) COMP.
  3739     05  BCPRM1F PIC  X(0001).
  3740     05  FILLER REDEFINES BCPRM1F.
  3741         10  BCPRM1A PIC  X(0001).
  3742     05  BCPRM1I PIC  X(0011).
  3743*    -------------------------------
  3744     05  BCAPRM1L PIC S9(0004) COMP.
  3745     05  BCAPRM1F PIC  X(0001).
  3746     05  FILLER REDEFINES BCAPRM1F.
  3747         10  BCAPRM1A PIC  X(0001).
  3748     05  BCAPRM1I PIC  X(0011).
  3749*    -------------------------------
  3750     05  BENABR1L PIC S9(0004) COMP.
  3751     05  BENABR1F PIC  X(0001).
  3752     05  FILLER REDEFINES BENABR1F.
  3753         10  BENABR1A PIC  X(0001).
  3754     05  BENABR1I PIC  X(0005).
  3755*    -------------------------------
  3756     05  BDIFF1L PIC S9(0004) COMP.
  3757     05  BDIFF1F PIC  X(0001).
  3758     05  FILLER REDEFINES BDIFF1F.
  3759         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  72
* EL6311.cbl
  3760     05  BDIFF1I PIC  X(0011).
  3761*    -------------------------------
  3762     05  BBILIT1L PIC S9(0004) COMP.
  3763     05  BBILIT1F PIC  X(0001).
  3764     05  FILLER REDEFINES BBILIT1F.
  3765         10  BBILIT1A PIC  X(0001).
  3766     05  BBILIT1I PIC  X(0008).
  3767*    -------------------------------
  3768     05  BADIFF1L PIC S9(0004) COMP.
  3769     05  BADIFF1F PIC  X(0001).
  3770     05  FILLER REDEFINES BADIFF1F.
  3771         10  BADIFF1A PIC  X(0001).
  3772     05  BADIFF1I PIC  X(0011).
  3773*    -------------------------------
  3774     05  BKIND2L PIC S9(0004) COMP.
  3775     05  BKIND2F PIC  X(0001).
  3776     05  FILLER REDEFINES BKIND2F.
  3777         10  BKIND2A PIC  X(0001).
  3778     05  BKIND2I PIC  X(0002).
  3779*    -------------------------------
  3780     05  BTYPE2L PIC S9(0004) COMP.
  3781     05  BTYPE2F PIC  X(0001).
  3782     05  FILLER REDEFINES BTYPE2F.
  3783         10  BTYPE2A PIC  X(0001).
  3784     05  BTYPE2I PIC  X(0003).
  3785*    -------------------------------
  3786     05  BTERM2L PIC S9(0004) COMP.
  3787     05  BTERM2F PIC  X(0001).
  3788     05  FILLER REDEFINES BTERM2F.
  3789         10  BTERM2A PIC  X(0001).
  3790     05  BTERM2I PIC  X(0003).
  3791*    -------------------------------
  3792     05  BBEN2L PIC S9(0004) COMP.
  3793     05  BBEN2F PIC  X(0001).
  3794     05  FILLER REDEFINES BBEN2F.
  3795         10  BBEN2A PIC  X(0001).
  3796     05  BBEN2I PIC  X(0012).
  3797*    -------------------------------
  3798     05  BPREM2L PIC S9(0004) COMP.
  3799     05  BPREM2F PIC  X(0001).
  3800     05  FILLER REDEFINES BPREM2F.
  3801         10  BPREM2A PIC  X(0001).
  3802     05  BPREM2I PIC  X(0011).
  3803*    -------------------------------
  3804     05  BEXPIR2L PIC S9(0004) COMP.
  3805     05  BEXPIR2F PIC  X(0001).
  3806     05  FILLER REDEFINES BEXPIR2F.
  3807         10  BEXPIR2A PIC  X(0001).
  3808     05  BEXPIR2I PIC  X(0008).
  3809*    -------------------------------
  3810     05  BCP2L PIC S9(0004) COMP.
  3811     05  BCP2F PIC  X(0001).
  3812     05  FILLER REDEFINES BCP2F.
  3813         10  BCP2A PIC  X(0001).
  3814     05  BCP2I PIC  X(0002).
  3815*    -------------------------------
  3816     05  BALTBN2L PIC S9(0004) COMP.
  3817     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  73
* EL6311.cbl
  3818     05  FILLER REDEFINES BALTBN2F.
  3819         10  BALTBN2A PIC  X(0001).
  3820     05  BALTBN2I PIC  X(0012).
  3821*    -------------------------------
  3822     05  BALTPR2L PIC S9(0004) COMP.
  3823     05  BALTPR2F PIC  X(0001).
  3824     05  FILLER REDEFINES BALTPR2F.
  3825         10  BALTPR2A PIC  X(0001).
  3826     05  BALTPR2I PIC  X(0011).
  3827*    -------------------------------
  3828     05  BBNCD2L PIC S9(0004) COMP.
  3829     05  BBNCD2F PIC  X(0001).
  3830     05  FILLER REDEFINES BBNCD2F.
  3831         10  BBNCD2A PIC  X(0001).
  3832     05  BBNCD2I PIC  X(0003).
  3833*    -------------------------------
  3834     05  BCPRM2L PIC S9(0004) COMP.
  3835     05  BCPRM2F PIC  X(0001).
  3836     05  FILLER REDEFINES BCPRM2F.
  3837         10  BCPRM2A PIC  X(0001).
  3838     05  BCPRM2I PIC  X(0011).
  3839*    -------------------------------
  3840     05  BCAPRM2L PIC S9(0004) COMP.
  3841     05  BCAPRM2F PIC  X(0001).
  3842     05  FILLER REDEFINES BCAPRM2F.
  3843         10  BCAPRM2A PIC  X(0001).
  3844     05  BCAPRM2I PIC  X(0011).
  3845*    -------------------------------
  3846     05  BENABR2L PIC S9(0004) COMP.
  3847     05  BENABR2F PIC  X(0001).
  3848     05  FILLER REDEFINES BENABR2F.
  3849         10  BENABR2A PIC  X(0001).
  3850     05  BENABR2I PIC  X(0005).
  3851*    -------------------------------
  3852     05  BDIFF2L PIC S9(0004) COMP.
  3853     05  BDIFF2F PIC  X(0001).
  3854     05  FILLER REDEFINES BDIFF2F.
  3855         10  BDIFF2A PIC  X(0001).
  3856     05  BDIFF2I PIC  X(0011).
  3857*    -------------------------------
  3858     05  BBILIT2L PIC S9(0004) COMP.
  3859     05  BBILIT2F PIC  X(0001).
  3860     05  FILLER REDEFINES BBILIT2F.
  3861         10  BBILIT2A PIC  X(0001).
  3862     05  BBILIT2I PIC  X(0008).
  3863*    -------------------------------
  3864     05  BADIFF2L PIC S9(0004) COMP.
  3865     05  BADIFF2F PIC  X(0001).
  3866     05  FILLER REDEFINES BADIFF2F.
  3867         10  BADIFF2A PIC  X(0001).
  3868     05  BADIFF2I PIC  X(0011).
  3869*    -------------------------------
  3870     05  BERMSG1L PIC S9(0004) COMP.
  3871     05  BERMSG1F PIC  X(0001).
  3872     05  FILLER REDEFINES BERMSG1F.
  3873         10  BERMSG1A PIC  X(0001).
  3874     05  BERMSG1I PIC  X(0078).
  3875*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  74
* EL6311.cbl
  3876     05  BERMSG2L PIC S9(0004) COMP.
  3877     05  BERMSG2F PIC  X(0001).
  3878     05  FILLER REDEFINES BERMSG2F.
  3879         10  BERMSG2A PIC  X(0001).
  3880     05  BERMSG2I PIC  X(0078).
  3881*    -------------------------------
  3882     05  BERMSG3L PIC S9(0004) COMP.
  3883     05  BERMSG3F PIC  X(0001).
  3884     05  FILLER REDEFINES BERMSG3F.
  3885         10  BERMSG3A PIC  X(0001).
  3886     05  BERMSG3I PIC  X(0078).
  3887*    -------------------------------
  3888     05  BPFENTRL PIC S9(0004) COMP.
  3889     05  BPFENTRF PIC  X(0001).
  3890     05  FILLER REDEFINES BPFENTRF.
  3891         10  BPFENTRA PIC  X(0001).
  3892     05  BPFENTRI PIC  9(2).
  3893*    -------------------------------
  3894     05  BPF5HDRL PIC S9(0004) COMP.
  3895     05  BPF5HDRF PIC  X(0001).
  3896     05  FILLER REDEFINES BPF5HDRF.
  3897         10  BPF5HDRA PIC  X(0001).
  3898     05  BPF5HDRI PIC  X(0005).
  3899*    -------------------------------
  3900     05  BPF4HDRL PIC S9(0004) COMP.
  3901     05  BPF4HDRF PIC  X(0001).
  3902     05  FILLER REDEFINES BPF4HDRF.
  3903         10  BPF4HDRA PIC  X(0001).
  3904     05  BPF4HDRI PIC  X(0013).
  3905*    -------------------------------
  3906     05  BF15HDRL PIC S9(0004) COMP.
  3907     05  BF15HDRF PIC  X(0001).
  3908     05  FILLER REDEFINES BF15HDRF.
  3909         10  BF15HDRA PIC  X(0001).
  3910     05  BF15HDRI PIC  X(0010).
  3911 01  EL631BO REDEFINES EL631BI.
  3912     05  FILLER            PIC  X(0012).
  3913*    -------------------------------
  3914     05  FILLER            PIC  X(0003).
  3915     05  BDATEO PIC  X(0008).
  3916*    -------------------------------
  3917     05  FILLER            PIC  X(0003).
  3918     05  BTIMEO PIC  99.99.
  3919*    -------------------------------
  3920     05  FILLER            PIC  X(0003).
  3921     05  BHEADO PIC  X(0038).
  3922*    -------------------------------
  3923     05  FILLER            PIC  X(0003).
  3924     05  BNCERTLO PIC  X(0008).
  3925*    -------------------------------
  3926     05  FILLER            PIC  X(0003).
  3927     05  BNCERTO PIC  X(0011).
  3928*    -------------------------------
  3929     05  FILLER            PIC  X(0003).
  3930     05  BNSTATLO PIC  X(0009).
  3931*    -------------------------------
  3932     05  FILLER            PIC  X(0003).
  3933     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  75
* EL6311.cbl
  3934*    -------------------------------
  3935     05  FILLER            PIC  X(0003).
  3936     05  BCHGTO PIC  X(0004).
  3937*    -------------------------------
  3938     05  FILLER            PIC  X(0003).
  3939     05  BCHGO PIC  ZZZ9.
  3940*    -------------------------------
  3941     05  FILLER            PIC  X(0003).
  3942     05  BMAINTO PIC  X(0001).
  3943*    -------------------------------
  3944     05  FILLER            PIC  X(0003).
  3945     05  BMANTBYO PIC  X(0004).
  3946*    -------------------------------
  3947     05  FILLER            PIC  X(0003).
  3948     05  BCHGHDGO PIC  X(0003).
  3949*    -------------------------------
  3950     05  FILLER            PIC  X(0003).
  3951     05  BMANTDTO PIC  X(0008).
  3952*    -------------------------------
  3953     05  FILLER            PIC  X(0003).
  3954     05  BMANTATO PIC  99.99.
  3955*    -------------------------------
  3956     05  FILLER            PIC  X(0003).
  3957     05  BCSRO PIC  X(0004).
  3958*    -------------------------------
  3959     05  FILLER            PIC  X(0003).
  3960     05  BBATCHO PIC  X(0006).
  3961*    -------------------------------
  3962     05  FILLER            PIC  X(0003).
  3963     05  BSEQO PIC  X(0004).
  3964*    -------------------------------
  3965     05  FILLER            PIC  X(0003).
  3966     05  BMOENDTO PIC  X(0008).
  3967*    -------------------------------
  3968     05  FILLER            PIC  X(0003).
  3969     05  BCARRO PIC  X(0001).
  3970*    -------------------------------
  3971     05  FILLER            PIC  X(0003).
  3972     05  BGROUPO PIC  X(0006).
  3973*    -------------------------------
  3974     05  FILLER            PIC  X(0003).
  3975     05  BSTATEO PIC  X(0002).
  3976*    -------------------------------
  3977     05  FILLER            PIC  X(0003).
  3978     05  BACCTO PIC  X(0010).
  3979*    -------------------------------
  3980     05  FILLER            PIC  X(0003).
  3981     05  BVINHO PIC  X(0004).
  3982*    -------------------------------
  3983     05  FILLER            PIC  X(0003).
  3984     05  BVINO PIC  X(0017).
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BREFHDGO PIC  X(0004).
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BREFO PIC  X(0012).
  3991*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  76
* EL6311.cbl
  3992     05  FILLER            PIC  X(0003).
  3993     05  BAGEDEFO PIC  X(0004).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BCERTNOO PIC  X(0010).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BSUFIXO PIC  X(0001).
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BEFFDTO PIC  X(0008).
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BLSTNMO PIC  X(0015).
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  B1STNMO PIC  X(0010).
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BINITO PIC  X(0001).
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BSEXO PIC  X(0001).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BAGEO PIC  X(0002).
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BBIRTHO PIC  X(0008).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  B1STPMTO PIC  X(0008).
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BDAYSO PIC  X(0003).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BLNTRMO PIC  X(0003).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BLNOFCRO PIC  X(0005).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BMODEO PIC  X(0001).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BFREQO PIC  X(0002).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BPMTSO PIC  X(0003).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BPMTAMTO PIC  ZZZZZ9.99.
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BAPRO PIC  99.9999.
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  77
* EL6311.cbl
  4050     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BMEMCAPO PIC  X(0011).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BORIGHDO PIC  X(0009).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  DMDBILO PIC  X(0006).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BFORCEO PIC  X(0001).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BENTRYO PIC  X(0001).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BREINO PIC  X(0001).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BBILCDO PIC  X(0001).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BUNWRITO PIC  X(0001).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BSKPCDO PIC  X(0001).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BINDGRPO PIC  X(0001).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BSIGO PIC  X(0001).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BRTCLSO PIC  X(0002).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BCHGCNTO PIC  X(0003).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BMEMBERO PIC  X(0012).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BORGNOO PIC  X(0006).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BORGSEQO PIC  X(0004).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BKIND1O PIC  X(0002).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  78
* EL6311.cbl
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BTERM1O PIC  X(0003).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BBEN1O PIC  X(0012).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BPREM1O PIC  X(0011).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BEXPIR1O PIC  X(0008).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BCP1O PIC  X(0002).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BALTBN1O PIC  X(0012).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BALTPR1O PIC  X(0011).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BBNCD1O PIC  X(0003).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BCPRM1O PIC  X(0011).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BCAPRM1O PIC  X(0011).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BENABR1O PIC  X(0005).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BDIFF1O PIC  X(0011).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BBILIT1O PIC  X(0008).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BADIFF1O PIC  X(0011).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BKIND2O PIC  X(0002).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BTYPE2O PIC  X(0003).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BTERM2O PIC  X(0003).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BBEN2O PIC  X(0012).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BPREM2O PIC  X(0011).
  4165*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  79
* EL6311.cbl
  4166     05  FILLER            PIC  X(0003).
  4167     05  BEXPIR2O PIC  X(0008).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BCP2O PIC  X(0002).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BALTBN2O PIC  X(0012).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BALTPR2O PIC  X(0011).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BBNCD2O PIC  X(0003).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BCPRM2O PIC  X(0011).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BCAPRM2O PIC  X(0011).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BENABR2O PIC  X(0005).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BDIFF2O PIC  X(0011).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BBILIT2O PIC  X(0008).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BADIFF2O PIC  X(0011).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BERMSG1O PIC  X(0078).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BERMSG2O PIC  X(0078).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BERMSG3O PIC  X(0078).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BPFENTRO PIC  X(0002).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BPF5HDRO PIC  X(0005).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BPF4HDRO PIC  X(0013).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BF15HDRO PIC  X(0010).
  4219*    -------------------------------
  4220 01  EL631CI REDEFINES EL631BI.
  4221     05  FILLER            PIC  X(0012).
  4222*    -------------------------------
  4223     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  80
* EL6311.cbl
  4224     05  CDATEF PIC  X(0001).
  4225     05  FILLER REDEFINES CDATEF.
  4226         10  CDATEA PIC  X(0001).
  4227     05  CDATEI PIC  X(0008).
  4228*    -------------------------------
  4229     05  CTIMEL PIC S9(0004) COMP.
  4230     05  CTIMEF PIC  X(0001).
  4231     05  FILLER REDEFINES CTIMEF.
  4232         10  CTIMEA PIC  X(0001).
  4233     05  CTIMEI PIC  X(0005).
  4234*    -------------------------------
  4235     05  CHEADL PIC S9(0004) COMP.
  4236     05  CHEADF PIC  X(0001).
  4237     05  FILLER REDEFINES CHEADF.
  4238         10  CHEADA PIC  X(0001).
  4239     05  CHEADI PIC  X(0038).
  4240*    -------------------------------
  4241     05  CCHGTL PIC S9(0004) COMP.
  4242     05  CCHGTF PIC  X(0001).
  4243     05  FILLER REDEFINES CCHGTF.
  4244         10  CCHGTA PIC  X(0001).
  4245     05  CCHGTI PIC  X(0004).
  4246*    -------------------------------
  4247     05  CCHGL PIC S9(0004) COMP.
  4248     05  CCHGF PIC  X(0001).
  4249     05  FILLER REDEFINES CCHGF.
  4250         10  CCHGA PIC  X(0001).
  4251     05  CCHGI PIC  X(0004).
  4252*    -------------------------------
  4253     05  CMAINTL PIC S9(0004) COMP.
  4254     05  CMAINTF PIC  X(0001).
  4255     05  FILLER REDEFINES CMAINTF.
  4256         10  CMAINTA PIC  X(0001).
  4257     05  CMAINTI PIC  X(0001).
  4258*    -------------------------------
  4259     05  CMANTBYL PIC S9(0004) COMP.
  4260     05  CMANTBYF PIC  X(0001).
  4261     05  FILLER REDEFINES CMANTBYF.
  4262         10  CMANTBYA PIC  X(0001).
  4263     05  CMANTBYI PIC  X(0004).
  4264*    -------------------------------
  4265     05  CCHGHDGL PIC S9(0004) COMP.
  4266     05  CCHGHDGF PIC  X(0001).
  4267     05  FILLER REDEFINES CCHGHDGF.
  4268         10  CCHGHDGA PIC  X(0001).
  4269     05  CCHGHDGI PIC  X(0003).
  4270*    -------------------------------
  4271     05  CMANTDTL PIC S9(0004) COMP.
  4272     05  CMANTDTF PIC  X(0001).
  4273     05  FILLER REDEFINES CMANTDTF.
  4274         10  CMANTDTA PIC  X(0001).
  4275     05  CMANTDTI PIC  X(0008).
  4276*    -------------------------------
  4277     05  CMANTATL PIC S9(0004) COMP.
  4278     05  CMANTATF PIC  X(0001).
  4279     05  FILLER REDEFINES CMANTATF.
  4280         10  CMANTATA PIC  X(0001).
  4281     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  81
* EL6311.cbl
  4282*    -------------------------------
  4283     05  CCSRL PIC S9(0004) COMP.
  4284     05  CCSRF PIC  X(0001).
  4285     05  FILLER REDEFINES CCSRF.
  4286         10  CCSRA PIC  X(0001).
  4287     05  CCSRI PIC  X(0004).
  4288*    -------------------------------
  4289     05  CBATCHL PIC S9(0004) COMP.
  4290     05  CBATCHF PIC  X(0001).
  4291     05  FILLER REDEFINES CBATCHF.
  4292         10  CBATCHA PIC  X(0001).
  4293     05  CBATCHI PIC  X(0006).
  4294*    -------------------------------
  4295     05  CSEQL PIC S9(0004) COMP.
  4296     05  CSEQF PIC  X(0001).
  4297     05  FILLER REDEFINES CSEQF.
  4298         10  CSEQA PIC  X(0001).
  4299     05  CSEQI PIC  X(0004).
  4300*    -------------------------------
  4301     05  CMOENDTL PIC S9(0004) COMP.
  4302     05  CMOENDTF PIC  X(0001).
  4303     05  FILLER REDEFINES CMOENDTF.
  4304         10  CMOENDTA PIC  X(0001).
  4305     05  CMOENDTI PIC  X(0008).
  4306*    -------------------------------
  4307     05  CCARRL PIC S9(0004) COMP.
  4308     05  CCARRF PIC  X(0001).
  4309     05  FILLER REDEFINES CCARRF.
  4310         10  CCARRA PIC  X(0001).
  4311     05  CCARRI PIC  X(0001).
  4312*    -------------------------------
  4313     05  CGROUPL PIC S9(0004) COMP.
  4314     05  CGROUPF PIC  X(0001).
  4315     05  FILLER REDEFINES CGROUPF.
  4316         10  CGROUPA PIC  X(0001).
  4317     05  CGROUPI PIC  X(0006).
  4318*    -------------------------------
  4319     05  CSTATEL PIC S9(0004) COMP.
  4320     05  CSTATEF PIC  X(0001).
  4321     05  FILLER REDEFINES CSTATEF.
  4322         10  CSTATEA PIC  X(0001).
  4323     05  CSTATEI PIC  X(0002).
  4324*    -------------------------------
  4325     05  CACCTL PIC S9(0004) COMP.
  4326     05  CACCTF PIC  X(0001).
  4327     05  FILLER REDEFINES CACCTF.
  4328         10  CACCTA PIC  X(0001).
  4329     05  CACCTI PIC  X(0010).
  4330*    -------------------------------
  4331     05  CORIGHDL PIC S9(0004) COMP.
  4332     05  CORIGHDF PIC  X(0001).
  4333     05  FILLER REDEFINES CORIGHDF.
  4334         10  CORIGHDA PIC  X(0001).
  4335     05  CORIGHDI PIC  X(0011).
  4336*    -------------------------------
  4337     05  CORGNOL PIC S9(0004) COMP.
  4338     05  CORGNOF PIC  X(0001).
  4339     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  82
* EL6311.cbl
  4340         10  CORGNOA PIC  X(0001).
  4341     05  CORGNOI PIC  X(0006).
  4342*    -------------------------------
  4343     05  CORGSEQL PIC S9(0004) COMP.
  4344     05  CORGSEQF PIC  X(0001).
  4345     05  FILLER REDEFINES CORGSEQF.
  4346         10  CORGSEQA PIC  X(0001).
  4347     05  CORGSEQI PIC  X(0004).
  4348*    -------------------------------
  4349     05  CREFHDGL PIC S9(0004) COMP.
  4350     05  CREFHDGF PIC  X(0001).
  4351     05  FILLER REDEFINES CREFHDGF.
  4352         10  CREFHDGA PIC  X(0001).
  4353     05  CREFHDGI PIC  X(0010).
  4354*    -------------------------------
  4355     05  CREFL PIC S9(0004) COMP.
  4356     05  CREFF PIC  X(0001).
  4357     05  FILLER REDEFINES CREFF.
  4358         10  CREFA PIC  X(0001).
  4359     05  CREFI PIC  X(0012).
  4360*    -------------------------------
  4361     05  CNHINTL PIC S9(0004) COMP.
  4362     05  CNHINTF PIC  X(0001).
  4363     05  FILLER REDEFINES CNHINTF.
  4364         10  CNHINTA PIC  X(0001).
  4365     05  CNHINTI PIC  9(7)V99.
  4366*    -------------------------------
  4367     05  CCERTNOL PIC S9(0004) COMP.
  4368     05  CCERTNOF PIC  X(0001).
  4369     05  FILLER REDEFINES CCERTNOF.
  4370         10  CCERTNOA PIC  X(0001).
  4371     05  CCERTNOI PIC  X(0010).
  4372*    -------------------------------
  4373     05  CSUFIXL PIC S9(0004) COMP.
  4374     05  CSUFIXF PIC  X(0001).
  4375     05  FILLER REDEFINES CSUFIXF.
  4376         10  CSUFIXA PIC  X(0001).
  4377     05  CSUFIXI PIC  X(0001).
  4378*    -------------------------------
  4379     05  CEFFDTL PIC S9(0004) COMP.
  4380     05  CEFFDTF PIC  X(0001).
  4381     05  FILLER REDEFINES CEFFDTF.
  4382         10  CEFFDTA PIC  X(0001).
  4383     05  CEFFDTI PIC  X(0008).
  4384*    -------------------------------
  4385     05  CLSTNML PIC S9(0004) COMP.
  4386     05  CLSTNMF PIC  X(0001).
  4387     05  FILLER REDEFINES CLSTNMF.
  4388         10  CLSTNMA PIC  X(0001).
  4389     05  CLSTNMI PIC  X(0015).
  4390*    -------------------------------
  4391     05  CPCYNL PIC S9(0004) COMP.
  4392     05  CPCYNF PIC  X(0001).
  4393     05  FILLER REDEFINES CPCYNF.
  4394         10  CPCYNA PIC  X(0001).
  4395     05  CPCYNI PIC  X(0001).
  4396*    -------------------------------
  4397     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  83
* EL6311.cbl
  4398     05  CINAMEF PIC  X(0001).
  4399     05  FILLER REDEFINES CINAMEF.
  4400         10  CINAMEA PIC  X(0001).
  4401     05  CINAMEI PIC  X(0015).
  4402*    -------------------------------
  4403     05  CINITSL PIC S9(0004) COMP.
  4404     05  CINITSF PIC  X(0001).
  4405     05  FILLER REDEFINES CINITSF.
  4406         10  CINITSA PIC  X(0001).
  4407     05  CINITSI PIC  X(0010).
  4408*    -------------------------------
  4409     05  CCANREAL PIC S9(0004) COMP.
  4410     05  CCANREAF PIC  X(0001).
  4411     05  FILLER REDEFINES CCANREAF.
  4412         10  CCANREAA PIC  X(0001).
  4413     05  CCANREAI PIC  X(0001).
  4414*    -------------------------------
  4415     05  CKIND1L PIC S9(0004) COMP.
  4416     05  CKIND1F PIC  X(0001).
  4417     05  FILLER REDEFINES CKIND1F.
  4418         10  CKIND1A PIC  X(0001).
  4419     05  CKIND1I PIC  X(0002).
  4420*    -------------------------------
  4421     05  CCANDT1L PIC S9(0004) COMP.
  4422     05  CCANDT1F PIC  X(0001).
  4423     05  FILLER REDEFINES CCANDT1F.
  4424         10  CCANDT1A PIC  X(0001).
  4425     05  CCANDT1I PIC  X(0008).
  4426*    -------------------------------
  4427     05  CREFND1L PIC S9(0004) COMP.
  4428     05  CREFND1F PIC  X(0001).
  4429     05  FILLER REDEFINES CREFND1F.
  4430         10  CREFND1A PIC  X(0001).
  4431     05  CREFND1I PIC  S9(9)V99.
  4432*    -------------------------------
  4433     05  CMTHD1L PIC S9(0004) COMP.
  4434     05  CMTHD1F PIC  X(0001).
  4435     05  FILLER REDEFINES CMTHD1F.
  4436         10  CMTHD1A PIC  X(0001).
  4437     05  CMTHD1I PIC  X(0001).
  4438*    -------------------------------
  4439     05  CKIND2L PIC S9(0004) COMP.
  4440     05  CKIND2F PIC  X(0001).
  4441     05  FILLER REDEFINES CKIND2F.
  4442         10  CKIND2A PIC  X(0001).
  4443     05  CKIND2I PIC  X(0002).
  4444*    -------------------------------
  4445     05  CCANDT2L PIC S9(0004) COMP.
  4446     05  CCANDT2F PIC  X(0001).
  4447     05  FILLER REDEFINES CCANDT2F.
  4448         10  CCANDT2A PIC  X(0001).
  4449     05  CCANDT2I PIC  X(0008).
  4450*    -------------------------------
  4451     05  CREFND2L PIC S9(0004) COMP.
  4452     05  CREFND2F PIC  X(0001).
  4453     05  FILLER REDEFINES CREFND2F.
  4454         10  CREFND2A PIC  X(0001).
  4455     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  84
* EL6311.cbl
  4456*    -------------------------------
  4457     05  CMTHD2L PIC S9(0004) COMP.
  4458     05  CMTHD2F PIC  X(0001).
  4459     05  FILLER REDEFINES CMTHD2F.
  4460         10  CMTHD2A PIC  X(0001).
  4461     05  CMTHD2I PIC  X(0001).
  4462*    -------------------------------
  4463     05  CLIVESL PIC S9(0004) COMP.
  4464     05  CLIVESF PIC  X(0001).
  4465     05  FILLER REDEFINES CLIVESF.
  4466         10  CLIVESA PIC  X(0001).
  4467     05  CLIVESI PIC  X(0003).
  4468*    -------------------------------
  4469     05  CFORCEL PIC S9(0004) COMP.
  4470     05  CFORCEF PIC  X(0001).
  4471     05  FILLER REDEFINES CFORCEF.
  4472         10  CFORCEA PIC  X(0001).
  4473     05  CFORCEI PIC  X(0001).
  4474*    -------------------------------
  4475     05  CBILCDL PIC S9(0004) COMP.
  4476     05  CBILCDF PIC  X(0001).
  4477     05  FILLER REDEFINES CBILCDF.
  4478         10  CBILCDA PIC  X(0001).
  4479     05  CBILCDI PIC  X(0001).
  4480*    -------------------------------
  4481     05  CCRFND1L PIC S9(0004) COMP.
  4482     05  CCRFND1F PIC  X(0001).
  4483     05  FILLER REDEFINES CCRFND1F.
  4484         10  CCRFND1A PIC  X(0001).
  4485     05  CCRFND1I PIC  X(0011).
  4486*    -------------------------------
  4487     05  CCRFND2L PIC S9(0004) COMP.
  4488     05  CCRFND2F PIC  X(0001).
  4489     05  FILLER REDEFINES CCRFND2F.
  4490         10  CCRFND2A PIC  X(0001).
  4491     05  CCRFND2I PIC  X(0011).
  4492*    -------------------------------
  4493     05  CBILIT1L PIC S9(0004) COMP.
  4494     05  CBILIT1F PIC  X(0001).
  4495     05  FILLER REDEFINES CBILIT1F.
  4496         10  CBILIT1A PIC  X(0001).
  4497     05  CBILIT1I PIC  X(0008).
  4498*    -------------------------------
  4499     05  CDRFND1L PIC S9(0004) COMP.
  4500     05  CDRFND1F PIC  X(0001).
  4501     05  FILLER REDEFINES CDRFND1F.
  4502         10  CDRFND1A PIC  X(0001).
  4503     05  CDRFND1I PIC  X(0011).
  4504*    -------------------------------
  4505     05  CBILIT2L PIC S9(0004) COMP.
  4506     05  CBILIT2F PIC  X(0001).
  4507     05  FILLER REDEFINES CBILIT2F.
  4508         10  CBILIT2A PIC  X(0001).
  4509     05  CBILIT2I PIC  X(0008).
  4510*    -------------------------------
  4511     05  CDRFND2L PIC S9(0004) COMP.
  4512     05  CDRFND2F PIC  X(0001).
  4513     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  85
* EL6311.cbl
  4514         10  CDRFND2A PIC  X(0001).
  4515     05  CDRFND2I PIC  X(0011).
  4516*    -------------------------------
  4517     05  CCANTXTL PIC S9(0004) COMP.
  4518     05  CCANTXTF PIC  X(0001).
  4519     05  FILLER REDEFINES CCANTXTF.
  4520         10  CCANTXTA PIC  X(0001).
  4521     05  CCANTXTI PIC  X(0005).
  4522*    -------------------------------
  4523     05  CCANFEEL PIC S9(0004) COMP.
  4524     05  CCANFEEF PIC  X(0001).
  4525     05  FILLER REDEFINES CCANFEEF.
  4526         10  CCANFEEA PIC  X(0001).
  4527     05  CCANFEEI PIC  X(0002).
  4528*    -------------------------------
  4529     05  CTERM1L PIC S9(0004) COMP.
  4530     05  CTERM1F PIC  X(0001).
  4531     05  FILLER REDEFINES CTERM1F.
  4532         10  CTERM1A PIC  X(0001).
  4533     05  CTERM1I PIC  X(0003).
  4534*    -------------------------------
  4535     05  CRTERM1L PIC S9(0004) COMP.
  4536     05  CRTERM1F PIC  X(0001).
  4537     05  FILLER REDEFINES CRTERM1F.
  4538         10  CRTERM1A PIC  X(0001).
  4539     05  CRTERM1I PIC  X(0003).
  4540*    -------------------------------
  4541     05  CPREM1L PIC S9(0004) COMP.
  4542     05  CPREM1F PIC  X(0001).
  4543     05  FILLER REDEFINES CPREM1F.
  4544         10  CPREM1A PIC  X(0001).
  4545     05  CPREM1I PIC  X(0011).
  4546*    -------------------------------
  4547     05  CTERM2L PIC S9(0004) COMP.
  4548     05  CTERM2F PIC  X(0001).
  4549     05  FILLER REDEFINES CTERM2F.
  4550         10  CTERM2A PIC  X(0001).
  4551     05  CTERM2I PIC  X(0003).
  4552*    -------------------------------
  4553     05  CRTERM2L PIC S9(0004) COMP.
  4554     05  CRTERM2F PIC  X(0001).
  4555     05  FILLER REDEFINES CRTERM2F.
  4556         10  CRTERM2A PIC  X(0001).
  4557     05  CRTERM2I PIC  X(0003).
  4558*    -------------------------------
  4559     05  CPREM2L PIC S9(0004) COMP.
  4560     05  CPREM2F PIC  X(0001).
  4561     05  FILLER REDEFINES CPREM2F.
  4562         10  CPREM2A PIC  X(0001).
  4563     05  CPREM2I PIC  X(0011).
  4564*    -------------------------------
  4565     05  CENTRDTL PIC S9(0004) COMP.
  4566     05  CENTRDTF PIC  X(0001).
  4567     05  FILLER REDEFINES CENTRDTF.
  4568         10  CENTRDTA PIC  X(0001).
  4569     05  CENTRDTI PIC  X(0008).
  4570*    -------------------------------
  4571     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  86
* EL6311.cbl
  4572     05  CPAYEEF PIC  X(0001).
  4573     05  FILLER REDEFINES CPAYEEF.
  4574         10  CPAYEEA PIC  X(0001).
  4575     05  CPAYEEI PIC  X(0006).
  4576*    -------------------------------
  4577     05  CRFNDSWL PIC S9(0004) COMP.
  4578     05  CRFNDSWF PIC  X(0001).
  4579     05  FILLER REDEFINES CRFNDSWF.
  4580         10  CRFNDSWA PIC  X(0001).
  4581     05  CRFNDSWI PIC  X(0003).
  4582*    -------------------------------
  4583     05  CLFHDGL PIC S9(0004) COMP.
  4584     05  CLFHDGF PIC  X(0001).
  4585     05  FILLER REDEFINES CLFHDGF.
  4586         10  CLFHDGA PIC  X(0001).
  4587     05  CLFHDGI PIC  X(0006).
  4588*    -------------------------------
  4589     05  CAHHDGL PIC S9(0004) COMP.
  4590     05  CAHHDGF PIC  X(0001).
  4591     05  FILLER REDEFINES CAHHDGF.
  4592         10  CAHHDGA PIC  X(0001).
  4593     05  CAHHDGI PIC  X(0006).
  4594*    -------------------------------
  4595     05  CENTDTL PIC S9(0004) COMP.
  4596     05  CENTDTF PIC  X(0001).
  4597     05  FILLER REDEFINES CENTDTF.
  4598         10  CENTDTA PIC  X(0001).
  4599     05  CENTDTI PIC  X(0008).
  4600*    -------------------------------
  4601     05  CENTBYL PIC S9(0004) COMP.
  4602     05  CENTBYF PIC  X(0001).
  4603     05  FILLER REDEFINES CENTBYF.
  4604         10  CENTBYA PIC  X(0001).
  4605     05  CENTBYI PIC  X(0004).
  4606*    -------------------------------
  4607     05  CCHGCNTL PIC S9(0004) COMP.
  4608     05  CCHGCNTF PIC  X(0001).
  4609     05  FILLER REDEFINES CCHGCNTF.
  4610         10  CCHGCNTA PIC  X(0001).
  4611     05  CCHGCNTI PIC  X(0003).
  4612*    -------------------------------
  4613     05  CLFREFNL PIC S9(0004) COMP.
  4614     05  CLFREFNF PIC  X(0001).
  4615     05  FILLER REDEFINES CLFREFNF.
  4616         10  CLFREFNA PIC  X(0001).
  4617     05  CLFREFNI PIC  X(0006).
  4618*    -------------------------------
  4619     05  CAHREFNL PIC S9(0004) COMP.
  4620     05  CAHREFNF PIC  X(0001).
  4621     05  FILLER REDEFINES CAHREFNF.
  4622         10  CAHREFNA PIC  X(0001).
  4623     05  CAHREFNI PIC  X(0006).
  4624*    -------------------------------
  4625     05  CREINCDL PIC S9(0004) COMP.
  4626     05  CREINCDF PIC  X(0001).
  4627     05  FILLER REDEFINES CREINCDF.
  4628         10  CREINCDA PIC  X(0001).
  4629     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  87
* EL6311.cbl
  4630*    -------------------------------
  4631     05  CAEFFDTL PIC S9(0004) COMP.
  4632     05  CAEFFDTF PIC  X(0001).
  4633     05  FILLER REDEFINES CAEFFDTF.
  4634         10  CAEFFDTA PIC  X(0001).
  4635     05  CAEFFDTI PIC  X(0008).
  4636*    -------------------------------
  4637     05  CAEXPDTL PIC S9(0004) COMP.
  4638     05  CAEXPDTF PIC  X(0001).
  4639     05  FILLER REDEFINES CAEXPDTF.
  4640         10  CAEXPDTA PIC  X(0001).
  4641     05  CAEXPDTI PIC  X(0008).
  4642*    -------------------------------
  4643     05  COMMLFL PIC S9(0004) COMP.
  4644     05  COMMLFF PIC  X(0001).
  4645     05  FILLER REDEFINES COMMLFF.
  4646         10  COMMLFA PIC  X(0001).
  4647     05  COMMLFI PIC  X(0006).
  4648*    -------------------------------
  4649     05  COMMAHL PIC S9(0004) COMP.
  4650     05  COMMAHF PIC  X(0001).
  4651     05  FILLER REDEFINES COMMAHF.
  4652         10  COMMAHA PIC  X(0001).
  4653     05  COMMAHI PIC  X(0006).
  4654*    -------------------------------
  4655     05  CERMSG1L PIC S9(0004) COMP.
  4656     05  CERMSG1F PIC  X(0001).
  4657     05  FILLER REDEFINES CERMSG1F.
  4658         10  CERMSG1A PIC  X(0001).
  4659     05  CERMSG1I PIC  X(0078).
  4660*    -------------------------------
  4661     05  CERMSG2L PIC S9(0004) COMP.
  4662     05  CERMSG2F PIC  X(0001).
  4663     05  FILLER REDEFINES CERMSG2F.
  4664         10  CERMSG2A PIC  X(0001).
  4665     05  CERMSG2I PIC  X(0078).
  4666*    -------------------------------
  4667     05  CERMSG3L PIC S9(0004) COMP.
  4668     05  CERMSG3F PIC  X(0001).
  4669     05  FILLER REDEFINES CERMSG3F.
  4670         10  CERMSG3A PIC  X(0001).
  4671     05  CERMSG3I PIC  X(0078).
  4672*    -------------------------------
  4673     05  CPFENTRL PIC S9(0004) COMP.
  4674     05  CPFENTRF PIC  X(0001).
  4675     05  FILLER REDEFINES CPFENTRF.
  4676         10  CPFENTRA PIC  X(0001).
  4677     05  CPFENTRI PIC  9(2).
  4678*    -------------------------------
  4679     05  CPF5HDRL PIC S9(0004) COMP.
  4680     05  CPF5HDRF PIC  X(0001).
  4681     05  FILLER REDEFINES CPF5HDRF.
  4682         10  CPF5HDRA PIC  X(0001).
  4683     05  CPF5HDRI PIC  X(0005).
  4684*    -------------------------------
  4685     05  CPF4HDRL PIC S9(0004) COMP.
  4686     05  CPF4HDRF PIC  X(0001).
  4687     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  88
* EL6311.cbl
  4688         10  CPF4HDRA PIC  X(0001).
  4689     05  CPF4HDRI PIC  X(0013).
  4690*    -------------------------------
  4691     05  CF15HDRL PIC S9(0004) COMP.
  4692     05  CF15HDRF PIC  X(0001).
  4693     05  FILLER REDEFINES CF15HDRF.
  4694         10  CF15HDRA PIC  X(0001).
  4695     05  CF15HDRI PIC  X(0022).
  4696 01  EL631CO REDEFINES EL631BI.
  4697     05  FILLER            PIC  X(0012).
  4698*    -------------------------------
  4699     05  FILLER            PIC  X(0003).
  4700     05  CDATEO PIC  X(0008).
  4701*    -------------------------------
  4702     05  FILLER            PIC  X(0003).
  4703     05  CTIMEO PIC  99.99.
  4704*    -------------------------------
  4705     05  FILLER            PIC  X(0003).
  4706     05  CHEADO PIC  X(0038).
  4707*    -------------------------------
  4708     05  FILLER            PIC  X(0003).
  4709     05  CCHGTO PIC  X(0004).
  4710*    -------------------------------
  4711     05  FILLER            PIC  X(0003).
  4712     05  CCHGO PIC  ZZZ9.
  4713*    -------------------------------
  4714     05  FILLER            PIC  X(0003).
  4715     05  CMAINTO PIC  X(0001).
  4716*    -------------------------------
  4717     05  FILLER            PIC  X(0003).
  4718     05  CMANTBYO PIC  X(0004).
  4719*    -------------------------------
  4720     05  FILLER            PIC  X(0003).
  4721     05  CCHGHDGO PIC  X(0003).
  4722*    -------------------------------
  4723     05  FILLER            PIC  X(0003).
  4724     05  CMANTDTO PIC  X(0008).
  4725*    -------------------------------
  4726     05  FILLER            PIC  X(0003).
  4727     05  CMANTATO PIC  99.99.
  4728*    -------------------------------
  4729     05  FILLER            PIC  X(0003).
  4730     05  CCSRO PIC  X(0004).
  4731*    -------------------------------
  4732     05  FILLER            PIC  X(0003).
  4733     05  CBATCHO PIC  X(0006).
  4734*    -------------------------------
  4735     05  FILLER            PIC  X(0003).
  4736     05  CSEQO PIC  X(0004).
  4737*    -------------------------------
  4738     05  FILLER            PIC  X(0003).
  4739     05  CMOENDTO PIC  X(0008).
  4740*    -------------------------------
  4741     05  FILLER            PIC  X(0003).
  4742     05  CCARRO PIC  X(0001).
  4743*    -------------------------------
  4744     05  FILLER            PIC  X(0003).
  4745     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  89
* EL6311.cbl
  4746*    -------------------------------
  4747     05  FILLER            PIC  X(0003).
  4748     05  CSTATEO PIC  X(0002).
  4749*    -------------------------------
  4750     05  FILLER            PIC  X(0003).
  4751     05  CACCTO PIC  X(0010).
  4752*    -------------------------------
  4753     05  FILLER            PIC  X(0003).
  4754     05  CORIGHDO PIC  X(0011).
  4755*    -------------------------------
  4756     05  FILLER            PIC  X(0003).
  4757     05  CORGNOO PIC  X(0006).
  4758*    -------------------------------
  4759     05  FILLER            PIC  X(0003).
  4760     05  CORGSEQO PIC  X(0004).
  4761*    -------------------------------
  4762     05  FILLER            PIC  X(0003).
  4763     05  CREFHDGO PIC  X(0010).
  4764*    -------------------------------
  4765     05  FILLER            PIC  X(0003).
  4766     05  CREFO PIC  X(0012).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  CNHINTO PIC  999999.99.
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CCERTNOO PIC  X(0010).
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CSUFIXO PIC  X(0001).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CEFFDTO PIC  X(0008).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CLSTNMO PIC  X(0015).
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CPCYNO PIC  X(0001).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CINAMEO PIC  X(0015).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CINITSO PIC  X(0010).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CCANREAO PIC  X(0001).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CKIND1O PIC  X(0002).
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CCANDT1O PIC  X(0008).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CREFND1O PIC  Z(7).99-.
  4803*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  90
* EL6311.cbl
  4804     05  FILLER            PIC  X(0003).
  4805     05  CMTHD1O PIC  X(0001).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CKIND2O PIC  X(0002).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CCANDT2O PIC  X(0008).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CREFND2O PIC  Z(7).99-.
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CMTHD2O PIC  X(0001).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CLIVESO PIC  X(0003).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CFORCEO PIC  X(0001).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CBILCDO PIC  X(0001).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CCRFND1O PIC  Z(7).99-.
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CCRFND2O PIC  Z(7).99-.
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CBILIT1O PIC  X(0008).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CDRFND1O PIC  Z(7).99-.
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CBILIT2O PIC  X(0008).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CDRFND2O PIC  Z(7).99-.
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CCANTXTO PIC  X(0005).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CCANFEEO PIC  Z9.
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CTERM1O PIC  ZZ9.
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CRTERM1O PIC  ZZ9.
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CPREM1O PIC  ZZZZZZ9.99-.
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  91
* EL6311.cbl
  4862     05  CTERM2O PIC  ZZ9.
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CRTERM2O PIC  ZZ9.
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CPREM2O PIC  ZZZZZZ9.99-.
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CENTRDTO PIC  X(0008).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CPAYEEO PIC  X(0006).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CRFNDSWO PIC  X(0003).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CLFHDGO PIC  X(0006).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CAHHDGO PIC  X(0006).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CENTDTO PIC  X(0008).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CENTBYO PIC  X(0004).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CCHGCNTO PIC  X(0003).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CLFREFNO PIC  X(0006).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CAHREFNO PIC  X(0006).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CREINCDO PIC  X(0003).
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CAEFFDTO PIC  X(0008).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CAEXPDTO PIC  X(0008).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  COMMLFO PIC  .99999.
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  COMMAHO PIC  .99999.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CERMSG1O PIC  X(0078).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  92
* EL6311.cbl
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CERMSG3O PIC  X(0078).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CPFENTRO PIC  X(0002).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CPF5HDRO PIC  X(0005).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CPF4HDRO PIC  X(0013).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CF15HDRO PIC  X(0022).
  4935*    -------------------------------
  4936 01  EL631DI REDEFINES EL631BI.
  4937     05  FILLER            PIC  X(0012).
  4938*    -------------------------------
  4939     05  DDATEL PIC S9(0004) COMP.
  4940     05  DDATEF PIC  X(0001).
  4941     05  FILLER REDEFINES DDATEF.
  4942         10  DDATEA PIC  X(0001).
  4943     05  DDATEI PIC  X(0008).
  4944*    -------------------------------
  4945     05  DTIMEL PIC S9(0004) COMP.
  4946     05  DTIMEF PIC  X(0001).
  4947     05  FILLER REDEFINES DTIMEF.
  4948         10  DTIMEA PIC  X(0001).
  4949     05  DTIMEI PIC  X(0005).
  4950*    -------------------------------
  4951     05  DHEADL PIC S9(0004) COMP.
  4952     05  DHEADF PIC  X(0001).
  4953     05  FILLER REDEFINES DHEADF.
  4954         10  DHEADA PIC  X(0001).
  4955     05  DHEADI PIC  X(0038).
  4956*    -------------------------------
  4957     05  DLDATEL PIC S9(0004) COMP.
  4958     05  DLDATEF PIC  X(0001).
  4959     05  FILLER REDEFINES DLDATEF.
  4960         10  DLDATEA PIC  X(0001).
  4961     05  DLDATEI PIC  X(0010).
  4962*    -------------------------------
  4963     05  DBATCHL PIC S9(0004) COMP.
  4964     05  DBATCHF PIC  X(0001).
  4965     05  FILLER REDEFINES DBATCHF.
  4966         10  DBATCHA PIC  X(0001).
  4967     05  DBATCHI PIC  X(0011).
  4968*    -------------------------------
  4969     05  DACCTNML PIC S9(0004) COMP.
  4970     05  DACCTNMF PIC  X(0001).
  4971     05  FILLER REDEFINES DACCTNMF.
  4972         10  DACCTNMA PIC  X(0001).
  4973     05  DACCTNMI PIC  X(0030).
  4974*    -------------------------------
  4975     05  DPROCDTL PIC S9(0004) COMP.
  4976     05  DPROCDTF PIC  X(0001).
  4977     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  93
* EL6311.cbl
  4978         10  DPROCDTA PIC  X(0001).
  4979     05  DPROCDTI PIC  X(0008).
  4980*    -------------------------------
  4981     05  DINPUTL PIC S9(0004) COMP.
  4982     05  DINPUTF PIC  X(0001).
  4983     05  FILLER REDEFINES DINPUTF.
  4984         10  DINPUTA PIC  X(0001).
  4985     05  DINPUTI PIC  X(0008).
  4986*    -------------------------------
  4987     05  DMAINDTL PIC S9(0004) COMP.
  4988     05  DMAINDTF PIC  X(0001).
  4989     05  FILLER REDEFINES DMAINDTF.
  4990         10  DMAINDTA PIC  X(0001).
  4991     05  DMAINDTI PIC  X(0008).
  4992*    -------------------------------
  4993     05  DCARRL PIC S9(0004) COMP.
  4994     05  DCARRF PIC  X(0001).
  4995     05  FILLER REDEFINES DCARRF.
  4996         10  DCARRA PIC  X(0001).
  4997     05  DCARRI PIC  X(0001).
  4998*    -------------------------------
  4999     05  DGROUPL PIC S9(0004) COMP.
  5000     05  DGROUPF PIC  X(0001).
  5001     05  FILLER REDEFINES DGROUPF.
  5002         10  DGROUPA PIC  X(0001).
  5003     05  DGROUPI PIC  X(0006).
  5004*    -------------------------------
  5005     05  DSTATEL PIC S9(0004) COMP.
  5006     05  DSTATEF PIC  X(0001).
  5007     05  FILLER REDEFINES DSTATEF.
  5008         10  DSTATEA PIC  X(0001).
  5009     05  DSTATEI PIC  X(0002).
  5010*    -------------------------------
  5011     05  DACCTL PIC S9(0004) COMP.
  5012     05  DACCTF PIC  X(0001).
  5013     05  FILLER REDEFINES DACCTF.
  5014         10  DACCTA PIC  X(0001).
  5015     05  DACCTI PIC  X(0010).
  5016*    -------------------------------
  5017     05  DRECVDTL PIC S9(0004) COMP.
  5018     05  DRECVDTF PIC  X(0001).
  5019     05  FILLER REDEFINES DRECVDTF.
  5020         10  DRECVDTA PIC  X(0001).
  5021     05  DRECVDTI PIC  X(0008).
  5022*    -------------------------------
  5023     05  DCSRL PIC S9(0004) COMP.
  5024     05  DCSRF PIC  X(0001).
  5025     05  FILLER REDEFINES DCSRF.
  5026         10  DCSRA PIC  X(0001).
  5027     05  DCSRI PIC  X(0004).
  5028*    -------------------------------
  5029     05  DREFHDGL PIC S9(0004) COMP.
  5030     05  DREFHDGF PIC  X(0001).
  5031     05  FILLER REDEFINES DREFHDGF.
  5032         10  DREFHDGA PIC  X(0001).
  5033     05  DREFHDGI PIC  X(0010).
  5034*    -------------------------------
  5035     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  94
* EL6311.cbl
  5036     05  DREFF PIC  X(0001).
  5037     05  FILLER REDEFINES DREFF.
  5038         10  DREFA PIC  X(0001).
  5039     05  DREFI PIC  X(0012).
  5040*    -------------------------------
  5041     05  DLFPHDGL PIC S9(0004) COMP.
  5042     05  DLFPHDGF PIC  X(0001).
  5043     05  FILLER REDEFINES DLFPHDGF.
  5044         10  DLFPHDGA PIC  X(0001).
  5045     05  DLFPHDGI PIC  X(0010).
  5046*    -------------------------------
  5047     05  DAHPHDGL PIC S9(0004) COMP.
  5048     05  DAHPHDGF PIC  X(0001).
  5049     05  FILLER REDEFINES DAHPHDGF.
  5050         10  DAHPHDGA PIC  X(0001).
  5051     05  DAHPHDGI PIC  X(0010).
  5052*    -------------------------------
  5053     05  DLFRHDGL PIC S9(0004) COMP.
  5054     05  DLFRHDGF PIC  X(0001).
  5055     05  FILLER REDEFINES DLFRHDGF.
  5056         10  DLFRHDGA PIC  X(0001).
  5057     05  DLFRHDGI PIC  X(0009).
  5058*    -------------------------------
  5059     05  DAHRHDGL PIC S9(0004) COMP.
  5060     05  DAHRHDGF PIC  X(0001).
  5061     05  FILLER REDEFINES DAHRHDGF.
  5062         10  DAHRHDGA PIC  X(0001).
  5063     05  DAHRHDGI PIC  X(0009).
  5064*    -------------------------------
  5065     05  DRISSL PIC S9(0004) COMP.
  5066     05  DRISSF PIC  X(0001).
  5067     05  FILLER REDEFINES DRISSF.
  5068         10  DRISSA PIC  X(0001).
  5069     05  DRISSI PIC  X(0005).
  5070*    -------------------------------
  5071     05  DRLFPRML PIC S9(0004) COMP.
  5072     05  DRLFPRMF PIC  X(0001).
  5073     05  FILLER REDEFINES DRLFPRMF.
  5074         10  DRLFPRMA PIC  X(0001).
  5075     05  DRLFPRMI PIC  S9(9)V99.
  5076*    -------------------------------
  5077     05  DRAHPRML PIC S9(0004) COMP.
  5078     05  DRAHPRMF PIC  X(0001).
  5079     05  FILLER REDEFINES DRAHPRMF.
  5080         10  DRAHPRMA PIC  X(0001).
  5081     05  DRAHPRMI PIC  S9(9)V99.
  5082*    -------------------------------
  5083     05  DRCANCL PIC S9(0004) COMP.
  5084     05  DRCANCF PIC  X(0001).
  5085     05  FILLER REDEFINES DRCANCF.
  5086         10  DRCANCA PIC  X(0001).
  5087     05  DRCANCI PIC  X(0005).
  5088*    -------------------------------
  5089     05  DRLFRFDL PIC S9(0004) COMP.
  5090     05  DRLFRFDF PIC  X(0001).
  5091     05  FILLER REDEFINES DRLFRFDF.
  5092         10  DRLFRFDA PIC  X(0001).
  5093     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  95
* EL6311.cbl
  5094*    -------------------------------
  5095     05  DRAHRFDL PIC S9(0004) COMP.
  5096     05  DRAHRFDF PIC  X(0001).
  5097     05  FILLER REDEFINES DRAHRFDF.
  5098         10  DRAHRFDA PIC  X(0001).
  5099     05  DRAHRFDI PIC  S9(9)V99.
  5100*    -------------------------------
  5101     05  DEISSL PIC S9(0004) COMP.
  5102     05  DEISSF PIC  X(0001).
  5103     05  FILLER REDEFINES DEISSF.
  5104         10  DEISSA PIC  X(0001).
  5105     05  DEISSI PIC  X(0005).
  5106*    -------------------------------
  5107     05  DELFPRML PIC S9(0004) COMP.
  5108     05  DELFPRMF PIC  X(0001).
  5109     05  FILLER REDEFINES DELFPRMF.
  5110         10  DELFPRMA PIC  X(0001).
  5111     05  DELFPRMI PIC  X(0011).
  5112*    -------------------------------
  5113     05  DEAHPRML PIC S9(0004) COMP.
  5114     05  DEAHPRMF PIC  X(0001).
  5115     05  FILLER REDEFINES DEAHPRMF.
  5116         10  DEAHPRMA PIC  X(0001).
  5117     05  DEAHPRMI PIC  X(0011).
  5118*    -------------------------------
  5119     05  DECANCL PIC S9(0004) COMP.
  5120     05  DECANCF PIC  X(0001).
  5121     05  FILLER REDEFINES DECANCF.
  5122         10  DECANCA PIC  X(0001).
  5123     05  DECANCI PIC  X(0005).
  5124*    -------------------------------
  5125     05  DELFRFDL PIC S9(0004) COMP.
  5126     05  DELFRFDF PIC  X(0001).
  5127     05  FILLER REDEFINES DELFRFDF.
  5128         10  DELFRFDA PIC  X(0001).
  5129     05  DELFRFDI PIC  X(0011).
  5130*    -------------------------------
  5131     05  DEAHRFDL PIC S9(0004) COMP.
  5132     05  DEAHRFDF PIC  X(0001).
  5133     05  FILLER REDEFINES DEAHRFDF.
  5134         10  DEAHRFDA PIC  X(0001).
  5135     05  DEAHRFDI PIC  X(0011).
  5136*    -------------------------------
  5137     05  DCISSL PIC S9(0004) COMP.
  5138     05  DCISSF PIC  X(0001).
  5139     05  FILLER REDEFINES DCISSF.
  5140         10  DCISSA PIC  X(0001).
  5141     05  DCISSI PIC  X(0005).
  5142*    -------------------------------
  5143     05  DCLFPRML PIC S9(0004) COMP.
  5144     05  DCLFPRMF PIC  X(0001).
  5145     05  FILLER REDEFINES DCLFPRMF.
  5146         10  DCLFPRMA PIC  X(0001).
  5147     05  DCLFPRMI PIC  X(0011).
  5148*    -------------------------------
  5149     05  DCAHPRML PIC S9(0004) COMP.
  5150     05  DCAHPRMF PIC  X(0001).
  5151     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  96
* EL6311.cbl
  5152         10  DCAHPRMA PIC  X(0001).
  5153     05  DCAHPRMI PIC  X(0011).
  5154*    -------------------------------
  5155     05  DCCANCL PIC S9(0004) COMP.
  5156     05  DCCANCF PIC  X(0001).
  5157     05  FILLER REDEFINES DCCANCF.
  5158         10  DCCANCA PIC  X(0001).
  5159     05  DCCANCI PIC  X(0005).
  5160*    -------------------------------
  5161     05  DCLFRFDL PIC S9(0004) COMP.
  5162     05  DCLFRFDF PIC  X(0001).
  5163     05  FILLER REDEFINES DCLFRFDF.
  5164         10  DCLFRFDA PIC  X(0001).
  5165     05  DCLFRFDI PIC  X(0011).
  5166*    -------------------------------
  5167     05  DCAHRFDL PIC S9(0004) COMP.
  5168     05  DCAHRFDF PIC  X(0001).
  5169     05  FILLER REDEFINES DCAHRFDF.
  5170         10  DCAHRFDA PIC  X(0001).
  5171     05  DCAHRFDI PIC  X(0011).
  5172*    -------------------------------
  5173     05  DOISSL PIC S9(0004) COMP.
  5174     05  DOISSF PIC  X(0001).
  5175     05  FILLER REDEFINES DOISSF.
  5176         10  DOISSA PIC  X(0001).
  5177     05  DOISSI PIC  X(0005).
  5178*    -------------------------------
  5179     05  DOLFPRML PIC S9(0004) COMP.
  5180     05  DOLFPRMF PIC  X(0001).
  5181     05  FILLER REDEFINES DOLFPRMF.
  5182         10  DOLFPRMA PIC  X(0001).
  5183     05  DOLFPRMI PIC  X(0011).
  5184*    -------------------------------
  5185     05  DOAHPRML PIC S9(0004) COMP.
  5186     05  DOAHPRMF PIC  X(0001).
  5187     05  FILLER REDEFINES DOAHPRMF.
  5188         10  DOAHPRMA PIC  X(0001).
  5189     05  DOAHPRMI PIC  X(0011).
  5190*    -------------------------------
  5191     05  DOCANCL PIC S9(0004) COMP.
  5192     05  DOCANCF PIC  X(0001).
  5193     05  FILLER REDEFINES DOCANCF.
  5194         10  DOCANCA PIC  X(0001).
  5195     05  DOCANCI PIC  X(0005).
  5196*    -------------------------------
  5197     05  DOLFRFDL PIC S9(0004) COMP.
  5198     05  DOLFRFDF PIC  X(0001).
  5199     05  FILLER REDEFINES DOLFRFDF.
  5200         10  DOLFRFDA PIC  X(0001).
  5201     05  DOLFRFDI PIC  X(0011).
  5202*    -------------------------------
  5203     05  DOAHRFDL PIC S9(0004) COMP.
  5204     05  DOAHRFDF PIC  X(0001).
  5205     05  FILLER REDEFINES DOAHRFDF.
  5206         10  DOAHRFDA PIC  X(0001).
  5207     05  DOAHRFDI PIC  X(0011).
  5208*    -------------------------------
  5209     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  97
* EL6311.cbl
  5210     05  DITOTALF PIC  X(0001).
  5211     05  FILLER REDEFINES DITOTALF.
  5212         10  DITOTALA PIC  X(0001).
  5213     05  DITOTALI PIC  X(0005).
  5214*    -------------------------------
  5215     05  DIFATALL PIC S9(0004) COMP.
  5216     05  DIFATALF PIC  X(0001).
  5217     05  FILLER REDEFINES DIFATALF.
  5218         10  DIFATALA PIC  X(0001).
  5219     05  DIFATALI PIC  X(0005).
  5220*    -------------------------------
  5221     05  DIFORCEL PIC S9(0004) COMP.
  5222     05  DIFORCEF PIC  X(0001).
  5223     05  FILLER REDEFINES DIFORCEF.
  5224         10  DIFORCEA PIC  X(0001).
  5225     05  DIFORCEI PIC  X(0005).
  5226*    -------------------------------
  5227     05  DIHOLDL PIC S9(0004) COMP.
  5228     05  DIHOLDF PIC  X(0001).
  5229     05  FILLER REDEFINES DIHOLDF.
  5230         10  DIHOLDA PIC  X(0001).
  5231     05  DIHOLDI PIC  X(0005).
  5232*    -------------------------------
  5233     05  DIAVAILL PIC S9(0004) COMP.
  5234     05  DIAVAILF PIC  X(0001).
  5235     05  FILLER REDEFINES DIAVAILF.
  5236         10  DIAVAILA PIC  X(0001).
  5237     05  DIAVAILI PIC  X(0005).
  5238*    -------------------------------
  5239     05  DIGPREML PIC S9(0004) COMP.
  5240     05  DIGPREMF PIC  X(0001).
  5241     05  FILLER REDEFINES DIGPREMF.
  5242         10  DIGPREMA PIC  X(0001).
  5243     05  DIGPREMI PIC  X(0011).
  5244*    -------------------------------
  5245     05  DIBPREML PIC S9(0004) COMP.
  5246     05  DIBPREMF PIC  X(0001).
  5247     05  FILLER REDEFINES DIBPREMF.
  5248         10  DIBPREMA PIC  X(0001).
  5249     05  DIBPREMI PIC  X(0011).
  5250*    -------------------------------
  5251     05  DCTOTALL PIC S9(0004) COMP.
  5252     05  DCTOTALF PIC  X(0001).
  5253     05  FILLER REDEFINES DCTOTALF.
  5254         10  DCTOTALA PIC  X(0001).
  5255     05  DCTOTALI PIC  X(0005).
  5256*    -------------------------------
  5257     05  DCFATALL PIC S9(0004) COMP.
  5258     05  DCFATALF PIC  X(0001).
  5259     05  FILLER REDEFINES DCFATALF.
  5260         10  DCFATALA PIC  X(0001).
  5261     05  DCFATALI PIC  X(0005).
  5262*    -------------------------------
  5263     05  DCFORCEL PIC S9(0004) COMP.
  5264     05  DCFORCEF PIC  X(0001).
  5265     05  FILLER REDEFINES DCFORCEF.
  5266         10  DCFORCEA PIC  X(0001).
  5267     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  98
* EL6311.cbl
  5268*    -------------------------------
  5269     05  DCHOLDL PIC S9(0004) COMP.
  5270     05  DCHOLDF PIC  X(0001).
  5271     05  FILLER REDEFINES DCHOLDF.
  5272         10  DCHOLDA PIC  X(0001).
  5273     05  DCHOLDI PIC  X(0005).
  5274*    -------------------------------
  5275     05  DCAVAILL PIC S9(0004) COMP.
  5276     05  DCAVAILF PIC  X(0001).
  5277     05  FILLER REDEFINES DCAVAILF.
  5278         10  DCAVAILA PIC  X(0001).
  5279     05  DCAVAILI PIC  X(0005).
  5280*    -------------------------------
  5281     05  DCGPREML PIC S9(0004) COMP.
  5282     05  DCGPREMF PIC  X(0001).
  5283     05  FILLER REDEFINES DCGPREMF.
  5284         10  DCGPREMA PIC  X(0001).
  5285     05  DCGPREMI PIC  X(0011).
  5286*    -------------------------------
  5287     05  DCBPREML PIC S9(0004) COMP.
  5288     05  DCBPREMF PIC  X(0001).
  5289     05  FILLER REDEFINES DCBPREMF.
  5290         10  DCBPREMA PIC  X(0001).
  5291     05  DCBPREMI PIC  X(0011).
  5292*    -------------------------------
  5293     05  DNTOTALL PIC S9(0004) COMP.
  5294     05  DNTOTALF PIC  X(0001).
  5295     05  FILLER REDEFINES DNTOTALF.
  5296         10  DNTOTALA PIC  X(0001).
  5297     05  DNTOTALI PIC  X(0005).
  5298*    -------------------------------
  5299     05  DNFATALL PIC S9(0004) COMP.
  5300     05  DNFATALF PIC  X(0001).
  5301     05  FILLER REDEFINES DNFATALF.
  5302         10  DNFATALA PIC  X(0001).
  5303     05  DNFATALI PIC  X(0005).
  5304*    -------------------------------
  5305     05  DNFORCEL PIC S9(0004) COMP.
  5306     05  DNFORCEF PIC  X(0001).
  5307     05  FILLER REDEFINES DNFORCEF.
  5308         10  DNFORCEA PIC  X(0001).
  5309     05  DNFORCEI PIC  X(0005).
  5310*    -------------------------------
  5311     05  DNHOLDL PIC S9(0004) COMP.
  5312     05  DNHOLDF PIC  X(0001).
  5313     05  FILLER REDEFINES DNHOLDF.
  5314         10  DNHOLDA PIC  X(0001).
  5315     05  DNHOLDI PIC  X(0005).
  5316*    -------------------------------
  5317     05  DNAVAILL PIC S9(0004) COMP.
  5318     05  DNAVAILF PIC  X(0001).
  5319     05  FILLER REDEFINES DNAVAILF.
  5320         10  DNAVAILA PIC  X(0001).
  5321     05  DNAVAILI PIC  X(0005).
  5322*    -------------------------------
  5323     05  DNGPREML PIC S9(0004) COMP.
  5324     05  DNGPREMF PIC  X(0001).
  5325     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page  99
* EL6311.cbl
  5326         10  DNGPREMA PIC  X(0001).
  5327     05  DNGPREMI PIC  X(0011).
  5328*    -------------------------------
  5329     05  DNBPREML PIC S9(0004) COMP.
  5330     05  DNBPREMF PIC  X(0001).
  5331     05  FILLER REDEFINES DNBPREMF.
  5332         10  DNBPREMA PIC  X(0001).
  5333     05  DNBPREMI PIC  X(0011).
  5334*    -------------------------------
  5335     05  DERMSGL PIC S9(0004) COMP.
  5336     05  DERMSGF PIC  X(0001).
  5337     05  FILLER REDEFINES DERMSGF.
  5338         10  DERMSGA PIC  X(0001).
  5339     05  DERMSGI PIC  X(0075).
  5340*    -------------------------------
  5341     05  DPFENTRL PIC S9(0004) COMP.
  5342     05  DPFENTRF PIC  X(0001).
  5343     05  FILLER REDEFINES DPFENTRF.
  5344         10  DPFENTRA PIC  X(0001).
  5345     05  DPFENTRI PIC  9(2).
  5346 01  EL631DO REDEFINES EL631BI.
  5347     05  FILLER            PIC  X(0012).
  5348*    -------------------------------
  5349     05  FILLER            PIC  X(0003).
  5350     05  DDATEO PIC  X(0008).
  5351*    -------------------------------
  5352     05  FILLER            PIC  X(0003).
  5353     05  DTIMEO PIC  99.99.
  5354*    -------------------------------
  5355     05  FILLER            PIC  X(0003).
  5356     05  DHEADO PIC  X(0038).
  5357*    -------------------------------
  5358     05  FILLER            PIC  X(0003).
  5359     05  DLDATEO PIC  X(0010).
  5360*    -------------------------------
  5361     05  FILLER            PIC  X(0003).
  5362     05  DBATCHO PIC  X(0011).
  5363*    -------------------------------
  5364     05  FILLER            PIC  X(0003).
  5365     05  DACCTNMO PIC  X(0030).
  5366*    -------------------------------
  5367     05  FILLER            PIC  X(0003).
  5368     05  DPROCDTO PIC  X(0008).
  5369*    -------------------------------
  5370     05  FILLER            PIC  X(0003).
  5371     05  DINPUTO PIC  X(0008).
  5372*    -------------------------------
  5373     05  FILLER            PIC  X(0003).
  5374     05  DMAINDTO PIC  X(0008).
  5375*    -------------------------------
  5376     05  FILLER            PIC  X(0003).
  5377     05  DCARRO PIC  X(0001).
  5378*    -------------------------------
  5379     05  FILLER            PIC  X(0003).
  5380     05  DGROUPO PIC  X(0006).
  5381*    -------------------------------
  5382     05  FILLER            PIC  X(0003).
  5383     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 100
* EL6311.cbl
  5384*    -------------------------------
  5385     05  FILLER            PIC  X(0003).
  5386     05  DACCTO PIC  X(0010).
  5387*    -------------------------------
  5388     05  FILLER            PIC  X(0003).
  5389     05  DRECVDTO PIC  X(0008).
  5390*    -------------------------------
  5391     05  FILLER            PIC  X(0003).
  5392     05  DCSRO PIC  X(0004).
  5393*    -------------------------------
  5394     05  FILLER            PIC  X(0003).
  5395     05  DREFHDGO PIC  X(0010).
  5396*    -------------------------------
  5397     05  FILLER            PIC  X(0003).
  5398     05  DREFO PIC  X(0012).
  5399*    -------------------------------
  5400     05  FILLER            PIC  X(0003).
  5401     05  DLFPHDGO PIC  X(0010).
  5402*    -------------------------------
  5403     05  FILLER            PIC  X(0003).
  5404     05  DAHPHDGO PIC  X(0010).
  5405*    -------------------------------
  5406     05  FILLER            PIC  X(0003).
  5407     05  DLFRHDGO PIC  X(0009).
  5408*    -------------------------------
  5409     05  FILLER            PIC  X(0003).
  5410     05  DAHRHDGO PIC  X(0009).
  5411*    -------------------------------
  5412     05  FILLER            PIC  X(0003).
  5413     05  DRISSO PIC  ZZ99-.
  5414*    -------------------------------
  5415     05  FILLER            PIC  X(0003).
  5416     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5417*    -------------------------------
  5418     05  FILLER            PIC  X(0003).
  5419     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DRCANCO PIC  ZZ99-.
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DEISSO PIC  ZZ99-.
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DECANCO PIC  ZZ99-.
  5441*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 101
* EL6311.cbl
  5442     05  FILLER            PIC  X(0003).
  5443     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DCISSO PIC  ZZ99-.
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DCCANCO PIC  ZZ99-.
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DOISSO PIC  ZZ99-.
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DOCANCO PIC  ZZ99-.
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DITOTALO PIC  ZZZ99.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DIFATALO PIC  ZZZ99.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DIFORCEO PIC  ZZZ99.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DIHOLDO PIC  ZZZ99.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DIAVAILO PIC  ZZZ99.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 102
* EL6311.cbl
  5500     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DCTOTALO PIC  ZZZ99.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DCFATALO PIC  ZZZ99.
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DCFORCEO PIC  ZZZ99.
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DCHOLDO PIC  ZZZ99.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DCAVAILO PIC  ZZZ99.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DNTOTALO PIC  ---99.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DNFATALO PIC  ---99.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DNFORCEO PIC  ---99.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DNHOLDO PIC  ---99.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DNAVAILO PIC  ---99.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DNGPREMO PIC  -------9.99.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DNBPREMO PIC  -------9.99.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DERMSGO PIC  X(0075).
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DPFENTRO PIC  X(0002).
  5552*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 103
* EL6311.cbl
  5554 01  MAP-B REDEFINES EL631BI.
  5555     12  FILLER                  PIC X(569).
  5556*    12  FILLER                  PIC X(512).
  5557*    12  FILLER                  PIC X(510).
  5558     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5559         16  BKIND-LEN               PIC S9(4)  COMP.
  5560         16  BKIND-ATTRB             PIC X.
  5561         16  BKIND                   PIC XX.
  5562         16  BTYPE-LEN               PIC S9(4)  COMP.
  5563         16  BTYPE-ATTRB             PIC X.
  5564         16  BTYPE                   PIC X(3).
  5565         16  BTERM-LEN               PIC S9(4)  COMP.
  5566         16  BTERM-ATTRB             PIC X.
  5567         16  BTERMI                  PIC 999.
  5568         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5569         16  BBEN-LEN                PIC S9(4)  COMP.
  5570         16  BBEN-ATTRB              PIC X.
  5571         16  BBENI                   PIC 9(10)V99.
  5572*        16  BBENI                   PIC 9(12).
  5573         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5574         16  BPREM-LEN               PIC S9(4)  COMP.
  5575         16  BPREM-ATTRB             PIC X.
  5576         16  BPREMI                  PIC S9(9)V99.
  5577*        16  BPREMI                  PIC 9(11).
  5578         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5579         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5580         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5581         16  BEXPIRE-ATTRB           PIC X.
  5582         16  BEXPIRE                 PIC X(8).
  5583         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5584         16  BCRIT-PERD-ATTRB        PIC X.
  5585         16  BCRIT-PERDI             PIC 99.
  5586         16  BCRIT-PERDO REDEFINES
  5587                         BCRIT-PERDI PIC ZZ.
  5588         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5589         16  BALT-BEN-ATTRB          PIC X.
  5590         16  BALT-BENI               PIC 9(10)V99.
  5591*        16  BALT-BENI               PIC 9(12).
  5592         16  BALT-BENO REDEFINES
  5593                           BALT-BENI PIC Z(9).ZZ.
  5594         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5595         16  BALT-PREM-ATTRB         PIC X.
  5596         16  BALT-PREMI              PIC 9(9)V99.
  5597*        16  BALT-PREMI              PIC 9(11).
  5598         16  BALT-PREMO REDEFINES
  5599                          BALT-PREMI PIC Z(7).ZZ-.
  5600         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5601         16  BBEN-CD-ATTRB           PIC X.
  5602         16  BBEN-CD                 PIC XXX.
  5603         16  BCPREM-LEN              PIC S9(4)  COMP.
  5604         16  BCPREM-ATTRB            PIC X.
  5605         16  BCPREMI                 PIC S9(9)V99.
  5606*        16  BCPREMI                 PIC X(11).
  5607         16  BCPREMO REDEFINES BCPREMI
  5608                                     PIC Z(7).99-.
  5609         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5610         16  BCALT-PREM-ATTRB        PIC X.
  5611         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 104
* EL6311.cbl
  5612         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5613         16  BBEN-ABBR-ATTRB         PIC X.
  5614         16  BBEN-ABBR               PIC X(5).
  5615         16  BDIFF-LEN               PIC S9(4)  COMP.
  5616         16  BDIFF-ATTRB             PIC X.
  5617         16  BDIFFO                  PIC Z(7).99-.
  5618         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5619         16  BBILL-LIT-ATTRB         PIC X.
  5620         16  BBILL-LIT               PIC X(8).
  5621         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5622         16  BDALT-PREM-ATTRB        PIC X.
  5623         16  BDALT-PREM              PIC Z(7).99-.
  5624
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 105
* EL6311.cbl
  5626
  5627****************************************************************
  5628*
  5629* Copyright (c) 2007 by Clerity Solutions, Inc.
  5630* All rights reserved.
  5631*
  5632****************************************************************
  5633 01  DFHEIV.
  5634   02  DFHEIV0               PIC X(35).
  5635   02  DFHEIV1               PIC X(08).
  5636   02  DFHEIV2               PIC X(08).
  5637   02  DFHEIV3               PIC X(08).
  5638   02  DFHEIV4               PIC X(06).
  5639   02  DFHEIV5               PIC X(04).
  5640   02  DFHEIV6               PIC X(04).
  5641   02  DFHEIV7               PIC X(02).
  5642   02  DFHEIV8               PIC X(02).
  5643   02  DFHEIV9               PIC X(01).
  5644   02  DFHEIV10              PIC S9(7) COMP-3.
  5645   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5646   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5647   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5648   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5649   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5650   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5651   02  DFHEIV17              PIC X(04).
  5652   02  DFHEIV18              PIC X(04).
  5653   02  DFHEIV19              PIC X(04).
  5654   02  DFHEIV20              USAGE IS POINTER.
  5655   02  DFHEIV21              USAGE IS POINTER.
  5656   02  DFHEIV22              USAGE IS POINTER.
  5657   02  DFHEIV23              USAGE IS POINTER.
  5658   02  DFHEIV24              USAGE IS POINTER.
  5659   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5660   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5661   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5662   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5663   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5664   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5665   02  FILLER                PIC X(02).
  5666   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5667   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5668   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5669   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5670   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5671 LINKAGE  SECTION.
  5672*****************************************************************
  5673*                                                               *
  5674* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5675* All rights reserved.                                          *
  5676*                                                               *
  5677*****************************************************************
  5678 01  dfheiblk.
  5679     02  eibtime          pic s9(7) comp-3.
  5680     02  eibdate          pic s9(7) comp-3.
  5681     02  eibtrnid         pic x(4).
  5682     02  eibtaskn         pic s9(7) comp-3.
  5683     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 106
* EL6311.cbl
  5684     02  dfheigdi         pic s9(4) comp.
  5685     02  eibcposn         pic s9(4) comp.
  5686     02  eibcalen         pic s9(4) comp.
  5687     02  eibaid           pic x(1).
  5688     02  eibfiller1       pic x(1).
  5689     02  eibfn            pic x(2).
  5690     02  eibfiller2       pic x(2).
  5691     02  eibrcode         pic x(6).
  5692     02  eibfiller3       pic x(2).
  5693     02  eibds            pic x(8).
  5694     02  eibreqid         pic x(8).
  5695     02  eibrsrce         pic x(8).
  5696     02  eibsync          pic x(1).
  5697     02  eibfree          pic x(1).
  5698     02  eibrecv          pic x(1).
  5699     02  eibsend          pic x(1).
  5700     02  eibatt           pic x(1).
  5701     02  eibeoc           pic x(1).
  5702     02  eibfmh           pic x(1).
  5703     02  eibcompl         pic x(1).
  5704     02  eibsig           pic x(1).
  5705     02  eibconf          pic x(1).
  5706     02  eiberr           pic x(1).
  5707     02  eibrldbk         pic x(1).
  5708     02  eiberrcd         pic x(4).
  5709     02  eibsynrb         pic x(1).
  5710     02  eibnodat         pic x(1).
  5711     02  eibfiller5       pic x(2).
  5712     02  eibresp          pic 9(09) comp.
  5713     02  eibresp2         pic 9(09) comp.
  5714     02  dfheigdj         pic s9(4) comp.
  5715     02  dfheigdk         pic s9(4) comp.
  5716 01  DFHCOMMAREA                 PIC X(1300).
  5717
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 107
* EL6311.cbl
  5719*    COPY ERCPNDB.
  5720******************************************************************
  5721*                                                                *
  5722*                                                                *
  5723*                            ERCPNDB.                            *
  5724*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5725*                            VMOD=2.025                          *
  5726*                                                                *
  5727*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5728*                                                                *
  5729******************************************************************
  5730*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5731*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5732******************************************************************
  5733*                                                                *
  5734*                                                                *
  5735*   FILE TYPE = VSAM,KSDS                                        *
  5736*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5737*                                                                *
  5738*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5739*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5740*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5741*                                                 RKP=13,LEN=36  *
  5742*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5743*                                      AND CHG-SEQ.)             *
  5744*                                                RKP=49,LEN=11   *
  5745*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5746*                                      AND CHG-SEQ.)             *
  5747*                                                RKP=60,LEN=15   *
  5748*                                                                *
  5749*   LOG = NO                                                     *
  5750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5751******************************************************************
  5752******************************************************************
  5753*                   C H A N G E   L O G
  5754*
  5755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5756*-----------------------------------------------------------------
  5757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5758* EFFECTIVE    NUMBER
  5759*-----------------------------------------------------------------
  5760* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5761* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5762* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5763* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5764* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5765* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5766* 032306                   PEMA  ADD BOW LOAN NUMBER
  5767* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5768* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5769* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5770* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5771* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5772* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5773* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5774* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5775******************************************************************
  5776
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 108
* EL6311.cbl
  5777 01  PENDING-BUSINESS.
  5778     12  PB-RECORD-ID                     PIC XX.
  5779         88  VALID-PB-ID                        VALUE 'PB'.
  5780
  5781     12  PB-CONTROL-PRIMARY.
  5782         16  PB-COMPANY-CD                PIC X.
  5783         16  PB-ENTRY-BATCH               PIC X(6).
  5784         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5785         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5786
  5787     12  PB-CONTROL-BY-ACCOUNT.
  5788         16  PB-COMPANY-CD-A1             PIC X.
  5789         16  PB-CARRIER                   PIC X.
  5790         16  PB-GROUPING.
  5791             20  PB-GROUPING-PREFIX       PIC XXX.
  5792             20  PB-GROUPING-PRIME        PIC XXX.
  5793         16  PB-STATE                     PIC XX.
  5794         16  PB-ACCOUNT.
  5795             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5796             20  PB-ACCOUNT-PRIME         PIC X(6).
  5797         16  PB-CERT-EFF-DT               PIC XX.
  5798         16  PB-CERT-NO.
  5799             20  PB-CERT-PRIME            PIC X(10).
  5800             20  PB-CERT-SFX              PIC X.
  5801         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5802
  5803         16  PB-RECORD-TYPE               PIC X.
  5804             88  PB-MAILING-DATA                VALUE '0'.
  5805             88  PB-ISSUE                       VALUE '1'.
  5806             88  PB-CANCELLATION                VALUE '2'.
  5807             88  PB-BATCH-TRAILER               VALUE '9'.
  5808
  5809     12  PB-CONTROL-BY-ORIG-BATCH.
  5810         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5811         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5812         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5813         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5814
  5815     12  PB-CONTROL-BY-CSR.
  5816         16  PB-CSR-COMPANY-CD            PIC X.
  5817         16  PB-CSR-ID                    PIC X(4).
  5818         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5819         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5820         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5821******************************************************************
  5822*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5823******************************************************************
  5824
  5825     12  PB-LAST-MAINT-DT                 PIC XX.
  5826     12  PB-LAST-MAINT-BY                 PIC X(4).
  5827     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5828
  5829     12  PB-RECORD-BODY                   PIC X(375).
  5830
  5831     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5832         16  PB-CERT-ORIGIN               PIC X.
  5833             88  CLASIC-CREATED-CERT         VALUE '1'.
  5834         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 109
* EL6311.cbl
  5835             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5836             20  PB-I-INSURED-FIRST-NAME.
  5837                 24  PB-I-INSURED-1ST-INIT PIC X.
  5838                 24  FILLER                PIC X(9).
  5839             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5840         16  PB-I-AGE                     PIC S99   COMP-3.
  5841         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5842         16  PB-I-BIRTHDAY                PIC XX.
  5843         16  PB-I-INSURED-SEX             PIC X.
  5844             88  PB-SEX-MALE     VALUE 'M'.
  5845             88  PB-SEX-FEMALE   VALUE 'F'.
  5846
  5847         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5848         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5849         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5850         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5851         16  PB-I-SKIP-CODE               PIC X.
  5852             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5853             88  PB-SKIP-JULY              VALUE '1'.
  5854             88  PB-SKIP-AUGUST            VALUE '2'.
  5855             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5856             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5857             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5858             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5859             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5860             88  PB-SKIP-JUNE              VALUE '8'.
  5861             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5862             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5863             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5864         16  PB-I-TERM-TYPE               PIC X.
  5865             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5866             88  PB-PAID-WEEKLY            VALUE 'W'.
  5867             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5868             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5869             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5870         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5871         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5872         16  PB-I-DATA-ENTRY-SW           PIC X.
  5873             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5874             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5875             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5876             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5877         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5878         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5879*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5880         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5881         16  FILLER                       PIC X.
  5882
  5883         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5884             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5885             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5886                                                   '90' THRU '99'.
  5887         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5888                                          PIC XX.
  5889         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5890         16  PB-I-AMOUNT-FINANCED REDEFINES
  5891                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5892         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 110
* EL6311.cbl
  5893         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5894                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5895         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5896         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5897         16  PB-I-CLP-AMOUNT REDEFINES
  5898                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5899         16  PB-I-LF-CALC-FLAG            PIC X.
  5900             88 PB-COMP-LF-PREM               VALUE '?'.
  5901         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5902         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5903         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5904         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5905         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5906         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5907         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5908         16  PB-I-LF-ABBR                 PIC XXX.
  5909         16  PB-I-LF-INPUT-CD             PIC XX.
  5910
  5911         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5912             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5913             88  PB-INVALID-AH               VALUE '  ' '00'
  5914                                                   '90' THRU '99'.
  5915         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5916         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5917         16  PB-I-AH-CALC-FLAG            PIC X.
  5918             88 PB-COMP-AH-PREM                  VALUE '?'.
  5919         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5920         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5921         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5922         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5923         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5924         16  PB-I-AH-ABBR                 PIC XXX.
  5925         16  PB-I-AH-INPUT-CD             PIC XXX.
  5926
  5927         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5928         16  PB-I-REIN-TABLE              PIC XXX.
  5929         16  PB-I-BUSINESS-TYPE           PIC 99.
  5930         16  PB-I-INDV-GRP-CD             PIC X.
  5931         16  PB-I-MORT-CODE.
  5932             20  PB-I-TABLE               PIC X.
  5933             20  PB-I-INTEREST            PIC XX.
  5934             20  PB-I-MORT-TYP            PIC X.
  5935         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5936         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5937         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5938         16  PB-I-INDV-GRP-OVRD           PIC X.
  5939         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5940         16  PB-I-SIG-SW                  PIC X.
  5941             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5942         16  PB-I-RATE-CLASS              PIC XX.
  5943         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5944         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5945         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5946         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5947         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5948         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5949         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5950         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 111
* EL6311.cbl
  5951         16  PB-I-OB-FLAG                 PIC X.
  5952             88  PB-I-OB                      VALUE 'B'.
  5953             88  PB-I-SUMMARY                 VALUE 'Z'.
  5954         16  PB-I-ENTRY-STATUS            PIC X.
  5955             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5956                                              'M' '5' '9' '2'.
  5957             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5958             88  PB-I-POLICY-PENDING          VALUE '2'.
  5959             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5960             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5961             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5962             88  PB-I-REIN-ONLY               VALUE '9'.
  5963             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5964             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5965             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5966             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5967         16  PB-I-INT-CODE                PIC X.
  5968             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5969             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5970         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5971         16  PB-I-SOC-SEC-NO              PIC X(11).
  5972         16  PB-I-MEMBER-NO               PIC X(12).
  5973         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5974*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5975         16  PB-I-OLD-LOF                 PIC XXX.
  5976         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5977         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5978         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5979         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5980         16  PB-I-LIFE-INDICATOR          PIC X.
  5981             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5982         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5983         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5984                                          PIC S9(5)V99    COMP-3.
  5985         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5986             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5987             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5988         16  PB-I-1ST-PMT-DT              PIC XX.
  5989         16  PB-I-JOINT-INSURED.
  5990             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5991             20 PB-I-JOINT-FIRST-NAME.
  5992                24  PB-I-JOINT-FIRST-INIT PIC X.
  5993                24  FILLER                PIC X(9).
  5994             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5995*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5996         16  PB-I-BENEFICIARY-NAME.
  5997             20  PB-I-BANK-NUMBER         PIC X(10).
  5998             20  FILLER                   PIC X(15).
  5999         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6000         16  PB-I-REFERENCE               PIC X(12).
  6001         16  FILLER REDEFINES PB-I-REFERENCE.
  6002             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6003             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6004             20  PB-I-CLP-STATE           PIC XX.
  6005         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6006             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6007             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6008             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 112
* EL6311.cbl
  6009         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6010         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6011         16  PB-I-RESIDENT-STATE          PIC XX.
  6012         16  PB-I-RATE-CODE               PIC X(4).
  6013         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6014         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6015         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6016         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6017         16  PB-I-BANK-NOCHRGB            PIC 99.
  6018         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6019         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6020
  6021     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6022         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6023             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6024         16  PB-C-CANCEL-ORIGIN           PIC X.
  6025             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6026         16  PB-C-LF-CANCEL-DT            PIC XX.
  6027         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6028         16  PB-C-LF-CALC-REQ             PIC X.
  6029             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6030         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6031         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6032         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6033             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6034         16  PB-C-AH-CANCEL-DT            PIC XX.
  6035         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6036         16  PB-C-AH-CALC-REQ             PIC X.
  6037             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6038         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6039         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6040         16  PB-C-LAST-NAME               PIC X(15).
  6041         16  PB-C-REFUND-SW               PIC X.
  6042             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6043             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6044         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6045         16  PB-C-PAYEE-CODE              PIC X(6).
  6046         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6047         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6048         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6049         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6050         16  PB-C-REFERENCE               PIC X(12).
  6051         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6052         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6053         16  PB-C-POST-CARD-IND           PIC X.
  6054         16  PB-C-CANCEL-REASON           PIC X.
  6055         16  PB-C-REF-INTERFACE-SW        PIC X.
  6056         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6057         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6058         16  FILLER                       PIC X(01).
  6059*        16  FILLER                       PIC X(18).
  6060         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6061*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6062         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6063         16  PB-CANCELED-CERT-DATA.
  6064             20  PB-CI-INSURED-NAME.
  6065                 24  PB-CI-LAST-NAME      PIC X(15).
  6066                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 113
* EL6311.cbl
  6067             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6068             20  PB-CI-INSURED-SEX        PIC X.
  6069             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6070             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6071             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6072             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6073             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6074             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6075             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6076             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6077             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6078             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6079             20  PB-CI-RATE-CLASS         PIC XX.
  6080             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6081             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6082             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6083             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6084             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6085             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6086             20  PB-CI-LF-ABBR            PIC X(3).
  6087             20  PB-CI-AH-ABBR            PIC X(3).
  6088             20  PB-CI-OB-FLAG            PIC X.
  6089                 88  PB-CI-OB                VALUE 'B'.
  6090             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6091                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6092                                           'M' '4' '5' '9' '2'.
  6093                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6094                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6095                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6096                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6097                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6098                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6099                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6100                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6101                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6102                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6103                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6104                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6105             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6106                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6107                                           'M' '4' '5' '9' '2'.
  6108                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6109                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6110                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6111                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6112                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6113                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6114                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6115                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6116                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6117                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6118                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6119                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6120             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6121             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6122             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6123             20  PB-CI-MEMBER-NO          PIC X(12).
  6124             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 114
* EL6311.cbl
  6125                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6126                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6127             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6128             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6129             20  PB-CI-COMP-EXCP-SW       PIC X.
  6130                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6131                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6132             20  PB-CI-ENTRY-STATUS       PIC X.
  6133             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6134             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6135             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6136             20  PB-CI-DEATH-DT           PIC XX.
  6137             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6138             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6139             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6140             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6141             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6142             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6143             20  PB-CI-ENTRY-DT              PIC XX.
  6144             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6145             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6146             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6147             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6148             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6149             20  PB-CI-OLD-LOF               PIC XXX.
  6150*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6151             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6152             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6153             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6154             20  PB-CI-INDV-GRP-CD           PIC X.
  6155             20  PB-CI-BENEFICIARY-NAME.
  6156                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6157                 24  FILLER                  PIC X(15).
  6158             20  PB-CI-NOTE-SW               PIC X.
  6159             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6160             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6161             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6162             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6163             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6164             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6165             20  PB-CI-FIRST-NAME            PIC X(10).
  6166             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6167
  6168         16  FILLER                       PIC X(13).
  6169*032306  16  FILLER                       PIC X(27).
  6170*        16  FILLER                       PIC X(46).
  6171
  6172     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6173         16  FILLER                       PIC X(10).
  6174         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6175         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6176         16  PB-M-INSURED-MID-INIT        PIC X.
  6177         16  PB-M-INSURED-AGE             PIC 99.
  6178         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6179         16  PB-M-INSURED-SEX             PIC X.
  6180         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6181         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6182         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 115
* EL6311.cbl
  6183         16  PB-M-INSURED-CITY-STATE.
  6184             20  PB-M-INSURED-CITY        PIC X(28).
  6185             20  PB-M-INSURED-STATE       PIC XX.
  6186         16  PB-M-INSURED-ZIP-CODE.
  6187             20  PB-M-INSURED-ZIP-PRIME.
  6188                 24  PB-M-INSURED-ZIP-1   PIC X.
  6189                     88  PB-M-CANADIAN-POST-CODE
  6190                                             VALUE 'A' THRU 'Z'.
  6191                 24  FILLER               PIC X(4).
  6192             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6193         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6194                                        PB-M-INSURED-ZIP-CODE.
  6195             20  PM-M-INS-CAN-POST1       PIC XXX.
  6196             20  PM-M-INS-CAN-POST2       PIC XXX.
  6197             20  FILLER                   PIC XXX.
  6198         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6199         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6200         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6201         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6202         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6203         16  PB-M-CRED-BENE-CITYST.
  6204             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6205             20  PB-M-CRED-BENE-STATE     PIC XX.
  6206         16  FILLER                       PIC X(92).
  6207
  6208     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6209         16  FILLER                       PIC X(10).
  6210         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6211         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6212         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6213         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6214         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6215         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6216         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6217         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6218         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6219         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6220         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6221         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6222         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6223         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6224         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6225         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6226         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6227         16  PB-ACCOUNT-NAME              PIC X(30).
  6228         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6229         16  PB-REFERENCE                 PIC X(12).
  6230         16  PB-B-RECEIVED-DT             PIC XX.
  6231         16  FILLER                       PIC X(234).
  6232
  6233     12  PB-RECORD-STATUS.
  6234         16  PB-CREDIT-SELECT-DT          PIC XX.
  6235         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6236         16  PB-BILLED-DT                 PIC XX.
  6237         16  PB-BILLING-STATUS            PIC X.
  6238             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6239             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6240             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 116
* EL6311.cbl
  6241         16  PB-RECORD-BILL               PIC X.
  6242             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6243             88  PB-RECORD-RETURNED           VALUE 'R'.
  6244             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6245             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6246             88  PB-OVERRIDE-AH               VALUE 'A'.
  6247             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6248         16  PB-BATCH-ENTRY               PIC X.
  6249             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6250             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6251             88  PB-REISSUED-CERT             VALUE 'E'.
  6252             88  PB-MONTHLY-CERT              VALUE 'M'.
  6253             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6254             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6255             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6256         16  PB-FORCE-CODE                PIC X.
  6257             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6258             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6259             88  PB-CANCEL-FORCE              VALUE '8'.
  6260             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6261             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6262             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6263             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6264             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6265             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6266             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6267         16  PB-FATAL-FLAG                PIC X.
  6268             88  PB-FATAL-ERRORS              VALUE 'X'.
  6269         16  PB-FORCE-ER-CD               PIC X.
  6270             88  PB-FORCE-ERRORS              VALUE 'F'.
  6271             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6272         16  PB-WARN-ER-CD                PIC X.
  6273             88  PB-WARNING-ERRORS            VALUE 'W'.
  6274         16  FILLER                       PIC X.
  6275         16  PB-OUT-BAL-CD                PIC X.
  6276             88  PB-OUT-OF-BAL                VALUE 'O'.
  6277         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6278         16  PB-AH-OVERRIDE-L1            PIC X.
  6279         16  PB-INPUT-DT                  PIC XX.
  6280         16  PB-INPUT-BY                  PIC X(4).
  6281         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6282         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6283         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6284         16  PB-LF-EARNING-METHOD         PIC X.
  6285         16  PB-AH-EARNING-METHOD         PIC X.
  6286         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6287         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6288         16  PB-REIN-CD                   PIC XXX.
  6289         16  PB-LF-REFUND-TYPE            PIC X.
  6290         16  PB-AH-REFUND-TYPE            PIC X.
  6291         16  PB-ACCT-EFF-DT               PIC XX.
  6292         16  PB-ACCT-EXP-DT               PIC XX.
  6293         16  PB-COMPANY-ID                PIC X(3).
  6294         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6295         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6296         16  PB-SV-CARRIER                PIC X.
  6297         16  PB-SV-GROUPING               PIC X(6).
  6298         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 117
* EL6311.cbl
  6299         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6300         16  PB-GA-BILLING-INFO.
  6301             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6302                                          PIC XX.
  6303         16  PB-SV-REMIT-TO  REDEFINES
  6304             PB-GA-BILLING-INFO           PIC X(10).
  6305         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6306         16  PB-I-LOAN-OFFICER            PIC X(5).
  6307         16  PB-I-VIN                     PIC X(17).
  6308
  6309         16  FILLER                       PIC X(04).
  6310         16  IMNET-BYPASS-SW              PIC X.
  6311
  6312******************************************************************
  6313*                COMMON EDIT ERRORS                              *
  6314******************************************************************
  6315
  6316     12  PB-COMMON-ERRORS.
  6317         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6318                                           PIC S9(4)     COMP.
  6319
  6320******************************************************************
  6321
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 118
* EL6311.cbl
  6323*    COPY ELCCERT.
  6324******************************************************************
  6325*                                                                *
  6326*                            ELCCERT.                            *
  6327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6328*                            VMOD=2.013                          *
  6329*                                                                *
  6330*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6331*                                                                *
  6332*   FILE TYPE = VSAM,KSDS                                        *
  6333*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6334*                                                                *
  6335*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6336*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6337*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6338*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6339*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6340*                                                                *
  6341*   LOG = YES                                                    *
  6342*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6343******************************************************************
  6344*                   C H A N G E   L O G
  6345*
  6346* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6347*-----------------------------------------------------------------
  6348*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6349* EFFECTIVE    NUMBER
  6350*-----------------------------------------------------------------
  6351* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6352* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6353* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6354* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6355* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6356* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6357* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6358* 032612  CR2011110200001  PEMA  AHL CHANGES
  6359******************************************************************
  6360
  6361 01  CERTIFICATE-MASTER.
  6362     12  CM-RECORD-ID                      PIC XX.
  6363         88  VALID-CM-ID                      VALUE 'CM'.
  6364
  6365     12  CM-CONTROL-PRIMARY.
  6366         16  CM-COMPANY-CD                 PIC X.
  6367         16  CM-CARRIER                    PIC X.
  6368         16  CM-GROUPING.
  6369             20  CM-GROUPING-PREFIX        PIC X(3).
  6370             20  CM-GROUPING-PRIME         PIC X(3).
  6371         16  CM-STATE                      PIC XX.
  6372         16  CM-ACCOUNT.
  6373             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6374             20  CM-ACCOUNT-PRIME          PIC X(6).
  6375         16  CM-CERT-EFF-DT                PIC XX.
  6376         16  CM-CERT-NO.
  6377             20  CM-CERT-PRIME             PIC X(10).
  6378             20  CM-CERT-SFX               PIC X.
  6379
  6380     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 119
* EL6311.cbl
  6381         16  CM-COMPANY-CD-A1              PIC X.
  6382         16  CM-INSURED-LAST-NAME          PIC X(15).
  6383         16  CM-INSURED-INITIALS.
  6384             20  CM-INSURED-INITIAL1       PIC X.
  6385             20  CM-INSURED-INITIAL2       PIC X.
  6386
  6387     12  CM-CONTROL-BY-SSN.
  6388         16  CM-COMPANY-CD-A2              PIC X.
  6389         16  CM-SOC-SEC-NO.
  6390             20  CM-SSN-STATE              PIC XX.
  6391             20  CM-SSN-ACCOUNT            PIC X(6).
  6392             20  CM-SSN-LN3.
  6393                 25  CM-INSURED-INITIALS-A2.
  6394                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6395                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6396                 25 CM-PART-LAST-NAME-A2         PIC X.
  6397
  6398     12  CM-CONTROL-BY-CERT-NO.
  6399         16  CM-COMPANY-CD-A4              PIC X.
  6400         16  CM-CERT-NO-A4                 PIC X(11).
  6401
  6402     12  CM-CONTROL-BY-MEMB.
  6403         16  CM-COMPANY-CD-A5              PIC X.
  6404         16  CM-MEMBER-NO.
  6405             20  CM-MEMB-STATE             PIC XX.
  6406             20  CM-MEMB-ACCOUNT           PIC X(6).
  6407             20  CM-MEMB-LN4.
  6408                 25  CM-INSURED-INITIALS-A5.
  6409                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6410                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6411                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6412
  6413     12  CM-INSURED-PROFILE-DATA.
  6414         16  CM-INSURED-FIRST-NAME.
  6415             20  CM-INSURED-1ST-INIT       PIC X.
  6416             20  FILLER                    PIC X(9).
  6417         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6418         16  CM-INSURED-SEX                PIC X.
  6419             88  CM-SEX-MALE                  VALUE 'M'.
  6420             88  CM-SEX-FEMAL                 VALUE 'F'.
  6421         16  CM-INSURED-JOINT-AGE          PIC 99.
  6422         16  CM-JOINT-INSURED-NAME.
  6423             20  CM-JT-LAST-NAME           PIC X(15).
  6424             20  CM-JT-FIRST-NAME.
  6425                 24  CM-JT-1ST-INIT        PIC X.
  6426                 24  FILLER                PIC X(9).
  6427             20  CM-JT-INITIAL             PIC X.
  6428
  6429     12  CM-LIFE-DATA.
  6430         16  CM-LF-BENEFIT-CD              PIC XX.
  6431         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6432         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6433         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6434         16  CM-LF-DEV-CODE                PIC XXX.
  6435         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6436         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6437         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6438         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 120
* EL6311.cbl
  6439         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6440         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6441         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6442         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6443         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6444         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6445         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6446         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6447         16  FILLER                        PIC XX.
  6448
  6449     12  CM-AH-DATA.
  6450         16  CM-AH-BENEFIT-CD              PIC XX.
  6451         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6452         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6453         16  CM-AH-DEV-CODE                PIC XXX.
  6454         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6455         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6456         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6457         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6458         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6459         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6460         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6461         16  CM-AH-PAID-THRU-DT            PIC XX.
  6462             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6463         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6464         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6465         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6466         16  FILLER                        PIC X.
  6467
  6468     12  CM-LOAN-INFORMATION.
  6469         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6470         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6471                                           PIC S9(5)V99  COMP-3.
  6472         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6473         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6474         16  CM-PAY-FREQUENCY              PIC S99.
  6475         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6476         16  CM-RATE-CLASS                 PIC XX.
  6477         16  CM-BENEFICIARY                PIC X(25).
  6478         16  CM-POLICY-FORM-NO             PIC X(12).
  6479         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6480         16  CM-LAST-ADD-ON-DT             PIC XX.
  6481         16  CM-DEDUCTIBLE-AMOUNTS.
  6482             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6483             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6484         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6485             20  CM-RESIDENT-STATE         PIC XX.
  6486             20  CM-RATE-CODE              PIC X(4).
  6487             20  FILLER                    PIC XX.
  6488         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6489             20  CM-LOAN-OFFICER           PIC X(5).
  6490             20  FILLER                    PIC XXX.
  6491         16  CM-CSR-CODE                   PIC XXX.
  6492         16  CM-UNDERWRITING-CODE          PIC X.
  6493             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6494         16  CM-POST-CARD-IND              PIC X.
  6495         16  CM-NH-INTERFACE-SW            PIC X.
  6496         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 121
* EL6311.cbl
  6497             88  CM-SING-PRM                  VALUE '1'.
  6498             88  CM-O-B-COVERAGE              VALUE '2'.
  6499             88  CM-OPEN-END                  VALUE '3'.
  6500         16  CM-IND-GRP-TYPE               PIC X.
  6501             88  CM-INDIVIDUAL                VALUE 'I'.
  6502             88  CM-GROUP                     VALUE 'G'.
  6503         16  CM-SKIP-CODE                  PIC X.
  6504             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6505             88  SKIP-JULY                    VALUE '1'.
  6506             88  SKIP-AUGUST                  VALUE '2'.
  6507             88  SKIP-SEPTEMBER               VALUE '3'.
  6508             88  SKIP-JULY-AUG                VALUE '4'.
  6509             88  SKIP-AUG-SEPT                VALUE '5'.
  6510             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6511             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6512             88  SKIP-JUNE                    VALUE '8'.
  6513             88  SKIP-JUNE-JULY               VALUE '9'.
  6514             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6515             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6516         16  CM-PAYMENT-MODE               PIC X.
  6517             88  PAY-MONTHLY                  VALUE SPACE.
  6518             88  PAY-WEEKLY                   VALUE '1'.
  6519             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6520             88  PAY-BI-WEEKLY                VALUE '3'.
  6521             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6522         16  CM-LOAN-NUMBER                PIC X(8).
  6523         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6524         16  CM-OLD-LOF                    PIC XXX.
  6525*        16  CM-LOAN-OFFICER               PIC XXX.
  6526         16  CM-REIN-TABLE                 PIC XXX.
  6527         16  CM-SPECIAL-REIN-CODE          PIC X.
  6528         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6529         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6530         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6531
  6532     12  CM-STATUS-DATA.
  6533         16  CM-ENTRY-STATUS               PIC X.
  6534         16  CM-ENTRY-DT                   PIC XX.
  6535
  6536         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6537         16  CM-LF-CANCEL-DT               PIC XX.
  6538         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6539
  6540         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6541         16  CM-LF-DEATH-DT                PIC XX.
  6542         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6543
  6544         16  CM-LF-CURRENT-STATUS          PIC X.
  6545             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6546                                                'M' '4' '5' '9'.
  6547             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6548             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6549             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6550             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6551             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6552             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6553             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6554             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 122
* EL6311.cbl
  6555             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6556             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6557             88  CM-LF-DECLINED               VALUE 'D'.
  6558             88  CM-LF-VOIDED                 VALUE 'V'.
  6559
  6560         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6561         16  CM-AH-CANCEL-DT               PIC XX.
  6562         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6563
  6564         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6565         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6566         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6567
  6568         16  CM-AH-CURRENT-STATUS          PIC X.
  6569             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6570                                                'M' '4' '5' '9'.
  6571             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6572             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6573             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6574             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6575             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6576             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6577             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6578             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6579             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6580             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6581             88  CM-AH-DECLINED               VALUE 'D'.
  6582             88  CM-AH-VOIDED                 VALUE 'V'.
  6583
  6584         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6585             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6586             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6587             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6588         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6589
  6590         16  CM-ENTRY-BATCH                PIC X(6).
  6591         16  CM-LF-EXIT-BATCH              PIC X(6).
  6592         16  CM-AH-EXIT-BATCH              PIC X(6).
  6593         16  CM-LAST-MONTH-END             PIC XX.
  6594
  6595     12  CM-NOTE-SW                        PIC X.
  6596         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6597         88  CERT-NOTES-PRESENT               VALUE '1'.
  6598         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6599         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6600         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6601         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6602         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6603         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6604     12  CM-COMP-EXCP-SW                   PIC X.
  6605         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6606         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6607     12  CM-INSURED-ADDRESS-SW             PIC X.
  6608         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6609         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6610
  6611*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6612     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 123
* EL6311.cbl
  6613     12  FILLER                            PIC X.
  6614
  6615*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6616     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6617     12  FILLER                            PIC X.
  6618*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6619     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6620
  6621     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6622         88  CERT-ADDED-BATCH                 VALUE ' '.
  6623         88  CERT-ADDED-ONLINE                VALUE '1'.
  6624         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6625         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6626         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6627     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6628         88  CERT-AS-LOADED                   VALUE ' '.
  6629         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6630         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6631         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6632         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6633         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6634         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6635         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6636
  6637     12  CM-ACCOUNT-COMM-PCTS.
  6638         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6639         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6640
  6641     12  CM-USER-FIELD                     PIC X.
  6642     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6643     12  CM-CLP-STATE                      PIC XX.
  6644     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6645     12  CM-USER-RESERVED                  PIC XXX.
  6646     12  FILLER REDEFINES CM-USER-RESERVED.
  6647         16  CM-AH-CLASS-CD                PIC XX.
  6648         16  F                             PIC X.
  6649******************************************************************
  6650
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 124
* EL6311.cbl
  6652*    COPY ERCNOTE.
  6653******************************************************************
  6654*                                                                *
  6655*                                                                *
  6656*                            ERCNOTE                             *
  6657*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6658*                            VMOD=2.003                          *
  6659*                                                                *
  6660*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6661*                                                                *
  6662*        FILE TYPE= VSAM,KSDS                                    *
  6663*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6664*                                                                *
  6665*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6666*                                                                *
  6667*        LOG = YES                                               *
  6668*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6669*                                                                *
  6670******************************************************************
  6671*                   C H A N G E   L O G
  6672*
  6673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6674*-----------------------------------------------------------------
  6675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6676* EFFECTIVE    NUMBER
  6677*-----------------------------------------------------------------
  6678* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6679*                                FILE WILL CONTAIN BILLING NOTES O
  6680******************************************************************
  6681
  6682 01  CERTIFICATE-NOTE.
  6683     12  CN-RECORD-ID                PIC  XX.
  6684         88  VALID-CN-ID                  VALUE 'CN'.
  6685
  6686     12  CN-CONTROL-PRIMARY.
  6687         16  CN-COMPANY-CD           PIC X.
  6688         16  CN-CARRIER              PIC X.
  6689         16  CN-GROUPING.
  6690             20 CN-GROUPING-PREFIX   PIC XXX.
  6691             20 CN-GROUPING-PRIME    PIC XXX.
  6692         16  CN-STATE                PIC XX.
  6693         16  CN-ACCOUNT.
  6694             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6695             20 CN-ACCOUNT-PRIME     PIC X(6).
  6696         16  CN-CERT-EFF-DT          PIC XX.
  6697         16  CN-CERT-NO.
  6698             20  CN-CERT-PRIME       PIC X(10).
  6699             20  CN-CERT-SFX         PIC X.
  6700
  6701     12  CN-BILLING-START-LINE-NO    PIC 99.
  6702     12  CN-BILLING-END-LINE-NO      PIC 99.
  6703
  6704     12  CN-LINES.
  6705         16  CN-LINE OCCURS 10       PIC X(77).
  6706
  6707     12  CN-LAST-MAINT-DT            PIC XX.
  6708     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6709     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 125
* EL6311.cbl
  6710     12  FILLER                      PIC X(6).
  6711******************************************************************
  6712
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 126
* EL6311.cbl
  6714*    COPY ERCPNDM.
  6715******************************************************************
  6716*                                                                *
  6717*                                                                *
  6718*                            ERCPNDM                             *
  6719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6720*                            VMOD=2.003                          *
  6721*                                                                *
  6722*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6723*                                                                *
  6724*   FILE TYPE = VSAM,KSDS                                        *
  6725*   RECORD SIZE = 374   RECFORM = FIX                            *
  6726*                                                                *
  6727*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6728*   ALTERNATE PATH    = NOT USED                                 *
  6729*                                                                *
  6730*   LOG = YES                                                    *
  6731*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6732******************************************************************
  6733*                   C H A N G E   L O G
  6734*
  6735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6736*-----------------------------------------------------------------
  6737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6738* EFFECTIVE    NUMBER
  6739*-----------------------------------------------------------------
  6740* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6741* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6742* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6743******************************************************************
  6744
  6745 01  PENDING-MAILING-DATA.
  6746     12  PM-RECORD-ID                      PIC XX.
  6747         88  VALID-MA-ID                       VALUE 'PM'.
  6748
  6749     12  PM-CONTROL-PRIMARY.
  6750         16  PM-COMPANY-CD                 PIC X.
  6751         16  PM-ENTRY-BATCH                PIC X(6).
  6752         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6753         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6754
  6755     12  FILLER                            PIC X(14).
  6756
  6757     12  PM-ACCESS-CONTROL.
  6758         16  PM-SOURCE-SYSTEM              PIC XX.
  6759             88  PM-FROM-CREDIT                VALUE 'CR'.
  6760             88  PM-FROM-VSI                   VALUE 'VS'.
  6761             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6762             88  PM-FROM-OTHER                 VALUE 'OT'.
  6763         16  PM-RECORD-ADD-DT              PIC XX.
  6764         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6765         16  PM-LAST-MAINT-DT              PIC XX.
  6766         16  PM-LAST-MAINT-BY              PIC XXXX.
  6767         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6768
  6769     12  PM-PROFILE-INFO.
  6770         16  PM-QUALIFY-CODE-1             PIC XX.
  6771         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 127
* EL6311.cbl
  6772         16  PM-QUALIFY-CODE-3             PIC XX.
  6773         16  PM-QUALIFY-CODE-4             PIC XX.
  6774         16  PM-QUALIFY-CODE-5             PIC XX.
  6775
  6776         16  PM-INSURED-LAST-NAME          PIC X(15).
  6777         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6778         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6779         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6780         16  PM-INSURED-BIRTH-DT           PIC XX.
  6781         16  PM-INSURED-SEX                PIC X.
  6782             88  PM-SEX-MALE                   VALUE 'M'.
  6783             88  PM-SEX-FEMALE                 VALUE 'F'.
  6784         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6785
  6786         16  PM-ADDRESS-CORRECTED          PIC X.
  6787         16  PM-JOINT-BIRTH-DT             PIC XX.
  6788*        16  FILLER                        PIC X(12).
  6789
  6790         16  PM-ADDRESS-LINE-1             PIC X(30).
  6791         16  PM-ADDRESS-LINE-2             PIC X(30).
  6792         16  PM-CITY-STATE.
  6793             20  PM-CITY                   PIC X(28).
  6794             20  PM-STATE                  PIC XX.
  6795         16  PM-ZIP.
  6796             20  PM-ZIP-CODE.
  6797                 24  PM-ZIP-1              PIC X.
  6798                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6799                 24  FILLER                PIC X(4).
  6800             20  PM-ZIP-PLUS4              PIC X(4).
  6801         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6802             20  PM-CAN-POST1              PIC XXX.
  6803             20  PM-CAN-POST2              PIC XXX.
  6804             20  FILLER                    PIC XXX.
  6805
  6806         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6807
  6808         16  FILLER                        PIC X(03).
  6809
  6810     12  PM-CRED-BENE-INFO.
  6811         16  PM-CRED-BENE-NAME             PIC X(25).
  6812         16  PM-CRED-BENE-ADDR             PIC X(30).
  6813         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6814         16  PM-CRED-BENE-CTYST.
  6815             20  PM-CRED-BENE-CITY         PIC X(28).
  6816             20  PM-CRED-BENE-STATE        PIC XX.
  6817         16  PM-CRED-BENE-ZIP.
  6818             20  PM-CB-ZIP-CODE.
  6819                 24  PM-CB-ZIP-1           PIC X.
  6820                     88  PM-CB-CANADIAN-POST-CODE
  6821                                  VALUE 'A' THRU 'Z'.
  6822                 24  FILLER                PIC X(4).
  6823             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6824         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6825             20  PM-CB-CAN-POST1           PIC XXX.
  6826             20  PM-CB-CAN-POST2           PIC XXX.
  6827             20  FILLER                    PIC XXX.
  6828     12  PM-POST-CARD-MAIL-DATA.
  6829         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 128
* EL6311.cbl
  6830             20  PM-MAIL-TYPE              PIC X.
  6831                 88  PM-12MO-MAILING           VALUE '1'.
  6832                 88  PM-EXP-MAILING            VALUE '2'.
  6833             20  PM-MAIL-STATUS            PIC X.
  6834                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6835                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6836                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6837             20  PM-MAIL-DATE              PIC XX.
  6838     12  FILLER                            PIC XX.
  6839     12  FILLER                            PIC X(12).
  6840*    12  FILLER                            PIC X(30).
  6841
  6842******************************************************************
  6843
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 129
* EL6311.cbl
  6845*    COPY ERCMAIL.
  6846******************************************************************
  6847*                                                                *
  6848*                                                                *
  6849*                            ERCMAIL                             *
  6850*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6851*                            VMOD=2.003                          *
  6852*                                                                *
  6853*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6854*                                                                *
  6855*   FILE TYPE = VSAM,KSDS                                        *
  6856*   RECORD SIZE = 374   RECFORM = FIX                            *
  6857*                                                                *
  6858*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6859*   ALTERNATE PATH    = NOT USED                                 *
  6860*                                                                *
  6861*   LOG = YES                                                    *
  6862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6863******************************************************************
  6864*                   C H A N G E   L O G
  6865*
  6866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6867*-----------------------------------------------------------------
  6868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6869* EFFECTIVE    NUMBER
  6870*-----------------------------------------------------------------
  6871* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6872* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6873* 111108                   PEMA  ADD CRED BENE ADDR2
  6874******************************************************************
  6875
  6876 01  MAILING-DATA.
  6877     12  MA-RECORD-ID                      PIC XX.
  6878         88  VALID-MA-ID                       VALUE 'MA'.
  6879
  6880     12  MA-CONTROL-PRIMARY.
  6881         16  MA-COMPANY-CD                 PIC X.
  6882         16  MA-CARRIER                    PIC X.
  6883         16  MA-GROUPING.
  6884             20  MA-GROUPING-PREFIX        PIC XXX.
  6885             20  MA-GROUPING-PRIME         PIC XXX.
  6886         16  MA-STATE                      PIC XX.
  6887         16  MA-ACCOUNT.
  6888             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6889             20  MA-ACCOUNT-PRIME          PIC X(6).
  6890         16  MA-CERT-EFF-DT                PIC XX.
  6891         16  MA-CERT-NO.
  6892             20  MA-CERT-PRIME             PIC X(10).
  6893             20  MA-CERT-SFX               PIC X.
  6894
  6895     12  FILLER                            PIC XX.
  6896
  6897     12  MA-ACCESS-CONTROL.
  6898         16  MA-SOURCE-SYSTEM              PIC XX.
  6899             88  MA-FROM-CREDIT                VALUE 'CR'.
  6900             88  MA-FROM-VSI                   VALUE 'VS'.
  6901             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6902             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 130
* EL6311.cbl
  6903         16  MA-RECORD-ADD-DT              PIC XX.
  6904         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6905         16  MA-LAST-MAINT-DT              PIC XX.
  6906         16  MA-LAST-MAINT-BY              PIC XXXX.
  6907         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6908
  6909     12  MA-PROFILE-INFO.
  6910         16  MA-QUALIFY-CODE-1             PIC XX.
  6911         16  MA-QUALIFY-CODE-2             PIC XX.
  6912         16  MA-QUALIFY-CODE-3             PIC XX.
  6913         16  MA-QUALIFY-CODE-4             PIC XX.
  6914         16  MA-QUALIFY-CODE-5             PIC XX.
  6915
  6916         16  MA-INSURED-LAST-NAME          PIC X(15).
  6917         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6918         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6919         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6920         16  MA-INSURED-BIRTH-DT           PIC XX.
  6921         16  MA-INSURED-SEX                PIC X.
  6922             88  MA-SEX-MALE                   VALUE 'M'.
  6923             88  MA-SEX-FEMALE                 VALUE 'F'.
  6924         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6925
  6926         16  MA-ADDRESS-CORRECTED          PIC X.
  6927         16  MA-JOINT-BIRTH-DT             PIC XX.
  6928*        16  FILLER                        PIC X(12).
  6929
  6930         16  MA-ADDRESS-LINE-1             PIC X(30).
  6931         16  MA-ADDRESS-LINE-2             PIC X(30).
  6932         16  MA-CITY-STATE.
  6933             20  MA-CITY                   PIC X(28).
  6934             20  MA-ADDR-STATE             PIC XX.
  6935         16  MA-ZIP.
  6936             20  MA-ZIP-CODE.
  6937                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6938                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6939                 24  FILLER                PIC X(4).
  6940             20  MA-ZIP-PLUS4              PIC X(4).
  6941         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6942             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6943             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6944             20  FILLER                    PIC X(3).
  6945
  6946         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6947
  6948         16  FILLER                        PIC XXX.
  6949*        16  FILLER                        PIC X(10).
  6950
  6951     12  MA-CRED-BENE-INFO.
  6952         16  MA-CRED-BENE-NAME                 PIC X(25).
  6953         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6954         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6955         16  MA-CRED-BENE-CTYST.
  6956             20  MA-CRED-BENE-CITY             PIC X(28).
  6957             20  MA-CRED-BENE-STATE            PIC XX.
  6958         16  MA-CRED-BENE-ZIP.
  6959             20  MA-CB-ZIP-CODE.
  6960                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 131
* EL6311.cbl
  6961                     88  MA-CB-CANADIAN-POST-CODE
  6962                                           VALUE 'A' THRU 'Z'.
  6963                 24  FILLER                    PIC X(4).
  6964             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6965         16  MA-CB-CANADIAN-POSTAL-CODE
  6966                            REDEFINES MA-CRED-BENE-ZIP.
  6967             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6968             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6969             20  FILLER                        PIC X(3).
  6970     12  MA-POST-CARD-MAIL-DATA.
  6971         16  MA-MAIL-DATA OCCURS 7.
  6972             20  MA-MAIL-TYPE              PIC X.
  6973                 88  MA-12MO-MAILING           VALUE '1'.
  6974                 88  MA-EXP-MAILING            VALUE '2'.
  6975             20  MA-MAIL-STATUS            PIC X.
  6976                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6977                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6978                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6979             20  MA-MAIL-DATE              PIC XX.
  6980     12  FILLER                            PIC XX.
  6981     12  FILLER                            PIC XX.
  6982*    12  FILLER                            PIC X(30).
  6983******************************************************************
  6984
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 132
* EL6311.cbl
  6986*    COPY ERCRQST.
  6987******************************************************************
  6988*                                                                *
  6989*                                                                *
  6990*                            ERCRQST.                            *
  6991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6992*                            VMOD=2.002                          *
  6993*                                                                *
  6994*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  6995*                                                                *
  6996*   FILE TYPE = VSAM,KSDS                                        *
  6997*   RECORD SIZE = 200  RECFORM = FIXED                           *
  6998*                                                                *
  6999*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7000*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7001*                                   ACCOUNT, REF, BATCH)         *
  7002*                                                RKP=9, LEN=38   *
  7003*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7004*                                   ACCOUNT, REF, BATCH)         *
  7005*                                                RKP=47, LEN=46  *
  7006*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7007*                                   BATCH)                       *
  7008*                                                RKP=93, LEN=24  *
  7009*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7010*                                   REF, BATCH)                  *
  7011*                                                RKP=117, LEN=35 *
  7012*   LOG = NO                                                     *
  7013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7014******************************************************************
  7015
  7016 01  AR-REQUEST-RECORD.
  7017     12  RQ-RECORD-ID                     PIC XX.
  7018         88  VALID-RQ-ID                        VALUE 'RQ'.
  7019
  7020     12  RQ-CONTROL-PRIMARY.
  7021         16  RQ-COMPANY-CD                PIC X.
  7022         16  RQ-ENTRY-BATCH               PIC X(6).
  7023
  7024     12  RQ-CONTROL-BY-ACCT-REF.
  7025         16  RQ-COMPANY-CD-A1             PIC X.
  7026         16  RQ-CARRIER-A1                PIC X.
  7027         16  RQ-GROUPING-A1               PIC X(6).
  7028         16  RQ-STATE-A1                  PIC XX.
  7029         16  RQ-ACCOUNT-A1                PIC X(10).
  7030         16  RQ-REFERENCE-A1              PIC X(12).
  7031         16  RQ-BATCH-A1                  PIC X(6).
  7032
  7033     12  RQ-CONTROL-BY-FIN-RESP.
  7034         16  RQ-COMPANY-CD-A2             PIC X.
  7035         16  RQ-CARRIER-A2                PIC X.
  7036         16  RQ-GROUPING-A2               PIC X(6).
  7037         16  RQ-FIN-RESP-A2               PIC X(10).
  7038         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7039         16  RQ-REFERENCE-A2              PIC X(12).
  7040         16  RQ-BATCH-A2                  PIC X(6).
  7041
  7042     12  RQ-CONTROL-BY-ACCT-AGENT.
  7043         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 133
* EL6311.cbl
  7044         16  RQ-CARRIER-A3                PIC X.
  7045         16  RQ-GROUPING-A3               PIC X(6).
  7046         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7047         16  RQ-BATCH-A3                  PIC X(6).
  7048
  7049     12  RQ-CONTROL-BY-SUMMARY.
  7050         16  RQ-COMPANY-CD-A4             PIC X.
  7051         16  RQ-SUMMARY-CODE              PIC X(6).
  7052         16  RQ-ACCOUNT-A4                PIC X(10).
  7053         16  RQ-REFERENCE-A4              PIC X(12).
  7054         16  RQ-BATCH-A4                  PIC X(6).
  7055
  7056     12  RQ-REQUEST-METHOD                PIC X.
  7057         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7058         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7059         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7060         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7061     12  FILLER                           PIC X.
  7062     12  RQ-STATUS                        PIC X.
  7063         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7064         88  RQ-RESUBMIT                      VALUE 'R'.
  7065     12  RQ-PROCESSOR-ID                  PIC X(4).
  7066     12  RQ-ENTRY-DT                      PIC XX.
  7067     12  RQ-MO-END-DT                     PIC XX.
  7068     12  RQ-REQUEST-DT                    PIC XX.
  7069     12  RQ-STMT-DT                       PIC XX.
  7070     12  RQ-REVERSAL-DT                   PIC XX.
  7071     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7072     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7073
  7074     12  FILLER                           PIC X(27).
  7075
  7076******************************************************************
  7077
  7078
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 134
* EL6311.cbl
  7080*    COPY ERCLOFC.
  7081******************************************************************
  7082*                                                                *
  7083*                                                                *
  7084*                            ERCLOFC                             *
  7085*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7086*                            VMOD=2.003                          *
  7087*                                                                *
  7088*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7089*                                                                *
  7090*   FILE TYPE = VSAM,KSDS                                        *
  7091*   RECORD SIZE = 670   RECFORM = FIX                            *
  7092*                                                                *
  7093*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7094*                                                                *
  7095*   LOG = YES                                                    *
  7096*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7097*                                                                *
  7098******************************************************************
  7099
  7100 01  LOAN-OFFICER-MASTER.
  7101     12  LO-RECORD-ID                PIC XX.
  7102         88  VALID-LO-ID                VALUE 'LO'.
  7103
  7104     12  LO-CONTROL-PRIMARY.
  7105         16  LO-COMPANY-CD           PIC X.
  7106         16  LO-CARRIER              PIC X.
  7107         16  LO-GROUPING.
  7108             20  LO-GROUPING-PREFIX  PIC XXX.
  7109             20  LO-GROUPING-PRIME   PIC XXX.
  7110         16  LO-STATE                PIC XX.
  7111         16  LO-ACCOUNT.
  7112             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7113             20  LO-ACCOUNT-PRIME    PIC X(6).
  7114         16  LO-OFFICER-CODE         PIC X(5).
  7115
  7116     12  LO-OFFICER-NAME             PIC X(30).
  7117
  7118     12  LO-LAST-MAINT-DT            PIC XX.
  7119     12  LO-LAST-USER                PIC X(4).
  7120     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7121
  7122     12  LO-COMP-CONTROL             PIC X.
  7123             88  LO-SHOW-COMP           VALUE 'Y'.
  7124             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7125     12  LO-DETAIL-CONTROL           PIC X.
  7126             88  LO-PRINT-DETAIL        VALUE 'D'.
  7127             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7128
  7129     12  LO-SV-CARRIER               PIC X.
  7130     12  LO-SV-GROUPING              PIC X(6).
  7131     12  LO-SV-STATE                 PIC XX.
  7132
  7133     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7134     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7135
  7136     12  LO-OFFICER-INFO.
  7137         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 135
* EL6311.cbl
  7138             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7139             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7140             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7141             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7142             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7143             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7144             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7145             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7146     12  FILLER                      PIC X(198).
  7147******************************************************************
  7148
  7149*    COPY ERCPYAJ.
  7150******************************************************************
  7151*                                                                *
  7152*                            ERCPYAJ                             *
  7153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7154*                            VMOD=2.015                          *
  7155*                                                                *
  7156*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7157*                                                                *
  7158*                                                                *
  7159*   FILE TYPE = VSAM,KSDS                                        *
  7160*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7161*                                                                *
  7162*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7163*       ALTERNATE PATHS = NONE                                   *
  7164*                                                                *
  7165*   LOG = YES                                                    *
  7166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7167******************************************************************
  7168******************************************************************
  7169*                   C H A N G E   L O G
  7170*
  7171* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7172*-----------------------------------------------------------------
  7173*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7174* EFFECTIVE    NUMBER
  7175*-----------------------------------------------------------------
  7176* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7177* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7178******************************************************************
  7179
  7180 01  PENDING-PAY-ADJ.
  7181     12  PY-RECORD-ID                     PIC XX.
  7182         88  VALID-PY-ID                        VALUE 'PY'.
  7183
  7184     12  PY-CONTROL-PRIMARY.
  7185         16  PY-COMPANY-CD                PIC X.
  7186         16  PY-CARRIER                   PIC X.
  7187         16  PY-GROUPING                  PIC X(6).
  7188         16  PY-FIN-RESP                  PIC X(10).
  7189         16  PY-ACCOUNT                   PIC X(10).
  7190         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7191                                          PIC X(10).
  7192         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7193         16  PY-RECORD-TYPE               PIC X.
  7194             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7195             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 136
* EL6311.cbl
  7196             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7197             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7198             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7199             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7200             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7201             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7202             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7203             88  PY-FICA-ENTRY                VALUE 'F'.
  7204             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7205             88  PY-POLICY-FEE                VALUE 'W'.
  7206             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7207
  7208     12  PY-PYMT-TYPE                     PIC X.
  7209             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7210             88  PY-REINS-PYMT                VALUE 'R'.
  7211             88  PY-EXP-PYMT                  VALUE 'E'.
  7212
  7213     12  PY-BIL-INV                       PIC X(6).
  7214     12  PY-REF-NO                        PIC X(12).
  7215
  7216     12  PY-LAST-MAINT-DT                 PIC XX.
  7217     12  PY-LAST-MAINT-BY                 PIC X(4).
  7218     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7219
  7220     12  PY-PYADJ-RECORD.
  7221         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7222         16  PY-ENTRY-COMMENT             PIC X(30).
  7223         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7224             20  PY-GL-ACCOUNT            PIC X(10).
  7225             20  PY-GL-STATE              PIC X(02).
  7226             20  PY-GL-CANC-SW            PIC X(01).
  7227                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7228                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7229             20  PY-GL-COMMENT            PIC X(10).
  7230             20  FILLER      REDEFINES PY-GL-COMMENT.
  7231                 24  PY-GL-CHECK-NO       PIC 9(06).
  7232                 24  FILLER               PIC X(04).
  7233             20  FILLER                   PIC X(07).
  7234         16  PY-SAVE-ACCOUNT              PIC X(10).
  7235         16  PY-SAVE-TYPE                 PIC X(01).
  7236
  7237         16  PY-LETTERS.
  7238             20  PY-LETTER OCCURS 3 TIMES
  7239                           INDEXED BY PY-LET-NDX
  7240                                          PIC X(04).
  7241
  7242         16  PY-ERCOMP-TYPE               PIC X.
  7243             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7244             88  PY-GA-TYPE                   VALUE 'G'.
  7245             88  PY-BANK-TYPE                 VALUE 'B'.
  7246         16  FILLER                       PIC X(05).
  7247
  7248     12  PY-RECORD-STATUS.
  7249         16  PY-CREDIT-SELECT-DT          PIC XX.
  7250         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7251         16  PY-BILLED-DATE               PIC XX.
  7252         16  PY-REPORTED-DT               PIC XX.
  7253         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 137
* EL6311.cbl
  7254             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7255             88  PY-GA-PMT                    VALUE 'G'.
  7256             88  PY-OVWRITE-PMT               VALUE 'O'.
  7257             88  PY-NON-AR-PMT                VALUE 'N'.
  7258         16  FILLER                       PIC X(5).
  7259         16  PY-INPUT-DT                  PIC XX.
  7260         16  PY-CHECK-NUMBER              PIC X(6).
  7261         16  PY-VOID-SW                   PIC X.
  7262             88  PY-CHECK-VOIDED              VALUE 'V'.
  7263         16  PY-CHECK-ORIGIN-SW           PIC X.
  7264             88  PY-BILLING-CHECK             VALUE 'B'.
  7265             88  PY-REFUND-CHECK              VALUE 'R'.
  7266             88  PY-GA-CHECK                  VALUE 'G'.
  7267             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7268             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7269         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7270         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7271         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7272         16  PY-BILL-FLAG                 PIC X.
  7273             88  PY-BILLED                    VALUE 'B'.
  7274         16  PY-AR-FLAG                   PIC X.
  7275             88  PY-AR-CYCLE                  VALUE 'C'.
  7276             88  PY-AR-MONTH-END              VALUE 'M'.
  7277         16  PY-AR-DATE                   PIC XX.
  7278
  7279     12  PY-GL-CODES.
  7280         16  PY-GL-DB                     PIC X(14).
  7281         16  PY-GL-CR                     PIC X(14).
  7282         16  PY-GL-FLAG                   PIC X.
  7283         16  PY-GL-DATE                   PIC XX.
  7284
  7285     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7286     12  FILLER                           PIC X(3).
  7287******************************************************************
  7288
  7289*    COPY ERCCNOT.
  7290******************************************************************
  7291*                                                                *
  7292*                            ERCCNOT                             *
  7293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7294*                            VMOD=2.003                          *
  7295*                                                                *
  7296*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7297*                                                                *
  7298*        FILE TYPE= VSAM,KSDS                                    *
  7299*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7300*                                                                *
  7301*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7302*                                                                *
  7303*        LOG = YES                                               *
  7304*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7305*                                                                *
  7306******************************************************************
  7307*                   C H A N G E   L O G
  7308*
  7309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7310*-----------------------------------------------------------------
  7311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 138
* EL6311.cbl
  7312* EFFECTIVE    NUMBER
  7313*-----------------------------------------------------------------
  7314* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7315******************************************************************
  7316
  7317 01  CERT-NOTE-FILE.
  7318     12  CZ-RECORD-ID                PIC  XX.
  7319         88  VALID-CZ-ID                  VALUE 'CZ'.
  7320
  7321     12  CZ-CONTROL-PRIMARY.
  7322         16  CZ-COMPANY-CD           PIC X.
  7323         16  CZ-CARRIER              PIC X.
  7324         16  CZ-GROUPING.
  7325             20 CZ-GROUPING-PREFIX   PIC XXX.
  7326             20 CZ-GROUPING-PRIME    PIC XXX.
  7327         16  CZ-STATE                PIC XX.
  7328         16  CZ-ACCOUNT.
  7329             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7330             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7331         16  CZ-CERT-EFF-DT          PIC XX.
  7332         16  CZ-CERT-NO.
  7333             20  CZ-CERT-PRIME       PIC X(10).
  7334             20  CZ-CERT-SFX         PIC X.
  7335         16  CZ-RECORD-TYPE          PIC X.
  7336             88  CERT-NOTE           VALUE '1'.
  7337             88  CLAIM-CERT-NOTE     VALUE '2'.
  7338         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7339
  7340     12  CZ-LAST-MAINT-DT            PIC XX.
  7341     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7342     12  CZ-LAST-MAINT-USER          PIC X(4).
  7343
  7344     12  CZ-NOTE-INFORMATION.
  7345         16  CZ-NOTE                 PIC X(63).
  7346         16  FILLER                  PIC X(39).
  7347******************************************************************
  7348
  7349*    COPY ELCMSTR.
  7350******************************************************************
  7351*                                                                *
  7352*                            ELCMSTR.                            *
  7353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7354*                            VMOD=2.012                          *
  7355*                                                                *
  7356*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7357*                                                                *
  7358*   FILE TYPE = VSAM,KSDS                                        *
  7359*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7360*                                                                *
  7361*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7362*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7363*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7364*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7365*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7366*                                                 RKP=75,LEN=21  *
  7367*                                                                *
  7368*   **** NOTE ****                                               *
  7369*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 139
* EL6311.cbl
  7370*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7371*                                                                *
  7372*   LOG = YES                                                    *
  7373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7374******************************************************************
  7375*                   C H A N G E   L O G
  7376*
  7377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7378*-----------------------------------------------------------------
  7379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7380* EFFECTIVE    NUMBER
  7381*-----------------------------------------------------------------
  7382* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7383* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7384******************************************************************
  7385 01  CLAIM-MASTER.
  7386     12  CL-RECORD-ID                PIC XX.
  7387         88  VALID-CL-ID         VALUE 'CL'.
  7388
  7389     12  CL-CONTROL-PRIMARY.
  7390         16  CL-COMPANY-CD           PIC X.
  7391         16  CL-CARRIER              PIC X.
  7392         16  CL-CLAIM-NO             PIC X(7).
  7393         16  CL-CERT-NO.
  7394             20  CL-CERT-PRIME       PIC X(10).
  7395             20  CL-CERT-SFX         PIC X.
  7396
  7397     12  CL-CONTROL-BY-NAME.
  7398         16  CL-COMPANY-CD-A1        PIC X.
  7399         16  CL-INSURED-LAST-NAME    PIC X(15).
  7400         16  CL-INSURED-NAME.
  7401             20  CL-INSURED-1ST-NAME PIC X(12).
  7402             20  CL-INSURED-MID-INIT PIC X.
  7403
  7404     12  CL-CONTROL-BY-SSN.
  7405         16  CL-COMPANY-CD-A2        PIC X.
  7406         16  CL-SOC-SEC-NO.
  7407             20  CL-SSN-STATE        PIC XX.
  7408             20  CL-SSN-ACCOUNT      PIC X(6).
  7409             20  CL-SSN-LN3          PIC X(3).
  7410
  7411     12  CL-CONTROL-BY-CERT-NO.
  7412         16  CL-COMPANY-CD-A4        PIC X.
  7413         16  CL-CERT-NO-A4.
  7414             20  CL-CERT-A4-PRIME    PIC X(10).
  7415             20  CL-CERT-A4-SFX      PIC X.
  7416
  7417     12  CL-CONTROL-BY-CCN.
  7418         16  CL-COMPANY-CD-A5        PIC X.
  7419         16  CL-CCN-A5.
  7420             20  CL-CCN.
  7421                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7422                 24  CL-CCN-PRIME-A5 PIC X(12).
  7423             20  CL-CCN-FILLER-A5    PIC X(4).
  7424
  7425     12  CL-INSURED-PROFILE-DATA.
  7426         16  CL-INSURED-BIRTH-DT     PIC XX.
  7427         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 140
* EL6311.cbl
  7428             88  INSURED-IS-MALE        VALUE 'M'.
  7429             88  INSURED-IS-FEMALE      VALUE 'F'.
  7430             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7431         16  CL-INSURED-OCC-CD       PIC X(6).
  7432         16  FILLER                  PIC X(5).
  7433
  7434     12  CL-PROCESSING-INFO.
  7435         16  CL-PROCESSOR-ID         PIC X(4).
  7436         16  CL-CLAIM-STATUS         PIC X.
  7437             88  CLAIM-IS-OPEN          VALUE 'O'.
  7438             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7439         16  CL-CLAIM-TYPE           PIC X.
  7440*            88  AH-CLAIM               VALUE 'A'.
  7441*            88  LIFE-CLAIM             VALUE 'L'.
  7442*            88  PROPERTY-CLAIM         VALUE 'P'.
  7443*            88  IUI-CLAIM              VALUE 'I'.
  7444*            88  GAP-CLAIM              VALUE 'G'.
  7445         16  CL-CLAIM-PREM-TYPE      PIC X.
  7446             88  SINGLE-PREMIUM         VALUE '1'.
  7447             88  O-B-COVERAGE           VALUE '2'.
  7448             88  OPEN-END-COVERAGE      VALUE '3'.
  7449         16  CL-INCURRED-DT          PIC XX.
  7450         16  CL-REPORTED-DT          PIC XX.
  7451         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7452         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7453         16  CL-LAST-PMT-DT          PIC XX.
  7454         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7455         16  CL-PAID-THRU-DT         PIC XX.
  7456         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7457         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7458         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7459         16  CL-PMT-CALC-METHOD      PIC X.
  7460             88  CL-360-DAY-YR          VALUE '1'.
  7461             88  CL-365-DAY-YR          VALUE '2'.
  7462             88  CL-FULL-MONTHS         VALUE '3'.
  7463         16  CL-CAUSE-CD             PIC X(6).
  7464
  7465         16  CL-PRIME-CERT-NO.
  7466             20  CL-PRIME-CERT-PRIME PIC X(10).
  7467             20  CL-PRIME-CERT-SFX   PIC X.
  7468
  7469         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7470             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7471             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7472
  7473         16  CL-MICROFILM-NO         PIC X(10).
  7474         16  CL-PROG-FORM-TYPE       PIC X.
  7475         16  CL-LAST-ADD-ON-DT       PIC XX.
  7476
  7477         16  CL-LAST-REOPEN-DT       PIC XX.
  7478         16  CL-LAST-CLOSE-DT        PIC XX.
  7479         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7480             88  FINAL-PAID             VALUE '1'.
  7481             88  CLAIM-DENIED           VALUE '2'.
  7482             88  AUTO-CLOSE             VALUE '3'.
  7483             88  MANUAL-CLOSE           VALUE '4'.
  7484             88  BENEFITS-CHANGED       VALUE 'C'.
  7485             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 141
* EL6311.cbl
  7486         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7487         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7488         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7489             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7490         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7491         16  FILLER                  PIC X.
  7492
  7493     12  CL-CERTIFICATE-DATA.
  7494         16  CL-CERT-ORIGIN          PIC X.
  7495             88  CERT-WAS-ONLINE        VALUE '1'.
  7496             88  CERT-WAS-CREATED       VALUE '2'.
  7497             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7498         16  CL-CERT-KEY-DATA.
  7499             20  CL-CERT-CARRIER     PIC X.
  7500             20  CL-CERT-GROUPING    PIC X(6).
  7501             20  CL-CERT-STATE       PIC XX.
  7502             20  CL-CERT-ACCOUNT.
  7503                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7504                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7505             20  CL-CERT-EFF-DT      PIC XX.
  7506
  7507     12  CL-STATUS-CONTROLS.
  7508         16  CL-PRIORITY-CD          PIC X.
  7509             88  CONFIDENTIAL-DATA      VALUE '8'.
  7510             88  HIGHEST-PRIORITY       VALUE '9'.
  7511         16  CL-SUPV-ATTN-CD         PIC X.
  7512             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7513             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7514         16  CL-PURGED-DT            PIC XX.
  7515         16  CL-RESTORED-DT          PIC XX.
  7516         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7517         16  CL-NEXT-RESEND-DT       PIC XX.
  7518         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7519         16  FILLER                  PIC XX.
  7520         16  CL-LAST-MAINT-DT        PIC XX.
  7521         16  CL-LAST-MAINT-USER      PIC X(4).
  7522         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7523         16  CL-LAST-MAINT-TYPE      PIC X.
  7524             88  CLAIM-SET-UP           VALUE ' '.
  7525             88  PAYMENT-MADE           VALUE '1'.
  7526             88  LETTER-SENT            VALUE '2'.
  7527             88  MASTER-WAS-ALTERED     VALUE '3'.
  7528             88  MASTER-WAS-RESTORED    VALUE '4'.
  7529             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7530             88  FILE-CONVERTED         VALUE '6'.
  7531             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7532             88  ERROR-CORRECTION       VALUE 'E'.
  7533         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7534         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7535         16  CL-BENEFICIARY          PIC X(10).
  7536         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7537         16  CL-DENIAL-TYPE          PIC X.
  7538             88  CL-TYPE-DENIAL          VALUE '1'.
  7539             88  CL-TYPE-RESCISSION      VALUE '2'.
  7540             88  CL-TYPE-REFORMATION     VALUE '3'.
  7541             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7542             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7543         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 142
* EL6311.cbl
  7544
  7545     12  CL-TRAILER-CONTROLS.
  7546         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7547             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7548             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7549             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7550         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7551         16  FILLER                  PIC XX.
  7552         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7553         16  CL-ADDRESS-TRAILER-CNT.
  7554             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7555                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7556             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7557                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7558             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7559                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7560             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7561                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7562             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7563                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7564             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7565                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7566             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7567                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7568
  7569     12  CL-CV-REFERENCE-NO.
  7570         16  CL-CV-REFNO-PRIME       PIC X(18).
  7571         16  CL-CV-REFNO-SFX         PIC XX.
  7572
  7573     12  CL-FILE-LOCATION            PIC X(4).
  7574
  7575     12  CL-PROCESS-ERRORS.
  7576         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7577             88  NO-FATAL-ERRORS        VALUE ZERO.
  7578         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7579             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7580
  7581     12  CL-PRODUCT-CD               PIC X.
  7582
  7583     12  CL-CURRENT-KEY-DATA.
  7584         16  CL-CURRENT-CARRIER      PIC X.
  7585         16  CL-CURRENT-GROUPING     PIC X(6).
  7586         16  CL-CURRENT-STATE        PIC XX.
  7587         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7588
  7589     12  CL-ASSOCIATES               PIC X.
  7590         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7591         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7592         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7593         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7594
  7595     12  CL-ACTIVITY-CODE            PIC 99.
  7596     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7597     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7598
  7599     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7600     12  CL-LAG-REPORT-CODE          PIC 9.
  7601     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 143
* EL6311.cbl
  7602     12  CL-LEGAL-STATE              PIC XX.
  7603
  7604*    12  FILLER                      PIC X(5).
  7605     12  CL-YESNOSW                  PIC X.
  7606     12  FILLER                      PIC X(4).
  7607
  7608*    COPY ERCENDT.
  7609******************************************************************
  7610*                                                                *
  7611*                                                                *
  7612*                            ERCENDT.                            *
  7613*                            VMOD=2.001                          *
  7614*                                                                *
  7615*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7616*                                                                *
  7617*   FILE TYPE = VSAM,KSDS                                        *
  7618*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7619*                                                                *
  7620*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7621*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7622*                                                                *
  7623*   LOG = NO                                                     *
  7624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7625******************************************************************
  7626*-----------------------------------------------------------------
  7627*                   C H A N G E   L O G
  7628*
  7629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7630*-----------------------------------------------------------------
  7631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7632* EFFECTIVE    NUMBER
  7633*-----------------------------------------------------------------
  7634* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7635*                                WITH OPEN CLAIMS
  7636* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7637* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7638* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7639*-----------------------------------------------------------------
  7640 01  ENDORSEMENT-RECORD.
  7641     12  EN-RECORD-ID                PIC XX.
  7642         88  VALID-EN-ID                VALUE 'EN'.
  7643     12  EN-CONTROL-PRIMARY.
  7644         16  EN-COMPANY-CD           PIC X.
  7645         16  EN-CARRIER              PIC X.
  7646         16  EN-GROUPING             PIC X(6).
  7647         16  EN-STATE                PIC XX.
  7648         16  EN-ACCOUNT              PIC X(10).
  7649         16  EN-CERT-EFF-DT          PIC XX.
  7650         16  EN-CERT-NO.
  7651             20  EN-CERT-PRIME       PIC X(10).
  7652             20  EN-CERT-SFX         PIC X.
  7653         16  EN-REC-TYPE             PIC X.
  7654             88  EN-ISSUE               VALUE 'I'.
  7655             88  EN-CANCELLATION        VALUE 'C'.
  7656         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7657     12  EN-CONTROL-BY-ARCH-NO.
  7658         16  EN-COMPANY-CD-A1              PIC X.
  7659         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 144
* EL6311.cbl
  7660     12  EN-LAST-MAINT-DT            PIC XX.
  7661     12  EN-LAST-MAINT-BY            PIC X(4).
  7662     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7663     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7664     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7665         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7666         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7667         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7668         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7669         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7670         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7671         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7672         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7673         16  EN-LF-ORIG-BENCD        PIC XX.
  7674         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7675         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7676         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7677         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7678         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7679         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7680*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7681         16  EN-ORIG-CRED-BENE       PIC X(25).
  7682         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7683         16  FILLER                  PIC X.
  7684         16  EN-AH-ORIG-BENCD        PIC XX.
  7685         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7686         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7687         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7688         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7689*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7690*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7691         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7692         16  F                       PIC X(09).
  7693         16  EN-AH-ORIG-CP           PIC 99.
  7694         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7695         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7696         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7697         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7698         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7699         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7700         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7701         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7702         16  EN-LF-NEW-BENCD         PIC XX.
  7703         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7704         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7705         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7706         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7707         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7708         16  EN-LF-NEW-EXP-DT        PIC XX.
  7709         16  EN-NEW-CRED-BENE        PIC X(25).
  7710         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7711         16  FILLER                  PIC X.
  7712         16  EN-AH-NEW-BENCD         PIC XX.
  7713         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7714         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7715         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7716         16  EN-AH-NEW-EXP-DT        PIC XX.
  7717*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 145
* EL6311.cbl
  7718*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7719*        16  F                       PIC X(12).
  7720         16  EN-AH-NEW-CP            PIC 99.
  7721         16  EN-SIG-SW               PIC X.
  7722         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7723         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7724         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7725         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7726         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7727         16  FILLER                  PIC X(33).
  7728     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7729         16  EN-LF-ORIG-REF-DT       PIC XX.
  7730         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7731         16  EN-AH-ORIG-REF-DT       PIC XX.
  7732         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7733         16  EN-LF-NEW-REF-DT        PIC XX.
  7734         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7735         16  EN-AH-NEW-REF-DT        PIC XX.
  7736         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7737         16  EN-FLAG-CERT            PIC X.
  7738         16  EN-INS-LAST-NAME        PIC X(15).
  7739         16  EN-INS-FIRST-NAME       PIC X(10).
  7740         16  EN-INS-MIDDLE-INIT      PIC X.
  7741         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7742         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7743         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7744         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7745         16  FILLER                  PIC X(262).
  7746     12  EN-MONEY-SW             PIC X.
  7747     12  EN-HEALTH-APP           PIC X.
  7748     12  EN-VOUCHER-SW           PIC X.
  7749     12  EN-PAYEE                PIC X(14).
  7750     12  EN-INPUT-DT             PIC XX.
  7751     12  EN-PROCESS-DT           PIC XX.
  7752     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7753     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7754     12  EN-REASON-CODES.
  7755         16  F OCCURS 12.
  7756             20  EN-REASON-CODE  PIC X(4).
  7757     12  EN-TEMPLATE-USED        PIC X(8).
  7758     12  EN-DOCU-TYPE            PIC X.
  7759         88  EN-VERI-DOCU          VALUE 'V'.
  7760         88  EN-GCE-DOCU           VALUE 'G'.
  7761         88  EN-CANC-DOCU          VALUE 'C'.
  7762     12  EN-COMMENTS1            PIC X(13).
  7763     12  EN-COMMENTS2            PIC X(70).
  7764     12  EN-COMM-CHGBK           PIC X.
  7765         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7766         88  EN-CHG-ACCT           VALUE 'Y'.
  7767     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7768     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7769     12  EN-BATCH-NUMBER         PIC X(6).
  7770     12  EN-ACCT-SUMM            PIC X.
  7771     12  EN-CSO-SUMM             PIC X.
  7772     12  FILLER                  PIC X(13).
  7773******************************************************************
  7774
  7775*    COPY ELCCRTT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 146
* EL6311.cbl
  7776******************************************************************
  7777*                                                                *
  7778*                            ELCCRTT.                            *
  7779*                                                                *
  7780*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7781*                                                                *
  7782*   FILE TYPE = VSAM,KSDS                                        *
  7783*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7784*                                                                *
  7785*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7786*                                                                *
  7787*   LOG = YES                                                    *
  7788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7789******************************************************************
  7790*                   C H A N G E   L O G
  7791*
  7792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7793*-----------------------------------------------------------------
  7794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7795* EFFECTIVE    NUMBER
  7796*-----------------------------------------------------------------
  7797* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7798* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7799* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7800* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7801******************************************************************
  7802
  7803 01  CERTIFICATE-TRAILERS.
  7804     12  CS-RECORD-ID                      PIC XX.
  7805         88  VALID-CS-ID                      VALUE 'CS'.
  7806
  7807     12  CS-CONTROL-PRIMARY.
  7808         16  CS-COMPANY-CD                 PIC X.
  7809         16  CS-CARRIER                    PIC X.
  7810         16  CS-GROUPING                   PIC X(6).
  7811         16  CS-STATE                      PIC XX.
  7812         16  CS-ACCOUNT                    PIC X(10).
  7813         16  CS-CERT-EFF-DT                PIC XX.
  7814         16  CS-CERT-NO.
  7815             20  CS-CERT-PRIME             PIC X(10).
  7816             20  CS-CERT-SFX               PIC X.
  7817         16  CS-TRAILER-TYPE               PIC X.
  7818             88  COMM-TRLR           VALUE 'A'.
  7819             88  FUTURE-TRLR         VALUE 'B'.
  7820             88  CERT-DATA-TRLR      VALUE 'C'.
  7821
  7822     12  CS-DATA-AREA                      PIC X(516).
  7823
  7824     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7825         16  CS-BANK-COMMISSION-AREA.
  7826             20  CS-BANK-COMMS       OCCURS 10.
  7827                 24  CS-AGT                PIC X(10).
  7828                 24  CS-COM-TYP            PIC X.
  7829                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7830                 24  CS-RECALC-LV-INDIC    PIC X.
  7831                 24  FILLER                PIC X(10).
  7832         16  FILLER                        PIC X(256).
  7833
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 147
* EL6311.cbl
  7834     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7835         16  CS-VIN-NUMBER                 PIC X(17).
  7836         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7837         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7838         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7839         16  FILLER                        PIC X(496).
  7840******************************************************************
  7841
  7842 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7843                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7844                          PENDING-MAILING-DATA MAILING-DATA
  7845                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7846                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7847                          CLAIM-MASTER ENDORSEMENT-RECORD
  7848                          CERTIFICATE-TRAILERS.
  7849 0000-DFHEXIT SECTION.
  7850     MOVE '9#                    $   ' TO DFHEIV0.
  7851     MOVE 'EL6311' TO DFHEIV1.
  7852     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7853
  7854     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7855     MOVE EIBTRMID               TO QID-TERM.
  7856     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7857     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7858     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7859     MOVE 2                      TO EMI-SWITCH2.
  7860
  7861     IF EIBCALEN = 0
  7862         GO TO 8800-UNAUTHORIZED-ACCESS.
  7863
  7864     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  7865     MOVE '5'                   TO DC-OPTION-CODE.
  7866     PERFORM 9700-DATE-LINK.
  7867     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7868     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7869
  7870     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7871     MOVE SPACE                  TO DC-OPTION-CODE.
  7872     PERFORM 9700-DATE-LINK.
  7873     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7874     MOVE LOW-VALUES             TO EL631BI.
  7875
  7876
  7877* EXEC CICS HANDLE CONDITION
  7878*        PGMIDERR  (9600-PGMID-ERROR)
  7879*        ERROR     (9990-ABEND)
  7880*        INVREQ    (9990-ABEND)
  7881*        QIDERR    (0010-MAIN-LOGIC)
  7882*    END-EXEC.
  7883*    MOVE '"$L.8N                ! " #00007872' TO DFHEIV0
  7884     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7886     MOVE X'2220233030303037383732' TO DFHEIV0(25:11)
  7887     CALL 'kxdfhei1' USING DFHEIV0
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7889
  7890
  7891     IF PI-CALLING-PROGRAM NOT = THIS-PGM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 148
* EL6311.cbl
  7892         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7893             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7894             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7895             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7896             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7897             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7898             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7899             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7900             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7901
  7902             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7903                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7904
  7905             ELSE
  7906                 NEXT SENTENCE
  7907
  7908         ELSE
  7909             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7910             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7911             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7912             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7913             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7914             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7915             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7916             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7917             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7918             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7919             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7920             GO TO 3900-RE-DISPLAY-RECORD
  7921     ELSE
  7922         GO TO 0020-MAIN-LOGIC.
  7923
  7924 0010-MAIN-LOGIC.
  7925     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7926                                    WS-FIRST-ENTRY-SW.
  7927
  7928     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7929
  7930     MOVE LOW-VALUES             TO EC-NEW-CERT
  7931                                    EC-NEW-STATE.
  7932
  7933     IF PI-DISPLAY-ORIGINAL-BATCH
  7934         NEXT SENTENCE
  7935     ELSE
  7936         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7937             GO TO 5000-BROWSE-BATCH-HEADERS.
  7938
  7939     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7940         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7941
  7942     IF PI-CSR-BROWSE
  7943        GO TO 4200-BROWSE-CSR-FORWARD.
  7944
  7945     IF PI-FILE-BROWSE
  7946         GO TO 4300-BROWSE-FILE-FORWARD.
  7947
  7948     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7949
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 149
* EL6311.cbl
  7950 0020-MAIN-LOGIC.
  7951     IF EIBAID = DFHCLEAR
  7952         GO TO 9400-CLEAR.
  7953
  7954     MOVE LOW-VALUES             TO EC-NEW-CERT
  7955                                    EC-NEW-STATE.
  7956
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 150
* EL6311.cbl
  7958
  7959******************************************************************
  7960*                                                                *
  7961*              R E C E I V E   M A P                             *
  7962*                                                                *
  7963******************************************************************
  7964
  7965 0200-RECEIVE.
  7966     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7967         MOVE ER-0008            TO EMI-ERROR
  7968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7969         IF PI-MAP-NAME = EL631B
  7970             MOVE -1                 TO BMAINTL
  7971             GO TO 8200-SEND-DATAONLY
  7972         ELSE
  7973             IF PI-MAP-NAME = EL631C
  7974                 MOVE -1                 TO CMAINTL
  7975                 GO TO 8200-SEND-DATAONLY
  7976             ELSE
  7977                 IF PI-MAP-NAME = EL631D
  7978                     MOVE -1                 TO DPFENTRL
  7979                     GO TO 8200-SEND-DATAONLY.
  7980
  7981
  7982* EXEC CICS RECEIVE
  7983*        MAP      (PI-MAP-NAME)
  7984*        MAPSET   (MAPSET-EL6311S)
  7985*        INTO     (EL631BI)
  7986*    END-EXEC.
  7987     MOVE LENGTH OF
  7988      EL631BI
  7989       TO DFHEIV11
  7990*    MOVE '8"T I  L              ''   #00007969' TO DFHEIV0
  7991     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7993     MOVE X'2020233030303037393639' TO DFHEIV0(25:11)
  7994     CALL 'kxdfhei1' USING DFHEIV0,
  7995           PI-MAP-NAME,
  7996           EL631BI,
  7997           DFHEIV11,
  7998           MAPSET-EL6311S,
  7999           DFHEIV99,
  8000           DFHEIV99
  8001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8002
  8003
  8004******************************************************************
  8005*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8006******************************************************************
  8007
  8008     IF BTYPE-LEN (1) EQUAL +3
  8009        IF BTYPE (1) EQUAL ALL ' '
  8010            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8011
  8012     IF BTYPE-LEN (2) EQUAL +3
  8013        IF BTYPE (2) EQUAL ALL ' '
  8014            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8015
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 151
* EL6311.cbl
  8016     INSPECT EL631BI CONVERTING '_' TO ' '.
  8017
  8018     IF PI-MAP-NAME = EL631B
  8019         IF BPFENTRL GREATER THAN ZEROS
  8020             IF EIBAID NOT = DFHENTER
  8021                 MOVE ER-0004       TO EMI-ERROR
  8022                 MOVE -1            TO BPFENTRL
  8023                 MOVE AL-UNBOF      TO BPFENTRA
  8024                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8025                 GO TO 8200-SEND-DATAONLY
  8026             ELSE
  8027                 IF BPFENTRI NUMERIC AND
  8028                   (BPFENTRI GREATER 0 AND LESS 25)
  8029                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8030                 ELSE
  8031                     MOVE ER-0029  TO EMI-ERROR
  8032                     MOVE AL-UNBON TO BPFENTRA
  8033                     MOVE -1       TO BPFENTRL
  8034                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8035                     GO TO 8200-SEND-DATAONLY
  8036         ELSE
  8037             NEXT SENTENCE
  8038     ELSE
  8039         IF PI-MAP-NAME = EL631C
  8040            IF CPFENTRL GREATER THAN ZEROS
  8041                IF EIBAID NOT = DFHENTER
  8042                 MOVE ER-0004         TO EMI-ERROR
  8043                 MOVE -1              TO CPFENTRL
  8044                 MOVE AL-UNBOF        TO CPFENTRA
  8045                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8046                 GO TO 8200-SEND-DATAONLY
  8047             ELSE
  8048                 IF CPFENTRI NUMERIC AND
  8049                   (CPFENTRI GREATER 0 AND LESS 25)
  8050                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8051                 ELSE
  8052                     MOVE ER-0029      TO EMI-ERROR
  8053                     MOVE AL-UNBON     TO CPFENTRA
  8054                     MOVE -1           TO CPFENTRL
  8055                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8056                     GO TO 8200-SEND-DATAONLY
  8057         ELSE
  8058             NEXT SENTENCE
  8059     ELSE
  8060     IF PI-MAP-NAME = EL631D
  8061         IF DPFENTRL GREATER THAN ZEROS
  8062             IF EIBAID NOT = DFHENTER
  8063                 MOVE ER-0004         TO EMI-ERROR
  8064                 MOVE -1              TO DPFENTRL
  8065                 MOVE AL-UNBOF        TO DPFENTRA
  8066                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067                 GO TO 8200-SEND-DATAONLY
  8068             ELSE
  8069                 IF DPFENTRI NUMERIC AND
  8070                   (DPFENTRI GREATER 0 AND LESS 25)
  8071                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8072                 ELSE
  8073                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 152
* EL6311.cbl
  8074                     MOVE AL-UNBON     TO DPFENTRA
  8075                     MOVE -1           TO DPFENTRL
  8076                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8077                     GO TO 8200-SEND-DATAONLY.
  8078
  8079     IF EIBAID = DFHPF23
  8080         GO TO 8810-PF23.
  8081
  8082     IF EIBAID = DFHPF24
  8083         GO TO 9200-RETURN-MAIN-MENU.
  8084
  8085     IF EIBAID = DFHPF12
  8086         GO TO 9500-PF12.
  8087
  8088     IF PI-MAP-NAME = EL631B
  8089        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8090
  8091     IF PI-MAP-NAME = EL631C
  8092        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8093
  8094     IF PI-MAP-NAME = EL631D
  8095        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8096
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 153
* EL6311.cbl
  8098
  8099******************************************************************
  8100*                                                                *
  8101*      ISSUE SCREEN PF KEY CHECKING                              *
  8102*                                                                *
  8103******************************************************************
  8104
  8105******************************************************************
  8106*                                                                *
  8107*      PF KEY FUNCTIONS:                                         *
  8108*                                                                *
  8109*      PF1  = BROWSE FORWARD                                     *
  8110*      PF2  = BROWSE BACKWARD                                    *
  8111*      PF3  = CERTIFICATE LOOKUP                                 *
  8112*      PF4  = DISPLAY BATCH HEADER                               *
  8113*      PF5  = ADD ISSUE  SCREEN                                  *
  8114*      PF6  = ADD CANCEL SCREEN                                  *
  8115*      PF7  = CERTIFICATE DISPLAY                                *
  8116*      PF8  = CERTIFICATE NOTES                                  *
  8117*      PF9  = EDIT CONTROL                                       *
  8118*      PF10 = DISPLAY LETTER SCREEN                              *
  8119*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8120*      PF12 = HELP SCREEN                                        *
  8121*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8122*      PF14 = ACCOUNT MASTER                                     *
  8123*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8124*      PF16 = DISPLAY LETTER REVIEW                              *
  8125*                                                                *
  8126******************************************************************
  8127
  8128 0300-CHECK-ISSUE-PF-KEYS.
  8129     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8130        MOVE ER-2337            TO EMI-ERROR
  8131        MOVE -1                  TO BMAINTL
  8132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8133        GO TO 8200-SEND-DATAONLY.
  8134
  8135     IF EIBAID = DFHPF1
  8136        MOVE '0'                TO PI-EDIT-SW
  8137        IF PI-PRIMARY-BROWSE
  8138           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8139        ELSE
  8140           IF PI-PRIMARY-WITH-SELECT
  8141              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8142           ELSE
  8143              IF PI-FILE-BROWSE
  8144                 GO TO 4300-BROWSE-FILE-FORWARD
  8145              ELSE
  8146                 IF PI-CSR-BROWSE
  8147                    GO TO 4200-BROWSE-CSR-FORWARD
  8148                 ELSE
  8149                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8150
  8151     IF EIBAID = DFHPF2
  8152        MOVE '0'                TO PI-EDIT-SW
  8153        IF PI-PRIMARY-BROWSE
  8154           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8155        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 154
* EL6311.cbl
  8156           IF PI-PRIMARY-WITH-SELECT
  8157              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8158           ELSE
  8159              IF PI-FILE-BROWSE
  8160                 GO TO 4800-BROWSE-FILE-BACKWARD
  8161              ELSE
  8162                 IF PI-CSR-BROWSE
  8163                    GO TO 4900-BROWSE-CSR-BACKWARD
  8164                 ELSE
  8165                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8166
  8167     IF EIBAID = DFHPF3
  8168        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8169        MOVE XCTL-EL127         TO PGM-NAME
  8170        GO TO 9300-XCTL.
  8171
  8172     IF (EIBAID = DFHPF15 OR DFHPF6)
  8173        AND (CSR-EDIT-SESSION)
  8174*       AND (FATAL-OR-UNFORCED)
  8175        AND (FATAL-ERRORS)
  8176        MOVE ER-1819             TO EMI-ERROR
  8177        MOVE -1                  TO BMAINTL
  8178        MOVE AL-UANON            TO BMAINTA
  8179        PERFORM 9900-ERROR-FORMAT
  8180                                 THRU 9900-EXIT
  8181        GO TO 8200-SEND-DATAONLY
  8182     END-IF
  8183     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8184      OR (EIBAID = DFHPF10)
  8185        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8186        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8187        IF (RESP-NORMAL)
  8188           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8189              AM-CONTROL-PRIMARY (1:20))
  8190            IF AM-NAME NOT GREATER THAN SPACES OR
  8191               AM-ADDRS NOT GREATER THAN SPACES  OR
  8192               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8193               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8194               AM-ZIP NOT GREATER THAN SPACES
  8195               MOVE ER-3834             TO EMI-ERROR
  8196               MOVE -1                  TO BMAINTL
  8197               MOVE AL-UANON            TO BMAINTA
  8198               PERFORM 9900-ERROR-FORMAT
  8199                                 THRU 9900-EXIT
  8200               GO TO 8200-SEND-DATAONLY
  8201            END-IF
  8202        ELSE
  8203           MOVE ER-1609             TO EMI-ERROR
  8204           MOVE -1                  TO BMAINTL
  8205           MOVE AL-UANON            TO BMAINTA
  8206           PERFORM 9900-ERROR-FORMAT
  8207                                THRU 9900-EXIT
  8208           GO TO 8200-SEND-DATAONLY
  8209        END-IF
  8210
  8211        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8212        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8213        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 155
* EL6311.cbl
  8214            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8215               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8216               MA-CITY NOT GREATER THAN SPACES OR
  8217               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8218               MA-ZIP-CODE NOT GREATER THAN SPACES
  8219               MOVE ER-3835             TO EMI-ERROR
  8220               MOVE -1                  TO BMAINTL
  8221               MOVE AL-UANON            TO BMAINTA
  8222               PERFORM 9900-ERROR-FORMAT
  8223                                 THRU 9900-EXIT
  8224               GO TO 8200-SEND-DATAONLY
  8225            END-IF
  8226        ELSE
  8227           MOVE ER-3000             TO EMI-ERROR
  8228           MOVE -1                  TO BMAINTL
  8229           MOVE AL-UANON            TO BMAINTA
  8230           PERFORM 9900-ERROR-FORMAT
  8231                                THRU 9900-EXIT
  8232           GO TO 8200-SEND-DATAONLY
  8233        END-IF
  8234
  8235     END-IF
  8236     IF (EIBAID = DFHPF15)
  8237        AND (CSR-EDIT-SESSION)
  8238        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8239        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8240        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8241        MOVE PI-SV-STATE         TO PI-STATE
  8242        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8243        MOVE BCERTNOI            TO PI-CERT-PRIME
  8244        MOVE BSUFIXI             TO PI-CERT-SFX
  8245        MOVE BEFFDTI             TO DEEDIT-FIELD
  8246        PERFORM 8600-DEEDIT
  8247        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8248        MOVE '4'                 TO DC-OPTION-CODE
  8249        PERFORM 9700-DATE-LINK
  8250        IF DATE-CONVERSION-ERROR
  8251           MOVE ER-0348          TO EMI-ERROR
  8252           MOVE -1               TO BEFFDTL
  8253           MOVE AL-UABON         TO BEFFDTA
  8254           PERFORM 9900-ERROR-FORMAT
  8255                                 THRU 9900-EXIT
  8256           GO TO 8200-SEND-DATAONLY
  8257        ELSE
  8258           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8259           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8260           MOVE XCTL-EL6315      TO PGM-NAME
  8261           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8262           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8263           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8264           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8265           GO TO 9300-XCTL
  8266        END-IF
  8267     END-IF
  8268
  8269     IF EIBAID = DFHPF4
  8270        MOVE '0'                TO PI-EDIT-SW
  8271        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 156
* EL6311.cbl
  8272           NEXT SENTENCE
  8273        ELSE
  8274           GO TO 7200-DISPLAY-BATCHES.
  8275
  8276     IF EIBAID = DFHPF5
  8277        MOVE ER-0029                TO EMI-ERROR
  8278        MOVE -1                     TO BPFENTRL
  8279        MOVE AL-UNBON               TO BPFENTRA
  8280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8281        GO TO 8200-SEND-DATAONLY.
  8282*        MOVE '0'                TO PI-EDIT-SW
  8283*        IF PI-DISPLAY-ORIGINAL-BATCH
  8284*           NEXT SENTENCE
  8285*        ELSE
  8286*           MOVE EL631B              TO PI-MAP-NAME
  8287*           MOVE LOW-VALUES          TO EL631BI
  8288*           MOVE 'A'                 TO BMAINTO
  8289*           MOVE AL-UANON            TO BMAINTA
  8290*           MOVE -1                  TO BMAINTL
  8291*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8292*           GO TO 8100-SEND-INITIAL-MAP.
  8293
  8294     IF EIBAID = DFHPF6
  8295        IF NOT CSR-EDIT-SESSION
  8296           MOVE ER-0029                TO EMI-ERROR
  8297           MOVE -1                     TO BPFENTRL
  8298           MOVE AL-UNBON               TO BPFENTRA
  8299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8300           GO TO 8200-SEND-DATAONLY
  8301*           MOVE '0'              TO PI-EDIT-SW
  8302*           IF PI-DISPLAY-ORIGINAL-BATCH
  8303*              NEXT SENTENCE
  8304*           ELSE
  8305*              MOVE EL631C        TO PI-MAP-NAME
  8306*              MOVE LOW-VALUES    TO EL631CI
  8307*              MOVE 'A'           TO CMAINTO
  8308*              MOVE AL-UANON      TO CMAINTA
  8309*              MOVE -1            TO CMAINTL
  8310*              MOVE '6'           TO PI-MAINT-FUNCTION
  8311*              GO TO 8100-SEND-INITIAL-MAP
  8312*           END-IF
  8313        ELSE
  8314           PERFORM 5100-PROCESS-POL-RESC
  8315                                 THRU 5100-EXIT
  8316           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8317           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8318                                    PI-PREV-SEQ-NO
  8319           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8320*                                    WS-CANCEL-LETTER-SW
  8321                                    PI-ALL-ISSUES-SW
  8322                                    PI-ALL-CANCELS-SW
  8323           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8324        END-IF
  8325     END-IF
  8326     IF EIBAID = DFHPF7
  8327        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8328        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8329        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 157
* EL6311.cbl
  8330        MOVE PI-SV-STATE            TO PI-STATE
  8331        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8332        MOVE BCERTNOI               TO PI-CERT-PRIME
  8333        MOVE BSUFIXI                TO PI-CERT-SFX
  8334        MOVE BEFFDTI                TO DEEDIT-FIELD
  8335        PERFORM 8600-DEEDIT
  8336        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8337        MOVE '4'                    TO DC-OPTION-CODE
  8338        PERFORM 9700-DATE-LINK
  8339        IF DATE-CONVERSION-ERROR
  8340           MOVE ER-0348            TO EMI-ERROR
  8341           MOVE -1                  TO BEFFDTL
  8342           MOVE AL-UABON            TO BEFFDTA
  8343           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8344           GO TO 8200-SEND-DATAONLY
  8345        ELSE
  8346           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8347           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8348           MOVE XCTL-EL1273        TO PGM-NAME
  8349           GO TO 9300-XCTL.
  8350
  8351     IF EIBAID = DFHPF8
  8352        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8353        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8354        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8355        MOVE PI-SV-STATE            TO PI-STATE
  8356        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8357        MOVE BCERTNOI               TO PI-CERT-PRIME
  8358        MOVE BSUFIXI                TO PI-CERT-SFX
  8359        MOVE BEFFDTI                TO DEEDIT-FIELD
  8360        PERFORM 8600-DEEDIT
  8361        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8362        MOVE '4'                    TO DC-OPTION-CODE
  8363        PERFORM 9700-DATE-LINK
  8364        IF DATE-CONVERSION-ERROR
  8365           MOVE ER-0348            TO EMI-ERROR
  8366           MOVE -1                  TO BEFFDTL
  8367           MOVE AL-UABON            TO BEFFDTA
  8368           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8369           GO TO 8200-SEND-DATAONLY
  8370        ELSE
  8371           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8372           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8373           IF PI-COMPANY-ID = 'DMD'
  8374               MOVE XCTL-EL401DMD      TO PGM-NAME
  8375             ELSE
  8376               MOVE XCTL-EL1279        TO PGM-NAME
  8377           END-IF
  8378           GO TO 9300-XCTL.
  8379
  8380     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8381        MOVE XCTL-EL6312         TO PGM-NAME
  8382
  8383* EXEC CICS XCTL
  8384*           PROGRAM   (PGM-NAME)
  8385*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8386*           LENGTH    (WS-COMM-LENGTH)
  8387*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 158
* EL6311.cbl
  8388*    MOVE '.$C                   %   #00008353' TO DFHEIV0
  8389     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8390     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8391     MOVE X'2020233030303038333533' TO DFHEIV0(25:11)
  8392     CALL 'kxdfhei1' USING DFHEIV0,
  8393           PGM-NAME,
  8394           PROGRAM-INTERFACE-BLOCK,
  8395           WS-COMM-LENGTH,
  8396           DFHEIV99
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8398     ELSE
  8399        MOVE '0'                 TO  PI-EDIT-SW.
  8400
  8401     IF  EIBAID = DFHPF10
  8402         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8403         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8404         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8405                                    PI-1042-WA
  8406         MOVE 4                  TO PI-689-DATA-SOURCE
  8407         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8408         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8409         MOVE PI-SV-STATE        TO PI-689-STATE
  8410         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8411         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8412         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8413         MOVE PI-PB-ALT-CHG-SEQ-NO
  8414                                 TO PI-689-ALT-SEQ-NO
  8415         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8416         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8417         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8418         MOVE +0                 TO PI-689-CONTROL
  8419         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8420                                    PI-689-EXP-DATE
  8421                                    PI-689-RESP-PERSON
  8422                                    PI-689-TYPE
  8423                                    PI-689-FOLLOW-UP-EDIT
  8424                                    PI-689-RESEND1-EDIT
  8425                                    PI-689-SEQ-EDIT
  8426                                    PI-689-BCSEQ-EDIT
  8427                                    PI-689-LBL-OVERRIDE
  8428         MOVE W-LETTER-COMMUNICATION-AREAS
  8429                                 TO PI-PROGRAM-WORK-AREA
  8430         MOVE XCTL-EL689         TO PGM-NAME
  8431         GO TO 9300-XCTL.
  8432
  8433     IF  EIBAID = DFHPF16
  8434         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8435         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8436         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8437                                    PI-1042-WA
  8438         MOVE 4                  TO PI-689-DATA-SOURCE
  8439         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8440         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8441         MOVE PI-SV-STATE        TO PI-689-STATE
  8442         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8443         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8444         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8445         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 159
* EL6311.cbl
  8446                                 TO PI-689-ALT-SEQ-NO
  8447         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8448         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8449         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8450         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8451         MOVE W-LETTER-COMMUNICATION-AREAS
  8452                                 TO PI-PROGRAM-WORK-AREA
  8453         MOVE XCTL-EL690         TO PGM-NAME
  8454         GO TO 9300-XCTL.
  8455
  8456     IF EIBAID = DFHPF13
  8457         MOVE XCTL-EL6313        TO PGM-NAME
  8458         GO TO 9300-XCTL.
  8459
  8460     IF EIBAID = DFHPF17
  8461        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8462        IF (PB-I-LOAN-APR > ZEROS)
  8463           AND (PB-I-BENEFICIARY-NAME NOT
  8464              = SPACES AND LOW-VALUES)
  8465
  8466           MOVE LINK-ELVADS          TO PGM-NAME
  8467
  8468* EXEC CICS LINK
  8469*              PROGRAM    (PGM-NAME)
  8470*              COMMAREA   (WS-PASS-AREA)
  8471*              LENGTH     (WS-PASS-AREA-LENGTH)
  8472*          END-EXEC
  8473*    MOVE '."C                   (   #00008427' TO DFHEIV0
  8474     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8476     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8477     CALL 'kxdfhei1' USING DFHEIV0,
  8478           PGM-NAME,
  8479           WS-PASS-AREA,
  8480           WS-PASS-AREA-LENGTH,
  8481           DFHEIV99,
  8482           DFHEIV99,
  8483           DFHEIV99,
  8484           DFHEIV99
  8485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8486
  8487           MOVE 0000             TO EMI-ERROR
  8488           MOVE -1               TO BMAINTL
  8489           PERFORM 9900-ERROR-FORMAT
  8490                                 THRU 9900-EXIT
  8491           GO TO 8200-SEND-DATAONLY
  8492        ELSE
  8493           MOVE ER-0877            TO EMI-ERROR
  8494           MOVE -1                  TO BEFFDTL
  8495           MOVE AL-UABON            TO BEFFDTA
  8496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8497           GO TO 8200-SEND-DATAONLY
  8498        END-IF
  8499     END-IF
  8500     IF EIBAID = DFHPF14
  8501        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8502        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8503        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 160
* EL6311.cbl
  8504        MOVE PI-SV-STATE            TO PI-CR-STATE
  8505        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8506        MOVE SPACE                  TO PI-EDIT-SW
  8507        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8508        MOVE XCTL-EL650             TO PGM-NAME
  8509        GO TO 9300-XCTL.
  8510
  8511     IF EIBAID = DFHPF15
  8512        IF PI-COMPANY-ID  =  'HER'
  8513            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8514            MOVE XCTL-EL680         TO PGM-NAME
  8515            GO TO 9300-XCTL.
  8516
  8517     IF EIBAID = DFHENTER OR DFHPF11
  8518        GO TO 1000-ISSUE-MAINLINE.
  8519
  8520     MOVE ER-0029                TO EMI-ERROR
  8521     MOVE -1                     TO BPFENTRL
  8522     MOVE AL-UNBON               TO BPFENTRA
  8523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8524     GO TO 8200-SEND-DATAONLY.
  8525
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 161
* EL6311.cbl
  8527
  8528******************************************************************
  8529*                                                                *
  8530*      CANCEL SCREEN PF KEY CHECKING                             *
  8531*                                                                *
  8532******************************************************************
  8533
  8534******************************************************************
  8535*                                                                *
  8536*      PF KEY FUNCTIONS:                                         *
  8537*                                                                *
  8538*      PF1  = BROWSE FORWARD                                     *
  8539*      PF2  = BROWSE BACKWARD                                    *
  8540*      PF3  = CERTIFICATE LOOKUP                                 *
  8541*      PF4  = DISPLAY BATCH HEADER                               *
  8542*      PF5  = ADD ISSUE SCREEN                                   *
  8543*      PF6  = ADD CANCEL SCREEN                                  *
  8544*      PF7  = CERTIFICATE DISPLAY                                *
  8545*      PF8  = CERTIFICATE NOTES                                  *
  8546*      PF9  = EDIT CONTROL                                       *
  8547*      PF10 = DISPLAY LETTER SCREEN                              *
  8548*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8549*      PF12 = DISPLAY HELP SCREEN                                *
  8550*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8551*      PF14 = ACCOUNT MASTER                                     *
  8552*      PF16 = LETTER REVIEW                                      *
  8553*                                                                *
  8554******************************************************************
  8555
  8556 0400-CHECK-CANCEL-PF-KEYS.
  8557     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8558        MOVE ER-2337             TO EMI-ERROR
  8559        MOVE -1                  TO CMAINTL
  8560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8561        GO TO 8200-SEND-DATAONLY.
  8562
  8563     IF EIBAID = DFHPF1
  8564        MOVE '0'                TO PI-EDIT-SW
  8565        IF PI-PRIMARY-BROWSE
  8566           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8567        ELSE
  8568           IF PI-PRIMARY-WITH-SELECT
  8569              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8570           ELSE
  8571              IF PI-FILE-BROWSE
  8572                 GO TO 4300-BROWSE-FILE-FORWARD
  8573              ELSE
  8574                 IF PI-CSR-BROWSE
  8575                    GO TO 4200-BROWSE-CSR-FORWARD
  8576                 ELSE
  8577                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8578
  8579     IF EIBAID = DFHPF2
  8580        MOVE '0'                TO PI-EDIT-SW
  8581        IF PI-PRIMARY-BROWSE
  8582           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8583        ELSE
  8584           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 162
* EL6311.cbl
  8585              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8586           ELSE
  8587              IF PI-FILE-BROWSE
  8588                 GO TO 4800-BROWSE-FILE-BACKWARD
  8589              ELSE
  8590                 IF PI-CSR-BROWSE
  8591                    GO TO 4900-BROWSE-CSR-BACKWARD
  8592                 ELSE
  8593                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8594
  8595     IF EIBAID = DFHPF3
  8596        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8597        MOVE XCTL-EL127         TO PGM-NAME
  8598        GO TO 9300-XCTL.
  8599
  8600     IF (EIBAID = DFHPF15 OR DFHPF17)
  8601        AND (CSR-EDIT-SESSION)
  8602*       AND (FATAL-OR-UNFORCED)
  8603        AND (FATAL-ERRORS)
  8604        MOVE ER-1819             TO EMI-ERROR
  8605        MOVE -1                  TO CMAINTL
  8606        MOVE AL-UANON            TO CMAINTA
  8607        PERFORM 9900-ERROR-FORMAT
  8608                                 THRU 9900-EXIT
  8609        GO TO 8200-SEND-DATAONLY
  8610     END-IF
  8611     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8612       AND (CSR-EDIT-SESSION)
  8613        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8614        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8615        IF (RESP-NORMAL)
  8616           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8617              AM-CONTROL-PRIMARY (1:20))
  8618            IF AM-NAME NOT GREATER THAN SPACES OR
  8619               AM-ADDRS NOT GREATER THAN SPACES  OR
  8620               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8621               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8622               AM-ZIP NOT GREATER THAN SPACES
  8623               MOVE ER-3834             TO EMI-ERROR
  8624               MOVE -1                  TO BMAINTL
  8625               MOVE AL-UANON            TO BMAINTA
  8626               PERFORM 9900-ERROR-FORMAT
  8627                                 THRU 9900-EXIT
  8628               GO TO 8200-SEND-DATAONLY
  8629            END-IF
  8630        ELSE
  8631           MOVE ER-1609             TO EMI-ERROR
  8632           MOVE -1                  TO BMAINTL
  8633           MOVE AL-UANON            TO BMAINTA
  8634           PERFORM 9900-ERROR-FORMAT
  8635                                THRU 9900-EXIT
  8636           GO TO 8200-SEND-DATAONLY
  8637        END-IF
  8638
  8639        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8640        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8641        IF (ERMAIL-FOUND)
  8642            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 163
* EL6311.cbl
  8643               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8644               MA-CITY NOT GREATER THAN SPACES OR
  8645               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8646               MA-ZIP-CODE NOT GREATER THAN SPACES
  8647               MOVE ER-3835             TO EMI-ERROR
  8648               MOVE -1                  TO BMAINTL
  8649               MOVE AL-UANON            TO BMAINTA
  8650               PERFORM 9900-ERROR-FORMAT
  8651                                 THRU 9900-EXIT
  8652               GO TO 8200-SEND-DATAONLY
  8653            END-IF
  8654        ELSE
  8655           MOVE ER-3000             TO EMI-ERROR
  8656           MOVE -1                  TO BMAINTL
  8657           MOVE AL-UANON            TO BMAINTA
  8658           PERFORM 9900-ERROR-FORMAT
  8659                                THRU 9900-EXIT
  8660           GO TO 8200-SEND-DATAONLY
  8661        END-IF
  8662
  8663     END-IF
  8664     IF (EIBAID = DFHPF15 OR DFHPF17)
  8665        AND (CSR-EDIT-SESSION)
  8666        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8667        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8668        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8669        MOVE PI-SV-STATE         TO PI-STATE
  8670        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8671        MOVE CCERTNOI            TO PI-CERT-PRIME
  8672        MOVE CSUFIXI             TO PI-CERT-SFX
  8673        MOVE CEFFDTI             TO DEEDIT-FIELD
  8674        PERFORM 8600-DEEDIT
  8675        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8676        MOVE '4'                 TO DC-OPTION-CODE
  8677        PERFORM 9700-DATE-LINK
  8678        IF DATE-CONVERSION-ERROR
  8679           MOVE ER-0348          TO EMI-ERROR
  8680           MOVE -1               TO CEFFDTL
  8681           MOVE AL-UABON         TO CEFFDTA
  8682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8683           GO TO 8200-SEND-DATAONLY
  8684        ELSE
  8685           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8686           PERFORM 6000-CREATE-TEMP-STORAGE
  8687                                 THRU 6000-EXIT
  8688           IF EIBAID = DFHPF17
  8689               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8690                                  THRU 6400-EXIT
  8691               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8692                                 '2' AND '3' AND '4'
  8693                  MOVE ER-3831     TO  EMI-ERROR
  8694                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8695                  GO TO 8200-SEND-DATAONLY
  8696               END-IF
  8697               MOVE 'Y'          TO PI-CLM-RESC-IND
  8698           ELSE
  8699               MOVE 'N'          TO PI-CLM-RESC-IND
  8700           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 164
* EL6311.cbl
  8701           MOVE XCTL-EL6316      TO PGM-NAME
  8702           MOVE '2'              TO PI-ISS-CAN-SW
  8703           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8704           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8705           GO TO 9300-XCTL
  8706        END-IF
  8707     END-IF
  8708
  8709     IF EIBAID = DFHPF4
  8710        MOVE '0'                TO PI-EDIT-SW
  8711        IF PI-DISPLAY-ORIGINAL-BATCH
  8712           NEXT SENTENCE
  8713        ELSE
  8714           GO TO 7200-DISPLAY-BATCHES.
  8715
  8716     IF EIBAID = DFHPF5
  8717        MOVE ER-0029                TO EMI-ERROR
  8718        MOVE -1                     TO BPFENTRL
  8719        MOVE AL-UNBON               TO BPFENTRA
  8720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8721        GO TO 8200-SEND-DATAONLY.
  8722*        MOVE '0'                TO PI-EDIT-SW
  8723*        IF PI-DISPLAY-ORIGINAL-BATCH
  8724*           NEXT SENTENCE
  8725*        ELSE
  8726*           MOVE EL631B              TO PI-MAP-NAME
  8727*           MOVE LOW-VALUES          TO EL631BI
  8728*           MOVE 'A'                 TO BMAINTO
  8729*           MOVE AL-UANON            TO BMAINTA
  8730*           MOVE -1                  TO BMAINTL
  8731*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8732*           GO TO 8100-SEND-INITIAL-MAP.
  8733
  8734     IF EIBAID = DFHPF6
  8735        MOVE ER-0029                TO EMI-ERROR
  8736        MOVE -1                     TO BPFENTRL
  8737        MOVE AL-UNBON               TO BPFENTRA
  8738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8739        GO TO 8200-SEND-DATAONLY.
  8740*        MOVE '0'                TO PI-EDIT-SW
  8741*        IF PI-DISPLAY-ORIGINAL-BATCH
  8742*           NEXT SENTENCE
  8743*        ELSE
  8744*           MOVE EL631C              TO PI-MAP-NAME
  8745*           MOVE LOW-VALUES          TO EL631CI
  8746*           MOVE 'A'                 TO CMAINTO
  8747*           MOVE AL-UANON            TO CMAINTA
  8748*           MOVE -1                  TO CMAINTL
  8749*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8750*           GO TO 8100-SEND-INITIAL-MAP.
  8751
  8752     IF EIBAID = DFHPF7
  8753        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8754        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8755        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8756        MOVE PI-SV-STATE            TO PI-STATE
  8757        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8758        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 165
* EL6311.cbl
  8759        MOVE CSUFIXI                TO PI-CERT-SFX
  8760        MOVE CEFFDTI                TO DEEDIT-FIELD
  8761        PERFORM 8600-DEEDIT
  8762        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8763        MOVE '4'                    TO DC-OPTION-CODE
  8764        PERFORM 9700-DATE-LINK
  8765        IF DATE-CONVERSION-ERROR
  8766           MOVE ER-0348            TO EMI-ERROR
  8767           MOVE -1                  TO BEFFDTL
  8768           MOVE AL-UABON            TO BEFFDTA
  8769           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8770           GO TO 8200-SEND-DATAONLY
  8771        ELSE
  8772           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8773           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8774           MOVE XCTL-EL1273        TO PGM-NAME
  8775           GO TO 9300-XCTL.
  8776
  8777     IF EIBAID = DFHPF8
  8778        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8779        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8780        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8781        MOVE PI-SV-STATE            TO PI-STATE
  8782        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8783        MOVE CCERTNOI               TO PI-CERT-PRIME
  8784        MOVE CSUFIXI                TO PI-CERT-SFX
  8785        MOVE CEFFDTI                TO DEEDIT-FIELD
  8786        PERFORM 8600-DEEDIT
  8787        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8788        MOVE '4'                    TO DC-OPTION-CODE
  8789        PERFORM 9700-DATE-LINK
  8790        IF DATE-CONVERSION-ERROR
  8791           MOVE ER-0348             TO EMI-ERROR
  8792           MOVE -1                  TO BEFFDTL
  8793           MOVE AL-UABON            TO BEFFDTA
  8794           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8795           GO TO 8200-SEND-DATAONLY
  8796        ELSE
  8797           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8798           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8799           IF PI-COMPANY-ID = 'DMD'
  8800               MOVE XCTL-EL401DMD      TO PGM-NAME
  8801             ELSE
  8802               MOVE XCTL-EL1279        TO PGM-NAME
  8803           END-IF
  8804           GO TO 9300-XCTL.
  8805
  8806     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8807        MOVE XCTL-EL6312     TO PGM-NAME
  8808
  8809* EXEC CICS XCTL
  8810*           PROGRAM  (PGM-NAME)
  8811*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8812*           LENGTH   (WS-COMM-LENGTH)
  8813*       END-EXEC
  8814*    MOVE '.$C                   %   #00008754' TO DFHEIV0
  8815     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 166
* EL6311.cbl
  8817     MOVE X'2020233030303038373534' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0,
  8819           PGM-NAME,
  8820           PROGRAM-INTERFACE-BLOCK,
  8821           WS-COMM-LENGTH,
  8822           DFHEIV99
  8823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8824     ELSE
  8825        MOVE '0'                 TO  PI-EDIT-SW.
  8826
  8827     IF EIBAID = DFHPF10
  8828         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8829         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8830         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8831         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8832                                    PI-1042-WA
  8833         MOVE 4                  TO PI-689-DATA-SOURCE
  8834         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8835         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8836         MOVE PI-SV-STATE        TO PI-689-STATE
  8837         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8838         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8839         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8840         MOVE PI-PB-ALT-CHG-SEQ-NO
  8841                                 TO PI-689-ALT-SEQ-NO
  8842         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8843         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8844         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8845         MOVE +0                 TO PI-689-CONTROL
  8846         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8847                                    PI-689-EXP-DATE
  8848                                    PI-689-RESP-PERSON
  8849                                    PI-689-TYPE
  8850                                    PI-689-FOLLOW-UP-EDIT
  8851                                    PI-689-RESEND1-EDIT
  8852                                    PI-689-SEQ-EDIT
  8853                                    PI-689-BCSEQ-EDIT
  8854                                    PI-689-LBL-OVERRIDE
  8855         MOVE W-LETTER-COMMUNICATION-AREAS
  8856                                 TO PI-PROGRAM-WORK-AREA
  8857         MOVE XCTL-EL689         TO PGM-NAME
  8858         GO TO 9300-XCTL.
  8859
  8860     IF  EIBAID = DFHPF16
  8861         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8862         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8863         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8864                                    PI-1042-WA
  8865         MOVE 4                  TO PI-689-DATA-SOURCE
  8866         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8867         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8868         MOVE PI-SV-STATE        TO PI-689-STATE
  8869         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8870         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8871         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8872         MOVE PI-PB-ALT-CHG-SEQ-NO
  8873                                 TO PI-689-ALT-SEQ-NO
  8874         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 167
* EL6311.cbl
  8875         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8876         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8877         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8878         MOVE W-LETTER-COMMUNICATION-AREAS
  8879                                 TO PI-PROGRAM-WORK-AREA
  8880         MOVE XCTL-EL690         TO PGM-NAME
  8881         GO TO 9300-XCTL.
  8882
  8883     IF EIBAID = DFHPF13
  8884        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8885        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8886        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8887        MOVE PI-SV-STATE            TO PI-STATE
  8888        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8889        MOVE CCERTNOI               TO PI-CERT-PRIME
  8890        MOVE CSUFIXI                TO PI-CERT-SFX
  8891        MOVE CEFFDTI                TO DEEDIT-FIELD
  8892        PERFORM 8600-DEEDIT
  8893        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8894        MOVE '4'                    TO DC-OPTION-CODE
  8895        PERFORM 9700-DATE-LINK
  8896        IF DATE-CONVERSION-ERROR
  8897           MOVE ER-0348            TO EMI-ERROR
  8898           MOVE -1                  TO CEFFDTL
  8899           MOVE AL-UABON            TO CEFFDTA
  8900           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8901           GO TO 8200-SEND-DATAONLY
  8902        ELSE
  8903           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8904           MOVE AL-UANON            TO CEFFDTA
  8905           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8906           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8907           MOVE XCTL-EL677         TO PGM-NAME
  8908           GO TO 9300-XCTL.
  8909
  8910     IF EIBAID = DFHPF14
  8911        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8912        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8913        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8914        MOVE PI-SV-STATE            TO PI-CR-STATE
  8915        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8916        MOVE SPACE                  TO PI-EDIT-SW
  8917        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8918        MOVE XCTL-EL650             TO PGM-NAME
  8919        GO TO 9300-XCTL.
  8920
  8921     IF EIBAID = DFHENTER OR DFHPF11
  8922        GO TO 2000-CANCEL-MAINLINE.
  8923
  8924     MOVE ER-0029                TO EMI-ERROR.
  8925     MOVE -1                     TO CPFENTRL.
  8926     MOVE AL-UNBON               TO CPFENTRA.
  8927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8928     GO TO 8200-SEND-DATAONLY.
  8929
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 168
* EL6311.cbl
  8931
  8932******************************************************************
  8933*                                                                *
  8934*      BATCH SCREEN PF KEY CHECKING                              *
  8935*                                                                *
  8936******************************************************************
  8937
  8938******************************************************************
  8939*                                                                *
  8940*      PF KEY FUNCTIONS:                                         *
  8941*                                                                *
  8942*      PF1 = BROWSE FORWARD                                      *
  8943*      PF2 = BROWSE BACKWARD                                     *
  8944*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8945*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8946*                                                                *
  8947*                                                                *
  8948******************************************************************
  8949
  8950 0500-CHECK-BATCH-PF-KEYS.
  8951     IF EIBAID = DFHPF1
  8952        MOVE '0'                TO PI-EDIT-SW
  8953        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8954           GO TO 5000-BROWSE-BATCH-HEADERS
  8955        ELSE
  8956           IF PI-GOOD-BROWSE
  8957              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8958                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  8959              ELSE
  8960                 IF PI-FILE-BROWSE
  8961                    GO TO 4300-BROWSE-FILE-FORWARD
  8962                 ELSE
  8963                    IF PI-CSR-BROWSE
  8964                       GO TO 4200-BROWSE-CSR-FORWARD
  8965                    ELSE
  8966                       GO TO 4000-BROWSE-DETAIL-FORWARD
  8967           ELSE
  8968              GO TO 0800-BROWSE-ERROR.
  8969
  8970     IF EIBAID = DFHPF2
  8971        MOVE '0'                TO PI-EDIT-SW
  8972        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8973           GO TO 5500-BROWSE-BATCH-BACKWARD
  8974        ELSE
  8975           IF PI-GOOD-BROWSE
  8976              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8977                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8978              ELSE
  8979                 IF PI-FILE-BROWSE
  8980                    GO TO 4800-BROWSE-FILE-BACKWARD
  8981                 ELSE
  8982                    IF PI-CSR-BROWSE
  8983                       GO TO 4900-BROWSE-CSR-BACKWARD
  8984                    ELSE
  8985                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  8986           ELSE
  8987              GO TO 0800-BROWSE-ERROR.
  8988
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 169
* EL6311.cbl
  8989     IF EIBAID = DFHPF3
  8990        GO TO 3000-BATCH-MAINLINE.
  8991
  8992     IF  EIBAID = DFHPF4
  8993        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8994        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8995        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8996        MOVE PI-SV-STATE            TO PI-CR-STATE
  8997        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8998                                       PI-CR-FIN-RESP
  8999        MOVE 'A'                    TO PI-CR-TYPE
  9000        MOVE SPACE                  TO PI-EDIT-SW
  9001        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9002        MOVE XCTL-EL640             TO PGM-NAME
  9003        GO TO 9300-XCTL.
  9004
  9005     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9006       AND
  9007        (EIBAID = DFHENTER)
  9008           GO TO 3500-EDIT-BATCH-DATA.
  9009
  9010     IF EIBAID = DFHENTER
  9011        GO TO 3500-EDIT-BATCH-DATA.
  9012
  9013     MOVE ER-0029             TO EMI-ERROR.
  9014     MOVE -1                  TO DPFENTRL.
  9015     MOVE AL-UNBON            TO DPFENTRA.
  9016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9017     GO TO 8200-SEND-DATAONLY.
  9018
  9019 0800-BROWSE-ERROR.
  9020     MOVE ER-2258                TO EMI-ERROR.
  9021     MOVE -1                     TO DPFENTRL.
  9022     MOVE AL-UNBON               TO DPFENTRA.
  9023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9024     GO TO 8200-SEND-DATAONLY.
  9025
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 170
* EL6311.cbl
  9027
  9028******************************************************************
  9029*                                                                *
  9030*                I S S U E   M A I N L I N E                     *
  9031*                                                                *
  9032******************************************************************
  9033
  9034 1000-ISSUE-MAINLINE.
  9035     IF PI-DISPLAY-ORIGINAL-BATCH
  9036        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9037           MOVE ER-0023             TO EMI-ERROR
  9038           MOVE -1                  TO BMAINTL
  9039           MOVE AL-UABON            TO BMAINTA
  9040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9041           GO TO 8200-SEND-DATAONLY
  9042        ELSE
  9043           NEXT SENTENCE
  9044     ELSE
  9045        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9046           MOVE ER-0023             TO EMI-ERROR
  9047           MOVE -1                  TO BMAINTL
  9048           MOVE AL-UABON            TO BMAINTA
  9049           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9050           GO TO 8200-SEND-DATAONLY.
  9051
  9052     IF BMAINTI = 'S'
  9053        GO TO 1100-SHOW-REQUEST.
  9054
  9055     IF NOT MODIFY-CAP
  9056         MOVE 'UPDATE'       TO SM-READ
  9057         PERFORM 9995-SECURITY-VIOLATION
  9058         MOVE ER-0070        TO EMI-ERROR
  9059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9060         GO TO 8100-SEND-INITIAL-MAP.
  9061
  9062     IF BMAINTL GREATER THAN ZEROS
  9063        IF PI-PF5-FUNCTION
  9064           IF BMAINTI NOT = 'A'
  9065              MOVE AL-UABON  TO BMAINTA
  9066              MOVE -1        TO BMAINTL
  9067              MOVE ER-2260   TO EMI-ERROR
  9068              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069              GO TO 8200-SEND-DATAONLY.
  9070
  9071     IF BCERTNOL = ZEROS
  9072       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9073         NEXT SENTENCE
  9074     ELSE
  9075         IF BCERTNOL NOT = ZEROS
  9076             MOVE AL-UANON       TO BCERTNOA
  9077         ELSE
  9078             MOVE -1             TO BCERTNOL
  9079             MOVE  1             TO SET-CURSOR-SW
  9080             MOVE ER-2218        TO EMI-ERROR
  9081             MOVE AL-UABON       TO BCERTNOA
  9082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9083
  9084     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 171
* EL6311.cbl
  9085         MOVE AL-UANON       TO BSUFIXA
  9086     ELSE
  9087         MOVE AL-SANOF       TO BSUFIXA.
  9088
  9089     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9090        NEXT SENTENCE
  9091     ELSE
  9092        IF BEFFDTL NOT = ZEROS
  9093           MOVE AL-UNNON             TO BEFFDTA
  9094           MOVE BEFFDTI              TO DEEDIT-FIELD
  9095           PERFORM 8600-DEEDIT
  9096           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9097           MOVE 4                    TO DC-OPTION-CODE
  9098           PERFORM 9700-DATE-LINK
  9099           IF NO-CONVERSION-ERROR
  9100              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9101              ELSE
  9102              MOVE -1                TO BEFFDTL
  9103              MOVE  1                TO SET-CURSOR-SW
  9104              MOVE ER-2226           TO EMI-ERROR
  9105              MOVE AL-UNBON          TO BEFFDTA
  9106              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9107           ELSE
  9108              MOVE -1                TO BEFFDTL
  9109              MOVE  1                TO SET-CURSOR-SW
  9110              MOVE ER-2220           TO EMI-ERROR
  9111              MOVE AL-UNBON          TO BEFFDTA
  9112              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9113
  9114     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9115
  9116     IF BCERTNOL NOT = ZEROS
  9117        MOVE BCERTNOI                TO WS-NEW-PRIME
  9118     ELSE
  9119        MOVE SPACES                  TO WS-NEW-PRIME.
  9120
  9121     IF BSUFIXL NOT = ZEROS
  9122        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9123     ELSE
  9124        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9125
  9126     IF BEFFDTL NOT = ZEROS
  9127        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9128     ELSE
  9129        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9130
  9131     IF BMAINTI = 'A' OR 'K' OR 'S'
  9132        NEXT SENTENCE
  9133     ELSE
  9134        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9135        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9136           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9137           WS-PB-RECORD-TYPE NOT = '1'
  9138           IF BMAINTI = 'C'
  9139               MOVE ER-2287          TO EMI-ERROR
  9140               MOVE -1               TO BCERTNOL
  9141               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9142               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 172
* EL6311.cbl
  9143               GO TO 8200-SEND-DATAONLY
  9144             ELSE
  9145               MOVE ER-2260          TO EMI-ERROR
  9146               MOVE -1               TO BCERTNOL
  9147               MOVE AL-UABON         TO BCERTNOA
  9148               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9149               GO TO 8200-SEND-DATAONLY.
  9150
  9151     IF BMAINTI = 'D'
  9152         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9153
  9154*    IF BMICRNOL  NOT =  ZEROS
  9155*        IF BMICRNOI  NUMERIC
  9156*            MOVE AL-UNNON       TO  BMICRNOA
  9157*        ELSE
  9158*            MOVE -1             TO  BMICRNOL
  9159*            MOVE 1              TO  SET-CURSOR-SW
  9160*            MOVE AL-UNBON       TO  BMICRNOA
  9161*            MOVE ER-2701        TO  EMI-ERROR
  9162*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9163     IF BVINL NOT = ZEROS
  9164        MOVE AL-UANON            TO BVINA
  9165     END-IF
  9166     IF B1STNML NOT = ZEROS
  9167         MOVE AL-UANON                TO B1STNMA.
  9168
  9169     IF BINITL  NOT = ZEROS
  9170        MOVE AL-UANON                TO BINITA.
  9171
  9172     IF BSEXL NOT = ZEROS
  9173        IF BSEXI = 'M' OR 'F'
  9174           MOVE AL-UANON             TO BSEXA
  9175        ELSE
  9176           MOVE -1               TO BSEXL
  9177           MOVE ER-2629          TO EMI-ERROR
  9178           MOVE AL-UABON         TO BSEXA
  9179           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9180
  9181     IF BAGEL NOT = ZEROS
  9182         IF BAGEI NUMERIC
  9183             MOVE BAGEI              TO WS-BAGE
  9184             MOVE AL-UNNON           TO BAGEA
  9185         ELSE
  9186             MOVE -1                 TO BAGEL
  9187             MOVE  1                 TO SET-CURSOR-SW
  9188             MOVE ER-2223            TO EMI-ERROR
  9189             MOVE AL-UNBON           TO BAGEA
  9190             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9191
  9192     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9193
  9194     IF (BBIRTHL GREATER THAN +0) AND
  9195        (BBIRTHI NOT EQUAL SPACES)
  9196        NEXT SENTENCE
  9197     ELSE
  9198        GO TO 1010-CHECK-AGE.
  9199
  9200     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 173
* EL6311.cbl
  9201     PERFORM 8600-DEEDIT.
  9202     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9203     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9204     MOVE AL-UNNON               TO BBIRTHA.
  9205     MOVE '4'                    TO DC-OPTION-CODE.
  9206     PERFORM 9700-DATE-LINK.
  9207     IF DATE-CONVERSION-ERROR
  9208        MOVE -1                  TO BBIRTHL
  9209        MOVE  1                  TO SET-CURSOR-SW
  9210        MOVE ER-2228             TO EMI-ERROR
  9211        MOVE AL-UNBON            TO BBIRTHA
  9212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9213        GO TO 1010-CHECK-AGE.
  9214
  9215     IF (NO-CONVERSION-ERROR) AND
  9216        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9217        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9218        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9219        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9220                                    WS-CONVERTED-BIRTH
  9221        MOVE AL-UANON            TO BBIRTHA
  9222     ELSE
  9223        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9224        MOVE AL-UANON            TO BBIRTHA.
  9225
  9226 1010-CHECK-AGE.
  9227
  9228*    IF BAGEL = ZERO
  9229*       IF BBIRTHL GREATER THAN ZERO
  9230*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9231
  9232     IF B1STPMTL NOT = ZEROS
  9233        IF B1STPMTI = SPACES
  9234           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9235        ELSE
  9236           MOVE B1STPMTI             TO DEEDIT-FIELD
  9237           PERFORM 8600-DEEDIT
  9238           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9239           MOVE AL-UNNON             TO B1STPMTA
  9240           MOVE 4                    TO DC-OPTION-CODE
  9241           PERFORM 9700-DATE-LINK
  9242           IF NO-CONVERSION-ERROR
  9243              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9244              MOVE AL-UANON          TO B1STPMTA
  9245           ELSE
  9246              MOVE -1                TO B1STPMTL
  9247              MOVE  1                TO SET-CURSOR-SW
  9248              MOVE ER-2200           TO EMI-ERROR
  9249              MOVE AL-UNBON          TO B1STPMTA
  9250              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9251
  9252     IF BDAYSL NOT = ZEROS
  9253         IF BDAYSI NUMERIC
  9254             MOVE AL-UNNON           TO BDAYSA
  9255         ELSE
  9256             MOVE -1                 TO BDAYSL
  9257             MOVE ER-2530            TO EMI-ERROR
  9258             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 174
* EL6311.cbl
  9259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9260
  9261     IF BLNTRML NOT = ZEROS
  9262         IF BLNTRMI NUMERIC
  9263             MOVE AL-UNNON       TO BLNTRMA
  9264         ELSE
  9265             MOVE -1             TO BLNTRML
  9266             MOVE ER-2533        TO EMI-ERROR
  9267             MOVE AL-UNBON       TO BLNTRMA
  9268             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9269
  9270**   IF PI-COMPANY-ID = 'DMD'
  9271     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9272        NEXT SENTENCE
  9273     ELSE
  9274         IF BLNOFCRL NOT = ZEROS
  9275            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9276            IF LOAN-OFFICER-FOUND
  9277                MOVE AL-UANON        TO BLNOFCRA
  9278             ELSE
  9279                 MOVE SPACE          TO WS-LOAN-OFFICER
  9280                 MOVE -1             TO BLNOFCRL
  9281                 MOVE  1             TO SET-CURSOR-SW
  9282                 MOVE ER-3006        TO EMI-ERROR
  9283                 MOVE AL-UNBON       TO BLNOFCRA
  9284                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285
  9286     IF BFREQL NOT = ZEROS
  9287         IF BFREQI NUMERIC
  9288             MOVE AL-UNNON       TO BFREQA
  9289         ELSE
  9290             MOVE -1             TO BFREQL
  9291             MOVE  1             TO SET-CURSOR-SW
  9292             MOVE ER-2223        TO EMI-ERROR
  9293             MOVE AL-UNBON       TO BFREQA
  9294             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9295
  9296     IF BMODEL NOT = ZEROS
  9297         MOVE BMODEI             TO WS-MODE-CODE
  9298                                    PI-BMODE
  9299         IF WS-MODE-CODE-VALID
  9300             MOVE AL-UANON       TO BMODEA
  9301         ELSE
  9302             MOVE -1             TO BMODEL
  9303             MOVE ER-2591        TO EMI-ERROR
  9304             MOVE AL-UABON       TO BMODEA
  9305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9306
  9307     IF BPMTSL NOT = ZEROS
  9308         IF BPMTSI NUMERIC
  9309             MOVE AL-UNNON           TO BPMTSA
  9310             MOVE BPMTSI             TO PI-BPMTS
  9311         ELSE
  9312             MOVE -1                 TO BPMTSL
  9313             MOVE ER-2592            TO EMI-ERROR
  9314             MOVE AL-UNBON           TO BPMTSA
  9315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9316
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 175
* EL6311.cbl
  9317     IF BPMTAMTL NOT = ZEROS
  9318
  9319* EXEC CICS BIF DEEDIT
  9320*            FIELD  (BPMTAMTI)
  9321*            LENGTH (9)
  9322*       END-EXEC
  9323     MOVE 9
  9324       TO DFHEIV11
  9325*    MOVE '@"L                   #   #00009253' TO DFHEIV0
  9326     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9327     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9328     MOVE X'2020233030303039323533' TO DFHEIV0(25:11)
  9329     CALL 'kxdfhei1' USING DFHEIV0,
  9330           BPMTAMTI,
  9331           DFHEIV11
  9332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9333        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9334*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9335*        PERFORM 8600-DEEDIT
  9336*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9337
  9338*    IF BAPRL NOT = ZEROS
  9339*        EXEC CICS BIF DEEDIT
  9340*            FIELD  (BAPRI)
  9341*            LENGTH (7)
  9342*        END-EXEC
  9343*        MOVE BAPRI              TO WS-BAPR.
  9344
  9345     IF BAPRL > 0
  9346        MOVE +0                  TO  WS-BAPR
  9347        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9348           (WS-SUB > 7)
  9349           OR (BAPRI (WS-SUB:1) NUMERIC)
  9350           OR (BAPRI (WS-SUB:1) = '.')
  9351        END-PERFORM
  9352        IF WS-SUB > 7
  9353           MOVE ER-2471       TO EMI-ERROR
  9354           MOVE -1            TO BAPRL
  9355           MOVE AL-UNBON      TO BAPRA
  9356           PERFORM 9900-ERROR-FORMAT
  9357                                 THRU 9900-EXIT
  9358        ELSE
  9359           IF BAPRI (WS-SUB:1) NUMERIC
  9360              MOVE WS-SUB           TO WS-BEG
  9361              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9362                 (WS-SUB > 7)
  9363                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9364              END-PERFORM
  9365              COMPUTE WS-END = WS-SUB - WS-BEG
  9366              MOVE BAPRI (WS-BEG:WS-END)
  9367                                 TO WS-APR-WHOLE-NUM
  9368           END-IF
  9369           IF BAPRI (WS-SUB:1) = '.'
  9370              COMPUTE WS-BEG = WS-SUB + 1
  9371              IF (WS-BEG < 8)
  9372                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9373                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9374                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 176
* EL6311.cbl
  9375                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9376                 END-PERFORM
  9377                 COMPUTE WS-END = WS-SUB - WS-BEG
  9378                 MOVE BAPRI (WS-BEG:WS-END)
  9379                                 TO WS-APR-DEC (1:WS-END)
  9380              END-IF
  9381           END-IF
  9382           MOVE AL-UNNON      TO BAPRA
  9383           MOVE WS-BAPR       TO BAPRO
  9384        END-IF
  9385     END-IF
  9386*     IF BAPRL NOT = ZEROS
  9387*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9388*        PERFORM 8600-DEEDIT
  9389*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9390
  9391     IF BLIVESL NOT = ZEROS
  9392        MOVE BLIVESI             TO DEEDIT-FIELD
  9393        PERFORM 8600-DEEDIT
  9394        IF DEEDIT-FIELD-V0 NUMERIC
  9395           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9396           MOVE AL-UNNON         TO BLIVESA
  9397        ELSE
  9398           MOVE -1               TO BLIVESL
  9399           MOVE AL-UNBON         TO BLIVESA
  9400           MOVE ER-2223          TO EMI-ERROR
  9401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403*DMD CUSTOM CODING*************START
  9404*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9405     IF PI-COMPANY-ID NOT = 'DMD'
  9406         MOVE ZEROS               TO BBILLEDL
  9407         GO TO 1010-EDIT-CONT.
  9408
  9409     IF BBILLEDL NOT = ZEROS
  9410        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9411        MOVE 'Y'                 TO WS-NUMERIC-SW
  9412        MOVE +1                  TO WS-CSO-SUB
  9413        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9414        IF CSO-NUMERIC-FIELD
  9415
  9416* EXEC CICS BIF DEEDIT
  9417*              FIELD  (BBILLEDI)
  9418*              LENGTH (9)
  9419*          END-EXEC
  9420     MOVE 9
  9421       TO DFHEIV11
  9422*    MOVE '@"L                   #   #00009339' TO DFHEIV0
  9423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9425     MOVE X'2020233030303039333339' TO DFHEIV0(25:11)
  9426     CALL 'kxdfhei1' USING DFHEIV0,
  9427           BBILLEDI,
  9428           DFHEIV11
  9429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9430           MOVE BBILLEDI         TO WS-BILLED
  9431           MOVE AL-UNNON         TO BBILLEDA
  9432        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 177
* EL6311.cbl
  9433           MOVE -1               TO BBILLEDL
  9434           MOVE AL-UNBON         TO BBILLEDA
  9435           MOVE ER-2547          TO EMI-ERROR
  9436           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9437     ELSE
  9438        IF BMAINTI EQUAL 'A'
  9439           MOVE -1               TO BBILLEDL
  9440           MOVE AL-UNBON         TO BBILLEDA
  9441           MOVE ER-8148          TO EMI-ERROR
  9442           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9443
  9444 1010-EDIT-CONT.
  9445
  9446     IF BFORCEL  NOT = ZEROS
  9447         IF FORCE-CAP
  9448            MOVE AL-UANON            TO BFORCEA
  9449         ELSE
  9450            MOVE ER-2945             TO EMI-ERROR
  9451            MOVE AL-UABON            TO BFORCEA
  9452            MOVE -1                  TO BFORCEL
  9453            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9454
  9455     IF BENTRYL NOT = ZEROS
  9456        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9457                         'D' AND 'V' AND 'U' AND 'M'
  9458           MOVE ER-2224              TO EMI-ERROR
  9459           MOVE AL-UABON             TO BENTRYA
  9460           MOVE -1                   TO BENTRYL
  9461           MOVE  1                   TO SET-CURSOR-SW
  9462           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463        ELSE
  9464           MOVE AL-UANON             TO BENTRYA.
  9465
  9466     IF BUNWRITL NOT = ZEROS
  9467        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9468           MOVE ER-7574              TO EMI-ERROR
  9469           MOVE AL-UABON             TO BUNWRITA
  9470           MOVE -1                   TO BUNWRITL
  9471           MOVE  1                   TO SET-CURSOR-SW
  9472           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9473        ELSE
  9474           MOVE AL-UANON             TO BUNWRITA.
  9475
  9476     IF BREINL  NOT = ZEROS
  9477         MOVE AL-UANON               TO BREINA.
  9478
  9479     IF BBILCDL NOT = ZEROS
  9480        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9481                             AND 'A' AND 'B' AND 'E'
  9482           MOVE ER-2225              TO EMI-ERROR
  9483           MOVE AL-UABON             TO BBILCDA
  9484           MOVE -1                   TO BBILCDL
  9485           MOVE  1                   TO SET-CURSOR-SW
  9486           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9487        ELSE
  9488           MOVE AL-UANON             TO BBILCDA.
  9489
  9490     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 178
* EL6311.cbl
  9491         MOVE AL-UANON               TO BSKPCDA.
  9492
  9493     IF BINDGRPL NOT = ZEROS
  9494         MOVE AL-UANON               TO BINDGRPA.
  9495
  9496     IF BSIGL   NOT = ZEROS
  9497         MOVE AL-UANON               TO BSIGA.
  9498
  9499     IF BRTCLSL NOT = ZEROS
  9500         MOVE AL-UANON               TO BRTCLSA.
  9501
  9502     IF BMEMBERL NOT = ZEROS
  9503         MOVE AL-UANON               TO BMEMBERA.
  9504
  9505     MOVE +0                         TO WS-SUB1.
  9506
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 179
* EL6311.cbl
  9508
  9509******************************************************************
  9510*                                                                *
  9511*           E D I T   I S S U E   C O V E R A G E S              *
  9512*                                                                *
  9513******************************************************************
  9514
  9515 1020-EDIT-COVERAGES.
  9516     ADD +1                      TO WS-SUB1.
  9517
  9518     IF WS-SUB1 GREATER +2
  9519        GO TO 1025-EDIT-COMPLETE.
  9520
  9521     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9522       IF (BMODEL   GREATER ZERO  OR
  9523            BPMTSL   GREATER ZERO  OR
  9524            BPMTAMTL GREATER ZERO)
  9525          AND
  9526            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9527               GO TO 1021-CONT-EDIT.
  9528
  9529     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9530        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9531        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9532        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9533        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9534        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9535        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9536        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9537        NEXT SENTENCE
  9538         ELSE
  9539            GO TO 1020-EDIT-COVERAGES.
  9540
  9541 1021-CONT-EDIT.
  9542
  9543     IF BMAINTI = 'A'
  9544        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9545           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9546        ELSE
  9547           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9548           MOVE ER-7404          TO EMI-ERROR
  9549           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9550           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9551     ELSE
  9552        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9553           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9554
  9555     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9556        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9557        PERFORM 8600-DEEDIT
  9558        IF DEEDIT-FIELD-V0 NUMERIC
  9559           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9560        ELSE
  9561           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9562
  9563     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9564*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9565        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 180
* EL6311.cbl
  9566           BPMTSL  GREATER THAN ZEROS
  9567           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9568
  9569     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9570         IF BMODEL   GREATER THAN ZEROS  OR
  9571            BPMTSL   GREATER THAN ZEROS  OR
  9572            BPMTAMTL GREATER THAN ZEROS
  9573             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9574
  9575     IF BMAINTI = ('C' OR 'K')
  9576        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9577           NEXT SENTENCE
  9578        ELSE
  9579           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9580           PERFORM 8600-DEEDIT
  9581           IF DEEDIT-FIELD-V0 NUMERIC
  9582              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9583              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9584                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9585              ELSE
  9586                    MOVE ER-2241      TO EMI-ERROR
  9587                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9588                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9589                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9590           ELSE
  9591              MOVE ER-2223          TO EMI-ERROR
  9592              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9593              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9595     ELSE
  9596        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9597            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9598            PERFORM 8600-DEEDIT
  9599            IF DEEDIT-FIELD-V0      NUMERIC
  9600               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9601                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9602                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9603               ELSE
  9604                  MOVE ER-2241         TO EMI-ERROR
  9605                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9606                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9607                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9608            ELSE
  9609              MOVE ER-2223             TO EMI-ERROR
  9610              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9611              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9612              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9613        ELSE
  9614            MOVE ER-2240               TO EMI-ERROR
  9615            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9616            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9617*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9618*        IF BMODEL  GREATER THAN ZEROS  AND
  9619*           BPMTSL  GREATER THAN ZEROS
  9620*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9621
  9622     IF BBEN-LEN (WS-SUB1) = ZEROS
  9623        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 181
* EL6311.cbl
  9624           NEXT SENTENCE
  9625     ELSE
  9626        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9627           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9628
  9629* EXEC CICS BIF DEEDIT
  9630*              FIELD  (BBENI (WS-SUB1))
  9631*              LENGTH (12)
  9632*          END-EXEC
  9633     MOVE 12
  9634       TO DFHEIV11
  9635*    MOVE '@"L                   #   #00009541' TO DFHEIV0
  9636     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9637     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9638     MOVE X'2020233030303039353431' TO DFHEIV0(25:11)
  9639     CALL 'kxdfhei1' USING DFHEIV0,
  9640           BBENI(WS-SUB1),
  9641           DFHEIV11
  9642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9643           IF BBENI (WS-SUB1)  NUMERIC
  9644              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9645                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9646*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9647*          PERFORM 8600-DEEDIT
  9648*          IF DEEDIT-FIELD-V2  NUMERIC
  9649*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9650*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9651              ELSE
  9652                 MOVE ER-7632    TO EMI-ERROR
  9653                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9654                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9655                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9656           ELSE
  9657              MOVE ER-2223         TO EMI-ERROR
  9658              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9659              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9660              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9661        ELSE
  9662           MOVE ER-7632    TO EMI-ERROR
  9663           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9664           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9666
  9667     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9668        AND (BMAINTI = ('C' OR 'K'))
  9669        CONTINUE
  9670     ELSE
  9671        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9672           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9673           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9674              FOR ALL '.'
  9675           IF WS-TALLY > 1
  9676              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9677                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9678              END-PERFORM
  9679              IF A1 < 9
  9680                 ADD 3 TO A1
  9681                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 182
* EL6311.cbl
  9682              END-IF
  9683           ELSE
  9684              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9685                (A1 > 11)
  9686                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9687                  LOW-VALUES OR SPACES)
  9688              END-PERFORM
  9689              IF A1 > 1 AND < 12
  9690                 MOVE SPACES
  9691                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9692              END-IF
  9693           END-IF
  9694
  9695* EXEC CICS BIF DEEDIT
  9696*              FIELD  (BPREMI (WS-SUB1))
  9697*              LENGTH (11)
  9698*          END-EXEC
  9699     MOVE 11
  9700       TO DFHEIV11
  9701*    MOVE '@"L                   #   #00009596' TO DFHEIV0
  9702     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9703     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9704     MOVE X'2020233030303039353936' TO DFHEIV0(25:11)
  9705     CALL 'kxdfhei1' USING DFHEIV0,
  9706           BPREMI(WS-SUB1),
  9707           DFHEIV11
  9708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9709           IF BPREMI (WS-SUB1) NUMERIC
  9710              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9711                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9712*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9713*          PERFORM 8600-DEEDIT
  9714*          IF DEEDIT-FIELD-V2  NUMERIC
  9715*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9716*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9717              ELSE
  9718                 IF PI-COMPANY-ID NOT = 'DCC'
  9719                    MOVE ER-7633    TO EMI-ERROR
  9720                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9721                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9722                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9723                 END-IF
  9724              END-IF
  9725           ELSE
  9726              MOVE ER-2223         TO EMI-ERROR
  9727              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9728              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9729              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9730           END-IF
  9731        ELSE
  9732           IF PI-COMPANY-ID NOT = 'DCC'
  9733              MOVE ER-7633         TO EMI-ERROR
  9734              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9735              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9736              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9737           END-IF
  9738        END-IF
  9739     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 183
* EL6311.cbl
  9740
  9741     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9742        NEXT SENTENCE
  9743     ELSE
  9744        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9745
  9746* EXEC CICS BIF DEEDIT
  9747*           FIELD  (BCPREMI (WS-SUB1))
  9748*           LENGTH (11)
  9749*       END-EXEC
  9750     MOVE 11
  9751       TO DFHEIV11
  9752*    MOVE '@"L                   #   #00009636' TO DFHEIV0
  9753     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9754     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9755     MOVE X'2020233030303039363336' TO DFHEIV0(25:11)
  9756     CALL 'kxdfhei1' USING DFHEIV0,
  9757           BCPREMI(WS-SUB1),
  9758           DFHEIV11
  9759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9760        IF BCPREMI (WS-SUB1) NUMERIC
  9761           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9762*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9763*       PERFORM 8600-DEEDIT
  9764*       IF DEEDIT-FIELD-V2  NUMERIC
  9765*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9766        ELSE
  9767           MOVE ER-2223         TO EMI-ERROR
  9768           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9769           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9771
  9772     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9773        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9774        PERFORM 8600-DEEDIT
  9775        IF DEEDIT-FIELD-V0 NUMERIC
  9776           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9777           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9778         ELSE
  9779           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9780           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9781           MOVE ER-2223              TO EMI-ERROR
  9782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9783
  9784     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9785        IF BEXPIRE   (WS-SUB1) = SPACES
  9786           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9787        ELSE
  9788           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9789           PERFORM 8600-DEEDIT
  9790           IF DEEDIT-FIELD-V0        NUMERIC
  9791              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9792              MOVE 4                TO DC-OPTION-CODE
  9793              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9794              PERFORM 9700-DATE-LINK
  9795              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9796                                                        (WS-SUB1)
  9797              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 184
* EL6311.cbl
  9798                 NEXT SENTENCE
  9799              ELSE
  9800                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9801                 MOVE ER-2531    TO EMI-ERROR
  9802                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9803                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804           ELSE
  9805             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9806             MOVE ER-2532        TO EMI-ERROR
  9807             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9809
  9810     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9811        NEXT SENTENCE
  9812     ELSE
  9813
  9814* EXEC CICS BIF DEEDIT
  9815*           FIELD  (BALT-BENI (WS-SUB1))
  9816*           LENGTH (12)
  9817*       END-EXEC
  9818     MOVE 12
  9819       TO DFHEIV11
  9820*    MOVE '@"L                   #   #00009693' TO DFHEIV0
  9821     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9822     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9823     MOVE X'2020233030303039363933' TO DFHEIV0(25:11)
  9824     CALL 'kxdfhei1' USING DFHEIV0,
  9825           BALT-BENI(WS-SUB1),
  9826           DFHEIV11
  9827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9828        IF BALT-BENI (WS-SUB1) NUMERIC
  9829           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9830*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9831*       PERFORM 8600-DEEDIT
  9832*       IF DEEDIT-FIELD-V0 NUMERIC
  9833*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9834        ELSE
  9835           MOVE ER-2223         TO EMI-ERROR
  9836           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9837           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9839
  9840     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9841        NEXT SENTENCE
  9842     ELSE
  9843
  9844* EXEC CICS BIF DEEDIT
  9845*           FIELD  (BALT-PREMI (WS-SUB1))
  9846*           LENGTH (11)
  9847*       END-EXEC
  9848     MOVE 11
  9849       TO DFHEIV11
  9850*    MOVE '@"L                   #   #00009712' TO DFHEIV0
  9851     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9852     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9853     MOVE X'2020233030303039373132' TO DFHEIV0(25:11)
  9854     CALL 'kxdfhei1' USING DFHEIV0,
  9855           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 185
* EL6311.cbl
  9856           DFHEIV11
  9857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9858        IF BALT-PREMI (WS-SUB1) NUMERIC
  9859           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9860*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9861*       PERFORM 8600-DEEDIT
  9862*       IF DEEDIT-FIELD-V0 NUMERIC
  9863*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9864        ELSE
  9865           MOVE ER-2223         TO EMI-ERROR
  9866           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9867           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9869
  9870      GO TO 1020-EDIT-COVERAGES.
  9871
  9872 1025-EDIT-COMPLETE.
  9873     IF PI-COMPANY-ID  =  'DMD'
  9874        MOVE LOW-VALUES             TO BNCERTI
  9875                                       BNSTATI.
  9876
  9877     IF EMI-ERROR = ZEROS
  9878         NEXT SENTENCE
  9879     ELSE
  9880         GO TO 8200-SEND-DATAONLY.
  9881
  9882     IF BMAINTI = 'A'
  9883         GO TO 1200-ADD-ISSUE-ROUTINE.
  9884
  9885     IF BMAINTI = 'C'
  9886         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9887
  9888     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9889
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 186
* EL6311.cbl
  9891
  9892 1030-EDIT-FOR-NUMERICS.
  9893     IF WS-CSO-SUB EQUAL 10
  9894        GO TO 1030-EDIT-EXIT.
  9895
  9896     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9897        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9898        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9899           ADD +1               TO WS-CSO-SUB
  9900           GO TO 1030-EDIT-FOR-NUMERICS.
  9901
  9902     MOVE 'N'                   TO WS-NUMERIC-SW.
  9903
  9904 1030-EDIT-EXIT.
  9905******************************************************************
  9906*                                                                *
  9907*                 C A L C U L A T E   A G E                      *
  9908*                                                                *
  9909******************************************************************
  9910
  9911
  9912 1095-CALC-AGE.
  9913
  9914     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9915     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9916     MOVE 1                  TO DC-OPTION-CODE.
  9917     PERFORM 9700-DATE-LINK
  9918     IF NO-CONVERSION-ERROR
  9919         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9920         MOVE WS-BAGE            TO BAGEI
  9921         MOVE +2                 TO BAGEL
  9922         MOVE AL-UNNON TO BAGEA.
  9923
  9924 1099-EXIT.
  9925     EXIT.
  9926
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 187
* EL6311.cbl
  9928
  9929******************************************************************
  9930*                                                                *
  9931*                   S H O W   I S S U E                          *
  9932*                                                                *
  9933******************************************************************
  9934
  9935 1100-SHOW-REQUEST.
  9936     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9937
  9938     IF BCERTNOL = ZEROS AND
  9939        BEFFDTL  = ZEROS
  9940        MOVE -1                  TO BMAINTL
  9941        GO TO 8200-SEND-DATAONLY.
  9942
  9943     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9944
  9945     IF BSUFIXL NOT = ZEROS
  9946        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9947     ELSE
  9948        MOVE SPACE               TO WS-NEW-SUFFIX.
  9949
  9950     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9951     PERFORM 8600-DEEDIT.
  9952     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9953     MOVE '4'                    TO DC-OPTION-CODE.
  9954     PERFORM 9700-DATE-LINK.
  9955     IF DATE-CONVERSION-ERROR
  9956        MOVE ER-0348             TO EMI-ERROR
  9957        MOVE -1                  TO BEFFDTL
  9958        MOVE AL-UABON            TO BEFFDTA
  9959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9960        GO TO 8200-SEND-DATAONLY
  9961     ELSE
  9962        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  9963        MOVE AL-UANON            TO BEFFDTA
  9964        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  9965
  9966     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9967
  9968     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
  9969        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
  9970          MOVE 'Y'                    TO WS-SHOW-SW
  9971          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9972             GO TO 4100-BROWSE-PRIMARY-FORWARD
  9973           ELSE
  9974             IF PI-FILE-BROWSE
  9975                GO TO 4300-BROWSE-FILE-FORWARD
  9976              ELSE
  9977                IF PI-CSR-BROWSE
  9978                   GO TO 4200-BROWSE-CSR-FORWARD
  9979                ELSE
  9980                   GO TO 4000-BROWSE-DETAIL-FORWARD
  9981        ELSE
  9982           GO TO 3900-RE-DISPLAY-RECORD.
  9983
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 188
* EL6311.cbl
  9985
  9986******************************************************************
  9987*                                                                *
  9988*            A D D   I S S U E   R O U T I N E                   *
  9989*                                                                *
  9990******************************************************************
  9991
  9992***************************************************************
  9993*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
  9994*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  9995*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
  9996*     4. LINK TO THE EDIT ROUTINE.                            *
  9997*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
  9998*     6. WRITE THE NEW ISSUE RECORD.                          *
  9999*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10000*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10001*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10002*        ELSE                                                 *
 10003*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10004***************************************************************
 10005
 10006 1200-ADD-ISSUE-ROUTINE.
 10007     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10008
 10009
 10010* EXEC CICS GETMAIN
 10011*        SET     (ADDRESS OF PENDING-BUSINESS)
 10012*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10013*    END-EXEC.
 10014*    MOVE '," L                  $   #00009867' TO DFHEIV0
 10015     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10016     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10017     MOVE X'2020233030303039383637' TO DFHEIV0(25:11)
 10018     CALL 'kxdfhei1' USING DFHEIV0,
 10019           DFHEIV20,
 10020           ERPNDB-RECORD-LENGTH,
 10021           DFHEIV99
 10022     SET ADDRESS OF PENDING-BUSINESS TO
 10023         DFHEIV20
 10024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10025
 10026
 10027
 10028* EXEC CICS HANDLE CONDITION
 10029*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10030*    END-EXEC.
 10031*    MOVE '"$I                   ! # #00009872' TO DFHEIV0
 10032     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10034     MOVE X'2320233030303039383732' TO DFHEIV0(25:11)
 10035     CALL 'kxdfhei1' USING DFHEIV0
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10037
 10038
 10039     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10040     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10041     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10042
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 189
* EL6311.cbl
 10043
 10044* EXEC CICS READ
 10045*        INTO    (PENDING-BUSINESS)
 10046*        DATASET (FILE-ID-ERPNDB)
 10047*        RIDFLD  (ERPNDB-KEY)
 10048*    END-EXEC.
 10049     MOVE LENGTH OF
 10050      PENDING-BUSINESS
 10051       TO DFHEIV11
 10052*    MOVE '&"IL       E          (   #00009880' TO DFHEIV0
 10053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303039383830' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           FILE-ID-ERPNDB,
 10058           PENDING-BUSINESS,
 10059           DFHEIV11,
 10060           ERPNDB-KEY,
 10061           DFHEIV99,
 10062           DFHEIV99,
 10063           DFHEIV99
 10064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10065
 10066
 10067     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10068
 10069     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10070     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10071     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10072     MOVE SPACES                 TO PENDING-BUSINESS.
 10073     MOVE 'PB'                   TO PB-RECORD-ID.
 10074     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10075     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10076     MOVE SPACES                 TO PB-CERT-SFX.
 10077     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10078     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10079                                    PB-ALT-CHG-SEQ-NO.
 10080
 10081     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10082     MOVE '1'                    TO PB-RECORD-TYPE.
 10083
 10084     IF BSUFIXL NOT = ZEROS
 10085        MOVE BSUFIXI             TO PB-CERT-SFX.
 10086
 10087     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10088
 10089     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10090     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10091
 10092     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10093                                    PB-I-LF-PREM-CALC
 10094                                    PB-I-LF-ALT-PREM-CALC
 10095                                    PB-I-LF-RATE
 10096                                    PB-I-LF-ALT-RATE
 10097                                    PB-I-LF-REI-RATE
 10098                                    PB-I-LF-ALT-REI-RATE
 10099                                    PB-I-RATE-DEV-PCT-LF
 10100                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 190
* EL6311.cbl
 10101                                    PB-I-AH-RATE
 10102                                    PB-I-AH-REI-RATE
 10103                                    PB-I-AH-RATE-TRM
 10104                                    PB-I-RATE-DEV-PCT-AH
 10105                                    PB-I-BUSINESS-TYPE
 10106                                    PB-I-LIFE-COMMISSION
 10107                                    PB-I-JOINT-COMMISSION
 10108                                    PB-I-JOINT-AGE
 10109                                    PB-I-AH-COMMISSION
 10110                                    PB-I-CURR-SEQ
 10111                                    PB-CHG-COUNT
 10112                                    PB-LF-BILLED-AMTS
 10113                                    PB-AH-BILLED-AMTS
 10114                                    PB-CALC-TOLERANCE
 10115                                    PB-I-EXTENTION-DAYS
 10116*                                   PB-I-MICROFILM-NO
 10117                                    PB-I-TERM-IN-DAYS.
 10118
 10119     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10120                                    PB-I-LF-EXPIRE-DT
 10121                                    PB-I-AH-EXPIRE-DT
 10122                                    PB-BILLED-DT
 10123                                    PB-ACCT-EFF-DT
 10124                                    PB-ACCT-EXP-DT
 10125                                    PB-I-1ST-PMT-DT.
 10126
 10127     MOVE 'X'                    TO PB-FATAL-FLAG.
 10128
 10129     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10130
 10131     IF BLSTNML GREATER THAN ZEROS
 10132         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10133
 10134*    IF BMICRNOL  GREATER  ZEROS
 10135*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10136*    ELSE
 10137*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10138     IF BVINL > ZEROS
 10139        MOVE BVINI               TO PB-I-VIN
 10140     END-IF
 10141     IF B1STNML GREATER THAN ZEROS
 10142         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10143
 10144     IF BINITL  GREATER THAN ZEROS
 10145         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10146
 10147     IF BBIRTHL GREATER THAN ZERO
 10148         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10149     ELSE
 10150         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10151
 10152     IF B1STPMTL GREATER THAN ZERO
 10153         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10154     ELSE
 10155         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10156
 10157     IF BAGEL    GREATER THAN ZEROS
 10158         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 191
* EL6311.cbl
 10159        ELSE
 10160         MOVE ZEROS              TO PB-I-AGE.
 10161
 10162     IF BSEXL    GREATER THAN ZEROS
 10163         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10164
 10165     IF BTERM-LEN (1) GREATER THAN ZEROS
 10166        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10167     ELSE
 10168        MOVE ZEROS               TO PB-I-LF-TERM.
 10169
 10170     IF BTERM-LEN (2) GREATER THAN ZEROS
 10171        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10172     ELSE
 10173        MOVE ZEROS               TO PB-I-AH-TERM.
 10174
 10175     IF BLNTRML       GREATER THAN ZEROS
 10176         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10177        ELSE
 10178         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10179
 10180     IF BFREQL        GREATER THAN ZEROS
 10181         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10182        ELSE
 10183         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10184
 10185     IF BSKPCDL       GREATER THAN ZEROS
 10186         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10187
 10188     IF BMODEL        GREATER THAN ZEROS
 10189         MOVE BMODEI             TO PB-I-TERM-TYPE
 10190                                    PI-BMODE.
 10191
 10192     IF BPMTSL        GREATER THAN ZEROS
 10193         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10194                                    PI-BPMTS
 10195        ELSE
 10196         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10197                                    PI-BPMTS.
 10198
 10199     IF BPMTAMTL      GREATER THAN ZEROS
 10200         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10201        ELSE
 10202         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10203
 10204     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10205        IF BTYPE  (1)   NOT = ZEROS
 10206           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10207                                    PI-BTYPE (1)
 10208           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10209           MOVE SPACES           TO PB-I-LF-ABBR
 10210        ELSE
 10211           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10212                                    PB-I-LF-ABBR
 10213           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10214     ELSE
 10215        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10216                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 192
* EL6311.cbl
 10217        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10218
 10219     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10220         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10221     ELSE
 10222         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10223
 10224     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10225         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10226     ELSE
 10227         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10228
 10229     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10230         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10231            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10232            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10233         ELSE
 10234            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10235            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10236     ELSE
 10237         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10238
 10239     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10240         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10241
 10242     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10243         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10244         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10245     ELSE
 10246         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10247
 10248     IF  BALT-PREM-LEN     (2) > ZEROS
 10249         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10250     ELSE
 10251         MOVE ZEROS            TO PB-I-TOT-FEES.
 10252
 10253     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10254        IF BTYPE      (2)   NOT = ZEROS
 10255           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10256                                  PI-BTYPE (2)
 10257           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10258           MOVE SPACES         TO PB-I-AH-ABBR
 10259        ELSE
 10260           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10261                                  PB-I-AH-ABBR
 10262           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10263     ELSE
 10264        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10265                                  PB-I-AH-ABBR
 10266        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10267
 10268     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10269         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10270     ELSE
 10271         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10272
 10273     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10274         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 193
* EL6311.cbl
 10275            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10276            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10277         ELSE
 10278            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10279            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10280     ELSE
 10281         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10282
 10283     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10284         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10285
 10286     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10287        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10288     ELSE
 10289        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10290
 10291     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10292        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10293     ELSE
 10294        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10295
 10296     IF BINDGRPL  GREATER THAN ZEROS
 10297         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10298
 10299     IF BRTCLSL   GREATER THAN ZEROS
 10300         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10301
 10302     IF BSIGL     GREATER THAN ZEROS
 10303         MOVE BSIGI              TO PB-I-SIG-SW.
 10304
 10305     IF BAPRL     GREATER THAN ZEROS
 10306         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10307     ELSE
 10308         MOVE ZEROS              TO PB-I-LOAN-APR.
 10309
 10310     IF BMEMBERL  GREATER THAN ZEROS
 10311         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10312
 10313     IF BLNOFCRL  GREATER THAN ZEROS
 10314         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10315
 10316     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10317        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10318     ELSE
 10319        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10320
 10321     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10322        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10323     ELSE
 10324        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10325
 10326     IF BDAYSL   GREATER THAN ZEROS
 10327        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10328                                    PB-I-EXTENTION-DAYS
 10329     ELSE
 10330        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10331                                    PB-I-EXTENTION-DAYS.
 10332
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 194
* EL6311.cbl
 10333     IF BDAYSL GREATER THAN ZEROS
 10334        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10335
 10336     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10337        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10338           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10339
 10340     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10341        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10342           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10343
 10344     IF B1STPMTL GREATER THAN ZEROS
 10345        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10346
 10347     IF PB-EXT-DAYS-PROCESSING
 10348        IF PB-I-EXTENTION-DAYS = ZEROS
 10349           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10350
 10351     IF PB-EXPIRE-DT-PROCESSING
 10352        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10353           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10354             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10355
 10356     IF PB-1ST-PMT-DT-PROCESSING
 10357        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10358           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10359
 10360     IF BREINL GREATER THAN ZEROS
 10361        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10362
 10363     IF BENTRYL NOT = ZEROS
 10364        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10365        IF PI-COMPANY-ID = 'CID'
 10366           AND (PB-BATCH-ENTRY = 'P')
 10367           AND (PB-STATE = 'VA')
 10368           PERFORM 1500-UPDATE-ERNOTE
 10369                                 THRU 1500-EXIT
 10370        END-IF
 10371     END-IF
 10372     IF BUNWRITL NOT = ZEROS
 10373        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10374
 10375     IF BFORCEL NOT = ZEROS
 10376        MOVE BFORCEI             TO PB-FORCE-CODE.
 10377
 10378     IF BBILCDL NOT = ZEROS
 10379        MOVE BBILCDI             TO PB-RECORD-BILL.
 10380
 10381     IF BLIVESL GREATER THAN ZEROS
 10382        MOVE WS-BLIVES           TO PB-I-LIVES
 10383     ELSE
 10384        MOVE ZEROS               TO PB-I-LIVES.
 10385
 10386     IF BBILLEDL GREATER THAN ZEROS
 10387        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10388     ELSE
 10389        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10390
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 195
* EL6311.cbl
 10391*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10392
 10393 1260-WRITE-PB-RECORD.
 10394     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10395                                    PB-INPUT-BY.
 10396     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10397     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10398                                    PB-INPUT-DT.
 10399
 10400     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10401     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10402                                    PB-CONTROL-BY-ORIG-BATCH.
 10403
 10404
 10405     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10406     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10407     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10408     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10409     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10410
 10411     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10412
 10413     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10414
 10415     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10416     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10417     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10418
 10419     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10420     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10421
 10422 1275-WRITE-PENDING-BUSINESS.
 10423     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10424     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10425     MOVE 'A'                    TO JP-RECORD-TYPE.
 10426     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10427
 10428
 10429* EXEC CICS HANDLE CONDITION
 10430*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10431*    END-EXEC.
 10432*    MOVE '"$%                   ! $ #00010247' TO DFHEIV0
 10433     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10435     MOVE X'2420233030303130323437' TO DFHEIV0(25:11)
 10436     CALL 'kxdfhei1' USING DFHEIV0
 10437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10438
 10439
 10440
 10441* EXEC CICS WRITE
 10442*        DATASET (FILE-ID-ERPNDB)
 10443*        FROM    (PENDING-BUSINESS)
 10444*        RIDFLD  (PB-CONTROL-PRIMARY)
 10445*    END-EXEC.
 10446     MOVE LENGTH OF
 10447      PENDING-BUSINESS
 10448       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 196
* EL6311.cbl
 10449*    MOVE '&$ L                  ''   #00010251' TO DFHEIV0
 10450     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10451     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10452     MOVE X'2020233030303130323531' TO DFHEIV0(25:11)
 10453     CALL 'kxdfhei1' USING DFHEIV0,
 10454           FILE-ID-ERPNDB,
 10455           PENDING-BUSINESS,
 10456           DFHEIV11,
 10457           PB-CONTROL-PRIMARY,
 10458           DFHEIV99,
 10459           DFHEIV99
 10460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10461
 10462
 10463     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10464
 10465     PERFORM 8400-LOG-JOURNAL-RECORD.
 10466
 10467******************************************************************
 10468*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10469******************************************************************
 10470     display ' made it to add orig cert '
 10471     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10472     MOVE ' '                    TO WS-ERMAIL-SW
 10473
 10474* EXEC CICS READ
 10475*       DATASET   (FILE-ID-ERMAIL)
 10476*       SET       (ADDRESS OF MAILING-DATA)
 10477*       RIDFLD    (ERMAIL-KEY)
 10478*       RESP      (WS-RESPONSE)
 10479*    END-EXEC
 10480*    MOVE '&"S        E          (  N#00010267' TO DFHEIV0
 10481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10483     MOVE X'204E233030303130323637' TO DFHEIV0(25:11)
 10484     CALL 'kxdfhei1' USING DFHEIV0,
 10485           FILE-ID-ERMAIL,
 10486           DFHEIV20,
 10487           DFHEIV99,
 10488           ERMAIL-KEY,
 10489           DFHEIV99,
 10490           DFHEIV99,
 10491           DFHEIV99
 10492     SET ADDRESS OF MAILING-DATA TO
 10493         DFHEIV20
 10494     MOVE EIBRESP  TO WS-RESPONSE
 10495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10496     IF RESP-NORMAL
 10497        SET ERMAIL-FOUND TO TRUE
 10498     END-IF
 10499
 10500     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10501     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10502     MOVE 'OC'                   TO OC-RECORD-ID
 10503     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10504                                 TO OC-CONTROL-PRIMARY (1:33)
 10505     MOVE 'I'                    TO OC-RECORD-TYPE
 10506     MOVE +4096                  TO OC-KEY-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 197
* EL6311.cbl
 10507     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10508     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10509     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10510     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10511     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10512     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10513     MOVE PB-I-AGE               TO OC-INS-AGE
 10514     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10515     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10516     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10517     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10518     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10519     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10520     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10521     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10522     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10523     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10524     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10525     IF PB-I-JOINT-COMMISSION > +0
 10526         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10527     ELSE
 10528         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10529     END-IF
 10530     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10531     MOVE +0                     TO OC-LF-CANCEL-AMT
 10532                                    OC-LF-ITD-CANCEL-AMT
 10533     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10534     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10535     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10536     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10537     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10538     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10539     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10540     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10541     MOVE +0                     TO OC-AH-CANCEL-AMT
 10542                                    OC-AH-ITD-CANCEL-AMT
 10543     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10544     IF ERMAIL-FOUND
 10545        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10546     END-IF
 10547     IF NOT CERT-TRL-REC-NOT-FOUND
 10548        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10549                           OC-INS-AGE-DEFAULT-FLAG
 10550        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10551                           OC-JNT-AGE-DEFAULT-FLAG
 10552     END-IF
 10553     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10554     .
 10555 1275-WRITE-ELCRTO.
 10556
 10557* EXEC CICS WRITE
 10558*       DATASET   ('ELCRTO')
 10559*       FROM      (ORIGINAL-CERTIFICATE)
 10560*       RIDFLD    (OC-CONTROL-PRIMARY)
 10561*       RESP      (WS-RESPONSE)
 10562*    END-EXEC
 10563     MOVE LENGTH OF
 10564      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 198
* EL6311.cbl
 10565       TO DFHEIV11
 10566     MOVE 'ELCRTO' TO DFHEIV1
 10567*    MOVE '&$ L                  ''  N#00010333' TO DFHEIV0
 10568     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10569     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10570     MOVE X'204E233030303130333333' TO DFHEIV0(25:11)
 10571     CALL 'kxdfhei1' USING DFHEIV0,
 10572           DFHEIV1,
 10573           ORIGINAL-CERTIFICATE,
 10574           DFHEIV11,
 10575           OC-CONTROL-PRIMARY,
 10576           DFHEIV99,
 10577           DFHEIV99
 10578     MOVE EIBRESP  TO WS-RESPONSE
 10579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10580     display ' just wrote 1275 ' ws-response
 10581     IF RESP-DUPKEY
 10582        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10583        GO TO 1275-WRITE-ELCRTO
 10584     ELSE
 10585        IF NOT RESP-NORMAL
 10586           MOVE -1               TO BMAINTL
 10587           MOVE ER-7450          TO EMI-ERROR
 10588           PERFORM 9900-ERROR-FORMAT
 10589                                 THRU 9900-EXIT
 10590           GO TO 8200-SEND-DATAONLY
 10591        END-IF
 10592     END-IF
 10593******************************************************************
 10594*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10595******************************************************************
 10596
 10597
 10598* EXEC CICS READ
 10599*        INTO    (PENDING-BUSINESS)
 10600*        DATASET (FILE-ID-ERPNDB)
 10601*        RIDFLD  (ERPNDB-KEY)
 10602*        UPDATE
 10603*    END-EXEC.
 10604     MOVE LENGTH OF
 10605      PENDING-BUSINESS
 10606       TO DFHEIV11
 10607*    MOVE '&"IL       EU         (   #00010356' TO DFHEIV0
 10608     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10610     MOVE X'2020233030303130333536' TO DFHEIV0(25:11)
 10611     CALL 'kxdfhei1' USING DFHEIV0,
 10612           FILE-ID-ERPNDB,
 10613           PENDING-BUSINESS,
 10614           DFHEIV11,
 10615           ERPNDB-KEY,
 10616           DFHEIV99,
 10617           DFHEIV99,
 10618           DFHEIV99
 10619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10620
 10621
 10622     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 199
* EL6311.cbl
 10623     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10624     MOVE 'B'                    TO JP-RECORD-TYPE.
 10625     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10626
 10627     PERFORM 8400-LOG-JOURNAL-RECORD.
 10628
 10629     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10630
 10631
 10632* EXEC CICS REWRITE
 10633*        DATASET (FILE-ID-ERPNDB)
 10634*        FROM    (PENDING-BUSINESS)
 10635*    END-EXEC.
 10636     MOVE LENGTH OF
 10637      PENDING-BUSINESS
 10638       TO DFHEIV11
 10639*    MOVE '&& L                  %   #00010372' TO DFHEIV0
 10640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10642     MOVE X'2020233030303130333732' TO DFHEIV0(25:11)
 10643     CALL 'kxdfhei1' USING DFHEIV0,
 10644           FILE-ID-ERPNDB,
 10645           PENDING-BUSINESS,
 10646           DFHEIV11,
 10647           DFHEIV99
 10648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10649
 10650
 10651     MOVE 'C'                    TO JP-RECORD-TYPE.
 10652     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10653
 10654     PERFORM 8400-LOG-JOURNAL-RECORD.
 10655
 10656     IF WS-ERRORS-PRESENT
 10657         GO TO 3900-RE-DISPLAY-RECORD.
 10658
 10659     MOVE ZEROS                  TO EMI-ERROR.
 10660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10661     MOVE LOW-VALUES             TO EL631BI.
 10662     MOVE  -1                    TO BMAINTL.
 10663     GO TO 8100-SEND-INITIAL-MAP.
 10664
 10665 1280-BATCH-HDR-NOT-FOUND.
 10666     MOVE -1                     TO BMAINTL.
 10667     MOVE ER-7450                TO EMI-ERROR.
 10668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10669     GO TO 8200-SEND-DATAONLY.
 10670
 10671 1290-DUPLICATE-ALT-INDEX.
 10672
 10673******************************************************************
 10674*                                                                *
 10675*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10676*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10677*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10678*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10679*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10680*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 200
* EL6311.cbl
 10681*                                                                *
 10682******************************************************************
 10683
 10684     IF LCP-ONCTR-01 =  0
 10685         ADD 1 TO LCP-ONCTR-01
 10686        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10687
 10688     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10689
 10690     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10691         NEXT SENTENCE
 10692     ELSE
 10693         ADD +1 TO PB-BATCH-SEQ-NO
 10694                   PB-CSR-BATCH-SEQ-NO
 10695         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10696         GO TO 1275-WRITE-PENDING-BUSINESS.
 10697
 10698     MOVE -1                     TO BCERTNOL.
 10699     MOVE AL-UABON               TO BCERTNOA.
 10700     MOVE AL-UNBON               TO BEFFDTA.
 10701
 10702     MOVE 1                      TO EMI-SUB
 10703                                    EMI-SWITCH1
 10704                                    EMI-SWITCH-AREA-1
 10705                                    EMI-SWITCH-AREA-2.
 10706
 10707     MOVE SPACES                 TO EMI-ERROR-LINES.
 10708
 10709
 10710* EXEC CICS SYNCPOINT ROLLBACK
 10711*    END-EXEC.
 10712*    MOVE '6"R                   !   #00010435' TO DFHEIV0
 10713     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10715     MOVE X'2020233030303130343335' TO DFHEIV0(25:11)
 10716     CALL 'kxdfhei1' USING DFHEIV0
 10717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10718
 10719
 10720     MOVE ER-2247                TO EMI-ERROR.
 10721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10722     GO TO 8200-SEND-DATAONLY.
 10723
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 201
* EL6311.cbl
 10725
 10726
 10727 1295-READ-CERT-TRAILER.
 10728
 10729
 10730* EXEC CICS GETMAIN
 10731*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10732*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10733*        INITIMG (GETMAIN-SPACE)
 10734*    END-EXEC
 10735*    MOVE ',"IL                  $   #00010447' TO DFHEIV0
 10736     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10738     MOVE X'2020233030303130343437' TO DFHEIV0(25:11)
 10739     CALL 'kxdfhei1' USING DFHEIV0,
 10740           DFHEIV20,
 10741           ELCRTT-RECORD-LENGTH,
 10742           GETMAIN-SPACE
 10743     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10744         DFHEIV20
 10745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10746
 10747     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10748     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10749     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10750
 10751
 10752* EXEC CICS HANDLE CONDITION
 10753*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10754*    END-EXEC.
 10755*    MOVE '"$I                   ! % #00010457' TO DFHEIV0
 10756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10758     MOVE X'2520233030303130343537' TO DFHEIV0(25:11)
 10759     CALL 'kxdfhei1' USING DFHEIV0
 10760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10761
 10762
 10763
 10764* EXEC CICS READ
 10765*        DATASET  (CRTT-ID)
 10766*        RIDFLD   (ELCRTT-KEY)
 10767*        INTO     (CERTIFICATE-TRAILERS)
 10768*    END-EXEC.
 10769     MOVE LENGTH OF
 10770      CERTIFICATE-TRAILERS
 10771       TO DFHEIV11
 10772*    MOVE '&"IL       E          (   #00010461' TO DFHEIV0
 10773     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10775     MOVE X'2020233030303130343631' TO DFHEIV0(25:11)
 10776     CALL 'kxdfhei1' USING DFHEIV0,
 10777           CRTT-ID,
 10778           CERTIFICATE-TRAILERS,
 10779           DFHEIV11,
 10780           ELCRTT-KEY,
 10781           DFHEIV99,
 10782           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 202
* EL6311.cbl
 10783           DFHEIV99
 10784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10785
 10786
 10787     GO TO 1295-EXIT.
 10788
 10789 1295-CERT-TRL-REC-NOTFND.
 10790     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10791
 10792 1295-EXIT.
 10793     EXIT.
 10794
 10795******************************************************************
 10796*                                                                *
 10797*          C H A N G E   I S S U E   R O U T I N E               *
 10798*                                                                *
 10799******************************************************************
 10800
 10801***************************************************************
 10802*                                                             *
 10803*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10804*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10805*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10806*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10807*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10808*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10809*     5. LINK TO THE EDIT ROUTINE.                            *
 10810*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10811*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10812*              THE EDIT ROUTINE.                              *
 10813*     7. REWRITE THE NEW ISSUE                                *
 10814*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10815*                                                             *
 10816***************************************************************
 10817
 10818 1300-CHANGE-ISSUE-ROUTINE.
 10819     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10820
 10821     IF BCHGL NOT = ZEROS
 10822        MOVE ER-2196             TO EMI-ERROR
 10823        MOVE AL-UABON            TO BMAINTA
 10824        MOVE -1                  TO BMAINTL
 10825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10826        GO TO 8200-SEND-DATAONLY.
 10827
 10828     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10829
 10830     IF BSUFIXL NOT = ZEROS
 10831        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10832     ELSE
 10833        MOVE SPACE               TO WS-NEW-SUFFIX.
 10834
 10835     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10836     PERFORM 8600-DEEDIT.
 10837     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10838     MOVE '4'                    TO DC-OPTION-CODE.
 10839     PERFORM 9700-DATE-LINK.
 10840     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 203
* EL6311.cbl
 10841        MOVE ER-0348             TO EMI-ERROR
 10842        MOVE -1                  TO BEFFDTL
 10843        MOVE AL-UABON            TO BEFFDTA
 10844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10845        GO TO 8200-SEND-DATAONLY
 10846     ELSE
 10847        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10848        MOVE AL-UANON            TO BEFFDTA
 10849        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10850
 10851 1325-PROCESS-ISSUE-CHANGES.
 10852
 10853* EXEC CICS HANDLE CONDITION
 10854*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10855*    END-EXEC.
 10856*    MOVE '"$I                   ! & #00010532' TO DFHEIV0
 10857     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10859     MOVE X'2620233030303130353332' TO DFHEIV0(25:11)
 10860     CALL 'kxdfhei1' USING DFHEIV0
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
 10864     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10865     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10866     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10867
 10868
 10869* EXEC CICS GETMAIN
 10870*        SET      (ADDRESS OF PENDING-BUSINESS)
 10871*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10872*        INITIMG  (GETMAIN-SPACE)
 10873*     END-EXEC.
 10874*    MOVE ',"IL                  $   #00010540' TO DFHEIV0
 10875     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10876     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10877     MOVE X'2020233030303130353430' TO DFHEIV0(25:11)
 10878     CALL 'kxdfhei1' USING DFHEIV0,
 10879           DFHEIV20,
 10880           ERPNDB-RECORD-LENGTH,
 10881           GETMAIN-SPACE
 10882     SET ADDRESS OF PENDING-BUSINESS TO
 10883         DFHEIV20
 10884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10885
 10886
 10887
 10888* EXEC CICS READ
 10889*        INTO    (PENDING-BUSINESS)
 10890*        DATASET (FILE-ID-ERPNDB)
 10891*        RIDFLD  (ERPNDB-KEY)
 10892*    END-EXEC.
 10893     MOVE LENGTH OF
 10894      PENDING-BUSINESS
 10895       TO DFHEIV11
 10896*    MOVE '&"IL       E          (   #00010546' TO DFHEIV0
 10897     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 204
* EL6311.cbl
 10899     MOVE X'2020233030303130353436' TO DFHEIV0(25:11)
 10900     CALL 'kxdfhei1' USING DFHEIV0,
 10901           FILE-ID-ERPNDB,
 10902           PENDING-BUSINESS,
 10903           DFHEIV11,
 10904           ERPNDB-KEY,
 10905           DFHEIV99,
 10906           DFHEIV99,
 10907           DFHEIV99
 10908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10909
 10910
 10911     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10912
 10913
 10914* EXEC CICS HANDLE CONDITION
 10915*         NOTFND     (1385-REC-NOT-FOUND)
 10916*    END-EXEC.
 10917*    MOVE '"$I                   ! '' #00010554' TO DFHEIV0
 10918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10920     MOVE X'2720233030303130353534' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0
 10922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10923
 10924
 10925**********************************************************
 10926*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10927*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10928**********************************************************
 10929
 10930
 10931* EXEC CICS READ
 10932*        DATASET (FILE-ID-ERPNDB)
 10933*        INTO    (PENDING-BUSINESS)
 10934*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10935*    END-EXEC.
 10936     MOVE LENGTH OF
 10937      PENDING-BUSINESS
 10938       TO DFHEIV11
 10939*    MOVE '&"IL       E          (   #00010563' TO DFHEIV0
 10940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10942     MOVE X'2020233030303130353633' TO DFHEIV0(25:11)
 10943     CALL 'kxdfhei1' USING DFHEIV0,
 10944           FILE-ID-ERPNDB,
 10945           PENDING-BUSINESS,
 10946           DFHEIV11,
 10947           PI-PREV-CONTROL-PRIMARY,
 10948           DFHEIV99,
 10949           DFHEIV99,
 10950           DFHEIV99
 10951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10952
 10953
 10954********** DO NOT ALLOW CHANGES IF THRU A/R
 10955     IF BMAINTI = 'C'
 10956         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 205
* EL6311.cbl
 10957             MOVE ER-4005          TO EMI-ERROR
 10958             MOVE -1               TO BMAINTL
 10959             MOVE AL-UABON         TO BMAINTA
 10960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10961             GO TO 8200-SEND-DATAONLY.
 10962**********
 10963
 10964     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10965        MOVE -1                 TO BMAINTL
 10966        MOVE ER-2197            TO EMI-ERROR
 10967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10968        GO TO 8200-SEND-DATAONLY.
 10969
 10970     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 10971        MOVE ER-2196             TO EMI-ERROR
 10972        MOVE AL-UABON            TO BMAINTA
 10973        MOVE -1                  TO BMAINTL
 10974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10975        GO TO 8200-SEND-DATAONLY.
 10976
 10977     MOVE ZEROS                  TO WS-SEQ-SAVE.
 10978
 10979     IF PB-BILLED-DT = LOW-VALUES AND
 10980        PB-CHG-COUNT = ZEROS
 10981        NEXT SENTENCE
 10982     ELSE
 10983        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10984            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 10985           OR
 10986           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10987            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10988           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 10989
 10990
 10991* EXEC CICS READ
 10992*        DATASET (FILE-ID-ERPNDB)
 10993*        INTO    (PENDING-BUSINESS)
 10994*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10995*        UPDATE
 10996*    END-EXEC.
 10997     MOVE LENGTH OF
 10998      PENDING-BUSINESS
 10999       TO DFHEIV11
 11000*    MOVE '&"IL       EU         (   #00010605' TO DFHEIV0
 11001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11002     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11003     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 11004     CALL 'kxdfhei1' USING DFHEIV0,
 11005           FILE-ID-ERPNDB,
 11006           PENDING-BUSINESS,
 11007           DFHEIV11,
 11008           PI-PREV-CONTROL-PRIMARY,
 11009           DFHEIV99,
 11010           DFHEIV99,
 11011           DFHEIV99
 11012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11013
 11014
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 206
* EL6311.cbl
 11015     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11016     MOVE 'B'                    TO JP-RECORD-TYPE
 11017     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11018     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11019
 11020     PERFORM 8400-LOG-JOURNAL-RECORD.
 11021
 11022     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11023        PB-CHG-COUNT NOT = ZEROS
 11024        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11025            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11026           OR
 11027           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11028            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11029            MOVE LOW-VALUES             TO PB-BILLED-DT
 11030            ADD +1                      TO PB-CHG-COUNT.
 11031
 11032     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11033     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11034     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11035     MOVE '5'                    TO DC-OPTION-CODE.
 11036     PERFORM 9700-DATE-LINK
 11037     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11038
 11039*    IF BMICRNOL  GREATER  ZEROS
 11040*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11041
 11042     IF BVINL > ZEROS
 11043        MOVE BVINI               TO PB-I-VIN
 11044     END-IF
 11045     IF (BFORCEL NOT = ZEROS)
 11046        AND (PB-COMPANY-ID = 'DCC')
 11047        AND (BFORCEI = ' ')
 11048        AND (PB-FORCE-CODE = 'O')
 11049        COMPUTE PB-I-AH-PREMIUM-AMT =
 11050           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11051        PERFORM 1800-REMOVE-CERT-NOTES
 11052                                 THRU 1800-EXIT
 11053        PERFORM 1900-DELETE-ERPYAJ
 11054                                 THRU 1900-EXIT
 11055        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11056     END-IF
 11057     IF (BFORCEL NOT = ZEROS)
 11058        AND (PB-COMPANY-ID = 'DCC')
 11059        AND (BFORCEI = 'O')
 11060        AND (PB-FORCE-CODE NOT = 'O')
 11061        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11062           PB-I-AH-PREM-CALC
 11063        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11064        MOVE SPACE               TO DC-OPTION-CODE
 11065        PERFORM 9700-DATE-LINK
 11066        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11067        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11068        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11069        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11070        PERFORM 1500-UPDATE-ERNOTE
 11071                                 THRU 1500-EXIT
 11072        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 207
* EL6311.cbl
 11073                                 THRU 1600-EXIT
 11074     END-IF
 11075     IF BLSTNML  GREATER THAN ZEROS
 11076         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11077
 11078     IF B1STNML  GREATER THAN ZEROS
 11079         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11080
 11081     IF BINITL   GREATER THAN ZEROS
 11082         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11083
 11084     IF BBIRTHL  GREATER THAN ZERO
 11085         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11086
 11087     IF B1STPMTL GREATER THAN ZERO
 11088         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11089
 11090     IF BAGEL    GREATER THAN ZEROS
 11091         MOVE BAGEI              TO PB-I-AGE.
 11092
 11093     MOVE 'N'                    TO WS-INS-AGE-SET
 11094                                    WS-JNT-AGE-SET.
 11095     IF BAGEL    GREATER THAN ZEROS
 11096        MOVE 'Y'                TO WS-INS-AGE-SET
 11097        IF BAGEI = ZERO AND
 11098             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11099           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11100           MOVE 'AGE*'          TO BAGEDEFO
 11101        ELSE
 11102           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11103           MOVE 'AGE '          TO BAGEDEFO
 11104        END-IF
 11105        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11106     END-IF.
 11107
 11108     IF BSEXL    GREATER THAN ZEROS
 11109         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11110
 11111     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11112        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11113
 11114     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11115        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11116
 11117     IF BLNTRML  GREATER THAN ZEROS
 11118         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11119
 11120     IF BFREQL   GREATER THAN ZEROS
 11121         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11122
 11123     IF BSKPCDL  GREATER THAN ZEROS
 11124         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11125
 11126     IF BMODEL   GREATER THAN ZEROS
 11127         MOVE BMODEI             TO PB-I-TERM-TYPE
 11128                                    PI-BMODE.
 11129
 11130     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 208
* EL6311.cbl
 11131         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11132                                    PI-BPMTS.
 11133
 11134     IF BPMTAMTL GREATER THAN ZEROS
 11135         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11136
 11137     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11138         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11139
 11140     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11141         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11142
 11143     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11144
 11145     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11146         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11147            SUBTRACT PB-I-LF-PREMIUM-AMT
 11148                     FROM WS-B-LF-ISS-PRM-ENTERED
 11149            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11150            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11151            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11152         ELSE
 11153            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11154            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11155
 11156     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11157            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11158                     FROM WS-B-LF-ISS-PRM-ENTERED
 11159         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11160         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11161
 11162     IF  BALT-PREM-LEN     (2)  > ZEROS
 11163         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11164
 11165     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11166         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11167
 11168     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11169         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11170            SUBTRACT PB-I-AH-PREMIUM-AMT
 11171                     FROM WS-B-AH-ISS-PRM-ENTERED
 11172            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11173            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11174            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11175         ELSE
 11176            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11177            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11178
 11179     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11180        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11181
 11182     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11183        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11184
 11185     IF BINDGRPL            GREATER THAN ZEROS
 11186         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11187
 11188     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 209
* EL6311.cbl
 11189         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11190
 11191     IF BSIGL               GREATER THAN ZEROS
 11192         MOVE BSIGI              TO PB-I-SIG-SW.
 11193
 11194     IF BAPRL               GREATER THAN ZEROS
 11195         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11196
 11197     IF BMEMBERL            GREATER THAN ZEROS
 11198         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11199
 11200     IF BLNOFCRL            GREATER THAN ZEROS
 11201         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11202
 11203     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11204        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11205
 11206     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11207        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11208
 11209     IF BDAYSL              GREATER THAN ZEROS
 11210        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11211                                    PB-I-EXTENTION-DAYS.
 11212
 11213     IF BDAYSL GREATER THAN ZEROS
 11214        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11215
 11216     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11217        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11218           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11219
 11220     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11221        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11222           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11223
 11224     IF B1STPMTL GREATER THAN ZEROS
 11225        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11226
 11227     IF PB-EXT-DAYS-PROCESSING
 11228        IF PB-I-EXTENTION-DAYS = ZEROS
 11229           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11230
 11231     IF PB-EXPIRE-DT-PROCESSING
 11232        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11233           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11234             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11235
 11236     IF PB-1ST-PMT-DT-PROCESSING
 11237        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11238           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11239
 11240     IF BREINL GREATER THAN ZEROS
 11241        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11242
 11243     IF BFORCEL NOT = ZEROS
 11244        MOVE BFORCEI             TO PB-FORCE-CODE.
 11245     IF (BENTRYL NOT = ZEROS)
 11246        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 210
* EL6311.cbl
 11247        AND (PB-STATE = 'VA')
 11248        AND (BENTRYI NOT = 'P')
 11249        AND (PB-BATCH-ENTRY = 'P')
 11250        PERFORM 1800-REMOVE-CERT-NOTES
 11251                                 THRU 1800-EXIT
 11252     END-IF
 11253     IF BENTRYL NOT = ZEROS
 11254        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11255        IF PI-COMPANY-ID = 'CID'
 11256           AND (PB-BATCH-ENTRY = 'P')
 11257           AND (PB-STATE = 'VA')
 11258           PERFORM 1500-UPDATE-ERNOTE
 11259                                 THRU 1500-EXIT
 11260        END-IF
 11261     END-IF
 11262
 11263     IF BUNWRITL NOT = ZEROS
 11264        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11265
 11266     IF BBILCDL NOT = ZEROS
 11267        MOVE BBILCDI             TO PB-RECORD-BILL.
 11268
 11269     IF BLIVESL GREATER THAN ZEROS
 11270        MOVE WS-BLIVES           TO PB-I-LIVES.
 11271
 11272
 11273*DMD CUSTOM CODING*************START
 11274     IF PI-COMPANY-ID NOT = 'DMD'
 11275         MOVE ZEROS               TO BBILLEDL.
 11276*DMD CUSTOM CODING*************END
 11277
 11278     IF BBILLEDL GREATER THAN ZEROS
 11279        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11280
 11281
 11282*****************************************************************
 11283*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11284*****************************************************************
 11285
 11286     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11287        IF BTYPE  (1)   = ZEROS OR SPACES
 11288           IF REMOVE-LF-COVERAGE
 11289               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11290                                        PI-BTYPE (1)
 11291               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11292                                        WS-B-LF-ISS-PRM-ENTERED
 11293               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11294                                        WS-B-LF-ISS-PRM-ENTERED
 11295               SUBTRACT PB-I-LF-PREM-CALC FROM
 11296                                        WS-B-LF-ISS-PRM-COMPUTED
 11297               MOVE ZEROS            TO PB-I-LF-TERM
 11298                                        PB-I-LF-BENEFIT-AMT
 11299                                        PB-I-LF-PREMIUM-AMT
 11300                                        PB-I-LF-BENEFIT-CD
 11301                                        PB-I-LF-PREM-CALC
 11302                                        PB-I-LF-CRIT-PER
 11303                                        PB-I-LF-ALT-BENEFIT-AMT
 11304                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 211
* EL6311.cbl
 11305               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11306           ELSE
 11307               NEXT SENTENCE
 11308        ELSE
 11309           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11310                                    PI-BTYPE (1).
 11311     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11312        IF BTYPE  (2)   = ZEROS OR SPACES
 11313           IF  REMOVE-AH-COVERAGE
 11314               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11315                                        PI-BTYPE (2)
 11316               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11317                                        WS-B-AH-ISS-PRM-ENTERED
 11318               SUBTRACT PB-I-AH-PREM-CALC FROM
 11319                                        WS-B-AH-ISS-PRM-COMPUTED
 11320               MOVE ZEROS            TO PB-I-AH-TERM
 11321                                        PB-I-AH-BENEFIT-AMT
 11322                                        PB-I-AH-PREMIUM-AMT
 11323                                        PB-I-AH-BENEFIT-CD
 11324                                        PB-I-AH-PREM-CALC
 11325                                        PB-I-AH-CRIT-PER
 11326               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11327           ELSE
 11328               NEXT SENTENCE
 11329        ELSE
 11330           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11331                                    PI-BTYPE (2).
 11332 1360-REWRITE-PB-RECORD.
 11333     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11334
 11335     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11336     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11337
 11338     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11339
 11340     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11341     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11342
 11343     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11344         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11345
 11346     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11347         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11348
 11349     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11350
 11351     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11352
 11353     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11354
 11355     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11356     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11357     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11358
 11359     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11360     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11361
 11362 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 212
* EL6311.cbl
 11363     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11364     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11365     MOVE 'C'                    TO JP-RECORD-TYPE.
 11366     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11367
 11368
 11369* EXEC CICS REWRITE
 11370*        DATASET (FILE-ID-ERPNDB)
 11371*        FROM    (PENDING-BUSINESS)
 11372*    END-EXEC.
 11373     MOVE LENGTH OF
 11374      PENDING-BUSINESS
 11375       TO DFHEIV11
 11376*    MOVE '&& L                  %   #00010965' TO DFHEIV0
 11377     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11378     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11379     MOVE X'2020233030303130393635' TO DFHEIV0(25:11)
 11380     CALL 'kxdfhei1' USING DFHEIV0,
 11381           FILE-ID-ERPNDB,
 11382           PENDING-BUSINESS,
 11383           DFHEIV11,
 11384           DFHEIV99
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11386
 11387
 11388     PERFORM 8400-LOG-JOURNAL-RECORD.
 11389******************************************************************
 11390*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11391******************************************************************
 11392     display ' made it to update orig cert '
 11393     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11394     MOVE ' '                    TO WS-ERMAIL-SW
 11395
 11396* EXEC CICS READ
 11397*       DATASET   (FILE-ID-ERMAIL)
 11398*       SET       (ADDRESS OF MAILING-DATA)
 11399*       RIDFLD    (ERMAIL-KEY)
 11400*       RESP      (WS-RESPONSE)
 11401*    END-EXEC
 11402*    MOVE '&"S        E          (  N#00010977' TO DFHEIV0
 11403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11405     MOVE X'204E233030303130393737' TO DFHEIV0(25:11)
 11406     CALL 'kxdfhei1' USING DFHEIV0,
 11407           FILE-ID-ERMAIL,
 11408           DFHEIV20,
 11409           DFHEIV99,
 11410           ERMAIL-KEY,
 11411           DFHEIV99,
 11412           DFHEIV99,
 11413           DFHEIV99
 11414     SET ADDRESS OF MAILING-DATA TO
 11415         DFHEIV20
 11416     MOVE EIBRESP  TO WS-RESPONSE
 11417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11418     IF RESP-NORMAL
 11419        SET ERMAIL-FOUND TO TRUE
 11420     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 213
* EL6311.cbl
 11421
 11422     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11423     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11424                                 TO ELCRTO-KEY
 11425     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11426     MOVE +0                     TO ELCRTO-SEQ-NO
 11427
 11428* EXEC CICS READ
 11429*       DATASET   ('ELCRTO')
 11430*       INTO      (ORIGINAL-CERTIFICATE)
 11431*       RIDFLD    (ELCRTO-KEY)
 11432*       GTEQ
 11433*       RESP      (WS-RESPONSE)
 11434*    END-EXEC
 11435     MOVE LENGTH OF
 11436      ORIGINAL-CERTIFICATE
 11437       TO DFHEIV11
 11438     MOVE 'ELCRTO' TO DFHEIV1
 11439*    MOVE '&"IL       G          (  N#00010992' TO DFHEIV0
 11440     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11442     MOVE X'204E233030303130393932' TO DFHEIV0(25:11)
 11443     CALL 'kxdfhei1' USING DFHEIV0,
 11444           DFHEIV1,
 11445           ORIGINAL-CERTIFICATE,
 11446           DFHEIV11,
 11447           ELCRTO-KEY,
 11448           DFHEIV99,
 11449           DFHEIV99,
 11450           DFHEIV99
 11451     MOVE EIBRESP  TO WS-RESPONSE
 11452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11453     display ' just read gteq ' ws-response
 11454     IF RESP-NORMAL
 11455        AND (OC-CONTROL-PRIMARY (1:33) =
 11456                 PB-CONTROL-BY-ACCOUNT (1:33))
 11457        AND (OC-RECORD-TYPE = 'I')
 11458        display ' resp norm, key =, type i '
 11459        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11460           display ' end proc blank '
 11461           display ' csr edit session ' PI-CSR-SESSION-SW
 11462           IF NOT CSR-EDIT-SESSION
 11463
 11464* EXEC CICS READ
 11465*                DATASET   ('ELCRTO')
 11466*                INTO      (ORIGINAL-CERTIFICATE)
 11467*                RIDFLD    (OC-CONTROL-PRIMARY)
 11468*                UPDATE
 11469*                RESP      (WS-RESPONSE)
 11470*             END-EXEC
 11471     MOVE LENGTH OF
 11472      ORIGINAL-CERTIFICATE
 11473       TO DFHEIV11
 11474     MOVE 'ELCRTO' TO DFHEIV1
 11475*    MOVE '&"IL       EU         (  N#00011009' TO DFHEIV0
 11476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11478     MOVE X'204E233030303131303039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 214
* EL6311.cbl
 11479     CALL 'kxdfhei1' USING DFHEIV0,
 11480           DFHEIV1,
 11481           ORIGINAL-CERTIFICATE,
 11482           DFHEIV11,
 11483           OC-CONTROL-PRIMARY,
 11484           DFHEIV99,
 11485           DFHEIV99,
 11486           DFHEIV99
 11487     MOVE EIBRESP  TO WS-RESPONSE
 11488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11489              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11490              IF RESP-NORMAL
 11491                 display ' good read upd '
 11492                 MOVE PB-I-INSURED-LAST-NAME TO
 11493                         OC-INS-LAST-NAME
 11494                 MOVE PB-I-INSURED-FIRST-NAME TO
 11495                         OC-INS-FIRST-NAME
 11496                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11497                         OC-INS-MIDDLE-INIT
 11498                 MOVE PB-I-AGE         TO OC-INS-AGE
 11499                 MOVE PB-I-JOINT-LAST-NAME   TO
 11500                         OC-JNT-LAST-NAME
 11501                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11502                         OC-JNT-FIRST-NAME
 11503                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11504                         OC-JNT-MIDDLE-INIT
 11505                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11506                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11507                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11508                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11509                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11510                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11511                         OC-LF-ALT-BEN-AMT
 11512                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11513                         OC-LF-ALT-PRM-AMT
 11514                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11515                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11516                 MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11517                 MOVE +0               TO OC-LF-CANCEL-AMT
 11518                                          OC-LF-ITD-CANCEL-AMT
 11519                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11520                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11521                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11522                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11523                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11524                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11525                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11526                 MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11527                 MOVE +0               TO OC-AH-CANCEL-AMT
 11528                                          OC-AH-ITD-CANCEL-AMT
 11529                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11530                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11531                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11532                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11533                 IF ERMAIL-FOUND
 11534                    MOVE MA-CRED-BENE-NAME
 11535                                 TO OC-CRED-BENE-NAME
 11536                 END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 215
* EL6311.cbl
 11537                 IF NOT CERT-TRL-REC-NOT-FOUND
 11538                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11539                           OC-INS-AGE-DEFAULT-FLAG
 11540                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11541                           OC-JNT-AGE-DEFAULT-FLAG
 11542                 END-IF
 11543
 11544* EXEC CICS REWRITE
 11545*                   DATASET   ('ELCRTO')
 11546*                   FROM      (ORIGINAL-CERTIFICATE)
 11547*                   RESP      (WS-RESPONSE)
 11548*                END-EXEC
 11549     MOVE LENGTH OF
 11550      ORIGINAL-CERTIFICATE
 11551       TO DFHEIV11
 11552     MOVE 'ELCRTO' TO DFHEIV1
 11553*    MOVE '&& L                  %  N#00011070' TO DFHEIV0
 11554     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11555     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11556     MOVE X'204E233030303131303730' TO DFHEIV0(25:11)
 11557     CALL 'kxdfhei1' USING DFHEIV0,
 11558           DFHEIV1,
 11559           ORIGINAL-CERTIFICATE,
 11560           DFHEIV11,
 11561           DFHEIV99
 11562     MOVE EIBRESP  TO WS-RESPONSE
 11563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11564                 display ' just rewrote ' ws-response
 11565              END-IF
 11566           END-IF
 11567        ELSE
 11568           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11569           MOVE 'OC'             TO OC-RECORD-ID
 11570           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11571           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11572           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11573           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11574           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11575           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11576           MOVE PB-I-AGE         TO OC-INS-AGE
 11577           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11578           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11579           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11580           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11581           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11582           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11583           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11584           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11585           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11586           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11587           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11588           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11589           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11590           MOVE +0               TO OC-LF-CANCEL-AMT
 11591                                    OC-LF-ITD-CANCEL-AMT
 11592           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11593           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11594           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 216
* EL6311.cbl
 11595           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11596           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11597           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11598           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11599           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11600           MOVE +0               TO OC-AH-CANCEL-AMT
 11601                                    OC-AH-ITD-CANCEL-AMT
 11602           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11603           IF ERMAIL-FOUND
 11604              MOVE MA-CRED-BENE-NAME
 11605                                 TO OC-CRED-BENE-NAME
 11606           END-IF
 11607           IF NOT CERT-TRL-REC-NOT-FOUND
 11608              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11609                           OC-INS-AGE-DEFAULT-FLAG
 11610              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11611                           OC-JNT-AGE-DEFAULT-FLAG
 11612           END-IF
 11613           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11614
 11615* EXEC CICS WRITE
 11616*             DATASET   ('ELCRTO')
 11617*             FROM      (ORIGINAL-CERTIFICATE)
 11618*             RIDFLD    (OC-CONTROL-PRIMARY)
 11619*             RESP      (WS-RESPONSE)
 11620*          END-EXEC
 11621     MOVE LENGTH OF
 11622      ORIGINAL-CERTIFICATE
 11623       TO DFHEIV11
 11624     MOVE 'ELCRTO' TO DFHEIV1
 11625*    MOVE '&$ L                  ''  N#00011125' TO DFHEIV0
 11626     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11628     MOVE X'204E233030303131313235' TO DFHEIV0(25:11)
 11629     CALL 'kxdfhei1' USING DFHEIV0,
 11630           DFHEIV1,
 11631           ORIGINAL-CERTIFICATE,
 11632           DFHEIV11,
 11633           OC-CONTROL-PRIMARY,
 11634           DFHEIV99,
 11635           DFHEIV99
 11636     MOVE EIBRESP  TO WS-RESPONSE
 11637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11638        END-IF
 11639     ELSE
 11640        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11641        MOVE 'OC'                TO OC-RECORD-ID
 11642        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11643                                 TO OC-CONTROL-PRIMARY (1:33)
 11644        MOVE 'I'                 TO OC-RECORD-TYPE
 11645        MOVE +4096               TO OC-KEY-SEQ-NO
 11646        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11647        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11648        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11649        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11650        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11651        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11652        MOVE PB-I-AGE            TO OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 217
* EL6311.cbl
 11653        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11654        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11655        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11656        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11657        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11658        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11659        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11660        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11661        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11662        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11663        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11664        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11665        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11666        MOVE +0                  TO OC-LF-CANCEL-AMT
 11667                                    OC-LF-ITD-CANCEL-AMT
 11668        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11669        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11670        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11671        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11672        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11673        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11674        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11675        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11676        MOVE +0                  TO OC-AH-CANCEL-AMT
 11677                                    OC-AH-ITD-CANCEL-AMT
 11678        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11679        IF ERMAIL-FOUND
 11680           MOVE MA-CRED-BENE-NAME
 11681                                 TO OC-CRED-BENE-NAME
 11682        END-IF
 11683        IF NOT CERT-TRL-REC-NOT-FOUND
 11684           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11685                           OC-INS-AGE-DEFAULT-FLAG
 11686           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11687                           OC-JNT-AGE-DEFAULT-FLAG
 11688        END-IF
 11689        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11690
 11691* EXEC CICS WRITE
 11692*          DATASET   ('ELCRTO')
 11693*          FROM      (ORIGINAL-CERTIFICATE)
 11694*          RIDFLD    (OC-CONTROL-PRIMARY)
 11695*          RESP      (WS-RESPONSE)
 11696*       END-EXEC
 11697     MOVE LENGTH OF
 11698      ORIGINAL-CERTIFICATE
 11699       TO DFHEIV11
 11700     MOVE 'ELCRTO' TO DFHEIV1
 11701*    MOVE '&$ L                  ''  N#00011183' TO DFHEIV0
 11702     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11704     MOVE X'204E233030303131313833' TO DFHEIV0(25:11)
 11705     CALL 'kxdfhei1' USING DFHEIV0,
 11706           DFHEIV1,
 11707           ORIGINAL-CERTIFICATE,
 11708           DFHEIV11,
 11709           OC-CONTROL-PRIMARY,
 11710           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 218
* EL6311.cbl
 11711           DFHEIV99
 11712     MOVE EIBRESP  TO WS-RESPONSE
 11713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11714     END-IF
 11715******************************************************************
 11716*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11717******************************************************************
 11718
 11719     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11720     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11721
 11722
 11723* EXEC CICS READ
 11724*        INTO    (PENDING-BUSINESS)
 11725*        DATASET (FILE-ID-ERPNDB)
 11726*        RIDFLD  (ERPNDB-KEY)
 11727*        UPDATE
 11728*    END-EXEC.
 11729     MOVE LENGTH OF
 11730      PENDING-BUSINESS
 11731       TO DFHEIV11
 11732*    MOVE '&"IL       EU         (   #00011197' TO DFHEIV0
 11733     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11734     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11735     MOVE X'2020233030303131313937' TO DFHEIV0(25:11)
 11736     CALL 'kxdfhei1' USING DFHEIV0,
 11737           FILE-ID-ERPNDB,
 11738           PENDING-BUSINESS,
 11739           DFHEIV11,
 11740           ERPNDB-KEY,
 11741           DFHEIV99,
 11742           DFHEIV99,
 11743           DFHEIV99
 11744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11745
 11746
 11747     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11748     MOVE 'B'                    TO JP-RECORD-TYPE.
 11749     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11750
 11751     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11752
 11753     PERFORM 8400-LOG-JOURNAL-RECORD.
 11754
 11755     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11756
 11757     MOVE 'C'                    TO JP-RECORD-TYPE.
 11758     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11759
 11760
 11761* EXEC CICS REWRITE
 11762*        DATASET    (FILE-ID-ERPNDB)
 11763*        FROM       (PENDING-BUSINESS)
 11764*    END-EXEC.
 11765     MOVE LENGTH OF
 11766      PENDING-BUSINESS
 11767       TO DFHEIV11
 11768*    MOVE '&& L                  %   #00011217' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 219
* EL6311.cbl
 11769     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11770     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11771     MOVE X'2020233030303131323137' TO DFHEIV0(25:11)
 11772     CALL 'kxdfhei1' USING DFHEIV0,
 11773           FILE-ID-ERPNDB,
 11774           PENDING-BUSINESS,
 11775           DFHEIV11,
 11776           DFHEIV99
 11777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11778
 11779
 11780     PERFORM 8400-LOG-JOURNAL-RECORD.
 11781
 11782     IF WS-ERRORS-PRESENT
 11783        GO TO 3900-RE-DISPLAY-RECORD.
 11784
 11785     MOVE ZEROS                  TO EMI-ERROR.
 11786     MOVE -1                     TO BMAINTL.
 11787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11788     GO TO 3900-RE-DISPLAY-RECORD.
 11789
 11790 1380-BATCH-HDR-NOT-FOUND.
 11791     MOVE -1                     TO BMAINTL.
 11792     MOVE ER-7450                TO EMI-ERROR.
 11793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11794     GO TO 8200-SEND-DATAONLY.
 11795
 11796 1385-REC-NOT-FOUND.
 11797     MOVE -1                     TO BMAINTL.
 11798     MOVE ER-7451                TO EMI-ERROR.
 11799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11800     GO TO 8200-SEND-DATAONLY.
 11801
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 220
* EL6311.cbl
 11803
 11804 1386-UPDATE-AGE-FLAGS.
 11805
 11806
 11807* EXEC CICS GETMAIN
 11808*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11809*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11810*        INITIMG (GETMAIN-SPACE)
 11811*    END-EXEC
 11812*    MOVE ',"IL                  $   #00011248' TO DFHEIV0
 11813     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11814     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11815     MOVE X'2020233030303131323438' TO DFHEIV0(25:11)
 11816     CALL 'kxdfhei1' USING DFHEIV0,
 11817           DFHEIV20,
 11818           ELCRTT-RECORD-LENGTH,
 11819           GETMAIN-SPACE
 11820     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11821         DFHEIV20
 11822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11823
 11824
 11825* EXEC CICS HANDLE CONDITION
 11826*        NOTFND   (1386-NOTFND)
 11827*    END-EXEC.
 11828*    MOVE '"$I                   ! ( #00011254' TO DFHEIV0
 11829     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11831     MOVE X'2820233030303131323534' TO DFHEIV0(25:11)
 11832     CALL 'kxdfhei1' USING DFHEIV0
 11833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11834
 11835
 11836     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11837     MOVE 'C'                TO ELCRTT-REC-TYPE
 11838
 11839
 11840* EXEC CICS READ
 11841*        UPDATE
 11842*        DATASET  (CRTT-ID)
 11843*        RIDFLD   (ELCRTT-KEY)
 11844*        INTO     (CERTIFICATE-TRAILERS)
 11845*    END-EXEC.
 11846     MOVE LENGTH OF
 11847      CERTIFICATE-TRAILERS
 11848       TO DFHEIV11
 11849*    MOVE '&"IL       EU         (   #00011261' TO DFHEIV0
 11850     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11851     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11852     MOVE X'2020233030303131323631' TO DFHEIV0(25:11)
 11853     CALL 'kxdfhei1' USING DFHEIV0,
 11854           CRTT-ID,
 11855           CERTIFICATE-TRAILERS,
 11856           DFHEIV11,
 11857           ELCRTT-KEY,
 11858           DFHEIV99,
 11859           DFHEIV99,
 11860           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 221
* EL6311.cbl
 11861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11862
 11863
 11864     IF WS-INS-AGE-SET = 'Y'
 11865        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11866     END-IF
 11867     IF WS-JNT-AGE-SET = 'Y'
 11868        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11869     END-IF
 11870
 11871
 11872* EXEC CICS REWRITE
 11873*       DATASET  (CRTT-ID)
 11874*       FROM     (CERTIFICATE-TRAILERS)
 11875*    END-EXEC.
 11876     MOVE LENGTH OF
 11877      CERTIFICATE-TRAILERS
 11878       TO DFHEIV11
 11879*    MOVE '&& L                  %   #00011275' TO DFHEIV0
 11880     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11881     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11882     MOVE X'2020233030303131323735' TO DFHEIV0(25:11)
 11883     CALL 'kxdfhei1' USING DFHEIV0,
 11884           CRTT-ID,
 11885           CERTIFICATE-TRAILERS,
 11886           DFHEIV11,
 11887           DFHEIV99
 11888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11889
 11890
 11891     GO TO 1386-EXIT.
 11892
 11893 1386-NOTFND.
 11894
 11895     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11896     MOVE 'CS'         TO CS-RECORD-ID.
 11897     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11898     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11899     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11900     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11901     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11902
 11903* EXEC CICS WRITE
 11904*       DATASET  (CRTT-ID)
 11905*       RIDFLD   (ELCRTT-KEY)
 11906*       FROM     (CERTIFICATE-TRAILERS)
 11907*    END-EXEC.
 11908     MOVE LENGTH OF
 11909      CERTIFICATE-TRAILERS
 11910       TO DFHEIV11
 11911*    MOVE '&$ L                  ''   #00011291' TO DFHEIV0
 11912     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11914     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 11915     CALL 'kxdfhei1' USING DFHEIV0,
 11916           CRTT-ID,
 11917           CERTIFICATE-TRAILERS,
 11918           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 222
* EL6311.cbl
 11919           ELCRTT-KEY,
 11920           DFHEIV99,
 11921           DFHEIV99
 11922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11923
 11924
 11925 1386-EXIT.
 11926     EXIT.
 11927
 11928 1390-UPDATE-ERPNDM.
 11929
 11930
 11931* EXEC CICS HANDLE CONDITION
 11932*        NOTFND (1399-EXIT)
 11933*    END-EXEC.
 11934*    MOVE '"$I                   ! ) #00011302' TO DFHEIV0
 11935     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11937     MOVE X'2920233030303131333032' TO DFHEIV0(25:11)
 11938     CALL 'kxdfhei1' USING DFHEIV0
 11939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11940
 11941
 11942     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11943
 11944
 11945* EXEC CICS READ
 11946*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 11947*        DATASET (FILE-ID-ERPNDM)
 11948*        RIDFLD  (ERPNDM-KEY)
 11949*        UPDATE
 11950*    END-EXEC.
 11951*    MOVE '&"S        EU         (   #00011308' TO DFHEIV0
 11952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11954     MOVE X'2020233030303131333038' TO DFHEIV0(25:11)
 11955     CALL 'kxdfhei1' USING DFHEIV0,
 11956           FILE-ID-ERPNDM,
 11957           DFHEIV20,
 11958           DFHEIV99,
 11959           ERPNDM-KEY,
 11960           DFHEIV99,
 11961           DFHEIV99,
 11962           DFHEIV99
 11963     SET ADDRESS OF PENDING-MAILING-DATA TO
 11964         DFHEIV20
 11965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11966
 11967
 11968     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 11969     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 11970     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 11971
 11972     IF BLSTNML GREATER THAN ZEROS
 11973         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 11974
 11975     IF B1STNML GREATER  THAN ZEROS
 11976         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 223
* EL6311.cbl
 11977
 11978     IF BINITL GREATER THAN ZEROS
 11979         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 11980
 11981     IF BAGEL GREATER THAN ZEROS
 11982         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 11983
 11984     IF BBIRTHL GREATER THAN ZEROS
 11985         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 11986
 11987     IF BSEXL GREATER THAN ZEROS
 11988         MOVE  BSEXI             TO PM-INSURED-SEX.
 11989
 11990
 11991* EXEC CICS REWRITE
 11992*        DATASET (FILE-ID-ERPNDM)
 11993*        FROM    (PENDING-MAILING-DATA)
 11994*    END-EXEC.
 11995     MOVE LENGTH OF
 11996      PENDING-MAILING-DATA
 11997       TO DFHEIV11
 11998*    MOVE '&& L                  %   #00011337' TO DFHEIV0
 11999     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12000     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12001     MOVE X'2020233030303131333337' TO DFHEIV0(25:11)
 12002     CALL 'kxdfhei1' USING DFHEIV0,
 12003           FILE-ID-ERPNDM,
 12004           PENDING-MAILING-DATA,
 12005           DFHEIV11,
 12006           DFHEIV99
 12007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12008
 12009
 12010 1399-EXIT.
 12011     EXIT.
 12012
 12013******************************************************************
 12014*                                                                *
 12015*          D E L E T E   I S S U E   R O U T I N E               *
 12016*                                                                *
 12017******************************************************************
 12018
 12019 1400-DELETE-ISSUE-ROUTINE.
 12020     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12021
 12022     IF BCHGL NOT = ZEROS
 12023        MOVE ER-2196             TO EMI-ERROR
 12024        MOVE AL-UABON            TO BMAINTA
 12025        MOVE -1                  TO BMAINTL
 12026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12027        GO TO 8200-SEND-DATAONLY.
 12028
 12029
 12030* EXEC CICS HANDLE CONDITION
 12031*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12032*    END-EXEC.
 12033*    MOVE '"$I                   ! * #00011361' TO DFHEIV0
 12034     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 224
* EL6311.cbl
 12035     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12036     MOVE X'2A20233030303131333631' TO DFHEIV0(25:11)
 12037     CALL 'kxdfhei1' USING DFHEIV0
 12038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12039
 12040
 12041     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12042     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12043     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12044
 12045
 12046* EXEC CICS READ
 12047*        SET     (ADDRESS OF PENDING-BUSINESS)
 12048*        DATASET (FILE-ID-ERPNDB)
 12049*        RIDFLD  (ERPNDB-KEY)
 12050*    END-EXEC.
 12051*    MOVE '&"S        E          (   #00011369' TO DFHEIV0
 12052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12054     MOVE X'2020233030303131333639' TO DFHEIV0(25:11)
 12055     CALL 'kxdfhei1' USING DFHEIV0,
 12056           FILE-ID-ERPNDB,
 12057           DFHEIV20,
 12058           DFHEIV99,
 12059           ERPNDB-KEY,
 12060           DFHEIV99,
 12061           DFHEIV99,
 12062           DFHEIV99
 12063     SET ADDRESS OF PENDING-BUSINESS TO
 12064         DFHEIV20
 12065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12066
 12067
 12068     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12069
 12070     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12071
 12072     IF BSUFIXL NOT = ZEROS
 12073        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12074     ELSE
 12075        MOVE SPACE               TO WS-NEW-SUFFIX.
 12076
 12077     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12078     PERFORM 8600-DEEDIT.
 12079     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12080     MOVE '4'                    TO DC-OPTION-CODE.
 12081     PERFORM 9700-DATE-LINK.
 12082     IF DATE-CONVERSION-ERROR
 12083        MOVE ER-0348             TO EMI-ERROR
 12084        MOVE -1                  TO BEFFDTL
 12085        MOVE AL-UABON            TO BEFFDTA
 12086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12087        GO TO 8200-SEND-DATAONLY
 12088     ELSE
 12089        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12090        MOVE AL-UANON            TO BEFFDTA
 12091        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12092
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 225
* EL6311.cbl
 12093
 12094* EXEC CICS HANDLE CONDITION
 12095*         NOTFND    (1490-RECORD-NOT-FOUND)
 12096*    END-EXEC.
 12097*    MOVE '"$I                   ! + #00011400' TO DFHEIV0
 12098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12100     MOVE X'2B20233030303131343030' TO DFHEIV0(25:11)
 12101     CALL 'kxdfhei1' USING DFHEIV0
 12102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12103
 12104
 12105
 12106* EXEC CICS READ
 12107*        SET     (ADDRESS OF PENDING-BUSINESS)
 12108*        DATASET (FILE-ID-ERPNDB)
 12109*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12110*        UPDATE
 12111*    END-EXEC.
 12112*    MOVE '&"S        EU         (   #00011404' TO DFHEIV0
 12113     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12114     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12115     MOVE X'2020233030303131343034' TO DFHEIV0(25:11)
 12116     CALL 'kxdfhei1' USING DFHEIV0,
 12117           FILE-ID-ERPNDB,
 12118           DFHEIV20,
 12119           DFHEIV99,
 12120           PI-PREV-CONTROL-PRIMARY,
 12121           DFHEIV99,
 12122           DFHEIV99,
 12123           DFHEIV99
 12124     SET ADDRESS OF PENDING-BUSINESS TO
 12125         DFHEIV20
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12127
 12128
 12129     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12130        MOVE -1                 TO BMAINTL
 12131        MOVE ER-2197            TO EMI-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        GO TO 8200-SEND-DATAONLY.
 12134
 12135     IF PB-BILLED-DT NOT = LOW-VALUES
 12136        MOVE -1                 TO BMAINTL
 12137        MOVE ER-2129            TO EMI-ERROR
 12138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12139        GO TO 8200-SEND-DATAONLY.
 12140
 12141     IF PB-CHG-COUNT NOT = ZEROS
 12142        MOVE ER-2336            TO EMI-ERROR
 12143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12144        MOVE AL-UABON            TO BMAINTA
 12145        MOVE -1                  TO BMAINTL
 12146        GO TO 8200-SEND-DATAONLY.
 12147
 12148     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12149        PB-CHG-COUNT NOT = ZEROS
 12150        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 226
* EL6311.cbl
 12151        MOVE AL-UABON            TO BMAINTA
 12152        MOVE -1                  TO BMAINTL
 12153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12154        GO TO 8200-SEND-DATAONLY.
 12155******************************************************************
 12156*                                                                *
 12157*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12158*                                                                *
 12159******************************************************************
 12160     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12161     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12162     MOVE +0                     TO ELCRTO-SEQ-NO
 12163
 12164* EXEC CICS READ
 12165*       DATASET   ('ELCRTO')
 12166*       INTO      (ORIGINAL-CERTIFICATE)
 12167*       RIDFLD    (ELCRTO-KEY)
 12168*       GTEQ
 12169*       RESP      (WS-RESPONSE)
 12170*    END-EXEC
 12171     MOVE LENGTH OF
 12172      ORIGINAL-CERTIFICATE
 12173       TO DFHEIV11
 12174     MOVE 'ELCRTO' TO DFHEIV1
 12175*    MOVE '&"IL       G          (  N#00011445' TO DFHEIV0
 12176     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12178     MOVE X'204E233030303131343435' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           DFHEIV1,
 12181           ORIGINAL-CERTIFICATE,
 12182           DFHEIV11,
 12183           ELCRTO-KEY,
 12184           DFHEIV99,
 12185           DFHEIV99,
 12186           DFHEIV99
 12187     MOVE EIBRESP  TO WS-RESPONSE
 12188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12189     IF RESP-NORMAL
 12190        AND (OC-CONTROL-PRIMARY (1:33) =
 12191                 PB-CONTROL-BY-ACCOUNT (1:33))
 12192        AND (OC-RECORD-TYPE = 'I')
 12193
 12194* EXEC CICS READ
 12195*          DATASET   ('ELCRTO')
 12196*          INTO      (ORIGINAL-CERTIFICATE)
 12197*          RIDFLD    (ELCRTO-KEY)
 12198*          UPDATE
 12199*          RESP      (WS-RESPONSE)
 12200*       END-EXEC
 12201     MOVE LENGTH OF
 12202      ORIGINAL-CERTIFICATE
 12203       TO DFHEIV11
 12204     MOVE 'ELCRTO' TO DFHEIV1
 12205*    MOVE '&"IL       EU         (  N#00011456' TO DFHEIV0
 12206     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12207     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12208     MOVE X'204E233030303131343536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 227
* EL6311.cbl
 12209     CALL 'kxdfhei1' USING DFHEIV0,
 12210           DFHEIV1,
 12211           ORIGINAL-CERTIFICATE,
 12212           DFHEIV11,
 12213           ELCRTO-KEY,
 12214           DFHEIV99,
 12215           DFHEIV99,
 12216           DFHEIV99
 12217     MOVE EIBRESP  TO WS-RESPONSE
 12218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12219        IF RESP-NORMAL
 12220
 12221* EXEC CICS DELETE
 12222*             DATASET   ('ELCRTO')
 12223*          END-EXEC
 12224     MOVE 'ELCRTO' TO DFHEIV1
 12225*    MOVE '&(                    &   #00011464' TO DFHEIV0
 12226     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12228     MOVE X'2020233030303131343634' TO DFHEIV0(25:11)
 12229     CALL 'kxdfhei1' USING DFHEIV0,
 12230           DFHEIV1,
 12231           DFHEIV99,
 12232           DFHEIV99,
 12233           DFHEIV99,
 12234           DFHEIV99
 12235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12236        END-IF
 12237     END-IF
 12238******************************************************************
 12239*                                                                *
 12240*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12241*                                                                *
 12242******************************************************************
 12243
 12244* EXEC CICS HANDLE CONDITION
 12245*        NOTFND    (1405-DELETE-CERTIFICATE)
 12246*    END-EXEC.
 12247*    MOVE '"$I                   ! , #00011474' TO DFHEIV0
 12248     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12250     MOVE X'2C20233030303131343734' TO DFHEIV0(25:11)
 12251     CALL 'kxdfhei1' USING DFHEIV0
 12252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12253
 12254
 12255
 12256* EXEC CICS READ
 12257*        EQUAL
 12258*        DATASET   (FILE-ID-ERPNDM)
 12259*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12260*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12261*        UPDATE
 12262*    END-EXEC.
 12263*    MOVE '&"S        EU         (   #00011478' TO DFHEIV0
 12264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12266     MOVE X'2020233030303131343738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 228
* EL6311.cbl
 12267     CALL 'kxdfhei1' USING DFHEIV0,
 12268           FILE-ID-ERPNDM,
 12269           DFHEIV20,
 12270           DFHEIV99,
 12271           PI-PREV-CONTROL-PRIMARY,
 12272           DFHEIV99,
 12273           DFHEIV99,
 12274           DFHEIV99
 12275     SET ADDRESS OF PENDING-MAILING-DATA TO
 12276         DFHEIV20
 12277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12278
 12279
 12280     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12281     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12282     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12283
 12284     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12285
 12286
 12287* EXEC CICS DELETE
 12288*        DATASET   (FILE-ID-ERPNDM)
 12289*    END-EXEC.
 12290*    MOVE '&(                    &   #00011492' TO DFHEIV0
 12291     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12293     MOVE X'2020233030303131343932' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0,
 12295           FILE-ID-ERPNDM,
 12296           DFHEIV99,
 12297           DFHEIV99,
 12298           DFHEIV99,
 12299           DFHEIV99
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12301
 12302
 12303******************************************************************
 12304*                PROCESS   CERTIFICATE                           *
 12305******************************************************************
 12306
 12307 1405-DELETE-CERTIFICATE.
 12308
 12309* EXEC CICS HANDLE CONDITION
 12310*         NOTFND  (1420-CONTINUE-DELETE)
 12311*    END-EXEC.
 12312*    MOVE '"$I                   ! - #00011501' TO DFHEIV0
 12313     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12315     MOVE X'2D20233030303131353031' TO DFHEIV0(25:11)
 12316     CALL 'kxdfhei1' USING DFHEIV0
 12317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12318
 12319
 12320     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12321     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12322     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12323     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12324
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 229
* EL6311.cbl
 12325
 12326* EXEC CICS READ
 12327*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12328*        DATASET (FILE-ID-ELCERT)
 12329*        RIDFLD  (ELCERT-KEY)
 12330*        UPDATE
 12331*    END-EXEC.
 12332*    MOVE '&"S        EU         (   #00011510' TO DFHEIV0
 12333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12335     MOVE X'2020233030303131353130' TO DFHEIV0(25:11)
 12336     CALL 'kxdfhei1' USING DFHEIV0,
 12337           FILE-ID-ELCERT,
 12338           DFHEIV20,
 12339           DFHEIV99,
 12340           ELCERT-KEY,
 12341           DFHEIV99,
 12342           DFHEIV99,
 12343           DFHEIV99
 12344     SET ADDRESS OF CERTIFICATE-MASTER TO
 12345         DFHEIV20
 12346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12347
 12348
 12349     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12350
 12351     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12352     MOVE 'B'                    TO JP-RECORD-TYPE
 12353     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12354
 12355     PERFORM 8400-LOG-JOURNAL-RECORD.
 12356
 12357     IF CERT-NOTES-ARE-NOT-PRESENT
 12358        MOVE ' '                 TO WS-CERT-NOTE-SW
 12359     ELSE
 12360        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12361
 12362     IF INSURED-ADDR-PRESENT
 12363        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12364
 12365******************************************************************
 12366******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12367******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12368******************************************************************
 12369******************************************************************
 12370
 12371     IF CERT-ADDED-BATCH AND
 12372        (NOT NO-CLAIM-ATTACHED
 12373         OR
 12374         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12375        GO TO 1410-REWRITE-CERT.
 12376
 12377******************************************************************
 12378******************************************************************
 12379
 12380     IF CERT-ADDED-BATCH  AND
 12381        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12382        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 230
* EL6311.cbl
 12383
 12384     IF NO-CLAIM-ATTACHED
 12385        NEXT SENTENCE
 12386     ELSE
 12387        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12388        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12389        GO TO 1410-REWRITE-CERT.
 12390
 12391     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12392     MOVE 'D'                      TO JP-RECORD-TYPE.
 12393     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12394
 12395
 12396* EXEC CICS DELETE
 12397*         DATASET    (FILE-ID-ELCERT)
 12398*    END-EXEC.
 12399*    MOVE '&(                    &   #00011563' TO DFHEIV0
 12400     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12401     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12402     MOVE X'2020233030303131353633' TO DFHEIV0(25:11)
 12403     CALL 'kxdfhei1' USING DFHEIV0,
 12404           FILE-ID-ELCERT,
 12405           DFHEIV99,
 12406           DFHEIV99,
 12407           DFHEIV99,
 12408           DFHEIV99
 12409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12410
 12411
 12412     PERFORM 8400-LOG-JOURNAL-RECORD.
 12413
 12414******************************************************************
 12415*                                                                *
 12416*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12417*                                                                *
 12418******************************************************************
 12419
 12420     IF  CERT-NOTES-ARE-PRESENT
 12421         NEXT SENTENCE
 12422     ELSE
 12423         GO TO 1407-DELETE-MAILING.
 12424
 12425
 12426* EXEC CICS HANDLE CONDITION
 12427*         NOTFND  (1406-DELETE-ERNOTE)
 12428*    END-EXEC.
 12429*    MOVE '"$I                   ! . #00011580' TO DFHEIV0
 12430     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12432     MOVE X'2E20233030303131353830' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0
 12434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12435
 12436
 12437     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12438     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12439     MOVE 0                     TO ERCNOT-SEQUENCE.
 12440
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 231
* EL6311.cbl
 12441 1406-DELETE-ERCNOT-LOOP.
 12442
 12443
 12444* EXEC CICS READ
 12445*        GTEQ
 12446*        DATASET   (FILE-ID-ERCNOT)
 12447*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12448*        RIDFLD    (ERCNOT-KEY)
 12449*    END-EXEC.
 12450*    MOVE '&"S        G          (   #00011590' TO DFHEIV0
 12451     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12453     MOVE X'2020233030303131353930' TO DFHEIV0(25:11)
 12454     CALL 'kxdfhei1' USING DFHEIV0,
 12455           FILE-ID-ERCNOT,
 12456           DFHEIV20,
 12457           DFHEIV99,
 12458           ERCNOT-KEY,
 12459           DFHEIV99,
 12460           DFHEIV99,
 12461           DFHEIV99
 12462     SET ADDRESS OF CERT-NOTE-FILE TO
 12463         DFHEIV20
 12464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12465
 12466
 12467     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12468     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12469         GO TO 1406-DELETE-ERNOTE
 12470     END-IF.
 12471
 12472     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12473     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12474     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12475
 12476     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12477
 12478
 12479* EXEC CICS DELETE
 12480*        DATASET   (FILE-ID-ERCNOT)
 12481*        RIDFLD    (ERCNOT-KEY)
 12482*        END-EXEC.
 12483*    MOVE '&(  R                 &   #00011608' TO DFHEIV0
 12484     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12485     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12486     MOVE X'2020233030303131363038' TO DFHEIV0(25:11)
 12487     CALL 'kxdfhei1' USING DFHEIV0,
 12488           FILE-ID-ERCNOT,
 12489           ERCNOT-KEY,
 12490           DFHEIV99,
 12491           DFHEIV99,
 12492           DFHEIV99
 12493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12494
 12495
 12496     PERFORM 8400-LOG-JOURNAL-RECORD.
 12497
 12498     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 232
* EL6311.cbl
 12499
 12500 1406-DELETE-ERNOTE.
 12501
 12502
 12503* EXEC CICS HANDLE CONDITION
 12504*         NOTFND  (1407-DELETE-MAILING)
 12505*    END-EXEC.
 12506*    MOVE '"$I                   ! / #00011619' TO DFHEIV0
 12507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12509     MOVE X'2F20233030303131363139' TO DFHEIV0(25:11)
 12510     CALL 'kxdfhei1' USING DFHEIV0
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514
 12515* EXEC CICS READ
 12516*        EQUAL
 12517*        DATASET   (FILE-ID-ERNOTE)
 12518*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12519*        RIDFLD    (ELCERT-KEY)
 12520*        UPDATE
 12521*    END-EXEC.
 12522*    MOVE '&"S        EU         (   #00011623' TO DFHEIV0
 12523     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12524     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12525     MOVE X'2020233030303131363233' TO DFHEIV0(25:11)
 12526     CALL 'kxdfhei1' USING DFHEIV0,
 12527           FILE-ID-ERNOTE,
 12528           DFHEIV20,
 12529           DFHEIV99,
 12530           ELCERT-KEY,
 12531           DFHEIV99,
 12532           DFHEIV99,
 12533           DFHEIV99
 12534     SET ADDRESS OF CERTIFICATE-NOTE TO
 12535         DFHEIV20
 12536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12537
 12538
 12539     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12540     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12541     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12542
 12543     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12544
 12545
 12546* EXEC CICS DELETE
 12547*        DATASET   (FILE-ID-ERNOTE)
 12548*        END-EXEC.
 12549*    MOVE '&(                    &   #00011637' TO DFHEIV0
 12550     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12552     MOVE X'2020233030303131363337' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0,
 12554           FILE-ID-ERNOTE,
 12555           DFHEIV99,
 12556           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 233
* EL6311.cbl
 12557           DFHEIV99,
 12558           DFHEIV99
 12559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12560
 12561
 12562     PERFORM 8400-LOG-JOURNAL-RECORD.
 12563
 12564******************************************************************
 12565*                                                                *
 12566*                DELETE MAILING ADDRESS RECORDS                  *
 12567*                                                                *
 12568******************************************************************
 12569
 12570 1407-DELETE-MAILING.
 12571     IF CERT-ADDRESS-PRESENT
 12572        NEXT SENTENCE
 12573     ELSE
 12574        GO TO 1420-CONTINUE-DELETE.
 12575
 12576
 12577* EXEC CICS HANDLE CONDITION
 12578*         NOTFND  (1420-CONTINUE-DELETE)
 12579*    END-EXEC.
 12580*    MOVE '"$I                   ! 0 #00011655' TO DFHEIV0
 12581     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12583     MOVE X'3020233030303131363535' TO DFHEIV0(25:11)
 12584     CALL 'kxdfhei1' USING DFHEIV0
 12585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12586
 12587
 12588
 12589* EXEC CICS READ
 12590*        EQUAL
 12591*        DATASET   (FILE-ID-ERMAIL)
 12592*        SET       (ADDRESS OF MAILING-DATA)
 12593*        RIDFLD    (ELCERT-KEY)
 12594*        UPDATE
 12595*    END-EXEC.
 12596*    MOVE '&"S        EU         (   #00011659' TO DFHEIV0
 12597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12598     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12599     MOVE X'2020233030303131363539' TO DFHEIV0(25:11)
 12600     CALL 'kxdfhei1' USING DFHEIV0,
 12601           FILE-ID-ERMAIL,
 12602           DFHEIV20,
 12603           DFHEIV99,
 12604           ELCERT-KEY,
 12605           DFHEIV99,
 12606           DFHEIV99,
 12607           DFHEIV99
 12608     SET ADDRESS OF MAILING-DATA TO
 12609         DFHEIV20
 12610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12611
 12612
 12613     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12614     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 234
* EL6311.cbl
 12615     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12616
 12617     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12618
 12619
 12620* EXEC CICS DELETE
 12621*        DATASET   (FILE-ID-ERMAIL)
 12622*    END-EXEC.
 12623*    MOVE '&(                    &   #00011673' TO DFHEIV0
 12624     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12625     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12626     MOVE X'2020233030303131363733' TO DFHEIV0(25:11)
 12627     CALL 'kxdfhei1' USING DFHEIV0,
 12628           FILE-ID-ERMAIL,
 12629           DFHEIV99,
 12630           DFHEIV99,
 12631           DFHEIV99,
 12632           DFHEIV99
 12633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12634
 12635
 12636     GO TO 1420-CONTINUE-DELETE.
 12637
 12638 1410-REWRITE-CERT.
 12639     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12640     MOVE 'C'                      TO JP-RECORD-TYPE.
 12641     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12642     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12643
 12644
 12645* EXEC CICS REWRITE
 12646*         DATASET    (FILE-ID-ELCERT)
 12647*         FROM       (CERTIFICATE-MASTER)
 12648*         END-EXEC.
 12649     MOVE LENGTH OF
 12650      CERTIFICATE-MASTER
 12651       TO DFHEIV11
 12652*    MOVE '&& L                  %   #00011685' TO DFHEIV0
 12653     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12654     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12655     MOVE X'2020233030303131363835' TO DFHEIV0(25:11)
 12656     CALL 'kxdfhei1' USING DFHEIV0,
 12657           FILE-ID-ELCERT,
 12658           CERTIFICATE-MASTER,
 12659           DFHEIV11,
 12660           DFHEIV99
 12661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12662
 12663
 12664     PERFORM 8400-LOG-JOURNAL-RECORD.
 12665
 12666 1420-CONTINUE-DELETE.
 12667     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12668     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12669
 12670     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12671     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12672
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 235
* EL6311.cbl
 12673     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12674
 12675 1450-DELETE-PB-RECORD.
 12676     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12677     MOVE 'D'                      TO JP-RECORD-TYPE
 12678     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12679
 12680
 12681* EXEC CICS DELETE
 12682*        DATASET    (FILE-ID-ERPNDB)
 12683*    END-EXEC.
 12684*    MOVE '&(                    &   #00011706' TO DFHEIV0
 12685     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12686     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12687     MOVE X'2020233030303131373036' TO DFHEIV0(25:11)
 12688     CALL 'kxdfhei1' USING DFHEIV0,
 12689           FILE-ID-ERPNDB,
 12690           DFHEIV99,
 12691           DFHEIV99,
 12692           DFHEIV99,
 12693           DFHEIV99
 12694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12695
 12696
 12697     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12698
 12699     PERFORM 8400-LOG-JOURNAL-RECORD.
 12700
 12701     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12702     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12703     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12704
 12705
 12706* EXEC CICS HANDLE CONDITION
 12707*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12708*    END-EXEC.
 12709*    MOVE '"$I                   ! 1 #00011718' TO DFHEIV0
 12710     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12712     MOVE X'3120233030303131373138' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0
 12714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12715
 12716
 12717
 12718* EXEC CICS READ
 12719*        SET     (ADDRESS OF PENDING-BUSINESS)
 12720*        DATASET (FILE-ID-ERPNDB)
 12721*        RIDFLD  (ERPNDB-KEY)
 12722*        UPDATE
 12723*    END-EXEC.
 12724*    MOVE '&"S        EU         (   #00011722' TO DFHEIV0
 12725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12727     MOVE X'2020233030303131373232' TO DFHEIV0(25:11)
 12728     CALL 'kxdfhei1' USING DFHEIV0,
 12729           FILE-ID-ERPNDB,
 12730           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 236
* EL6311.cbl
 12731           DFHEIV99,
 12732           ERPNDB-KEY,
 12733           DFHEIV99,
 12734           DFHEIV99,
 12735           DFHEIV99
 12736     SET ADDRESS OF PENDING-BUSINESS TO
 12737         DFHEIV20
 12738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12739
 12740
 12741     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12742
 12743     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12744
 12745     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12746        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12747        MOVE 'D'                   TO JP-RECORD-TYPE
 12748        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12749
 12750* EXEC CICS DELETE
 12751*            DATASET    (FILE-ID-ERPNDB)
 12752*       END-EXEC
 12753*    MOVE '&(                    &   #00011737' TO DFHEIV0
 12754     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12756     MOVE X'2020233030303131373337' TO DFHEIV0(25:11)
 12757     CALL 'kxdfhei1' USING DFHEIV0,
 12758           FILE-ID-ERPNDB,
 12759           DFHEIV99,
 12760           DFHEIV99,
 12761           DFHEIV99,
 12762           DFHEIV99
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12764        PERFORM 8400-LOG-JOURNAL-RECORD
 12765     ELSE
 12766        MOVE 'B'                 TO JP-RECORD-TYPE
 12767        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12768        PERFORM 8400-LOG-JOURNAL-RECORD
 12769        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12770        MOVE 'C'                 TO JP-RECORD-TYPE
 12771        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12772
 12773* EXEC CICS REWRITE
 12774*            DATASET    (FILE-ID-ERPNDB)
 12775*            FROM       (PENDING-BUSINESS)
 12776*       END-EXEC
 12777     MOVE LENGTH OF
 12778      PENDING-BUSINESS
 12779       TO DFHEIV11
 12780*    MOVE '&& L                  %   #00011748' TO DFHEIV0
 12781     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12782     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12783     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
 12784     CALL 'kxdfhei1' USING DFHEIV0,
 12785           FILE-ID-ERPNDB,
 12786           PENDING-BUSINESS,
 12787           DFHEIV11,
 12788           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 237
* EL6311.cbl
 12789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12790        PERFORM 8400-LOG-JOURNAL-RECORD.
 12791
 12792******************************************************************
 12793*                                                                *
 12794*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12795*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12796*                                                                *
 12797******************************************************************
 12798
 12799     IF NOT PI-AR-PROCESSING
 12800        GO TO 1475-DELETE-FINISHED.
 12801
 12802     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12803        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12804        NEXT SENTENCE
 12805     ELSE
 12806        GO TO 1475-DELETE-FINISHED.
 12807
 12808
 12809* EXEC CICS HANDLE CONDITION
 12810*         NOTFND    (1475-DELETE-FINISHED)
 12811*         END-EXEC.
 12812*    MOVE '"$I                   ! 2 #00011770' TO DFHEIV0
 12813     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12815     MOVE X'3220233030303131373730' TO DFHEIV0(25:11)
 12816     CALL 'kxdfhei1' USING DFHEIV0
 12817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12818
 12819
 12820     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12821     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12822
 12823
 12824* EXEC CICS READ
 12825*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12826*        DATASET (FILE-ID-ERRQST)
 12827*        RIDFLD  (ERRQST-KEY)
 12828*        UPDATE
 12829*    END-EXEC.
 12830*    MOVE '&"S        EU         (   #00011777' TO DFHEIV0
 12831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12832     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12833     MOVE X'2020233030303131373737' TO DFHEIV0(25:11)
 12834     CALL 'kxdfhei1' USING DFHEIV0,
 12835           FILE-ID-ERRQST,
 12836           DFHEIV20,
 12837           DFHEIV99,
 12838           ERRQST-KEY,
 12839           DFHEIV99,
 12840           DFHEIV99,
 12841           DFHEIV99
 12842     SET ADDRESS OF AR-REQUEST-RECORD TO
 12843         DFHEIV20
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 238
* EL6311.cbl
 12847     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12848
 12849     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12850
 12851     MOVE 'D'                      TO JP-RECORD-TYPE.
 12852     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12853
 12854
 12855* EXEC CICS DELETE
 12856*         DATASET    (FILE-ID-ERRQST)
 12857*    END-EXEC.
 12858*    MOVE '&(                    &   #00011791' TO DFHEIV0
 12859     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12861     MOVE X'2020233030303131373931' TO DFHEIV0(25:11)
 12862     CALL 'kxdfhei1' USING DFHEIV0,
 12863           FILE-ID-ERRQST,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99,
 12867           DFHEIV99
 12868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12869
 12870
 12871     PERFORM 8400-LOG-JOURNAL-RECORD.
 12872
 12873 1475-DELETE-FINISHED.
 12874     MOVE ZEROS                  TO EMI-ERROR.
 12875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12876     MOVE LOW-VALUES             TO EL631BI.
 12877     MOVE -1                     TO BMAINTL.
 12878     GO TO 8100-SEND-INITIAL-MAP.
 12879
 12880 1480-BATCH-HDR-NOT-FOUND.
 12881     MOVE -1                     TO BMAINTL.
 12882     MOVE ER-7450                TO EMI-ERROR.
 12883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12884     GO TO 8200-SEND-DATAONLY.
 12885
 12886 1490-RECORD-NOT-FOUND.
 12887     MOVE -1                     TO BMAINTL.
 12888     MOVE ER-7451                TO EMI-ERROR.
 12889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12890     GO TO 8200-SEND-DATAONLY.
 12891
 12892******************************************************************
 12893*            O V E R   C H A R G E   P R O C E S S I N G         *
 12894******************************************************************
 12895 1500-UPDATE-ERNOTE.
 12896     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12897     MOVE 'A'                    TO WS-NOTE-SW
 12898     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12899     .
 12900 1500-EXIT.
 12901     EXIT.
 12902 1510-ADD-ERNOTE-REC.
 12903
 12904* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 239
* EL6311.cbl
 12905*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12906*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12907*        INITIMG (GETMAIN-SPACE)
 12908*    END-EXEC
 12909*    MOVE ',"IL                  $   #00011827' TO DFHEIV0
 12910     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12912     MOVE X'2020233030303131383237' TO DFHEIV0(25:11)
 12913     CALL 'kxdfhei1' USING DFHEIV0,
 12914           DFHEIV20,
 12915           ERNOTE-RECORD-LENGTH,
 12916           GETMAIN-SPACE
 12917     SET ADDRESS OF CERTIFICATE-NOTE TO
 12918         DFHEIV20
 12919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12920     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12921                                 TO ERNOTE-KEY
 12922
 12923* EXEC CICS READ
 12924*       DATASET    (FILE-ID-ERNOTE)
 12925*       RIDFLD     (ERNOTE-KEY)
 12926*       INTO       (CERTIFICATE-NOTE)
 12927*       RESP       (WS-RESPONSE)
 12928*       UPDATE
 12929*    END-EXEC
 12930     MOVE LENGTH OF
 12931      CERTIFICATE-NOTE
 12932       TO DFHEIV11
 12933*    MOVE '&"IL       EU         (  N#00011834' TO DFHEIV0
 12934     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12935     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12936     MOVE X'204E233030303131383334' TO DFHEIV0(25:11)
 12937     CALL 'kxdfhei1' USING DFHEIV0,
 12938           FILE-ID-ERNOTE,
 12939           CERTIFICATE-NOTE,
 12940           DFHEIV11,
 12941           ERNOTE-KEY,
 12942           DFHEIV99,
 12943           DFHEIV99,
 12944           DFHEIV99
 12945     MOVE EIBRESP  TO WS-RESPONSE
 12946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12947     IF RESP-NORMAL
 12948        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12949           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12950        END-IF
 12951        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12952           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12953        END-IF
 12954        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 12955           (N1 > +10)
 12956           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12957           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12958        END-PERFORM
 12959        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12960          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12961
 12962* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 240
* EL6311.cbl
 12963*            DATASET    (FILE-ID-ERNOTE)
 12964*          END-EXEC
 12965*    MOVE '&*                    #   #00011855' TO DFHEIV0
 12966     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12967     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12968     MOVE X'2020233030303131383535' TO DFHEIV0(25:11)
 12969     CALL 'kxdfhei1' USING DFHEIV0,
 12970           FILE-ID-ERNOTE,
 12971           DFHEIV99
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12973        ELSE
 12974          PERFORM VARYING N1 FROM +1 BY +1
 12975           UNTIL (N1 > +10)
 12976           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 12977          END-PERFORM
 12978          IF (N1 < +11)
 12979            IF N1 >= CN-BILLING-START-LINE-NO AND
 12980              N1 <= CN-BILLING-END-LINE-NO
 12981              IF PI-COMPANY-ID = 'DCC'
 12982                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12983              ELSE
 12984                 MOVE WS-VA-NO-COMM-MESS
 12985                                    TO CN-LINE (N1)
 12986              END-IF
 12987            ELSE
 12988              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12989               (N1 = (CN-BILLING-END-LINE-NO + +1))
 12990                IF PI-COMPANY-ID = 'DCC'
 12991                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12992                ELSE
 12993                  MOVE WS-VA-NO-COMM-MESS
 12994                                    TO CN-LINE (N1)
 12995                END-IF
 12996                MOVE N1             TO CN-BILLING-END-LINE-NO
 12997              ELSE
 12998                IF (CN-BILLING-END-LINE-NO = ZEROS)
 12999                  IF PI-COMPANY-ID = 'DCC'
 13000                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13001                  ELSE
 13002                     MOVE WS-VA-NO-COMM-MESS
 13003                                    TO CN-LINE (N1)
 13004                  END-IF
 13005                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13006                                      CN-BILLING-START-LINE-NO
 13007                ELSE
 13008                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13009                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13010                     IF PI-COMPANY-ID = 'DCC'
 13011                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13012                     ELSE
 13013                       MOVE WS-VA-NO-COMM-MESS
 13014                                    TO CN-LINE (N1)
 13015                     END-IF
 13016                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13017                  ELSE
 13018                     PERFORM 1700-SQUEEZE-IT-IN
 13019                                 THRU 1700-EXIT
 13020                  END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 241
* EL6311.cbl
 13021                END-IF
 13022              END-IF
 13023            END-IF
 13024            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13025            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13026            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13027
 13028* EXEC CICS REWRITE
 13029*              DATASET    (FILE-ID-ERNOTE)
 13030*              FROM       (CERTIFICATE-NOTE)
 13031*              RESP       (WS-RESPONSE)
 13032*           END-EXEC
 13033     MOVE LENGTH OF
 13034      CERTIFICATE-NOTE
 13035       TO DFHEIV11
 13036*    MOVE '&& L                  %  N#00011912' TO DFHEIV0
 13037     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13038     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13039     MOVE X'204E233030303131393132' TO DFHEIV0(25:11)
 13040     CALL 'kxdfhei1' USING DFHEIV0,
 13041           FILE-ID-ERNOTE,
 13042           CERTIFICATE-NOTE,
 13043           DFHEIV11,
 13044           DFHEIV99
 13045     MOVE EIBRESP  TO WS-RESPONSE
 13046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13047          END-IF
 13048        END-IF
 13049     ELSE
 13050        MOVE SPACES              TO CERTIFICATE-NOTE
 13051        MOVE 'CN'                TO CN-RECORD-ID
 13052        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13053                                 TO CN-CONTROL-PRIMARY
 13054                                    ERNOTE-KEY
 13055        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13056                                    CN-BILLING-END-LINE-NO
 13057        IF PI-COMPANY-ID = 'DCC'
 13058           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13059        ELSE
 13060           MOVE WS-VA-NO-COMM-MESS
 13061                                 TO CN-LINE (1)
 13062        END-IF
 13063        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13064        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13065        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13066
 13067* EXEC CICS WRITE
 13068*          DATASET    (FILE-ID-ERNOTE)
 13069*          FROM       (CERTIFICATE-NOTE)
 13070*          RIDFLD     (ERNOTE-KEY)
 13071*          RESP       (WS-RESPONSE)
 13072*       END-EXEC
 13073     MOVE LENGTH OF
 13074      CERTIFICATE-NOTE
 13075       TO DFHEIV11
 13076*    MOVE '&$ L                  ''  N#00011936' TO DFHEIV0
 13077     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 242
* EL6311.cbl
 13079     MOVE X'204E233030303131393336' TO DFHEIV0(25:11)
 13080     CALL 'kxdfhei1' USING DFHEIV0,
 13081           FILE-ID-ERNOTE,
 13082           CERTIFICATE-NOTE,
 13083           DFHEIV11,
 13084           ERNOTE-KEY,
 13085           DFHEIV99,
 13086           DFHEIV99
 13087     MOVE EIBRESP  TO WS-RESPONSE
 13088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13089     END-IF
 13090     .
 13091 1510-EXIT.
 13092     EXIT.
 13093 1520-UPDATE-ELCERT.
 13094     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13095                                 TO ELCERT-KEY
 13096
 13097* EXEC CICS READ
 13098*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13099*        DATASET (FILE-ID-ELCERT)
 13100*        RIDFLD  (ELCERT-KEY)
 13101*        UPDATE
 13102*        RESP    (WS-RESPONSE)
 13103*    END-EXEC
 13104*    MOVE '&"S        EU         (  N#00011949' TO DFHEIV0
 13105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13106     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13107     MOVE X'204E233030303131393439' TO DFHEIV0(25:11)
 13108     CALL 'kxdfhei1' USING DFHEIV0,
 13109           FILE-ID-ELCERT,
 13110           DFHEIV20,
 13111           DFHEIV99,
 13112           ELCERT-KEY,
 13113           DFHEIV99,
 13114           DFHEIV99,
 13115           DFHEIV99
 13116     SET ADDRESS OF CERTIFICATE-MASTER TO
 13117         DFHEIV20
 13118     MOVE EIBRESP  TO WS-RESPONSE
 13119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13120     IF RESP-NORMAL
 13121        IF WS-NOTE-SW = 'A'
 13122           IF CM-NOTE-SW = ' '
 13123              MOVE '2'             TO CM-NOTE-SW
 13124           ELSE
 13125             IF CM-NOTE-SW = '1'
 13126                MOVE '3'           TO CM-NOTE-SW
 13127             ELSE
 13128               IF CM-NOTE-SW = '4'
 13129                  MOVE '6'         TO CM-NOTE-SW
 13130               ELSE
 13131                 IF CM-NOTE-SW = '5'
 13132                    MOVE '7'       TO CM-NOTE-SW
 13133                 END-IF
 13134               END-IF
 13135             END-IF
 13136           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 243
* EL6311.cbl
 13137        ELSE
 13138           IF CM-NOTE-SW = '2'
 13139              MOVE ' '             TO CM-NOTE-SW
 13140           ELSE
 13141             IF CM-NOTE-SW = '3'
 13142                MOVE '1'           TO CM-NOTE-SW
 13143             ELSE
 13144               IF CM-NOTE-SW = '6'
 13145                  MOVE '4'         TO CM-NOTE-SW
 13146               ELSE
 13147                 IF CM-NOTE-SW = '7'
 13148                    MOVE '5'       TO CM-NOTE-SW
 13149                 END-IF
 13150               END-IF
 13151             END-IF
 13152           END-IF
 13153        END-IF
 13154
 13155* EXEC CICS REWRITE
 13156*          DATASET    (FILE-ID-ELCERT)
 13157*          FROM       (CERTIFICATE-MASTER)
 13158*          RESP       (WS-RESPONSE)
 13159*       END-EXEC
 13160     MOVE LENGTH OF
 13161      CERTIFICATE-MASTER
 13162       TO DFHEIV11
 13163*    MOVE '&& L                  %  N#00011990' TO DFHEIV0
 13164     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13165     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13166     MOVE X'204E233030303131393930' TO DFHEIV0(25:11)
 13167     CALL 'kxdfhei1' USING DFHEIV0,
 13168           FILE-ID-ELCERT,
 13169           CERTIFICATE-MASTER,
 13170           DFHEIV11,
 13171           DFHEIV99
 13172     MOVE EIBRESP  TO WS-RESPONSE
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13174        IF RESP-NORMAL
 13175           CONTINUE
 13176        ELSE
 13177           MOVE WS-RESPONSE TO EMI-ERROR
 13178           PERFORM 9900-ERROR-FORMAT
 13179                                 THRU 9900-EXIT
 13180           GO TO 8200-SEND-DATAONLY
 13181        END-IF
 13182     ELSE
 13183        MOVE -1                  TO BMAINTL
 13184        MOVE 0249                TO EMI-ERROR
 13185        PERFORM 9900-ERROR-FORMAT
 13186                                 THRU 9900-EXIT
 13187        GO TO 8200-SEND-DATAONLY
 13188     END-IF
 13189     .
 13190 1520-EXIT.
 13191     EXIT.
 13192 1600-UPDATE-ERPYAJ.
 13193     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13194                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 244
* EL6311.cbl
 13195     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13196                                 THRU 1620-EXIT
 13197     .
 13198 1600-EXIT.
 13199     EXIT.
 13200 1610-ADD-ERPYAJ-BANK-REC.
 13201
 13202* EXEC CICS GETMAIN
 13203*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13204*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13205*        INITIMG (GETMAIN-SPACE)
 13206*    END-EXEC
 13207*    MOVE ',"IL                  $   #00012022' TO DFHEIV0
 13208     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13210     MOVE X'2020233030303132303232' TO DFHEIV0(25:11)
 13211     CALL 'kxdfhei1' USING DFHEIV0,
 13212           DFHEIV20,
 13213           ERPYAJ-RECORD-LENGTH,
 13214           GETMAIN-SPACE
 13215     SET ADDRESS OF PENDING-PAY-ADJ TO
 13216         DFHEIV20
 13217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13218     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13219     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13220     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13221     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13222     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13223     MOVE +10                    TO ERPYAJ-SEQ-NO
 13224     MOVE 'R'                    TO ERPYAJ-TYPE
 13225     IF REVERSAL
 13226        MOVE 'C'                 TO ERPYAJ-TYPE
 13227     END-IF
 13228     MOVE SPACES                 TO PENDING-PAY-ADJ
 13229     MOVE 'PY'                   TO PY-RECORD-ID
 13230     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13231     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13232     IF REVERSAL
 13233        MOVE PB-I-DCC-OVER-CHG-AMT
 13234                                 TO PY-ENTRY-AMT
 13235     END-IF
 13236     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13237                                    PY-INPUT-DT
 13238*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13239*                                   PY-INPUT-DT
 13240     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13241     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13242     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13243     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13244     IF PB-CARRIER = '2'
 13245        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13246     ELSE
 13247        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13248     END-IF
 13249     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13250                                    PY-BILLED-DATE
 13251                                    PY-AR-DATE
 13252                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 245
* EL6311.cbl
 13253                                    PY-CHECK-WRITTEN-DT
 13254     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13255                                    PY-CHECK-QUE-SEQUENCE
 13256     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13257     PERFORM WITH TEST AFTER
 13258        UNTIL (NOT RESP-DUPKEY)
 13259           AND (NOT RESP-DUPREC)
 13260
 13261* EXEC CICS WRITE
 13262*          DATASET    (FILE-ID-ERPYAJ)
 13263*          FROM       (PENDING-PAY-ADJ)
 13264*          RIDFLD     (ERPYAJ-KEY)
 13265*          RESP       (WS-RESPONSE)
 13266*       END-EXEC
 13267     MOVE LENGTH OF
 13268      PENDING-PAY-ADJ
 13269       TO DFHEIV11
 13270*    MOVE '&$ L                  ''  N#00012069' TO DFHEIV0
 13271     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13273     MOVE X'204E233030303132303639' TO DFHEIV0(25:11)
 13274     CALL 'kxdfhei1' USING DFHEIV0,
 13275           FILE-ID-ERPYAJ,
 13276           PENDING-PAY-ADJ,
 13277           DFHEIV11,
 13278           ERPYAJ-KEY,
 13279           DFHEIV99,
 13280           DFHEIV99
 13281     MOVE EIBRESP  TO WS-RESPONSE
 13282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13283        IF RESP-DUPKEY OR RESP-DUPREC
 13284           ADD +1                TO ERPYAJ-SEQ-NO
 13285           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13286        END-IF
 13287     END-PERFORM
 13288     .
 13289 1610-EXIT.
 13290     EXIT.
 13291 1620-ADD-ERPYAJ-DLR-REC.
 13292     MOVE 'C'                    TO ERPYAJ-TYPE
 13293     IF REVERSAL
 13294        MOVE 'R'                 TO ERPYAJ-TYPE
 13295     END-IF
 13296     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13297                                    ERPYAJ-ACCOUNT
 13298     ADD +1                      TO ERPYAJ-SEQ-NO
 13299     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13300     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13301     IF PB-CARRIER = '2'
 13302        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13303     ELSE
 13304        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13305     END-IF
 13306     PERFORM WITH TEST AFTER
 13307        UNTIL (NOT RESP-DUPKEY)
 13308           AND (NOT RESP-DUPREC)
 13309
 13310* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 246
* EL6311.cbl
 13311*          DATASET    (FILE-ID-ERPYAJ)
 13312*          FROM       (PENDING-PAY-ADJ)
 13313*          RIDFLD     (ERPYAJ-KEY)
 13314*          RESP       (WS-RESPONSE)
 13315*       END-EXEC
 13316     MOVE LENGTH OF
 13317      PENDING-PAY-ADJ
 13318       TO DFHEIV11
 13319*    MOVE '&$ L                  ''  N#00012101' TO DFHEIV0
 13320     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13321     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13322     MOVE X'204E233030303132313031' TO DFHEIV0(25:11)
 13323     CALL 'kxdfhei1' USING DFHEIV0,
 13324           FILE-ID-ERPYAJ,
 13325           PENDING-PAY-ADJ,
 13326           DFHEIV11,
 13327           ERPYAJ-KEY,
 13328           DFHEIV99,
 13329           DFHEIV99
 13330     MOVE EIBRESP  TO WS-RESPONSE
 13331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13332        IF RESP-DUPKEY OR RESP-DUPREC
 13333           ADD +1                TO ERPYAJ-SEQ-NO
 13334           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13335        END-IF
 13336     END-PERFORM
 13337     .
 13338 1620-EXIT.
 13339     EXIT.
 13340 1700-SQUEEZE-IT-IN.
 13341     IF (N1 > CN-BILLING-END-LINE-NO)
 13342        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13343           N1 = +1
 13344           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13345           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13346              IF PI-COMPANY-ID = 'DCC'
 13347                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13348              ELSE
 13349                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13350              END-IF
 13351              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13352              MOVE +2 TO N1
 13353           END-IF
 13354        END-PERFORM
 13355     ELSE
 13356        IF (N1 < CN-BILLING-START-LINE-NO)
 13357           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13358              N1 = +10
 13359              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13360              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13361                 IF PI-COMPANY-ID = 'DCC'
 13362                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13363                 ELSE
 13364                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13365                 END-IF
 13366                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13367                 MOVE +9 TO N1
 13368              END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 247
* EL6311.cbl
 13369           END-PERFORM
 13370        END-IF
 13371     END-IF
 13372     .
 13373 1700-EXIT.
 13374     EXIT.
 13375 1800-REMOVE-CERT-NOTES.
 13376     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13377                                 TO ERNOTE-KEY
 13378
 13379* EXEC CICS READ
 13380*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13381*       DATASET    (FILE-ID-ERNOTE)
 13382*       RIDFLD     (ERNOTE-KEY)
 13383*       RESP       (WS-RESPONSE)
 13384*       UPDATE
 13385*    END-EXEC
 13386*    MOVE '&"S        EU         (  N#00012153' TO DFHEIV0
 13387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13388     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13389     MOVE X'204E233030303132313533' TO DFHEIV0(25:11)
 13390     CALL 'kxdfhei1' USING DFHEIV0,
 13391           FILE-ID-ERNOTE,
 13392           DFHEIV20,
 13393           DFHEIV99,
 13394           ERNOTE-KEY,
 13395           DFHEIV99,
 13396           DFHEIV99,
 13397           DFHEIV99
 13398     SET ADDRESS OF CERTIFICATE-NOTE TO
 13399         DFHEIV20
 13400     MOVE EIBRESP  TO WS-RESPONSE
 13401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13402     IF RESP-NORMAL
 13403        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13404           (N1 > +10)
 13405           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13406           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13407        END-PERFORM
 13408        IF N1 < +11
 13409           MOVE SPACES              TO CN-LINE (N1)
 13410           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13411              N1 <= CN-BILLING-END-LINE-NO
 13412              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13413              IF CN-BILLING-END-LINE-NO <
 13414                               CN-BILLING-START-LINE-NO
 13415                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13416                                     CN-BILLING-START-LINE-NO
 13417              END-IF
 13418              PERFORM 1820-SQUEEZE-ERNOTE
 13419                                  THRU 1820-EXIT
 13420           END-IF
 13421           IF CN-LINES = SPACES
 13422
 13423* EXEC CICS DELETE
 13424*                DATASET    (FILE-ID-ERNOTE)
 13425*                RESP       (WS-RESPONSE)
 13426*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 248
* EL6311.cbl
 13427*    MOVE '&(                    &  N#00012180' TO DFHEIV0
 13428     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13430     MOVE X'204E233030303132313830' TO DFHEIV0(25:11)
 13431     CALL 'kxdfhei1' USING DFHEIV0,
 13432           FILE-ID-ERNOTE,
 13433           DFHEIV99,
 13434           DFHEIV99,
 13435           DFHEIV99,
 13436           DFHEIV99
 13437     MOVE EIBRESP  TO WS-RESPONSE
 13438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13439              IF RESP-NORMAL
 13440                 MOVE 'D'        TO WS-NOTE-SW
 13441                 PERFORM 1520-UPDATE-ELCERT
 13442                                 THRU 1520-EXIT
 13443              END-IF
 13444           ELSE
 13445
 13446* EXEC CICS REWRITE
 13447*                DATASET    (FILE-ID-ERNOTE)
 13448*                FROM       (CERTIFICATE-NOTE)
 13449*                RESP       (WS-RESPONSE)
 13450*             END-EXEC
 13451     MOVE LENGTH OF
 13452      CERTIFICATE-NOTE
 13453       TO DFHEIV11
 13454*    MOVE '&& L                  %  N#00012190' TO DFHEIV0
 13455     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13456     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13457     MOVE X'204E233030303132313930' TO DFHEIV0(25:11)
 13458     CALL 'kxdfhei1' USING DFHEIV0,
 13459           FILE-ID-ERNOTE,
 13460           CERTIFICATE-NOTE,
 13461           DFHEIV11,
 13462           DFHEIV99
 13463     MOVE EIBRESP  TO WS-RESPONSE
 13464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13465           END-IF
 13466        END-IF
 13467     END-IF
 13468     .
 13469 1800-EXIT.
 13470     EXIT.
 13471 1820-SQUEEZE-ERNOTE.
 13472     MOVE CN-BILLING-START-LINE-NO TO N2
 13473     IF N2 = 0
 13474         MOVE +1                 TO N2
 13475     END-IF
 13476     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13477        (N1 > +9)
 13478        IF CN-LINE (N1) = SPACES
 13479           MOVE CN-LINE (N1 + +1)
 13480                                 TO CN-LINE (N1)
 13481           MOVE SPACES           TO CN-LINE (N1 + +1)
 13482        END-IF
 13483     END-PERFORM
 13484     .
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 249
* EL6311.cbl
 13485 1820-EXIT.
 13486     EXIT.
 13487 1900-DELETE-ERPYAJ.
 13488     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13489     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13490     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13491     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13492     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13493     MOVE +10                    TO ERPYAJ-SEQ-NO
 13494     MOVE 'R'                    TO ERPYAJ-TYPE
 13495     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13496
 13497* EXEC CICS STARTBR
 13498*       DATASET    (FILE-ID-ERPYAJ)
 13499*       RIDFLD     (ERPYAJ-KEY)
 13500*       RESP       (WS-RESPONSE)
 13501*    END-EXEC
 13502     MOVE 0
 13503       TO DFHEIV11
 13504*    MOVE '&,         G          &  N#00012226' TO DFHEIV0
 13505     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13507     MOVE X'204E233030303132323236' TO DFHEIV0(25:11)
 13508     CALL 'kxdfhei1' USING DFHEIV0,
 13509           FILE-ID-ERPYAJ,
 13510           ERPYAJ-KEY,
 13511           DFHEIV99,
 13512           DFHEIV11,
 13513           DFHEIV99
 13514     MOVE EIBRESP  TO WS-RESPONSE
 13515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13516     IF RESP-NORMAL
 13517        CONTINUE
 13518     ELSE
 13519        GO TO 1900-GET-DEALER
 13520     END-IF
 13521     .
 13522 1900-READNEXT-ERPYAJ-B.
 13523*  GET THE BANK ERPYAJ RECORD
 13524
 13525* EXEC CICS READNEXT
 13526*       DATASET    (FILE-ID-ERPYAJ)
 13527*       RIDFLD     (ERPYAJ-KEY)
 13528*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13529*       RESP       (WS-RESPONSE)
 13530*    END-EXEC
 13531     MOVE 0
 13532       TO DFHEIV11
 13533*    MOVE '&.S                   )  N#00012239' TO DFHEIV0
 13534     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13535     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13536     MOVE X'204E233030303132323339' TO DFHEIV0(25:11)
 13537     CALL 'kxdfhei1' USING DFHEIV0,
 13538           FILE-ID-ERPYAJ,
 13539           DFHEIV20,
 13540           DFHEIV99,
 13541           ERPYAJ-KEY,
 13542           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 250
* EL6311.cbl
 13543           DFHEIV11,
 13544           DFHEIV99,
 13545           DFHEIV99
 13546     SET ADDRESS OF PENDING-PAY-ADJ TO
 13547         DFHEIV20
 13548     MOVE EIBRESP  TO WS-RESPONSE
 13549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13550     IF RESP-NORMAL
 13551        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13552           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13553              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13554                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13555
 13556* EXEC CICS READ
 13557*                   DATASET    (FILE-ID-ERPYAJ)
 13558*                   RIDFLD     (ERPYAJ-KEY)
 13559*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13560*                   RESP       (WS-RESPONSE)
 13561*                   UPDATE
 13562*                END-EXEC
 13563*    MOVE '&"S        EU         (  N#00012250' TO DFHEIV0
 13564     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13565     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13566     MOVE X'204E233030303132323530' TO DFHEIV0(25:11)
 13567     CALL 'kxdfhei1' USING DFHEIV0,
 13568           FILE-ID-ERPYAJ,
 13569           DFHEIV20,
 13570           DFHEIV99,
 13571           ERPYAJ-KEY,
 13572           DFHEIV99,
 13573           DFHEIV99,
 13574           DFHEIV99
 13575     SET ADDRESS OF PENDING-PAY-ADJ TO
 13576         DFHEIV20
 13577     MOVE EIBRESP  TO WS-RESPONSE
 13578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13579                 IF RESP-NORMAL
 13580
 13581* EXEC CICS DELETE
 13582*                      DATASET   (FILE-ID-ERPYAJ)
 13583*                      RESP      (WS-RESPONSE)
 13584*                   END-EXEC
 13585*    MOVE '&(                    &  N#00012258' TO DFHEIV0
 13586     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13587     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13588     MOVE X'204E233030303132323538' TO DFHEIV0(25:11)
 13589     CALL 'kxdfhei1' USING DFHEIV0,
 13590           FILE-ID-ERPYAJ,
 13591           DFHEIV99,
 13592           DFHEIV99,
 13593           DFHEIV99,
 13594           DFHEIV99
 13595     MOVE EIBRESP  TO WS-RESPONSE
 13596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13597                 END-IF
 13598              ELSE
 13599                 SET REVERSAL    TO TRUE
 13600                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 251
* EL6311.cbl
 13601                                 THRU 1600-EXIT
 13602                 GO TO 1900-EXIT
 13603              END-IF
 13604           ELSE
 13605              GO TO 1900-READNEXT-ERPYAJ-B
 13606           END-IF
 13607        END-IF
 13608
 13609* EXEC CICS ENDBR
 13610*          DATASET   (FILE-ID-ERPYAJ)
 13611*       END-EXEC
 13612     MOVE 0
 13613       TO DFHEIV11
 13614*    MOVE '&2                    $   #00012273' TO DFHEIV0
 13615     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13617     MOVE X'2020233030303132323733' TO DFHEIV0(25:11)
 13618     CALL 'kxdfhei1' USING DFHEIV0,
 13619           FILE-ID-ERPYAJ,
 13620           DFHEIV11,
 13621           DFHEIV99
 13622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13623     END-IF
 13624     .
 13625 1900-GET-DEALER.
 13626     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13627     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13628     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13629     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13630     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13631     MOVE +10                    TO ERPYAJ-SEQ-NO
 13632     MOVE 'C'                    TO ERPYAJ-TYPE
 13633     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13634
 13635* EXEC CICS STARTBR
 13636*       DATASET    (FILE-ID-ERPYAJ)
 13637*       RIDFLD     (ERPYAJ-KEY)
 13638*       RESP       (WS-RESPONSE)
 13639*    END-EXEC
 13640     MOVE 0
 13641       TO DFHEIV11
 13642*    MOVE '&,         G          &  N#00012287' TO DFHEIV0
 13643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13645     MOVE X'204E233030303132323837' TO DFHEIV0(25:11)
 13646     CALL 'kxdfhei1' USING DFHEIV0,
 13647           FILE-ID-ERPYAJ,
 13648           ERPYAJ-KEY,
 13649           DFHEIV99,
 13650           DFHEIV11,
 13651           DFHEIV99
 13652     MOVE EIBRESP  TO WS-RESPONSE
 13653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13654     IF RESP-NORMAL
 13655        CONTINUE
 13656     ELSE
 13657        GO TO 1900-EXIT
 13658     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 252
* EL6311.cbl
 13659     .
 13660 1900-READNEXT-ERPYAJ-D.
 13661*  GET THE DEALER ERPYAJ RECORD
 13662
 13663* EXEC CICS READNEXT
 13664*       DATASET    (FILE-ID-ERPYAJ)
 13665*       RIDFLD     (ERPYAJ-KEY)
 13666*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13667*       RESP       (WS-RESPONSE)
 13668*    END-EXEC
 13669     MOVE 0
 13670       TO DFHEIV11
 13671*    MOVE '&.S                   )  N#00012300' TO DFHEIV0
 13672     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13674     MOVE X'204E233030303132333030' TO DFHEIV0(25:11)
 13675     CALL 'kxdfhei1' USING DFHEIV0,
 13676           FILE-ID-ERPYAJ,
 13677           DFHEIV20,
 13678           DFHEIV99,
 13679           ERPYAJ-KEY,
 13680           DFHEIV99,
 13681           DFHEIV11,
 13682           DFHEIV99,
 13683           DFHEIV99
 13684     SET ADDRESS OF PENDING-PAY-ADJ TO
 13685         DFHEIV20
 13686     MOVE EIBRESP  TO WS-RESPONSE
 13687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13688     IF RESP-NORMAL
 13689        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13690           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13691              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13692                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13693
 13694* EXEC CICS READ
 13695*                   DATASET    (FILE-ID-ERPYAJ)
 13696*                   RIDFLD     (ERPYAJ-KEY)
 13697*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13698*                   RESP       (WS-RESPONSE)
 13699*                   UPDATE
 13700*                END-EXEC
 13701*    MOVE '&"S        EU         (  N#00012311' TO DFHEIV0
 13702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13703     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13704     MOVE X'204E233030303132333131' TO DFHEIV0(25:11)
 13705     CALL 'kxdfhei1' USING DFHEIV0,
 13706           FILE-ID-ERPYAJ,
 13707           DFHEIV20,
 13708           DFHEIV99,
 13709           ERPYAJ-KEY,
 13710           DFHEIV99,
 13711           DFHEIV99,
 13712           DFHEIV99
 13713     SET ADDRESS OF PENDING-PAY-ADJ TO
 13714         DFHEIV20
 13715     MOVE EIBRESP  TO WS-RESPONSE
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 253
* EL6311.cbl
 13717                 IF RESP-NORMAL
 13718
 13719* EXEC CICS DELETE
 13720*                      DATASET   (FILE-ID-ERPYAJ)
 13721*                      RESP      (WS-RESPONSE)
 13722*                   END-EXEC
 13723*    MOVE '&(                    &  N#00012319' TO DFHEIV0
 13724     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13725     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13726     MOVE X'204E233030303132333139' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           FILE-ID-ERPYAJ,
 13729           DFHEIV99,
 13730           DFHEIV99,
 13731           DFHEIV99,
 13732           DFHEIV99
 13733     MOVE EIBRESP  TO WS-RESPONSE
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13735                 END-IF
 13736              ELSE
 13737                 SET REVERSAL    TO TRUE
 13738              END-IF
 13739           ELSE
 13740              GO TO 1900-READNEXT-ERPYAJ-D
 13741           END-IF
 13742        END-IF
 13743
 13744* EXEC CICS ENDBR
 13745*          DATASET   (FILE-ID-ERPYAJ)
 13746*       END-EXEC
 13747     MOVE 0
 13748       TO DFHEIV11
 13749*    MOVE '&2                    $   #00012331' TO DFHEIV0
 13750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13752     MOVE X'2020233030303132333331' TO DFHEIV0(25:11)
 13753     CALL 'kxdfhei1' USING DFHEIV0,
 13754           FILE-ID-ERPYAJ,
 13755           DFHEIV11,
 13756           DFHEIV99
 13757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13758     END-IF
 13759     .
 13760 1900-EXIT.
 13761     EXIT.
 13762******************************************************************
 13763*            C A N C E L   M A I N L I N E                       *
 13764******************************************************************
 13765
 13766 2000-CANCEL-MAINLINE.
 13767     IF PI-DISPLAY-ORIGINAL-BATCH
 13768        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13769           MOVE ER-0023             TO EMI-ERROR
 13770           MOVE -1                  TO CMAINTL
 13771           MOVE AL-UABON            TO CMAINTA
 13772           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13773           GO TO 8200-SEND-DATAONLY
 13774        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 254
* EL6311.cbl
 13775           NEXT SENTENCE
 13776     ELSE
 13777        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13778           MOVE ER-0023             TO EMI-ERROR
 13779           MOVE -1                  TO CMAINTL
 13780           MOVE AL-UABON            TO CMAINTA
 13781           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13782           GO TO 8200-SEND-DATAONLY.
 13783
 13784     IF CMAINTI = 'S'
 13785        GO TO 2100-SHOW-REQUEST.
 13786
 13787     IF NOT MODIFY-CAP
 13788         MOVE 'UPDATE'       TO SM-READ
 13789         PERFORM 9995-SECURITY-VIOLATION
 13790         MOVE ER-0070        TO EMI-ERROR
 13791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13792         GO TO 8100-SEND-INITIAL-MAP.
 13793
 13794     IF CMAINTL GREATER THAN ZEROS
 13795        IF PI-PF6-FUNCTION
 13796           IF CMAINTI NOT = 'A'
 13797              MOVE AL-UABON  TO CMAINTA
 13798              MOVE -1        TO CMAINTL
 13799              MOVE ER-2260   TO EMI-ERROR
 13800              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13801              GO TO 8200-SEND-DATAONLY.
 13802
 13803     IF CCERTNOL = ZEROS
 13804       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13805         NEXT SENTENCE
 13806     ELSE
 13807         IF CCERTNOL NOT = ZEROS
 13808             MOVE AL-UANON       TO CCERTNOA
 13809         ELSE
 13810             MOVE -1             TO CCERTNOL
 13811             MOVE  1             TO SET-CURSOR-SW
 13812             MOVE ER-2218       TO EMI-ERROR
 13813             MOVE AL-UABON       TO CCERTNOA
 13814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13815
 13816     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13817        NEXT SENTENCE
 13818     ELSE
 13819        IF CEFFDTL NOT = ZEROS
 13820           MOVE AL-UNNON         TO CEFFDTA
 13821           MOVE CEFFDTI TO DEEDIT-FIELD
 13822           PERFORM 8600-DEEDIT
 13823           MOVE 4                TO DC-OPTION-CODE
 13824           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13825           PERFORM 9700-DATE-LINK
 13826           IF NO-CONVERSION-ERROR
 13827              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13828              ELSE
 13829              MOVE -1            TO CEFFDTL
 13830              MOVE  1            TO SET-CURSOR-SW
 13831              MOVE ER-2226      TO EMI-ERROR
 13832              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 255
* EL6311.cbl
 13833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13834          ELSE
 13835          MOVE -1                 TO CEFFDTL
 13836          MOVE  1                 TO SET-CURSOR-SW
 13837          MOVE ER-2220            TO EMI-ERROR
 13838          MOVE AL-UNBON           TO CEFFDTA
 13839          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13840
 13841     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13842
 13843     IF CCERTNOL NOT = ZEROS
 13844        MOVE CCERTNOI                TO WS-NEW-PRIME
 13845     ELSE
 13846        MOVE SPACES                  TO WS-NEW-PRIME.
 13847
 13848     IF CSUFIXL NOT = ZEROS
 13849        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13850     ELSE
 13851        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13852
 13853     IF CEFFDTL NOT = ZEROS
 13854        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13855     ELSE
 13856        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13857
 13858     IF CMAINTI = 'A' OR 'K' OR 'S'
 13859        NEXT SENTENCE
 13860     ELSE
 13861        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13862        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13863           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13864           WS-PB-RECORD-TYPE NOT = '2'
 13865           IF CMAINTI = 'C'
 13866              MOVE ER-2287          TO EMI-ERROR
 13867              MOVE -1               TO CCERTNOL
 13868              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13870              GO TO 8200-SEND-DATAONLY
 13871             ELSE
 13872              MOVE ER-2260          TO EMI-ERROR
 13873              MOVE -1               TO CCERTNOL
 13874              MOVE AL-UABON         TO CCERTNOA
 13875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13876              GO TO 8200-SEND-DATAONLY.
 13877
 13878     IF CMAINTI = 'D'
 13879        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13880
 13881     IF CLSTNML GREATER THAN ZEROS
 13882         MOVE AL-UANON           TO CLSTNMA.
 13883
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 256
* EL6311.cbl
 13885
 13886******************************************************************
 13887*                                                                *
 13888*           E D I T   C A N C E L   C O V E R A G E S            *
 13889*                                                                *
 13890******************************************************************
 13891
 13892 2015-EDIT-COVERAGES.
 13893     IF CCANDT1L      GREATER THAN ZEROS OR
 13894        CREFND1L      GREATER THAN ZEROS OR
 13895        CCANDT2L      GREATER THAN ZEROS OR
 13896        CREFND2L      GREATER THAN ZEROS OR
 13897        CMTHD1L       GREATER THAN ZEROS OR
 13898        CMTHD2L       GREATER THAN ZEROS OR
 13899        CLIVESL       GREATER THAN ZEROS OR
 13900        CPAYEEL       GREATER THAN ZEROS OR
 13901        CFORCEL       GREATER THAN ZEROS OR
 13902        CBILCDL       GREATER THAN ZEROS OR
 13903        CCANREAL      GREATER THAN ZEROS
 13904            NEXT SENTENCE
 13905         ELSE
 13906            GO TO 2030-EDIT-COMPLETE.
 13907
 13908     IF CCANDT1L = ZEROS
 13909        AND (CMAINTI = 'C' OR 'K')
 13910        NEXT SENTENCE
 13911     ELSE
 13912        IF CCANDT1L      GREATER THAN ZEROS
 13913            MOVE AL-UNNON            TO CCANDT1A
 13914            IF CCANDT1I = SPACES
 13915               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13916            ELSE
 13917               MOVE CCANDT1I            TO DEEDIT-FIELD
 13918               PERFORM 8600-DEEDIT
 13919               IF DEEDIT-FIELD-V0   NUMERIC
 13920                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13921                  MOVE 4                TO DC-OPTION-CODE
 13922                  PERFORM 9700-DATE-LINK
 13923                  IF NO-CONVERSION-ERROR
 13924                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13925                  ELSE
 13926                      MOVE -1        TO CCANDT1L
 13927                      MOVE ER-2227   TO EMI-ERROR
 13928                      MOVE AL-UNBON  TO CCANDT1A
 13929                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930               ELSE
 13931                  MOVE -1         TO CCANDT1L
 13932                  MOVE ER-2223    TO EMI-ERROR
 13933                  MOVE AL-UNBON   TO CCANDT1A
 13934                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13935        ELSE
 13936            IF CREFND1L GREATER THAN ZEROS
 13937               MOVE -1             TO CCANDT1L
 13938               MOVE ER-2222        TO EMI-ERROR
 13939               MOVE AL-UNBOF       TO CCANDT1A
 13940               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13941
 13942     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 257
* EL6311.cbl
 13943        AND (CMAINTI = 'C' OR 'K')
 13944         NEXT SENTENCE
 13945     ELSE
 13946         IF CREFND1L NOT = ZEROS
 13947            MOVE AL-UNNON        TO CREFND1A
 13948
 13949* EXEC CICS BIF DEEDIT
 13950*               FIELD  (CREFND1I)
 13951*               LENGTH (11)
 13952*           END-EXEC
 13953     MOVE 11
 13954       TO DFHEIV11
 13955*    MOVE '@"L                   #   #00012524' TO DFHEIV0
 13956     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13957     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13958     MOVE X'2020233030303132353234' TO DFHEIV0(25:11)
 13959     CALL 'kxdfhei1' USING DFHEIV0,
 13960           CREFND1I,
 13961           DFHEIV11
 13962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13963            MOVE CREFND1I        TO WS-CREFND1
 13964*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 13965*           PERFORM 8600-DEEDIT
 13966*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 13967            IF WS-CREFND1  = ZEROS
 13968               AND CMAINTI = 'A'
 13969             MOVE ER-2437        TO EMI-ERROR
 13970             MOVE -1             TO CREFND1L
 13971             MOVE AL-UNBON       TO CREFND1A
 13972             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13973
 13974     IF CCANREAL > +0
 13975        MOVE AL-UANON            TO CCANREAA
 13976        IF CCANREAI = 'R' OR ' '
 13977           CONTINUE
 13978        ELSE
 13979           MOVE ER-9841        TO EMI-ERROR
 13980           MOVE -1             TO CCANREAL
 13981           MOVE AL-UABON       TO CCANREAA
 13982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13983        END-IF
 13984     END-IF
 13985     IF CMTHD1L EQUAL +0
 13986        NEXT SENTENCE
 13987     ELSE
 13988        IF CMTHD1L NOT = +0
 13989           MOVE AL-UNNON        TO CMTHD1A
 13990           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 13991                         OR '5' OR '6' OR '8' OR '9'
 13992                         OR 'R' OR ' '
 13993              NEXT SENTENCE
 13994           ELSE
 13995              MOVE ER-0582        TO EMI-ERROR
 13996              MOVE -1             TO CMTHD1L
 13997              MOVE AL-UNBON       TO CMTHD1A
 13998              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13999
 14000     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 258
* EL6311.cbl
 14001        AND (CMAINTI = 'C' OR 'K')
 14002         NEXT SENTENCE
 14003     ELSE
 14004         IF CCANDT2L  GREATER THAN ZEROS
 14005             MOVE AL-UNNON       TO CCANDT2A
 14006             IF CCANDT2I = SPACES
 14007                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14008             ELSE
 14009                MOVE CCANDT2I       TO DEEDIT-FIELD
 14010                PERFORM 8600-DEEDIT
 14011                IF DEEDIT-FIELD-V0   NUMERIC
 14012                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14013                   MOVE 4                TO DC-OPTION-CODE
 14014                   PERFORM 9700-DATE-LINK
 14015                   IF NO-CONVERSION-ERROR
 14016                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14017                   ELSE
 14018                      MOVE -1       TO CCANDT2L
 14019                      MOVE ER-2227  TO EMI-ERROR
 14020                      MOVE AL-UNBON TO CCANDT2A
 14021                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14022                ELSE
 14023                   MOVE -1         TO CCANDT2L
 14024                   MOVE ER-2223    TO EMI-ERROR
 14025                   MOVE AL-UNBON   TO CCANDT2A
 14026                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14027         ELSE
 14028            IF CREFND2L GREATER THAN ZEROS
 14029               MOVE -1             TO CCANDT2L
 14030               MOVE ER-2222        TO EMI-ERROR
 14031               MOVE AL-UNBOF       TO CCANDT2A
 14032               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
 14034     IF CREFND2L = ZEROS
 14035        AND (CMAINTI = 'C' OR 'K')
 14036         NEXT SENTENCE
 14037     ELSE
 14038         IF CREFND2L NOT = ZEROS
 14039            MOVE AL-UNNON        TO CREFND2A
 14040
 14041* EXEC CICS BIF DEEDIT
 14042*               FIELD  (CREFND2I)
 14043*               LENGTH (11)
 14044*           END-EXEC
 14045     MOVE 11
 14046       TO DFHEIV11
 14047*    MOVE '@"L                   #   #00012605' TO DFHEIV0
 14048     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14049     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14050     MOVE X'2020233030303132363035' TO DFHEIV0(25:11)
 14051     CALL 'kxdfhei1' USING DFHEIV0,
 14052           CREFND2I,
 14053           DFHEIV11
 14054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14055            MOVE CREFND2I        TO WS-CREFND2
 14056*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14057*           PERFORM 8600-DEEDIT
 14058*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 259
* EL6311.cbl
 14059            IF WS-CREFND2  = ZEROS
 14060               AND CMAINTI = 'A'
 14061             MOVE ER-2437        TO EMI-ERROR
 14062             MOVE -1             TO CREFND2L
 14063             MOVE AL-UNBON       TO CREFND2A
 14064             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14065
 14066     IF CMTHD2L EQUAL +0
 14067        NEXT SENTENCE
 14068     ELSE
 14069        IF CMTHD2L NOT = +0
 14070           MOVE AL-UNNON        TO CMTHD2A
 14071           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14072                         OR '5' OR '6' OR '8' OR '9'
 14073                         OR ' ' OR 'R'
 14074              NEXT SENTENCE
 14075           ELSE
 14076              MOVE ER-0582        TO EMI-ERROR
 14077              MOVE -1             TO CMTHD2L
 14078              MOVE AL-UNBON       TO CMTHD2A
 14079              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14080
 14081     IF CLIVESL GREATER THAN ZEROS
 14082         MOVE CLIVESI            TO DEEDIT-FIELD
 14083         PERFORM 8600-DEEDIT
 14084         IF DEEDIT-FIELD-V0 NUMERIC
 14085             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14086             MOVE AL-UNNON       TO CLIVESA
 14087         ELSE
 14088             MOVE -1             TO CLIVESL
 14089             MOVE AL-UNBON       TO CLIVESA
 14090             MOVE ER-2223        TO EMI-ERROR
 14091             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14092
 14093     IF CFORCEL  NOT = ZEROS
 14094         IF FORCE-CAP
 14095            MOVE AL-UANON            TO CFORCEA
 14096         ELSE
 14097            MOVE ER-2945             TO EMI-ERROR
 14098            MOVE AL-UABON            TO CFORCEA
 14099            MOVE -1                  TO CFORCEL
 14100            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
 14102     IF CPAYEEL GREATER THAN ZEROS
 14103        MOVE AL-UANON            TO CPAYEEA.
 14104
 14105     IF CBILCDL NOT = ZEROS
 14106        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14107                             AND 'A' AND 'B' AND 'E'
 14108           MOVE ER-2225              TO EMI-ERROR
 14109           MOVE AL-UABON             TO CBILCDA
 14110           MOVE -1                   TO CBILCDL
 14111           MOVE  1                   TO SET-CURSOR-SW
 14112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113        ELSE
 14114           MOVE AL-UANON             TO CBILCDA.
 14115
 14116 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 260
* EL6311.cbl
 14117     IF EMI-ERROR = ZEROS
 14118         NEXT SENTENCE
 14119     ELSE
 14120         GO TO 8200-SEND-DATAONLY.
 14121
 14122     IF CMAINTI = 'A'
 14123        GO TO 2200-ADD-CANCEL-ROUTINE.
 14124
 14125     IF CMAINTI = 'C'
 14126        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14127
 14128     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14129
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 261
* EL6311.cbl
 14131
 14132******************************************************************
 14133*                                                                *
 14134*                   S H O W   C A N C E L                        *
 14135*                                                                *
 14136******************************************************************
 14137
 14138 2100-SHOW-REQUEST.
 14139     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14140
 14141     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14142        MOVE -1                  TO CMAINTL
 14143        GO TO 8200-SEND-DATAONLY.
 14144
 14145     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14146
 14147     IF CSUFIXL NOT = ZEROS
 14148        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14149       ELSE
 14150        MOVE SPACE            TO WS-NEW-SUFFIX.
 14151
 14152     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14153     PERFORM 8600-DEEDIT.
 14154     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14155     MOVE '4'                    TO DC-OPTION-CODE.
 14156     PERFORM 9700-DATE-LINK.
 14157     IF DATE-CONVERSION-ERROR
 14158        MOVE ER-0348             TO EMI-ERROR
 14159        MOVE -1                  TO CEFFDTL
 14160        MOVE AL-UABON            TO CEFFDTA
 14161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14162        GO TO 8200-SEND-DATAONLY
 14163     ELSE
 14164        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14165        MOVE AL-UANON            TO CEFFDTA
 14166        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14167
 14168     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14169
 14170     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14171        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14172        MOVE 'Y'                    TO WS-SHOW-SW
 14173        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14174           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14175        ELSE
 14176           IF PI-FILE-BROWSE
 14177              GO TO 4300-BROWSE-FILE-FORWARD
 14178           ELSE
 14179              IF PI-CSR-BROWSE
 14180                 GO TO 4200-BROWSE-CSR-FORWARD
 14181              ELSE
 14182                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14183     ELSE
 14184        GO TO 3900-RE-DISPLAY-RECORD.
 14185
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 262
* EL6311.cbl
 14187
 14188
 14189******************************************************************
 14190*                                                                *
 14191*            A D D   C A N C E L   R O U T I N E                 *
 14192*                                                                *
 14193******************************************************************
 14194
 14195 2200-ADD-CANCEL-ROUTINE.
 14196     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14197
 14198
 14199* EXEC CICS GETMAIN
 14200*        SET     (ADDRESS OF PENDING-BUSINESS)
 14201*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14202*    END-EXEC.
 14203*    MOVE '," L                  $   #00012752' TO DFHEIV0
 14204     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14205     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14206     MOVE X'2020233030303132373532' TO DFHEIV0(25:11)
 14207     CALL 'kxdfhei1' USING DFHEIV0,
 14208           DFHEIV20,
 14209           ERPNDB-RECORD-LENGTH,
 14210           DFHEIV99
 14211     SET ADDRESS OF PENDING-BUSINESS TO
 14212         DFHEIV20
 14213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14214
 14215
 14216
 14217* EXEC CICS HANDLE CONDITION
 14218*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14219*    END-EXEC.
 14220*    MOVE '"$I                   ! 3 #00012757' TO DFHEIV0
 14221     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14223     MOVE X'3320233030303132373537' TO DFHEIV0(25:11)
 14224     CALL 'kxdfhei1' USING DFHEIV0
 14225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14226
 14227
 14228     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14229     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14230     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14231
 14232
 14233* EXEC CICS READ
 14234*        INTO    (PENDING-BUSINESS)
 14235*        DATASET (FILE-ID-ERPNDB)
 14236*        RIDFLD  (ERPNDB-KEY)
 14237*    END-EXEC.
 14238     MOVE LENGTH OF
 14239      PENDING-BUSINESS
 14240       TO DFHEIV11
 14241*    MOVE '&"IL       E          (   #00012765' TO DFHEIV0
 14242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14244     MOVE X'2020233030303132373635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 263
* EL6311.cbl
 14245     CALL 'kxdfhei1' USING DFHEIV0,
 14246           FILE-ID-ERPNDB,
 14247           PENDING-BUSINESS,
 14248           DFHEIV11,
 14249           ERPNDB-KEY,
 14250           DFHEIV99,
 14251           DFHEIV99,
 14252           DFHEIV99
 14253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14254
 14255
 14256     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14257
 14258     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14259     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14260     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14261     MOVE SPACES                 TO PENDING-BUSINESS.
 14262     MOVE 'PB'                   TO PB-RECORD-ID.
 14263     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14264     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14265     MOVE SPACES                 TO PB-CERT-SFX.
 14266     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14267     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14268                                    PB-ALT-CHG-SEQ-NO.
 14269
 14270     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14271     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14272     MOVE '2'                    TO PB-RECORD-TYPE.
 14273
 14274     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14275     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14276
 14277
 14278     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14279                                    PB-ALT-CHG-SEQ-NO
 14280                                    PB-C-LF-REF-CALC
 14281                                    PB-C-AH-REF-CALC
 14282                                    PB-C-LF-RFND-CLP
 14283                                    PB-C-AH-RFND-CLP
 14284                                    PB-CI-INSURED-AGE
 14285                                    PB-CI-LF-TERM
 14286                                    PB-CI-AH-TERM
 14287                                    PB-CI-LF-BENEFIT-CD
 14288                                    PB-CI-LF-BENEFIT-AMT
 14289                                    PB-CI-LF-ALT-BENEFIT-AMT
 14290                                    PB-CI-LF-PREMIUM-AMT
 14291                                    PB-CI-LF-ALT-PREMIUM-AMT
 14292                                    PB-CI-AH-BENEFIT-CD
 14293                                    PB-CI-AH-BENEFIT-AMT
 14294                                    PB-CI-AH-PREMIUM-AMT
 14295                                    PB-CI-PAY-FREQUENCY
 14296                                    PB-CI-LOAN-APR
 14297                                    PB-CI-LOAN-TERM
 14298                                    PB-CI-LIFE-COMMISSION
 14299                                    PB-CI-AH-COMMISSION
 14300                                    PB-CI-CURR-SEQ
 14301                                    PB-CI-AH-CANCEL-AMT
 14302                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 264
* EL6311.cbl
 14303                                    PB-CI-RATE-DEV-PCT-LF
 14304                                    PB-CI-RATE-DEV-PCT-AH
 14305                                    PB-CI-EXTENTION-DAYS
 14306                                    PB-CI-TERM-IN-DAYS
 14307                                    PB-CI-LIVES
 14308                                    PB-CI-LF-CRIT-PER
 14309                                    PB-CI-AH-CRIT-PER
 14310                                    PB-C-LF-REM-TERM
 14311                                    PB-C-AH-REM-TERM
 14312                                    PB-CHG-COUNT
 14313                                    PB-LF-BILLED-AMTS
 14314                                    PB-AH-BILLED-AMTS
 14315                                    PB-C-NH-INT-ON-REFS
 14316*                                   PB-C-MICROFILM-NO
 14317                                    PB-CALC-TOLERANCE.
 14318
 14319     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14320                                    PB-CI-AH-SETTLEMENT-DT
 14321                                    PB-CI-DEATH-DT
 14322                                    PB-CI-LF-PRIOR-CANCEL-DT
 14323                                    PB-CI-AH-PRIOR-CANCEL-DT
 14324                                    PB-CI-ENTRY-DT
 14325                                    PB-CI-LF-EXPIRE-DT
 14326                                    PB-CI-AH-EXPIRE-DT
 14327                                    PB-CI-LOAN-1ST-PMT-DT
 14328                                    PB-C-LF-CANCEL-DT
 14329                                    PB-C-AH-CANCEL-DT
 14330                                    PB-CREDIT-ACCEPT-DT
 14331                                    PB-BILLED-DT
 14332                                    PB-ACCT-EFF-DT
 14333                                    PB-ACCT-EXP-DT.
 14334
 14335     MOVE 'X'                    TO PB-FATAL-FLAG.
 14336
 14337     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14338
 14339     IF CSUFIXL     GREATER THAN ZEROS
 14340        MOVE CSUFIXI             TO PB-CERT-SFX.
 14341
 14342*    IF CMICRNOL  GREATER  ZEROS
 14343*        IF CMICRNOI  NUMERIC
 14344*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14345*            MOVE AL-UNNON       TO  CMICRNOA
 14346*        ELSE
 14347*            MOVE -1             TO  CMICRNOL
 14348*            MOVE AL-UNBON       TO  CMICRNOA
 14349*            MOVE ER-2701        TO  EMI-ERROR
 14350*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14351
 14352     IF CLSTNML     GREATER THAN ZEROS
 14353        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14354
 14355     IF CCANREAL > ZEROS
 14356        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14357     END-IF
 14358     IF CPCYNL > ZEROS
 14359        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14360     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 265
* EL6311.cbl
 14361     IF CCANDT1L    GREATER THAN ZEROS
 14362        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14363
 14364     IF CCANDT2L    GREATER THAN ZEROS
 14365        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14366
 14367     IF CMTHD1L    GREATER THAN +0
 14368        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14369
 14370     IF CMTHD2L    GREATER THAN +0
 14371        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14372
 14373     IF CREFND1L    GREATER THAN ZEROS
 14374        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14375        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14376     ELSE
 14377        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14378
 14379     IF CREFND2L    GREATER THAN ZEROS
 14380        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14381        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14382     ELSE
 14383        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14384
 14385     IF CLIVESL     GREATER THAN ZEROS
 14386        MOVE WS-CLIVES           TO PB-C-LIVES
 14387     ELSE
 14388        MOVE ZEROS               TO PB-C-LIVES.
 14389
 14390     IF CPAYEEL     GREATER THAN ZEROS
 14391        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14392
 14393     IF CFORCEL     GREATER THAN ZEROS
 14394        MOVE CFORCEI             TO PB-FORCE-CODE.
 14395
 14396     IF CBILCDL     GREATER THAN ZEROS
 14397        MOVE CBILCDI             TO PB-RECORD-BILL.
 14398
 14399*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14400
 14401 2260-WRITE-PB-RECORD.
 14402     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14403                                    PB-INPUT-BY.
 14404     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14405     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14406                                    PB-INPUT-DT.
 14407
 14408     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14409     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14410                                    PB-CONTROL-BY-ORIG-BATCH.
 14411
 14412     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14413     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14414     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14415     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14416     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14417
 14418     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 266
* EL6311.cbl
 14419
 14420     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14421
 14422     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14423     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14424     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14425
 14426     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14427     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14428
 14429 2275-WRITE-PENDING-BUSINESS.
 14430     MOVE 'A'                    TO JP-RECORD-TYPE.
 14431     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14432     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14433     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14434
 14435
 14436* EXEC CICS HANDLE CONDITION
 14437*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14438*    END-EXEC.
 14439*    MOVE '"$%                   ! 4 #00012950' TO DFHEIV0
 14440     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14442     MOVE X'3420233030303132393530' TO DFHEIV0(25:11)
 14443     CALL 'kxdfhei1' USING DFHEIV0
 14444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14445
 14446
 14447
 14448* EXEC CICS WRITE
 14449*        DATASET (FILE-ID-ERPNDB)
 14450*        FROM    (PENDING-BUSINESS)
 14451*        RIDFLD  (PB-CONTROL-PRIMARY)
 14452*    END-EXEC.
 14453     MOVE LENGTH OF
 14454      PENDING-BUSINESS
 14455       TO DFHEIV11
 14456*    MOVE '&$ L                  ''   #00012954' TO DFHEIV0
 14457     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14459     MOVE X'2020233030303132393534' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0,
 14461           FILE-ID-ERPNDB,
 14462           PENDING-BUSINESS,
 14463           DFHEIV11,
 14464           PB-CONTROL-PRIMARY,
 14465           DFHEIV99,
 14466           DFHEIV99
 14467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14468
 14469
 14470     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14471
 14472     PERFORM 8400-LOG-JOURNAL-RECORD.
 14473
 14474******************************************************************
 14475*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14476******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 267
* EL6311.cbl
 14477
 14478     display ' made it to add orig CANCEL cert '
 14479     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14480     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14481     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14482     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14483
 14484
 14485* EXEC CICS READ
 14486*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14487*        DATASET (FILE-ID-ELCERT)
 14488*        RIDFLD  (ELCERT-KEY)
 14489*        RESP    (WS-RESPONSE)
 14490*    END-EXEC.
 14491*    MOVE '&"S        E          (  N#00012974' TO DFHEIV0
 14492     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14494     MOVE X'204E233030303132393734' TO DFHEIV0(25:11)
 14495     CALL 'kxdfhei1' USING DFHEIV0,
 14496           FILE-ID-ELCERT,
 14497           DFHEIV20,
 14498           DFHEIV99,
 14499           ELCERT-KEY,
 14500           DFHEIV99,
 14501           DFHEIV99,
 14502           DFHEIV99
 14503     SET ADDRESS OF CERTIFICATE-MASTER TO
 14504         DFHEIV20
 14505     MOVE EIBRESP  TO WS-RESPONSE
 14506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14507
 14508
 14509     IF NOT RESP-NORMAL
 14510        GO TO 2276-BYPASS-CRTO
 14511     END-IF
 14512
 14513     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14514     MOVE ' '                    TO WS-ERMAIL-SW
 14515
 14516
 14517* EXEC CICS READ
 14518*       DATASET   (FILE-ID-ERMAIL)
 14519*       SET       (ADDRESS OF MAILING-DATA)
 14520*       RIDFLD    (ERMAIL-KEY)
 14521*       RESP      (WS-RESPONSE)
 14522*    END-EXEC
 14523*    MOVE '&"S        E          (  N#00012988' TO DFHEIV0
 14524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14526     MOVE X'204E233030303132393838' TO DFHEIV0(25:11)
 14527     CALL 'kxdfhei1' USING DFHEIV0,
 14528           FILE-ID-ERMAIL,
 14529           DFHEIV20,
 14530           DFHEIV99,
 14531           ERMAIL-KEY,
 14532           DFHEIV99,
 14533           DFHEIV99,
 14534           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 268
* EL6311.cbl
 14535     SET ADDRESS OF MAILING-DATA TO
 14536         DFHEIV20
 14537     MOVE EIBRESP  TO WS-RESPONSE
 14538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14539
 14540     IF RESP-NORMAL
 14541        SET ERMAIL-FOUND TO TRUE
 14542     END-IF
 14543
 14544     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14545
 14546     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14547     MOVE 'OC'                   TO OC-RECORD-ID
 14548     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14549                                 TO OC-CONTROL-PRIMARY (1:33)
 14550     MOVE 'I'                    TO OC-RECORD-TYPE
 14551     MOVE +4096                  TO OC-KEY-SEQ-NO
 14552     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14553     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14554     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14555
 14556     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14557     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14558     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14559     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14560     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14561     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14562     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14563     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14564     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14565     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14566     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14567     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14568     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14569     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14570     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14571     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14572     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14573     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14574     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14575     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14576     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14577     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14578     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14579     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14580     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14581     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14582     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14583     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14584     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14585     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14586
 14587     IF ERMAIL-FOUND
 14588        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14589     END-IF
 14590     IF NOT CERT-TRL-REC-NOT-FOUND
 14591        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14592                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 269
* EL6311.cbl
 14593        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14594                           OC-JNT-AGE-DEFAULT-FLAG
 14595     END-IF
 14596     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14597     .
 14598 2275-WRITE-ELCRTO.
 14599
 14600
 14601* EXEC CICS WRITE
 14602*       DATASET   ('ELCRTO')
 14603*       FROM      (ORIGINAL-CERTIFICATE)
 14604*       RIDFLD    (OC-CONTROL-PRIMARY)
 14605*       RESP      (WS-RESPONSE)
 14606*    END-EXEC
 14607     MOVE LENGTH OF
 14608      ORIGINAL-CERTIFICATE
 14609       TO DFHEIV11
 14610     MOVE 'ELCRTO' TO DFHEIV1
 14611*    MOVE '&$ L                  ''  N#00013055' TO DFHEIV0
 14612     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14614     MOVE X'204E233030303133303535' TO DFHEIV0(25:11)
 14615     CALL 'kxdfhei1' USING DFHEIV0,
 14616           DFHEIV1,
 14617           ORIGINAL-CERTIFICATE,
 14618           DFHEIV11,
 14619           OC-CONTROL-PRIMARY,
 14620           DFHEIV99,
 14621           DFHEIV99
 14622     MOVE EIBRESP  TO WS-RESPONSE
 14623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14624
 14625     display ' just wrote 2275 ' ws-response
 14626     IF RESP-DUPKEY
 14627        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14628        GO TO 2275-WRITE-ELCRTO
 14629     ELSE
 14630        IF NOT RESP-NORMAL
 14631           MOVE -1               TO BMAINTL
 14632           MOVE ER-7450          TO EMI-ERROR
 14633           PERFORM 9900-ERROR-FORMAT
 14634                                 THRU 9900-EXIT
 14635           GO TO 8200-SEND-DATAONLY
 14636        END-IF
 14637     END-IF.
 14638
 14639 2276-BYPASS-CRTO.
 14640******************************************************************
 14641*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14642******************************************************************
 14643
 14644
 14645* EXEC CICS READ
 14646*        INTO    (PENDING-BUSINESS)
 14647*        DATASET (FILE-ID-ERPNDB)
 14648*        RIDFLD  (ERPNDB-KEY)
 14649*        UPDATE
 14650*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 270
* EL6311.cbl
 14651     MOVE LENGTH OF
 14652      PENDING-BUSINESS
 14653       TO DFHEIV11
 14654*    MOVE '&"IL       EU         (   #00013081' TO DFHEIV0
 14655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14656     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14657     MOVE X'2020233030303133303831' TO DFHEIV0(25:11)
 14658     CALL 'kxdfhei1' USING DFHEIV0,
 14659           FILE-ID-ERPNDB,
 14660           PENDING-BUSINESS,
 14661           DFHEIV11,
 14662           ERPNDB-KEY,
 14663           DFHEIV99,
 14664           DFHEIV99,
 14665           DFHEIV99
 14666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14667
 14668
 14669     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14670     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14671     MOVE 'B'                    TO JP-RECORD-TYPE.
 14672     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14673
 14674     PERFORM 8400-LOG-JOURNAL-RECORD.
 14675
 14676     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14677
 14678
 14679* EXEC CICS REWRITE
 14680*        DATASET (FILE-ID-ERPNDB)
 14681*        FROM    (PENDING-BUSINESS)
 14682*    END-EXEC.
 14683     MOVE LENGTH OF
 14684      PENDING-BUSINESS
 14685       TO DFHEIV11
 14686*    MOVE '&& L                  %   #00013097' TO DFHEIV0
 14687     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14688     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14689     MOVE X'2020233030303133303937' TO DFHEIV0(25:11)
 14690     CALL 'kxdfhei1' USING DFHEIV0,
 14691           FILE-ID-ERPNDB,
 14692           PENDING-BUSINESS,
 14693           DFHEIV11,
 14694           DFHEIV99
 14695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14696
 14697
 14698     MOVE 'C'                    TO JP-RECORD-TYPE.
 14699     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14700
 14701     PERFORM 8400-LOG-JOURNAL-RECORD.
 14702
 14703     IF WS-ERRORS-PRESENT
 14704        GO TO 3900-RE-DISPLAY-RECORD.
 14705
 14706     MOVE ZEROS                  TO EMI-ERROR.
 14707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14708     MOVE LOW-VALUES             TO EL631CI.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 271
* EL6311.cbl
 14709     MOVE  -1                    TO CMAINTL.
 14710     GO TO 8100-SEND-INITIAL-MAP.
 14711
 14712 2280-BATCH-HDR-NOT-FOUND.
 14713     MOVE -1                     TO BMAINTL.
 14714     MOVE ER-7450                TO EMI-ERROR.
 14715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14716     GO TO 8200-SEND-DATAONLY.
 14717
 14718 2290-DUPLICATE-ALT-INDEX.
 14719
 14720******************************************************************
 14721*                                                                *
 14722*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14723*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14724*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14725*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14726*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14727*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14728*                                                                *
 14729******************************************************************
 14730
 14731     IF LCP-ONCTR-02 =  0
 14732         ADD 1 TO LCP-ONCTR-02
 14733        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14734
 14735     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14736
 14737     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14738         NEXT SENTENCE
 14739     ELSE
 14740         ADD +1 TO PB-BATCH-SEQ-NO
 14741                   PB-CSR-BATCH-SEQ-NO
 14742         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14743         GO TO 2275-WRITE-PENDING-BUSINESS.
 14744
 14745     MOVE -1                     TO CCERTNOL.
 14746     MOVE AL-UABON               TO CCERTNOA.
 14747     MOVE AL-UNBON               TO CEFFDTA.
 14748
 14749     MOVE 1                      TO EMI-SUB
 14750                                    EMI-SWITCH1
 14751                                    EMI-SWITCH-AREA-1
 14752                                    EMI-SWITCH-AREA-2.
 14753
 14754     MOVE SPACES                 TO EMI-ERROR-LINES.
 14755
 14756
 14757* EXEC CICS SYNCPOINT ROLLBACK
 14758*    END-EXEC.
 14759*    MOVE '6"R                   !   #00013160' TO DFHEIV0
 14760     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14762     MOVE X'2020233030303133313630' TO DFHEIV0(25:11)
 14763     CALL 'kxdfhei1' USING DFHEIV0
 14764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14765
 14766
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 272
* EL6311.cbl
 14767     MOVE ER-2247                TO EMI-ERROR.
 14768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14769     GO TO 8200-SEND-DATAONLY.
 14770
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 273
* EL6311.cbl
 14772
 14773******************************************************************
 14774*                                                                *
 14775*          C H A N G E   C A N C E L   R O U T I N E             *
 14776*                                                                *
 14777******************************************************************
 14778
 14779***************************************************************
 14780*                                                             *
 14781*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14782*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14783*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14784*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14785*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14786*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14787*     5. LINK TO THE EDIT ROUTINE.                            *
 14788*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14789*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14790*              THE EDIT ROUTINE.                              *
 14791*     7. REWRITE THE NEW ISSUE                                *
 14792*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14793*                                                             *
 14794***************************************************************
 14795 2300-CHANGE-CANCEL-ROUTINE.
 14796     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14797
 14798     IF CCHGL NOT = ZEROS
 14799        MOVE ER-2196             TO EMI-ERROR
 14800        MOVE AL-UABON            TO CMAINTA
 14801        MOVE -1                  TO CMAINTL
 14802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14803        GO TO 8200-SEND-DATAONLY.
 14804
 14805     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14806
 14807     IF CSUFIXL NOT = ZEROS
 14808        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14809     ELSE
 14810        MOVE SPACE               TO WS-NEW-SUFFIX.
 14811
 14812     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14813     PERFORM 8600-DEEDIT.
 14814     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14815     MOVE '4'                    TO DC-OPTION-CODE.
 14816
 14817     PERFORM 9700-DATE-LINK.
 14818
 14819     IF DATE-CONVERSION-ERROR
 14820        MOVE ER-0348             TO EMI-ERROR
 14821        MOVE -1                  TO CEFFDTL
 14822        MOVE AL-UABON            TO CEFFDTA
 14823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14824        GO TO 8200-SEND-DATAONLY
 14825     ELSE
 14826        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14827        MOVE AL-UANON            TO CEFFDTA
 14828        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14829
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 274
* EL6311.cbl
 14830 2325-PROCESS-CANCEL-CHANGES.
 14831
 14832* EXEC CICS HANDLE CONDITION
 14833*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14834*    END-EXEC.
 14835*    MOVE '"$I                   ! 5 #00013227' TO DFHEIV0
 14836     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14838     MOVE X'3520233030303133323237' TO DFHEIV0(25:11)
 14839     CALL 'kxdfhei1' USING DFHEIV0
 14840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14841
 14842
 14843     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14844     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14845     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14846
 14847
 14848* EXEC CICS GETMAIN
 14849*        SET      (ADDRESS OF PENDING-BUSINESS)
 14850*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14851*        INITIMG  (GETMAIN-SPACE)
 14852*     END-EXEC.
 14853*    MOVE ',"IL                  $   #00013235' TO DFHEIV0
 14854     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14855     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14856     MOVE X'2020233030303133323335' TO DFHEIV0(25:11)
 14857     CALL 'kxdfhei1' USING DFHEIV0,
 14858           DFHEIV20,
 14859           ERPNDB-RECORD-LENGTH,
 14860           GETMAIN-SPACE
 14861     SET ADDRESS OF PENDING-BUSINESS TO
 14862         DFHEIV20
 14863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14864
 14865
 14866
 14867* EXEC CICS READ
 14868*        INTO    (PENDING-BUSINESS)
 14869*        DATASET (FILE-ID-ERPNDB)
 14870*        RIDFLD  (ERPNDB-KEY)
 14871*    END-EXEC.
 14872     MOVE LENGTH OF
 14873      PENDING-BUSINESS
 14874       TO DFHEIV11
 14875*    MOVE '&"IL       E          (   #00013241' TO DFHEIV0
 14876     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14878     MOVE X'2020233030303133323431' TO DFHEIV0(25:11)
 14879     CALL 'kxdfhei1' USING DFHEIV0,
 14880           FILE-ID-ERPNDB,
 14881           PENDING-BUSINESS,
 14882           DFHEIV11,
 14883           ERPNDB-KEY,
 14884           DFHEIV99,
 14885           DFHEIV99,
 14886           DFHEIV99
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 275
* EL6311.cbl
 14888
 14889
 14890     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14891
 14892
 14893* EXEC CICS HANDLE CONDITION
 14894*         NOTFND     (2385-REC-NOT-FOUND)
 14895*    END-EXEC.
 14896*    MOVE '"$I                   ! 6 #00013249' TO DFHEIV0
 14897     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14899     MOVE X'3620233030303133323439' TO DFHEIV0(25:11)
 14900     CALL 'kxdfhei1' USING DFHEIV0
 14901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14902
 14903
 14904**********************************************************
 14905*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14906*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14907**********************************************************
 14908
 14909
 14910* EXEC CICS READ
 14911*        DATASET (FILE-ID-ERPNDB)
 14912*        INTO    (PENDING-BUSINESS)
 14913*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14914*    END-EXEC.
 14915     MOVE LENGTH OF
 14916      PENDING-BUSINESS
 14917       TO DFHEIV11
 14918*    MOVE '&"IL       E          (   #00013258' TO DFHEIV0
 14919     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14921     MOVE X'2020233030303133323538' TO DFHEIV0(25:11)
 14922     CALL 'kxdfhei1' USING DFHEIV0,
 14923           FILE-ID-ERPNDB,
 14924           PENDING-BUSINESS,
 14925           DFHEIV11,
 14926           PI-PREV-CONTROL-PRIMARY,
 14927           DFHEIV99,
 14928           DFHEIV99,
 14929           DFHEIV99
 14930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14931
 14932
 14933********** DO NOT ALLOW CHANGES IF THRU A/R
 14934     IF BMAINTI = 'C'
 14935         IF PB-EL860-INTERNAL-PROCESS
 14936             MOVE ER-4005          TO EMI-ERROR
 14937             MOVE -1               TO BMAINTL
 14938             MOVE AL-UABON         TO BMAINTA
 14939             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14940             GO TO 8200-SEND-DATAONLY.
 14941**********
 14942
 14943     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14944        MOVE -1                 TO CMAINTL
 14945        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 276
* EL6311.cbl
 14946        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14947        GO TO 8200-SEND-DATAONLY.
 14948
 14949     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 14950        MOVE ER-2196             TO EMI-ERROR
 14951        MOVE AL-UABON            TO CMAINTA
 14952        MOVE -1                  TO CMAINTL
 14953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14954        GO TO 8200-SEND-DATAONLY.
 14955     MOVE ZEROS                  TO WS-SEQ-SAVE.
 14956
 14957     IF PB-BILLED-DT = LOW-VALUES AND
 14958        PB-CHG-COUNT = ZEROS
 14959        NEXT SENTENCE
 14960     ELSE
 14961        IF (CREFND1L GREATER THAN ZEROS AND
 14962            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 14963           OR
 14964           (CREFND2L GREATER THAN ZEROS AND
 14965            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14966           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 14967
 14968
 14969* EXEC CICS READ
 14970*        DATASET (FILE-ID-ERPNDB)
 14971*        INTO    (PENDING-BUSINESS)
 14972*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14973*        UPDATE
 14974*    END-EXEC.
 14975     MOVE LENGTH OF
 14976      PENDING-BUSINESS
 14977       TO DFHEIV11
 14978*    MOVE '&"IL       EU         (   #00013299' TO DFHEIV0
 14979     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14980     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14981     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 14982     CALL 'kxdfhei1' USING DFHEIV0,
 14983           FILE-ID-ERPNDB,
 14984           PENDING-BUSINESS,
 14985           DFHEIV11,
 14986           PI-PREV-CONTROL-PRIMARY,
 14987           DFHEIV99,
 14988           DFHEIV99,
 14989           DFHEIV99
 14990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14991
 14992
 14993     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14994     MOVE 'B'                    TO JP-RECORD-TYPE
 14995     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14996     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14997
 14998     PERFORM 8400-LOG-JOURNAL-RECORD.
 14999
 15000     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15001          PB-CHG-COUNT NOT = ZEROS
 15002        IF (CREFND1L GREATER THAN ZEROS AND
 15003            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 277
* EL6311.cbl
 15004           OR
 15005           (CREFND2L GREATER THAN ZEROS AND
 15006            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15007            ADD +1                      TO PB-CHG-COUNT
 15008            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15009
 15010*    IF CMICRNOL  GREATER  ZEROS
 15011*        IF CMICRNOI  NUMERIC
 15012*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15013*            MOVE AL-UNNON       TO  CMICRNOA
 15014*        ELSE
 15015*            MOVE -1             TO  CMICRNOL
 15016*            MOVE AL-UNBON       TO  CMICRNOA
 15017*            MOVE ER-2701        TO  EMI-ERROR
 15018*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15019
 15020     IF CSUFIXL GREATER THAN ZEROS
 15021        MOVE CSUFIXI             TO PB-CERT-SFX.
 15022
 15023     IF CLSTNML GREATER THAN ZEROS
 15024         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15025
 15026     IF CCANREAL > ZEROS
 15027        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15028     END-IF
 15029     IF CPCYNL > ZEROS
 15030        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15031     END-IF
 15032     IF CCANDT1L    GREATER THAN ZEROS
 15033        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15034
 15035     IF CCANDT2L    GREATER THAN ZEROS
 15036        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15037
 15038     IF CMTHD1L    GREATER THAN +0
 15039        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15040
 15041     IF CMTHD2L    GREATER THAN +0
 15042        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15043
 15044     IF CREFND1L    GREATER THAN ZEROS
 15045        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15046        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15047        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15048        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15049
 15050     IF CREFND2L    GREATER THAN ZEROS
 15051        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15052        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15053        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15054        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15055
 15056     IF CLIVESL     GREATER THAN ZEROS
 15057        MOVE WS-CLIVES           TO PB-C-LIVES.
 15058
 15059     IF CPAYEEL     GREATER THAN ZEROS
 15060        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15061
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 278
* EL6311.cbl
 15062     IF CFORCEL     GREATER THAN ZEROS
 15063        MOVE CFORCEI             TO PB-FORCE-CODE.
 15064
 15065     IF CBILCDL     GREATER THAN ZEROS
 15066        MOVE CBILCDI             TO PB-RECORD-BILL.
 15067
 15068 2360-REWRITE-PB-RECORD.
 15069     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15070     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15071     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15072     MOVE 'C'                    TO JP-RECORD-TYPE.
 15073     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15074     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15075     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15076
 15077     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15078
 15079     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15080     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15081
 15082     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15083
 15084     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15085
 15086     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15087     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15088     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15089
 15090     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15091     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15092
 15093 2375-REWRITE-PENDING-BUSINESS.
 15094     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15095     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15096     MOVE 'C'                    TO JP-RECORD-TYPE.
 15097     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15098
 15099
 15100* EXEC CICS REWRITE
 15101*        DATASET (FILE-ID-ERPNDB)
 15102*        FROM    (PENDING-BUSINESS)
 15103*    END-EXEC.
 15104     MOVE LENGTH OF
 15105      PENDING-BUSINESS
 15106       TO DFHEIV11
 15107*    MOVE '&& L                  %   #00013412' TO DFHEIV0
 15108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15110     MOVE X'2020233030303133343132' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0,
 15112           FILE-ID-ERPNDB,
 15113           PENDING-BUSINESS,
 15114           DFHEIV11,
 15115           DFHEIV99
 15116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15117
 15118
 15119     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 279
* EL6311.cbl
 15120
 15121******************************************************************
 15122*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15123******************************************************************
 15124
 15125     display ' made it to update orig cancel cert '
 15126
 15127     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15128     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15129     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15130     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15131
 15132
 15133* EXEC CICS READ
 15134*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15135*        DATASET (FILE-ID-ELCERT)
 15136*        RIDFLD  (ELCERT-KEY)
 15137*        RESP    (WS-RESPONSE)
 15138*    END-EXEC.
 15139*    MOVE '&"S        E          (  N#00013430' TO DFHEIV0
 15140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15142     MOVE X'204E233030303133343330' TO DFHEIV0(25:11)
 15143     CALL 'kxdfhei1' USING DFHEIV0,
 15144           FILE-ID-ELCERT,
 15145           DFHEIV20,
 15146           DFHEIV99,
 15147           ELCERT-KEY,
 15148           DFHEIV99,
 15149           DFHEIV99,
 15150           DFHEIV99
 15151     SET ADDRESS OF CERTIFICATE-MASTER TO
 15152         DFHEIV20
 15153     MOVE EIBRESP  TO WS-RESPONSE
 15154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15155
 15156
 15157     IF NOT RESP-NORMAL
 15158        GO TO 2376-BYPASS-CRTO
 15159     END-IF
 15160
 15161
 15162     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15163     MOVE ' '                    TO WS-ERMAIL-SW
 15164
 15165
 15166* EXEC CICS READ
 15167*       DATASET   (FILE-ID-ERMAIL)
 15168*       SET       (ADDRESS OF MAILING-DATA)
 15169*       RIDFLD    (ERMAIL-KEY)
 15170*       RESP      (WS-RESPONSE)
 15171*    END-EXEC
 15172*    MOVE '&"S        E          (  N#00013445' TO DFHEIV0
 15173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15175     MOVE X'204E233030303133343435' TO DFHEIV0(25:11)
 15176     CALL 'kxdfhei1' USING DFHEIV0,
 15177           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 280
* EL6311.cbl
 15178           DFHEIV20,
 15179           DFHEIV99,
 15180           ERMAIL-KEY,
 15181           DFHEIV99,
 15182           DFHEIV99,
 15183           DFHEIV99
 15184     SET ADDRESS OF MAILING-DATA TO
 15185         DFHEIV20
 15186     MOVE EIBRESP  TO WS-RESPONSE
 15187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15188
 15189     IF RESP-NORMAL
 15190        SET ERMAIL-FOUND TO TRUE
 15191     END-IF
 15192
 15193     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15194
 15195     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15196                                 TO ELCRTO-KEY
 15197     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15198     MOVE +0                     TO ELCRTO-SEQ-NO
 15199
 15200
 15201* EXEC CICS READ
 15202*       DATASET   ('ELCRTO')
 15203*       INTO      (ORIGINAL-CERTIFICATE)
 15204*       RIDFLD    (ELCRTO-KEY)
 15205*       GTEQ
 15206*       RESP      (WS-RESPONSE)
 15207*    END-EXEC
 15208     MOVE LENGTH OF
 15209      ORIGINAL-CERTIFICATE
 15210       TO DFHEIV11
 15211     MOVE 'ELCRTO' TO DFHEIV1
 15212*    MOVE '&"IL       G          (  N#00013463' TO DFHEIV0
 15213     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15215     MOVE X'204E233030303133343633' TO DFHEIV0(25:11)
 15216     CALL 'kxdfhei1' USING DFHEIV0,
 15217           DFHEIV1,
 15218           ORIGINAL-CERTIFICATE,
 15219           DFHEIV11,
 15220           ELCRTO-KEY,
 15221           DFHEIV99,
 15222           DFHEIV99,
 15223           DFHEIV99
 15224     MOVE EIBRESP  TO WS-RESPONSE
 15225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15226
 15227     display ' just read gteq ' ws-response
 15228     IF RESP-NORMAL
 15229        AND (OC-CONTROL-PRIMARY (1:33) =
 15230                 PB-CONTROL-BY-ACCOUNT (1:33))
 15231        AND (OC-RECORD-TYPE = 'I')
 15232        display ' resp norm, key =, type i '
 15233        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15234           display ' end proc blank '
 15235           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 281
* EL6311.cbl
 15236           IF NOT CSR-EDIT-SESSION
 15237
 15238* EXEC CICS READ
 15239*                DATASET   ('ELCRTO')
 15240*                INTO      (ORIGINAL-CERTIFICATE)
 15241*                RIDFLD    (OC-CONTROL-PRIMARY)
 15242*                UPDATE
 15243*                RESP      (WS-RESPONSE)
 15244*             END-EXEC
 15245     MOVE LENGTH OF
 15246      ORIGINAL-CERTIFICATE
 15247       TO DFHEIV11
 15248     MOVE 'ELCRTO' TO DFHEIV1
 15249*    MOVE '&"IL       EU         (  N#00013481' TO DFHEIV0
 15250     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15251     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15252     MOVE X'204E233030303133343831' TO DFHEIV0(25:11)
 15253     CALL 'kxdfhei1' USING DFHEIV0,
 15254           DFHEIV1,
 15255           ORIGINAL-CERTIFICATE,
 15256           DFHEIV11,
 15257           OC-CONTROL-PRIMARY,
 15258           DFHEIV99,
 15259           DFHEIV99,
 15260           DFHEIV99
 15261     MOVE EIBRESP  TO WS-RESPONSE
 15262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15263              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15264              IF RESP-NORMAL
 15265                 display ' good read upd '
 15266                 MOVE CM-INSURED-LAST-NAME   TO
 15267                         OC-INS-LAST-NAME
 15268                 MOVE CM-INSURED-FIRST-NAME  TO
 15269                         OC-INS-FIRST-NAME
 15270                 MOVE CM-INSURED-INITIAL2    TO
 15271                         OC-INS-MIDDLE-INIT
 15272                 MOVE CM-INSURED-ISSUE-AGE   TO
 15273                         OC-INS-AGE
 15274                 MOVE CM-JT-LAST-NAME        TO
 15275                         OC-JNT-LAST-NAME
 15276                 MOVE CM-JT-FIRST-NAME       TO
 15277                         OC-JNT-FIRST-NAME
 15278                 MOVE CM-JT-INITIAL          TO
 15279                         OC-JNT-MIDDLE-INIT
 15280                 MOVE CM-INSURED-JOINT-AGE   TO
 15281                         OC-JNT-AGE
 15282                 MOVE CM-LF-BENEFIT-CD       TO
 15283                         OC-LF-BENCD
 15284                 MOVE CM-LF-ORIG-TERM        TO
 15285                         OC-LF-TERM
 15286                 MOVE CM-LF-BENEFIT-AMT      TO
 15287                         OC-LF-BEN-AMT
 15288                 MOVE CM-LF-PREMIUM-AMT      TO
 15289                         OC-LF-PRM-AMT
 15290                 MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15291                         OC-LF-ALT-BEN-AMT
 15292                 MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15293                         OC-LF-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 282
* EL6311.cbl
 15294                 MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15295                         OC-LF-EXP-DT
 15296                 MOVE CM-LIFE-COMM-PCT       TO
 15297                         OC-LF-COMM-PCT
 15298                 MOVE PB-C-LF-CANCEL-DT      TO
 15299                         OC-LF-CANCEL-DT
 15300                 MOVE PB-C-LF-CANCEL-AMT     TO
 15301                         OC-LF-CANCEL-AMT
 15302                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15303                         OC-LF-ITD-CANCEL-AMT
 15304                 MOVE CM-AH-BENEFIT-CD       TO
 15305                         OC-AH-BENCD
 15306                 MOVE CM-AH-ORIG-TERM        TO
 15307                         OC-AH-TERM
 15308                 MOVE CM-AH-BENEFIT-AMT      TO
 15309                         OC-AH-BEN-AMT
 15310                 MOVE CM-AH-PREMIUM-AMT      TO
 15311                         OC-AH-PRM-AMT
 15312                 MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15313                         OC-AH-EXP-DT
 15314                 MOVE CM-AH-COMM-PCT         TO
 15315                         OC-AH-COMM-PCT
 15316                 MOVE CM-AH-CRITICAL-PERIOD  TO
 15317                         OC-AH-CP
 15318                 MOVE PB-C-AH-CANCEL-DT      TO
 15319                         OC-AH-CANCEL-DT
 15320                 MOVE PB-C-AH-CANCEL-AMT     TO
 15321                         OC-AH-CANCEL-AMT
 15322                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15323                         OC-AH-ITD-CANCEL-AMT
 15324                 MOVE CM-LOAN-1ST-PMT-DT     TO
 15325                         OC-1ST-PMT-DT
 15326                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15327                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15328                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15329                 IF ERMAIL-FOUND
 15330                    MOVE MA-CRED-BENE-NAME
 15331                                 TO OC-CRED-BENE-NAME
 15332                 END-IF
 15333                 IF NOT CERT-TRL-REC-NOT-FOUND
 15334                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15335                           OC-INS-AGE-DEFAULT-FLAG
 15336                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15337                           OC-JNT-AGE-DEFAULT-FLAG
 15338                 END-IF
 15339
 15340* EXEC CICS REWRITE
 15341*                   DATASET   ('ELCRTO')
 15342*                   FROM      (ORIGINAL-CERTIFICATE)
 15343*                   RESP      (WS-RESPONSE)
 15344*                END-EXEC
 15345     MOVE LENGTH OF
 15346      ORIGINAL-CERTIFICATE
 15347       TO DFHEIV11
 15348     MOVE 'ELCRTO' TO DFHEIV1
 15349*    MOVE '&& L                  %  N#00013564' TO DFHEIV0
 15350     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15351     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 283
* EL6311.cbl
 15352     MOVE X'204E233030303133353634' TO DFHEIV0(25:11)
 15353     CALL 'kxdfhei1' USING DFHEIV0,
 15354           DFHEIV1,
 15355           ORIGINAL-CERTIFICATE,
 15356           DFHEIV11,
 15357           DFHEIV99
 15358     MOVE EIBRESP  TO WS-RESPONSE
 15359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15360                 display ' just rewrote ' ws-response
 15361              END-IF
 15362           END-IF
 15363        ELSE
 15364           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15365           MOVE 'OC'             TO OC-RECORD-ID
 15366           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15367           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15368           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15369           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15370           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15371           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15372           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15373           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15374           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15375           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15376           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15377           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15378           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15379           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15380           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15381           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15382           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15383           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15384           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15385           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15386           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15387           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15388           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15389           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15390           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15391           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15392           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15393           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15394           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15395           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15396           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15397           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15398           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15399           IF ERMAIL-FOUND
 15400              MOVE MA-CRED-BENE-NAME
 15401                                 TO OC-CRED-BENE-NAME
 15402           END-IF
 15403           IF NOT CERT-TRL-REC-NOT-FOUND
 15404              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15405                           OC-INS-AGE-DEFAULT-FLAG
 15406              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15407                           OC-JNT-AGE-DEFAULT-FLAG
 15408           END-IF
 15409           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 284
* EL6311.cbl
 15410
 15411* EXEC CICS WRITE
 15412*             DATASET   ('ELCRTO')
 15413*             FROM      (ORIGINAL-CERTIFICATE)
 15414*             RIDFLD    (OC-CONTROL-PRIMARY)
 15415*             RESP      (WS-RESPONSE)
 15416*          END-EXEC
 15417     MOVE LENGTH OF
 15418      ORIGINAL-CERTIFICATE
 15419       TO DFHEIV11
 15420     MOVE 'ELCRTO' TO DFHEIV1
 15421*    MOVE '&$ L                  ''  N#00013619' TO DFHEIV0
 15422     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15424     MOVE X'204E233030303133363139' TO DFHEIV0(25:11)
 15425     CALL 'kxdfhei1' USING DFHEIV0,
 15426           DFHEIV1,
 15427           ORIGINAL-CERTIFICATE,
 15428           DFHEIV11,
 15429           OC-CONTROL-PRIMARY,
 15430           DFHEIV99,
 15431           DFHEIV99
 15432     MOVE EIBRESP  TO WS-RESPONSE
 15433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15434        END-IF
 15435     ELSE
 15436        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15437        MOVE 'OC'                TO OC-RECORD-ID
 15438        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15439                                 TO OC-CONTROL-PRIMARY (1:33)
 15440        MOVE 'I'                 TO OC-RECORD-TYPE
 15441        MOVE +4096               TO OC-KEY-SEQ-NO
 15442        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15443        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15444        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15445        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15446        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15447        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15448        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15449        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15450        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15451        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15452        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15453        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15454        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15455        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15456        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15457        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15458        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15459        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15460        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15461        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15462        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15463        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15464        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15465        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15466        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15467        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 285
* EL6311.cbl
 15468        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15469        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15470        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15471        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15472        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15473        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15474        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15475        IF ERMAIL-FOUND
 15476           MOVE MA-CRED-BENE-NAME
 15477                                 TO OC-CRED-BENE-NAME
 15478        END-IF
 15479        IF NOT CERT-TRL-REC-NOT-FOUND
 15480           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15481                           OC-INS-AGE-DEFAULT-FLAG
 15482           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15483                           OC-JNT-AGE-DEFAULT-FLAG
 15484        END-IF
 15485        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15486
 15487
 15488* EXEC CICS WRITE
 15489*          DATASET   ('ELCRTO')
 15490*          FROM      (ORIGINAL-CERTIFICATE)
 15491*          RIDFLD    (OC-CONTROL-PRIMARY)
 15492*          RESP      (WS-RESPONSE)
 15493*       END-EXEC
 15494     MOVE LENGTH OF
 15495      ORIGINAL-CERTIFICATE
 15496       TO DFHEIV11
 15497     MOVE 'ELCRTO' TO DFHEIV1
 15498*    MOVE '&$ L                  ''  N#00013678' TO DFHEIV0
 15499     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15501     MOVE X'204E233030303133363738' TO DFHEIV0(25:11)
 15502     CALL 'kxdfhei1' USING DFHEIV0,
 15503           DFHEIV1,
 15504           ORIGINAL-CERTIFICATE,
 15505           DFHEIV11,
 15506           OC-CONTROL-PRIMARY,
 15507           DFHEIV99,
 15508           DFHEIV99
 15509     MOVE EIBRESP  TO WS-RESPONSE
 15510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15511     END-IF.
 15512
 15513 2376-BYPASS-CRTO.
 15514******************************************************************
 15515*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15516******************************************************************
 15517
 15518
 15519* EXEC CICS HANDLE CONDITION
 15520*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15521*    END-EXEC.
 15522*    MOVE '"$I                   ! 7 #00013691' TO DFHEIV0
 15523     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15525     MOVE X'3720233030303133363931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 286
* EL6311.cbl
 15526     CALL 'kxdfhei1' USING DFHEIV0
 15527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15528
 15529
 15530
 15531* EXEC CICS READ
 15532*        INTO    (PENDING-BUSINESS)
 15533*        DATASET (FILE-ID-ERPNDB)
 15534*        RIDFLD  (ERPNDB-KEY)
 15535*        UPDATE
 15536*    END-EXEC.
 15537     MOVE LENGTH OF
 15538      PENDING-BUSINESS
 15539       TO DFHEIV11
 15540*    MOVE '&"IL       EU         (   #00013695' TO DFHEIV0
 15541     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15542     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15543     MOVE X'2020233030303133363935' TO DFHEIV0(25:11)
 15544     CALL 'kxdfhei1' USING DFHEIV0,
 15545           FILE-ID-ERPNDB,
 15546           PENDING-BUSINESS,
 15547           DFHEIV11,
 15548           ERPNDB-KEY,
 15549           DFHEIV99,
 15550           DFHEIV99,
 15551           DFHEIV99
 15552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15553
 15554
 15555     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15556     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15557     MOVE 'B'                    TO JP-RECORD-TYPE.
 15558     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15559
 15560     PERFORM 8400-LOG-JOURNAL-RECORD.
 15561
 15562     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15563
 15564
 15565* EXEC CICS REWRITE
 15566*        DATASET (FILE-ID-ERPNDB)
 15567*        FROM    (PENDING-BUSINESS)
 15568*    END-EXEC.
 15569     MOVE LENGTH OF
 15570      PENDING-BUSINESS
 15571       TO DFHEIV11
 15572*    MOVE '&& L                  %   #00013711' TO DFHEIV0
 15573     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15574     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15575     MOVE X'2020233030303133373131' TO DFHEIV0(25:11)
 15576     CALL 'kxdfhei1' USING DFHEIV0,
 15577           FILE-ID-ERPNDB,
 15578           PENDING-BUSINESS,
 15579           DFHEIV11,
 15580           DFHEIV99
 15581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15582
 15583
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 287
* EL6311.cbl
 15584     MOVE 'C'                    TO JP-RECORD-TYPE.
 15585     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15586
 15587     PERFORM 8400-LOG-JOURNAL-RECORD.
 15588
 15589     IF WS-ERRORS-PRESENT
 15590         GO TO 3900-RE-DISPLAY-RECORD.
 15591
 15592     MOVE ZEROS                  TO EMI-ERROR
 15593     MOVE -1                     TO CMAINTL
 15594     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15595     GO TO 3900-RE-DISPLAY-RECORD.
 15596
 15597 2380-BATCH-HDR-NOT-FOUND.
 15598     MOVE -1                     TO BMAINTL.
 15599     MOVE ER-7450                TO EMI-ERROR.
 15600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15601     GO TO 8200-SEND-DATAONLY.
 15602
 15603 2385-REC-NOT-FOUND.
 15604     MOVE -1                     TO BMAINTL.
 15605     MOVE ER-7451                TO EMI-ERROR.
 15606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15607     GO TO 8200-SEND-DATAONLY.
 15608
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 288
* EL6311.cbl
 15610
 15611******************************************************************
 15612*                                                                *
 15613*          D E L E T E   C A N C E L   R O U T I N E             *
 15614*                                                                *
 15615******************************************************************
 15616
 15617 2400-DELETE-CANCEL-ROUTINE.
 15618     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15619
 15620     IF CCHGL NOT = ZEROS
 15621        MOVE ER-2196             TO EMI-ERROR
 15622        MOVE AL-UABON            TO CMAINTA
 15623        MOVE -1                  TO CMAINTL
 15624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15625        GO TO 8200-SEND-DATAONLY.
 15626
 15627
 15628* EXEC CICS HANDLE CONDITION
 15629*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15630*    END-EXEC.
 15631*    MOVE '"$I                   ! 8 #00013759' TO DFHEIV0
 15632     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15634     MOVE X'3820233030303133373539' TO DFHEIV0(25:11)
 15635     CALL 'kxdfhei1' USING DFHEIV0
 15636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15637
 15638
 15639     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15640     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15641     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15642
 15643
 15644* EXEC CICS READ
 15645*        SET     (ADDRESS OF PENDING-BUSINESS)
 15646*        DATASET (FILE-ID-ERPNDB)
 15647*        RIDFLD  (ERPNDB-KEY)
 15648*    END-EXEC.
 15649*    MOVE '&"S        E          (   #00013767' TO DFHEIV0
 15650     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15652     MOVE X'2020233030303133373637' TO DFHEIV0(25:11)
 15653     CALL 'kxdfhei1' USING DFHEIV0,
 15654           FILE-ID-ERPNDB,
 15655           DFHEIV20,
 15656           DFHEIV99,
 15657           ERPNDB-KEY,
 15658           DFHEIV99,
 15659           DFHEIV99,
 15660           DFHEIV99
 15661     SET ADDRESS OF PENDING-BUSINESS TO
 15662         DFHEIV20
 15663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15664
 15665
 15666     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15667
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 289
* EL6311.cbl
 15668     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15669
 15670     IF CSUFIXL NOT = ZEROS
 15671        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15672     ELSE
 15673        MOVE SPACE               TO WS-NEW-SUFFIX.
 15674
 15675     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15676
 15677     PERFORM 8600-DEEDIT.
 15678     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15679     MOVE '4'                    TO DC-OPTION-CODE.
 15680     PERFORM 9700-DATE-LINK.
 15681
 15682     IF DATE-CONVERSION-ERROR
 15683        MOVE ER-0348             TO EMI-ERROR
 15684        MOVE -1                  TO CEFFDTL
 15685        MOVE AL-UABON            TO CEFFDTA
 15686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15687        GO TO 8200-SEND-DATAONLY
 15688     ELSE
 15689        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15690        MOVE AL-UANON            TO CEFFDTA
 15691        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15692
 15693
 15694* EXEC CICS HANDLE CONDITION
 15695*         NOTFND    (2490-RECORD-NOT-FOUND)
 15696*    END-EXEC.
 15697*    MOVE '"$I                   ! 9 #00013800' TO DFHEIV0
 15698     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15700     MOVE X'3920233030303133383030' TO DFHEIV0(25:11)
 15701     CALL 'kxdfhei1' USING DFHEIV0
 15702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15703
 15704
 15705
 15706* EXEC CICS READ
 15707*        SET     (ADDRESS OF PENDING-BUSINESS)
 15708*        DATASET (FILE-ID-ERPNDB)
 15709*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15710*        UPDATE
 15711*    END-EXEC.
 15712*    MOVE '&"S        EU         (   #00013804' TO DFHEIV0
 15713     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15715     MOVE X'2020233030303133383034' TO DFHEIV0(25:11)
 15716     CALL 'kxdfhei1' USING DFHEIV0,
 15717           FILE-ID-ERPNDB,
 15718           DFHEIV20,
 15719           DFHEIV99,
 15720           PI-PREV-CONTROL-PRIMARY,
 15721           DFHEIV99,
 15722           DFHEIV99,
 15723           DFHEIV99
 15724     SET ADDRESS OF PENDING-BUSINESS TO
 15725         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 290
* EL6311.cbl
 15726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15727
 15728
 15729     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15730        MOVE -1                 TO CMAINTL
 15731        MOVE ER-2197            TO EMI-ERROR
 15732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15733        GO TO 8200-SEND-DATAONLY.
 15734
 15735     IF PB-BILLED-DT NOT = LOW-VALUES
 15736        MOVE -1                 TO CMAINTL
 15737        MOVE ER-2129            TO EMI-ERROR
 15738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15739        GO TO 8200-SEND-DATAONLY.
 15740
 15741     IF PB-CHG-COUNT NOT = ZEROS
 15742        MOVE ER-2336            TO EMI-ERROR
 15743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15744        MOVE AL-UABON            TO CMAINTA
 15745        MOVE -1                  TO CMAINTL
 15746        GO TO 8200-SEND-DATAONLY.
 15747
 15748     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15749        PB-CHG-COUNT NOT = ZEROS
 15750        MOVE ER-2196             TO EMI-ERROR
 15751        MOVE AL-UABON            TO CMAINTA
 15752        MOVE -1                  TO CMAINTL
 15753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15754        GO TO 8200-SEND-DATAONLY.
 15755
 15756     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15757        MOVE ER-2900 TO EMI-ERROR
 15758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15759        MOVE AL-UABON         TO CMAINTA
 15760        MOVE -1               TO CMAINTL
 15761        GO TO 8200-SEND-DATAONLY.
 15762
 15763
 15764* EXEC CICS HANDLE CONDITION
 15765*         NOTFND  (2475-CONTINUE-DELETE)
 15766*    END-EXEC
 15767*    MOVE '"$I                   ! : #00013845' TO DFHEIV0
 15768     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15770     MOVE X'3A20233030303133383435' TO DFHEIV0(25:11)
 15771     CALL 'kxdfhei1' USING DFHEIV0
 15772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15773
 15774     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15775     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15776     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15777     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15778
 15779
 15780* EXEC CICS READ
 15781*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15782*        DATASET (FILE-ID-ELCERT)
 15783*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 291
* EL6311.cbl
 15784*        UPDATE
 15785*    END-EXEC.
 15786*    MOVE '&"S        EU         (   #00013854' TO DFHEIV0
 15787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15789     MOVE X'2020233030303133383534' TO DFHEIV0(25:11)
 15790     CALL 'kxdfhei1' USING DFHEIV0,
 15791           FILE-ID-ELCERT,
 15792           DFHEIV20,
 15793           DFHEIV99,
 15794           ELCERT-KEY,
 15795           DFHEIV99,
 15796           DFHEIV99,
 15797           DFHEIV99
 15798     SET ADDRESS OF CERTIFICATE-MASTER TO
 15799         DFHEIV20
 15800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15801
 15802
 15803     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15804
 15805     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15806     MOVE 'B'                    TO JP-RECORD-TYPE.
 15807     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15808     PERFORM 8400-LOG-JOURNAL-RECORD.
 15809
 15810     IF PB-CI-LIVES NOT NUMERIC
 15811         MOVE ZERO                    TO PB-CI-LIVES.
 15812
 15813     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15814        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15815           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15816           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15817           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15818                                            CM-LF-CANCEL-DT
 15819           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15820        ELSE
 15821           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15822           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15823           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15824           MOVE PB-CI-LIVES              TO CM-LIVES.
 15825
 15826     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15827        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15828           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15829               MOVE CM-LF-STATUS-AT-CANCEL
 15830                                        TO CM-LF-CURRENT-STATUS
 15831               MOVE SPACE
 15832                                        TO CM-LF-STATUS-AT-CANCEL
 15833           ELSE
 15834               MOVE PB-CI-LF-POLICY-STATUS
 15835                                        TO CM-LF-CURRENT-STATUS
 15836        ELSE
 15837           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15838
 15839
 15840     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15841        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 292
* EL6311.cbl
 15842           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15843           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15844           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15845                                            CM-AH-CANCEL-DT
 15846           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15847        ELSE
 15848           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15849           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15850           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15851           MOVE PB-CI-LIVES              TO CM-LIVES.
 15852
 15853     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15854        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15855           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15856               MOVE CM-AH-STATUS-AT-CANCEL
 15857                                        TO CM-AH-CURRENT-STATUS
 15858               MOVE SPACE
 15859                                        TO CM-AH-STATUS-AT-CANCEL
 15860           ELSE
 15861               MOVE PB-CI-AH-POLICY-STATUS
 15862                                        TO CM-AH-CURRENT-STATUS
 15863        ELSE
 15864           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15865
 15866 2450-REWRITE-CERT.
 15867     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15868     MOVE 'C'                      TO JP-RECORD-TYPE.
 15869     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15870
 15871
 15872* EXEC CICS REWRITE
 15873*        DATASET  (FILE-ID-ELCERT)
 15874*        FROM     (CERTIFICATE-MASTER)
 15875*    END-EXEC.
 15876     MOVE LENGTH OF
 15877      CERTIFICATE-MASTER
 15878       TO DFHEIV11
 15879*    MOVE '&& L                  %   #00013929' TO DFHEIV0
 15880     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15881     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15882     MOVE X'2020233030303133393239' TO DFHEIV0(25:11)
 15883     CALL 'kxdfhei1' USING DFHEIV0,
 15884           FILE-ID-ELCERT,
 15885           CERTIFICATE-MASTER,
 15886           DFHEIV11,
 15887           DFHEIV99
 15888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15889
 15890
 15891     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15892
 15893     PERFORM 8400-LOG-JOURNAL-RECORD.
 15894
 15895 2475-CONTINUE-DELETE.
 15896     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15897     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15898
 15899     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 293
* EL6311.cbl
 15900     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15901
 15902     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15903
 15904     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15905     MOVE 'D'                    TO JP-RECORD-TYPE
 15906     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15907
 15908
 15909* EXEC CICS DELETE
 15910*        DATASET    (FILE-ID-ERPNDB)
 15911*    END-EXEC.
 15912*    MOVE '&(                    &   #00013951' TO DFHEIV0
 15913     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15915     MOVE X'2020233030303133393531' TO DFHEIV0(25:11)
 15916     CALL 'kxdfhei1' USING DFHEIV0,
 15917           FILE-ID-ERPNDB,
 15918           DFHEIV99,
 15919           DFHEIV99,
 15920           DFHEIV99,
 15921           DFHEIV99
 15922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15923
 15924
 15925     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15926
 15927     PERFORM 8400-LOG-JOURNAL-RECORD.
 15928
 15929     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15930     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15931
 15932
 15933* EXEC CICS HANDLE CONDITION
 15934*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15935*    END-EXEC.
 15936*    MOVE '"$I                   ! ; #00013962' TO DFHEIV0
 15937     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15939     MOVE X'3B20233030303133393632' TO DFHEIV0(25:11)
 15940     CALL 'kxdfhei1' USING DFHEIV0
 15941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15942
 15943
 15944
 15945* EXEC CICS READ
 15946*        SET     (ADDRESS OF PENDING-BUSINESS)
 15947*        DATASET (FILE-ID-ERPNDB)
 15948*        RIDFLD  (ERPNDB-KEY)
 15949*        UPDATE
 15950*    END-EXEC.
 15951*    MOVE '&"S        EU         (   #00013966' TO DFHEIV0
 15952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15954     MOVE X'2020233030303133393636' TO DFHEIV0(25:11)
 15955     CALL 'kxdfhei1' USING DFHEIV0,
 15956           FILE-ID-ERPNDB,
 15957           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 294
* EL6311.cbl
 15958           DFHEIV99,
 15959           ERPNDB-KEY,
 15960           DFHEIV99,
 15961           DFHEIV99,
 15962           DFHEIV99
 15963     SET ADDRESS OF PENDING-BUSINESS TO
 15964         DFHEIV20
 15965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15966
 15967
 15968     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 15969     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15970
 15971     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15972        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15973        MOVE 'D'                 TO JP-RECORD-TYPE
 15974        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15975
 15976* EXEC CICS DELETE
 15977*            DATASET    (FILE-ID-ERPNDB)
 15978*       END-EXEC
 15979*    MOVE '&(                    &   #00013980' TO DFHEIV0
 15980     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15982     MOVE X'2020233030303133393830' TO DFHEIV0(25:11)
 15983     CALL 'kxdfhei1' USING DFHEIV0,
 15984           FILE-ID-ERPNDB,
 15985           DFHEIV99,
 15986           DFHEIV99,
 15987           DFHEIV99,
 15988           DFHEIV99
 15989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15990        PERFORM 8400-LOG-JOURNAL-RECORD
 15991     ELSE
 15992        MOVE 'B'                 TO JP-RECORD-TYPE
 15993        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15994        PERFORM 8400-LOG-JOURNAL-RECORD
 15995        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 15996        MOVE 'C'                 TO JP-RECORD-TYPE
 15997        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15998
 15999* EXEC CICS REWRITE
 16000*            DATASET    (FILE-ID-ERPNDB)
 16001*            FROM       (PENDING-BUSINESS)
 16002*       END-EXEC
 16003     MOVE LENGTH OF
 16004      PENDING-BUSINESS
 16005       TO DFHEIV11
 16006*    MOVE '&& L                  %   #00013991' TO DFHEIV0
 16007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16009     MOVE X'2020233030303133393931' TO DFHEIV0(25:11)
 16010     CALL 'kxdfhei1' USING DFHEIV0,
 16011           FILE-ID-ERPNDB,
 16012           PENDING-BUSINESS,
 16013           DFHEIV11,
 16014           DFHEIV99
 16015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 295
* EL6311.cbl
 16016        PERFORM 8400-LOG-JOURNAL-RECORD.
 16017
 16018******************************************************************
 16019*                                                                *
 16020*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16021*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16022*                                                                *
 16023******************************************************************
 16024
 16025     IF NOT PI-AR-PROCESSING
 16026        GO TO 2480-DELETE-FINISHED.
 16027
 16028     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16029        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16030        NEXT SENTENCE
 16031     ELSE
 16032        GO TO 2480-DELETE-FINISHED.
 16033
 16034
 16035* EXEC CICS HANDLE CONDITION
 16036*         NOTFND    (2480-DELETE-FINISHED)
 16037*    END-EXEC.
 16038*    MOVE '"$I                   ! < #00014013' TO DFHEIV0
 16039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16041     MOVE X'3C20233030303134303133' TO DFHEIV0(25:11)
 16042     CALL 'kxdfhei1' USING DFHEIV0
 16043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16044
 16045
 16046     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16047     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16048
 16049
 16050* EXEC CICS READ
 16051*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16052*        DATASET (FILE-ID-ERRQST)
 16053*        RIDFLD  (ERRQST-KEY)
 16054*        UPDATE
 16055*    END-EXEC.
 16056*    MOVE '&"S        EU         (   #00014020' TO DFHEIV0
 16057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16059     MOVE X'2020233030303134303230' TO DFHEIV0(25:11)
 16060     CALL 'kxdfhei1' USING DFHEIV0,
 16061           FILE-ID-ERRQST,
 16062           DFHEIV20,
 16063           DFHEIV99,
 16064           ERRQST-KEY,
 16065           DFHEIV99,
 16066           DFHEIV99,
 16067           DFHEIV99
 16068     SET ADDRESS OF AR-REQUEST-RECORD TO
 16069         DFHEIV20
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16071
 16072
 16073     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 296
* EL6311.cbl
 16074
 16075     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16076
 16077     MOVE 'D'                      TO JP-RECORD-TYPE.
 16078     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16079
 16080
 16081* EXEC CICS DELETE
 16082*         DATASET    (FILE-ID-ERRQST)
 16083*    END-EXEC.
 16084*    MOVE '&(                    &   #00014034' TO DFHEIV0
 16085     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16086     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16087     MOVE X'2020233030303134303334' TO DFHEIV0(25:11)
 16088     CALL 'kxdfhei1' USING DFHEIV0,
 16089           FILE-ID-ERRQST,
 16090           DFHEIV99,
 16091           DFHEIV99,
 16092           DFHEIV99,
 16093           DFHEIV99
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16095
 16096
 16097     PERFORM 8400-LOG-JOURNAL-RECORD.
 16098
 16099 2480-DELETE-FINISHED.
 16100     MOVE ZEROS                  TO EMI-ERROR.
 16101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16102     MOVE LOW-VALUES             TO EL631CI.
 16103     MOVE -1                     TO CMAINTL.
 16104     GO TO 8100-SEND-INITIAL-MAP.
 16105
 16106 2485-BATCH-HDR-NOT-FOUND.
 16107     MOVE -1                     TO CMAINTL
 16108     MOVE AL-UABON               TO CMAINTA.
 16109     MOVE ER-7450                TO EMI-ERROR.
 16110     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16111     GO TO 8200-SEND-DATAONLY.
 16112
 16113 2490-RECORD-NOT-FOUND.
 16114     MOVE -1                     TO CMAINTL
 16115     MOVE AL-UABON               TO CMAINTA.
 16116     MOVE ER-7451                TO EMI-ERROR.
 16117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16118     GO TO 8200-SEND-DATAONLY.
 16119
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 297
* EL6311.cbl
 16121
 16122***************************************************************
 16123*                                                             *
 16124*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16125*                                                             *
 16126***************************************************************
 16127
 16128***************************************************************
 16129*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16130*     AN ALREADY BILLED RECORD.                               *
 16131***************************************************************
 16132
 16133 2700-BUILD-CORRECTION-RECORD.
 16134     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16135     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16136     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16137     MOVE '5'                    TO DC-OPTION-CODE.
 16138     PERFORM 9700-DATE-LINK.
 16139     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16140
 16141     IF PB-CHG-COUNT = ZEROS
 16142        MOVE +1                  TO WS-SEQ-SAVE
 16143     ELSE
 16144        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16145
 16146     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16147     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16148
 16149     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16150
 16151     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16152     MOVE 'A'                    TO JP-RECORD-TYPE.
 16153     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16154
 16155
 16156* EXEC CICS WRITE
 16157*        DATASET    (FILE-ID-ERPNDB)
 16158*        FROM       (PENDING-BUSINESS)
 16159*        RIDFLD     (PB-CONTROL-PRIMARY)
 16160*    END-EXEC.
 16161     MOVE LENGTH OF
 16162      PENDING-BUSINESS
 16163       TO DFHEIV11
 16164*    MOVE '&$ L                  ''   #00014096' TO DFHEIV0
 16165     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16166     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16167     MOVE X'2020233030303134303936' TO DFHEIV0(25:11)
 16168     CALL 'kxdfhei1' USING DFHEIV0,
 16169           FILE-ID-ERPNDB,
 16170           PENDING-BUSINESS,
 16171           DFHEIV11,
 16172           PB-CONTROL-PRIMARY,
 16173           DFHEIV99,
 16174           DFHEIV99
 16175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16176
 16177
 16178     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 298
* EL6311.cbl
 16179
 16180     PERFORM 8400-LOG-JOURNAL-RECORD.
 16181
 16182 2799-EXIT.
 16183      EXIT.
 16184
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 299
* EL6311.cbl
 16186
 16187******************************************************************
 16188*                                                                *
 16189*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16190*                                                                *
 16191******************************************************************
 16192
 16193 2800-REWRITE-ISSUE-CERT-KEY.
 16194     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16195
 16196     IF  BCERTNOL GREATER THAN ZEROS
 16197         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16198
 16199     IF  BSUFIXL  GREATER THAN ZEROS
 16200         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16201
 16202     IF  BEFFDTL  GREATER THAN ZEROS
 16203         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16204
 16205 2810-READ-BY-ACCOUNT.
 16206
 16207* EXEC CICS HANDLE CONDITION
 16208*         NOTFND    (2820-PROCESS-REWRITE)
 16209*    END-EXEC.
 16210*    MOVE '"$I                   ! = #00014130' TO DFHEIV0
 16211     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16213     MOVE X'3D20233030303134313330' TO DFHEIV0(25:11)
 16214     CALL 'kxdfhei1' USING DFHEIV0
 16215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16216
 16217
 16218
 16219* EXEC CICS READ
 16220*        SET     (ADDRESS OF PENDING-BUSINESS)
 16221*        DATASET (FILE-ID-ERPNDB2)
 16222*        RIDFLD  (ERPNDB-ALT-KEY)
 16223*    END-EXEC.
 16224*    MOVE '&"S        E          (   #00014134' TO DFHEIV0
 16225     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16227     MOVE X'2020233030303134313334' TO DFHEIV0(25:11)
 16228     CALL 'kxdfhei1' USING DFHEIV0,
 16229           FILE-ID-ERPNDB2,
 16230           DFHEIV20,
 16231           DFHEIV99,
 16232           ERPNDB-ALT-KEY,
 16233           DFHEIV99,
 16234           DFHEIV99,
 16235           DFHEIV99
 16236     SET ADDRESS OF PENDING-BUSINESS TO
 16237         DFHEIV20
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
 16240
 16241     GO TO 2890-DUPLICATE-RECORD.
 16242
 16243  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 300
* EL6311.cbl
 16244
 16245* EXEC CICS HANDLE CONDITION
 16246*         NOTFND    (2885-RECORD-MISSING)
 16247*    END-EXEC.
 16248*    MOVE '"$I                   ! > #00014143' TO DFHEIV0
 16249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16251     MOVE X'3E20233030303134313433' TO DFHEIV0(25:11)
 16252     CALL 'kxdfhei1' USING DFHEIV0
 16253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16254
 16255
 16256     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16257
 16258
 16259* EXEC CICS READ
 16260*        SET     (ADDRESS OF PENDING-BUSINESS)
 16261*        DATASET (FILE-ID-ERPNDB)
 16262*        RIDFLD  (ERPNDB-KEY)
 16263*        UPDATE
 16264*    END-EXEC.
 16265*    MOVE '&"S        EU         (   #00014149' TO DFHEIV0
 16266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16268     MOVE X'2020233030303134313439' TO DFHEIV0(25:11)
 16269     CALL 'kxdfhei1' USING DFHEIV0,
 16270           FILE-ID-ERPNDB,
 16271           DFHEIV20,
 16272           DFHEIV99,
 16273           ERPNDB-KEY,
 16274           DFHEIV99,
 16275           DFHEIV99,
 16276           DFHEIV99
 16277     SET ADDRESS OF PENDING-BUSINESS TO
 16278         DFHEIV20
 16279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16280
 16281
 16282     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16283     MOVE 'D'                    TO JP-RECORD-TYPE.
 16284     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16285     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16286
 16287     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16288
 16289     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16290     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16291     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16292
 16293
 16294* EXEC CICS DELETE
 16295*        DATASET    (FILE-ID-ERPNDB)
 16296*    END-EXEC.
 16297*    MOVE '&(                    &   #00014167' TO DFHEIV0
 16298     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16300     MOVE X'2020233030303134313637' TO DFHEIV0(25:11)
 16301     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 301
* EL6311.cbl
 16302           FILE-ID-ERPNDB,
 16303           DFHEIV99,
 16304           DFHEIV99,
 16305           DFHEIV99,
 16306           DFHEIV99
 16307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16308
 16309
 16310     PERFORM 8400-LOG-JOURNAL-RECORD.
 16311
 16312
 16313* EXEC CICS GETMAIN
 16314*        SET      (ADDRESS OF PENDING-BUSINESS)
 16315*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16316*        INITIMG  (GETMAIN-SPACE)
 16317*    END-EXEC.
 16318*    MOVE ',"IL                  $   #00014173' TO DFHEIV0
 16319     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16320     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16321     MOVE X'2020233030303134313733' TO DFHEIV0(25:11)
 16322     CALL 'kxdfhei1' USING DFHEIV0,
 16323           DFHEIV20,
 16324           ERPNDB-RECORD-LENGTH,
 16325           GETMAIN-SPACE
 16326     SET ADDRESS OF PENDING-BUSINESS TO
 16327         DFHEIV20
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
 16331     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16332
 16333
 16334* EXEC CICS HANDLE CONDITION
 16335*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16336*    END-EXEC.
 16337*    MOVE '"$I                   ! ? #00014181' TO DFHEIV0
 16338     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16340     MOVE X'3F20233030303134313831' TO DFHEIV0(25:11)
 16341     CALL 'kxdfhei1' USING DFHEIV0
 16342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16343
 16344
 16345
 16346* EXEC CICS READ
 16347*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16348*        DATASET (FILE-ID-ELCERT)
 16349*        RIDFLD  (ELCERT-KEY)
 16350*        UPDATE
 16351*    END-EXEC.
 16352*    MOVE '&"S        EU         (   #00014185' TO DFHEIV0
 16353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16354     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16355     MOVE X'2020233030303134313835' TO DFHEIV0(25:11)
 16356     CALL 'kxdfhei1' USING DFHEIV0,
 16357           FILE-ID-ELCERT,
 16358           DFHEIV20,
 16359           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 302
* EL6311.cbl
 16360           ELCERT-KEY,
 16361           DFHEIV99,
 16362           DFHEIV99,
 16363           DFHEIV99
 16364     SET ADDRESS OF CERTIFICATE-MASTER TO
 16365         DFHEIV20
 16366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16367
 16368
 16369     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16370     MOVE 'B'                    TO JP-RECORD-TYPE
 16371     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16372     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16373
 16374     IF INSURED-ADDR-PRESENT
 16375        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16376
 16377     IF CERT-NOTES-ARE-NOT-PRESENT
 16378        MOVE SPACE               TO WS-CERT-NOTE-SW
 16379     ELSE
 16380        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16381
 16382     IF CERT-ADDED-BATCH      OR
 16383        CERT-AND-CLAIM-ONLINE OR
 16384        CERT-WAS-CREATED-FOR-CLAIM
 16385        NEXT SENTENCE
 16386     ELSE
 16387        GO TO 2825-DELETE-CERTIFICATE.
 16388
 16389     PERFORM 8400-LOG-JOURNAL-RECORD.
 16390
 16391*********************************************************
 16392** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16393     IF CERT-ADDED-BATCH
 16394         GO TO 2822-REWRITE-ELCERT.
 16395*********************************************************
 16396
 16397     IF NO-CLAIM-ATTACHED
 16398        NEXT SENTENCE
 16399     ELSE
 16400        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16401        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16402
 16403 2822-REWRITE-ELCERT.
 16404     MOVE 'C'                    TO JP-RECORD-TYPE
 16405     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16406
 16407     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16408
 16409
 16410* EXEC CICS REWRITE
 16411*         DATASET    (FILE-ID-ELCERT)
 16412*         FROM       (CERTIFICATE-MASTER)
 16413*    END-EXEC.
 16414     MOVE LENGTH OF
 16415      CERTIFICATE-MASTER
 16416       TO DFHEIV11
 16417*    MOVE '&& L                  %   #00014232' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 303
* EL6311.cbl
 16418     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16419     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16420     MOVE X'2020233030303134323332' TO DFHEIV0(25:11)
 16421     CALL 'kxdfhei1' USING DFHEIV0,
 16422           FILE-ID-ELCERT,
 16423           CERTIFICATE-MASTER,
 16424           DFHEIV11,
 16425           DFHEIV99
 16426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16427
 16428
 16429     PERFORM 8400-LOG-JOURNAL-RECORD.
 16430
 16431     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16432
 16433 2825-DELETE-CERTIFICATE.
 16434     MOVE 'D'                      TO JP-RECORD-TYPE.
 16435     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16436
 16437     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16438
 16439
 16440* EXEC CICS DELETE
 16441*         DATASET    (FILE-ID-ELCERT)
 16442*    END-EXEC.
 16443*    MOVE '&(                    &   #00014247' TO DFHEIV0
 16444     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16446     MOVE X'2020233030303134323437' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           FILE-ID-ELCERT,
 16449           DFHEIV99,
 16450           DFHEIV99,
 16451           DFHEIV99,
 16452           DFHEIV99
 16453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16454
 16455
 16456     PERFORM 8400-LOG-JOURNAL-RECORD.
 16457
 16458******************************************************************
 16459*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16460******************************************************************
 16461
 16462     IF CERT-NOTES-ARE-PRESENT
 16463        NEXT SENTENCE
 16464     ELSE
 16465        GO TO 2827-DELETE-MAILING.
 16466
 16467
 16468* EXEC CICS HANDLE CONDITION
 16469*         NOTFND  (2827-DELETE-MAILING)
 16470*    END-EXEC.
 16471*    MOVE '"$I                   ! @ #00014262' TO DFHEIV0
 16472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16474     MOVE X'4020233030303134323632' TO DFHEIV0(25:11)
 16475     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 304
* EL6311.cbl
 16476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16477
 16478
 16479
 16480* EXEC CICS READ
 16481*        EQUAL
 16482*        DATASET   (FILE-ID-ERNOTE)
 16483*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16484*        RIDFLD    (ELCERT-KEY)
 16485*        UPDATE
 16486*    END-EXEC.
 16487*    MOVE '&"S        EU         (   #00014266' TO DFHEIV0
 16488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16489     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16490     MOVE X'2020233030303134323636' TO DFHEIV0(25:11)
 16491     CALL 'kxdfhei1' USING DFHEIV0,
 16492           FILE-ID-ERNOTE,
 16493           DFHEIV20,
 16494           DFHEIV99,
 16495           ELCERT-KEY,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99
 16499     SET ADDRESS OF CERTIFICATE-NOTE TO
 16500         DFHEIV20
 16501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16502
 16503
 16504     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16505     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16506     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16507
 16508     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16509
 16510
 16511* EXEC CICS DELETE
 16512*        DATASET   (FILE-ID-ERNOTE)
 16513*    END-EXEC.
 16514*    MOVE '&(                    &   #00014280' TO DFHEIV0
 16515     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16517     MOVE X'2020233030303134323830' TO DFHEIV0(25:11)
 16518     CALL 'kxdfhei1' USING DFHEIV0,
 16519           FILE-ID-ERNOTE,
 16520           DFHEIV99,
 16521           DFHEIV99,
 16522           DFHEIV99,
 16523           DFHEIV99
 16524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16525
 16526
 16527     PERFORM 8400-LOG-JOURNAL-RECORD.
 16528
 16529******************************************************************
 16530*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16531******************************************************************
 16532
 16533 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 305
* EL6311.cbl
 16534     IF CERT-ADDRESS-PRESENT
 16535        NEXT SENTENCE
 16536     ELSE
 16537        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16538
 16539
 16540* EXEC CICS HANDLE CONDITION
 16541*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16542*    END-EXEC.
 16543*    MOVE '"$I                   ! A #00014296' TO DFHEIV0
 16544     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16546     MOVE X'4120233030303134323936' TO DFHEIV0(25:11)
 16547     CALL 'kxdfhei1' USING DFHEIV0
 16548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16549
 16550
 16551     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16552
 16553
 16554* EXEC CICS READ
 16555*        EQUAL
 16556*        DATASET   (FILE-ID-ERMAIL)
 16557*        SET       (ADDRESS OF MAILING-DATA)
 16558*        RIDFLD    (ERMAIL-KEY)
 16559*        UPDATE
 16560*    END-EXEC.
 16561*    MOVE '&"S        EU         (   #00014302' TO DFHEIV0
 16562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16563     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16564     MOVE X'2020233030303134333032' TO DFHEIV0(25:11)
 16565     CALL 'kxdfhei1' USING DFHEIV0,
 16566           FILE-ID-ERMAIL,
 16567           DFHEIV20,
 16568           DFHEIV99,
 16569           ERMAIL-KEY,
 16570           DFHEIV99,
 16571           DFHEIV99,
 16572           DFHEIV99
 16573     SET ADDRESS OF MAILING-DATA TO
 16574         DFHEIV20
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16579     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16580     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16581
 16582     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16583
 16584
 16585* EXEC CICS DELETE
 16586*        DATASET   (FILE-ID-ERMAIL)
 16587*    END-EXEC.
 16588*    MOVE '&(                    &   #00014316' TO DFHEIV0
 16589     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16591     MOVE X'2020233030303134333136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 306
* EL6311.cbl
 16592     CALL 'kxdfhei1' USING DFHEIV0,
 16593           FILE-ID-ERMAIL,
 16594           DFHEIV99,
 16595           DFHEIV99,
 16596           DFHEIV99,
 16597           DFHEIV99
 16598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16599
 16600
 16601     PERFORM 8400-LOG-JOURNAL-RECORD.
 16602
 16603 2830-BUILD-NEW-ISSUE-RECORD.
 16604     MOVE SPACES                 TO ELCERT-KEY.
 16605
 16606     IF  BCERTNOL GREATER THAN ZEROS
 16607         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16608
 16609     IF  BSUFIXL  GREATER THAN ZEROS
 16610         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16611
 16612     IF BEFFDTL GREATER THAN ZEROS
 16613        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16614
 16615 2870-WRITE-PENDING-BUSINESS.
 16616     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16617     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16618     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16619     MOVE '5'                    TO DC-OPTION-CODE.
 16620     PERFORM 9700-DATE-LINK.
 16621     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16622
 16623     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16624
 16625     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16626     MOVE 'A'                    TO JP-RECORD-TYPE.
 16627     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16628
 16629
 16630* EXEC CICS WRITE
 16631*        DATASET  (FILE-ID-ERPNDB)
 16632*        FROM     (PENDING-BUSINESS)
 16633*        RIDFLD   (PB-CONTROL-PRIMARY)
 16634*    END-EXEC.
 16635     MOVE LENGTH OF
 16636      PENDING-BUSINESS
 16637       TO DFHEIV11
 16638*    MOVE '&$ L                  ''   #00014348' TO DFHEIV0
 16639     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16641     MOVE X'2020233030303134333438' TO DFHEIV0(25:11)
 16642     CALL 'kxdfhei1' USING DFHEIV0,
 16643           FILE-ID-ERPNDB,
 16644           PENDING-BUSINESS,
 16645           DFHEIV11,
 16646           PB-CONTROL-PRIMARY,
 16647           DFHEIV99,
 16648           DFHEIV99
 16649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 307
* EL6311.cbl
 16650
 16651
 16652     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16653
 16654     PERFORM 8400-LOG-JOURNAL-RECORD.
 16655
 16656     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16657
 16658 2885-RECORD-MISSING.
 16659     MOVE -1                     TO BMAINTL
 16660     MOVE AL-UABON               TO BMAINTA
 16661     MOVE ER-2902                TO EMI-ERROR.
 16662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16663     GO TO 8200-SEND-DATAONLY.
 16664
 16665 2890-DUPLICATE-RECORD.
 16666     MOVE -1                     TO BMAINTL.
 16667     MOVE AL-UABON               TO BCERTNOA.
 16668     MOVE AL-UNBON               TO BEFFDTA.
 16669     MOVE SPACE                  TO BMAINTI.
 16670
 16671     MOVE 1                      TO EMI-SUB
 16672                                    EMI-SWITCH1
 16673                                    EMI-SWITCH-AREA-1
 16674                                    EMI-SWITCH-AREA-2.
 16675
 16676     MOVE SPACES                 TO EMI-ERROR-LINES.
 16677
 16678
 16679* EXEC CICS SYNCPOINT ROLLBACK
 16680*    END-EXEC.
 16681*    MOVE '6"R                   !   #00014380' TO DFHEIV0
 16682     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16684     MOVE X'2020233030303134333830' TO DFHEIV0(25:11)
 16685     CALL 'kxdfhei1' USING DFHEIV0
 16686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16687
 16688
 16689     MOVE ER-2247                TO EMI-ERROR.
 16690     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16691     GO TO 8200-SEND-DATAONLY.
 16692
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 308
* EL6311.cbl
 16694
 16695******************************************************************
 16696*                                                                *
 16697*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16698*                                                                *
 16699******************************************************************
 16700
 16701 2900-REWRITE-CAN-CERT-KEY.
 16702     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16703
 16704     IF  CCERTNOL GREATER THAN ZEROS
 16705         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16706
 16707     IF  CSUFIXL  GREATER THAN ZEROS
 16708         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16709
 16710     IF  CEFFDTL  GREATER THAN ZEROS
 16711         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16712
 16713 2910-READ-BY-ACCOUNT.
 16714
 16715* EXEC CICS HANDLE CONDITION
 16716*         NOTFND    (2920-PROCESS-REWRITE)
 16717*    END-EXEC.
 16718*    MOVE '"$I                   ! B #00014408' TO DFHEIV0
 16719     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16721     MOVE X'4220233030303134343038' TO DFHEIV0(25:11)
 16722     CALL 'kxdfhei1' USING DFHEIV0
 16723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16724
 16725
 16726
 16727* EXEC CICS READ
 16728*        SET     (ADDRESS OF PENDING-BUSINESS)
 16729*        DATASET (FILE-ID-ERPNDB2)
 16730*        RIDFLD  (ERPNDB-ALT-KEY)
 16731*    END-EXEC.
 16732*    MOVE '&"S        E          (   #00014412' TO DFHEIV0
 16733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16735     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16736     CALL 'kxdfhei1' USING DFHEIV0,
 16737           FILE-ID-ERPNDB2,
 16738           DFHEIV20,
 16739           DFHEIV99,
 16740           ERPNDB-ALT-KEY,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV99
 16744     SET ADDRESS OF PENDING-BUSINESS TO
 16745         DFHEIV20
 16746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16747
 16748
 16749     GO TO 2990-DUPLICATE-RECORD.
 16750
 16751  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 309
* EL6311.cbl
 16752
 16753* EXEC CICS HANDLE CONDITION
 16754*         NOTFND    (2985-RECORD-MISSING)
 16755*    END-EXEC.
 16756*    MOVE '"$I                   ! C #00014421' TO DFHEIV0
 16757     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16759     MOVE X'4320233030303134343231' TO DFHEIV0(25:11)
 16760     CALL 'kxdfhei1' USING DFHEIV0
 16761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16762
 16763
 16764     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16765
 16766
 16767* EXEC CICS READ
 16768*        SET     (ADDRESS OF PENDING-BUSINESS)
 16769*        DATASET (FILE-ID-ERPNDB)
 16770*        RIDFLD  (ERPNDB-KEY)
 16771*        UPDATE
 16772*    END-EXEC.
 16773*    MOVE '&"S        EU         (   #00014427' TO DFHEIV0
 16774     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16775     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16776     MOVE X'2020233030303134343237' TO DFHEIV0(25:11)
 16777     CALL 'kxdfhei1' USING DFHEIV0,
 16778           FILE-ID-ERPNDB,
 16779           DFHEIV20,
 16780           DFHEIV99,
 16781           ERPNDB-KEY,
 16782           DFHEIV99,
 16783           DFHEIV99,
 16784           DFHEIV99
 16785     SET ADDRESS OF PENDING-BUSINESS TO
 16786         DFHEIV20
 16787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16788
 16789
 16790     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16791     MOVE 'D'                    TO JP-RECORD-TYPE.
 16792     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16793     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16794
 16795     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16796
 16797     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16798     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16799     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16800
 16801
 16802* EXEC CICS DELETE
 16803*        DATASET    (FILE-ID-ERPNDB)
 16804*    END-EXEC.
 16805*    MOVE '&(                    &   #00014445' TO DFHEIV0
 16806     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16808     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 16809     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 310
* EL6311.cbl
 16810           FILE-ID-ERPNDB,
 16811           DFHEIV99,
 16812           DFHEIV99,
 16813           DFHEIV99,
 16814           DFHEIV99
 16815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16816
 16817
 16818     PERFORM 8400-LOG-JOURNAL-RECORD.
 16819
 16820
 16821* EXEC CICS GETMAIN
 16822*        SET      (ADDRESS OF PENDING-BUSINESS)
 16823*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16824*        INITIMG  (GETMAIN-SPACE)
 16825*    END-EXEC.
 16826*    MOVE ',"IL                  $   #00014451' TO DFHEIV0
 16827     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16829     MOVE X'2020233030303134343531' TO DFHEIV0(25:11)
 16830     CALL 'kxdfhei1' USING DFHEIV0,
 16831           DFHEIV20,
 16832           ERPNDB-RECORD-LENGTH,
 16833           GETMAIN-SPACE
 16834     SET ADDRESS OF PENDING-BUSINESS TO
 16835         DFHEIV20
 16836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16837
 16838
 16839     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16840
 16841 2950-PROCESS-CANCELS.
 16842
 16843
 16844* EXEC CICS HANDLE CONDITION
 16845*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16846*    END-EXEC.
 16847*    MOVE '"$I                   ! D #00014461' TO DFHEIV0
 16848     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16849     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16850     MOVE X'4420233030303134343631' TO DFHEIV0(25:11)
 16851     CALL 'kxdfhei1' USING DFHEIV0
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16853
 16854
 16855
 16856* EXEC CICS READ
 16857*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16858*        DATASET (FILE-ID-ELCERT)
 16859*        RIDFLD  (ELCERT-KEY)
 16860*        UPDATE
 16861*    END-EXEC.
 16862*    MOVE '&"S        EU         (   #00014465' TO DFHEIV0
 16863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16864     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16865     MOVE X'2020233030303134343635' TO DFHEIV0(25:11)
 16866     CALL 'kxdfhei1' USING DFHEIV0,
 16867           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 311
* EL6311.cbl
 16868           DFHEIV20,
 16869           DFHEIV99,
 16870           ELCERT-KEY,
 16871           DFHEIV99,
 16872           DFHEIV99,
 16873           DFHEIV99
 16874     SET ADDRESS OF CERTIFICATE-MASTER TO
 16875         DFHEIV20
 16876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16877
 16878
 16879     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16880
 16881     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16882     MOVE 'B'                      TO JP-RECORD-TYPE.
 16883     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16884     PERFORM 8400-LOG-JOURNAL-RECORD.
 16885
 16886     IF PB-CI-LIVES NOT NUMERIC
 16887         MOVE ZERO                    TO PB-CI-LIVES.
 16888
 16889     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16890        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16891        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16892        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16893                                         CM-LF-CANCEL-DT
 16894     ELSE
 16895        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16896        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16897        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16898        MOVE PB-CI-LIVES              TO CM-LIVES.
 16899
 16900     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16901        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16902            MOVE CM-LF-STATUS-AT-CANCEL
 16903                                     TO CM-LF-CURRENT-STATUS
 16904            MOVE SPACE
 16905                                     TO CM-LF-STATUS-AT-CANCEL
 16906        ELSE
 16907            MOVE PB-CI-LF-POLICY-STATUS
 16908                                     TO CM-LF-CURRENT-STATUS
 16909     ELSE
 16910        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16911
 16912     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16913        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16914        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16915        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16916                                         CM-AH-CANCEL-DT
 16917     ELSE
 16918        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16919        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16920        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16921        MOVE PB-CI-LIVES              TO CM-LIVES.
 16922
 16923     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16924        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16925            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 312
* EL6311.cbl
 16926                                     TO CM-AH-CURRENT-STATUS
 16927            MOVE SPACE
 16928                                     TO CM-AH-STATUS-AT-CANCEL
 16929        ELSE
 16930            MOVE PB-CI-AH-POLICY-STATUS
 16931                                     TO CM-AH-CURRENT-STATUS
 16932     ELSE
 16933        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16934
 16935 2975-REWRITE-CERT.
 16936     MOVE 'C'                      TO JP-RECORD-TYPE.
 16937     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16938
 16939
 16940* EXEC CICS REWRITE
 16941*        DATASET    (FILE-ID-ELCERT)
 16942*        FROM       (CERTIFICATE-MASTER)
 16943*    END-EXEC.
 16944     MOVE LENGTH OF
 16945      CERTIFICATE-MASTER
 16946       TO DFHEIV11
 16947*    MOVE '&& L                  %   #00014532' TO DFHEIV0
 16948     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16949     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16950     MOVE X'2020233030303134353332' TO DFHEIV0(25:11)
 16951     CALL 'kxdfhei1' USING DFHEIV0,
 16952           FILE-ID-ELCERT,
 16953           CERTIFICATE-MASTER,
 16954           DFHEIV11,
 16955           DFHEIV99
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959     PERFORM 8400-LOG-JOURNAL-RECORD.
 16960
 16961 2960-BUILD-NEW-CANCEL-RECORD.
 16962     IF  CCERTNOL GREATER THAN ZEROS
 16963         MOVE CCERTNOI            TO PB-CERT-PRIME.
 16964
 16965     IF  CSUFIXL  GREATER THAN ZEROS
 16966         MOVE CSUFIXI             TO PB-CERT-SFX.
 16967
 16968     IF  CEFFDTL  GREATER  THAN ZEROS
 16969         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 16970
 16971 2970-WRITE-PENDING-BUSINESS.
 16972     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16973     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16974     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16975     MOVE '5'                    TO DC-OPTION-CODE.
 16976     PERFORM 9700-DATE-LINK.
 16977     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16978
 16979     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16980
 16981     MOVE SPACES                 TO PB-CI-INSURED-NAME
 16982                                    PB-CI-INSURED-SEX
 16983                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 313
* EL6311.cbl
 16984                                    PB-CI-AH-BENEFIT-CD
 16985                                    PB-CI-RATE-CLASS
 16986                                    PB-CI-RATE-DEV-LF
 16987                                    PB-CI-RATE-DEV-AH
 16988                                    PB-CI-LF-ABBR
 16989                                    PB-CI-AH-ABBR
 16990                                    PB-CI-OB-FLAG
 16991                                    PB-CI-LF-POLICY-STATUS
 16992                                    PB-CI-AH-POLICY-STATUS
 16993                                    PB-CI-INDV-GRP-CD
 16994                                    PB-CI-BENEFICIARY-NAME
 16995                                    PB-CI-NOTE-SW
 16996                                    PB-CI-SOC-SEC-NO
 16997                                    PB-CI-MEMBER-NO
 16998                                    PB-CI-INT-CODE
 16999                                    PB-CI-COMP-EXCP-SW
 17000                                    PB-CI-ENTRY-STATUS
 17001                                    PB-CI-CREDIT-INTERFACE-SW-1
 17002                                    PB-CI-CREDIT-INTERFACE-SW-2
 17003                                    PB-CI-ENTRY-BATCH.
 17004
 17005     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17006                                    PB-CI-AH-SETTLEMENT-DT
 17007                                    PB-CI-DEATH-DT
 17008                                    PB-CI-LF-PRIOR-CANCEL-DT
 17009                                    PB-CI-AH-PRIOR-CANCEL-DT
 17010                                    PB-CI-LOAN-1ST-PMT-DT
 17011                                    PB-CI-ENTRY-DT
 17012                                    PB-CI-LF-EXPIRE-DT
 17013                                    PB-CI-AH-EXPIRE-DT.
 17014
 17015     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17016                                    PB-CI-LF-TERM
 17017                                    PB-CI-LF-BENEFIT-AMT
 17018                                    PB-CI-LF-ALT-BENEFIT-AMT
 17019                                    PB-CI-LF-PREMIUM-AMT
 17020                                    PB-CI-LF-ALT-PREMIUM-AMT
 17021                                    PB-CI-AH-TERM
 17022                                    PB-CI-AH-BENEFIT-AMT
 17023                                    PB-CI-AH-PREMIUM-AMT
 17024                                    PB-CI-RATE-DEV-PCT-LF
 17025                                    PB-CI-RATE-DEV-PCT-AH
 17026                                    PB-CI-LIFE-COMMISSION
 17027                                    PB-CI-AH-COMMISSION
 17028                                    PB-CI-PAY-FREQUENCY
 17029                                    PB-CI-LOAN-APR
 17030                                    PB-CI-LOAN-TERM
 17031                                    PB-CI-CURR-SEQ
 17032                                    PB-CI-AH-CANCEL-AMT
 17033                                    PB-CI-LF-CANCEL-AMT
 17034                                    PB-CI-EXTENTION-DAYS
 17035                                    PB-CI-TERM-IN-DAYS
 17036                                    PB-CI-LOAN-OFFICER
 17037                                    PB-CI-LIVES
 17038                                    PB-CI-LF-CRIT-PER
 17039                                    PB-CI-AH-CRIT-PER
 17040                                    PB-C-LF-REM-TERM
 17041                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 314
* EL6311.cbl
 17042
 17043     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17044     MOVE 'A'                    TO JP-RECORD-TYPE.
 17045     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17046
 17047
 17048* EXEC CICS HANDLE CONDITION
 17049*        DUPREC   (2990-DUPLICATE-RECORD)
 17050*    END-EXEC.
 17051*    MOVE '"$%                   ! E #00014625' TO DFHEIV0
 17052     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17054     MOVE X'4520233030303134363235' TO DFHEIV0(25:11)
 17055     CALL 'kxdfhei1' USING DFHEIV0
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17057
 17058
 17059
 17060* EXEC CICS WRITE
 17061*        DATASET  (FILE-ID-ERPNDB)
 17062*        FROM     (PENDING-BUSINESS)
 17063*        RIDFLD   (PB-CONTROL-PRIMARY)
 17064*    END-EXEC.
 17065     MOVE LENGTH OF
 17066      PENDING-BUSINESS
 17067       TO DFHEIV11
 17068*    MOVE '&$ L                  ''   #00014629' TO DFHEIV0
 17069     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17071     MOVE X'2020233030303134363239' TO DFHEIV0(25:11)
 17072     CALL 'kxdfhei1' USING DFHEIV0,
 17073           FILE-ID-ERPNDB,
 17074           PENDING-BUSINESS,
 17075           DFHEIV11,
 17076           PB-CONTROL-PRIMARY,
 17077           DFHEIV99,
 17078           DFHEIV99
 17079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17080
 17081
 17082     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17083
 17084     PERFORM 8400-LOG-JOURNAL-RECORD.
 17085
 17086     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17087
 17088 2985-RECORD-MISSING.
 17089     MOVE -1                     TO CMAINTL
 17090     MOVE AL-UABON               TO CMAINTA.
 17091
 17092     MOVE ER-2902                TO EMI-ERROR.
 17093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17094     GO TO 8200-SEND-DATAONLY.
 17095
 17096 2990-DUPLICATE-RECORD.
 17097     MOVE SPACE                  TO CMAINTI.
 17098     MOVE -1                     TO CMAINTL.
 17099     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 315
* EL6311.cbl
 17100     MOVE AL-UNBON               TO CEFFDTA.
 17101
 17102     MOVE 1                      TO EMI-SUB
 17103                                    EMI-SWITCH1
 17104                                    EMI-SWITCH-AREA-1
 17105                                    EMI-SWITCH-AREA-2.
 17106     MOVE SPACES                 TO EMI-ERROR-LINES.
 17107
 17108
 17109* EXEC CICS SYNCPOINT ROLLBACK
 17110*    END-EXEC.
 17111*    MOVE '6"R                   !   #00014661' TO DFHEIV0
 17112     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17114     MOVE X'2020233030303134363631' TO DFHEIV0(25:11)
 17115     CALL 'kxdfhei1' USING DFHEIV0
 17116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17117
 17118
 17119     MOVE ER-2247                TO EMI-ERROR.
 17120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17121     GO TO 8200-SEND-DATAONLY.
 17122
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 316
* EL6311.cbl
 17124
 17125***************************************************************
 17126*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17127*     PREMIUM FOR A SINGLE BATCH.                             *
 17128*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17129***************************************************************
 17130
 17131 3000-BATCH-MAINLINE.
 17132     IF PI-PREV-KEY NOT = SPACES
 17133         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17134     ELSE
 17135         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17136
 17137     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17138
 17139 3010-READNEXT.
 17140
 17141* EXEC CICS READ
 17142*         DATASET    (FILE-ID-ERPNDB)
 17143*         SET        (ADDRESS OF PENDING-BUSINESS)
 17144*         RIDFLD     (ERPNDB-KEY)
 17145*         GTEQ
 17146*    END-EXEC.
 17147*    MOVE '&"S        G          (   #00014685' TO DFHEIV0
 17148     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17150     MOVE X'2020233030303134363835' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0,
 17152           FILE-ID-ERPNDB,
 17153           DFHEIV20,
 17154           DFHEIV99,
 17155           ERPNDB-KEY,
 17156           DFHEIV99,
 17157           DFHEIV99,
 17158           DFHEIV99
 17159     SET ADDRESS OF PENDING-BUSINESS TO
 17160         DFHEIV20
 17161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17162
 17163
 17164     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17165        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17166          GO TO 3030-END-BATCH.
 17167
 17168     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17169
 17170     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17171        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17172          GO TO 3020-BUMP-SEQ.
 17173
 17174     IF PB-ISSUE
 17175        ADD +1                   TO WS-ISS-TOTAL-CNT
 17176        IF PB-FATAL-ERRORS
 17177           ADD +1                      TO WS-ISS-FATAL-CNT
 17178           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17179           GO TO 3020-BUMP-SEQ
 17180        ELSE
 17181           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 317
* EL6311.cbl
 17182              ADD +1                      TO WS-ISS-FORCE-CNT
 17183              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17184              GO TO 3020-BUMP-SEQ
 17185           ELSE
 17186              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17187                 ADD +1                      TO WS-ISS-HOLD-CNT
 17188                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17189                 GO TO 3020-BUMP-SEQ
 17190              ELSE
 17191                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17192                     THRU  3299-EXIT
 17193                 GO TO 3020-BUMP-SEQ.
 17194
 17195     IF PB-CANCELLATION
 17196        ADD +1                   TO WS-CAN-TOTAL-CNT
 17197        IF PB-FATAL-ERRORS
 17198           ADD +1                 TO WS-CAN-FATAL-CNT
 17199           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17200           GO TO 3020-BUMP-SEQ
 17201        ELSE
 17202           IF PB-UNFORCED-ERRORS
 17203              ADD +1                 TO WS-CAN-FORCE-CNT
 17204              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17205              GO TO 3020-BUMP-SEQ
 17206           ELSE
 17207              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17208                 ADD +1                 TO WS-CAN-HOLD-CNT
 17209                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17210                 GO TO 3020-BUMP-SEQ
 17211              ELSE
 17212                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17213                     THRU  3499-EXIT
 17214                 GO TO 3020-BUMP-SEQ.
 17215
 17216     IF PB-BATCH-TRAILER
 17217         GO TO 3030-END-BATCH.
 17218
 17219 3020-BUMP-SEQ.
 17220     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17221     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17222     GO TO 3010-READNEXT.
 17223
 17224 3030-END-BATCH.
 17225     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17226     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17227     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17228     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17229
 17230     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17231                                          - WS-ISS-FORCE-CNT
 17232                                          - WS-ISS-HOLD-CNT).
 17233
 17234     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17235     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17236
 17237     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17238     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17239     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 318
* EL6311.cbl
 17240     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17241     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17242                                          - WS-CAN-FORCE-CNT
 17243                                          - WS-CAN-HOLD-CNT).
 17244     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17245     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17246
 17247     COMPUTE WS-NET-TOTAL-CNT
 17248         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17249     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17250     COMPUTE WS-NET-FATAL-CNT
 17251         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17252     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17253     COMPUTE WS-NET-FORCE-CNT
 17254         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17255     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17256     COMPUTE WS-NET-HOLD-CNT
 17257         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17258     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17259
 17260     COMPUTE WS-NET-AVAIL-CNT
 17261          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17262                              - WS-ISS-FORCE-CNT
 17263                              - WS-ISS-HOLD-CNT)
 17264          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17265                              - WS-CAN-FORCE-CNT
 17266                              - WS-CAN-HOLD-CNT).
 17267     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17268
 17269     COMPUTE WS-NET-GOOD-PREM
 17270         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17271     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17272     COMPUTE WS-NET-BAD-PREM
 17273         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17274     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17275
 17276     MOVE 0000                   TO EMI-ERROR.
 17277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17278     MOVE -1                     TO DPFENTRL.
 17279     GO TO 8200-SEND-DATAONLY.
 17280
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 319
* EL6311.cbl
 17282
 17283******************************************************************
 17284*                                                                *
 17285*           A D D    B A D   I S S U E   P R E M I U M           *
 17286*                                                                *
 17287******************************************************************
 17288
 17289 3100-ADD-BAD-ISSUE-PREM.
 17290     IF PB-OVERRIDE-LIFE
 17291       OR PB-OVERRIDE-BOTH
 17292           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17293           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17294       ELSE
 17295           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17296           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17297
 17298     IF PB-OVERRIDE-AH
 17299       OR PB-OVERRIDE-BOTH
 17300           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17301       ELSE
 17302           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17303
 17304 3199-EXIT.
 17305     EXIT.
 17306
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 320
* EL6311.cbl
 17308
 17309******************************************************************
 17310*                                                                *
 17311*       A D D   G O O D   I S S U E   P R E M I U M              *
 17312*                                                                *
 17313******************************************************************
 17314
 17315 3200-ADD-GOOD-ISSUE-PREM.
 17316     IF PB-OVERRIDE-LIFE
 17317       OR PB-OVERRIDE-BOTH
 17318           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17319           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17320       ELSE
 17321           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17322           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17323
 17324     IF PB-OVERRIDE-AH
 17325       OR PB-OVERRIDE-BOTH
 17326           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17327       ELSE
 17328           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17329
 17330 3299-EXIT.
 17331     EXIT.
 17332
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 321
* EL6311.cbl
 17334
 17335
 17336******************************************************************
 17337*                                                                *
 17338*        A D D   B A D   C A N C E L   P R E M I U M             *
 17339*                                                                *
 17340******************************************************************
 17341
 17342 3300-ADD-BAD-CANCEL-PREM.
 17343     IF PB-OVERRIDE-LIFE
 17344       OR PB-OVERRIDE-BOTH
 17345           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17346       ELSE
 17347           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17348
 17349     IF PB-OVERRIDE-AH
 17350       OR PB-OVERRIDE-BOTH
 17351           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17352       ELSE
 17353           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17354
 17355 3399-EXIT.
 17356     EXIT.
 17357
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 322
* EL6311.cbl
 17359
 17360******************************************************************
 17361*                                                                *
 17362*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17363*                                                                *
 17364******************************************************************
 17365
 17366 3400-ADD-GOOD-CANCEL-PREM.
 17367     IF PB-OVERRIDE-LIFE
 17368       OR PB-OVERRIDE-BOTH
 17369           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17370       ELSE
 17371           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17372
 17373     IF PB-OVERRIDE-AH
 17374       OR PB-OVERRIDE-BOTH
 17375           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17376       ELSE
 17377           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17378
 17379 3499-EXIT.
 17380     EXIT.
 17381
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 323
* EL6311.cbl
 17383
 17384******************************************************************
 17385*                                                                *
 17386*           E D I T   B A T C H   D A T A                        *
 17387*                                                                *
 17388******************************************************************
 17389
 17390 3500-EDIT-BATCH-DATA.
 17391     IF PI-PREV-KEY NOT = SPACES
 17392        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17393     ELSE
 17394        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17395
 17396     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17397     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17398
 17399
 17400* EXEC CICS HANDLE CONDITION
 17401*         NOTFND      (3590-NOT-FOUND)
 17402*    END-EXEC.
 17403*    MOVE '"$I                   ! F #00014927' TO DFHEIV0
 17404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17406     MOVE X'4620233030303134393237' TO DFHEIV0(25:11)
 17407     CALL 'kxdfhei1' USING DFHEIV0
 17408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17409
 17410
 17411     IF DRISSL   GREATER THAN ZEROS OR
 17412        DRISSL   GREATER THAN ZEROS OR
 17413        DRLFPRML GREATER THAN ZEROS OR
 17414        DRAHPRML GREATER THAN ZEROS OR
 17415        DRCANCL  GREATER THAN ZEROS OR
 17416        DRLFRFDL GREATER THAN ZEROS OR
 17417        DRAHRFDL GREATER THAN ZEROS
 17418              NEXT SENTENCE
 17419          ELSE
 17420              MOVE ER-3224    TO EMI-ERROR
 17421              MOVE -1         TO DPFENTRL
 17422              MOVE AL-UNBON   TO DPFENTRA
 17423              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17424              GO TO 8200-SEND-DATAONLY.
 17425
 17426     IF NOT MODIFY-CAP
 17427         MOVE 'UPDATE'       TO SM-READ
 17428         PERFORM 9995-SECURITY-VIOLATION
 17429         MOVE ER-0070        TO EMI-ERROR
 17430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17431         GO TO 8100-SEND-INITIAL-MAP.
 17432
 17433        IF DRISSL GREATER THAN ZEROS
 17434           MOVE AL-UNNON         TO DRISSA
 17435           MOVE DRISSI           TO DEEDIT-FIELD
 17436           PERFORM 8600-DEEDIT
 17437           IF DEEDIT-FIELD-V0  NUMERIC
 17438              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17439           ELSE
 17440              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 324
* EL6311.cbl
 17441              MOVE -1         TO DRISSL
 17442              MOVE AL-UNBON   TO DRISSA
 17443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17444
 17445        IF DRLFPRML GREATER THAN ZEROS
 17446           MOVE AL-UNNON         TO DRLFPRMA
 17447
 17448* EXEC CICS BIF DEEDIT
 17449*              FIELD  (DRLFPRMI)
 17450*              LENGTH (11)
 17451*          END-EXEC
 17452     MOVE 11
 17453       TO DFHEIV11
 17454*    MOVE '@"L                   #   #00014967' TO DFHEIV0
 17455     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17456     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17457     MOVE X'2020233030303134393637' TO DFHEIV0(25:11)
 17458     CALL 'kxdfhei1' USING DFHEIV0,
 17459           DRLFPRMI,
 17460           DFHEIV11
 17461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17462           IF DRLFPRMI NUMERIC
 17463              MOVE DRLFPRMI   TO WS-DRLFPRM
 17464*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17465*          PERFORM 8600-DEEDIT
 17466*          IF DEEDIT-FIELD-V2  NUMERIC
 17467*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17468           ELSE
 17469              MOVE ER-2223    TO EMI-ERROR
 17470              MOVE -1         TO DRLFPRML
 17471              MOVE AL-UNBON   TO DRLFPRMA
 17472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17473
 17474        IF DRAHPRML GREATER THAN ZEROS
 17475           MOVE AL-UNNON         TO DRAHPRMA
 17476
 17477* EXEC CICS BIF DEEDIT
 17478*              FIELD  (DRAHPRMI)
 17479*              LENGTH (11)
 17480*          END-EXEC
 17481     MOVE 11
 17482       TO DFHEIV11
 17483*    MOVE '@"L                   #   #00014985' TO DFHEIV0
 17484     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17485     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17486     MOVE X'2020233030303134393835' TO DFHEIV0(25:11)
 17487     CALL 'kxdfhei1' USING DFHEIV0,
 17488           DRAHPRMI,
 17489           DFHEIV11
 17490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17491           IF DRAHPRMI NUMERIC
 17492              MOVE DRAHPRMI   TO WS-DRAHPRM
 17493*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17494*          PERFORM 8600-DEEDIT
 17495*          IF DEEDIT-FIELD-V2  NUMERIC
 17496*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17497           ELSE
 17498              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 325
* EL6311.cbl
 17499              MOVE -1         TO DRAHPRML
 17500              MOVE AL-UNBON   TO DRAHPRMA
 17501              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17502
 17503        IF DRCANCL GREATER THAN ZEROS
 17504           MOVE AL-UNNON         TO DRCANCA
 17505           MOVE DRCANCI          TO DEEDIT-FIELD
 17506           PERFORM 8600-DEEDIT
 17507           IF DEEDIT-FIELD-V0  NUMERIC
 17508              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17509           ELSE
 17510              MOVE ER-2223    TO EMI-ERROR
 17511              MOVE -1         TO DRCANCL
 17512              MOVE AL-UNBON   TO DRCANCL
 17513              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17514
 17515        IF DRLFRFDL GREATER THAN ZEROS
 17516           MOVE AL-UNNON         TO DRLFRFDA
 17517
 17518* EXEC CICS BIF DEEDIT
 17519*              FIELD  (DRLFRFDI)
 17520*              LENGTH (11)
 17521*          END-EXEC
 17522     MOVE 11
 17523       TO DFHEIV11
 17524*    MOVE '@"L                   #   #00015015' TO DFHEIV0
 17525     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17526     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17527     MOVE X'2020233030303135303135' TO DFHEIV0(25:11)
 17528     CALL 'kxdfhei1' USING DFHEIV0,
 17529           DRLFRFDI,
 17530           DFHEIV11
 17531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17532           IF DRLFRFDI NUMERIC
 17533              MOVE DRLFRFDI   TO WS-DRLFRFD
 17534*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17535*          PERFORM 8600-DEEDIT
 17536*          IF DEEDIT-FIELD-V2  NUMERIC
 17537*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17538           ELSE
 17539              MOVE ER-2223    TO EMI-ERROR
 17540              MOVE -1         TO DRLFRFDL
 17541              MOVE AL-UNBON   TO DRLFRFDA
 17542              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17543
 17544        IF DRAHRFDL GREATER THAN ZEROS
 17545           MOVE AL-UNNON         TO DRAHRFDA
 17546
 17547* EXEC CICS BIF DEEDIT
 17548*              FIELD  (DRAHRFDI)
 17549*              LENGTH (11)
 17550*          END-EXEC
 17551     MOVE 11
 17552       TO DFHEIV11
 17553*    MOVE '@"L                   #   #00015033' TO DFHEIV0
 17554     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17555     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17556     MOVE X'2020233030303135303333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 326
* EL6311.cbl
 17557     CALL 'kxdfhei1' USING DFHEIV0,
 17558           DRAHRFDI,
 17559           DFHEIV11
 17560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17561           IF DRAHRFDI NUMERIC
 17562              MOVE DRAHRFDI   TO WS-DRAHRFD
 17563*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17564*          PERFORM 8600-DEEDIT
 17565*          IF DEEDIT-FIELD-V2  NUMERIC
 17566*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17567           ELSE
 17568              MOVE ER-2223    TO EMI-ERROR
 17569              MOVE -1         TO DRAHRFDL
 17570              MOVE AL-UNBON   TO DRAHRFDA
 17571              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17572
 17573     IF EMI-ERROR = ZEROS
 17574        GO 3600-UPDATE-BATCH-HEADER.
 17575
 17576     GO TO 8200-SEND-DATAONLY.
 17577
 17578 3590-NOT-FOUND.
 17579     MOVE ER-2192                TO EMI-ERROR.
 17580     MOVE -1                     TO DPFENTRL.
 17581     MOVE AL-UNBON               TO DPFENTRA.
 17582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17583     GO TO 8200-SEND-DATAONLY.
 17584
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 327
* EL6311.cbl
 17586
 17587******************************************************************
 17588*                                                                *
 17589*           U P D A T E   B A T C H   H E A D E R                *
 17590*                                                                *
 17591******************************************************************
 17592
 17593 3600-UPDATE-BATCH-HEADER.
 17594
 17595* EXEC CICS HANDLE CONDITION
 17596*         NOTFND      (3690-NOT-FOUND)
 17597*    END-EXEC.
 17598*    MOVE '"$I                   ! G #00015070' TO DFHEIV0
 17599     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17601     MOVE X'4720233030303135303730' TO DFHEIV0(25:11)
 17602     CALL 'kxdfhei1' USING DFHEIV0
 17603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17604
 17605
 17606
 17607* EXEC CICS READ
 17608*        DATASET (FILE-ID-ERPNDB)
 17609*        RIDFLD  (ERPNDB-KEY)
 17610*        SET     (ADDRESS OF PENDING-BUSINESS)
 17611*        UPDATE
 17612*    END-EXEC.
 17613*    MOVE '&"S        EU         (   #00015074' TO DFHEIV0
 17614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17616     MOVE X'2020233030303135303734' TO DFHEIV0(25:11)
 17617     CALL 'kxdfhei1' USING DFHEIV0,
 17618           FILE-ID-ERPNDB,
 17619           DFHEIV20,
 17620           DFHEIV99,
 17621           ERPNDB-KEY,
 17622           DFHEIV99,
 17623           DFHEIV99,
 17624           DFHEIV99
 17625     SET ADDRESS OF PENDING-BUSINESS TO
 17626         DFHEIV20
 17627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17628
 17629
 17630     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17631     MOVE 'B'                    TO JP-RECORD-TYPE.
 17632     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17633
 17634     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17635
 17636     PERFORM 8400-LOG-JOURNAL-RECORD.
 17637
 17638     IF DRISSL GREATER THAN ZEROS
 17639        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17640
 17641     IF DRCANCL GREATER THAN ZEROS
 17642        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17643
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 328
* EL6311.cbl
 17644
 17645     IF DRLFPRML GREATER THAN ZEROS
 17646        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17647
 17648     IF DRAHPRML GREATER THAN ZEROS
 17649        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17650
 17651     IF DRLFRFDL GREATER THAN ZEROS
 17652        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17653
 17654     IF DRAHRFDL GREATER THAN ZEROS
 17655        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17656
 17657 3670-REWRITE-BATCH-HEADER.
 17658     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17659        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17660        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17661        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17662        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17663        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17664        MOVE SPACE               TO PB-OUT-BAL-CD
 17665     ELSE
 17666        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17667
 17668     MOVE 'C'                    TO JP-RECORD-TYPE.
 17669     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17670
 17671
 17672* EXEC CICS REWRITE
 17673*         DATASET      (FILE-ID-ERPNDB)
 17674*         FROM         (PENDING-BUSINESS)
 17675*    END-EXEC.
 17676     MOVE LENGTH OF
 17677      PENDING-BUSINESS
 17678       TO DFHEIV11
 17679*    MOVE '&& L                  %   #00015122' TO DFHEIV0
 17680     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17681     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17682     MOVE X'2020233030303135313232' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0,
 17684           FILE-ID-ERPNDB,
 17685           PENDING-BUSINESS,
 17686           DFHEIV11,
 17687           DFHEIV99
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     PERFORM 8400-LOG-JOURNAL-RECORD.
 17692
 17693     GO TO 7200-DISPLAY-BATCHES.
 17694
 17695 3690-NOT-FOUND.
 17696     MOVE ER-2192                TO EMI-ERROR.
 17697     MOVE -1                     TO DPFENTRL.
 17698     MOVE AL-UNBON               TO DPFENTRA.
 17699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17700     GO TO 8200-SEND-DATAONLY.
 17701
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 329
* EL6311.cbl
 17703
 17704******************************************************************
 17705*                                                                *
 17706*           R E - D I S P L A Y   R E C O R D                    *
 17707*                                                                *
 17708******************************************************************
 17709
 17710 3900-RE-DISPLAY-RECORD.
 17711
 17712* EXEC CICS HANDLE CONDITION
 17713*         NOTFND   (3990-NOT-FOUND)
 17714*    END-EXEC.
 17715*    MOVE '"$I                   ! H #00015147' TO DFHEIV0
 17716     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17717     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17718     MOVE X'4820233030303135313437' TO DFHEIV0(25:11)
 17719     CALL 'kxdfhei1' USING DFHEIV0
 17720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17721
 17722
 17723     IF PI-DISPLAY-ORIGINAL-BATCH
 17724         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17725     ELSE
 17726         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17727
 17728
 17729* EXEC CICS READ
 17730*         DATASET   (FILE-ID)
 17731*         RIDFLD    (PI-PREV-KEY)
 17732*         SET       (ADDRESS OF PENDING-BUSINESS)
 17733*    END-EXEC.
 17734*    MOVE '&"S        E          (   #00015156' TO DFHEIV0
 17735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17737     MOVE X'2020233030303135313536' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0,
 17739           FILE-ID,
 17740           DFHEIV20,
 17741           DFHEIV99,
 17742           PI-PREV-KEY,
 17743           DFHEIV99,
 17744           DFHEIV99,
 17745           DFHEIV99
 17746     SET ADDRESS OF PENDING-BUSINESS TO
 17747         DFHEIV20
 17748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17749
 17750
 17751     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17752
 17753     IF PB-ISSUE
 17754         GO TO 7000-DISPLAY-ISSUES.
 17755
 17756     IF PB-CANCELLATION
 17757         GO TO 7100-DISPLAY-CANCELS.
 17758
 17759     IF PB-BATCH-TRAILER
 17760         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 330
* EL6311.cbl
 17761
 17762 3990-NOT-FOUND.
 17763     MOVE LOW-VALUES             TO EL631BI.
 17764
 17765     IF PI-MAP-NAME = EL631B
 17766         MOVE -1                  TO BMAINTL
 17767     ELSE
 17768         MOVE -1                  TO CMAINTL.
 17769
 17770     GO TO 8100-SEND-INITIAL-MAP.
 17771
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 331
* EL6311.cbl
 17773
 17774***************************************************************
 17775*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17776*                                                             *
 17777*      1. START BROWSE WITH                                   *
 17778*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17779*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17780*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17781*                                                             *
 17782*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17783*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17784*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17785*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17786*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17787*               AND IS IT TO BE DISPLAYED.                    *
 17788*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17789*               DISPLAYED.                                    *
 17790*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17791*               DISPLAYED.                                    *
 17792*                                                             *
 17793*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17794*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17795***************************************************************
 17796
 17797 4000-BROWSE-DETAIL-FORWARD.
 17798     IF FIRST-TIME
 17799        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17800     ELSE
 17801        IF SHOW-RECORD
 17802           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17803           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17804           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17805           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17806           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17807        ELSE
 17808           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17809
 17810
 17811* EXEC CICS HANDLE CONDITION
 17812*         NOTFND   (4050-END-RECORDS)
 17813*         ENDFILE  (4050-END-RECORDS)
 17814*    END-EXEC.
 17815*    MOVE '"$I''                  ! I #00015221' TO DFHEIV0
 17816     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17818     MOVE X'4920233030303135323231' TO DFHEIV0(25:11)
 17819     CALL 'kxdfhei1' USING DFHEIV0
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17821
 17822
 17823
 17824* EXEC CICS STARTBR
 17825*         DATASET   (FILE-ID-ERPNDB2)
 17826*         RIDFLD    (ERPNDB-ALT-KEY)
 17827*    END-EXEC.
 17828     MOVE 0
 17829       TO DFHEIV11
 17830*    MOVE '&,         G          &   #00015226' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 332
* EL6311.cbl
 17831     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17832     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17833     MOVE X'2020233030303135323236' TO DFHEIV0(25:11)
 17834     CALL 'kxdfhei1' USING DFHEIV0,
 17835           FILE-ID-ERPNDB2,
 17836           ERPNDB-ALT-KEY,
 17837           DFHEIV99,
 17838           DFHEIV11,
 17839           DFHEIV99
 17840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17841
 17842
 17843     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17844
 17845     IF FIRST-TIME OR SHOW-RECORD
 17846        MOVE SPACE               TO WS-FIRST-TIME-SW
 17847        GO TO 4005-READ-NEXT-RECORD.
 17848
 17849
 17850* EXEC CICS READNEXT
 17851*         DATASET    (FILE-ID-ERPNDB2)
 17852*         SET        (ADDRESS OF PENDING-BUSINESS)
 17853*         RIDFLD     (ERPNDB-ALT-KEY)
 17854*    END-EXEC.
 17855     MOVE 0
 17856       TO DFHEIV11
 17857*    MOVE '&.S                   )   #00015237' TO DFHEIV0
 17858     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17859     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17860     MOVE X'2020233030303135323337' TO DFHEIV0(25:11)
 17861     CALL 'kxdfhei1' USING DFHEIV0,
 17862           FILE-ID-ERPNDB2,
 17863           DFHEIV20,
 17864           DFHEIV99,
 17865           ERPNDB-ALT-KEY,
 17866           DFHEIV99,
 17867           DFHEIV11,
 17868           DFHEIV99,
 17869           DFHEIV99
 17870     SET ADDRESS OF PENDING-BUSINESS TO
 17871         DFHEIV20
 17872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17873
 17874
 17875 4005-READ-NEXT-RECORD.
 17876
 17877* EXEC CICS READNEXT
 17878*         DATASET    (FILE-ID-ERPNDB2)
 17879*         SET        (ADDRESS OF PENDING-BUSINESS)
 17880*         RIDFLD     (ERPNDB-ALT-KEY)
 17881*    END-EXEC.
 17882     MOVE 0
 17883       TO DFHEIV11
 17884*    MOVE '&.S                   )   #00015244' TO DFHEIV0
 17885     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17886     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17887     MOVE X'2020233030303135323434' TO DFHEIV0(25:11)
 17888     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 333
* EL6311.cbl
 17889           FILE-ID-ERPNDB2,
 17890           DFHEIV20,
 17891           DFHEIV99,
 17892           ERPNDB-ALT-KEY,
 17893           DFHEIV99,
 17894           DFHEIV11,
 17895           DFHEIV99,
 17896           DFHEIV99
 17897     SET ADDRESS OF PENDING-BUSINESS TO
 17898         DFHEIV20
 17899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17900
 17901
 17902     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17903
 17904     IF WS-BATCH-PREFIX = '#CL'
 17905        GO TO 4005-READ-NEXT-RECORD.
 17906
 17907     IF SHOW-RECORD
 17908        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17909           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17910           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17911           PB-STATE         NOT = PI-PB-STATE          OR
 17912           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17913           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17914           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17915           GO TO 4050-END-RECORDS
 17916        ELSE
 17917           GO TO 4010-CHECK-REC-TYPE.
 17918
 17919     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17920        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17921        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17922        PB-STATE            NOT = PI-PB-STATE          OR
 17923        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17924        GO TO 4050-END-RECORDS.
 17925
 17926     IF PB-BATCH-TRAILER
 17927        GO TO 4005-READ-NEXT-RECORD.
 17928
 17929     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17930        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17931           GO TO 4005-READ-NEXT-RECORD
 17932        ELSE
 17933           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17934              GO TO 4010-CHECK-REC-TYPE
 17935           ELSE
 17936              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17937                 GO TO 4010-CHECK-REC-TYPE
 17938              ELSE
 17939                 GO TO 4005-READ-NEXT-RECORD.
 17940
 17941     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17942        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17943           GO TO 4005-READ-NEXT-RECORD.
 17944
 17945 4010-CHECK-REC-TYPE.
 17946     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 334
* EL6311.cbl
 17947         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17948             NEXT SENTENCE
 17949         ELSE
 17950             GO TO 4005-READ-NEXT-RECORD.
 17951
 17952     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17953         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17954             NEXT SENTENCE
 17955        ELSE
 17956             GO TO 4005-READ-NEXT-RECORD.
 17957
 17958     IF NOT DISPLAY-CHANGE-RECORDS AND
 17959            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17960        GO TO 4005-READ-NEXT-RECORD.
 17961
 17962     IF DISPLAY-HOLD-RECORDS AND
 17963        NOT PB-RECORD-ON-HOLD
 17964          GO TO 4005-READ-NEXT-RECORD.
 17965
 17966     IF PB-ISSUE
 17967        IF DISPLAY-CHK-REQ-RECORDS
 17968            GO TO 4005-READ-NEXT-RECORD.
 17969
 17970     IF PB-ISSUE
 17971        IF ISSUE-WITH-WARNING
 17972           IF PB-WARNING-ERRORS
 17973              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17974                  GO TO 4005-READ-NEXT-RECORD
 17975              ELSE
 17976                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17977                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17978                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17979                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17980                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17981                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17982                 GO TO 7000-DISPLAY-ISSUES
 17983           ELSE
 17984              GO TO 4005-READ-NEXT-RECORD.
 17985
 17986     IF PB-ISSUE
 17987        IF (ISSUES-IN-ERROR AND
 17988            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17989            ALL-ISSUES
 17990            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17991            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17992            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17993            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17994            MOVE PB-SV-STATE            TO PI-SV-STATE
 17995            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17996            GO TO 7000-DISPLAY-ISSUES
 17997        ELSE
 17998            GO TO 4005-READ-NEXT-RECORD.
 17999
 18000     IF PB-CANCELLATION
 18001        IF DISPLAY-CHK-REQ-RECORDS
 18002           IF PB-C-REFUND-REQUESTED
 18003              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18004              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 335
* EL6311.cbl
 18005              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18006              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18007              MOVE PB-SV-STATE            TO PI-SV-STATE
 18008              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18009              GO TO 7100-DISPLAY-CANCELS
 18010           ELSE
 18011               GO TO 4005-READ-NEXT-RECORD.
 18012
 18013     IF PB-CANCELLATION
 18014        IF CANCEL-WITH-WARNING
 18015           IF PB-WARNING-ERRORS
 18016              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18017                  GO TO 4005-READ-NEXT-RECORD
 18018              ELSE
 18019                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18020                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18021                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18022                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18023                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18024                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18025                 GO TO 7100-DISPLAY-CANCELS
 18026           ELSE
 18027              GO TO 4005-READ-NEXT-RECORD.
 18028
 18029     IF PB-CANCELLATION
 18030        IF (CANCEL-IN-ERROR  AND
 18031            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18032            ALL-CANCELS
 18033            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18034            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18035            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18036            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18037            MOVE PB-SV-STATE            TO PI-SV-STATE
 18038            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18039            GO TO 7100-DISPLAY-CANCELS.
 18040
 18041     GO TO 4005-READ-NEXT-RECORD.
 18042
 18043 4050-END-RECORDS.
 18044******************************************************************
 18045*                                                                *
 18046*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18047*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18048*         PROGRAM.                                               *
 18049*                                                                *
 18050******************************************************************
 18051
 18052     IF BROWSE-STARTED
 18053        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18054
 18055* EXEC CICS ENDBR
 18056*            DATASET  (FILE-ID-ERPNDB2)
 18057*       END-EXEC.
 18058     MOVE 0
 18059       TO DFHEIV11
 18060*    MOVE '&2                    $   #00015402' TO DFHEIV0
 18061     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18062     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 336
* EL6311.cbl
 18063     MOVE X'2020233030303135343032' TO DFHEIV0(25:11)
 18064     CALL 'kxdfhei1' USING DFHEIV0,
 18065           FILE-ID-ERPNDB2,
 18066           DFHEIV11,
 18067           DFHEIV99
 18068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18069
 18070
 18071     IF  EIBTRNID NOT = TRANS-EXB1
 18072         IF PENDING-BUS-RECS-FOUND
 18073             NEXT SENTENCE
 18074           ELSE
 18075             MOVE '9'            TO PI-BROWSE-SW
 18076             GO TO 9400-CLEAR.
 18077
 18078     IF SHOW-RECORD
 18079        MOVE ER-2253            TO EMI-ERROR
 18080       ELSE
 18081        MOVE ER-2254            TO EMI-ERROR.
 18082
 18083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18084
 18085     IF PI-MAP-NAME = SPACES
 18086        MOVE -1                  TO DPFENTRL
 18087        MOVE EL631D               TO PI-MAP-NAME
 18088        GO TO 8100-SEND-INITIAL-MAP.
 18089
 18090     IF PI-MAP-NAME = EL631B
 18091        MOVE -1                  TO BMAINTL
 18092     ELSE
 18093        IF PI-MAP-NAME = EL631C
 18094           MOVE -1               TO CMAINTL
 18095        ELSE
 18096           MOVE -1               TO DPFENTRL.
 18097
 18098     GO TO 8200-SEND-DATAONLY.
 18099
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 337
* EL6311.cbl
 18101
 18102***************************************************************
 18103*                                                             *
 18104*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18105*                                                             *
 18106*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18107*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18108*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18109*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18110*                                                             *
 18111*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18112*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18113*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18114*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18115*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18116*                AND IS IT TO BE DISPLAYED.                   *
 18117*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18118*                DISPLAYED.                                   *
 18119*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18120*                DISPLAYED.                                   *
 18121*                                                             *
 18122*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18123*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18124*                                                             *
 18125*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18126*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18127*                THEY ARE NOT TO BE DISPLAYED.                *
 18128*                                                             *
 18129***************************************************************
 18130
 18131 4100-BROWSE-PRIMARY-FORWARD.
 18132     IF FIRST-TIME  OR SHOW-RECORD
 18133        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18134        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18135        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18136     ELSE
 18137        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18138        IF ERPNDB-BATCH-SEQ-NO = +9999
 18139           GO TO 4150-END-BATCH
 18140        ELSE
 18141           IF DISPLAY-CHANGE-RECORDS
 18142              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18143           ELSE
 18144              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18145              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18146
 18147     IF FIRST-TIME
 18148         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18149            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18150              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18151
 18152
 18153* EXEC CICS HANDLE CONDITION
 18154*         ENDFILE  (4150-END-BATCH)
 18155*    END-EXEC.
 18156*    MOVE '"$''                   ! J #00015487' TO DFHEIV0
 18157     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 338
* EL6311.cbl
 18159     MOVE X'4A20233030303135343837' TO DFHEIV0(25:11)
 18160     CALL 'kxdfhei1' USING DFHEIV0
 18161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18162
 18163
 18164 4105-READ-NEXT.
 18165
 18166* EXEC CICS HANDLE CONDITION
 18167*         NOTFND    (4150-END-BATCH)
 18168*    END-EXEC.
 18169*    MOVE '"$I                   ! K #00015492' TO DFHEIV0
 18170     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18172     MOVE X'4B20233030303135343932' TO DFHEIV0(25:11)
 18173     CALL 'kxdfhei1' USING DFHEIV0
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18175
 18176
 18177     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18178
 18179     IF PI-DISPLAY-ORIGINAL-BATCH
 18180        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18181     ELSE
 18182        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18183
 18184
 18185* EXEC CICS READ
 18186*         DATASET   (FILE-ID)
 18187*         SET       (ADDRESS OF PENDING-BUSINESS)
 18188*         RIDFLD    (ERPNDB-KEY)
 18189*         GTEQ
 18190*    END-EXEC.
 18191*    MOVE '&"S        G          (   #00015503' TO DFHEIV0
 18192     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18194     MOVE X'2020233030303135353033' TO DFHEIV0(25:11)
 18195     CALL 'kxdfhei1' USING DFHEIV0,
 18196           FILE-ID,
 18197           DFHEIV20,
 18198           DFHEIV99,
 18199           ERPNDB-KEY,
 18200           DFHEIV99,
 18201           DFHEIV99,
 18202           DFHEIV99
 18203     SET ADDRESS OF PENDING-BUSINESS TO
 18204         DFHEIV20
 18205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18206
 18207
 18208     IF PI-DISPLAY-ORIGINAL-BATCH
 18209        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18210           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18211           GO TO 4150-END-BATCH
 18212        ELSE
 18213           IF PB-BATCH-TRAILER
 18214              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18215              GO TO 4105-READ-NEXT
 18216           ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 339
* EL6311.cbl
 18217              NEXT SENTENCE
 18218     ELSE
 18219        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18220           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18221           GO TO 4150-END-BATCH.
 18222
 18223     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18224
 18225     IF WS-BATCH-PREFIX = '#CL'
 18226         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18227         GO TO 4105-READ-NEXT.
 18228
 18229     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18230     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18231     MOVE PB-STATE               TO PI-PB-STATE.
 18232     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18233
 18234     IF PB-BATCH-TRAILER
 18235        IF SHOW-RECORD
 18236           GO TO 4150-END-BATCH
 18237        ELSE
 18238           MOVE ER-2251         TO EMI-ERROR
 18239           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18240           MOVE 1               TO PI-BROWSE-TYPE
 18241           GO TO 7200-DISPLAY-BATCHES.
 18242
 18243     IF SHOW-RECORD
 18244           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18245              GO TO 4110-BUMP-SEQ
 18246           ELSE
 18247              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18248                 GO TO 4110-BUMP-SEQ
 18249              ELSE
 18250                 GO TO 4107-CHECK-REC-TYPE.
 18251
 18252     IF NOT  PI-PRIMARY-WITH-SELECT
 18253        GO TO 4107-CHECK-REC-TYPE.
 18254
 18255     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18256        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18257           GO TO 4110-BUMP-SEQ
 18258        ELSE
 18259           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18260              GO TO 4107-CHECK-REC-TYPE
 18261           ELSE
 18262              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18263                 GO TO 4107-CHECK-REC-TYPE
 18264              ELSE
 18265                 GO TO 4110-BUMP-SEQ.
 18266
 18267     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18268        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18269           GO TO 4110-BUMP-SEQ.
 18270
 18271 4107-CHECK-REC-TYPE.
 18272     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18273         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18274             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 340
* EL6311.cbl
 18275           ELSE
 18276             GO TO 4110-BUMP-SEQ.
 18277
 18278     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18279         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18280             NEXT SENTENCE
 18281           ELSE
 18282             GO TO 4110-BUMP-SEQ.
 18283
 18284     IF NOT DISPLAY-CHANGE-RECORDS AND
 18285        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18286           GO TO 4110-BUMP-SEQ.
 18287
 18288     IF DISPLAY-HOLD-RECORDS AND
 18289        NOT PB-RECORD-ON-HOLD
 18290          GO TO 4110-BUMP-SEQ.
 18291
 18292     IF PB-ISSUE
 18293        IF DISPLAY-CHK-REQ-RECORDS
 18294            GO TO 4110-BUMP-SEQ.
 18295
 18296     IF PB-ISSUE
 18297        IF ISSUE-WITH-WARNING
 18298           IF PB-WARNING-ERRORS
 18299              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18300                  GO TO 4110-BUMP-SEQ
 18301              ELSE
 18302                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18303                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18304                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18305                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18306                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18307                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18308                 GO TO 7000-DISPLAY-ISSUES
 18309        ELSE
 18310            GO TO 4110-BUMP-SEQ.
 18311
 18312     IF PB-ISSUE
 18313        IF (ISSUES-IN-ERROR AND
 18314            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18315            ALL-ISSUES
 18316            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18317            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18318            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18319            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18320            MOVE PB-SV-STATE            TO PI-SV-STATE
 18321            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18322            GO TO 7000-DISPLAY-ISSUES
 18323        ELSE
 18324            GO TO 4110-BUMP-SEQ.
 18325
 18326     IF PB-CANCELLATION
 18327        IF DISPLAY-CHK-REQ-RECORDS
 18328           IF PB-C-REFUND-REQUESTED
 18329              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18330              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18331              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18332              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 341
* EL6311.cbl
 18333              MOVE PB-SV-STATE            TO PI-SV-STATE
 18334              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18335              GO TO 7100-DISPLAY-CANCELS
 18336           ELSE
 18337              GO TO 4110-BUMP-SEQ.
 18338
 18339     IF PB-CANCELLATION
 18340        IF CANCEL-WITH-WARNING
 18341           IF PB-WARNING-ERRORS
 18342              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18343                  GO TO 4110-BUMP-SEQ
 18344              ELSE
 18345                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18346                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18347                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18348                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18349                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18350                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18351                 GO TO 7100-DISPLAY-CANCELS
 18352           ELSE
 18353              GO TO 4110-BUMP-SEQ.
 18354
 18355     IF PB-CANCELLATION
 18356        IF (CANCEL-IN-ERROR  AND
 18357            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18358            ALL-CANCELS
 18359            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18360            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18361            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18362            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18363            MOVE PB-SV-STATE            TO PI-SV-STATE
 18364            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18365            GO TO 7100-DISPLAY-CANCELS.
 18366
 18367 4110-BUMP-SEQ.
 18368     IF NOT DISPLAY-CHANGE-RECORDS
 18369        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18370        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18371     ELSE
 18372        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18373           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18374           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18375        ELSE
 18376           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18377           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18378
 18379     GO TO 4105-READ-NEXT.
 18380
 18381 4150-END-BATCH.
 18382******************************************************************
 18383*                                                                *
 18384*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18385*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18386*         PROGRAM.                                               *
 18387*                                                                *
 18388******************************************************************
 18389
 18390     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 342
* EL6311.cbl
 18391         IF PENDING-BUS-RECS-FOUND
 18392             NEXT SENTENCE
 18393           ELSE
 18394             MOVE '9'            TO PI-BROWSE-SW
 18395             GO TO 9400-CLEAR.
 18396
 18397     IF SHOW-RECORD
 18398        MOVE ER-2253             TO EMI-ERROR
 18399     ELSE
 18400        MOVE ER-2251             TO EMI-ERROR.
 18401
 18402     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18403
 18404     IF PI-MAP-NAME = SPACES
 18405        MOVE -1                  TO BMAINTL
 18406        MOVE EL631B              TO PI-MAP-NAME
 18407        GO TO 8100-SEND-INITIAL-MAP.
 18408
 18409     IF PI-MAP-NAME = EL631B
 18410        MOVE -1                  TO BMAINTL
 18411     ELSE
 18412        IF PI-MAP-NAME = EL631C
 18413           MOVE -1               TO CMAINTL
 18414        ELSE
 18415           MOVE -1               TO DPFENTRL.
 18416
 18417     GO TO 8200-SEND-DATAONLY.
 18418
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 343
* EL6311.cbl
 18420
 18421***************************************************************
 18422*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18423*                                                             *
 18424*      1. START BROWSE WITH                                   *
 18425*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18426*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18427*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18428*                                                             *
 18429*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18430*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18431*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18432*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18433*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18434*               AND IS IT TO BE DISPLAYED.                    *
 18435*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18436*               DISPLAYED.                                    *
 18437*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18438*               DISPLAYED.                                    *
 18439*                                                             *
 18440*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18441*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18442***************************************************************
 18443
 18444 4200-BROWSE-CSR-FORWARD.
 18445
 18446     IF FIRST-TIME
 18447        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18448     ELSE
 18449        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18450
 18451
 18452* EXEC CICS HANDLE CONDITION
 18453*         NOTFND   (4250-END-RECORDS)
 18454*         ENDFILE  (4250-END-RECORDS)
 18455*    END-EXEC.
 18456*    MOVE '"$I''                  ! L #00015753' TO DFHEIV0
 18457     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18459     MOVE X'4C20233030303135373533' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0
 18461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18462
 18463
 18464
 18465* EXEC CICS STARTBR
 18466*         DATASET   (FILE-ID-ERPNDB4)
 18467*         RIDFLD    (ERPNDB-CSR-KEY)
 18468*    END-EXEC.
 18469     MOVE 0
 18470       TO DFHEIV11
 18471*    MOVE '&,         G          &   #00015758' TO DFHEIV0
 18472     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18473     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18474     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0,
 18476           FILE-ID-ERPNDB4,
 18477           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 344
* EL6311.cbl
 18478           DFHEIV99,
 18479           DFHEIV11,
 18480           DFHEIV99
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18482
 18483
 18484     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18485
 18486     IF FIRST-TIME
 18487        MOVE SPACE               TO WS-FIRST-TIME-SW
 18488        GO TO 4205-READ-NEXT-RECORD.
 18489
 18490
 18491* EXEC CICS READNEXT
 18492*         DATASET    (FILE-ID-ERPNDB4)
 18493*         SET        (ADDRESS OF PENDING-BUSINESS)
 18494*         RIDFLD     (ERPNDB-CSR-KEY)
 18495*    END-EXEC.
 18496     MOVE 0
 18497       TO DFHEIV11
 18498*    MOVE '&.S                   )   #00015769' TO DFHEIV0
 18499     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18501     MOVE X'2020233030303135373639' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0,
 18503           FILE-ID-ERPNDB4,
 18504           DFHEIV20,
 18505           DFHEIV99,
 18506           ERPNDB-CSR-KEY,
 18507           DFHEIV99,
 18508           DFHEIV11,
 18509           DFHEIV99,
 18510           DFHEIV99
 18511     SET ADDRESS OF PENDING-BUSINESS TO
 18512         DFHEIV20
 18513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18514
 18515
 18516 4205-READ-NEXT-RECORD.
 18517
 18518
 18519* EXEC CICS READNEXT
 18520*         DATASET    (FILE-ID-ERPNDB4)
 18521*         SET        (ADDRESS OF PENDING-BUSINESS)
 18522*         RIDFLD     (ERPNDB-CSR-KEY)
 18523*    END-EXEC.
 18524     MOVE 0
 18525       TO DFHEIV11
 18526*    MOVE '&.S                   )   #00015777' TO DFHEIV0
 18527     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18528     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18529     MOVE X'2020233030303135373737' TO DFHEIV0(25:11)
 18530     CALL 'kxdfhei1' USING DFHEIV0,
 18531           FILE-ID-ERPNDB4,
 18532           DFHEIV20,
 18533           DFHEIV99,
 18534           ERPNDB-CSR-KEY,
 18535           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 345
* EL6311.cbl
 18536           DFHEIV11,
 18537           DFHEIV99,
 18538           DFHEIV99
 18539     SET ADDRESS OF PENDING-BUSINESS TO
 18540         DFHEIV20
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18545
 18546     IF WS-BATCH-PREFIX = '#CL'
 18547        GO TO 4205-READ-NEXT-RECORD.
 18548
 18549     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18550        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18551        GO TO 4250-END-RECORDS.
 18552
 18553     IF PB-BATCH-TRAILER
 18554        GO TO 4205-READ-NEXT-RECORD.
 18555
 18556     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18557        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18558           GO TO 4205-READ-NEXT-RECORD
 18559        ELSE
 18560           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18561              GO TO 4210-CHECK-REC-TYPE
 18562           ELSE
 18563              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18564                 GO TO 4210-CHECK-REC-TYPE
 18565              ELSE
 18566                 GO TO 4205-READ-NEXT-RECORD.
 18567
 18568     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18569        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18570           GO TO 4205-READ-NEXT-RECORD.
 18571
 18572 4210-CHECK-REC-TYPE.
 18573     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18574         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18575             NEXT SENTENCE
 18576         ELSE
 18577             GO TO 4205-READ-NEXT-RECORD.
 18578
 18579     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18580         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18581             NEXT SENTENCE
 18582        ELSE
 18583             GO TO 4205-READ-NEXT-RECORD.
 18584
 18585     IF NOT DISPLAY-CHANGE-RECORDS AND
 18586            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18587        GO TO 4205-READ-NEXT-RECORD.
 18588
 18589     IF DISPLAY-HOLD-RECORDS AND
 18590        NOT PB-RECORD-ON-HOLD
 18591          GO TO 4205-READ-NEXT-RECORD.
 18592
 18593     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 346
* EL6311.cbl
 18594        IF DISPLAY-CHK-REQ-RECORDS
 18595            GO TO 4205-READ-NEXT-RECORD.
 18596
 18597     IF PB-ISSUE
 18598        IF ISSUE-WITH-WARNING
 18599           IF PB-WARNING-ERRORS
 18600              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18601                  GO TO 4205-READ-NEXT-RECORD
 18602              ELSE
 18603                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18604                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18605                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18606                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18607                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18608                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18609                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18610                 GO TO 7000-DISPLAY-ISSUES
 18611           ELSE
 18612              GO TO 4205-READ-NEXT-RECORD.
 18613
 18614     IF PB-ISSUE
 18615        IF (ISSUES-IN-ERROR AND
 18616            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18617            ALL-ISSUES
 18618            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18619            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18620            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18621            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18622            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18623            MOVE PB-SV-STATE            TO PI-SV-STATE
 18624            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18625            GO TO 7000-DISPLAY-ISSUES
 18626        ELSE
 18627            GO TO 4205-READ-NEXT-RECORD.
 18628
 18629     IF PB-CANCELLATION
 18630        IF DISPLAY-CHK-REQ-RECORDS
 18631           IF PB-C-REFUND-REQUESTED
 18632              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18633              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18634              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18635              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18636              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18637              MOVE PB-SV-STATE            TO PI-SV-STATE
 18638              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18639              GO TO 7100-DISPLAY-CANCELS
 18640           ELSE
 18641               GO TO 4205-READ-NEXT-RECORD.
 18642
 18643     IF PB-CANCELLATION
 18644        IF CANCEL-WITH-WARNING
 18645           IF PB-WARNING-ERRORS
 18646              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18647                  GO TO 4205-READ-NEXT-RECORD
 18648              ELSE
 18649                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18650                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18651                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 347
* EL6311.cbl
 18652                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18653                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18654                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18655                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18656                 GO TO 7100-DISPLAY-CANCELS
 18657           ELSE
 18658              GO TO 4205-READ-NEXT-RECORD.
 18659
 18660     IF PB-CANCELLATION
 18661        IF (CANCEL-IN-ERROR  AND
 18662            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18663            ALL-CANCELS
 18664            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18665            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18666            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18667            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18668            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18669            MOVE PB-SV-STATE            TO PI-SV-STATE
 18670            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18671            GO TO 7100-DISPLAY-CANCELS.
 18672
 18673     GO TO 4205-READ-NEXT-RECORD.
 18674
 18675 4250-END-RECORDS.
 18676******************************************************************
 18677*                                                                *
 18678*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18679*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18680*         PROGRAM.                                               *
 18681*                                                                *
 18682******************************************************************
 18683
 18684     IF BROWSE-STARTED
 18685        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18686
 18687* EXEC CICS ENDBR
 18688*            DATASET  (FILE-ID-ERPNDB4)
 18689*       END-EXEC.
 18690     MOVE 0
 18691       TO DFHEIV11
 18692*    MOVE '&2                    $   #00015925' TO DFHEIV0
 18693     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18695     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 18696     CALL 'kxdfhei1' USING DFHEIV0,
 18697           FILE-ID-ERPNDB4,
 18698           DFHEIV11,
 18699           DFHEIV99
 18700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18701
 18702
 18703     IF  EIBTRNID NOT = TRANS-EXB1
 18704         IF PENDING-BUS-RECS-FOUND
 18705             NEXT SENTENCE
 18706           ELSE
 18707             MOVE '9'            TO PI-BROWSE-SW
 18708             GO TO 9400-CLEAR.
 18709
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 348
* EL6311.cbl
 18710     IF SHOW-RECORD
 18711        MOVE ER-2253            TO EMI-ERROR
 18712       ELSE
 18713        MOVE ER-2254            TO EMI-ERROR.
 18714
 18715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18716
 18717     IF PI-MAP-NAME = SPACES
 18718        MOVE -1                  TO DPFENTRL
 18719        MOVE EL631D               TO PI-MAP-NAME
 18720        GO TO 8100-SEND-INITIAL-MAP.
 18721
 18722     IF PI-MAP-NAME = EL631B
 18723        MOVE -1                  TO BMAINTL
 18724     ELSE
 18725        IF PI-MAP-NAME = EL631C
 18726           MOVE -1               TO CMAINTL
 18727        ELSE
 18728           MOVE -1               TO DPFENTRL.
 18729
 18730     GO TO 8200-SEND-DATAONLY.
 18731
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 349
* EL6311.cbl
 18733
 18734***************************************************************
 18735*                                                             *
 18736*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18737*                                                             *
 18738*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18739*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18740*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18741*                                                             *
 18742*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18743*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18744*          A. IS IT WITHIN THE SAME COMPANY                   *
 18745*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18746*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18747*                AND IS IT TO BE DISPLAYED.                   *
 18748*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18749*                DISPLAYED.                                   *
 18750*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18751*                DISPLAYED.                                   *
 18752*                                                             *
 18753*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18754*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18755*                                                             *
 18756*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18757*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18758*                THEY ARE NOT TO BE DISPLAYED.                *
 18759*                                                             *
 18760***************************************************************
 18761
 18762 4300-BROWSE-FILE-FORWARD.
 18763     IF FIRST-TIME OR SHOW-RECORD
 18764        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18765        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18766        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18767     ELSE
 18768        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18769        IF ERPNDB-BATCH-SEQ-NO = +9999
 18770           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18771        ELSE
 18772           IF DISPLAY-CHANGE-RECORDS
 18773              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18774           ELSE
 18775              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18776              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18777
 18778
 18779* EXEC CICS HANDLE CONDITION
 18780*         ENDFILE  (4350-END-BATCH)
 18781*         NOTFND   (4350-END-BATCH)
 18782*    END-EXEC.
 18783*    MOVE '"$''I                  ! M #00016004' TO DFHEIV0
 18784     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18786     MOVE X'4D20233030303136303034' TO DFHEIV0(25:11)
 18787     CALL 'kxdfhei1' USING DFHEIV0
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 350
* EL6311.cbl
 18791 4305-READ-NEXT.
 18792     IF PI-DISPLAY-ORIGINAL-BATCH
 18793        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18794     ELSE
 18795        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18796
 18797
 18798* EXEC CICS READ
 18799*         DATASET   (FILE-ID)
 18800*         SET       (ADDRESS OF PENDING-BUSINESS)
 18801*         RIDFLD    (ERPNDB-KEY)
 18802*         GTEQ
 18803*    END-EXEC.
 18804*    MOVE '&"S        G          (   #00016015' TO DFHEIV0
 18805     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18807     MOVE X'2020233030303136303135' TO DFHEIV0(25:11)
 18808     CALL 'kxdfhei1' USING DFHEIV0,
 18809           FILE-ID,
 18810           DFHEIV20,
 18811           DFHEIV99,
 18812           ERPNDB-KEY,
 18813           DFHEIV99,
 18814           DFHEIV99,
 18815           DFHEIV99
 18816     SET ADDRESS OF PENDING-BUSINESS TO
 18817         DFHEIV20
 18818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18819
 18820
 18821     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18822        GO TO 4350-END-BATCH.
 18823
 18824     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18825                                    WS-BATCH-NO.
 18826
 18827     IF  WS-BATCH-PREFIX = '#CL'
 18828         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18829         GO TO 4305-READ-NEXT.
 18830
 18831     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18832     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18833     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18834     MOVE PB-STATE               TO PI-PB-STATE.
 18835     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18836
 18837     IF PB-BATCH-TRAILER
 18838        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18839        GO TO 4305-READ-NEXT.
 18840
 18841     IF SHOW-RECORD
 18842           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18843              GO TO 4310-BUMP-SEQ
 18844           ELSE
 18845              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18846                 GO TO 4310-BUMP-SEQ
 18847              ELSE
 18848                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 351
* EL6311.cbl
 18849
 18850     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18851        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18852           GO TO 4310-BUMP-SEQ
 18853        ELSE
 18854           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18855              GO TO 4307-CHECK-REC-TYPE
 18856           ELSE
 18857              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18858                 GO TO 4307-CHECK-REC-TYPE
 18859              ELSE
 18860                 GO TO 4310-BUMP-SEQ.
 18861
 18862     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18863        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18864           GO TO 4310-BUMP-SEQ.
 18865
 18866 4307-CHECK-REC-TYPE.
 18867     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18868         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18869             NEXT SENTENCE
 18870         ELSE
 18871             GO TO 4310-BUMP-SEQ.
 18872
 18873     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18874         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18875             NEXT SENTENCE
 18876        ELSE
 18877             GO TO 4310-BUMP-SEQ.
 18878
 18879     IF NOT DISPLAY-CHANGE-RECORDS AND
 18880            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18881        GO TO 4310-BUMP-SEQ.
 18882
 18883     IF DISPLAY-HOLD-RECORDS AND
 18884        NOT PB-RECORD-ON-HOLD
 18885          GO TO 4310-BUMP-SEQ.
 18886
 18887     IF PB-ISSUE
 18888        IF DISPLAY-CHK-REQ-RECORDS
 18889           GO TO 4310-BUMP-SEQ.
 18890
 18891     IF PB-ISSUE
 18892        IF ISSUE-WITH-WARNING
 18893           IF PB-WARNING-ERRORS
 18894              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18895                  GO TO 4310-BUMP-SEQ
 18896              ELSE
 18897                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18898                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18899                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18900                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18901                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18902                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18903                 GO TO 7000-DISPLAY-ISSUES
 18904           ELSE
 18905              GO TO 4310-BUMP-SEQ.
 18906
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 352
* EL6311.cbl
 18907     IF PB-ISSUE
 18908        IF (ISSUES-IN-ERROR AND
 18909            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18910            ALL-ISSUES
 18911            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18912            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18913            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18914            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18915            MOVE PB-SV-STATE            TO PI-SV-STATE
 18916            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18917            GO TO 7000-DISPLAY-ISSUES
 18918        ELSE
 18919            GO TO 4310-BUMP-SEQ.
 18920
 18921     IF PB-CANCELLATION
 18922        IF DISPLAY-CHK-REQ-RECORDS
 18923           IF PB-C-REFUND-REQUESTED
 18924              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18925              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18926              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18927              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18928              MOVE PB-SV-STATE            TO PI-SV-STATE
 18929              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18930              GO TO 7100-DISPLAY-CANCELS
 18931           ELSE
 18932              GO TO 4310-BUMP-SEQ.
 18933
 18934     IF PB-CANCELLATION
 18935        IF CANCEL-WITH-WARNING
 18936           IF PB-WARNING-ERRORS
 18937              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18938                  GO TO 4310-BUMP-SEQ
 18939              ELSE
 18940                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18941                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18942                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18943                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18944                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18945                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18946                 GO TO 7100-DISPLAY-CANCELS
 18947           ELSE
 18948              GO TO 4310-BUMP-SEQ.
 18949
 18950     IF PB-CANCELLATION
 18951        IF (CANCEL-IN-ERROR  AND
 18952            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18953            ALL-CANCELS
 18954            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18955            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18956            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18957            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18958            MOVE PB-SV-STATE            TO PI-SV-STATE
 18959            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18960            GO TO 7100-DISPLAY-CANCELS.
 18961
 18962 4310-BUMP-SEQ.
 18963     IF NOT DISPLAY-CHANGE-RECORDS
 18964        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 353
* EL6311.cbl
 18965        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18966     ELSE
 18967        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18968           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18969           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18970        ELSE
 18971           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18972           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 18973
 18974     GO TO 4305-READ-NEXT.
 18975
 18976 4350-END-BATCH.
 18977
 18978******************************************************************
 18979*                                                                *
 18980*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18981*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 18982*         PROGRAM.                                               *
 18983*                                                                *
 18984******************************************************************
 18985
 18986     IF  EIBTRNID NOT = TRANS-EXB1
 18987         IF PENDING-BUS-RECS-FOUND
 18988             NEXT SENTENCE
 18989           ELSE
 18990             MOVE '9'            TO PI-BROWSE-SW
 18991             GO TO 9400-CLEAR.
 18992
 18993     IF SHOW-RECORD
 18994        MOVE ER-2253            TO EMI-ERROR
 18995     ELSE
 18996        MOVE ER-2251            TO EMI-ERROR.
 18997
 18998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18999
 19000     IF PI-MAP-NAME = SPACES
 19001        MOVE -1                  TO BMAINTL
 19002        MOVE EL631B               TO PI-MAP-NAME
 19003        GO TO 8100-SEND-INITIAL-MAP.
 19004
 19005     IF PI-MAP-NAME = EL631B
 19006        MOVE -1                  TO BMAINTL
 19007     ELSE
 19008        IF PI-MAP-NAME = EL631C
 19009           MOVE -1               TO CMAINTL
 19010        ELSE
 19011           MOVE -1               TO DPFENTRL.
 19012
 19013     GO TO 8200-SEND-DATAONLY.
 19014
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 354
* EL6311.cbl
 19016
 19017******************************************************************
 19018*                                                                *
 19019*        B R O W S E   D E T A I L   B A C K W A R D             *
 19020*                                                                *
 19021******************************************************************
 19022
 19023 4500-BROWSE-DETAIL-BACKWARD.
 19024
 19025     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19026
 19027
 19028* EXEC CICS HANDLE CONDITION
 19029*         NOTFND   (4570-NOT-FOUND)
 19030*         ENDFILE  (4550-END-RECORDS)
 19031*    END-EXEC
 19032*    MOVE '"$I''                  ! N #00016228' TO DFHEIV0
 19033     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19035     MOVE X'4E20233030303136323238' TO DFHEIV0(25:11)
 19036     CALL 'kxdfhei1' USING DFHEIV0
 19037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19038
 19039
 19040* EXEC CICS STARTBR
 19041*         DATASET   (FILE-ID-ERPNDB2)
 19042*         RIDFLD    (ERPNDB-ALT-KEY)
 19043*    END-EXEC.
 19044     MOVE 0
 19045       TO DFHEIV11
 19046*    MOVE '&,         G          &   #00016233' TO DFHEIV0
 19047     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19049     MOVE X'2020233030303136323333' TO DFHEIV0(25:11)
 19050     CALL 'kxdfhei1' USING DFHEIV0,
 19051           FILE-ID-ERPNDB2,
 19052           ERPNDB-ALT-KEY,
 19053           DFHEIV99,
 19054           DFHEIV11,
 19055           DFHEIV99
 19056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19057
 19058
 19059     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19060                                    WS-FIRST-TIME-SW.
 19061
 19062 4505-READ-PREV-RECORD.
 19063
 19064* EXEC CICS READPREV
 19065*         DATASET    (FILE-ID-ERPNDB2)
 19066*         SET        (ADDRESS OF PENDING-BUSINESS)
 19067*         RIDFLD     (ERPNDB-ALT-KEY)
 19068*    END-EXEC.
 19069     MOVE 0
 19070       TO DFHEIV11
 19071*    MOVE '&0S                   )   #00016242' TO DFHEIV0
 19072     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19073     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 355
* EL6311.cbl
 19074     MOVE X'2020233030303136323432' TO DFHEIV0(25:11)
 19075     CALL 'kxdfhei1' USING DFHEIV0,
 19076           FILE-ID-ERPNDB2,
 19077           DFHEIV20,
 19078           DFHEIV99,
 19079           ERPNDB-ALT-KEY,
 19080           DFHEIV99,
 19081           DFHEIV11,
 19082           DFHEIV99,
 19083           DFHEIV99
 19084     SET ADDRESS OF PENDING-BUSINESS TO
 19085         DFHEIV20
 19086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19087
 19088
 19089     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19090
 19091     IF WS-BATCH-PREFIX = '#CL'
 19092         GO TO 4505-READ-PREV-RECORD.
 19093
 19094     IF FIRST-TIME
 19095         MOVE SPACE               TO WS-FIRST-TIME-SW
 19096         GO TO 4505-READ-PREV-RECORD.
 19097
 19098     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19099        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19100        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19101        PB-STATE         NOT = PI-PB-STATE    OR
 19102        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19103          GO TO 4550-END-RECORDS.
 19104
 19105
 19106     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19107
 19108     IF PB-BATCH-TRAILER
 19109        GO TO 4505-READ-PREV-RECORD.
 19110
 19111     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19112
 19113     IF  WS-BATCH-PREFIX = '#CL'
 19114         GO TO 4505-READ-PREV-RECORD.
 19115
 19116     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19117        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19118           GO TO 4505-READ-PREV-RECORD
 19119        ELSE
 19120           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19121              GO TO 4510-CHECK-REC-TYPE
 19122           ELSE
 19123              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19124                 GO TO 4510-CHECK-REC-TYPE
 19125              ELSE
 19126                 GO TO 4505-READ-PREV-RECORD.
 19127
 19128     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19129        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19130           GO TO 4505-READ-PREV-RECORD.
 19131
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 356
* EL6311.cbl
 19132 4510-CHECK-REC-TYPE.
 19133     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19134         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19135             NEXT SENTENCE
 19136         ELSE
 19137             GO TO 4505-READ-PREV-RECORD.
 19138
 19139     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19140         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19141             NEXT SENTENCE
 19142        ELSE
 19143             GO TO 4505-READ-PREV-RECORD.
 19144
 19145     IF NOT DISPLAY-CHANGE-RECORDS AND
 19146            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19147        GO TO 4505-READ-PREV-RECORD.
 19148
 19149     IF DISPLAY-HOLD-RECORDS AND
 19150        NOT PB-RECORD-ON-HOLD
 19151          GO TO 4505-READ-PREV-RECORD.
 19152
 19153     IF PB-ISSUE
 19154        IF DISPLAY-CHK-REQ-RECORDS
 19155           GO TO 4505-READ-PREV-RECORD.
 19156
 19157     IF PB-ISSUE
 19158        IF ISSUE-WITH-WARNING
 19159           IF PB-WARNING-ERRORS
 19160              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19161                  GO TO 4505-READ-PREV-RECORD
 19162              ELSE
 19163                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19164                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19165                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19166                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19167                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19168                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19169                 GO TO 7000-DISPLAY-ISSUES
 19170           ELSE
 19171              GO TO 4505-READ-PREV-RECORD.
 19172
 19173     IF PB-ISSUE
 19174        IF (ISSUES-IN-ERROR AND
 19175            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19176            ALL-ISSUES
 19177            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19178            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19179            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19180            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19181            MOVE PB-SV-STATE            TO PI-SV-STATE
 19182            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19183            GO TO 7000-DISPLAY-ISSUES
 19184        ELSE
 19185            GO TO 4505-READ-PREV-RECORD.
 19186
 19187     IF PB-CANCELLATION
 19188        IF DISPLAY-CHK-REQ-RECORDS
 19189           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 357
* EL6311.cbl
 19190              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19191              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19192              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19193              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19194              MOVE PB-SV-STATE            TO PI-SV-STATE
 19195              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19196              GO TO 7100-DISPLAY-CANCELS
 19197           ELSE
 19198              GO TO 4505-READ-PREV-RECORD.
 19199
 19200     IF PB-CANCELLATION
 19201        IF CANCEL-WITH-WARNING
 19202           IF PB-WARNING-ERRORS
 19203              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19204                  GO TO 4505-READ-PREV-RECORD
 19205              ELSE
 19206                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19207                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19208                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19209                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19210                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19211                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19212                 GO TO 7100-DISPLAY-CANCELS
 19213           ELSE
 19214              GO TO 4505-READ-PREV-RECORD.
 19215
 19216     IF PB-CANCELLATION
 19217        IF (CANCEL-IN-ERROR  AND
 19218            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19219            ALL-CANCELS
 19220            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19221            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19222            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19223            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19224            MOVE PB-SV-STATE            TO PI-SV-STATE
 19225            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19226            GO TO 7100-DISPLAY-CANCELS.
 19227
 19228     GO TO 4505-READ-PREV-RECORD.
 19229
 19230 4550-END-RECORDS.
 19231     IF PI-MAP-NAME = EL631B
 19232        MOVE -1                  TO BMAINTL
 19233     ELSE
 19234        IF PI-MAP-NAME = EL631C
 19235           MOVE -1               TO CMAINTL
 19236        ELSE
 19237           MOVE -1               TO DPFENTRL.
 19238
 19239     MOVE ER-2255               TO EMI-ERROR.
 19240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19241     GO TO 8200-SEND-DATAONLY.
 19242
 19243 4570-NOT-FOUND.
 19244
 19245******************************************************************
 19246*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19247******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 358
* EL6311.cbl
 19248
 19249
 19250* EXEC CICS RESETBR
 19251*         DATASET    (FILE-ID-ERPNDB2)
 19252*         RIDFLD     (ERPNDB-ALT-KEY)
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&4         G          &   #00016408' TO DFHEIV0
 19257     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303136343038' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID-ERPNDB2,
 19262           ERPNDB-ALT-KEY,
 19263           DFHEIV99,
 19264           DFHEIV11,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269
 19270* EXEC CICS READNEXT
 19271*         DATASET    (FILE-ID-ERPNDB2)
 19272*         SET        (ADDRESS OF PENDING-BUSINESS)
 19273*         RIDFLD     (ERPNDB-ALT-KEY)
 19274*    END-EXEC.
 19275     MOVE 0
 19276       TO DFHEIV11
 19277*    MOVE '&.S                   )   #00016413' TO DFHEIV0
 19278     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19279     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19280     MOVE X'2020233030303136343133' TO DFHEIV0(25:11)
 19281     CALL 'kxdfhei1' USING DFHEIV0,
 19282           FILE-ID-ERPNDB2,
 19283           DFHEIV20,
 19284           DFHEIV99,
 19285           ERPNDB-ALT-KEY,
 19286           DFHEIV99,
 19287           DFHEIV11,
 19288           DFHEIV99,
 19289           DFHEIV99
 19290     SET ADDRESS OF PENDING-BUSINESS TO
 19291         DFHEIV20
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19293
 19294
 19295
 19296* EXEC CICS READPREV
 19297*         DATASET    (FILE-ID-ERPNDB2)
 19298*         SET        (ADDRESS OF PENDING-BUSINESS)
 19299*         RIDFLD     (ERPNDB-ALT-KEY)
 19300*    END-EXEC.
 19301     MOVE 0
 19302       TO DFHEIV11
 19303*    MOVE '&0S                   )   #00016419' TO DFHEIV0
 19304     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19305     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 359
* EL6311.cbl
 19306     MOVE X'2020233030303136343139' TO DFHEIV0(25:11)
 19307     CALL 'kxdfhei1' USING DFHEIV0,
 19308           FILE-ID-ERPNDB2,
 19309           DFHEIV20,
 19310           DFHEIV99,
 19311           ERPNDB-ALT-KEY,
 19312           DFHEIV99,
 19313           DFHEIV11,
 19314           DFHEIV99,
 19315           DFHEIV99
 19316     SET ADDRESS OF PENDING-BUSINESS TO
 19317         DFHEIV20
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321 4580-READ-PREV-RECORD.
 19322
 19323* EXEC CICS READPREV
 19324*         DATASET    (FILE-ID-ERPNDB2)
 19325*         SET        (ADDRESS OF PENDING-BUSINESS)
 19326*         RIDFLD     (ERPNDB-ALT-KEY)
 19327*    END-EXEC.
 19328     MOVE 0
 19329       TO DFHEIV11
 19330*    MOVE '&0S                   )   #00016426' TO DFHEIV0
 19331     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19332     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19333     MOVE X'2020233030303136343236' TO DFHEIV0(25:11)
 19334     CALL 'kxdfhei1' USING DFHEIV0,
 19335           FILE-ID-ERPNDB2,
 19336           DFHEIV20,
 19337           DFHEIV99,
 19338           ERPNDB-ALT-KEY,
 19339           DFHEIV99,
 19340           DFHEIV11,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     SET ADDRESS OF PENDING-BUSINESS TO
 19344         DFHEIV20
 19345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19346
 19347
 19348     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19349
 19350     IF WS-BATCH-PREFIX = '#CL'
 19351        GO TO 4580-READ-PREV-RECORD.
 19352
 19353     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19354     GO TO 4505-READ-PREV-RECORD.
 19355
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 360
* EL6311.cbl
 19357
 19358******************************************************************
 19359*                                                                *
 19360*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19361*                                                                *
 19362******************************************************************
 19363
 19364 4600-BROWSE-PRIMARY-BACKWARD.
 19365        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19366
 19367     IF ERPNDB-BATCH-SEQ-NO = +9999
 19368        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19369
 19370        IF ERPNDB-BATCH-SEQ-NO = +0000
 19371           GO TO 4650-END-BATCH
 19372        ELSE
 19373           IF PI-MAP-NAME NOT = EL631D
 19374              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19375                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19376              ELSE
 19377                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19378                 IF DISPLAY-CHANGE-RECORDS
 19379                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19380                 ELSE
 19381                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19382
 19383
 19384* EXEC CICS HANDLE CONDITION
 19385*         NOTFND    (4680-NOT-FOUND)
 19386*         ENDFILE   (4680-NOT-FOUND)
 19387*    END-EXEC.
 19388*    MOVE '"$I''                  ! O #00016467' TO DFHEIV0
 19389     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19391     MOVE X'4F20233030303136343637' TO DFHEIV0(25:11)
 19392     CALL 'kxdfhei1' USING DFHEIV0
 19393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19394
 19395
 19396 4605-READ-NEXT.
 19397     IF ERPNDB-BATCH-SEQ-NO = +0000
 19398        GO TO 4650-END-BATCH.
 19399
 19400     IF PI-DISPLAY-ORIGINAL-BATCH
 19401        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19402     ELSE
 19403        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19404
 19405
 19406* EXEC CICS READ
 19407*         DATASET   (FILE-ID)
 19408*         SET       (ADDRESS OF PENDING-BUSINESS)
 19409*         RIDFLD    (ERPNDB-KEY)
 19410*    END-EXEC.
 19411*    MOVE '&"S        E          (   #00016481' TO DFHEIV0
 19412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19414     MOVE X'2020233030303136343831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 361
* EL6311.cbl
 19415     CALL 'kxdfhei1' USING DFHEIV0,
 19416           FILE-ID,
 19417           DFHEIV20,
 19418           DFHEIV99,
 19419           ERPNDB-KEY,
 19420           DFHEIV99,
 19421           DFHEIV99,
 19422           DFHEIV99
 19423     SET ADDRESS OF PENDING-BUSINESS TO
 19424         DFHEIV20
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428     IF NOT  PI-PRIMARY-WITH-SELECT
 19429        GO TO 4607-CHECK-REC-TYPE.
 19430
 19431     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19432
 19433     IF  WS-BATCH-PREFIX = '#CL'
 19434         GO TO 4610-BUMP-SEQ.
 19435
 19436     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19437        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19438           GO TO 4610-BUMP-SEQ
 19439        ELSE
 19440           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19441              GO TO 4607-CHECK-REC-TYPE
 19442           ELSE
 19443              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19444                 GO TO 4607-CHECK-REC-TYPE
 19445              ELSE
 19446                 GO TO 4610-BUMP-SEQ.
 19447
 19448     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19449        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19450           GO TO 4610-BUMP-SEQ.
 19451
 19452 4607-CHECK-REC-TYPE.
 19453     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19454         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19455             NEXT SENTENCE
 19456         ELSE
 19457             GO TO 4610-BUMP-SEQ.
 19458
 19459     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19460         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19461             NEXT SENTENCE
 19462        ELSE
 19463             GO TO 4610-BUMP-SEQ.
 19464
 19465     IF NOT DISPLAY-CHANGE-RECORDS AND
 19466            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19467        GO TO 4610-BUMP-SEQ.
 19468
 19469     IF DISPLAY-HOLD-RECORDS AND
 19470        NOT PB-RECORD-ON-HOLD
 19471          GO TO 4610-BUMP-SEQ.
 19472
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 362
* EL6311.cbl
 19473     IF PB-ISSUE
 19474        IF DISPLAY-CHK-REQ-RECORDS
 19475           GO TO 4610-BUMP-SEQ.
 19476
 19477     IF PB-ISSUE
 19478        IF ISSUE-WITH-WARNING
 19479           IF PB-WARNING-ERRORS
 19480              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19481                  GO TO 4610-BUMP-SEQ
 19482              ELSE
 19483                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19484                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19485                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19486                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19487                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19488                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19489                 GO TO 7000-DISPLAY-ISSUES
 19490           ELSE
 19491              GO TO 4610-BUMP-SEQ.
 19492
 19493     IF PB-ISSUE
 19494        IF (ISSUES-IN-ERROR AND
 19495            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19496            ALL-ISSUES
 19497            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19498            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19499            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19500            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19501            MOVE PB-SV-STATE            TO PI-SV-STATE
 19502            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19503            GO TO 7000-DISPLAY-ISSUES
 19504        ELSE
 19505            GO TO 4610-BUMP-SEQ.
 19506
 19507     IF PB-CANCELLATION
 19508        IF DISPLAY-CHK-REQ-RECORDS
 19509           IF PB-C-REFUND-REQUESTED
 19510              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19511              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19512              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19513              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19514              MOVE PB-SV-STATE            TO PI-SV-STATE
 19515              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19516              GO TO 7100-DISPLAY-CANCELS
 19517           ELSE
 19518              GO TO 4610-BUMP-SEQ.
 19519
 19520     IF PB-CANCELLATION
 19521        IF CANCEL-WITH-WARNING
 19522           IF PB-WARNING-ERRORS
 19523              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19524                  GO TO 4610-BUMP-SEQ
 19525              ELSE
 19526                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19527                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19528                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19529                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19530                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 363
* EL6311.cbl
 19531                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19532                 GO TO 7100-DISPLAY-CANCELS
 19533           ELSE
 19534              GO TO 4610-BUMP-SEQ.
 19535
 19536     IF PB-CANCELLATION
 19537        IF (CANCEL-IN-ERROR  AND
 19538            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19539            ALL-CANCELS
 19540            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19541            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19542            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19543            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19544            MOVE PB-SV-STATE            TO PI-SV-STATE
 19545            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19546            GO TO 7100-DISPLAY-CANCELS.
 19547
 19548 4610-BUMP-SEQ.
 19549     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19550        GO TO 4650-END-BATCH.
 19551
 19552     IF DISPLAY-CHANGE-RECORDS
 19553        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19554           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19555        ELSE
 19556           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19557           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19558        ELSE
 19559           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19560           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19561
 19562        GO TO 4605-READ-NEXT.
 19563
 19564 4650-END-BATCH.
 19565     IF PI-MAP-NAME = EL631B
 19566        MOVE -1                  TO BMAINTL
 19567     ELSE
 19568        IF PI-MAP-NAME = EL631C
 19569           MOVE -1               TO CMAINTL
 19570        ELSE
 19571           MOVE -1               TO DPFENTRL.
 19572
 19573     MOVE ER-2252               TO EMI-ERROR.
 19574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19575     GO TO 8200-SEND-DATAONLY.
 19576
 19577 4680-NOT-FOUND.
 19578     IF DISPLAY-CHANGE-RECORDS
 19579        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19580           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19581        ELSE
 19582           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19583           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19584     ELSE
 19585        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19586
 19587     GO TO 4605-READ-NEXT.
 19588
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 364
* EL6311.cbl
 19590
 19591******************************************************************
 19592*                                                                *
 19593*        B R O W S E   F I L E   B A C K W A R D S               *
 19594*                                                                *
 19595******************************************************************
 19596
 19597 4800-BROWSE-FILE-BACKWARD.
 19598
 19599* EXEC CICS HANDLE CONDITION
 19600*         NOTFND   (4860-NOT-FOUND)
 19601*         ENDFILE  (4850-END-RECORDS)
 19602*    END-EXEC.
 19603*    MOVE '"$I''                  ! P #00016657' TO DFHEIV0
 19604     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19606     MOVE X'5020233030303136363537' TO DFHEIV0(25:11)
 19607     CALL 'kxdfhei1' USING DFHEIV0
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19609
 19610
 19611     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19612
 19613     IF PI-DISPLAY-ORIGINAL-BATCH
 19614        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19615     ELSE
 19616        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19617
 19618
 19619* EXEC CICS STARTBR
 19620*         DATASET   (FILE-ID)
 19621*         RIDFLD    (ERPNDB-KEY)
 19622*    END-EXEC.
 19623     MOVE 0
 19624       TO DFHEIV11
 19625*    MOVE '&,         G          &   #00016669' TO DFHEIV0
 19626     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19628     MOVE X'2020233030303136363639' TO DFHEIV0(25:11)
 19629     CALL 'kxdfhei1' USING DFHEIV0,
 19630           FILE-ID,
 19631           ERPNDB-KEY,
 19632           DFHEIV99,
 19633           DFHEIV11,
 19634           DFHEIV99
 19635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19636
 19637
 19638     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19639
 19640
 19641* EXEC CICS READPREV
 19642*         DATASET    (FILE-ID-ERPNDB)
 19643*         SET        (ADDRESS OF PENDING-BUSINESS)
 19644*         RIDFLD     (ERPNDB-KEY)
 19645*    END-EXEC.
 19646     MOVE 0
 19647       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 365
* EL6311.cbl
 19648*    MOVE '&0S                   )   #00016676' TO DFHEIV0
 19649     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303136363736' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           FILE-ID-ERPNDB,
 19654           DFHEIV20,
 19655           DFHEIV99,
 19656           ERPNDB-KEY,
 19657           DFHEIV99,
 19658           DFHEIV11,
 19659           DFHEIV99,
 19660           DFHEIV99
 19661     SET ADDRESS OF PENDING-BUSINESS TO
 19662         DFHEIV20
 19663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19664
 19665
 19666 4810-READ-PREV-RECORD.
 19667
 19668* EXEC CICS READPREV
 19669*         DATASET    (FILE-ID-ERPNDB)
 19670*         SET        (ADDRESS OF PENDING-BUSINESS)
 19671*         RIDFLD     (ERPNDB-KEY)
 19672*    END-EXEC.
 19673     MOVE 0
 19674       TO DFHEIV11
 19675*    MOVE '&0S                   )   #00016683' TO DFHEIV0
 19676     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19677     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19678     MOVE X'2020233030303136363833' TO DFHEIV0(25:11)
 19679     CALL 'kxdfhei1' USING DFHEIV0,
 19680           FILE-ID-ERPNDB,
 19681           DFHEIV20,
 19682           DFHEIV99,
 19683           ERPNDB-KEY,
 19684           DFHEIV99,
 19685           DFHEIV11,
 19686           DFHEIV99,
 19687           DFHEIV99
 19688     SET ADDRESS OF PENDING-BUSINESS TO
 19689         DFHEIV20
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19694        GO TO 4850-END-RECORDS.
 19695
 19696     IF PB-BATCH-TRAILER
 19697        GO TO 4810-READ-PREV-RECORD.
 19698
 19699     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19700
 19701     IF  WS-BATCH-PREFIX = '#CL'
 19702         GO TO 4810-READ-PREV-RECORD.
 19703
 19704     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19705        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 366
* EL6311.cbl
 19706           GO TO 4810-READ-PREV-RECORD
 19707        ELSE
 19708           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19709              GO TO 4820-CHECK-REC-TYPE
 19710           ELSE
 19711              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19712                 GO TO 4820-CHECK-REC-TYPE
 19713              ELSE
 19714                 GO TO 4810-READ-PREV-RECORD.
 19715
 19716     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19717        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19718           GO TO 4810-READ-PREV-RECORD.
 19719
 19720 4820-CHECK-REC-TYPE.
 19721     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19722         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19723             NEXT SENTENCE
 19724         ELSE
 19725             GO TO 4810-READ-PREV-RECORD.
 19726
 19727     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19728         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19729             NEXT SENTENCE
 19730        ELSE
 19731             GO TO 4810-READ-PREV-RECORD.
 19732
 19733     IF NOT DISPLAY-CHANGE-RECORDS AND
 19734            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19735        GO TO 4810-READ-PREV-RECORD.
 19736
 19737     IF DISPLAY-HOLD-RECORDS AND
 19738        NOT PB-RECORD-ON-HOLD
 19739          GO TO 4810-READ-PREV-RECORD.
 19740
 19741     IF PB-ISSUE
 19742        IF DISPLAY-CHK-REQ-RECORDS
 19743           GO TO 4810-READ-PREV-RECORD.
 19744
 19745     IF PB-ISSUE
 19746        IF ISSUE-WITH-WARNING
 19747           IF PB-WARNING-ERRORS
 19748              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19749                  GO TO 4810-READ-PREV-RECORD
 19750              ELSE
 19751                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19752                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19753                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19754                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19755                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19756                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19757                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19758                 GO TO 7000-DISPLAY-ISSUES
 19759           ELSE
 19760              GO TO 4810-READ-PREV-RECORD.
 19761
 19762     IF PB-ISSUE
 19763        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 367
* EL6311.cbl
 19764            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19765            ALL-ISSUES
 19766            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19767            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19768            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19769            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19770            MOVE PB-SV-STATE            TO PI-SV-STATE
 19771            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19772            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19773            GO TO 7000-DISPLAY-ISSUES
 19774        ELSE
 19775            GO TO 4810-READ-PREV-RECORD.
 19776
 19777     IF PB-CANCELLATION
 19778        IF DISPLAY-CHK-REQ-RECORDS
 19779           IF PB-C-REFUND-REQUESTED
 19780              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19781              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19782              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19783              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19784              MOVE PB-SV-STATE            TO PI-SV-STATE
 19785              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19786              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19787              GO TO 7100-DISPLAY-CANCELS
 19788           ELSE
 19789              GO TO 4810-READ-PREV-RECORD.
 19790
 19791     IF PB-CANCELLATION
 19792        IF CANCEL-WITH-WARNING
 19793           IF PB-WARNING-ERRORS
 19794              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19795                  GO TO 4810-READ-PREV-RECORD
 19796              ELSE
 19797                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19798                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19799                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19800                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19801                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19802                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19803                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19804                 GO TO 7100-DISPLAY-CANCELS
 19805           ELSE
 19806              GO TO 4810-READ-PREV-RECORD.
 19807
 19808     IF PB-CANCELLATION
 19809        IF (CANCEL-IN-ERROR  AND
 19810            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19811            ALL-CANCELS
 19812            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19813            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19814            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19815            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19816            MOVE PB-SV-STATE            TO PI-SV-STATE
 19817            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19818            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19819            GO TO 7100-DISPLAY-CANCELS.
 19820
 19821     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 368
* EL6311.cbl
 19822
 19823 4850-END-RECORDS.
 19824     MOVE ER-2252                TO EMI-ERROR.
 19825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19826
 19827     IF PI-MAP-NAME = EL631B
 19828        MOVE -1                  TO BPFENTRL
 19829     ELSE
 19830        MOVE -1                  TO CPFENTRL.
 19831
 19832     GO TO 8200-SEND-DATAONLY.
 19833
 19834 4860-NOT-FOUND.
 19835
 19836******************************************************************
 19837*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19838******************************************************************
 19839
 19840
 19841* EXEC CICS RESETBR
 19842*         DATASET    (FILE-ID-ERPNDB)
 19843*         RIDFLD     (ERPNDB-KEY)
 19844*     END-EXEC.
 19845     MOVE 0
 19846       TO DFHEIV11
 19847*    MOVE '&4         G          &   #00016836' TO DFHEIV0
 19848     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19850     MOVE X'2020233030303136383336' TO DFHEIV0(25:11)
 19851     CALL 'kxdfhei1' USING DFHEIV0,
 19852           FILE-ID-ERPNDB,
 19853           ERPNDB-KEY,
 19854           DFHEIV99,
 19855           DFHEIV11,
 19856           DFHEIV99
 19857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19858
 19859
 19860
 19861* EXEC CICS READNEXT
 19862*         DATASET    (FILE-ID-ERPNDB)
 19863*         SET        (ADDRESS OF PENDING-BUSINESS)
 19864*         RIDFLD     (ERPNDB-KEY)
 19865*    END-EXEC.
 19866     MOVE 0
 19867       TO DFHEIV11
 19868*    MOVE '&.S                   )   #00016841' TO DFHEIV0
 19869     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19870     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19871     MOVE X'2020233030303136383431' TO DFHEIV0(25:11)
 19872     CALL 'kxdfhei1' USING DFHEIV0,
 19873           FILE-ID-ERPNDB,
 19874           DFHEIV20,
 19875           DFHEIV99,
 19876           ERPNDB-KEY,
 19877           DFHEIV99,
 19878           DFHEIV11,
 19879           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 369
* EL6311.cbl
 19880           DFHEIV99
 19881     SET ADDRESS OF PENDING-BUSINESS TO
 19882         DFHEIV20
 19883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19884
 19885
 19886
 19887* EXEC CICS READPREV
 19888*         DATASET    (FILE-ID-ERPNDB)
 19889*         SET        (ADDRESS OF PENDING-BUSINESS)
 19890*         RIDFLD     (ERPNDB-KEY)
 19891*    END-EXEC.
 19892     MOVE 0
 19893       TO DFHEIV11
 19894*    MOVE '&0S                   )   #00016847' TO DFHEIV0
 19895     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19896     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19897     MOVE X'2020233030303136383437' TO DFHEIV0(25:11)
 19898     CALL 'kxdfhei1' USING DFHEIV0,
 19899           FILE-ID-ERPNDB,
 19900           DFHEIV20,
 19901           DFHEIV99,
 19902           ERPNDB-KEY,
 19903           DFHEIV99,
 19904           DFHEIV11,
 19905           DFHEIV99,
 19906           DFHEIV99
 19907     SET ADDRESS OF PENDING-BUSINESS TO
 19908         DFHEIV20
 19909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19910
 19911
 19912     GO TO 4810-READ-PREV-RECORD.
 19913
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 370
* EL6311.cbl
 19915
 19916******************************************************************
 19917*                                                                *
 19918*           B R O W S E   C S R   B A C K W A R D                *
 19919*                                                                *
 19920******************************************************************
 19921
 19922 4900-BROWSE-CSR-BACKWARD.
 19923
 19924     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19925
 19926
 19927* EXEC CICS HANDLE CONDITION
 19928*         NOTFND   (4970-NOT-FOUND)
 19929*         ENDFILE  (4950-END-RECORDS)
 19930*    END-EXEC
 19931*    MOVE '"$I''                  ! Q #00016867' TO DFHEIV0
 19932     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19934     MOVE X'5120233030303136383637' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0
 19936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19937
 19938
 19939* EXEC CICS STARTBR
 19940*         DATASET   (FILE-ID-ERPNDB4)
 19941*         RIDFLD    (ERPNDB-CSR-KEY)
 19942*    END-EXEC.
 19943     MOVE 0
 19944       TO DFHEIV11
 19945*    MOVE '&,         G          &   #00016872' TO DFHEIV0
 19946     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303136383732' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           FILE-ID-ERPNDB4,
 19951           ERPNDB-CSR-KEY,
 19952           DFHEIV99,
 19953           DFHEIV11,
 19954           DFHEIV99
 19955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19956
 19957
 19958     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19959                                    WS-FIRST-TIME-SW.
 19960
 19961 4905-READ-PREV-RECORD.
 19962
 19963* EXEC CICS READPREV
 19964*         DATASET    (FILE-ID-ERPNDB4)
 19965*         SET        (ADDRESS OF PENDING-BUSINESS)
 19966*         RIDFLD     (ERPNDB-CSR-KEY)
 19967*    END-EXEC.
 19968     MOVE 0
 19969       TO DFHEIV11
 19970*    MOVE '&0S                   )   #00016881' TO DFHEIV0
 19971     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19972     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 371
* EL6311.cbl
 19973     MOVE X'2020233030303136383831' TO DFHEIV0(25:11)
 19974     CALL 'kxdfhei1' USING DFHEIV0,
 19975           FILE-ID-ERPNDB4,
 19976           DFHEIV20,
 19977           DFHEIV99,
 19978           ERPNDB-CSR-KEY,
 19979           DFHEIV99,
 19980           DFHEIV11,
 19981           DFHEIV99,
 19982           DFHEIV99
 19983     SET ADDRESS OF PENDING-BUSINESS TO
 19984         DFHEIV20
 19985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19986
 19987
 19988     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19989
 19990     IF WS-BATCH-PREFIX = '#CL'
 19991         GO TO 4905-READ-PREV-RECORD.
 19992
 19993     IF FIRST-TIME
 19994         MOVE SPACE               TO WS-FIRST-TIME-SW
 19995         GO TO 4905-READ-PREV-RECORD.
 19996
 19997     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19998        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19999        GO TO 4950-END-RECORDS.
 20000
 20001     IF PB-BATCH-TRAILER
 20002        GO TO 4905-READ-PREV-RECORD.
 20003
 20004     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20005
 20006     IF  WS-BATCH-PREFIX = '#CL'
 20007         GO TO 4905-READ-PREV-RECORD.
 20008
 20009     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20010        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20011           GO TO 4905-READ-PREV-RECORD
 20012        ELSE
 20013           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20014              GO TO 4910-CHECK-REC-TYPE
 20015           ELSE
 20016              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20017                 GO TO 4910-CHECK-REC-TYPE
 20018              ELSE
 20019                 GO TO 4905-READ-PREV-RECORD.
 20020
 20021     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20022        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20023           GO TO 4905-READ-PREV-RECORD.
 20024
 20025 4910-CHECK-REC-TYPE.
 20026     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20027         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20028             NEXT SENTENCE
 20029         ELSE
 20030             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 372
* EL6311.cbl
 20031
 20032     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20033         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20034             NEXT SENTENCE
 20035        ELSE
 20036             GO TO 4905-READ-PREV-RECORD.
 20037
 20038     IF NOT DISPLAY-CHANGE-RECORDS AND
 20039            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20040        GO TO 4905-READ-PREV-RECORD.
 20041
 20042     IF DISPLAY-HOLD-RECORDS AND
 20043        NOT PB-RECORD-ON-HOLD
 20044          GO TO 4905-READ-PREV-RECORD.
 20045
 20046     IF PB-ISSUE
 20047        IF DISPLAY-CHK-REQ-RECORDS
 20048           GO TO 4905-READ-PREV-RECORD.
 20049
 20050     IF PB-ISSUE
 20051        IF ISSUE-WITH-WARNING
 20052           IF PB-WARNING-ERRORS
 20053              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20054                  GO TO 4505-READ-PREV-RECORD
 20055              ELSE
 20056                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20057                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20058                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20059                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20060                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20061                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20062                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20063                 GO TO 7000-DISPLAY-ISSUES
 20064           ELSE
 20065              GO TO 4905-READ-PREV-RECORD.
 20066
 20067     IF PB-ISSUE
 20068        IF (ISSUES-IN-ERROR AND
 20069            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20070            ALL-ISSUES
 20071            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20072            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20073            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20074            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20075            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20076            MOVE PB-SV-STATE            TO PI-SV-STATE
 20077            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20078            GO TO 7000-DISPLAY-ISSUES
 20079        ELSE
 20080            GO TO 4905-READ-PREV-RECORD.
 20081
 20082     IF PB-CANCELLATION
 20083        IF DISPLAY-CHK-REQ-RECORDS
 20084           IF PB-C-REFUND-REQUESTED
 20085              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20086              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20087              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20088              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 373
* EL6311.cbl
 20089              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20090              MOVE PB-SV-STATE            TO PI-SV-STATE
 20091              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20092              GO TO 7100-DISPLAY-CANCELS
 20093           ELSE
 20094              GO TO 4905-READ-PREV-RECORD.
 20095
 20096     IF PB-CANCELLATION
 20097        IF CANCEL-WITH-WARNING
 20098           IF PB-WARNING-ERRORS
 20099              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20100                  GO TO 4505-READ-PREV-RECORD
 20101              ELSE
 20102                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20103                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20104                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20105                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20106                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20107                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20108                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20109                 GO TO 7100-DISPLAY-CANCELS
 20110           ELSE
 20111              GO TO 4905-READ-PREV-RECORD.
 20112
 20113     IF PB-CANCELLATION
 20114        IF (CANCEL-IN-ERROR  AND
 20115            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20116            ALL-CANCELS
 20117            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20118            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20119            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20120            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20121            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20122            MOVE PB-SV-STATE            TO PI-SV-STATE
 20123            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20124            GO TO 7100-DISPLAY-CANCELS.
 20125
 20126     GO TO 4905-READ-PREV-RECORD.
 20127
 20128 4950-END-RECORDS.
 20129     IF PI-MAP-NAME = EL631B
 20130        MOVE -1                  TO BMAINTL
 20131     ELSE
 20132        IF PI-MAP-NAME = EL631C
 20133           MOVE -1               TO CMAINTL
 20134        ELSE
 20135           MOVE -1               TO DPFENTRL.
 20136
 20137     MOVE ER-2255               TO EMI-ERROR.
 20138     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20139     GO TO 8200-SEND-DATAONLY.
 20140
 20141 4970-NOT-FOUND.
 20142
 20143******************************************************************
 20144*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20145******************************************************************
 20146
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 374
* EL6311.cbl
 20147
 20148* EXEC CICS RESETBR
 20149*         DATASET    (FILE-ID-ERPNDB4)
 20150*         RIDFLD     (ERPNDB-CSR-KEY)
 20151*    END-EXEC.
 20152     MOVE 0
 20153       TO DFHEIV11
 20154*    MOVE '&4         G          &   #00017046' TO DFHEIV0
 20155     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303137303436' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           FILE-ID-ERPNDB4,
 20160           ERPNDB-CSR-KEY,
 20161           DFHEIV99,
 20162           DFHEIV11,
 20163           DFHEIV99
 20164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20165
 20166
 20167
 20168* EXEC CICS READNEXT
 20169*         DATASET    (FILE-ID-ERPNDB4)
 20170*         SET        (ADDRESS OF PENDING-BUSINESS)
 20171*         RIDFLD     (ERPNDB-CSR-KEY)
 20172*    END-EXEC.
 20173     MOVE 0
 20174       TO DFHEIV11
 20175*    MOVE '&.S                   )   #00017051' TO DFHEIV0
 20176     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20178     MOVE X'2020233030303137303531' TO DFHEIV0(25:11)
 20179     CALL 'kxdfhei1' USING DFHEIV0,
 20180           FILE-ID-ERPNDB4,
 20181           DFHEIV20,
 20182           DFHEIV99,
 20183           ERPNDB-CSR-KEY,
 20184           DFHEIV99,
 20185           DFHEIV11,
 20186           DFHEIV99,
 20187           DFHEIV99
 20188     SET ADDRESS OF PENDING-BUSINESS TO
 20189         DFHEIV20
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20191
 20192
 20193
 20194* EXEC CICS READPREV
 20195*         DATASET    (FILE-ID-ERPNDB4)
 20196*         SET        (ADDRESS OF PENDING-BUSINESS)
 20197*         RIDFLD     (ERPNDB-CSR-KEY)
 20198*    END-EXEC.
 20199     MOVE 0
 20200       TO DFHEIV11
 20201*    MOVE '&0S                   )   #00017057' TO DFHEIV0
 20202     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303137303537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 375
* EL6311.cbl
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           FILE-ID-ERPNDB4,
 20207           DFHEIV20,
 20208           DFHEIV99,
 20209           ERPNDB-CSR-KEY,
 20210           DFHEIV99,
 20211           DFHEIV11,
 20212           DFHEIV99,
 20213           DFHEIV99
 20214     SET ADDRESS OF PENDING-BUSINESS TO
 20215         DFHEIV20
 20216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20217
 20218
 20219 4980-READ-PREV-RECORD.
 20220
 20221* EXEC CICS READPREV
 20222*         DATASET    (FILE-ID-ERPNDB4)
 20223*         SET        (ADDRESS OF PENDING-BUSINESS)
 20224*         RIDFLD     (ERPNDB-CSR-KEY)
 20225*    END-EXEC.
 20226     MOVE 0
 20227       TO DFHEIV11
 20228*    MOVE '&0S                   )   #00017064' TO DFHEIV0
 20229     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20230     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20231     MOVE X'2020233030303137303634' TO DFHEIV0(25:11)
 20232     CALL 'kxdfhei1' USING DFHEIV0,
 20233           FILE-ID-ERPNDB4,
 20234           DFHEIV20,
 20235           DFHEIV99,
 20236           ERPNDB-CSR-KEY,
 20237           DFHEIV99,
 20238           DFHEIV11,
 20239           DFHEIV99,
 20240           DFHEIV99
 20241     SET ADDRESS OF PENDING-BUSINESS TO
 20242         DFHEIV20
 20243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20244
 20245
 20246     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20247
 20248     IF WS-BATCH-PREFIX = '#CL'
 20249        GO TO 4980-READ-PREV-RECORD.
 20250
 20251     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20252     GO TO 4905-READ-PREV-RECORD.
 20253
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 376
* EL6311.cbl
 20255
 20256
 20257******************************************************************
 20258*                                                                *
 20259*        B R O W S E   B A T C H   H E A D E R S                 *
 20260*                                                                *
 20261******************************************************************
 20262
 20263 5000-BROWSE-BATCH-HEADERS.
 20264
 20265     IF EIBTRNID NOT = TRANS-EXB1
 20266        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20267        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20268        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20269        GO TO 5010-READ-NEXT-RECORD.
 20270
 20271     IF EIBAID = DFHPF4
 20272        MOVE '0'                TO PI-EDIT-SW
 20273        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20274        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20275        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20276        GO TO 5010-READ-NEXT-RECORD.
 20277
 20278     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20279     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20280     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20281
 20282
 20283* EXEC CICS HANDLE CONDITION
 20284*         ENDFILE  (5050-NOT-FOUND)
 20285*    END-EXEC.
 20286*    MOVE '"$''                   ! R #00017106' TO DFHEIV0
 20287     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20289     MOVE X'5220233030303137313036' TO DFHEIV0(25:11)
 20290     CALL 'kxdfhei1' USING DFHEIV0
 20291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20292
 20293
 20294 5010-READ-NEXT-RECORD.
 20295
 20296* EXEC CICS HANDLE CONDITION
 20297*         NOTFND    (5050-NOT-FOUND)
 20298*    END-EXEC.
 20299*    MOVE '"$I                   ! S #00017111' TO DFHEIV0
 20300     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20302     MOVE X'5320233030303137313131' TO DFHEIV0(25:11)
 20303     CALL 'kxdfhei1' USING DFHEIV0
 20304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20305
 20306
 20307
 20308* EXEC CICS READ
 20309*         DATASET   (FILE-ID-ERPNDB)
 20310*         SET       (ADDRESS OF PENDING-BUSINESS)
 20311*         RIDFLD    (ERPNDB-KEY)
 20312*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 377
* EL6311.cbl
 20313*    END-EXEC.
 20314*    MOVE '&"S        G          (   #00017115' TO DFHEIV0
 20315     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303137313135' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           FILE-ID-ERPNDB,
 20320           DFHEIV20,
 20321           DFHEIV99,
 20322           ERPNDB-KEY,
 20323           DFHEIV99,
 20324           DFHEIV99,
 20325           DFHEIV99
 20326     SET ADDRESS OF PENDING-BUSINESS TO
 20327         DFHEIV20
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20332         GO TO 5050-NOT-FOUND.
 20333
 20334     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20335
 20336     IF WS-BATCH-PREFIX = '#CL'
 20337         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20338         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20339         GO TO 5010-READ-NEXT-RECORD.
 20340
 20341     IF NOT PB-BATCH-TRAILER
 20342         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20343         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20344         GO TO 5010-READ-NEXT-RECORD.
 20345
 20346     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20347         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20348             NEXT SENTENCE
 20349         ELSE
 20350             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20351             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20352             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20353             GO TO 5010-READ-NEXT-RECORD.
 20354
 20355     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20356         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20357             NEXT SENTENCE
 20358        ELSE
 20359             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20360             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20361             GO TO 5010-READ-NEXT-RECORD.
 20362
 20363     IF EIBAID = DFHPF4
 20364        MOVE '0'                TO PI-EDIT-SW
 20365        GO TO 7200-DISPLAY-BATCHES.
 20366
 20367     IF PI-CSR-BROWSE
 20368        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20369           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20370           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 378
* EL6311.cbl
 20371           GO TO 5010-READ-NEXT-RECORD.
 20372
 20373     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20374       IF PI-PB-CARRIER    = SPACES AND
 20375          PI-PB-GROUPING   = SPACES AND
 20376          PI-PB-STATE      = SPACES AND
 20377          PI-PB-ACCOUNT    = SPACES
 20378            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20379            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20380            GO TO 7200-DISPLAY-BATCHES
 20381         ELSE
 20382           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20383              PI-PB-GROUPING   = PB-GROUPING AND
 20384              PI-PB-STATE      = PB-STATE    AND
 20385              PI-PB-ACCOUNT    = PB-ACCOUNT
 20386              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20387              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20388              GO TO 7200-DISPLAY-BATCHES.
 20389
 20390     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20391     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20392
 20393
 20394* EXEC CICS HANDLE CONDITION
 20395*         NOTFND    (5050-NOT-FOUND)
 20396*    END-EXEC.
 20397*    MOVE '"$I                   ! T #00017184' TO DFHEIV0
 20398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20400     MOVE X'5420233030303137313834' TO DFHEIV0(25:11)
 20401     CALL 'kxdfhei1' USING DFHEIV0
 20402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20403
 20404
 20405
 20406* EXEC CICS READ
 20407*         DATASET   (FILE-ID-ERPNDB)
 20408*         SET       (ADDRESS OF PENDING-BUSINESS)
 20409*         RIDFLD    (ERPNDB-KEY)
 20410*         GTEQ
 20411*    END-EXEC.
 20412*    MOVE '&"S        G          (   #00017188' TO DFHEIV0
 20413     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303137313838' TO DFHEIV0(25:11)
 20416     CALL 'kxdfhei1' USING DFHEIV0,
 20417           FILE-ID-ERPNDB,
 20418           DFHEIV20,
 20419           DFHEIV99,
 20420           ERPNDB-KEY,
 20421           DFHEIV99,
 20422           DFHEIV99,
 20423           DFHEIV99
 20424     SET ADDRESS OF PENDING-BUSINESS TO
 20425         DFHEIV20
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 379
* EL6311.cbl
 20429     GO TO 5010-READ-NEXT-RECORD.
 20430
 20431 5050-NOT-FOUND.
 20432
 20433******************************************************************
 20434*                                                                *
 20435*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20436*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20437*         PROGRAM.                                               *
 20438*                                                                *
 20439******************************************************************
 20440
 20441     IF EIBTRNID NOT = TRANS-EXB1
 20442        IF PENDING-BUS-RECS-FOUND
 20443            NEXT SENTENCE
 20444          ELSE
 20445            MOVE '9'            TO PI-BROWSE-SW
 20446            GO TO 9400-CLEAR.
 20447
 20448     MOVE ER-2256                TO EMI-ERROR.
 20449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20450
 20451     IF PI-MAP-NAME = SPACES
 20452        MOVE EL631D              TO PI-MAP-NAME
 20453        MOVE -1                  TO DPFENTRL
 20454        GO TO 8100-SEND-INITIAL-MAP.
 20455
 20456     IF PI-MAP-NAME = EL631B
 20457        MOVE -1                  TO BMAINTL
 20458     ELSE
 20459        IF PI-MAP-NAME = EL631C
 20460           MOVE -1               TO CMAINTL
 20461        ELSE
 20462           MOVE -1               TO DPFENTRL
 20463           GO TO 8200-SEND-DATAONLY.
 20464
 20465     GO TO 8100-SEND-INITIAL-MAP.
 20466
 20467     .
 20468 5100-PROCESS-POL-RESC.
 20469     MOVE ZEROS                  TO CG-LF-BENCD
 20470                                    CG-AH-BENCD
 20471                                    CG-LF-CAN-AMT
 20472                                    CG-AH-CAN-AMT
 20473     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20474                                    CG-AH-CAN-DT
 20475     MOVE SPACES                 TO CG-BATCH-NO
 20476     MOVE '4'                    TO CG-OPTION-CODE
 20477     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20478     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20479     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20480     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20481     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20482     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20483     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20484     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20485     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20486     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 380
* EL6311.cbl
 20487     MOVE PI-PREV-ALT-KEY (1:33)
 20488                                 TO CG-CERT-KEY
 20489     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20490     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20491                                    CG-AH-CAN-AMT
 20492     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20493                                    CG-AH-CAN-DT
 20494     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20495     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20496      display 'about to cancel ' cg-cert-key
 20497
 20498* EXEC CICS LINK
 20499*        PROGRAM  ('ELCANC')
 20500*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20501*    END-EXEC
 20502     MOVE LENGTH OF
 20503      CANCEL-GEN-PASS-AREA
 20504       TO DFHEIV11
 20505     MOVE 'ELCANC' TO DFHEIV1
 20506*    MOVE '."C                   (   #00017263' TO DFHEIV0
 20507     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20509     MOVE X'2020233030303137323633' TO DFHEIV0(25:11)
 20510     CALL 'kxdfhei1' USING DFHEIV0,
 20511           DFHEIV1,
 20512           CANCEL-GEN-PASS-AREA,
 20513           DFHEIV11,
 20514           DFHEIV99,
 20515           DFHEIV99,
 20516           DFHEIV99,
 20517           DFHEIV99
 20518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20519     IF CG-SUCCESS
 20520        CONTINUE
 20521     ELSE
 20522        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20523        MOVE '3'                 TO EMI-SWITCH1
 20524        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20525        EVALUATE TRUE
 20526           WHEN CG-DATE-ERROR
 20527             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20528           WHEN CG-CERT-NOT-FOUND
 20529             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20530           WHEN CG-AMOUNT-ERROR
 20531             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20532           WHEN CG-OPTION-ERROR
 20533             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20534           WHEN CG-PREV-CAN
 20535             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20536           WHEN CG-INVALID-DATA
 20537             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20538           WHEN CG-NO-ACCT-MSTR
 20539             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20540           WHEN CG-SFX-A-EXIST
 20541             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20542           WHEN CG-MISC-ERROR
 20543             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20544           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 381
* EL6311.cbl
 20545             MOVE ' ERROR - ELCANC - RETURN '
 20546                                 TO EMI-ERROR-TEXT (1) (12:25)
 20547        END-EVALUATE
 20548        GO TO 8200-SEND-DATAONLY
 20549     END-IF
 20550     .
 20551 5100-EXIT.
 20552     EXIT.
 20553
 20554******************************************************************
 20555*                                                                *
 20556*        B R O W S E   B A T C H   B A C K W A R D S             *
 20557*                                                                *
 20558******************************************************************
 20559
 20560 5500-BROWSE-BATCH-BACKWARD.
 20561
 20562* EXEC CICS HANDLE CONDITION
 20563*         NOTFND   (5550-END-RECORDS)
 20564*         ENDFILE  (5550-END-RECORDS)
 20565*    END-EXEC.
 20566*    MOVE '"$I''                  ! U #00017309' TO DFHEIV0
 20567     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20569     MOVE X'5520233030303137333039' TO DFHEIV0(25:11)
 20570     CALL 'kxdfhei1' USING DFHEIV0
 20571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20572
 20573
 20574 5505-START-BROWSE.
 20575     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20576     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20577     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20578
 20579
 20580* EXEC CICS STARTBR
 20581*         DATASET   (FILE-ID-ERPNDB)
 20582*         RIDFLD    (ERPNDB-ALT-KEY)
 20583*    END-EXEC.
 20584     MOVE 0
 20585       TO DFHEIV11
 20586*    MOVE '&,         G          &   #00017319' TO DFHEIV0
 20587     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20589     MOVE X'2020233030303137333139' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0,
 20591           FILE-ID-ERPNDB,
 20592           ERPNDB-ALT-KEY,
 20593           DFHEIV99,
 20594           DFHEIV11,
 20595           DFHEIV99
 20596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20597
 20598
 20599     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20600
 20601
 20602* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 382
* EL6311.cbl
 20603*         DATASET    (FILE-ID-ERPNDB)
 20604*         SET        (ADDRESS OF PENDING-BUSINESS)
 20605*         RIDFLD     (ERPNDB-KEY)
 20606*    END-EXEC.
 20607     MOVE 0
 20608       TO DFHEIV11
 20609*    MOVE '&.S                   )   #00017326' TO DFHEIV0
 20610     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20611     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20612     MOVE X'2020233030303137333236' TO DFHEIV0(25:11)
 20613     CALL 'kxdfhei1' USING DFHEIV0,
 20614           FILE-ID-ERPNDB,
 20615           DFHEIV20,
 20616           DFHEIV99,
 20617           ERPNDB-KEY,
 20618           DFHEIV99,
 20619           DFHEIV11,
 20620           DFHEIV99,
 20621           DFHEIV99
 20622     SET ADDRESS OF PENDING-BUSINESS TO
 20623         DFHEIV20
 20624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20625
 20626
 20627
 20628* EXEC CICS READPREV
 20629*         DATASET    (FILE-ID-ERPNDB)
 20630*         SET        (ADDRESS OF PENDING-BUSINESS)
 20631*         RIDFLD     (ERPNDB-KEY)
 20632*    END-EXEC.
 20633     MOVE 0
 20634       TO DFHEIV11
 20635*    MOVE '&0S                   )   #00017332' TO DFHEIV0
 20636     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20637     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20638     MOVE X'2020233030303137333332' TO DFHEIV0(25:11)
 20639     CALL 'kxdfhei1' USING DFHEIV0,
 20640           FILE-ID-ERPNDB,
 20641           DFHEIV20,
 20642           DFHEIV99,
 20643           ERPNDB-KEY,
 20644           DFHEIV99,
 20645           DFHEIV11,
 20646           DFHEIV99,
 20647           DFHEIV99
 20648     SET ADDRESS OF PENDING-BUSINESS TO
 20649         DFHEIV20
 20650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20651
 20652
 20653
 20654* EXEC CICS READPREV
 20655*         DATASET    (FILE-ID-ERPNDB)
 20656*         SET        (ADDRESS OF PENDING-BUSINESS)
 20657*         RIDFLD     (ERPNDB-KEY)
 20658*    END-EXEC.
 20659     MOVE 0
 20660       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 383
* EL6311.cbl
 20661*    MOVE '&0S                   )   #00017338' TO DFHEIV0
 20662     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20663     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20664     MOVE X'2020233030303137333338' TO DFHEIV0(25:11)
 20665     CALL 'kxdfhei1' USING DFHEIV0,
 20666           FILE-ID-ERPNDB,
 20667           DFHEIV20,
 20668           DFHEIV99,
 20669           ERPNDB-KEY,
 20670           DFHEIV99,
 20671           DFHEIV11,
 20672           DFHEIV99,
 20673           DFHEIV99
 20674     SET ADDRESS OF PENDING-BUSINESS TO
 20675         DFHEIV20
 20676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20677
 20678
 20679     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20680        GO TO 5550-END-RECORDS.
 20681
 20682     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20683
 20684     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20685
 20686     IF  WS-BATCH-PREFIX = '#CL'
 20687             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20688
 20689* EXEC CICS ENDBR
 20690*                 DATASET  (FILE-ID-ERPNDB)
 20691*            END-EXEC
 20692     MOVE 0
 20693       TO DFHEIV11
 20694*    MOVE '&2                    $   #00017353' TO DFHEIV0
 20695     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20696     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20697     MOVE X'2020233030303137333533' TO DFHEIV0(25:11)
 20698     CALL 'kxdfhei1' USING DFHEIV0,
 20699           FILE-ID-ERPNDB,
 20700           DFHEIV11,
 20701           DFHEIV99
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20703         GO TO 5505-START-BROWSE.
 20704
 20705     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20706         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20707             NEXT SENTENCE
 20708         ELSE
 20709             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20710
 20711* EXEC CICS ENDBR
 20712*                 DATASET  (FILE-ID-ERPNDB)
 20713*            END-EXEC
 20714     MOVE 0
 20715       TO DFHEIV11
 20716*    MOVE '&2                    $   #00017363' TO DFHEIV0
 20717     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20718     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 384
* EL6311.cbl
 20719     MOVE X'2020233030303137333633' TO DFHEIV0(25:11)
 20720     CALL 'kxdfhei1' USING DFHEIV0,
 20721           FILE-ID-ERPNDB,
 20722           DFHEIV11,
 20723           DFHEIV99
 20724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20725             GO TO 5505-START-BROWSE.
 20726
 20727
 20728     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20729         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20730             NEXT SENTENCE
 20731        ELSE
 20732             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20733
 20734* EXEC CICS ENDBR
 20735*                 DATASET  (FILE-ID-ERPNDB)
 20736*            END-EXEC
 20737     MOVE 0
 20738       TO DFHEIV11
 20739*    MOVE '&2                    $   #00017374' TO DFHEIV0
 20740     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20742     MOVE X'2020233030303137333734' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           FILE-ID-ERPNDB,
 20745           DFHEIV11,
 20746           DFHEIV99
 20747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20748             GO TO 5505-START-BROWSE.
 20749
 20750     IF NOT PB-BATCH-TRAILER
 20751        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20752
 20753* EXEC CICS ENDBR
 20754*            DATASET  (FILE-ID-ERPNDB)
 20755*       END-EXEC
 20756     MOVE 0
 20757       TO DFHEIV11
 20758*    MOVE '&2                    $   #00017381' TO DFHEIV0
 20759     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303137333831' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           FILE-ID-ERPNDB,
 20764           DFHEIV11,
 20765           DFHEIV99
 20766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20767        GO TO 5505-START-BROWSE.
 20768
 20769     IF PI-CSR-BROWSE
 20770        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20771           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20772
 20773* EXEC CICS ENDBR
 20774*               DATASET  (FILE-ID-ERPNDB)
 20775*          END-EXEC
 20776     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 385
* EL6311.cbl
 20777       TO DFHEIV11
 20778*    MOVE '&2                    $   #00017389' TO DFHEIV0
 20779     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20780     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20781     MOVE X'2020233030303137333839' TO DFHEIV0(25:11)
 20782     CALL 'kxdfhei1' USING DFHEIV0,
 20783           FILE-ID-ERPNDB,
 20784           DFHEIV11,
 20785           DFHEIV99
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20787           GO TO 5505-START-BROWSE.
 20788
 20789     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20790        IF PI-PB-CARRIER    = SPACES AND
 20791           PI-PB-GROUPING   = SPACES AND
 20792           PI-PB-STATE      = SPACES AND
 20793           PI-PB-ACCOUNT    = SPACES
 20794             GO TO 7200-DISPLAY-BATCHES
 20795          ELSE
 20796            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20797               PI-PB-GROUPING   = PB-GROUPING AND
 20798               PI-PB-STATE      = PB-STATE    AND
 20799               PI-PB-ACCOUNT    = PB-ACCOUNT
 20800                 GO TO 7200-DISPLAY-BATCHES.
 20801
 20802     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20803
 20804
 20805* EXEC CICS ENDBR
 20806*         DATASET  (FILE-ID-ERPNDB)
 20807*    END-EXEC.
 20808     MOVE 0
 20809       TO DFHEIV11
 20810*    MOVE '&2                    $   #00017409' TO DFHEIV0
 20811     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20812     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20813     MOVE X'2020233030303137343039' TO DFHEIV0(25:11)
 20814     CALL 'kxdfhei1' USING DFHEIV0,
 20815           FILE-ID-ERPNDB,
 20816           DFHEIV11,
 20817           DFHEIV99
 20818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20819
 20820
 20821     GO TO 5505-START-BROWSE.
 20822
 20823 5550-END-RECORDS.
 20824     MOVE ER-2257                TO EMI-ERROR.
 20825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20826     MOVE -1                     TO DPFENTRL.
 20827
 20828     GO TO 8200-SEND-DATAONLY.
 20829
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 386
* EL6311.cbl
 20831
 20832******************************************************************
 20833*                                                                *
 20834*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20835*                                                                *
 20836******************************************************************
 20837
 20838 6000-CREATE-TEMP-STORAGE.
 20839
 20840
 20841* EXEC CICS HANDLE CONDITION
 20842*        QIDERR  (6050-QID-ERROR)
 20843*    END-EXEC.
 20844*    MOVE '"$N                   ! V #00017432' TO DFHEIV0
 20845     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20847     MOVE X'5620233030303137343332' TO DFHEIV0(25:11)
 20848     CALL 'kxdfhei1' USING DFHEIV0
 20849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20850
 20851
 20852
 20853* EXEC CICS WRITEQ TS
 20854*        QUEUE    (QID)
 20855*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20856*        LENGTH   (WS-COMM-LENGTH)
 20857*        ITEM     (W-ONE)
 20858*    END-EXEC.
 20859*    MOVE '*" I                  ''   #00017436' TO DFHEIV0
 20860     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20862     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 20863     CALL 'kxdfhei1' USING DFHEIV0,
 20864           QID,
 20865           PROGRAM-INTERFACE-BLOCK,
 20866           WS-COMM-LENGTH,
 20867           W-ONE,
 20868           DFHEIV99,
 20869           DFHEIV99
 20870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20871
 20872
 20873 6000-EXIT.
 20874      EXIT.
 20875
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 387
* EL6311.cbl
 20877
 20878******************************************************************
 20879*                                                                *
 20880*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20881*                                                                *
 20882******************************************************************
 20883
 20884 6050-RECOVER-TEMP-STORAGE.
 20885     IF PGM-NAME = XCTL-EL6312
 20886        GO TO 6050-EXIT.
 20887
 20888     IF PGM-NAME = XCTL-EL6313
 20889        GO TO 6050-EXIT.
 20890
 20891     IF PGM-NAME = XCTL-EL6315
 20892         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20893     END-IF
 20894
 20895     IF PGM-NAME = XCTL-EL6316
 20896         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20897     END-IF
 20898
 20899
 20900* EXEC CICS HANDLE CONDITION
 20901*        QIDERR  (6050-QID-ERROR)
 20902*    END-EXEC.
 20903*    MOVE '"$N                   ! W #00017469' TO DFHEIV0
 20904     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20906     MOVE X'5720233030303137343639' TO DFHEIV0(25:11)
 20907     CALL 'kxdfhei1' USING DFHEIV0
 20908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20909
 20910
 20911
 20912* EXEC CICS READQ TS
 20913*         QUEUE   (QID)
 20914*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20915*         LENGTH  (WS-COMM-LENGTH)
 20916*         ITEM    (W-ONE)
 20917*     END-EXEC.
 20918*    MOVE '*$II   L              ''   #00017473' TO DFHEIV0
 20919     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20921     MOVE X'2020233030303137343733' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0,
 20923           QID,
 20924           PROGRAM-INTERFACE-BLOCK,
 20925           WS-COMM-LENGTH,
 20926           W-ONE,
 20927           DFHEIV99,
 20928           DFHEIV99
 20929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20930
 20931
 20932 6050-DELETE-TEMP-STORAGE.
 20933
 20934
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 388
* EL6311.cbl
 20935* EXEC CICS DELETEQ TS
 20936*        QUEUE   (QID)
 20937*    END-EXEC.
 20938*    MOVE '*&                    #   #00017482' TO DFHEIV0
 20939     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 20940     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20941     MOVE X'2020233030303137343832' TO DFHEIV0(25:11)
 20942     CALL 'kxdfhei1' USING DFHEIV0,
 20943           QID,
 20944           DFHEIV99
 20945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20946
 20947
 20948     GO TO 6050-EXIT.
 20949
 20950 6050-QID-ERROR.
 20951     MOVE ER-0033                TO EMI-ERROR
 20952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20953
 20954 6050-EXIT.
 20955      EXIT.
 20956
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 389
* EL6311.cbl
 20958
 20959******************************************************************
 20960*                                                                *
 20961*            T E R M   C O N V E R S I O N                       *
 20962*                                                                *
 20963******************************************************************
 20964
 20965 6100-TERM-CONVERSION.
 20966
 20967     IF PI-BPMTS = ZERO
 20968         GO TO 6199-EXIT.
 20969
 20970     IF PI-BMODE = ' ' OR 'M'
 20971         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 20972         GO TO 6105-ROUND-TERM.
 20973
 20974     IF PI-BMODE = 'S'
 20975         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 20976         GO TO 6105-ROUND-TERM.
 20977
 20978     IF PI-BMODE = 'W'
 20979         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 20980         GO TO 6105-ROUND-TERM.
 20981
 20982     IF PI-BMODE = 'B'
 20983         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 20984         GO TO 6105-ROUND-TERM.
 20985
 20986     IF PI-BMODE = 'T'
 20987         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 20988
 20989 6105-ROUND-TERM.
 20990
 20991     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 20992         ADD +1                  TO WS-CALC-TERM-WHOLE
 20993         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 20994
 20995     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 20996         GO TO 6125-COMPUTE-TERM-BENEFIT.
 20997
 20998     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 20999         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21000                                      WS-BTERM    (WS-SUB1)
 21001         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21002
 21003     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21004         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21005             MOVE -1               TO BMODEL
 21006             MOVE ER-2593          TO EMI-ERROR
 21007             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21009
 21010 6124-CHECK-BENEFIT.
 21011
 21012     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21013        GO TO 6126-COMPUTE-BENEFIT.
 21014
 21015     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 390
* EL6311.cbl
 21016
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 391
* EL6311.cbl
 21018******************************************************************
 21019**         COMPUTE TERM AND BENEFIT
 21020******************************************************************
 21021 6125-COMPUTE-TERM-BENEFIT.
 21022
 21023     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21024        PI-BPMTAMT = ZERO
 21025         GO TO 6199-EXIT.
 21026
 21027     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21028                                     WS-BTERM  (WS-SUB1).
 21029     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21030
 21031 6126-COMPUTE-BENEFIT.
 21032
 21033     IF PI-BMODE = 'M' OR  ' '
 21034         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21035
 21036     IF PI-BMODE = 'W'
 21037         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21038
 21039     IF PI-BMODE = 'S'
 21040         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21041
 21042     IF PI-BMODE = 'B'
 21043         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21044
 21045     IF PI-BMODE = 'T'
 21046         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21047
 21048     IF WS-SUB1 = +1
 21049        COMPUTE WS-BBEN (WS-SUB1) =
 21050                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21051
 21052     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21053     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21054     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21055
 21056 6199-EXIT.
 21057     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 392
* EL6311.cbl
 21059
 21060******************************************************************
 21061*                                                                *
 21062*             D I S P L A Y   I S S U E S                        *
 21063*                                                                *
 21064******************************************************************
 21065
 21066 6200-CREATE-VADS.
 21067     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21068     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21069     MOVE SPACES                 TO WS-PASS-VADS-REC
 21070
 21071* EXEC CICS GETMAIN
 21072*       SET      (ADDRESS OF PENDING-BUSINESS)
 21073*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21074*       INITIMG  (GETMAIN-SPACE)
 21075*       RESP     (WS-RESPONSE)
 21076*    END-EXEC
 21077*    MOVE ',"IL                  $  N#00017608' TO DFHEIV0
 21078     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21080     MOVE X'204E233030303137363038' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0,
 21082           DFHEIV20,
 21083           ERPNDB-RECORD-LENGTH,
 21084           GETMAIN-SPACE
 21085     SET ADDRESS OF PENDING-BUSINESS TO
 21086         DFHEIV20
 21087     MOVE EIBRESP  TO WS-RESPONSE
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21089
 21090* EXEC CICS READ
 21091*       INTO    (PENDING-BUSINESS)
 21092*       DATASET (FILE-ID-ERPNDB)
 21093*       RIDFLD  (ERPNDB-KEY)
 21094*       RESP    (WS-RESPONSE)
 21095*    END-EXEC
 21096     MOVE LENGTH OF
 21097      PENDING-BUSINESS
 21098       TO DFHEIV11
 21099*    MOVE '&"IL       E          (  N#00017614' TO DFHEIV0
 21100     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21102     MOVE X'204E233030303137363134' TO DFHEIV0(25:11)
 21103     CALL 'kxdfhei1' USING DFHEIV0,
 21104           FILE-ID-ERPNDB,
 21105           PENDING-BUSINESS,
 21106           DFHEIV11,
 21107           ERPNDB-KEY,
 21108           DFHEIV99,
 21109           DFHEIV99,
 21110           DFHEIV99
 21111     MOVE EIBRESP  TO WS-RESPONSE
 21112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21113     IF RESP-NORMAL
 21114        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21115        IF (RESP-NORMAL)
 21116           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 393
* EL6311.cbl
 21117              AM-CONTROL-PRIMARY (1:20))
 21118           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21119        ELSE
 21120           MOVE 'ACCOUNT NOT FOUND'
 21121                                 TO VD-ACCOUNT-NAME
 21122        END-IF
 21123        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21124                                    TO M1
 21125        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21126        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21127           (A2 > M1)
 21128           OR (WS-WORK-FIELD (A2:1) = '*')
 21129           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21130           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21131        END-PERFORM
 21132        IF A2 > M1
 21133           CONTINUE
 21134        ELSE
 21135           MOVE WS-WORK-FIELD (1:A2 - 1)
 21136                                    TO VD-ACCOUNT-NAME
 21137        END-IF
 21138        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21139        MOVE PB-CARRIER          TO VD-CARRIER
 21140        MOVE PB-GROUPING         TO VD-GROUPING
 21141        MOVE PB-STATE            TO VD-STATE
 21142        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21143        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21144        MOVE PB-CERT-NO          TO VD-CERT-NO
 21145        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21146        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21147        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21148        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21149        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21150        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21151        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21152        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21153        MOVE PB-CSR-ID           TO VD-CSR-ID
 21154        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21155        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21156        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21157        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21158        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21159        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21160        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21161        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21162        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21163        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21164        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21165        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21166        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21167     END-IF
 21168     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21169
 21170
 21171* EXEC CICS GETMAIN
 21172*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21173*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21174*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 394
* EL6311.cbl
 21175*       RESP     (WS-RESPONSE)
 21176*    END-EXEC
 21177*    MOVE ',"IL                  $  N#00017677' TO DFHEIV0
 21178     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21179     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21180     MOVE X'204E233030303137363737' TO DFHEIV0(25:11)
 21181     CALL 'kxdfhei1' USING DFHEIV0,
 21182           DFHEIV20,
 21183           ERPNDM-RECORD-LENGTH,
 21184           GETMAIN-SPACE
 21185     SET ADDRESS OF PENDING-MAILING-DATA TO
 21186         DFHEIV20
 21187     MOVE EIBRESP  TO WS-RESPONSE
 21188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21189
 21190
 21191* EXEC CICS READ
 21192*       INTO    (PENDING-MAILING-DATA)
 21193*       DATASET (FILE-ID-ERPNDM)
 21194*       RIDFLD  (ERPNDM-KEY)
 21195*       RESP    (WS-RESPONSE)
 21196*    END-EXEC
 21197     MOVE LENGTH OF
 21198      PENDING-MAILING-DATA
 21199       TO DFHEIV11
 21200*    MOVE '&"IL       E          (  N#00017684' TO DFHEIV0
 21201     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21203     MOVE X'204E233030303137363834' TO DFHEIV0(25:11)
 21204     CALL 'kxdfhei1' USING DFHEIV0,
 21205           FILE-ID-ERPNDM,
 21206           PENDING-MAILING-DATA,
 21207           DFHEIV11,
 21208           ERPNDM-KEY,
 21209           DFHEIV99,
 21210           DFHEIV99,
 21211           DFHEIV99
 21212     MOVE EIBRESP  TO WS-RESPONSE
 21213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21214
 21215     IF RESP-NORMAL
 21216        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21217        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21218        MOVE PM-CITY              TO VD-INSURED-CITY
 21219        MOVE PM-STATE             TO VD-INSURED-STATE
 21220        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21221     END-IF
 21222
 21223     MOVE 'VAC1'                  TO VD-LETTER-ID
 21224     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21225     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21226     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21227     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21228     MOVE +0                      TO VD-ARCHIVE-NO
 21229     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21230     .
 21231 6200-EXIT.
 21232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 395
* EL6311.cbl
 21233 6210-READ-ERACCT.
 21234     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21235     MOVE LOW-VALUES             TO ERACCT-FILL
 21236
 21237* EXEC CICS READ
 21238*         DATASET   ('ERACCT')
 21239*         INTO      (ACCOUNT-MASTER)
 21240*         RIDFLD    (ERACCT-KEY)
 21241*         GTEQ
 21242*         RESP      (WS-RESPONSE)
 21243*    END-EXEC
 21244     MOVE LENGTH OF
 21245      ACCOUNT-MASTER
 21246       TO DFHEIV11
 21247     MOVE 'ERACCT' TO DFHEIV1
 21248*    MOVE '&"IL       G          (  N#00017712' TO DFHEIV0
 21249     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21251     MOVE X'204E233030303137373132' TO DFHEIV0(25:11)
 21252     CALL 'kxdfhei1' USING DFHEIV0,
 21253           DFHEIV1,
 21254           ACCOUNT-MASTER,
 21255           DFHEIV11,
 21256           ERACCT-KEY,
 21257           DFHEIV99,
 21258           DFHEIV99,
 21259           DFHEIV99
 21260     MOVE EIBRESP  TO WS-RESPONSE
 21261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21262     .
 21263 6210-EXIT.
 21264     EXIT.
 21265
 21266 6220-READ-ERMAIL.
 21267
 21268     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21269     MOVE ' '                    TO WS-ERMAIL-SW
 21270
 21271
 21272* EXEC CICS READ
 21273*       DATASET   (FILE-ID-ERMAIL)
 21274*       SET       (ADDRESS OF MAILING-DATA)
 21275*       RIDFLD    (ERMAIL-KEY)
 21276*       RESP      (WS-RESPONSE)
 21277*    END-EXEC
 21278*    MOVE '&"S        E          (  N#00017728' TO DFHEIV0
 21279     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21281     MOVE X'204E233030303137373238' TO DFHEIV0(25:11)
 21282     CALL 'kxdfhei1' USING DFHEIV0,
 21283           FILE-ID-ERMAIL,
 21284           DFHEIV20,
 21285           DFHEIV99,
 21286           ERMAIL-KEY,
 21287           DFHEIV99,
 21288           DFHEIV99,
 21289           DFHEIV99
 21290     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 396
* EL6311.cbl
 21291         DFHEIV20
 21292     MOVE EIBRESP  TO WS-RESPONSE
 21293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21294
 21295     IF RESP-NORMAL
 21296        SET ERMAIL-FOUND TO TRUE
 21297     END-IF
 21298     .
 21299 6220-EXIT.
 21300     EXIT.
 21301
 21302 6400-CHECK-FOR-RES-REF-CLAIM.
 21303     display 'made it to 6400- for ' pi-cert-no
 21304     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21305
 21306     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21307                                    W-CL-COMP-CD.
 21308     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21309                                    W-CL-CERT-NO.
 21310     MOVE SPACES                 TO MSTR-CERT-SFX.
 21311
 21312
 21313* EXEC CICS HANDLE CONDITION
 21314*        NOTFND  (6400-CONTINUE)
 21315*        ENDFILE (6400-CONTINUE)
 21316*    END-EXEC.
 21317*    MOVE '"$I''                  ! X #00017752' TO DFHEIV0
 21318     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21320     MOVE X'5820233030303137373532' TO DFHEIV0(25:11)
 21321     CALL 'kxdfhei1' USING DFHEIV0
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21323
 21324
 21325
 21326* EXEC CICS IGNORE CONDITION
 21327*        DUPKEY
 21328*    END-EXEC.
 21329*    MOVE '"*$                   !   #00017757' TO DFHEIV0
 21330     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21332     MOVE X'2020233030303137373537' TO DFHEIV0(25:11)
 21333     CALL 'kxdfhei1' USING DFHEIV0
 21334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21335
 21336
 21337
 21338* EXEC CICS STARTBR
 21339*        DATASET   (CLMS-ID)
 21340*        RIDFLD    (ELMSTR-KEY)
 21341*        GENERIC   EQUAL
 21342*        KEYLENGTH (ELMSTR-LENGTH)
 21343*    END-EXEC.
 21344     MOVE 0
 21345       TO DFHEIV11
 21346*    MOVE '&,   KG    E          &   #00017761' TO DFHEIV0
 21347     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 397
* EL6311.cbl
 21349     MOVE X'2020233030303137373631' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0,
 21351           CLMS-ID,
 21352           ELMSTR-KEY,
 21353           ELMSTR-LENGTH,
 21354           DFHEIV11,
 21355           DFHEIV99
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21357
 21358
 21359     display 'browse started'
 21360     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21361
 21362 6400-NEXT-CLAIM.
 21363
 21364
 21365* EXEC CICS READNEXT
 21366*        DATASET   (CLMS-ID)
 21367*        RIDFLD    (ELMSTR-KEY)
 21368*        SET       (ADDRESS OF CLAIM-MASTER)
 21369*    END-EXEC.
 21370     MOVE 0
 21371       TO DFHEIV11
 21372*    MOVE '&.S                   )   #00017773' TO DFHEIV0
 21373     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21374     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21375     MOVE X'2020233030303137373733' TO DFHEIV0(25:11)
 21376     CALL 'kxdfhei1' USING DFHEIV0,
 21377           CLMS-ID,
 21378           DFHEIV20,
 21379           DFHEIV99,
 21380           ELMSTR-KEY,
 21381           DFHEIV99,
 21382           DFHEIV11,
 21383           DFHEIV99,
 21384           DFHEIV99
 21385     SET ADDRESS OF CLAIM-MASTER TO
 21386         DFHEIV20
 21387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21388
 21389
 21390     display 'read claim for ' mstr-cert-no
 21391     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21392        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21393         GO TO 6400-CONTINUE
 21394     END-IF.
 21395
 21396     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21397        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21398        PI-STATE       NOT = CL-CERT-STATE     OR
 21399        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21400        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21401         GO TO 6400-NEXT-CLAIM
 21402     END-IF.
 21403
 21404     display 'found claim ' cl-claim-no
 21405        ' with denial type ' cl-denial-type
 21406     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 398
* EL6311.cbl
 21407         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21408         GO TO 6400-CONTINUE
 21409     END-IF.
 21410
 21411     GO TO 6400-NEXT-CLAIM.
 21412
 21413 6400-CONTINUE.
 21414
 21415     IF WS-BROWSE-STARTED-SW = 'Y'
 21416
 21417* EXEC CICS ENDBR
 21418*            DATASET   (CLMS-ID)
 21419*        END-EXEC
 21420     MOVE 0
 21421       TO DFHEIV11
 21422*    MOVE '&2                    $   #00017805' TO DFHEIV0
 21423     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21425     MOVE X'2020233030303137383035' TO DFHEIV0(25:11)
 21426     CALL 'kxdfhei1' USING DFHEIV0,
 21427           CLMS-ID,
 21428           DFHEIV11,
 21429           DFHEIV99
 21430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21431         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21432     END-IF.
 21433
 21434 6400-EXIT.
 21435     EXIT.
 21436
 21437 7000-DISPLAY-ISSUES.
 21438
 21439     IF PI-DISPLAY-ORIGINAL-BATCH
 21440        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21441        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21442     ELSE
 21443        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21444
 21445     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21446
 21447     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21448     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21449
 21450     MOVE LOW-VALUES                 TO EL631BI.
 21451     MOVE ZEROS                      TO PI-BPMTAMT
 21452                                        PI-BPMTS.
 21453     MOVE SPACE                      TO PI-BMODE
 21454                                        PI-BTYPE (1)
 21455                                        PI-BTYPE (2).
 21456     MOVE EL631B                     TO PI-MAP-NAME.
 21457     MOVE 'Y'                        TO PI-BROWSE-SW.
 21458     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21459                                        PI-HIGH-SEQ-NO.
 21460
 21461     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21462        MOVE AL-SABOF                TO BCHGTA
 21463        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21464        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 399
* EL6311.cbl
 21465     ELSE
 21466        MOVE AL-SADOF                TO BCHGTA
 21467                                        BCHGA
 21468        MOVE PB-CHG-COUNT            TO BCHGO.
 21469
 21470     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21471     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21472     MOVE WS-HR-MINS                 TO BMANTATO.
 21473
 21474     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21475        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21476        MOVE SPACE                   TO DC-OPTION-CODE
 21477        PERFORM 9700-DATE-LINK
 21478        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21479        MOVE 'INACTIVE'              TO BMOENDTO
 21480     ELSE
 21481        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21482        MOVE SPACE                   TO DC-OPTION-CODE
 21483        PERFORM 9700-DATE-LINK
 21484        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21485        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21486        MOVE SPACE                   TO DC-OPTION-CODE
 21487        PERFORM 9700-DATE-LINK
 21488        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21489
 21490*    MOVE PB-I-REFERENCE             TO BREFO.
 21491
 21492*    IF PI-COMPANY-ID EQUAL 'HER'
 21493*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21494*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21495*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21496*                MOVE WS-MEMBER-NO-1-8
 21497*                                TO  BMICRNOO.
 21498
 21499*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21500*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21501*            MOVE PB-I-MICROFILM-NO
 21502*                                TO  BMICRNOO.
 21503     IF PB-I-VIN NOT = SPACES
 21504        MOVE PB-I-VIN            TO BVINO
 21505     END-IF
 21506
 21507     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21508     MOVE PB-CERT-SFX                TO BSUFIXO.
 21509     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21510     MOVE SPACE                      TO DC-OPTION-CODE.
 21511     PERFORM 9700-DATE-LINK.
 21512     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21513
 21514     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21515     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21516     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21517     MOVE PB-I-INSURED-SEX           TO BSEXO
 21518
 21519     IF PB-I-AGE NOT = ZEROS
 21520         MOVE PB-I-AGE               TO BAGEO.
 21521
 21522     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 400
* EL6311.cbl
 21523                                 TO ELCERT-KEY
 21524     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21525     IF NOT CERT-TRL-REC-NOT-FOUND
 21526         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21527             MOVE 'AGE*'             TO BAGEDEFO
 21528         ELSE
 21529             MOVE 'AGE '             TO BAGEDEFO
 21530         END-IF
 21531     ELSE
 21532         MOVE 'AGE '             TO BAGEDEFO
 21533     END-IF
 21534
 21535     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21536         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21537         MOVE SPACE                  TO DC-OPTION-CODE
 21538         PERFORM 9700-DATE-LINK
 21539         IF NO-CONVERSION-ERROR
 21540            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21541
 21542     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21543         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21544         MOVE SPACE                  TO DC-OPTION-CODE
 21545         PERFORM 9700-DATE-LINK
 21546         IF NO-CONVERSION-ERROR
 21547            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21548
 21549     IF PB-I-EXTENTION-DAYS NUMERIC
 21550        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21551           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21552        ELSE
 21553           IF PB-I-TERM-IN-DAYS NUMERIC
 21554              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21555                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21556
 21557     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21558        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21559
 21560     MOVE PB-FORCE-CODE              TO BFORCEO.
 21561     MOVE PB-I-TERM-TYPE             TO BMODEO
 21562                                        PI-BMODE.
 21563
 21564     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21565        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21566
 21567     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21568         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21569                                        PI-BPMTS.
 21570
 21571     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21572         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21573           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21574                                        PI-BPMTAMT.
 21575
 21576     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21577     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21578     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21579     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21580     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 401
* EL6311.cbl
 21581     MOVE PB-I-SIG-SW                TO BSIGO.
 21582     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21583     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21584     MOVE PB-RECORD-BILL             TO BBILCDO.
 21585     MOVE PB-FORCE-CODE              TO BFORCEO.
 21586
 21587     IF (PB-I-LIVES NUMERIC)
 21588        AND (PB-I-LIVES > ZEROS)
 21589        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21590        IF (RESP-NORMAL)
 21591           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21592           CONTINUE
 21593        ELSE
 21594           MOVE PB-I-LIVES       TO BLIVESO
 21595        END-IF
 21596     END-IF
 21597
 21598     IF PB-I-NUM-BILLED NUMERIC AND
 21599        PB-I-NUM-BILLED GREATER THAN ZEROS
 21600        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21601*    ELSE
 21602*       MOVE ZEROS                   TO BBILLEDO.
 21603
 21604     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21605
 21606     IF PB-I-LOAN-APR NOT = ZEROS
 21607        MOVE PB-I-LOAN-APR           TO BAPRO.
 21608
 21609     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21610        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21611
 21612     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21613        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21614           MOVE AL-SANOF                TO BORIGHDA
 21615           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21616           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21617
 21618     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21619
 21620     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21621        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21622
 21623     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21624        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21625                                        PI-BTYPE (1).
 21626
 21627     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21628        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21629
 21630     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21631        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21632
 21633     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21634        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21635
 21636     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21637        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21638
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 402
* EL6311.cbl
 21639     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21640        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21641
 21642     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21643         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21644         MOVE SPACE                  TO DC-OPTION-CODE
 21645         PERFORM 9700-DATE-LINK
 21646         IF NO-CONVERSION-ERROR
 21647            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21648
 21649     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21650        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21651        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21652        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21653        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21654                 GIVING BDIFFO (1)
 21655     ELSE
 21656        MOVE SPACES                  TO BBEN-CD     (1)
 21657                                        BBEN-ABBR   (1).
 21658
 21659     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21660        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21661        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21662                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21663
 21664     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21665       IF PB-RECORD-ON-HOLD
 21666          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21667
 21668     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21669       IF PB-RECORD-RETURNED
 21670          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21671
 21672     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21673        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21674             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21675
 21676     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21677
 21678     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21679        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21680
 21681     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21682        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21683                                        PI-BTYPE (2).
 21684
 21685     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21686        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21687
 21688     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21689        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21690
 21691     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21692        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21693
 21694     IF PB-I-TOT-FEES NOT NUMERIC
 21695        MOVE ZEROS               TO PB-I-TOT-FEES
 21696     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 403
* EL6311.cbl
 21697     IF PB-I-TOT-FEES > ZEROS
 21698        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21699
 21700     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21701         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21702         MOVE SPACE                  TO DC-OPTION-CODE
 21703         PERFORM 9700-DATE-LINK
 21704         IF NO-CONVERSION-ERROR
 21705            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21706
 21707     IF PB-I-TOT-FEES > ZEROS
 21708        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21709        SUBTRACT PB-I-TOT-FEES FROM
 21710                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21711
 21712     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21713        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21714        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21715        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21716        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21717                 GIVING BDIFFO (2)
 21718     ELSE
 21719        MOVE SPACES                  TO BBEN-CD     (2)
 21720                                        BBEN-ABBR   (2).
 21721
 21722     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21723       IF PB-RECORD-ON-HOLD
 21724          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21725
 21726     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21727       IF PB-RECORD-RETURNED
 21728          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21729
 21730     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21731        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21732             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21733
 21734     MOVE PB-CSR-ID                  TO BCSRO.
 21735
 21736     IF PI-COMPANY-ID  =  'DMD'
 21737        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21738            NEXT SENTENCE
 21739        ELSE
 21740            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21741               MOVE 'NEW CERT'       TO BNCERTLI
 21742               MOVE EC-NEW-CERT      TO BNCERTO.
 21743
 21744     IF PI-COMPANY-ID  =  'DMD'
 21745        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21746            NEXT SENTENCE
 21747        ELSE
 21748           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21749               MOVE 'NEW STATE'      TO BNSTATLI
 21750               MOVE EC-NEW-STATE     TO BNSTATO.
 21751
 21752 7000-CONTINUE.
 21753     MOVE 'C'                        TO BMAINTI.
 21754     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 404
* EL6311.cbl
 21755
 21756     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21757        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21758
 21759     IF PI-6315-FINALIZED = 'Y'   AND
 21760        PB-UNFORCED-ERRORS
 21761          MOVE -1                TO BFORCEL
 21762          MOVE  1                TO SET-CURSOR-SW
 21763     END-IF
 21764
 21765     IF NO-CURSOR-SET
 21766        MOVE -1                      TO BMAINTL.
 21767
 21768     GO TO 8100-SEND-INITIAL-MAP.
 21769
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 405
* EL6311.cbl
 21771
 21772******************************************************************
 21773*                                                                *
 21774*             D I S P L A Y   C A N C E L S                      *
 21775*                                                                *
 21776******************************************************************
 21777
 21778 7100-DISPLAY-CANCELS.
 21779     IF PI-DISPLAY-ORIGINAL-BATCH
 21780        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21781        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21782     ELSE
 21783        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21784
 21785     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21786
 21787     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21788     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21789
 21790     MOVE LOW-VALUES                 TO EL631CI.
 21791     MOVE EL631C                     TO PI-MAP-NAME.
 21792     MOVE 'Y'                        TO PI-BROWSE-SW.
 21793     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21794                                        PI-HIGH-SEQ-NO.
 21795
 21796     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21797        MOVE AL-SABOF                TO CCHGTA
 21798        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21799        MOVE AL-SANON                TO CCHGA
 21800      ELSE
 21801        MOVE AL-SADOF                TO CCHGTA
 21802                                        CCHGA
 21803        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21804
 21805*    MOVE PB-C-REFERENCE             TO CREFO.
 21806
 21807*    IF PB-C-MICROFILM-NO IS NUMERIC
 21808*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21809*          MOVE PB-C-MICROFILM-NO
 21810*                                TO CMICRNOO
 21811*          MOVE AL-UNNON         TO CMICRNOA
 21812*       END-IF
 21813*    END-IF
 21814     IF PB-C-NH-INT-ON-REFS NUMERIC
 21815        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21816           MOVE PB-C-NH-INT-ON-REFS
 21817                                 TO CNHINTO
 21818           MOVE AL-SANOF         TO CNHINTA
 21819        END-IF
 21820     END-IF
 21821     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21822     MOVE PB-CERT-SFX                TO CSUFIXO.
 21823     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21824     MOVE SPACE                      TO DC-OPTION-CODE.
 21825     PERFORM 9700-DATE-LINK.
 21826     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21827
 21828     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 406
* EL6311.cbl
 21829        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21830        MOVE SPACE                   TO DC-OPTION-CODE
 21831        PERFORM 9700-DATE-LINK
 21832        IF NO-CONVERSION-ERROR
 21833           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21834
 21835     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21836        NEXT SENTENCE
 21837     ELSE
 21838        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21839
 21840     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21841        NEXT SENTENCE
 21842     ELSE
 21843        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21844
 21845     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21846        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21847        MOVE SPACE                   TO DC-OPTION-CODE
 21848        PERFORM 9700-DATE-LINK
 21849        IF NO-CONVERSION-ERROR
 21850           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21851
 21852     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21853         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21854
 21855     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21856         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21857
 21858     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21859        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21860        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21861                 GIVING CDRFND1O.
 21862
 21863     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21864        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21865        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21866                 GIVING CDRFND2O.
 21867
 21868     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21869       IF PB-RECORD-ON-HOLD
 21870          MOVE 'ON HOLD'             TO CBILIT1O.
 21871
 21872     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21873       IF PB-RECORD-RETURNED
 21874          MOVE 'RETURNED'            TO CBILIT1O.
 21875
 21876     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21877        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21878             MOVE 'OVERRIDE'         TO CBILIT1O.
 21879
 21880     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21881       IF PB-RECORD-ON-HOLD
 21882          MOVE 'ON HOLD'             TO CBILIT2O.
 21883
 21884     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21885       IF PB-RECORD-RETURNED
 21886          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 407
* EL6311.cbl
 21887
 21888     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21889        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21890             MOVE 'OVERRIDE'         TO CBILIT2O.
 21891
 21892     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21893     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21894     IF PB-C-POST-CARD-IND = 'Y'
 21895        MOVE 'Y'                     TO CPCYNO
 21896     ELSE
 21897        MOVE 'N'                     TO CPCYNO
 21898     END-IF
 21899     MOVE PB-FORCE-CODE              TO CFORCEO.
 21900     MOVE PB-RECORD-BILL             TO CBILCDO.
 21901     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21902     MOVE SPACES                     TO CINITSO.
 21903     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21904         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21905     ELSE
 21906         MOVE PB-CI-INITIALS         TO CINITSO
 21907     END-IF.
 21908
 21909     IF PB-CI-CANCEL-FEE NUMERIC
 21910        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21911        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21912     ELSE
 21913        MOVE ZEROES                  TO W-CANCEL-FEE.
 21914
 21915     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21916
 21917     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21918        ADD PB-CI-LF-PREMIUM-AMT
 21919             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21920
 21921     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21922        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21923
 21924     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21925     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21926     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21927     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21928
 21929     IF PB-C-LIVES NUMERIC
 21930        MOVE PB-C-LIVES              TO CLIVESO.
 21931
 21932     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21933        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 21934
 21935     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 21936        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 21937        MOVE SPACE                   TO DC-OPTION-CODE
 21938        PERFORM 9700-DATE-LINK
 21939        IF NO-CONVERSION-ERROR
 21940           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 21941
 21942     IF  PB-C-REFUND-CREATED
 21943         MOVE 'YES'                  TO CRFNDSWO
 21944     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 408
* EL6311.cbl
 21945         IF PB-C-REFUND-REQUESTED
 21946            MOVE 'REQ'               TO CRFNDSWO
 21947         ELSE
 21948            MOVE 'NO'                TO CRFNDSWO.
 21949
 21950     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 21951     MOVE SPACE                      TO DC-OPTION-CODE.
 21952     PERFORM 9700-DATE-LINK.
 21953     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 21954     MOVE PB-INPUT-BY                TO CENTBYO.
 21955
 21956     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21957        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21958        MOVE SPACE                   TO DC-OPTION-CODE
 21959        PERFORM 9700-DATE-LINK
 21960        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21961        MOVE 'INACTIVE'              TO CMOENDTO
 21962     ELSE
 21963        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21964        MOVE SPACE                   TO DC-OPTION-CODE
 21965        PERFORM 9700-DATE-LINK
 21966        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21967        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21968        MOVE SPACE                   TO DC-OPTION-CODE
 21969        PERFORM 9700-DATE-LINK
 21970        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 21971
 21972     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 21973
 21974     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21975     MOVE WS-HR-MINS                 TO CMANTATO.
 21976
 21977     EVALUATE PB-LF-REFUND-TYPE
 21978        WHEN '1'
 21979           MOVE 'RULE78'            TO CLFREFNO
 21980        WHEN '2'
 21981           MOVE 'PRORAT'            TO CLFREFNO
 21982        WHEN '3'
 21983           MOVE 'CALIF'             TO CLFREFNO
 21984        WHEN '4'
 21985           MOVE 'IRREG'             TO CLFREFNO
 21986        WHEN '5'
 21987           MOVE 'NETPAY'            TO CLFREFNO
 21988        WHEN '6'
 21989           MOVE 'ATCP'              TO CLFREFNO
 21990        WHEN '7'
 21991           MOVE 'UTAH'              TO CLFREFNO
 21992        WHEN '8'
 21993           MOVE 'MEAN'              TO CLFREFNO
 21994        WHEN '9'
 21995           MOVE 'SUM '              TO CLFREFNO
 21996        WHEN 'B'
 21997           MOVE 'BALN'              TO CLFREFNO
 21998     END-EVALUATE.
 21999
 22000     EVALUATE TRUE
 22001        WHEN PB-AH-REFUND-TYPE =  '1'
 22002           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 409
* EL6311.cbl
 22003        WHEN PB-AH-REFUND-TYPE =  '2'
 22004           MOVE 'PRORAT'            TO CAHREFNO
 22005        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22006           MOVE 'CALIF'             TO CAHREFNO
 22007        WHEN PB-AH-REFUND-TYPE =  '4'
 22008           MOVE 'IRREG'             TO CAHREFNO
 22009        WHEN PB-AH-REFUND-TYPE =  '5'
 22010           MOVE 'NETPAY'            TO CAHREFNO
 22011        WHEN PB-AH-REFUND-TYPE =  '6'
 22012           MOVE 'ATCP'              TO CAHREFNO
 22013        WHEN PB-AH-REFUND-TYPE =  '7'
 22014           MOVE 'UTAH'              TO CAHREFNO
 22015        WHEN PB-AH-REFUND-TYPE =  '8'
 22016           MOVE 'MEAN'              TO CAHREFNO
 22017        WHEN PB-AH-REFUND-TYPE =  '9'
 22018           MOVE 'SUM '              TO CAHREFNO
 22019        WHEN PB-AH-REFUND-TYPE =  'B'
 22020           MOVE 'BALN'              TO CAHREFNO
 22021     END-EVALUATE.
 22022
 22023     MOVE PB-REIN-CD                 TO CREINCDO.
 22024
 22025     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22026        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22027        MOVE SPACE                   TO DC-OPTION-CODE
 22028        PERFORM 9700-DATE-LINK
 22029        IF NO-CONVERSION-ERROR
 22030           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22031
 22032     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22033        MOVE 999999                  TO WS-EXP-DT-EDIT
 22034        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22035        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22036     ELSE
 22037        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22038           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22039           MOVE SPACE                   TO DC-OPTION-CODE
 22040           PERFORM 9700-DATE-LINK
 22041           IF NO-CONVERSION-ERROR
 22042              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22043
 22044     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22045        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22046           MOVE AL-SANOF                TO CORIGHDA
 22047           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22048           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22049
 22050     MOVE PB-CSR-ID              TO CCSRO.
 22051
 22052     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22053     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22054
 22055     MOVE 'C'                    TO CMAINTI.
 22056     MOVE AL-UANON               TO CMAINTA.
 22057
 22058     IF PI-6316-FINALIZED = 'Y'  AND
 22059        PB-UNFORCED-ERRORS
 22060          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 410
* EL6311.cbl
 22061          MOVE  1                TO SET-CURSOR-SW
 22062     END-IF
 22063
 22064     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22065        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22066
 22067     IF NO-CURSOR-SET
 22068        MOVE -1                  TO CMAINTL.
 22069
 22070     GO TO 8100-SEND-INITIAL-MAP.
 22071
 22072
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 411
* EL6311.cbl
 22074***************************************************************
 22075*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22076*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22077***************************************************************
 22078
 22079 7200-DISPLAY-BATCHES.
 22080     MOVE EL631D                 TO PI-MAP-NAME.
 22081     MOVE LOW-VALUES             TO EL631DI.
 22082
 22083     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22084
 22085
 22086* EXEC CICS HANDLE CONDITION
 22087*         NOTFND   (3690-NOT-FOUND)
 22088*    END-EXEC.
 22089*    MOVE '"$I                   ! Y #00018462' TO DFHEIV0
 22090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22092     MOVE X'5920233030303138343632' TO DFHEIV0(25:11)
 22093     CALL 'kxdfhei1' USING DFHEIV0
 22094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22095
 22096
 22097     IF PI-DISPLAY-SCREEN
 22098        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22099     ELSE
 22100        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22101
 22102     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22103     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22104
 22105
 22106* EXEC CICS READ
 22107*         DATASET   (FILE-ID-ERPNDB)
 22108*         RIDFLD    (ERPNDB-KEY)
 22109*         SET       (ADDRESS OF PENDING-BUSINESS)
 22110*    END-EXEC.
 22111*    MOVE '&"S        E          (   #00018474' TO DFHEIV0
 22112     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22114     MOVE X'2020233030303138343734' TO DFHEIV0(25:11)
 22115     CALL 'kxdfhei1' USING DFHEIV0,
 22116           FILE-ID-ERPNDB,
 22117           DFHEIV20,
 22118           DFHEIV99,
 22119           ERPNDB-KEY,
 22120           DFHEIV99,
 22121           DFHEIV99,
 22122           DFHEIV99
 22123     SET ADDRESS OF PENDING-BUSINESS TO
 22124         DFHEIV20
 22125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22126
 22127
 22128     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22129     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22130     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22131     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 412
* EL6311.cbl
 22132     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22133
 22134     MOVE EL631D                 TO PI-MAP-NAME.
 22135     MOVE LOW-VALUES             TO EL631DI.
 22136     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22137
 22138*    IF PI-AR-PROCESSING
 22139*       MOVE PB-REFERENCE        TO DREFO.
 22140
 22141     MOVE PB-CSR-ID              TO DCSRO.
 22142
 22143     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22144        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22145        MOVE SPACE               TO DC-OPTION-CODE
 22146        PERFORM 9700-DATE-LINK
 22147        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22148        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22149        MOVE 'INACTIVE'          TO DLDATEO
 22150     ELSE
 22151        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22152        MOVE SPACE               TO DC-OPTION-CODE
 22153        PERFORM 9700-DATE-LINK
 22154        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22155
 22156     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22157     MOVE SPACE                  TO DC-OPTION-CODE.
 22158     PERFORM 9700-DATE-LINK.
 22159     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22160
 22161     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22162        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22163     ELSE
 22164        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22165        MOVE SPACE               TO DC-OPTION-CODE
 22166        PERFORM 9700-DATE-LINK
 22167        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22168
 22169     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22170     MOVE SPACE                  TO DC-OPTION-CODE.
 22171     PERFORM 9700-DATE-LINK.
 22172     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22173
 22174     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22175     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22176
 22177     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22178        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22179                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22180
 22181     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22182     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22183     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22184
 22185     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22186        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22187                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22188
 22189     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 413
* EL6311.cbl
 22190     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22191     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22192
 22193     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22194        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22195                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22196
 22197     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22198     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22199
 22200     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22201        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22202                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22203
 22204     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22205     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22206     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22207
 22208     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22209        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22210                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22211
 22212     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22213     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22214     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22215
 22216     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22217        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22218                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22219
 22220     MOVE -1                     TO DPFENTRL.
 22221     GO TO 8100-SEND-INITIAL-MAP.
 22222
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 414
* EL6311.cbl
 22224
 22225***************************************************************
 22226*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22227*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22228*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22229*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22230*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22231*     ARE THEN SET ACCORDINGLY.                               *
 22232*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22233*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22234*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22235***************************************************************
 22236
 22237******************************************************************
 22238*                                                                *
 22239*            E R R O R   A N A L Y S I S                         *
 22240*                                                                *
 22241******************************************************************
 22242
 22243******************************************************************
 22244*                                                                *
 22245*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22246*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22247*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22248*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22249*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22250*                                                                *
 22251*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22252*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22253*                                                                *
 22254******************************************************************
 22255
 22256 7300-FORMAT-ERRORS.
 22257     MOVE ' '                    TO PI-ERRORS-SW
 22258     IF PB-COMMON-ERRORS = LOW-VALUES
 22259        IF PB-FATAL-ERRORS
 22260           MOVE ER-2695          TO EMI-ERROR
 22261           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22262           GO TO 7399-EXIT.
 22263
 22264     MOVE +0                     TO WS-SUB4.
 22265
 22266 7310-ERROR-LOOP.
 22267
 22268     ADD +1                      TO WS-SUB4.
 22269
 22270     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22271        GO TO 7350-SET-ERROR-FLAGS.
 22272
 22273     IF PI-COMPANY-ID = 'UCL'
 22274         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22275             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22276             MOVE ' '                   TO DC-OPTION-CODE
 22277             PERFORM 9700-DATE-LINK
 22278             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22279
 22280     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 415
* EL6311.cbl
 22282     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22283
 22284     GO TO 7310-ERROR-LOOP.
 22285
 22286
 22287 7350-SET-ERROR-FLAGS.
 22288
 22289     IF EMI-FATAL-CTR NOT = ZEROS
 22290        display 'fatal error counter = ' emi-fatal-ctr
 22291        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22292        MOVE 'X'                 TO PB-FATAL-FLAG
 22293                                    PI-ERRORS-SW
 22294        GO TO 7355-SET-ERROR-FLAGS.
 22295
 22296     IF EMI-FORCABLE-CTR NOT = ZEROS
 22297        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22298        IF PB-ISSUE
 22299           IF PB-ISSUE-FORCE
 22300              MOVE 'F'           TO PB-FORCE-ER-CD
 22301              MOVE ER-2600       TO EMI-ERROR
 22302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22303             ELSE
 22304              MOVE 'X'           TO PB-FORCE-ER-CD
 22305*                                   PI-ERRORS-SW
 22306          ELSE
 22307           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22308              MOVE 'F'           TO PB-FORCE-ER-CD
 22309              MOVE ER-2600       TO EMI-ERROR
 22310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22311             ELSE
 22312              MOVE 'X'           TO PB-FORCE-ER-CD.
 22313*                                   PI-ERRORS-SW.
 22314
 22315     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22316     IF PB-ISSUE
 22317         MOVE 'I'                TO ENDT-RECORD-TYPE
 22318     ELSE
 22319         MOVE 'C'                TO ENDT-RECORD-TYPE
 22320     END-IF
 22321     MOVE +0                     TO ENDT-SEQ-NO
 22322
 22323
 22324* EXEC CICS READ
 22325*        DATASET   (FILE-ID-ERENDT)
 22326*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22327*        RIDFLD    (ERENDT-KEY)
 22328*        RESP      (WS-RESPONSE)
 22329*        GTEQ
 22330*    END-EXEC
 22331*    MOVE '&"S        G          (  N#00018675' TO DFHEIV0
 22332     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22334     MOVE X'204E233030303138363735' TO DFHEIV0(25:11)
 22335     CALL 'kxdfhei1' USING DFHEIV0,
 22336           FILE-ID-ERENDT,
 22337           DFHEIV20,
 22338           DFHEIV99,
 22339           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 416
* EL6311.cbl
 22340           DFHEIV99,
 22341           DFHEIV99,
 22342           DFHEIV99
 22343     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22344         DFHEIV20
 22345     MOVE EIBRESP  TO WS-RESPONSE
 22346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22347
 22348     IF RESP-NORMAL
 22349        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22350        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22351            MOVE ER-0280          TO EMI-ERROR
 22352            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22353            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22354            EVALUATE TRUE
 22355              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22356                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22357              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22358                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22359              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22360                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22361            END-EVALUATE
 22362        END-IF
 22363     END-IF
 22364
 22365
 22366
 22367     IF FIRST-ENTRY OR
 22368        EIBAID = DFHPF1 OR DFHPF2
 22369        MOVE '0'                TO PI-EDIT-SW
 22370        GO TO 7399-EXIT.
 22371
 22372 7355-SET-ERROR-FLAGS.
 22373
 22374     IF EMI-WARNING-CTR NOT = ZEROS
 22375        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22376        MOVE 'W'                 TO PB-WARN-ER-CD.
 22377
 22378     IF PB-UNFORCED-ERRORS OR
 22379        PB-FATAL-ERRORS    OR
 22380        PB-RECORD-ON-HOLD  OR
 22381        PB-RECORD-RETURNED OR
 22382        PB-CANCELLATION
 22383          NEXT SENTENCE
 22384        ELSE
 22385          GO TO 7399-EXIT.
 22386
 22387
 22388* EXEC CICS  HANDLE CONDITION
 22389*           NOTFND   (7399-EXIT)
 22390*    END-EXEC.
 22391*    MOVE '"$I                   ! Z #00018722' TO DFHEIV0
 22392     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22394     MOVE X'5A20233030303138373232' TO DFHEIV0(25:11)
 22395     CALL 'kxdfhei1' USING DFHEIV0
 22396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22397
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 417
* EL6311.cbl
 22398
 22399     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22400     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22401     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22402     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22403
 22404
 22405* EXEC CICS READ
 22406*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22407*        DATASET (FILE-ID-ELCERT)
 22408*        RIDFLD  (ELCERT-KEY)
 22409*        UPDATE
 22410*    END-EXEC.
 22411*    MOVE '&"S        EU         (   #00018731' TO DFHEIV0
 22412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22413     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22414     MOVE X'2020233030303138373331' TO DFHEIV0(25:11)
 22415     CALL 'kxdfhei1' USING DFHEIV0,
 22416           FILE-ID-ELCERT,
 22417           DFHEIV20,
 22418           DFHEIV99,
 22419           ELCERT-KEY,
 22420           DFHEIV99,
 22421           DFHEIV99,
 22422           DFHEIV99
 22423     SET ADDRESS OF CERTIFICATE-MASTER TO
 22424         DFHEIV20
 22425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22426
 22427
 22428
 22429     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22430     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22431
 22432     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22433        GO TO 7360-REWRITE-CERT-MASTER.
 22434
 22435     IF PB-ISSUE
 22436        IF PB-RECORD-RETURNED
 22437            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22438            GO TO 7360-REWRITE-CERT-MASTER
 22439        ELSE
 22440            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22441            GO TO 7360-REWRITE-CERT-MASTER.
 22442
 22443     IF PB-RECORD-RETURNED
 22444         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22445         GO TO 7360-REWRITE-CERT-MASTER.
 22446
 22447     IF PB-C-LF-CANCEL-VOIDED
 22448        IF (PB-UNFORCED-ERRORS OR
 22449            PB-FATAL-ERRORS    OR
 22450            PB-RECORD-ON-HOLD)
 22451            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22452            GO TO 7360-REWRITE-CERT-MASTER
 22453        ELSE
 22454            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22455            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 418
* EL6311.cbl
 22456
 22457     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22458                            OR PB-RECORD-ON-HOLD)
 22459        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22460     ELSE
 22461        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22462
 22463 7360-REWRITE-CERT-MASTER.
 22464
 22465     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22466        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22467
 22468* EXEC CICS UNLOCK
 22469*            DATASET    (FILE-ID-ELCERT)
 22470*       END-EXEC
 22471*    MOVE '&*                    #   #00018777' TO DFHEIV0
 22472     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22473     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22474     MOVE X'2020233030303138373737' TO DFHEIV0(25:11)
 22475     CALL 'kxdfhei1' USING DFHEIV0,
 22476           FILE-ID-ELCERT,
 22477           DFHEIV99
 22478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22479        GO TO 7399-EXIT.
 22480
 22481
 22482* EXEC CICS REWRITE
 22483*         DATASET    (FILE-ID-ELCERT)
 22484*         FROM       (CERTIFICATE-MASTER)
 22485*    END-EXEC.
 22486     MOVE LENGTH OF
 22487      CERTIFICATE-MASTER
 22488       TO DFHEIV11
 22489*    MOVE '&& L                  %   #00018782' TO DFHEIV0
 22490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22492     MOVE X'2020233030303138373832' TO DFHEIV0(25:11)
 22493     CALL 'kxdfhei1' USING DFHEIV0,
 22494           FILE-ID-ELCERT,
 22495           CERTIFICATE-MASTER,
 22496           DFHEIV11,
 22497           DFHEIV99
 22498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22499
 22500
 22501 7399-EXIT.
 22502      EXIT.
 22503
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 419
* EL6311.cbl
 22505
 22506*************************************************************
 22507*                                                           *
 22508*              S E T   A T T R I B U T E S                  *
 22509*                                                           *
 22510*************************************************************
 22511
 22512 7400-SET-ATTRIBUTES.
 22513
 22514     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22515        GO TO 7499-EXIT.
 22516
 22517**2601**
 22518
 22519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22520        IF PB-ISSUE
 22521           MOVE AL-UABON         TO BEFFDTA
 22522           GO TO 7499-EXIT
 22523         ELSE
 22524           MOVE AL-UABON         TO CEFFDTA
 22525           GO TO 7499-EXIT.
 22526
 22527**2604**
 22528
 22529     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22530        IF PB-ISSUE
 22531           MOVE AL-UABON         TO BTYPE1A
 22532           MOVE -1               TO BTYPE1L
 22533           MOVE  1               TO SET-CURSOR-SW
 22534           GO TO 7499-EXIT.
 22535
 22536**2605**
 22537
 22538     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22539        IF PB-ISSUE
 22540           MOVE AL-UABON         TO BTYPE2A
 22541           MOVE -1               TO BTYPE2L
 22542           MOVE  1               TO SET-CURSOR-SW
 22543           GO TO 7499-EXIT.
 22544
 22545**2606**
 22546
 22547     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22548        IF PB-ISSUE
 22549           MOVE AL-UABON         TO BSIGA
 22550           MOVE -1               TO BSIGL
 22551           MOVE  1               TO SET-CURSOR-SW
 22552           GO TO 7499-EXIT.
 22553
 22554**2607**
 22555
 22556     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22557        IF PB-ISSUE
 22558           MOVE AL-UABON         TO BSIGA
 22559           MOVE -1               TO BSIGL
 22560           MOVE  1               TO SET-CURSOR-SW
 22561           GO TO 7499-EXIT.
 22562
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 420
* EL6311.cbl
 22563**2615**
 22564
 22565     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22566        IF PB-ISSUE
 22567           MOVE AL-UABOF         TO BREINA
 22568           MOVE -1               TO BREINL
 22569           GO TO 7499-EXIT.
 22570
 22571**2622**
 22572
 22573     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22574        IF PB-ISSUE
 22575           MOVE AL-UABON         TO BEFFDTA
 22576           GO TO 7499-EXIT
 22577        ELSE
 22578           MOVE AL-UABON         TO CEFFDTA
 22579           GO TO 7499-EXIT.
 22580
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 421
* EL6311.cbl
 22582
 22583*************************************************************
 22584*                                                           *
 22585*              I S S U E   E R R O R S                      *
 22586*                                                           *
 22587*************************************************************
 22588
 22589 7420-ISSUE-ERRORS.
 22590
 22591**2626**
 22592
 22593     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22594        MOVE AL-UABON            TO BCERTNOA
 22595        GO TO 7499-EXIT.
 22596
 22597**2627**
 22598
 22599     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22600        MOVE AL-UNBON            TO BAGEA
 22601        MOVE -1                  TO BAGEL
 22602        MOVE  1                  TO SET-CURSOR-SW
 22603        GO TO 7499-EXIT.
 22604
 22605**2628**
 22606
 22607     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22608        MOVE AL-UNBON            TO BAGEA
 22609        MOVE -1                  TO BAGEL
 22610        MOVE  1                  TO SET-CURSOR-SW
 22611        GO TO 7499-EXIT.
 22612
 22613**2629**
 22614
 22615     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22616        MOVE AL-UABON            TO BSEXA
 22617        MOVE -1                  TO BSEXL
 22618        MOVE  1                  TO SET-CURSOR-SW
 22619        GO TO 7499-EXIT.
 22620
 22621**2630**
 22622
 22623     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22624        MOVE -1                  TO BTYPE1L
 22625        MOVE  1                  TO SET-CURSOR-SW
 22626        GO TO 7499-EXIT.
 22627
 22628**2631**
 22629
 22630     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22631        MOVE -1                  TO BTYPE1L
 22632        MOVE  1                  TO SET-CURSOR-SW
 22633        GO TO 7499-EXIT.
 22634
 22635**2632**
 22636
 22637     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22638        MOVE AL-UNBON            TO BBEN1A
 22639        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 422
* EL6311.cbl
 22640        MOVE  1                  TO SET-CURSOR-SW
 22641        GO TO 7499-EXIT.
 22642
 22643**2633**
 22644
 22645     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22646        MOVE AL-UNBON            TO BPREM1A
 22647        MOVE -1                  TO BPREM1L
 22648        MOVE  1                  TO SET-CURSOR-SW
 22649        GO TO 7499-EXIT.
 22650
 22651**2634**
 22652
 22653     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22654        MOVE -1                  TO BTYPE2L
 22655        MOVE  1                  TO SET-CURSOR-SW
 22656        GO TO 7499-EXIT.
 22657
 22658**2635**
 22659
 22660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22661        MOVE AL-UNBON            TO BBEN2A
 22662        MOVE -1                  TO BBEN2L
 22663        MOVE  1                  TO SET-CURSOR-SW
 22664        GO TO 7499-EXIT.
 22665
 22666**2636**
 22667
 22668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22669        MOVE AL-UNBON            TO BPREM2A
 22670        MOVE -1                  TO BPREM2L
 22671        MOVE  1                  TO SET-CURSOR-SW
 22672        GO TO 7499-EXIT.
 22673
 22674**2639**
 22675
 22676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22677        MOVE AL-UNBON            TO BBEN1A
 22678        MOVE -1                  TO BBEN1L
 22679        MOVE  1                  TO SET-CURSOR-SW
 22680        GO TO 7499-EXIT.
 22681
 22682**2640**
 22683
 22684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22685        MOVE AL-UNBON            TO BBEN2A
 22686        MOVE -1                  TO BBEN2L
 22687        MOVE  1                  TO SET-CURSOR-SW
 22688        GO TO 7499-EXIT.
 22689
 22690**2647**
 22691
 22692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22693        MOVE AL-UNBON            TO BTERM1A
 22694        MOVE -1                  TO BTERM1L
 22695        MOVE  1                  TO SET-CURSOR-SW
 22696        GO TO 7499-EXIT.
 22697
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 423
* EL6311.cbl
 22698**2648**
 22699
 22700     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22701        MOVE AL-UNBON            TO BLNTRMA
 22702        MOVE -1                  TO BLNTRML
 22703        MOVE  1                  TO SET-CURSOR-SW
 22704        GO TO 7499-EXIT.
 22705
 22706**2649**
 22707
 22708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22709        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22710            MOVE AL-UNBON            TO BPREM1A
 22711            MOVE -1                  TO BPREM1L
 22712            MOVE  1                  TO SET-CURSOR-SW
 22713            GO TO 7499-EXIT
 22714     ELSE
 22715        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22716           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22717            MOVE AL-UNBON            TO BPREM2A
 22718            MOVE -1                  TO BPREM2L
 22719            MOVE  1                  TO SET-CURSOR-SW
 22720            GO TO 7499-EXIT.
 22721
 22722**2650**
 22723
 22724     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22725        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22726            MOVE AL-UNBON        TO BPREM1A
 22727            MOVE -1              TO BPREM1L
 22728            MOVE  1              TO SET-CURSOR-SW
 22729            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22730                MOVE AL-UNBON        TO BPREM2A
 22731                MOVE -1              TO BPREM2L
 22732                MOVE  1              TO SET-CURSOR-SW
 22733                GO TO 7499-EXIT
 22734            ELSE
 22735                GO TO 7499-EXIT
 22736        ELSE
 22737            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22738                MOVE AL-UNBON        TO BPREM2A
 22739                MOVE -1              TO BPREM2L
 22740                MOVE  1              TO SET-CURSOR-SW
 22741                GO TO 7499-EXIT
 22742            ELSE
 22743                GO TO 7499-EXIT.
 22744
 22745**2651**
 22746
 22747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22748        MOVE AL-UABON            TO BSIGA
 22749        MOVE -1                  TO BSIGL
 22750        MOVE  1                  TO SET-CURSOR-SW
 22751        GO TO 7499-EXIT.
 22752
 22753**2653**
 22754
 22755     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 424
* EL6311.cbl
 22756        MOVE AL-UABON            TO BFREQA
 22757        MOVE -1                  TO BFREQL
 22758        MOVE  1                  TO SET-CURSOR-SW
 22759        GO TO 7499-EXIT.
 22760
 22761**2654**
 22762
 22763     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22764        MOVE AL-UABON            TO BFREQA
 22765        MOVE -1                  TO BFREQL
 22766        MOVE  1                  TO SET-CURSOR-SW
 22767        GO TO 7499-EXIT.
 22768
 22769**2655**
 22770
 22771     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22772        MOVE AL-UABON            TO BFREQA
 22773        MOVE -1                  TO BFREQL
 22774        MOVE  1                  TO SET-CURSOR-SW
 22775        GO TO 7499-EXIT.
 22776
 22777**2656**
 22778
 22779     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22780        MOVE AL-UNBON            TO BAPRA
 22781        MOVE -1                  TO BAPRL
 22782        MOVE  1                  TO SET-CURSOR-SW
 22783        GO TO 7499-EXIT.
 22784
 22785**2657**
 22786
 22787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22788        MOVE AL-UNBON            TO BAPRA
 22789        MOVE -1                  TO BAPRL
 22790        MOVE  1                  TO SET-CURSOR-SW
 22791        GO TO 7499-EXIT.
 22792
 22793**2658**
 22794
 22795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22796        MOVE AL-UNBON            TO BTERM2A
 22797        MOVE -1                  TO BTERM2L
 22798        MOVE  1                  TO SET-CURSOR-SW
 22799        GO TO 7499-EXIT.
 22800
 22801**2660**
 22802
 22803     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22804        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22805        MOVE -1                  TO BLSTNML
 22806        MOVE  1                  TO SET-CURSOR-SW
 22807        GO TO 7499-EXIT.
 22808
 22809
 22810**2662**
 22811
 22812     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22813        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 425
* EL6311.cbl
 22814        MOVE -1                  TO BAGEL
 22815        MOVE  1                  TO SET-CURSOR-SW
 22816        GO TO 7499-EXIT.
 22817
 22818**2663**
 22819
 22820     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22821        MOVE AL-UNBON            TO BAGEA
 22822        MOVE -1                  TO BAGEL
 22823        MOVE  1                  TO SET-CURSOR-SW
 22824        GO TO 7499-EXIT.
 22825
 22826**2664**
 22827
 22828     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22829        MOVE AL-UABON            TO BREINA
 22830        MOVE -1                  TO BREINL
 22831        MOVE  1                  TO SET-CURSOR-SW
 22832        GO TO 7499-EXIT.
 22833
 22834**2667**
 22835
 22836     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22837        MOVE AL-UNBON            TO BBEN2A
 22838        MOVE -1                  TO BBEN2L
 22839        MOVE  1                  TO SET-CURSOR-SW
 22840        GO TO 7499-EXIT.
 22841
 22842**2668**
 22843
 22844     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22845        MOVE AL-UABON            TO BEFFDTA
 22846        GO TO 7499-EXIT.
 22847
 22848**2669**
 22849
 22850     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22851        MOVE AL-UNBON            TO BAGEA
 22852        MOVE -1                  TO BAGEL
 22853        MOVE  1                  TO SET-CURSOR-SW
 22854        GO TO 7499-EXIT.
 22855
 22856**2670**
 22857
 22858     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22859        MOVE AL-UABON            TO BFORCEA
 22860        MOVE -1                  TO BFORCEL
 22861        MOVE  1                  TO SET-CURSOR-SW
 22862        GO TO 7499-EXIT.
 22863
 22864**2671**
 22865
 22866     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22867        MOVE AL-UABON            TO BEFFDTA
 22868        GO TO 7499-EXIT.
 22869
 22870**2672**
 22871
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 426
* EL6311.cbl
 22872     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22873        MOVE AL-UABON            TO BEFFDTA
 22874        GO TO 7499-EXIT.
 22875
 22876**2673**
 22877
 22878     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22879        MOVE AL-UABON            TO BEFFDTA
 22880        GO TO 7499-EXIT.
 22881
 22882**2674**
 22883
 22884     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22885        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22886        MOVE -1                  TO BTYPE1L
 22887        MOVE  1                  TO SET-CURSOR-SW
 22888        GO TO 7499-EXIT.
 22889
 22890**2677**
 22891
 22892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22893        MOVE AL-UNBON            TO BTERM1A
 22894        MOVE -1                  TO BTERM1L
 22895        MOVE  1                  TO SET-CURSOR-SW
 22896        GO TO 7499-EXIT.
 22897
 22898**2678**
 22899
 22900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22901        MOVE AL-UNBON            TO BTERM2A
 22902        MOVE -1                  TO BTERM2L
 22903        MOVE  1                  TO SET-CURSOR-SW
 22904        GO TO 7499-EXIT.
 22905
 22906**2679**
 22907
 22908     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22909        MOVE AL-UABON            TO BTYPE1A
 22910        MOVE -1                  TO BTYPE1L
 22911        MOVE  1                  TO SET-CURSOR-SW
 22912        GO TO 7499-EXIT.
 22913
 22914**2680**
 22915
 22916     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22917        MOVE AL-UABOF            TO B1STPMTA
 22918        MOVE -1                  TO B1STPMTL
 22919        MOVE  1                  TO SET-CURSOR-SW
 22920        GO TO 7499-EXIT.
 22921
 22922**2681**
 22923
 22924     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22925        MOVE AL-UABON            TO BDAYSA
 22926        MOVE -1                  TO BDAYSL
 22927        MOVE  1                  TO SET-CURSOR-SW
 22928        GO TO 7499-EXIT.
 22929
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 427
* EL6311.cbl
 22930**2682**
 22931
 22932     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 22933        MOVE AL-UABON            TO BTERM1A
 22934        MOVE -1                  TO BTERM1L
 22935        MOVE  1                  TO SET-CURSOR-SW
 22936        GO TO 7499-EXIT.
 22937
 22938**2683**
 22939
 22940     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 22941        MOVE AL-UABON            TO BSKPCDA
 22942        MOVE -1                  TO BSKPCDL
 22943        MOVE  1                  TO SET-CURSOR-SW
 22944        GO TO 7499-EXIT.
 22945
 22946**2684**
 22947
 22948     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 22949        MOVE AL-UABON            TO BTYPE2A
 22950        MOVE -1                  TO BTYPE2L
 22951        MOVE  1                  TO SET-CURSOR-SW
 22952        GO TO 7499-EXIT.
 22953
 22954**2686**
 22955
 22956     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 22957        MOVE AL-UABON            TO BTYPE2A
 22958        MOVE -1                  TO BTYPE2L
 22959        MOVE  1                  TO SET-CURSOR-SW
 22960        GO TO 7499-EXIT.
 22961
 22962**2689**
 22963
 22964     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 22965        MOVE AL-UABON            TO BSIGA
 22966        MOVE -1                  TO BSIGL
 22967        MOVE  1                  TO SET-CURSOR-SW
 22968        GO TO 7499-EXIT.
 22969
 22970**2690**
 22971
 22972     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 22973        MOVE AL-UABOF            TO BLNOFCRA
 22974        MOVE -1                  TO BLNOFCRL
 22975        MOVE  1                  TO SET-CURSOR-SW
 22976        GO TO 7499-EXIT.
 22977
 22978**2693**
 22979
 22980     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 22981        MOVE AL-UABOF            TO BLNOFCRA
 22982        MOVE AL-UNBON            TO BBEN1A
 22983        MOVE -1                  TO BBEN1L
 22984        MOVE  1                  TO SET-CURSOR-SW
 22985        GO TO 7499-EXIT.
 22986
 22987**2720**
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 428
* EL6311.cbl
 22988
 22989     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 22990        MOVE AL-UNBON            TO BBEN1A
 22991        MOVE -1                  TO BBEN1L
 22992        MOVE  1                  TO SET-CURSOR-SW
 22993        GO TO 7499-EXIT.
 22994
 22995**2709**
 22996
 22997*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 22998*       MOVE AL-UNBON            TO BBEN1A
 22999*       MOVE -1                  TO BBEN1L
 23000*       MOVE  1                  TO SET-CURSOR-SW
 23001*       GO TO 7499-EXIT.
 23002
 23003*************************************************************
 23004*                                                           *
 23005*            C A N C E L   E R R O R S                      *
 23006*                                                           *
 23007*************************************************************
 23008
 23009**2726**
 23010
 23011     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23012        MOVE AL-UABON            TO CCERTNOA
 23013        GO TO 7499-EXIT.
 23014
 23015**2728**
 23016
 23017     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23018        MOVE AL-UABON            TO CCERTNOA
 23019        GO TO 7499-EXIT.
 23020
 23021**2729**
 23022
 23023     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23024        MOVE AL-UABON            TO CCERTNOA
 23025        GO TO 7499-EXIT.
 23026
 23027**2730**
 23028
 23029     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23030        MOVE AL-UABON            TO CCERTNOA
 23031        GO TO 7499-EXIT.
 23032
 23033**2731**
 23034
 23035     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23036        MOVE AL-UABON            TO CCANDT1A
 23037        MOVE -1                  TO CCANDT1L
 23038        MOVE  1                  TO SET-CURSOR-SW
 23039        GO TO 7499-EXIT.
 23040
 23041**2732**
 23042
 23043     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 23044        MOVE AL-UABON            TO CCANDT1A
 23045        MOVE -1                  TO CCANDT1L
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 429
* EL6311.cbl
 23046        MOVE  1                  TO SET-CURSOR-SW
 23047        GO TO 7499-EXIT.
 23048
 23049**2733**
 23050
 23051     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23052        MOVE AL-UABON            TO CCANDT1A
 23053        MOVE -1                  TO CCANDT1L
 23054        MOVE  1                  TO SET-CURSOR-SW
 23055        GO TO 7499-EXIT.
 23056
 23057**2734**
 23058
 23059     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23060        MOVE AL-UNBON            TO CREFND1A
 23061        MOVE -1                  TO CREFND1L
 23062        MOVE  1                  TO SET-CURSOR-SW
 23063        GO TO 7499-EXIT.
 23064
 23065**2735**
 23066
 23067     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23068        MOVE AL-UABON            TO CCANDT2A
 23069        MOVE -1                  TO CCANDT2L
 23070        MOVE  1                  TO SET-CURSOR-SW
 23071        GO TO 7499-EXIT.
 23072
 23073**2736**
 23074
 23075     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23076        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23077            MOVE AL-UNBON        TO CREFND1A
 23078            MOVE -1              TO CREFND1L
 23079            MOVE  1              TO SET-CURSOR-SW
 23080            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23081                MOVE AL-UNBON        TO CREFND2A
 23082                MOVE -1              TO CREFND2L
 23083                MOVE  1              TO SET-CURSOR-SW
 23084                GO TO 7499-EXIT
 23085            ELSE
 23086                GO TO 7499-EXIT
 23087        ELSE
 23088            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23089                MOVE AL-UNBON        TO CREFND2A
 23090                MOVE -1              TO CREFND2L
 23091                MOVE  1              TO SET-CURSOR-SW
 23092                GO TO 7499-EXIT
 23093            ELSE
 23094                GO TO 7499-EXIT.
 23095
 23096**2738**
 23097
 23098     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23099        MOVE -1                  TO CREFND2L
 23100        MOVE  1                  TO SET-CURSOR-SW
 23101        GO TO 7499-EXIT.
 23102
 23103**2739**
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 430
* EL6311.cbl
 23104
 23105     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23106        MOVE -1                  TO CREFND1L
 23107        MOVE  1                  TO SET-CURSOR-SW
 23108        GO TO 7499-EXIT.
 23109
 23110**2741**
 23111
 23112     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23113        MOVE -1                  TO CREFND1L
 23114        MOVE  1                  TO SET-CURSOR-SW
 23115        GO TO 7499-EXIT.
 23116
 23117**2743**
 23118
 23119     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23120        MOVE AL-UNBON            TO CCANDT1A
 23121        MOVE -1                  TO CCANDT1L
 23122        MOVE  1                  TO SET-CURSOR-SW
 23123        GO TO 7499-EXIT.
 23124
 23125**2744**
 23126
 23127     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23128        MOVE AL-UNBON            TO CCANDT2A
 23129        MOVE -1                  TO CCANDT2L
 23130        MOVE  1                  TO SET-CURSOR-SW
 23131        GO TO 7499-EXIT.
 23132
 23133**2747**
 23134
 23135     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23136        MOVE AL-UABON            TO CLSTNMA
 23137        MOVE -1                  TO CLSTNML
 23138        MOVE  1                  TO SET-CURSOR-SW
 23139        GO TO 7499-EXIT.
 23140
 23141**2749**
 23142
 23143     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23144        MOVE AL-UABON            TO CFORCEA
 23145        MOVE -1                  TO CFORCEL
 23146        MOVE  1                  TO SET-CURSOR-SW
 23147        GO TO 7499-EXIT.
 23148
 23149**2753**
 23150
 23151     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23152        MOVE AL-UNBON            TO CCANDT1A
 23153        MOVE -1                  TO CCANDT1L
 23154        MOVE  1                  TO SET-CURSOR-SW
 23155        GO TO 7499-EXIT.
 23156
 23157**2755**
 23158
 23159     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 23160        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23161            MOVE AL-UNBON        TO CREFND1A
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 431
* EL6311.cbl
 23162            MOVE -1              TO CREFND1L
 23163            MOVE  1              TO SET-CURSOR-SW
 23164            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23165                MOVE AL-UNBON        TO CREFND2A
 23166                MOVE -1              TO CREFND2L
 23167                MOVE  1              TO SET-CURSOR-SW
 23168                GO TO 7499-EXIT
 23169            ELSE
 23170                GO TO 7499-EXIT
 23171        ELSE
 23172            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23173                MOVE AL-UNBON        TO CREFND2A
 23174                MOVE -1              TO CREFND2L
 23175                MOVE  1              TO SET-CURSOR-SW
 23176            ELSE
 23177                GO TO 7499-EXIT.
 23178
 23179**2757**
 23180
 23181     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23182        MOVE AL-UNBON            TO CLIVESA
 23183        MOVE -1                  TO CLIVESL
 23184        MOVE  1                  TO SET-CURSOR-SW
 23185        GO TO 7499-EXIT.
 23186
 23187**2771**
 23188
 23189     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23190        MOVE AL-UABON            TO CCANDT2A
 23191        MOVE -1                  TO CCANDT2L
 23192        MOVE  1                  TO SET-CURSOR-SW
 23193        GO TO 7499-EXIT.
 23194
 23195**2774**
 23196
 23197     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23198        MOVE AL-UABON            TO CCANDT1A
 23199        MOVE -1                  TO CCANDT1L
 23200        MOVE  1                  TO SET-CURSOR-SW
 23201        GO TO 7499-EXIT.
 23202
 23203**2775**
 23204
 23205     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23206        MOVE AL-UABON            TO CCANDT2A
 23207        MOVE -1                  TO CCANDT2L
 23208        MOVE  1                  TO SET-CURSOR-SW
 23209        GO TO 7499-EXIT.
 23210
 23211**2776**
 23212
 23213     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23214        MOVE AL-UABON            TO CCANDT1A
 23215        MOVE -1                  TO CCANDT1L
 23216        MOVE  1                  TO SET-CURSOR-SW
 23217        GO TO 7499-EXIT.
 23218
 23219
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 432
* EL6311.cbl
 23220**2777**
 23221
 23222     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23223        MOVE AL-UABON            TO CCANDT2A
 23224        MOVE -1                  TO CCANDT2L
 23225        MOVE  1                  TO SET-CURSOR-SW
 23226        GO TO 7499-EXIT.
 23227
 23228**2794**
 23229
 23230     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23231        MOVE AL-UABON            TO CFORCEA
 23232        MOVE -1                  TO CFORCEL
 23233        MOVE  1                  TO SET-CURSOR-SW
 23234        GO TO 7499-EXIT.
 23235
 23236**2799**
 23237
 23238     IF PI-COMPANY-ID = 'UCL'
 23239         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23240             MOVE AL-UNBON            TO BEFFDTA
 23241             MOVE -1                  TO BEFFDTL
 23242             MOVE  1                  TO SET-CURSOR-SW
 23243             GO TO 7499-EXIT.
 23244
 23245 7499-EXIT.
 23246      EXIT.
 23247
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 433
* EL6311.cbl
 23249
 23250 7500-READ-ERLOFC.
 23251     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23252                                     ERLOFC-KEY.
 23253
 23254     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23255
 23256     IF ST-ACCNT-CNTL
 23257         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23258
 23259     IF CARR-GROUP-ST-ACCNT-CNTL
 23260         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23261         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23262         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23263
 23264     IF CARR-ST-ACCNT-CNTL
 23265         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23266         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23267
 23268     IF CARR-ACCNT-CNTL
 23269         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23270
 23271     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23272
 23273     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23274
 23275
 23276* EXEC CICS HANDLE CONDITION
 23277*        NOTFND   (7550-OFFICER-NOTFND)
 23278*    END-EXEC.
 23279*    MOVE '"$I                   ! [ #00019561' TO DFHEIV0
 23280     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23282     MOVE X'5B20233030303139353631' TO DFHEIV0(25:11)
 23283     CALL 'kxdfhei1' USING DFHEIV0
 23284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23285
 23286
 23287
 23288* EXEC CICS READ
 23289*        DATASET   (FILE-ID-ERLOFC)
 23290*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23291*        RIDFLD    (ERLOFC-KEY)
 23292*        EQUAL
 23293*    END-EXEC.
 23294*    MOVE '&"S        E          (   #00019565' TO DFHEIV0
 23295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23297     MOVE X'2020233030303139353635' TO DFHEIV0(25:11)
 23298     CALL 'kxdfhei1' USING DFHEIV0,
 23299           FILE-ID-ERLOFC,
 23300           DFHEIV20,
 23301           DFHEIV99,
 23302           ERLOFC-KEY,
 23303           DFHEIV99,
 23304           DFHEIV99,
 23305           DFHEIV99
 23306     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 434
* EL6311.cbl
 23307         DFHEIV20
 23308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23309
 23310
 23311     GO TO 7599-EXIT.
 23312
 23313 7550-OFFICER-NOTFND.
 23314     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23315
 23316 7599-EXIT.
 23317      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 435
* EL6311.cbl
 23319******************************************************************
 23320*                                                                *
 23321*            S  E N D    I N I T I A L   M A P                   *
 23322*                                                                *
 23323******************************************************************
 23324
 23325 8100-SEND-INITIAL-MAP.
 23326     MOVE EIBTIME                TO TIME-IN.
 23327
 23328     IF EIBAID = DFHPF11
 23329        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23331
 23332
 23333     IF PI-COMPANY-ID = CLIENT-GIC
 23334        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23335                                       BCPREM-ATTRB (2).
 23336
 23337     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23338                         CLIENT-PEM OR
 23339                         CLIENT-CSO)
 23340        AND PI-DISPLAY-ORIGINAL-BATCH
 23341          IF PI-MAP-NAME = EL631B
 23342             MOVE AL-SADOF               TO BPF5HDRA
 23343                                            BPF4HDRA
 23344          ELSE
 23345             IF PI-MAP-NAME = EL631C
 23346                MOVE AL-SADOF            TO CPF5HDRA
 23347                                            CPF4HDRA.
 23348
 23349     IF PI-MAP-NAME = EL631B
 23350        MOVE AL-SADOF               TO BPF5HDRA
 23351     ELSE
 23352        MOVE AL-SADOF               TO CPF5HDRA
 23353     END-IF
 23354
 23355*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23356     IF PI-MAP-NAME = EL631B
 23357          IF PI-COMPANY-ID NOT = 'DMD'
 23358             MOVE AL-SANOF            TO BBILLEDA
 23359             MOVE AL-SADOF            TO DMDBILA.
 23360*DMD CUSTOM CODING*************END
 23361
 23362     IF PI-PROCESSOR-ID = 'LGXX'
 23363        IF PI-MAP-NAME = EL631B
 23364           MOVE AL-SABOF                    TO BREFHDGA
 23365           MOVE AL-SANOF                    TO BREFA
 23366        ELSE
 23367           IF PI-MAP-NAME = EL631C
 23368              MOVE AL-SABOF                 TO CREFHDGA
 23369              MOVE AL-SANOF                 TO CREFA.
 23370
 23371*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23372     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23373        NEXT SENTENCE
 23374     ELSE
 23375        IF PI-MAP-NAME = EL631C
 23376           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 436
* EL6311.cbl
 23377                                       CCANFEEA.
 23378
 23379     IF PI-MAP-NAME = EL631D
 23380        IF PI-AR-PROCESSING
 23381           MOVE AL-SANOF            TO DREFHDGA
 23382        ELSE
 23383           MOVE AL-SADOF            TO DREFHDGA.
 23384
 23385     IF (PI-COMPANY-ID NOT = 'DCC')
 23386        AND (PI-MAP-NAME = EL631B)
 23387        MOVE AL-SADOF            TO BVINHA
 23388                                    BVINA
 23389     END-IF
 23390     IF PI-MAP-NAME = EL631B
 23391        IF CSR-EDIT-SESSION
 23392           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23393                                 TO BHEADO
 23394           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23395        ELSE
 23396           MOVE AL-SADOF         TO BF15HDRA
 23397           MOVE '4=B-HDR      '  TO BPF4HDRO
 23398        END-IF
 23399        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23400        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23401        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23402        MOVE WS-CURRENT-DT          TO BDATEO
 23403        MOVE TIME-OUT               TO BTIMEO
 23404        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23405        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23406        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23407        IF   WS-DISPLAY-SCREEN
 23408             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23409             MOVE PB-SV-CARRIER     TO BCARRO
 23410             MOVE PB-SV-GROUPING    TO BGROUPO
 23411             MOVE PB-SV-STATE       TO BSTATEO
 23412             MOVE PB-ACCOUNT        TO BACCTO
 23413        ELSE
 23414             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23415     ELSE
 23416        IF PI-MAP-NAME = EL631C
 23417           MOVE '4=B-HDR      '     TO CPF4HDRO
 23418           IF CSR-EDIT-SESSION
 23419              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23420                                 TO CHEADO
 23421           ELSE
 23422              MOVE AL-SADOF      TO CF15HDRA
 23423           END-IF
 23424           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23425           MOVE WS-CURRENT-DT          TO CDATEO
 23426           MOVE TIME-OUT               TO CTIMEO
 23427           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23428           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23429           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23430           MOVE WS-C-HDG               TO CLFHDGO
 23431           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23432           MOVE WS-C-HDG               TO CAHHDGO
 23433           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23434           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 437
* EL6311.cbl
 23435           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23436           IF   WS-DISPLAY-SCREEN
 23437                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23438                MOVE PB-SV-CARRIER     TO CCARRO
 23439                MOVE PB-SV-GROUPING    TO CGROUPO
 23440                MOVE PB-SV-STATE       TO CSTATEO
 23441                MOVE PB-ACCOUNT        TO CACCTO
 23442           ELSE
 23443                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23444        ELSE
 23445           MOVE WS-CURRENT-DT          TO DDATEO
 23446           MOVE TIME-OUT               TO DTIMEO
 23447           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23448                                          WS-REFUND-HDG-OVERRIDE
 23449           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23450           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23451           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23452                                          WS-REFUND-HDG-OVERRIDE
 23453           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23454           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23455           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23456           IF CSR-EDIT-SESSION
 23457              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23458                                 TO DHEADO
 23459           END-IF
 23460           IF  WS-DISPLAY-SCREEN
 23461               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23462               MOVE PB-CARRIER         TO DCARRO
 23463               MOVE PB-GROUPING        TO DGROUPO
 23464               MOVE PB-STATE           TO DSTATEO
 23465               MOVE PB-ACCOUNT         TO DACCTO
 23466               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23467           ELSE
 23468               MOVE EL631D             TO PI-MAP-NAME
 23469               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23470               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23471
 23472     MOVE SPACE                        TO WS-DISPLAY-SW.
 23473
 23474
 23475* EXEC CICS SEND
 23476*        MAP      (PI-MAP-NAME)
 23477*        MAPSET   (MAPSET-EL6311S)
 23478*        FROM     (EL631BI)
 23479*        ERASE
 23480*        CURSOR
 23481*    END-EXEC.
 23482     MOVE LENGTH OF
 23483      EL631BI
 23484       TO DFHEIV12
 23485     MOVE -1
 23486       TO DFHEIV11
 23487*    MOVE '8$     CT  E    H L F ,   #00019735' TO DFHEIV0
 23488     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23489     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23490     MOVE X'2020233030303139373335' TO DFHEIV0(25:11)
 23491     CALL 'kxdfhei1' USING DFHEIV0,
 23492           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 438
* EL6311.cbl
 23493           EL631BI,
 23494           DFHEIV12,
 23495           MAPSET-EL6311S,
 23496           DFHEIV99,
 23497           DFHEIV99,
 23498           DFHEIV99,
 23499           DFHEIV11,
 23500           DFHEIV99,
 23501           DFHEIV99,
 23502           DFHEIV99
 23503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23504
 23505
 23506     GO TO 9100-RETURN-TRAN.
 23507
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 439
* EL6311.cbl
 23509
 23510******************************************************************
 23511*                                                                *
 23512*              S E N D    D A T A O N L Y                        *
 23513*                                                                *
 23514******************************************************************
 23515
 23516 8200-SEND-DATAONLY.
 23517     MOVE EIBTIME                TO TIME-IN.
 23518
 23519     IF PI-COMPANY-ID = CLIENT-GIC
 23520        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23521                                       BCPREM-ATTRB (2).
 23522
 23523     IF PI-MAP-NAME = EL631B
 23524        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23525        MOVE WS-CURRENT-DT          TO BDATEO
 23526        MOVE TIME-OUT               TO BTIMEO
 23527        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23528        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23529        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23530        MOVE SPACES                 TO BPFENTRO
 23531        MOVE AL-UANOF               TO BPFENTRA
 23532
 23533*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23534        IF PI-COMPANY-ID NOT = 'DMD'
 23535             MOVE AL-SANOF            TO BBILLEDA
 23536             MOVE AL-SADOF            TO DMDBILA
 23537         ELSE
 23538            NEXT SENTENCE
 23539*DMD CUSTOM CODING*************END
 23540     ELSE
 23541        IF PI-MAP-NAME = EL631C
 23542           MOVE WS-CURRENT-DT          TO CDATEO
 23543           MOVE TIME-OUT               TO CTIMEO
 23544           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23545           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23546           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23547           MOVE SPACES                 TO CPFENTRO
 23548           MOVE AL-UANOF               TO CPFENTRA
 23549        ELSE
 23550           MOVE WS-CURRENT-DT          TO DDATEO
 23551           MOVE TIME-OUT               TO DTIMEO
 23552           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23553
 23554
 23555* EXEC CICS SEND
 23556*        MAP      (PI-MAP-NAME)
 23557*        MAPSET   (MAPSET-EL6311S)
 23558*        FROM     (EL631BI)
 23559*        DATAONLY
 23560*        CURSOR
 23561*    END-EXEC.
 23562     MOVE LENGTH OF
 23563      EL631BI
 23564       TO DFHEIV12
 23565     MOVE -1
 23566       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 440
* EL6311.cbl
 23567*    MOVE '8$D    CT       H L F ,   #00019791' TO DFHEIV0
 23568     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23569     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23570     MOVE X'2020233030303139373931' TO DFHEIV0(25:11)
 23571     CALL 'kxdfhei1' USING DFHEIV0,
 23572           PI-MAP-NAME,
 23573           EL631BI,
 23574           DFHEIV12,
 23575           MAPSET-EL6311S,
 23576           DFHEIV99,
 23577           DFHEIV99,
 23578           DFHEIV99,
 23579           DFHEIV11,
 23580           DFHEIV99,
 23581           DFHEIV99,
 23582           DFHEIV99
 23583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23584
 23585
 23586     GO TO 9100-RETURN-TRAN.
 23587
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 441
* EL6311.cbl
 23589
 23590******************************************************************
 23591*                                                                *
 23592*           U T I L I T Y   R O U T I N E S                      *
 23593*                                                                *
 23594******************************************************************
 23595
 23596 8300-SEND-TEXT.
 23597
 23598* EXEC CICS SEND TEXT
 23599*        FROM     (LOGOFF-TEXT)
 23600*        LENGTH   (LOGOFF-LENGTH)
 23601*        ERASE
 23602*        FREEKB
 23603*    END-EXEC.
 23604*    MOVE '8&      T  E F  H   F -   #00019810' TO DFHEIV0
 23605     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23606     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23607     MOVE X'2020233030303139383130' TO DFHEIV0(25:11)
 23608     CALL 'kxdfhei1' USING DFHEIV0,
 23609           LOGOFF-TEXT,
 23610           LOGOFF-LENGTH,
 23611           DFHEIV99,
 23612           DFHEIV99,
 23613           DFHEIV99,
 23614           DFHEIV99,
 23615           DFHEIV99,
 23616           DFHEIV99,
 23617           DFHEIV99,
 23618           DFHEIV99,
 23619           DFHEIV99,
 23620           DFHEIV99
 23621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23622
 23623
 23624
 23625* EXEC CICS RETURN
 23626*    END-EXEC.
 23627*    MOVE '.(                    ''   #00019817' TO DFHEIV0
 23628     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23630     MOVE X'2020233030303139383137' TO DFHEIV0(25:11)
 23631     CALL 'kxdfhei1' USING DFHEIV0,
 23632           DFHEIV99,
 23633           DFHEIV99,
 23634           DFHEIV99,
 23635           DFHEIV99,
 23636           DFHEIV99,
 23637           DFHEIV99
 23638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23639
 23640
 23641 8400-LOG-JOURNAL-RECORD.
 23642     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23643     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23644
 23645*    EXEC CICS JOURNAL
 23646*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 442
* EL6311.cbl
 23647*        JTYPEID     ('EL')
 23648*        FROM        (JOURNAL-RECORD)
 23649*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23650*    END-EXEC.
 23651
 23652 8600-DEEDIT.
 23653
 23654* EXEC CICS BIF DEEDIT
 23655*         FIELD   (DEEDIT-FIELD)
 23656*         LENGTH  (15)
 23657*    END-EXEC.
 23658     MOVE 15
 23659       TO DFHEIV11
 23660*    MOVE '@"L                   #   #00019832' TO DFHEIV0
 23661     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23663     MOVE X'2020233030303139383332' TO DFHEIV0(25:11)
 23664     CALL 'kxdfhei1' USING DFHEIV0,
 23665           DEEDIT-FIELD,
 23666           DFHEIV11
 23667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23668
 23669
 23670 8800-UNAUTHORIZED-ACCESS.
 23671     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23672     GO TO 8300-SEND-TEXT.
 23673
 23674 8810-PF23.
 23675     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23676     MOVE XCTL-EL005             TO PGM-NAME.
 23677     GO TO 9300-XCTL.
 23678
 23679 9100-RETURN-TRAN.
 23680     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23681
 23682     IF  PI-MAP-NAME =  EL631B
 23683         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23684
 23685     IF  PI-MAP-NAME =  EL631C
 23686         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23687
 23688     IF  PI-MAP-NAME =  EL631D
 23689         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23690
 23691
 23692* EXEC CICS RETURN
 23693*        TRANSID    (TRANS-EXB1)
 23694*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23695*        LENGTH     (1300)
 23696*    END-EXEC.
 23697     MOVE 1300
 23698       TO DFHEIV11
 23699*    MOVE '.(CT                  ''   #00019858' TO DFHEIV0
 23700     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23701     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23702     MOVE X'2020233030303139383538' TO DFHEIV0(25:11)
 23703     CALL 'kxdfhei1' USING DFHEIV0,
 23704           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 443
* EL6311.cbl
 23705           PROGRAM-INTERFACE-BLOCK,
 23706           DFHEIV11,
 23707           DFHEIV99,
 23708           DFHEIV99,
 23709           DFHEIV99
 23710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23711
 23712
 23713 9200-RETURN-MAIN-MENU.
 23714     MOVE XCTL-EL626             TO PGM-NAME.
 23715     GO TO 9300-XCTL.
 23716
 23717 9300-XCTL.
 23718
 23719* EXEC CICS XCTL
 23720*        PROGRAM    (PGM-NAME)
 23721*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23722*        LENGTH     (PI-COMM-LENGTH)
 23723*    END-EXEC.
 23724*    MOVE '.$C                   %   #00019869' TO DFHEIV0
 23725     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23726     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23727     MOVE X'2020233030303139383639' TO DFHEIV0(25:11)
 23728     CALL 'kxdfhei1' USING DFHEIV0,
 23729           PGM-NAME,
 23730           PROGRAM-INTERFACE-BLOCK,
 23731           PI-COMM-LENGTH,
 23732           DFHEIV99
 23733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23734
 23735
 23736 9400-CLEAR.
 23737     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23738     GO TO 9300-XCTL.
 23739
 23740 9500-PF12.
 23741     MOVE XCTL-EL010             TO PGM-NAME.
 23742     GO TO 9300-XCTL.
 23743
 23744 9600-PGMID-ERROR.
 23745
 23746* EXEC CICS HANDLE CONDITION
 23747*        PGMIDERR    (8300-SEND-TEXT)
 23748*    END-EXEC.
 23749*    MOVE '"$L                   ! \ #00019884' TO DFHEIV0
 23750     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23752     MOVE X'5C20233030303139383834' TO DFHEIV0(25:11)
 23753     CALL 'kxdfhei1' USING DFHEIV0
 23754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23755
 23756
 23757     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23758     MOVE ' '                    TO PI-ENTRY-CD-1.
 23759     MOVE XCTL-EL005             TO PGM-NAME.
 23760     MOVE PGM-NAME               TO LOGOFF-PGM.
 23761     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23762     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 444
* EL6311.cbl
 23763
 23764 9700-DATE-LINK.
 23765     MOVE LINK-ELDATCV           TO PGM-NAME.
 23766
 23767* EXEC CICS LINK
 23768*        PROGRAM    (PGM-NAME)
 23769*        COMMAREA   (DATE-CONVERSION-DATA)
 23770*        LENGTH     (DC-COMM-LENGTH)
 23771*    END-EXEC.
 23772*    MOVE '."C                   (   #00019897' TO DFHEIV0
 23773     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23775     MOVE X'2020233030303139383937' TO DFHEIV0(25:11)
 23776     CALL 'kxdfhei1' USING DFHEIV0,
 23777           PGM-NAME,
 23778           DATE-CONVERSION-DATA,
 23779           DC-COMM-LENGTH,
 23780           DFHEIV99,
 23781           DFHEIV99,
 23782           DFHEIV99,
 23783           DFHEIV99
 23784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23785
 23786
 23787 9800-LINK-PENDING-EDIT.
 23788     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23789     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23790
 23791     MOVE LINK-EL050             TO PGM-NAME
 23792     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23793     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23794                                    WK-CO-TOL-CLAIM
 23795                                    WK-CO-TOL-PREM
 23796                                    WK-CO-TOL-REFUND
 23797                                    WK-CO-TOL-PREM-PCT
 23798                                    WK-CO-TOL-REFUND-PCT
 23799                                    WK-REFUND-OVS-AMT
 23800                                    WK-REFUND-OVS-PCT
 23801                                    WK-ACCT-ADDR
 23802                                    WK-LIFE-EDIT-ADDR
 23803                                    WK-AH-EDIT-ADDR
 23804                                    WK-LIFE-BEN-ADDR
 23805                                    WK-AH-BEN-ADDR
 23806                                    WK-STATE-ADDR
 23807                                    WK-PLAN-ADDR
 23808                                    WK-FORM-ADDR
 23809     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23810
 23811     MOVE '6'                    TO WK-ENTRY-SW.
 23812
 23813     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23814
 23815     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23816                                    EC-AM-EXPIRATION-DT
 23817                                    EC-AM-EFFECTIVE-DT
 23818                                    EC-CM-LF-CANCEL-DT
 23819                                    EC-CM-AH-CANCEL-DT
 23820                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 445
* EL6311.cbl
 23821
 23822     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23823                                    EC-CO-TOL-REFUND
 23824                                    EC-CO-MIN-AGE
 23825                                    EC-CO-MIN-PREMIUM
 23826                                    EC-CO-MIN-TERM
 23827                                    EC-CO-MAX-TERM
 23828                                    EC-ST-TOL-PREM
 23829                                    EC-ST-TOL-REFUND
 23830                                    EC-AM-LF-TOL-PREM
 23831                                    EC-AM-AH-TOL-PREM
 23832                                    EC-AM-LF-MAX-ATT-AGE
 23833                                    EC-AM-LF-MAX-AGE
 23834                                    EC-AM-LF-MAX-TERM
 23835                                    EC-AM-LF-MAX-TOT-BEN
 23836                                    EC-AM-AH-MAX-ATT-AGE
 23837                                    EC-AM-AH-MAX-AGE
 23838                                    EC-AM-AH-MAX-TERM
 23839                                    EC-AM-AH-MAX-TOT-BEN
 23840                                    EC-AM-AH-MAX-MON-BEN
 23841                                    EC-RT-LF-MAX-ATT-AGE
 23842                                    EC-RT-LF-MAX-AGE
 23843                                    EC-RT-LF-MAX-TERM
 23844                                    EC-RT-LF-MAX-TOT-BEN
 23845                                    EC-RT-AH-MAX-ATT-AGE
 23846                                    EC-RT-AH-MAX-AGE
 23847                                    EC-RT-AH-MAX-TERM
 23848                                    EC-RT-AH-MAX-TOT-BEN
 23849                                    EC-RT-AH-MAX-MON-BEN
 23850                                    EC-RT-AH-RATE
 23851                                    EC-RT-LF-RATE
 23852                                    EC-RT-LF-NSP-RATE
 23853                                    EC-RT-AH-NSP-RATE
 23854                                    EC-CM-LF-PRIOR-REFUND
 23855                                    EC-CM-AH-PRIOR-REFUND.
 23856
 23857     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23858                                    EC-ST-TOL-PREM-PCT
 23859                                    EC-AM-LF-TOL-REFUND
 23860                                    EC-AM-LF-DEV-PERCENT
 23861                                    EC-CO-TOL-REFUND-PCT
 23862                                    EC-ST-TOL-REFUND-PCT
 23863                                    EC-AM-AH-TOL-REFUND
 23864                                    EC-AM-AH-DEV-PERCENT.
 23865
 23866
 23867* EXEC CICS LINK
 23868*         PROGRAM   (PGM-NAME)
 23869*         COMMAREA  (PASSED-RECORD)
 23870*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23871*    END-EXEC.
 23872*    MOVE '."C                   (   #00019982' TO DFHEIV0
 23873     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23875     MOVE X'2020233030303139393832' TO DFHEIV0(25:11)
 23876     CALL 'kxdfhei1' USING DFHEIV0,
 23877           PGM-NAME,
 23878           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 446
* EL6311.cbl
 23879           WS-EDIT-PASS-LENGTH,
 23880           DFHEIV99,
 23881           DFHEIV99,
 23882           DFHEIV99,
 23883           DFHEIV99
 23884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23885
 23886
 23887     MOVE '1'                    TO PI-EDIT-SW.
 23888     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23889
 23890     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23891
 23892     IF PI-COMPANY-ID = 'UCL'
 23893         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23894
 23895     IF VALID-PB-ID
 23896        GO TO 9800-EXIT.
 23897
 23898     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23899
 23900     IF PI-MAP-NAME = EL631B
 23901        MOVE -1                  TO BMAINTL
 23902       ELSE
 23903        MOVE -1                  TO CMAINTL.
 23904
 23905     GO TO 8200-SEND-DATAONLY.
 23906
 23907 9800-EXIT.
 23908      EXIT.
 23909
 23910 9900-ERROR-FORMAT.
 23911
 23912     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23913
 23914     IF NOT EMI-ERRORS-COMPLETE
 23915         MOVE LINK-EL001         TO PGM-NAME
 23916
 23917* EXEC CICS LINK
 23918*            PROGRAM    (PGM-NAME)
 23919*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23920*            LENGTH     (EMI-COMM-LENGTH)
 23921*        END-EXEC.
 23922*    MOVE '."C                   (   #00020017' TO DFHEIV0
 23923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23925     MOVE X'2020233030303230303137' TO DFHEIV0(25:11)
 23926     CALL 'kxdfhei1' USING DFHEIV0,
 23927           PGM-NAME,
 23928           ERROR-MESSAGE-INTERFACE-BLOCK,
 23929           EMI-COMM-LENGTH,
 23930           DFHEIV99,
 23931           DFHEIV99,
 23932           DFHEIV99,
 23933           DFHEIV99
 23934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23935
 23936
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 447
* EL6311.cbl
 23937 9900-EXIT.
 23938     EXIT.
 23939
 23940 9990-ABEND.
 23941     MOVE LINK-EL004             TO PGM-NAME.
 23942     MOVE DFHEIBLK               TO EMI-LINE1.
 23943
 23944* EXEC CICS LINK
 23945*        PROGRAM   (PGM-NAME)
 23946*        COMMAREA  (EMI-LINE1)
 23947*        LENGTH    (72)
 23948*    END-EXEC.
 23949     MOVE 72
 23950       TO DFHEIV11
 23951*    MOVE '."C                   (   #00020029' TO DFHEIV0
 23952     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23954     MOVE X'2020233030303230303239' TO DFHEIV0(25:11)
 23955     CALL 'kxdfhei1' USING DFHEIV0,
 23956           PGM-NAME,
 23957           EMI-LINE1,
 23958           DFHEIV11,
 23959           DFHEIV99,
 23960           DFHEIV99,
 23961           DFHEIV99,
 23962           DFHEIV99
 23963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23964
 23965
 23966     IF PI-MAP-NAME = EL631B
 23967        MOVE -1                  TO BMAINTL
 23968       ELSE
 23969        MOVE -1                  TO CMAINTL.
 23970
 23971     IF EIBTRNID NOT = TRANS-EXB1
 23972        GO TO 8100-SEND-INITIAL-MAP
 23973       ELSE
 23974        GO TO 8200-SEND-DATAONLY.
 23975
 23976 9995-SECURITY-VIOLATION.
 23977*                            COPY ELCSCTP.
 23978******************************************************************
 23979*                                                                *
 23980*                            ELCSCTP                             *
 23981*                            VMOD=2.001                          *
 23982*                                                                *
 23983*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 23984******************************************************************
 23985
 23986
 23987     MOVE EIBDATE          TO SM-JUL-DATE.
 23988     MOVE EIBTRMID         TO SM-TERMID.
 23989     MOVE THIS-PGM         TO SM-PGM.
 23990     MOVE EIBTIME          TO TIME-IN.
 23991     MOVE TIME-OUT         TO SM-TIME.
 23992     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 23993
 23994
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 448
* EL6311.cbl
 23995* EXEC CICS LINK
 23996*         PROGRAM  ('EL003')
 23997*         COMMAREA (SECURITY-MESSAGE)
 23998*         LENGTH   (80)
 23999*    END-EXEC.
 24000     MOVE 'EL003' TO DFHEIV1
 24001     MOVE 80
 24002       TO DFHEIV11
 24003*    MOVE '."C                   (   #00020063' TO DFHEIV0
 24004     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24006     MOVE X'2020233030303230303633' TO DFHEIV0(25:11)
 24007     CALL 'kxdfhei1' USING DFHEIV0,
 24008           DFHEIV1,
 24009           SECURITY-MESSAGE,
 24010           DFHEIV11,
 24011           DFHEIV99,
 24012           DFHEIV99,
 24013           DFHEIV99,
 24014           DFHEIV99
 24015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24016
 24017
 24018******************************************************************
 24019
 24020
 24021 9999-DFHBACK SECTION.
 24022     MOVE '9%                    "   ' TO DFHEIV0
 24023     MOVE 'EL6311' TO DFHEIV1
 24024     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24025     GOBACK.
 24026 9999-DFHEXIT.
 24027     IF DFHEIGDJ EQUAL 0001
 24028         NEXT SENTENCE
 24029     ELSE IF DFHEIGDJ EQUAL 2
 24030         GO TO 9600-PGMID-ERROR,
 24031               9990-ABEND,
 24032               9990-ABEND,
 24033               0010-MAIN-LOGIC
 24034         DEPENDING ON DFHEIGDI
 24035     ELSE IF DFHEIGDJ EQUAL 3
 24036         GO TO 1280-BATCH-HDR-NOT-FOUND
 24037         DEPENDING ON DFHEIGDI
 24038     ELSE IF DFHEIGDJ EQUAL 4
 24039         GO TO 1290-DUPLICATE-ALT-INDEX
 24040         DEPENDING ON DFHEIGDI
 24041     ELSE IF DFHEIGDJ EQUAL 5
 24042         GO TO 1295-CERT-TRL-REC-NOTFND
 24043         DEPENDING ON DFHEIGDI
 24044     ELSE IF DFHEIGDJ EQUAL 6
 24045         GO TO 1380-BATCH-HDR-NOT-FOUND
 24046         DEPENDING ON DFHEIGDI
 24047     ELSE IF DFHEIGDJ EQUAL 7
 24048         GO TO 1385-REC-NOT-FOUND
 24049         DEPENDING ON DFHEIGDI
 24050     ELSE IF DFHEIGDJ EQUAL 8
 24051         GO TO 1386-NOTFND
 24052         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 449
* EL6311.cbl
 24053     ELSE IF DFHEIGDJ EQUAL 9
 24054         GO TO 1399-EXIT
 24055         DEPENDING ON DFHEIGDI
 24056     ELSE IF DFHEIGDJ EQUAL 10
 24057         GO TO 1480-BATCH-HDR-NOT-FOUND
 24058         DEPENDING ON DFHEIGDI
 24059     ELSE IF DFHEIGDJ EQUAL 11
 24060         GO TO 1490-RECORD-NOT-FOUND
 24061         DEPENDING ON DFHEIGDI
 24062     ELSE IF DFHEIGDJ EQUAL 12
 24063         GO TO 1405-DELETE-CERTIFICATE
 24064         DEPENDING ON DFHEIGDI
 24065     ELSE IF DFHEIGDJ EQUAL 13
 24066         GO TO 1420-CONTINUE-DELETE
 24067         DEPENDING ON DFHEIGDI
 24068     ELSE IF DFHEIGDJ EQUAL 14
 24069         GO TO 1406-DELETE-ERNOTE
 24070         DEPENDING ON DFHEIGDI
 24071     ELSE IF DFHEIGDJ EQUAL 15
 24072         GO TO 1407-DELETE-MAILING
 24073         DEPENDING ON DFHEIGDI
 24074     ELSE IF DFHEIGDJ EQUAL 16
 24075         GO TO 1420-CONTINUE-DELETE
 24076         DEPENDING ON DFHEIGDI
 24077     ELSE IF DFHEIGDJ EQUAL 17
 24078         GO TO 1480-BATCH-HDR-NOT-FOUND
 24079         DEPENDING ON DFHEIGDI
 24080     ELSE IF DFHEIGDJ EQUAL 18
 24081         GO TO 1475-DELETE-FINISHED
 24082         DEPENDING ON DFHEIGDI
 24083     ELSE IF DFHEIGDJ EQUAL 19
 24084         GO TO 2280-BATCH-HDR-NOT-FOUND
 24085         DEPENDING ON DFHEIGDI
 24086     ELSE IF DFHEIGDJ EQUAL 20
 24087         GO TO 2290-DUPLICATE-ALT-INDEX
 24088         DEPENDING ON DFHEIGDI
 24089     ELSE IF DFHEIGDJ EQUAL 21
 24090         GO TO 2380-BATCH-HDR-NOT-FOUND
 24091         DEPENDING ON DFHEIGDI
 24092     ELSE IF DFHEIGDJ EQUAL 22
 24093         GO TO 2385-REC-NOT-FOUND
 24094         DEPENDING ON DFHEIGDI
 24095     ELSE IF DFHEIGDJ EQUAL 23
 24096         GO TO 2380-BATCH-HDR-NOT-FOUND
 24097         DEPENDING ON DFHEIGDI
 24098     ELSE IF DFHEIGDJ EQUAL 24
 24099         GO TO 2485-BATCH-HDR-NOT-FOUND
 24100         DEPENDING ON DFHEIGDI
 24101     ELSE IF DFHEIGDJ EQUAL 25
 24102         GO TO 2490-RECORD-NOT-FOUND
 24103         DEPENDING ON DFHEIGDI
 24104     ELSE IF DFHEIGDJ EQUAL 26
 24105         GO TO 2475-CONTINUE-DELETE
 24106         DEPENDING ON DFHEIGDI
 24107     ELSE IF DFHEIGDJ EQUAL 27
 24108         GO TO 2485-BATCH-HDR-NOT-FOUND
 24109         DEPENDING ON DFHEIGDI
 24110     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 450
* EL6311.cbl
 24111         GO TO 2480-DELETE-FINISHED
 24112         DEPENDING ON DFHEIGDI
 24113     ELSE IF DFHEIGDJ EQUAL 29
 24114         GO TO 2820-PROCESS-REWRITE
 24115         DEPENDING ON DFHEIGDI
 24116     ELSE IF DFHEIGDJ EQUAL 30
 24117         GO TO 2885-RECORD-MISSING
 24118         DEPENDING ON DFHEIGDI
 24119     ELSE IF DFHEIGDJ EQUAL 31
 24120         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24121         DEPENDING ON DFHEIGDI
 24122     ELSE IF DFHEIGDJ EQUAL 32
 24123         GO TO 2827-DELETE-MAILING
 24124         DEPENDING ON DFHEIGDI
 24125     ELSE IF DFHEIGDJ EQUAL 33
 24126         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24127         DEPENDING ON DFHEIGDI
 24128     ELSE IF DFHEIGDJ EQUAL 34
 24129         GO TO 2920-PROCESS-REWRITE
 24130         DEPENDING ON DFHEIGDI
 24131     ELSE IF DFHEIGDJ EQUAL 35
 24132         GO TO 2985-RECORD-MISSING
 24133         DEPENDING ON DFHEIGDI
 24134     ELSE IF DFHEIGDJ EQUAL 36
 24135         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24136         DEPENDING ON DFHEIGDI
 24137     ELSE IF DFHEIGDJ EQUAL 37
 24138         GO TO 2990-DUPLICATE-RECORD
 24139         DEPENDING ON DFHEIGDI
 24140     ELSE IF DFHEIGDJ EQUAL 38
 24141         GO TO 3590-NOT-FOUND
 24142         DEPENDING ON DFHEIGDI
 24143     ELSE IF DFHEIGDJ EQUAL 39
 24144         GO TO 3690-NOT-FOUND
 24145         DEPENDING ON DFHEIGDI
 24146     ELSE IF DFHEIGDJ EQUAL 40
 24147         GO TO 3990-NOT-FOUND
 24148         DEPENDING ON DFHEIGDI
 24149     ELSE IF DFHEIGDJ EQUAL 41
 24150         GO TO 4050-END-RECORDS,
 24151               4050-END-RECORDS
 24152         DEPENDING ON DFHEIGDI
 24153     ELSE IF DFHEIGDJ EQUAL 42
 24154         GO TO 4150-END-BATCH
 24155         DEPENDING ON DFHEIGDI
 24156     ELSE IF DFHEIGDJ EQUAL 43
 24157         GO TO 4150-END-BATCH
 24158         DEPENDING ON DFHEIGDI
 24159     ELSE IF DFHEIGDJ EQUAL 44
 24160         GO TO 4250-END-RECORDS,
 24161               4250-END-RECORDS
 24162         DEPENDING ON DFHEIGDI
 24163     ELSE IF DFHEIGDJ EQUAL 45
 24164         GO TO 4350-END-BATCH,
 24165               4350-END-BATCH
 24166         DEPENDING ON DFHEIGDI
 24167     ELSE IF DFHEIGDJ EQUAL 46
 24168         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 11:58 Page 451
* EL6311.cbl
 24169               4550-END-RECORDS
 24170         DEPENDING ON DFHEIGDI
 24171     ELSE IF DFHEIGDJ EQUAL 47
 24172         GO TO 4680-NOT-FOUND,
 24173               4680-NOT-FOUND
 24174         DEPENDING ON DFHEIGDI
 24175     ELSE IF DFHEIGDJ EQUAL 48
 24176         GO TO 4860-NOT-FOUND,
 24177               4850-END-RECORDS
 24178         DEPENDING ON DFHEIGDI
 24179     ELSE IF DFHEIGDJ EQUAL 49
 24180         GO TO 4970-NOT-FOUND,
 24181               4950-END-RECORDS
 24182         DEPENDING ON DFHEIGDI
 24183     ELSE IF DFHEIGDJ EQUAL 50
 24184         GO TO 5050-NOT-FOUND
 24185         DEPENDING ON DFHEIGDI
 24186     ELSE IF DFHEIGDJ EQUAL 51
 24187         GO TO 5050-NOT-FOUND
 24188         DEPENDING ON DFHEIGDI
 24189     ELSE IF DFHEIGDJ EQUAL 52
 24190         GO TO 5050-NOT-FOUND
 24191         DEPENDING ON DFHEIGDI
 24192     ELSE IF DFHEIGDJ EQUAL 53
 24193         GO TO 5550-END-RECORDS,
 24194               5550-END-RECORDS
 24195         DEPENDING ON DFHEIGDI
 24196     ELSE IF DFHEIGDJ EQUAL 54
 24197         GO TO 6050-QID-ERROR
 24198         DEPENDING ON DFHEIGDI
 24199     ELSE IF DFHEIGDJ EQUAL 55
 24200         GO TO 6050-QID-ERROR
 24201         DEPENDING ON DFHEIGDI
 24202     ELSE IF DFHEIGDJ EQUAL 56
 24203         GO TO 6400-CONTINUE,
 24204               6400-CONTINUE
 24205         DEPENDING ON DFHEIGDI
 24206     ELSE IF DFHEIGDJ EQUAL 57
 24207         GO TO 3690-NOT-FOUND
 24208         DEPENDING ON DFHEIGDI
 24209     ELSE IF DFHEIGDJ EQUAL 58
 24210         GO TO 7399-EXIT
 24211         DEPENDING ON DFHEIGDI
 24212     ELSE IF DFHEIGDJ EQUAL 59
 24213         GO TO 7550-OFFICER-NOTFND
 24214         DEPENDING ON DFHEIGDI
 24215     ELSE IF DFHEIGDJ EQUAL 60
 24216         GO TO 8300-SEND-TEXT
 24217         DEPENDING ON DFHEIGDI.
 24218     MOVE '9%                    "   ' TO DFHEIV0
 24219     MOVE 'EL6311' TO DFHEIV1
 24220     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24221     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14728     Code:       96239
