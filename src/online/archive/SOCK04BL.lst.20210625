* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   1
* SOCK04BL.cbl
* Options: int("SOCK04BL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK04BL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK04BL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SOCK04BL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK04BL.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   2
* SOCK04BL.cbl
    14***                                                            ***
    15***  This program acts as a Socket Server and expects a key    ***
    16***  to read an account master and a compensation master and   ***
    17***  will pass back a few items. It currently is designed to   ***
    18***  work with the Agent Signature Verification process.       ***
    19***                                                            ***
    20***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 031115  CR               PEMA  NEW PROGRAM
    30* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    31* 092118  CR2018091700001  PEMA  ADD "HOME OFFICE" OPTION
    32*-----------------------------------------------------------------
    33 environment division.
    34 data division.
    35 working-storage section.
    36 01  DFH-START PIC X(04).
    37 77  WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    38 77  WS-COMP-ID                   PIC XXX VALUE 'CID'.
    39 77  WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    40 77  WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    41 77  WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    42 77  WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    43 77  WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    44 77  a1                           PIC S999 COMP-3 VALUE +0.
    45 77  c1                           PIC S999 COMP-3 VALUE +0.
    46 77  WS-BUILD-SW                  PIC X.
    47     88  TIME-TO-BUILD               VALUE 'Y'.
    48 77  WS-SAVE-ERACCT               PIC X(2000).
    49 77  WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    50 77  ws-bin-eff-dt                pic xx  value low-values.
    51 77  ws-bin-1st-pay-dt            pic xx  value low-values.
    52 77  WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    53 77  ws-disp-rate                 pic z9.99999.
    54 77  WS-ERACCT-SW                PIC X VALUE ' '.
    55     88  END-OF-ERACCT                 VALUE 'Y'.
    56 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    57     88  END-OF-ERCTBL                 VALUE 'Y'.
    58 77  WS-STATUS                   PIC X.
    59 77  ws-bin-cert-eff-dt          pic xx   value low-values.
    60 77  ws-current-bin-dt           pic xx   value low-values.
    61 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    62 77  note-count                  pic s999 comp-3 value +0.
    63 77  ws-build-note-sw            pic x value ' '.
    64     88  finished-with-notes      value 'Y'.
    65 77  ws-ercnot-sw                pic x  value spaces.
    66     88  ercnot-startbr            value 'Y'.
    67 01  ws-work-date.
    68     05  ws-work-ccyy            pic x(4).
    69     05  ws-work-mm              pic xx.
    70     05  ws-work-dd              pic xx.
    71 01  ws-work-date-num redefines ws-work-date
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   3
* SOCK04BL.cbl
    72                                 pic 9(8).
    73 01  cert-note-records-holder.
    74     05  cert-note-record occurs 300.
    75         10  filler              pic x(48).
    76         10  cnr-rest            pic x(102).
    77 01  WS-AM-KEY.
    78     05  WS-AM-COMPANY-CD        PIC X.
    79     05  WS-AM-CARRIER           PIC X.
    80     05  WS-AM-GROUP             PIC X(6).
    81     05  WS-AM-STATE             PIC XX.
    82     05  WS-AM-ACCOUNT           PIC X(10).
    83     05  WS-AM-EXP-DT            PIC XX.
    84     05  FILLER                  PIC X(4).
    85 01  WS-CO-KEY.
    86     05  WS-CO-COMPANY-CD        PIC X.
    87     05  WS-CO-CARRIER           PIC X.
    88     05  WS-CO-GROUP             PIC X(6).
    89     05  WS-CO-FIN-RESP          PIC X(10).
    90     05  WS-CO-ACCOUNT           PIC X(10).
    91     05  WS-CO-TYPE              PIC X.
    92 01  WS-CM-KEY.
    93     05  WS-CM-COMPANY-CD        PIC X.
    94     05  WS-CM-CARRIER           PIC X.
    95     05  WS-CM-GROUP             PIC X(6).
    96     05  WS-CM-STATE             PIC XX.
    97     05  WS-CM-ACCOUNT           PIC X(10).
    98     05  WS-CM-EFF-DT            PIC XX.
    99     05  WS-CM-CERT-NO           PIC X(11).
   100 01  WS-CZ-KEY.
   101     05  WS-CZ-COMPANY-CD        PIC X.
   102     05  WS-CZ-CARRIER           PIC X.
   103     05  WS-CZ-GROUP             PIC X(6).
   104     05  WS-CZ-STATE             PIC XX.
   105     05  WS-CZ-ACCOUNT           PIC X(10).
   106     05  WS-CZ-EFF-DT            PIC XX.
   107     05  WS-CZ-CERT-NO           PIC X(11).
   108     05  WS-CZ-REC-TYPE          PIC X.
   109     05  ws-cz-note-seq          pic s9(4) comp.
   110 01  WS-CS-KEY.
   111     05  WS-CS-COMPANY-CD        PIC X.
   112     05  WS-CS-CARRIER           PIC X.
   113     05  WS-CS-GROUP             PIC X(6).
   114     05  WS-CS-STATE             PIC XX.
   115     05  WS-CS-ACCOUNT           PIC X(10).
   116     05  WS-CS-EFF-DT            PIC XX.
   117     05  WS-CS-CERT-NO           PIC X(11).
   118     05  WS-CS-TRLR-TYPE         PIC X.
   119 01  ws-return-stuff.
   120     05  ws-am-name              pic x(30).
   121     05  ws-am-person            pic x(30).
   122     05  ws-am-control-name      pic x(30).
   123     05  ws-am-phone             pic x(10).
   124     05  ws-co-fax               pic x(10).
   125     05  ws-co-contact           pic x(30).
   126 01  WS-CID-NO                   PIC X(8).
   127 01  WS-DISP-RESP                PIC 9(5).
   128 01  WS-RESPONSE                 PIC S9(8)   COMP.
   129     88  RESP-NORMAL                  VALUE +00.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   4
* SOCK04BL.cbl
   130     88  RESP-NOTFND                  VALUE +13.
   131     88  RESP-NOTOPEN                 VALUE +19.
   132     88  RESP-ENDFILE                 VALUE +20.
   133*                                 COPY ELCCERT.
   134******************************************************************
   135*                                                                *
   136*                            ELCCERT.                            *
   137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   138*                            VMOD=2.013                          *
   139*                                                                *
   140*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   141*                                                                *
   142*   FILE TYPE = VSAM,KSDS                                        *
   143*   RECORD SIZE = 450  RECFORM = FIXED                           *
   144*                                                                *
   145*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   146*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   147*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   148*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   149*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   150*                                                                *
   151*   LOG = YES                                                    *
   152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   153******************************************************************
   154*                   C H A N G E   L O G
   155*
   156* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   157*-----------------------------------------------------------------
   158*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   159* EFFECTIVE    NUMBER
   160*-----------------------------------------------------------------
   161* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   162* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   163* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   164* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   165* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   166* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   167* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   168* 032612  CR2011110200001  PEMA  AHL CHANGES
   169* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   170* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   171* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   172******************************************************************
   173
   174 01  CERTIFICATE-MASTER.
   175     12  CM-RECORD-ID                      PIC XX.
   176         88  VALID-CM-ID                      VALUE 'CM'.
   177
   178     12  CM-CONTROL-PRIMARY.
   179         16  CM-COMPANY-CD                 PIC X.
   180         16  CM-CARRIER                    PIC X.
   181         16  CM-GROUPING.
   182             20  CM-GROUPING-PREFIX        PIC X(3).
   183             20  CM-GROUPING-PRIME         PIC X(3).
   184         16  CM-STATE                      PIC XX.
   185         16  CM-ACCOUNT.
   186             20  CM-ACCOUNT-PREFIX         PIC X(4).
   187             20  CM-ACCOUNT-PRIME          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   5
* SOCK04BL.cbl
   188         16  CM-CERT-EFF-DT                PIC XX.
   189         16  CM-CERT-NO.
   190             20  CM-CERT-PRIME             PIC X(10).
   191             20  CM-CERT-SFX               PIC X.
   192
   193     12  CM-CONTROL-BY-NAME.
   194         16  CM-COMPANY-CD-A1              PIC X.
   195         16  CM-INSURED-LAST-NAME          PIC X(15).
   196         16  CM-INSURED-INITIALS.
   197             20  CM-INSURED-INITIAL1       PIC X.
   198             20  CM-INSURED-INITIAL2       PIC X.
   199
   200     12  CM-CONTROL-BY-SSN.
   201         16  CM-COMPANY-CD-A2              PIC X.
   202         16  CM-SOC-SEC-NO.
   203             20  CM-SSN-STATE              PIC XX.
   204             20  CM-SSN-ACCOUNT            PIC X(6).
   205             20  CM-SSN-LN3.
   206                 25  CM-INSURED-INITIALS-A2.
   207                     30 CM-INSURED-INITIAL1-A2   PIC X.
   208                     30 CM-INSURED-INITIAL2-A2   PIC X.
   209                 25 CM-PART-LAST-NAME-A2         PIC X.
   210
   211     12  CM-CONTROL-BY-CERT-NO.
   212         16  CM-COMPANY-CD-A4              PIC X.
   213         16  CM-CERT-NO-A4                 PIC X(11).
   214
   215     12  CM-CONTROL-BY-MEMB.
   216         16  CM-COMPANY-CD-A5              PIC X.
   217         16  CM-MEMBER-NO.
   218             20  CM-MEMB-STATE             PIC XX.
   219             20  CM-MEMB-ACCOUNT           PIC X(6).
   220             20  CM-MEMB-LN4.
   221                 25  CM-INSURED-INITIALS-A5.
   222                     30 CM-INSURED-INITIAL1-A5   PIC X.
   223                     30 CM-INSURED-INITIAL2-A5   PIC X.
   224                 25 CM-PART-LAST-NAME-A5         PIC XX.
   225
   226     12  CM-INSURED-PROFILE-DATA.
   227         16  CM-INSURED-FIRST-NAME.
   228             20  CM-INSURED-1ST-INIT       PIC X.
   229             20  FILLER                    PIC X(9).
   230         16  CM-INSURED-ISSUE-AGE          PIC 99.
   231         16  CM-INSURED-SEX                PIC X.
   232             88  CM-SEX-MALE                  VALUE 'M'.
   233             88  CM-SEX-FEMAL                 VALUE 'F'.
   234         16  CM-INSURED-JOINT-AGE          PIC 99.
   235         16  CM-JOINT-INSURED-NAME.
   236             20  CM-JT-LAST-NAME           PIC X(15).
   237             20  CM-JT-FIRST-NAME.
   238                 24  CM-JT-1ST-INIT        PIC X.
   239                 24  FILLER                PIC X(9).
   240             20  CM-JT-INITIAL             PIC X.
   241
   242     12  CM-LIFE-DATA.
   243         16  CM-LF-BENEFIT-CD              PIC XX.
   244         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   245         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   6
* SOCK04BL.cbl
   246         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   247         16  CM-LF-DEV-CODE                PIC XXX.
   248         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   249         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   250         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   251         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   252         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   253         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   254         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   255         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   256         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   257         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   258         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   259         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   260         16  cm-temp-epiq                  pic xx.
   261             88  EPIQ-CLASS                  value 'EQ'.
   262*        16  FILLER                        PIC XX.
   263
   264     12  CM-AH-DATA.
   265         16  CM-AH-BENEFIT-CD              PIC XX.
   266         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   267         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   268         16  CM-AH-DEV-CODE                PIC XXX.
   269         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   270         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   271         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   272         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   273         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   274         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   275         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   276         16  CM-AH-PAID-THRU-DT            PIC XX.
   277             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   278         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   279         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   280         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   281         16  FILLER                        PIC X.
   282
   283     12  CM-LOAN-INFORMATION.
   284         16  CM-LIVES                      PIC S9(7)     COMP-3.
   285         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   286                                           PIC S9(5)V99  COMP-3.
   287         16  CM-BILLED                     PIC S9(7)     COMP-3.
   288         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   289         16  CM-PAY-FREQUENCY              PIC S99.
   290         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   291         16  CM-RATE-CLASS                 PIC XX.
   292         16  CM-BENEFICIARY                PIC X(25).
   293         16  CM-POLICY-FORM-NO             PIC X(12).
   294         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   295         16  CM-LAST-ADD-ON-DT             PIC XX.
   296         16  CM-DEDUCTIBLE-AMOUNTS.
   297             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   298             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   299         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   300             20  CM-RESIDENT-STATE         PIC XX.
   301             20  CM-RATE-CODE              PIC X(4).
   302             20  FILLER                    PIC XX.
   303         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   7
* SOCK04BL.cbl
   304             20  CM-LOAN-OFFICER           PIC X(5).
   305             20  FILLER                    PIC XXX.
   306         16  CM-CSR-CODE                   PIC XXX.
   307         16  CM-UNDERWRITING-CODE          PIC X.
   308             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   309         16  CM-POST-CARD-IND              PIC X.
   310         16  CM-REF-INTERFACE-SW           PIC X.
   311         16  CM-PREMIUM-TYPE               PIC X.
   312             88  CM-SING-PRM                  VALUE '1'.
   313             88  CM-O-B-COVERAGE              VALUE '2'.
   314             88  CM-OPEN-END                  VALUE '3'.
   315         16  CM-IND-GRP-TYPE               PIC X.
   316             88  CM-INDIVIDUAL                VALUE 'I'.
   317             88  CM-GROUP                     VALUE 'G'.
   318         16  CM-SKIP-CODE                  PIC X.
   319             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   320             88  SKIP-JULY                    VALUE '1'.
   321             88  SKIP-AUGUST                  VALUE '2'.
   322             88  SKIP-SEPTEMBER               VALUE '3'.
   323             88  SKIP-JULY-AUG                VALUE '4'.
   324             88  SKIP-AUG-SEPT                VALUE '5'.
   325             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   326             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   327             88  SKIP-JUNE                    VALUE '8'.
   328             88  SKIP-JUNE-JULY               VALUE '9'.
   329             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   330             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   331         16  CM-PAYMENT-MODE               PIC X.
   332             88  PAY-MONTHLY                  VALUE SPACE.
   333             88  PAY-WEEKLY                   VALUE '1'.
   334             88  PAY-SEMI-MONTHLY             VALUE '2'.
   335             88  PAY-BI-WEEKLY                VALUE '3'.
   336             88  PAY-SEMI-ANUALLY             VALUE '4'.
   337         16  CM-LOAN-NUMBER                PIC X(8).
   338         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   339         16  CM-OLD-LOF                    PIC XXX.
   340*        16  CM-LOAN-OFFICER               PIC XXX.
   341         16  CM-REIN-TABLE                 PIC XXX.
   342         16  CM-SPECIAL-REIN-CODE          PIC X.
   343         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   344         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   345         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   346
   347     12  CM-STATUS-DATA.
   348         16  CM-ENTRY-STATUS               PIC X.
   349         16  CM-ENTRY-DT                   PIC XX.
   350
   351         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   352         16  CM-LF-CANCEL-DT               PIC XX.
   353         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   354
   355         16  CM-LF-STATUS-AT-DEATH         PIC X.
   356         16  CM-LF-DEATH-DT                PIC XX.
   357         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   358
   359         16  CM-LF-CURRENT-STATUS          PIC X.
   360             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   361                                                'M' '4' '5' '9'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   8
* SOCK04BL.cbl
   362             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   363             88  CM-LF-POLICY-PENDING         VALUE '2'.
   364             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   365             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   366             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   367             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   368             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   369             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   370             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   371             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   372             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   373             88  CM-LF-DECLINED               VALUE 'D'.
   374             88  CM-LF-VOIDED                 VALUE 'V'.
   375
   376         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   377         16  CM-AH-CANCEL-DT               PIC XX.
   378         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   379
   380         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   381         16  CM-AH-SETTLEMENT-DT           PIC XX.
   382         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   383
   384         16  CM-AH-CURRENT-STATUS          PIC X.
   385             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   386                                                'M' '4' '5' '9'.
   387             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   388             88  CM-AH-POLICY-PENDING         VALUE '2'.
   389             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   390             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   391             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   392             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   393             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   394             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   395             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   396             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   397             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   398             88  CM-AH-DECLINED               VALUE 'D'.
   399             88  CM-AH-VOIDED                 VALUE 'V'.
   400
   401         16  CM-CLAIM-INTERFACE-SW         PIC X.
   402             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   403             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   404             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   405         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   406
   407         16  CM-ENTRY-BATCH                PIC X(6).
   408         16  CM-LF-EXIT-BATCH              PIC X(6).
   409         16  CM-AH-EXIT-BATCH              PIC X(6).
   410         16  CM-LAST-MONTH-END             PIC XX.
   411
   412     12  CM-NOTE-SW                        PIC X.
   413         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   414         88  CERT-NOTES-PRESENT               VALUE '1'.
   415         88  BILLING-NOTES-PRESENT            VALUE '2'.
   416         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   417         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   418         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   419         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page   9
* SOCK04BL.cbl
   420         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   421     12  CM-COMP-EXCP-SW                   PIC X.
   422         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   423         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   424     12  CM-INSURED-ADDRESS-SW             PIC X.
   425         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   426         88  INSURED-ADDR-PRESENT             VALUE '1'.
   427
   428*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   429     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   430     12  FILLER                            PIC X.
   431
   432*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   433     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   434     12  FILLER                            PIC X.
   435*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   436     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   437
   438     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   439         88  CERT-ADDED-BATCH                 VALUE ' '.
   440         88  CERT-ADDED-ONLINE                VALUE '1'.
   441         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   442         88  CERT-PURGED-OFFLINE              VALUE '3'.
   443         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   444     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   445         88  CERT-AS-LOADED                   VALUE ' '.
   446         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   447         88  CERT-CLAIM-ONLINE                VALUE '2'.
   448         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   449         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   450         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   451         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   452         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   453
   454     12  CM-ACCOUNT-COMM-PCTS.
   455         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   456         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   457
   458     12  CM-USER-FIELD                     PIC X.
   459     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   460     12  CM-CLP-STATE                      PIC XX.
   461     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   462     12  CM-USER-RESERVED                  PIC XXX.
   463     12  FILLER REDEFINES CM-USER-RESERVED.
   464         16  CM-AH-CLASS-CD                PIC XX.
   465         16  F                             PIC X.
   466******************************************************************
   467*                                 COPY ELCCRTT.
   468******************************************************************
   469*                                                                *
   470*                            ELCCRTT.                            *
   471*                                                                *
   472*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
   473*                                                                *
   474*   FILE TYPE = VSAM,KSDS                                        *
   475*   RECORD SIZE = 552  RECFORM = FIXED                           *
   476*                                                                *
   477*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  10
* SOCK04BL.cbl
   478*                                                                *
   479*   LOG = YES                                                    *
   480*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   481******************************************************************
   482*                   C H A N G E   L O G
   483*
   484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   485*-----------------------------------------------------------------
   486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   487* EFFECTIVE    NUMBER
   488*-----------------------------------------------------------------
   489* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
   490* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
   491* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   492* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   493* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   494* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   495* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   496* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
   497* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   498* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   499* 091318  CR2018073000001  PEMA  ADD Refund methods
   500* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   501******************************************************************
   502
   503 01  CERTIFICATE-TRAILERS.
   504     12  CS-RECORD-ID                      PIC XX.
   505         88  VALID-CS-ID                      VALUE 'CS'.
   506
   507     12  CS-CONTROL-PRIMARY.
   508         16  CS-COMPANY-CD                 PIC X.
   509         16  CS-CARRIER                    PIC X.
   510         16  CS-GROUPING                   PIC X(6).
   511         16  CS-STATE                      PIC XX.
   512         16  CS-ACCOUNT                    PIC X(10).
   513         16  CS-CERT-EFF-DT                PIC XX.
   514         16  CS-CERT-NO.
   515             20  CS-CERT-PRIME             PIC X(10).
   516             20  CS-CERT-SFX               PIC X.
   517         16  CS-TRAILER-TYPE               PIC X.
   518             88  COMM-TRLR           VALUE 'A'.
   519             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
   520             88  CERT-DATA-TRLR      VALUE 'C'.
   521
   522     12  CS-DATA-AREA                      PIC X(516).
   523
   524     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
   525         16  CS-BANK-COMMISSION-AREA.
   526             20  CS-BANK-COMMS       OCCURS 10.
   527                 24  CS-AGT                PIC X(10).
   528                 24  CS-COM-TYP            PIC X.
   529                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
   530                 24  CS-RECALC-LV-INDIC    PIC X.
   531                 24  FILLER                PIC X(10).
   532         16  FILLER                        PIC X(256).
   533
   534     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
   535****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  11
* SOCK04BL.cbl
   536         16  CS-MB-CLAIM-DATA OCCURS 24.
   537             20  CS-CLAIM-NO               PIC X(7).
   538             20  CS-CLAIM-TYPE             PIC X.
   539                 88  CS-AH-CLM               VALUE 'A'.
   540                 88  CS-IU-CLM               VALUE 'I'.
   541                 88  CS-GP-CLM               VALUE 'G'.
   542                 88  CS-LF-CLM               VALUE 'L'.
   543                 88  CS-PR-CLM               VALUE 'P'.
   544                 88  CS-FL-CLM               VALUE 'F'.
   545                 88  CS-OT-CLM               VALUE 'O'.
   546             20  CS-INSURED-TYPE           PIC X.
   547                 88  CS-PRIM-INSURED          VALUE 'P'.
   548                 88  CS-CO-BORROWER           VALUE 'C'.
   549             20  CS-BENEFIT-PERIOD         PIC 99.
   550             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
   551             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
   552             20  CS-REMAINING-BENS         PIC S999 COMP-3.
   553         16  FILLER                        PIC X(12).
   554     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
   555         16  CS-VIN-NUMBER                 PIC X(17).
   556         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
   557         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
   558         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
   559         16  cs-agent-name.
   560             20  cs-agent-fname            pic x(20).
   561             20  cs-agent-mi               pic x.
   562             20  cs-agent-lname            pic x(25).
   563         16  cs-license-no                 pic x(15).
   564         16  cs-npn-number                 pic x(10).
   565         16  cs-agent-edit-status          pic x.
   566             88  cs-ae-refer-to-manager      value 'M'.
   567             88  cs-ae-cover-sheet           value 'C'.
   568             88  cs-ae-sig-form              value 'S'.
   569             88  cs-ae-verified              value 'V'.
   570             88  cs-unidentified-signature   value 'U'.
   571             88  cs-cert-returned            value 'R'.
   572             88  cs-accept-no-commission     value 'N'.
   573         16  cs-year                       pic 9999.
   574         16  cs-make                       pic x(20).
   575         16  cs-model                      pic x(20).
   576         16  cs-future                     pic x(20).
   577         16  cs-vehicle-odometer           pic s9(7) comp-3.
   578         16  cs-claim-verification-status  pic x.
   579             88  cs-clm-ver-eligible         value 'A'.
   580             88  cs-clm-ver-partial-elig     value 'B'.
   581             88  cs-clm-ver-not-eligible     value 'C'.
   582             88  cs-clm-ver-not-elig-opn-clm value 'D'.
   583             88  cs-clm-ver-not-part-elig-rw value 'E'.
   584             88  cs-clm-ver-ND-CERT          value 'F'.
   585             88  cs-clm-ver-spec-other       value 'G'.
   586             88  cs-clam-ver-pratial-corrected
   587                                             value 'H'.
   588             88  cs-clm-ver-no-matches       value 'I'.
   589             88  cs-clm-ver-not-elig-corrected
   590                                             value 'J'.
   591             88  cs-clm-ver-needs-review     value 'R'.
   592             88  cs-clm-ver-sent-to-claims   value 'W'.
   593         16  CS-LF-REFUND-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  12
* SOCK04BL.cbl
   594         16  CS-AH-REFUND-METHOD           PIC X.
   595         16  FILLER                        PIC X(353). *> was 420
   596*        16  FILLER                        PIC X(496).
   597*                                 COPY ERCACCT.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ERCACCT                             *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.031                          *
   604*                                                                *
   605*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   606*                                                                *
   607*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   608*   VSAM ACCOUNT MASTER FILES.                                   *
   609*                                                                *
   610*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   611*                                                                *
   612*   FILE TYPE = VSAM,KSDS                                        *
   613*   RECORD SIZE = 2000  RECFORM = FIX                            *
   614*                                                                *
   615*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   616*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   617*                                                                *
   618*   LOG = NO                                                     *
   619*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   620*                                                                *
   621*                                                                *
   622******************************************************************
   623*                   C H A N G E   L O G
   624*
   625* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   626*-----------------------------------------------------------------
   627*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   628* EFFECTIVE    NUMBER
   629*-----------------------------------------------------------------
   630* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   631* 092705    2005050300006  PEMA  ADD SPP LEASES
   632* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   633* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   634* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   635* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   636* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   637* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   638******************************************************************
   639
   640 01  ACCOUNT-MASTER.
   641     12  AM-RECORD-ID                      PIC XX.
   642         88  VALID-AM-ID                      VALUE 'AM'.
   643
   644     12  AM-CONTROL-PRIMARY.
   645         16  AM-COMPANY-CD                 PIC X.
   646         16  AM-MSTR-CNTRL.
   647             20  AM-CONTROL-A.
   648                 24  AM-CARRIER            PIC X.
   649                 24  AM-GROUPING.
   650                     28 AM-GROUPING-PREFIX PIC XXX.
   651                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  13
* SOCK04BL.cbl
   652                 24  AM-STATE              PIC XX.
   653                 24  AM-ACCOUNT.
   654                     28  AM-ACCOUNT-PREFIX PIC X(4).
   655                     28  AM-ACCOUNT-PRIME  PIC X(6).
   656             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   657                                           PIC X(19).
   658             20  AM-CNTRL-B.
   659                 24  AM-EXPIRATION-DT      PIC XX.
   660                 24  FILLER                PIC X(4).
   661             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   662                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   663
   664     12  AM-CONTROL-BY-VAR-GRP.
   665         16  AM-COMPANY-CD-A1              PIC X.
   666         16  AM-VG-CARRIER                 PIC X.
   667         16  AM-VG-GROUPING                PIC X(6).
   668         16  AM-VG-STATE                   PIC XX.
   669         16  AM-VG-ACCOUNT                 PIC X(10).
   670         16  AM-VG-DATE.
   671             20  AM-VG-EXPIRATION-DT       PIC XX.
   672             20  FILLER                    PIC X(4).
   673         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   674                                           PIC 9(11)      COMP-3.
   675     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   676         16  FILLER                        PIC X(10).
   677         16  AM-VG-KEY3.
   678             20  AM-VG3-ACCOUNT            PIC X(10).
   679             20  AM-VG3-EXP-DT             PIC XX.
   680         16  FILLER                        PIC X(4).
   681     12  AM-MAINT-INFORMATION.
   682         16  AM-LAST-MAINT-DT              PIC XX.
   683         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   684         16  AM-LAST-MAINT-USER            PIC X(4).
   685         16  FILLER                        PIC XX.
   686
   687     12  AM-EFFECTIVE-DT                   PIC XX.
   688     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   689
   690     12  AM-PREV-DATES  COMP-3.
   691         16  AM-PREV-EXP-DT                PIC 9(11).
   692         16  AM-PREV-EFF-DT                PIC 9(11).
   693
   694     12  AM-REPORT-CODE-1                  PIC X(10).
   695     12  AM-REPORT-CODE-2                  PIC X(10).
   696
   697     12  AM-CITY-CODE                      PIC X(4).
   698     12  AM-COUNTY-PARISH                  PIC X(6).
   699
   700     12  AM-NAME                           PIC X(30).
   701     12  AM-PERSON                         PIC X(30).
   702     12  AM-ADDRS                          PIC X(30).
   703     12  AM-CITY.
   704         16  AM-ADDR-CITY                  PIC X(28).
   705         16  AM-ADDR-STATE                 PIC XX.
   706     12  AM-ZIP.
   707         16  AM-ZIP-PRIME.
   708             20  AM-ZIP-PRI-1ST            PIC X.
   709                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  14
* SOCK04BL.cbl
   710             20  FILLER                    PIC X(4).
   711         16  AM-ZIP-PLUS4                  PIC X(4).
   712     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   713         16  AM-CAN-POSTAL-1               PIC XXX.
   714         16  AM-CAN-POSTAL-2               PIC XXX.
   715         16  FILLER                        PIC XXX.
   716     12  AM-TEL-NO.
   717         16  AM-AREA-CODE                  PIC 999.
   718         16  AM-TEL-PRE                    PIC 999.
   719         16  AM-TEL-NBR                    PIC 9(4).
   720     12  AM-TEL-LOC                        PIC X.
   721         88  AM-TEL-AT-HOME                   VALUE 'H'.
   722         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   723
   724     12  AM-COMM-STRUCTURE.
   725         16  AM-DEFN-1.
   726             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   727                 24  AM-AGT.
   728                     28  AM-AGT-PREFIX     PIC X(4).
   729                     28  AM-AGT-PRIME      PIC X(6).
   730                 24  AM-COM-TYP            PIC X.
   731                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   732                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   733                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   734                 24  AM-RECALC-LV-INDIC    PIC X.
   735                 24  AM-RETRO-LV-INDIC     PIC X.
   736                 24  AM-GL-CODES           PIC X.
   737                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   738                 24  FILLER                PIC X(01).
   739         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   740             20  AM-COM-TBLS        OCCURS 10 TIMES.
   741                 24  FILLER                PIC X(11).
   742                 24  AM-L-COMA             PIC XXX.
   743                 24  AM-J-COMA             PIC XXX.
   744                 24  AM-A-COMA             PIC XXX.
   745                 24  FILLER                PIC X(6).
   746
   747     12  AM-COMM-CHANGE-STATUS             PIC X.
   748         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   749
   750     12  AM-CSR-CODE                       PIC X(4).
   751
   752     12  AM-BILLING-STATUS                 PIC X.
   753         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   754         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   755     12  AM-AUTO-REFUND-SW                 PIC X.
   756         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   757         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   758     12  AM-GPCD                           PIC 99.
   759     12  AM-IG                             PIC X.
   760         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   761         88  AM-HAS-GROUP                     VALUE '2'.
   762     12  AM-STATUS                         PIC X.
   763         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   764         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   765         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   766         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   767         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  15
* SOCK04BL.cbl
   768         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   769         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   770         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   771         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   772         88  AM-ACCOUNT-PENDING               VALUE '9'.
   773     12  AM-REMIT-TO                       PIC 99.
   774     12  AM-ID-NO                          PIC X(11).
   775
   776     12  AM-CAL-TABLE                      PIC XX.
   777     12  AM-LF-DEVIATION                   PIC XXX.
   778     12  AM-AH-DEVIATION                   PIC XXX.
   779     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   780     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   781     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   782     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   783     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   784     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   785
   786     12  AM-USER-FIELDS.
   787         16  AM-FLD-1                      PIC XX.
   788         16  AM-FLD-2                      PIC XX.
   789         16  AM-FLD-3                      PIC XX.
   790         16  AM-FLD-4                      PIC XX.
   791         16  AM-FLD-5                      PIC XX.
   792
   793     12  AM-1ST-PROD-DATE.
   794         16  AM-1ST-PROD-YR                PIC XX.
   795         16  AM-1ST-PROD-MO                PIC XX.
   796         16  AM-1ST-PROD-DA                PIC XX.
   797     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   798     12  AM-CERTS-PURGED-DATE.
   799         16  AM-PUR-YR                     PIC XX.
   800         16  AM-PUR-MO                     PIC XX.
   801         16  AM-PUR-DA                     PIC XX.
   802     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   803     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   804     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   805     12  AM-INACTIVE-DATE.
   806         16  AM-INA-MO                     PIC 99.
   807         16  AM-INA-DA                     PIC 99.
   808         16  AM-INA-YR                     PIC 99.
   809     12  AM-AR-HI-CERT-DATE                PIC XX.
   810
   811     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   812     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   813
   814     12  AM-OB-PAYMENT-MODE                PIC X.
   815         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   816         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   817         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   818         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   819
   820     12  AM-AH-ONLY-INDICATOR              PIC X.
   821         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   822         88  AM-NO-AH-ONLY                    VALUE 'N'.
   823
   824     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   825
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  16
* SOCK04BL.cbl
   826     12  AM-OVER-SHORT.
   827         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   828         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   829
   830     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   831     12  AM-DCC-CLP-STATE                  PIC XX.
   832
   833     12  AM-RECALC-COMM                    PIC X.
   834     12  AM-RECALC-REIN                    PIC X.
   835
   836     12  AM-REI-TABLE                      PIC XXX.
   837     12  AM-REI-ET-LF                      PIC X.
   838     12  AM-REI-ET-AH                      PIC X.
   839     12  AM-REI-PE-LF                      PIC X.
   840     12  AM-REI-PE-AH                      PIC X.
   841     12  AM-REI-PRT-ST                     PIC X.
   842     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   843     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   844     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   845     12  AM-REI-GROUP-A                    PIC X(6).
   846     12  AM-REI-MORT                       PIC X(4).
   847     12  AM-REI-PRT-OW                     PIC X.
   848     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   849     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   850     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   851     12  AM-REI-GROUP-B                    PIC X(6).
   852
   853     12  AM-TRUST-TYPE                     PIC X(2).
   854
   855     12  AM-EMPLOYER-STMT-USED             PIC X.
   856     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   857
   858     12  AM-STD-AH-TYPE                    PIC XX.
   859     12  AM-EARN-METHODS.
   860         16  AM-EARN-METHOD-R              PIC X.
   861             88 AM-REF-RL-R78                 VALUE 'R'.
   862             88 AM-REF-RL-PR                  VALUE 'P'.
   863             88 AM-REF-RL-MEAN                VALUE 'M'.
   864             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   865         16  AM-EARN-METHOD-L              PIC X.
   866             88 AM-REF-LL-R78                 VALUE 'R'.
   867             88 AM-REF-LL-PR                  VALUE 'P'.
   868             88 AM-REF-LL-MEAN                VALUE 'M'.
   869             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   870         16  AM-EARN-METHOD-A              PIC X.
   871             88 AM-REF-AH-R78                 VALUE 'R'.
   872             88 AM-REF-AH-PR                  VALUE 'P'.
   873             88 AM-REF-AH-MEAN                VALUE 'M'.
   874             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   875             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   876             88 AM-REF-AH-NET                 VALUE 'N'.
   877
   878     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   879     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   880     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   881
   882     12  AM-RET-Y-N                        PIC X.
   883     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  17
* SOCK04BL.cbl
   884     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   885     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   886     12  AM-RET-GRP                        PIC X(6).
   887     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   888         16  AM-POOL-PRIME                 PIC XXX.
   889         16  AM-POOL-SUB                   PIC XXX.
   890     12  AM-RETRO-EARNINGS.
   891         16  AM-RET-EARN-R                 PIC X.
   892         16  AM-RET-EARN-L                 PIC X.
   893         16  AM-RET-EARN-A                 PIC X.
   894     12  AM-RET-ST-TAX-USE                 PIC X.
   895         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   896         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   897     12  AM-RETRO-BEG-EARNINGS.
   898         16  AM-RET-BEG-EARN-R             PIC X.
   899         16  AM-RET-BEG-EARN-L             PIC X.
   900         16  AM-RET-BEG-EARN-A             PIC X.
   901     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   902     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   903
   904     12  AM-USER-SELECT-OPTIONS.
   905         16  AM-USER-SELECT-1              PIC X(10).
   906         16  AM-USER-SELECT-2              PIC X(10).
   907         16  AM-USER-SELECT-3              PIC X(10).
   908         16  AM-USER-SELECT-4              PIC X(10).
   909         16  AM-USER-SELECT-5              PIC X(10).
   910
   911     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   912
   913     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   914
   915     12  AM-RPT045A-SWITCH                 PIC X.
   916         88  RPT045A-OFF                   VALUE 'N'.
   917
   918     12  AM-INSURANCE-LIMITS.
   919         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   920         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   921
   922     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   923         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   924
   925     12  AM-DISMBR-COVERAGE-SW             PIC X.
   926         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   927         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   928
   929     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   930
   931     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   932     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   933     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   934     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   935     12  AM-DCC-UEF-STATE                  PIC XX.
   936     12  FILLER                            PIC XXX.
   937     12  AM-REPORT-CODE-3                  PIC X(10).
   938*    12  FILLER                            PIC X(22).
   939
   940     12  AM-RESERVE-DATE.
   941         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  18
* SOCK04BL.cbl
   942         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   943         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   944
   945     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   946     12  AM-NOTIFICATION-TYPES.
   947         16  AM-NOTIF-OF-LETTERS           PIC X.
   948         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   949         16  AM-NOTIF-OF-REPORTS           PIC X.
   950         16  AM-NOTIF-OF-STATUS            PIC X.
   951
   952     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   953         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   954         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   955         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   956         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   957
   958     12  AM-BENEFIT-CONTROLS.
   959         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   960             20  AM-BENEFIT-CODE           PIC XX.
   961             20  AM-BENEFIT-TYPE           PIC X.
   962             20  AM-BENEFIT-REVISION       PIC XXX.
   963             20  AM-BENEFIT-REM-TERM       PIC X.
   964             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   965             20  FILLER                    PIC XX.
   966         16  FILLER                        PIC X(80).
   967
   968     12  AM-TRANSFER-DATA.
   969         16  AM-TRANSFERRED-FROM.
   970             20  AM-TRNFROM-CARRIER        PIC X.
   971             20  AM-TRNFROM-GROUPING.
   972                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   973                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   974             20  AM-TRNFROM-STATE          PIC XX.
   975             20  AM-TRNFROM-ACCOUNT.
   976                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   977                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   978             20  AM-TRNFROM-DTE            PIC XX.
   979         16  AM-TRANSFERRED-TO.
   980             20  AM-TRNTO-CARRIER          PIC X.
   981             20  AM-TRNTO-GROUPING.
   982                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   983                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   984             20  AM-TRNTO-STATE            PIC XX.
   985             20  AM-TRNTO-ACCOUNT.
   986                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   987                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   988             20  AM-TRNTO-DTE              PIC XX.
   989         16  FILLER                        PIC X(10).
   990
   991     12  AM-SAVED-REMIT-TO                 PIC 99.
   992
   993     12  AM-COMM-STRUCTURE-SAVED.
   994         16  AM-DEFN-1-SAVED.
   995             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   996                 24  AM-AGT-SV             PIC X(10).
   997                 24  AM-COM-TYP-SV         PIC X.
   998                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   999                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  19
* SOCK04BL.cbl
  1000                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1001                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1002                 24  FILLER                PIC X.
  1003                 24  AM-GL-CODES-SV        PIC X.
  1004                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1005                 24  FILLER                PIC X.
  1006         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1007             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1008                 24  FILLER                PIC X(11).
  1009                 24  AM-L-COMA-SV          PIC XXX.
  1010                 24  AM-J-COMA-SV          PIC XXX.
  1011                 24  AM-A-COMA-SV          PIC XXX.
  1012                 24  FILLER                PIC X(6).
  1013
  1014     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1015         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1016            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1017            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1018            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1019
  1020     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1021     12  FILLER                            PIC X(120).
  1022
  1023     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1024         16  AM-CONTROL-NAME               PIC X(30).
  1025         16  AM-EXECUTIVE-ONE.
  1026             20  AM-EXEC1-NAME             PIC X(15).
  1027             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1028                                                          COMP-3.
  1029             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1030                                                          COMP-3.
  1031         16  AM-EXECUTIVE-TWO.
  1032             20  AM-EXEC2-NAME             PIC X(15).
  1033             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1034                                                          COMP-3.
  1035             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1036                                                          COMP-3.
  1037
  1038     12  AM-RETRO-ADDITIONAL-DATA.
  1039         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1040         16  AM-RETRO-PREM-P-E             PIC X.
  1041         16  AM-RETRO-CLMS-P-I             PIC X.
  1042         16  AM-RETRO-RET-BRACKET-LF.
  1043             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1044                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1045                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1046             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1047                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1048                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1049             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1050                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1051                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1052         16  AM-RETRO-RET-BRACKET-AH.
  1053             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1054                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1055                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1056                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1057             20  AM-RETRO-RET-BASIS-AH     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  20
* SOCK04BL.cbl
  1058                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1059                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1060             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1061                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1062                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1063
  1064     12  AM-COMMENTS.
  1065         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1066
  1067     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1068         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1069         16  AM-FLI-BILLING-CODE           PIC X.
  1070         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1071         16  AM-FLI-UNITED-IDENT           PIC X.
  1072         16  AM-FLI-INTEREST-LOST-DATA.
  1073             20  AM-FLI-BANK-NO            PIC X(5).
  1074             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1075             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1076             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1077         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1078             20  AM-FLI-AGT                PIC X(9).
  1079             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1080             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1081         16  FILLER                        PIC X(102).
  1082
  1083     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1084         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1085             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1086             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1087             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1088             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1089             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1090         16  FILLER                          PIC X(10).
  1091******************************************************************
  1092*                                 COPY ERCCOMP.
  1093******************************************************************
  1094*                                                                *
  1095*                                                                *
  1096*                            ERCCOMP                             *
  1097*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1098*                            VMOD=2.019                          *
  1099*                                                                *
  1100*   ONLINE CREDIT SYSTEM                                         *
  1101*                                                                *
  1102*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1103*                                                                *
  1104*   FILE TYPE = VSAM,KSDS                                        *
  1105*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1106*                                                                *
  1107*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1108*       ALTERNATE PATH = NONE                                    *
  1109*                                                                *
  1110*   LOG = NO                                                     *
  1111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1112*                                                                *
  1113******************************************************************
  1114*                   C H A N G E   L O G
  1115*
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  21
* SOCK04BL.cbl
  1116* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1117*-----------------------------------------------------------------
  1118*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1119* EFFECTIVE    NUMBER
  1120*-----------------------------------------------------------------
  1121* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1122* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1123* 092205    2005050300006  PEMA  ADD LEASE FEE
  1124* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1125* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1126* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1127* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1128* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1129* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1130******************************************************************
  1131
  1132 01  COMPENSATION-MASTER.
  1133     12  CO-RECORD-ID                          PIC XX.
  1134         88  VALID-CO-ID                          VALUE 'CO'.
  1135
  1136     12  CO-CONTROL-PRIMARY.
  1137         16  CO-COMPANY-CD                     PIC X.
  1138         16  CO-CONTROL.
  1139             20  CO-CTL-1.
  1140                 24  CO-CARR-GROUP.
  1141                     28  CO-CARRIER            PIC X.
  1142                     28  CO-GROUPING.
  1143                         32  CO-GROUP-PREFIX   PIC XXX.
  1144                         32  CO-GROUP-PRIME    PIC XXX.
  1145                 24  CO-RESP-NO.
  1146                     28  CO-RESP-PREFIX        PIC X(4).
  1147                     28  CO-RESP-PRIME         PIC X(6).
  1148             20  CO-CTL-2.
  1149                 24  CO-ACCOUNT.
  1150                     28  CO-ACCT-PREFIX        PIC X(4).
  1151                     28  CO-ACCT-PRIME         PIC X(6).
  1152         16  CO-TYPE                           PIC X.
  1153             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1154             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1155             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1156
  1157     12  CO-MAINT-INFORMATION.
  1158         16  CO-LAST-MAINT-DT                  PIC XX.
  1159         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1160         16  CO-LAST-MAINT-USER                PIC X(4).
  1161     12  FILLER                                PIC XX.
  1162     12  CO-STMT-TYPE                          PIC XXX.
  1163     12  CO-COMP-TYPE                          PIC X.
  1164         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1165     12  CO-STMT-OWNER                         PIC X(4).
  1166     12  CO-BALANCE-CONTROL                    PIC X.
  1167         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1168         88  CO-NO-BALANCE                        VALUE 'N'.
  1169
  1170     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1171         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1172         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1173         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  22
* SOCK04BL.cbl
  1174
  1175     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1176         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1177         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1178
  1179     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1180     12  CO-GA-DIRECT-DEP                      PIC X.
  1181     12  CO-FUTURE-SPACE                       PIC X.
  1182         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1183
  1184     12  CO-ACCT-NAME                          PIC X(30).
  1185     12  CO-MAIL-NAME                          PIC X(30).
  1186     12  CO-ADDR-1                             PIC X(30).
  1187     12  CO-ADDR-2                             PIC X(30).
  1188     12  CO-ADDR-3.
  1189         16  CO-ADDR-CITY                      PIC X(27).
  1190         16  CO-ADDR-STATE                     PIC XX.
  1191     12  CO-CSO-1099                           PIC X.
  1192     12  CO-ZIP.
  1193         16  CO-ZIP-PRIME.
  1194             20  CO-ZIP-PRI-1ST                PIC X.
  1195                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1196             20  FILLER                        PIC X(4).
  1197         16  CO-ZIP-PLUS4                      PIC X(4).
  1198     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1199         16  CO-CAN-POSTAL-1                   PIC XXX.
  1200         16  CO-CAN-POSTAL-2                   PIC XXX.
  1201         16  FILLER                            PIC XXX.
  1202     12  CO-SOC-SEC                            PIC X(13).
  1203     12  CO-TELEPHONE.
  1204         16  CO-AREA-CODE                      PIC XXX.
  1205         16  CO-PREFIX                         PIC XXX.
  1206         16  CO-PHONE                          PIC X(4).
  1207
  1208     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1209
  1210     12  CO-AR-BAL-LEVEL                       PIC X.
  1211         88  CO-AR-REF-LVL                        VALUE '1'.
  1212         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1213         88  CO-AR-BILL-LVL                       VALUE '2'.
  1214         88  CO-AR-AGT-LVL                        VALUE '3'.
  1215         88  CO-AR-FR-LVL                         VALUE '4'.
  1216
  1217     12  CO-AR-NORMAL-PRINT                    PIC X.
  1218         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1219         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1220
  1221     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1222
  1223     12  CO-AR-REPORTING                       PIC X.
  1224         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1225         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1226
  1227     12  CO-AR-PULL-CHECK                      PIC X.
  1228         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1229         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1230
  1231     12  CO-AR-BALANCE-PRINT                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  23
* SOCK04BL.cbl
  1232         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1233
  1234     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1235         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1236         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1237         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1238
  1239     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1240
  1241     12  CO-USER-CODE                          PIC X.
  1242     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1243
  1244******************************************************************
  1245*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1246*    THE LAST MONTH END RUN.
  1247******************************************************************
  1248
  1249     12  CO-LAST-ACTIVITY-DATE.
  1250         16  CO-ACT-YEAR                       PIC 99.
  1251         16  CO-ACT-MONTH                      PIC 99.
  1252         16  CO-ACT-DAY                        PIC 99.
  1253
  1254     12  CO-LAST-STMT-DT.
  1255         16  CO-LAST-STMT-YEAR                 PIC 99.
  1256         16  CO-LAST-STMT-MONTH                PIC 99.
  1257         16  CO-LAST-STMT-DAY                  PIC 99.
  1258
  1259     12  CO-MO-END-TOTALS.
  1260         16  CO-MONTHLY-TOTALS.
  1261             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1262             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1263             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1264             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1265             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1266
  1267         16  CO-AGING-TOTALS.
  1268             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1269             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1270             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1271             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1272
  1273         16  CO-YTD-TOTALS.
  1274             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1275             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1276
  1277         16  CO-OVER-UNDER-TOTALS.
  1278             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1279             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1280
  1281     12  CO-MISCELLANEOUS-TOTALS.
  1282         16  CO-FICA-TOTALS.
  1283             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1284             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1285
  1286         16  CO-CLAIM-TOTALS.
  1287             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1288             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  24
* SOCK04BL.cbl
  1290******************************************************************
  1291*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1292*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1293******************************************************************
  1294
  1295     12  CO-CURRENT-TOTALS.
  1296         16  CO-CURRENT-LAST-STMT-DT.
  1297             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1298             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1299             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1300
  1301         16  CO-CURRENT-MONTHLY-TOTALS.
  1302             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1303             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1304             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1305             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1306             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1307
  1308         16  CO-CURRENT-AGING-TOTALS.
  1309             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1310             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1311             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1312             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1313
  1314         16  CO-CURRENT-YTD-TOTALS.
  1315             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1316             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1317
  1318     12  CO-PAID-COMM-TOTALS.
  1319         16  CO-YTD-PAID-COMMS.
  1320             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1321             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1322
  1323     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1324         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1325         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1326
  1327     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1328         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1329         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1330         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1331         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1332         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1333         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1334         88  CO-FINAL-LETTER                  VALUE 'F'.
  1335         88  CO-RECONCILING                   VALUE 'R'.
  1336         88  CO-PHONE-CALL                    VALUE 'P'.
  1337         88  CO-LEGAL                         VALUE 'L'.
  1338         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1339         88  CO-WRITE-OFF                     VALUE 'W'.
  1340         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1341
  1342     12  CO-CSR-CODE                       PIC X(4).
  1343
  1344     12  CO-GA-STATUS-INFO.
  1345         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1346         16  CO-GA-TERMINATION-DT          PIC XX.
  1347         16  CO-GA-STATUS-CODE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  25
* SOCK04BL.cbl
  1348             88  CO-GA-ACTIVE                 VALUE 'A'.
  1349             88  CO-GA-INACTIVE               VALUE 'I'.
  1350             88  CO-GA-PENDING                VALUE 'P'.
  1351         16  CO-GA-COMMENTS.
  1352             20  CO-GA-COMMENT-1           PIC X(40).
  1353             20  CO-GA-COMMENT-2           PIC X(40).
  1354             20  CO-GA-COMMENT-3           PIC X(40).
  1355             20  CO-GA-COMMENT-4           PIC X(40).
  1356
  1357     12  CO-RPTCD2                         PIC X(10).
  1358     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1359         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1360         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1361
  1362     12  CO-TYPE-AGENT                     PIC X(01).
  1363         88  CO-CORPORATION                   VALUE 'C'.
  1364         88  CO-PARTNERSHIP                   VALUE 'P'.
  1365         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1366         88  CO-TRUST                         VALUE 'T'.
  1367         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1368
  1369     12  CO-FAXNO.
  1370         16  CO-FAX-AREA-CODE                  PIC XXX.
  1371         16  CO-FAX-PREFIX                     PIC XXX.
  1372         16  CO-FAX-PHONE                      PIC X(4).
  1373
  1374     12  CO-BANK-INFORMATION.
  1375         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1376         16  CO-BANK-TRANSIT-NON REDEFINES
  1377             CO-BANK-TRANSIT-NO                PIC 9(8).
  1378
  1379         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1380     12  CO-MISC-DEDUCT-INFO REDEFINES
  1381                  CO-BANK-INFORMATION.
  1382         16  CO-MD-GL-ACCT                     PIC X(10).
  1383         16  CO-MD-DIV                         PIC XX.
  1384         16  CO-MD-CENTER                      PIC X(4).
  1385         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1386         16  CO-CREATE-AP-CHECK                PIC X.
  1387         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1388         16  FILLER                            PIC XXX.
  1389     12  CO-ACH-STATUS                         PIC X.
  1390         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1391         88  CO-ACH-PENDING                        VALUE 'P'.
  1392
  1393     12  CO-BILL-SW                            PIC X.
  1394     12  CO-CONTROL-NAME                       PIC X(30).
  1395     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1396     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1397     12  CO-CLP-STATE                          PIC XX.
  1398     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1399     12  CO-SPP-REFUND-EDIT                    PIC X.
  1400
  1401******************************************************************
  1402*                                 COPY ERCCNOT.
  1403******************************************************************
  1404*                                                                *
  1405*                            ERCCNOT                             *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  26
* SOCK04BL.cbl
  1406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1407*                            VMOD=2.003                          *
  1408*                                                                *
  1409*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1410*                                                                *
  1411*        FILE TYPE= VSAM,KSDS                                    *
  1412*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1413*                                                                *
  1414*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1415*                                                                *
  1416*        LOG = YES                                               *
  1417*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1418*                                                                *
  1419******************************************************************
  1420*                   C H A N G E   L O G
  1421*
  1422* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1423*-----------------------------------------------------------------
  1424*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1425* EFFECTIVE    NUMBER
  1426*-----------------------------------------------------------------
  1427* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1428******************************************************************
  1429
  1430 01  CERT-NOTE-FILE.
  1431     12  CZ-RECORD-ID                PIC  XX.
  1432         88  VALID-CZ-ID                  VALUE 'CZ'.
  1433
  1434     12  CZ-CONTROL-PRIMARY.
  1435         16  CZ-COMPANY-CD           PIC X.
  1436         16  CZ-CARRIER              PIC X.
  1437         16  CZ-GROUPING.
  1438             20 CZ-GROUPING-PREFIX   PIC XXX.
  1439             20 CZ-GROUPING-PRIME    PIC XXX.
  1440         16  CZ-STATE                PIC XX.
  1441         16  CZ-ACCOUNT.
  1442             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1443             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1444         16  CZ-CERT-EFF-DT          PIC XX.
  1445         16  CZ-CERT-NO.
  1446             20  CZ-CERT-PRIME       PIC X(10).
  1447             20  CZ-CERT-SFX         PIC X.
  1448         16  CZ-RECORD-TYPE          PIC X.
  1449             88  CERT-NOTE           VALUE '1'.
  1450             88  CLAIM-CERT-NOTE     VALUE '2'.
  1451         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1452
  1453     12  CZ-LAST-MAINT-DT            PIC XX.
  1454     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1455     12  CZ-LAST-MAINT-USER          PIC X(4).
  1456
  1457     12  CZ-NOTE-INFORMATION.
  1458         16  CZ-NOTE                 PIC X(63).
  1459         16  FILLER                  PIC X(39).
  1460******************************************************************
  1461*                                 COPY ELCDATE.
  1462******************************************************************
  1463*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  27
* SOCK04BL.cbl
  1464*                                                                *
  1465*                            ELCDATE.                            *
  1466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1467*                            VMOD=2.003
  1468*                                                                *
  1469*                                                                *
  1470*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1471*                 LENGTH = 200                                   *
  1472******************************************************************
  1473
  1474 01  DATE-CONVERSION-DATA.
  1475     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1476     12  DC-OPTION-CODE                PIC X.
  1477         88  BIN-TO-GREG                VALUE ' '.
  1478         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1479         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1480         88  YMD-GREG-TO-BIN            VALUE '3'.
  1481         88  MDY-GREG-TO-BIN            VALUE '4'.
  1482         88  JULIAN-TO-BIN              VALUE '5'.
  1483         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1484         88  FIND-CENTURY               VALUE '7'.
  1485         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1486         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1487         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1488         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1489         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1490         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1491         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1492         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1493         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1494         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1495         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1496         88  BIN-3-TO-GREG              VALUE 'I'.
  1497         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1498         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1499         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1500         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1501         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1502         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1503         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1504         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1505         88  THREE-CHARACTER-BIN
  1506                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1507         88  GREGORIAN-TO-BIN
  1508                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1509         88  BIN-TO-GREGORIAN
  1510                  VALUES ' ' '1' 'I' '8' 'G'.
  1511         88  JULIAN-TO-BINARY
  1512                  VALUES '5' 'C' 'E' 'F'.
  1513     12  DC-ERROR-CODE                 PIC X.
  1514         88  NO-CONVERSION-ERROR        VALUE ' '.
  1515         88  DATE-CONVERSION-ERROR
  1516                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1517         88  DATE-IS-ZERO               VALUE '1'.
  1518         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1519         88  DATE-IS-INVALID            VALUE '3'.
  1520         88  DATE1-GREATER-DATE2        VALUE '4'.
  1521         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  28
* SOCK04BL.cbl
  1522         88  DATE-INVALID-OPTION        VALUE '9'.
  1523         88  INVALID-CENTURY            VALUE 'A'.
  1524         88  ONLY-CENTURY               VALUE 'B'.
  1525         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1526         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1527     12  DC-END-OF-MONTH               PIC X.
  1528         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1529     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1530         88  USE-NORMAL-PROCESS         VALUE ' '.
  1531         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1532         88  ADJUST-UP-100-YRS          VALUE '2'.
  1533     12  FILLER                        PIC X.
  1534     12  DC-CONVERSION-DATES.
  1535         16  DC-BIN-DATE-1             PIC XX.
  1536         16  DC-BIN-DATE-2             PIC XX.
  1537         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1538         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1539                       DC-GREG-DATE-1-EDIT.
  1540             20  DC-EDIT1-MONTH        PIC 99.
  1541             20  SLASH1-1              PIC X.
  1542             20  DC-EDIT1-DAY          PIC 99.
  1543             20  SLASH1-2              PIC X.
  1544             20  DC-EDIT1-YEAR         PIC 99.
  1545         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1546         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1547                     DC-GREG-DATE-2-EDIT.
  1548             20  DC-EDIT2-MONTH        PIC 99.
  1549             20  SLASH2-1              PIC X.
  1550             20  DC-EDIT2-DAY          PIC 99.
  1551             20  SLASH2-2              PIC X.
  1552             20  DC-EDIT2-YEAR         PIC 99.
  1553         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1554         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1555                     DC-GREG-DATE-1-YMD.
  1556             20  DC-YMD-YEAR           PIC 99.
  1557             20  DC-YMD-MONTH          PIC 99.
  1558             20  DC-YMD-DAY            PIC 99.
  1559         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1560         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1561                      DC-GREG-DATE-1-MDY.
  1562             20  DC-MDY-MONTH          PIC 99.
  1563             20  DC-MDY-DAY            PIC 99.
  1564             20  DC-MDY-YEAR           PIC 99.
  1565         16  DC-GREG-DATE-1-ALPHA.
  1566             20  DC-ALPHA-MONTH        PIC X(10).
  1567             20  DC-ALPHA-DAY          PIC 99.
  1568             20  FILLER                PIC XX.
  1569             20  DC-ALPHA-CENTURY.
  1570                 24 DC-ALPHA-CEN-N     PIC 99.
  1571             20  DC-ALPHA-YEAR         PIC 99.
  1572         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1573         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1574         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1575         16  DC-JULIAN-DATE            PIC 9(05).
  1576         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1577                                       PIC 9(05).
  1578         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1579             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  29
* SOCK04BL.cbl
  1580             20  DC-JULIAN-DAYS        PIC 999.
  1581         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1582         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1583         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1584     12  DATE-CONVERSION-VARIBLES.
  1585         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1586         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1587             20  FILLER                PIC 9(3).
  1588             20  HOLD-CEN-1-CCYY.
  1589                 24  HOLD-CEN-1-CC     PIC 99.
  1590                 24  HOLD-CEN-1-YY     PIC 99.
  1591             20  HOLD-CEN-1-MO         PIC 99.
  1592             20  HOLD-CEN-1-DA         PIC 99.
  1593         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1594             20  HOLD-CEN-1-R-MO       PIC 99.
  1595             20  HOLD-CEN-1-R-DA       PIC 99.
  1596             20  HOLD-CEN-1-R-CCYY.
  1597                 24  HOLD-CEN-1-R-CC   PIC 99.
  1598                 24  HOLD-CEN-1-R-YY   PIC 99.
  1599             20  FILLER                PIC 9(3).
  1600         16  HOLD-CENTURY-1-X.
  1601             20  FILLER                PIC X(3)  VALUE SPACES.
  1602             20  HOLD-CEN-1-X-CCYY.
  1603                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1604                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1605             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1606             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1607         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1608             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1609             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1610             20  HOLD-CEN-1-R-X-CCYY.
  1611                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1612                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1613             20  FILLER                PIC XXX.
  1614         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1615         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1616         16  DC-JULIAN-DATE-1          PIC 9(07).
  1617         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1618             20  DC-JULIAN-1-CCYY.
  1619                 24  DC-JULIAN-1-CC    PIC 99.
  1620                 24  DC-JULIAN-1-YR    PIC 99.
  1621             20  DC-JULIAN-DA-1        PIC 999.
  1622         16  DC-JULIAN-DATE-2          PIC 9(07).
  1623         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1624             20  DC-JULIAN-2-CCYY.
  1625                 24  DC-JULIAN-2-CC    PIC 99.
  1626                 24  DC-JULIAN-2-YR    PIC 99.
  1627             20  DC-JULIAN-DA-2        PIC 999.
  1628         16  DC-GREG-DATE-A-EDIT.
  1629             20  DC-EDITA-MONTH        PIC 99.
  1630             20  SLASHA-1              PIC X VALUE '/'.
  1631             20  DC-EDITA-DAY          PIC 99.
  1632             20  SLASHA-2              PIC X VALUE '/'.
  1633             20  DC-EDITA-CCYY.
  1634                 24  DC-EDITA-CENT     PIC 99.
  1635                 24  DC-EDITA-YEAR     PIC 99.
  1636         16  DC-GREG-DATE-B-EDIT.
  1637             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  30
* SOCK04BL.cbl
  1638             20  SLASHB-1              PIC X VALUE '/'.
  1639             20  DC-EDITB-DAY          PIC 99.
  1640             20  SLASHB-2              PIC X VALUE '/'.
  1641             20  DC-EDITB-CCYY.
  1642                 24  DC-EDITB-CENT     PIC 99.
  1643                 24  DC-EDITB-YEAR     PIC 99.
  1644         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1645         16  DC-GREG-DATE-CYMD-R REDEFINES
  1646                              DC-GREG-DATE-CYMD.
  1647             20  DC-CYMD-CEN           PIC 99.
  1648             20  DC-CYMD-YEAR          PIC 99.
  1649             20  DC-CYMD-MONTH         PIC 99.
  1650             20  DC-CYMD-DAY           PIC 99.
  1651         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1652         16  DC-GREG-DATE-MDCY-R REDEFINES
  1653                              DC-GREG-DATE-MDCY.
  1654             20  DC-MDCY-MONTH         PIC 99.
  1655             20  DC-MDCY-DAY           PIC 99.
  1656             20  DC-MDCY-CEN           PIC 99.
  1657             20  DC-MDCY-YEAR          PIC 99.
  1658    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1659        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1660    12  DC-EL310-DATE                  PIC X(21).
  1661    12  FILLER                         PIC X(28).
  1662****************************************************************
  1663*
  1664* Copyright (c) 2007-2013 Dell Inc.
  1665* All rights reserved.
  1666*
  1667****************************************************************
  1668 01  DFHEIV.
  1669   02  DFHEIV0               PIC X(35).
  1670   02  DFHEIV1               PIC X(08).
  1671   02  DFHEIV2               PIC X(08).
  1672   02  DFHEIV3               PIC X(08).
  1673   02  DFHEIV4               PIC X(06).
  1674   02  DFHEIV5               PIC X(04).
  1675   02  DFHEIV6               PIC X(04).
  1676   02  DFHEIV7               PIC X(02).
  1677   02  DFHEIV8               PIC X(02).
  1678   02  DFHEIV9               PIC X(01).
  1679   02  DFHEIV10              PIC S9(7) COMP-3.
  1680   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1681   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1682   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1683   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1684   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1685   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1686   02  DFHEIV17              PIC X(04).
  1687   02  DFHEIV18              PIC X(04).
  1688   02  DFHEIV19              PIC X(04).
  1689   02  DFHEIV20              USAGE IS POINTER.
  1690   02  DFHEIV21              USAGE IS POINTER.
  1691   02  DFHEIV22              USAGE IS POINTER.
  1692   02  DFHEIV23              USAGE IS POINTER.
  1693   02  DFHEIV24              USAGE IS POINTER.
  1694   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1695   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  31
* SOCK04BL.cbl
  1696   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1697   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1698   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1699   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1700   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1701   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1702   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1703   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1704   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1705   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1706   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1707   02  FILLER                PIC X(02).
  1708   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1709   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1710   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1711   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1712   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1713   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1714   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1715 LINKAGE  SECTION.
  1716*****************************************************************
  1717*                                                               *
  1718* Copyright (c) 2007-2013 Dell Inc.                             *
  1719* All rights reserved.                                          *
  1720*                                                               *
  1721*****************************************************************
  1722 01  dfheiblk.
  1723     02  eibtime          pic s9(7) comp-3.
  1724     02  eibdate          pic s9(7) comp-3.
  1725     02  eibtrnid         pic x(4).
  1726     02  eibtaskn         pic s9(7) comp-3.
  1727     02  eibtrmid         pic x(4).
  1728     02  dfheigdi         pic s9(4) comp.
  1729     02  eibcposn         pic s9(4) comp.
  1730     02  eibcalen         pic s9(4) comp.
  1731     02  eibaid           pic x(1).
  1732     02  eibfiller1       pic x(1).
  1733     02  eibfn            pic x(2).
  1734     02  eibfiller2       pic x(2).
  1735     02  eibrcode         pic x(6).
  1736     02  eibfiller3       pic x(2).
  1737     02  eibds            pic x(8).
  1738     02  eibreqid         pic x(8).
  1739     02  eibrsrce         pic x(8).
  1740     02  eibsync          pic x(1).
  1741     02  eibfree          pic x(1).
  1742     02  eibrecv          pic x(1).
  1743     02  eibsend          pic x(1).
  1744     02  eibatt           pic x(1).
  1745     02  eibeoc           pic x(1).
  1746     02  eibfmh           pic x(1).
  1747     02  eibcompl         pic x(1).
  1748     02  eibsig           pic x(1).
  1749     02  eibconf          pic x(1).
  1750     02  eiberr           pic x(1).
  1751     02  eibrldbk         pic x(1).
  1752     02  eiberrcd         pic x(4).
  1753     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  32
* SOCK04BL.cbl
  1754     02  eibnodat         pic x(1).
  1755     02  eibfiller5       pic x(2).
  1756     02  eibresp          pic s9(8) comp.
  1757     02  eibresp2         pic s9(8) comp.
  1758     02  dfheigdj         pic s9(4) comp.
  1759     02  dfheigdk         pic s9(4) comp.
  1760 01  DFHCOMMAREA.
  1761*                                copy SOCK04-COMMAREA.
  1762*****************************************************************
  1763*                                                               *
  1764* Copyright (c) 2015 by CSO.                                    *
  1765* All rights reserved.                                          *
  1766*                                                               *
  1767*****************************************************************
  1768****************************************
  1769*  commarea for SOCK04.cl2
  1770*  (business logic input & output)
  1771****************************************
  1772 03  socket-commarea.
  1773     05 sock-IN-DATA.
  1774         10  sock-CAR          PIC X.
  1775         10  sock-GRP          PIC X(6).
  1776         10  sock-ST           PIC XX.
  1777         10  sock-ACT          PIC X(10).
  1778         10  sock-EFF-DT       PIC X(8).
  1779         10  sock-cert-no      pic x(11).
  1780         10  sock-ID           PIC XXX.
  1781         10  sock-proc-id      pic x(4).
  1782         10  sock-ACTION-TAKEN PIC X.
  1783         10  FILLER              PIC X(9).
  1784     05  sock-return-area.
  1785         10  sock-am-name        pic x(30).
  1786         10  sock-am-person      pic x(30).
  1787         10  sock-am-cntrl-name  pic x(30).
  1788         10  sock-am-phone       pic x(10).
  1789         10  sock-co-fax         pic x(10).
  1790         10  sock-co-contact     pic x(30).
  1791 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1792 0000-DFHEXIT SECTION.
  1793     MOVE '9#                    $   ' TO DFHEIV0.
  1794     MOVE 'SOCK04BL' TO DFHEIV1.
  1795     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1796     display ' Begin SOCK04BL =' SOCK-IN-DATA '='
  1797     perform 0010-init           thru 0010-exit
  1798     perform 0100-process-request thru 0100-exit
  1799     GO TO cics-return
  1800     .
  1801 0010-init.
  1802
  1803* exec cics
  1804*       asktime
  1805*    end-exec
  1806*    MOVE '0"                    "   #00001798' TO DFHEIV0
  1807     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1808     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1809     MOVE X'2020233030303031373938' TO DFHEIV0(25:11)
  1810     CALL 'kxdfhei1' USING DFHEIV0,
  1811           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  33
* SOCK04BL.cbl
  1812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1813     display ' eibtime ' eibtime
  1814     display ' eibdate ' eibdate
  1815     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1816     MOVE '5'                    TO DC-OPTION-CODE
  1817     perform 9700-date-link      thru 9700-exit
  1818     IF DATE-CONVERSION-ERROR
  1819        display ' error converting eibdate '
  1820        MOVE LOW-VALUES          TO ws-current-bin-dt
  1821     ELSE
  1822        MOVE DC-BIN-DATE-1       TO ws-current-bin-dt
  1823     end-if
  1824     move sock-id                to ws-comp-id
  1825     evaluate true
  1826        when ws-comp-id = 'AHL'
  1827           MOVE X'06'            TO ws-comp-cd
  1828        when ws-comp-id = 'DCC'
  1829           move X'05'            to ws-comp-cd
  1830        when ws-comp-id = 'VPP'
  1831           move X'07'            to ws-comp-cd
  1832        when other
  1833           move X'04'            to ws-comp-cd
  1834     end-evaluate
  1835     move sock-eff-dt            to dc-greg-date-1-edit
  1836     move '2'                    to dc-option-code
  1837     perform 9700-date-link      thru 9700-exit
  1838     if not no-conversion-error
  1839        display ' error converting eff date '
  1840        go to cics-return
  1841     end-if
  1842     move dc-bin-date-1          to ws-bin-cert-eff-dt
  1843     .
  1844 0010-exit.
  1845     exit.
  1846 0100-process-request.
  1847     perform 0110-get-elcert     thru 0110-exit
  1848     if resp-normal
  1849        perform 0120-process-cert-trailer
  1850                                 thru 0120-exit
  1851        perform 0150-process-cert-notes
  1852                                 thru 0150-exit
  1853        perform 0200-process-acct-comp
  1854                                 thru 0200-exit
  1855     end-if
  1856     .
  1857 0100-exit.
  1858     exit.
  1859 0110-get-elcert.
  1860     move low-values             to ws-cm-key
  1861     move ws-comp-cd             to ws-cm-company-cd
  1862     move sock-car               to ws-cm-carrier
  1863     move sock-grp               to ws-cm-group
  1864     move sock-st                to ws-cm-state
  1865     move sock-act               to ws-cm-account
  1866     move ws-bin-cert-eff-dt     to ws-cm-eff-dt
  1867     move sock-cert-no           to ws-cm-cert-no
  1868
  1869* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  34
* SOCK04BL.cbl
  1870*         INTO    (CERTIFICATE-MASTER)
  1871*         DATASET ('ELCERT')
  1872*         RIDFLD  (WS-CM-KEY)
  1873*         RESP    (WS-RESPONSE)
  1874*    END-EXEC
  1875     MOVE LENGTH OF
  1876      CERTIFICATE-MASTER
  1877       TO DFHEIV11
  1878     MOVE 'ELCERT' TO DFHEIV1
  1879*    MOVE '&"IL       E          (  N#00001857' TO DFHEIV0
  1880     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1882     MOVE X'204E233030303031383537' TO DFHEIV0(25:11)
  1883     CALL 'kxdfhei1' USING DFHEIV0,
  1884           DFHEIV1,
  1885           CERTIFICATE-MASTER,
  1886           DFHEIV11,
  1887           WS-CM-KEY,
  1888           DFHEIV99,
  1889           DFHEIV99,
  1890           DFHEIV99
  1891     MOVE EIBRESP  TO WS-RESPONSE
  1892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1893     .
  1894 0110-exit.
  1895     exit.
  1896 0120-process-cert-trailer.
  1897     perform 0121-read-elcrtt    thru 0121-exit
  1898     evaluate true
  1899        when resp-normal
  1900           perform 0122-upd-elcrtt
  1901                                 thru 0122-exit
  1902        when resp-notfnd
  1903           perform 0123-add-elcrtt
  1904                                 thru 0123-exit
  1905        when other
  1906           display ' error cert trlr ' ws-response
  1907           go to cics-return
  1908     end-evaluate
  1909     .
  1910 0120-exit.
  1911     exit.
  1912 0121-read-elcrtt.
  1913     move cm-control-primary     to ws-cs-key
  1914     move 'C'                    to ws-cs-trlr-type
  1915
  1916* EXEC CICS READ
  1917*       UPDATE
  1918*       INTO    (CERTIFICATE-TRAILERS)
  1919*       DATASET ('ELCRTT')
  1920*       RIDFLD  (WS-CS-KEY)
  1921*       RESP    (WS-RESPONSE)
  1922*    END-EXEC
  1923     MOVE LENGTH OF
  1924      CERTIFICATE-TRAILERS
  1925       TO DFHEIV11
  1926     MOVE 'ELCRTT' TO DFHEIV1
  1927*    MOVE '&"IL       EU         (  N#00001887' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  35
* SOCK04BL.cbl
  1928     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1929     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1930     MOVE X'204E233030303031383837' TO DFHEIV0(25:11)
  1931     CALL 'kxdfhei1' USING DFHEIV0,
  1932           DFHEIV1,
  1933           CERTIFICATE-TRAILERS,
  1934           DFHEIV11,
  1935           WS-CS-KEY,
  1936           DFHEIV99,
  1937           DFHEIV99,
  1938           DFHEIV99
  1939     MOVE EIBRESP  TO WS-RESPONSE
  1940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1941     .
  1942 0121-exit.
  1943     exit.
  1944 0122-upd-elcrtt.
  1945     move sock-action-taken      to cs-agent-edit-status
  1946     if cs-agent-edit-status = 'C' or 'S' or 'U' or 'R' or
  1947                               'M' or 'N' or 'H'
  1948        move spaces              to cs-agent-name
  1949                                    cs-license-no
  1950                                    cs-npn-number
  1951     end-if
  1952     evaluate cs-agent-edit-status
  1953        when 'U'
  1954           move 'Unidentified'   to cs-agent-name
  1955        when 'R'
  1956           move 'Returned'       to cs-agent-name
  1957        when 'N'
  1958           move 'Accept with no commission'
  1959                                 to cs-agent-name
  1960        when 'H'
  1961           move 'Home Office'    to cs-agent-name
  1962     end-evaluate
  1963
  1964* EXEC CICS REWRITE
  1965*       DATASET ('ELCRTT')
  1966*       FROM    (CERTIFICATE-TRAILERS)
  1967*       RESP    (WS-RESPONSE)
  1968*    END-EXEC
  1969     MOVE LENGTH OF
  1970      CERTIFICATE-TRAILERS
  1971       TO DFHEIV11
  1972     MOVE 'ELCRTT' TO DFHEIV1
  1973*    MOVE '&& L                  %  N#00001917' TO DFHEIV0
  1974     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1975     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1976     MOVE X'204E233030303031393137' TO DFHEIV0(25:11)
  1977     CALL 'kxdfhei1' USING DFHEIV0,
  1978           DFHEIV1,
  1979           CERTIFICATE-TRAILERS,
  1980           DFHEIV11,
  1981           DFHEIV99
  1982     MOVE EIBRESP  TO WS-RESPONSE
  1983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1984     .
  1985 0122-exit.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  36
* SOCK04BL.cbl
  1986     exit.
  1987 0123-add-elcrtt.
  1988     move 'CS'                   to certificate-trailers
  1989     move cm-control-primary     to cs-control-primary
  1990     move 'C'                    to cs-trailer-type
  1991     move sock-action-taken    to cs-agent-edit-status
  1992     evaluate cs-agent-edit-status
  1993        when 'U'
  1994           move 'Unidentified'   to cs-agent-name
  1995        when 'R'
  1996           move 'Returned'       to cs-agent-name
  1997        when 'N'
  1998           move 'Accept with no commission'
  1999                                 to cs-agent-name
  2000        when 'H'
  2001           move 'Home Office'    to cs-agent-name
  2002     end-evaluate
  2003
  2004* EXEC CICS WRITE
  2005*       DATASET ('ELCRTT')
  2006*       FROM    (CERTIFICATE-TRAILERS)
  2007*       RIDFLD  (cs-control-primary)
  2008*       RESP    (WS-RESPONSE)
  2009*    END-EXEC
  2010     MOVE LENGTH OF
  2011      CERTIFICATE-TRAILERS
  2012       TO DFHEIV11
  2013     MOVE 'ELCRTT' TO DFHEIV1
  2014*    MOVE '&$ L                  ''  N#00001942' TO DFHEIV0
  2015     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2017     MOVE X'204E233030303031393432' TO DFHEIV0(25:11)
  2018     CALL 'kxdfhei1' USING DFHEIV0,
  2019           DFHEIV1,
  2020           CERTIFICATE-TRAILERS,
  2021           DFHEIV11,
  2022           cs-control-primary,
  2023           DFHEIV99,
  2024           DFHEIV99
  2025     MOVE EIBRESP  TO WS-RESPONSE
  2026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2027     .
  2028 0123-exit.
  2029     exit.
  2030 0150-process-cert-notes.
  2031     move spaces                 to cert-note-records-holder
  2032                                    ws-build-note-sw
  2033                                    ws-ercnot-sw
  2034     move cm-control-primary     to ws-cz-key
  2035     move '1'                    to ws-cz-rec-type
  2036     move +0                     to ws-cz-note-seq
  2037                                    c1
  2038
  2039* EXEC CICS STARTBR
  2040*         DATASET    ('ERCNOT')
  2041*         RIDFLD     (WS-CZ-KEY)
  2042*         GTEQ
  2043*         RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  37
* SOCK04BL.cbl
  2044*    END-EXEC
  2045     MOVE 'ERCNOT' TO DFHEIV1
  2046     MOVE 0
  2047       TO DFHEIV11
  2048*    MOVE '&,         G          &  N#00001960' TO DFHEIV0
  2049     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2051     MOVE X'204E233030303031393630' TO DFHEIV0(25:11)
  2052     CALL 'kxdfhei1' USING DFHEIV0,
  2053           DFHEIV1,
  2054           WS-CZ-KEY,
  2055           DFHEIV99,
  2056           DFHEIV11,
  2057           DFHEIV99
  2058     MOVE EIBRESP  TO WS-RESPONSE
  2059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2060     IF RESP-NORMAL
  2061        set ercnot-startbr to true
  2062        perform until finished-with-notes
  2063
  2064* EXEC CICS READNEXT
  2065*             DATASET    ('ERCNOT')
  2066*             RIDFLD     (WS-CZ-KEY)
  2067*             INTO       (cert-note-file)
  2068*             resp       (ws-response)
  2069*          end-exec
  2070     MOVE LENGTH OF
  2071      cert-note-file
  2072       TO DFHEIV12
  2073     MOVE 'ERCNOT' TO DFHEIV1
  2074     MOVE 0
  2075       TO DFHEIV11
  2076*    MOVE '&.IL                  )  N#00001970' TO DFHEIV0
  2077     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2078     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2079     MOVE X'204E233030303031393730' TO DFHEIV0(25:11)
  2080     CALL 'kxdfhei1' USING DFHEIV0,
  2081           DFHEIV1,
  2082           cert-note-file,
  2083           DFHEIV12,
  2084           WS-CZ-KEY,
  2085           DFHEIV99,
  2086           DFHEIV11,
  2087           DFHEIV99,
  2088           DFHEIV99
  2089     MOVE EIBRESP  TO ws-response
  2090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2091           if (resp-normal)
  2092              and (cz-control-primary (1:33) =
  2093                 cm-control-primary (1:33))
  2094              if cz-record-type = '1'
  2095                 add +1 to c1
  2096                 move cert-note-file
  2097                                 to cert-note-record (c1)
  2098              end-if
  2099           else
  2100              set finished-with-notes to true
  2101           end-if
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  38
* SOCK04BL.cbl
  2102        end-perform
  2103     end-if
  2104     if ercnot-startbr
  2105
  2106* exec cics endbr
  2107*          dataset    ('ERCNOT')
  2108*       end-exec
  2109     MOVE 'ERCNOT' TO DFHEIV1
  2110     MOVE 0
  2111       TO DFHEIV11
  2112*    MOVE '&2                    $   #00001991' TO DFHEIV0
  2113     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2114     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2115     MOVE X'2020233030303031393931' TO DFHEIV0(25:11)
  2116     CALL 'kxdfhei1' USING DFHEIV0,
  2117           DFHEIV1,
  2118           DFHEIV11,
  2119           DFHEIV99
  2120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2121     end-if
  2122     move c1                     to note-count
  2123     if c1 = +0
  2124        perform 0151-add-verify-agent-sig-note
  2125                                 thru 0151-exit
  2126     else
  2127        if ((cnr-rest (1) (1:21) = 'AGENT CHECK SIGNATURE')
  2128           and (sock-action-taken = 'C'))
  2129                         or
  2130           ((cnr-rest (1) (1:23) = 'MISSING AGENT SIGNATURE')
  2131           and (sock-action-taken = 'S'))
  2132                         or
  2133           ((cnr-rest (1) (1:22) = 'UNIDENTIFIED SIGNATURE')
  2134           and (sock-action-taken = 'U'))
  2135                         or
  2136           ((cnr-rest (1) (1:20) = 'CERTIFICATE RETURNED')
  2137           and (sock-action-taken = 'R'))
  2138                         or
  2139           ((cnr-rest (1) (1:19) = 'REFERRED TO MANAGER')
  2140           and (sock-action-taken = 'M'))
  2141                         or
  2142           ((cnr-rest (1) (1:25) = 'ACCEPT WITH NO COMMISSION')
  2143           and (sock-action-taken = 'N'))
  2144                         or
  2145           ((cnr-rest (1) (1:17) = 'HOME OFFICE ISSUE')
  2146           and (sock-action-taken = 'H'))
  2147           go to 0150-exit
  2148        else
  2149           perform 0152-delete-cert-notes
  2150                                 thru 0152-exit
  2151           if resp-normal
  2152              perform 0151-add-verify-agent-sig-note
  2153                                 thru 0151-exit
  2154              if resp-normal
  2155                 perform 0153-put-back-cert-notes
  2156                                 thru 0153-exit
  2157                 if resp-normal
  2158                    continue
  2159                 else
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  39
* SOCK04BL.cbl
  2160                    display ' something wrong with put back '
  2161                       cm-cert-no
  2162                 end-if
  2163              else
  2164                 display ' something went wrong with adding note '
  2165                    cm-cert-no
  2166              end-if
  2167           else
  2168              display ' something went wrong with generic delete '
  2169                 cm-cert-no
  2170           end-if
  2171        end-if
  2172     end-if
  2173     .
  2174 0150-exit.
  2175     exit.
  2176 0151-add-verify-agent-sig-note.
  2177     move 'CZ'                to cert-note-file
  2178     move cm-control-primary  to cz-control-primary
  2179     move '1'                 to cz-record-type
  2180     move +1                  to cz-note-sequence
  2181     move ws-current-bin-dt   to cz-last-maint-dt
  2182     move eibtime             to cz-last-maint-hhmmss
  2183     move sock-proc-id        to cz-last-maint-user
  2184     evaluate true
  2185        when sock-action-taken = 'C'
  2186           MOVE 'AGENT CHECK SIGNATURE COVER SHEET GENERATED'
  2187                              to cz-note
  2188        when sock-action-taken = 'S'
  2189           move 'MISSING AGENT SIGNATURE FORM GENERATED'
  2190                              to cz-note
  2191        when sock-action-taken = 'U'
  2192           move 'UNIDENTIFIED SIGNATURE'
  2193                              to cz-note
  2194        when sock-action-taken = 'R'
  2195           move 'CERTIFICATE RETURNED'
  2196                              to cz-note
  2197        when sock-action-taken = 'N'
  2198           move 'ACCEPTED WITH NO COMMISSION'
  2199                              to cz-note
  2200        when sock-action-taken = 'H'
  2201           move 'HOME OFFICE ISSUE'
  2202                              to cz-note
  2203        when other
  2204           move 'REFERRED TO MANAGER'
  2205                              to cz-note
  2206     end-evaluate
  2207
  2208* exec cics write
  2209*       dataset   ('ERCNOT')
  2210*       from      (cert-note-file)
  2211*       ridfld    (cz-control-primary)
  2212*       resp      (ws-response)
  2213*    end-exec
  2214     MOVE LENGTH OF
  2215      cert-note-file
  2216       TO DFHEIV11
  2217     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  40
* SOCK04BL.cbl
  2218*    MOVE '&$ L                  ''  N#00002081' TO DFHEIV0
  2219     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2221     MOVE X'204E233030303032303831' TO DFHEIV0(25:11)
  2222     CALL 'kxdfhei1' USING DFHEIV0,
  2223           DFHEIV1,
  2224           cert-note-file,
  2225           DFHEIV11,
  2226           cz-control-primary,
  2227           DFHEIV99,
  2228           DFHEIV99
  2229     MOVE EIBRESP  TO ws-response
  2230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2231     if not resp-normal
  2232        display ' error-ercnot-write ' ws-response ' '
  2233           cz-control-primary (2:33)
  2234     end-if
  2235     .
  2236 0151-exit.
  2237     exit.
  2238 0152-delete-cert-notes.
  2239     move cm-control-primary     to ws-cz-key
  2240     move '1'                    to ws-cz-rec-type
  2241     move +0                     to ws-cz-note-seq
  2242*       ws-cz-key (23:11)
  2243
  2244* EXEC CICS STARTBR
  2245*         DATASET    ('ERCNOT')
  2246*         RIDFLD     (WS-CZ-KEY)
  2247*         GTEQ
  2248*         RESP       (WS-RESPONSE)
  2249*    END-EXEC
  2250     MOVE 'ERCNOT' TO DFHEIV1
  2251     MOVE 0
  2252       TO DFHEIV11
  2253*    MOVE '&,         G          &  N#00002101' TO DFHEIV0
  2254     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2255     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2256     MOVE X'204E233030303032313031' TO DFHEIV0(25:11)
  2257     CALL 'kxdfhei1' USING DFHEIV0,
  2258           DFHEIV1,
  2259           WS-CZ-KEY,
  2260           DFHEIV99,
  2261           DFHEIV11,
  2262           DFHEIV99
  2263     MOVE EIBRESP  TO WS-RESPONSE
  2264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2265     IF not RESP-NORMAL
  2266        display ' error startbr for delete ' ws-response
  2267        go to 0152-exit
  2268     end-if
  2269     .
  2270 0152-read-next.
  2271
  2272* EXEC CICS READNEXT
  2273*       DATASET    ('ERCNOT')
  2274*       RIDFLD     (WS-CZ-KEY)
  2275*       INTO       (cert-note-file)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  41
* SOCK04BL.cbl
  2276*       resp       (ws-response)
  2277*    end-exec
  2278     MOVE LENGTH OF
  2279      cert-note-file
  2280       TO DFHEIV12
  2281     MOVE 'ERCNOT' TO DFHEIV1
  2282     MOVE 0
  2283       TO DFHEIV11
  2284*    MOVE '&.IL                  )  N#00002114' TO DFHEIV0
  2285     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2286     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2287     MOVE X'204E233030303032313134' TO DFHEIV0(25:11)
  2288     CALL 'kxdfhei1' USING DFHEIV0,
  2289           DFHEIV1,
  2290           cert-note-file,
  2291           DFHEIV12,
  2292           WS-CZ-KEY,
  2293           DFHEIV99,
  2294           DFHEIV11,
  2295           DFHEIV99,
  2296           DFHEIV99
  2297     MOVE EIBRESP  TO ws-response
  2298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2299     if resp-normal
  2300        if cz-control-primary (1:33) = cm-control-primary (1:33)
  2301           if cz-record-type = '1'
  2302
  2303* exec cics endbr
  2304*                dataset    ('ERCNOT')
  2305*                resp       (ws-response)
  2306*             end-exec
  2307     MOVE 'ERCNOT' TO DFHEIV1
  2308     MOVE 0
  2309       TO DFHEIV11
  2310*    MOVE '&2                    $  N#00002126' TO DFHEIV0
  2311     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2312     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2313     MOVE X'204E233030303032313236' TO DFHEIV0(25:11)
  2314     CALL 'kxdfhei1' USING DFHEIV0,
  2315           DFHEIV1,
  2316           DFHEIV11,
  2317           DFHEIV99
  2318     MOVE EIBRESP  TO ws-response
  2319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2320              if not resp-normal
  2321                 display ' bad endbr ' ws-response
  2322                 go to 0152-exit
  2323              else
  2324
  2325* EXEC CICS READ
  2326*                   UPDATE
  2327*                   DATASET    ('ERCNOT')
  2328*                   RIDFLD     (WS-CZ-KEY)
  2329*                   INTO       (cert-note-file)
  2330*                   resp       (ws-response)
  2331*                end-exec
  2332     MOVE LENGTH OF
  2333      cert-note-file
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  42
* SOCK04BL.cbl
  2334       TO DFHEIV11
  2335     MOVE 'ERCNOT' TO DFHEIV1
  2336*    MOVE '&"IL       EU         (  N#00002135' TO DFHEIV0
  2337     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2338     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2339     MOVE X'204E233030303032313335' TO DFHEIV0(25:11)
  2340     CALL 'kxdfhei1' USING DFHEIV0,
  2341           DFHEIV1,
  2342           cert-note-file,
  2343           DFHEIV11,
  2344           WS-CZ-KEY,
  2345           DFHEIV99,
  2346           DFHEIV99,
  2347           DFHEIV99
  2348     MOVE EIBRESP  TO ws-response
  2349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2350                 if not resp-normal
  2351                    display ' bad read update ' ws-response
  2352                    go to 0152-exit
  2353                 end-if
  2354
  2355* exec cics delete
  2356*                   dataset   ('ERCNOT')
  2357*                   RIDFLD     (WS-CZ-KEY)
  2358*                   resp      (ws-response)
  2359*                end-exec
  2360     MOVE 'ERCNOT' TO DFHEIV1
  2361*    MOVE '&(                    &  N#00002147' TO DFHEIV0
  2362     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2363     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2364     MOVE X'204E233030303032313437' TO DFHEIV0(25:11)
  2365     CALL 'kxdfhei1' USING DFHEIV0,
  2366           DFHEIV1,
  2367           DFHEIV99,
  2368           DFHEIV99,
  2369           DFHEIV99,
  2370           DFHEIV99
  2371     MOVE EIBRESP  TO ws-response
  2372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2373                 if not resp-normal
  2374                    display ' bad delete ercnot ' ws-response
  2375                    go to 0152-exit
  2376                 else
  2377                    display ' good delete '
  2378                 end-if
  2379              end-if
  2380           else
  2381              display ' rec type not = 1 '
  2382           end-if
  2383           go to 0152-delete-cert-notes
  2384        else
  2385           display ' primary not = '
  2386        end-if
  2387     else
  2388        display ' error ercnot readnext delete ' ws-response
  2389     end-if
  2390
  2391* exec cics endbr
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  43
* SOCK04BL.cbl
  2392*       dataset    ('ERCNOT')
  2393*       resp       (ws-response)
  2394*    end-exec
  2395     MOVE 'ERCNOT' TO DFHEIV1
  2396     MOVE 0
  2397       TO DFHEIV11
  2398*    MOVE '&2                    $  N#00002170' TO DFHEIV0
  2399     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2401     MOVE X'204E233030303032313730' TO DFHEIV0(25:11)
  2402     CALL 'kxdfhei1' USING DFHEIV0,
  2403           DFHEIV1,
  2404           DFHEIV11,
  2405           DFHEIV99
  2406     MOVE EIBRESP  TO ws-response
  2407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2408     if not resp-normal
  2409        display ' bad resp endbr ercnot ' ws-response
  2410     else
  2411        display ' good endbr '
  2412     end-if
  2413     .
  2414 0152-exit.
  2415     exit.
  2416*0152-delete-cert-notes.
  2417*
  2418*    move cm-control-primary     to ws-cz-key
  2419*    move '1'                    to ws-cz-rec-type
  2420*    move +0                     to ws-cz-note-seq
  2421*       ws-cz-key (23:11)
  2422*    exec cics delete
  2423*       dataset    ('ERCNOT')
  2424*       keylength  (ws-cert-note-generic-key-len)
  2425*       ridfld     (ws-cz-key (1:34))
  2426*       generic
  2427*       resp       (ws-response)
  2428*    end-exec
  2429*
  2430*    display ' made it back from generic delete ' ws-response
  2431*
  2432*    .
  2433*0152-exit.
  2434*    exit.
  2435 0153-put-back-cert-notes.
  2436*    display ' made it to 0153 ' note-count
  2437     perform varying c1 from +1 by +1 until
  2438        c1 > note-count
  2439        move cert-note-record (c1)
  2440                                 to cert-note-file
  2441        add +1                   to cz-note-sequence
  2442*           cz-record-type ' ' cz-note-information
  2443
  2444* exec cics write
  2445*          dataset ('ERCNOT')
  2446*          FROM    (cert-note-file)
  2447*          ridfld  (cz-control-primary)
  2448*          resp    (ws-response)
  2449*       end-exec
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  44
* SOCK04BL.cbl
  2450     MOVE LENGTH OF
  2451      cert-note-file
  2452       TO DFHEIV11
  2453     MOVE 'ERCNOT' TO DFHEIV1
  2454*    MOVE '&$ L                  ''  N#00002213' TO DFHEIV0
  2455     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2457     MOVE X'204E233030303032323133' TO DFHEIV0(25:11)
  2458     CALL 'kxdfhei1' USING DFHEIV0,
  2459           DFHEIV1,
  2460           cert-note-file,
  2461           DFHEIV11,
  2462           cz-control-primary,
  2463           DFHEIV99,
  2464           DFHEIV99
  2465     MOVE EIBRESP  TO ws-response
  2466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2467        if not resp-normal
  2468           display ' error-ercnot-write subsequ ' ws-response ' '
  2469              cz-control-primary (2:33)
  2470           move +999             to c1
  2471        else
  2472           display ' good ercnot write ' c1
  2473        end-if
  2474     end-perform
  2475    .
  2476 0153-exit.
  2477     exit.
  2478 0200-process-acct-comp.
  2479     move low-values             to ws-am-key
  2480     move ws-comp-cd             to ws-am-company-cd
  2481     move sock-car               to ws-am-carrier
  2482     move sock-grp               to ws-am-group
  2483     move sock-st                to ws-am-state
  2484     move sock-act               to ws-am-account
  2485     move ws-bin-cert-eff-dt     to ws-am-exp-dt
  2486
  2487* EXEC CICS STARTBR
  2488*         DATASET    ('ERACCT')
  2489*         RIDFLD     (WS-AM-KEY)
  2490*         GTEQ
  2491*         RESP       (WS-RESPONSE)
  2492*    END-EXEC
  2493     MOVE 'ERACCT' TO DFHEIV1
  2494     MOVE 0
  2495       TO DFHEIV11
  2496*    MOVE '&,         G          &  N#00002239' TO DFHEIV0
  2497     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2499     MOVE X'204E233030303032323339' TO DFHEIV0(25:11)
  2500     CALL 'kxdfhei1' USING DFHEIV0,
  2501           DFHEIV1,
  2502           WS-AM-KEY,
  2503           DFHEIV99,
  2504           DFHEIV11,
  2505           DFHEIV99
  2506     MOVE EIBRESP  TO WS-RESPONSE
  2507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  45
* SOCK04BL.cbl
  2508     if not resp-normal
  2509        display ' bad startbr ' ws-response
  2510        go to 0200-exit
  2511     end-if
  2512
  2513* EXEC CICS READNEXT
  2514*         INTO    (ACCOUNT-MASTER)
  2515*         DATASET ('ERACCT')
  2516*         RIDFLD  (WS-AM-KEY)
  2517*         RESP    (WS-RESPONSE)
  2518*    END-EXEC
  2519     MOVE LENGTH OF
  2520      ACCOUNT-MASTER
  2521       TO DFHEIV12
  2522     MOVE 'ERACCT' TO DFHEIV1
  2523     MOVE 0
  2524       TO DFHEIV11
  2525*    MOVE '&.IL                  )  N#00002249' TO DFHEIV0
  2526     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2527     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2528     MOVE X'204E233030303032323439' TO DFHEIV0(25:11)
  2529     CALL 'kxdfhei1' USING DFHEIV0,
  2530           DFHEIV1,
  2531           ACCOUNT-MASTER,
  2532           DFHEIV12,
  2533           WS-AM-KEY,
  2534           DFHEIV99,
  2535           DFHEIV11,
  2536           DFHEIV99,
  2537           DFHEIV99
  2538     MOVE EIBRESP  TO WS-RESPONSE
  2539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2540     if (resp-normal)
  2541        and (ws-am-company-cd = ws-comp-cd)
  2542        and (ws-am-carrier    = sock-car)
  2543        and (ws-am-state      = sock-st)
  2544        and (ws-am-account    = sock-act)
  2545        continue
  2546     else
  2547        display ' account not found '
  2548        go to 0200-exit
  2549     end-if
  2550     move spaces                 to ws-return-stuff
  2551     move am-name                to sock-am-name
  2552     move am-person              to sock-am-person
  2553     move am-control-name        to sock-am-cntrl-name
  2554     move am-tel-no              to sock-am-phone
  2555     MOVE LOW-VALUES             TO WS-CO-KEY
  2556     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  2557     MOVE AM-CARRIER             TO WS-CO-CARRIER
  2558     MOVE AM-GROUPING            TO WS-CO-GROUP
  2559     MOVE 'A'                    TO WS-CO-TYPE
  2560     if am-remit-to not numeric
  2561        move zeros               to am-remit-to
  2562     end-if
  2563     if am-remit-to = zeros
  2564        move 01                  to am-remit-to
  2565     end-if
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  46
* SOCK04BL.cbl
  2566     move am-agt (am-remit-to)   to ws-co-fin-resp
  2567     perform varying a1 from +1 by +1 until
  2568        (a1 > +10)
  2569        or (am-com-typ (a1) = 'C' or 'D')
  2570     end-perform
  2571     if a1 < +11
  2572        move am-agt (a1)         to ws-co-account
  2573     else
  2574        move am-account          to ws-co-account
  2575     end-if
  2576
  2577* EXEC CICS READ
  2578*         INTO    (COMPENSATION-MASTER)
  2579*         DATASET ('ERCOMP')
  2580*         RIDFLD  (WS-CO-KEY)
  2581*         RESP    (WS-RESPONSE)
  2582*    END-EXEC
  2583     MOVE LENGTH OF
  2584      COMPENSATION-MASTER
  2585       TO DFHEIV11
  2586     MOVE 'ERCOMP' TO DFHEIV1
  2587*    MOVE '&"IL       E          (  N#00002291' TO DFHEIV0
  2588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2590     MOVE X'204E233030303032323931' TO DFHEIV0(25:11)
  2591     CALL 'kxdfhei1' USING DFHEIV0,
  2592           DFHEIV1,
  2593           COMPENSATION-MASTER,
  2594           DFHEIV11,
  2595           WS-CO-KEY,
  2596           DFHEIV99,
  2597           DFHEIV99,
  2598           DFHEIV99
  2599     MOVE EIBRESP  TO WS-RESPONSE
  2600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2601     IF RESP-NORMAL
  2602        MOVE CO-CONTROL-NAME     TO sock-co-contact
  2603        MOVE CO-faxno            TO sock-co-fax
  2604     ELSE
  2605        MOVE ' unknown     '     TO sock-co-contact
  2606     END-IF
  2607     .
  2608 0200-exit.
  2609     exit.
  2610 cics-return.
  2611     display 'SOCK04BL Finished ' sock-return-area
  2612
  2613* exec cics
  2614*       return
  2615*    end-exec
  2616*    MOVE '.(                    ''   #00002308' TO DFHEIV0
  2617     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2618     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2619     MOVE X'2020233030303032333038' TO DFHEIV0(25:11)
  2620     CALL 'kxdfhei1' USING DFHEIV0,
  2621           DFHEIV99,
  2622           DFHEIV99,
  2623           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-18 09:04 Page  47
* SOCK04BL.cbl
  2624           DFHEIV99,
  2625           DFHEIV99,
  2626           DFHEIV99
  2627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2628
  2629* goback
  2630
  2631     MOVE '9%                    "   ' TO DFHEIV0
  2632     MOVE 'SOCK04BL' TO DFHEIV1
  2633     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2634     goback
  2635     .
  2636 9700-DATE-LINK.
  2637
  2638* EXEC CICS LINK
  2639*         PROGRAM  ('ELDATCV')
  2640*         COMMAREA (DATE-CONVERSION-DATA)
  2641*         LENGTH   (DC-COMM-LENGTH)
  2642*    END-EXEC.
  2643     MOVE 'ELDATCV' TO DFHEIV1
  2644*    MOVE '."C                   (   #00002314' TO DFHEIV0
  2645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2647     MOVE X'2020233030303032333134' TO DFHEIV0(25:11)
  2648     CALL 'kxdfhei1' USING DFHEIV0,
  2649           DFHEIV1,
  2650           DATE-CONVERSION-DATA,
  2651           DC-COMM-LENGTH,
  2652           DFHEIV99,
  2653           DFHEIV99,
  2654           DFHEIV99,
  2655           DFHEIV99
  2656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2657
  2658 9700-EXIT.
  2659      EXIT.
  2660
  2661 9999-DFHBACK SECTION.
  2662     MOVE '9%                    "   ' TO DFHEIV0
  2663     MOVE 'SOCK04BL' TO DFHEIV1
  2664     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2665     GOBACK.
  2666 9999-DFHEXIT.
  2667     IF DFHEIGDJ EQUAL 0001
  2668         NEXT SENTENCE.
  2669     MOVE '9%                    "   ' TO DFHEIV0
  2670     MOVE 'SOCK04BL' TO DFHEIV1
  2671     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2672     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       53132     Code:        6556
