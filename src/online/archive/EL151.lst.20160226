* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL151.cbl
* Options: int("EL151.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL151.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL151.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL151.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL151 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/06/95 13:08:11.
     7*                            VMOD=2.012.
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL151.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24******************************************************************
    25*                   C H A N G E   L O G
    26*
    27* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    28*-----------------------------------------------------------------
    29*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    30* EFFECTIVE    NUMBER
    31*-----------------------------------------------------------------
    32* 050506    2006030600001  AJRA  ADD PROOF DATE TO DENIAL SCREEN
    33* 120808    2008100900001  PEMA  ADD FOR DENIAL CODE
    34* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    35******************************************************************
    36*REMARKS.
    37
    38*    SCREENS     - EL151S - DENIALS
    39
    40*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    41
    42*    EXIT TO     - EL150 - CALLING PROGRAM
    43
    44*    INPUT FILE  - ELMSTR - CLAIM MASTER
    45*                - ELTRLR - ACTIVITY TRAILERS
    46*                - ERNOTE - CERTIFICATE NOTES
    47
    48*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    49*                - ELTRLR - ACTIVITY TRAILERS
    50
    51*    COMMAREA    - PASSED
    52
    53*    ERROR-CODES ACCESSED - 132,  133, 270, 137, 29, 315, 008, 50
    54
    55*    NARRATIVE   - 1- PROVIDE CREATION OF DENIAL TRAILERS
    56*                  2- UPDATE CLAIM STATUS TYPE TO CLOSED (ELMSTR)
    57*                  3- UPDATE RESERVE-EXPENSE TRAILER STATUS TO
    58*                     CLOSED, REASON DENIAL
    59
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL151.cbl
    61 ENVIRONMENT DIVISION.
    62
    63 DATA DIVISION.
    64
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67
    68 77  FILLER  PIC X(32)  VALUE '********************************'.
    69 77  FILLER  PIC X(32)  VALUE '*   EL151  WORKING STORAGE     *'.
    70 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.012 ********'.
    71
    72*                            COPY ELCSCTM.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCTM                             *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    80*                                                                *
    81******************************************************************
    82 01  SECURITY-MESSAGE.
    83     12  FILLER                          PIC X(30)
    84            VALUE '** LOGIC SECURITY VIOLATION -'.
    85     12  SM-READ                         PIC X(6).
    86     12  FILLER                          PIC X(5)
    87            VALUE ' PGM='.
    88     12  SM-PGM                          PIC X(6).
    89     12  FILLER                          PIC X(5)
    90            VALUE ' OPR='.
    91     12  SM-PROCESSOR-ID                 PIC X(4).
    92     12  FILLER                          PIC X(6)
    93            VALUE ' TERM='.
    94     12  SM-TERMID                       PIC X(4).
    95     12  FILLER                          PIC XX   VALUE SPACE.
    96     12  SM-JUL-DATE                     PIC 9(5).
    97     12  FILLER                          PIC X    VALUE SPACE.
    98     12  SM-TIME                         PIC 99.99.
    99
   100
   101*                            COPY ELCSCRTY.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCRTY                            *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   109*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   110*        SAVED IN PI-SECURITY-ADDRESS.                           *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-CONTROL.
   114     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   115     12  FILLER                       PIC XX    VALUE 'SC'.
   116     12  SC-CREDIT-CODES.
   117         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   118             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL151.cbl
   119             20  SC-CREDIT-UPDATE     PIC X.
   120     12  SC-CLAIMS-CODES.
   121         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   122             20  SC-CLAIMS-DISPLAY    PIC X.
   123             20  SC-CLAIMS-UPDATE     PIC X.
   124
   125*                            COPY ELCNWA.
   126*****************************************************************
   127*                                                               *
   128*                                                               *
   129*                            ELCNWA.                            *
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   131*                            VMOD=2.003                         *
   132*                                                               *
   133*            M O V E   N A M E   W O R K   A R E A.             *
   134*                                                               *
   135*****************************************************************.
   136
   137 01  WS-NAME-WORK-AREA.
   138     05  WS-INSURED-LAST-NAME        PIC X(15).
   139     05  WS-INSURED-1ST-NAME         PIC X(12).
   140     05  WS-INSURED-MID-INIT         PIC X.
   141
   142     05  WS-NAME-WORK.
   143         10  WS-NW                   PIC X
   144             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   145
   146     05  WS-NAME-WORK2.
   147         10  WS-NW2                  PIC X
   148             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   149                                        NWA-INDEX0.
   150
   151     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   152                                     COMP-3.
   153
   154
   155 01  WS-DATE-AREA.
   156     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   157     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   158     05  WS-BLANK            PIC X       VALUE ' '.
   159
   160 01  WS-SCRATCH-AREA.
   161     05  GETMAIN-SPACE               PIC X     VALUE SPACE.
   162     05  WS-TRLR-LENGTH              PIC S9(4) VALUE +200  COMP.
   163     05  WS-DMO-LENGTH               PIC S9(4) VALUE +108  COMP.
   164     05  WS-DCT-LENGTH               PIC S9(4) VALUE +53   COMP.
   165     05  SC-ITEM                     PIC S9(4) VALUE +0001 COMP.
   166
   167     05  WS-TRANS-ID                 PIC X(4)   VALUE 'EX32'.
   168     05  WS-SEQ-NO-SAVED             PIC S9(4)   VALUE ZEROS.
   169
   170     05  WS-ORIG-SEQ-CNT             PIC S9(4)   VALUE ZEROS.
   171
   172     05  TR-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   173     05  TR-SUB-2                    PIC S9(4)   VALUE ZERO  COMP.
   174     05  MISC-SUB                    PIC S9(03)  COMP-3  VALUE +0.
   175
   176     05  MAP-NAME                    PIC X(08)   VALUE 'EL151A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL151.cbl
   177     05  MAPSET-NAME                 PIC X(08)   VALUE 'EL151S'.
   178
   179     05  ELTRLR-FILE-ID              PIC X(08)   VALUE 'ELTRLR'.
   180     05  ELMSTR-FILE-ID              PIC X(08)   VALUE 'ELMSTR'.
   181     05  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   182     05  ELARCH-FILE-ID              PIC X(08)   VALUE 'ELARCH'.
   183
   184     05  THIS-PGM                    PIC X(08)   VALUE  'EL151'.
   185
   186     05  WS-OC-LOAD-SW               PIC X(01)   VALUE SPACE.
   187         88  OC-HISTORY-LOADED       VALUE 'X'.
   188
   189     05  WS-CLAIM-SEQ-SW             PIC X(01)   VALUE SPACE.
   190         88  NO-SEQ-NUMBER           VALUE 'X'.
   191         88  SEQ-NUMBER-EXIST        VALUE ' '.
   192         88  NO-ACCT-TRLR            VALUE 'Y'.
   193
   194     05  WS-RESET-SW                 PIC X(01)   VALUE 'N'.
   195     05  WS-REC-FOUND-SW             PIC X(01)   VALUE 'N'.
   196     05  WS-BROWSE-SW                PIC X(01)   VALUE 'N'.
   197     05  WS-UPDATE-SW                PIC X(01)   VALUE 'N'.
   198
   199     05  TIME-IN                     PIC S9(7).
   200     05  TIME-OUT-R REDEFINES TIME-IN.
   201         10  FILLER                  PIC X(01).
   202         10  TIME-OUT                PIC 99V99.
   203         10  FILLER                  PIC X(02).
   204
   205     05  DEEDIT-FIELD                PIC X(15).
   206     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   207
   208     05  WS-PRF-DT                   PIC X(2).
   209     05  WS-MAX-LETTER-ANSWER-DT     PIC X(2)  VALUE LOW-VALUES.
   210
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL151.cbl
   212     05  DENIAL-TABLE.
   213         10  FILLER                  PIC X(44)    VALUE
   214             'DPE  PRE-EXISTING DISABILITY                '.
   215         10  FILLER                  PIC X(44)    VALUE
   216             'DDN  DISABILITY NOT COVERED DUE TO NATURE   '.
   217         10  FILLER                  PIC X(44)    VALUE
   218             'DIR  INSURED RECOVERED FROM DISABILITY      '.
   219         10  FILLER                  PIC X(44)    VALUE
   220             'DEM  EMPLOYMENT INDICATES OCCUPATION NOT MET'.
   221         10  FILLER                  PIC X(44)    VALUE
   222             'DWP  DISABILITY WAITING PERIOD NOT SATISFIED'.
   223         10  FILLER                  PIC X(44)    VALUE
   224             'DNC  NO COVERAGE                            '.
   225         10  FILLER                  PIC X(44)    VALUE
   226             'DAP  APPLICATION MISREPRESENTATION          '.
   227         10  FILLER                  PIC X(44)    VALUE
   228             'DMA  MIS-STATEMENT OF AGE                   '.
   229         10  FILLER                  PIC X(44)    VALUE
   230             'DSU  SUICIDE OR SELF-INFLICTED INJURY       '.
   231         10  FILLER                  PIC X(44)    VALUE
   232             'DOT  OTHER                                  '.
   233         10  FILLER                  PIC X(44)    VALUE
   234             'DAR  AWARE OF UNEMPLOY./RED. AT INCEPTION   '.
   235         10  FILLER                  PIC X(44)    VALUE
   236             'DNE  NOT EMPLOYED SIX MONTHS PRIOR          '.
   237         10  FILLER                  PIC X(44)    VALUE
   238             'DNR  NOT MADE REDUNDANT/NOT UNEMPLOYED      '.
   239         10  FILLER                  PIC X(44)    VALUE
   240             'DSE  SELF EMPLOYED                          '.
   241         10  FILLER                  PIC X(44)    VALUE
   242             'DTW  TEMPORARY WORK                         '.
   243         10  FILLER                  PIC X(44)    VALUE
   244             'LAP  APPLICATION MISREPRESENTATION          '.
   245         10  FILLER                  PIC X(44)    VALUE
   246             'LMA  MIS-STATEMENT OF AGE                   '.
   247         10  FILLER                  PIC X(44)    VALUE
   248             'LNC  NO COVERAGE                            '.
   249         10  FILLER                  PIC X(44)    VALUE
   250             'LOT  OTHER                                  '.
   251     05  DEN-TABLE REDEFINES DENIAL-TABLE OCCURS 19
   252         INDEXED BY DEN-INDEX.
   253         10  DENIAL-CODE.
   254             15  DENIAL-1-1          PIC X(01).
   255             15  DENIAL-2-3          PIC X(02).
   256             15  DENIAL-4-4          PIC X(01).
   257         10  FILLER                  PIC X(01).
   258         10  DENIAL-DESC             PIC X(39).
   259
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL151.cbl
   261 01  ACCESS-KEYS.
   262     05  WS-TRAILER-KEY.
   263         10  WS-CLAIM-KEY.
   264             15  WS-KEY-COMPANY-CD       PIC X.
   265             15  WS-KEY-CARRIER          PIC X.
   266             15  WS-KEY-CLAIM-NO         PIC X(7).
   267             15  WS-KEY-CERT-NO.
   268                 20  WS-KEY-CERT-PRIME   PIC X(10).
   269                 20  WS-KEY-CERT-SFX     PIC X.
   270         10  WS-KEY-SEQUENCE-NO      PIC   S9(4) COMP.
   271
   272     05  ELARCH-KEY.
   273         10  ELARCH-COMPANY-CD   PIC X(01).
   274         10  ELARCH-ARCHIVE-NO   PIC S9(08)  COMP.
   275         10  ELARCH-RECORD-TYPE  PIC X(01).
   276         10  ELARCH-SEQ-NO       PIC S9(04)  COMP.
   277
   278     05  WS-ELDENY-KEY.
   279         10  ELDENY-COMPANY-CD   PIC X.
   280         10  ELDENY-DENIAL-CODE  PIC X(4).
   281         10  FILLER              PIC X(10).
   282     05  ELCNTL-KEY.
   283         10  ELCNTL-COMPANY-ID   PIC X(03).
   284         10  ELCNTL-RECORD-TYPE  PIC X(01).
   285         10  ELCNTL-ACCESS       PIC X(04).
   286         10  ELCNTL-SEQ-NO       PIC S9(04)  COMP.
   287
   288     05  W-NOTE-KEY.
   289         10  W-NOTE-COMP-CD      PIC X.
   290         10  W-NOTE-CERT-KEY.
   291             16  W-NOTE-CARRIER  PIC X.
   292             16  W-NOTE-GROUPING PIC X(6).
   293             16  W-NOTE-STATE    PIC XX.
   294             16  W-NOTE-ACCOUNT  PIC X(10).
   295             16  W-NOTE-EFF-DT   PIC XX.
   296             16  W-NOTE-CERT-NO  PIC X(11).
   297
   298 01  WS-RESPONSE             PIC S9(8)   COMP.
   299     88  RESP-NORMAL              VALUE +00.
   300     88  RESP-ERROR               VALUE +01.
   301     88  RESP-NOTFND              VALUE +13.
   302     88  RESP-NOTOPEN             VALUE +19.
   303     88  RESP-ENDFILE             VALUE +20.
   304 01  ERROR-MESSAGES.
   305     12  ER-0000                 PIC X(4)  VALUE '0000'.
   306     12  ER-0004                 PIC X(4)  VALUE '0004'.
   307     12  ER-0008                 PIC X(4)  VALUE '0008'.
   308     12  ER-0021                 PIC X(4)  VALUE '0021'.
   309     12  ER-0029                 PIC X(4)  VALUE '0029'.
   310     12  ER-0050                 PIC X(4)  VALUE '0050'.
   311     12  ER-0070                 PIC X(4)  VALUE '0070'.
   312     12  ER-0132                 PIC X(4)  VALUE '0132'.
   313     12  ER-0133                 PIC X(4)  VALUE '0133'.
   314     12  ER-0137                 PIC X(4)  VALUE '0137'.
   315     12  ER-0154                 PIC X(4)  VALUE '0154'.
   316     12  ER-0172                 PIC X(4)  VALUE '0172'.
   317     12  ER-0270                 PIC X(4)  VALUE '0270'.
   318     12  ER-0483                 PIC X(4)  VALUE '0483'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL151.cbl
   319     12  ER-0872                 PIC X(4)  VALUE '0872'.
   320     12  ER-0873                 PIC X(4)  VALUE '0873'.
   321     12  ER-0884                 PIC X(4)  VALUE '0884'.
   322     12  ER-0919                 PIC X(4)  VALUE '0919'.
   323     12  ER-0921                 PIC X(4)  VALUE '0921'.
   324     12  ER-0946                 PIC X(4)  VALUE '0946'.
   325     12  ER-0947                 PIC X(4)  VALUE '0947'.
   326     12  ER-0948                 PIC X(4)  VALUE '0948'.
   327     12  ER-0949                 PIC X(4)  VALUE '0949'.
   328     12  ER-0950                 PIC X(4)  VALUE '0950'.
   329     12  ER-0951                 PIC X(4)  VALUE '0951'.
   330     12  ER-0954                 PIC X(4)  VALUE '0954'.
   331     12  ER-0974                 PIC X(4)  VALUE '0974'.
   332     12  ER-0975                 PIC X(4)  VALUE '0975'.
   333     12  ER-8051                 PIC X(4)  VALUE '8051'.
   334     12  ER-8052                 PIC X(4)  VALUE '8052'.
   335     12  ER-8053                 PIC X(4)  VALUE '8053'.
   336     12  ER-8054                 PIC X(4)  VALUE '8054'.
   337     12  ER-8055                 PIC X(4)  VALUE '8055'.
   338     12  ER-8056                 PIC X(4)  VALUE '8056'.
   339     12  ER-8057                 PIC X(4)  VALUE '8057'.
   340     12  ER-8058                 PIC X(4)  VALUE '8058'.
   341     12  ER-8059                 PIC X(4)  VALUE '8059'.
   342     12  ER-8060                 PIC X(4)  VALUE '8060'.
   343     12  ER-8061                 PIC X(4)  VALUE '8061'.
   344     12  ER-8062                 PIC X(4)  VALUE '8062'.
   345     12  ER-8063                 PIC X(4)  VALUE '8063'.
   346     12  ER-8064                 PIC X(4)  VALUE '8064'.
   347     12  ER-8065                 PIC X(4)  VALUE '8065'.
   348     12  ER-8066                 PIC X(4)  VALUE '8066'.
   349     12  ER-8152                 PIC X(4)  VALUE '8152'.
   350     12  ER-8153                 PIC X(4)  VALUE '8153'.
   351     12  ER-8154                 PIC X(4)  VALUE '8154'.
   352     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL151.cbl
   354*                                    COPY ELCAID.
   355******************************************************************
   356*                                                                *
   357*                            ELCAID.                             *
   358*                            VMOD=2.001                          *
   359*                                                                *
   360*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   361*                                                                *
   362*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   363*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   364******************************************************************
   365
   366 01  DFHAID.
   367   02  DFHNULL   PIC  X  VALUE  ' '.
   368   02  DFHENTER  PIC  X  VALUE  QUOTE.
   369   02  DFHCLEAR  PIC  X  VALUE  '_'.
   370   02  DFHPEN    PIC  X  VALUE  '='.
   371   02  DFHOPID   PIC  X  VALUE  'W'.
   372   02  DFHPA1    PIC  X  VALUE  '%'.
   373   02  DFHPA2    PIC  X  VALUE  '>'.
   374   02  DFHPA3    PIC  X  VALUE  ','.
   375   02  DFHPF1    PIC  X  VALUE  '1'.
   376   02  DFHPF2    PIC  X  VALUE  '2'.
   377   02  DFHPF3    PIC  X  VALUE  '3'.
   378   02  DFHPF4    PIC  X  VALUE  '4'.
   379   02  DFHPF5    PIC  X  VALUE  '5'.
   380   02  DFHPF6    PIC  X  VALUE  '6'.
   381   02  DFHPF7    PIC  X  VALUE  '7'.
   382   02  DFHPF8    PIC  X  VALUE  '8'.
   383   02  DFHPF9    PIC  X  VALUE  '9'.
   384   02  DFHPF10   PIC  X  VALUE  ':'.
   385   02  DFHPF11   PIC  X  VALUE  '#'.
   386   02  DFHPF12   PIC  X  VALUE  '@'.
   387   02  DFHPF13   PIC  X  VALUE  'A'.
   388   02  DFHPF14   PIC  X  VALUE  'B'.
   389   02  DFHPF15   PIC  X  VALUE  'C'.
   390   02  DFHPF16   PIC  X  VALUE  'D'.
   391   02  DFHPF17   PIC  X  VALUE  'E'.
   392   02  DFHPF18   PIC  X  VALUE  'F'.
   393   02  DFHPF19   PIC  X  VALUE  'G'.
   394   02  DFHPF20   PIC  X  VALUE  'H'.
   395   02  DFHPF21   PIC  X  VALUE  'I'.
   396*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   397   02  DFHPF22   PIC  X  VALUE  '['.
   398   02  DFHPF23   PIC  X  VALUE  '.'.
   399   02  DFHPF24   PIC  X  VALUE  '<'.
   400   02  DFHMSRE   PIC  X  VALUE  'X'.
   401   02  DFHSTRF   PIC  X  VALUE  'h'.
   402   02  DFHTRIG   PIC  X  VALUE  '"'.
   403 01  PF-AID REDEFINES DFHAID.
   404     05  FILLER                      PIC X(8).
   405     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL151.cbl
   407*                                    COPY ELCINTF.
   408******************************************************************
   409*                                                                *
   410*                                                                *
   411*                            ELCINTF.                            *
   412*                            VMOD=2.017                          *
   413*                                                                *
   414*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   415*                                                                *
   416*       LENGTH = 1024                                            *
   417*                                                                *
   418******************************************************************
   419 01  PROGRAM-INTERFACE-BLOCK.
   420     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   421     12  PI-CALLING-PROGRAM              PIC X(8).
   422     12  PI-SAVED-PROGRAM-1              PIC X(8).
   423     12  PI-SAVED-PROGRAM-2              PIC X(8).
   424     12  PI-SAVED-PROGRAM-3              PIC X(8).
   425     12  PI-SAVED-PROGRAM-4              PIC X(8).
   426     12  PI-SAVED-PROGRAM-5              PIC X(8).
   427     12  PI-SAVED-PROGRAM-6              PIC X(8).
   428     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   429     12  PI-COMPANY-ID                   PIC XXX.
   430     12  PI-COMPANY-CD                   PIC X.
   431
   432     12  PI-COMPANY-PASSWORD             PIC X(8).
   433
   434     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   435
   436     12  PI-CONTROL-IN-PROGRESS.
   437         16  PI-CARRIER                  PIC X.
   438         16  PI-GROUPING                 PIC X(6).
   439         16  PI-STATE                    PIC XX.
   440         16  PI-ACCOUNT                  PIC X(10).
   441         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   442                                         PIC X(10).
   443         16  PI-CLAIM-CERT-GRP.
   444             20  PI-CLAIM-NO             PIC X(7).
   445             20  PI-CERT-NO.
   446                 25  PI-CERT-PRIME       PIC X(10).
   447                 25  PI-CERT-SFX         PIC X.
   448             20  PI-CERT-EFF-DT          PIC XX.
   449         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   450             20  PI-PLAN-CODE            PIC X(2).
   451             20  PI-REVISION-NUMBER      PIC X(3).
   452             20  PI-PLAN-EFF-DT          PIC X(2).
   453             20  PI-PLAN-EXP-DT          PIC X(2).
   454             20  FILLER                  PIC X(11).
   455         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   456             20  PI-OE-REFERENCE-1.
   457                 25  PI-OE-REF-1-PRIME   PIC X(18).
   458                 25  PI-OE-REF-1-SUFF    PIC XX.
   459
   460     12  PI-SESSION-IN-PROGRESS          PIC X.
   461         88  CLAIM-SESSION                   VALUE '1'.
   462         88  CREDIT-SESSION                  VALUE '2'.
   463         88  WARRANTY-SESSION                VALUE '3'.
   464         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL151.cbl
   465         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   466
   467
   468*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   469
   470     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   471     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   472
   473     12  PI-CREDIT-USER                  PIC X.
   474         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   475         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   476
   477     12  PI-CLAIM-USER                   PIC X.
   478         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   479         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   480
   481     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   482         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   483         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   484         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   485         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   486         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   487
   488     12  PI-PROCESSOR-ID                 PIC X(4).
   489
   490     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   491
   492     12  PI-MEMBER-CAPTION               PIC X(10).
   493
   494     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   495         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   496
   497     12  PI-LIFE-OVERRIDE-L1             PIC X.
   498     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   499     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   500     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   501
   502     12  PI-AH-OVERRIDE-L1               PIC X.
   503     12  PI-AH-OVERRIDE-L2               PIC XX.
   504     12  PI-AH-OVERRIDE-L6               PIC X(6).
   505     12  PI-AH-OVERRIDE-L12              PIC X(12).
   506
   507     12  PI-NEW-SYSTEM                   PIC X(2).
   508
   509     12  PI-PRIMARY-CERT-NO              PIC X(11).
   510     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   511         88  PI-USES-PAID-TO                 VALUE '1'.
   512     12  PI-CRDTCRD-SYSTEM.
   513         16  PI-CRDTCRD-USER             PIC X.
   514             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   515             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   516         16  PI-CC-MONTH-END-DT          PIC XX.
   517     12  PI-PROCESSOR-PRINTER            PIC X(4).
   518
   519     12  PI-OE-REFERENCE-2.
   520         16  PI-OE-REF-2-PRIME           PIC X(10).
   521         16  PI-OE-REF-2-SUFF            PIC X.
   522
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL151.cbl
   523     12  PI-REM-TRM-CALC-OPTION          PIC X.
   524
   525     12  PI-LANGUAGE-TYPE                PIC X.
   526             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   527             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   528             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   529
   530     12  PI-POLICY-LINKAGE-IND           PIC X.
   531         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   532         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   533                                                   LOW-VALUES.
   534
   535     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   536     12  PI-CLAIM-PW-SESSION             PIC X(1).
   537         88  PI-CLAIM-CREDIT                 VALUE '1'.
   538         88  PI-CLAIM-CONVEN                 VALUE '2'.
   539     12  FILLER                          PIC X(4).
   540
   541     12  PI-SYSTEM-LEVEL                 PIC X(145).
   542
   543     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   544         PI-SYSTEM-LEVEL.
   545
   546         16  PI-ENTRY-CODES.
   547             20  PI-ENTRY-CD-1           PIC X.
   548             20  PI-ENTRY-CD-2           PIC X.
   549
   550         16  PI-RETURN-CODES.
   551             20  PI-RETURN-CD-1          PIC X.
   552             20  PI-RETURN-CD-2          PIC X.
   553
   554         16  PI-UPDATE-STATUS-SAVE.
   555             20  PI-UPDATE-BY            PIC X(4).
   556             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   557
   558         16  PI-LOWER-CASE-LETTERS       PIC X.
   559             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   560
   561*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   562*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   563*            88  CARRIER-CLM-CNTL            VALUE '2'.
   564
   565         16  PI-CERT-ACCESS-CONTROL      PIC X.
   566             88  ST-ACCNT-CNTL               VALUE ' '.
   567             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   568             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   569             88  ACCNT-CNTL                  VALUE '3'.
   570             88  CARR-ACCNT-CNTL             VALUE '4'.
   571
   572         16  PI-PROCESSOR-CAP-LIST.
   573             20  PI-SYSTEM-CONTROLS.
   574                24 PI-SYSTEM-DISPLAY     PIC X.
   575                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   576                24 PI-SYSTEM-MODIFY      PIC X.
   577                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   578             20  FILLER                  PIC XX.
   579             20  PI-DISPLAY-CAP          PIC X.
   580                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL151.cbl
   581             20  PI-MODIFY-CAP           PIC X.
   582                 88  MODIFY-CAP              VALUE 'Y'.
   583             20  PI-MSG-AT-LOGON-CAP     PIC X.
   584                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   585             20  PI-FORCE-CAP            PIC X.
   586                 88  FORCE-CAP               VALUE 'Y'.
   587
   588         16  PI-PROGRAM-CONTROLS.
   589             20  PI-PGM-PRINT-OPT        PIC X.
   590             20  PI-PGM-FORMAT-OPT       PIC X.
   591             20  PI-PGM-PROCESS-OPT      PIC X.
   592             20  PI-PGM-TOTALS-OPT       PIC X.
   593
   594         16  PI-HELP-INTERFACE.
   595             20  PI-LAST-ERROR-NO        PIC X(4).
   596             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   597
   598         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   599             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   600
   601         16  PI-CR-CONTROL-IN-PROGRESS.
   602             20  PI-CR-CARRIER           PIC X.
   603             20  PI-CR-GROUPING          PIC X(6).
   604             20  PI-CR-STATE             PIC XX.
   605             20  PI-CR-ACCOUNT           PIC X(10).
   606             20  PI-CR-FIN-RESP          PIC X(10).
   607             20  PI-CR-TYPE              PIC X.
   608
   609         16  PI-CR-BATCH-NUMBER          PIC X(6).
   610
   611         16  PI-CR-MONTH-END-DT          PIC XX.
   612
   613         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   614             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   615             88  PI-ZERO-CARRIER             VALUE '1'.
   616             88  PI-ZERO-GROUPING            VALUE '2'.
   617             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   618
   619         16  PI-CARRIER-SECURITY         PIC X.
   620             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   621
   622         16  PI-ACCOUNT-SECURITY         PIC X(10).
   623             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   624             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   625
   626         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   627             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   628                                         INDEXED BY PI-ACCESS-NDX
   629                                         PIC X.
   630
   631         16  PI-GA-BILLING-CONTROL       PIC X.
   632             88  PI-GA-BILLING               VALUE '1'.
   633
   634         16  PI-MAIL-PROCESSING          PIC X.
   635             88  PI-MAIL-YES                 VALUE 'Y'.
   636
   637         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   638
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL151.cbl
   639         16  PI-AR-SYSTEM.
   640             20  PI-AR-PROCESSING-CNTL   PIC X.
   641                 88  PI-AR-PROCESSING        VALUE 'Y'.
   642             20  PI-AR-SUMMARY-CODE      PIC X(6).
   643             20  PI-AR-MONTH-END-DT      PIC XX.
   644
   645         16  PI-MP-SYSTEM.
   646             20  PI-MORTGAGE-USER            PIC X.
   647                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   648                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   649             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   650                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   651                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   652                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   653                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   654                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   655             20  PI-MP-MONTH-END-DT          PIC XX.
   656             20  PI-MP-REFERENCE-NO.
   657                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   658                 24  PI-MP-REFERENCE-SFX     PIC XX.
   659
   660         16  PI-LABEL-CONTROL            PIC X(01).
   661             88  PI-CREATE-LABELS                    VALUE 'Y'.
   662             88  PI-BYPASS-LABELS                    VALUE 'N'.
   663
   664         16  PI-BILL-GROUPING-CODE       PIC X(01).
   665             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   666
   667         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   668             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   669             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   670
   671         16  FILLER                      PIC X(14).
   672
   673     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   674******************************************************************
   675     12  PI-REDEFINES REDEFINES PI-PROGRAM-WORK-AREA.
   676         16  PI-PREV-TRLR-KEY        PIC X(22).
   677*00252          16  FILLER                  PIC X(618).
   678         16  PI-PROOF-DATE           PIC 9(6).
   679         16  FILLER                  PIC X(612).
   680
   681* DLO023
   682 01  DL23-COMM-LENGTH              PIC S9(4) COMP VALUE +132.
   683 01  WS-DLO-CODES-TABLE.
   684     12  DL23-SYSTEM-ID            PIC XX.
   685     12  DL23-RECORD-TYPE          PIC XX.
   686     12  DL23-RECORD-KEY           PIC X(6).
   687     12  DL23-RETURN-CODE          PIC XX.
   688     12  DL23-CODE-DESC.
   689         16  DL23-CODE-TEXT        PIC X(20).
   690         16  DL23-RET-CODE         PIC X(40).
   691     12  DL23-GEN-DESC-1           PIC X(20).
   692     12  DL23-GEN-DESC-2           PIC X(20).
   693     12  DL23-GEN-DESC-3           PIC X(20).
   694
   695 01  DMD-DATE-YYYYMMDD.
   696     12  DMD-DECADE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL151.cbl
   697     12  DMD-YYMMDD.
   698         16  DMD-YY          PIC XX      VALUE SPACES.
   699         16  DMD-MM          PIC XX      VALUE SPACES.
   700         16  DMD-DD          PIC XX      VALUE SPACES.
   701
   702     12  W-NAME-LAST             PIC  X(15).
   703     12  W-NAME-FIRST            PIC  X(15).
   704     12  W-NAME-MIDDLE.
   705         16  FILLER              PIC  X(01).
   706         16  W-NAME-MIDDLE-2     PIC  X(01).
   707         16  FILLER              PIC  X(13).
   708
   709*                                    COPY ELCDCTB.
   710******************************************************************
   711*                                                                *
   712*                                                                *
   713*                            ELCDCTB.                            *
   714*                            VMOD=2.002                          *
   715*                                                                *
   716*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   717*       COMMUNICATIONS AREA                                      *
   718*                                                                *
   719******************************************************************
   720 01  DCT-COMMUNICATION-AREA.
   721     12  DCT-BILLING-BANK-ID      PIC  X(05).
   722     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   723     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   724     12  DCT-PRODUCT-CODE         PIC  X(02).
   725     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   726     12  DCT-RETURN-CODE          PIC  X(02).
   727     12  DCT-MAIL-CODE            PIC  X(05).
   728     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   729     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL151.cbl
   731*                                    COPY ELCATTR.
   732******************************************************************
   733*                                                                *
   734*                            ELCATTR.                            *
   735*                            VMOD=2.001                          *
   736*                                                                *
   737*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   738*                                                                *
   739*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   740*                                                                *
   741*                   POS 1   P=PROTECTED                          *
   742*                           U=UNPROTECTED                        *
   743*                           S=ASKIP                              *
   744*                   POS 2   A=ALPHA/NUMERIC                      *
   745*                           N=NUMERIC                            *
   746*                   POS 3   N=NORMAL                             *
   747*                           B=BRIGHT                             *
   748*                           D=DARK                               *
   749*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   750*                           OF=MODIFIED DATA TAG OFF             *
   751*                                                                *
   752*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   753******************************************************************
   754 01  ATTRIBUTE-LIST.
   755     12  AL-PABOF            PIC X       VALUE 'Y'.
   756     12  AL-PABON            PIC X       VALUE 'Z'.
   757     12  AL-PADOF            PIC X       VALUE '%'.
   758     12  AL-PADON            PIC X       VALUE '_'.
   759     12  AL-PANOF            PIC X       VALUE '-'.
   760     12  AL-PANON            PIC X       VALUE '/'.
   761     12  AL-SABOF            PIC X       VALUE '8'.
   762     12  AL-SABON            PIC X       VALUE '9'.
   763     12  AL-SADOF            PIC X       VALUE '@'.
   764     12  AL-SADON            PIC X       VALUE QUOTE.
   765     12  AL-SANOF            PIC X       VALUE '0'.
   766     12  AL-SANON            PIC X       VALUE '1'.
   767     12  AL-UABOF            PIC X       VALUE 'H'.
   768     12  AL-UABON            PIC X       VALUE 'I'.
   769     12  AL-UADOF            PIC X       VALUE '<'.
   770     12  AL-UADON            PIC X       VALUE '('.
   771     12  AL-UANOF            PIC X       VALUE ' '.
   772     12  AL-UANON            PIC X       VALUE 'A'.
   773     12  AL-UNBOF            PIC X       VALUE 'Q'.
   774     12  AL-UNBON            PIC X       VALUE 'R'.
   775     12  AL-UNDOF            PIC X       VALUE '*'.
   776     12  AL-UNDON            PIC X       VALUE ')'.
   777     12  AL-UNNOF            PIC X       VALUE '&'.
   778     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL151.cbl
   780*                                    COPY ELCLOGOF.
   781******************************************************************
   782*                                                                *
   783*                                                                *
   784*                            ELCLOGOF.                           *
   785*                            VMOD=2.001                          *
   786*                                                                *
   787*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   788*                                                                *
   789******************************************************************
   790 01  CLASIC-LOGOFF.
   791     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   792     12  LOGOFF-TEXT.
   793         16  FILLER          PIC X(5)    VALUE SPACES.
   794         16  LOGOFF-MSG.
   795             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   796             20  FILLER      PIC X       VALUE SPACES.
   797             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   798         16  FILLER          PIC X(80)
   799           VALUE '* YOU ARE NOW LOGGED OFF'.
   800         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   801         16  FILLER          PIC X       VALUE QUOTE.
   802         16  LOGOFF-SYS-MSG  PIC X(17)
   803           VALUE 'S CLAS-IC SYSTEM '.
   804     12  TEXT-MESSAGES.
   805         16  UNACCESS-MSG    PIC X(29)
   806             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   807         16  PGMIDERR-MSG    PIC X(17)
   808             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL151.cbl
   810*                                    COPY ELCDATE.
   811******************************************************************
   812*                                                                *
   813*                                                                *
   814*                            ELCDATE.                            *
   815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   816*                            VMOD=2.003
   817*                                                                *
   818*                                                                *
   819*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   820*                 LENGTH = 200                                   *
   821******************************************************************
   822
   823 01  DATE-CONVERSION-DATA.
   824     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   825     12  DC-OPTION-CODE                PIC X.
   826         88  BIN-TO-GREG                VALUE ' '.
   827         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   828         88  EDIT-GREG-TO-BIN           VALUE '2'.
   829         88  YMD-GREG-TO-BIN            VALUE '3'.
   830         88  MDY-GREG-TO-BIN            VALUE '4'.
   831         88  JULIAN-TO-BIN              VALUE '5'.
   832         88  BIN-PLUS-ELAPSED           VALUE '6'.
   833         88  FIND-CENTURY               VALUE '7'.
   834         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   835         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   836         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   837         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   838         88  JULIAN-TO-BIN-3            VALUE 'C'.
   839         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   840         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   841         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   842         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   843         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   844         88  CHECK-LEAP-YEAR            VALUE 'H'.
   845         88  BIN-3-TO-GREG              VALUE 'I'.
   846         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   847         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   848         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   849         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   850         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   851         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   852         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   853         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   854         88  THREE-CHARACTER-BIN
   855                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   856         88  GREGORIAN-TO-BIN
   857                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   858         88  BIN-TO-GREGORIAN
   859                  VALUES ' ' '1' 'I' '8' 'G'.
   860         88  JULIAN-TO-BINARY
   861                  VALUES '5' 'C' 'E' 'F'.
   862     12  DC-ERROR-CODE                 PIC X.
   863         88  NO-CONVERSION-ERROR        VALUE ' '.
   864         88  DATE-CONVERSION-ERROR
   865                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   866         88  DATE-IS-ZERO               VALUE '1'.
   867         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL151.cbl
   868         88  DATE-IS-INVALID            VALUE '3'.
   869         88  DATE1-GREATER-DATE2        VALUE '4'.
   870         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   871         88  DATE-INVALID-OPTION        VALUE '9'.
   872         88  INVALID-CENTURY            VALUE 'A'.
   873         88  ONLY-CENTURY               VALUE 'B'.
   874         88  ONLY-LEAP-YEAR             VALUE 'C'.
   875         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   876     12  DC-END-OF-MONTH               PIC X.
   877         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   878     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   879         88  USE-NORMAL-PROCESS         VALUE ' '.
   880         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   881         88  ADJUST-UP-100-YRS          VALUE '2'.
   882     12  FILLER                        PIC X.
   883     12  DC-CONVERSION-DATES.
   884         16  DC-BIN-DATE-1             PIC XX.
   885         16  DC-BIN-DATE-2             PIC XX.
   886         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   887         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   888                       DC-GREG-DATE-1-EDIT.
   889             20  DC-EDIT1-MONTH        PIC 99.
   890             20  SLASH1-1              PIC X.
   891             20  DC-EDIT1-DAY          PIC 99.
   892             20  SLASH1-2              PIC X.
   893             20  DC-EDIT1-YEAR         PIC 99.
   894         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   895         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   896                     DC-GREG-DATE-2-EDIT.
   897             20  DC-EDIT2-MONTH        PIC 99.
   898             20  SLASH2-1              PIC X.
   899             20  DC-EDIT2-DAY          PIC 99.
   900             20  SLASH2-2              PIC X.
   901             20  DC-EDIT2-YEAR         PIC 99.
   902         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   903         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   904                     DC-GREG-DATE-1-YMD.
   905             20  DC-YMD-YEAR           PIC 99.
   906             20  DC-YMD-MONTH          PIC 99.
   907             20  DC-YMD-DAY            PIC 99.
   908         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   909         16  DC-GREG-DATE-1-MDY-R REDEFINES
   910                      DC-GREG-DATE-1-MDY.
   911             20  DC-MDY-MONTH          PIC 99.
   912             20  DC-MDY-DAY            PIC 99.
   913             20  DC-MDY-YEAR           PIC 99.
   914         16  DC-GREG-DATE-1-ALPHA.
   915             20  DC-ALPHA-MONTH        PIC X(10).
   916             20  DC-ALPHA-DAY          PIC 99.
   917             20  FILLER                PIC XX.
   918             20  DC-ALPHA-CENTURY.
   919                 24 DC-ALPHA-CEN-N     PIC 99.
   920             20  DC-ALPHA-YEAR         PIC 99.
   921         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   922         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   923         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   924         16  DC-JULIAN-DATE            PIC 9(05).
   925         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL151.cbl
   926                                       PIC 9(05).
   927         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   928             20  DC-JULIAN-YEAR        PIC 99.
   929             20  DC-JULIAN-DAYS        PIC 999.
   930         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   931         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   932         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   933     12  DATE-CONVERSION-VARIBLES.
   934         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   935         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   936             20  FILLER                PIC 9(3).
   937             20  HOLD-CEN-1-CCYY.
   938                 24  HOLD-CEN-1-CC     PIC 99.
   939                 24  HOLD-CEN-1-YY     PIC 99.
   940             20  HOLD-CEN-1-MO         PIC 99.
   941             20  HOLD-CEN-1-DA         PIC 99.
   942         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   943             20  HOLD-CEN-1-R-MO       PIC 99.
   944             20  HOLD-CEN-1-R-DA       PIC 99.
   945             20  HOLD-CEN-1-R-CCYY.
   946                 24  HOLD-CEN-1-R-CC   PIC 99.
   947                 24  HOLD-CEN-1-R-YY   PIC 99.
   948             20  FILLER                PIC 9(3).
   949         16  HOLD-CENTURY-1-X.
   950             20  FILLER                PIC X(3)  VALUE SPACES.
   951             20  HOLD-CEN-1-X-CCYY.
   952                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   953                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   954             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   955             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   956         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   957             20  HOLD-CEN-1-R-X-MO     PIC XX.
   958             20  HOLD-CEN-1-R-X-DA     PIC XX.
   959             20  HOLD-CEN-1-R-X-CCYY.
   960                 24  HOLD-CEN-1-R-X-CC PIC XX.
   961                 24  HOLD-CEN-1-R-X-YY PIC XX.
   962             20  FILLER                PIC XXX.
   963         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   964         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   965         16  DC-JULIAN-DATE-1          PIC 9(07).
   966         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   967             20  DC-JULIAN-1-CCYY.
   968                 24  DC-JULIAN-1-CC    PIC 99.
   969                 24  DC-JULIAN-1-YR    PIC 99.
   970             20  DC-JULIAN-DA-1        PIC 999.
   971         16  DC-JULIAN-DATE-2          PIC 9(07).
   972         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   973             20  DC-JULIAN-2-CCYY.
   974                 24  DC-JULIAN-2-CC    PIC 99.
   975                 24  DC-JULIAN-2-YR    PIC 99.
   976             20  DC-JULIAN-DA-2        PIC 999.
   977         16  DC-GREG-DATE-A-EDIT.
   978             20  DC-EDITA-MONTH        PIC 99.
   979             20  SLASHA-1              PIC X VALUE '/'.
   980             20  DC-EDITA-DAY          PIC 99.
   981             20  SLASHA-2              PIC X VALUE '/'.
   982             20  DC-EDITA-CCYY.
   983                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL151.cbl
   984                 24  DC-EDITA-YEAR     PIC 99.
   985         16  DC-GREG-DATE-B-EDIT.
   986             20  DC-EDITB-MONTH        PIC 99.
   987             20  SLASHB-1              PIC X VALUE '/'.
   988             20  DC-EDITB-DAY          PIC 99.
   989             20  SLASHB-2              PIC X VALUE '/'.
   990             20  DC-EDITB-CCYY.
   991                 24  DC-EDITB-CENT     PIC 99.
   992                 24  DC-EDITB-YEAR     PIC 99.
   993         16  DC-GREG-DATE-CYMD         PIC 9(08).
   994         16  DC-GREG-DATE-CYMD-R REDEFINES
   995                              DC-GREG-DATE-CYMD.
   996             20  DC-CYMD-CEN           PIC 99.
   997             20  DC-CYMD-YEAR          PIC 99.
   998             20  DC-CYMD-MONTH         PIC 99.
   999             20  DC-CYMD-DAY           PIC 99.
  1000         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1001         16  DC-GREG-DATE-MDCY-R REDEFINES
  1002                              DC-GREG-DATE-MDCY.
  1003             20  DC-MDCY-MONTH         PIC 99.
  1004             20  DC-MDCY-DAY           PIC 99.
  1005             20  DC-MDCY-CEN           PIC 99.
  1006             20  DC-MDCY-YEAR          PIC 99.
  1007    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1008        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1009    12  DC-EL310-DATE                  PIC X(21).
  1010    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL151.cbl
  1012*                                    COPY ELCEMIB.
  1013******************************************************************
  1014*                                                                *
  1015*                                                                *
  1016*                            ELCEMIB.                            *
  1017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1018*                            VMOD=2.005                          *
  1019*                                                                *
  1020*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1021*                                                                *
  1022******************************************************************
  1023 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1024     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1025     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1026     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1027     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1028     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1029     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1030     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1031     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1032     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1033         88  EMI-NO-ERRORS                    VALUE '1'.
  1034         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1035         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1036     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1037         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1038     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1039         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1040         88  EMI-AREA1-FULL                   VALUE '2'.
  1041     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1042         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1043         88  EMI-AREA2-FULL                   VALUE '2'.
  1044     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1045         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1046         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1047         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1048         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1049         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1050     12  EMI-ERROR-LINES.
  1051         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1052         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1053         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1054         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1055             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1056                 24  EMI-ERR-NUM         PIC X(4).
  1057                 24  EMI-FILLER          PIC X.
  1058                 24  EMI-SEV             PIC X.
  1059                 24  FILLER              PIC X.
  1060             20  FILLER                  PIC X(02).
  1061     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1062         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1063             20  EMI-ERROR-NUMBER    PIC X(4).
  1064             20  EMI-FILL            PIC X.
  1065             20  EMI-SEVERITY        PIC X.
  1066             20  FILLER              PIC X.
  1067             20  EMI-ERROR-TEXT.
  1068                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1069                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL151.cbl
  1070     12  EMI-SEVERITY-SAVE           PIC X.
  1071         88  EMI-NOTE                    VALUE 'N'.
  1072         88  EMI-WARNING                 VALUE 'W'.
  1073         88  EMI-FORCABLE                VALUE 'F'.
  1074         88  EMI-FATAL                   VALUE 'X'.
  1075     12  EMI-MESSAGE-FLAG            PIC X.
  1076         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1077         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1078     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1079     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1080         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1081         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1082         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1083     12  FILLER                      PIC X(137)  VALUE SPACES.
  1084     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1085     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1086     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1087     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL151.cbl
  1089*                                    COPY EL151S.
  1090 01  EL151AI.
  1091     05  FILLER            PIC  X(0012).
  1092*    -------------------------------
  1093     05  MRNDATEL PIC S9(0004) COMP.
  1094     05  MRNDATEF PIC  X(0001).
  1095     05  FILLER REDEFINES MRNDATEF.
  1096         10  MRNDATEA PIC  X(0001).
  1097     05  MRNDATEI PIC  X(0008).
  1098*    -------------------------------
  1099     05  MRNTIMEL PIC S9(0004) COMP.
  1100     05  MRNTIMEF PIC  X(0001).
  1101     05  FILLER REDEFINES MRNTIMEF.
  1102         10  MRNTIMEA PIC  X(0001).
  1103     05  MRNTIMEI PIC  X(0005).
  1104*    -------------------------------
  1105     05  MLINE1L PIC S9(0004) COMP.
  1106     05  MLINE1F PIC  X(0001).
  1107     05  FILLER REDEFINES MLINE1F.
  1108         10  MLINE1A PIC  X(0001).
  1109     05  MLINE1I PIC  X(0060).
  1110*    -------------------------------
  1111     05  MLINE2L PIC S9(0004) COMP.
  1112     05  MLINE2F PIC  X(0001).
  1113     05  FILLER REDEFINES MLINE2F.
  1114         10  MLINE2A PIC  X(0001).
  1115     05  MLINE2I PIC  X(0060).
  1116*    -------------------------------
  1117     05  MDENCDL PIC S9(0004) COMP.
  1118     05  MDENCDF PIC  X(0001).
  1119     05  FILLER REDEFINES MDENCDF.
  1120         10  MDENCDA PIC  X(0001).
  1121     05  MDENCDI PIC  X(0004).
  1122*    -------------------------------
  1123     05  MPRFDTL PIC S9(0004) COMP.
  1124     05  MPRFDTF PIC  X(0001).
  1125     05  FILLER REDEFINES MPRFDTF.
  1126         10  MPRFDTA PIC  X(0001).
  1127     05  MPRFDTI PIC  X(0008).
  1128*    -------------------------------
  1129     05  MERMSG1L PIC S9(0004) COMP.
  1130     05  MERMSG1F PIC  X(0001).
  1131     05  FILLER REDEFINES MERMSG1F.
  1132         10  MERMSG1A PIC  X(0001).
  1133     05  MERMSG1I PIC  X(0070).
  1134*    -------------------------------
  1135     05  MERMSG2L PIC S9(0004) COMP.
  1136     05  MERMSG2F PIC  X(0001).
  1137     05  FILLER REDEFINES MERMSG2F.
  1138         10  MERMSG2A PIC  X(0001).
  1139     05  MERMSG2I PIC  X(0070).
  1140*    -------------------------------
  1141     05  MPFNUMBL PIC S9(0004) COMP.
  1142     05  MPFNUMBF PIC  X(0001).
  1143     05  FILLER REDEFINES MPFNUMBF.
  1144         10  MPFNUMBA PIC  X(0001).
  1145     05  MPFNUMBI PIC  99.
  1146 01  EL151AO REDEFINES EL151AI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL151.cbl
  1147     05  FILLER            PIC  X(0012).
  1148*    -------------------------------
  1149     05  FILLER            PIC  X(0003).
  1150     05  MRNDATEO PIC  X(0008).
  1151*    -------------------------------
  1152     05  FILLER            PIC  X(0003).
  1153     05  MRNTIMEO PIC  99.99.
  1154*    -------------------------------
  1155     05  FILLER            PIC  X(0003).
  1156     05  MLINE1O PIC  X(0060).
  1157*    -------------------------------
  1158     05  FILLER            PIC  X(0003).
  1159     05  MLINE2O PIC  X(0060).
  1160*    -------------------------------
  1161     05  FILLER            PIC  X(0003).
  1162     05  MDENCDO PIC  X(0004).
  1163*    -------------------------------
  1164     05  FILLER            PIC  X(0003).
  1165     05  MPRFDTO PIC  99B99B99.
  1166*    -------------------------------
  1167     05  FILLER            PIC  X(0003).
  1168     05  MERMSG1O PIC  X(0070).
  1169*    -------------------------------
  1170     05  FILLER            PIC  X(0003).
  1171     05  MERMSG2O PIC  X(0070).
  1172*    -------------------------------
  1173     05  FILLER            PIC  X(0003).
  1174     05  MPFNUMBO PIC  99.
  1175*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL151.cbl
  1177*                                    COPY ELCDMO.
  1178******************************************************************
  1179*                                                                *
  1180*                                                                *
  1181*                            ELCDMO.                             *
  1182*                            VMOD=2.004                          *
  1183*                                                                *
  1184*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1185*        COMMUNICATION AREA                                      *
  1186*   FILE TYPE = NA                                               *
  1187*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1188*                                                                *
  1189******************************************************************
  1190 01  DMO-COMMUNICATION-AREA.
  1191     12  DM-RECORD-TYPE                  PIC  X(02).
  1192             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1193             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1194             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1195     12  DM-DIST-CODE                    PIC  X(04).
  1196     12  DM-MAIL-CODE                    PIC  X(05).
  1197     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1198     12  DM-INSURED-NAME                 PIC  X(30).
  1199     12  DM-CLAIM-NO                     PIC  X(07).
  1200     12  DM-CLAIM-TYPE                   PIC  X.
  1201
  1202     12  DM-STATUS-DATA-AREA.
  1203         16  DM-CLAIM-STATUS             PIC  X.
  1204             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1205             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1206             88  DM-CLOSED                        VALUE '3'.
  1207             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1208             88  DM-DEFAULT                       VALUE '9'.
  1209         16  DM-STATUS-DATE              PIC  X(08).
  1210******YYYYMMDD
  1211         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1212             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1213             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1214             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1215             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1216             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1217             88  DM-RE-OPENED                     VALUE 'R'.
  1218             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1219             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1220             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1221         16  DM-STAT-CARRIER             PIC X.
  1222
  1223     12  DM-DRAFT-DATA-AREA.
  1224         16  DM-PAYMENT-TYPE             PIC  X.
  1225             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1226         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1227         16  DM-PAYMENT-DATE             PIC  X(08).
  1228******YYYYMMDD
  1229         16  DM-CERT-NO                  PIC  X(11).
  1230         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1231         16  DM-CARRIER                  PIC  X.
  1232
  1233     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL151.cbl
  1235****************************************************************
  1236*
  1237* Copyright (c) 2007 by Clerity Solutions, Inc.
  1238* All rights reserved.
  1239*
  1240****************************************************************
  1241 01  DFHEIV.
  1242   02  DFHEIV0               PIC X(35).
  1243   02  DFHEIV1               PIC X(08).
  1244   02  DFHEIV2               PIC X(08).
  1245   02  DFHEIV3               PIC X(08).
  1246   02  DFHEIV4               PIC X(06).
  1247   02  DFHEIV5               PIC X(04).
  1248   02  DFHEIV6               PIC X(04).
  1249   02  DFHEIV7               PIC X(02).
  1250   02  DFHEIV8               PIC X(02).
  1251   02  DFHEIV9               PIC X(01).
  1252   02  DFHEIV10              PIC S9(7) COMP-3.
  1253   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1254   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1255   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1256   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1257   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1258   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1259   02  DFHEIV17              PIC X(04).
  1260   02  DFHEIV18              PIC X(04).
  1261   02  DFHEIV19              PIC X(04).
  1262   02  DFHEIV20              USAGE IS POINTER.
  1263   02  DFHEIV21              USAGE IS POINTER.
  1264   02  DFHEIV22              USAGE IS POINTER.
  1265   02  DFHEIV23              USAGE IS POINTER.
  1266   02  DFHEIV24              USAGE IS POINTER.
  1267   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1268   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1269   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1270   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1271   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1272   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1273   02  FILLER                PIC X(02).
  1274   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1275   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1276   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1277   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1278   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1279 LINKAGE  SECTION.
  1280*****************************************************************
  1281*                                                               *
  1282* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1283* All rights reserved.                                          *
  1284*                                                               *
  1285*****************************************************************
  1286 01  dfheiblk.
  1287     02  eibtime          pic s9(7) comp-3.
  1288     02  eibdate          pic s9(7) comp-3.
  1289     02  eibtrnid         pic x(4).
  1290     02  eibtaskn         pic s9(7) comp-3.
  1291     02  eibtrmid         pic x(4).
  1292     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL151.cbl
  1293     02  eibcposn         pic s9(4) comp.
  1294     02  eibcalen         pic s9(4) comp.
  1295     02  eibaid           pic x(1).
  1296     02  eibfiller1       pic x(1).
  1297     02  eibfn            pic x(2).
  1298     02  eibfiller2       pic x(2).
  1299     02  eibrcode         pic x(6).
  1300     02  eibfiller3       pic x(2).
  1301     02  eibds            pic x(8).
  1302     02  eibreqid         pic x(8).
  1303     02  eibrsrce         pic x(8).
  1304     02  eibsync          pic x(1).
  1305     02  eibfree          pic x(1).
  1306     02  eibrecv          pic x(1).
  1307     02  eibsend          pic x(1).
  1308     02  eibatt           pic x(1).
  1309     02  eibeoc           pic x(1).
  1310     02  eibfmh           pic x(1).
  1311     02  eibcompl         pic x(1).
  1312     02  eibsig           pic x(1).
  1313     02  eibconf          pic x(1).
  1314     02  eiberr           pic x(1).
  1315     02  eibrldbk         pic x(1).
  1316     02  eiberrcd         pic x(4).
  1317     02  eibsynrb         pic x(1).
  1318     02  eibnodat         pic x(1).
  1319     02  eibfiller5       pic x(2).
  1320     02  eibresp          pic 9(09) comp.
  1321     02  eibresp2         pic 9(09) comp.
  1322     02  dfheigdj         pic s9(4) comp.
  1323     02  dfheigdk         pic s9(4) comp.
  1324 01  DFHCOMMAREA                     PICTURE X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL151.cbl
  1326*                                    COPY ELCMSTR.
  1327******************************************************************
  1328*                                                                *
  1329*                            ELCMSTR.                            *
  1330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1331*                            VMOD=2.012                          *
  1332*                                                                *
  1333*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1334*                                                                *
  1335*   FILE TYPE = VSAM,KSDS                                        *
  1336*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1337*                                                                *
  1338*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1339*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1340*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1341*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1342*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1343*                                                 RKP=75,LEN=21  *
  1344*                                                                *
  1345*   **** NOTE ****                                               *
  1346*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1347*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1348*                                                                *
  1349*   LOG = YES                                                    *
  1350*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1351******************************************************************
  1352*                   C H A N G E   L O G
  1353*
  1354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1355*-----------------------------------------------------------------
  1356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1357* EFFECTIVE    NUMBER
  1358*-----------------------------------------------------------------
  1359* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1360* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1361******************************************************************
  1362 01  CLAIM-MASTER.
  1363     12  CL-RECORD-ID                PIC XX.
  1364         88  VALID-CL-ID         VALUE 'CL'.
  1365
  1366     12  CL-CONTROL-PRIMARY.
  1367         16  CL-COMPANY-CD           PIC X.
  1368         16  CL-CARRIER              PIC X.
  1369         16  CL-CLAIM-NO             PIC X(7).
  1370         16  CL-CERT-NO.
  1371             20  CL-CERT-PRIME       PIC X(10).
  1372             20  CL-CERT-SFX         PIC X.
  1373
  1374     12  CL-CONTROL-BY-NAME.
  1375         16  CL-COMPANY-CD-A1        PIC X.
  1376         16  CL-INSURED-LAST-NAME    PIC X(15).
  1377         16  CL-INSURED-NAME.
  1378             20  CL-INSURED-1ST-NAME PIC X(12).
  1379             20  CL-INSURED-MID-INIT PIC X.
  1380
  1381     12  CL-CONTROL-BY-SSN.
  1382         16  CL-COMPANY-CD-A2        PIC X.
  1383         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL151.cbl
  1384             20  CL-SSN-STATE        PIC XX.
  1385             20  CL-SSN-ACCOUNT      PIC X(6).
  1386             20  CL-SSN-LN3          PIC X(3).
  1387
  1388     12  CL-CONTROL-BY-CERT-NO.
  1389         16  CL-COMPANY-CD-A4        PIC X.
  1390         16  CL-CERT-NO-A4.
  1391             20  CL-CERT-A4-PRIME    PIC X(10).
  1392             20  CL-CERT-A4-SFX      PIC X.
  1393
  1394     12  CL-CONTROL-BY-CCN.
  1395         16  CL-COMPANY-CD-A5        PIC X.
  1396         16  CL-CCN-A5.
  1397             20  CL-CCN.
  1398                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1399                 24  CL-CCN-PRIME-A5 PIC X(12).
  1400             20  CL-CCN-FILLER-A5    PIC X(4).
  1401
  1402     12  CL-INSURED-PROFILE-DATA.
  1403         16  CL-INSURED-BIRTH-DT     PIC XX.
  1404         16  CL-INSURED-SEX-CD       PIC X.
  1405             88  INSURED-IS-MALE        VALUE 'M'.
  1406             88  INSURED-IS-FEMALE      VALUE 'F'.
  1407             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1408         16  CL-INSURED-OCC-CD       PIC X(6).
  1409         16  FILLER                  PIC X(5).
  1410
  1411     12  CL-PROCESSING-INFO.
  1412         16  CL-PROCESSOR-ID         PIC X(4).
  1413         16  CL-CLAIM-STATUS         PIC X.
  1414             88  CLAIM-IS-OPEN          VALUE 'O'.
  1415             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1416         16  CL-CLAIM-TYPE           PIC X.
  1417*            88  AH-CLAIM               VALUE 'A'.
  1418*            88  LIFE-CLAIM             VALUE 'L'.
  1419*            88  PROPERTY-CLAIM         VALUE 'P'.
  1420*            88  IUI-CLAIM              VALUE 'I'.
  1421*            88  GAP-CLAIM              VALUE 'G'.
  1422         16  CL-CLAIM-PREM-TYPE      PIC X.
  1423             88  SINGLE-PREMIUM         VALUE '1'.
  1424             88  O-B-COVERAGE           VALUE '2'.
  1425             88  OPEN-END-COVERAGE      VALUE '3'.
  1426         16  CL-INCURRED-DT          PIC XX.
  1427         16  CL-REPORTED-DT          PIC XX.
  1428         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1429         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1430         16  CL-LAST-PMT-DT          PIC XX.
  1431         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1432         16  CL-PAID-THRU-DT         PIC XX.
  1433         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1434         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1435         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1436         16  CL-PMT-CALC-METHOD      PIC X.
  1437             88  CL-360-DAY-YR          VALUE '1'.
  1438             88  CL-365-DAY-YR          VALUE '2'.
  1439             88  CL-FULL-MONTHS         VALUE '3'.
  1440         16  CL-CAUSE-CD             PIC X(6).
  1441
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL151.cbl
  1442         16  CL-PRIME-CERT-NO.
  1443             20  CL-PRIME-CERT-PRIME PIC X(10).
  1444             20  CL-PRIME-CERT-SFX   PIC X.
  1445
  1446         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1447             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1448             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1449
  1450         16  CL-MICROFILM-NO         PIC X(10).
  1451         16  CL-PROG-FORM-TYPE       PIC X.
  1452         16  CL-LAST-ADD-ON-DT       PIC XX.
  1453
  1454         16  CL-LAST-REOPEN-DT       PIC XX.
  1455         16  CL-LAST-CLOSE-DT        PIC XX.
  1456         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1457             88  FINAL-PAID             VALUE '1'.
  1458             88  CLAIM-DENIED           VALUE '2'.
  1459             88  AUTO-CLOSE             VALUE '3'.
  1460             88  MANUAL-CLOSE           VALUE '4'.
  1461             88  BENEFITS-CHANGED       VALUE 'C'.
  1462             88  SETUP-ERRORS           VALUE 'E'.
  1463         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1464         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1465         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1466             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1467         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1468         16  FILLER                  PIC X.
  1469
  1470     12  CL-CERTIFICATE-DATA.
  1471         16  CL-CERT-ORIGIN          PIC X.
  1472             88  CERT-WAS-ONLINE        VALUE '1'.
  1473             88  CERT-WAS-CREATED       VALUE '2'.
  1474             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1475         16  CL-CERT-KEY-DATA.
  1476             20  CL-CERT-CARRIER     PIC X.
  1477             20  CL-CERT-GROUPING    PIC X(6).
  1478             20  CL-CERT-STATE       PIC XX.
  1479             20  CL-CERT-ACCOUNT.
  1480                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1481                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1482             20  CL-CERT-EFF-DT      PIC XX.
  1483
  1484     12  CL-STATUS-CONTROLS.
  1485         16  CL-PRIORITY-CD          PIC X.
  1486             88  CONFIDENTIAL-DATA      VALUE '8'.
  1487             88  HIGHEST-PRIORITY       VALUE '9'.
  1488         16  CL-SUPV-ATTN-CD         PIC X.
  1489             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1490             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1491         16  CL-PURGED-DT            PIC XX.
  1492         16  CL-RESTORED-DT          PIC XX.
  1493         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1494         16  CL-NEXT-RESEND-DT       PIC XX.
  1495         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1496         16  FILLER                  PIC XX.
  1497         16  CL-LAST-MAINT-DT        PIC XX.
  1498         16  CL-LAST-MAINT-USER      PIC X(4).
  1499         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL151.cbl
  1500         16  CL-LAST-MAINT-TYPE      PIC X.
  1501             88  CLAIM-SET-UP           VALUE ' '.
  1502             88  PAYMENT-MADE           VALUE '1'.
  1503             88  LETTER-SENT            VALUE '2'.
  1504             88  MASTER-WAS-ALTERED     VALUE '3'.
  1505             88  MASTER-WAS-RESTORED    VALUE '4'.
  1506             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1507             88  FILE-CONVERTED         VALUE '6'.
  1508             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1509             88  ERROR-CORRECTION       VALUE 'E'.
  1510         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1511         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1512         16  CL-BENEFICIARY          PIC X(10).
  1513         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1514         16  CL-DENIAL-TYPE          PIC X.
  1515             88  CL-TYPE-DENIAL          VALUE '1'.
  1516             88  CL-TYPE-RESCISSION      VALUE '2'.
  1517             88  CL-TYPE-REFORMATION     VALUE '3'.
  1518             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1519             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1520         16  FILLER                  PIC X(5).
  1521
  1522     12  CL-TRAILER-CONTROLS.
  1523         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1524             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1525             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1526             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1527         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1528         16  FILLER                  PIC XX.
  1529         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1530         16  CL-ADDRESS-TRAILER-CNT.
  1531             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1532                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1533             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1534                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1535             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1536                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1537             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1538                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1539             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1540                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1541             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1542                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1543             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1544                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1545
  1546     12  CL-CV-REFERENCE-NO.
  1547         16  CL-CV-REFNO-PRIME       PIC X(18).
  1548         16  CL-CV-REFNO-SFX         PIC XX.
  1549
  1550     12  CL-FILE-LOCATION            PIC X(4).
  1551
  1552     12  CL-PROCESS-ERRORS.
  1553         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1554             88  NO-FATAL-ERRORS        VALUE ZERO.
  1555         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1556             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1557
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL151.cbl
  1558     12  CL-PRODUCT-CD               PIC X.
  1559
  1560     12  CL-CURRENT-KEY-DATA.
  1561         16  CL-CURRENT-CARRIER      PIC X.
  1562         16  CL-CURRENT-GROUPING     PIC X(6).
  1563         16  CL-CURRENT-STATE        PIC XX.
  1564         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1565
  1566     12  CL-ASSOCIATES               PIC X.
  1567         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1568         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1569         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1570         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1571
  1572     12  CL-ACTIVITY-CODE            PIC 99.
  1573     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1574     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1575
  1576     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1577     12  CL-LAG-REPORT-CODE          PIC 9.
  1578     12  CL-LOAN-TYPE                PIC XX.
  1579     12  CL-LEGAL-STATE              PIC XX.
  1580
  1581*    12  FILLER                      PIC X(5).
  1582     12  CL-YESNOSW                  PIC X.
  1583     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL151.cbl
  1585*                                    COPY ELCTRLR.
  1586******************************************************************
  1587*                                                                *
  1588*                            ELCTRLR.                            *
  1589*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1590*                            VMOD=2.014                          *
  1591*                                                                *
  1592*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1593*                                                                *
  1594*   FILE TYPE = VSAM,KSDS                                        *
  1595*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1596*                                                                *
  1597*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1598*       ALTERNATE INDEX = NONE                                   *
  1599*                                                                *
  1600*   LOG = YES                                                    *
  1601*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1602******************************************************************
  1603*                   C H A N G E   L O G
  1604*
  1605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1606*-----------------------------------------------------------------
  1607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1608* EFFECTIVE    NUMBER
  1609*-----------------------------------------------------------------
  1610* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1611* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1612* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1613* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1614* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1615* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1616* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1617* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1618* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1619* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1620* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1621* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1622* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1623******************************************************************
  1624 01  ACTIVITY-TRAILERS.
  1625     12  AT-RECORD-ID                    PIC XX.
  1626         88  VALID-AT-ID                       VALUE 'AT'.
  1627
  1628     12  AT-CONTROL-PRIMARY.
  1629         16  AT-COMPANY-CD               PIC X.
  1630         16  AT-CARRIER                  PIC X.
  1631         16  AT-CLAIM-NO                 PIC X(7).
  1632         16  AT-CERT-NO.
  1633             20  AT-CERT-PRIME           PIC X(10).
  1634             20  AT-CERT-SFX             PIC X.
  1635         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1636             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1637             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1638             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1639             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1640             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1641             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1642             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL151.cbl
  1643             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1644             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1645             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1646             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1647             88  AT-BENEFICIARY-TRL           VALUE +91.
  1648             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1649             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1650
  1651     12  AT-TRAILER-TYPE                 PIC X.
  1652         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1653         88  PAYMENT-TR                       VALUE '2'.
  1654         88  AUTO-PAY-TR                      VALUE '3'.
  1655         88  CORRESPONDENCE-TR                VALUE '4'.
  1656         88  ADDRESS-TR                       VALUE '5'.
  1657         88  GENERAL-INFO-TR                  VALUE '6'.
  1658         88  AUTO-PROMPT-TR                   VALUE '7'.
  1659         88  DENIAL-TR                        VALUE '8'.
  1660         88  INCURRED-CHG-TR                  VALUE '9'.
  1661         88  FORM-CONTROL-TR                  VALUE 'A'.
  1662
  1663     12  AT-RECORDED-DT                  PIC XX.
  1664     12  AT-RECORDED-BY                  PIC X(4).
  1665     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1666
  1667     12  AT-TRAILER-BODY                 PIC X(165).
  1668
  1669     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1670         16  AT-RESERVE-CONTROLS.
  1671             20  AT-MANUAL-SW            PIC X.
  1672                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1673             20  AT-FUTURE-SW            PIC X.
  1674                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1675             20  AT-PTC-SW               PIC X.
  1676                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1677             20  AT-IBNR-SW              PIC X.
  1678                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1679             20  AT-PTC-LF-SW            PIC X.
  1680                 88  AT-LF-PTC-USED          VALUE '1'.
  1681             20  AT-CDT-ACCESS-METHOD    PIC X.
  1682                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1683                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1684                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1685             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1686         16  AT-LAST-COMPUTED-DT         PIC XX.
  1687         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  1688         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1689         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1690         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1691         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1692         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1693         16  AT-EXPENSE-CONTROLS.
  1694             20  AT-EXPENSE-METHOD       PIC X.
  1695                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1696                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1697                 88  PERCENT-OF-PMT           VALUE '3'.
  1698                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1699             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1700             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL151.cbl
  1701         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1702         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1703
  1704         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1705         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1706
  1707*        16  FILLER                      PIC X(53).
  1708         16  FILLER                      PIC X(47).
  1709
  1710         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1711         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1712
  1713         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1714             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1715             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1716*                    C = CLOSED
  1717*                    O = OPEN
  1718             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1719*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1720
  1721     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1722         16  AT-PAYMENT-TYPE             PIC X.
  1723             88  PARTIAL-PAYMENT                VALUE '1'.
  1724             88  FINAL-PAYMENT                  VALUE '2'.
  1725             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1726             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1727             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1728             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1729             88  VOIDED-PAYMENT                 VALUE '9'.
  1730             88  TRANSFER                       VALUE 'T'.
  1731             88  LIFE-INTEREST                  VALUE 'I'.
  1732
  1733         16  AT-CLAIM-TYPE               PIC X.
  1734             88  PAID-FOR-AH                    VALUE 'A'.
  1735             88  PAID-FOR-LIFE                  VALUE 'L'.
  1736             88  PAID-FOR-IUI                   VALUE 'I'.
  1737             88  PAID-FOR-GAP                   VALUE 'G'.
  1738         16  AT-CLAIM-PREM-TYPE          PIC X.
  1739             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1740             88  AT-O-B-COVERAGE                VALUE '2'.
  1741             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1742         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1743         16  AT-CHECK-NO                 PIC X(7).
  1744         16  AT-PAID-FROM-DT             PIC XX.
  1745         16  AT-PAID-THRU-DT             PIC XX.
  1746         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1747         16  FILLER                      PIC X.
  1748         16  AT-PAYEES-NAME              PIC X(30).
  1749         16  AT-PAYMENT-ORIGIN           PIC X.
  1750             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1751             88  ONLINE-AUTO-PMT                VALUE '2'.
  1752             88  OFFLINE-PMT                    VALUE '3'.
  1753         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1754         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1755         16  AT-VOID-DATA.
  1756             20  AT-VOID-DT              PIC XX.
  1757*00144       20  AT-VOID-REASON          PIC X(30).
  1758             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL151.cbl
  1759         16  AT-PMT-APPROVED-BY          PIC X(04).
  1760         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1761         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1762         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1763                                         PIC S99V9(5)  COMP-3.
  1764         16  AT-CREDIT-INTERFACE.
  1765             20  AT-PMT-SELECT-DT        PIC XX.
  1766                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1767             20  AT-PMT-ACCEPT-DT        PIC XX.
  1768                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1769             20  AT-VOID-SELECT-DT       PIC XX.
  1770                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1771             20  AT-VOID-ACCEPT-DT       PIC XX.
  1772                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1773
  1774         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1775                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1776                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1777         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1778
  1779         16  AT-FORCE-CONTROL            PIC X.
  1780             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1781         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1782         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1783         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1784         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1785         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1786         16  AT-BENEFIT-TYPE             PIC X.
  1787
  1788         16  AT-EXPENSE-TYPE             PIC X.
  1789         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1790
  1791         16  AT-PAYEE-TYPE-CD.
  1792             20  AT-PAYEE-TYPE           PIC X.
  1793                 88  INSURED-PAID           VALUE 'I'.
  1794                 88  BENEFICIARY-PAID       VALUE 'B'.
  1795                 88  ACCOUNT-PAID           VALUE 'A'.
  1796                 88  OTHER-1-PAID           VALUE 'O'.
  1797                 88  OTHER-2-PAID           VALUE 'Q'.
  1798                 88  DOCTOR-PAID            VALUE 'P'.
  1799                 88  EMPLOYER-PAID          VALUE 'E'.
  1800             20  AT-PAYEE-SEQ            PIC X.
  1801
  1802         16  AT-CASH-PAYMENT             PIC X.
  1803         16  AT-GROUPED-PAYMENT          PIC X.
  1804         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1805         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1806         16  AT-APPROVED-LEVEL           PIC X.
  1807         16  AT-VOID-TYPE                PIC X.
  1808             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1809             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1810         16  AT-AIG-UNEMP-IND            PIC X.
  1811             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1812         16  AT-ASSOCIATES               PIC X.
  1813             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1814             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1815
  1816         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL151.cbl
  1817         16  AT-CV-PMT-CODE              PIC X.
  1818             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1819             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1820             88  FULL-ADD-PAYMENT           VALUE '3'.
  1821             88  HALF-ADD-PAYMENT           VALUE '4'.
  1822             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1823             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1824             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1825             88  ADDL-PAYMENT               VALUE '8'.
  1826
  1827         16  AT-EOB-CODE1                PIC XXX.
  1828         16  AT-EOB-CODE2                PIC XXX.
  1829         16  AT-EOB-CODE3                PIC XXX.
  1830         16  AT-EOB-CODE4                PIC XXX.
  1831         16  FILLER REDEFINES AT-EOB-CODE4.
  1832             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1833             20  FILLER                  PIC X.
  1834         16  AT-EOB-CODE5                PIC XXX.
  1835         16  FILLER REDEFINES AT-EOB-CODE5.
  1836             20  AT-PMT-PROOF-DT         PIC XX.
  1837             20  FILLER                  PIC X.
  1838
  1839         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1840             88  AT-PRINT-EOB            VALUE 'Y'.
  1841
  1842         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1843         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1844
  1845     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1846         16  AT-SCHEDULE-START-DT        PIC XX.
  1847         16  AT-SCHEDULE-END-DT          PIC XX.
  1848         16  AT-TERMINATED-DT            PIC XX.
  1849         16  AT-LAST-PMT-TYPE            PIC X.
  1850             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1851             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1852         16  AT-FIRST-PMT-DATA.
  1853             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1854             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  1855             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1856         16  AT-REGULAR-PMT-DATA.
  1857             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1858             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1859             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1860         16  AT-AUTO-PAYEE-CD.
  1861             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1862                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1863                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1864                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1865                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1866                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1867             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1868         16  AT-AUTO-PAY-DAY             PIC 99.
  1869         16  AT-AUTO-CASH                PIC X.
  1870             88  AT-CASH                      VALUE 'Y'.
  1871             88  AT-NON-CASH                  VALUE 'N'.
  1872*        16  FILLER                      PIC X(129).
  1873         16  AT-AUTO-END-LETTER          PIC X(4).
  1874         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL151.cbl
  1875
  1876         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1877         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1878
  1879     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1880         16  AT-LETTER-SENT-DT           PIC XX.
  1881         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1882         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1883         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1884         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1885         16  AT-LETTER-ORIGIN            PIC X.
  1886             88  ONLINE-CREATION              VALUE '1' '3'.
  1887             88  OFFLINE-CREATION             VALUE '2' '4'.
  1888             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1889             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1890         16  AT-STD-LETTER-FORM          PIC X(4).
  1891         16  AT-REASON-TEXT              PIC X(70).
  1892         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1893         16  AT-ADDRESEE-TYPE            PIC X.
  1894              88  INSURED-ADDRESEE            VALUE 'I'.
  1895              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1896              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1897              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1898              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1899              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1900              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1901         16  AT-ADDRESSEE-NAME           PIC X(30).
  1902         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1903         16  AT-RESEND-PRINT-DATE        PIC XX.
  1904         16  AT-CORR-SOL-UNSOL           PIC X.
  1905         16  AT-LETTER-PURGED-DT         PIC XX.
  1906*
  1907*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1908*
  1909         16  AT-CSO-REDEFINITION.
  1910             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1911             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1912             20  AT-LETTER-TO-BENE       PIC X(1).
  1913             20  AT-STOP-LETTER-DT       PIC X(2).
  1914             20  FILLER                  PIC X(19).
  1915*             20  FILLER                  PIC X(27).
  1916             20  AT-CSO-LETTER-STATUS    PIC X.
  1917                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1918                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1919                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1920             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1921             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1922*
  1923*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1924*
  1925*        16  FILLER                      PIC X(26).
  1926*
  1927*        16  AT-DMD-BSR-CODE             PIC X.
  1928*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1929*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1930*
  1931*        16  AT-DMD-LETTER-STATUS        PIC X.
  1932*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL151.cbl
  1933*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1934*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1935*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1936*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1937
  1938         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1939         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1940
  1941     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1942         16  AT-ADDRESS-TYPE             PIC X.
  1943             88  INSURED-ADDRESS               VALUE 'I'.
  1944             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1945             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1946             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1947             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1948             88  OTHER-ADDRESS-1               VALUE 'O'.
  1949             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1950         16  AT-MAIL-TO-NAME             PIC X(30).
  1951         16  AT-ADDRESS-LINE-1           PIC X(30).
  1952         16  AT-ADDRESS-LINE-2           PIC X(30).
  1953         16  AT-CITY-STATE.
  1954             20  AT-CITY                 PIC X(28).
  1955             20  AT-STATE                PIC XX.
  1956         16  AT-ZIP.
  1957             20  AT-ZIP-CODE.
  1958                 24  AT-ZIP-1ST          PIC X.
  1959                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1960                 24  FILLER              PIC X(4).
  1961             20  AT-ZIP-PLUS4            PIC X(4).
  1962         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1963             20  AT-CAN-POSTAL-1         PIC XXX.
  1964             20  AT-CAN-POSTAL-2         PIC XXX.
  1965             20  FILLER                  PIC XXX.
  1966         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1967*         16  FILLER                      PIC X(23).
  1968         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1969         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1970         16  FILLER                      PIC X(13).
  1971         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1972         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1973
  1974     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1975         16  AT-INFO-LINE-1              PIC X(60).
  1976         16  AT-INFO-LINE-2              PIC X(60).
  1977         16  AT-INFO-TRAILER-TYPE        PIC X.
  1978             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1979             88  AT-CALL-NOTE            VALUE 'C'.
  1980             88  AT-MAINT-NOTE           VALUE 'M'.
  1981             88  AT-CERT-CHANGE          VALUE 'X'.
  1982             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1983             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1984         16  AT-CALL-TYPE                PIC X.
  1985             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1986             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1987         16  AT-NOTE-CONTINUATION        PIC X.
  1988             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1989         16  AT-EOB-CODES-EXIST          PIC X.
  1990             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL151.cbl
  1991         16  FILLER                      PIC X(35).
  1992         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1993         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1994
  1995     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1996         16  AT-PROMPT-LINE-1            PIC X(60).
  1997         16  AT-PROMPT-LINE-2            PIC X(60).
  1998         16  AT-PROMPT-START-DT          PIC XX.
  1999         16  AT-PROMPT-END-DT            PIC XX.
  2000         16  FILLER                      PIC X(35).
  2001         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2002         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2003
  2004     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2005         16  AT-DENIAL-INFO-1            PIC X(60).
  2006         16  AT-DENIAL-INFO-2            PIC X(60).
  2007         16  AT-DENIAL-DT                PIC XX.
  2008         16  AT-RETRACTION-DT            PIC XX.
  2009         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2010*         16  FILLER                      PIC X(31).
  2011         16  AT-DENIAL-PROOF-DT          PIC XX.
  2012         16  FILLER                      PIC X(29).
  2013         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2014         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2015
  2016     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2017         16  AT-OLD-INCURRED-DT          PIC XX.
  2018         16  AT-OLD-REPORTED-DT          PIC XX.
  2019         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2020         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2021         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2022         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2023         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2024         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2025         16  FILLER                      PIC X(26).
  2026         16  AT-OLD-DIAG-CODE            PIC X(6).
  2027         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2028         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2029         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2030         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2031         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2032         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2033         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2034         16  FILLER                      PIC X(25).
  2035         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2036
  2037     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2038         16  AT-FORM-SEND-ON-DT          PIC XX.
  2039         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2040         16  AT-FORM-RE-SEND-DT          PIC XX.
  2041         16  AT-FORM-ANSWERED-DT         PIC XX.
  2042         16  AT-FORM-PRINTED-DT          PIC XX.
  2043         16  AT-FORM-REPRINT-DT          PIC XX.
  2044         16  AT-FORM-TYPE                PIC X.
  2045             88  INITIAL-FORM                  VALUE '1'.
  2046             88  PROGRESS-FORM                 VALUE '2'.
  2047         16  AT-INSTRUCT-LN-1            PIC X(28).
  2048         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL151.cbl
  2049         16  AT-INSTRUCT-LN-3            PIC X(28).
  2050         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2051         16  AT-FORM-ADDRESS             PIC X.
  2052             88  FORM-TO-INSURED              VALUE 'I'.
  2053             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2054             88  FORM-TO-OTHER-1              VALUE 'O'.
  2055             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2056         16  AT-RELATED-1.
  2057             20 AT-REL-CARR-1            PIC X.
  2058             20 AT-REL-CLAIM-1           PIC X(7).
  2059             20 AT-REL-CERT-1            PIC X(11).
  2060         16  AT-RELATED-2.
  2061             20 AT-REL-CARR-2            PIC X.
  2062             20 AT-REL-CLAIM-2           PIC X(7).
  2063             20 AT-REL-CERT-2            PIC X(11).
  2064         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2065         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2066         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2067         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2068         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2069         16  AT-STOP-FORM-DT             PIC X(2).
  2070
  2071         16  FILLER                      PIC X(09).
  2072         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2073         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2074******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL151.cbl
  2076*                                    COPY ELCARCH.
  2077******************************************************************
  2078*                                                                *
  2079*                            ELCARCH.                            *
  2080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2081*                            VMOD=2.007                          *
  2082*                                                                *
  2083*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2084*                                                                *
  2085*   FILE TYPE = VSAM,KSDS                                        *
  2086*   RECORD SIZE = 090  RECFORM = FIXED                           *
  2087*                                                                *
  2088*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  2089*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  2090*                                                                *
  2091*   LOG = NO                                                     *
  2092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2093*                                                                *
  2094*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  2095******************************************************************
  2096 01  LETTER-ARCHIVE.
  2097     12  LA-RECORD-ID                PIC XX.
  2098         88  VALID-LA-ID                VALUE 'LA'.
  2099
  2100     12  LA-CONTROL-PRIMARY.
  2101         16  LA-COMPANY-CD           PIC X.
  2102         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  2103         16  LA-RECORD-TYPE          PIC X.
  2104             88  LA-HEADER-DATA         VALUE '1'.
  2105             88  LA-ADDRESS-DATA        VALUE '2'.
  2106             88  LA-TEXT-DATA           VALUE '3'.
  2107             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  2108         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  2109
  2110     12  LA-CONTROL-BY-TYPE.
  2111         16  LA-COMPANY-CD-A1        PIC X.
  2112         16  LA-RECORD-TYPE-A1       PIC X.
  2113         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  2114         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  2115
  2116     12  LA-TEXT-RECORD.
  2117         16  LA-SKIP-CONTROL         PIC XX.
  2118             88  NO-LINES-SKIPPED       VALUE SPACES.
  2119             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  2120         16  LA-TEXT-LINE            PIC X(70).
  2121
  2122     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  2123         16  FILLER                  PIC XX.
  2124         16  LA-ADDRESS-LINE         PIC X(30).
  2125         16  FILLER                  PIC X(40).
  2126
  2127     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  2128         16  FILLER                  PIC XX.
  2129         16  LA-CARRIER              PIC X.
  2130         16  LA-CLAIM-NO             PIC X(7).
  2131         16  LA-CERT-NO.
  2132             20  LA-CERT-PRIME       PIC X(10).
  2133             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL151.cbl
  2134         16  LA-NO-OF-COPIES         PIC S9.
  2135         16  LA-RESEND-DATE          PIC XX.
  2136         16  LA-PROCESSOR-CD         PIC X(4).
  2137         16  LA-CREATION-DT          PIC XX.
  2138         16  LA-INITIAL-PRINT-DATE   PIC XX.
  2139         16  LA-RESEND-PRINT-DATE    PIC XX.
  2140         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  2141         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  2142*
  2143* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  2144*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  2145*   I        20  LA-DMD-PROD-CODE        PIC XX.
  2146*   I        20  LA-DMD-RES-ST           PIC XX.
  2147*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  2148*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  2149*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  2150*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  2151*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  2152*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  2153*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  2154*   I        20  LA-DMD-UND-CODE         PIC XX.
  2155*   I        20  LA-DMD-BEN-CODE         PIC XX.
  2156*   V    16  FILLER                  PIC X(15).
  2157* -----
  2158*
  2159* REINSERTED  CSO  MODS
  2160*
  2161         16  FILLER.
  2162             20  FILLER                  PIC X(29).
  2163             20  LA-CSO-LETTER-STATUS    PIC X.
  2164                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  2165                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  2166                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  2167             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  2168             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  2169*
  2170
  2171     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  2172         16  FILLER                  PIC XX.
  2173         16  LA4-CARRIER             PIC X.
  2174         16  LA4-CLAIM-NO            PIC X(7).
  2175         16  LA4-CERT-NO.
  2176             20  LA4-CERT-PRIME      PIC X(10).
  2177             20  LA4-CERT-SFX        PIC X.
  2178         16  LA4-NO-OF-COPIES        PIC S9.
  2179         16  LA4-RESEND-DATE         PIC XX.
  2180         16  LA4-PROCESSOR-CD        PIC X(4).
  2181         16  LA4-CREATION-DT         PIC XX.
  2182         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  2183         16  LA4-RESEND-PRINT-DATE   PIC XX.
  2184         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  2185         16  LA4-FORM-TYPE           PIC X.
  2186             88  LA4-INITIAL-FORM    VALUE '1'.
  2187             88  LA4-PROGRESS-FORM   VALUE '2'.
  2188         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  2189         16  LA4-STATE               PIC X(02).
  2190         16  FILLER                  PIC X(31).
  2191******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL151.cbl
  2193*                                    COPY ELCCNTL.
  2194******************************************************************
  2195*                                                                *
  2196*                                                                *
  2197*                            ELCCNTL.                            *
  2198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2199*                            VMOD=2.059                          *
  2200*                                                                *
  2201*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2202*                                                                *
  2203*   FILE TYPE = VSAM,KSDS                                        *
  2204*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2205*                                                                *
  2206*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2207*       ALTERNATE INDEX = NONE                                   *
  2208*                                                                *
  2209*   LOG = YES                                                    *
  2210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2211******************************************************************
  2212*                   C H A N G E   L O G
  2213*
  2214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2215*-----------------------------------------------------------------
  2216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2217* EFFECTIVE    NUMBER
  2218*-----------------------------------------------------------------
  2219* 082503                   PEMA  ADD BENEFIT GROUP
  2220* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2221* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2222* 092705    2005050300006  PEMA  ADD SPP LEASES
  2223* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2224* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2225* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2226* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2227* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2228******************************************************************
  2229*
  2230 01  CONTROL-FILE.
  2231     12  CF-RECORD-ID                       PIC XX.
  2232         88  VALID-CF-ID                        VALUE 'CF'.
  2233
  2234     12  CF-CONTROL-PRIMARY.
  2235         16  CF-COMPANY-ID                  PIC XXX.
  2236         16  CF-RECORD-TYPE                 PIC X.
  2237             88  CF-COMPANY-MASTER              VALUE '1'.
  2238             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2239             88  CF-STATE-MASTER                VALUE '3'.
  2240             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2241             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2242             88  CF-CARRIER-MASTER              VALUE '6'.
  2243             88  CF-MORTALITY-MASTER            VALUE '7'.
  2244             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2245             88  CF-TERMINAL-MASTER             VALUE '9'.
  2246             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2247             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2248             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2249             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2250             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL151.cbl
  2251             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2252             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2253             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2254             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2255         16  CF-ACCESS-CD-GENL              PIC X(4).
  2256         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2257             20  CF-PROCESSOR               PIC X(4).
  2258         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2259             20  CF-STATE-CODE              PIC XX.
  2260             20  FILLER                     PIC XX.
  2261         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2262             20  FILLER                     PIC XX.
  2263             20  CF-HI-BEN-IN-REC           PIC XX.
  2264         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2265             20  FILLER                     PIC XXX.
  2266             20  CF-CARRIER-CNTL            PIC X.
  2267         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2268             20  FILLER                     PIC XX.
  2269             20  CF-HI-TYPE-IN-REC          PIC 99.
  2270         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2271             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2272                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2273             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2274             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2275         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2276             20  FILLER                     PIC X.
  2277             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2278         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2279             20  FILLER                     PIC XX.
  2280             20  CF-MORTGAGE-PLAN           PIC XX.
  2281         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2282
  2283     12  CF-LAST-MAINT-DT                   PIC XX.
  2284     12  CF-LAST-MAINT-BY                   PIC X(4).
  2285     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2286
  2287     12  CF-RECORD-BODY                     PIC X(728).
  2288
  2289
  2290****************************************************************
  2291*             COMPANY MASTER RECORD                            *
  2292****************************************************************
  2293
  2294     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2295         16  CF-COMPANY-ADDRESS.
  2296             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2297             20  CF-CL-IN-CARE-OF           PIC X(30).
  2298             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2299             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2300             20  CF-CL-CITY-STATE           PIC X(30).
  2301             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2302             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2303         16  CF-COMPANY-CD                  PIC X.
  2304         16  CF-COMPANY-PASSWORD            PIC X(8).
  2305         16  CF-SECURITY-OPTION             PIC X.
  2306             88  ALL-SECURITY                   VALUE '1'.
  2307             88  COMPANY-VERIFY                 VALUE '2'.
  2308             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL151.cbl
  2309             88  NO-SECURITY                    VALUE '4'.
  2310             88  ALL-BUT-TERM                   VALUE '5'.
  2311         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2312             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2313         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2314             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2315         16  CF-INFORCE-LOCATION            PIC X.
  2316             88  CERTS-ARE-ONLINE               VALUE '1'.
  2317             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2318             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2319         16  CF-LOWER-CASE-LETTERS          PIC X.
  2320         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2321             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2322             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2323             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2324             88  CF-ACCNT-CNTL                  VALUE '3'.
  2325             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2326
  2327         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2328         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2329
  2330         16  CF-LGX-CREDIT-USER             PIC X.
  2331             88  CO-IS-NOT-USER                 VALUE 'N'.
  2332             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2333
  2334         16 CF-CREDIT-CALC-CODES.
  2335             20  CF-CR-REM-TERM-CALC PIC X.
  2336               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2337               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2338               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2339               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2340               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2341               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2342               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2343             20  CF-CR-R78-METHOD           PIC X.
  2344               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2345               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2346
  2347         16  CF-CLAIM-CONTROL-COUNTS.
  2348             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2349                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2350
  2351             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2352                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2353
  2354             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2355                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2356
  2357             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2358                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2359
  2360         16  CF-CURRENT-MONTH-END           PIC XX.
  2361
  2362         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2363             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2364             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2365             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2366             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL151.cbl
  2367                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2368                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2369             20  CF-CO-PREM-REJECT-SW       PIC X.
  2370                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2371                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2372             20  CF-CO-REF-REJECT-SW        PIC X.
  2373                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2374                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2375
  2376         16  CF-CO-REPORTING-DT             PIC XX.
  2377         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2378         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2379           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2380           88  CF-CO-MONTH-END                  VALUE '1'.
  2381
  2382         16  CF-LGX-CLAIM-USER              PIC X.
  2383             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2384             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2385
  2386         16  CF-CREDIT-EDIT-CONTROLS.
  2387             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2388             20  CF-MIN-AGE                 PIC 99.
  2389             20  CF-DEFAULT-AGE             PIC 99.
  2390             20  CF-MIN-TERM                PIC S999      COMP-3.
  2391             20  CF-MAX-TERM                PIC S999      COMP-3.
  2392             20  CF-DEFAULT-SEX             PIC X.
  2393             20  CF-JOINT-AGE-INPUT         PIC X.
  2394                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2395             20  CF-BIRTH-DATE-INPUT        PIC X.
  2396                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2397             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2398                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2399                 88  CF-ZERO-CARRIER            VALUE '1'.
  2400                 88  CF-ZERO-GROUPING           VALUE '2'.
  2401                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2402             20  CF-EDIT-SW                 PIC X.
  2403                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2404             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2405             20  CF-CR-PR-METHOD            PIC X.
  2406               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2407               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2408             20  FILLER                     PIC X.
  2409
  2410         16  CF-CREDIT-MISC-CONTROLS.
  2411             20  CF-REIN-TABLE-SW           PIC X.
  2412                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2413             20  CF-COMP-TABLE-SW           PIC X.
  2414                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2415             20  CF-EXPERIENCE-RETENTION-AGE
  2416                                            PIC S9        COMP-3.
  2417             20  CF-CONVERSION-DT           PIC XX.
  2418             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2419             20  CF-RUN-FREQUENCY-SW        PIC X.
  2420                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2421                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2422
  2423             20  CF-CR-CHECK-NO-CONTROL.
  2424                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL151.cbl
  2425                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2426                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2427                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2428                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2429                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2430
  2431                 24  CF-CR-CHECK-COUNT       REDEFINES
  2432                     CF-CR-CHECK-COUNTER      PIC X(4).
  2433
  2434                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2435                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2436
  2437                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2438                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2439                 24  CF-MAIL-PROCESSING       PIC X.
  2440                     88  MAIL-PROCESSING          VALUE 'Y'.
  2441
  2442         16  CF-MISC-SYSTEM-CONTROL.
  2443             20  CF-SYSTEM-C                 PIC X.
  2444                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2445             20  CF-SYSTEM-D                 PIC X.
  2446                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2447             20  CF-SOC-SEC-NO-SW            PIC X.
  2448                 88  SOC-SEC-NO-USED             VALUE '1'.
  2449             20  CF-MEMBER-NO-SW             PIC X.
  2450                 88  MEMBER-NO-USED              VALUE '1'.
  2451             20  CF-TAX-ID-NUMBER            PIC X(11).
  2452             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2453             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2454                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2455                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2456                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2457                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2458             20  CF-SYSTEM-E                 PIC X.
  2459                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2460
  2461         16  CF-LGX-LIFE-USER               PIC X.
  2462             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2463             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2464
  2465         16  CF-CR-MONTH-END-DT             PIC XX.
  2466
  2467         16  CF-FILE-MAINT-DATES.
  2468             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2469                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2470             20  CF-LAST-BATCH       REDEFINES
  2471                 CF-LAST-BATCH-NO               PIC X(4).
  2472             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2473             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2474             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2475             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2476             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2477             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2478             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2479             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2480             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2481             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL151.cbl
  2483         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2484         16  FILLER                         PIC X.
  2485
  2486         16  CF-ALT-MORT-CODE               PIC X(4).
  2487         16  CF-MEMBER-CAPTION              PIC X(10).
  2488
  2489         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2490             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2491             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2492             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2493             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2494             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2495
  2496         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2497
  2498         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2499         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2500         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2501         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2502
  2503         16  CF-AH-OVERRIDE-L1              PIC X.
  2504         16  CF-AH-OVERRIDE-L2              PIC XX.
  2505         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2506         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2507
  2508         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2509         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2510
  2511         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2512         16  CF-AR-LAST-EL860-DT            PIC XX.
  2513         16  CF-MP-MONTH-END-DT             PIC XX.
  2514
  2515         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2516         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2517             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2518
  2519         16  CF-AR-MONTH-END-DT             PIC XX.
  2520
  2521         16  CF-CRDTCRD-USER                PIC X.
  2522             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2523             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2524
  2525         16  CF-CC-MONTH-END-DT             PIC XX.
  2526
  2527         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2528
  2529         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2530             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2531             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2532             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2533         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2534         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2535         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2536         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2537             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2538             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2539         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2540         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL151.cbl
  2541         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2542             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2543         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2544
  2545         16  CF-CL-ZIP-CODE.
  2546             20  CF-CL-ZIP-PRIME.
  2547                 24  CF-CL-ZIP-1ST          PIC X.
  2548                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2549                 24  FILLER                 PIC X(4).
  2550             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2551         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2552             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2553             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2554             20  FILLER                     PIC XXX.
  2555
  2556         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2557         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2558         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2559         16  CF-CO-OPTION-START-DATE        PIC XX.
  2560         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2561           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2562                                                      '3' '4'.
  2563           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2564           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2565           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2566           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2567           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2568           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2569
  2570         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2571
  2572         16  CF-PAYMENT-APPROVAL-LEVELS.
  2573             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2574             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2575             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2576             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2577             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2578             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2579
  2580         16  CF-END-USER-REPORTING-USER     PIC X.
  2581             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2582             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2583
  2584         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2585             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2586             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2587
  2588         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2589
  2590         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2591         16  FILLER                         PIC X.
  2592
  2593         16  CF-CREDIT-ARCHIVE-CNTL.
  2594             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2595             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2596             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2597
  2598         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL151.cbl
  2599
  2600         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2601             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2602             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2603
  2604         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2605             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2606             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2607
  2608         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2609
  2610         16  CF-CO-ACH-ID-CODE              PIC  X.
  2611             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2612             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2613             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2614         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2615         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2616         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2617         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2618         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2619         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2620         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2621         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2622         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2623                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2624         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2625                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2626
  2627         16  CF-CO-OVER-SHORT.
  2628             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2629             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2630
  2631*         16  FILLER                         PIC X(102).
  2632         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2633             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2634             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2635
  2636         16  CF-AH-APPROVAL-DAYS.
  2637             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2638             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2639             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2640             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2641
  2642         16  FILLER                         PIC X(82).
  2643****************************************************************
  2644*             PROCESSOR/USER RECORD                            *
  2645****************************************************************
  2646
  2647     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2648         16  CF-PROCESSOR-NAME              PIC X(30).
  2649         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2650         16  CF-PROCESSOR-TITLE             PIC X(26).
  2651         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2652                 88  MESSAGE-YES                VALUE 'Y'.
  2653                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2654
  2655*****************************************************
  2656****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL151.cbl
  2657****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2658****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2659****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2660*****************************************************
  2661
  2662         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2663             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2664             20  CF-APPLICATION-FORCE       PIC X.
  2665             20  CF-INDIVIDUAL-APP.
  2666                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2667                     28  CF-BROWSE-APP      PIC X.
  2668                     28  CF-UPDATE-APP      PIC X.
  2669
  2670         16  CF-CURRENT-TERM-ON             PIC X(4).
  2671         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2672             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2673             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2674             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2675             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2676             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2677             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2678             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2679         16  CF-PROCESSOR-CARRIER           PIC X.
  2680             88  NO-CARRIER-SECURITY            VALUE ' '.
  2681         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2682             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2683         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2684             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2685         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2686             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2687
  2688         16  CF-PROC-SYS-ACCESS-SW.
  2689             20  CF-PROC-CREDIT-CLAIMS-SW.
  2690                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2691                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2692                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2693                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2694             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2695                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2696                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2697             20  CF-PROC-LIFE-GNRLDGR-SW.
  2698                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2699                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2700                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2701                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2702             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2703                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2704                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2705         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2706             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2707             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2708         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2709
  2710         16  CF-APPROVAL-LEVEL                  PIC X.
  2711             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2712             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2713             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2714             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL151.cbl
  2715
  2716         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2717
  2718         16  CF-LANGUAGE-TYPE                   PIC X.
  2719             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2720             88  CF-LANG-IS-FR                      VALUE 'F'.
  2721         16  FILLER                             PIC  X(240).
  2722
  2723****************************************************************
  2724*             PROCESSOR/REMINDERS RECORD                       *
  2725****************************************************************
  2726
  2727     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2728         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2729             20  CF-START-REMIND-DT         PIC XX.
  2730             20  CF-END-REMIND-DT           PIC XX.
  2731             20  CF-REMINDER-TEXT           PIC X(50).
  2732         16  FILLER                         PIC X(296).
  2733
  2734
  2735****************************************************************
  2736*             STATE MASTER RECORD                              *
  2737****************************************************************
  2738
  2739     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2740         16  CF-STATE-ABBREVIATION          PIC XX.
  2741         16  CF-STATE-NAME                  PIC X(25).
  2742         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2743         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2744             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2745             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2746             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2747             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2748                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2749                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2750             20  CF-ST-PREM-REJECT-SW       PIC X.
  2751                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2752                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2753             20  CF-ST-REF-REJECT-SW        PIC X.
  2754                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2755                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2756         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2757         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2758         16  CF-ST-REFUND-RULES.
  2759             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2760             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2761             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2762         16  CF-ST-FST-PMT-EXTENSION.
  2763             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2764             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2765                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2766                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2767                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2768                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2769         16  CF-ST-STATE-CALL.
  2770             20  CF-ST-CALL-UNEARNED        PIC X.
  2771             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2772             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL151.cbl
  2773         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2774             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2775             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2776         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2777         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2778         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2779         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2780         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2781         16  FILLER                         PIC X.
  2782         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2783             20  CF-ST-BENEFIT-CD           PIC XX.
  2784             20  CF-ST-BENEFIT-KIND         PIC X.
  2785                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2786                 88  CF-ST-AH-KIND              VALUE 'A'.
  2787             20  CF-ST-REM-TERM-CALC        PIC X.
  2788                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2789                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2790                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2791                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2792                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2793                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2794                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2795                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2796
  2797             20  CF-ST-REFUND-CALC          PIC X.
  2798                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2799                 88  ST-REFD-BY-R78             VALUE '1'.
  2800                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2801                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2802                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2803                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2804                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2805                 88  ST-REFD-UTAH               VALUE '7'.
  2806                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2807                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2808                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2809
  2810             20  CF-ST-EARNING-CALC         PIC X.
  2811                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2812                 88  ST-EARN-BY-R78             VALUE '1'.
  2813                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2814                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2815                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2816                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2817                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2818                 88  ST-EARN-MEAN               VALUE '8'.
  2819                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2820
  2821             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2822                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2823                 88  ST-OVRD-BY-R78             VALUE '1'.
  2824                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2825                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2826                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2827                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2828                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2829                 88  ST-OVRD-MEAN               VALUE '8'.
  2830                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL151.cbl
  2831             20  FILLER                     PIC X.
  2832
  2833         16  CF-ST-COMMISSION-CAPS.
  2834             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2835             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2836             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2837             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2838         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2839                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2840
  2841         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2842
  2843         16  CF-ST-STATUTORY-INTEREST.
  2844             20  CF-ST-STAT-DATE-FROM       PIC X.
  2845                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2846                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2847             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2848             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2849             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2850             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2851             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2852
  2853         16  CF-ST-OVER-SHORT.
  2854             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2855             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2856
  2857         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2858
  2859         16  CF-ST-RT-CALC                  PIC X.
  2860
  2861         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2862         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2863         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2864         16  CF-ST-RF-LR-CALC               PIC X.
  2865         16  CF-ST-RF-LL-CALC               PIC X.
  2866         16  CF-ST-RF-LN-CALC               PIC X.
  2867         16  CF-ST-RF-AH-CALC               PIC X.
  2868         16  CF-ST-RF-CP-CALC               PIC X.
  2869*        16  FILLER                         PIC X(206).
  2870*CIDMOD         16  FILLER                         PIC X(192).
  2871         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2872             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2873         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2874         16  CF-ST-VFY-2ND-BENE             PIC X.
  2875         16  FILLER                         PIC X(186).
  2876
  2877****************************************************************
  2878*             BENEFIT MASTER RECORD                            *
  2879****************************************************************
  2880
  2881     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2882         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2883             20  CF-BENEFIT-CODE            PIC XX.
  2884             20  CF-BENEFIT-NUMERIC  REDEFINES
  2885                 CF-BENEFIT-CODE            PIC XX.
  2886             20  CF-BENEFIT-ALPHA           PIC XXX.
  2887             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2888             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL151.cbl
  2889
  2890             20  CF-LF-COVERAGE-TYPE        PIC X.
  2891                 88  CF-REDUCING                VALUE 'R'.
  2892                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2893
  2894             20  CF-SPECIAL-CALC-CD         PIC X.
  2895                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2896                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2897                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2898                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2899                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2900                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2901                 88  CF-FARM-PLAN               VALUE 'F'.
  2902                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2903                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2904                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2905                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2906                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2907                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2908                 88  CF-PRUDENTIAL              VALUE 'P'.
  2909                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2910                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2911                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2912                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2913                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2914                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2915
  2916             20  CF-JOINT-INDICATOR         PIC X.
  2917                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2918
  2919*            20  FILLER                     PIC X(12).
  2920             20  FILLER                     PIC X(11).
  2921             20  CF-BENEFIT-CATEGORY        PIC X.
  2922             20  CF-LOAN-TYPE               PIC X(8).
  2923
  2924             20  CF-CO-REM-TERM-CALC        PIC X.
  2925                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2926                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2927                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2928                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2929                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2930
  2931             20  CF-CO-EARNINGS-CALC        PIC X.
  2932                 88  CO-EARN-BY-R78             VALUE '1'.
  2933                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2934                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2935                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2936                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2937                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2938                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2939                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2940
  2941             20  CF-CO-REFUND-CALC          PIC X.
  2942                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2943                 88  CO-REFD-BY-R78             VALUE '1'.
  2944                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2945                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2946                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL151.cbl
  2947                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2948                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2949                 88  CO-REFD-MEAN               VALUE '8'.
  2950                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2951                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2952                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2953
  2954             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2955                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2956                 88  CO-OVRD-BY-R78             VALUE '1'.
  2957                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2958                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2959                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2960                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2961                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2962                 88  CO-OVRD-MEAN               VALUE '8'.
  2963                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2964
  2965             20  CF-CO-BEN-I-G-CD           PIC X.
  2966                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2967                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2968                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2969
  2970         16  FILLER                         PIC X(304).
  2971
  2972
  2973****************************************************************
  2974*             CARRIER MASTER RECORD                            *
  2975****************************************************************
  2976
  2977     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2978         16  CF-ADDRESS-DATA.
  2979             20  CF-MAIL-TO-NAME            PIC X(30).
  2980             20  CF-IN-CARE-OF              PIC X(30).
  2981             20  CF-ADDRESS-LINE-1          PIC X(30).
  2982             20  CF-ADDRESS-LINE-2          PIC X(30).
  2983             20  CF-CITY-STATE              PIC X(30).
  2984             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2985             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2986
  2987         16  CF-CLAIM-NO-CONTROL.
  2988             20  CF-CLAIM-NO-METHOD         PIC X.
  2989                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2990                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2991                 88  CLAIM-NO-SEQ               VALUE '3'.
  2992                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2993             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2994                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2995                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2996                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2997
  2998         16  CF-CHECK-NO-CONTROL.
  2999             20  CF-CHECK-NO-METHOD         PIC X.
  3000                 88  CHECK-NO-MANUAL            VALUE '1'.
  3001                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3002                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3003                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3004             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL151.cbl
  3005                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3006
  3007         16  CF-DOMICILE-STATE              PIC XX.
  3008
  3009         16  CF-EXPENSE-CONTROLS.
  3010             20  CF-EXPENSE-METHOD          PIC X.
  3011                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3012                 88  DOLLARS-PER-PMT            VALUE '2'.
  3013                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3014                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3015             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3016             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3017
  3018         16  CF-CORRESPONDENCE-CONTROL.
  3019             20  CF-LETTER-RESEND-OPT       PIC X.
  3020                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3021                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3022             20  FILLER                     PIC X(4).
  3023
  3024         16  CF-RESERVE-CONTROLS.
  3025             20  CF-MANUAL-SW               PIC X.
  3026                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3027             20  CF-FUTURE-SW               PIC X.
  3028                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3029             20  CF-PTC-SW                  PIC X.
  3030                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3031             20  CF-IBNR-SW                 PIC X.
  3032                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3033             20  CF-PTC-LF-SW               PIC X.
  3034                 88  CF-LF-PTC-USED             VALUE '1'.
  3035             20  CF-CDT-ACCESS-METHOD       PIC X.
  3036                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3037                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3038                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3039             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3040
  3041         16  CF-CLAIM-CALC-METHOD           PIC X.
  3042             88  360-PLUS-MONTHS                VALUE '1'.
  3043             88  365-PLUS-MONTHS                VALUE '2'.
  3044             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3045             88  360-DAILY                      VALUE '4'.
  3046             88  365-DAILY                      VALUE '5'.
  3047
  3048         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3049         16  FILLER                         PIC X(11).
  3050
  3051         16  CF-LIMIT-AMOUNTS.
  3052             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3053             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3054             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3055             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3056             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3057             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3058             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3059             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3060             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3061             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3062
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL151.cbl
  3063         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3064         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3065         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3066
  3067         16  CF-ZIP-CODE.
  3068             20  CF-ZIP-PRIME.
  3069                 24  CF-ZIP-1ST             PIC X.
  3070                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3071                 24  FILLER                 PIC X(4).
  3072             20  CF-ZIP-PLUS4               PIC X(4).
  3073         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3074             20  CF-CAN-POSTAL-1            PIC XXX.
  3075             20  CF-CAN-POSTAL-2            PIC XXX.
  3076             20  FILLER                     PIC XXX.
  3077
  3078         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3079         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3080         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3081
  3082         16  CF-RATING-SWITCH               PIC X.
  3083             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3084             88  CF-NO-RATING                   VALUE 'N'.
  3085
  3086         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3087
  3088         16  CF-CARRIER-OVER-SHORT.
  3089             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3090             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3091
  3092         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3093         16  CF-SECPAY-SWITCH               PIC X.
  3094             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3095             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3096         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3097         16  FILLER                         PIC X(448).
  3098*        16  FILLER                         PIC X(452).
  3099
  3100
  3101****************************************************************
  3102*             MORTALITY MASTER RECORD                          *
  3103****************************************************************
  3104
  3105     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3106         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3107                                INDEXED BY CF-MORT-NDX.
  3108             20  CF-MORT-TABLE              PIC X(5).
  3109             20  CF-MORT-TABLE-TYPE         PIC X.
  3110                 88  CF-MORT-JOINT              VALUE 'J'.
  3111                 88  CF-MORT-SINGLE             VALUE 'S'.
  3112                 88  CF-MORT-COMBINED           VALUE 'C'.
  3113                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3114                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3115             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3116             20  CF-MORT-AGE-METHOD         PIC XX.
  3117                 88  CF-AGE-LAST                VALUE 'AL'.
  3118                 88  CF-AGE-NEAR                VALUE 'AN'.
  3119             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3120             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL151.cbl
  3121                                            PIC X.
  3122                 88  CF-MINUS                   VALUE '-'.
  3123                 88  CF-PLUS                    VALUE '+'.
  3124             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3125             20  CF-MORT-JOINT-CODE         PIC X.
  3126                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3127             20  CF-MORT-PC-Q               PIC X.
  3128                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3129             20  CF-MORT-TABLE-CODE         PIC X(4).
  3130             20  CF-MORT-COMMENTS           PIC X(15).
  3131             20  FILLER                     PIC X(14).
  3132
  3133         16  FILLER                         PIC X(251).
  3134
  3135
  3136****************************************************************
  3137*             BUSSINESS TYPE MASTER RECORD                     *
  3138****************************************************************
  3139
  3140     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3141* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3142* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3143* AND RECORD 05 IS TYPES 81-99
  3144         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3145             20  CF-BUSINESS-TITLE          PIC  X(19).
  3146             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3147                                            PIC S9V9(4) COMP-3.
  3148             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3149             20  FILLER                     PIC  X.
  3150         16  FILLER                         PIC  X(248).
  3151
  3152
  3153****************************************************************
  3154*             TERMINAL MASTER RECORD                           *
  3155****************************************************************
  3156
  3157     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3158
  3159         16  CF-COMPANY-TERMINALS.
  3160             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3161                                  PIC X(4).
  3162         16  FILLER               PIC X(248).
  3163
  3164
  3165****************************************************************
  3166*             LIFE EDIT MASTER RECORD                          *
  3167****************************************************************
  3168
  3169     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3170         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3171             20  CF-LIFE-CODE-IN            PIC XX.
  3172             20  CF-LIFE-CODE-OUT           PIC XX.
  3173         16  FILLER                         PIC X(248).
  3174
  3175
  3176****************************************************************
  3177*             AH EDIT MASTER RECORD                            *
  3178****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL151.cbl
  3179
  3180     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3181         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3182             20  CF-AH-CODE-IN              PIC XXX.
  3183             20  CF-AH-CODE-OUT             PIC XX.
  3184         16  FILLER                         PIC X(248).
  3185
  3186
  3187****************************************************************
  3188*             CREDIBILITY TABLES                               *
  3189****************************************************************
  3190
  3191     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3192         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3193                             INDEXED BY CF-CRDB-NDX.
  3194             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3195             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3196             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3197         16  FILLER                         PIC  X(332).
  3198
  3199
  3200****************************************************************
  3201*             REPORT CUSTOMIZATION RECORD                      *
  3202****************************************************************
  3203
  3204     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3205         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3206             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3207             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3208             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3209**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3210****       A T-TRANSFER.                                   ****
  3211             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3212
  3213         16  FILLER                         PIC XX.
  3214
  3215         16  CF-CARRIER-CNTL-OPT.
  3216             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3217                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3218                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3219             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3220                                            PIC X.
  3221         16  CF-GROUP-CNTL-OPT.
  3222             20  CF-GROUP-OPT-SEQ           PIC 9.
  3223                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3224                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3225             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3226                                            PIC X(6).
  3227         16  CF-STATE-CNTL-OPT.
  3228             20  CF-STATE-OPT-SEQ           PIC 9.
  3229                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3230                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3231             20  CF-STATE-SELECT OCCURS 3 TIMES
  3232                                            PIC XX.
  3233         16  CF-ACCOUNT-CNTL-OPT.
  3234             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3235                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3236                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL151.cbl
  3237             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3238                                            PIC X(10).
  3239         16  CF-BUS-TYP-CNTL-OPT.
  3240             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3241                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3242                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3243             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3244                                            PIC XX.
  3245         16  CF-LF-TYP-CNTL-OPT.
  3246             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3247                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3248                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3249             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3250                                            PIC XX.
  3251         16  CF-AH-TYP-CNTL-OPT.
  3252             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3253                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3254                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3255             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3256                                            PIC XX.
  3257         16  CF-REPTCD1-CNTL-OPT.
  3258             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3259                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3260                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3261             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3262                                            PIC X(10).
  3263         16  CF-REPTCD2-CNTL-OPT.
  3264             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3265                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3266                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3267             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3268                                            PIC X(10).
  3269         16  CF-USER1-CNTL-OPT.
  3270             20  CF-USER1-OPT-SEQ           PIC 9.
  3271                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3272                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3273             20  CF-USER1-SELECT OCCURS 3 TIMES
  3274                                            PIC X(10).
  3275         16  CF-USER2-CNTL-OPT.
  3276             20  CF-USER2-OPT-SEQ           PIC 9.
  3277                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3278                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3279             20  CF-USER2-SELECT OCCURS 3 TIMES
  3280                                            PIC X(10).
  3281         16  CF-USER3-CNTL-OPT.
  3282             20  CF-USER3-OPT-SEQ           PIC 9.
  3283                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3284                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3285             20  CF-USER3-SELECT OCCURS 3 TIMES
  3286                                            PIC X(10).
  3287         16  CF-USER4-CNTL-OPT.
  3288             20  CF-USER4-OPT-SEQ           PIC 9.
  3289                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3290                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3291             20  CF-USER4-SELECT OCCURS 3 TIMES
  3292                                            PIC X(10).
  3293         16  CF-USER5-CNTL-OPT.
  3294             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL151.cbl
  3295                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3296                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3297             20  CF-USER5-SELECT OCCURS 3 TIMES
  3298                                            PIC X(10).
  3299         16  CF-REINS-CNTL-OPT.
  3300             20  CF-REINS-OPT-SEQ           PIC 9.
  3301                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3302                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3303             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3304                 24  CF-REINS-PRIME         PIC XXX.
  3305                 24  CF-REINS-SUB           PIC XXX.
  3306
  3307         16  CF-AGENT-CNTL-OPT.
  3308             20  CF-AGENT-OPT-SEQ           PIC 9.
  3309                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3310                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3311             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3312                                            PIC X(10).
  3313
  3314         16  FILLER                         PIC X(43).
  3315
  3316         16  CF-LOSS-RATIO-SELECT.
  3317             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3318             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3319         16  CF-ENTRY-DATE-SELECT.
  3320             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3321             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3322         16  CF-EFFECTIVE-DATE-SELECT.
  3323             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3324             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3325
  3326         16  CF-EXCEPTION-LIST-IND          PIC X.
  3327             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3328
  3329         16  FILLER                         PIC X(318).
  3330
  3331****************************************************************
  3332*                  EXCEPTION REPORTING RECORD                  *
  3333****************************************************************
  3334
  3335     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3336         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3337             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3338
  3339         16  CF-COMBINED-LIFE-AH-OPT.
  3340             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3341             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3342             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3343             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3344
  3345         16  CF-LIFE-OPT.
  3346             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3347             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3348             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3349             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3350             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3351             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3352             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL151.cbl
  3353             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3354             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3355             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3356
  3357         16  CF-AH-OPT.
  3358             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3359             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3360             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3361             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3362             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3363             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3364             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3365             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3366             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3367             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3368
  3369         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3370             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3371             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3372             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3373
  3374         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3375
  3376         16  FILLER                         PIC X(673).
  3377
  3378
  3379****************************************************************
  3380*             MORTGAGE SYSTEM PLAN RECORD                      *
  3381****************************************************************
  3382
  3383     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3384         16  CF-PLAN-TYPE                   PIC X.
  3385             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3386             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3387             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3388         16  CF-PLAN-ABBREV                 PIC XXX.
  3389         16  CF-PLAN-DESCRIPT               PIC X(10).
  3390         16  CF-PLAN-NOTES                  PIC X(20).
  3391         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3392         16  CF-PLAN-UNDERWRITING.
  3393             20  CF-PLAN-TERM-DATA.
  3394                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3395                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3396             20  CF-PLAN-AGE-DATA.
  3397                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3398                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3399                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3400             20  CF-PLAN-BENEFIT-DATA.
  3401                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3402                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3403                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3404                                            PIC S9(7)V99  COMP-3.
  3405         16  CF-PLAN-POLICY-FORMS.
  3406             20  CF-POLICY-FORM             PIC X(12).
  3407             20  CF-MASTER-APPLICATION      PIC X(12).
  3408             20  CF-MASTER-POLICY           PIC X(12).
  3409         16  CF-PLAN-RATING.
  3410             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL151.cbl
  3411             20  CF-SEX-RATING              PIC X.
  3412                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3413                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3414             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3415             20  CF-SUB-STD-TYPE            PIC X.
  3416                 88  CF-PCT-OF-PREM            VALUE '1'.
  3417                 88  CF-PCT-OF-BENE            VALUE '2'.
  3418         16  CF-PLAN-PREM-TOLERANCES.
  3419             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3420             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3421         16  CF-PLAN-PYMT-TOLERANCES.
  3422             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3423             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3424         16  CF-PLAN-MISC-DATA.
  3425             20  FILLER                     PIC X.
  3426             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3427             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3428         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3429         16  CF-PLAN-IND-GRP                PIC X.
  3430             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3431                                                     '1'.
  3432             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3433                                                     '2'.
  3434         16  CF-MIB-SEARCH-SW               PIC X.
  3435             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3436             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3437             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3438             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3439         16  CF-ALPHA-SEARCH-SW             PIC X.
  3440             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3441             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3442             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3443             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3444             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3445             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3446             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3447             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3448             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3449             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3450                                                     'A' 'B' 'C'
  3451                                                     'X' 'Y' 'Z'.
  3452         16  CF-EFF-DT-RULE-SW              PIC X.
  3453             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3454             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3455             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3456             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3457             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3458         16  FILLER                         PIC X(4).
  3459         16  CF-HEALTH-QUESTIONS            PIC X.
  3460             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3461         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3462         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3463         16  CF-PLAN-SNGL-JNT               PIC X.
  3464             88  CF-COMBINED-PLAN              VALUE 'C'.
  3465             88  CF-JNT-PLAN                   VALUE 'J'.
  3466             88  CF-SNGL-PLAN                  VALUE 'S'.
  3467         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3468         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL151.cbl
  3469         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3470         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3471         16  CF-RERATE-CNTL                 PIC  X.
  3472             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3473             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3474             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3475             88  CF-AUTO-RECALC                 VALUE '4'.
  3476         16  CF-BENEFIT-TYPE                PIC  X.
  3477             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3478             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3479         16  CF-POLICY-FEE                  PIC S999V99
  3480                                                    COMP-3.
  3481         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3482         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3483         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3484         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3485         16  FILLER                         PIC  X(32).
  3486         16  CF-TERMINATION-FORM            PIC  X(04).
  3487         16  FILLER                         PIC  X(08).
  3488         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3489                                                       COMP-3.
  3490         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3491         16  CF-ISSUE-LETTER                PIC  X(4).
  3492         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3493         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3494             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3495             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3496         16  CF-MP-REFUND-CALC              PIC X.
  3497             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3498             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3499             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3500             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3501             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3502             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3503             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3504             88  CF-MP-REFD-MEAN                VALUE '8'.
  3505         16  CF-ALT-RATE-CODE               PIC  X(5).
  3506
  3507
  3508         16  FILLER                         PIC X(498).
  3509****************************************************************
  3510*             MORTGAGE COMPANY MASTER RECORD                   *
  3511****************************************************************
  3512
  3513     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3514         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3515         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3516             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3517             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3518             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3519             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3520             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3521
  3522         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3523         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3524         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3525         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3526         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL151.cbl
  3527
  3528         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3529             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3530         16  CF-MP-RECON-USE-IND            PIC X(1).
  3531             88  CF-MP-USE-RECON             VALUE 'Y'.
  3532         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3533             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3534         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3535             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3536             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3537         16  FILLER                         PIC X(1).
  3538         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3539             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3540         16  CF-MORTG-MIB-VERSION           PIC X.
  3541             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3542             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3543             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3544         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3545             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3546                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3547             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3548                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3549             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3550                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3551             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3552                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3553             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3554                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3555             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3556                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3557         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3558         16  FILLER                         PIC X(7).
  3559         16  CF-MORTG-DESTINATION-SYMBOL.
  3560             20  CF-MORTG-MIB-COMM          PIC X(5).
  3561             20  CF-MORTG-MIB-TERM          PIC X(5).
  3562         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3563             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3564         16  FILLER                         PIC X(03).
  3565         16  CF-MP-CHECK-NO-CONTROL.
  3566             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3567                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3568                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3569                                                ' ' LOW-VALUES.
  3570                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3571                                               VALUE '3'.
  3572         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3573         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3574         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3575             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3576                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3577             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3578                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3579             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3580                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3581             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3582                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3583             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3584                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL151.cbl
  3585             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3586                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3587         16  CF-MORTG-BILLING-AREA.
  3588             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3589                                            PIC X.
  3590         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3591         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3592         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3593         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3594             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3595             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3596         16  FILLER                         PIC X.
  3597         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3598             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3599             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3600         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3601         16  FILLER                         PIC X(8).
  3602         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3603         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3604         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3605         16  CF-ACH-COMPANY-ID.
  3606             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3607                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3608                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3609                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3610             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3611         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3612             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3613         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3614             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3615             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3616         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3617         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3618         16  FILLER                         PIC X(536).
  3619
  3620****************************************************************
  3621*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3622****************************************************************
  3623
  3624     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3625         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3626             20  CF-FEMALE-HEIGHT.
  3627                 24  CF-FEMALE-FT           PIC 99.
  3628                 24  CF-FEMALE-IN           PIC 99.
  3629             20  CF-FEMALE-MIN-WT           PIC 999.
  3630             20  CF-FEMALE-MAX-WT           PIC 999.
  3631         16  FILLER                         PIC X(428).
  3632
  3633     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3634         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3635             20  CF-MALE-HEIGHT.
  3636                 24  CF-MALE-FT             PIC 99.
  3637                 24  CF-MALE-IN             PIC 99.
  3638             20  CF-MALE-MIN-WT             PIC 999.
  3639             20  CF-MALE-MAX-WT             PIC 999.
  3640         16  FILLER                         PIC X(428).
  3641******************************************************************
  3642*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL151.cbl
  3643******************************************************************
  3644     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3645         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3646             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3647             20  CF-SYS-LETTER-ID           PIC X(04).
  3648             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3649             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3650             20  CF-SYS-RESET-SW            PIC X(01).
  3651             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3652             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3653
  3654         16  FILLER                         PIC X(50).
  3655
  3656         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3657             20  CF-USER-ACTIVE-SW          PIC X(01).
  3658             20  CF-USER-LETTER-ID          PIC X(04).
  3659             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3660             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3661             20  CF-USER-RESET-SW           PIC X(01).
  3662             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3663             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3664             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3665
  3666         16  FILLER                         PIC X(246).
  3667*                                    COPY ELCDENY.
  3668******************************************************************
  3669*                                                                *
  3670*                                                                *
  3671*                            ELCDENY                             *
  3672*                            VMOD=2.001                          *
  3673*                                                                *
  3674*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  3675*                                                                *
  3676*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3677*   VSAM DENIAL TABLE                                            *
  3678*                                                                *
  3679*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  3680*                                                                *
  3681*   FILE TYPE = VSAM,KSDS                                        *
  3682*   RECORD SIZE = 125   RECFORM = FIX                            *
  3683*                                                                *
  3684*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  3685*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  3686*                                                                *
  3687*   LOG = NO                                                     *
  3688*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3689*                                                                *
  3690*                                                                *
  3691******************************************************************
  3692*                   C H A N G E   L O G
  3693*
  3694* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3695*-----------------------------------------------------------------
  3696*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3697* EFFECTIVE    NUMBER
  3698*-----------------------------------------------------------------
  3699* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  3700******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL151.cbl
  3701 01  DENIAL-CODES.
  3702     12  DN-RECORD-ID                      PIC XX.
  3703         88  VALID-DN-ID                      VALUE 'DN'.
  3704     12  DN-CONTROL-PRIMARY.
  3705         16  DN-COMPANY-CD                 PIC X.
  3706         16  DN-DENIAL-CODE                PIC X(4).
  3707         16  FILLER                        PIC X(10).
  3708     12  DN-CONTROL-BY-TYPE.
  3709         16  DN-COMPANY-CD-A1              PIC X.
  3710         16  DN-RECORD-TYPE                PIC X.
  3711         16  DN-DENIAL-CODE-A1             PIC X(4).
  3712         16  FILLER                        PIC X(10).
  3713     12  DN-MAINT-INFORMATION.
  3714         16  DN-LAST-MAINT-DT              PIC XX.
  3715         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3716         16  DN-LAST-MAINT-USER            PIC X(4).
  3717         16  FILLER                        PIC XX.
  3718     12  DN-DESCRIPTION                    PIC X(50).
  3719     12  FILLER                            PIC X(30).
  3720******************************************************************
  3721*                                    COPY ELCDAR.
  3722******************************************************************
  3723*                                                                *
  3724*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  3725*   FILE TYPE = VSAM,KSDS                                        *
  3726*   RECORD SIZE = 25   RECFORM = FIXED                           *
  3727*   BASE CLUSTER = DLYACTV                                       *
  3728*   LOG = YES                                                    *
  3729*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  3730*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  3731*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  3732*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  3733*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  3734*               BY PROGRAM "LGINFCE".                            *
  3735*                                                                *
  3736******************************************************************
  3737 01  DAILY-ACTIVITY-RECORD.
  3738     05  DA-KEY.
  3739         10  DA-COMP-CD          PIC X.
  3740         10  DA-CARRIER          PIC X.
  3741         10  DA-CLAIM-NO         PIC X(7).
  3742         10  DA-CERT-NO.
  3743             15  DA-CERT-PRIME   PIC X(10).
  3744             15  DA-CERT-SFX     PIC X.
  3745     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  3746     05  DA-RECORD-TYPE          PIC X.
  3747     05  FILLER                  PIC X(2).
  3748******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL151.cbl
  3750*                                    COPY ERCDMDNT.
  3751******************************************************************
  3752*                                                                *
  3753*                            ERCDMDNT                            *
  3754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3755*                            VMOD=2.005                          *
  3756*                                                                *
  3757*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  3758*                                                                *
  3759*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  3760*                                                                *
  3761*        FILE TYPE= VSAM,KSDS                                    *
  3762*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3763*                                                                *
  3764*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3765*                                                                *
  3766*        LOG = YES                                               *
  3767*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3768*                                                                *
  3769******************************************************************
  3770
  3771 01  CERTIFICATE-NOTE.
  3772     12  CN-RECORD-ID                     PIC  XX.
  3773         88  VALID-CN-ID                      VALUE 'CN'.
  3774
  3775     12  CN-CONTROL-PRIMARY.
  3776         16  CN-COMPANY-CD                PIC X.
  3777         16  CN-CERT-KEY.
  3778             20  CN-CARRIER               PIC X.
  3779             20  CN-GROUPING.
  3780                 24  CN-GROUPING-PREFIX   PIC XXX.
  3781                 24  CN-GROUPING-PRIME    PIC XXX.
  3782             20  CN-STATE                 PIC XX.
  3783             20  CN-ACCOUNT.
  3784                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  3785                 24  CN-ACCOUNT-PRIME     PIC X(6).
  3786             20  CN-CERT-EFF-DT           PIC XX.
  3787             20  CN-CERT-NO.
  3788                 24  CN-CERT-PRIME        PIC X(10).
  3789                 24  CN-CERT-SFX          PIC X.
  3790
  3791     12  CN-BILLING-START-LINE-NO         PIC 99.
  3792     12  CN-BILLING-END-LINE-NO           PIC 99.
  3793
  3794     12  CN-LINES.
  3795         16  CN-LINE                      PIC X(77)  OCCURS 10.
  3796
  3797     12  CN-CSI-NOTES REDEFINES CN-LINES.
  3798         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  3799         16  CN-CSI-GENERAL-DATA-AREA.
  3800             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  3801
  3802         16  CN-CSI-GENERAL-DATA-R REDEFINES
  3803             CN-CSI-GENERAL-DATA-AREA.
  3804             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  3805             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  3806             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  3807             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL151.cbl
  3808             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  3809             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  3810             20  CN-CSI-GEN-INFRM-MI          PIC X.
  3811             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  3812             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  3813             20  FILLER                       PIC XX.
  3814             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  3815             20  FILLER                       PIC X(38).
  3816
  3817         16  CN-CSI-PRODUCT-DATA-AREA.
  3818             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  3819
  3820         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  3821             CN-CSI-PRODUCT-DATA-AREA.
  3822             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  3823             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  3824             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  3825             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  3826             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  3827             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  3828             20  FILLER                   PIC XX.
  3829             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3830             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3831             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  3832             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  3833             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3834             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3835             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3836             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3837             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  3838             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  3839             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  3840             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  3841             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  3842             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  3843             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  3844             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  3845             20  CN-CSI-CC-TERM-AGE       PIC 999.
  3846             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3847             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  3848             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  3849             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  3850             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  3851             20  FILLER                   PIC X(25).
  3852
  3853         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  3854             CN-CSI-CREDIT-CARD-DATA.
  3855             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  3856             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  3857             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  3858             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  3859             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  3860             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  3861             20  FILLER                   PIC XX.
  3862             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  3863             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  3864             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  3865             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL151.cbl
  3866             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  3867             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  3868             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  3869             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  3870             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  3871             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  3872             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  3873             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  3874             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  3875             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  3876             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  3877             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  3878             20  CN-CSI-FL-TERM-AGE       PIC 999.
  3879             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  3880             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  3881             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  3882             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  3883             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  3884             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  3885             20  FILLER                   PIC X(17).
  3886
  3887         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  3888             CN-CSI-FAMILY-LEAVE-DATA.
  3889             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  3890             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  3891             20  CN-CSI-SL-BENE-REL       PIC X(8).
  3892             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  3893             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  3894             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  3895             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  3896             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  3897             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  3898             20  CN-CSI-SL-INT-ON-PROCEEDS
  3899                                          PIC S9(5)V99  COMP-3.
  3900             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  3901             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  3902             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  3903             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  3904             20  CN-CSI-SL-POLICY-BENEFITS
  3905                                          PIC S9(5)V99  COMP-3.
  3906             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  3907             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  3908             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  3909             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  3910             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  3911             20  CN-CSI-SL-PREM-MODE      PIC 99.
  3912             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  3913             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  3914             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  3915             20  CN-CSI-SL-STATE-NOT      PIC X.
  3916             20  FILLER                   PIC XX.
  3917
  3918         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  3919             CN-CSI-SENIOR-LIFE-DATA.
  3920             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  3921             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  3922             20  CN-CSI-PP-BEN-PAID-TO-DATE
  3923                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL151.cbl
  3924             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  3925             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  3926             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  3927             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  3928             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  3929             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  3930             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  3931             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  3932             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  3933             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  3934             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  3935             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  3936             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  3937             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  3938             20  CN-CSI-PP-REPAIR         PIC X.
  3939             20  CN-CSI-PP-REPLACE        PIC X.
  3940             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  3941             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  3942             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  3943             20  CN-CSI-PP-TERM-AGE       PIC 999.
  3944             20  FILLER                   PIC X(5).
  3945
  3946         16  CN-CSI-EXT-WARR-DATA REDEFINES
  3947             CN-CSI-PURCH-PROP-DATA.
  3948             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  3949             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  3950             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  3951             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  3952             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  3953             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  3954             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  3955             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  3956             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  3957             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  3958             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  3959             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  3960             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  3961             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  3962             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  3963             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  3964             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  3965             20  CN-CSI-EW-REPLACE        PIC X.
  3966             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  3967             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  3968             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  3969             20  CN-CSI-EW-TERM-AGE       PIC 999.
  3970             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  3971             20  FILLER                   PIC X(4).
  3972
  3973     12  CN-LAST-MAINT-DT                 PIC XX.
  3974     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  3975     12  CN-LAST-MAINT-USER               PIC X(4).
  3976     12  FILLER                           PIC X(6).
  3977
  3978******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL151.cbl
  3980 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3981                          ACTIVITY-TRAILERS LETTER-ARCHIVE
  3982                          CONTROL-FILE DENIAL-CODES
  3983                          DAILY-ACTIVITY-RECORD
  3984                          CERTIFICATE-NOTE.
  3985 0000-DFHEXIT SECTION.
  3986     MOVE '9#                    $   ' TO DFHEIV0.
  3987     MOVE 'EL151' TO DFHEIV1.
  3988     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3989
  3990     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3991     MOVE '5'                    TO DC-OPTION-CODE.
  3992     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3993     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  3994     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  3995
  3996 0001-PROCESSING-EXITS.
  3997     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  3998     IF EIBCALEN NOT GREATER THAN ZEROS
  3999       GO TO 8800-UNAUTHORIZED-ACCESS.
  4000
  4001
  4002* EXEC CICS  HANDLE CONDITION
  4003*           ERROR    (9990-ABEND)
  4004*           PGMIDERR (9600-PGMID-ERROR)
  4005*    END-EXEC.
  4006*    MOVE '"$.L                  ! " #00003997' TO DFHEIV0
  4007     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  4008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4009     MOVE X'2220233030303033393937' TO DFHEIV0(25:11)
  4010     CALL 'kxdfhei1' USING DFHEIV0
  4011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4012
  4013
  4014     IF PI-CALLING-PROGRAM  NOT  = THIS-PGM
  4015         IF PI-RETURN-TO-PROGRAM NOT  =  THIS-PGM
  4016             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4017             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4018             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4019             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4020             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4021             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4022             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4023             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4024         ELSE
  4025             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4026             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4027             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4028             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4029             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4030             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4031             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4032             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4033
  4034     IF EIBAID IS EQUAL TO DFHCLEAR
  4035         GO TO 9400-CLEAR.
  4036
  4037     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL151.cbl
  4038         NEXT SENTENCE
  4039     ELSE
  4040
  4041* EXEC CICS READQ TS
  4042*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4043*            INTO    (SECURITY-CONTROL)
  4044*            LENGTH  (SC-COMM-LENGTH)
  4045*            ITEM    (SC-ITEM)
  4046*        END-EXEC
  4047*    MOVE '*$II   L              ''   #00004028' TO DFHEIV0
  4048     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4049     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4050     MOVE X'2020233030303034303238' TO DFHEIV0(25:11)
  4051     CALL 'kxdfhei1' USING DFHEIV0,
  4052           PI-SECURITY-TEMP-STORE-ID,
  4053           SECURITY-CONTROL,
  4054           SC-COMM-LENGTH,
  4055           SC-ITEM,
  4056           DFHEIV99,
  4057           DFHEIV99
  4058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4059         MOVE SC-CLAIMS-DISPLAY (6)    TO  PI-DISPLAY-CAP
  4060         MOVE SC-CLAIMS-UPDATE  (6)    TO  PI-MODIFY-CAP.
  4061
  4062     IF EIBTRNID IS EQUAL TO WS-TRANS-ID
  4063         GO TO 0200-RECEIVE.
  4064
  4065 0100-FIRST-TIME-IN.
  4066
  4067     MOVE LOW-VALUES                 TO  EL151AO
  4068     MOVE -1                         TO  MLINE1L
  4069     MOVE 1                          TO  EMI-NUMBER-OF-LINES.
  4070
  4071     MOVE SPACE                      TO  DC-ERROR-CODE
  4072                                         WS-CLAIM-SEQ-SW
  4073                                         MERMSG2O.
  4074
  4075     MOVE '153A'                     TO  PI-CURRENT-SCREEN-NO.
  4076
  4077     MOVE 0                          TO  PI-PROOF-DATE.
  4078     PERFORM 3550-FIND-LETTER-TRLR THRU 3550-EXIT.
  4079
  4080     GO TO 8100-SEND-INITIAL-MAP.
  4081
  4082 0200-RECEIVE.
  4083
  4084     MOVE LOW-VALUES              TO  EL151AI.
  4085
  4086     IF (EIBAID IS EQUAL TO DFHPA1 OR DFHPA2 OR DFHPA3)
  4087         MOVE ER-0008             TO  EMI-ERROR
  4088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4089         MOVE -1                  TO  MPFNUMBL
  4090         GO TO 8200-SEND-DATAONLY.
  4091
  4092
  4093* EXEC CICS RECEIVE
  4094*        MAP      (MAP-NAME)
  4095*        MAPSET   (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL151.cbl
  4096*        INTO     (EL151AI)
  4097*    END-EXEC.
  4098     MOVE LENGTH OF
  4099      EL151AI
  4100       TO DFHEIV11
  4101*    MOVE '8"T I  L              ''   #00004067' TO DFHEIV0
  4102     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4104     MOVE X'2020233030303034303637' TO DFHEIV0(25:11)
  4105     CALL 'kxdfhei1' USING DFHEIV0,
  4106           MAP-NAME,
  4107           EL151AI,
  4108           DFHEIV11,
  4109           MAPSET-NAME,
  4110           DFHEIV99,
  4111           DFHEIV99
  4112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4113
  4114
  4115     IF MPFNUMBL IS EQUAL TO +0
  4116         GO TO 0300-CHECK-PFKEYS.
  4117
  4118     IF EIBAID IS NOT EQUAL TO DFHENTER
  4119         MOVE ER-0004             TO  EMI-ERROR
  4120         GO TO 0320-INPUT-ERROR.
  4121
  4122     IF (MPFNUMBI NUMERIC) AND (MPFNUMBI GREATER 0 AND LESS 25)
  4123         MOVE PF-VALUES (MPFNUMBI)    TO  EIBAID
  4124     ELSE
  4125         MOVE ER-0029                 TO  EMI-ERROR
  4126         GO TO 0320-INPUT-ERROR.
  4127
  4128 0300-CHECK-PFKEYS.
  4129
  4130     IF EIBAID IS EQUAL TO DFHPF12
  4131        MOVE  'EL010'            TO  THIS-PGM
  4132        GO TO 9300-XCTL.
  4133
  4134     IF EIBAID IS EQUAL TO DFHPF23
  4135        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4136        MOVE 'EL005'             TO  THIS-PGM
  4137        GO TO 9300-XCTL.
  4138
  4139     IF EIBAID IS EQUAL TO DFHPF24
  4140        MOVE EIBAID              TO  PI-ENTRY-CD-1
  4141        MOVE  'EL126'            TO  THIS-PGM
  4142        GO TO 9300-XCTL.
  4143
  4144     IF EIBAID IS EQUAL TO DFHENTER
  4145        GO TO 0330-EDIT-DATA.
  4146
  4147     MOVE ER-0029                TO  EMI-ERROR.
  4148
  4149 0320-INPUT-ERROR.
  4150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4151
  4152     MOVE -1                     TO  MPFNUMBL.
  4153     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL151.cbl
  4154
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL151.cbl
  4156 0330-EDIT-DATA.
  4157     IF NOT MODIFY-CAP
  4158        MOVE 'UPDATE'             TO  SM-READ
  4159        PERFORM 9995-SECURITY-VIOLATION
  4160        MOVE ER-0070              TO  EMI-ERROR
  4161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4162        GO TO 8100-SEND-INITIAL-MAP.
  4163
  4164     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CID' OR 'DCC' OR 'AHL'
  4165         IF MLINE1I = (LOW-VALUES OR SPACES) AND
  4166            MLINE2I = (LOW-VALUES OR SPACES) AND
  4167            MDENCDI = (LOW-VALUES OR SPACES)
  4168             MOVE ER-0483        TO  EMI-ERROR
  4169             MOVE -1             TO  MLINE1L
  4170             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4171             GO TO 8100-SEND-INITIAL-MAP
  4172         ELSE
  4173             NEXT SENTENCE
  4174     ELSE
  4175         IF MLINE1I  = (LOW-VALUES OR SPACES)  AND
  4176            MLINE2I  = (LOW-VALUES OR SPACES)
  4177             MOVE ER-0483        TO  EMI-ERROR
  4178             MOVE -1             TO  MLINE1L
  4179             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4180             GO TO 8100-SEND-INITIAL-MAP.
  4181
  4182     IF MPRFDTL > 0
  4183         MOVE MPRFDTI TO DEEDIT-FIELD
  4184         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4185         MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4186         MOVE PI-PROOF-DATE    TO MPRFDTO
  4187         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4188     END-IF.
  4189
  4190     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES
  4191*     IF  MPRFDTI  = LOW-VALUES OR SPACES
  4192         MOVE ER-0872             TO EMI-ERROR
  4193         MOVE -1                  TO MPRFDTL
  4194         MOVE AL-UABON            TO MPRFDTA
  4195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4196         GO TO 8200-SEND-DATAONLY
  4197     END-IF.
  4198
  4199     IF  PI-PROOF-DATE > 0
  4200         MOVE PI-PROOF-DATE       TO DEEDIT-FIELD
  4201         PERFORM 9650-DEEDIT      THRU 9650-EXIT
  4202         MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  4203         MOVE '4'                 TO DC-OPTION-CODE
  4204         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
  4205         IF DATE-CONVERSION-ERROR
  4206            MOVE ER-0021          TO EMI-ERROR
  4207            MOVE -1               TO MPRFDTL
  4208            MOVE AL-UABON         TO MPRFDTA
  4209            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4210            GO TO 8200-SEND-DATAONLY
  4211         ELSE
  4212            IF DC-BIN-DATE-1 > SAVE-BIN-DATE
  4213                MOVE ER-0873      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL151.cbl
  4214                MOVE -1           TO MPRFDTL
  4215                MOVE AL-UABON     TO MPRFDTA
  4216                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4217                GO TO 8200-SEND-DATAONLY
  4218            ELSE
  4219                MOVE DC-BIN-DATE-1    TO WS-PRF-DT
  4220                MOVE DEEDIT-FIELD-V0  TO PI-PROOF-DATE
  4221                MOVE PI-PROOF-DATE    TO MPRFDTO
  4222                INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  4223            END-IF
  4224         END-IF
  4225     END-IF.
  4226
  4227     MOVE LOW-VALUES             TO  WS-TRAILER-KEY.
  4228     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  4229     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  4230     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  4231     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  4232
  4233     PERFORM 7000-READ-ELMSTR-UPDATE THRU 7000-EXIT.
  4234
  4235     IF CL-LAST-TRL-AVAIL
  4236         MOVE ER-0137            TO  EMI-ERROR
  4237         MOVE -1                 TO  MLINE1L
  4238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4239         GO TO 8200-SEND-DATAONLY.
  4240
  4241     MOVE CL-TRAILER-SEQ-CNT     TO  WS-ORIG-SEQ-CNT.
  4242     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  4243     MOVE CL-TRAILER-SEQ-CNT     TO  WS-SEQ-NO-SAVED.
  4244     MOVE 'C'                    TO  CL-CLAIM-STATUS.
  4245     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  4246     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  4247     MOVE '2'                    TO  CL-LAST-CLOSE-REASON.
  4248     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  4249     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT
  4250                                     CL-LAST-CLOSE-DT.
  4251
  4252     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4253         IF MDENCDL IS GREATER THAN +0
  4254             MOVE MDENCDI        TO  CL-FILE-LOCATION.
  4255
  4256*************************************************************
  4257*****         START BUILDING ACTIVITY RECORD HERE          **
  4258*************************************************************
  4259     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
  4260         PERFORM 2300-GETMAIN-DLYACTV THRU
  4261                 2300-EXIT
  4262         PERFORM 3500-BUILD-ACTIVITY-RECORD THRU
  4263                 3500-EXIT
  4264         PERFORM 2350-WRITE-DLYACTV THRU
  4265                 2350-EXIT
  4266     END-IF.
  4267
  4268*************************************************************
  4269*****            END OF BUILDING ACTIVITY RECORD           **
  4270*************************************************************
  4271
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL151.cbl
  4272     PERFORM 7120-READ-ELTRLR-UPDATE THRU 7120-EXIT.
  4273
  4274     MOVE +1                     TO  MISC-SUB.
  4275     MOVE SPACES                 TO  WS-OC-LOAD-SW.
  4276     PERFORM 1000-SET-OPEN-CLOSE-HIST THRU 1000-EXIT.
  4277
  4278     MOVE +01                    TO  TR-SUB
  4279                                     TR-SUB-2.
  4280     PERFORM 1010-UPDATE-TR1-OC   THRU 1010-EXIT
  4281             UNTIL  OC-HISTORY-LOADED.
  4282
  4283     MOVE PI-PROCESSOR-ID        TO AT-RESERVES-LAST-UPDATED-BY
  4284     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  4285     MOVE SAVE-BIN-DATE          TO AT-RESERVES-LAST-MAINT-DT.
  4286
  4287     IF PI-COMPANY-ID = 'DMD'
  4288         PERFORM 2000-CREATE-DMD-DMO  THRU  2000-EXIT.
  4289
  4290     PERFORM 7130-REWRITE-ELTRLR THRU 7130-EXIT.
  4291
  4292     PERFORM 7100-GETMAIN-ELTRLR  THRU 7100-EXIT.
  4293     PERFORM 1050-BUILD-DENIAL-TRLR THRU 1090-EXIT.
  4294
  4295     PERFORM 7110-WRITE-ELTRLR    THRU 7110-EXIT.
  4296
  4297     PERFORM 6100-CHECK-AUTO-ACTIVITY THRU 6100-EXIT.
  4298
  4299     IF WS-REC-FOUND-SW IS EQUAL TO 'N'
  4300         GO TO 0340-FINISH-EDIT-DATA.
  4301
  4302     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  4303         GO TO 0340-FINISH-EDIT-DATA.
  4304
  4305     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  4306        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  4307         GO TO 0340-FINISH-EDIT-DATA.
  4308
  4309     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  4310         PERFORM 6000-RESET-AUTO-ACTIVITY THRU 6000-EXIT
  4311         IF WS-UPDATE-SW IS EQUAL TO 'Y'
  4312             MOVE LOW-VALUES         TO  CL-NEXT-RESEND-DT
  4313                                         CL-NEXT-FOLLOWUP-DT.
  4314
  4315     IF WS-RESET-SW IS EQUAL TO 'Y'
  4316         MOVE ZEROS                  TO  CL-ACTIVITY-CODE
  4317         MOVE SAVE-BIN-DATE          TO  CL-ACTIVITY-MAINT-DT
  4318         MOVE 'DENY'                 TO  CL-ACTIVITY-MAINT-TYPE.
  4319
  4320 0340-FINISH-EDIT-DATA.
  4321
  4322     PERFORM 7010-REWRITE-ELMSTR  THRU 7010-EXIT.
  4323
  4324     MOVE ER-0000                TO EMI-ERROR.
  4325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4326     MOVE -1                     TO MLINE1L.
  4327*    MOVE LOW-VALUES             TO MLINE1O
  4328*                                   MLINE2O
  4329*                                   MDENCDO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL151.cbl
  4330     GO TO 8200-SEND-DATAONLY.
  4331
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL151.cbl
  4333 1000-SET-OPEN-CLOSE-HIST.
  4334     PERFORM 1000-BUMP-OPEN-CLOSE-HIST UNTIL
  4335        (MISC-SUB GREATER THAN +6 OR
  4336        AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES).
  4337
  4338     IF MISC-SUB GREATER THAN +1
  4339        SUBTRACT +1 FROM MISC-SUB
  4340        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = 'C'
  4341           MOVE SAVE-BIN-DATE   TO AT-OPEN-CLOSE-DATE (MISC-SUB)
  4342           MOVE 'C'             TO AT-OPEN-CLOSE-TYPE (MISC-SUB)
  4343           MOVE 'DENIED'        TO AT-OPEN-CLOSE-REASON (MISC-SUB)
  4344           MOVE 'X'             TO WS-OC-LOAD-SW.
  4345
  4346     GO TO 1000-EXIT.
  4347
  4348 1000-BUMP-OPEN-CLOSE-HIST.
  4349     ADD +1 TO MISC-SUB.
  4350
  4351 1000-EXIT.
  4352     EXIT.
  4353
  4354 1010-UPDATE-TR1-OC.
  4355     IF  AT-OPEN-CLOSE-DATE (TR-SUB) = (LOW-VALUE OR SPACES)
  4356         MOVE SAVE-BIN-DATE      TO AT-OPEN-CLOSE-DATE (TR-SUB)
  4357         MOVE 'C'                TO AT-OPEN-CLOSE-TYPE (TR-SUB)
  4358         MOVE 'DENIED'           TO AT-OPEN-CLOSE-REASON (TR-SUB)
  4359         MOVE 'X'                TO WS-OC-LOAD-SW
  4360         GO TO 1010-EXIT.
  4361
  4362     ADD 1  TO TR-SUB.
  4363     IF  TR-SUB  GREATER THAN 6
  4364         MOVE +01                TO TR-SUB
  4365         MOVE +02                TO TR-SUB-2
  4366         PERFORM 1020-BUMP    THRU 1020-EXIT
  4367          UNTIL TR-SUB-2 GREATER THAN 6
  4368         MOVE SPACES             TO AT-OPEN-CLOSE-DATE (TR-SUB).
  4369
  4370 1010-EXIT.
  4371      EXIT.
  4372
  4373 1020-BUMP.
  4374     MOVE AT-OPEN-CLOSE-DATE (TR-SUB-2) TO
  4375                           AT-OPEN-CLOSE-DATE (TR-SUB).
  4376     MOVE AT-OPEN-CLOSE-TYPE (TR-SUB-2) TO
  4377                           AT-OPEN-CLOSE-TYPE (TR-SUB).
  4378     MOVE AT-OPEN-CLOSE-REASON (TR-SUB-2) TO
  4379                           AT-OPEN-CLOSE-REASON (TR-SUB).
  4380
  4381     ADD +1  TO TR-SUB
  4382                TR-SUB-2.
  4383
  4384 1020-EXIT.
  4385     EXIT.
  4386
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL151.cbl
  4388 1050-BUILD-DENIAL-TRLR.
  4389
  4390     MOVE 'AT'                   TO AT-RECORD-ID.
  4391     MOVE '8'                    TO AT-TRAILER-TYPE.
  4392
  4393*DLO023
  4394     IF PI-COMPANY-ID NOT = 'DMD'
  4395         GO TO 1055-EDIT-CID-CODE
  4396     END-IF
  4397
  4398     IF MDENCDL GREATER +0
  4399         MOVE 'CL'               TO DL23-SYSTEM-ID
  4400         MOVE 'DN'               TO DL23-RECORD-TYPE
  4401         MOVE MDENCDI            TO DL23-RECORD-KEY
  4402
  4403* EXEC CICS LINK
  4404*            PROGRAM    ('DLO023')
  4405*            COMMAREA   (WS-DLO-CODES-TABLE)
  4406*            LENGTH     (DL23-COMM-LENGTH)
  4407*        END-EXEC
  4408     MOVE 'DLO023' TO DFHEIV1
  4409*    MOVE '."C                   ''   #00004360' TO DFHEIV0
  4410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4412     MOVE X'2020233030303034333630' TO DFHEIV0(25:11)
  4413     CALL 'kxdfhei1' USING DFHEIV0,
  4414           DFHEIV1,
  4415           WS-DLO-CODES-TABLE,
  4416           DL23-COMM-LENGTH,
  4417           DFHEIV99,
  4418           DFHEIV99,
  4419           DFHEIV99
  4420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4421         IF DL23-RETURN-CODE = 'OK'
  4422             MOVE AL-UANON       TO MDENCDA
  4423          ELSE
  4424             MOVE AL-UABON       TO MDENCDA
  4425             MOVE -1             TO MDENCDL
  4426             MOVE ER-0884        TO EMI-ERROR
  4427             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4428             PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4429             PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4430             GO TO 8200-SEND-DATAONLY.
  4431
  4432     IF MLINE1I = LOW-VALUES OR SPACES
  4433         MOVE SPACES         TO AT-DENIAL-INFO-1
  4434      ELSE
  4435         MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4436
  4437     GO TO 1070-CONTINUE.
  4438
  4439 1055-EDIT-CID-CODE.
  4440     IF MDENCDL > +0
  4441        MOVE LOW-VALUES          TO WS-ELDENY-KEY
  4442        MOVE PI-COMPANY-CD       TO ELDENY-COMPANY-CD
  4443        MOVE MDENCDI             TO ELDENY-DENIAL-CODE
  4444
  4445* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL151.cbl
  4446*          DATASET('ELDENY')
  4447*          SET    (ADDRESS OF DENIAL-CODES)
  4448*          RIDFLD (WS-ELDENY-KEY)
  4449*          RESP   (WS-RESPONSE)
  4450*       END-EXEC
  4451     MOVE 'ELDENY' TO DFHEIV1
  4452*    MOVE '&"S        E          (  N#00004388' TO DFHEIV0
  4453     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4455     MOVE X'204E233030303034333838' TO DFHEIV0(25:11)
  4456     CALL 'kxdfhei1' USING DFHEIV0,
  4457           DFHEIV1,
  4458           DFHEIV20,
  4459           DFHEIV99,
  4460           WS-ELDENY-KEY,
  4461           DFHEIV99,
  4462           DFHEIV99,
  4463           DFHEIV99
  4464     SET ADDRESS OF DENIAL-CODES TO
  4465         DFHEIV20
  4466     MOVE EIBRESP  TO WS-RESPONSE
  4467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4468        IF RESP-NORMAL
  4469           IF MLINE1L > +0
  4470              STRING DN-DESCRIPTION ' ' MLINE1I
  4471                 DELIMITED BY '  ' INTO AT-DENIAL-INFO-1
  4472              END-STRING
  4473           ELSE
  4474              MOVE DN-DESCRIPTION
  4475                                 TO AT-DENIAL-INFO-1
  4476           END-IF
  4477           MOVE DN-RECORD-TYPE   TO CL-DENIAL-TYPE
  4478           MOVE AT-DENIAL-INFO-1 TO MLINE1O
  4479           MOVE +1               TO MLINE1L
  4480           MOVE AL-UANON         TO MLINE1A
  4481           MOVE DN-RECORD-TYPE
  4482                                 TO CL-DENIAL-TYPE
  4483        ELSE
  4484           MOVE AL-UABON         TO MDENCDA
  4485           MOVE -1               TO MDENCDL
  4486           MOVE ER-0884          TO EMI-ERROR
  4487           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4488           PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4489           PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4490           GO TO 8200-SEND-DATAONLY
  4491        END-IF
  4492     ELSE
  4493        MOVE AL-UABON            TO MDENCDA
  4494        MOVE -1                  TO MDENCDL
  4495        MOVE ER-0884             TO EMI-ERROR
  4496        PERFORM 9900-ERROR-FORMAT
  4497                                 THRU 9900-EXIT
  4498        PERFORM 2250-UNLOCK-CLAIM-MSTR
  4499                                 THRU 2250-EXIT
  4500        PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4501        GO TO 8200-SEND-DATAONLY
  4502     END-IF
  4503     GO TO 1070-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL151.cbl
  4504     .
  4505 1060-CONTINUE.
  4506     IF MDENCDL IS GREATER THAN +0
  4507         SET DEN-INDEX TO +1
  4508         SEARCH DEN-TABLE VARYING DEN-INDEX
  4509             AT END
  4510                 MOVE MLINE1I                TO  AT-DENIAL-INFO-1
  4511         WHEN MDENCDI IS EQUAL TO DENIAL-CODE (DEN-INDEX)
  4512             MOVE DENIAL-DESC (DEN-INDEX)    TO  AT-DENIAL-INFO-1
  4513                                                 MLINE1O
  4514     ELSE
  4515         IF MLINE1I = LOW-VALUES OR SPACES
  4516             MOVE SPACES         TO AT-DENIAL-INFO-1
  4517         ELSE
  4518             MOVE MLINE1I        TO AT-DENIAL-INFO-1.
  4519
  4520 1070-CONTINUE.
  4521     IF  MLINE2I  = LOW-VALUES OR SPACES
  4522         MOVE  SPACES            TO AT-DENIAL-INFO-2
  4523     ELSE
  4524         MOVE MLINE2I            TO AT-DENIAL-INFO-2.
  4525
  4526     IF (AT-DENIAL-INFO-1 IS EQUAL TO SPACES OR LOW-VALUES)
  4527         MOVE AT-DENIAL-INFO-2   TO AT-DENIAL-INFO-1
  4528         MOVE SPACES             TO AT-DENIAL-INFO-2.
  4529
  4530     MOVE WS-PRF-DT              TO AT-DENIAL-PROOF-DT.
  4531     MOVE WS-SEQ-NO-SAVED        TO WS-KEY-SEQUENCE-NO.
  4532
  4533     MOVE WS-TRAILER-KEY         TO AT-CONTROL-PRIMARY.
  4534     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  4535                                    AT-DENIAL-LAST-UPDATED-BY.
  4536     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  4537     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  4538                                    AT-DENIAL-DT
  4539                                    AT-DENIAL-LAST-MAINT-DT.
  4540     MOVE MDENCDI                TO AT-DENIAL-REASON-CODE.
  4541     MOVE LOW-VALUES             TO AT-RETRACTION-DT.
  4542
  4543 1090-EXIT.
  4544      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL151.cbl
  4546******************************************************************
  4547*    DMD ONLY  -  CREATE THE DIRECT MARKETING OUTPUT FILE
  4548******************************************************************
  4549 2000-CREATE-DMD-DMO.
  4550
  4551     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
  4552     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
  4553     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
  4554
  4555
  4556* EXEC CICS HANDLE CONDITION
  4557*         NOTFND   (2000-NOTE-NOT-FOUND)
  4558*         END-EXEC.
  4559*    MOVE '"$I                   ! # #00004481' TO DFHEIV0
  4560     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4562     MOVE X'2320233030303034343831' TO DFHEIV0(25:11)
  4563     CALL 'kxdfhei1' USING DFHEIV0
  4564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4565
  4566
  4567
  4568* EXEC CICS READ
  4569*         DATASET('ERNOTE')
  4570*         SET    (ADDRESS OF CERTIFICATE-NOTE)
  4571*         RIDFLD (W-NOTE-KEY)
  4572*         END-EXEC.
  4573     MOVE 'ERNOTE' TO DFHEIV1
  4574*    MOVE '&"S        E          (   #00004485' TO DFHEIV0
  4575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4577     MOVE X'2020233030303034343835' TO DFHEIV0(25:11)
  4578     CALL 'kxdfhei1' USING DFHEIV0,
  4579           DFHEIV1,
  4580           DFHEIV20,
  4581           DFHEIV99,
  4582           W-NOTE-KEY,
  4583           DFHEIV99,
  4584           DFHEIV99,
  4585           DFHEIV99
  4586     SET ADDRESS OF CERTIFICATE-NOTE TO
  4587         DFHEIV20
  4588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4589
  4590
  4591     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
  4592     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
  4593     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
  4594
  4595     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
  4596         MOVE 'CC'               TO DCT-PRODUCT-CODE
  4597     ELSE
  4598         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
  4599
  4600     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
  4601     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
  4602
  4603
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL151.cbl
  4604* EXEC CICS LINK
  4605*        PROGRAM    ('DLO006')
  4606*        COMMAREA   (DCT-COMMUNICATION-AREA)
  4607*        LENGTH     (WS-DCT-LENGTH)
  4608*    END-EXEC.
  4609     MOVE 'DLO006' TO DFHEIV1
  4610*    MOVE '."C                   ''   #00004503' TO DFHEIV0
  4611     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4613     MOVE X'2020233030303034353033' TO DFHEIV0(25:11)
  4614     CALL 'kxdfhei1' USING DFHEIV0,
  4615           DFHEIV1,
  4616           DCT-COMMUNICATION-AREA,
  4617           WS-DCT-LENGTH,
  4618           DFHEIV99,
  4619           DFHEIV99,
  4620           DFHEIV99
  4621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4622
  4623
  4624     IF  DCT-RETURN-CODE = 'OK'
  4625         GO TO 2000-CONT.
  4626
  4627     IF  DCT-RETURN-CODE = '01' OR '02'
  4628         GO TO 2000-EXIT.
  4629
  4630     IF  DCT-RETURN-CODE = '03'
  4631         MOVE ER-0951            TO EMI-ERROR
  4632         MOVE -1                 TO MLINE1L
  4633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4634         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4635             THRU 2250-EXIT
  4636         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4637         GO TO 8200-SEND-DATAONLY.
  4638
  4639     IF  DCT-RETURN-CODE = '06'
  4640         MOVE ER-0921            TO EMI-ERROR
  4641         MOVE -1                 TO MLINE1L
  4642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4643         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4644             THRU 2250-EXIT
  4645         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4646         GO TO 8200-SEND-DATAONLY.
  4647
  4648     IF  DCT-RETURN-CODE = '07'
  4649         MOVE ER-0919            TO EMI-ERROR
  4650         MOVE -1                 TO MLINE1L
  4651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4652         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4653             THRU 2250-EXIT
  4654         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4655         GO TO 8200-SEND-DATAONLY.
  4656
  4657     IF  DCT-RETURN-CODE = '04'
  4658         MOVE ER-0946            TO EMI-ERROR
  4659         MOVE -1                 TO MLINE1L
  4660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4661         PERFORM 2250-UNLOCK-CLAIM-MSTR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL151.cbl
  4662             THRU 2250-EXIT
  4663         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4664         GO TO 8200-SEND-DATAONLY.
  4665
  4666     IF  DCT-RETURN-CODE = '05'
  4667         MOVE ER-0947            TO EMI-ERROR
  4668         MOVE -1                 TO MLINE1L
  4669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4670         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4671             THRU 2250-EXIT
  4672         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4673         GO TO 8200-SEND-DATAONLY.
  4674
  4675     IF  DCT-RETURN-CODE = '08'
  4676         MOVE ER-0948            TO EMI-ERROR
  4677         MOVE -1                 TO MLINE1L
  4678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4679         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4680             THRU 2250-EXIT
  4681         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4682         GO TO 8200-SEND-DATAONLY.
  4683
  4684     IF  DCT-RETURN-CODE = 'N1'
  4685         MOVE ER-0950            TO EMI-ERROR
  4686         MOVE -1                 TO MLINE1L
  4687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4688         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4689             THRU 2250-EXIT
  4690         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4691         GO TO 8200-SEND-DATAONLY.
  4692
  4693     IF DCT-RETURN-CODE = 'E1'
  4694         MOVE ER-0974            TO EMI-ERROR
  4695         MOVE -1                 TO MLINE1L
  4696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4697         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4698             THRU 2250-EXIT
  4699         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4700         GO TO 8200-SEND-DATAONLY.
  4701
  4702     IF DCT-RETURN-CODE = 'E2'
  4703         MOVE ER-0975            TO EMI-ERROR
  4704         MOVE -1                 TO MLINE1L
  4705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4706         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4707             THRU 2250-EXIT
  4708         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4709         GO TO 8200-SEND-DATAONLY.
  4710
  4711     IF DCT-RETURN-CODE NOT = 'OK'
  4712         MOVE ER-0949            TO EMI-ERROR
  4713         MOVE -1                 TO MLINE1L
  4714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4715         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4716             THRU 2250-EXIT
  4717         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4718         GO TO 8200-SEND-DATAONLY.
  4719
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL151.cbl
  4720 2000-CONT.
  4721
  4722     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
  4723     MOVE 'CS'                   TO DM-RECORD-TYPE.
  4724     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
  4725     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
  4726     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
  4727     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
  4728     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
  4729
  4730     MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1.
  4731     MOVE ' '                    TO  DC-OPTION-CODE.
  4732     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4733     MOVE DC-GREG-DATE-1-YMD     TO  DMD-YYMMDD.
  4734
  4735     IF DMD-YY GREATER THAN 70
  4736         MOVE '19'               TO  DMD-DECADE
  4737     ELSE
  4738         MOVE '20'               TO  DMD-DECADE.
  4739
  4740     MOVE DMD-DATE-YYYYMMDD      TO  DM-STATUS-DATE.
  4741     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
  4742     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
  4743     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
  4744     PERFORM 2100-FORMAT-LAST-NAME-1ST THRU 2100-EXIT.
  4745     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
  4746
  4747     MOVE 'D'                    TO DM-STAT-CHANGE-TYPE.
  4748     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
  4749     MOVE '3'                    TO DM-CLAIM-STATUS.
  4750
  4751
  4752* EXEC CICS LINK
  4753*        PROGRAM    ('DLO025')
  4754*        COMMAREA   (DMO-COMMUNICATION-AREA)
  4755*        LENGTH     (WS-DMO-LENGTH)
  4756*    END-EXEC.
  4757     MOVE 'DLO025' TO DFHEIV1
  4758*    MOVE '."C                   ''   #00004636' TO DFHEIV0
  4759     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4761     MOVE X'2020233030303034363336' TO DFHEIV0(25:11)
  4762     CALL 'kxdfhei1' USING DFHEIV0,
  4763           DFHEIV1,
  4764           DMO-COMMUNICATION-AREA,
  4765           WS-DMO-LENGTH,
  4766           DFHEIV99,
  4767           DFHEIV99,
  4768           DFHEIV99
  4769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4770
  4771
  4772     IF  DM-RETURN-CODE = 'OK'
  4773         GO TO 2000-EXIT.
  4774
  4775     IF  DM-RETURN-CODE = '01'
  4776         MOVE ER-8051            TO EMI-ERROR
  4777         MOVE -1                 TO MLINE1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL151.cbl
  4778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4779         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4780             THRU 2250-EXIT
  4781         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4782         GO TO 8200-SEND-DATAONLY.
  4783
  4784     IF  DM-RETURN-CODE = '02'
  4785         MOVE ER-8052            TO EMI-ERROR
  4786         MOVE -1                 TO MLINE1L
  4787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4788         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4789             THRU 2250-EXIT
  4790         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4791         GO TO 8200-SEND-DATAONLY.
  4792
  4793     IF  DM-RETURN-CODE = '03'
  4794         MOVE ER-8053            TO EMI-ERROR
  4795         MOVE -1                 TO MLINE1L
  4796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4797         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4798             THRU 2250-EXIT
  4799         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4800         GO TO 8200-SEND-DATAONLY.
  4801
  4802     IF  DM-RETURN-CODE = '04'
  4803         MOVE ER-8054            TO EMI-ERROR
  4804         MOVE -1                 TO MLINE1L
  4805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4806         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4807             THRU 2250-EXIT
  4808         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4809         GO TO 8200-SEND-DATAONLY.
  4810
  4811     IF  DM-RETURN-CODE = '05'
  4812         MOVE ER-8055            TO EMI-ERROR
  4813         MOVE -1                 TO MLINE1L
  4814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4815         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4816             THRU 2250-EXIT
  4817         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4818         GO TO 8200-SEND-DATAONLY.
  4819
  4820     IF  DM-RETURN-CODE = '06'
  4821         MOVE ER-8056            TO EMI-ERROR
  4822         MOVE -1                 TO MLINE1L
  4823         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4824         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4825             THRU 2250-EXIT
  4826         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4827         GO TO 8200-SEND-DATAONLY.
  4828
  4829     IF  DM-RETURN-CODE = '07'
  4830         MOVE ER-8057            TO EMI-ERROR
  4831         MOVE -1                 TO MLINE1L
  4832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4833         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4834             THRU 2250-EXIT
  4835         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL151.cbl
  4836         GO TO 8200-SEND-DATAONLY.
  4837
  4838     IF  DM-RETURN-CODE = '08'
  4839         MOVE ER-8058            TO EMI-ERROR
  4840         MOVE -1                 TO MLINE1L
  4841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4842         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4843             THRU 2250-EXIT
  4844         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4845         GO TO 8200-SEND-DATAONLY.
  4846
  4847     IF  DM-RETURN-CODE = '09'
  4848         MOVE ER-8059            TO EMI-ERROR
  4849         MOVE -1                 TO MLINE1L
  4850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4851         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4852             THRU 2250-EXIT
  4853         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4854         GO TO 8200-SEND-DATAONLY.
  4855
  4856     IF  DM-RETURN-CODE = '10'
  4857         MOVE ER-8060            TO EMI-ERROR
  4858         MOVE -1                 TO MLINE1L
  4859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4860         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4861             THRU 2250-EXIT
  4862         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4863         GO TO 8200-SEND-DATAONLY.
  4864
  4865     IF  DM-RETURN-CODE = '11'
  4866         MOVE ER-8061            TO EMI-ERROR
  4867         MOVE -1                 TO MLINE1L
  4868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4869         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4870             THRU 2250-EXIT
  4871         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4872         GO TO 8200-SEND-DATAONLY.
  4873
  4874     IF  DM-RETURN-CODE = '12'
  4875         MOVE ER-8062            TO EMI-ERROR
  4876         MOVE -1                 TO MLINE1L
  4877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4878         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4879             THRU 2250-EXIT
  4880         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4881         GO TO 8200-SEND-DATAONLY.
  4882
  4883     IF  DM-RETURN-CODE = '13'
  4884         MOVE ER-8063            TO EMI-ERROR
  4885         MOVE -1                 TO MLINE1L
  4886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4887         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4888             THRU 2250-EXIT
  4889         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4890         GO TO 8200-SEND-DATAONLY.
  4891
  4892     IF  DM-RETURN-CODE = '14'
  4893         MOVE ER-8064            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL151.cbl
  4894         MOVE -1                 TO MLINE1L
  4895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4896         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4897             THRU 2250-EXIT
  4898         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4899         GO TO 8200-SEND-DATAONLY.
  4900
  4901     IF  DM-RETURN-CODE = '15'
  4902         MOVE ER-8065            TO EMI-ERROR
  4903         MOVE -1                 TO MLINE1L
  4904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4905         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4906             THRU 2250-EXIT
  4907         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4908         GO TO 8200-SEND-DATAONLY.
  4909
  4910     IF DM-RETURN-CODE = '16'
  4911         MOVE ER-8154            TO EMI-ERROR
  4912         MOVE -1                 TO MLINE1L
  4913         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  4914         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4915         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  4916         GO TO 8200-SEND-DATAONLY.
  4917
  4918     IF DM-RETURN-CODE = '17'
  4919         MOVE ER-8155            TO EMI-ERROR
  4920         MOVE -1                 TO MLINE1L
  4921         PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  4922         PERFORM 2250-UNLOCK-CLAIM-MSTR THRU 2250-EXIT
  4923         PERFORM 2255-UNLOCK-TRLR       THRU 2255-EXIT
  4924         GO TO 8200-SEND-DATAONLY.
  4925
  4926     IF DM-RETURN-CODE = 'N1'
  4927         MOVE ER-8152            TO EMI-ERROR
  4928         MOVE -1                 TO MLINE1L
  4929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4930         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4931             THRU 2250-EXIT
  4932         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4933         GO TO 8200-SEND-DATAONLY.
  4934
  4935     IF DM-RETURN-CODE = 'E1'
  4936         MOVE ER-8153            TO EMI-ERROR
  4937         MOVE -1                 TO MLINE1L
  4938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4939         PERFORM 2250-UNLOCK-CLAIM-MSTR
  4940             THRU 2250-EXIT
  4941         PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT
  4942         GO TO 8200-SEND-DATAONLY.
  4943
  4944     MOVE ER-8066                TO EMI-ERROR.
  4945     MOVE -1                     TO MLINE1L.
  4946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4947     PERFORM 2250-UNLOCK-CLAIM-MSTR
  4948         THRU 2250-EXIT.
  4949     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  4950     GO TO 8200-SEND-DATAONLY.
  4951
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL151.cbl
  4952 2000-NOTE-NOT-FOUND.
  4953
  4954     MOVE ER-0954                TO EMI-ERROR.
  4955     MOVE -1                     TO MLINE1L.
  4956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4957     PERFORM 2250-UNLOCK-CLAIM-MSTR
  4958         THRU 2250-EXIT.
  4959     PERFORM 2255-UNLOCK-TRLR THRU 2255-EXIT.
  4960     GO TO 8200-SEND-DATAONLY.
  4961
  4962 2000-EXIT.
  4963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL151.cbl
  4965
  4966 2100-FORMAT-LAST-NAME-1ST.
  4967*****************************************************************
  4968*             M O V E   N A M E   R O U T I N E                 *
  4969*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
  4970*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
  4971*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
  4972*                  FIELD                   VALUE                *
  4973*           W-NAME-LAST    (CL15)      SMITH                    *
  4974*           W-NAME-FIRST   (CL15)      JOHN                     *
  4975*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
  4976*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
  4977*     CONTAIN                                                   *
  4978*                SMITH, JOHN ALLEN                              *
  4979*     OR                                                        *
  4980*                SMITH, JOHN A.                                 *
  4981*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
  4982*     COPYBOOK, ELCNWA.                                         *
  4983*****************************************************************.
  4984
  4985     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  4986     MOVE ZERO                   TO  WS-NAME-SW.
  4987     SET NWA-INDEX               TO +1.
  4988
  4989     IF  W-NAME-LAST EQUAL SPACES
  4990             AND
  4991         W-NAME-MIDDLE EQUAL SPACES
  4992         MOVE +1                 TO WS-NAME-SW.
  4993
  4994     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
  4995     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  4996
  4997     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
  4998     PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  4999
  5000     SET NWA-INDEX UP BY +1.
  5001
  5002     IF  W-NAME-MIDDLE NOT EQUAL SPACES
  5003
  5004         IF  W-NAME-MIDDLE-2 EQUAL SPACES
  5005             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
  5006             SET NWA-INDEX UP BY +1
  5007             MOVE '.'            TO WS-NW (NWA-INDEX)
  5008             SET NWA-INDEX UP BY +2
  5009
  5010         ELSE
  5011             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
  5012             PERFORM 2150-MOVE-NAME THRU 2150-EXIT.
  5013
  5014 2100-EXIT.
  5015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL151.cbl
  5017 2150-MOVE-NAME.
  5018
  5019     IF  WS-NAME-SW GREATER THAN +1
  5020         GO TO 2150-EXIT.
  5021
  5022     IF  WS-NAME-WORK2 = SPACES
  5023         GO TO 2150-EXIT.
  5024
  5025     SET NWA-INDEX2            TO +1.
  5026     SET NWA-INDEX3            TO +2.
  5027
  5028 2150-MOVE-NAME-CYCLE.
  5029
  5030     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  5031
  5032     IF  NWA-INDEX LESS THAN +30
  5033         SET NWA-INDEX UP BY +1
  5034
  5035     ELSE
  5036         ADD +2                TO  WS-NAME-SW
  5037         GO TO 2150-EXIT.
  5038
  5039     IF  NWA-INDEX2 LESS THAN +20
  5040         SET NWA-INDEX3 UP BY +1
  5041         SET NWA-INDEX2 UP BY +1.
  5042
  5043     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
  5044             AND
  5045         WS-NW2 (NWA-INDEX3) EQUAL SPACES
  5046
  5047         IF  WS-NAME-SW EQUAL ZERO
  5048             MOVE ','            TO  WS-NW (NWA-INDEX)
  5049             SET NWA-INDEX UP BY +2
  5050             MOVE +1             TO  WS-NAME-SW
  5051             GO TO 2150-EXIT
  5052
  5053         ELSE
  5054             GO TO 2150-EXIT.
  5055
  5056     GO TO 2150-MOVE-NAME-CYCLE.
  5057
  5058 2150-EXIT.
  5059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL151.cbl
  5061 2250-UNLOCK-CLAIM-MSTR.
  5062
  5063* EXEC CICS UNLOCK
  5064*          DATASET  (ELMSTR-FILE-ID)
  5065*          END-EXEC.
  5066*    MOVE '&*                    #   #00004932' TO DFHEIV0
  5067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5069     MOVE X'2020233030303034393332' TO DFHEIV0(25:11)
  5070     CALL 'kxdfhei1' USING DFHEIV0,
  5071           ELMSTR-FILE-ID,
  5072           DFHEIV99
  5073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5074
  5075 2250-EXIT.
  5076     EXIT.
  5077 2255-UNLOCK-TRLR.
  5078
  5079* EXEC CICS UNLOCK
  5080*          DATASET (ELTRLR-FILE-ID)
  5081*          END-EXEC.
  5082*    MOVE '&*                    #   #00004938' TO DFHEIV0
  5083     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5085     MOVE X'2020233030303034393338' TO DFHEIV0(25:11)
  5086     CALL 'kxdfhei1' USING DFHEIV0,
  5087           ELTRLR-FILE-ID,
  5088           DFHEIV99
  5089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5090
  5091 2255-EXIT.
  5092     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL151.cbl
  5093/
  5094*************************************************************
  5095*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5096*************************************************************
  5097 2300-GETMAIN-DLYACTV.
  5098
  5099* EXEC CICS GETMAIN
  5100*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  5101*        LENGTH (25)
  5102*        INITIMG (WS-BLANK)
  5103*    END-EXEC.
  5104     MOVE 25
  5105       TO DFHEIV11
  5106*    MOVE ',"IL                  $   #00004948' TO DFHEIV0
  5107     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5109     MOVE X'2020233030303034393438' TO DFHEIV0(25:11)
  5110     CALL 'kxdfhei1' USING DFHEIV0,
  5111           DFHEIV20,
  5112           DFHEIV11,
  5113           WS-BLANK
  5114     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  5115         DFHEIV20
  5116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5117
  5118 2300-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL151.cbl
  5119/
  5120*************************************************************
  5121*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5122*************************************************************
  5123 2350-WRITE-DLYACTV.
  5124
  5125* EXEC CICS HANDLE CONDITION
  5126*        NOTOPEN (9986-NOTOPEN-DLYACTV)
  5127*        DUPREC (2350-EXIT)
  5128*    END-EXEC.
  5129*    MOVE '"$J%                  ! $ #00004959' TO DFHEIV0
  5130     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  5131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5132     MOVE X'2420233030303034393539' TO DFHEIV0(25:11)
  5133     CALL 'kxdfhei1' USING DFHEIV0
  5134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5135
  5136
  5137
  5138* EXEC CICS WRITE
  5139*        DATASET ('DLYACTV')
  5140*        RIDFLD (DA-KEY)
  5141*        FROM (DAILY-ACTIVITY-RECORD)
  5142*    END-EXEC.
  5143     MOVE LENGTH OF
  5144      DAILY-ACTIVITY-RECORD
  5145       TO DFHEIV11
  5146     MOVE 'DLYACTV' TO DFHEIV1
  5147*    MOVE '&$ L                  ''   #00004964' TO DFHEIV0
  5148     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5149     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5150     MOVE X'2020233030303034393634' TO DFHEIV0(25:11)
  5151     CALL 'kxdfhei1' USING DFHEIV0,
  5152           DFHEIV1,
  5153           DAILY-ACTIVITY-RECORD,
  5154           DFHEIV11,
  5155           DA-KEY,
  5156           DFHEIV99,
  5157           DFHEIV99
  5158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5159
  5160
  5161 2350-EXIT.
  5162     EXIT.
  5163
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL151.cbl
  5164/
  5165*************************************************************
  5166*****      CSO ADDITION - FOR BUILDING ACTIVITY FILE      ***
  5167*************************************************************
  5168
  5169 3500-BUILD-ACTIVITY-RECORD.
  5170
  5171     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  5172     MOVE WS-CLAIM-KEY           TO DA-KEY.
  5173     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
  5174                                 GIVING DA-TRAILER-SEQ-NO.
  5175     MOVE 'D'                    TO DA-RECORD-TYPE.
  5176
  5177 3500-EXIT.
  5178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL151.cbl
  5179/
  5180 3550-FIND-LETTER-TRLR.
  5181      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5182      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5183      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5184      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5185      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5186
  5187 3550-STARTBR-ELTRLR.
  5188
  5189
  5190* EXEC CICS HANDLE CONDITION
  5191*         ENDFILE   (3550-END)
  5192*         NOTFND    (3550-END)
  5193*     END-EXEC.
  5194*    MOVE '"$''I                  ! % #00004998' TO DFHEIV0
  5195     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5197     MOVE X'2520233030303034393938' TO DFHEIV0(25:11)
  5198     CALL 'kxdfhei1' USING DFHEIV0
  5199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5200
  5201
  5202
  5203* EXEC CICS STARTBR
  5204*         DATASET   (ELTRLR-FILE-ID)
  5205*         RIDFLD    (WS-TRAILER-KEY)
  5206*         GTEQ
  5207*     END-EXEC.
  5208     MOVE 0
  5209       TO DFHEIV11
  5210*    MOVE '&,         G          &   #00005003' TO DFHEIV0
  5211     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5212     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5213     MOVE X'2020233030303035303033' TO DFHEIV0(25:11)
  5214     CALL 'kxdfhei1' USING DFHEIV0,
  5215           ELTRLR-FILE-ID,
  5216           WS-TRAILER-KEY,
  5217           DFHEIV99,
  5218           DFHEIV11,
  5219           DFHEIV99
  5220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5221
  5222
  5223      MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
  5224
  5225 3550-READNEXT-ELTRLR.
  5226
  5227
  5228* EXEC CICS READNEXT
  5229*         DATASET   (ELTRLR-FILE-ID)
  5230*         RIDFLD    (WS-TRAILER-KEY)
  5231*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5232*     END-EXEC.
  5233     MOVE 0
  5234       TO DFHEIV11
  5235*    MOVE '&.S                   )   #00005013' TO DFHEIV0
  5236     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL151.cbl
  5237     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5238     MOVE X'2020233030303035303133' TO DFHEIV0(25:11)
  5239     CALL 'kxdfhei1' USING DFHEIV0,
  5240           ELTRLR-FILE-ID,
  5241           DFHEIV20,
  5242           DFHEIV99,
  5243           WS-TRAILER-KEY,
  5244           DFHEIV99,
  5245           DFHEIV11,
  5246           DFHEIV99,
  5247           DFHEIV99
  5248     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5249         DFHEIV20
  5250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5251
  5252
  5253      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5254         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5255         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5256         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5257          GO TO 3550-END.
  5258
  5259      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5260          GO TO 3550-READNEXT-ELTRLR.
  5261
  5262     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-ANSWER-DT
  5263         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER-DT
  5264     END-IF.
  5265
  5266     GO TO 3550-READNEXT-ELTRLR.
  5267
  5268 3550-END.
  5269
  5270     IF WS-MAX-LETTER-ANSWER-DT NOT EQUAL LOW-VALUES AND SPACES
  5271         MOVE SPACES             TO  DC-OPTION-CODE
  5272         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
  5273         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5274         MOVE DC-GREG-DATE-1-MDY TO PI-PROOF-DATE
  5275         MOVE PI-PROOF-DATE TO  MPRFDTO
  5276         INSPECT MPRFDTI REPLACING ALL ' ' BY '/'
  5277     END-IF.
  5278
  5279
  5280* EXEC CICS ENDBR
  5281*         DATASET   (ELTRLR-FILE-ID)
  5282*     END-EXEC.
  5283     MOVE 0
  5284       TO DFHEIV11
  5285*    MOVE '&2                    $   #00005045' TO DFHEIV0
  5286     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5287     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5288     MOVE X'2020233030303035303435' TO DFHEIV0(25:11)
  5289     CALL 'kxdfhei1' USING DFHEIV0,
  5290           ELTRLR-FILE-ID,
  5291           DFHEIV11,
  5292           DFHEIV99
  5293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5294
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL151.cbl
  5295
  5296 3550-EXIT.
  5297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL151.cbl
  5298/
  5299 6000-RESET-AUTO-ACTIVITY.
  5300******************************************************************
  5301*    RESET ALL FUTURE LETTER ACTIVITY AWAITING FURTHER ACTION    *
  5302*    (RESEND, FOLLOW-UP, ETC) BY MOVING LOW-VALUES TO THE        *
  5303*    FOLLOW-UP OR RESEND DATES IN THE ACTIVITY TRAILER AND THE   *
  5304*    RESEND DATE IS THE LETTER ARCHIVE, IF NECESSARY.            *
  5305******************************************************************
  5306      MOVE PI-COMPANY-CD             TO  WS-KEY-COMPANY-CD.
  5307      MOVE PI-CARRIER                TO  WS-KEY-CARRIER.
  5308      MOVE PI-CLAIM-NO               TO  WS-KEY-CLAIM-NO.
  5309      MOVE PI-CERT-NO                TO  WS-KEY-CERT-NO.
  5310      MOVE +100                      TO  WS-KEY-SEQUENCE-NO.
  5311
  5312 6000-STARTBR-ELTRLR.
  5313
  5314
  5315* EXEC CICS HANDLE CONDITION
  5316*         ENDFILE   (6000-END-RESET)
  5317*         NOTFND    (6000-END-RESET)
  5318*     END-EXEC.
  5319*    MOVE '"$''I                  ! & #00005067' TO DFHEIV0
  5320     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5322     MOVE X'2620233030303035303637' TO DFHEIV0(25:11)
  5323     CALL 'kxdfhei1' USING DFHEIV0
  5324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5325
  5326
  5327
  5328* EXEC CICS STARTBR
  5329*         DATASET   (ELTRLR-FILE-ID)
  5330*         RIDFLD    (WS-TRAILER-KEY)
  5331*         GTEQ
  5332*     END-EXEC.
  5333     MOVE 0
  5334       TO DFHEIV11
  5335*    MOVE '&,         G          &   #00005072' TO DFHEIV0
  5336     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5338     MOVE X'2020233030303035303732' TO DFHEIV0(25:11)
  5339     CALL 'kxdfhei1' USING DFHEIV0,
  5340           ELTRLR-FILE-ID,
  5341           WS-TRAILER-KEY,
  5342           DFHEIV99,
  5343           DFHEIV11,
  5344           DFHEIV99
  5345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5346
  5347
  5348      MOVE 'Y'                       TO  WS-BROWSE-SW.
  5349
  5350 6000-READNEXT-ELTRLR.
  5351
  5352
  5353* EXEC CICS READNEXT
  5354*         DATASET   (ELTRLR-FILE-ID)
  5355*         RIDFLD    (WS-TRAILER-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL151.cbl
  5356*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5357*     END-EXEC.
  5358     MOVE 0
  5359       TO DFHEIV11
  5360*    MOVE '&.S                   )   #00005082' TO DFHEIV0
  5361     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5362     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5363     MOVE X'2020233030303035303832' TO DFHEIV0(25:11)
  5364     CALL 'kxdfhei1' USING DFHEIV0,
  5365           ELTRLR-FILE-ID,
  5366           DFHEIV20,
  5367           DFHEIV99,
  5368           WS-TRAILER-KEY,
  5369           DFHEIV99,
  5370           DFHEIV11,
  5371           DFHEIV99,
  5372           DFHEIV99
  5373     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5374         DFHEIV20
  5375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5376
  5377
  5378      IF (PI-COMPANY-CD IS NOT EQUAL TO  WS-KEY-COMPANY-CD) OR
  5379         (PI-CARRIER    IS NOT EQUAL TO  WS-KEY-CARRIER)    OR
  5380         (PI-CLAIM-NO   IS NOT EQUAL TO  WS-KEY-CLAIM-NO)   OR
  5381         (PI-CERT-NO    IS NOT EQUAL TO  WS-KEY-CERT-NO)
  5382          GO TO 6000-END-RESET.
  5383
  5384      IF WS-TRAILER-KEY IS EQUAL TO PI-PREV-TRLR-KEY
  5385          GO TO 6000-READNEXT-ELTRLR.
  5386
  5387      IF AT-TRAILER-TYPE IS NOT EQUAL TO '4'
  5388          GO TO 6000-READNEXT-ELTRLR.
  5389
  5390      IF (AT-LETTER-ANSWERED-DT NOT EQUAL LOW-VALUES AND SPACES)
  5391          GO TO 6000-READNEXT-ELTRLR.
  5392
  5393      IF (AT-AUTO-RE-SEND-DT EQUAL LOW-VALUES OR SPACES)
  5394        AND
  5395         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES OR SPACES)
  5396          GO TO 6000-READNEXT-ELTRLR.
  5397
  5398      IF AT-RECEIPT-FOLLOW-UP IS LESS THAN SAVE-BIN-DATE AND
  5399         AT-AUTO-RE-SEND-DT IS LESS THAN SAVE-BIN-DATE   AND
  5400         AT-RESEND-PRINT-DATE IS LESS THAN SAVE-BIN-DATE
  5401          GO TO 6000-READNEXT-ELTRLR.
  5402
  5403      IF (AT-AUTO-RE-SEND-DT NOT EQUAL LOW-VALUES AND SPACES)
  5404        AND
  5405         (AT-RESEND-PRINT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  5406        AND
  5407         (AT-RECEIPT-FOLLOW-UP EQUAL LOW-VALUES)
  5408          GO TO 6000-READNEXT-ELTRLR.
  5409
  5410 6000-END-BROWSE.
  5411
  5412      MOVE WS-TRAILER-KEY            TO  PI-PREV-TRLR-KEY.
  5413
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL151.cbl
  5414
  5415* EXEC CICS ENDBR
  5416*         DATASET   (ELTRLR-FILE-ID)
  5417*     END-EXEC.
  5418     MOVE 0
  5419       TO DFHEIV11
  5420*    MOVE '&2                    $   #00005124' TO DFHEIV0
  5421     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5422     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5423     MOVE X'2020233030303035313234' TO DFHEIV0(25:11)
  5424     CALL 'kxdfhei1' USING DFHEIV0,
  5425           ELTRLR-FILE-ID,
  5426           DFHEIV11,
  5427           DFHEIV99
  5428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5429
  5430
  5431      MOVE 'N'                       TO  WS-BROWSE-SW.
  5432
  5433 6000-READ-ELTRLR-UPDATE.
  5434
  5435
  5436* EXEC CICS READ
  5437*         DATASET   (ELTRLR-FILE-ID)
  5438*         RIDFLD    (WS-TRAILER-KEY)
  5439*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5440*         UPDATE
  5441*     END-EXEC.
  5442*    MOVE '&"S        EU         (   #00005132' TO DFHEIV0
  5443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5445     MOVE X'2020233030303035313332' TO DFHEIV0(25:11)
  5446     CALL 'kxdfhei1' USING DFHEIV0,
  5447           ELTRLR-FILE-ID,
  5448           DFHEIV20,
  5449           DFHEIV99,
  5450           WS-TRAILER-KEY,
  5451           DFHEIV99,
  5452           DFHEIV99,
  5453           DFHEIV99
  5454     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5455         DFHEIV20
  5456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5457
  5458
  5459      MOVE 'Y'                       TO  WS-UPDATE-SW.
  5460
  5461      IF AT-AUTO-RE-SEND-DT IS NOT LESS THAN SAVE-BIN-DATE
  5462          MOVE LOW-VALUES            TO  AT-AUTO-RE-SEND-DT
  5463          MOVE PI-COMPANY-CD         TO  ELARCH-COMPANY-CD
  5464          MOVE AT-LETTER-ARCHIVE-NO  TO  ELARCH-ARCHIVE-NO
  5465          MOVE '1'                   TO  ELARCH-RECORD-TYPE
  5466          MOVE +0                    TO  ELARCH-SEQ-NO
  5467          PERFORM 6200-READ-ELARCH-UPDATE THRU 6200-EXIT.
  5468
  5469      IF AT-RECEIPT-FOLLOW-UP IS NOT LESS THAN SAVE-BIN-DATE
  5470          MOVE LOW-VALUES            TO  AT-RECEIPT-FOLLOW-UP.
  5471
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL151.cbl
  5472 6000-REWRITE-ELTRLR.
  5473
  5474
  5475* EXEC CICS REWRITE
  5476*         DATASET   (ELTRLR-FILE-ID)
  5477*         FROM      (ACTIVITY-TRAILERS)
  5478*     END-EXEC.
  5479     MOVE LENGTH OF
  5480      ACTIVITY-TRAILERS
  5481       TO DFHEIV11
  5482*    MOVE '&& L                  %   #00005154' TO DFHEIV0
  5483     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5484     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5485     MOVE X'2020233030303035313534' TO DFHEIV0(25:11)
  5486     CALL 'kxdfhei1' USING DFHEIV0,
  5487           ELTRLR-FILE-ID,
  5488           ACTIVITY-TRAILERS,
  5489           DFHEIV11,
  5490           DFHEIV99
  5491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5492
  5493
  5494      GO TO 6000-STARTBR-ELTRLR.
  5495
  5496 6000-END-RESET.
  5497
  5498      IF WS-BROWSE-SW IS EQUAL TO 'Y'
  5499          MOVE 'N'                   TO  WS-BROWSE-SW
  5500
  5501* EXEC CICS ENDBR
  5502*             DATASET   (ELTRLR-FILE-ID)
  5503*         END-EXEC.
  5504     MOVE 0
  5505       TO DFHEIV11
  5506*    MOVE '&2                    $   #00005165' TO DFHEIV0
  5507     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5508     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5509     MOVE X'2020233030303035313635' TO DFHEIV0(25:11)
  5510     CALL 'kxdfhei1' USING DFHEIV0,
  5511           ELTRLR-FILE-ID,
  5512           DFHEIV11,
  5513           DFHEIV99
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516
  5517 6000-EXIT.
  5518     EXIT.
  5519
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL151.cbl
  5521 6100-CHECK-AUTO-ACTIVITY.
  5522******************************************************************
  5523*    READ THE AUTOMATIC ACTIVITY RECORD TO DETERMINE IF THE      *
  5524*    AUTOMATIC ACTIVITY CODE IN THE CLAIM MASTER IS TO BE RESET. *
  5525******************************************************************
  5526
  5527
  5528* EXEC CICS HANDLE CONDITION
  5529*         NOTFND   (6100-NOT-FOUND)
  5530*     END-EXEC.
  5531*    MOVE '"$I                   ! '' #00005179' TO DFHEIV0
  5532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5534     MOVE X'2720233030303035313739' TO DFHEIV0(25:11)
  5535     CALL 'kxdfhei1' USING DFHEIV0
  5536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5537
  5538
  5539      MOVE PI-COMPANY-ID             TO  ELCNTL-COMPANY-ID.
  5540      MOVE 'T'                       TO  ELCNTL-RECORD-TYPE.
  5541      MOVE SPACES                    TO  ELCNTL-ACCESS.
  5542      MOVE +0                        TO  ELCNTL-SEQ-NO.
  5543
  5544
  5545* EXEC CICS READ
  5546*         DATASET   (ELCNTL-FILE-ID)
  5547*         RIDFLD    (ELCNTL-KEY)
  5548*         SET       (ADDRESS OF CONTROL-FILE)
  5549*     END-EXEC.
  5550*    MOVE '&"S        E          (   #00005188' TO DFHEIV0
  5551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5553     MOVE X'2020233030303035313838' TO DFHEIV0(25:11)
  5554     CALL 'kxdfhei1' USING DFHEIV0,
  5555           ELCNTL-FILE-ID,
  5556           DFHEIV20,
  5557           DFHEIV99,
  5558           ELCNTL-KEY,
  5559           DFHEIV99,
  5560           DFHEIV99,
  5561           DFHEIV99
  5562     SET ADDRESS OF CONTROL-FILE TO
  5563         DFHEIV20
  5564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5565
  5566
  5567      IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  5568          MOVE CL-ACTIVITY-CODE      TO  MISC-SUB
  5569          IF MISC-SUB IS GREATER THAN +9
  5570              SUBTRACT +9 FROM MISC-SUB
  5571              MOVE CF-USER-RESET-SW (MISC-SUB) TO  WS-RESET-SW
  5572          ELSE
  5573              MOVE CF-SYS-RESET-SW  (MISC-SUB) TO  WS-RESET-SW.
  5574
  5575      MOVE 'Y'                       TO  WS-REC-FOUND-SW.
  5576      GO TO 6100-EXIT.
  5577
  5578 6100-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL151.cbl
  5579
  5580     MOVE 'N'                        TO  WS-RESET-SW
  5581                                         WS-REC-FOUND-SW.
  5582
  5583 6100-EXIT.
  5584     EXIT.
  5585
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL151.cbl
  5587 6200-READ-ELARCH-UPDATE.
  5588******************************************************************
  5589*  READ AND UPDATE THE RESEND DATE IN THE LETTER ARCHIVE RECORD  *
  5590******************************************************************
  5591
  5592
  5593* EXEC CICS HANDLE CONDITION
  5594*         NOTFND   (6200-EXIT)
  5595*     END-EXEC.
  5596*    MOVE '"$I                   ! ( #00005219' TO DFHEIV0
  5597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5599     MOVE X'2820233030303035323139' TO DFHEIV0(25:11)
  5600     CALL 'kxdfhei1' USING DFHEIV0
  5601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5602
  5603
  5604
  5605* EXEC CICS READ
  5606*         DATASET   (ELARCH-FILE-ID)
  5607*         RIDFLD    (ELARCH-KEY)
  5608*         SET       (ADDRESS OF LETTER-ARCHIVE)
  5609*         UPDATE
  5610*     END-EXEC.
  5611*    MOVE '&"S        EU         (   #00005223' TO DFHEIV0
  5612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5613     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5614     MOVE X'2020233030303035323233' TO DFHEIV0(25:11)
  5615     CALL 'kxdfhei1' USING DFHEIV0,
  5616           ELARCH-FILE-ID,
  5617           DFHEIV20,
  5618           DFHEIV99,
  5619           ELARCH-KEY,
  5620           DFHEIV99,
  5621           DFHEIV99,
  5622           DFHEIV99
  5623     SET ADDRESS OF LETTER-ARCHIVE TO
  5624         DFHEIV20
  5625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5626
  5627
  5628      MOVE LOW-VALUES                TO  LA-RESEND-DATE.
  5629
  5630 6200-REWRITE-ELARCH.
  5631
  5632
  5633* EXEC CICS REWRITE
  5634*         DATASET   (ELARCH-FILE-ID)
  5635*         FROM      (LETTER-ARCHIVE)
  5636*     END-EXEC.
  5637     MOVE LENGTH OF
  5638      LETTER-ARCHIVE
  5639       TO DFHEIV11
  5640*    MOVE '&& L                  %   #00005234' TO DFHEIV0
  5641     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5642     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5643     MOVE X'2020233030303035323334' TO DFHEIV0(25:11)
  5644     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL151.cbl
  5645           ELARCH-FILE-ID,
  5646           LETTER-ARCHIVE,
  5647           DFHEIV11,
  5648           DFHEIV99
  5649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5650
  5651
  5652 6200-EXIT.
  5653     EXIT.
  5654
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL151.cbl
  5656 7000-READ-ELMSTR-UPDATE.
  5657
  5658
  5659* EXEC CICS  HANDLE CONDITION
  5660*           NOTFND  (7000-NOTFND)
  5661*           NOTOPEN (9981-NOTOPEN-MSTR)
  5662*    END-EXEC.
  5663*    MOVE '"$IJ                  ! ) #00005245' TO DFHEIV0
  5664     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5666     MOVE X'2920233030303035323435' TO DFHEIV0(25:11)
  5667     CALL 'kxdfhei1' USING DFHEIV0
  5668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5669
  5670
  5671
  5672* EXEC CICS  READ
  5673*        DATASET  (ELMSTR-FILE-ID)
  5674*        RIDFLD   (WS-CLAIM-KEY)
  5675*        SET      (ADDRESS OF CLAIM-MASTER)
  5676*        UPDATE
  5677*    END-EXEC.
  5678*    MOVE '&"S        EU         (   #00005250' TO DFHEIV0
  5679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5681     MOVE X'2020233030303035323530' TO DFHEIV0(25:11)
  5682     CALL 'kxdfhei1' USING DFHEIV0,
  5683           ELMSTR-FILE-ID,
  5684           DFHEIV20,
  5685           DFHEIV99,
  5686           WS-CLAIM-KEY,
  5687           DFHEIV99,
  5688           DFHEIV99,
  5689           DFHEIV99
  5690     SET ADDRESS OF CLAIM-MASTER TO
  5691         DFHEIV20
  5692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5693
  5694
  5695     GO TO 7000-EXIT.
  5696
  5697 7000-NOTFND.
  5698
  5699     MOVE ER-0133                TO  EMI-ERROR.
  5700     MOVE -1                     TO  MLINE1L.
  5701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5702     GO TO 8200-SEND-DATAONLY.
  5703
  5704 7000-EXIT.
  5705      EXIT.
  5706
  5707 7010-REWRITE-ELMSTR.
  5708
  5709
  5710* EXEC CICS HANDLE CONDITION
  5711*        DUPKEY (7010-EXIT)
  5712*        END-EXEC.
  5713*    MOVE '"$$                   ! * #00005271' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL151.cbl
  5714     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5716     MOVE X'2A20233030303035323731' TO DFHEIV0(25:11)
  5717     CALL 'kxdfhei1' USING DFHEIV0
  5718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5719
  5720
  5721
  5722* EXEC CICS  REWRITE
  5723*        DATASET  (ELMSTR-FILE-ID)
  5724*        FROM     (CLAIM-MASTER)
  5725*    END-EXEC.
  5726     MOVE LENGTH OF
  5727      CLAIM-MASTER
  5728       TO DFHEIV11
  5729*    MOVE '&& L                  %   #00005275' TO DFHEIV0
  5730     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5732     MOVE X'2020233030303035323735' TO DFHEIV0(25:11)
  5733     CALL 'kxdfhei1' USING DFHEIV0,
  5734           ELMSTR-FILE-ID,
  5735           CLAIM-MASTER,
  5736           DFHEIV11,
  5737           DFHEIV99
  5738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5739
  5740
  5741 7010-EXIT.
  5742      EXIT.
  5743
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL151.cbl
  5745 7100-GETMAIN-ELTRLR.
  5746
  5747
  5748* EXEC CICS GETMAIN
  5749*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  5750*        INITIMG (GETMAIN-SPACE)
  5751*        LENGTH  (WS-TRLR-LENGTH)
  5752*    END-EXEC.
  5753*    MOVE ',"IL                  $   #00005286' TO DFHEIV0
  5754     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5755     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5756     MOVE X'2020233030303035323836' TO DFHEIV0(25:11)
  5757     CALL 'kxdfhei1' USING DFHEIV0,
  5758           DFHEIV20,
  5759           WS-TRLR-LENGTH,
  5760           GETMAIN-SPACE
  5761     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5762         DFHEIV20
  5763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5764
  5765
  5766 7100-EXIT.
  5767     EXIT.
  5768
  5769 7110-WRITE-ELTRLR.
  5770
  5771* EXEC CICS  HANDLE CONDITION
  5772*           DUPREC   (7110-DUPREC)
  5773*    END-EXEC.
  5774*    MOVE '"$%                   ! + #00005296' TO DFHEIV0
  5775     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5777     MOVE X'2B20233030303035323936' TO DFHEIV0(25:11)
  5778     CALL 'kxdfhei1' USING DFHEIV0
  5779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5780
  5781
  5782
  5783* EXEC CICS  WRITE
  5784*           DATASET  (ELTRLR-FILE-ID)
  5785*           RIDFLD   (WS-TRAILER-KEY)
  5786*           FROM     (ACTIVITY-TRAILERS)
  5787*    END-EXEC.
  5788     MOVE LENGTH OF
  5789      ACTIVITY-TRAILERS
  5790       TO DFHEIV11
  5791*    MOVE '&$ L                  ''   #00005300' TO DFHEIV0
  5792     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5794     MOVE X'2020233030303035333030' TO DFHEIV0(25:11)
  5795     CALL 'kxdfhei1' USING DFHEIV0,
  5796           ELTRLR-FILE-ID,
  5797           ACTIVITY-TRAILERS,
  5798           DFHEIV11,
  5799           WS-TRAILER-KEY,
  5800           DFHEIV99,
  5801           DFHEIV99
  5802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL151.cbl
  5803
  5804
  5805     GO TO 7110-EXIT.
  5806
  5807 7110-DUPREC.
  5808
  5809     MOVE ER-0132                TO  EMI-ERROR.
  5810     MOVE -1                     TO  MLINE1L.
  5811     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5812     GO TO 8200-SEND-DATAONLY.
  5813
  5814 7110-EXIT.
  5815      EXIT.
  5816
  5817 7120-READ-ELTRLR-UPDATE.
  5818
  5819
  5820* EXEC CICS  HANDLE CONDITION
  5821*           NOTFND  (9965-NO-TRLR-ERROR)
  5822*           NOTOPEN (9982-NOTOPEN-TRLR)
  5823*    END-EXEC.
  5824*    MOVE '"$IJ                  ! , #00005320' TO DFHEIV0
  5825     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5827     MOVE X'2C20233030303035333230' TO DFHEIV0(25:11)
  5828     CALL 'kxdfhei1' USING DFHEIV0
  5829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5830
  5831
  5832
  5833* EXEC CICS  READ
  5834*        DATASET  (ELTRLR-FILE-ID)
  5835*        RIDFLD   (WS-TRAILER-KEY)
  5836*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  5837*        UPDATE
  5838*    END-EXEC.
  5839*    MOVE '&"S        EU         (   #00005325' TO DFHEIV0
  5840     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5841     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5842     MOVE X'2020233030303035333235' TO DFHEIV0(25:11)
  5843     CALL 'kxdfhei1' USING DFHEIV0,
  5844           ELTRLR-FILE-ID,
  5845           DFHEIV20,
  5846           DFHEIV99,
  5847           WS-TRAILER-KEY,
  5848           DFHEIV99,
  5849           DFHEIV99,
  5850           DFHEIV99
  5851     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5852         DFHEIV20
  5853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5854
  5855
  5856 7120-EXIT.
  5857      EXIT.
  5858
  5859 7130-REWRITE-ELTRLR.
  5860
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL151.cbl
  5861
  5862* EXEC CICS  REWRITE
  5863*        DATASET  (ELTRLR-FILE-ID)
  5864*        FROM     (ACTIVITY-TRAILERS)
  5865*    END-EXEC.
  5866     MOVE LENGTH OF
  5867      ACTIVITY-TRAILERS
  5868       TO DFHEIV11
  5869*    MOVE '&& L                  %   #00005337' TO DFHEIV0
  5870     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5871     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5872     MOVE X'2020233030303035333337' TO DFHEIV0(25:11)
  5873     CALL 'kxdfhei1' USING DFHEIV0,
  5874           ELTRLR-FILE-ID,
  5875           ACTIVITY-TRAILERS,
  5876           DFHEIV11,
  5877           DFHEIV99
  5878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5879
  5880
  5881 7130-EXIT.
  5882      EXIT.
  5883
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL151.cbl
  5885 8100-SEND-INITIAL-MAP.
  5886
  5887     MOVE SAVE-DATE                  TO  MRNDATEO.
  5888     MOVE EIBTIME                    TO  TIME-IN.
  5889     MOVE TIME-OUT                   TO  MRNTIMEO.
  5890
  5891
  5892* EXEC CICS  SEND
  5893*         MAP      (MAP-NAME)
  5894*         MAPSET   (MAPSET-NAME)
  5895*         FROM     (EL151AO)
  5896*         ERASE
  5897*         CURSOR
  5898*    END-EXEC.
  5899     MOVE LENGTH OF
  5900      EL151AO
  5901       TO DFHEIV12
  5902     MOVE -1
  5903       TO DFHEIV11
  5904*    MOVE '8$     CT  E    H L F ,   #00005352' TO DFHEIV0
  5905     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5906     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5907     MOVE X'2020233030303035333532' TO DFHEIV0(25:11)
  5908     CALL 'kxdfhei1' USING DFHEIV0,
  5909           MAP-NAME,
  5910           EL151AO,
  5911           DFHEIV12,
  5912           MAPSET-NAME,
  5913           DFHEIV99,
  5914           DFHEIV99,
  5915           DFHEIV99,
  5916           DFHEIV11,
  5917           DFHEIV99,
  5918           DFHEIV99,
  5919           DFHEIV99
  5920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5921
  5922
  5923     GO TO 9100-RETURN-TRAN.
  5924
  5925 8200-SEND-DATAONLY.
  5926
  5927     MOVE SAVE-DATE                  TO  MRNDATEO.
  5928     MOVE EIBTIME                    TO  TIME-IN.
  5929     MOVE TIME-OUT                   TO  MRNTIMEO.
  5930
  5931
  5932* EXEC CICS  SEND
  5933*        MAP       (MAP-NAME)
  5934*        MAPSET    (MAPSET-NAME)
  5935*        FROM      (EL151AO)
  5936*        DATAONLY
  5937*        CURSOR
  5938*    END-EXEC.
  5939     MOVE LENGTH OF
  5940      EL151AO
  5941       TO DFHEIV12
  5942     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL151.cbl
  5943       TO DFHEIV11
  5944*    MOVE '8$D    CT       H L F ,   #00005368' TO DFHEIV0
  5945     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5946     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5947     MOVE X'2020233030303035333638' TO DFHEIV0(25:11)
  5948     CALL 'kxdfhei1' USING DFHEIV0,
  5949           MAP-NAME,
  5950           EL151AO,
  5951           DFHEIV12,
  5952           MAPSET-NAME,
  5953           DFHEIV99,
  5954           DFHEIV99,
  5955           DFHEIV99,
  5956           DFHEIV11,
  5957           DFHEIV99,
  5958           DFHEIV99,
  5959           DFHEIV99
  5960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5961
  5962
  5963     GO TO 9100-RETURN-TRAN.
  5964
  5965 8300-SEND-TEXT.
  5966
  5967* EXEC CICS SEND TEXT
  5968*        FROM     (LOGOFF-TEXT)
  5969*        LENGTH   (LOGOFF-LENGTH)
  5970*        ERASE
  5971*        FREEKB
  5972*    END-EXEC.
  5973*    MOVE '8&      T  E F  H   F -   #00005379' TO DFHEIV0
  5974     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5975     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5976     MOVE X'2020233030303035333739' TO DFHEIV0(25:11)
  5977     CALL 'kxdfhei1' USING DFHEIV0,
  5978           LOGOFF-TEXT,
  5979           LOGOFF-LENGTH,
  5980           DFHEIV99,
  5981           DFHEIV99,
  5982           DFHEIV99,
  5983           DFHEIV99,
  5984           DFHEIV99,
  5985           DFHEIV99,
  5986           DFHEIV99,
  5987           DFHEIV99,
  5988           DFHEIV99,
  5989           DFHEIV99
  5990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5991
  5992
  5993
  5994* EXEC CICS RETURN
  5995*        END-EXEC.
  5996*    MOVE '.(                    &   #00005386' TO DFHEIV0
  5997     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5998     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5999     MOVE X'2020233030303035333836' TO DFHEIV0(25:11)
  6000     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL151.cbl
  6001           DFHEIV99,
  6002           DFHEIV99,
  6003           DFHEIV99,
  6004           DFHEIV99,
  6005           DFHEIV99
  6006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6007
  6008
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL151.cbl
  6010 9600-PGMID-ERROR.
  6011
  6012* EXEC CICS HANDLE CONDITION
  6013*        PGMIDERR (8300-SEND-TEXT)
  6014*    END-EXEC.
  6015*    MOVE '"$L                   ! - #00005391' TO DFHEIV0
  6016     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6018     MOVE X'2D20233030303035333931' TO DFHEIV0(25:11)
  6019     CALL 'kxdfhei1' USING DFHEIV0
  6020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6021
  6022
  6023     MOVE THIS-PGM               TO LOGOFF-PGM
  6024                                    PI-CALLING-PROGRAM.
  6025     MOVE SPACES                 TO PI-ENTRY-CD-1.
  6026     MOVE 'EL005'                TO THIS-PGM.
  6027     MOVE THIS-PGM               TO LOGOFF-PGM.
  6028     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6029     GO TO 9300-XCTL.
  6030
  6031 8800-UNAUTHORIZED-ACCESS.
  6032
  6033     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6034     GO TO 8300-SEND-TEXT.
  6035
  6036 9100-RETURN-TRAN.
  6037     MOVE EMI-ERROR-NUMBER (1)    TO  PI-LAST-ERROR-NO.
  6038     MOVE '151A'                  TO  PI-CURRENT-SCREEN-NO.
  6039
  6040
  6041* EXEC CICS  RETURN
  6042*        TRANSID  (WS-TRANS-ID)
  6043*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6044*        LENGTH   (PI-COMM-LENGTH)
  6045*    END-EXEC.
  6046*    MOVE '.(CT                  &   #00005412' TO DFHEIV0
  6047     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6049     MOVE X'2020233030303035343132' TO DFHEIV0(25:11)
  6050     CALL 'kxdfhei1' USING DFHEIV0,
  6051           WS-TRANS-ID,
  6052           PROGRAM-INTERFACE-BLOCK,
  6053           PI-COMM-LENGTH,
  6054           DFHEIV99,
  6055           DFHEIV99
  6056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6057
  6058
  6059 9300-XCTL.
  6060
  6061* EXEC CICS XCTL
  6062*        PROGRAM  (THIS-PGM)
  6063*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  6064*        LENGTH   (PI-COMM-LENGTH)
  6065*    END-EXEC.
  6066*    MOVE '.$C                   $   #00005419' TO DFHEIV0
  6067     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL151.cbl
  6068     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6069     MOVE X'2020233030303035343139' TO DFHEIV0(25:11)
  6070     CALL 'kxdfhei1' USING DFHEIV0,
  6071           THIS-PGM,
  6072           PROGRAM-INTERFACE-BLOCK,
  6073           PI-COMM-LENGTH
  6074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6075
  6076
  6077 9400-CLEAR.
  6078     MOVE PI-RETURN-TO-PROGRAM       TO  THIS-PGM.
  6079     GO TO 9300-XCTL.
  6080
  6081 9650-DEEDIT.
  6082
  6083* EXEC CICS BIF DEEDIT
  6084*        FIELD (DEEDIT-FIELD)
  6085*        LENGTH(15)
  6086*    END-EXEC.
  6087     MOVE 15
  6088       TO DFHEIV11
  6089*    MOVE '@"L                   #   #00005430' TO DFHEIV0
  6090     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6092     MOVE X'2020233030303035343330' TO DFHEIV0(25:11)
  6093     CALL 'kxdfhei1' USING DFHEIV0,
  6094           DEEDIT-FIELD,
  6095           DFHEIV11
  6096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6097
  6098
  6099 9650-EXIT.
  6100      EXIT.
  6101
  6102 9700-LINK-DATE-CONVERT.
  6103
  6104* EXEC CICS LINK
  6105*           PROGRAM  ('ELDATCV')
  6106*           COMMAREA (DATE-CONVERSION-DATA)
  6107*           LENGTH   (DC-COMM-LENGTH)
  6108*    END-EXEC.
  6109     MOVE 'ELDATCV' TO DFHEIV1
  6110*    MOVE '."C                   ''   #00005439' TO DFHEIV0
  6111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6113     MOVE X'2020233030303035343339' TO DFHEIV0(25:11)
  6114     CALL 'kxdfhei1' USING DFHEIV0,
  6115           DFHEIV1,
  6116           DATE-CONVERSION-DATA,
  6117           DC-COMM-LENGTH,
  6118           DFHEIV99,
  6119           DFHEIV99,
  6120           DFHEIV99
  6121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6122
  6123
  6124 9700-EXIT.
  6125      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL151.cbl
  6126
  6127 9900-ERROR-FORMAT.
  6128
  6129
  6130* EXEC CICS LINK
  6131*        PROGRAM  ('EL001')
  6132*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  6133*        LENGTH   (EMI-COMM-LENGTH)
  6134*    END-EXEC.
  6135     MOVE 'EL001' TO DFHEIV1
  6136*    MOVE '."C                   ''   #00005450' TO DFHEIV0
  6137     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6139     MOVE X'2020233030303035343530' TO DFHEIV0(25:11)
  6140     CALL 'kxdfhei1' USING DFHEIV0,
  6141           DFHEIV1,
  6142           ERROR-MESSAGE-INTERFACE-BLOCK,
  6143           EMI-COMM-LENGTH,
  6144           DFHEIV99,
  6145           DFHEIV99,
  6146           DFHEIV99
  6147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6148
  6149
  6150     MOVE EMI-LINE1              TO  MERMSG1O.
  6151
  6152 9900-EXIT.
  6153      EXIT.
  6154
  6155 9965-NO-TRLR-ERROR.
  6156     MOVE ER-0270                TO  EMI-ERROR.
  6157     MOVE -1                     TO  MLINE1L.
  6158     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6159     GO TO 8200-SEND-DATAONLY.
  6160
  6161 9981-NOTOPEN-MSTR.
  6162     MOVE ER-0154                TO EMI-ERROR
  6163     MOVE -1                     TO  MLINE1L.
  6164     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6165     GO TO 8200-SEND-DATAONLY.
  6166
  6167 9982-NOTOPEN-TRLR.
  6168     MOVE ER-0172                TO EMI-ERROR
  6169     MOVE -1                     TO  MLINE1L.
  6170     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6171     GO TO 8200-SEND-DATAONLY.
  6172
  6173 9986-NOTOPEN-DLYACTV.
  6174     MOVE '2955'                 TO EMI-ERROR.
  6175     MOVE -1                     TO  MLINE1L.
  6176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6177     GO TO 8200-SEND-DATAONLY.
  6178
  6179 9995-SECURITY-VIOLATION.
  6180*                            COPY ELCSCTP.
  6181******************************************************************
  6182*                                                                *
  6183*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL151.cbl
  6184*                            VMOD=2.001                          *
  6185*                                                                *
  6186*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6187******************************************************************
  6188
  6189
  6190     MOVE EIBDATE          TO SM-JUL-DATE.
  6191     MOVE EIBTRMID         TO SM-TERMID.
  6192     MOVE THIS-PGM         TO SM-PGM.
  6193     MOVE EIBTIME          TO TIME-IN.
  6194     MOVE TIME-OUT         TO SM-TIME.
  6195     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6196
  6197
  6198* EXEC CICS LINK
  6199*         PROGRAM  ('EL003')
  6200*         COMMAREA (SECURITY-MESSAGE)
  6201*         LENGTH   (80)
  6202*    END-EXEC.
  6203     MOVE 'EL003' TO DFHEIV1
  6204     MOVE 80
  6205       TO DFHEIV11
  6206*    MOVE '."C                   ''   #00005503' TO DFHEIV0
  6207     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6209     MOVE X'2020233030303035353033' TO DFHEIV0(25:11)
  6210     CALL 'kxdfhei1' USING DFHEIV0,
  6211           DFHEIV1,
  6212           SECURITY-MESSAGE,
  6213           DFHEIV11,
  6214           DFHEIV99,
  6215           DFHEIV99,
  6216           DFHEIV99
  6217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6218
  6219
  6220******************************************************************
  6221
  6222
  6223 9995-EXIT.
  6224     EXIT.
  6225
  6226 9990-ABEND.
  6227     MOVE -1                      TO  MPFNUMBL.
  6228     MOVE DFHEIBLK                TO  EMI-LINE1.
  6229
  6230
  6231* EXEC CICS LINK
  6232*          PROGRAM  ('EL004')
  6233*          COMMAREA (EMI-LINE1)
  6234*          LENGTH   (72)
  6235*    END-EXEC.
  6236     MOVE 'EL004' TO DFHEIV1
  6237     MOVE 72
  6238       TO DFHEIV11
  6239*    MOVE '."C                   ''   #00005519' TO DFHEIV0
  6240     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL151.cbl
  6242     MOVE X'2020233030303035353139' TO DFHEIV0(25:11)
  6243     CALL 'kxdfhei1' USING DFHEIV0,
  6244           DFHEIV1,
  6245           EMI-LINE1,
  6246           DFHEIV11,
  6247           DFHEIV99,
  6248           DFHEIV99,
  6249           DFHEIV99
  6250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6251
  6252
  6253     MOVE EMI-LINE1               TO  MERMSG1O.
  6254     GO TO 8200-SEND-DATAONLY.
  6255
  6256
  6257 9999-DFHBACK SECTION.
  6258     MOVE '9%                    "   ' TO DFHEIV0
  6259     MOVE 'EL151' TO DFHEIV1
  6260     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6261     GOBACK.
  6262 9999-DFHEXIT.
  6263     IF DFHEIGDJ EQUAL 0001
  6264         NEXT SENTENCE
  6265     ELSE IF DFHEIGDJ EQUAL 2
  6266         GO TO 9990-ABEND,
  6267               9600-PGMID-ERROR
  6268         DEPENDING ON DFHEIGDI
  6269     ELSE IF DFHEIGDJ EQUAL 3
  6270         GO TO 2000-NOTE-NOT-FOUND
  6271         DEPENDING ON DFHEIGDI
  6272     ELSE IF DFHEIGDJ EQUAL 4
  6273         GO TO 9986-NOTOPEN-DLYACTV,
  6274               2350-EXIT
  6275         DEPENDING ON DFHEIGDI
  6276     ELSE IF DFHEIGDJ EQUAL 5
  6277         GO TO 3550-END,
  6278               3550-END
  6279         DEPENDING ON DFHEIGDI
  6280     ELSE IF DFHEIGDJ EQUAL 6
  6281         GO TO 6000-END-RESET,
  6282               6000-END-RESET
  6283         DEPENDING ON DFHEIGDI
  6284     ELSE IF DFHEIGDJ EQUAL 7
  6285         GO TO 6100-NOT-FOUND
  6286         DEPENDING ON DFHEIGDI
  6287     ELSE IF DFHEIGDJ EQUAL 8
  6288         GO TO 6200-EXIT
  6289         DEPENDING ON DFHEIGDI
  6290     ELSE IF DFHEIGDJ EQUAL 9
  6291         GO TO 7000-NOTFND,
  6292               9981-NOTOPEN-MSTR
  6293         DEPENDING ON DFHEIGDI
  6294     ELSE IF DFHEIGDJ EQUAL 10
  6295         GO TO 7010-EXIT
  6296         DEPENDING ON DFHEIGDI
  6297     ELSE IF DFHEIGDJ EQUAL 11
  6298         GO TO 7110-DUPREC
  6299         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL151.cbl
  6300     ELSE IF DFHEIGDJ EQUAL 12
  6301         GO TO 9965-NO-TRLR-ERROR,
  6302               9982-NOTOPEN-TRLR
  6303         DEPENDING ON DFHEIGDI
  6304     ELSE IF DFHEIGDJ EQUAL 13
  6305         GO TO 8300-SEND-TEXT
  6306         DEPENDING ON DFHEIGDI.
  6307     MOVE '9%                    "   ' TO DFHEIV0
  6308     MOVE 'EL151' TO DFHEIV1
  6309     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6310     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5328     Code:       13270
