* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
   165* 012220  CR2018092700002  TANA  ADD NEW ERROR MSGS
   166* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM ERROR MSG.
   167*-----------------------------------------------------------------
   168
   169 01  WORK-AREAS.
   170
   171*****************************************************************
   172*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   173*****************************************************************
   174
   175     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   176     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   177     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   178     12  WS-NAME-EDIT-WORK-AREA.
   179         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   180         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   181             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   5
* EL050.cbl
   182         16  WS-WORK-NAME.
   183             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   184             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   185             20  FILLER           PIC X(10)     VALUE SPACES.
   186         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   187             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   188
   189*****************************************************************
   190*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   191*****************************************************************
   192
   193     12  WS-ERRESC-KEY.
   194         16 WS-ERRESC-SEARCH-KEY.
   195             20  WS-ERRESC-COMPANY-CD PIC  X.
   196             20  WS-ERRESC-CARRIER    PIC  X.
   197             20  WS-ERRESC-GROUP      PIC X(6).
   198             20  WS-ERRESC-STATE      PIC XX.
   199             20  WS-ERRESC-ACCOUNT    PIC X(10).
   200         16 WS-ERRESC-RESIDUAL-KEY.
   201             20  WS-ERRESC-AGENT      PIC X(10).
   202             20  WS-ERRESC-RES-STATE  PIC XX.
   203             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   204*                                          YYYYMMDD
   205     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   206     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   207
   208*RESIDENT STATE TAX MASTER(ERRESS)
   209*
   210     12  WS-ERRESS-KEY.
   211         16  WS-ERRESS-COMPANY-CD      PIC  X.
   212         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   213         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   214         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   215*                                          YYYYMMDD
   216
   217     12  WS-CONTRACT-DATE              PIC 9(8).
   218*                                          YYYYMMDD
   219     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   220     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   221         16 WS-YEAR-YY                 PIC   9999.
   222         16 FILLER                     PIC 9(4).
   223*                                          YYYYMMDD
   224     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   225     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   226     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   227     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   228
   229     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   230         88  DPRB-1ST-TIME                      VALUE ' '.
   231
   232*****************************************************************
   233*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   234*****************************************************************
   235
   236     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   237     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   238     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   239     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   6
* EL050.cbl
   240     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   241     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   242     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   243     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   244     12  ws-st-agent-sig-edit    pic x          value spaces.
   245     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   246     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   249         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   250         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   251     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   252         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   253         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   254     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   255
   256     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   257     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   258
   259     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   260     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   273     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   274     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   288     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   289     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   290     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   291     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   292     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   293     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   294     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   295     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   296     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   297     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   7
* EL050.cbl
   298     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   304     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   305     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   306     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   307     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   308     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   309     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   310     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   311     12  WS-2671-SW               PIC X         VALUE SPACE.
   312     12  WS-2672-SW               PIC X         VALUE SPACE.
   313     12  ws-9813-sw               pic x         value spaces.
   314     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   315         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   316     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   317         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   318     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   319
   320     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   321         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   322         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   323         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   324         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   325
   326     12  WS-CREDIT-EDIT-CONTROLS.
   327         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   328         16  WS-MIN-AGE           PIC 99                VALUE  0.
   329         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   330         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   331         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   332         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   333
   334     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   335     12  WS-AGE-FIELDS.
   336         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   337         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   338         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   339         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   340
   341     12  WS-SAVE-ALLOWABLE-BENEFIT.
   342         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   343         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   344         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   345         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   346         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   347         16  FILLER                      PIC XX.
   348
   349     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   350     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   351     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   352     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   353     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   354     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   355     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   8
* EL050.cbl
   356     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   357     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   358     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   359
   360     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   361     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   362     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   363     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   364     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   365     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   366     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   367     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   368         88  WS-REDUCING              VALUE 'R'.
   369         88  WS-LEVEL                 VALUE 'L' 'P'.
   370     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   371
   372     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   373     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   374     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   375     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   376     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   377     12  ws-ah-max-bens           pic 99        value zeros.
   378     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   379     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   380     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   381     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   382
   383     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   384     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   385     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   386     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   387     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   388     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   389     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   390     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   391     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   392     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   393     12  WS-ACCT-SIG-SW.
   394         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   395         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   396     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   397     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   398     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   399     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   401     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   402     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   403     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   404     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   405     12  WS-INITIALS.
   406         16  WS-INIT-1            PIC X         VALUE SPACES.
   407         16  WS-INIT-2            PIC X         VALUE SPACES.
   408
   409     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   410     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   411     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   412     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   413     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page   9
* EL050.cbl
   414*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   415     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   416     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   419     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   420     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   421     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   422     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   423     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   424     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   425     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   426     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   427     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   428     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   429     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   431     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   435     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   436     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   437******** FLA
   438     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   439     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   440     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   441     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   442     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   443********
   444     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   445     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   446     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   447     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   448     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   449     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   450     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   451     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   452     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   453     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   454
   455     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   456         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   457                                         '0' THRU '9'.
   458
   459     12  NUMBER-OF-MONTHS.
   460         16  SK-MO OCCURS 12 TIMES PIC X.
   461
   462     12  WS-WORK-DATE.
   463         16  WS-YEAR            PIC 99    VALUE 00.
   464         16  WS-MONTH           PIC 99    VALUE 00.
   465         16  WS-DAY             PIC 99    VALUE 00.
   466
   467     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   468     12  WS-WORK-CRIT-DEV       REDEFINES
   469         WS-WORK-LF-CRIT-PER    PIC X(03).
   470
   471     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  10
* EL050.cbl
   472     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   473
   474     12  WS-WORK-DATE-FROM.
   475         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   476         16  FILLER             PIC X  VALUE SPACE.
   477         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   478         16  FILLER             PIC X         VALUE SPACE.
   479         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   480
   481     12  WS-WORK-DATE-THRU.
   482         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   483         16  FILLER             PIC X         VALUE SPACE.
   484         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   485         16  FILLER             PIC X         VALUE SPACE.
   486         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   487
   488     12  WS-LF-INPUT-CD.
   489         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   490         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   491
   492     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   493     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   494         16  WS-AH-INPUT-CD-1   PIC X.
   495         16  WS-AH-INPUT-CD-2-3 PIC XX.
   496
   497     12  WS-SWITCHES.
   498         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   499         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   500             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   501         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   502             88  BANK-ACCT-FOUND          VALUE 'Y'.
   503         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   504             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   505         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   506             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   507         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   508             88  COMP-MASTER-FOUND        VALUE 'Y'.
   509         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   510             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   511         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   512             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   513         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   514             88  STAT-MASTER-FOUND        VALUE 'Y'.
   515         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   516             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   517         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   518             88  ELCRTT-FOUND             VALUE 'Y'.
   519         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   520             88  ELCRTT-UPDATE            VALUE 'Y'.
   521         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   522             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   523         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   524             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   525         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   526             88  FORM-MASTER-FOUND        VALUE 'Y'.
   527         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   528             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   529         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  11
* EL050.cbl
   530             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   531         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   532             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   533         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   534             88  NO-BENEFIT-FOUND         VALUE 'N'.
   535         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   536             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   537         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   538             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   539         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   540             88  AH-BENEFIT-FOUND         VALUE ' '.
   541             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   542         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   543             88  LF-BENEFIT-FOUND         VALUE ' '.
   544             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   545         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   546             88  NO-STATE-RECORD          VALUE '1'.
   547         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   548             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   549         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   550             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   551         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   552             88  CERT-WAS-FOUND           VALUE ' '.
   553             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   554         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   555             88  BROWSE-STARTED           VALUE 'Y'.
   556         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   557             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   558         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   559             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   560         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   561             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   562         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   563             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   564         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   565             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   566         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   567             88  APP-CERT-USED            VALUE 'Y' 'A'.
   568         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   569             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   570             88  FIRST-TIME-THROUGH       VALUE '1'.
   571             88  CTBL-NOT-FOUND           VALUE '2'.
   572
   573         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   574             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   575
   576         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   577             88  DLO-ERROR-FOUND          VALUE 'Y'.
   578
   579********FLA
   580     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   581     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   582********
   583     12  RC-SW-1                  PIC X           VALUE '0'.
   584     12  RC-SW-2                  PIC X           VALUE '0'.
   585     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   586     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   587     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  12
* EL050.cbl
   588     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   592     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   593     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   594     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   595     12  LIT-SPACES               PIC X           VALUE SPACES.
   596     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   597     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   598     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   599     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   600     12  erpndm-unlock-sw         pic x           value spaces.
   601         88  need-to-unlock-erpndm  value 'Y'.
   602     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   603     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   604     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   605         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   606         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   607     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   608         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   609
   610 01  WS-EXTRA-PERIODS-BY-STATE.
   611     12  WS-INT-PERIODS          PIC 9.
   612     12  WS-EXTRA-PMTS           PIC 9.
   613 01  ws-net-only-state           pic x value 'N'.
   614 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   615     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   616     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   617 01  WS-CRI-SSN-WORK-AREA.
   618     05  WS-CRI-SOC-SEC-NO.
   619         10  WS-SS-REPT-CD       PIC X(5).
   620         10  WS-SS-LAST-NAME     PIC X(5).
   621         10  WS-SS-INITIAL       PIC X.
   622
   623     05  WS-CRI-REPORT-CODE.
   624         10  FILLER              PIC X(5).
   625         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   626
   627     05  WS-CRI-LAST-NAME.
   628         10  WS-CRI-NAME-MOVE    PIC X(5).
   629         10  FILLER              PIC X(10).
   630
   631 01  ws-state-commission-caps.
   632     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   633     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   634     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   635     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   636     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   637     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   638     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   639     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   640     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   641     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   642     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   643     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   644     05  ws-st-cap-limit-to      pic x.
   645     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  13
* EL050.cbl
   646     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   647     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   648     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   649     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   650     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   651     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   652     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   653     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   654     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   655     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   656     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   657 01  WS-NUM-TABLE                PIC X(26)  VALUE
   658     '12345678012345070923456789'.
   659 01  FILLER REDEFINES WS-NUM-TABLE.
   660     05  WS-NUM OCCURS 26        PIC 9.
   661 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   662 01  V1                          PIC S999 COMP-3.
   663 01  V2                          PIC S999 COMP-3.
   664 01  V3                          PIC S999 COMP-3.
   665 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   666 01  FILLER REDEFINES WS-WORK-VIN.
   667     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   668 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   669 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   670 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   671 01  WS-HEX-WORK.
   672     05  FILLER                  PIC X  VALUE LOW-VALUES.
   673     05  WS-HEX-BYTE             PIC X.
   674 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   675 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   676 01  WS-WORK-HIN-ROW-B.
   677     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   678
   679 01  ws-benefit-cd-chg-sw      pic x value spaces.
   680     88  benefit-code-chg           value 'Y'.
   681 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   682 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   683     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   684 01  WS-ROW-D-TABLE.
   685     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   686
   687 01  WS-HIN-TABLE-B.
   688     05  F                       PIC XX VALUE 'A2'.
   689     05  F                       PIC XX VALUE 'B3'.
   690     05  F                       PIC XX VALUE 'C4'.
   691     05  F                       PIC XX VALUE 'D5'.
   692     05  F                       PIC XX VALUE 'E6'.
   693     05  F                       PIC XX VALUE 'F7'.
   694     05  F                       PIC XX VALUE 'G8'.
   695     05  F                       PIC XX VALUE 'H9'.
   696     05  F                       PIC XX VALUE 'I1'.
   697     05  F                       PIC XX VALUE 'J2'.
   698     05  F                       PIC XX VALUE 'K3'.
   699     05  F                       PIC XX VALUE 'L4'.
   700     05  F                       PIC XX VALUE 'M5'.
   701     05  F                       PIC XX VALUE 'N6'.
   702     05  F                       PIC XX VALUE 'O0'.
   703     05  F                       PIC XX VALUE 'P7'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'Q0'.
   705     05  F                       PIC XX VALUE 'R8'.
   706     05  F                       PIC XX VALUE 'S9'.
   707     05  F                       PIC XX VALUE 'T2'.
   708     05  F                       PIC XX VALUE 'U3'.
   709     05  F                       PIC XX VALUE 'V4'.
   710     05  F                       PIC XX VALUE 'W5'.
   711     05  F                       PIC XX VALUE 'X6'.
   712     05  F                       PIC XX VALUE 'Y7'.
   713     05  F                       PIC XX VALUE 'Z8'.
   714 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   715     05  WS-VAL-IN               PIC X.
   716     05  WS-VAL-OUT              PIC 9.
   717 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   718 01  ws-greg-eff-date            pic x(10) value ' '.
   719 01  WS-COMPARE-BINARY-DATES.
   720     05  WS-971231                PIC XX VALUE X'92FF'.
   721     05  WS-931231                PIC XX VALUE X'8CFF'.
   722     05  WS-791231                PIC XX VALUE X'77FF'.
   723     05  WS-771001                PIC XX VALUE X'74A1'.
   724     05  WS-820301                PIC XX VALUE X'7B41'.
   725     05  WS-831031                PIC XX VALUE X'7DBF'.
   726     05  WS-831231                PIC XX VALUE X'7DFF'.
   727     05  WS-810831                PIC XX VALUE X'7A7F'.
   728     05  WS-830901                PIC XX VALUE X'7D81'.
   729
   730 01  FILE-ACCESS-IDS.
   731     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   732     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   733     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   734     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   735     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   736     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   737     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   738     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   739     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   740     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   741     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   742     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   743     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   744     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   745     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   746     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   747     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   748 01  DD-IU-SW                    PIC X   VALUE ' '.
   749     88  DD-IU-PRESENT                 VALUE 'Y'.
   750
   751 01  ACCESS-KEYS.
   752     12  ELMSTR-KEY.
   753         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   754         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   755     12  W-CLAIM-KEY.
   756         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   757         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   758
   759     12  ELCNTL-KEY.
   760         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   761         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  15
* EL050.cbl
   762         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   763         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   764
   765     12  ELCERT-KEY.
   766         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   767         16  CERT-CARRIER         PIC X       VALUE SPACE.
   768         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   769         16  CERT-STATE           PIC XX      VALUE SPACES.
   770         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   771         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   772         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   773
   774     12  ELCERT2-KEY.
   775         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   776         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   777
   778     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   779
   780     12  ELCERT-SAVE.
   781         16  FILLER                      PIC XX    VALUE SPACES.
   782
   783         16  WCS-CONTROL-PRIMARY.
   784             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   785             20  WCS-CARRIER             PIC X     VALUE SPACE.
   786             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   787             20  WCS-STATE               PIC XX    VALUE SPACES.
   788             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   789             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   790             20  WCS-CERT-NO.
   791                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   792                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   793
   794         16  CS-CONTROL-BY-NAME.
   795             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   796             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   797             20  CS-INSURED-INITIALS.
   798                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   799                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   800
   801         16  CS-CONTROL-BY-SSN.
   802             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   803             20  CS-SOC-SEC-NO.
   804                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   805                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   806                 24  CS-SSN-LN3.
   807                     28 CS-INSURED-INITIALS-A2   PIC XX
   808                                     VALUE SPACES.
   809                     28 CS-PART-LAST-NAME-A2     PIC X
   810                                     VALUE SPACE.
   811
   812         16  CS-CONTROL-BY-CERT-NO.
   813             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   814             20  CS-CERT-NO-A4           PIC X(11)
   815                                     VALUE SPACES.
   816
   817         16  CS-CONTROL-BY-MEMB.
   818             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   819             20  CS-MEMBER-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  16
* EL050.cbl
   820                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   821                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   822                 24  CS-MEMB-LN4.
   823                     28 CS-INSURED-INITIALS-A5   PIC XX
   824                                      VALUE SPACES.
   825                     28 CS-PART-LAST-NAME-A5     PIC XX
   826                                      VALUE SPACES.
   827
   828         16  FILLER              PIC X(360) VALUE SPACES.
   829
   830     12  ERACCT-KEY.
   831         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   832         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   833         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   834         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   835         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   836         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   837
   838     12  ERCOMP-KEY.
   839         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   840         16  COMP-CARRIER         PIC X     VALUE SPACES.
   841         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   842         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   843         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   844         16  COMP-TYPE            PIC X     VALUE SPACES.
   845
   846     12  ERLOFC-KEY.
   847         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   848         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   849         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   850         16  LOFC-STATE           PIC XX    VALUE SPACES.
   851         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   852         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   853
   854     12  WS-ELCRTT-KEY.
   855         16  WS-ELCRTT-PRIMARY       PIC X(33).
   856         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   857
   858     12  ERBXRF-KEY.
   859         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   860         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   861         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   862         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   863
   864     12  ERAGTC-KEY.
   865         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   866         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   867         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   868         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   869         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   870         16  AGTC-TYPE            PIC X     VALUE SPACES.
   871
   872     12  ERPLAN-KEY.
   873         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   874         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   875         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   876         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   877         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  17
* EL050.cbl
   878         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   879         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   880         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   881
   882     12  ERFORM-KEY.
   883         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   884         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   885         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   886         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   887
   888     12  ERREIN-KEY.
   889         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   890         16  REIN-TYPE            PIC X     VALUE SPACES.
   891         16  REIN-TABLE-CO.
   892             20  REIN-CODE-1      PIC X     VALUE SPACE.
   893             20  REIN-CODE-2      PIC X     VALUE SPACE.
   894             20  REIN-CODE-3      PIC X     VALUE SPACE.
   895         16  FILLER               PIC X(3)  VALUE SPACES.
   896
   897     12  ERCTBL-KEY.
   898         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   899         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   900         16  CTBL-CNTRL-2.
   901             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   902             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   903
   904     12  ELCRTO-KEY.
   905         16  ELCRTO-COMPANY-CD       PIC X.
   906         16  ELCRTO-CARRIER          PIC X.
   907         16  ELCRTO-GROUPING         PIC X(6).
   908         16  ELCRTO-STATE            PIC XX.
   909         16  ELCRTO-ACCOUNT          PIC X(10).
   910         16  ELCRTO-CERT-EFF-DT      PIC XX.
   911         16  ELCRTO-CERT-NO.
   912             20  ELCRTO-CERT-PRIME   PIC X(10).
   913             20  ELCRTO-CERT-SFX     PIC X.
   914         16  ELCRTO-RECORD-TYPE      PIC X.
   915         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   916
   917
   918     12  WS-ACCESS.
   919         16  FILLER               PIC XX    VALUE SPACES.
   920         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   921
   922     12  WS-CARR-ACCESS.
   923         16  FILLER               PIC X(3)  VALUE SPACES.
   924         16  WS-CARR              PIC X     VALUE SPACE.
   925*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   926*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   927     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   928         88  WS-DMD-LF-RATING   VALUE 'Y'.
   929         88  WS-DMD-AH-RATING   VALUE 'Y'.
   930         88  WS-DMD-NO-RATING   VALUE 'N'.
   931
   932     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   933         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   934                                         'NJ' 'NL'
   935                                         'PJ' 'PL'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  18
* EL050.cbl
   936                                         'SJ' 'SL'.
   937     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   938         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   939                                         'NI' 'NJ' 'NL' 'NU'
   940                                         'PJ' 'PL' 'PI' 'PU'
   941                                         'SI' 'SJ' 'SL' 'SU'
   942                                         'MX' 'MY' 'MZ'.
   943 01  ERPDEF-KEY-SAVE             PIC X(18).
   944 01  ERPDEF-KEY.
   945     12  ERPDEF-COMPANY-CD       PIC X.
   946     12  ERPDEF-STATE            PIC XX.
   947     12  ERPDEF-PROD-CD          PIC XXX.
   948     12  F                       PIC X(7).
   949     12  ERPDEF-BEN-TYPE         PIC X.
   950     12  ERPDEF-BEN-CODE         PIC XX.
   951     12  ERPDEF-EXP-DT           PIC XX.
   952
   953 01  ELSTAT-KEY-SAVE             PIC X(20).
   954 01  ELSTAT-KEY.
   955     12  ELSTAT-COMPANY-ID       PIC XXX.
   956     12  ELSTAT-CARRIER          PIC X.
   957     12  ELSTAT-GROUP            PIC X(6).
   958     12  ELSTAT-STATE            PIC XX.
   959     12  ELSTAT-EXP-DT           PIC 9(8).
   960 01  WS-ERROR-VALUES.
   961     12  ER-1570                     PIC S9(4)   VALUE +1570.
   962     12  ER-1571                     PIC S9(4)   VALUE +1571.
   963     12  er-1572                     pic s9(4)   value +1572.
   964     12  er-1573                     pic s9(4)   value +1573.
   965     12  er-1574                     pic s9(4)   value +1574.
   966     12  ER-1575                     PIC S9(4)   VALUE +1575.
   967     12  er-1576                     pic s9(4)   value +1576.
   968     12  er-1577                     pic s9(4)   value +1577.
   969     12  er-1583                     pic s9(4)   value +1583.
   970     12  er-1584                     pic s9(4)   value +1584.
   971     12  er-1743                     pic s9(4)   value +1743.
   972     12  er-1744                     pic s9(4)   value +1744.
   973     12  er-1745                     pic s9(4)   value +1745.
   974     12  er-1746                     pic s9(4)   value +1746.
   975     12  er-1747                     pic s9(4)   value +1747.
   976     12  er-1748                     pic s9(4)   value +1748.
   977     12  er-1749                     pic s9(4)   value +1749.
   978     12  er-1750                     pic s9(4)   value +1750.
   979     12  er-1751                     pic s9(4)   value +1751.
   980     12  er-1752                     pic s9(4)   value +1752.
   981     12  er-1753                     pic s9(4)   value +1753.
   982     12  er-1754                     pic s9(4)   value +1754.
   983     12  er-1755                     pic s9(4)   value +1755.
   984     12  er-1756                     pic s9(4)   value +1756.
   985     12  er-1757                     pic s9(4)   value +1757.
   986     12  er-1758                     pic s9(4)   value +1758.
   987     12  er-1759                     pic s9(4)   value +1759.
   988     12  er-1760                     pic s9(4)   value +1760.
   989     12  er-1761                     pic s9(4)   value +1761.
   990     12  ER-1891                     PIC S9(4)   VALUE +1891.
   991     12  ER-1892                     PIC S9(4)   VALUE +1892.
   992     12  ER-1893                     PIC S9(4)   VALUE +1893.
   993     12  ER-1894                     PIC S9(4)   VALUE +1894.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  19
* EL050.cbl
   994     12  ER-1895                     PIC S9(4)   VALUE +1895.
   995     12  ER-1896                     PIC S9(4)   VALUE +1896.
   996     12  ER-1897                     PIC S9(4)   VALUE +1897.
   997     12  ER-1898                     PIC S9(4)   VALUE +1898.
   998     12  ER-1899                     PIC S9(4)   VALUE +1899.
   999     12  ER-1900                     PIC S9(4)   VALUE +1900.
  1000     12  ER-1901                     PIC S9(4)   VALUE +1901.
  1001     12  ER-1902                     PIC S9(4)   VALUE +1902.
  1002     12  ER-1903                     PIC S9(4)   VALUE +1903.
  1003     12  ER-1904                     PIC S9(4)   VALUE +1904.
  1004     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1005     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1006     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1007     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1008     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1009     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1010     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1011     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1012     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1013     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1014     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1015     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1016     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1017     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1018     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1019     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1020     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1021     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1022     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1023     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1024     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1025     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1026     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1027     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1028     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1029     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1030     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1031     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1032     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1033     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1034     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1035     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1036     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1037     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1038     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1039     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1040     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1041     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1042     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1043     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1044     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1045     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1046     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1047     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1048     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1049     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1050     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1051     12  ER-2615                     PIC S9(4)   VALUE +2615.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  20
* EL050.cbl
  1052     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1053     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1054     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1055     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1056     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1057     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1058     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1059     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1060     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1061     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1062     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1063     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1064     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1065     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1066     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1067     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1068     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1069     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1070     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1071     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1072     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1073     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1074     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1075     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1076     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1077     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1078     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1079     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1080     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1081     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1082     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1083     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1084     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1085     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1086     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1087     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1088     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1089     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1090     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1091     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1092     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1093     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1094     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1095     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1096     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1097     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1098     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1099     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1100     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1101     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1102     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1103     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1104     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1105     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1106     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1107     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1108     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1109     12  ER-2673                     PIC S9(4)   VALUE +2673.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  21
* EL050.cbl
  1110     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1111     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1112     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1113     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1114     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1115     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1116     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1117     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1118     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1119     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1120     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1121     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1122     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1123     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1124     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1125     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1126     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1127     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1128     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1129     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1130     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1131     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1132     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1133     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1134     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1135     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1136     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1137     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1138     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1139     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1140     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1141     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1142     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1143     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1144     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1145     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1146     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1147     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1148     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1149     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1150     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1151     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1152     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1153     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1154     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1155     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1156     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1157     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1158     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1159     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1160     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1161     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1162     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1163     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1164     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1165     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1166     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1167     12  ER-2741                     PIC S9(4)   VALUE +2741.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  22
* EL050.cbl
  1168     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1169     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1170     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1171     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1172     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1173     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1174     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1175     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1176     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1177     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1178     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1179     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1180     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1181     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1182     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1183     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1184     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1185     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1186     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1187     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1188     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1189     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1190     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1191     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1192     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1193     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1194     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1195     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1196     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1197     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1198     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1199     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1200     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1201     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1202     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1203     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1204     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1205     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1206     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1207     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1208     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1209     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1210     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1211     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1212     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1213     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1214     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1215     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1216     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1217     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1218     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1219     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1220     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1221     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1222     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1223     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1224     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1225     12  ER-2882                     PIC S9(4)   VALUE +2882.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  23
* EL050.cbl
  1226     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1227     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1228     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1229     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1230     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1231     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1232     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1233     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1234     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1235     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1236     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1237     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1238     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1239     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1240     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1241     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1242     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1243     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1244     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1245     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1246     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1247     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1248     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1249     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1250     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1251     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1252     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1253     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1254     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1255     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1256     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1257     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1258     12  ER-3069                     PIC S9(4)   VALUE +3069.
  1259     12  er-3070                     pic s9(4)   value +3070.
  1260     12  er-3270                     pic s9(4)   value +3270.
  1261     12  er-3273                     pic s9(4)   value +3273.
  1262     12  er-3281                     pic s9(4)   value +3281.
  1263     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1264     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1265     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1266     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1267     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1268     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1269     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1270     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1271     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1272     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1273     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1274     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1275     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1276     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1277     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1278     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1279     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1280     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1281     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1282     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1283     12  ER-8002                     PIC S9(4)   VALUE +8002.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  24
* EL050.cbl
  1284     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1285     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1286     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1287     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1288     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1289     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1290     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1291     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1292     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1293     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1294     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1295     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1296     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1297     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1298     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1299     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1300     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1301     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1302     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1303     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1304     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1305     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1306     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1307     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1308     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1309     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1310     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1311     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1312     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1313     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1314     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1315     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1316     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1317     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1318     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1319     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1320     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1321     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1322     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1323     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1324     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1325     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1326     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1327     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1328     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1329     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1330     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1331     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1332     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1333     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1334     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1335     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1336     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1337     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1338     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1339     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1340     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1341     12  ER-8303                     PIC S9(4)   VALUE +8303.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  25
* EL050.cbl
  1342     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1343     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1344     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1345     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1346     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1347     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1348     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1349     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1350     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1351     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1352     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1353     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1354     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1355     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1356     12  er-9823                     pic s9(4)   value +9823.
  1357     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1358******************************************************************
  1359***************   END OF ELC50WS     ****************************
  1360******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  26
* EL050.cbl
  1363 01  WORKING-STORAGE-WORK-AREAS.
  1364     12  WS-RESPONSE             PIC S9(8)  COMP.
  1365         88  WS-RESP-NORMAL           VALUE +00.
  1366         88  WS-RESP-ERROR            VALUE +01.
  1367         88  WS-RESP-NOTFND           VALUE +13.
  1368         88  WS-RESP-DUPREC           VALUE +14.
  1369         88  WS-RESP-ENDFILE          VALUE +20.
  1370     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1371     12  WORK-AREAS.
  1372         16  WK-CONV-GREG.
  1373             24  WCG-CENT             PIC XX.
  1374             24  WCG-REST             PIC X(4).
  1375         16  WORK-GREGORIAN-DATE.
  1376             24  WK-GREG-CENT         PIC XX.
  1377             24  WK-GREG-DATE-YYMMDD.
  1378                 28  WK-GREG-YYMM     PIC X(4).
  1379                 28  WK-GREG-DD       PIC XX.
  1380
  1381         16  WORK-SELECT-DATE.
  1382             24  WK-SELECT-CENT            PIC XX.
  1383             24  WK-SELECT-DATE-YYMMDD.
  1384                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1385                 28  FILLER                PIC XX.
  1386
  1387         16  WK-FORM-NO.
  1388             24  WK-FORM-BANK-ID       PIC X(5).
  1389             24  WK-FORM-UNDRWRTR      PIC X(1).
  1390             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1391
  1392         16  WK-MEMBER-NO.
  1393             24  WK-MEMBER-1-6        PIC X(6).
  1394             24  WK-MEMBER-7-12       PIC X(6).
  1395
  1396         16  WK-FULL-CERT-NO.
  1397             24  WK-CERT-POS-1-2      PIC X(2).
  1398             24  WK-CERT-POS-3        PIC X(1).
  1399             24  WK-CERT-POS-4        PIC X(1).
  1400             24  WK-CERT-POS-5-6      PIC X(2).
  1401             24  WK-CERT-POS-7        PIC X(1).
  1402             24  WK-CERT-POS-8-11     PIC X(4).
  1403
  1404         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1405             88  VALID-RATE-CODE        VALUE 'Y'.
  1406             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1407
  1408         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1409         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1410         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1411         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1412         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1413         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1414         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1415         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1416         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1417         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1418
  1419* DLO001
  1420 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  27
* EL050.cbl
  1421     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1422     12  DMPF-RETURN-CODE          PIC XX.
  1423         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1424         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1425         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1426         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1427         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1428         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1429
  1430* DLO002
  1431 01  WS-DLO-INTERNAL-POLICY-FORM.
  1432     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1433     12  DIPF-RETURN-CODE          PIC XX.
  1434         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1435         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1436         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1437         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1438         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1439         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1440
  1441* DLO003
  1442 01  WS-DLO-VALID-BANK-ID.
  1443     12  DVBI-BANK-ID              PIC X(5).
  1444     12  DVBI-BANK-ID-TYPE         PIC X.
  1445         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1446         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1447         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1448         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1449         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1450     12  DVBI-RETURN-CODE          PIC XX.
  1451         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1452         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1453         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1454         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1455         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1456         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1457         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1458         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1459         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1460
  1461* DLO007
  1462 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1463     12  DCUA-RES-STATE            PIC XX.
  1464     12  DCUA-BEN-TYPE             PIC XX.
  1465     12  DCUA-SYS-IDENT            PIC X.
  1466         88  DCUA-CLAIM                        VALUE 'C'.
  1467         88  DCUA-PREMIUM                      VALUE 'P'.
  1468     12  DCUA-COVERAGE-RULE        PIC X.
  1469     12  DCUA-CLIENT-ID            PIC X(10).
  1470     12  DCUA-EFF-DATE             PIC X(8).
  1471     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1472     12  DCUA-RETURN-CODE          PIC XX.
  1473         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1474     12  DCUA-CERT-NUMBER          PIC X(11).
  1475     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1476     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1477
  1478* DLO011
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  28
* EL050.cbl
  1479 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1480     12  DPRB-RATE-CODE            PIC X(4).
  1481     12  DPRB-COVERAGE-CATEG       PIC X.
  1482     12  DPRB-RETURN-CODE          PIC XX.
  1483         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1484         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1485         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1486         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1487         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1488         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1489         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1490         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1491         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1492     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1493     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1494     12  DPRB-BEN-TYPE             PIC XX.
  1495
  1496* DLO017
  1497 01  WS-DLO-VALID-RATE-CODE.
  1498     12  DVRC-RATE-CODE            PIC X(4).
  1499     12  DVRC-RETURN-CODE          PIC XX.
  1500         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1501         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1502         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1503         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1504         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1505         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1506
  1507* DLO019
  1508 01  WS-DLO-ORIG-COV-CAT.
  1509     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1510     12  DOCC-RETURN-CODE          PIC XX.
  1511     12  DOCC-ORIG-COV-CAT         PIC X.
  1512     12  DOCC-UNDERWITER           PIC XX.
  1513     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1514     12  DOCC-FILLER               PIC X(6).
  1515
  1516* DLO021
  1517 01  WS-DLO-VALID-LOAN-OFFICER.
  1518     12  DVLO-LOAN-OFFICER.
  1519         16  DVLO-BILL-TYPE        PIC X.
  1520         16  DVLO-BILL-SOURCE      PIC X.
  1521         16  DVLO-BATCH-TYPE       PIC X.
  1522     12  DVLO-RETURN-CODE          PIC XX.
  1523         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1524         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1525         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1526         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1527         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1528         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1529
  1530* DLO022
  1531 01  WS-DLO-VALID-STATE-CODE.
  1532     12  DVSC-STATE-CODE           PIC XX.
  1533     12  DVSC-RETURN-CODE          PIC XX.
  1534         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1535
  1536* DLO023
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  29
* EL050.cbl
  1537 01  WS-DLO-VALID-CODE-VALUES.
  1538     12  DVCV-SYSTEM-ID            PIC XX.
  1539         88  DVCV-CLAIMS                       VALUE 'CL'.
  1540         88  DVCV-CREDIT                       VALUE 'CR'.
  1541     12  DVCV-RECORD-TYPE          PIC XX.
  1542         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1543         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1544         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1545         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1546         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1547         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1548         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1549         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1550     12  DVCV-RECORD-KEY           PIC X(6).
  1551     12  DVCV-RETURN-CODE          PIC XX.
  1552         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1553         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1554         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1555         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1556         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1557         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1558         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1559     12  DVCV-CODE-DESC            PIC X(60).
  1560     12  DVCV-GEN-DESC-1           PIC X(20).
  1561     12  DVCV-GEN-DESC-2           PIC X(20).
  1562     12  DVCV-GEN-DESC-3           PIC X(20).
  1563
  1564 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1565 01  hldi-pass-area.
  1566     03  PA-VIN                  PIC X(17).
  1567     03  PA-ErrorCode            PIC X(10).
  1568     03  PA-ErrorDesc            PIC X(30).
  1569     03  PA-ModelYear            PIC 9(7).
  1570     03  PA-MakeName             PIC X(50).
  1571     03  PA-ModelName            PIC X(50).
  1572     03  PA-SeriesName           PIC X(50).
  1573 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1574 01  zipcd-pass-area.
  1575     03  PA-zip                  PIC X(5).
  1576     03  PA-ErrorCode-zip        PIC X(10).
  1577     03  PA-city                 PIC x(50).
  1578     03  PA-state                PIC Xx.
  1579 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1580 01  clmhs-pass-area.
  1581     03  pa-clmhs-state          pic xx.
  1582     03  pa-account              pic x(10).
  1583     03  pa-eff-dt               pic x(10).
  1584     03  pa-cert-no              pic x(11).
  1585     03  pa-clm-count            pic 9(5).
  1586****  this is for aggregate report.
  1587****  Length is erpndb + 100 of passed-key-area
  1588 01  ws-passed-key-length        pic s9(4) comp value +587.
  1589 01  ws-pass-to-pemaggo.
  1590     05  ws-passed-erpndb        pic x(585).
  1591     05  ws-exceed-limit-yn      pic x.
  1592     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  30
* EL050.cbl
  1594*    COPY ERCBXRF.
  1595******************************************************************
  1596*                                                                *
  1597*                                                                *
  1598*                            ERCBXRF                             *
  1599*                                                                *
  1600*   ONLINE CREDIT SYSTEM                                         *
  1601*                                                                *
  1602*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1603*                                                                *
  1604*   FILE TYPE = VSAM,KSDS                                        *
  1605*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1606*                                                                *
  1607*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1608*       ALTERNATE PATH = NONE                                    *
  1609*                                                                *
  1610*   LOG = NO                                                     *
  1611*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1612*                                                                *
  1613******************************************************************
  1614
  1615 01  BANK-CROSS-REFERENCE.
  1616     12  BK-RECORD-ID                PIC XX.
  1617         88  VALID-BK-ID             VALUE 'BK'.
  1618
  1619     12  BK-CONTROL-PRIMARY.
  1620         16  BK-COMPANY-CD           PIC X.
  1621         16  BK-CARRIER              PIC X.
  1622         16  BK-GROUPING             PIC X(6).
  1623         16  BK-BANK-NO              PIC X(10).
  1624
  1625     12  BK-MAINT-INFORMATION.
  1626         16  BK-LAST-MAINT-DT        PIC XX.
  1627         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1628         16  BK-LAST-MAINT-USER      PIC X(4).
  1629         16  FILLER                  PIC X(9).
  1630
  1631     12  FILLER                      PIC X(37).
  1632
  1633     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1634
  1635     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1636                            DEPENDING ON BK-BANK-POINTER-CNT.
  1637         16  BK-AM-ACCOUNT           PIC X(10).
  1638         16  BK-AM-EXP-DT            PIC XX.
  1639         16  BK-AM-EFF-DT            PIC XX.
  1640         16  BK-AM-STATE             PIC XX.
  1641         16  FILLER                  PIC X(20).
  1642
  1643******************************************************************
  1644
  1645*    COPY ERCCOMP.
  1646******************************************************************
  1647*                                                                *
  1648*                                                                *
  1649*                            ERCCOMP                             *
  1650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1651*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  31
* EL050.cbl
  1652*                                                                *
  1653*   ONLINE CREDIT SYSTEM                                         *
  1654*                                                                *
  1655*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1656*                                                                *
  1657*   FILE TYPE = VSAM,KSDS                                        *
  1658*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1659*                                                                *
  1660*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1661*       ALTERNATE PATH = NONE                                    *
  1662*                                                                *
  1663*   LOG = NO                                                     *
  1664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1665*                                                                *
  1666******************************************************************
  1667*                   C H A N G E   L O G
  1668*
  1669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1670*-----------------------------------------------------------------
  1671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1672* EFFECTIVE    NUMBER
  1673*-----------------------------------------------------------------
  1674* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1675* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1676* 092205    2005050300006  PEMA  ADD LEASE FEE
  1677* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1678* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1679* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1680* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1681* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1682* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1683******************************************************************
  1684
  1685 01  COMPENSATION-MASTER.
  1686     12  CO-RECORD-ID                          PIC XX.
  1687         88  VALID-CO-ID                          VALUE 'CO'.
  1688
  1689     12  CO-CONTROL-PRIMARY.
  1690         16  CO-COMPANY-CD                     PIC X.
  1691         16  CO-CONTROL.
  1692             20  CO-CTL-1.
  1693                 24  CO-CARR-GROUP.
  1694                     28  CO-CARRIER            PIC X.
  1695                     28  CO-GROUPING.
  1696                         32  CO-GROUP-PREFIX   PIC XXX.
  1697                         32  CO-GROUP-PRIME    PIC XXX.
  1698                 24  CO-RESP-NO.
  1699                     28  CO-RESP-PREFIX        PIC X(4).
  1700                     28  CO-RESP-PRIME         PIC X(6).
  1701             20  CO-CTL-2.
  1702                 24  CO-ACCOUNT.
  1703                     28  CO-ACCT-PREFIX        PIC X(4).
  1704                     28  CO-ACCT-PRIME         PIC X(6).
  1705         16  CO-TYPE                           PIC X.
  1706             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1707             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1708             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1709
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  32
* EL050.cbl
  1710     12  CO-MAINT-INFORMATION.
  1711         16  CO-LAST-MAINT-DT                  PIC XX.
  1712         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1713         16  CO-LAST-MAINT-USER                PIC X(4).
  1714     12  FILLER                                PIC XX.
  1715     12  CO-STMT-TYPE                          PIC XXX.
  1716     12  CO-COMP-TYPE                          PIC X.
  1717         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1718     12  CO-STMT-OWNER                         PIC X(4).
  1719     12  CO-BALANCE-CONTROL                    PIC X.
  1720         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1721         88  CO-NO-BALANCE                        VALUE 'N'.
  1722
  1723     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1724         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1725         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1726         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1727
  1728     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1729         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1730         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1731
  1732     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1733     12  CO-GA-DIRECT-DEP                      PIC X.
  1734     12  CO-FUTURE-SPACE                       PIC X.
  1735         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1736
  1737     12  CO-ACCT-NAME                          PIC X(30).
  1738     12  CO-MAIL-NAME                          PIC X(30).
  1739     12  CO-ADDR-1                             PIC X(30).
  1740     12  CO-ADDR-2                             PIC X(30).
  1741     12  CO-ADDR-3.
  1742         16  CO-ADDR-CITY                      PIC X(27).
  1743         16  CO-ADDR-STATE                     PIC XX.
  1744     12  CO-CSO-1099                           PIC X.
  1745     12  CO-ZIP.
  1746         16  CO-ZIP-PRIME.
  1747             20  CO-ZIP-PRI-1ST                PIC X.
  1748                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1749             20  FILLER                        PIC X(4).
  1750         16  CO-ZIP-PLUS4                      PIC X(4).
  1751     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1752         16  CO-CAN-POSTAL-1                   PIC XXX.
  1753         16  CO-CAN-POSTAL-2                   PIC XXX.
  1754         16  FILLER                            PIC XXX.
  1755     12  CO-SOC-SEC                            PIC X(13).
  1756     12  CO-TELEPHONE.
  1757         16  CO-AREA-CODE                      PIC XXX.
  1758         16  CO-PREFIX                         PIC XXX.
  1759         16  CO-PHONE                          PIC X(4).
  1760
  1761     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1762
  1763     12  CO-AR-BAL-LEVEL                       PIC X.
  1764         88  CO-AR-REF-LVL                        VALUE '1'.
  1765         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1766         88  CO-AR-BILL-LVL                       VALUE '2'.
  1767         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  33
* EL050.cbl
  1768         88  CO-AR-FR-LVL                         VALUE '4'.
  1769
  1770     12  CO-AR-NORMAL-PRINT                    PIC X.
  1771         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1772         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1773
  1774     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1775
  1776     12  CO-AR-REPORTING                       PIC X.
  1777         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1778         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1779
  1780     12  CO-AR-PULL-CHECK                      PIC X.
  1781         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1782         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1783
  1784     12  CO-AR-BALANCE-PRINT                   PIC X.
  1785         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1786
  1787     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1788         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1789         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1790         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1791
  1792     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1793
  1794     12  CO-USER-CODE                          PIC X.
  1795     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1796
  1797******************************************************************
  1798*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1799*    THE LAST MONTH END RUN.
  1800******************************************************************
  1801
  1802     12  CO-LAST-ACTIVITY-DATE.
  1803         16  CO-ACT-YEAR                       PIC 99.
  1804         16  CO-ACT-MONTH                      PIC 99.
  1805         16  CO-ACT-DAY                        PIC 99.
  1806
  1807     12  CO-LAST-STMT-DT.
  1808         16  CO-LAST-STMT-YEAR                 PIC 99.
  1809         16  CO-LAST-STMT-MONTH                PIC 99.
  1810         16  CO-LAST-STMT-DAY                  PIC 99.
  1811
  1812     12  CO-MO-END-TOTALS.
  1813         16  CO-MONTHLY-TOTALS.
  1814             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1815             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1816             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1817             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1818             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1819
  1820         16  CO-AGING-TOTALS.
  1821             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1822             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1823             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1824             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1825
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  34
* EL050.cbl
  1826         16  CO-YTD-TOTALS.
  1827             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1828             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1829
  1830         16  CO-OVER-UNDER-TOTALS.
  1831             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1832             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1833
  1834     12  CO-MISCELLANEOUS-TOTALS.
  1835         16  CO-FICA-TOTALS.
  1836             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1837             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1838
  1839         16  CO-CLAIM-TOTALS.
  1840             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1841             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1842
  1843******************************************************************
  1844*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1845*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1846******************************************************************
  1847
  1848     12  CO-CURRENT-TOTALS.
  1849         16  CO-CURRENT-LAST-STMT-DT.
  1850             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1851             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1852             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1853
  1854         16  CO-CURRENT-MONTHLY-TOTALS.
  1855             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1856             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1857             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1858             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1859             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1860
  1861         16  CO-CURRENT-AGING-TOTALS.
  1862             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1863             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1864             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1865             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1866
  1867         16  CO-CURRENT-YTD-TOTALS.
  1868             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1869             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1870
  1871     12  CO-PAID-COMM-TOTALS.
  1872         16  CO-YTD-PAID-COMMS.
  1873             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1874             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1875
  1876     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1877         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1878         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1879
  1880     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1881         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1882         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1883         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  35
* EL050.cbl
  1884         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1885         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1886         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1887         88  CO-FINAL-LETTER                  VALUE 'F'.
  1888         88  CO-RECONCILING                   VALUE 'R'.
  1889         88  CO-PHONE-CALL                    VALUE 'P'.
  1890         88  CO-LEGAL                         VALUE 'L'.
  1891         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1892         88  CO-WRITE-OFF                     VALUE 'W'.
  1893         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1894
  1895     12  CO-CSR-CODE                       PIC X(4).
  1896
  1897     12  CO-GA-STATUS-INFO.
  1898         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1899         16  CO-GA-TERMINATION-DT          PIC XX.
  1900         16  CO-GA-STATUS-CODE             PIC X.
  1901             88  CO-GA-ACTIVE                 VALUE 'A'.
  1902             88  CO-GA-INACTIVE               VALUE 'I'.
  1903             88  CO-GA-PENDING                VALUE 'P'.
  1904         16  CO-GA-COMMENTS.
  1905             20  CO-GA-COMMENT-1           PIC X(40).
  1906             20  CO-GA-COMMENT-2           PIC X(40).
  1907             20  CO-GA-COMMENT-3           PIC X(40).
  1908             20  CO-GA-COMMENT-4           PIC X(40).
  1909
  1910     12  CO-RPTCD2                         PIC X(10).
  1911     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1912         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1913         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1914
  1915     12  CO-TYPE-AGENT                     PIC X(01).
  1916         88  CO-CORPORATION                   VALUE 'C'.
  1917         88  CO-PARTNERSHIP                   VALUE 'P'.
  1918         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1919         88  CO-TRUST                         VALUE 'T'.
  1920         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1921
  1922     12  CO-FAXNO.
  1923         16  CO-FAX-AREA-CODE                  PIC XXX.
  1924         16  CO-FAX-PREFIX                     PIC XXX.
  1925         16  CO-FAX-PHONE                      PIC X(4).
  1926
  1927     12  CO-BANK-INFORMATION.
  1928         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1929         16  CO-BANK-TRANSIT-NON REDEFINES
  1930             CO-BANK-TRANSIT-NO                PIC 9(8).
  1931
  1932         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1933     12  CO-MISC-DEDUCT-INFO REDEFINES
  1934                  CO-BANK-INFORMATION.
  1935         16  CO-MD-GL-ACCT                     PIC X(10).
  1936         16  CO-MD-DIV                         PIC XX.
  1937         16  CO-MD-CENTER                      PIC X(4).
  1938         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1939         16  CO-CREATE-AP-CHECK                PIC X.
  1940         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1941         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  36
* EL050.cbl
  1942     12  CO-ACH-STATUS                         PIC X.
  1943         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1944         88  CO-ACH-PENDING                        VALUE 'P'.
  1945
  1946     12  CO-BILL-SW                            PIC X.
  1947     12  CO-CONTROL-NAME                       PIC X(30).
  1948     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1949     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1950     12  CO-CLP-STATE                          PIC XX.
  1951     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1952     12  CO-SPP-REFUND-EDIT                    PIC X.
  1953
  1954******************************************************************
  1955
  1956*    COPY ERCAGTC.
  1957******************************************************************
  1958*                                                                *
  1959*                                                                *
  1960*                            ERCAGTC                             *
  1961*                            VMOD=2.001                          *
  1962*                                                                *
  1963*   ONLINE CREDIT SYSTEM                                         *
  1964*                                                                *
  1965*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1966*                                                                *
  1967*   FILE TYPE = VSAM,KSDS                                        *
  1968*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1969*                                                                *
  1970*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1971*       ALTERNATE PATH = NONE                                    *
  1972*                                                                *
  1973*   LOG = NO                                                     *
  1974*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1975*                                                                *
  1976******************************************************************
  1977*                   C H A N G E   L O G
  1978*
  1979* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1980*-----------------------------------------------------------------
  1981*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1982* EFFECTIVE    NUMBER
  1983*-----------------------------------------------------------------
  1984* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1985* 111004                         NEW FILE AND COPYBOOK
  1986* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1987******************************************************************
  1988 01  AGENT-COMMISSIONS.
  1989     12  AG-RECORD-ID                          PIC XX.
  1990         88  VALID-CO-ID                          VALUE 'AG'.
  1991     12  AG-CONTROL-PRIMARY.
  1992         16  AG-COMPANY-CD                     PIC X.
  1993         16  AG-CONTROL.
  1994             20  AG-CTL-1.
  1995                 24  AG-CARR-GROUP.
  1996                     28  AG-CARRIER            PIC X.
  1997                     28  AG-GROUPING           PIC X(6).
  1998                 24  AG-BANK                   PIC X(10).
  1999             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  37
* EL050.cbl
  2000                 24  AG-EXP-DT                 PIC XX.
  2001         16  AG-TYPE                           PIC X.
  2002             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2003             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2004     12  AG-MAINT-INFORMATION.
  2005         16  AG-LAST-MAINT-DT                  PIC XX.
  2006         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2007         16  AG-LAST-MAINT-USER                PIC X(4).
  2008         16  FILLER                            PIC X(10).
  2009     12  AG-EFF-DT                             PIC XX.
  2010     12  AG-COMM-STRUCTURE.
  2011         16  AG-AGT-COMMS OCCURS 10.
  2012             20  AG-AGT                PIC X(10).
  2013             20  AG-COM-TYP            PIC X.
  2014             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2015             20  AG-RECALC-LV-INDIC    PIC X.
  2016             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2017             20  AG-LRCALC-LV-INDIC    PIC X.
  2018             20  FILLER                PIC X(05).
  2019     12  FILLER                  PIC X(145).
  2020******************************************************************
  2021*    COPY ERCRESS.
  2022******************************************************************
  2023*                                                                *
  2024*                            ERCRESS                             *
  2025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2026*                            VMOD=2.002                          *
  2027*                                                                *
  2028*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2029*                                                                *
  2030*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2031*   VSAM RESIDENT STATE TAX MASTER                              *
  2032*                                                                *
  2033*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2034*                                                                *
  2035*   FILE TYPE = VSAM,KSDS                                        *
  2036*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2037*                                                                *
  2038*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2039*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2040*                                                                *
  2041*   LOG = NO                                                     *
  2042*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2043*                                                                *
  2044*                                                                *
  2045******************************************************************
  2046
  2047 01  RESIDENT-STATE-TAX-MASTER.
  2048
  2049     10  ERRESS-PRIMARY-KEY.
  2050         15  RES-COMPANY-CD        PIC X.
  2051         15  RES-RESIDENT-STATE    PIC XX.
  2052         15  RES-COVERAGE-CATEGORY PIC X.
  2053         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2054*                                      YYYYMMDD
  2055*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2056
  2057     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  38
* EL050.cbl
  2058
  2059         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2060         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2061         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2062         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2063
  2064     10 RES-RECALC-SW              PIC   X.
  2065         88 RECALC                VALUE 'Y'.
  2066         88 NO-RECALC             VALUE 'N'.
  2067     10  RES-MAINT-BY              PIC X(4).
  2068     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2069     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2070*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  39
* EL050.cbl
  2072*    COPY ERCRESC.
  2073******************************************************************
  2074*                                                                *
  2075*                            ERCRESC                             *
  2076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2077*                            VMOD=2.003                          *
  2078*                                                                *
  2079*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2080*                                                                *
  2081*   FILE TYPE = VSAM,KSDS                                        *
  2082*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2083*                                                                *
  2084*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2085*       ALTERNATE PATH1 = NONE                                   *
  2086*                                                                *
  2087*   LOG = NO                                                     *
  2088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2089*                                                                *
  2090******************************************************************
  2091
  2092 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2093
  2094     10  ERRESC-RECORD-KEY.
  2095         15  RESC-COMPANY-CD           PIC   X.
  2096         15  RESC-CARRIER              PIC   X.
  2097         15  RESC-GROUP                PIC   X(6).
  2098         15  RESC-STATE                PIC   XX.
  2099         15  RESC-ACCOUNT              PIC   X(10).
  2100         15  RESC-AGENT                PIC   X(10).
  2101         15  RESC-RESIDENT-STATE       PIC   XX.
  2102         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2103*                                           YYYYMMDD
  2104     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2105
  2106     10  RESC-COMM-RECORD-DATA.
  2107         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2108             20 RESC-COVERAGE-CAT      PIC    X.
  2109             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2110             20 RESC-COMMISSION-TAB REDEFINES
  2111                RESC-COMMISSION-PER    PIC  XXX.
  2112
  2113     10  RESC-MAINT-BY                 PIC X(4).
  2114     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2115     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2116*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  40
* EL050.cbl
  2118*    COPY ERCPLAN.
  2119******************************************************************
  2120*                                                                *
  2121*                                                                *
  2122*                            ERCPLAN                             *
  2123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2124*                            VMOD=2.003                          *
  2125*                                                                *
  2126*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2127*                                                                *
  2128*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2129*   PLAN MASTER                                                  *
  2130*                                                                *
  2131*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2132*                                                                *
  2133*   FILE TYPE = VSAM,KSDS                                        *
  2134*   RECORD SIZE = 420   RECFORM = FIX                            *
  2135*                                                                *
  2136*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2137*       ALTERNATE PATH1 = N/A                                    *
  2138*                                                                *
  2139*   LOG = NO                                                     *
  2140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2141*                                                                *
  2142*                                                                *
  2143******************************************************************
  2144
  2145 01  PLAN-MASTER.
  2146     12  PL-RECORD-ID                      PIC XX.
  2147         88  VALID-PL-ID                      VALUE 'PL'.
  2148
  2149     12  PL-CONTROL-PRIMARY.
  2150         16  PL-COMPANY-CD                 PIC X.
  2151         16  PL-MSTR-CNTRL.
  2152             20  PL-CONTROL-A.
  2153                 24  PL-CARRIER            PIC X.
  2154                 24  PL-GROUPING           PIC X(6).
  2155                 24  PL-STATE              PIC XX.
  2156                 24  PL-ACCOUNT            PIC X(10).
  2157             20  PL-BENEFIT-TYPE           PIC X.
  2158             20  PL-BENEFIT-CODE           PIC XX.
  2159             20  PL-REVISION-NO            PIC X(3).
  2160
  2161     12  PL-CONTROL-BY-VAR-GRP.
  2162         16  PL-COMPANY-CD-A1              PIC X.
  2163         16  PL-VG-CARRIER                 PIC X.
  2164         16  PL-VG-GROUPING                PIC X(6).
  2165         16  PL-VG-STATE                   PIC XX.
  2166         16  PL-VG-ACCOUNT                 PIC X(10).
  2167         16  PL-BENEFIT-TYPE-A1            PIC X.
  2168         16  PL-BENEFIT-CODE-A1            PIC XX.
  2169         16  PL-REVISION-NO-A1             PIC 999.
  2170
  2171     12  PL-MAINT-INFORMATION.
  2172         16  PL-LAST-MAINT-DT              PIC XX.
  2173         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2174         16  PL-LAST-MAINT-USER            PIC X(4).
  2175         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  41
* EL050.cbl
  2176
  2177     12  PL-LIABILITY-LIMITS.
  2178         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2179         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2180             20  PL-LM-AGE                 PIC S99        COMP-3.
  2181             20  PL-LM-DUR                 PIC S999       COMP-3.
  2182             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2183             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2184
  2185     12  FILLER                            PIC X(30).
  2186
  2187     12  PL-GL-ACCOUNT-NOS.
  2188         16  PL-PREMIUM-GL                 PIC X(8).
  2189         16  PL-COMM-GL                    PIC X(8).
  2190         16  PL-CLAIM-GL                   PIC X(8).
  2191     12  FILLER                            PIC X(24).
  2192     12  PL-TOLERANCES.
  2193         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2194         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2195         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2196         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2197         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2198         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2199     12  PL-OVER-SHORT.
  2200         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2201         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2202     12  FILLER                            PIC X(24).
  2203     12  PLAN-MISC.
  2204         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2205         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2206         16  PL-IG                         PIC X.
  2207         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2208         16  PL-POLICY-FORM                PIC X(12).
  2209         16  PL-EDIT-FOR-FORM              PIC X(01).
  2210         16  PL-DEV-CODE                   PIC XXX.
  2211         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2212         16  PL-CALC-METHOD                PIC X.
  2213         16  PL-BENEFIT-GROUP              PIC X(05).
  2214         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2215
  2216         16  FILLER                        PIC X(99).
  2217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  42
* EL050.cbl
  2219*    COPY ELCCERT.
  2220******************************************************************
  2221*                                                                *
  2222*                            ELCCERT.                            *
  2223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2224*                            VMOD=2.013                          *
  2225*                                                                *
  2226*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2227*                                                                *
  2228*   FILE TYPE = VSAM,KSDS                                        *
  2229*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2230*                                                                *
  2231*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2232*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2233*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2234*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2235*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2236*                                                                *
  2237*   LOG = YES                                                    *
  2238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2239******************************************************************
  2240*                   C H A N G E   L O G
  2241*
  2242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2243*-----------------------------------------------------------------
  2244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2245* EFFECTIVE    NUMBER
  2246*-----------------------------------------------------------------
  2247* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2248* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2249* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2250* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2251* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2252* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2253* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2254* 032612  CR2011110200001  PEMA  AHL CHANGES
  2255* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2256* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2257* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2258******************************************************************
  2259
  2260 01  CERTIFICATE-MASTER.
  2261     12  CM-RECORD-ID                      PIC XX.
  2262         88  VALID-CM-ID                      VALUE 'CM'.
  2263
  2264     12  CM-CONTROL-PRIMARY.
  2265         16  CM-COMPANY-CD                 PIC X.
  2266         16  CM-CARRIER                    PIC X.
  2267         16  CM-GROUPING.
  2268             20  CM-GROUPING-PREFIX        PIC X(3).
  2269             20  CM-GROUPING-PRIME         PIC X(3).
  2270         16  CM-STATE                      PIC XX.
  2271         16  CM-ACCOUNT.
  2272             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2273             20  CM-ACCOUNT-PRIME          PIC X(6).
  2274         16  CM-CERT-EFF-DT                PIC XX.
  2275         16  CM-CERT-NO.
  2276             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  43
* EL050.cbl
  2277             20  CM-CERT-SFX               PIC X.
  2278
  2279     12  CM-CONTROL-BY-NAME.
  2280         16  CM-COMPANY-CD-A1              PIC X.
  2281         16  CM-INSURED-LAST-NAME          PIC X(15).
  2282         16  CM-INSURED-INITIALS.
  2283             20  CM-INSURED-INITIAL1       PIC X.
  2284             20  CM-INSURED-INITIAL2       PIC X.
  2285
  2286     12  CM-CONTROL-BY-SSN.
  2287         16  CM-COMPANY-CD-A2              PIC X.
  2288         16  CM-SOC-SEC-NO.
  2289             20  CM-SSN-STATE              PIC XX.
  2290             20  CM-SSN-ACCOUNT            PIC X(6).
  2291             20  CM-SSN-LN3.
  2292                 25  CM-INSURED-INITIALS-A2.
  2293                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2294                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2295                 25 CM-PART-LAST-NAME-A2         PIC X.
  2296
  2297     12  CM-CONTROL-BY-CERT-NO.
  2298         16  CM-COMPANY-CD-A4              PIC X.
  2299         16  CM-CERT-NO-A4                 PIC X(11).
  2300
  2301     12  CM-CONTROL-BY-MEMB.
  2302         16  CM-COMPANY-CD-A5              PIC X.
  2303         16  CM-MEMBER-NO.
  2304             20  CM-MEMB-STATE             PIC XX.
  2305             20  CM-MEMB-ACCOUNT           PIC X(6).
  2306             20  CM-MEMB-LN4.
  2307                 25  CM-INSURED-INITIALS-A5.
  2308                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2309                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2310                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2311
  2312     12  CM-INSURED-PROFILE-DATA.
  2313         16  CM-INSURED-FIRST-NAME.
  2314             20  CM-INSURED-1ST-INIT       PIC X.
  2315             20  FILLER                    PIC X(9).
  2316         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2317         16  CM-INSURED-SEX                PIC X.
  2318             88  CM-SEX-MALE                  VALUE 'M'.
  2319             88  CM-SEX-FEMAL                 VALUE 'F'.
  2320         16  CM-INSURED-JOINT-AGE          PIC 99.
  2321         16  CM-JOINT-INSURED-NAME.
  2322             20  CM-JT-LAST-NAME           PIC X(15).
  2323             20  CM-JT-FIRST-NAME.
  2324                 24  CM-JT-1ST-INIT        PIC X.
  2325                 24  FILLER                PIC X(9).
  2326             20  CM-JT-INITIAL             PIC X.
  2327
  2328     12  CM-LIFE-DATA.
  2329         16  CM-LF-BENEFIT-CD              PIC XX.
  2330         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2331         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2332         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2333         16  CM-LF-DEV-CODE                PIC XXX.
  2334         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  44
* EL050.cbl
  2335         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2336         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2337         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2338         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2339         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2340         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2341         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2342         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2343         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2344         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2345         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2346         16  cm-temp-epiq                  pic xx.
  2347             88  EPIQ-CLASS                  value 'EQ'.
  2348*        16  FILLER                        PIC XX.
  2349
  2350     12  CM-AH-DATA.
  2351         16  CM-AH-BENEFIT-CD              PIC XX.
  2352         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2353         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2354         16  CM-AH-DEV-CODE                PIC XXX.
  2355         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2356         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2357         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2358         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2359         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2360         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2361         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2362         16  CM-AH-PAID-THRU-DT            PIC XX.
  2363             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2364         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2365         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2366         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2367         16  FILLER                        PIC X.
  2368
  2369     12  CM-LOAN-INFORMATION.
  2370         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2371         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2372                                           PIC S9(5)V99  COMP-3.
  2373         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2374         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2375         16  CM-PAY-FREQUENCY              PIC S99.
  2376         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2377         16  CM-RATE-CLASS                 PIC XX.
  2378         16  CM-BENEFICIARY                PIC X(25).
  2379         16  CM-POLICY-FORM-NO             PIC X(12).
  2380         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2381         16  CM-LAST-ADD-ON-DT             PIC XX.
  2382         16  CM-DEDUCTIBLE-AMOUNTS.
  2383             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2384             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2385         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2386             20  CM-RESIDENT-STATE         PIC XX.
  2387             20  CM-RATE-CODE              PIC X(4).
  2388             20  FILLER                    PIC XX.
  2389         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2390             20  CM-LOAN-OFFICER           PIC X(5).
  2391             20  FILLER                    PIC XXX.
  2392         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  45
* EL050.cbl
  2393         16  CM-UNDERWRITING-CODE          PIC X.
  2394             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2395         16  CM-POST-CARD-IND              PIC X.
  2396         16  CM-REF-INTERFACE-SW           PIC X.
  2397         16  CM-PREMIUM-TYPE               PIC X.
  2398             88  CM-SING-PRM                  VALUE '1'.
  2399             88  CM-O-B-COVERAGE              VALUE '2'.
  2400             88  CM-OPEN-END                  VALUE '3'.
  2401         16  CM-IND-GRP-TYPE               PIC X.
  2402             88  CM-INDIVIDUAL                VALUE 'I'.
  2403             88  CM-GROUP                     VALUE 'G'.
  2404         16  CM-SKIP-CODE                  PIC X.
  2405             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2406             88  SKIP-JULY                    VALUE '1'.
  2407             88  SKIP-AUGUST                  VALUE '2'.
  2408             88  SKIP-SEPTEMBER               VALUE '3'.
  2409             88  SKIP-JULY-AUG                VALUE '4'.
  2410             88  SKIP-AUG-SEPT                VALUE '5'.
  2411             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2412             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2413             88  SKIP-JUNE                    VALUE '8'.
  2414             88  SKIP-JUNE-JULY               VALUE '9'.
  2415             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2416             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2417         16  CM-PAYMENT-MODE               PIC X.
  2418             88  PAY-MONTHLY                  VALUE SPACE.
  2419             88  PAY-WEEKLY                   VALUE '1'.
  2420             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2421             88  PAY-BI-WEEKLY                VALUE '3'.
  2422             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2423         16  CM-LOAN-NUMBER                PIC X(8).
  2424         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2425         16  CM-OLD-LOF                    PIC XXX.
  2426*        16  CM-LOAN-OFFICER               PIC XXX.
  2427         16  CM-REIN-TABLE                 PIC XXX.
  2428         16  CM-SPECIAL-REIN-CODE          PIC X.
  2429         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2430         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2431         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2432
  2433     12  CM-STATUS-DATA.
  2434         16  CM-ENTRY-STATUS               PIC X.
  2435         16  CM-ENTRY-DT                   PIC XX.
  2436
  2437         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2438         16  CM-LF-CANCEL-DT               PIC XX.
  2439         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2440
  2441         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2442         16  CM-LF-DEATH-DT                PIC XX.
  2443         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2444
  2445         16  CM-LF-CURRENT-STATUS          PIC X.
  2446             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2447                                                'M' '4' '5' '9'.
  2448             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2449             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2450             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  46
* EL050.cbl
  2451             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2452             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2453             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2454             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2455             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2456             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2457             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2458             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2459             88  CM-LF-DECLINED               VALUE 'D'.
  2460             88  CM-LF-VOIDED                 VALUE 'V'.
  2461
  2462         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2463         16  CM-AH-CANCEL-DT               PIC XX.
  2464         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2465
  2466         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2467         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2468         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2469
  2470         16  CM-AH-CURRENT-STATUS          PIC X.
  2471             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2472                                                'M' '4' '5' '9'.
  2473             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2474             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2475             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2476             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2477             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2478             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2479             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2480             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2481             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2482             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2483             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2484             88  CM-AH-DECLINED               VALUE 'D'.
  2485             88  CM-AH-VOIDED                 VALUE 'V'.
  2486
  2487         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2488             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2489             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2490             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2491         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2492
  2493         16  CM-ENTRY-BATCH                PIC X(6).
  2494         16  CM-LF-EXIT-BATCH              PIC X(6).
  2495         16  CM-AH-EXIT-BATCH              PIC X(6).
  2496         16  CM-LAST-MONTH-END             PIC XX.
  2497
  2498     12  CM-NOTE-SW                        PIC X.
  2499         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2500         88  CERT-NOTES-PRESENT               VALUE '1'.
  2501         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2502         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2503         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2504         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2505         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2506         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2507     12  CM-COMP-EXCP-SW                   PIC X.
  2508         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  47
* EL050.cbl
  2509         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2510     12  CM-INSURED-ADDRESS-SW             PIC X.
  2511         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2512         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2513
  2514*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2515     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2516     12  FILLER                            PIC X.
  2517
  2518*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2519     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2520     12  FILLER                            PIC X.
  2521*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2522     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2523
  2524     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2525         88  CERT-ADDED-BATCH                 VALUE ' '.
  2526         88  CERT-ADDED-ONLINE                VALUE '1'.
  2527         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2528         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2529         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2530     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2531         88  CERT-AS-LOADED                   VALUE ' '.
  2532         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2533         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2534         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2535         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2536         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2537         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2538         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2539
  2540     12  CM-ACCOUNT-COMM-PCTS.
  2541         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2542         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2543
  2544     12  CM-USER-FIELD                     PIC X.
  2545     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2546     12  CM-CLP-STATE                      PIC XX.
  2547     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2548     12  CM-USER-RESERVED                  PIC XXX.
  2549     12  FILLER REDEFINES CM-USER-RESERVED.
  2550         16  CM-AH-CLASS-CD                PIC XX.
  2551         16  F                             PIC X.
  2552******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  48
* EL050.cbl
  2554*    COPY ERCMAIL.
  2555******************************************************************
  2556*                                                                *
  2557*                                                                *
  2558*                            ERCMAIL                             *
  2559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2560*                            VMOD=2.003                          *
  2561*                                                                *
  2562*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2563*                                                                *
  2564*   FILE TYPE = VSAM,KSDS                                        *
  2565*   RECORD SIZE = 374   RECFORM = FIX                            *
  2566*                                                                *
  2567*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2568*   ALTERNATE PATH    = NOT USED                                 *
  2569*                                                                *
  2570*   LOG = YES                                                    *
  2571*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2572******************************************************************
  2573*                   C H A N G E   L O G
  2574*
  2575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2576*-----------------------------------------------------------------
  2577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2578* EFFECTIVE    NUMBER
  2579*-----------------------------------------------------------------
  2580* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2581* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2582* 111108                   PEMA  ADD CRED BENE ADDR2
  2583******************************************************************
  2584
  2585 01  MAILING-DATA.
  2586     12  MA-RECORD-ID                      PIC XX.
  2587         88  VALID-MA-ID                       VALUE 'MA'.
  2588
  2589     12  MA-CONTROL-PRIMARY.
  2590         16  MA-COMPANY-CD                 PIC X.
  2591         16  MA-CARRIER                    PIC X.
  2592         16  MA-GROUPING.
  2593             20  MA-GROUPING-PREFIX        PIC XXX.
  2594             20  MA-GROUPING-PRIME         PIC XXX.
  2595         16  MA-STATE                      PIC XX.
  2596         16  MA-ACCOUNT.
  2597             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2598             20  MA-ACCOUNT-PRIME          PIC X(6).
  2599         16  MA-CERT-EFF-DT                PIC XX.
  2600         16  MA-CERT-NO.
  2601             20  MA-CERT-PRIME             PIC X(10).
  2602             20  MA-CERT-SFX               PIC X.
  2603
  2604     12  FILLER                            PIC XX.
  2605
  2606     12  MA-ACCESS-CONTROL.
  2607         16  MA-SOURCE-SYSTEM              PIC XX.
  2608             88  MA-FROM-CREDIT                VALUE 'CR'.
  2609             88  MA-FROM-VSI                   VALUE 'VS'.
  2610             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2611             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  49
* EL050.cbl
  2612         16  MA-RECORD-ADD-DT              PIC XX.
  2613         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2614         16  MA-LAST-MAINT-DT              PIC XX.
  2615         16  MA-LAST-MAINT-BY              PIC XXXX.
  2616         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2617
  2618     12  MA-PROFILE-INFO.
  2619         16  MA-QUALIFY-CODE-1             PIC XX.
  2620         16  MA-QUALIFY-CODE-2             PIC XX.
  2621         16  MA-QUALIFY-CODE-3             PIC XX.
  2622         16  MA-QUALIFY-CODE-4             PIC XX.
  2623         16  MA-QUALIFY-CODE-5             PIC XX.
  2624
  2625         16  MA-INSURED-LAST-NAME          PIC X(15).
  2626         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2627         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2628         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2629         16  MA-INSURED-BIRTH-DT           PIC XX.
  2630         16  MA-INSURED-SEX                PIC X.
  2631             88  MA-SEX-MALE                   VALUE 'M'.
  2632             88  MA-SEX-FEMALE                 VALUE 'F'.
  2633         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2634
  2635         16  MA-ADDRESS-CORRECTED          PIC X.
  2636         16  MA-JOINT-BIRTH-DT             PIC XX.
  2637*        16  FILLER                        PIC X(12).
  2638
  2639         16  MA-ADDRESS-LINE-1             PIC X(30).
  2640         16  MA-ADDRESS-LINE-2             PIC X(30).
  2641         16  MA-CITY-STATE.
  2642             20  MA-CITY                   PIC X(28).
  2643             20  MA-ADDR-STATE             PIC XX.
  2644         16  MA-ZIP.
  2645             20  MA-ZIP-CODE.
  2646                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2647                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2648                 24  FILLER                PIC X(4).
  2649             20  MA-ZIP-PLUS4              PIC X(4).
  2650         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2651             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2652             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2653             20  FILLER                    PIC X(3).
  2654
  2655         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2656
  2657         16  FILLER                        PIC XXX.
  2658*        16  FILLER                        PIC X(10).
  2659
  2660     12  MA-CRED-BENE-INFO.
  2661         16  MA-CRED-BENE-NAME                 PIC X(25).
  2662         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2663         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2664         16  MA-CRED-BENE-CTYST.
  2665             20  MA-CRED-BENE-CITY             PIC X(28).
  2666             20  MA-CRED-BENE-STATE            PIC XX.
  2667         16  MA-CRED-BENE-ZIP.
  2668             20  MA-CB-ZIP-CODE.
  2669                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  50
* EL050.cbl
  2670                     88  MA-CB-CANADIAN-POST-CODE
  2671                                           VALUE 'A' THRU 'Z'.
  2672                 24  FILLER                    PIC X(4).
  2673             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2674         16  MA-CB-CANADIAN-POSTAL-CODE
  2675                            REDEFINES MA-CRED-BENE-ZIP.
  2676             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2677             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2678             20  FILLER                        PIC X(3).
  2679     12  MA-POST-CARD-MAIL-DATA.
  2680         16  MA-MAIL-DATA OCCURS 7.
  2681             20  MA-MAIL-TYPE              PIC X.
  2682                 88  MA-12MO-MAILING           VALUE '1'.
  2683                 88  MA-EXP-MAILING            VALUE '2'.
  2684             20  MA-MAIL-STATUS            PIC X.
  2685                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2686                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2687                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2688             20  MA-MAIL-DATE              PIC XX.
  2689     12  FILLER                            PIC XX.
  2690     12  FILLER                            PIC XX.
  2691*    12  FILLER                            PIC X(30).
  2692******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  51
* EL050.cbl
  2694*    COPY ERCPNDM.
  2695******************************************************************
  2696*                                                                *
  2697*                                                                *
  2698*                            ERCPNDM                             *
  2699*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2700*                            VMOD=2.003                          *
  2701*                                                                *
  2702*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2703*                                                                *
  2704*   FILE TYPE = VSAM,KSDS                                        *
  2705*   RECORD SIZE = 374   RECFORM = FIX                            *
  2706*                                                                *
  2707*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2708*   ALTERNATE PATH    = NOT USED                                 *
  2709*                                                                *
  2710*   LOG = YES                                                    *
  2711*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2712******************************************************************
  2713*                   C H A N G E   L O G
  2714*
  2715* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2716*-----------------------------------------------------------------
  2717*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2718* EFFECTIVE    NUMBER
  2719*-----------------------------------------------------------------
  2720* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2721* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2722* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2723* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2724******************************************************************
  2725
  2726 01  PENDING-MAILING-DATA.
  2727     12  PM-RECORD-ID                      PIC XX.
  2728         88  VALID-MA-ID                       VALUE 'PM'.
  2729
  2730     12  PM-CONTROL-PRIMARY.
  2731         16  PM-COMPANY-CD                 PIC X.
  2732         16  PM-ENTRY-BATCH                PIC X(6).
  2733         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2734         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2735
  2736     12  FILLER                            PIC X(14).
  2737
  2738     12  PM-ACCESS-CONTROL.
  2739         16  PM-SOURCE-SYSTEM              PIC XX.
  2740             88  PM-FROM-CREDIT                VALUE 'CR'.
  2741             88  PM-FROM-VSI                   VALUE 'VS'.
  2742             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2743             88  PM-FROM-OTHER                 VALUE 'OT'.
  2744         16  PM-RECORD-ADD-DT              PIC XX.
  2745         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2746         16  PM-LAST-MAINT-DT              PIC XX.
  2747         16  PM-LAST-MAINT-BY              PIC XXXX.
  2748         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2749
  2750     12  PM-PROFILE-INFO.
  2751         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  52
* EL050.cbl
  2752         16  PM-QUALIFY-CODE-2             PIC XX.
  2753         16  PM-QUALIFY-CODE-3             PIC XX.
  2754         16  PM-QUALIFY-CODE-4             PIC XX.
  2755         16  PM-QUALIFY-CODE-5             PIC XX.
  2756
  2757         16  PM-INSURED-LAST-NAME          PIC X(15).
  2758         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2759         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2760         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2761         16  PM-INSURED-BIRTH-DT           PIC XX.
  2762         16  PM-INSURED-SEX                PIC X.
  2763             88  PM-SEX-MALE                   VALUE 'M'.
  2764             88  PM-SEX-FEMALE                 VALUE 'F'.
  2765         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2766
  2767         16  PM-ADDRESS-CORRECTED          PIC X.
  2768         16  PM-JOINT-BIRTH-DT             PIC XX.
  2769*        16  FILLER                        PIC X(12).
  2770
  2771         16  PM-ADDRESS-LINE-1             PIC X(30).
  2772         16  PM-ADDRESS-LINE-2             PIC X(30).
  2773         16  PM-CITY-STATE.
  2774             20  PM-CITY                   PIC X(28).
  2775             20  PM-STATE                  PIC XX.
  2776         16  PM-ZIP.
  2777             20  PM-ZIP-CODE.
  2778                 24  PM-ZIP-1              PIC X.
  2779                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2780                 24  FILLER                PIC X(4).
  2781             20  PM-ZIP-PLUS4              PIC X(4).
  2782         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2783             20  PM-CAN-POST1              PIC XXX.
  2784             20  PM-CAN-POST2              PIC XXX.
  2785             20  FILLER                    PIC XXX.
  2786
  2787         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2788         16  pm-city-st-zip-verified       pic x.
  2789         16  FILLER                        PIC XX.
  2790
  2791     12  PM-CRED-BENE-INFO.
  2792         16  PM-CRED-BENE-NAME             PIC X(25).
  2793         16  PM-CRED-BENE-ADDR             PIC X(30).
  2794         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2795         16  PM-CRED-BENE-CTYST.
  2796             20  PM-CRED-BENE-CITY         PIC X(28).
  2797             20  PM-CRED-BENE-STATE        PIC XX.
  2798         16  PM-CRED-BENE-ZIP.
  2799             20  PM-CB-ZIP-CODE.
  2800                 24  PM-CB-ZIP-1           PIC X.
  2801                     88  PM-CB-CANADIAN-POST-CODE
  2802                                  VALUE 'A' THRU 'Z'.
  2803                 24  FILLER                PIC X(4).
  2804             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2805         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2806             20  PM-CB-CAN-POST1           PIC XXX.
  2807             20  PM-CB-CAN-POST2           PIC XXX.
  2808             20  FILLER                    PIC XXX.
  2809     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  53
* EL050.cbl
  2810         16  PM-MAIL-DATA OCCURS 7.
  2811             20  PM-MAIL-TYPE              PIC X.
  2812                 88  PM-12MO-MAILING           VALUE '1'.
  2813                 88  PM-EXP-MAILING            VALUE '2'.
  2814             20  PM-MAIL-STATUS            PIC X.
  2815                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2816                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2817                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2818             20  PM-MAIL-DATE              PIC XX.
  2819     12  FILLER                            PIC XX.
  2820     12  FILLER                            PIC X(12).
  2821*    12  FILLER                            PIC X(30).
  2822
  2823******************************************************************
  2824*                                COPY ERCLOFC.
  2825******************************************************************
  2826*                                                                *
  2827*                                                                *
  2828*                            ERCLOFC                             *
  2829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2830*                            VMOD=2.003                          *
  2831*                                                                *
  2832*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2833*                                                                *
  2834*   FILE TYPE = VSAM,KSDS                                        *
  2835*   RECORD SIZE = 670   RECFORM = FIX                            *
  2836*                                                                *
  2837*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2838*                                                                *
  2839*   LOG = YES                                                    *
  2840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2841*                                                                *
  2842******************************************************************
  2843
  2844 01  LOAN-OFFICER-MASTER.
  2845     12  LO-RECORD-ID                PIC XX.
  2846         88  VALID-LO-ID                VALUE 'LO'.
  2847
  2848     12  LO-CONTROL-PRIMARY.
  2849         16  LO-COMPANY-CD           PIC X.
  2850         16  LO-CARRIER              PIC X.
  2851         16  LO-GROUPING.
  2852             20  LO-GROUPING-PREFIX  PIC XXX.
  2853             20  LO-GROUPING-PRIME   PIC XXX.
  2854         16  LO-STATE                PIC XX.
  2855         16  LO-ACCOUNT.
  2856             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2857             20  LO-ACCOUNT-PRIME    PIC X(6).
  2858         16  LO-OFFICER-CODE         PIC X(5).
  2859
  2860     12  LO-OFFICER-NAME             PIC X(30).
  2861
  2862     12  LO-LAST-MAINT-DT            PIC XX.
  2863     12  LO-LAST-USER                PIC X(4).
  2864     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2865
  2866     12  LO-COMP-CONTROL             PIC X.
  2867             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  54
* EL050.cbl
  2868             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2869     12  LO-DETAIL-CONTROL           PIC X.
  2870             88  LO-PRINT-DETAIL        VALUE 'D'.
  2871             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2872
  2873     12  LO-SV-CARRIER               PIC X.
  2874     12  LO-SV-GROUPING              PIC X(6).
  2875     12  LO-SV-STATE                 PIC XX.
  2876
  2877     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2878     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2879
  2880     12  LO-OFFICER-INFO.
  2881         16  FILLER OCCURS 12 TIMES.
  2882             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2883             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2884             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2885             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2886             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2887             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2888             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2889             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2890     12  FILLER                      PIC X(198).
  2891******************************************************************
  2892*                                COPY ERCPDEF.
  2893******************************************************************
  2894*                                                                *
  2895*                                                                *
  2896*                            ERCPDEF.                            *
  2897*                                                                *
  2898*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2899*                                                                *
  2900*    FILE TYPE = VSAM,KSDS                                       *
  2901*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2902*                                                                *
  2903*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2904*                                                                *
  2905*    LOG = YES                                                   *
  2906*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2907******************************************************************
  2908*                   C H A N G E   L O G
  2909*
  2910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2911*-----------------------------------------------------------------
  2912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2913* EFFECTIVE    NUMBER
  2914*-----------------------------------------------------------------
  2915* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2916* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2917* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2918* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2919******************************************************************
  2920 01  PRODUCT-MASTER.
  2921    12  PD-RECORD-ID                 PIC X(02).
  2922        88  VALID-PD-ID                  VALUE 'PD'.
  2923    12  PD-CONTROL-PRIMARY.
  2924        16  PD-COMPANY-CD            PIC X.
  2925        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  55
* EL050.cbl
  2926        16  PD-PRODUCT-CD            PIC XXX.
  2927        16  PD-FILLER                PIC X(7).
  2928        16  PD-BEN-TYPE              PIC X.
  2929        16  PD-BEN-CODE              PIC XX.
  2930        16  PD-PROD-EXP-DT           PIC XX.
  2931    12  FILLER                       PIC X(50).
  2932    12  PD-PRODUCT-DATA OCCURS 8.
  2933        16  PD-PROD-CODE             PIC X.
  2934            88  PD-PROD-LIFE           VALUE 'L'.
  2935            88  PD-PROD-PROP           VALUE 'P'.
  2936            88  PD-PROD-AH             VALUE 'A'.
  2937            88  PD-PROD-IU             VALUE 'I'.
  2938            88  PD-PROD-GAP            VALUE 'G'.
  2939            88  PD-PROD-FAML           VALUE 'F'.
  2940            88  PD-PROD-OTH            VALUE 'O'.
  2941        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2942        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2943        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2944        16  PD-MAX-TERM              PIC S999        COMP-3.
  2945        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2946        16  FILLER                   PIC X.
  2947        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2948        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2949        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2950        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2951        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2952        16  PD-REC-CRIT-PERIOD       PIC 99.
  2953        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2954            20  PD-RECURRING-YN      PIC X.
  2955            20  FILLER               PIC X.
  2956        16  PD-RTW-MOS               PIC 99.
  2957        16  PD-MAX-EXTENSION         PIC 99.
  2958        16  pd-ben-pct               pic sv999 comp-3.
  2959*       16  FILLER                   PIC XX.
  2960    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2961    12  PD-TERM-LIMITS OCCURS 15.
  2962        16  PD-LOW-TERM              PIC S999        COMP-3.
  2963        16  PD-HI-TERM               PIC S999        COMP-3.
  2964*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2965    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2966        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2967        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2968    12  PD-EARN-FACTORS.
  2969        16  FILLER OCCURS 15.
  2970            20  FILLER OCCURS 15.
  2971                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2972    12  PD-PRODUCT-DESC              PIC X(80).
  2973    12  PD-TRUNCATED                 PIC X.
  2974    12  FILLER                       PIC X(59).
  2975    12  PD-MAINT-INFORMATION.
  2976        16  PD-LAST-MAINT-DT         PIC X(02).
  2977        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2978        16  PD-LAST-MAINT-BY         PIC X(04).
  2979*                                COPY ELCSTATE.
  2980******************************************************************
  2981*                                                                *
  2982*                                                                *
  2983*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  56
* EL050.cbl
  2984*                                                                *
  2985*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2986*                                                                *
  2987*   FILE TYPE = VSAM,KSDS                                        *
  2988*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2989*                                                                *
  2990*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2991*       ALTERNATE INDEX = NONE                                   *
  2992*                                                                *
  2993*   LOG = YES                                                    *
  2994*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2995******************************************************************
  2996*                   C H A N G E   L O G
  2997*
  2998* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2999*-----------------------------------------------------------------
  3000*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3001* EFFECTIVE    NUMBER
  3002*-----------------------------------------------------------------
  3003* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  3004******************************************************************
  3005*
  3006 01  STATE-FILE.
  3007     12  SF-RECORD-ID                       PIC XX.
  3008         88  VALID-CF-ID                        VALUE 'SF'.
  3009     12  SF-CONTROL-PRIMARY.
  3010         16  SF-COMPANY-ID                  PIC XXX.
  3011         16  SF-CARRIER-CODE                PIC X.
  3012         16  SF-GROUPING                    PIC X(6).
  3013         16  SF-STATE-CODE                  PIC XX.
  3014         16  SF-EXPIRE-DATE                 PIC 9(8).
  3015****************************************************************
  3016*             STATE CONTROLS
  3017****************************************************************
  3018     12  SF-LAST-MAINT-DT                   PIC XX.
  3019     12  SF-LAST-MAINT-BY                   PIC X(4).
  3020     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3021     12  SF-STATE-RT-CONTROLS.
  3022         16  SF-ST-RT-CALC                  PIC X.
  3023     12  SF-ST-TAX-CONTROLS.
  3024         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3025         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3026         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3027     12  SF-ST-REFUND-OPTIONS.
  3028         16  SF-ST-RF-LR-CALC               PIC X.
  3029         16  SF-ST-RF-LL-CALC               PIC X.
  3030         16  SF-ST-RF-LN-CALC               PIC X.
  3031         16  SF-ST-RF-AH-CALC               PIC X.
  3032         16  SF-ST-RF-CP-CALC               PIC X.
  3033     12  SF-ST-UNEARN-PREM-OPTIONS.
  3034         16  SF-ST-LUEP-R78                 PIC X.
  3035         16  SF-ST-LUEP-PRO                 PIC X.
  3036         16  SF-ST-LUEP-ST                  PIC X.
  3037         16  SF-ST-LUEP-DOM                 PIC X.
  3038         16  SF-ST-AUEP-R78                 PIC X.
  3039         16  SF-ST-AUEP-PRO                 PIC X.
  3040         16  SF-ST-AUEP-ST                  PIC X.
  3041         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  57
* EL050.cbl
  3042         16  SF-ST-CUEP-R78                 PIC X.
  3043         16  SF-ST-CUEP-PRO                 PIC X.
  3044         16  SF-ST-CUEP-ST                  PIC X.
  3045         16  SF-ST-CUEP-DOM                 PIC X.
  3046     12  SF-ST-EARN-PREM-OPTIONS.
  3047         16  SF-ST-LEP-R78                  PIC X.
  3048         16  SF-ST-LEP-PRO                  PIC X.
  3049         16  SF-ST-LEP-ST                   PIC X.
  3050         16  SF-ST-LEP-DOM                  PIC X.
  3051         16  SF-ST-AEP-R78                  PIC X.
  3052         16  SF-ST-AEP-PRO                  PIC X.
  3053         16  SF-ST-AEP-ST                   PIC X.
  3054         16  SF-ST-AEP-DOM                  PIC X.
  3055         16  SF-ST-CEP-R78                  PIC X.
  3056         16  SF-ST-CEP-PRO                  PIC X.
  3057         16  SF-ST-CEP-ST                   PIC X.
  3058         16  SF-ST-CEP-DOM                  PIC X.
  3059     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  58
* EL050.cbl
  3061*    COPY ELCCRTT.
  3062******************************************************************
  3063*                                                                *
  3064*                            ELCCRTT.                            *
  3065*                                                                *
  3066*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3067*                                                                *
  3068*   FILE TYPE = VSAM,KSDS                                        *
  3069*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3070*                                                                *
  3071*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3072*                                                                *
  3073*   LOG = YES                                                    *
  3074*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3075******************************************************************
  3076*                   C H A N G E   L O G
  3077*
  3078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3079*-----------------------------------------------------------------
  3080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3081* EFFECTIVE    NUMBER
  3082*-----------------------------------------------------------------
  3083* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3084* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3085* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3086* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3087* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3088* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3089* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3090* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3091* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3092* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3093* 091318  CR2018073000001  PEMA  ADD Refund methods
  3094* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3095******************************************************************
  3096
  3097 01  CERTIFICATE-TRAILERS.
  3098     12  CS-RECORD-ID                      PIC XX.
  3099         88  VALID-CS-ID                      VALUE 'CS'.
  3100
  3101     12  CS-CONTROL-PRIMARY.
  3102         16  CS-COMPANY-CD                 PIC X.
  3103         16  CS-CARRIER                    PIC X.
  3104         16  CS-GROUPING                   PIC X(6).
  3105         16  CS-STATE                      PIC XX.
  3106         16  CS-ACCOUNT                    PIC X(10).
  3107         16  CS-CERT-EFF-DT                PIC XX.
  3108         16  CS-CERT-NO.
  3109             20  CS-CERT-PRIME             PIC X(10).
  3110             20  CS-CERT-SFX               PIC X.
  3111         16  CS-TRAILER-TYPE               PIC X.
  3112             88  COMM-TRLR           VALUE 'A'.
  3113             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3114             88  CERT-DATA-TRLR      VALUE 'C'.
  3115
  3116     12  CS-DATA-AREA                      PIC X(516).
  3117
  3118     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  59
* EL050.cbl
  3119         16  CS-BANK-COMMISSION-AREA.
  3120             20  CS-BANK-COMMS       OCCURS 10.
  3121                 24  CS-AGT                PIC X(10).
  3122                 24  CS-COM-TYP            PIC X.
  3123                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3124                 24  CS-RECALC-LV-INDIC    PIC X.
  3125                 24  FILLER                PIC X(10).
  3126         16  FILLER                        PIC X(256).
  3127
  3128     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3129****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3130         16  CS-MB-CLAIM-DATA OCCURS 24.
  3131             20  CS-CLAIM-NO               PIC X(7).
  3132             20  CS-CLAIM-TYPE             PIC X.
  3133                 88  CS-AH-CLM               VALUE 'A'.
  3134                 88  CS-IU-CLM               VALUE 'I'.
  3135                 88  CS-GP-CLM               VALUE 'G'.
  3136                 88  CS-LF-CLM               VALUE 'L'.
  3137                 88  CS-PR-CLM               VALUE 'P'.
  3138                 88  CS-FL-CLM               VALUE 'F'.
  3139                 88  CS-OT-CLM               VALUE 'O'.
  3140             20  CS-INSURED-TYPE           PIC X.
  3141                 88  CS-PRIM-INSURED          VALUE 'P'.
  3142                 88  CS-CO-BORROWER           VALUE 'C'.
  3143             20  CS-BENEFIT-PERIOD         PIC 99.
  3144             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3145             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3146             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3147         16  FILLER                        PIC X(12).
  3148     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3149         16  CS-VIN-NUMBER                 PIC X(17).
  3150         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3151         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3152         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3153         16  cs-agent-name.
  3154             20  cs-agent-fname            pic x(20).
  3155             20  cs-agent-mi               pic x.
  3156             20  cs-agent-lname            pic x(25).
  3157         16  cs-license-no                 pic x(15).
  3158         16  cs-npn-number                 pic x(10).
  3159         16  cs-agent-edit-status          pic x.
  3160             88  cs-ae-refer-to-manager      value 'M'.
  3161             88  cs-ae-cover-sheet           value 'C'.
  3162             88  cs-ae-sig-form              value 'S'.
  3163             88  cs-ae-verified              value 'V'.
  3164             88  cs-unidentified-signature   value 'U'.
  3165             88  cs-cert-returned            value 'R'.
  3166             88  cs-accept-no-commission     value 'N'.
  3167         16  cs-year                       pic 9999.
  3168         16  cs-make                       pic x(20).
  3169         16  cs-model                      pic x(20).
  3170         16  cs-future                     pic x(20).
  3171         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3172         16  cs-claim-verification-status  pic x.
  3173             88  cs-clm-ver-eligible         value 'A'.
  3174             88  cs-clm-ver-partial-elig     value 'B'.
  3175             88  cs-clm-ver-not-eligible     value 'C'.
  3176             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  60
* EL050.cbl
  3177             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3178             88  cs-clm-ver-ND-CERT          value 'F'.
  3179             88  cs-clm-ver-spec-other       value 'G'.
  3180             88  cs-clam-ver-pratial-corrected
  3181                                             value 'H'.
  3182             88  cs-clm-ver-no-matches       value 'I'.
  3183             88  cs-clm-ver-not-elig-corrected
  3184                                             value 'J'.
  3185             88  cs-clm-ver-needs-review     value 'R'.
  3186             88  cs-clm-ver-sent-to-claims   value 'W'.
  3187         16  CS-LF-REFUND-METHOD           PIC X.
  3188         16  CS-AH-REFUND-METHOD           PIC X.
  3189         16  FILLER                        PIC X(353). *> was 420
  3190*        16  FILLER                        PIC X(496).
  3191*    COPY ELCCRTO.
  3192******************************************************************
  3193*                                                                *
  3194*                            ELCCRTO.                            *
  3195*                                                                *
  3196*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3197*                                                                *
  3198*   FILE TYPE = VSAM,KSDS                                        *
  3199*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3200*                                                                *
  3201*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3202*                                                                *
  3203*   LOG = YES                                                    *
  3204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3205******************************************************************
  3206*                   C H A N G E   L O G
  3207*
  3208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3209*-----------------------------------------------------------------
  3210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3211* EFFECTIVE    NUMBER
  3212*-----------------------------------------------------------------
  3213* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3214* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3215* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3216* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3217* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3218******************************************************************
  3219 01  ORIGINAL-CERTIFICATE.
  3220     12  OC-RECORD-ID                      PIC XX.
  3221         88  VALID-OC-ID                      VALUE 'OC'.
  3222     12  OC-CONTROL-PRIMARY.
  3223         16  OC-COMPANY-CD                 PIC X.
  3224         16  OC-CARRIER                    PIC X.
  3225         16  OC-GROUPING                   PIC X(6).
  3226         16  OC-STATE                      PIC XX.
  3227         16  OC-ACCOUNT                    PIC X(10).
  3228         16  OC-CERT-EFF-DT                PIC XX.
  3229         16  OC-CERT-NO.
  3230             20  OC-CERT-PRIME             PIC X(10).
  3231             20  OC-CERT-SFX               PIC X.
  3232         16  OC-RECORD-TYPE                PIC X.
  3233         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3234     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  61
* EL050.cbl
  3235     12  OC-LAST-MAINT-BY                  PIC X(4).
  3236     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3237     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3238     12  FILLER                            PIC X(49).
  3239     12  OC-ORIG-REC.
  3240         16  OC-INS-LAST-NAME              PIC X(15).
  3241         16  OC-INS-FIRST-NAME             PIC X(10).
  3242         16  OC-INS-MIDDLE-INIT            PIC X.
  3243         16  OC-INS-AGE                    PIC S999     COMP-3.
  3244         16  OC-JNT-LAST-NAME              PIC X(15).
  3245         16  OC-JNT-FIRST-NAME             PIC X(10).
  3246         16  OC-JNT-MIDDLE-INIT            PIC X.
  3247         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3248         16  OC-LF-BENCD                   PIC XX.
  3249         16  OC-LF-TERM                    PIC S999      COMP-3.
  3250         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3251         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3252         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3253         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3254         16  OC-LF-EXP-DT                  PIC XX.
  3255         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3256         16  OC-LF-CANCEL-DT               PIC XX.
  3257         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3258         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3259         16  OC-AH-BENCD                   PIC XX.
  3260         16  OC-AH-TERM                    PIC S999      COMP-3.
  3261         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3262         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3263         16  OC-AH-EXP-DT                  PIC XX.
  3264         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3265         16  OC-AH-CP                      PIC 99.
  3266         16  OC-AH-CANCEL-DT               PIC XX.
  3267         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3268         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3269         16  OC-CRED-BENE-NAME             PIC X(25).
  3270         16  OC-1ST-PMT-DT                 PIC XX.
  3271         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3272         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3273         16  OC-ISSUE-TRAN-IND             PIC X.
  3274         16  OC-CANCEL-TRAN-IND            PIC X.
  3275         16  FILLER                        PIC X(211).
  3276
  3277     12  FILLER                            PIC X(50).
  3278******************************************************************
  3279
  3280*    COPY ELCDATE.
  3281******************************************************************
  3282*                                                                *
  3283*                                                                *
  3284*                            ELCDATE.                            *
  3285*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3286*                            VMOD=2.003
  3287*                                                                *
  3288*                                                                *
  3289*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3290*                 LENGTH = 200                                   *
  3291******************************************************************
  3292
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  62
* EL050.cbl
  3293 01  DATE-CONVERSION-DATA.
  3294     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3295     12  DC-OPTION-CODE                PIC X.
  3296         88  BIN-TO-GREG                VALUE ' '.
  3297         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3298         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3299         88  YMD-GREG-TO-BIN            VALUE '3'.
  3300         88  MDY-GREG-TO-BIN            VALUE '4'.
  3301         88  JULIAN-TO-BIN              VALUE '5'.
  3302         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3303         88  FIND-CENTURY               VALUE '7'.
  3304         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3305         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3306         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3307         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3308         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3309         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3310         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3311         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3312         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3313         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3314         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3315         88  BIN-3-TO-GREG              VALUE 'I'.
  3316         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3317         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3318         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3319         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3320         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3321         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3322         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3323         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3324         88  THREE-CHARACTER-BIN
  3325                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3326         88  GREGORIAN-TO-BIN
  3327                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3328         88  BIN-TO-GREGORIAN
  3329                  VALUES ' ' '1' 'I' '8' 'G'.
  3330         88  JULIAN-TO-BINARY
  3331                  VALUES '5' 'C' 'E' 'F'.
  3332     12  DC-ERROR-CODE                 PIC X.
  3333         88  NO-CONVERSION-ERROR        VALUE ' '.
  3334         88  DATE-CONVERSION-ERROR
  3335                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3336         88  DATE-IS-ZERO               VALUE '1'.
  3337         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3338         88  DATE-IS-INVALID            VALUE '3'.
  3339         88  DATE1-GREATER-DATE2        VALUE '4'.
  3340         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3341         88  DATE-INVALID-OPTION        VALUE '9'.
  3342         88  INVALID-CENTURY            VALUE 'A'.
  3343         88  ONLY-CENTURY               VALUE 'B'.
  3344         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3345         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3346     12  DC-END-OF-MONTH               PIC X.
  3347         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3348     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3349         88  USE-NORMAL-PROCESS         VALUE ' '.
  3350         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  63
* EL050.cbl
  3351         88  ADJUST-UP-100-YRS          VALUE '2'.
  3352     12  FILLER                        PIC X.
  3353     12  DC-CONVERSION-DATES.
  3354         16  DC-BIN-DATE-1             PIC XX.
  3355         16  DC-BIN-DATE-2             PIC XX.
  3356         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3357         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3358                       DC-GREG-DATE-1-EDIT.
  3359             20  DC-EDIT1-MONTH        PIC 99.
  3360             20  SLASH1-1              PIC X.
  3361             20  DC-EDIT1-DAY          PIC 99.
  3362             20  SLASH1-2              PIC X.
  3363             20  DC-EDIT1-YEAR         PIC 99.
  3364         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3365         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3366                     DC-GREG-DATE-2-EDIT.
  3367             20  DC-EDIT2-MONTH        PIC 99.
  3368             20  SLASH2-1              PIC X.
  3369             20  DC-EDIT2-DAY          PIC 99.
  3370             20  SLASH2-2              PIC X.
  3371             20  DC-EDIT2-YEAR         PIC 99.
  3372         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3373         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3374                     DC-GREG-DATE-1-YMD.
  3375             20  DC-YMD-YEAR           PIC 99.
  3376             20  DC-YMD-MONTH          PIC 99.
  3377             20  DC-YMD-DAY            PIC 99.
  3378         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3379         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3380                      DC-GREG-DATE-1-MDY.
  3381             20  DC-MDY-MONTH          PIC 99.
  3382             20  DC-MDY-DAY            PIC 99.
  3383             20  DC-MDY-YEAR           PIC 99.
  3384         16  DC-GREG-DATE-1-ALPHA.
  3385             20  DC-ALPHA-MONTH        PIC X(10).
  3386             20  DC-ALPHA-DAY          PIC 99.
  3387             20  FILLER                PIC XX.
  3388             20  DC-ALPHA-CENTURY.
  3389                 24 DC-ALPHA-CEN-N     PIC 99.
  3390             20  DC-ALPHA-YEAR         PIC 99.
  3391         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3392         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3393         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3394         16  DC-JULIAN-DATE            PIC 9(05).
  3395         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3396                                       PIC 9(05).
  3397         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3398             20  DC-JULIAN-YEAR        PIC 99.
  3399             20  DC-JULIAN-DAYS        PIC 999.
  3400         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3401         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3402         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3403     12  DATE-CONVERSION-VARIBLES.
  3404         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3405         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3406             20  FILLER                PIC 9(3).
  3407             20  HOLD-CEN-1-CCYY.
  3408                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  64
* EL050.cbl
  3409                 24  HOLD-CEN-1-YY     PIC 99.
  3410             20  HOLD-CEN-1-MO         PIC 99.
  3411             20  HOLD-CEN-1-DA         PIC 99.
  3412         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3413             20  HOLD-CEN-1-R-MO       PIC 99.
  3414             20  HOLD-CEN-1-R-DA       PIC 99.
  3415             20  HOLD-CEN-1-R-CCYY.
  3416                 24  HOLD-CEN-1-R-CC   PIC 99.
  3417                 24  HOLD-CEN-1-R-YY   PIC 99.
  3418             20  FILLER                PIC 9(3).
  3419         16  HOLD-CENTURY-1-X.
  3420             20  FILLER                PIC X(3)  VALUE SPACES.
  3421             20  HOLD-CEN-1-X-CCYY.
  3422                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3423                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3424             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3425             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3426         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3427             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3428             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3429             20  HOLD-CEN-1-R-X-CCYY.
  3430                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3431                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3432             20  FILLER                PIC XXX.
  3433         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3434         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3435         16  DC-JULIAN-DATE-1          PIC 9(07).
  3436         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3437             20  DC-JULIAN-1-CCYY.
  3438                 24  DC-JULIAN-1-CC    PIC 99.
  3439                 24  DC-JULIAN-1-YR    PIC 99.
  3440             20  DC-JULIAN-DA-1        PIC 999.
  3441         16  DC-JULIAN-DATE-2          PIC 9(07).
  3442         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3443             20  DC-JULIAN-2-CCYY.
  3444                 24  DC-JULIAN-2-CC    PIC 99.
  3445                 24  DC-JULIAN-2-YR    PIC 99.
  3446             20  DC-JULIAN-DA-2        PIC 999.
  3447         16  DC-GREG-DATE-A-EDIT.
  3448             20  DC-EDITA-MONTH        PIC 99.
  3449             20  SLASHA-1              PIC X VALUE '/'.
  3450             20  DC-EDITA-DAY          PIC 99.
  3451             20  SLASHA-2              PIC X VALUE '/'.
  3452             20  DC-EDITA-CCYY.
  3453                 24  DC-EDITA-CENT     PIC 99.
  3454                 24  DC-EDITA-YEAR     PIC 99.
  3455         16  DC-GREG-DATE-B-EDIT.
  3456             20  DC-EDITB-MONTH        PIC 99.
  3457             20  SLASHB-1              PIC X VALUE '/'.
  3458             20  DC-EDITB-DAY          PIC 99.
  3459             20  SLASHB-2              PIC X VALUE '/'.
  3460             20  DC-EDITB-CCYY.
  3461                 24  DC-EDITB-CENT     PIC 99.
  3462                 24  DC-EDITB-YEAR     PIC 99.
  3463         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3464         16  DC-GREG-DATE-CYMD-R REDEFINES
  3465                              DC-GREG-DATE-CYMD.
  3466             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  65
* EL050.cbl
  3467             20  DC-CYMD-YEAR          PIC 99.
  3468             20  DC-CYMD-MONTH         PIC 99.
  3469             20  DC-CYMD-DAY           PIC 99.
  3470         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3471         16  DC-GREG-DATE-MDCY-R REDEFINES
  3472                              DC-GREG-DATE-MDCY.
  3473             20  DC-MDCY-MONTH         PIC 99.
  3474             20  DC-MDCY-DAY           PIC 99.
  3475             20  DC-MDCY-CEN           PIC 99.
  3476             20  DC-MDCY-YEAR          PIC 99.
  3477    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3478        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3479    12  DC-EL310-DATE                  PIC X(21).
  3480    12  FILLER                         PIC X(28).
  3481
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  66
* EL050.cbl
  3483*    COPY ELCCALC.
  3484******************************************************************
  3485*                                                                *
  3486*                           ELCCALC.                            *
  3487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3488*                            VMOD=2.025                          *
  3489*                                                                *
  3490*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3491*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3492*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3493*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3494*                                                                *
  3495*  PASSED TO ELRTRM                                              *
  3496*  -----------------                                             *
  3497*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3498*  ORIGINAL TERM                                                 *
  3499*  BEGINNING DATE                                                *
  3500*  ENDING DATE                                                   *
  3501*  COMPANY I.D.                                                  *
  3502*  ACCOUNT MASTER USER FIELD                                     *
  3503*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3504*  FREE LOOK DAYS                                                *
  3505*                                                                *
  3506*  RETURNED FROM ELRTRM                                          *
  3507*  ---------------------                                         *
  3508*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3509*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3510*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3511*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3512*----------------------------------------------------------------*
  3513*  PASSED TO ELRAMT                                              *
  3514*  ----------------                                              *
  3515*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3516*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3517*  ORIGINAL AMOUNT                                               *
  3518*  ALTERNATE BENEFIT (BALLON)                                    *
  3519*  A.P.R. - NET PAY ONLY                                         *
  3520*  METHOD
  3521*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3522*  COMPANY I.D.                                                  *
  3523*  BENEFIT TYPE                                                  *
  3524*                                                                *
  3525*  RETURNED FROM ELRAMT                                          *
  3526*  --------------------                                          *
  3527*  REMAINING AMOUNT 1 - CURRENT                                  *
  3528*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3529*  REMAINING AMOUNT FACTOR
  3530*----------------------------------------------------------------*
  3531*  PASSED TO ELRESV                                              *
  3532*  -----------------                                             *
  3533*  CERTIFICATE EFFECTIVE DATE                                    *
  3534*  VALUATION DATE                                                *
  3535*  PAID THRU DATE                                                *
  3536*  BENEFIT                                                       *
  3537*  INCURRED DATE                                                 *
  3538*  REPORTED DATE                                                 *
  3539*  ISSUE AGE                                                     *
  3540*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  67
* EL050.cbl
  3541*  CDT PERCENT                                                   *
  3542*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3543* *CLAIM TYPE (LIFE, A/H)                                        *
  3544* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3545* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3546*                                                                *
  3547*  RETURNED FROM ELRESV                                          *
  3548*  --------------------                                          *
  3549*  CDT TABLE USED                                                *
  3550*  CDT FACTOR USED                                               *
  3551*  PAY TO CURRENT RESERVE                                        *
  3552*  I.B.N.R. - A/H ONLY                                           *
  3553*  FUTURE (ACCRUED) AH ONLY                                      *
  3554*----------------------------------------------------------------*
  3555*  PASSED TO ELRATE                                              *
  3556*  ----------------                                              *
  3557*  CERT ISSUE DATE                                               *
  3558*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3559*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3560*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3561*  STATE CODE (CLIENT DEFINED)                                   *
  3562*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3563*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3564*  DEVIATION CODE                                                *
  3565*  ISSUE AGE                                                     *
  3566*  ORIGINAL BENEFIT AMOUNT                                       *
  3567*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3568*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3569*  BENEFIT KIND (LIFE OR A/H)                                    *
  3570*  A.P.R.                                                        *
  3571*  METHOD
  3572*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3573*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3574*  COMPANY I.D. (3 CHARACTER)                                    *
  3575*  BENEFIT CODE                                                  *
  3576*  BENEFIT OVERRIDE CODE                                         *
  3577*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3578*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3579*  JOINT INDICATOR (CSL ONLY)                                    *
  3580*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3581*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3582*                                                                *
  3583*  RETURNED FROM ELRATE                                          *
  3584*  --------------------                                          *
  3585*  CALCULATED PREMIUM                                            *
  3586*  PREMIUM RATE                                                  *
  3587*  MORTALITY CODE                                                *
  3588*  MAX ATTAINED AGE                                              *
  3589*  MAX AGE                                                       *
  3590*  MAX TERM                                                      *
  3591*  MAX MONTHLY BENEFIT                                           *
  3592*  MAX TOTAL BENIFIT                                             *
  3593*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3594*----------------------------------------------------------------*
  3595*  PASSED TO ELRFND                                              *
  3596*  ----------------                                              *
  3597*  CERT ISSUE DATE                                               *
  3598*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  68
* EL050.cbl
  3599*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3600*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3601*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3602*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3603*  STATE CODE (CLIENT DEFINED)                                   *
  3604*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3605*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3606*  DEVIATION CODE                                                *
  3607*  ISSUE AGE                                                     *
  3608*  ORIGINAL BENEFIT AMOUNT                                       *
  3609*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3610*  PROCESS TYPE (CANCEL)                                         *
  3611*  BENEFIT KIND (LIFE OR A/H)                                    *
  3612*  A.P.R.                                                        *
  3613*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3614*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3615*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3616*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3617*  COMPANY I.D. (3 CHARACTER)                                    *
  3618*  BENEFIT CODE                                                  *
  3619*  BENEFIT OVERRIDE CODE                                         *
  3620*                                                                *
  3621*  RETURNED FROM ELRFND                                          *
  3622*  --------------------                                          *
  3623*  CALCULATED REFUND                                             *
  3624*----------------------------------------------------------------*
  3625*  PASSED TO ELEARN                                              *
  3626*  ----------------                                              *
  3627*  CERT ISSUE DATE                                               *
  3628*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3629*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3630*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3631*  STATE CODE (CLIENT DEFINED)                                   *
  3632*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3633*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3634*  DEVIATION CODE                                                *
  3635*  ISSUE AGE                                                     *
  3636*  ORIGINAL BENEFIT AMOUNT                                       *
  3637*  BENEFIT KIND (LIFE OR A/H)                                    *
  3638*  A.P.R.                                                        *
  3639*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3640*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3641*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3642*  COMPANY I.D. (3 CHARACTER)                                    *
  3643*  BENEFIT CODE                                                  *
  3644*  BENEFIT OVERRIDE CODE                                         *
  3645*                                                                *
  3646*  RETURNED FROM ELEARN                                          *
  3647*  --------------------                                          *
  3648*  INDICATED  EARNINGS                                           *
  3649*----------------------------------------------------------------*
  3650*                 LENGTH = 450                                   *
  3651*                                                                *
  3652******************************************************************
  3653******************************************************************
  3654*                   C H A N G E   L O G
  3655*
  3656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  69
* EL050.cbl
  3657*-----------------------------------------------------------------
  3658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3659* EFFECTIVE    NUMBER
  3660*-----------------------------------------------------------------
  3661* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3662* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3663* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3664* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3665* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3666* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3667* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3668* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3669* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3670* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3671* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3672* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3673******************************************************************
  3674
  3675 01  CALCULATION-PASS-AREA.
  3676     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3677                                     COMP.
  3678
  3679     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3680       88  NO-CP-ERROR                             VALUE ZERO.
  3681       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3682                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3683       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3684       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3685       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3686       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3687       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3688       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3689       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3690       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3691       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3692       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3693       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3694       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3695       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3696       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3697       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3698       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3699       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3700       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3701
  3702     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3703       88  NO-CP-ERROR-2                           VALUE ZERO.
  3704***********************  INPUT AREAS ****************************
  3705
  3706     12  CP-CALCULATION-AREA.
  3707         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3708         16  CP-CERT-EFF-DT        PIC XX.
  3709         16  CP-VALUATION-DT       PIC XX.
  3710         16  CP-PAID-THRU-DT       PIC XX.
  3711         16  CP-BENEFIT-TYPE       PIC X.
  3712           88  CP-AH                               VALUE 'A' 'D'
  3713                                                   'I' 'U'.
  3714           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  70
* EL050.cbl
  3715           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3716         16  CP-INCURRED-DT        PIC XX.
  3717         16  CP-REPORTED-DT        PIC XX.
  3718         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3719         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3720         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3721                                     COMP-3.
  3722         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-CDT-METHOD         PIC X.
  3725           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3726           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3727           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3728         16  CP-CLAIM-TYPE         PIC X.
  3729           88  CP-AH-CLAIM                         VALUE 'A'.
  3730           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3731         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-REM-TERM-METHOD    PIC X.
  3746           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3747           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3748           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3749           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3750           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3751           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3752           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3753         16  CP-EARNING-METHOD     PIC X.
  3754           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3755           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3756           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3757           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3758           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3759           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3760           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3761           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3762           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3763           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3764           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3765           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3766           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3767           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3768         16  CP-PROCESS-TYPE       PIC X.
  3769           88  CP-CLAIM                            VALUE '1'.
  3770           88  CP-CANCEL                           VALUE '2'.
  3771           88  CP-ISSUE                            VALUE '3'.
  3772         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  71
* EL050.cbl
  3773           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3774           88  CP-1-MTH-INTEREST               VALUE ' '.
  3775           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3776           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3777           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3778           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3779           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3780           88  CP-FARM-PLAN                    VALUE 'F'.
  3781           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3782           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3783           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3784           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3785           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3786           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3787           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3788           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3789           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3790           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3791                                                     'W' 'X'.
  3792           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3793           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3794           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3795           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3796           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3797           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3798           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3799           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3800           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3801           88  CP-CSL-METH-1                   VALUE '5'.
  3802           88  CP-CSL-METH-2                   VALUE '6'.
  3803           88  CP-CSL-METH-3                   VALUE '7'.
  3804           88  CP-CSL-METH-4                   VALUE '8'.
  3805
  3806         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3807                                     COMP-3.
  3808         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3809         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3810         16  CP-STATE              PIC XX          VALUE SPACE.
  3811         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3812         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3813           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3814               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3815         16  CP-R78-OPTION         PIC X.
  3816           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3817           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3818
  3819         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3820         16  CP-IBNR-RESERVE-SW    PIC X.
  3821         16  CP-CLAIM-STATUS       PIC X.
  3822         16  CP-RATE-FILE          PIC X.
  3823         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3824                                     COMP-3.
  3825
  3826         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3827         16  CP-AH-OVERRIDE-CODE   PIC X.
  3828
  3829         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3830                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  72
* EL050.cbl
  3831         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3832                                   PIC S9(5)V99 COMP-3.
  3833         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3834                                     COMP-3.
  3835         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3840                                  PIC S9(7)V99 COMP-3.
  3841
  3842         16  CP-PAID-FROM-DATE     PIC X(02).
  3843         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3844         16  CP-EXT-DAYS-CALC      PIC X.
  3845           88  CP-EXT-NO-CHG                   VALUE ' '.
  3846           88  CP-EXT-CHG-LF                   VALUE '1'.
  3847           88  CP-EXT-CHG-AH                   VALUE '2'.
  3848           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3849         16  CP-DOMICILE-STATE     PIC XX.
  3850         16  CP-CARRIER            PIC X.
  3851         16  CP-REIN-FLAG          PIC X.
  3852         16  CP-REM-TRM-CALC-OPTION PIC X.
  3853           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3854                      '2' '3' '4' '5'.
  3855           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3856           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3857           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3858           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3859           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3860           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3861           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3862           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3863         16  CP-SIG-SWITCH         PIC X.
  3864         16  CP-RATING-METHOD      PIC X.
  3865           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3866           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3867           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3868           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3869           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3870           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3871           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3872           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3873           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3874         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3875                                     COMP-3.
  3876         16  CP-BEN-CATEGORY       PIC X.
  3877         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3878         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3879                                   PIC S99V9(5) COMP-3.
  3880         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3881         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3882                                   PIC S99V9(5) COMP-3.
  3883         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3884         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3885         16  CP-EXPIRE-DT          PIC XX.
  3886         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3887         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3888         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  73
* EL050.cbl
  3889         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3890         16  CP-DDF-SPEC-CALC      PIC X.
  3891             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3892             88  CP-CALC-CLP              VALUE 'C'.
  3893         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3894         16  CP-CANCEL-REASON      PIC X.
  3895         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3896         16  CP-PMT-MODE           PIC X.
  3897         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3898         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3899         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3900         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3901         16  FILLER                PIC X.
  3902
  3903***************    OUTPUT FROM ELRESV   ************************
  3904
  3905         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3906
  3907         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3914                                     COMP-3.
  3915         16  FILLER                PIC X(09).
  3916***************    OUTPUT FROM ELRTRM   *************************
  3917
  3918         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3923                                     COMP-3.
  3924         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3925                                     COMP-3.
  3926         16  FILLER                PIC X(12).
  3927
  3928***************    OUTPUT FROM ELRAMT   *************************
  3929
  3930         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3931                                     COMP-3.
  3932         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  FILLER                PIC X(12).
  3935
  3936***************    OUTPUT FROM ELRATE   *************************
  3937
  3938         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-MORTALITY-CODE     PIC X(4).
  3943         16  CP-RATE-EDIT-FLAG     PIC X.
  3944             88  CP-RATES-NEED-APR                  VALUE '1'.
  3945         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3946                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  74
* EL050.cbl
  3947         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3948         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3949         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3950                                   PIC S9(7)V99 COMP-3.
  3951         16  FILLER                PIC X(07).
  3952
  3953***************    OUTPUT FROM ELRFND   *************************
  3954
  3955         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3956                                     COMP-3.
  3957         16  CP-REFUND-TYPE-USED   PIC X.
  3958           88  CP-R-AS-R78                         VALUE '1'.
  3959           88  CP-R-AS-PRORATA                     VALUE '2'.
  3960           88  CP-R-AS-CALIF                       VALUE '3'.
  3961           88  CP-R-AS-TEXAS                       VALUE '4'.
  3962           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3963           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3964           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3965           88  CP-R-AS-MEAN                        VALUE '8'.
  3966           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3967           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3968           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3969           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3970           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3971           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3972         16  FILLER                PIC X(12).
  3973
  3974***************    OUTPUT FROM ELEARN   *************************
  3975
  3976         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3977                                     COMP-3.
  3978         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3981                                     COMP-3.
  3982         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3983                                     COMP-3.
  3984         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3985                                     COMP-3.
  3986         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3987                                     COMP-3.
  3988         16  CP-EARNING-TYPE-USED  PIC X.
  3989           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3990           88  CP-E-AS-R78                         VALUE '1'.
  3991           88  CP-E-AS-PRORATA                     VALUE '2'.
  3992           88  CP-E-AS-TEXAS                       VALUE '4'.
  3993           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3994           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3995           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3996           88  CP-E-AS-MEAN                        VALUE '8'.
  3997           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3998         16  FILLER                PIC X(12).
  3999
  4000***************    OUTPUT FROM ELPMNT   *************************
  4001
  4002         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4003                                     COMP-3.
  4004         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  75
* EL050.cbl
  4005                                     COMP-3.
  4006         16  FILLER                PIC X(12).
  4007
  4008***************   MISC WORK AREAS    *****************************
  4009         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4010                                     COMP-3.
  4011         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4014                                     COMP-3.
  4015         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4016                                     COMP-3.
  4017         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4018                                     COMP-3.
  4019         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4022             88  OPEN-RATE-FILE                   VALUE 'O'.
  4023             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4024             88  IO-ERROR                         VALUE 'E'.
  4025
  4026         16  CP-FIRST-PAY-DATE     PIC XX.
  4027
  4028         16  CP-JOINT-INDICATOR    PIC X.
  4029
  4030         16  CP-RESERVE-REMAINING-TERM
  4031                                   PIC S9(4)V9    VALUE ZERO
  4032                                     COMP-3.
  4033
  4034         16  CP-INSURED-BIRTH-DT   PIC XX.
  4035
  4036         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4037                                     COMP-3.
  4038
  4039         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4040                                     COMP-3.
  4041
  4042         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4043                                     COMP-3.
  4044
  4045         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4046                                     COMP-3.
  4047
  4048         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4049                                     COMP-3.
  4050
  4051         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4052                                     COMP-3.
  4053
  4054         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4055                                     COMP-3.
  4056
  4057         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4058             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4059
  4060         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4061                                     COMP-3.
  4062         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  76
* EL050.cbl
  4063                                     COMP-3.
  4064         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4065         16  cp-extra-periods      pic 9 value zeros.
  4066         16  cp-net-only-state     pic x value spaces.
  4067         16  FILLER                PIC X(13).
  4068******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  77
* EL050.cbl
  4070******************************************************************
  4071*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4072*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4073*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4074*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4075*** MODIFICATION.                                              ***
  4076*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4077*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4078******************************************************************
  4079*    COPY ERCPNDB.
  4080******************************************************************
  4081*                                                                *
  4082*                                                                *
  4083*                            ERCPNDB.                            *
  4084*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4085*                            VMOD=2.025                          *
  4086*                                                                *
  4087*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4088*                                                                *
  4089******************************************************************
  4090*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4091*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4092******************************************************************
  4093*                                                                *
  4094*                                                                *
  4095*   FILE TYPE = VSAM,KSDS                                        *
  4096*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4097*                                                                *
  4098*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4099*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4100*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4101*                                                 RKP=13,LEN=36  *
  4102*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4103*                                      AND CHG-SEQ.)             *
  4104*                                                RKP=49,LEN=11   *
  4105*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4106*                                      AND CHG-SEQ.)             *
  4107*                                                RKP=60,LEN=15   *
  4108*                                                                *
  4109*   LOG = NO                                                     *
  4110*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4111******************************************************************
  4112******************************************************************
  4113*                   C H A N G E   L O G
  4114*
  4115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4116*-----------------------------------------------------------------
  4117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4118* EFFECTIVE    NUMBER
  4119*-----------------------------------------------------------------
  4120* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4121* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4122* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4123* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4124* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4125* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4126* 032306                   PEMA  ADD BOW LOAN NUMBER
  4127* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  78
* EL050.cbl
  4128* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4129* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4130* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4131* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4132* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4133* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4134* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4135* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4136* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4137* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4138* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4139* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4140******************************************************************
  4141
  4142 01  PENDING-BUSINESS.
  4143     12  PB-RECORD-ID                     PIC XX.
  4144         88  VALID-PB-ID                        VALUE 'PB'.
  4145
  4146     12  PB-CONTROL-PRIMARY.
  4147         16  PB-COMPANY-CD                PIC X.
  4148         16  PB-ENTRY-BATCH               PIC X(6).
  4149         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4150         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4151
  4152     12  PB-CONTROL-BY-ACCOUNT.
  4153         16  PB-COMPANY-CD-A1             PIC X.
  4154         16  PB-CARRIER                   PIC X.
  4155         16  PB-GROUPING.
  4156             20  PB-GROUPING-PREFIX       PIC XXX.
  4157             20  PB-GROUPING-PRIME        PIC XXX.
  4158         16  PB-STATE                     PIC XX.
  4159         16  PB-ACCOUNT.
  4160             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4161             20  PB-ACCOUNT-PRIME         PIC X(6).
  4162         16  PB-CERT-EFF-DT               PIC XX.
  4163         16  PB-CERT-NO.
  4164             20  PB-CERT-PRIME            PIC X(10).
  4165             20  PB-CERT-SFX              PIC X.
  4166         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4167
  4168         16  PB-RECORD-TYPE               PIC X.
  4169             88  PB-MAILING-DATA                VALUE '0'.
  4170             88  PB-ISSUE                       VALUE '1'.
  4171             88  PB-CANCELLATION                VALUE '2'.
  4172             88  PB-BATCH-TRAILER               VALUE '9'.
  4173
  4174     12  PB-CONTROL-BY-ORIG-BATCH.
  4175         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4176         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4177         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4178         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4179
  4180     12  PB-CONTROL-BY-CSR.
  4181         16  PB-CSR-COMPANY-CD            PIC X.
  4182         16  PB-CSR-ID                    PIC X(4).
  4183         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4184         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4185         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  79
* EL050.cbl
  4186******************************************************************
  4187*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4188******************************************************************
  4189
  4190     12  PB-LAST-MAINT-DT                 PIC XX.
  4191     12  PB-LAST-MAINT-BY                 PIC X(4).
  4192     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4193
  4194     12  PB-RECORD-BODY                   PIC X(375).
  4195
  4196     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4197         16  PB-CERT-ORIGIN               PIC X.
  4198             88  CLASIC-CREATED-CERT         VALUE '1'.
  4199         16  PB-I-NAME.
  4200             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4201             20  PB-I-INSURED-FIRST-NAME.
  4202                 24  PB-I-INSURED-1ST-INIT PIC X.
  4203                 24  FILLER                PIC X(9).
  4204             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4205         16  PB-I-AGE                     PIC S99   COMP-3.
  4206         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4207         16  PB-I-BIRTHDAY                PIC XX.
  4208         16  PB-I-INSURED-SEX             PIC X.
  4209             88  PB-SEX-MALE     VALUE 'M'.
  4210             88  PB-SEX-FEMALE   VALUE 'F'.
  4211
  4212         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4213         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4214         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4215         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4216         16  PB-I-SKIP-CODE               PIC X.
  4217             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4218             88  PB-SKIP-JULY              VALUE '1'.
  4219             88  PB-SKIP-AUGUST            VALUE '2'.
  4220             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4221             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4222             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4223             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4224             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4225             88  PB-SKIP-JUNE              VALUE '8'.
  4226             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4227             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4228             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4229         16  PB-I-TERM-TYPE               PIC X.
  4230             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4231             88  PB-PAID-WEEKLY            VALUE 'W'.
  4232             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4233             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4234             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4235         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4236         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4237         16  PB-I-DATA-ENTRY-SW           PIC X.
  4238             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4239             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4240             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4241             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4242         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4243         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  80
* EL050.cbl
  4244*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4245         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4246         16  PB-I-LETTER-REQD             PIC X.
  4247
  4248         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4249             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4250             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4251                                                   '90' THRU '99'.
  4252         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4253                                          PIC XX.
  4254         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4255         16  PB-I-AMOUNT-FINANCED REDEFINES
  4256                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4257         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4258         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4259                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4260         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4261         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4262         16  PB-I-CLP-AMOUNT REDEFINES
  4263                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4264         16  PB-I-LF-CALC-FLAG            PIC X.
  4265             88 PB-COMP-LF-PREM               VALUE '?'.
  4266         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4267         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4268         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4269         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4270         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4271         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4272         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4273         16  PB-I-LF-ABBR                 PIC XXX.
  4274         16  PB-I-LF-INPUT-CD             PIC XX.
  4275
  4276         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4277             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4278             88  PB-INVALID-AH               VALUE '  ' '00'
  4279                                                   '90' THRU '99'.
  4280         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4281         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4282         16  PB-I-AH-CALC-FLAG            PIC X.
  4283             88 PB-COMP-AH-PREM                  VALUE '?'.
  4284         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4285         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4286         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4287         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4288         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4289         16  PB-I-AH-ABBR                 PIC XXX.
  4290         16  PB-I-AH-INPUT-CD             PIC XXX.
  4291
  4292         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4293         16  PB-I-REIN-TABLE              PIC XXX.
  4294         16  PB-I-BUSINESS-TYPE           PIC 99.
  4295         16  PB-I-INDV-GRP-CD             PIC X.
  4296         16  PB-I-MORT-CODE.
  4297             20  PB-I-TABLE               PIC X.
  4298             20  PB-I-INTEREST            PIC XX.
  4299             20  PB-I-MORT-TYP            PIC X.
  4300         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4301         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  81
* EL050.cbl
  4302         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4303         16  PB-I-INDV-GRP-OVRD           PIC X.
  4304         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4305         16  PB-I-SIG-SW                  PIC X.
  4306             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4307         16  PB-I-RATE-CLASS              PIC XX.
  4308         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4309         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4310         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4311         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4312         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4313         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4314         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4315         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4316         16  PB-I-OB-FLAG                 PIC X.
  4317             88  PB-I-OB                      VALUE 'B'.
  4318             88  PB-I-SUMMARY                 VALUE 'Z'.
  4319         16  PB-I-ENTRY-STATUS            PIC X.
  4320             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4321                                              'M' '5' '9' '2'.
  4322             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4323             88  PB-I-POLICY-PENDING          VALUE '2'.
  4324             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4325             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4326             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4327             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4328             88  PB-I-REIN-ONLY               VALUE '9'.
  4329             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4330             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4331             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4332             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4333         16  PB-I-INT-CODE                PIC X.
  4334             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4335             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4336         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4337         16  PB-I-SOC-SEC-NO              PIC X(11).
  4338         16  PB-I-MEMBER-NO               PIC X(12).
  4339         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4340*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4341         16  PB-I-OLD-LOF                 PIC XXX.
  4342         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4343         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4344         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4345         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4346         16  PB-I-LIFE-INDICATOR          PIC X.
  4347             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4348         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4349         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4350                                          PIC S9(5)V99    COMP-3.
  4351         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4352             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4353             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4354         16  PB-I-1ST-PMT-DT              PIC XX.
  4355         16  PB-I-JOINT-INSURED.
  4356             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4357             20 PB-I-JOINT-FIRST-NAME.
  4358                24  PB-I-JOINT-FIRST-INIT PIC X.
  4359                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  82
* EL050.cbl
  4360             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4361*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4362         16  PB-I-BENEFICIARY-NAME.
  4363             20  PB-I-BANK-NUMBER         PIC X(10).
  4364             20  FILLER                   PIC X(15).
  4365         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4366         16  PB-I-REFERENCE               PIC X(12).
  4367         16  FILLER REDEFINES PB-I-REFERENCE.
  4368             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4369             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4370             20  PB-I-CLP-STATE           PIC XX.
  4371         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4372             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4373             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4374             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4375         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4376         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4377         16  PB-I-RESIDENT-STATE          PIC XX.
  4378         16  PB-I-RATE-CODE               PIC X(4).
  4379         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4380         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4381         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4382         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4383         16  PB-I-BANK-NOCHRGB            PIC 99.
  4384         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4385         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4386
  4387     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4388         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4389             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4390         16  PB-C-CANCEL-ORIGIN           PIC X.
  4391             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4392         16  PB-C-LF-CANCEL-DT            PIC XX.
  4393         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4394         16  PB-C-LF-CALC-REQ             PIC X.
  4395             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4396         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4397         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4398         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4399             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4400         16  PB-C-AH-CANCEL-DT            PIC XX.
  4401         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4402         16  PB-C-AH-CALC-REQ             PIC X.
  4403             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4404         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4405         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4406         16  PB-C-LAST-NAME               PIC X(15).
  4407         16  PB-C-REFUND-SW               PIC X.
  4408             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4409             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4410         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4411         16  PB-C-PAYEE-CODE              PIC X(6).
  4412         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4413         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4414         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4415         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4416         16  PB-C-REFERENCE               PIC X(12).
  4417         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  83
* EL050.cbl
  4418         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4419         16  PB-C-POST-CARD-IND           PIC X.
  4420         16  PB-C-CANCEL-REASON           PIC X.
  4421         16  PB-C-REF-INTERFACE-SW        PIC X.
  4422         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4423         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4424         16  FILLER                       PIC X(01).
  4425*        16  FILLER                       PIC X(18).
  4426         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4427*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4428         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4429         16  PB-CANCELED-CERT-DATA.
  4430             20  PB-CI-INSURED-NAME.
  4431                 24  PB-CI-LAST-NAME      PIC X(15).
  4432                 24  PB-CI-INITIALS       PIC XX.
  4433             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4434             20  PB-CI-INSURED-SEX        PIC X.
  4435             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4436             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4437             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4438             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4439             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4440             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4441             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4442             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4443             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4444             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4445             20  PB-CI-RATE-CLASS         PIC XX.
  4446             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4447             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4448             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4449             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4450             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4451             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4452             20  PB-CI-LF-ABBR            PIC X(3).
  4453             20  PB-CI-AH-ABBR            PIC X(3).
  4454             20  PB-CI-OB-FLAG            PIC X.
  4455                 88  PB-CI-OB                VALUE 'B'.
  4456             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4457                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4458                                           'M' '4' '5' '9' '2'.
  4459                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4460                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4461                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4462                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4463                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4464                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4465                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4466                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4467                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4468                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4469                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4470                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4471                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4472             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4473                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4474                                           'M' '4' '5' '9' '2'.
  4475                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  84
* EL050.cbl
  4476                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4477                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4478                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4479                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4480                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4481                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4482                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4483                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4484                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4485                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4486                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4487                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4488             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4489             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4490             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4491             20  PB-CI-MEMBER-NO          PIC X(12).
  4492             20  PB-CI-INT-CODE           PIC X.
  4493                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4494                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4495             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4496             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4497             20  PB-CI-COMP-EXCP-SW       PIC X.
  4498                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4499                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4500             20  PB-CI-ENTRY-STATUS       PIC X.
  4501             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4502             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4503             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4504             20  PB-CI-DEATH-DT           PIC XX.
  4505             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4506             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4507             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4508             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4509             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4510             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4511             20  PB-CI-ENTRY-DT              PIC XX.
  4512             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4513             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4514             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4515             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4516             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4517             20  PB-CI-OLD-LOF               PIC XXX.
  4518*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4519             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4520             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4521             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4522             20  PB-CI-INDV-GRP-CD           PIC X.
  4523             20  PB-CI-BENEFICIARY-NAME.
  4524                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4525                 24  FILLER                  PIC X(15).
  4526             20  PB-CI-NOTE-SW               PIC X.
  4527             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4528             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4529             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4530             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4531             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4532             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4533             20  PB-CI-FIRST-NAME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  85
* EL050.cbl
  4534             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4535
  4536         16  FILLER                       PIC X(13).
  4537*032306  16  FILLER                       PIC X(27).
  4538*        16  FILLER                       PIC X(46).
  4539
  4540     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4541         16  FILLER                       PIC X(10).
  4542         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4543         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4544         16  PB-M-INSURED-MID-INIT        PIC X.
  4545         16  PB-M-INSURED-AGE             PIC 99.
  4546         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4547         16  PB-M-INSURED-SEX             PIC X.
  4548         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4549         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4550         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4551         16  PB-M-INSURED-CITY-STATE.
  4552             20  PB-M-INSURED-CITY        PIC X(28).
  4553             20  PB-M-INSURED-STATE       PIC XX.
  4554         16  PB-M-INSURED-ZIP-CODE.
  4555             20  PB-M-INSURED-ZIP-PRIME.
  4556                 24  PB-M-INSURED-ZIP-1   PIC X.
  4557                     88  PB-M-CANADIAN-POST-CODE
  4558                                             VALUE 'A' THRU 'Z'.
  4559                 24  FILLER               PIC X(4).
  4560             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4561         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4562                                        PB-M-INSURED-ZIP-CODE.
  4563             20  PM-M-INS-CAN-POST1       PIC XXX.
  4564             20  PM-M-INS-CAN-POST2       PIC XXX.
  4565             20  FILLER                   PIC XXX.
  4566         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4567         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4568         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4569         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4570         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4571         16  PB-M-CRED-BENE-CITYST.
  4572             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4573             20  PB-M-CRED-BENE-STATE     PIC XX.
  4574         16  FILLER                       PIC X(92).
  4575
  4576     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4577         16  FILLER                       PIC X(10).
  4578         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4579         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4580         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4581         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4582         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4583         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4584         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4585         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4586         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4587         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4588         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4589         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4590         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4591         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  86
* EL050.cbl
  4592         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4593         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4594         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4595         16  PB-ACCOUNT-NAME              PIC X(30).
  4596         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4597         16  PB-REFERENCE                 PIC X(12).
  4598         16  PB-B-RECEIVED-DT             PIC XX.
  4599         16  FILLER                       PIC X(234).
  4600
  4601     12  PB-RECORD-STATUS.
  4602         16  PB-CREDIT-SELECT-DT          PIC XX.
  4603         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4604         16  PB-BILLED-DT                 PIC XX.
  4605         16  PB-BILLING-STATUS            PIC X.
  4606             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4607             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4608             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4609         16  PB-RECORD-BILL               PIC X.
  4610             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4611             88  PB-RECORD-RETURNED           VALUE 'R'.
  4612             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4613             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4614             88  PB-OVERRIDE-AH               VALUE 'A'.
  4615             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4616         16  PB-BATCH-ENTRY               PIC X.
  4617             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4618             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4619             88  PB-REISSUED-CERT             VALUE 'E'.
  4620             88  PB-CASH-CERT                 VALUE 'C'.
  4621             88  PB-MONTHLY-CERT              VALUE 'M'.
  4622             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4623             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4624             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4625         16  PB-FORCE-CODE                PIC X.
  4626             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4627             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4628             88  PB-CANCEL-FORCE              VALUE '8'.
  4629             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4630             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4631             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4632             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4633             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4634             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4635             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4636             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4637         16  PB-FATAL-FLAG                PIC X.
  4638             88  PB-FATAL-ERRORS              VALUE 'X'.
  4639         16  PB-FORCE-ER-CD               PIC X.
  4640             88  PB-FORCE-ERRORS              VALUE 'F'.
  4641             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4642         16  PB-WARN-ER-CD                PIC X.
  4643             88  PB-WARNING-ERRORS            VALUE 'W'.
  4644         16  FILLER                       PIC X.
  4645         16  PB-OUT-BAL-CD                PIC X.
  4646             88  PB-OUT-OF-BAL                VALUE 'O'.
  4647         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4648         16  PB-AH-OVERRIDE-L1            PIC X.
  4649         16  PB-INPUT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  87
* EL050.cbl
  4650         16  PB-INPUT-BY                  PIC X(4).
  4651         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4652         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4653         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4654         16  PB-LF-EARNING-METHOD         PIC X.
  4655         16  PB-AH-EARNING-METHOD         PIC X.
  4656         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4657         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4658         16  PB-REIN-CD                   PIC XXX.
  4659         16  PB-LF-REFUND-TYPE            PIC X.
  4660         16  PB-AH-REFUND-TYPE            PIC X.
  4661         16  PB-ACCT-EFF-DT               PIC XX.
  4662         16  PB-ACCT-EXP-DT               PIC XX.
  4663         16  PB-COMPANY-ID                PIC X(3).
  4664         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4665         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4666         16  PB-SV-CARRIER                PIC X.
  4667         16  PB-SV-GROUPING               PIC X(6).
  4668         16  PB-SV-STATE                  PIC XX.
  4669         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4670         16  PB-GA-BILLING-INFO.
  4671             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4672                                          PIC XX.
  4673         16  PB-SV-REMIT-TO  REDEFINES
  4674             PB-GA-BILLING-INFO           PIC X(10).
  4675         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4676         16  PB-I-LOAN-OFFICER            PIC X(5).
  4677         16  PB-I-VIN                     PIC X(17).
  4678
  4679         16  FILLER                       PIC X(04).
  4680         16  IMNET-BYPASS-SW              PIC X.
  4681
  4682******************************************************************
  4683*                COMMON EDIT ERRORS                              *
  4684******************************************************************
  4685
  4686     12  PB-COMMON-ERRORS.
  4687         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4688                                           PIC S9(4)     COMP.
  4689
  4690******************************************************************
  4691
  4692* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4693*    COPY ELC50W1.
  4694******************************************************************
  4695*                                                                *
  4696*                                                                *
  4697*                             ELC50W1                            *
  4698*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4699*                            VMOD=2.004                          *
  4700*                                                                *
  4701*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4702*                                                                *
  4703*                                                                *
  4704******************************************************************
  4705
  4706     12  WK-WORK-AREA.
  4707         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  88
* EL050.cbl
  4708         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4709         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4710         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4711         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4712         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4713         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4714         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4715         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4716         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4717         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4718         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4719         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4720         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4721         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4722         16  WK-CREDIT-EDIT-CONTROLS.
  4723             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4724             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4725             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4726             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4727             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4728             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4729         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4730         16  WK-SAVE-REIN-DATA.
  4731             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4732             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4733             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4734         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4735             88  ENTRY-FROM-EL6311       VALUE '6'.
  4736         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4737         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4738     12  WK-RECORD-ADDRESSES.
  4739         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4740         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4741         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4742         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4743         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4744         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4745         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4746         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4747     12  WK-OVER-SHORT-AREA.
  4748         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4749         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4750         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4751             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4752         16  FILLER                   PIC X(5) VALUE SPACES.
  4753
  4754*    COPY ELCEDITC.
  4755******************************************************************
  4756*                                                                *
  4757*                                                                *
  4758*                            ELCEDITC                            *
  4759*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4760*                            VMOD=2.012                          *
  4761*                                                                *
  4762*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4763*                     EL6313, EL050 AND EL517.                   *
  4764*                                                                *
  4765******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  89
* EL050.cbl
  4766******************************************************************
  4767*                   C H A N G E   L O G
  4768*
  4769* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4770*-----------------------------------------------------------------
  4771*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4772* EFFECTIVE    NUMBER
  4773*-----------------------------------------------------------------
  4774* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4775******************************************************************
  4776
  4777     12  EDIT-CRITERIA-DATA.
  4778         16  EC-CO-MONTH-END-DT       PIC XX.
  4779         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4780         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4781         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4782         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4783         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4784         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4785         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4786         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4787         16  EC-CO-REM-TERM-CALC      PIC X.
  4788               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4789               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4790               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4791               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4792
  4793         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4794               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4795               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4796               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4797               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4798               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4799               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4800               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4801               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4802               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4803               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4804
  4805         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4806               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4807               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4808               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4809               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4810               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4811               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4812               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4813               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4814
  4815         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4816                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4817                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4818
  4819         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4820                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4821                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4822                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4823                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  90
* EL050.cbl
  4824                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4825                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4826                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4827                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4828
  4829         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4830               88  EC-BR-REDUCING                   VALUE 'R'.
  4831               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4832
  4833         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4834         16  EC-BR-LF-DESC             PIC X(10).
  4835         16  EC-BR-AH-DESC             PIC X(10).
  4836         16  EC-BR-LF-COMMENT          PIC X(10).
  4837         16  EC-BR-AH-COMMENT          PIC X(10).
  4838
  4839         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4840               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4841               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4842               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4843               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4844
  4845         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4846               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4847               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4848               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4849               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4850
  4851         16  EC-BR-LF-REFUND-CALC      PIC X.
  4852                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4853                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4854                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4855                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4856                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4857                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4858                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4859
  4860         16  EC-BR-AH-REFUND-CALC      PIC X.
  4861                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4862                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4863                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4864                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4865                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4866                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4867                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4868                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4869
  4870         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4871                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4872                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4873                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4874
  4875         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4876                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4877                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4878                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4879
  4880         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4881         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  91
* EL050.cbl
  4882         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4883         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4884
  4885         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4886         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4887                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4888                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4889                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4890                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4891
  4892         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4893               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4894               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4895               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4896               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4897               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4898
  4899         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4900               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4901               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4902               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4903               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4904               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4905
  4906         16  EC-ST-LF-REFUND-CALC      PIC X.
  4907                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4908                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4909                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4910                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4911                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4912                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4913                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4914                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4915
  4916         16  EC-ST-AH-REFUND-CALC      PIC X.
  4917                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4918                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4919                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4920                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4921                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4922                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4923                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4924                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4925
  4926         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4927         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4928         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4929         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4930         16  EC-AM-EXPIRATION-DT       PIC XX.
  4931         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4932         16  EC-AM-CLASS-CD            PIC XX.
  4933         16  EC-AM-LF-DEVIATION        PIC XXX.
  4934         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4935         16  EC-AM-AH-DEVIATION        PIC XXX.
  4936         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4937         16  EC-AM-PHONE-NO            PIC X(10).
  4938
  4939         16  EC-AM-LF-REFUND-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  92
* EL050.cbl
  4940                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4941                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4942                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4943                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4944                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4945                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4946                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4947
  4948         16  EC-AM-AH-REFUND-CALC      PIC X.
  4949                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4950                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4951                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4952                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4953                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4954                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4955                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4956
  4957         16  EC-AM-BEN-I-G-CD          PIC X.
  4958                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4959                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4960                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4961
  4962         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4963         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4964         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4965         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4966         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4967         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4968         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4969         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4970         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4971
  4972         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4973         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4974         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4975         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4976         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4977         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4978         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4979         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4980         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4981         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4982         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4983         16  EC-RT-LF-NSP-ST           PIC XX.
  4984         16  EC-RT-AH-NSP-ST           PIC XX.
  4985         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4986         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4987
  4988         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4989             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4990                                             'M' '5' '9' '2'.
  4991             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4992             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4993             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4994             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4995             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4996             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4997             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  93
* EL050.cbl
  4998             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4999             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  5000             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  5001
  5002         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  5003             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  5004                                             'M' '5' '9' '2'.
  5005             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  5006             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  5007             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  5008             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  5009             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5010             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5011             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5012             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5013             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5014             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5015
  5016         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5017         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5018         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5019         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5020         16  EC-CM-DEATH-DT            PIC XX.
  5021
  5022*DMD CUSTOM CODING FIELDS BELOW
  5023*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5024         16  EC-BR-DMD-RATING-SW       PIC X.
  5025                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5026                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5027                 88  NO-DMD-RATING               VALUE 'N'.
  5028
  5029         16  EC-NEW-CERT               PIC X(11).
  5030         16  EC-NEW-STATE              PIC XX.
  5031         16  FILLER                    PIC X.
  5032*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5033         16  OVER-SHORT-EDIT-FIELDS.
  5034             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5035             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5036             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5037             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5038             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5039             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5040             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5041             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5042             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5043         16  FILLER                    PIC X(71).
  5044******************************************************************
  5045
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  94
* EL050.cbl
  5047*    COPY ELCDIFRD.
  5048******************************************************************
  5049*                                                                *
  5050*                                                                *
  5051*                            ELCDIFRD.                           *
  5052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5053*                            VMOD=2.004                          *
  5054*                                                                *
  5055*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5056*                                                                *
  5057******************************************************************
  5058*
  5059  01  WS-DIFFERENCE-CALCULATION.
  5060        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5061        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5062        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5063        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5064        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5065        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5066        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5067        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5068        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5069        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5070        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5071
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  95
* EL050.cbl
  5073****************************************************************
  5074*
  5075* Copyright (c) 2007-2013 Dell Inc.
  5076* All rights reserved.
  5077*
  5078****************************************************************
  5079 01  DFHEIV.
  5080   02  DFHEIV0               PIC X(35).
  5081   02  DFHEIV1               PIC X(08).
  5082   02  DFHEIV2               PIC X(08).
  5083   02  DFHEIV3               PIC X(08).
  5084   02  DFHEIV4               PIC X(06).
  5085   02  DFHEIV5               PIC X(04).
  5086   02  DFHEIV6               PIC X(04).
  5087   02  DFHEIV7               PIC X(02).
  5088   02  DFHEIV8               PIC X(02).
  5089   02  DFHEIV9               PIC X(01).
  5090   02  DFHEIV10              PIC S9(7) COMP-3.
  5091   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5092   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5093   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5094   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5095   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5096   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5097   02  DFHEIV17              PIC X(04).
  5098   02  DFHEIV18              PIC X(04).
  5099   02  DFHEIV19              PIC X(04).
  5100   02  DFHEIV20              USAGE IS POINTER.
  5101   02  DFHEIV21              USAGE IS POINTER.
  5102   02  DFHEIV22              USAGE IS POINTER.
  5103   02  DFHEIV23              USAGE IS POINTER.
  5104   02  DFHEIV24              USAGE IS POINTER.
  5105   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5106   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5107   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5108   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5109   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5110   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5111   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5112   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5113   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5114   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5115   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5116   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5117   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5118   02  FILLER                PIC X(02).
  5119   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5120   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5121   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5122   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5123   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5124   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5125   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5126 LINKAGE  SECTION.
  5127*****************************************************************
  5128*                                                               *
  5129* Copyright (c) 2007-2013 Dell Inc.                             *
  5130* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  96
* EL050.cbl
  5131*                                                               *
  5132*****************************************************************
  5133 01  dfheiblk.
  5134     02  eibtime          pic s9(7) comp-3.
  5135     02  eibdate          pic s9(7) comp-3.
  5136     02  eibtrnid         pic x(4).
  5137     02  eibtaskn         pic s9(7) comp-3.
  5138     02  eibtrmid         pic x(4).
  5139     02  dfheigdi         pic s9(4) comp.
  5140     02  eibcposn         pic s9(4) comp.
  5141     02  eibcalen         pic s9(4) comp.
  5142     02  eibaid           pic x(1).
  5143     02  eibfiller1       pic x(1).
  5144     02  eibfn            pic x(2).
  5145     02  eibfiller2       pic x(2).
  5146     02  eibrcode         pic x(6).
  5147     02  eibfiller3       pic x(2).
  5148     02  eibds            pic x(8).
  5149     02  eibreqid         pic x(8).
  5150     02  eibrsrce         pic x(8).
  5151     02  eibsync          pic x(1).
  5152     02  eibfree          pic x(1).
  5153     02  eibrecv          pic x(1).
  5154     02  eibsend          pic x(1).
  5155     02  eibatt           pic x(1).
  5156     02  eibeoc           pic x(1).
  5157     02  eibfmh           pic x(1).
  5158     02  eibcompl         pic x(1).
  5159     02  eibsig           pic x(1).
  5160     02  eibconf          pic x(1).
  5161     02  eiberr           pic x(1).
  5162     02  eibrldbk         pic x(1).
  5163     02  eiberrcd         pic x(4).
  5164     02  eibsynrb         pic x(1).
  5165     02  eibnodat         pic x(1).
  5166     02  eibfiller5       pic x(2).
  5167     02  eibresp          pic s9(8) comp.
  5168     02  eibresp2         pic s9(8) comp.
  5169     02  dfheigdj         pic s9(4) comp.
  5170     02  dfheigdk         pic s9(4) comp.
  5171
  5172 01  DFHCOMMAREA                   PIC X(1036).
  5173
  5174*01 PARMLIST .
  5175*    02  FILLER                    PIC S9(8)   COMP.
  5176*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5177*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5178*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5179*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5180*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5181*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5182*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5183
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  97
* EL050.cbl
  5185*    COPY ELCCNTL.
  5186******************************************************************
  5187*                                                                *
  5188*                                                                *
  5189*                            ELCCNTL.                            *
  5190*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5191*                            VMOD=2.059                          *
  5192*                                                                *
  5193*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5194*                                                                *
  5195*   FILE TYPE = VSAM,KSDS                                        *
  5196*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5197*                                                                *
  5198*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5199*       ALTERNATE INDEX = NONE                                   *
  5200*                                                                *
  5201*   LOG = YES                                                    *
  5202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5203******************************************************************
  5204*                   C H A N G E   L O G
  5205*
  5206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5207*-----------------------------------------------------------------
  5208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5209* EFFECTIVE    NUMBER
  5210*-----------------------------------------------------------------
  5211* 082503                   PEMA  ADD BENEFIT GROUP
  5212* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5213* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5214* 092705    2005050300006  PEMA  ADD SPP LEASES
  5215* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5216* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5217* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5218* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5219* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5220* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5221* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5222* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5223* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5224* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5225* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5226******************************************************************
  5227*
  5228 01  CONTROL-FILE.
  5229     12  CF-RECORD-ID                       PIC XX.
  5230         88  VALID-CF-ID                        VALUE 'CF'.
  5231
  5232     12  CF-CONTROL-PRIMARY.
  5233         16  CF-COMPANY-ID                  PIC XXX.
  5234         16  CF-RECORD-TYPE                 PIC X.
  5235             88  CF-COMPANY-MASTER              VALUE '1'.
  5236             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5237             88  CF-STATE-MASTER                VALUE '3'.
  5238             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5239             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5240             88  CF-CARRIER-MASTER              VALUE '6'.
  5241             88  CF-MORTALITY-MASTER            VALUE '7'.
  5242             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  98
* EL050.cbl
  5243             88  CF-TERMINAL-MASTER             VALUE '9'.
  5244             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5245             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5246             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5247             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5248             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5249             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5250             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5251             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5252             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5253         16  CF-ACCESS-CD-GENL              PIC X(4).
  5254         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5255             20  CF-PROCESSOR               PIC X(4).
  5256         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5257             20  CF-STATE-CODE              PIC XX.
  5258             20  FILLER                     PIC XX.
  5259         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5260             20  FILLER                     PIC XX.
  5261             20  CF-HI-BEN-IN-REC           PIC XX.
  5262         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5263             20  FILLER                     PIC XXX.
  5264             20  CF-CARRIER-CNTL            PIC X.
  5265         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5266             20  FILLER                     PIC XX.
  5267             20  CF-HI-TYPE-IN-REC          PIC 99.
  5268         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5269             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5270                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5271             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5272             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5273         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5274             20  FILLER                     PIC X.
  5275             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5276         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5277             20  FILLER                     PIC XX.
  5278             20  CF-MORTGAGE-PLAN           PIC XX.
  5279         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5280
  5281     12  CF-LAST-MAINT-DT                   PIC XX.
  5282     12  CF-LAST-MAINT-BY                   PIC X(4).
  5283     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5284
  5285     12  CF-RECORD-BODY                     PIC X(728).
  5286
  5287
  5288****************************************************************
  5289*             COMPANY MASTER RECORD                            *
  5290****************************************************************
  5291
  5292     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5293         16  CF-COMPANY-ADDRESS.
  5294             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5295             20  CF-CL-IN-CARE-OF           PIC X(30).
  5296             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5297             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5298             20  CF-CL-CITY-STATE           PIC X(30).
  5299             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5300             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page  99
* EL050.cbl
  5301         16  CF-COMPANY-CD                  PIC X.
  5302         16  CF-COMPANY-PASSWORD            PIC X(8).
  5303         16  CF-SECURITY-OPTION             PIC X.
  5304             88  ALL-SECURITY                   VALUE '1'.
  5305             88  COMPANY-VERIFY                 VALUE '2'.
  5306             88  PROCESSOR-VERIFY               VALUE '3'.
  5307             88  NO-SECURITY                    VALUE '4'.
  5308             88  ALL-BUT-TERM                   VALUE '5'.
  5309         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5310             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5311         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5312             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5313         16  CF-INFORCE-LOCATION            PIC X.
  5314             88  CERTS-ARE-ONLINE               VALUE '1'.
  5315             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5316             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5317         16  CF-LOWER-CASE-LETTERS          PIC X.
  5318         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5319             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5320             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5321             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5322             88  CF-ACCNT-CNTL                  VALUE '3'.
  5323             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5324
  5325         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5326         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5327
  5328         16  CF-LGX-CREDIT-USER             PIC X.
  5329             88  CO-IS-NOT-USER                 VALUE 'N'.
  5330             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5331
  5332         16 CF-CREDIT-CALC-CODES.
  5333             20  CF-CR-REM-TERM-CALC PIC X.
  5334               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5335               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5336               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5337               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5338               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5339               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5340               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5341             20  CF-CR-R78-METHOD           PIC X.
  5342               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5343               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5344
  5345         16  CF-CLAIM-CONTROL-COUNTS.
  5346             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5347                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5348
  5349             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5350                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5351
  5352             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5353                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5354
  5355             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5356                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5357
  5358         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 100
* EL050.cbl
  5359
  5360         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5361             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5362             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5363             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5364             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5365                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5366                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5367             20  CF-CO-PREM-REJECT-SW       PIC X.
  5368                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5369                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5370             20  CF-CO-REF-REJECT-SW        PIC X.
  5371                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5372                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5373
  5374         16  CF-CO-REPORTING-DT             PIC XX.
  5375         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5376         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5377           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5378           88  CF-CO-MONTH-END                  VALUE '1'.
  5379
  5380         16  CF-LGX-CLAIM-USER              PIC X.
  5381             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5382             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5383
  5384         16  CF-CREDIT-EDIT-CONTROLS.
  5385             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5386             20  CF-MIN-AGE                 PIC 99.
  5387             20  CF-DEFAULT-AGE             PIC 99.
  5388             20  CF-MIN-TERM                PIC S999      COMP-3.
  5389             20  CF-MAX-TERM                PIC S999      COMP-3.
  5390             20  CF-DEFAULT-SEX             PIC X.
  5391             20  CF-JOINT-AGE-INPUT         PIC X.
  5392                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5393             20  CF-BIRTH-DATE-INPUT        PIC X.
  5394                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5395             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5396                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5397                 88  CF-ZERO-CARRIER            VALUE '1'.
  5398                 88  CF-ZERO-GROUPING           VALUE '2'.
  5399                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5400             20  CF-EDIT-SW                 PIC X.
  5401                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5402             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5403             20  CF-CR-PR-METHOD            PIC X.
  5404               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5405               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5406             20  FILLER                     PIC X.
  5407
  5408         16  CF-CREDIT-MISC-CONTROLS.
  5409             20  CF-REIN-TABLE-SW           PIC X.
  5410                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5411             20  CF-COMP-TABLE-SW           PIC X.
  5412                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5413             20  CF-EXPERIENCE-RETENTION-AGE
  5414                                            PIC S9        COMP-3.
  5415             20  CF-CONVERSION-DT           PIC XX.
  5416             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 101
* EL050.cbl
  5417             20  CF-RUN-FREQUENCY-SW        PIC X.
  5418                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5419                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5420
  5421             20  CF-CR-CHECK-NO-CONTROL.
  5422                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5423                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5424                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5425                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5426                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5427                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5428
  5429                 24  CF-CR-CHECK-COUNT       REDEFINES
  5430                     CF-CR-CHECK-COUNTER      PIC X(4).
  5431
  5432                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5433                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5434
  5435                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5436                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5437                 24  CF-MAIL-PROCESSING       PIC X.
  5438                     88  MAIL-PROCESSING          VALUE 'Y'.
  5439
  5440         16  CF-MISC-SYSTEM-CONTROL.
  5441             20  CF-SYSTEM-C                 PIC X.
  5442                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5443             20  CF-SYSTEM-D                 PIC X.
  5444                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5445             20  CF-SOC-SEC-NO-SW            PIC X.
  5446                 88  SOC-SEC-NO-USED             VALUE '1'.
  5447             20  CF-MEMBER-NO-SW             PIC X.
  5448                 88  MEMBER-NO-USED              VALUE '1'.
  5449             20  CF-TAX-ID-NUMBER            PIC X(11).
  5450             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5451             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5452                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5453                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5454                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5455                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5456             20  CF-SYSTEM-E                 PIC X.
  5457                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5458
  5459         16  CF-LGX-LIFE-USER               PIC X.
  5460             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5461             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5462
  5463         16  CF-CR-MONTH-END-DT             PIC XX.
  5464
  5465         16  CF-FILE-MAINT-DATES.
  5466             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5467                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5468             20  CF-LAST-BATCH       REDEFINES
  5469                 CF-LAST-BATCH-NO               PIC X(4).
  5470             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5471             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5472             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5473             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5474             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 102
* EL050.cbl
  5475             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5476             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5477             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5478             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5479             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5480
  5481         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5482         16  FILLER                         PIC X.
  5483
  5484         16  CF-ALT-MORT-CODE               PIC X(4).
  5485         16  CF-MEMBER-CAPTION              PIC X(10).
  5486
  5487         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5488             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5489             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5490             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5491             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5492             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5493
  5494         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5495
  5496         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5497         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5498         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5499         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5500
  5501         16  CF-AH-OVERRIDE-L1              PIC X.
  5502         16  CF-AH-OVERRIDE-L2              PIC XX.
  5503         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5504         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5505
  5506         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5507         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5508
  5509         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5510         16  CF-AR-LAST-EL860-DT            PIC XX.
  5511         16  CF-MP-MONTH-END-DT             PIC XX.
  5512
  5513         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5514         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5515             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5516
  5517         16  CF-AR-MONTH-END-DT             PIC XX.
  5518
  5519         16  CF-CRDTCRD-USER                PIC X.
  5520             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5521             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5522
  5523         16  CF-CC-MONTH-END-DT             PIC XX.
  5524
  5525         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5526
  5527         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5528             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5529             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5530             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5531         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5532         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 103
* EL050.cbl
  5533         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5534         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5535             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5536             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5537         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5538         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5539         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5540             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5541         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5542
  5543         16  CF-CL-ZIP-CODE.
  5544             20  CF-CL-ZIP-PRIME.
  5545                 24  CF-CL-ZIP-1ST          PIC X.
  5546                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5547                 24  FILLER                 PIC X(4).
  5548             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5549         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5550             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5551             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5552             20  FILLER                     PIC XXX.
  5553
  5554         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5555         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5556         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5557         16  CF-CO-OPTION-START-DATE        PIC XX.
  5558         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5559           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5560                                                      '3' '4'.
  5561           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5562           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5563           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5564           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5565           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5566           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5567
  5568         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5569
  5570         16  CF-PAYMENT-APPROVAL-LEVELS.
  5571             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5572             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5573             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5574             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5575             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5576             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5577
  5578         16  CF-END-USER-REPORTING-USER     PIC X.
  5579             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5580             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5581
  5582         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5583             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5584             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5585
  5586         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5587
  5588         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5589         16  FILLER                         PIC X.
  5590
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 104
* EL050.cbl
  5591         16  CF-CREDIT-ARCHIVE-CNTL.
  5592             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5593             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5594             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5595
  5596         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5597
  5598         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5599             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5600             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5601
  5602         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5603             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5604             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5605
  5606         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5607
  5608         16  CF-CO-ACH-ID-CODE              PIC  X.
  5609             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5610             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5611             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5612         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5613         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5614         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5615         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5616         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5617         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5618         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5619         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5620         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5621                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5622         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5623                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5624
  5625         16  CF-CO-OVER-SHORT.
  5626             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5627             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5628
  5629*         16  FILLER                         PIC X(102).
  5630         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5631             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5632             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5633
  5634         16  CF-AH-APPROVAL-DAYS.
  5635             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5636             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5637             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5638             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5639
  5640         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5641
  5642         16  CF-APPROV-LEV-5.
  5643             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5644             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5645             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5646
  5647         16  FILLER                         PIC X(68).
  5648****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 105
* EL050.cbl
  5649*             PROCESSOR/USER RECORD                            *
  5650****************************************************************
  5651
  5652     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5653         16  CF-PROCESSOR-NAME              PIC X(30).
  5654         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5655         16  CF-PROCESSOR-TITLE             PIC X(26).
  5656         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5657                 88  MESSAGE-YES                VALUE 'Y'.
  5658                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5659
  5660*****************************************************
  5661****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5662****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5663****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5664****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5665*****************************************************
  5666
  5667         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5668             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5669             20  CF-APPLICATION-FORCE       PIC X.
  5670             20  CF-INDIVIDUAL-APP.
  5671                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5672                     28  CF-BROWSE-APP      PIC X.
  5673                     28  CF-UPDATE-APP      PIC X.
  5674
  5675         16  CF-CURRENT-TERM-ON             PIC X(4).
  5676         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5677             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5678             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5679             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5680             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5681             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5682             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5683             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5684         16  CF-PROCESSOR-CARRIER           PIC X.
  5685             88  NO-CARRIER-SECURITY            VALUE ' '.
  5686         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5687             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5688         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5689             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5690         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5691             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5692
  5693         16  CF-PROC-SYS-ACCESS-SW.
  5694             20  CF-PROC-CREDIT-CLAIMS-SW.
  5695                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5696                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5697                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5698                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5699             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5700                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5701                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5702             20  CF-PROC-LIFE-GNRLDGR-SW.
  5703                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5704                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5705                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5706                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 106
* EL050.cbl
  5707             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5708                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5709                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5710         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5711             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5712             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5713         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5714
  5715         16  CF-APPROVAL-LEVEL                  PIC X.
  5716             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5717             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5718             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5719             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5720             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5721
  5722         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5723
  5724         16  CF-LANGUAGE-TYPE                   PIC X.
  5725             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5726             88  CF-LANG-IS-FR                      VALUE 'F'.
  5727
  5728         16  CF-CSR-IND                         PIC X.
  5729         16  FILLER                             PIC X(239).
  5730
  5731****************************************************************
  5732*             PROCESSOR/REMINDERS RECORD                       *
  5733****************************************************************
  5734
  5735     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5736         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5737             20  CF-START-REMIND-DT         PIC XX.
  5738             20  CF-END-REMIND-DT           PIC XX.
  5739             20  CF-REMINDER-TEXT           PIC X(50).
  5740         16  FILLER                         PIC X(296).
  5741
  5742
  5743****************************************************************
  5744*             STATE MASTER RECORD                              *
  5745****************************************************************
  5746
  5747     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5748         16  CF-STATE-ABBREVIATION          PIC XX.
  5749         16  CF-STATE-NAME                  PIC X(25).
  5750         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5751         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5752             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5753             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5754             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5755             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5756                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5757                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5758             20  CF-ST-PREM-REJECT-SW       PIC X.
  5759                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5760                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5761             20  CF-ST-REF-REJECT-SW        PIC X.
  5762                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5763                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5764         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 107
* EL050.cbl
  5765         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5766         16  CF-ST-REFUND-RULES.
  5767             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5768             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5769             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5770         16  CF-ST-FST-PMT-EXTENSION.
  5771             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5772             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5773                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5774                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5775                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5776                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5777         16  CF-ST-STATE-CALL.
  5778             20  CF-ST-CALL-UNEARNED        PIC X.
  5779             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5780             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5781         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5782             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5783             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5784         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5785         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5786         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5787         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5788         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5789         16  FILLER                         PIC X.
  5790         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5791             20  CF-ST-BENEFIT-CD           PIC XX.
  5792             20  CF-ST-BENEFIT-KIND         PIC X.
  5793                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5794                 88  CF-ST-AH-KIND              VALUE 'A'.
  5795             20  CF-ST-REM-TERM-CALC        PIC X.
  5796                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5797                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5798                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5799                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5800                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5801                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5802                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5803                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5804
  5805             20  CF-ST-REFUND-CALC          PIC X.
  5806                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5807                 88  ST-REFD-BY-R78             VALUE '1'.
  5808                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5809                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5810                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5811                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5812                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5813                 88  ST-REFD-UTAH               VALUE '7'.
  5814                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5815                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5816                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5817
  5818             20  CF-ST-EARNING-CALC         PIC X.
  5819                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5820                 88  ST-EARN-BY-R78             VALUE '1'.
  5821                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5822                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 108
* EL050.cbl
  5823                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5824                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5825                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5826                 88  ST-EARN-MEAN               VALUE '8'.
  5827                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5828
  5829             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5830                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5831                 88  ST-OVRD-BY-R78             VALUE '1'.
  5832                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5833                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5834                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5835                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5836                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5837                 88  ST-OVRD-MEAN               VALUE '8'.
  5838                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5839             20  cf-st-extra-periods        pic 9.
  5840*            20  FILLER                     PIC X.
  5841
  5842         16  CF-ST-COMMISSION-CAPS.
  5843             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5844             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5845             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5846             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5847         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5848                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5849                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5850                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5851
  5852         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5853
  5854         16  CF-ST-STATUTORY-INTEREST.
  5855             20  CF-ST-STAT-DATE-FROM       PIC X.
  5856                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5857                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5858             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5859             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5860             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5861             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5862             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5863
  5864         16  CF-ST-OVER-SHORT.
  5865             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5866             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5867
  5868         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5869
  5870         16  CF-ST-RT-CALC                  PIC X.
  5871
  5872         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5873         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5874         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5875         16  CF-ST-RF-LR-CALC               PIC X.
  5876         16  CF-ST-RF-LL-CALC               PIC X.
  5877         16  CF-ST-RF-LN-CALC               PIC X.
  5878         16  CF-ST-RF-AH-CALC               PIC X.
  5879         16  CF-ST-RF-CP-CALC               PIC X.
  5880*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 109
* EL050.cbl
  5881*CIDMOD         16  FILLER                         PIC X(192).
  5882         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5883             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5884         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5885         16  CF-ST-VFY-2ND-BENE             PIC X.
  5886         16  CF-ST-CAUSAL-STATE             PIC X.
  5887         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5888         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5889         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5890             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5891         16  CF-ST-NET-ONLY-STATE           PIC X.
  5892             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5893         16  cf-commission-cap-required     pic x.
  5894         16  CF-ST-GA-COMMISSION-CAPS.
  5895             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5896             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5897             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5898             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5899         16  CF-ST-TOT-COMMISSION-CAPS.
  5900             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5901             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5902             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5903             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5904         16  FILLER                         PIC X(156).
  5905
  5906****************************************************************
  5907*             BENEFIT MASTER RECORD                            *
  5908****************************************************************
  5909
  5910     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5911         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5912             20  CF-BENEFIT-CODE            PIC XX.
  5913             20  CF-BENEFIT-NUMERIC  REDEFINES
  5914                 CF-BENEFIT-CODE            PIC XX.
  5915             20  CF-BENEFIT-ALPHA           PIC XXX.
  5916             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5917             20  CF-BENEFIT-COMMENT         PIC X(10).
  5918
  5919             20  CF-LF-COVERAGE-TYPE        PIC X.
  5920                 88  CF-REDUCING                VALUE 'R'.
  5921                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5922
  5923             20  CF-SPECIAL-CALC-CD         PIC X.
  5924                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5925                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5926                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5927                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5928                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5929                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5930                 88  CF-FARM-PLAN               VALUE 'F'.
  5931                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5932                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5933                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5934                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5935                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5936                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5937                 88  CF-PRUDENTIAL              VALUE 'P'.
  5938                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 110
* EL050.cbl
  5939                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5940                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5941                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5942                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5943                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5944
  5945             20  CF-JOINT-INDICATOR         PIC X.
  5946                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5947
  5948*            20  FILLER                     PIC X(12).
  5949             20  cf-maximum-benefits        pic s999 comp-3.
  5950             20  FILLER                     PIC X(09).
  5951             20  CF-BENEFIT-CATEGORY        PIC X.
  5952             20  CF-LOAN-TYPE               PIC X(8).
  5953
  5954             20  CF-CO-REM-TERM-CALC        PIC X.
  5955                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5956                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5957                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5958                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5959                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5960
  5961             20  CF-CO-EARNINGS-CALC        PIC X.
  5962                 88  CO-EARN-BY-R78             VALUE '1'.
  5963                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5964                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5965                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5966                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5967                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5968                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5969                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5970
  5971             20  CF-CO-REFUND-CALC          PIC X.
  5972                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5973                 88  CO-REFD-BY-R78             VALUE '1'.
  5974                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5975                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5976                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5977                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5978                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5979                 88  CO-REFD-MEAN               VALUE '8'.
  5980                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5981                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5982                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5983
  5984             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5985                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5986                 88  CO-OVRD-BY-R78             VALUE '1'.
  5987                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5988                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5989                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5990                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5991                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5992                 88  CO-OVRD-MEAN               VALUE '8'.
  5993                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5994
  5995             20  CF-CO-BEN-I-G-CD           PIC X.
  5996                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 111
* EL050.cbl
  5997                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5998                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5999
  6000         16  FILLER                         PIC X(304).
  6001
  6002
  6003****************************************************************
  6004*             CARRIER MASTER RECORD                            *
  6005****************************************************************
  6006
  6007     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6008         16  CF-ADDRESS-DATA.
  6009             20  CF-MAIL-TO-NAME            PIC X(30).
  6010             20  CF-IN-CARE-OF              PIC X(30).
  6011             20  CF-ADDRESS-LINE-1          PIC X(30).
  6012             20  CF-ADDRESS-LINE-2          PIC X(30).
  6013             20  CF-CITY-STATE              PIC X(30).
  6014             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6015             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6016
  6017         16  CF-CLAIM-NO-CONTROL.
  6018             20  CF-CLAIM-NO-METHOD         PIC X.
  6019                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6020                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6021                 88  CLAIM-NO-SEQ               VALUE '3'.
  6022                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6023             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6024                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6025                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6026                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6027
  6028         16  CF-CHECK-NO-CONTROL.
  6029             20  CF-CHECK-NO-METHOD         PIC X.
  6030                 88  CHECK-NO-MANUAL            VALUE '1'.
  6031                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6032                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6033                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6034             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6035                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6036
  6037         16  CF-DOMICILE-STATE              PIC XX.
  6038
  6039         16  CF-EXPENSE-CONTROLS.
  6040             20  CF-EXPENSE-METHOD          PIC X.
  6041                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6042                 88  DOLLARS-PER-PMT            VALUE '2'.
  6043                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6044                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6045             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6046             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6047
  6048         16  CF-CORRESPONDENCE-CONTROL.
  6049             20  CF-LETTER-RESEND-OPT       PIC X.
  6050                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6051                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6052             20  FILLER                     PIC X(4).
  6053
  6054         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 112
* EL050.cbl
  6055             20  CF-MANUAL-SW               PIC X.
  6056                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6057             20  CF-FUTURE-SW               PIC X.
  6058                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6059             20  CF-PTC-SW                  PIC X.
  6060                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6061             20  CF-IBNR-SW                 PIC X.
  6062                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6063             20  CF-PTC-LF-SW               PIC X.
  6064                 88  CF-LF-PTC-USED             VALUE '1'.
  6065             20  CF-CDT-ACCESS-METHOD       PIC X.
  6066                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6067                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6068                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6069             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6070
  6071         16  CF-CLAIM-CALC-METHOD           PIC X.
  6072             88  360-PLUS-MONTHS                VALUE '1'.
  6073             88  365-PLUS-MONTHS                VALUE '2'.
  6074             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6075             88  360-DAILY                      VALUE '4'.
  6076             88  365-DAILY                      VALUE '5'.
  6077
  6078         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6079         16  FILLER                         PIC X(11).
  6080
  6081         16  CF-LIMIT-AMOUNTS.
  6082             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6083             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6084             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6085             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6086             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6087             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6088             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6089             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6090             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6091             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6092
  6093         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6094         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6095         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6096
  6097         16  CF-ZIP-CODE.
  6098             20  CF-ZIP-PRIME.
  6099                 24  CF-ZIP-1ST             PIC X.
  6100                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6101                 24  FILLER                 PIC X(4).
  6102             20  CF-ZIP-PLUS4               PIC X(4).
  6103         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6104             20  CF-CAN-POSTAL-1            PIC XXX.
  6105             20  CF-CAN-POSTAL-2            PIC XXX.
  6106             20  FILLER                     PIC XXX.
  6107
  6108         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6109         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6110         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6111
  6112         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 113
* EL050.cbl
  6113             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6114             88  CF-NO-RATING                   VALUE 'N'.
  6115
  6116         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6117
  6118         16  CF-CARRIER-OVER-SHORT.
  6119             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6120             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6121
  6122         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6123         16  CF-SECPAY-SWITCH               PIC X.
  6124             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6125             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6126         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6127         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6128         16  FILLER                         PIC X(444).
  6129*        16  FILLER                         PIC X(452).
  6130
  6131
  6132****************************************************************
  6133*             MORTALITY MASTER RECORD                          *
  6134****************************************************************
  6135
  6136     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6137         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6138                                INDEXED BY CF-MORT-NDX.
  6139             20  CF-MORT-TABLE              PIC X(5).
  6140             20  CF-MORT-TABLE-TYPE         PIC X.
  6141                 88  CF-MORT-JOINT              VALUE 'J'.
  6142                 88  CF-MORT-SINGLE             VALUE 'S'.
  6143                 88  CF-MORT-COMBINED           VALUE 'C'.
  6144                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6145                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6146             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6147             20  CF-MORT-AGE-METHOD         PIC XX.
  6148                 88  CF-AGE-LAST                VALUE 'AL'.
  6149                 88  CF-AGE-NEAR                VALUE 'AN'.
  6150             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6151             20  CF-MORT-ADJUSTMENT-DIRECTION
  6152                                            PIC X.
  6153                 88  CF-MINUS                   VALUE '-'.
  6154                 88  CF-PLUS                    VALUE '+'.
  6155             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6156             20  CF-MORT-JOINT-CODE         PIC X.
  6157                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6158             20  CF-MORT-PC-Q               PIC X.
  6159                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6160             20  CF-MORT-TABLE-CODE         PIC X(4).
  6161             20  CF-MORT-COMMENTS           PIC X(15).
  6162             20  FILLER                     PIC X(14).
  6163
  6164         16  FILLER                         PIC X(251).
  6165
  6166
  6167****************************************************************
  6168*             BUSSINESS TYPE MASTER RECORD                     *
  6169****************************************************************
  6170
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 114
* EL050.cbl
  6171     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6172* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6173* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6174* AND RECORD 05 IS TYPES 81-99
  6175         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6176             20  CF-BUSINESS-TITLE          PIC  X(19).
  6177             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6178                                            PIC S9V9(4) COMP-3.
  6179             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6180             20  FILLER                     PIC  X.
  6181         16  FILLER                         PIC  X(248).
  6182
  6183
  6184****************************************************************
  6185*             TERMINAL MASTER RECORD                           *
  6186****************************************************************
  6187
  6188     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6189
  6190         16  CF-COMPANY-TERMINALS.
  6191             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6192                                  PIC X(4).
  6193         16  FILLER               PIC X(248).
  6194
  6195
  6196****************************************************************
  6197*             LIFE EDIT MASTER RECORD                          *
  6198****************************************************************
  6199
  6200     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6201         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6202             20  CF-LIFE-CODE-IN            PIC XX.
  6203             20  CF-LIFE-CODE-OUT           PIC XX.
  6204         16  FILLER                         PIC X(248).
  6205
  6206
  6207****************************************************************
  6208*             AH EDIT MASTER RECORD                            *
  6209****************************************************************
  6210
  6211     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6212         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6213             20  CF-AH-CODE-IN              PIC XXX.
  6214             20  CF-AH-CODE-OUT             PIC XX.
  6215         16  FILLER                         PIC X(248).
  6216
  6217
  6218****************************************************************
  6219*             CREDIBILITY TABLES                               *
  6220****************************************************************
  6221
  6222     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6223         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6224                             INDEXED BY CF-CRDB-NDX.
  6225             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6226             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6227             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6228         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 115
* EL050.cbl
  6229
  6230
  6231****************************************************************
  6232*             REPORT CUSTOMIZATION RECORD                      *
  6233****************************************************************
  6234
  6235     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6236         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6237             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6238             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6239             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6240**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6241****       A T-TRANSFER.                                   ****
  6242             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6243
  6244         16  FILLER                         PIC XX.
  6245
  6246         16  CF-CARRIER-CNTL-OPT.
  6247             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6248                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6249                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6250             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6251                                            PIC X.
  6252         16  CF-GROUP-CNTL-OPT.
  6253             20  CF-GROUP-OPT-SEQ           PIC 9.
  6254                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6255                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6256             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6257                                            PIC X(6).
  6258         16  CF-STATE-CNTL-OPT.
  6259             20  CF-STATE-OPT-SEQ           PIC 9.
  6260                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6261                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6262             20  CF-STATE-SELECT OCCURS 3 TIMES
  6263                                            PIC XX.
  6264         16  CF-ACCOUNT-CNTL-OPT.
  6265             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6266                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6267                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6268             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6269                                            PIC X(10).
  6270         16  CF-BUS-TYP-CNTL-OPT.
  6271             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6272                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6273                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6274             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6275                                            PIC XX.
  6276         16  CF-LF-TYP-CNTL-OPT.
  6277             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6278                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6279                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6280             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6281                                            PIC XX.
  6282         16  CF-AH-TYP-CNTL-OPT.
  6283             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6284                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6285                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6286             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 116
* EL050.cbl
  6287                                            PIC XX.
  6288         16  CF-REPTCD1-CNTL-OPT.
  6289             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6290                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6291                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6292             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6293                                            PIC X(10).
  6294         16  CF-REPTCD2-CNTL-OPT.
  6295             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6296                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6297                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6298             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6299                                            PIC X(10).
  6300         16  CF-USER1-CNTL-OPT.
  6301             20  CF-USER1-OPT-SEQ           PIC 9.
  6302                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6303                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6304             20  CF-USER1-SELECT OCCURS 3 TIMES
  6305                                            PIC X(10).
  6306         16  CF-USER2-CNTL-OPT.
  6307             20  CF-USER2-OPT-SEQ           PIC 9.
  6308                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6309                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6310             20  CF-USER2-SELECT OCCURS 3 TIMES
  6311                                            PIC X(10).
  6312         16  CF-USER3-CNTL-OPT.
  6313             20  CF-USER3-OPT-SEQ           PIC 9.
  6314                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6315                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6316             20  CF-USER3-SELECT OCCURS 3 TIMES
  6317                                            PIC X(10).
  6318         16  CF-USER4-CNTL-OPT.
  6319             20  CF-USER4-OPT-SEQ           PIC 9.
  6320                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6321                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6322             20  CF-USER4-SELECT OCCURS 3 TIMES
  6323                                            PIC X(10).
  6324         16  CF-USER5-CNTL-OPT.
  6325             20  CF-USER5-OPT-SEQ           PIC 9.
  6326                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6327                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6328             20  CF-USER5-SELECT OCCURS 3 TIMES
  6329                                            PIC X(10).
  6330         16  CF-REINS-CNTL-OPT.
  6331             20  CF-REINS-OPT-SEQ           PIC 9.
  6332                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6333                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6334             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6335                 24  CF-REINS-PRIME         PIC XXX.
  6336                 24  CF-REINS-SUB           PIC XXX.
  6337
  6338         16  CF-AGENT-CNTL-OPT.
  6339             20  CF-AGENT-OPT-SEQ           PIC 9.
  6340                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6341                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6342             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6343                                            PIC X(10).
  6344
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 117
* EL050.cbl
  6345         16  FILLER                         PIC X(43).
  6346
  6347         16  CF-LOSS-RATIO-SELECT.
  6348             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6349             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6350         16  CF-ENTRY-DATE-SELECT.
  6351             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6352             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6353         16  CF-EFFECTIVE-DATE-SELECT.
  6354             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6355             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6356
  6357         16  CF-EXCEPTION-LIST-IND          PIC X.
  6358             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6359
  6360         16  FILLER                         PIC X(318).
  6361
  6362****************************************************************
  6363*                  EXCEPTION REPORTING RECORD                  *
  6364****************************************************************
  6365
  6366     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6367         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6368             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6369
  6370         16  CF-COMBINED-LIFE-AH-OPT.
  6371             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6372             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6373             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6374             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6375
  6376         16  CF-LIFE-OPT.
  6377             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6378             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6379             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6380             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6381             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6382             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6383             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6384             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6385             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6386             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6387
  6388         16  CF-AH-OPT.
  6389             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6390             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6391             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6392             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6393             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6394             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6395             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6396             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6397             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6398             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6399
  6400         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6401             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6402             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 118
* EL050.cbl
  6403             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6404
  6405         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6406
  6407         16  FILLER                         PIC X(673).
  6408
  6409
  6410****************************************************************
  6411*             MORTGAGE SYSTEM PLAN RECORD                      *
  6412****************************************************************
  6413
  6414     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6415         16  CF-PLAN-TYPE                   PIC X.
  6416             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6417             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6418             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6419         16  CF-PLAN-ABBREV                 PIC XXX.
  6420         16  CF-PLAN-DESCRIPT               PIC X(10).
  6421         16  CF-PLAN-NOTES                  PIC X(20).
  6422         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6423         16  CF-PLAN-UNDERWRITING.
  6424             20  CF-PLAN-TERM-DATA.
  6425                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6426                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6427             20  CF-PLAN-AGE-DATA.
  6428                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6429                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6430                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6431             20  CF-PLAN-BENEFIT-DATA.
  6432                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6433                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6434                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6435                                            PIC S9(7)V99  COMP-3.
  6436         16  CF-PLAN-POLICY-FORMS.
  6437             20  CF-POLICY-FORM             PIC X(12).
  6438             20  CF-MASTER-APPLICATION      PIC X(12).
  6439             20  CF-MASTER-POLICY           PIC X(12).
  6440         16  CF-PLAN-RATING.
  6441             20  CF-RATE-CODE               PIC X(5).
  6442             20  CF-SEX-RATING              PIC X.
  6443                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6444                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6445             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6446             20  CF-SUB-STD-TYPE            PIC X.
  6447                 88  CF-PCT-OF-PREM            VALUE '1'.
  6448                 88  CF-PCT-OF-BENE            VALUE '2'.
  6449         16  CF-PLAN-PREM-TOLERANCES.
  6450             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6451             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6452         16  CF-PLAN-PYMT-TOLERANCES.
  6453             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6454             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6455         16  CF-PLAN-MISC-DATA.
  6456             20  FILLER                     PIC X.
  6457             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6458             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6459         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6460         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 119
* EL050.cbl
  6461             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6462                                                     '1'.
  6463             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6464                                                     '2'.
  6465         16  CF-MIB-SEARCH-SW               PIC X.
  6466             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6467             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6468             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6469             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6470         16  CF-ALPHA-SEARCH-SW             PIC X.
  6471             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6472             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6473             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6474             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6475             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6476             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6477             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6478             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6479             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6480             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6481                                                     'A' 'B' 'C'
  6482                                                     'X' 'Y' 'Z'.
  6483         16  CF-EFF-DT-RULE-SW              PIC X.
  6484             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6485             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6486             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6487             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6488             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6489         16  FILLER                         PIC X(4).
  6490         16  CF-HEALTH-QUESTIONS            PIC X.
  6491             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6492         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6493         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6494         16  CF-PLAN-SNGL-JNT               PIC X.
  6495             88  CF-COMBINED-PLAN              VALUE 'C'.
  6496             88  CF-JNT-PLAN                   VALUE 'J'.
  6497             88  CF-SNGL-PLAN                  VALUE 'S'.
  6498         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6499         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6500         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6501         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6502         16  CF-RERATE-CNTL                 PIC  X.
  6503             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6504             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6505             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6506             88  CF-AUTO-RECALC                 VALUE '4'.
  6507         16  CF-BENEFIT-TYPE                PIC  X.
  6508             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6509             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6510         16  CF-POLICY-FEE                  PIC S999V99
  6511                                                    COMP-3.
  6512         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6513         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6514         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6515         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6516         16  FILLER                         PIC  X(32).
  6517         16  CF-TERMINATION-FORM            PIC  X(04).
  6518         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 120
* EL050.cbl
  6519         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6520                                                       COMP-3.
  6521         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6522         16  CF-ISSUE-LETTER                PIC  X(4).
  6523         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6524         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6525             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6526             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6527         16  CF-MP-REFUND-CALC              PIC X.
  6528             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6529             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6530             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6531             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6532             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6533             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6534             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6535             88  CF-MP-REFD-MEAN                VALUE '8'.
  6536         16  CF-ALT-RATE-CODE               PIC  X(5).
  6537
  6538
  6539         16  FILLER                         PIC X(498).
  6540****************************************************************
  6541*             MORTGAGE COMPANY MASTER RECORD                   *
  6542****************************************************************
  6543
  6544     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6545         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6546         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6547             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6548             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6549             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6550             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6551             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6552
  6553         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6554         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6555         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6556         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6557         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6558
  6559         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6560             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6561         16  CF-MP-RECON-USE-IND            PIC X(1).
  6562             88  CF-MP-USE-RECON             VALUE 'Y'.
  6563         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6564             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6565         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6566             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6567             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6568         16  FILLER                         PIC X(1).
  6569         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6570             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6571         16  CF-MORTG-MIB-VERSION           PIC X.
  6572             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6573             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6574             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6575         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6576             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 121
* EL050.cbl
  6577                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6578             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6579                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6580             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6581                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6582             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6583                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6584             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6585                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6586             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6587                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6588         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6589         16  FILLER                         PIC X(7).
  6590         16  CF-MORTG-DESTINATION-SYMBOL.
  6591             20  CF-MORTG-MIB-COMM          PIC X(5).
  6592             20  CF-MORTG-MIB-TERM          PIC X(5).
  6593         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6594             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6595         16  FILLER                         PIC X(03).
  6596         16  CF-MP-CHECK-NO-CONTROL.
  6597             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6598                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6599                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6600                                                ' ' LOW-VALUES.
  6601                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6602                                               VALUE '3'.
  6603         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6604         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6605         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6606             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6607                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6608             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6609                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6610             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6611                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6612             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6613                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6614             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6615                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6616             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6617                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6618         16  CF-MORTG-BILLING-AREA.
  6619             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6620                                            PIC X.
  6621         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6622         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6623         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6624         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6625             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6626             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6627         16  FILLER                         PIC X.
  6628         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6629             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6630             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6631         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6632         16  FILLER                         PIC X(8).
  6633         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6634         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 122
* EL050.cbl
  6635         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6636         16  CF-ACH-COMPANY-ID.
  6637             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6638                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6639                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6640                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6641             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6642         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6643             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6644         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6645             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6646             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6647         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6648         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6649         16  FILLER                         PIC X(536).
  6650
  6651****************************************************************
  6652*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6653****************************************************************
  6654
  6655     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6656         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6657             20  CF-FEMALE-HEIGHT.
  6658                 24  CF-FEMALE-FT           PIC 99.
  6659                 24  CF-FEMALE-IN           PIC 99.
  6660             20  CF-FEMALE-MIN-WT           PIC 999.
  6661             20  CF-FEMALE-MAX-WT           PIC 999.
  6662         16  FILLER                         PIC X(428).
  6663
  6664     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6665         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6666             20  CF-MALE-HEIGHT.
  6667                 24  CF-MALE-FT             PIC 99.
  6668                 24  CF-MALE-IN             PIC 99.
  6669             20  CF-MALE-MIN-WT             PIC 999.
  6670             20  CF-MALE-MAX-WT             PIC 999.
  6671         16  FILLER                         PIC X(428).
  6672******************************************************************
  6673*             AUTOMATIC ACTIVITY RECORD                          *
  6674******************************************************************
  6675     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6676         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6677             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6678             20  CF-SYS-LETTER-ID           PIC X(04).
  6679             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6680             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6681             20  CF-SYS-RESET-SW            PIC X(01).
  6682             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6683             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6684
  6685         16  FILLER                         PIC X(50).
  6686
  6687         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6688             20  CF-USER-ACTIVE-SW          PIC X(01).
  6689             20  CF-USER-LETTER-ID          PIC X(04).
  6690             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6691             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6692             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 123
* EL050.cbl
  6693             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6694             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6695             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6696
  6697         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 124
* EL050.cbl
  6699*    COPY ERCACCT.
  6700******************************************************************
  6701*                                                                *
  6702*                                                                *
  6703*                            ERCACCT                             *
  6704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6705*                            VMOD=2.031                          *
  6706*                                                                *
  6707*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6708*                                                                *
  6709*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6710*   VSAM ACCOUNT MASTER FILES.                                   *
  6711*                                                                *
  6712*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6713*                                                                *
  6714*   FILE TYPE = VSAM,KSDS                                        *
  6715*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6716*                                                                *
  6717*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6718*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6719*                                                                *
  6720*   LOG = NO                                                     *
  6721*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6722*                                                                *
  6723*                                                                *
  6724******************************************************************
  6725*                   C H A N G E   L O G
  6726*
  6727* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6728*-----------------------------------------------------------------
  6729*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6730* EFFECTIVE    NUMBER
  6731*-----------------------------------------------------------------
  6732* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6733* 092705    2005050300006  PEMA  ADD SPP LEASES
  6734* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6735* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6736* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6737* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6738* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6739* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6740******************************************************************
  6741
  6742 01  ACCOUNT-MASTER.
  6743     12  AM-RECORD-ID                      PIC XX.
  6744         88  VALID-AM-ID                      VALUE 'AM'.
  6745
  6746     12  AM-CONTROL-PRIMARY.
  6747         16  AM-COMPANY-CD                 PIC X.
  6748         16  AM-MSTR-CNTRL.
  6749             20  AM-CONTROL-A.
  6750                 24  AM-CARRIER            PIC X.
  6751                 24  AM-GROUPING.
  6752                     28 AM-GROUPING-PREFIX PIC XXX.
  6753                     28 AM-GROUPING-PRIME  PIC XXX.
  6754                 24  AM-STATE              PIC XX.
  6755                 24  AM-ACCOUNT.
  6756                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 125
* EL050.cbl
  6757                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6758             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6759                                           PIC X(19).
  6760             20  AM-CNTRL-B.
  6761                 24  AM-EXPIRATION-DT      PIC XX.
  6762                 24  FILLER                PIC X(4).
  6763             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6764                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6765
  6766     12  AM-CONTROL-BY-VAR-GRP.
  6767         16  AM-COMPANY-CD-A1              PIC X.
  6768         16  AM-VG-CARRIER                 PIC X.
  6769         16  AM-VG-GROUPING                PIC X(6).
  6770         16  AM-VG-STATE                   PIC XX.
  6771         16  AM-VG-ACCOUNT                 PIC X(10).
  6772         16  AM-VG-DATE.
  6773             20  AM-VG-EXPIRATION-DT       PIC XX.
  6774             20  FILLER                    PIC X(4).
  6775         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6776                                           PIC 9(11)      COMP-3.
  6777     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6778         16  FILLER                        PIC X(10).
  6779         16  AM-VG-KEY3.
  6780             20  AM-VG3-ACCOUNT            PIC X(10).
  6781             20  AM-VG3-EXP-DT             PIC XX.
  6782         16  FILLER                        PIC X(4).
  6783     12  AM-MAINT-INFORMATION.
  6784         16  AM-LAST-MAINT-DT              PIC XX.
  6785         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6786         16  AM-LAST-MAINT-USER            PIC X(4).
  6787         16  FILLER                        PIC XX.
  6788
  6789     12  AM-EFFECTIVE-DT                   PIC XX.
  6790     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6791
  6792     12  AM-PREV-DATES  COMP-3.
  6793         16  AM-PREV-EXP-DT                PIC 9(11).
  6794         16  AM-PREV-EFF-DT                PIC 9(11).
  6795
  6796     12  AM-REPORT-CODE-1                  PIC X(10).
  6797     12  AM-REPORT-CODE-2                  PIC X(10).
  6798
  6799     12  AM-CITY-CODE                      PIC X(4).
  6800     12  AM-COUNTY-PARISH                  PIC X(6).
  6801
  6802     12  AM-NAME                           PIC X(30).
  6803     12  AM-PERSON                         PIC X(30).
  6804     12  AM-ADDRS                          PIC X(30).
  6805     12  AM-CITY.
  6806         16  AM-ADDR-CITY                  PIC X(28).
  6807         16  AM-ADDR-STATE                 PIC XX.
  6808     12  AM-ZIP.
  6809         16  AM-ZIP-PRIME.
  6810             20  AM-ZIP-PRI-1ST            PIC X.
  6811                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6812             20  FILLER                    PIC X(4).
  6813         16  AM-ZIP-PLUS4                  PIC X(4).
  6814     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 126
* EL050.cbl
  6815         16  AM-CAN-POSTAL-1               PIC XXX.
  6816         16  AM-CAN-POSTAL-2               PIC XXX.
  6817         16  FILLER                        PIC XXX.
  6818     12  AM-TEL-NO.
  6819         16  AM-AREA-CODE                  PIC 999.
  6820         16  AM-TEL-PRE                    PIC 999.
  6821         16  AM-TEL-NBR                    PIC 9(4).
  6822     12  AM-TEL-LOC                        PIC X.
  6823         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6824         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6825
  6826     12  AM-COMM-STRUCTURE.
  6827         16  AM-DEFN-1.
  6828             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6829                 24  AM-AGT.
  6830                     28  AM-AGT-PREFIX     PIC X(4).
  6831                     28  AM-AGT-PRIME      PIC X(6).
  6832                 24  AM-COM-TYP            PIC X.
  6833                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6834                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6835                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6836                 24  AM-RECALC-LV-INDIC    PIC X.
  6837                 24  AM-RETRO-LV-INDIC     PIC X.
  6838                 24  AM-GL-CODES           PIC X.
  6839                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6840                 24  FILLER                PIC X(01).
  6841         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6842             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6843                 24  FILLER                PIC X(11).
  6844                 24  AM-L-COMA             PIC XXX.
  6845                 24  AM-J-COMA             PIC XXX.
  6846                 24  AM-A-COMA             PIC XXX.
  6847                 24  FILLER                PIC X(6).
  6848
  6849     12  AM-COMM-CHANGE-STATUS             PIC X.
  6850         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6851
  6852     12  AM-CSR-CODE                       PIC X(4).
  6853
  6854     12  AM-BILLING-STATUS                 PIC X.
  6855         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6856         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6857     12  AM-AUTO-REFUND-SW                 PIC X.
  6858         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6859         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6860     12  AM-GPCD                           PIC 99.
  6861     12  AM-IG                             PIC X.
  6862         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6863         88  AM-HAS-GROUP                     VALUE '2'.
  6864     12  AM-STATUS                         PIC X.
  6865         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6866         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6867         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6868         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6869         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6870         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6871         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6872         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 127
* EL050.cbl
  6873         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6874         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6875     12  AM-REMIT-TO                       PIC 99.
  6876     12  AM-ID-NO                          PIC X(11).
  6877
  6878     12  AM-CAL-TABLE                      PIC XX.
  6879     12  AM-LF-DEVIATION                   PIC XXX.
  6880     12  AM-AH-DEVIATION                   PIC XXX.
  6881     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6882     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6883     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6884     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6885     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6886     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6887
  6888     12  AM-USER-FIELDS.
  6889         16  AM-FLD-1                      PIC XX.
  6890         16  AM-FLD-2                      PIC XX.
  6891         16  AM-FLD-3                      PIC XX.
  6892         16  AM-FLD-4                      PIC XX.
  6893         16  AM-FLD-5                      PIC XX.
  6894
  6895     12  AM-1ST-PROD-DATE.
  6896         16  AM-1ST-PROD-YR                PIC XX.
  6897         16  AM-1ST-PROD-MO                PIC XX.
  6898         16  AM-1ST-PROD-DA                PIC XX.
  6899     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6900     12  AM-CERTS-PURGED-DATE.
  6901         16  AM-PUR-YR                     PIC XX.
  6902         16  AM-PUR-MO                     PIC XX.
  6903         16  AM-PUR-DA                     PIC XX.
  6904     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6905     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6906     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6907     12  AM-INACTIVE-DATE.
  6908         16  AM-INA-MO                     PIC 99.
  6909         16  AM-INA-DA                     PIC 99.
  6910         16  AM-INA-YR                     PIC 99.
  6911     12  AM-AR-HI-CERT-DATE                PIC XX.
  6912
  6913     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6914     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6915
  6916     12  AM-OB-PAYMENT-MODE                PIC X.
  6917         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6918         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6919         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6920         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6921
  6922     12  AM-AH-ONLY-INDICATOR              PIC X.
  6923         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6924         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6925
  6926     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6927
  6928     12  AM-OVER-SHORT.
  6929         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6930         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 128
* EL050.cbl
  6931
  6932     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6933     12  AM-DCC-CLP-STATE                  PIC XX.
  6934
  6935     12  AM-RECALC-COMM                    PIC X.
  6936     12  AM-RECALC-REIN                    PIC X.
  6937
  6938     12  AM-REI-TABLE                      PIC XXX.
  6939     12  AM-REI-ET-LF                      PIC X.
  6940     12  AM-REI-ET-AH                      PIC X.
  6941     12  AM-REI-PE-LF                      PIC X.
  6942     12  AM-REI-PE-AH                      PIC X.
  6943     12  AM-REI-PRT-ST                     PIC X.
  6944     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6945     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6946     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6947     12  AM-REI-GROUP-A                    PIC X(6).
  6948     12  AM-REI-MORT                       PIC X(4).
  6949     12  AM-REI-PRT-OW                     PIC X.
  6950     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6951     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6952     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6953     12  AM-REI-GROUP-B                    PIC X(6).
  6954
  6955     12  AM-TRUST-TYPE                     PIC X(2).
  6956
  6957     12  AM-EMPLOYER-STMT-USED             PIC X.
  6958     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6959
  6960     12  AM-STD-AH-TYPE                    PIC XX.
  6961     12  AM-EARN-METHODS.
  6962         16  AM-EARN-METHOD-R              PIC X.
  6963             88 AM-REF-RL-R78                 VALUE 'R'.
  6964             88 AM-REF-RL-PR                  VALUE 'P'.
  6965             88 AM-REF-RL-MEAN                VALUE 'M'.
  6966             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6967         16  AM-EARN-METHOD-L              PIC X.
  6968             88 AM-REF-LL-R78                 VALUE 'R'.
  6969             88 AM-REF-LL-PR                  VALUE 'P'.
  6970             88 AM-REF-LL-MEAN                VALUE 'M'.
  6971             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6972         16  AM-EARN-METHOD-A              PIC X.
  6973             88 AM-REF-AH-R78                 VALUE 'R'.
  6974             88 AM-REF-AH-PR                  VALUE 'P'.
  6975             88 AM-REF-AH-MEAN                VALUE 'M'.
  6976             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6977             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6978             88 AM-REF-AH-NET                 VALUE 'N'.
  6979
  6980     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6981     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6982     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6983
  6984     12  AM-RET-Y-N                        PIC X.
  6985     12  AM-RET-P-E                        PIC X.
  6986     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6987     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6988     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 129
* EL050.cbl
  6989     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6990         16  AM-POOL-PRIME                 PIC XXX.
  6991         16  AM-POOL-SUB                   PIC XXX.
  6992     12  AM-RETRO-EARNINGS.
  6993         16  AM-RET-EARN-R                 PIC X.
  6994         16  AM-RET-EARN-L                 PIC X.
  6995         16  AM-RET-EARN-A                 PIC X.
  6996     12  AM-RET-ST-TAX-USE                 PIC X.
  6997         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6998         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6999     12  AM-RETRO-BEG-EARNINGS.
  7000         16  AM-RET-BEG-EARN-R             PIC X.
  7001         16  AM-RET-BEG-EARN-L             PIC X.
  7002         16  AM-RET-BEG-EARN-A             PIC X.
  7003     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  7004     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  7005
  7006     12  AM-USER-SELECT-OPTIONS.
  7007         16  AM-USER-SELECT-1              PIC X(10).
  7008         16  AM-USER-SELECT-2              PIC X(10).
  7009         16  AM-USER-SELECT-3              PIC X(10).
  7010         16  AM-USER-SELECT-4              PIC X(10).
  7011         16  AM-USER-SELECT-5              PIC X(10).
  7012
  7013     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7014
  7015     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7016
  7017     12  AM-RPT045A-SWITCH                 PIC X.
  7018         88  RPT045A-OFF                   VALUE 'N'.
  7019
  7020     12  AM-INSURANCE-LIMITS.
  7021         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7022         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7023
  7024     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7025         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7026
  7027     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7028         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7029         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7030
  7031     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7032
  7033     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7034     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7035     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7036     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7037     12  AM-DCC-UEF-STATE                  PIC XX.
  7038     12  FILLER                            PIC XXX.
  7039     12  AM-REPORT-CODE-3                  PIC X(10).
  7040*    12  FILLER                            PIC X(22).
  7041
  7042     12  AM-RESERVE-DATE.
  7043         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7044         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7045         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7046
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 130
* EL050.cbl
  7047     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7048     12  AM-NOTIFICATION-TYPES.
  7049         16  AM-NOTIF-OF-LETTERS           PIC X.
  7050         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7051         16  AM-NOTIF-OF-REPORTS           PIC X.
  7052         16  AM-NOTIF-OF-STATUS            PIC X.
  7053
  7054     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7055         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7056         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7057         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7058         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7059
  7060     12  AM-BENEFIT-CONTROLS.
  7061         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7062             20  AM-BENEFIT-CODE           PIC XX.
  7063             20  AM-BENEFIT-TYPE           PIC X.
  7064             20  AM-BENEFIT-REVISION       PIC XXX.
  7065             20  AM-BENEFIT-REM-TERM       PIC X.
  7066             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7067             20  FILLER                    PIC XX.
  7068         16  FILLER                        PIC X(80).
  7069
  7070     12  AM-TRANSFER-DATA.
  7071         16  AM-TRANSFERRED-FROM.
  7072             20  AM-TRNFROM-CARRIER        PIC X.
  7073             20  AM-TRNFROM-GROUPING.
  7074                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7075                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7076             20  AM-TRNFROM-STATE          PIC XX.
  7077             20  AM-TRNFROM-ACCOUNT.
  7078                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7079                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7080             20  AM-TRNFROM-DTE            PIC XX.
  7081         16  AM-TRANSFERRED-TO.
  7082             20  AM-TRNTO-CARRIER          PIC X.
  7083             20  AM-TRNTO-GROUPING.
  7084                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7085                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7086             20  AM-TRNTO-STATE            PIC XX.
  7087             20  AM-TRNTO-ACCOUNT.
  7088                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7089                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7090             20  AM-TRNTO-DTE              PIC XX.
  7091         16  FILLER                        PIC X(10).
  7092
  7093     12  AM-SAVED-REMIT-TO                 PIC 99.
  7094
  7095     12  AM-COMM-STRUCTURE-SAVED.
  7096         16  AM-DEFN-1-SAVED.
  7097             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7098                 24  AM-AGT-SV             PIC X(10).
  7099                 24  AM-COM-TYP-SV         PIC X.
  7100                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7101                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7102                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7103                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7104                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 131
* EL050.cbl
  7105                 24  AM-GL-CODES-SV        PIC X.
  7106                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7107                 24  FILLER                PIC X.
  7108         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7109             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7110                 24  FILLER                PIC X(11).
  7111                 24  AM-L-COMA-SV          PIC XXX.
  7112                 24  AM-J-COMA-SV          PIC XXX.
  7113                 24  AM-A-COMA-SV          PIC XXX.
  7114                 24  FILLER                PIC X(6).
  7115
  7116     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7117         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7118            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7119            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7120            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7121
  7122     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7123     12  FILLER                            PIC X(120).
  7124
  7125     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7126         16  AM-CONTROL-NAME               PIC X(30).
  7127         16  AM-EXECUTIVE-ONE.
  7128             20  AM-EXEC1-NAME             PIC X(15).
  7129             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7130                                                          COMP-3.
  7131             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7132                                                          COMP-3.
  7133         16  AM-EXECUTIVE-TWO.
  7134             20  AM-EXEC2-NAME             PIC X(15).
  7135             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7136                                                          COMP-3.
  7137             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7138                                                          COMP-3.
  7139
  7140     12  AM-RETRO-ADDITIONAL-DATA.
  7141         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7142         16  AM-RETRO-PREM-P-E             PIC X.
  7143         16  AM-RETRO-CLMS-P-I             PIC X.
  7144         16  AM-RETRO-RET-BRACKET-LF.
  7145             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7146                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7147                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7148             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7149                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7150                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7151             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7152                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7153                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7154         16  AM-RETRO-RET-BRACKET-AH.
  7155             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7156                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7157                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7158                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7159             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7160                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7161                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7162             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 132
* EL050.cbl
  7163                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7164                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7165
  7166     12  AM-COMMENTS.
  7167         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7168
  7169     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7170         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7171         16  AM-FLI-BILLING-CODE           PIC X.
  7172         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7173         16  AM-FLI-UNITED-IDENT           PIC X.
  7174         16  AM-FLI-INTEREST-LOST-DATA.
  7175             20  AM-FLI-BANK-NO            PIC X(5).
  7176             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7177             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7178             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7179         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7180             20  AM-FLI-AGT                PIC X(9).
  7181             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7182             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7183         16  FILLER                        PIC X(102).
  7184
  7185     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7186         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7187             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7188             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7189             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7190             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7191             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7192         16  FILLER                          PIC X(10).
  7193******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 133
* EL050.cbl
  7195*    COPY ERCREIN.
  7196******************************************************************
  7197*                                                                *
  7198*                            ERCREIN                             *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.010                          *
  7201*                                                                *
  7202*   ONLINE CREDIT SYSTEM                                         *
  7203*                                                                *
  7204*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7205*                                                                *
  7206*   FILE TYPE = VSAM,KSDS                                        *
  7207*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7208*                                                                *
  7209*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7210*       ALTERNATE PATH = NONE                                    *
  7211*                                                                *
  7212*   LOG = NO                                                     *
  7213*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7214*                                                                *
  7215******************************************************************
  7216*                   C H A N G E   L O G
  7217*
  7218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7219*-----------------------------------------------------------------
  7220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7221* EFFECTIVE    NUMBER
  7222*-----------------------------------------------------------------
  7223* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7224* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7225******************************************************************
  7226 01  REINSURANCE-RECORD.
  7227     12  RE-RECORD-ID                      PIC XX.
  7228         88  VALID-RE-ID                      VALUE 'RE'.
  7229
  7230     12  RE-CONTROL-PRIMARY.
  7231         16  RE-COMPANY-CD                 PIC X.
  7232         16  RE-KEY.
  7233             20  RE-CODE                   PIC X.
  7234                 88  RE-TABLE-RECORD          VALUE 'A'.
  7235                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7236             20  RE-TABLE                  PIC XXX.
  7237             20  FILLER                    PIC XXX.
  7238         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7239             20  FILLER                    PIC X.
  7240             20  RE-COMPANY.
  7241                 24  RE-COMP-PRIME         PIC XXX.
  7242                 24  RE-COMP-SUB           PIC XXX.
  7243
  7244     12  RE-MAINT-INFORMATION.
  7245         16  RE-LAST-MAINT-DT              PIC XX.
  7246         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7247         16  RE-LAST-MAINT-USER            PIC X(4).
  7248         16  FILLER                        PIC X(10).
  7249
  7250     12  RE-TABLE-DATA.
  7251         16  RE-100-COMP                   PIC 99.
  7252
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 134
* EL050.cbl
  7253         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7254             20  RE-REI-COMP-NO.
  7255                 24  RE-REI-COMP           PIC XXX.
  7256                 24  RE-REI-COMP-SUB       PIC XXX.
  7257             20  RE-LF-QC                  PIC X.
  7258             20  RE-AH-QC                  PIC X.
  7259             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7260             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7261             20  RE-LFAGE-LO               PIC 99.
  7262             20  RE-LFAGE-HI               PIC 99.
  7263             20  RE-AHAGE-LO               PIC 99.
  7264             20  RE-AHAGE-HI               PIC 99.
  7265             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7266             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7267             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7268             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7269             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7270             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7271             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7272             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7273             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7274             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7275             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7276             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7277             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7278             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7279             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7280             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7281             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7282             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7283             20  RE-LF-BEN-CODE            PIC X.
  7284             20  RE-AH-BEN-CODE            PIC X.
  7285             20  RE-INTERACTIVE            PIC X.
  7286             20  RE-REMAINING              PIC X.
  7287             20  RE-LF-RUNOFF-SW           PIC X.
  7288             20  RE-AH-RUNOFF-SW           PIC X.
  7289             20  FILLER                    PIC X(19).
  7290
  7291         16  RE-COMP-INFO-END              PIC X(6).
  7292         16  RE-NSP-ST-CD-LF               PIC XX.
  7293         16  RE-NSP-ST-CD-AH               PIC XX.
  7294         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7295             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7296
  7297         16  FILLER                        PIC X(27).
  7298
  7299     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7300         16  RE-NAME                       PIC X(30).
  7301         16  RE-LF-PE                      PIC X.
  7302         16  RE-AH-PE                      PIC X.
  7303         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7304         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7305         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7306         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7307         16  RE-PRT-ST                     PIC X.
  7308         16  RE-PRT-OW                     PIC X.
  7309         16  RE-MORT-CODE                  PIC X(4).
  7310         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 135
* EL050.cbl
  7311         16  RE-ZERO-LF-FEE                PIC X.
  7312         16  RE-ZERO-AH-FEE                PIC X.
  7313         16  RE-CEDE-NAME                  PIC X(30).
  7314         16  RE-LF-COMM                    PIC X.
  7315         16  RE-AH-COMM                    PIC X.
  7316         16  RE-LF-TAX                     PIC X.
  7317         16  RE-AH-TAX                     PIC X.
  7318         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7319         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7320         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7321
  7322         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7323             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7324
  7325         16  RE-LF-CEDING-FEE-BRACKETS.
  7326             20  RE-LF-FEE-METHOD          PIC X.
  7327                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7328                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7329                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7330                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7331             20  RE-LF-FEE-BASIS           PIC X.
  7332                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7333                 88  RE-LF-NET-CEDED               VALUE '2'.
  7334                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7335                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7336                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7337                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7338                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7339                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7340             20  FILLER                    PIC XXX.
  7341             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7342                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7343                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7344
  7345         16  RE-AH-CEDING-FEE-BRACKETS.
  7346             20  RE-AH-FEE-METHOD          PIC X.
  7347                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7348                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7349                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7350                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7351             20  RE-AH-FEE-BASIS           PIC X.
  7352                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7353                 88  RE-AH-NET-CEDED               VALUE '2'.
  7354                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7355                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7356                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7357                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7358                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7359                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7360             20  FILLER                    PIC XXX.
  7361             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7362                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7363                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7364
  7365         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7366
  7367         16  RE-OLD-CEDING-STMT            PIC X.
  7368
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 136
* EL050.cbl
  7369         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7370         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7371         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7372         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7373         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7374         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7375         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7376         16  RE-MORT-SW                    PIC X.
  7377         16  RE-CEDING-TYPE-FLAG           PIC X.
  7378             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7379             88  RE-CEDED                          VALUE 'C'.
  7380             88  RE-ASSUMED                        VALUE 'A'.
  7381             88  RE-PHANTOM                        VALUE 'P'.
  7382
  7383         16  RE-CEDING-STMT-OPT-A          PIC X.
  7384             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7385         16  RE-CEDING-STMT-OPT-B          PIC X.
  7386             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7387         16  RE-CEDING-STMT-OPT-C          PIC X.
  7388             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7389         16  RE-CEDING-STMT-OPT-D          PIC X.
  7390             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7391         16  RE-CEDING-STMT-OPT-E          PIC X.
  7392             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7393
  7394         16  RE-PRT-CRSV                   PIC X.
  7395
  7396         16  RE-GL-CENTER                  PIC X(4).
  7397
  7398         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7399
  7400         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7401
  7402         16  RE-EARN-STOP-CODE             PIC X.
  7403             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7404             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7405
  7406         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7407             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7408
  7409         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7410         16  FILLER                        PIC X(2281).
  7411
  7412         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7413
  7414******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 137
* EL050.cbl
  7416*    COPY ERCCTBL.
  7417******************************************************************
  7418*                                                                *
  7419*                                                                *
  7420*                            ERCCTBL                             *
  7421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7422*                            VMOD=2.003
  7423*                                                                *
  7424*   ONLINE CREDIT SYSTEM                                         *
  7425*                                                                *
  7426*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7427*                                                                *
  7428*   FILE TYPE = VSAM,KSDS                                        *
  7429*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7430*                                                                *
  7431*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7432*       ALTERNATE PATH = NONE                                    *
  7433*                                                                *
  7434*   LOG = NO                                                     *
  7435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7436*                                                                *
  7437*                                                                *
  7438******************************************************************
  7439
  7440 01  COMM-TABLE-RECORD.
  7441     12  CT-RECORD-ID                      PIC XX.
  7442         88  VALID-CT-ID                      VALUE 'CT'.
  7443
  7444     12  CT-CONTROL-PRIMARY.
  7445         16  CT-COMPANY-CD                 PIC X.
  7446         16  CT-TABLE                      PIC XXX.
  7447         16  CT-CNTRL-2.
  7448             20  CT-BEN-TYPE               PIC X.
  7449             20  CT-BEN-CODE               PIC XX.
  7450
  7451     12  CT-MAINT-INFORMATION.
  7452         16  CT-LAST-MAINT-DT              PIC XX.
  7453         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7454         16  CT-LAST-MAINT-USER            PIC X(4).
  7455         16  FILLER                        PIC X(31).
  7456
  7457     12  CT-LIMITS.
  7458         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7459
  7460         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7461
  7462         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7463
  7464     12  CT-RATES.
  7465         16  CT-RTX          OCCURS 27 TIMES.
  7466             20  CT-RT                     PIC SV9(5)     COMP-3.
  7467             20  CT-RT-R   REDEFINES
  7468                 CT-RT                     PIC XXX.
  7469
  7470     12  FILLER                            PIC  X(42).
  7471
  7472******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 138
* EL050.cbl
  7474*    COPY ERCFORM.
  7475******************************************************************
  7476*                                                                *
  7477*                                                                *
  7478*                            ERCFORM.                            *
  7479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7480*                            VMOD=2.003                          *
  7481*                                                                *
  7482*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7483*                                                                *
  7484*    FILE TYPE = VSAM,KSDS                                       *
  7485*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7486*                                                                *
  7487*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7488*                                                                *
  7489*    LOG = YES                                                   *
  7490*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7491******************************************************************
  7492 01  FORM-MASTER.
  7493    12  FO-RECORD-ID                 PIC X(02).
  7494        88  VALID-FO-ID                  VALUE 'FO'.
  7495
  7496    12  FO-CONTROL-PRIMARY.
  7497        16  FO-COMPANY-CD            PIC X(01).
  7498        16  FO-STATE                 PIC X(02).
  7499        16  FO-FORM-ID               PIC X(12).
  7500        16  FO-FORM-EXP-DT           PIC X(02).
  7501
  7502    12  FO-POLICY-FORM-DATA.
  7503        16  FO-IND-GRP-CD            PIC X(01).
  7504        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7505        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7506        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7507        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7508        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7509        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7510        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7511        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7512        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7513        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7514        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7515        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7516        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7517        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7518        16  FO-APP-CERT-USE-CD       PIC X(01).
  7519
  7520    12  FILLER                       PIC X(29).
  7521
  7522    12  FO-FORM-PLAN-TABLE.
  7523        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7524            20  FO-PLAN-TYPE         PIC X(01).
  7525            20  FO-PLAN-ID           PIC X(02).
  7526            20  FO-PLAN-TERM         PIC 9(03).
  7527            20  FO-PLAN-REFUND-METHOD
  7528                                     PIC X.
  7529
  7530    12  FILLER                       PIC X(30).
  7531
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 139
* EL050.cbl
  7532    12  FO-COMMENTS-AREA.
  7533        16  FO-COMMENT-LINE-1        PIC X(78).
  7534
  7535    12  FILLER                       PIC X(20).
  7536
  7537    12  FO-MAINT-INFORMATION.
  7538        16  FO-LAST-MAINT-DT         PIC X(02).
  7539        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7540        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 140
* EL050.cbl
  7542*    COPY ELCMSTR.
  7543******************************************************************
  7544*                                                                *
  7545*                            ELCMSTR.                            *
  7546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7547*                            VMOD=2.012                          *
  7548*                                                                *
  7549*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7550*                                                                *
  7551*   FILE TYPE = VSAM,KSDS                                        *
  7552*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7553*                                                                *
  7554*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7555*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7556*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7557*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7558*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7559*                                                 RKP=75,LEN=21  *
  7560*                                                                *
  7561*   **** NOTE ****                                               *
  7562*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7563*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7564*                                                                *
  7565*   LOG = YES                                                    *
  7566*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7567******************************************************************
  7568*                   C H A N G E   L O G
  7569*
  7570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7571*-----------------------------------------------------------------
  7572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7573* EFFECTIVE    NUMBER
  7574*-----------------------------------------------------------------
  7575* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7576* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7577* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7578* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7579* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7580* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7581* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7582******************************************************************
  7583 01  CLAIM-MASTER.
  7584     12  CL-RECORD-ID                PIC XX.
  7585         88  VALID-CL-ID         VALUE 'CL'.
  7586
  7587     12  CL-CONTROL-PRIMARY.
  7588         16  CL-COMPANY-CD           PIC X.
  7589         16  CL-CARRIER              PIC X.
  7590         16  CL-CLAIM-NO             PIC X(7).
  7591         16  CL-CERT-NO.
  7592             20  CL-CERT-PRIME       PIC X(10).
  7593             20  CL-CERT-SFX         PIC X.
  7594
  7595     12  CL-CONTROL-BY-NAME.
  7596         16  CL-COMPANY-CD-A1        PIC X.
  7597         16  CL-INSURED-LAST-NAME    PIC X(15).
  7598         16  CL-INSURED-NAME.
  7599             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 141
* EL050.cbl
  7600             20  CL-INSURED-MID-INIT PIC X.
  7601
  7602     12  CL-CONTROL-BY-SSN.
  7603         16  CL-COMPANY-CD-A2        PIC X.
  7604         16  CL-SOC-SEC-NO.
  7605             20  CL-SSN-STATE        PIC XX.
  7606             20  CL-SSN-ACCOUNT      PIC X(6).
  7607             20  CL-SSN-LN3          PIC X(3).
  7608
  7609     12  CL-CONTROL-BY-CERT-NO.
  7610         16  CL-COMPANY-CD-A4        PIC X.
  7611         16  CL-CERT-NO-A4.
  7612             20  CL-CERT-A4-PRIME    PIC X(10).
  7613             20  CL-CERT-A4-SFX      PIC X.
  7614
  7615     12  CL-CONTROL-BY-CCN.
  7616         16  CL-COMPANY-CD-A5        PIC X.
  7617         16  CL-CCN-A5.
  7618             20  CL-CCN.
  7619                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7620                 24  CL-CCN-PRIME-A5 PIC X(12).
  7621             20  CL-CCN-FILLER-A5    PIC X(4).
  7622
  7623     12  CL-INSURED-PROFILE-DATA.
  7624         16  CL-INSURED-BIRTH-DT     PIC XX.
  7625         16  CL-INSURED-SEX-CD       PIC X.
  7626             88  INSURED-IS-MALE        VALUE 'M'.
  7627             88  INSURED-IS-FEMALE      VALUE 'F'.
  7628             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7629         16  CL-INSURED-OCC-CD       PIC X(6).
  7630         16  FILLER                  PIC X(5).
  7631
  7632     12  CL-PROCESSING-INFO.
  7633         16  CL-PROCESSOR-ID         PIC X(4).
  7634         16  CL-CLAIM-STATUS         PIC X.
  7635             88  CLAIM-IS-OPEN          VALUE 'O'.
  7636             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7637         16  CL-CLAIM-TYPE           PIC X.
  7638*            88  AH-CLAIM               VALUE 'A'.
  7639*            88  LIFE-CLAIM             VALUE 'L'.
  7640*            88  PROPERTY-CLAIM         VALUE 'P'.
  7641*            88  IUI-CLAIM              VALUE 'I'.
  7642*            88  GAP-CLAIM              VALUE 'G'.
  7643*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7644*            88  OTHER-CLAIM            VALUE 'O'.
  7645         16  CL-CLAIM-PREM-TYPE      PIC X.
  7646             88  SINGLE-PREMIUM         VALUE '1'.
  7647             88  O-B-COVERAGE           VALUE '2'.
  7648             88  OPEN-END-COVERAGE      VALUE '3'.
  7649         16  CL-INCURRED-DT          PIC XX.
  7650         16  CL-REPORTED-DT          PIC XX.
  7651         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7652         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7653         16  CL-LAST-PMT-DT          PIC XX.
  7654         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7655         16  CL-PAID-THRU-DT         PIC XX.
  7656         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7657         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 142
* EL050.cbl
  7658         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7659         16  CL-PMT-CALC-METHOD      PIC X.
  7660             88  CL-360-DAY-YR          VALUE '1'.
  7661             88  CL-365-DAY-YR          VALUE '2'.
  7662             88  CL-FULL-MONTHS         VALUE '3'.
  7663         16  CL-CAUSE-CD             PIC X(6).
  7664
  7665         16  CL-PRIME-CERT-NO.
  7666             20  CL-PRIME-CERT-PRIME PIC X(10).
  7667             20  CL-PRIME-CERT-SFX   PIC X.
  7668
  7669         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7670             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7671             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7672
  7673         16  CL-MICROFILM-NO         PIC X(10).
  7674         16  FILLER REDEFINES CL-MICROFILM-NO.
  7675             20  CL-BENEFIT-PERIOD   PIC 99.
  7676             20  FILLER              PIC X(8).
  7677         16  CL-PROG-FORM-TYPE       PIC X.
  7678         16  CL-LAST-ADD-ON-DT       PIC XX.
  7679
  7680         16  CL-LAST-REOPEN-DT       PIC XX.
  7681         16  CL-LAST-CLOSE-DT        PIC XX.
  7682         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7683             88  FINAL-PAID             VALUE '1'.
  7684             88  CLAIM-DENIED           VALUE '2'.
  7685             88  AUTO-CLOSE             VALUE '3'.
  7686             88  MANUAL-CLOSE           VALUE '4'.
  7687             88  BENEFITS-CHANGED       VALUE 'C'.
  7688             88  SETUP-ERRORS           VALUE 'E'.
  7689         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7690         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7691         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7692             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7693         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7694         16  FILLER                  PIC X.
  7695
  7696     12  CL-CERTIFICATE-DATA.
  7697         16  CL-CERT-ORIGIN          PIC X.
  7698             88  CERT-WAS-ONLINE        VALUE '1'.
  7699             88  CERT-WAS-CREATED       VALUE '2'.
  7700             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7701         16  CL-CERT-KEY-DATA.
  7702             20  CL-CERT-CARRIER     PIC X.
  7703             20  CL-CERT-GROUPING    PIC X(6).
  7704             20  CL-CERT-STATE       PIC XX.
  7705             20  CL-CERT-ACCOUNT.
  7706                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7707                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7708             20  CL-CERT-EFF-DT      PIC XX.
  7709
  7710     12  CL-STATUS-CONTROLS.
  7711         16  CL-PRIORITY-CD          PIC X.
  7712             88  CONFIDENTIAL-DATA      VALUE '8'.
  7713             88  HIGHEST-PRIORITY       VALUE '9'.
  7714         16  CL-SUPV-ATTN-CD         PIC X.
  7715             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 143
* EL050.cbl
  7716             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7717         16  CL-PURGED-DT            PIC XX.
  7718         16  CL-RESTORED-DT          PIC XX.
  7719         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7720         16  CL-NEXT-RESEND-DT       PIC XX.
  7721         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7722         16  CL-CRITICAL-PERIOD      PIC 99.
  7723*        16  FILLER                  PIC XX.
  7724         16  CL-LAST-MAINT-DT        PIC XX.
  7725         16  CL-LAST-MAINT-USER      PIC X(4).
  7726         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7727         16  CL-LAST-MAINT-TYPE      PIC X.
  7728             88  CLAIM-SET-UP           VALUE ' '.
  7729             88  PAYMENT-MADE           VALUE '1'.
  7730             88  LETTER-SENT            VALUE '2'.
  7731             88  MASTER-WAS-ALTERED     VALUE '3'.
  7732             88  MASTER-WAS-RESTORED    VALUE '4'.
  7733             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7734             88  FILE-CONVERTED         VALUE '6'.
  7735             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7736             88  ERROR-CORRECTION       VALUE 'E'.
  7737         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7738         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7739         16  CL-BENEFICIARY          PIC X(10).
  7740         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7741         16  CL-DENIAL-TYPE          PIC X.
  7742             88  CL-TYPE-DENIAL          VALUE '1'.
  7743             88  CL-TYPE-RESCISSION      VALUE '2'.
  7744             88  CL-TYPE-REFORMATION     VALUE '3'.
  7745             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7746             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7747         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7748         16  filler                  pic x(3).
  7749*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7750*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7751*        16  CL-RTW-DT               PIC XX.
  7752
  7753     12  CL-TRAILER-CONTROLS.
  7754         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7755             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7756             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7757             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7758         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7759         16  FILLER                  PIC XX.
  7760         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7761         16  CL-ADDRESS-TRAILER-CNT.
  7762             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7763                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7764             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7765                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7766             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7767                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7768             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7769                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7770             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7771                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7772             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7773                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 144
* EL050.cbl
  7774             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7775                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7776
  7777     12  CL-CV-REFERENCE-NO.
  7778         16  CL-CV-REFNO-PRIME       PIC X(18).
  7779         16  CL-CV-REFNO-SFX         PIC XX.
  7780
  7781     12  CL-FILE-LOCATION            PIC X(4).
  7782
  7783     12  CL-PROCESS-ERRORS.
  7784         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7785             88  NO-FATAL-ERRORS        VALUE ZERO.
  7786         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7787             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7788
  7789     12  CL-PRODUCT-CD               PIC X.
  7790
  7791     12  CL-CURRENT-KEY-DATA.
  7792         16  CL-CURRENT-CARRIER      PIC X.
  7793         16  CL-CURRENT-GROUPING     PIC X(6).
  7794         16  CL-CURRENT-STATE        PIC XX.
  7795         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7796
  7797     12  CL-ASSOCIATES               PIC X.
  7798         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7799         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7800         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7801         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7802
  7803     12  CL-ACTIVITY-CODE            PIC 99.
  7804     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7805     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7806
  7807     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7808     12  CL-LAG-REPORT-CODE          PIC 9.
  7809     12  CL-LOAN-TYPE                PIC XX.
  7810     12  CL-LEGAL-STATE              PIC XX.
  7811
  7812     12  CL-YESNOSW                  PIC X.
  7813     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7814         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7815         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7816         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7817     12  cl-insured-type             pic x.
  7818         88  cl-claim-on-primary         value 'P'.
  7819         88  cl-claim-on-co-borrower     value 'C'.
  7820     12  cl-benefit-expiration-dt    PIC XX.
  7821
  7822 01  PLAN-RECORDS.
  7823     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7824     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7825
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 145
* EL050.cbl
  7827 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7828                          ACCOUNT-MASTER REINSURANCE-RECORD
  7829                          COMM-TABLE-RECORD FORM-MASTER
  7830                          CLAIM-MASTER PLAN-RECORDS.
  7831 0000-DFHEXIT SECTION.
  7832     MOVE '9#                    $   ' TO DFHEIV0.
  7833     MOVE 'EL050' TO DFHEIV1.
  7834     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7835
  7836     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7837
  7838
  7839* EXEC CICS  HANDLE CONDITION
  7840*           ERROR    (9300-ABEND)
  7841*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7842*    END-EXEC.
  7843*    MOVE '"$.J                  ! " #00007834' TO DFHEIV0
  7844     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7846     MOVE X'2220233030303037383334' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0
  7848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7849
  7850
  7851 0000-COPY-PROCEDURE-DIV.
  7852*                          COPY ELC50PD.
  7853******************************************************************
  7854*                                                                *
  7855*                            ELC50PD                             *
  7856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7857*                            VMOD=2.188                          *
  7858*                                                                *
  7859******************************************************************
  7860*                   C H A N G E   L O G
  7861*
  7862* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7863*-----------------------------------------------------------------
  7864*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7865* EFFECTIVE    NUMBER
  7866*-----------------------------------------------------------------
  7867* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7868* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7869* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7870*                             2709 AND 2718
  7871* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7872* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7873* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7874* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7875* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7876*                                IS OPEN OR CNC DT < PD THRU
  7877* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7878* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7879* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7880* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7881* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7882* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7883* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7884* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 146
* EL050.cbl
  7885* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7886* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7887* 020906                   PEMA  EXPAND LOAN OFFICER
  7888* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7889* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7890* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7891* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7892* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7893* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7894* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7895* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7896* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7897* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7898* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7899* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7900* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7901* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7902* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7903* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7904* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7905* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7906* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7907* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7908* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7909* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7910* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7911* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7912* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7913*                                UPDATE VIN ON CERT TRAILER
  7914* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7915* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7916* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7917* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7918* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7919* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7920* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7921* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7922* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7923* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7924* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7925* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7926* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7927* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7928* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7929* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7930* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7931* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7932* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7933* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7934* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7935* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7936* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7937* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7938* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7939* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7940* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7941* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7942* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 147
* EL050.cbl
  7943* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7944* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7945* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7946* 032912  CR2011110200001  PEMA  AHL CHANGES
  7947* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7948* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7949* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7950* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7951* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7952* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7953* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7954* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7955* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7956* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7957* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7958* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7959* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7960* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7961* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7962* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7963* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7964* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7965* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7966* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7967* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7968* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7969* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7970* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7971* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7972* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7973* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7974*                                CERT #, ADD 2898 FORCIBLE ERROR
  7975* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7976* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7977* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7978* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7979* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7980* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7981* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7982* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7983* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7984* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7985* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7986* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7987* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7988* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7989* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7990* 100617  CR2017062000003  PEMA  New comm cap edits
  7991* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7992* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7993* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7994* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7995* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7996* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7997* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7998* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7999* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  8000* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 148
* EL050.cbl
  8001* 101019  CR2019100700001  PEMA  Disallow V status with claim
  8002* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
  8003* 012220  CR2018092700002  TANA  Add edit for letter required
  8004* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXTD TERM.
  8005******************************************************************
  8006************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  8007******************************************************************
  8008
  8009     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  8010
  8011     MOVE SPACES                 TO PB-FATAL-FLAG
  8012                                    PB-FORCE-ER-CD
  8013                                    PB-WARN-ER-CD
  8014                                    PB-OUT-BAL-CD.
  8015
  8016     MOVE SPACE                  TO WS-IG-OVRD-AH
  8017                                    WS-IG-OVRD-LF
  8018                                    WS-IG-OVRD-AM
  8019                                    WS-IG-OVRD
  8020                                    WS-IG-OVRD-AH-PL
  8021                                    WS-IG-OVRD-LF-PL
  8022                                    WS-IG-OVRD-AH-BEN
  8023                                    WS-IG-OVRD-LF-BEN.
  8024
  8025******************************************************************
  8026*************       INITIALIZE COMMON ERRORS       ***************
  8027******************************************************************
  8028
  8029     MOVE +0                     TO PB-NO-OF-ERRORS.
  8030     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8031
  8032******************************************************************
  8033
  8034     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8035     SET JULIAN-TO-BIN           TO TRUE.
  8036*    MOVE 5                      TO DC-OPTION-CODE.
  8037     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8038     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8039
  8040     MOVE ZERO                   TO  SUB4.
  8041
  8042 0040-INITIALIZE-GA-BILL-DT.
  8043
  8044     ADD +1                      TO  SUB4.
  8045
  8046     IF  SUB4 GREATER THAN +5
  8047         GO TO 0050-CHECK-CNTL-FOUND.
  8048
  8049     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8050         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8051
  8052     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8053
  8054 0050-CHECK-CNTL-FOUND.
  8055
  8056     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8057        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8058                                         WS-AH-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 149
* EL050.cbl
  8059                                         EC-CO-REM-TERM-CALC
  8060        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8061        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8062        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8063                                         WS-TOL-AH-CLAIM
  8064        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8065                                         WS-TOL-AH-PREM
  8066                                         EC-CO-TOL-PREM
  8067        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8068                                         WS-TOL-AH-REFUND
  8069                                         EC-CO-TOL-REFUND
  8070        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8071                                         WS-AH-REFUND-OVS-AMT
  8072                                         EC-CO-OVR-SHT-AMT
  8073        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8074                                         WS-TOL-AH-PREM-PCT
  8075                                         EC-CO-TOL-PREM-PCT
  8076        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8077                                         WS-TOL-AH-REFUND-PCT
  8078                                         EC-CO-TOL-REFUND-PCT
  8079        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8080                                         WS-AH-REFUND-OVS-PCT
  8081                                         EC-CO-OVR-SHT-PCT
  8082        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8083        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8084        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8085        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8086        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8087        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8088        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8089        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8090        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8091        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8092        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8093        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8094                                         EC-CO-MONTH-END-DT
  8095        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8096          GO TO 0100-READ-ACCT.
  8097
  8098     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8099     MOVE SPACES                 TO CNTL-ACCESS.
  8100     MOVE '1'                    TO CNTL-REC-TYPE.
  8101     MOVE +0                     TO CNTL-SEQ-NO.
  8102
  8103     MOVE '1' TO RC-SW-1.
  8104     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8105     IF NOT CF-COMPANY-MASTER
  8106         MOVE ZEROS             TO WK-CO-TOL-PREM
  8107                                   WK-CO-TOL-CLAIM
  8108                                   WK-CO-TOL-REFUND
  8109                                   WK-REFUND-OVS-AMT
  8110                                   WK-REFUND-OVS-PCT
  8111                                   WK-CO-TOL-PREM-PCT
  8112                                   WK-CO-TOL-REFUND-PCT
  8113                                   WK-DEFAULT-APR
  8114                                   WK-CO-MAX-CAP
  8115        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8116                                   WK-CR-R78-METHOD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 150
* EL050.cbl
  8117                                   WK-CO-REF-REJECT-SW
  8118                                   WK-CO-PREM-REJECT-SW
  8119                                   WK-REM-TRM-CALC-OPTION
  8120                                   WK-BIRTH-DATE-INPUT
  8121                                   WK-JOINT-AGE-INPUT
  8122        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8123        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8124        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8125        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8126          GO TO 0099-COMPANY-NOT-FOUND.
  8127
  8128     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8129        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8130     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8131        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8132     IF CF-CO-TOL-CAP NOT NUMERIC
  8133        MOVE +0                    TO CF-CO-TOL-CAP.
  8134     IF CF-DEFAULT-APR NOT NUMERIC
  8135        MOVE +0                    TO CF-DEFAULT-APR.
  8136
  8137     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8138     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8139     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8140     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8141     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8142     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8143     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8144     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8145     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8146     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8147     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8148     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8149
  8150     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8151          CF-CO-OVR-SHT-AMT > +0
  8152        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8153
  8154     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8155          CF-CO-OVR-SHT-PCT > +0
  8156        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8157
  8158     IF CF-VALID-REM-TRM-OPTION
  8159         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8160     ELSE
  8161         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8162
  8163     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8164     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8165     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8166     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8167
  8168     GO TO 0050-CHECK-CNTL-FOUND.
  8169
  8170 0099-COMPANY-NOT-FOUND.
  8171
  8172     MOVE ER-2616                TO WS-ERROR.
  8173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8174
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 151
* EL050.cbl
  8175 0100-READ-ACCT.
  8176
  8177     MOVE SPACES                 TO DATE-RANGE-SW.
  8178
  8179     IF WK-ACCT-ADDR = ZEROS
  8180        GO TO 0102-ACCT-GETMAIN.
  8181
  8182     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8183     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8184     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8185
  8186     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8187        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8188        GO TO 0105-READ-ACCT
  8189     END-IF
  8190
  8191     IF PB-CARRIER NOT = SPACES
  8192        IF PB-CARRIER NOT = AM-VG-CARRIER
  8193           GO TO 0105-READ-ACCT.
  8194
  8195     IF PB-STATE NOT = SPACES
  8196        IF PB-STATE NOT = AM-VG-STATE
  8197           GO TO 0105-READ-ACCT.
  8198
  8199     IF PB-GROUPING NOT = SPACES
  8200        IF PB-GROUPING NOT = AM-VG-GROUPING
  8201           GO TO 0105-READ-ACCT.
  8202
  8203     MOVE 'X'                 TO DATE-RANGE-SW.
  8204
  8205     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8206        MOVE 'X'                 TO DATE-RANGE-SW
  8207        GO TO 0105-READ-ACCT.
  8208
  8209     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8210        GO TO 0105-READ-ACCT.
  8211
  8212     GO TO 0180-ACCOUNT-FOUND.
  8213
  8214 0102-ACCT-GETMAIN.
  8215     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8216     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8217
  8218 0105-READ-ACCT.
  8219     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8220     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8221     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8222     MOVE PB-STATE               TO ACCT-STATE.
  8223     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8224     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8225
  8226     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8227
  8228     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8229
  8230 0110-FIND-ACCT-TOLERANCES-LOOP.
  8231     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8232
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 152
* EL050.cbl
  8233     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8234        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8235        GO TO 0199-ACCT-NOT-FOUND
  8236     END-IF
  8237     IF PB-CARRIER NOT = SPACES
  8238        IF PB-CARRIER NOT = AM-VG-CARRIER
  8239           GO TO 0199-ACCT-NOT-FOUND.
  8240
  8241     IF PB-STATE NOT = SPACES
  8242        IF PB-STATE NOT = AM-VG-STATE
  8243           GO TO 0199-ACCT-NOT-FOUND.
  8244
  8245     IF PB-GROUPING NOT = SPACES
  8246        IF PB-GROUPING NOT = AM-VG-GROUPING
  8247           GO TO 0199-ACCT-NOT-FOUND.
  8248
  8249     MOVE 'X'                    TO DATE-RANGE-SW.
  8250
  8251     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8252        MOVE 'X'                 TO DATE-RANGE-SW
  8253        GO TO 0199-ACCT-NOT-FOUND.
  8254
  8255     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8256        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8257
  8258 0180-ACCOUNT-FOUND.
  8259     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8260     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8261     MOVE AM-STATE               TO PB-SV-STATE.
  8262     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8263
  8264     IF AM-CANCEL-FEE  NOT NUMERIC
  8265        MOVE ZEROS TO AM-CANCEL-FEE.
  8266
  8267     IF AM-MAX-MON-BEN NOT NUMERIC
  8268        MOVE ZEROS TO AM-MAX-MON-BEN.
  8269
  8270     IF AM-MAX-TOT-BEN NOT NUMERIC
  8271        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8272
  8273     IF AM-CLP-TOL-PCT NOT NUMERIC
  8274        MOVE +0                  TO AM-CLP-TOL-PCT
  8275     END-IF
  8276     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8277        MOVE +0                  TO AM-SPP-LEASE-COMM
  8278     END-IF
  8279     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8280        MOVE ER-2611             TO   WS-ERROR
  8281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8282
  8283     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8284        MOVE ER-2621             TO   WS-ERROR
  8285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8286
  8287     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8288        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8289        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8290        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 153
* EL050.cbl
  8291         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8292
  8293     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8294     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8295     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8296     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8297     IF AM-CLP-TOL-PCT NOT = ZEROS
  8298        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8299     END-IF
  8300     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8301        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8302     END-IF
  8303*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8304*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8305*                                   WS-ADMIN-FEES
  8306*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8307*          (SUB5 > +10)
  8308*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8309*             AND (AM-A-COM (SUB5) NUMERIC)
  8310*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8311*                + (AM-A-COM (SUB5) * 1000)
  8312*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8313*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8314*                + (AM-A-COM (SUB5) * 1000)
  8315*             END-IF
  8316*             IF AM-COM-TYP (SUB5) = 'N'
  8317*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8318*                + (AM-A-COM (SUB5) * 1000)
  8319*             END-IF
  8320*          END-IF
  8321*       END-PERFORM
  8322*    END-IF
  8323     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8324        AND (PB-ISSUE)
  8325        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8326                                    ws-cred-union-fees
  8327        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8328           (SUB5 > +10)
  8329           MOVE +0 TO WS-WK-RATE
  8330           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8331                                   'O' OR 'S')
  8332              IF (AM-A-COM (SUB5) NUMERIC)
  8333                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8334                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8335              ELSE
  8336                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8337                 IF PB-ISSUE
  8338                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8339                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8340                 ELSE
  8341                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8342                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8343                 END-IF
  8344                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8345                 MOVE ZEROS             TO WS-SUB1
  8346                                           WS-COMMISSION
  8347                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8348                 MOVE '0530'               TO CTBL-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 154
* EL050.cbl
  8349                 MOVE ' '                  TO WS-CTBL-READ-SW
  8350                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8351                 IF FIRST-TIME-THROUGH
  8352                    MOVE 'AA'              TO CTBL-BEN-CODE
  8353                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8354                 END-IF
  8355                 IF CTBL-TABLE-FOUND
  8356                    IF PB-ISSUE
  8357                       COMPUTE WS-COMM-CK-AMT =
  8358                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8359                    ELSE
  8360                       COMPUTE WS-COMM-CK-AMT =
  8361                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8362                    END-IF
  8363                    PERFORM 8800-GET-COMP-RATE
  8364                              THRU 8800-EXIT
  8365                 END-IF
  8366              END-IF
  8367              if am-com-typ (sub5) = 'O' or 'S'
  8368                 compute ws-cred-union-fees rounded =
  8369                    ws-cred-union-fees +
  8370                    (pb-i-ah-premium-amt * ws-wk-rate)
  8371              else
  8372                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8373                + (WS-WK-RATE * 1000)
  8374              end-if
  8375           END-IF
  8376        END-PERFORM
  8377     END-IF
  8378     IF PB-COMPANY-ID EQUAL 'CRI'
  8379         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8380
  8381     IF PB-COMPANY-ID EQUAL 'NCL'
  8382         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8383     END-IF
  8384
  8385     GO TO 0200-READ-CERT.
  8386
  8387 0199-ACCT-NOT-FOUND.
  8388
  8389     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8390
  8391     IF DATE-RANGE-SW NOT = SPACES
  8392        MOVE ER-2601             TO WS-ERROR
  8393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8394     ELSE
  8395        MOVE ER-2619             TO WS-ERROR
  8396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8397
  8398     GO TO 9990-RETURN.
  8399
  8400 0200-READ-CERT.
  8401
  8402     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8403     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8404     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8405     MOVE PB-SV-STATE            TO CERT-STATE.
  8406     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 155
* EL050.cbl
  8407     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8408     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8409
  8410     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8411
  8412     IF CERT-WAS-NOT-FOUND
  8413        GO TO 0299-CERT-NOT-FOUND.
  8414
  8415     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8416        MOVE ER-2759             TO WS-ERROR
  8417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8418        GO TO 0298-UNLOCK-RETURN.
  8419
  8420     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8421         MOVE ER-2758            TO WS-ERROR
  8422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423         GO TO 0298-UNLOCK-RETURN.
  8424
  8425     IF PB-ISSUE
  8426        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8427           IF CERT-WAS-CREATED-FOR-CLAIM
  8428              NEXT SENTENCE
  8429            ELSE
  8430              MOVE ER-2626       TO WS-ERROR
  8431              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8432              GO TO 0298-UNLOCK-RETURN.
  8433
  8434     IF NOT PB-CANCELLATION
  8435        GO TO 0300-CONTINUE-EDIT.
  8436
  8437     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8438     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8439     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8440     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8441     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8442     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8443
  8444     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8445     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8446     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8447     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8448     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8449     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8450     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8451     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8452     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8453
  8454     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8455     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8456     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8457     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8458     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8459     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8460     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8461
  8462     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8463     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8464
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 156
* EL050.cbl
  8465     MOVE CM-CREDIT-INTERFACE-SW-1
  8466                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8467     MOVE CM-CREDIT-INTERFACE-SW-2
  8468                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8469
  8470     IF CM-O-B-COVERAGE
  8471         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8472
  8473     IF CM-LIVES NOT NUMERIC
  8474         MOVE ZERO                TO CM-LIVES.
  8475
  8476     IF CM-BILLED NOT NUMERIC
  8477         MOVE ZERO                TO CM-BILLED.
  8478
  8479     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8480         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8481         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8482         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8483         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8484         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8485         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8486         MOVE CM-LIVES             TO PB-CI-LIVES
  8487*The next line causes a problem with my change  I dont think it is
  8488*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8489
  8490     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8491     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8492     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8493     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8494     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8495     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8496
  8497     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8498     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8499     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8500     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8501
  8502     IF CM-LIFE-COMM-PCT NUMERIC
  8503         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8504     ELSE
  8505         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8506
  8507     IF CM-AH-COMM-PCT NUMERIC
  8508         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8509     ELSE
  8510         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8511
  8512     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8513
  8514     IF CM-LOAN-APR       NOT NUMERIC
  8515           MOVE ZERO               TO CM-LOAN-APR.
  8516
  8517     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8518           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8519
  8520     IF CM-LOAN-TERM      NOT NUMERIC
  8521           MOVE ZERO               TO CM-LOAN-TERM.
  8522
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 157
* EL050.cbl
  8523     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8524           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8525
  8526     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8527           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8528
  8529     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8530     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8531     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8532     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8533     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8534     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8535     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8536     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8537     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8538     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8539     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8540     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8541     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8542
  8543     IF CM-STATE = CM-SSN-STATE
  8544         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8545
  8546     IF CM-STATE NOT = CM-MEMB-STATE
  8547         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8548
  8549     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8550
  8551     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8552*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8553        IF CM-ADDL-CLP NOT NUMERIC
  8554           MOVE +0               TO CM-ADDL-CLP
  8555        END-IF
  8556        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8557        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8558           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8559        END-IF
  8560     END-IF
  8561     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8562        MOVE +0                  TO WS-ADMIN-FEES
  8563                                    WS-CSO-ADMIN-FEE
  8564                                    WS-COMM-AND-MFEE
  8565                                    WS-1ST-YR-ALLOW
  8566        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8567           (SUB5 > +10)
  8568           MOVE +0 TO WS-WK-RATE
  8569           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8570              IF (AM-A-COM (SUB5) NUMERIC)
  8571                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8572                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8573              ELSE
  8574                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8575                 IF PB-ISSUE
  8576                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8577                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8578                 ELSE
  8579                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8580                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 158
* EL050.cbl
  8581                 END-IF
  8582                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8583                 MOVE ZEROS             TO WS-SUB1
  8584                                           WS-COMMISSION
  8585                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8586                 MOVE '0530'               TO CTBL-SW
  8587                 MOVE ' '                  TO WS-CTBL-READ-SW
  8588                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8589                 IF FIRST-TIME-THROUGH
  8590                    MOVE 'AA'              TO CTBL-BEN-CODE
  8591                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8592                 END-IF
  8593                 IF CTBL-TABLE-FOUND
  8594                    IF PB-ISSUE
  8595                       COMPUTE WS-COMM-CK-AMT =
  8596                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8597                    ELSE
  8598                       COMPUTE WS-COMM-CK-AMT =
  8599                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8600                    END-IF
  8601                    PERFORM 8800-GET-COMP-RATE
  8602                              THRU 8800-EXIT
  8603                 END-IF
  8604              END-IF
  8605              IF AM-COM-TYP (SUB5) = 'I'
  8606                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8607                   + (WS-WK-RATE * 1000)
  8608              END-IF
  8609              IF AM-COM-TYP (SUB5) = 'N'
  8610                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8611                   + (WS-WK-RATE * 1000)
  8612              END-IF
  8613              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8614                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8615                   + (WS-WK-RATE * 1000)
  8616              END-IF
  8617              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8618                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8619                   + (WS-WK-RATE * 1000)
  8620              END-IF
  8621           END-IF
  8622        END-PERFORM
  8623     END-IF
  8624     GO TO 0300-CONTINUE-EDIT.
  8625
  8626 0298-UNLOCK-RETURN.
  8627      PERFORM 9250-UNLOCK-RETURN
  8628      GO TO 9990-RETURN.
  8629
  8630 0299-CERT-NOT-FOUND.
  8631
  8632     MOVE '1'                     TO CERT-STATUS-SW.
  8633
  8634     IF PB-COMPANY-ID = 'UCL'
  8635         IF WS-ERROR = ER-2799
  8636             GO TO 3000-CONTINUE-EDIT.
  8637
  8638     IF NOT PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 159
* EL050.cbl
  8639         GO TO 0300-CONTINUE-EDIT.
  8640
  8641     MOVE ER-2726                  TO  WS-ERROR.
  8642     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8643     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8644     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8645                                    PB-CI-LF-TERM
  8646                                    PB-C-LF-REM-TERM
  8647                                    PB-CI-AH-TERM
  8648                                    PB-C-AH-REM-TERM
  8649                                    PB-CI-LF-BENEFIT-CD
  8650                                    PB-CI-LF-BENEFIT-AMT
  8651                                    PB-CI-LF-ALT-BENEFIT-AMT
  8652                                    PB-CI-LF-PREMIUM-AMT
  8653                                    PB-CI-LF-ALT-PREMIUM-AMT
  8654                                    PB-CI-AH-BENEFIT-CD
  8655                                    PB-CI-AH-BENEFIT-AMT
  8656                                    PB-CI-AH-PREMIUM-AMT
  8657                                    PB-CI-PAY-FREQUENCY
  8658                                    PB-CI-LOAN-APR
  8659                                    PB-CI-LOAN-TERM
  8660                                    PB-CI-LIFE-COMMISSION
  8661                                    PB-CI-AH-COMMISSION
  8662                                    PB-CI-CURR-SEQ
  8663                                    PB-CI-AH-CANCEL-AMT
  8664                                    PB-CI-LF-CANCEL-AMT
  8665                                    PB-CI-RATE-DEV-PCT-LF
  8666                                    PB-CI-RATE-DEV-PCT-AH
  8667                                    PB-CI-EXTENTION-DAYS
  8668                                    PB-CI-TERM-IN-DAYS
  8669                                    PB-CI-LIVES
  8670                                    PB-CI-LF-CRIT-PER
  8671                                    PB-CI-AH-CRIT-PER
  8672                                    PB-CI-ADDL-CLP
  8673                                    PB-CI-DDF-IU-RATE-UP.
  8674
  8675     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8676                                    PB-CI-AH-SETTLEMENT-DT
  8677                                    PB-CI-DEATH-DT
  8678                                    PB-CI-LF-PRIOR-CANCEL-DT
  8679                                    PB-CI-AH-PRIOR-CANCEL-DT
  8680                                    PB-CI-ENTRY-DT
  8681                                    PB-CI-LF-EXPIRE-DT
  8682                                    PB-CI-AH-EXPIRE-DT
  8683                                    PB-CI-LOAN-1ST-PMT-DT.
  8684
  8685     IF ACCOUNT-MAST-FOUND
  8686        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8687        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8688
  8689
  8690 0300-CONTINUE-EDIT.
  8691
  8692     IF PB-ISSUE
  8693        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8694            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8695
  8696     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 160
* EL050.cbl
  8697        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8698            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8699
  8700     IF PB-ISSUE
  8701       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8702          (AM-NO-AH-ONLY)
  8703           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8704               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8705                   MOVE ER-2679 TO WS-ERROR
  8706                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8707
  8708     IF PB-ISSUE
  8709        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8710        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8711        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8712     ELSE
  8713        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8714        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8715        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8716
  8717     MOVE 'N'                    TO PLAN-MASTER-SW
  8718                                    PLAN-MASTER-LIFE-SW
  8719                                    FORM-MASTER-SW
  8720                                    WS-APP-CERT-SW.
  8721
  8722     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8723                                    WS-PL-TOL-LF-REFUND
  8724                                    WS-PL-REF-OVS-AMT
  8725                                    WS-PL-TOL-LF-PREM-PCT
  8726                                    WS-PL-TOL-LF-REFUND-PCT
  8727                                    WS-PL-REF-OVS-PCT
  8728                                    WS-PL-TOL-LF-CLAIM.
  8729
  8730     IF PB-COMPANY-ID = 'NCL'
  8731       IF PB-ISSUE
  8732         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8733             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8734             IF FORM-MASTER-FOUND
  8735                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8736
  8737     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8738        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8739
  8740********************** MON CODE **********************
  8741     IF PB-COMPANY-ID = 'MON'
  8742     IF PB-ISSUE
  8743     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8744        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8745             PB-I-LOAN-APR = ZERO)
  8746               MOVE 14.0         TO PB-I-LOAN-APR.
  8747******************************************************
  8748
  8749     IF PB-COMPANY-ID = 'NCL'
  8750       IF PB-ISSUE
  8751           IF FORM-MASTER-FOUND
  8752             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8753                AM-DISMBR-COVERAGE
  8754                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 161
* EL050.cbl
  8755                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8756                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8757                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8758                                           PB-I-LIFE-BENEFIT-CD.
  8759
  8760     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8761
  8762     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8763         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8764         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8765         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8766         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8767         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8768           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8769             GO TO 0301-LIFE-BENEFIT-SEARCH
  8770         ELSE
  8771             NEXT SENTENCE
  8772     ELSE
  8773         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8774
  8775     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8776     MOVE '4'                    TO CNTL-REC-TYPE.
  8777     MOVE +0                     TO CNTL-SEQ-NO.
  8778     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8779
  8780     MOVE '1' TO RC-SW-2.
  8781     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8782
  8783     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8784        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8785         GO TO 0305-BENEFIT-NOT-FOUND.
  8786
  8787     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8788
  8789 0301-LIFE-BENEFIT-SEARCH.
  8790
  8791     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8792
  8793     IF NO-BENEFIT-FOUND
  8794        GO TO 0305-BENEFIT-NOT-FOUND.
  8795
  8796     IF WS-BEN-CD = '99'
  8797        GO TO 0305-BENEFIT-NOT-FOUND.
  8798
  8799     IF PB-COMPANY-ID = 'NCL'
  8800         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8801             GO TO 0304-LIFE-BENEFIT-FOUND.
  8802
  8803     MOVE +1                     TO SUB5.
  8804     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8805
  8806* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8807* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8808     IF PB-COMPANY-ID = 'DMD'
  8809         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8810
  8811 0302-EDIT-ACCT-LF-BENEFITS.
  8812
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 162
* EL050.cbl
  8813     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8814        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8815           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8816                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8817           GO TO 03XX-GET-LIFE-ERPLAN.
  8818
  8819     IF SUB5 LESS THAN +20
  8820        ADD +1                   TO SUB5
  8821        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8822
  8823     MOVE +1                     TO SUB5.
  8824
  8825     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8826        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8827
  8828 0303-EDIT-DMD-EXTRA-BENEFITS.
  8829
  8830     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8831        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8832           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8833                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8834           GO TO 03XX-GET-LIFE-ERPLAN.
  8835
  8836     IF SUB5 LESS THAN +30
  8837        ADD +1                   TO SUB5
  8838        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8839
  8840     MOVE +1                     TO SUB5.
  8841
  8842 03XX-EDIT-FOR-NINETY-LF.
  8843
  8844***************************************************************
  8845*                                                             *
  8846*    NINETY BENEFIT PLAN TYPES:                               *
  8847*                                                             *
  8848*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8849*      92 = ALL GROUP REDUCING BENEFITS                       *
  8850*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8851*      94 = ALL GROUP LEVEL BENEFITS                          *
  8852*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8853*           BENEFIT CONTROLS.                                 *
  8854*      99 = ALL BENEFITS                                      *
  8855*                                                             *
  8856***************************************************************
  8857
  8858     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8859                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8860
  8861     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8862       AND
  8863        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        GO TO 03XX-GET-LIFE-ERPLAN.
  8865
  8866     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8867       AND
  8868        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8869        IF CF-REDUCING (SUB3)
  8870           IF (PB-I-INDV-GRP-OVRD = 'I')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 163
* EL050.cbl
  8871              OR
  8872           ((AM-IG = '1') AND
  8873           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8874              OR
  8875           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8876           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8877           (AM-IG NOT = '2'))
  8878              GO TO 03XX-GET-LIFE-ERPLAN.
  8879
  8880     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8881       AND
  8882        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8883        IF CF-REDUCING (SUB3)
  8884           IF (PB-I-INDV-GRP-OVRD = 'G')
  8885              OR
  8886           ((AM-IG = '2') AND
  8887           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8888              OR
  8889           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8890           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8891           (AM-IG NOT = '1'))
  8892              GO TO 03XX-GET-LIFE-ERPLAN.
  8893
  8894     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8895       AND
  8896        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8897        IF CF-LEVEL    (SUB3)
  8898           IF (PB-I-INDV-GRP-OVRD = 'I')
  8899              OR
  8900           ((AM-IG = '1') AND
  8901           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8902              OR
  8903           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8904           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8905            (AM-IG NOT = '2'))
  8906              GO TO 03XX-GET-LIFE-ERPLAN.
  8907
  8908     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8909       AND
  8910        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8911        IF CF-LEVEL    (SUB3)
  8912           IF (PB-I-INDV-GRP-OVRD = 'G')
  8913              OR
  8914           ((AM-IG = '2') AND
  8915           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8916              OR
  8917           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8918           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8919           (AM-IG NOT = '1'))
  8920              GO TO 03XX-GET-LIFE-ERPLAN.
  8921
  8922     IF SUB5 LESS THAN +20
  8923        ADD +1                   TO SUB5
  8924        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8925
  8926     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8927
  8928     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 164
* EL050.cbl
  8929        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8930
  8931     MOVE +1                     TO SUB5.
  8932
  8933 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8934
  8935     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8936                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8937
  8938     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8939       AND
  8940        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8941        GO TO 03XX-GET-LIFE-ERPLAN.
  8942
  8943     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8944       AND
  8945        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8946        IF CF-REDUCING (SUB3)
  8947           IF (PB-I-INDV-GRP-OVRD = 'I')
  8948              OR
  8949           ((AM-IG = '1') AND
  8950           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8951              OR
  8952           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8953           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8954           (AM-IG NOT = '2'))
  8955              GO TO 03XX-GET-LIFE-ERPLAN.
  8956
  8957     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8958       AND
  8959        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8960        IF CF-REDUCING (SUB3)
  8961           IF (PB-I-INDV-GRP-OVRD = 'G')
  8962              OR
  8963           ((AM-IG = '2') AND
  8964           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8965              OR
  8966           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8967           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8968           (AM-IG NOT = '1'))
  8969              GO TO 03XX-GET-LIFE-ERPLAN.
  8970
  8971     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8972       AND
  8973        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8974        IF CF-LEVEL    (SUB3)
  8975           IF (PB-I-INDV-GRP-OVRD = 'I')
  8976              OR
  8977           ((AM-IG = '1') AND
  8978           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8979              OR
  8980           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8981           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8982            (AM-IG NOT = '2'))
  8983              GO TO 03XX-GET-LIFE-ERPLAN.
  8984
  8985     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8986       AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 165
* EL050.cbl
  8987        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8988        IF CF-LEVEL    (SUB3)
  8989           IF (PB-I-INDV-GRP-OVRD = 'G')
  8990              OR
  8991           ((AM-IG = '2') AND
  8992           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8993              OR
  8994           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8995           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8996           (AM-IG NOT = '1'))
  8997              GO TO 03XX-GET-LIFE-ERPLAN.
  8998
  8999     IF SUB5 LESS THAN +30
  9000        ADD +1                   TO SUB5
  9001        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  9002
  9003     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9004
  9005 03XX-EDIT-FOR-NINETY-LF-CONT.
  9006
  9007     MOVE +99                    TO SUB5.
  9008
  9009     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9010        IF PB-ISSUE
  9011           MOVE ER-1924          TO  WS-ERROR
  9012           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9013
  9014     GO TO 0304-LIFE-BENEFIT-FOUND.
  9015
  9016 03XX-GET-LIFE-ERPLAN.
  9017
  9018     IF WK-PLAN-ADDR EQUAL +0
  9019        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9020
  9021     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9022     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9023     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9024     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9025     MOVE 'Y'                    TO PLAN-MASTER-SW
  9026                                    PLAN-MASTER-LIFE-SW.
  9027     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9028
  9029 03XX-ERPLAN-LIFE-GETMAIN.
  9030
  9031     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9032     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9033
  9034 03XX-ERPLAN-LIFE-READ.
  9035
  9036     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9037     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9038     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9039     MOVE PB-SV-STATE            TO PLAN-STATE.
  9040     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9041     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9042     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9043     MOVE WS-SAVE-BENEFIT-REVISION
  9044                                 TO PLAN-REVISION-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 166
* EL050.cbl
  9045
  9046     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9047     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9048
  9049     IF PB-COMPANY-ID = 'NCL'
  9050       IF NOT LF-PLAN-MASTER-FOUND
  9051         IF NOT PB-POLICY-IS-DECLINED  AND
  9052            NOT PB-POLICY-IS-VOIDED
  9053             MOVE  ER-1921         TO  WS-ERROR
  9054             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9055             GO TO 0304-LIFE-BENEFIT-FOUND.
  9056
  9057     IF NOT LF-PLAN-MASTER-FOUND
  9058        GO TO 0304-LIFE-BENEFIT-FOUND.
  9059
  9060 XXXX-CHECK-LF-PLAN-KEY.
  9061
  9062     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9063        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9064        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9065        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9066        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9067        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9068        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9069        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9070        MOVE 'N'                 TO PLAN-MASTER-SW
  9071          GO TO 03XX-ERPLAN-LIFE-READ.
  9072
  9073     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9074
  9075     IF  PB-CANCELLATION
  9076         GO TO  0303-LF-ACCT-BEN-FOUND.
  9077
  9078     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9079        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9080           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9081           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9082              MOVE ER-2644             TO WS-ERROR
  9083              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084           ELSE
  9085              NEXT SENTENCE
  9086        ELSE
  9087           IF PB-COMPANY-ID NOT = 'NCL'
  9088              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9089                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9090
  9091 0303-LF-ACCT-BEN-FOUND.
  9092
  9093     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9094
  9095     IF PL-DEV-CODE NOT = SPACES
  9096        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9097
  9098     IF PL-DEV-PCT NUMERIC AND
  9099        PL-DEV-PCT NOT = ZEROS
  9100        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9101
  9102     IF PL-TOL-PREM-AMT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 167
* EL050.cbl
  9103        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9104
  9105     IF PL-TOL-REF-AMT GREATER THAN +0
  9106        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9107
  9108     IF PL-TOL-PREM-PCT GREATER THAN +0
  9109        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9110
  9111     IF PL-TOL-REF-PCT GREATER THAN +0
  9112        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9113
  9114     IF PL-TOL-CLM-AMT GREATER THAN +0
  9115        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9116
  9117     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9118                          PL-OVER-SHORT-AMT > +0
  9119        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9120
  9121     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9122                          PL-OVER-SHORT-PCT > +0
  9123        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9124
  9125     IF PL-SALES-TAX NUMERIC AND
  9126                          PL-SALES-TAX > +0
  9127         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9128
  9129     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9130        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9131                                    WS-IG-OVRD-AM.
  9132
  9133 0304-LIFE-BENEFIT-FOUND.
  9134
  9135     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9136
  9137     IF PB-ISSUE
  9138        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9139     ELSE
  9140        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9141
  9142     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9143     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9144     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9145     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9146     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9147                                         WS-LF-REFUND-CALC.
  9148     if (ws-lf-earnings-calc = '5')
  9149        and (pb-i-loan-apr = zeros)
  9150        and (benefit-code-chg)
  9151        move +99.9999 to pb-i-loan-apr
  9152     end-if
  9153
  9154     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9155        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9156
  9157     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9158        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9159     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9160
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 168
* EL050.cbl
  9161     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9162     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9163     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9164     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9165     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9166     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9167
  9168     IF PB-COMPANY-ID = 'NCL'  AND
  9169        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9170         NEXT SENTENCE
  9171     ELSE
  9172         IF SUB5 NOT GREATER THAN +20
  9173            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9174               MOVE WS-SAVE-BENEFIT-REM-TERM
  9175                                      TO WS-AM-LF-BENE-REM-TERM
  9176                                         EC-BR-LF-REM-TERM-CALC.
  9177
  9178     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9179     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9180
  9181     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9182
  9183 0305-BENEFIT-NOT-FOUND.
  9184
  9185     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9186     MOVE ER-2604                TO WS-ERROR.
  9187     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9188
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 169
* EL050.cbl
  9190
  9191 0310-FIND-AH-BENEFIT-RECORD.
  9192
  9193     MOVE 'N'                    TO PLAN-MASTER-SW
  9194                                    PLAN-MASTER-AH-SW.
  9195
  9196     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9197                                    WS-PL-TOL-AH-REFUND
  9198                                    WS-AH-PL-REF-OVS-AMT
  9199                                    WS-PL-TOL-AH-PREM-PCT
  9200                                    WS-PL-TOL-AH-REFUND-PCT
  9201                                    WS-AH-PL-REF-OVS-PCT
  9202                                    WS-PL-TOL-AH-CLAIM.
  9203     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9204
  9205
  9206     if pb-issue
  9207        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9208           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9209        end-if
  9210        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9211           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9212           GO TO 0399-BENEFIT-NOT-FOUND
  9213        end-if
  9214     end-if
  9215
  9216     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9217        GO TO 0400-FIND-CARRIER.
  9218
  9219     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9220
  9221     IF WK-AH-BEN-ADDR NOT = ZEROS
  9222         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9223         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9224         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9225         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9226           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9227             GO TO 0311-AH-BENEFIT-SEARCH
  9228         ELSE
  9229             NEXT SENTENCE
  9230     ELSE
  9231         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9232
  9233     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9234     MOVE '5'                    TO CNTL-REC-TYPE.
  9235     MOVE +0                     TO CNTL-SEQ-NO.
  9236     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9237
  9238     MOVE '2' TO RC-SW-2.
  9239     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9240
  9241     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9242        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9243          GO TO 0399-BENEFIT-NOT-FOUND.
  9244
  9245     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9246
  9247 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 170
* EL050.cbl
  9248
  9249     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9250
  9251     IF NO-BENEFIT-FOUND
  9252         GO TO 0399-BENEFIT-NOT-FOUND.
  9253
  9254     IF WS-BEN-CD = '99'
  9255        GO TO 0399-BENEFIT-NOT-FOUND.
  9256
  9257     IF PB-COMPANY-ID  =  'NCL'
  9258         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9259             GO TO 0314-A-H-BENEFIT-FOUND.
  9260
  9261     MOVE +1                     TO SUB5.
  9262     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9263
  9264* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9265* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9266     IF PB-COMPANY-ID = 'DMD'
  9267         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9268
  9269 0312-EDIT-ACCT-AH-BENEFITS.
  9270
  9271     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9272        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9273           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9274                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9275           GO TO 03XX-GET-AH-ERPLAN.
  9276
  9277     IF SUB5 LESS THAN +20
  9278        ADD +1                   TO SUB5
  9279        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9280
  9281     MOVE +1                     TO SUB5.
  9282
  9283     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9284        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9285
  9286 0313-EDIT-DMD-EXTRA-BENEFITS.
  9287
  9288     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9289        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9290           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9291                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9292           GO TO 03XX-GET-AH-ERPLAN.
  9293
  9294     IF SUB5 LESS THAN +30
  9295        ADD +1                   TO SUB5
  9296        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9297
  9298     MOVE +1                     TO SUB5.
  9299
  9300 03XX-EDIT-FOR-NINETY-AH.
  9301
  9302***************************************************************
  9303*                                                             *
  9304*    NINETY BENEFIT PLAN TYPES:                               *
  9305*                                                             *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 171
* EL050.cbl
  9306*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9307*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9308*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9309*           BENEFIT CONTROLS.                                 *
  9310*      99 = ALL BENEFITS.                                     *
  9311*                                                             *
  9312***************************************************************
  9313
  9314     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9315                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9316
  9317     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9318       AND
  9319        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9320        GO TO 03XX-GET-AH-ERPLAN.
  9321
  9322     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9323       AND
  9324        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9325           IF (PB-I-INDV-GRP-OVRD = 'I')
  9326              OR
  9327           ((AM-IG = '1') AND
  9328           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9329              OR
  9330           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9331           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9332           (AM-IG NOT = '2'))
  9333              GO TO 03XX-GET-AH-ERPLAN.
  9334
  9335     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9336       AND
  9337        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9338           IF (PB-I-INDV-GRP-OVRD = 'G')
  9339              OR
  9340           ((AM-IG = '2') AND
  9341           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9342              OR
  9343           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9344           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9345           (AM-IG NOT = '1'))
  9346              GO TO 03XX-GET-AH-ERPLAN.
  9347
  9348     IF SUB5 LESS THAN +20
  9349        ADD +1                   TO SUB5
  9350        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9351
  9352     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9353        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9354
  9355     MOVE +1                    TO SUB5.
  9356
  9357 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9358
  9359     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9360                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9361
  9362     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9363       AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 172
* EL050.cbl
  9364        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9365        GO TO 03XX-GET-AH-ERPLAN.
  9366
  9367     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9368       AND
  9369        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9370           IF (PB-I-INDV-GRP-OVRD = 'I')
  9371              OR
  9372           ((AM-IG = '1') AND
  9373           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9374              OR
  9375           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9376           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9377           (AM-IG NOT = '2'))
  9378              GO TO 03XX-GET-AH-ERPLAN.
  9379
  9380     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9381       AND
  9382        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9383           IF (PB-I-INDV-GRP-OVRD = 'G')
  9384              OR
  9385           ((AM-IG = '2') AND
  9386           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9387              OR
  9388           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9389           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9390           (AM-IG NOT = '1'))
  9391              GO TO 03XX-GET-AH-ERPLAN.
  9392
  9393     IF SUB5 LESS THAN +30
  9394        ADD +1                   TO SUB5
  9395        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9396
  9397 03XX-EDIT-FOR-NINETY-AH-CONT.
  9398
  9399     MOVE +99                    TO SUB5.
  9400
  9401     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9402
  9403     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9404        IF PB-ISSUE
  9405           MOVE ER-1925          TO  WS-ERROR
  9406           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9407
  9408     GO TO 0314-A-H-BENEFIT-FOUND.
  9409
  9410 03XX-GET-AH-ERPLAN.
  9411
  9412     IF WK-PLAN-ADDR EQUAL +0
  9413         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9414
  9415     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9416     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9417     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9418     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9419     MOVE 'Y'                    TO PLAN-MASTER-SW
  9420                                    PLAN-MASTER-AH-SW.
  9421*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 173
* EL050.cbl
  9422     GO TO 03XX-ERPLAN-AH-READ.
  9423
  9424 03XX-ERPLAN-AH-GETMAIN.
  9425
  9426     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9427     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9428
  9429 03XX-ERPLAN-AH-READ.
  9430
  9431     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9432     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9433     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9434     MOVE PB-SV-STATE            TO PLAN-STATE.
  9435     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9436     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9437     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9438     MOVE WS-SAVE-BENEFIT-REVISION
  9439                                 TO PLAN-REVISION-NO.
  9440
  9441     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9442     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9443
  9444     IF PB-COMPANY-ID = 'NCL'
  9445       IF NOT AH-PLAN-MASTER-FOUND
  9446         IF NOT PB-POLICY-IS-DECLINED  AND
  9447            NOT PB-POLICY-IS-VOIDED
  9448             MOVE  ER-1922         TO  WS-ERROR
  9449             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9450             GO TO 0314-A-H-BENEFIT-FOUND.
  9451
  9452     IF NOT AH-PLAN-MASTER-FOUND
  9453        GO TO 0314-A-H-BENEFIT-FOUND.
  9454
  9455 XXXX-CHECK-AH-PLAN-KEY.
  9456
  9457     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9458        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9459        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9460        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9461        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9462        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9463        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9464        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9465        MOVE 'N'                 TO PLAN-MASTER-SW
  9466          GO TO 03XX-ERPLAN-AH-READ.
  9467
  9468     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9469
  9470     IF  PB-CANCELLATION
  9471         GO TO  0313-AH-ACCT-BEN-FOUND.
  9472
  9473     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9474       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9475          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9476          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9477             MOVE ER-2644             TO WS-ERROR
  9478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9479          ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 174
* EL050.cbl
  9480             NEXT SENTENCE
  9481       ELSE
  9482          IF PB-COMPANY-ID NOT = 'NCL'
  9483             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9484                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9485
  9486 0313-AH-ACCT-BEN-FOUND.
  9487
  9488     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9489
  9490     IF PL-DEV-CODE NOT = SPACES
  9491        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9492
  9493     IF PL-DEV-PCT NUMERIC AND
  9494        PL-DEV-PCT NOT = ZEROS
  9495        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9496
  9497     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9498        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9499
  9500     IF PL-TOL-REF-AMT NOT EQUAL +0
  9501        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9502
  9503     IF PL-TOL-PREM-PCT GREATER THAN +0
  9504        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9505
  9506     IF PL-TOL-REF-PCT GREATER THAN +0
  9507        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9508
  9509     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9510        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9511
  9512     IF PL-OVER-SHORT-AMT NUMERIC AND
  9513                          PL-OVER-SHORT-AMT > +0
  9514        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9515
  9516     IF PL-OVER-SHORT-PCT NUMERIC AND
  9517                          PL-OVER-SHORT-PCT > +0
  9518        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9519
  9520     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9521        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9522        IF WS-IG-OVRD-AM EQUAL SPACES
  9523            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9524
  9525 0314-A-H-BENEFIT-FOUND.
  9526
  9527     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9528
  9529     IF PB-ISSUE
  9530        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9531       ELSE
  9532        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9533
  9534     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9535     if cf-maximum-benefits (sub3) numeric
  9536        move cf-maximum-benefits (sub3)
  9537                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 175
* EL050.cbl
  9538     else
  9539        move zeros               to ws-ah-max-bens
  9540     end-if
  9541     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9542     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9543     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9544                                         WS-AH-REFUND-CALC.
  9545
  9546     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9547        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9548
  9549     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9550        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9551     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9552
  9553     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9554     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9555     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9556     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9557     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9558     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9559
  9560     IF PB-COMPANY-ID = 'NCL'  AND
  9561        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9562         NEXT SENTENCE
  9563     ELSE
  9564         IF SUB5 NOT GREATER THAN +20
  9565            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9566                MOVE WS-SAVE-BENEFIT-REM-TERM
  9567                                      TO WS-AM-AH-BENE-REM-TERM
  9568                                         EC-BR-AH-REM-TERM-CALC.
  9569
  9570     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9571     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9572
  9573     GO TO 0400-FIND-CARRIER.
  9574
  9575 0399-BENEFIT-NOT-FOUND.
  9576
  9577     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9578     MOVE ER-2605                TO WS-ERROR.
  9579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9580
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 176
* EL050.cbl
  9582
  9583 0400-FIND-CARRIER.
  9584
  9585     MOVE PB-SV-CARRIER          TO WS-CARR.
  9586
  9587     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9588     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9589     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9590     MOVE '6'                    TO CNTL-REC-TYPE.
  9591
  9592*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9593     MOVE SPACE                  TO WS-DMD-RATING-SW
  9594                                    EC-BR-DMD-RATING-SW.
  9595
  9596     MOVE '2'                    TO RC-SW-1.
  9597     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9598
  9599     IF NOT CF-CARRIER-MASTER
  9600        GO TO 0400-CARRIER-NOT-FOUND.
  9601
  9602 0400-BUILD-CARR-TOL.
  9603
  9604     IF CF-CR-TOL-PREM NUMERIC AND
  9605        CF-CR-TOL-PREM GREATER THAN +0
  9606        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9607                                    WS-TOL-AH-PREM.
  9608
  9609     IF CF-CR-TOL-REFUND NUMERIC AND
  9610        CF-CR-TOL-REFUND GREATER THAN +0
  9611        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9612                                    WS-TOL-AH-REFUND.
  9613
  9614     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9615        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9616        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9617                                    WS-AH-REFUND-OVS-AMT.
  9618
  9619     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9620        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9621        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9622                                    WS-AH-REFUND-OVS-PCT.
  9623
  9624     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9625        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9626        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9627                                    WS-TOL-AH-PREM-PCT.
  9628
  9629     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9630        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9631        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9632                                     WS-TOL-AH-REFUND-PCT.
  9633
  9634     IF CF-COMPANY-ID EQUAL 'DMD'
  9635         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9636                                    EC-BR-DMD-RATING-SW.
  9637
  9638     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9639     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 177
* EL050.cbl
  9640        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9641     END-IF
  9642     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9643        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9644     END-IF
  9645     IF WS-TOL-CLP-PCT = ZEROS
  9646        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9647     END-IF
  9648
  9649     IF WS-SPP-LEASE-COMM = ZEROS
  9650        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9651     END-IF
  9652     GO TO 0400-FIND-ERPDEF.
  9653
  9654 0400-CARRIER-NOT-FOUND.
  9655
  9656     MOVE ER-2602                TO WS-ERROR.
  9657     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9658
  9659 0400-FIND-ERPDEF.
  9660*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9661     IF (PB-COMPANY-ID = 'DCC')
  9662        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9663        CONTINUE
  9664     ELSE
  9665        GO TO 0400-FIND-ERCOMP
  9666     END-IF
  9667     MOVE ' '                    TO PDEF-MASTER-SW
  9668     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9669     MOVE PB-STATE               TO ERPDEF-STATE
  9670     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9671        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9672     END-IF
  9673     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9674     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9675     IF PB-ISSUE
  9676        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9677     ELSE
  9678        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9679     END-IF
  9680     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9681     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9682     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9683     IF PDEF-MASTER-FOUND
  9684        MOVE 'N'                 TO PDEF-MASTER-SW
  9685        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9686        IF PDEF-MASTER-FOUND
  9687           IF (ERPDEF-KEY-SAVE (1:16) =
  9688                        PD-CONTROL-PRIMARY (1:16))
  9689              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9690              CONTINUE
  9691           ELSE
  9692              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9693              IF (ERPDEF-KEY-SAVE (1:16) =
  9694                        PD-CONTROL-PRIMARY (1:16))
  9695                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9696                 CONTINUE
  9697              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 178
* EL050.cbl
  9698                 MOVE 'N'        TO PDEF-MASTER-SW
  9699              END-IF
  9700           END-IF
  9701        END-IF
  9702        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9703     END-IF
  9704     IF PDEF-MASTER-FOUND
  9705        IF PD-TRUNCATED = 'Y'
  9706           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9707        END-IF
  9708     END-IF
  9709     .
  9710 0400-FIND-ERCOMP.
  9711     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9712        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9713           (WS-SUB1 > +10)
  9714           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9715                 OR 'A' OR 'N'
  9716              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9717              MOVE PB-CARRIER    TO COMP-CARRIER
  9718              MOVE PB-GROUPING   TO COMP-GROUPING
  9719              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9720              MOVE AM-AGT (WS-SUB1)
  9721                                 TO COMP-FIN-RESP
  9722              MOVE 'G'           TO COMP-TYPE
  9723              PERFORM 8582-READ-COMPENSATION-MASTER
  9724                                 THRU 8582-EXIT
  9725              IF COMP-MASTER-FOUND
  9726                 IF CO-GA-INACTIVE
  9727                    MOVE ER-2763 TO WS-ERROR
  9728                    PERFORM 9900-ERROR-FORMAT
  9729                                 THRU 9900-EXIT
  9730                    MOVE +11     TO WS-SUB1
  9731                 END-IF
  9732                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9733                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9734                    MOVE ER-2788 TO WS-ERROR
  9735                    PERFORM 9900-ERROR-FORMAT
  9736                                 THRU 9900-EXIT
  9737                    MOVE +11     TO WS-SUB1
  9738                 END-IF
  9739              END-IF
  9740           END-IF
  9741        END-PERFORM
  9742     END-IF
  9743     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9744        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9745           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9746                                    WS-CLP-STATE
  9747        ELSE
  9748           MOVE SPACES           TO PB-I-CLP-STATE
  9749                                    WS-CLP-STATE
  9750        END-IF
  9751     END-IF
  9752
  9753     IF (PB-COMPANY-ID = 'DCC')
  9754        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9755        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 179
* EL050.cbl
  9756        CONTINUE
  9757     ELSE
  9758        GO TO 0400-FIND-STATE-RECORD
  9759     END-IF
  9760     MOVE SPACES                 TO WS-CLP-STATE
  9761     MOVE +0                     TO WS-BANK-FEE
  9762                                    WS-BANK-LFEE
  9763                                    WS-BANK-NOCHRGB
  9764
  9765     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9766     IF (PB-ISSUE)
  9767        AND (PB-I-BANK-NUMBER NOT =
  9768            SPACES AND ZEROS AND LOW-VALUES)
  9769        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9770     ELSE
  9771        IF (PB-CANCELLATION)
  9772           AND (PB-CI-BANK-NUMBER NOT =
  9773                SPACES AND ZEROS AND LOW-VALUES)
  9774           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9775        END-IF
  9776     END-IF
  9777     IF COMP-FIN-RESP NOT = LOW-VALUES
  9778        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9779        MOVE PB-CARRIER          TO COMP-CARRIER
  9780        MOVE PB-GROUPING         TO COMP-GROUPING
  9781        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9782        MOVE 'B'                 TO COMP-TYPE
  9783        PERFORM 8582-READ-COMPENSATION-MASTER
  9784                                 THRU 8582-EXIT
  9785        IF COMP-MASTER-FOUND
  9786           IF CO-MAX-BANK-FEE NOT NUMERIC
  9787              MOVE +0            TO CO-MAX-BANK-FEE
  9788           END-IF
  9789           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9790              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9791           END-IF
  9792           IF CO-GA-INACTIVE
  9793              MOVE ER-2763       TO WS-ERROR
  9794              PERFORM 9900-ERROR-FORMAT
  9795                                 THRU 9900-EXIT
  9796           END-IF
  9797           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9798              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9799              MOVE ER-2788 TO WS-ERROR
  9800              PERFORM 9900-ERROR-FORMAT
  9801                                 THRU 9900-EXIT
  9802              MOVE +11     TO WS-SUB1
  9803           END-IF
  9804           IF WS-AH-BEN-CATEGORY = 'G'
  9805              MOVE CO-MAX-BANK-FEE
  9806                                 TO WS-BANK-FEE
  9807                                    PB-I-BANK-FEE
  9808           ELSE
  9809              MOVE CO-MAX-BANK-FEE-LEASE
  9810                                 TO WS-BANK-LFEE
  9811                                    PB-I-BANK-FEE
  9812           END-IF
  9813           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 180
* EL050.cbl
  9814              AND (WS-AH-REFUND-CALC = 'G'))
  9815                        OR
  9816              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9817              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9818              CONTINUE
  9819           ELSE
  9820              MOVE ER-2789 TO WS-ERROR
  9821              PERFORM 9900-ERROR-FORMAT
  9822                                 THRU 9900-EXIT
  9823           END-IF
  9824           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9825                                    PB-I-CLP-STATE
  9826           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9827           MOVE CO-CARRIER       TO BXRF-CARRIER
  9828           MOVE CO-GROUPING      TO BXRF-GROUPING
  9829           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9830           MOVE BXRF-MAX-REC-LENGTH
  9831                                 TO BXRF-REC-LENGTH
  9832           PERFORM 8584-READ-BANK-CROSS-REF
  9833                                 THRU 8584-EXIT
  9834           IF BXRF-MASTER-FOUND
  9835              MOVE ' '           TO BANK-ACCT-SW
  9836              MOVE BK-BANK-POINTER-CNT
  9837                                 TO BK-BANK-POINTER-CNT
  9838              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9839                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9840                 OR (BANK-ACCT-FOUND)
  9841                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9842                    AND (BK-AM-EXP-DT (WS-SUB1)
  9843                                 > PB-CERT-EFF-DT)
  9844                    AND (BK-AM-EFF-DT (WS-SUB1)
  9845                                 NOT > PB-CERT-EFF-DT)
  9846                    SET BANK-ACCT-FOUND TO TRUE
  9847                 END-IF
  9848              END-PERFORM
  9849              IF NOT BANK-ACCT-FOUND
  9850                 MOVE ZEROS      TO WS-BANK-FEE
  9851                                    WS-BANK-LFEE
  9852                 MOVE ER-2869    TO WS-ERROR
  9853                 PERFORM 9900-ERROR-FORMAT
  9854                                 THRU 9900-EXIT
  9855              ELSE
  9856                 PERFORM 5000-PROCESS-REPS
  9857                                 THRU 5000-EXIT
  9858                 IF AGENT-MASTER-FOUND
  9859                    MOVE +0      TO WS-BANK-FEE
  9860                                    WS-BANK-LFEE
  9861*                   MOVE AG-SPP-FEES (1)
  9862*                                TO PB-I-BANK-FEE
  9863*                                   WS-BANK-FEE
  9864                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9865                       (WS-SUB1 > +10)
  9866                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9867                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9868                       END-IF
  9869                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9870                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9871                       END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 181
* EL050.cbl
  9872                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9873                          AG-SPP-FEES (WS-SUB1)
  9874                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9875                          AG-SPP-LFEES (WS-SUB1)
  9876                    END-PERFORM
  9877                    IF WS-AH-BEN-CATEGORY = 'G'
  9878                       MOVE WS-BANK-FEE
  9879                                 TO PB-I-BANK-FEE
  9880                    ELSE
  9881                       MOVE WS-BANK-LFEE
  9882                                 TO PB-I-BANK-FEE
  9883                    END-IF
  9884                 END-IF
  9885              END-IF
  9886           END-IF
  9887        ELSE
  9888           MOVE ER-2879          TO WS-ERROR
  9889           PERFORM 9900-ERROR-FORMAT
  9890                                 THRU 9900-EXIT
  9891        END-IF
  9892     ELSE
  9893        MOVE ER-2879             TO WS-ERROR
  9894        PERFORM 9900-ERROR-FORMAT
  9895                                 THRU 9900-EXIT
  9896     END-IF
  9897     IF WS-AH-BEN-CATEGORY = 'G'
  9898        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9899        + WS-BANK-FEE
  9900     ELSE
  9901        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9902        + WS-BANK-LFEE
  9903     END-IF
  9904     .
  9905 0400-FIND-STATE-RECORD.
  9906
  9907     IF WK-STATE-ADDR NOT = ZEROS
  9908         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9909         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9910         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9911         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9912         IF PB-SV-STATE = CF-STATE-CODE
  9913             GO TO 0405-CONTINUE-EDIT
  9914         ELSE
  9915             NEXT SENTENCE
  9916     ELSE
  9917         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9918
  9919     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9920     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9921     MOVE '3'                    TO CNTL-REC-TYPE.
  9922     MOVE +0                     TO CNTL-SEQ-NO.
  9923
  9924     MOVE '3'                    TO RC-SW-2.
  9925     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9926
  9927     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9928        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9929        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 182
* EL050.cbl
  9930        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9931                                    WS-TOL-AH-CLAIM
  9932                                    WS-MINIMUM-REFUND
  9933                                    WS-TOL-LF-PREM
  9934                                    WS-TOL-AH-PREM
  9935                                    WS-TOL-LF-REFUND
  9936                                    WS-TOL-AH-REFUND
  9937                                    EC-ST-TOL-PREM-PCT
  9938                                    WS-TOL-LF-PREM-PCT
  9939                                    WS-TOL-AH-PREM-PCT
  9940                                    EC-ST-TOL-REFUND-PCT
  9941                                    WS-TOL-LF-REFUND-PCT
  9942                                    WS-TOL-AH-REFUND-PCT
  9943                                    EC-ST-TOL-PREM
  9944                                    EC-ST-TOL-REFUND
  9945                                    EC-ST-FST-PMT-DAYS-MAX
  9946                                    WS-FREE-LOOK-PERIOD
  9947                                    WS-ST-LF-PREM-TAX
  9948                                    WS-ST-AH-PREM-TAX-I
  9949                                    WS-ST-AH-PREM-TAX-G
  9950                                    WS-BANK-FEE
  9951                                    WS-BANK-LFEE
  9952                                    WS-TOL-CLP-PCT
  9953                                    WS-SPP-LEASE-COMM
  9954                                    WS-INT-PERIODS
  9955                                    WS-EXTRA-PMTS
  9956        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9957                                    EC-ST-FST-PMT-DAYS-CHG
  9958                                    WS-LF-REM-TERM-CALC
  9959                                    WS-LF-REFUND-CALC
  9960                                    EC-ST-LF-REM-TERM-CALC
  9961                                    EC-ST-LF-REFUND-CALC
  9962                                    WS-AH-REM-TERM-CALC
  9963                                    WS-AH-REFUND-CALC
  9964                                    WS-LF-BEN-CATEGORY
  9965                                    WS-AH-BEN-CATEGORY
  9966                                    WS-CLP-STATE
  9967                                    WS-ST-REFUND-CLAIM-FLAG
  9968                                    WS-ST-CAUSAL-STATE
  9969                                    ws-st-agent-sig-edit
  9970                                    EC-ST-AH-REM-TERM-CALC
  9971                                    EC-ST-AH-REFUND-CALC
  9972          GO TO 0499-STATE-NOT-FOUND.
  9973
  9974     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9975
  9976 0405-CONTINUE-EDIT.
  9977
  9978     IF (PB-COMPANY-ID <> 'AHL')
  9979        and (pb-issue)
  9980        MOVE +0                  TO SUB3
  9981        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9982        IF SUB3 > +0
  9983           MOVE ER-3270          TO WS-ERROR
  9984           PERFORM 9900-ERROR-FORMAT
  9985                                 THRU 9900-EXIT
  9986        else
  9987           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 183
* EL050.cbl
  9988              MOVE ER-2722       TO WS-ERROR
  9989              PERFORM 9900-ERROR-FORMAT
  9990                                 THRU 9900-EXIT
  9991           end-if
  9992        END-IF
  9993     END-IF
  9994     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9995
  9996     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9997        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9998                                    WS-TOL-AH-CLAIM.
  9999
 10000     IF CF-ST-REFUND-MIN NOT NUMERIC
 10001        MOVE ZEROS               TO CF-ST-REFUND-MIN.
 10002
 10003     IF CF-ST-REFUND-MIN NOT = ZEROS
 10004        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
 10005
 10006     IF CF-ST-TOL-PREM  NOT = ZEROS
 10007        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
 10008                                    WS-TOL-AH-PREM
 10009        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
 10010
 10011     IF CF-ST-TOL-REFUND NOT = ZEROS
 10012        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10013                                    WS-TOL-AH-REFUND
 10014        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10015
 10016     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10017        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10018        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10019                                    WS-AH-REFUND-OVS-AMT
 10020                                    EC-ST-OVR-SHT-AMT.
 10021
 10022     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10023        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10024        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10025                                    WS-TOL-LF-PREM-PCT
 10026                                    WS-TOL-AH-PREM-PCT.
 10027
 10028     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10029        CF-ST-TOL-REF-PCT GREATER THAN +0
 10030        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10031                                    WS-TOL-LF-REFUND-PCT
 10032                                    WS-TOL-AH-REFUND-PCT.
 10033
 10034     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10035        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10036        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10037                                    WS-AH-REFUND-OVS-PCT
 10038                                    EC-ST-OVR-SHT-PCT.
 10039
 10040     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10041     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10042
 10043     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10044          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10045
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 184
* EL050.cbl
 10046     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10047     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10048     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10049
 10050     IF CF-ST-LF-PREM-TAX NUMERIC
 10051        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10052     END-IF
 10053     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10054        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10055     END-IF
 10056     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10057        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10058     END-IF
 10059
 10060     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10061         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10062     END-IF.
 10063
 10064     IF CF-ST-CAUSAL-STATE > SPACES
 10065         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10066     END-IF.
 10067     if cf-st-extra-interest-periods not numeric
 10068        move zeros               to cf-st-extra-interest-periods
 10069     end-if
 10070     if cf-st-extra-payments not numeric
 10071        move zeros               to cf-st-extra-payments
 10072     end-if
 10073
 10074     move cf-st-extra-interest-periods
 10075                                 to ws-int-periods
 10076     move cf-st-extra-payments   to ws-extra-pmts
 10077     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10078     move cf-st-net-only-state   to ws-net-only-state
 10079     if cf-st-comm-cap-sl not numeric
 10080        move zeros               to cf-st-comm-cap-sl
 10081     end-if
 10082     if cf-st-comm-cap-jl not numeric
 10083        move zeros               to cf-st-comm-cap-jl
 10084     end-if
 10085     if cf-st-comm-cap-sa not numeric
 10086        move zeros               to cf-st-comm-cap-sa
 10087     end-if
 10088     if cf-st-comm-cap-ja not numeric
 10089        move zeros               to cf-st-comm-cap-ja
 10090     end-if
 10091     if cf-st-ga-comm-cap-sl not numeric
 10092        move zeros               to cf-st-ga-comm-cap-sl
 10093     end-if
 10094     if cf-st-ga-comm-cap-jl not numeric
 10095        move zeros               to cf-st-ga-comm-cap-jl
 10096     end-if
 10097     if cf-st-ga-comm-cap-sa not numeric
 10098        move zeros               to cf-st-ga-comm-cap-sa
 10099     end-if
 10100     if cf-st-ga-comm-cap-ja not numeric
 10101        move zeros               to cf-st-ga-comm-cap-ja
 10102     end-if
 10103
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 185
* EL050.cbl
 10104     if cf-st-tot-comm-cap-sl not numeric
 10105        move zeros               to cf-st-tot-comm-cap-sl
 10106     end-if
 10107     if cf-st-tot-comm-cap-jl not numeric
 10108        move zeros               to cf-st-tot-comm-cap-jl
 10109     end-if
 10110     if cf-st-tot-comm-cap-sa not numeric
 10111        move zeros               to cf-st-tot-comm-cap-sa
 10112     end-if
 10113     if cf-st-tot-comm-cap-ja not numeric
 10114        move zeros               to cf-st-tot-comm-cap-ja
 10115     end-if
 10116
 10117     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10118     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10119     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10120     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10121     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10122     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10123     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10124     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10125     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10126     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10127     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10128     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10129     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10130     IF WS-LF-BENEFIT-CD = ZEROS
 10131        GO TO 0410-CHECK-AH.
 10132
 10133     IF CF-ST-RT-CALC NOT = SPACES
 10134        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10135                                    EC-ST-LF-REM-TERM-CALC
 10136     END-IF
 10137
 10138     IF WS-LF-COVERAGE-TYPE = 'R'
 10139        IF WS-LF-EARNINGS-CALC = '5'
 10140           IF CF-ST-RF-LN-CALC > '0'
 10141              MOVE CF-ST-RF-LN-CALC
 10142                                 TO WS-LF-REFUND-CALC
 10143                                    EC-ST-LF-REFUND-CALC
 10144           END-IF
 10145        ELSE
 10146           IF CF-ST-RF-LR-CALC > '0'
 10147              MOVE CF-ST-RF-LR-CALC
 10148                                 TO WS-LF-REFUND-CALC
 10149                                    EC-ST-LF-REFUND-CALC
 10150           END-IF
 10151        END-IF
 10152     ELSE
 10153        IF CF-ST-RF-LL-CALC > '0'
 10154           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10155                                    EC-ST-LF-REFUND-CALC
 10156        END-IF
 10157     END-IF
 10158
 10159     IF CF-ST-RT-CALC NOT = SPACES
 10160        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10161                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 186
* EL050.cbl
 10162     END-IF
 10163
 10164     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10165     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10166
 10167     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10168
 10169     IF NO-BENEFIT-FOUND
 10170        GO TO 0410-CHECK-AH.
 10171
 10172     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10173        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10174                                 TO EC-ST-LF-REM-TERM-CALC
 10175                                    WS-LF-REM-TERM-CALC
 10176     END-IF
 10177
 10178     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10179        MOVE CF-ST-REFUND-CALC (SUB3)
 10180                                 TO WS-LF-REFUND-CALC
 10181                                    EC-ST-LF-REFUND-CALC
 10182     END-IF
 10183*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10184     if cf-st-extra-periods (sub3) not numeric
 10185        move zeros               to cf-st-extra-periods (sub3)
 10186     end-if
 10187     if cf-st-extra-periods (sub3) > zeros
 10188        if ws-lf-ben-category = 'P'
 10189           move cf-st-extra-periods (sub3)
 10190                                 to ws-extra-pmts
 10191        else
 10192           if ws-lf-ben-category = 'I'
 10193              move cf-st-extra-periods (sub3)
 10194                                 to ws-int-periods
 10195           end-if
 10196        end-if
 10197     end-if
 10198     .
 10199 0410-CHECK-AH.
 10200
 10201     IF WS-AH-BENEFIT-CD = ZEROS
 10202        GO TO 0500-SET-ACCOUNT.
 10203
 10204     IF CF-ST-RT-CALC NOT = SPACES
 10205        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10206                                    EC-ST-AH-REM-TERM-CALC
 10207     END-IF
 10208
 10209     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10210        IF CF-ST-RF-CP-CALC > '0'
 10211           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10212                                    EC-ST-AH-REFUND-CALC
 10213        END-IF
 10214     ELSE
 10215        IF CF-ST-RF-AH-CALC > '0'
 10216           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10217                                    EC-ST-AH-REFUND-CALC
 10218        END-IF
 10219     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 187
* EL050.cbl
 10220     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10221     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10222
 10223     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10224
 10225     IF NO-BENEFIT-FOUND
 10226        GO TO 0500-SET-ACCOUNT.
 10227
 10228     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10229        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10230                                 TO WS-AH-REM-TERM-CALC
 10231                                    EC-ST-AH-REM-TERM-CALC
 10232     END-IF
 10233
 10234     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10235        MOVE CF-ST-REFUND-CALC (SUB3)
 10236                                 TO WS-AH-REFUND-CALC
 10237                                    EC-ST-AH-REFUND-CALC
 10238     END-IF
 10239
 10240*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10241
 10242     GO TO 0500-SET-ACCOUNT.
 10243
 10244 0499-STATE-NOT-FOUND.
 10245
 10246     MOVE ER-2603                TO WS-ERROR.
 10247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10248
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 188
* EL050.cbl
 10250
 10251 0500-SET-ACCOUNT.
 10252*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10253     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10254        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10255        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10256        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10257        MOVE '3'                 TO CNTL-REC-TYPE
 10258        MOVE +0                  TO CNTL-SEQ-NO
 10259
 10260        MOVE '3'                 TO RC-SW-2
 10261        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10262
 10263        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10264           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10265           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10266           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10267                                    WS-ST-AH-PREM-TAX-I
 10268                                    WS-ST-AH-PREM-TAX-G
 10269        ELSE
 10270           IF CF-ST-LF-PREM-TAX NUMERIC
 10271              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10272           END-IF
 10273           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10274              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10275           END-IF
 10276           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10277              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10278           END-IF
 10279        END-IF
 10280        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10281     END-IF
 10282*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10283*  FOR DCC ONLY
 10284     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10285
 10286        MOVE ' '                 TO STAT-MASTER-SW
 10287        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10288        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10289        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10290        MOVE PB-STATE            TO ELSTAT-STATE
 10291        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10292           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10293        END-IF
 10294
 10295        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10296        SET BIN-TO-GREG          TO TRUE
 10297        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10298        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10299        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10300
 10301        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10302        IF STAT-MASTER-FOUND
 10303           MOVE 'N'              TO STAT-MASTER-SW
 10304           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10305           IF STAT-MASTER-FOUND
 10306              IF (ELSTAT-KEY-SAVE (1:12) =
 10307                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 189
* EL050.cbl
 10308                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10309                    MOVE 'F'        TO STAT-MASTER-SW
 10310                 ELSE
 10311                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10312                    IF (STAT-MASTER-FOUND)
 10313                       AND (ELSTAT-KEY-SAVE (1:12) =
 10314                           SF-CONTROL-PRIMARY (1:12))
 10315                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10316                       MOVE 'F'     TO STAT-MASTER-SW
 10317                    END-IF
 10318                 END-IF
 10319              END-IF
 10320           END-IF
 10321        END-IF
 10322
 10323        IF STAT-MASTER-SW = 'F'
 10324           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10325              and (sf-st-lf-prem-tax > zeros)
 10326              MOVE SF-ST-LF-PREM-TAX
 10327                                 TO WS-ST-LF-PREM-TAX
 10328           END-IF
 10329           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10330              and (sf-st-ah-prem-tax-i > zeros)
 10331              MOVE SF-ST-AH-PREM-TAX-I
 10332                                 TO WS-ST-AH-PREM-TAX-I
 10333           END-IF
 10334           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10335              and (sf-st-ah-prem-tax-g > zeros)
 10336              MOVE SF-ST-AH-PREM-TAX-G
 10337                                 TO WS-ST-AH-PREM-TAX-G
 10338           END-IF
 10339        END-IF
 10340     END-IF
 10341     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10342        AND (PB-ISSUE)
 10343        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10344        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10345        AND (AM-GPCD = 06)
 10346        MOVE 'Y'                 TO WS-GOOD-HIN
 10347        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10348           MOVE PB-I-VIN         TO WS-WORK-VIN
 10349           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10350              (V1 > 16)
 10351              IF WS-WORK-VIN (V1:1) NUMERIC
 10352                 MOVE WS-WORK-VIN-N (V1)
 10353                                 TO WS-ROW-B-VAL (V1)
 10354              ELSE
 10355                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10356                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10357                    OR (V2 > 26)
 10358                 END-PERFORM
 10359                 IF V2 < 27
 10360                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10361                 ELSE
 10362                    MOVE 'N'     TO WS-GOOD-HIN
 10363                 END-IF
 10364              END-IF
 10365              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 190
* EL050.cbl
 10366                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10367              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10368                 WS-ROW-D-VAL (V1)
 10369           END-PERFORM
 10370           MOVE ZEROS            TO WS-VIN-REMAINDER
 10371           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10372             REMAINDER WS-VIN-REMAINDER
 10373           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10374              CONTINUE
 10375           ELSE
 10376              MOVE 'N'           TO WS-GOOD-HIN
 10377           END-IF
 10378        ELSE
 10379           MOVE 'N'              TO WS-GOOD-HIN
 10380        END-IF
 10381        IF WS-GOOD-HIN NOT = 'Y'
 10382           MOVE ER-3826           TO WS-ERROR
 10383           PERFORM 9900-ERROR-FORMAT
 10384                                 THRU 9900-EXIT
 10385        END-IF
 10386     END-IF
 10387     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10388        AND (PB-ISSUE)
 10389        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10390        AND (AM-GPCD NOT = 06)
 10391        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10392           perform 3400-edit-vin thru 3400-exit
 10393        ELSE
 10394          MOVE ER-3826           TO WS-ERROR
 10395          PERFORM 9900-ERROR-FORMAT
 10396                                 THRU 9900-EXIT
 10397        END-IF
 10398     END-IF
 10399     if (pb-company-id = 'CID')
 10400        and (pb-issue)
 10401        and (pb-i-vin not = spaces and low-values and zeros)
 10402        perform 3400-edit-vin    thru 3400-exit
 10403     end-if
 10404******************************************************************
 10405******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10406******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10407******* METHODS.
 10408******************************************************************
 10409     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10410        IF PB-CANCELLATION
 10411           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10412              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10413                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10414                IF FORM-MASTER-FOUND
 10415                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10416******************************************************************
 10417
 10418     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10419     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10420
 10421     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10422     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10423     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 191
* EL050.cbl
 10424     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10425
 10426
 10427     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10428     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10429     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10430
 10431     IF AM-LF-OB-RATE NOT NUMERIC
 10432         MOVE ZERO               TO AM-LF-OB-RATE.
 10433
 10434     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10435         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10436
 10437     IF AM-AH-OB-RATE NOT NUMERIC
 10438         MOVE ZERO               TO AM-AH-OB-RATE.
 10439
 10440     IF WS-LF-JOINT-INDICATOR = 'J'
 10441         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10442     ELSE
 10443         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10444
 10445     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10446
 10447     IF WS-IG-OVRD-AM  EQUAL SPACE
 10448         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10449
 10450     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10451         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10452                                       WS-IG-OVRD
 10453     ELSE
 10454         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10455             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10456                                       WS-IG-OVRD
 10457         ELSE
 10458             MOVE AM-IG             TO WS-IG-OVRD-AH
 10459                                       WS-IG-OVRD.
 10460
 10461     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10462         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10463                                       WS-IG-OVRD
 10464     ELSE
 10465         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10466             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10467                                       WS-IG-OVRD
 10468         ELSE
 10469             MOVE AM-IG             TO WS-IG-OVRD-LF
 10470                                       WS-IG-OVRD.
 10471
 10472     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10473     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10474     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10475     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10476*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10477     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10478                                              TO 'PRLDSFCTIA'.
 10479
 10480     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10481     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 192
* EL050.cbl
 10482     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10483     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10484
 10485     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10486     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10487     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10488     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10489     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10490     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10491     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10492
 10493     IF WS-ACCT-AH-DEV-PCT > +0
 10494        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10495     ELSE
 10496        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10497
 10498     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10499        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10500     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10501        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10502
 10503        IF AM-EARN-METHOD-L = 'S'
 10504            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10505                                        WS-LF-REFUND-CALC.
 10506
 10507        IF AM-EARN-METHOD-R = 'S'
 10508            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10509                                        WS-LF-REFUND-CALC.
 10510
 10511     IF WS-LF-COVERAGE-TYPE = 'R'
 10512         IF AM-EARN-METHOD-R = 'R'
 10513            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10514                                    WS-LF-REFUND-CALC.
 10515     IF WS-LF-COVERAGE-TYPE = 'R'
 10516         IF AM-EARN-METHOD-R = 'P'
 10517            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10518                                    WS-LF-REFUND-CALC.
 10519     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10520         IF AM-EARN-METHOD-L = 'R'
 10521            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10522                                    WS-LF-REFUND-CALC.
 10523     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10524         IF AM-EARN-METHOD-L = 'P'
 10525            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10526                                    WS-LF-REFUND-CALC.
 10527     IF WS-LF-COVERAGE-TYPE = 'R'
 10528         IF AM-EARN-METHOD-R = 'A'
 10529            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10530                                    WS-LF-REFUND-CALC.
 10531     IF WS-LF-COVERAGE-TYPE = 'R'
 10532         IF AM-EARN-METHOD-R = 'M'
 10533            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10534                                    WS-LF-REFUND-CALC.
 10535     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10536         IF AM-EARN-METHOD-L = 'A'
 10537            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10538                                    WS-LF-REFUND-CALC.
 10539     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 193
* EL050.cbl
 10540         IF AM-EARN-METHOD-L = 'M'
 10541            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10542                                    WS-LF-REFUND-CALC.
 10543
 10544     IF AM-EARN-METHOD-A = 'R'
 10545        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10546                                    WS-AH-REFUND-CALC.
 10547     IF AM-EARN-METHOD-A = 'P'
 10548        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10549                                    WS-AH-REFUND-CALC.
 10550     IF AM-EARN-METHOD-A = 'C'
 10551        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10552                                    WS-AH-REFUND-CALC.
 10553     IF AM-EARN-METHOD-A = 'A'
 10554        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10555                                    WS-AH-REFUND-CALC.
 10556     IF AM-EARN-METHOD-A = 'M'
 10557        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10558                                    WS-AH-REFUND-CALC.
 10559     IF AM-EARN-METHOD-A = 'N'
 10560        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10561                                    WS-AH-REFUND-CALC.
 10562     IF AM-EARN-METHOD-A = 'S'
 10563        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10564                                    WS-AH-REFUND-CALC.
 10565
 10566     IF AM-TOL-PREM NOT = ZEROS
 10567        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10568                                    WS-TOL-AH-PREM.
 10569
 10570     IF AM-OVR-SHT-AMT NUMERIC AND
 10571                  AM-OVR-SHT-AMT > 0
 10572        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10573                                    EC-AM-LF-OVR-SHT-AMT
 10574                                    WS-AH-REFUND-OVS-AMT
 10575                                    EC-AM-AH-OVR-SHT-AMT.
 10576
 10577     IF AM-OVR-SHT-PCT NUMERIC AND
 10578                    AM-OVR-SHT-PCT > 0
 10579        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10580                                    EC-AM-LF-OVR-SHT-PCT
 10581                                    WS-AH-REFUND-OVS-PCT
 10582                                    EC-AM-AH-OVR-SHT-PCT.
 10583
 10584     IF AM-TOL-REF-PCT NUMERIC AND
 10585                  AM-TOL-REF-PCT > 0
 10586        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10587                                    WS-TOL-AH-REFUND-PCT.
 10588
 10589     IF AM-TOL-REF  NOT = ZEROS  AND
 10590                  AM-TOL-REF NUMERIC
 10591        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10592                                    EC-AM-LF-TOL-REFUND
 10593                                    WS-TOL-AH-REFUND
 10594                                    EC-AM-AH-TOL-REFUND.
 10595
 10596     IF AM-TOL-CLM  NOT = ZEROS
 10597        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 194
* EL050.cbl
 10598                                    WS-TOL-AH-CLAIM.
 10599
 10600     IF AM-CLP-TOL-PCT NOT NUMERIC
 10601        MOVE +0                  TO AM-CLP-TOL-PCT
 10602     END-IF
 10603
 10604     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10605        MOVE +0                  TO AM-SPP-LEASE-COMM
 10606     END-IF
 10607     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10608        MOVE WS-PL-TOL-LF-PREM-PCT
 10609                                 TO WS-TOL-LF-PREM-PCT.
 10610
 10611     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10612        MOVE WS-PL-TOL-AH-PREM-PCT
 10613                                 TO WS-TOL-AH-PREM-PCT.
 10614
 10615     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10616        MOVE WS-PL-TOL-LF-REFUND-PCT
 10617                                 TO WS-TOL-LF-REFUND-PCT.
 10618
 10619     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10620        MOVE WS-PL-TOL-AH-REFUND-PCT
 10621                                 TO WS-TOL-AH-REFUND-PCT.
 10622
 10623     IF WS-PL-REF-OVS-AMT > +0
 10624        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10625
 10626     IF WS-PL-REF-OVS-PCT > +0
 10627        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10628
 10629     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10630        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10631     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10632        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10633     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10634        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10635     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10636        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10637     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10638        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10639     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10640        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10641
 10642     IF WS-AH-PL-REF-OVS-AMT > +0
 10643        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10644
 10645     IF WS-AH-PL-REF-OVS-PCT > +0
 10646        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10647
 10648     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10649     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10650
 10651     IF PB-CANCELLATION
 10652        GO TO 3000-CONTINUE-EDIT.
 10653
 10654     MOVE +1 TO SUB1.
 10655     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 195
* EL050.cbl
 10656     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10657
 10658     IF CF-COMPANY-ID = 'DMD'
 10659       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10660         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10661        ELSE
 10662         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10663
 10664  0525-FIND-ACCT-COMM.
 10665     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10666        NEXT SENTENCE
 10667      ELSE
 10668         ADD +1 TO SUB1
 10669         IF SUB1 LESS +11
 10670            GO TO 0525-FIND-ACCT-COMM
 10671          ELSE
 10672             GO TO 0550-st-comm-cap-check.
 10673
 10674     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10675     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10676                                    PB-I-LIFE-COMMISSION.
 10677***  IF PB-COMPANY-ID = 'CRI'
 10678     IF PB-PREM-ACCTNG-ONLY
 10679         GO TO 0550-st-comm-cap-check.
 10680
 10681     MOVE '0530' TO CTBL-SW.
 10682     MOVE ' '    TO WS-CTBL-READ-SW.
 10683
 10684
 10685 0530-GET-AH-COMP.
 10686     IF NO-AH-COVERAGE  OR
 10687        NO-AH-BENEFIT-MATCH
 10688           GO TO 0540-NEXT-READ-STEP.
 10689
 10690     IF AM-A-COM (SUB1) NUMERIC
 10691        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10692         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10693         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10694         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10695         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10696     ELSE
 10697          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10698          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10699          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10700          MOVE ZEROS             TO WS-SUB1
 10701                                    WS-COMMISSION
 10702          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10703          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10704          IF WS-COMMISSION > ZEROS
 10705             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10706             GO TO 0540-NEXT-READ-STEP
 10707          END-IF
 10708          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10709          IF CTBL-TABLE-FOUND
 10710             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10711                                        PB-I-AH-TERM
 10712             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10713             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 196
* EL050.cbl
 10714             GO TO 0540-NEXT-READ-STEP
 10715          ELSE
 10716             IF FIRST-TIME-THROUGH
 10717                 GO TO 0530-GET-AH-COMP
 10718             ELSE
 10719                 MOVE ER-2609                TO WS-ERROR
 10720                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10721
 10722 0540-NEXT-READ-STEP.
 10723     MOVE '0540' TO CTBL-SW.
 10724     MOVE ' '    TO WS-CTBL-READ-SW.
 10725
 10726 0540-GET-LF-COMP.
 10727     IF NO-LIFE-COVERAGE  OR
 10728        NO-LF-BENEFIT-MATCH
 10729           GO TO 0550-st-comm-cap-check.
 10730
 10731     IF WS-LF-JOINT-INDICATOR = 'J'
 10732        IF AM-J-COM (SUB1) NUMERIC
 10733           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10734           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10735           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10736           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10737           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10738        ELSE
 10739           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10740           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10741           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10742           MOVE ZEROS                TO WS-SUB1
 10743                                        WS-COMMISSION
 10744           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10745           IF WS-COMMISSION > ZEROS
 10746              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10747              GO TO 0550-st-comm-cap-check
 10748           END-IF
 10749           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10750           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10751           IF CTBL-TABLE-FOUND
 10752              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10753              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10754              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10755              GO TO 0550-st-comm-cap-check
 10756           ELSE
 10757              IF FIRST-TIME-THROUGH
 10758                  GO TO 0540-GET-LF-COMP
 10759              ELSE
 10760                  MOVE ER-2609                TO WS-ERROR
 10761                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10762                  GO TO 0550-st-comm-cap-check.
 10763
 10764     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10765        IF AM-L-COM (SUB1) NUMERIC
 10766           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10767           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10768           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10769           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10770           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10771        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 197
* EL050.cbl
 10772           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10773           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10774           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10775           MOVE ZEROS                TO WS-SUB1
 10776                                        WS-COMMISSION
 10777           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10778           IF WS-COMMISSION IS GREATER THAN ZEROS
 10779              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10780              GO TO 0550-st-comm-cap-check
 10781           END-IF
 10782           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10783           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10784           IF CTBL-TABLE-FOUND
 10785              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10786              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10787              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10788              GO TO 0550-st-comm-cap-check
 10789           ELSE
 10790              IF FIRST-TIME-THROUGH
 10791                  GO TO 0540-GET-LF-COMP
 10792              ELSE
 10793                  MOVE ER-2609                TO WS-ERROR
 10794                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10795
 10796 0550-st-comm-cap-check.
 10797
 10798     move +0                     to ws-tot-sl-wk-rate
 10799                                    ws-sl-wk-rate
 10800                                    ws-ga-sl-wk-rate
 10801                                    ws-tot-jl-wk-rate
 10802                                    ws-jl-wk-rate
 10803                                    ws-ga-jl-wk-rate
 10804                                    ws-tot-sa-wk-rate
 10805                                    ws-sa-wk-rate
 10806                                    ws-ga-sa-wk-rate
 10807                                    ws-tot-ja-wk-rate
 10808                                    ws-ja-wk-rate
 10809                                    ws-ga-ja-wk-rate
 10810     perform varying sub5 from +1 by +1 until
 10811        (sub5 > +10)
 10812        move +0                  to ws-wk-rate
 10813        if (am-gl-codes (sub5) <> 'Y')
 10814           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10815           if pb-i-lf-benefit-cd <> '  ' and '00'
 10816              move zeros         to ws-wk-rate
 10817              if (am-l-com (sub5) numeric)
 10818                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10819                 move am-l-com(sub5)
 10820                                 to ws-wk-rate
 10821              else
 10822                 move pb-company-cd to ctbl-company-cd
 10823                 move pb-i-lf-benefit-cd
 10824                                 to ctbl-ben-code
 10825                 move pb-i-lf-term  to ws-work-term
 10826                 move pb-life-override-l1
 10827                                 to ctbl-ben-type
 10828                 move zeros      to ws-sub1
 10829                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 198
* EL050.cbl
 10830                 move am-l-coma (sub5)
 10831                                 to ctbl-table
 10832                 move '0540'     to ctbl-sw
 10833                 perform 0552-get-it
 10834                                 thru 0552-exit
 10835              end-if
 10836              compute ws-tot-sl-wk-rate =
 10837                 ws-tot-sl-wk-rate + ws-wk-rate
 10838              if am-com-typ(sub5) = 'C' or 'D'
 10839                 compute ws-sl-wk-rate =
 10840                    ws-sl-wk-rate + ws-wk-rate
 10841              else
 10842                 if am-com-typ(sub5) = 'O' or 'P'
 10843                    compute ws-ga-sl-wk-rate =
 10844                       ws-ga-sl-wk-rate + ws-wk-rate
 10845                 end-if
 10846              end-if
 10847
 10848              move zeros         to ws-wk-rate
 10849              if (am-j-com (sub5) numeric)
 10850                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10851                 move am-j-com(sub5)
 10852                                 to ws-wk-rate
 10853              else
 10854                 move pb-company-cd to ctbl-company-cd
 10855                 move pb-i-lf-benefit-cd
 10856                                 to ctbl-ben-code
 10857                 move pb-i-lf-term  to ws-work-term
 10858                 move pb-life-override-l1
 10859                                 to ctbl-ben-type
 10860                 move zeros      to ws-sub1
 10861                                    ws-commission
 10862                 move am-j-coma (sub5)
 10863                                 to ctbl-table
 10864                 move '0540'     to ctbl-sw
 10865                 perform 0552-get-it
 10866                                 thru 0552-exit
 10867              end-if
 10868              compute ws-tot-jl-wk-rate =
 10869                 ws-tot-jl-wk-rate + ws-wk-rate
 10870              if am-com-typ(sub5) = 'C' or 'D'
 10871                 compute ws-jl-wk-rate =
 10872                    ws-jl-wk-rate + ws-wk-rate
 10873              else
 10874                 if am-com-typ(sub5) = 'O' or 'P'
 10875                    compute ws-ga-jl-wk-rate =
 10876                       ws-ga-jl-wk-rate + ws-wk-rate
 10877                 end-if
 10878              end-if
 10879           end-if
 10880           move zeros            to ws-wk-rate
 10881
 10882           if pb-i-ah-benefit-cd <> '  ' and '00'
 10883              if (am-a-com (sub5) numeric)
 10884                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10885                 move am-a-com(sub5)
 10886                                 to ws-wk-rate
 10887              else
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 199
* EL050.cbl
 10888                 move pb-company-cd to ctbl-company-cd
 10889                 move pb-i-ah-benefit-cd
 10890                                 to ctbl-ben-code
 10891                 move pb-i-ah-term  to ws-work-term
 10892                 move pb-ah-override-l1
 10893                                 to ctbl-ben-type
 10894                 move zeros      to ws-sub1
 10895                                    ws-commission
 10896                 move am-a-coma (sub5)
 10897                                 to ctbl-table
 10898                 move '0530'     to ctbl-sw
 10899                 perform 0552-get-it
 10900                                 thru 0552-exit
 10901              end-if
 10902              compute ws-tot-sa-wk-rate =
 10903                 ws-tot-sa-wk-rate + ws-wk-rate
 10904              if am-com-typ(sub5) = 'C' or 'D'
 10905                 compute ws-sa-wk-rate =
 10906                    ws-sa-wk-rate + ws-wk-rate
 10907              else
 10908                 if am-com-typ(sub5) = 'O' or 'P'
 10909                    compute ws-ga-sa-wk-rate =
 10910                       ws-ga-sa-wk-rate + ws-wk-rate
 10911                 end-if
 10912              end-if
 10913           end-if
 10914        end-if
 10915     end-perform
 10916
 10917     go to 0550-continue
 10918
 10919     .
 10920 0552-get-it.
 10921
 10922     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10923     MOVE ZEROS                  TO WS-SUB1
 10924                                    WS-COMMISSION
 10925     MOVE ' '                    TO WS-CTBL-READ-SW
 10926     PERFORM 8300-READ-CTBL-TABLE
 10927                                 THRU 8300-EXIT
 10928     IF FIRST-TIME-THROUGH
 10929        MOVE 'AA'                TO CTBL-BEN-CODE
 10930        PERFORM 8300-READ-CTBL-TABLE
 10931                                 THRU 8300-EXIT
 10932     END-IF
 10933     IF CTBL-TABLE-FOUND
 10934        if pb-life-override-l1 = ctbl-ben-type
 10935           move pb-i-lf-benefit-amt
 10936                                 to WS-COMM-CK-AMT
 10937        else
 10938           compute ws-comm-ck-amt =
 10939              pb-I-ah-benefit-amt * pb-i-ah-term
 10940        end-if
 10941        PERFORM 8800-GET-COMP-RATE
 10942                                 THRU 8800-EXIT
 10943     else
 10944        move zeros               to ws-wk-rate
 10945     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 200
* EL050.cbl
 10946
 10947     .
 10948 0552-exit.
 10949     exit.
 10950
 10951 0550-continue.
 10952
 10953     if ws-lf-joint-indicator = 'J'
 10954        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10955           and (ws-st-comm-cap-jl <> zeros)
 10956           MOVE ER-1956          TO WS-ERROR
 10957           PERFORM 9900-ERROR-FORMAT
 10958                                 THRU 9900-EXIT
 10959        end-if
 10960        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10961           and (ws-st-ga-comm-cap-jl <> zeros)
 10962           MOVE ER-1959          TO WS-ERROR
 10963           PERFORM 9900-ERROR-FORMAT
 10964                                 THRU 9900-EXIT
 10965        end-if
 10966        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10967           and (ws-st-tot-comm-cap-jl <> zeros)
 10968           MOVE ER-1962          TO WS-ERROR
 10969           PERFORM 9900-ERROR-FORMAT
 10970                                 THRU 9900-EXIT
 10971        end-if
 10972     else
 10973        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10974           and (ws-st-comm-cap-sl <> zeros)
 10975           MOVE ER-1955          TO WS-ERROR
 10976           PERFORM 9900-ERROR-FORMAT
 10977                                 THRU 9900-EXIT
 10978        end-if
 10979        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10980           and (ws-st-ga-comm-cap-sl <> zeros)
 10981           MOVE ER-1958          TO WS-ERROR
 10982           PERFORM 9900-ERROR-FORMAT
 10983                                 THRU 9900-EXIT
 10984        end-if
 10985        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10986           and (ws-st-tot-comm-cap-sl <> zeros)
 10987           MOVE ER-1961          TO WS-ERROR
 10988           PERFORM 9900-ERROR-FORMAT
 10989                                 THRU 9900-EXIT
 10990        end-if
 10991
 10992     if ws-ah-joint-indicator = 'J'
 10993        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10994           and (ws-st-comm-cap-ja <> zeros)
 10995           MOVE ER-1957          TO WS-ERROR
 10996           PERFORM 9900-ERROR-FORMAT
 10997                                 THRU 9900-EXIT
 10998        end-if
 10999        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 11000           and (ws-st-ga-comm-cap-ja <> zeros)
 11001           MOVE ER-1960          TO WS-ERROR
 11002           PERFORM 9900-ERROR-FORMAT
 11003                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 201
* EL050.cbl
 11004        end-if
 11005        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 11006           and (ws-st-tot-comm-cap-ja <> zeros)
 11007           MOVE ER-1963          TO WS-ERROR
 11008           PERFORM 9900-ERROR-FORMAT
 11009                                 THRU 9900-EXIT
 11010        end-if
 11011     else
 11012        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11013           and (ws-st-comm-cap-sa <> zeros)
 11014           MOVE ER-1957          TO WS-ERROR
 11015           PERFORM 9900-ERROR-FORMAT
 11016                                 THRU 9900-EXIT
 11017        end-if
 11018        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11019           and (ws-st-ga-comm-cap-sa <> zeros)
 11020           MOVE ER-1960          TO WS-ERROR
 11021           PERFORM 9900-ERROR-FORMAT
 11022                                 THRU 9900-EXIT
 11023        end-if
 11024        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11025           and (ws-st-tot-comm-cap-sa <> zeros)
 11026           MOVE ER-1963          TO WS-ERROR
 11027           PERFORM 9900-ERROR-FORMAT
 11028                                 THRU 9900-EXIT
 11029        end-if
 11030     end-if
 11031     .
 11032 0560-EDIT-CONTINUE.
 11033     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11034                                    WS-AH-PMF-COMM
 11035*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11036*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11037     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11038        (SUB1 > +10)
 11039        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11040           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11041           MOVE '0530'           TO CTBL-SW
 11042           MOVE ' '              TO WS-CTBL-READ-SW
 11043           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11044           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11045           MOVE '0540'           TO CTBL-SW
 11046           MOVE ' '              TO WS-CTBL-READ-SW
 11047           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11048        END-IF
 11049     END-PERFORM
 11050     GO TO 0564-EDIT-CONTINUE
 11051     .
 11052 0561-CHECK-AH.
 11053     IF (NO-AH-COVERAGE)
 11054        OR (NO-AH-BENEFIT-MATCH)
 11055        CONTINUE
 11056     ELSE
 11057        IF (AM-A-COM (SUB1) NUMERIC)
 11058           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11059           IF (AM-COM-TYP (SUB1) = 'A')
 11060              AND (WS-AH-PMF-COMM = ZEROS)
 11061              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 202
* EL050.cbl
 11062           END-IF
 11063           CONTINUE
 11064        ELSE
 11065           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11066           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11067           MOVE PB-AH-OVERRIDE-L1
 11068                                 TO CTBL-BEN-TYPE
 11069           MOVE ZEROS            TO WS-SUB1
 11070                                    WS-COMMISSION
 11071           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11072           PERFORM 8300-READ-CTBL-TABLE
 11073                                 THRU 8300-EXIT
 11074           IF CTBL-TABLE-FOUND
 11075              IF (AM-COM-TYP (SUB1) = 'A')
 11076                 AND (WS-AH-PMF-COMM = ZEROS)
 11077                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11078                                        PB-I-AH-TERM
 11079                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11080                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11081              END-IF
 11082              CONTINUE
 11083           ELSE
 11084              IF FIRST-TIME-THROUGH
 11085                 GO TO 0561-CHECK-AH
 11086              ELSE
 11087                 MOVE ER-2609    TO WS-ERROR
 11088                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11089              END-IF
 11090           END-IF
 11091        END-IF
 11092     END-IF
 11093     .
 11094 0561-EXIT.
 11095     EXIT.
 11096 0563-CHECK-LF.
 11097     IF (NO-LIFE-COVERAGE)
 11098        OR (NO-LF-BENEFIT-MATCH)
 11099        CONTINUE
 11100     ELSE
 11101        IF WS-LF-JOINT-INDICATOR = 'J'
 11102           IF AM-J-COM (SUB1) NUMERIC
 11103              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11104              IF (AM-COM-TYP (SUB1) = 'A')
 11105                 AND (WS-LF-PMF-COMM = ZEROS)
 11106                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11107              END-IF
 11108              CONTINUE
 11109           ELSE
 11110              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11111              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11112              MOVE PB-LIFE-OVERRIDE-L1
 11113                                 TO CTBL-BEN-TYPE
 11114              MOVE ZEROS         TO WS-SUB1
 11115                                    WS-COMMISSION
 11116              MOVE AM-J-COMA (SUB1)
 11117                                 TO CTBL-TABLE
 11118              PERFORM 8300-READ-CTBL-TABLE
 11119                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 203
* EL050.cbl
 11120              IF CTBL-TABLE-FOUND
 11121                 IF (AM-COM-TYP (SUB1) = 'A')
 11122                    AND (WS-LF-PMF-COMM = ZEROS)
 11123                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11124                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11125                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11126                 END-IF
 11127                 CONTINUE
 11128              ELSE
 11129                 IF FIRST-TIME-THROUGH
 11130                    GO TO 0563-CHECK-LF
 11131                 ELSE
 11132                    MOVE ER-2609 TO WS-ERROR
 11133                    PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135*                   GO TO 0560-EDIT-CONTINUE
 11136                 END-IF
 11137              END-IF
 11138           END-IF
 11139        ELSE
 11140           IF AM-L-COM (SUB1) NUMERIC
 11141              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11142              IF (AM-COM-TYP (SUB1) = 'A')
 11143                 AND (WS-LF-PMF-COMM = ZEROS)
 11144                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11145              END-IF
 11146              CONTINUE
 11147           ELSE
 11148              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11149              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11150              MOVE PB-LIFE-OVERRIDE-L1
 11151                                 TO CTBL-BEN-TYPE
 11152              MOVE ZEROS         TO WS-SUB1
 11153                                    WS-COMMISSION
 11154              MOVE AM-L-COMA (SUB1)
 11155                                 TO CTBL-TABLE
 11156              PERFORM 8300-READ-CTBL-TABLE
 11157                                 THRU 8300-EXIT
 11158              IF CTBL-TABLE-FOUND
 11159                 CONTINUE
 11160              ELSE
 11161                 IF FIRST-TIME-THROUGH
 11162                    GO TO 0563-CHECK-LF
 11163                 ELSE
 11164                    MOVE ER-2609 TO WS-ERROR
 11165                    PERFORM 9900-ERROR-FORMAT
 11166                                 THRU 9900-EXIT
 11167                 END-IF
 11168              END-IF
 11169           END-IF
 11170        END-IF
 11171     END-IF
 11172     .
 11173 0563-EXIT.
 11174     EXIT.
 11175 0564-EDIT-CONTINUE.
 11176
 11177     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 204
* EL050.cbl
 11178         IF PB-I-NUM-BILLED EQUAL ZEROS
 11179            MOVE ER-8148       TO WS-ERROR
 11180            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11181
 11182*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11183*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11184*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11185*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11186*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11187*         IF NO-CONVERSION-ERROR
 11188*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11189*         ELSE
 11190*             IF PB-COMPANY-ID EQUAL 'HAN'
 11191*                 MOVE ZEROS     TO PB-I-AGE.
 11192     IF PB-I-BIRTHDAY > LOW-VALUES
 11193        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11194        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11195        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11196        PERFORM 8500-DATE-CONVERT
 11197                                 THRU 8500-EXIT
 11198        IF NO-CONVERSION-ERROR
 11199           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11200           IF PB-I-AGE > ZEROS
 11201              IF WS-WORK-AGE NOT = PB-I-AGE
 11202                 MOVE ER-9501    TO WS-ERROR
 11203                 PERFORM 9900-ERROR-FORMAT
 11204                                 THRU 9900-EXIT
 11205              END-IF
 11206           ELSE
 11207              MOVE WS-WORK-AGE   TO PB-I-AGE
 11208           END-IF
 11209        END-IF
 11210     END-IF
 11211     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11212                                   WS-INS-AGE-SET
 11213     IF PB-I-AGE = ZEROS
 11214        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11215           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11216                                   WS-INS-AGE-SET
 11217           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11218
 11219     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11220                                   WS-AH-EDIT-AGE.
 11221
 11222     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11223        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11224        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11225        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11226        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11227        IF NO-CONVERSION-ERROR
 11228           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11229           IF PB-I-JOINT-AGE > 0
 11230              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11231                 MOVE ER-9503    TO WS-ERROR
 11232                 PERFORM 9900-ERROR-FORMAT
 11233                                 THRU 9900-EXIT
 11234              END-IF
 11235           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 205
* EL050.cbl
 11236              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11237           END-IF
 11238        ELSE
 11239           MOVE ZEROS            TO PB-I-JOINT-AGE
 11240        END-IF
 11241     END-IF
 11242     IF PB-I-JOINT-AGE NOT NUMERIC
 11243        MOVE ZERO               TO PB-I-JOINT-AGE.
 11244
 11245     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11246                                   WS-JNT-AGE-SET
 11247     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11248        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11249           (WS-AH-JOINT-INDICATOR = 'J')
 11250           IF PB-I-JOINT-AGE = ZEROS
 11251               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11252                                          WS-JNT-AGE-SET
 11253               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11254           END-IF
 11255        END-IF
 11256     END-IF
 11257
 11258     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11259     IF WS-LF-JOINT-INDICATOR = 'J'
 11260        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11261        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11262            IF  PB-I-JOINT-AGE = ZERO
 11263                MOVE ER-2686       TO WS-ERROR
 11264                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11265            ELSE
 11266                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11267                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11268                    IF PB-COMPANY-ID NOT = 'LBL'
 11269                        MOVE ER-2685    TO WS-ERROR
 11270                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272     IF WS-AH-JOINT-INDICATOR = 'J'
 11273        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11274            IF  PB-I-JOINT-AGE = ZERO
 11275                MOVE ER-2686       TO WS-ERROR
 11276                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11277            ELSE
 11278                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11279                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11280                                           WS-EDIT-AGE
 11281                    IF PB-COMPANY-ID NOT = 'LBL'
 11282                        MOVE ER-2685    TO WS-ERROR
 11283                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11284
 11285******************************************************************
 11286*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11287******************************************************************
 11288
 11289     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11290        (WS-AH-SPECIAL-CALC-CD = 'O')
 11291        NEXT SENTENCE
 11292     ELSE
 11293        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 206
* EL050.cbl
 11294          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11295           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11296            WS-AH-JOINT-INDICATOR = 'J')  AND
 11297           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11298            MOVE ER-2627             TO WS-ERROR
 11299            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11300
 11301     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11302        (WS-AH-SPECIAL-CALC-CD = 'O')
 11303         NEXT SENTENCE
 11304     ELSE
 11305         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11306            WS-AH-JOINT-INDICATOR = 'J'
 11307             IF PB-I-JOINT-INSURED = SPACES
 11308                 IF PB-COMPANY-ID NOT = 'JAL'
 11309                     MOVE ER-2696    TO WS-ERROR
 11310                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11311
 11312     IF PB-COMPANY-ID NOT = 'BOA'
 11313        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11314           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11315           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11316               PB-I-JOINT-INSURED NOT = SPACES)
 11317                MOVE ER-2691         TO WS-ERROR
 11318                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11319
 11320     IF PB-COMPANY-ID = 'BOA'
 11321        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11322           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11323            IF PB-I-JOINT-AGE NOT = ZEROS
 11324                MOVE ER-2691         TO WS-ERROR
 11325                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11326
 11327     IF PB-COMPANY-ID = 'CRI'
 11328        IF PB-I-SIG-SW = 'J'
 11329           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11330              WS-AH-JOINT-INDICATOR NOT = 'J'
 11331              MOVE ER-2675       TO WS-ERROR
 11332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11333
 11334     IF PB-COMPANY-ID = 'CRI'
 11335        IF PB-I-SIG-SW = 'S'
 11336           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11337              WS-AH-JOINT-INDICATOR = 'J'
 11338              MOVE ER-2676       TO WS-ERROR
 11339              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11340
 11341     IF PB-COMPANY-ID = 'CVL'
 11342         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11343            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11344              MOVE ER-2783           TO WS-ERROR
 11345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11346     IF (WS-LF-JOINT-INDICATOR = 'J')
 11347        AND (WS-AH-JOINT-INDICATOR = 'J')
 11348        AND (PB-I-LF-TERM > 120)
 11349        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11350        MOVE ER-2783             TO WS-ERROR
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 207
* EL050.cbl
 11352     END-IF
 11353     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11354
 11355     IF PB-I-INDV-GRP-OVRD = 'I'
 11356        MOVE ER-2666             TO WS-ERROR
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11359
 11360     IF PB-I-INDV-GRP-OVRD = 'G'
 11361        MOVE ER-2666             TO WS-ERROR
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11364
 11365     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11366        NEXT SENTENCE
 11367     ELSE
 11368        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11369
 11370     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11371        IF WS-ERROR = ER-2666
 11372           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11373           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11374
 11375     IF PB-COMPANY-ID = 'CID'
 11376        IF PB-STATE = 'UT' OR 'MO'
 11377           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11378                 OR '76' OR '77')
 11379                      OR
 11380               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11381                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11382                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11383                   OR '2K' OR '2L'))
 11384              AND PB-I-INDV-GRP-CD = 'I'
 11385              MOVE ER-2721             TO WS-ERROR
 11386              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387           END-IF
 11388        END-IF
 11389     END-IF
 11390
 11391     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11392     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11393        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11394     ELSE
 11395        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11396     END-IF
 11397
 11398*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11399*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11400     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11401                                    ACCOUNT-AH-CK-SW.
 11402
 11403     IF PB-REISSUED-CERT       OR
 11404        PB-REIN-ONLY-CERT      OR
 11405        PB-POLICY-IS-DECLINED  OR
 11406        PB-POLICY-IS-VOIDED
 11407*       OR PB-MONTHLY-CERT
 11408         GO TO 3000-CONTINUE-EDIT.
 11409
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 208
* EL050.cbl
 11410     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11411        IF WS-EDIT-AGE           > +65
 11412           MOVE ER-2709          TO WS-ERROR
 11413           PERFORM 9900-ERROR-FORMAT
 11414                                 THRU 9900-EXIT
 11415        ELSE
 11416           IF WS-EDIT-AGE        > +55
 11417              MOVE ER-2718       TO WS-ERROR
 11418              PERFORM 9900-ERROR-FORMAT
 11419                                 THRU 9900-EXIT
 11420           END-IF
 11421        END-IF
 11422     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11423        IF WS-EDIT-AGE           > +65
 11424           MOVE ER-2709          TO WS-ERROR
 11425           PERFORM 9900-ERROR-FORMAT
 11426                                 THRU 9900-EXIT
 11427        END-IF
 11428     END-IF
 11429     .
 11430
 11431 0565-LIFE-PLAN-LIMIT-EDITS.
 11432
 11433     IF NOT LF-PLAN-MASTER-FOUND
 11434        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11435                                    EC-AM-LF-MAX-TOT-BEN
 11436        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11437
 11438     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11439
 11440     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11441         IF PL-LM-AGE (1) = ZEROS
 11442             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11443
 11444     IF NO-LF-BENEFIT-MATCH          OR
 11445        WS-LF-BENEFIT-CD = ZEROS     OR
 11446        WS-LF-SPECIAL-CALC-CD = 'M'
 11447        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11448
 11449     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11450     MOVE +1                     TO SUB2.
 11451
 11452     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11453        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11454           MOVE +5   TO SUB2
 11455           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11456              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11457              (PL-LM-AGE (SUB2) EQUAL +0)
 11458              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11459              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11460
 11461     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11462
 11463     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11464                               + PB-I-LF-ALT-BENEFIT-AMT.
 11465
 11466 0568-CHECK-LIFE-ATT-AGE.
 11467
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 209
* EL050.cbl
 11468     IF PL-ATT-AGE NUMERIC AND
 11469        PL-ATT-AGE > +0
 11470        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11471     END-IF
 11472*    IF PL-ATT-AGE NUMERIC AND
 11473*       PL-ATT-AGE > +0
 11474*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11475*       IF PB-I-BIRTHDAY > LOW-VALUES
 11476*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11477*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11478*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11479*          SET BIN-PLUS-ELAPSED  TO TRUE
 11480*          PERFORM 8500-DATE-CONVERT
 11481*                                THRU 8500-EXIT
 11482*          IF NO-CONVERSION-ERROR
 11483*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11484*             MOVE ER-2669       TO WS-ERROR
 11485*             PERFORM 9900-ERROR-FORMAT
 11486*                                THRU 9900-EXIT
 11487*          END-IF
 11488*       ELSE
 11489*          IF WS-ATT-AGE >= PL-ATT-AGE
 11490*             MOVE ER-2669       TO WS-ERROR
 11491*             PERFORM 9900-ERROR-FORMAT
 11492*                                THRU 9900-EXIT
 11493*          END-IF
 11494*       END-IF
 11495*    END-IF
 11496     .
 11497 0570-CHECK-LIFE-LIMITS.
 11498
 11499     IF PB-COMPANY-ID EQUAL 'CRI'
 11500        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11501           IF SUB2 GREATER THAN +4
 11502              MOVE ER-2637 TO WS-ERROR
 11503              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11505
 11506     IF PB-COMPANY-ID  =  'NCL'
 11507        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11508            SUB2 GREATER THAN +8
 11509             MOVE 'U'         TO PB-BATCH-ENTRY
 11510             MOVE ER-2637     TO WS-ERROR
 11511             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11513
 11514     IF SUB2 > +8
 11515        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11516           AND (PB-I-SIG-SW = 'Y')
 11517           CONTINUE
 11518        ELSE
 11519           MOVE ER-2637          TO WS-ERROR
 11520           PERFORM 9900-ERROR-FORMAT
 11521                                 THRU 9900-EXIT
 11522        END-IF
 11523        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11524     END-IF
 11525     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 210
* EL050.cbl
 11526     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11527     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11528
 11529     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11530        ADD +1  TO SUB2
 11531        GO TO 0570-CHECK-LIFE-LIMITS.
 11532
 11533     IF PB-COMPANY-ID = 'NCL'
 11534         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11535
 11536     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11537        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11538        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11539           AND (PB-I-SIG-SW = 'Y')
 11540           CONTINUE
 11541        ELSE
 11542           MOVE ER-2637          TO WS-ERROR
 11543           PERFORM 9900-ERROR-FORMAT
 11544                                 THRU 9900-EXIT
 11545        END-IF
 11546     END-IF
 11547     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11548
 11549
 11550 0570-CHECK-NCL-LIFE-LIMITS.
 11551
 11552     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11553        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11554         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11555
 11556     IF APP-CERT-USED
 11557         IF SUB2  LESS THAN  +5
 11558             MOVE +5          TO SUB2
 11559             GO TO 0570-CHECK-LIFE-LIMITS.
 11560
 11561     MOVE ER-2637             TO WS-ERROR.
 11562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11563
 11564     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11565
 11566 0575-CHECK-NCL-SIG-SWITCH.
 11567
 11568     IF NOT APP-CERT-USED
 11569         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11570
 11571     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11572        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11573        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11574        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11575         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11576
 11577     IF SUB2 GREATER THAN +4
 11578         IF PL-LM-AGE (5) = ZEROS  AND
 11579            PL-LM-AGE (6) = ZEROS  AND
 11580            PL-LM-AGE (7) = ZEROS  AND
 11581            PL-LM-AGE (8) = ZEROS
 11582             MOVE  ER-1927        TO WS-ERROR
 11583             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 211
* EL050.cbl
 11584             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11585         ELSE
 11586             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11587                 MOVE  ER-1920    TO WS-ERROR
 11588                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11589
 11590     IF PB-I-SIG-SW  = 'Y'
 11591       IF NOT PB-I-POLICY-ACCEPTED  AND
 11592          NOT PB-I-POLICY-DECLINED
 11593           MOVE 'U'               TO PB-BATCH-ENTRY
 11594           MOVE  ER-1926          TO WS-ERROR
 11595           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11596
 11597
 11598 0580-AH-PLAN-LIMIT-EDITS.
 11599
 11600     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11601        IF PB-I-AH-BENEFIT-AMT > +1250
 11602           MOVE ER-2702          TO WS-ERROR
 11603           PERFORM 9900-ERROR-FORMAT
 11604                                 THRU 9900-EXIT
 11605        END-IF
 11606     END-IF
 11607
 11608     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11609        AND (PB-MONTHLY-CERT)
 11610        IF PB-I-AH-BENEFIT-AMT > +3000
 11611           MOVE ER-2881          TO WS-ERROR
 11612           PERFORM 9900-ERROR-FORMAT
 11613                                 THRU 9900-EXIT
 11614        END-IF
 11615     END-IF
 11616     IF NOT AH-PLAN-MASTER-FOUND
 11617        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11618        GO TO 3000-CONTINUE-EDIT.
 11619
 11620     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11621
 11622     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11623         IF PL-LM-AGE (1) = ZEROS
 11624             GO TO 3000-CONTINUE-EDIT.
 11625
 11626     IF NO-AH-BENEFIT-MATCH          OR
 11627        WS-AH-BENEFIT-CD = ZEROS     OR
 11628        WS-AH-SPECIAL-CALC-CD = 'M'
 11629        GO TO 3000-CONTINUE-EDIT.
 11630
 11631     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11632     MOVE +1                     TO SUB2.
 11633
 11634     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11635        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11636           MOVE +5 TO SUB2
 11637           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11638              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11639              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11640              (PL-LM-AGE (SUB2) EQUAL +0)
 11641              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 212
* EL050.cbl
 11642              GO TO 3000-CONTINUE-EDIT.
 11643
 11644     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11645
 11646 0590-CHECK-AH-ATT-AGE.
 11647
 11648     IF PL-ATT-AGE NUMERIC AND
 11649        PL-ATT-AGE GREATER THAN +0
 11650        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11651     END-IF
 11652*       IF WS-ATT-AGE >= PL-ATT-AGE
 11653*          MOVE ER-3054          TO WS-ERROR
 11654*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11655     .
 11656 0597-CHECK-AH-LIMITS.
 11657
 11658     IF PB-COMPANY-ID EQUAL 'CRI'
 11659        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11660           IF SUB2 GREATER THAN +4
 11661              MOVE ER-2638       TO WS-ERROR
 11662              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663              GO TO 3000-CONTINUE-EDIT.
 11664
 11665     IF PB-COMPANY-ID  =  'NCL'
 11666        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11667            SUB2 GREATER THAN +8
 11668             MOVE 'U'            TO PB-BATCH-ENTRY
 11669             MOVE ER-2638        TO WS-ERROR
 11670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11671             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11672
 11673     IF SUB2 > +8
 11674        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11675           AND (PB-I-SIG-SW = 'Y')
 11676           CONTINUE
 11677        ELSE
 11678           MOVE ER-2638          TO WS-ERROR
 11679           PERFORM 9900-ERROR-FORMAT
 11680                                 THRU 9900-EXIT
 11681        END-IF
 11682        GO TO 3000-CONTINUE-EDIT
 11683     END-IF
 11684
 11685     IF PB-COMPANY-ID = 'CRI'
 11686        IF WS-ERROR = ER-2638
 11687           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11688
 11689     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11690     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11691     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11692     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11693
 11694     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11695        ADD +1                   TO SUB2
 11696        GO TO 0597-CHECK-AH-LIMITS.
 11697
 11698     IF PB-COMPANY-ID = 'NCL'
 11699         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 213
* EL050.cbl
 11700
 11701     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11702        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11703        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11704                                 > PL-LM-AMT (SUB2))
 11705        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11706           AND (PB-I-SIG-SW = 'Y')
 11707           CONTINUE
 11708        ELSE
 11709           MOVE ER-2638          TO WS-ERROR
 11710           PERFORM 9900-ERROR-FORMAT
 11711                                 THRU 9900-EXIT
 11712        END-IF
 11713     END-IF
 11714
 11715     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11716         IF  WS-ERROR    EQUAL    ER-2638
 11717             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11718                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11719                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11720                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11721                MOVE  ER-1910    TO  WS-ERROR
 11722                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11723
 11724     IF PB-COMPANY-ID = 'CRI'
 11725        IF WS-ERROR = ER-2638
 11726            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11727            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11728            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11729
 11730     GO TO 3000-CONTINUE-EDIT.
 11731
 11732 0597-CHECK-NCL-AH-LIMITS.
 11733
 11734     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11735        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11736        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11737                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11738         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11739
 11740     IF APP-CERT-USED
 11741         IF SUB2  LESS THAN  +5
 11742             MOVE +5             TO SUB2
 11743             GO TO 0597-CHECK-AH-LIMITS.
 11744
 11745     MOVE ER-2638                TO WS-ERROR.
 11746     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11747
 11748     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11749
 11750 0599-CHECK-NCL-SIG-SWITCH.
 11751
 11752     IF NOT APP-CERT-USED
 11753         GO TO 3000-CONTINUE-EDIT.
 11754
 11755     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11756        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11757        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 214
* EL050.cbl
 11758        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11759         GO TO 3000-CONTINUE-EDIT.
 11760
 11761     IF SUB2 GREATER THAN +4
 11762         IF PL-LM-AGE (5) = ZEROS  AND
 11763            PL-LM-AGE (6) = ZEROS  AND
 11764            PL-LM-AGE (7) = ZEROS  AND
 11765            PL-LM-AGE (8) = ZEROS
 11766             MOVE  ER-1927        TO WS-ERROR
 11767             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11768             GO TO 3000-CONTINUE-EDIT
 11769         ELSE
 11770             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11771                 MOVE  ER-1920    TO WS-ERROR
 11772                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11773
 11774     IF PB-I-SIG-SW  = 'Y'
 11775       IF NOT PB-I-POLICY-ACCEPTED  AND
 11776          NOT PB-I-POLICY-DECLINED
 11777           MOVE 'U'               TO PB-BATCH-ENTRY
 11778           MOVE  ER-1926          TO WS-ERROR
 11779           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11780
 11781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 215
* EL050.cbl
 11783
 11784 3000-CONTINUE-EDIT.
 11785
 11786     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11787     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11788     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11789     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11790     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11791
 11792     IF BROWSE-STARTED
 11793        PERFORM 9990-RETURN THRU 9990-EXIT
 11794        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11795
 11796     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11797        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11798        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11799        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11800*       MOVE 1                   TO DC-OPTION-CODE
 11801        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11802        IF DATE-CONVERSION-ERROR
 11803           MOVE ER-2622          TO WS-ERROR
 11804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11805        ELSE
 11806           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11807              MOVE ER-2623       TO WS-ERROR
 11808              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11809           ELSE
 11810              MOVE ER-2622       TO WS-ERROR
 11811              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11812
 11813     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11814     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11815     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11816*    MOVE 1                      TO DC-OPTION-CODE.
 11817     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11818     IF DATE-CONVERSION-ERROR
 11819        GO TO 3005-EDIT-CONTINUE
 11820     ELSE
 11821        IF DC-ELAPSED-DAYS GREATER +180
 11822           MOVE ER-2613          TO WS-ERROR
 11823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824        ELSE
 11825           IF DC-ELAPSED-DAYS GREATER +90
 11826              MOVE ER-2612       TO WS-ERROR
 11827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11828           ELSE
 11829             IF DC-ELAPSED-DAYS GREATER +60
 11830                MOVE ER-2614     TO WS-ERROR
 11831                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11832
 11833 3005-EDIT-CONTINUE.
 11834
 11835     IF PB-CANCELLATION
 11836         GO TO 3700-EDIT-CANCEL.
 11837
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 216
* EL050.cbl
 11839******************************************************************
 11840*                  E D I T   I S S U E                           *
 11841******************************************************************
 11842
 11843 3020-EDIT-ISSUE.
 11844
 11845      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11846      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11847      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11848      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11849      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11850
 11851     IF PB-ISSUE-FORCE
 11852        OR PB-ISSUE-DATE-FORCED
 11853        OR PB-FORCE-OFF
 11854        OR PB-OVERCHARGE-FORCE
 11855        or pb-exceeded-limit-forced
 11856        CONTINUE
 11857     ELSE
 11858        MOVE ER-2670             TO WS-ERROR
 11859        PERFORM 9900-ERROR-FORMAT
 11860                                 THRU 9900-EXIT
 11861     END-IF
 11862     .
 11863 3022-SET-POLICY-STATUS.
 11864
 11865     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11866
 11867     IF (PB-REISSUED-CERT)
 11868             OR
 11869        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11870         AND (PB-MONTHLY-CERT))
 11871         MOVE '5'                TO PB-I-ENTRY-STATUS
 11872         MOVE 'E'                TO PB-BATCH-ENTRY
 11873     END-IF
 11874
 11875     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11876        IF PB-MONTHLY-CERT
 11877           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11878        END-IF
 11879        IF PB-CASH-CERT
 11880           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11881        END-IF
 11882     END-IF
 11883     IF PB-POLICY-IS-DECLINED
 11884         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11885     IF PB-POLICY-IS-VOIDED
 11886         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11887     IF PB-NEEDS-UNDERWRITING
 11888         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11889     IF PB-REIN-ONLY-CERT
 11890         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11891     IF PB-PREM-ACCTNG-ONLY
 11892         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11893
 11894     MOVE SPACE                  TO PB-I-OB-FLAG.
 11895
 11896     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 217
* EL050.cbl
 11897         MOVE ER-2665            TO WS-ERROR
 11898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11899         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11900
 11901     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11902        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11903           MOVE 'Z'             TO PB-I-OB-FLAG.
 11904
 11905     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11906        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11907           MOVE 'Z'             TO PB-I-OB-FLAG.
 11908
 11909     IF ACCOUNT-MAST-FOUND
 11910         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11911         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11912         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11913         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11914         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11915         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11916         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11917     END-IF
 11918
 11919     IF ACCOUNT-MAST-FOUND
 11920        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11921         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11922
 11923     IF (ACCOUNT-MAST-FOUND)
 11924*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11925        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11926        IF PB-REISSUED-CERT
 11927           CONTINUE
 11928        ELSE
 11929           MOVE ER-2608          TO WS-ERROR
 11930           PERFORM 9900-ERROR-FORMAT
 11931                                 THRU 9900-EXIT
 11932         END-IF
 11933     END-IF
 11934
 11935     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11936        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11937        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11938
 11939**********   DMD CUSTOM CODE FOLLOWS  **********
 11940 3024-EDIT-DMD-FIELDS.
 11941     IF PB-COMPANY-ID NOT = 'DMD'
 11942        GO TO 3025-EDIT-REINSURANCE.
 11943
 11944*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11945*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11946*** ERROR IF THEY ARE NOT EQUAL.
 11947
 11948     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11949     SET BIN-TO-GREG               TO TRUE.
 11950     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11951     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11952**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11953
 11954     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 218
* EL050.cbl
 11955     SET BIN-TO-GREG               TO TRUE.
 11956     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11957     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11958**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11959
 11960     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11961        MOVE ER-8116               TO WS-ERROR
 11962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11963
 11964     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11965
 11966     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11967                                      WK-FULL-CERT-NO.
 11968     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11969
 11970     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11971
 11972     IF PB-VALID-LIFE
 11973        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11974     ELSE
 11975        IF PB-VALID-AH
 11976          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11977
 11978
 11979     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11980     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11981     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11982                                      DCUA-UNDRWRTR-CODE
 11983                                      DCUA-UNDRWRTR-GROUP-CODE
 11984                                      DCUA-RETURN-CODE.
 11985
 11986****************************************************************
 11987*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11988***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11989***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11990***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11991***   TO THIS RECORD.                                        ***
 11992****************************************************************
 11993     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11994     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11995     IF DCUA-SUCCESSFUL-PROCESS
 11996        GO TO 3024-EDIT-DL7-CONT.
 11997
 11998     IF DCUA-RETURN-CODE EQUAL '01'
 11999        MOVE ER-8110               TO WS-ERROR
 12000        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002        GO TO 3024-EDIT-DL7-CONT.
 12003
 12004     IF DCUA-RETURN-CODE EQUAL '02'
 12005        MOVE ER-8111               TO WS-ERROR
 12006        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12008        GO TO 3024-EDIT-DL7-CONT.
 12009
 12010     IF DCUA-RETURN-CODE EQUAL '03'
 12011        MOVE ER-8074               TO WS-ERROR
 12012        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 219
* EL050.cbl
 12013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12014        GO TO 3024-EDIT-DL7-CONT.
 12015
 12016     IF DCUA-RETURN-CODE EQUAL '04'
 12017        MOVE ER-8075               TO WS-ERROR
 12018        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12020        GO TO 3024-EDIT-DL7-CONT.
 12021
 12022     IF DCUA-RETURN-CODE EQUAL '05'
 12023        MOVE ER-8076               TO WS-ERROR
 12024        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12026        GO TO 3024-EDIT-DL7-CONT.
 12027
 12028     IF DCUA-RETURN-CODE EQUAL '06'
 12029        MOVE ER-8077               TO WS-ERROR
 12030        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12032        GO TO 3024-EDIT-DL7-CONT.
 12033
 12034     IF DCUA-RETURN-CODE EQUAL '07'
 12035        MOVE ER-8078               TO WS-ERROR
 12036        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12037        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12038        GO TO 3024-EDIT-DL7-CONT.
 12039
 12040     IF DCUA-RETURN-CODE EQUAL 'E1'
 12041        MOVE ER-8079               TO WS-ERROR
 12042        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12044        GO TO 3024-EDIT-DL7-CONT.
 12045
 12046     IF DCUA-RETURN-CODE EQUAL 'E2'
 12047        MOVE ER-8080               TO WS-ERROR
 12048        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12050        GO TO 3024-EDIT-DL7-CONT.
 12051
 12052     IF DCUA-RETURN-CODE EQUAL 'E3'
 12053        MOVE ER-8098               TO WS-ERROR
 12054        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12056        GO TO 3024-EDIT-DL7-CONT.
 12057
 12058     IF DCUA-RETURN-CODE EQUAL 'C1'
 12059        MOVE ER-8099               TO WS-ERROR
 12060        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12062        GO TO 3024-EDIT-DL7-CONT.
 12063
 12064     IF DCUA-RETURN-CODE EQUAL 'U1'
 12065        MOVE ER-8109               TO WS-ERROR
 12066        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12068        GO TO 3024-EDIT-DL7-CONT.
 12069
 12070     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 220
* EL050.cbl
 12071        MOVE ER-8112               TO WS-ERROR
 12072        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12074        GO TO 3024-EDIT-DL7-CONT.
 12075
 12076     IF DCUA-RETURN-CODE EQUAL 'N2'
 12077        MOVE ER-8113               TO WS-ERROR
 12078        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12080        GO TO 3024-EDIT-DL7-CONT.
 12081
 12082     IF DCUA-RETURN-CODE EQUAL 'N3'
 12083        MOVE ER-8114               TO WS-ERROR
 12084        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12086        GO TO 3024-EDIT-DL7-CONT.
 12087
 12088     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12089     MOVE ER-8097                  TO WS-ERROR.
 12090     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12091     GO TO 3024-EDIT-DL7-CONT.
 12092
 12093 3024-EDIT-DL7-CONT.
 12094
 12095     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12096     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12097     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12098        NEXT SENTENCE
 12099     ELSE
 12100        MOVE ER-9263               TO WS-ERROR
 12101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12102
 12103******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12104******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12105     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12106        NEXT SENTENCE
 12107     ELSE
 12108        MOVE ER-8039               TO WS-ERROR
 12109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12110
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 221
* EL050.cbl
 12112****************************************************************
 12113*** VALIDATE STATE  : DLO022                                 ***
 12114****************************************************************
 12115     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12116     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12117
 12118     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12119     IF DVSC-SUCCESSFUL-EDIT
 12120        GO TO 3024-EDIT-DL22-CONT.
 12121
 12122     IF DVSC-RETURN-CODE EQUAL '01'
 12123        MOVE ER-8300               TO WS-ERROR
 12124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12125        GO TO 3024-EDIT-DL22-CONT.
 12126
 12127     IF DVSC-RETURN-CODE EQUAL '02'
 12128        MOVE ER-8301               TO WS-ERROR
 12129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12130        GO TO 3024-EDIT-DL22-CONT.
 12131
 12132     IF DVSC-RETURN-CODE EQUAL '03'
 12133        MOVE ER-8302               TO WS-ERROR
 12134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12135        GO TO 3024-EDIT-DL22-CONT.
 12136
 12137     IF DVSC-RETURN-CODE EQUAL 'N1'
 12138        MOVE ER-8304               TO WS-ERROR
 12139        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12140        GO TO 3024-EDIT-DL22-CONT.
 12141
 12142     MOVE ER-8303                  TO WS-ERROR
 12143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12144
 12145 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 222
* EL050.cbl
 12147****************************************************************
 12148*** VALIDATE LOAN OFFICER : DLO021                           ***
 12149****************************************************************
 12150
 12151     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12152     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12153     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12154     IF DVLO-SUCCESSFUL-EDIT
 12155        GO TO 3024-EDIT-DL21-CONT.
 12156
 12157     IF DVLO-RETURN-CODE EQUAL '01'
 12158        MOVE ER-8081               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL21-CONT.
 12161
 12162     IF DVLO-RETURN-CODE EQUAL '02'
 12163        MOVE ER-8082               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL21-CONT.
 12166
 12167     IF DVLO-RETURN-CODE EQUAL '03'
 12168        MOVE ER-8083               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL21-CONT.
 12171
 12172     IF DVLO-RETURN-CODE EQUAL '04'
 12173        MOVE ER-8084               TO WS-ERROR
 12174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12175        GO TO 3024-EDIT-DL21-CONT.
 12176
 12177     IF DVLO-RETURN-CODE EQUAL '05'
 12178        MOVE ER-8085               TO WS-ERROR
 12179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12180        GO TO 3024-EDIT-DL21-CONT.
 12181
 12182     MOVE ER-7825                  TO WS-ERROR
 12183     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12184     GO TO 3024-EDIT-DL21-CONT.
 12185
 12186 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 223
* EL050.cbl
 12188
 12189****************************************************************
 12190*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12191****************************************************************
 12192
 12193     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12194     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12195     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12196     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12197     IF DIPF-SUCCESSFUL-EDIT
 12198        GO TO 3024-EDIT-DL02-CONT.
 12199
 12200     IF DIPF-RETURN-CODE EQUAL '01'
 12201        MOVE ER-8086               TO WS-ERROR
 12202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12203        GO TO 3024-EDIT-DL02-CONT.
 12204
 12205     IF DIPF-RETURN-CODE EQUAL '02'
 12206        MOVE ER-8087               TO WS-ERROR
 12207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12208        GO TO 3024-EDIT-DL02-CONT.
 12209
 12210     IF DIPF-RETURN-CODE EQUAL '03'
 12211        MOVE ER-8088               TO WS-ERROR
 12212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12213        GO TO 3024-EDIT-DL02-CONT.
 12214
 12215     MOVE ER-8095                  TO WS-ERROR
 12216     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12217     GO TO 3024-EDIT-DL02-CONT.
 12218
 12219 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 224
* EL050.cbl
 12221
 12222****************************************************************
 12223*** VALIDATE BANK ID : DLO003                                ***
 12224****************************************************************
 12225
 12226     MOVE WK-GREG-CENT           TO WCG-CENT.
 12227     MOVE WK-GREG-YYMM           TO WCG-REST.
 12228     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12229        MOVE ER-8040               TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12231
 12232     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12233     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12234     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12235     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12236     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12237     IF DVBI-SUCCESSFUL-EDIT
 12238        GO TO 3024-EDIT-DL03-CONT.
 12239
 12240     IF DVBI-RETURN-CODE EQUAL '01'
 12241        MOVE ER-8089               TO WS-ERROR
 12242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12243        GO TO 3024-EDIT-DL03-CONT.
 12244
 12245     IF DVBI-RETURN-CODE EQUAL '02'
 12246        MOVE ER-8090               TO WS-ERROR
 12247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12248        GO TO 3024-EDIT-DL03-CONT.
 12249
 12250     IF DVBI-RETURN-CODE EQUAL '03'
 12251        MOVE ER-8091               TO WS-ERROR
 12252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253        GO TO 3024-EDIT-DL03-CONT.
 12254
 12255     IF DVBI-RETURN-CODE EQUAL '04'
 12256        MOVE ER-8092               TO WS-ERROR
 12257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258        GO TO 3024-EDIT-DL03-CONT.
 12259
 12260     IF DVBI-RETURN-CODE EQUAL '05'
 12261        MOVE ER-8093               TO WS-ERROR
 12262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12263        GO TO 3024-EDIT-DL03-CONT.
 12264
 12265     IF DVBI-RETURN-CODE EQUAL '06'
 12266        MOVE ER-8094               TO WS-ERROR
 12267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12268        GO TO 3024-EDIT-DL03-CONT.
 12269
 12270     MOVE ER-8096                  TO WS-ERROR
 12271     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12272     GO TO 3024-EDIT-DL03-CONT.
 12273
 12274 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 225
* EL050.cbl
 12276
 12277     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12278        NEXT SENTENCE
 12279     ELSE
 12280        MOVE ER-8042               TO WS-ERROR
 12281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12284     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12285     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12286
 12287     IF DMPF-RETURN-CODE = '01'
 12288        MOVE ER-8067               TO WS-ERROR
 12289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290        GO TO 3024-EDIT-DL01-CONT.
 12291
 12292     IF DMPF-RETURN-CODE = '02'
 12293        MOVE ER-8068               TO WS-ERROR
 12294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12295        GO TO 3024-EDIT-DL01-CONT.
 12296
 12297     IF DMPF-RETURN-CODE = '03'
 12298        MOVE ER-8069               TO WS-ERROR
 12299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12300        GO TO 3024-EDIT-DL01-CONT.
 12301
 12302     IF DMPF-RETURN-CODE = 'E1'
 12303        MOVE ER-8070               TO WS-ERROR
 12304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12305        GO TO 3024-EDIT-DL01-CONT.
 12306
 12307     IF DMPF-RETURN-CODE = 'N1'
 12308        MOVE ER-8071               TO WS-ERROR
 12309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12310        GO TO 3024-EDIT-DL01-CONT.
 12311
 12312     IF DMPF-RETURN-CODE NOT = 'OK'
 12313        MOVE ER-8072               TO WS-ERROR
 12314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12315
 12316 3024-EDIT-DL01-CONT.
 12317******************************************************************
 12318***  VALIDATES RATE CODES : DLO017                             ***
 12319******************************************************************
 12320
 12321      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12322      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12323      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12324      IF DVRC-SUCCESSFUL-EDIT
 12325        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12326        GO TO 3024-CHECK-VALID-RATE.
 12327
 12328      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12329
 12330      IF DVRC-RETURN-CODE EQUAL '01'
 12331         MOVE ER-7817                   TO WS-ERROR
 12332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12333         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 226
* EL050.cbl
 12334
 12335      IF DVRC-RETURN-CODE EQUAL '02'
 12336         MOVE ER-7818                   TO WS-ERROR
 12337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12338         GO TO 3025-EDIT-REINSURANCE.
 12339
 12340      IF DVRC-RETURN-CODE EQUAL '03'
 12341         MOVE ER-7819                   TO WS-ERROR
 12342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12343         GO TO 3025-EDIT-REINSURANCE.
 12344
 12345       MOVE ER-7820                     TO WS-ERROR.
 12346       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12347       GO TO 3025-EDIT-REINSURANCE.
 12348
 12349******************************************************************
 12350***  GET PREMIUM RATES : DLO011                                ***
 12351******************************************************************
 12352
 12353 3024-CHECK-VALID-RATE.
 12354
 12355     IF VALID-RATE-CODE
 12356        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12357        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12358        MOVE SPACES                TO DPRB-RETURN-CODE
 12359        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12360     ELSE
 12361         GO TO 3025-EDIT-REINSURANCE.
 12362
 12363      IF DPRB-SUCCESSFUL-PROCESS
 12364         IF PB-VALID-LIFE
 12365             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12366             GO TO 3025-EDIT-REINSURANCE
 12367         ELSE
 12368             IF PB-VALID-AH
 12369                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12370                 GO TO 3025-EDIT-REINSURANCE.
 12371
 12372      IF DPRB-RETURN-CODE EQUAL '01'
 12373         MOVE ER-7812                   TO WS-ERROR
 12374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375         GO TO 3025-EDIT-REINSURANCE.
 12376
 12377      IF DPRB-RETURN-CODE EQUAL '02'
 12378         MOVE ER-7813                   TO WS-ERROR
 12379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12380         GO TO 3025-EDIT-REINSURANCE.
 12381
 12382      IF DPRB-RETURN-CODE EQUAL '03'
 12383         MOVE ER-7814                   TO WS-ERROR
 12384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12385         GO TO 3025-EDIT-REINSURANCE.
 12386
 12387      IF DPRB-RETURN-CODE EQUAL '04'
 12388         IF NOT DPRB-1ST-TIME
 12389            MOVE ER-7815                   TO WS-ERROR
 12390            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12391            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 227
* EL050.cbl
 12392          ELSE
 12393         IF PB-VALID-LIFE
 12394            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12395          ELSE
 12396            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12397         END-IF
 12398         MOVE SPACES                TO DOCC-RETURN-CODE
 12399         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12400         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12401         IF DOCC-RETURN-CODE = 'OK'
 12402             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12403             GO TO 3024-CHECK-VALID-RATE
 12404           ELSE
 12405             MOVE ER-7823               TO WS-ERROR
 12406             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12407             GO TO 3025-EDIT-REINSURANCE.
 12408
 12409       MOVE ER-7816                     TO WS-ERROR.
 12410       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12411       GO TO 3025-EDIT-REINSURANCE.
 12412
 12413**********   DMD CUSTOM CODE ABOVE    **********
 12414
 12415 3025-EDIT-REINSURANCE.
 12416     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12417         GO TO 3027-EDIT-CONTINUE.
 12418
 12419     MOVE LOW-VALUES               TO ERREIN-KEY.
 12420     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12421     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12422                                      REIN-CODE-2
 12423                                      REIN-CODE-3.
 12424     MOVE 'A'                      TO REIN-TYPE.
 12425
 12426     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12427
 12428     MOVE '3026' TO REIN-SW.
 12429     MOVE ' '                   TO WS-REIN-READ-SW.
 12430
 12431     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12432     IF REIN-TABLE-NOT-FOUND
 12433         GO TO 3026-NO-SPEC-TABLE.
 12434
 12435     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12436     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12437                                   WS-NSP-ST-CD-LF.
 12438     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12439                                   WS-NSP-ST-CD-AH.
 12440
 12441     GO TO 3040-EDIT-CONTINUE.
 12442
 12443 3026-NO-SPEC-TABLE.
 12444
 12445     MOVE ER-2664                TO WS-ERROR.
 12446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12447     GO TO 3040-EDIT-CONTINUE.
 12448
 12449 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 228
* EL050.cbl
 12450
 12451     IF PB-I-REIN-TABLE = SPACES
 12452       GO TO 3040-EDIT-CONTINUE.
 12453
 12454     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12455          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12456          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12457           GO TO 3040-EDIT-CONTINUE.
 12458
 12459     MOVE LOW-VALUES            TO ERREIN-KEY.
 12460     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12461     MOVE 'A'                   TO REIN-TYPE.
 12462     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12463
 12464     MOVE '3028'                TO REIN-SW.
 12465     MOVE ' '                   TO WS-REIN-READ-SW.
 12466
 12467     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12468     IF REIN-TABLE-NOT-FOUND
 12469         GO TO 3028-NO-REIN-TABLE.
 12470
 12471     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12472     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12473                                   WS-NSP-ST-CD-LF.
 12474     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12475                                   WS-NSP-ST-CD-AH.
 12476
 12477     GO TO 3040-EDIT-CONTINUE.
 12478
 12479 3028-NO-REIN-TABLE.
 12480
 12481     MOVE ER-2615                TO WS-ERROR.
 12482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12483     GO TO 3040-EDIT-CONTINUE.
 12484
 12485 3040-EDIT-CONTINUE.
 12486
 12487     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12488         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12489
 12490     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12491         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12492
 12493     IF (NOT PB-REISSUED-CERT)
 12494        AND (NOT PB-MONTHLY-CERT)
 12495        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12496            MOVE '001'           TO PB-I-LF-TERM
 12497            MOVE 'M'             TO PB-I-INSURED-SEX.
 12498
 12499     IF (NOT PB-REISSUED-CERT)
 12500        AND (NOT PB-MONTHLY-CERT)
 12501        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12502            MOVE '001'           TO PB-I-AH-TERM
 12503            MOVE 'M'             TO PB-I-INSURED-SEX.
 12504
 12505 3040-EDIT-1ST-PMT-DT.
 12506     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12507     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 229
* EL050.cbl
 12508         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12509
 12510******************************************************************
 12511*                                                                *
 12512*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12513*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12514*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12515*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12516*                                                                *
 12517******************************************************************
 12518
 12519     IF PB-EFF-DT-PROCESSING
 12520        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12521                                    PB-I-LF-EXPIRE-DT
 12522                                    PB-I-AH-EXPIRE-DT
 12523        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12524        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12525        MOVE ZERO                TO DC-ELAPSED-DAYS
 12526        MOVE +1                  TO DC-ELAPSED-MONTHS
 12527        SET BIN-PLUS-ELAPSED     TO TRUE
 12528*       MOVE 6                   TO DC-OPTION-CODE
 12529        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12530        IF NO-CONVERSION-ERROR
 12531           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12532
 12533******************************************************************
 12534*                                                                *
 12535*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12536*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12537*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12538*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12539*                                                                *
 12540******************************************************************
 12541
 12542     IF PB-EXT-DAYS-PROCESSING
 12543          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12544                                         PB-I-LF-EXPIRE-DT
 12545                                         PB-I-AH-EXPIRE-DT
 12546          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12547          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12548          MOVE +1                     TO DC-ELAPSED-MONTHS
 12549          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12550          SET BIN-PLUS-ELAPSED        TO TRUE
 12551*         MOVE 6                      TO DC-OPTION-CODE
 12552          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12553          IF NO-CONVERSION-ERROR
 12554             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12555
 12556******************************************************************
 12557*                                                                *
 12558*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12559*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12560*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12561*        (EXPIRE DATE - (TERM -1))  *  -1.
 12562*                                                                *
 12563******************************************************************
 12564
 12565     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 230
* EL050.cbl
 12566        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12567           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12568              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12569              MOVE PB-I-AH-TERM      TO WS-TERM
 12570           ELSE
 12571              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12572              MOVE PB-I-LF-TERM      TO WS-TERM
 12573        ELSE
 12574           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12575              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12576              MOVE PB-I-LF-TERM      TO WS-TERM
 12577           ELSE
 12578              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12579              MOVE PB-I-AH-TERM      TO WS-TERM.
 12580
 12581     IF PB-EXPIRE-DT-PROCESSING
 12582        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12583        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12584        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12585        MOVE ZERO                TO DC-ELAPSED-DAYS
 12586                                    DC-ODD-DAYS-OVER
 12587          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12588          SET BIN-PLUS-ELAPSED    TO TRUE
 12589*         MOVE 6                  TO DC-OPTION-CODE
 12590          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12591          IF NO-CONVERSION-ERROR
 12592             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12593
 12594******************************************************************
 12595*                                                                *
 12596*            1ST PAYMENT DATE PROCESSING                         *
 12597*                                                                *
 12598******************************************************************
 12599
 12600     IF PB-1ST-PMT-DT-PROCESSING
 12601        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12602                                    PB-I-AH-EXPIRE-DT
 12603        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12604
 12605     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12606         NEXT SENTENCE
 12607     ELSE
 12608         MOVE ER-2680                 TO WS-ERROR
 12609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12610         GO TO 3060-ORIG-TERM-CHECK.
 12611
 12612     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12613     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12614     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12615*    MOVE 1                      TO DC-OPTION-CODE.
 12616     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12617                                    DC-ELAPSED-DAYS
 12618                                    DC-ODD-DAYS-OVER.
 12619
 12620     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12621
 12622     IF DATE-CONVERSION-ERROR
 12623        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 231
* EL050.cbl
 12624
 12625     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12626     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12627        AND (WS-LF-COVERAGE-TYPE = 'L')
 12628        IF (DC-ELAPSED-MONTHS > 1)
 12629                      OR
 12630           ((DC-ELAPSED-MONTHS = 1)
 12631           AND (DC-ODD-DAYS-OVER > 0))
 12632           MOVE ER-2882          TO WS-ERROR
 12633           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12634        END-IF
 12635     END-IF
 12636     if dc-elapsed-months > 0
 12637        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12638        + dc-odd-days-over
 12639     end-if
 12640     IF PB-EXT-DAYS-PROCESSING
 12641        CONTINUE
 12642     ELSE
 12643        IF DC-ELAPSED-MONTHS = +0
 12644           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12645        ELSE
 12646           IF (WS-LF-EARNINGS-CALC = '4')
 12647              AND (DC-ELAPSED-MONTHS > ZERO)
 12648              AND (DC-ELAPSED-DAYS > ZERO)
 12649              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12650           ELSE
 12651              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12652                                 THRU 6499-EXIT
 12653              MOVE WS-ODD-DAYS-OVER
 12654                                 TO PB-I-EXTENTION-DAYS
 12655           END-IF
 12656        END-IF
 12657     END-IF
 12658******************************************************************
 12659*                                                                *
 12660*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12661*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12662*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12663*            AND ANY ODD DAYS.                                   *
 12664*                                                                *
 12665******************************************************************
 12666
 12667     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12668                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12669     IF WS-LF-EARNINGS-CALC NOT = '4'
 12670        IF DC-ELAPSED-DAYS > ZEROS
 12671           MOVE ER-2681          TO WS-ERROR
 12672           PERFORM 9900-ERROR-FORMAT
 12673                                 THRU 9900-EXIT
 12674        END-IF
 12675     END-IF
 12676
 12677     IF WS-LF-EARNINGS-CALC NOT = '4'
 12678        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12679           MOVE ER-2681          TO WS-ERROR
 12680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12681
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 232
* EL050.cbl
 12682     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12683        (PB-I-LF-TERM NOT = ZERO) AND
 12684         NOT NO-LIFE-COVERAGE
 12685          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12686          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12687          IF WS-LF-EARNINGS-CALC = '4'
 12688             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12689             PB-I-PAY-FREQUENCY
 12690          END-IF
 12691          MOVE ZERO              TO DC-ELAPSED-DAYS
 12692                                    DC-ODD-DAYS-OVER
 12693          MOVE 1                 TO DC-END-OF-MONTH
 12694          SET BIN-PLUS-ELAPSED        TO TRUE
 12695*         MOVE 6                 TO DC-OPTION-CODE
 12696          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12697          IF NO-CONVERSION-ERROR
 12698             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12699             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12700                (WS-LF-SPECIAL-CALC-CD = 'L')
 12701                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12702                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12703                  MOVE +1             TO DC-ELAPSED-MONTHS
 12704                  SET BIN-PLUS-ELAPSED  TO TRUE
 12705*                 MOVE 6              TO DC-OPTION-CODE
 12706                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12707                  IF NO-CONVERSION-ERROR
 12708                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12709
 12710* okay, i had to move the new att age edit down here because the
 12711* expiration date could get recalculated and i need the exp date
 12712     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12713        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12714        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12715        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12716           AND ZEROS
 12717           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12718           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12719           SET ELAPSED-BETWEEN-BIN TO TRUE
 12720           PERFORM 8500-DATE-CONVERT
 12721                                 THRU 8500-EXIT
 12722           IF NO-CONVERSION-ERROR
 12723              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12724                 MOVE ER-2669       TO WS-ERROR
 12725*                PERFORM 9900-ERROR-FORMAT
 12726*                                THRU 9900-EXIT
 12727              END-IF
 12728           END-IF
 12729        ELSE
 12730           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12731           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12732              MOVE ER-2669       TO WS-ERROR
 12733*             PERFORM 9900-ERROR-FORMAT
 12734*                                THRU 9900-EXIT
 12735           ELSE
 12736              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12737                 MOVE ER-1570    TO WS-ERROR
 12738                 PERFORM 9900-ERROR-FORMAT
 12739                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 233
* EL050.cbl
 12740              END-IF
 12741           END-IF
 12742        END-IF
 12743        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12744           AND ZEROS
 12745           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12746           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12747           SET ELAPSED-BETWEEN-BIN TO TRUE
 12748           PERFORM 8500-DATE-CONVERT
 12749                                 THRU 8500-EXIT
 12750           IF NO-CONVERSION-ERROR
 12751              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12752                 MOVE ER-2669       TO WS-ERROR
 12753*                PERFORM 9900-ERROR-FORMAT
 12754*                                THRU 9900-EXIT
 12755              END-IF
 12756           END-IF
 12757        ELSE
 12758           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12759             (PB-I-LF-TERM / 12)
 12760           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12761              MOVE ER-2669       TO WS-ERROR
 12762*             PERFORM 9900-ERROR-FORMAT
 12763*                                THRU 9900-EXIT
 12764           ELSE
 12765              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12766                 MOVE ER-1571    TO WS-ERROR
 12767                 PERFORM 9900-ERROR-FORMAT
 12768                                 THRU 9900-EXIT
 12769              END-IF
 12770           END-IF
 12771        END-IF
 12772        IF WS-ERROR = ER-2669
 12773           PERFORM 9900-ERROR-FORMAT
 12774                                 THRU 9900-EXIT
 12775        END-IF
 12776     END-IF
 12777     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12778        (PB-I-AH-TERM NOT = ZERO) AND
 12779         NOT NO-AH-COVERAGE
 12780          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12781             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12782             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12783             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12784          ELSE
 12785             IF WS-LF-EARNINGS-CALC = '4'
 12786                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12787                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12788                PB-I-PAY-FREQUENCY
 12789             ELSE
 12790                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12791                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12792             END-IF
 12793          END-IF
 12794          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12795                                         DC-ODD-DAYS-OVER
 12796          MOVE 1                      TO DC-END-OF-MONTH
 12797          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 234
* EL050.cbl
 12798*         MOVE 6                      TO DC-OPTION-CODE
 12799          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12800          IF NO-CONVERSION-ERROR
 12801             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12802     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12803        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12804        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12805        IF PB-I-BIRTHDAY > LOW-VALUES
 12806           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12807           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12808           SET ELAPSED-BETWEEN-BIN TO TRUE
 12809           PERFORM 8500-DATE-CONVERT
 12810                                 THRU 8500-EXIT
 12811           IF NO-CONVERSION-ERROR
 12812              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12813                 MOVE ER-3054       TO WS-ERROR
 12814*                PERFORM 9900-ERROR-FORMAT
 12815*                                THRU 9900-EXIT
 12816              END-IF
 12817           END-IF
 12818        ELSE
 12819           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12820           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12821              MOVE ER-3054       TO WS-ERROR
 12822*             PERFORM 9900-ERROR-FORMAT
 12823*                                THRU 9900-EXIT
 12824           END-IF
 12825        END-IF
 12826        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12827           AND ZEROS
 12828           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12829           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12830           SET ELAPSED-BETWEEN-BIN TO TRUE
 12831           PERFORM 8500-DATE-CONVERT
 12832                                 THRU 8500-EXIT
 12833           IF NO-CONVERSION-ERROR
 12834              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12835                 MOVE ER-3054       TO WS-ERROR
 12836*                PERFORM 9900-ERROR-FORMAT
 12837*                                THRU 9900-EXIT
 12838              END-IF
 12839           END-IF
 12840        ELSE
 12841           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12842             (PB-I-AH-TERM / 12)
 12843           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12844              MOVE ER-3054       TO WS-ERROR
 12845*             PERFORM 9900-ERROR-FORMAT
 12846*                                THRU 9900-EXIT
 12847           END-IF
 12848        END-IF
 12849        IF WS-ERROR = ER-3054
 12850           PERFORM 9900-ERROR-FORMAT
 12851                                 THRU 9900-EXIT
 12852        END-IF
 12853     END-IF
 12854     MOVE SPACE                       TO DC-END-OF-MONTH.
 12855
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 235
* EL050.cbl
 12856     IF PB-COMPANY-ID = 'NCB'
 12857        GO TO 3040-EDIT-EXTENSION-DAYS.
 12858
 12859     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12860       AND
 12861        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12862        NEXT SENTENCE
 12863     ELSE
 12864        GO TO 3040-EDIT-EXTENSION-DAYS.
 12865
 12866     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12867        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12868        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12869     ELSE
 12870        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12871        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12872
 12873     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12874*    MOVE '1'      TO DC-OPTION-CODE
 12875     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12876     IF (NO-CONVERSION-ERROR)
 12877        AND (DC-ELAPSED-MONTHS > +1)
 12878        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12879        MOVE ER-2668   TO WS-ERROR
 12880        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12881
 12882 3040-EDIT-EXTENSION-DAYS.
 12883
 12884     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12885        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12886         GO TO 3050-EDIT-TERM-IN-DAYS
 12887     ELSE
 12888         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12889
 12890     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12891         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12892     ELSE
 12893        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12894           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12895           MOVE ER-2681         TO WS-ERROR
 12896           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12897
 12898     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12899        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12900        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12901         GO TO 3060-ORIG-TERM-CHECK.
 12902
 12903     GO TO 3060-ORIG-TERM-CHECK.
 12904
 12905 3050-EDIT-TERM-IN-DAYS.
 12906
 12907     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12908
 12909     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12910         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12911     ELSE
 12912         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12913            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 236
* EL050.cbl
 12914            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12915
 12916     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12917                                       REMAINDER WS-WORK-TERM.
 12918     IF WS-WORK-TERM GREATER THAN ZERO
 12919         ADD +1 TO PB-I-LF-TERM.
 12920
 12921     IF NOT NO-AH-COVERAGE
 12922         MOVE ER-2684            TO WS-ERROR
 12923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12924
 12925
 12926 3060-ORIG-TERM-CHECK.
 12927
 12928******************************************************************
 12929*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12930******************************************************************
 12931
 12932     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12933        NEXT SENTENCE
 12934     ELSE
 12935        IF NOT NO-LIFE-COVERAGE
 12936           IF PB-I-LF-TERM NUMERIC
 12937              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12938              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12939              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12940                  NEXT SENTENCE
 12941           ELSE
 12942              MOVE ER-2647       TO WS-ERROR
 12943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12944
 12945     IF NOT NO-AH-COVERAGE
 12946         IF PB-I-AH-TERM NUMERIC
 12947            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12948            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12949            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12950             NEXT SENTENCE
 12951          ELSE
 12952              MOVE ER-2658       TO WS-ERROR
 12953              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955     IF PB-COMPANY-ID = 'NCB'
 12956        GO TO 3070-LOAN-TERM-CHECK.
 12957
 12958     IF POLICY-HAS-AH
 12959       AND
 12960        POLICY-HAS-LIFE
 12961       AND
 12962        PB-I-LF-TERM NUMERIC
 12963       AND
 12964        PB-I-AH-TERM NUMERIC
 12965        NEXT SENTENCE
 12966     ELSE
 12967        GO TO 3070-LOAN-TERM-CHECK.
 12968
 12969     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12970     IF WS-TEX-FACT-2 LESS THAN +0
 12971        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 237
* EL050.cbl
 12972
 12973     IF WS-TEX-FACT-2 GREATER THAN +1
 12974        MOVE ER-2668             TO WS-ERROR
 12975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12976
 12977 3070-LOAN-TERM-CHECK.
 12978
 12979     IF (WS-LF-BENEFIT-CD = ZERO)
 12980         OR (NO-LF-BENEFIT-MATCH)
 12981            GO TO 3125-EDIT-PMT-FREQ.
 12982*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12983*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12984*          AND 'V' AND 'W' AND 'X'
 12985*          GO TO 3125-EDIT-PMT-FREQ
 12986*       END-IF
 12987*    ELSE
 12988*       IF WS-AH-DCC-TRUNC = 'T'
 12989*          CONTINUE
 12990*       ELSE
 12991*          GO TO 3125-EDIT-PMT-FREQ
 12992*       END-IF
 12993*    END-IF
 12994     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12995                    OR
 12996        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12997        AND (WS-AH-DCC-TRUNC = 'T'))
 12998        CONTINUE
 12999     ELSE
 13000        GO TO 3125-EDIT-PMT-FREQ
 13001     END-IF
 13002     IF PB-I-LOAN-TERM NOT NUMERIC
 13003         MOVE ZEROS              TO PB-I-LOAN-TERM.
 13004
 13005     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 13006        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 13007*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 13008        PB-I-LOAN-TERM NOT GREATER THAN +360
 13009         NEXT SENTENCE
 13010     ELSE
 13011         MOVE ER-2648            TO WS-ERROR
 13012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13013
 13014     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13015        MOVE ER-3058             TO WS-ERROR
 13016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13017     end-if
 13018
 13019     IF WS-STATE-ABBREVIATION = 'NC'
 13020        IF PB-I-LOAN-TERM > +59
 13021           CONTINUE
 13022        ELSE
 13023           MOVE ER-2792          TO WS-ERROR
 13024           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13025        END-IF
 13026     END-IF
 13027
 13028     .
 13029 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 238
* EL050.cbl
 13030     IF (WS-LF-BENEFIT-CD = ZERO)
 13031         OR (NO-LF-BENEFIT-MATCH)
 13032         or (pb-state = 'AL')
 13033            GO TO 3127-EDIT-LOAN-OFFICER.
 13034     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13035                    OR
 13036        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13037        AND (WS-AH-DCC-TRUNC = 'T'))
 13038                    OR
 13039         (PB-COMPANY-ID = 'AHL')
 13040        CONTINUE
 13041     ELSE
 13042        IF (PB-I-LOAN-TERM > ZEROS)
 13043           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13044           MOVE ER-1575          TO WS-ERROR
 13045           PERFORM 9900-ERROR-FORMAT
 13046                                 THRU 9900-EXIT
 13047        END-IF
 13048     END-IF
 13049     IF WS-LF-EARNINGS-CALC NOT = '4'
 13050         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13051            MOVE ER-2653         TO WS-ERROR
 13052            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13053            GO TO 3127-EDIT-LOAN-OFFICER
 13054         ELSE
 13055            GO TO 3127-EDIT-LOAN-OFFICER.
 13056
 13057     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13058         MOVE ER-2655            TO WS-ERROR
 13059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13060         GO TO 3127-EDIT-LOAN-OFFICER.
 13061
 13062     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13063         MOVE ER-2654            TO WS-ERROR
 13064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13065         GO TO 3127-EDIT-LOAN-OFFICER.
 13066
 13067     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13068         GIVING WS-TEX-FACT-2
 13069             REMAINDER WS-TEX-FACT-3.
 13070
 13071*    IF WS-TEX-FACT-3 NOT = ZERO
 13072*       MOVE ER-2654             TO WS-ERROR
 13073*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13074
 13075
 13076 3127-EDIT-LOAN-OFFICER.
 13077
 13078     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13079        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13080           MOVE ER-2690          TO WS-ERROR
 13081           PERFORM 9900-ERROR-FORMAT
 13082                                 THRU 9900-EXIT
 13083        ELSE
 13084           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13085           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13086           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13087           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 239
* EL050.cbl
 13088           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13089           MOVE PB-I-LOAN-OFFICER
 13090                                 TO LOFC-CODE
 13091           PERFORM 8586-READ-LOAN-OFFICER
 13092                                 THRU 8586-EXIT
 13093           IF (NOT LOFC-MASTER-FOUND)
 13094              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13095              MOVE ER-3006       TO WS-ERROR
 13096              PERFORM 9900-ERROR-FORMAT
 13097                                 THRU 9900-EXIT
 13098           END-IF
 13099        END-IF
 13100     END-IF
 13101     .
 13102 3129-EDIT-APR.
 13103
 13104     IF (WS-LF-BENEFIT-CD = ZERO)
 13105        OR (NO-LF-BENEFIT-MATCH)
 13106        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13107           GO TO 3130-EDIT-AGE
 13108*       ELSE
 13109*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13110*             GO TO 3130-EDIT-AGE
 13111*          END-IF
 13112        END-IF
 13113     END-IF
 13114
 13115     IF (WS-STATE-ABBREVIATION = 'OH')
 13116         AND (PB-I-RATE-CLASS NOT = 'L ')
 13117         AND (PB-I-LF-TERM GREATER THAN 60)
 13118         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13119         GO TO 3129-APR-CONT.
 13120
 13121     IF (WS-STATE-ABBREVIATION = 'RI')
 13122         AND (PB-I-LF-TERM GREATER THAN 60)
 13123         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13124         GO TO 3129-APR-CONT.
 13125
 13126     IF (WS-STATE-ABBREVIATION = 'UT')
 13127         AND (PB-I-LF-TERM GREATER THAN 62)
 13128         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13129         AND (PB-CERT-EFF-DT LESS WS-830901)
 13130         GO TO 3129-APR-CONT.
 13131
 13132     IF PB-COMPANY-ID = 'LAP'
 13133        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13134           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13135              MOVE ER-2656         TO WS-ERROR
 13136              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13137              GO TO 3130-EDIT-AGE.
 13138
 13139     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13140        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13141        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13142        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13143        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13144        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13145         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 240
* EL050.cbl
 13146
 13147 3129-APR-CONT.
 13148     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13149         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13150         GO TO 3130-EDIT-AGE.
 13151
 13152     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13153         WS-AH-BENEFIT-CD (1:1) = 'S')
 13154        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13155        AND (PB-I-LOAN-APR = ZERO)
 13156        MOVE ER-2657             TO WS-ERROR
 13157        PERFORM 9900-ERROR-FORMAT
 13158                                 THRU 9900-EXIT
 13159        GO TO 3130-EDIT-AGE
 13160     END-IF
 13161*    IF PB-I-LOAN-APR = ZERO
 13162*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13163*    END-IF
 13164
 13165     if pb-i-loan-apr = +99.9999
 13166        move er-2656             to ws-error
 13167        PERFORM 9900-ERROR-FORMAT
 13168                                 THRU 9900-EXIT
 13169        GO TO 3130-EDIT-AGE
 13170     end-if
 13171*    IF PB-I-LOAN-APR = ZERO
 13172*       MOVE ER-2656             TO WS-ERROR
 13173*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174*       GO TO 3130-EDIT-AGE.
 13175
 13176*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13177     if pb-i-loan-apr not = +99.9999
 13178        IF PB-I-LOAN-APR > +30.000
 13179           MOVE ER-2657          TO WS-ERROR
 13180           PERFORM 9900-ERROR-FORMAT
 13181                                 THRU 9900-EXIT
 13182        end-if
 13183     end-if
 13184     .
 13185 3130-EDIT-AGE.
 13186
 13187******************************************************************
 13188*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13189******************************************************************
 13190
 13191     IF NOT NO-LIFE-COVERAGE
 13192        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13193           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13194               MOVE ER-2628             TO WS-ERROR
 13195               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13196
 13197     IF NOT NO-AH-COVERAGE
 13198        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13199           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13200               MOVE ER-2628         TO WS-ERROR
 13201               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13202
 13203 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 241
* EL050.cbl
 13204     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13205         IF WS-DEFAULT-SEX = 'M'
 13206             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13207          ELSE
 13208             IF WS-DEFAULT-SEX = 'F'
 13209             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13210
 13211     IF PB-I-INSURED-SEX = '1'
 13212         MOVE 'M' TO PB-I-INSURED-SEX.
 13213
 13214     IF PB-I-INSURED-SEX = '2'
 13215         MOVE 'F' TO PB-I-INSURED-SEX.
 13216
 13217 3134-SIG-SW-EDIT.
 13218     IF PB-I-SIG-SW = SPACE
 13219         MOVE 'N'                TO  PB-I-SIG-SW.
 13220
 13221     IF PB-COMPANY-ID = 'NCL'
 13222         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13223             NEXT SENTENCE
 13224         ELSE
 13225             MOVE ER-1923        TO  WS-ERROR
 13226             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13227     ELSE
 13228     IF PB-COMPANY-ID = 'CRI'
 13229         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13230             NEXT SENTENCE
 13231         ELSE
 13232             MOVE ER-2606        TO  WS-ERROR
 13233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13234     ELSE
 13235     IF PB-COMPANY-ID = 'TMS'
 13236         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13237             NEXT SENTENCE
 13238         ELSE
 13239             MOVE ER-2689        TO  WS-ERROR
 13240             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13241     ELSE
 13242         IF PB-I-SIG-SW = 'Y' OR 'N'
 13243             NEXT SENTENCE
 13244         ELSE
 13245             MOVE ER-2651        TO  WS-ERROR
 13246             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13247
 13248     IF PB-COMPANY-ID = 'FLA'
 13249         IF (WS-EDIT-AGE GREATER 54  OR
 13250             WS-AH-EDIT-AGE GREATER 54)  AND
 13251            PB-I-SIG-SW = 'N'
 13252            MOVE ER-2651         TO  WS-ERROR
 13253            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13254
 13255 3135-NAME-EDIT.
 13256
 13257     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13258        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13259        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13260           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13261                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 242
* EL050.cbl
 13262        END-PERFORM
 13263     END-IF
 13264     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13265        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13266        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13267           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13268                                 TO PB-I-JOINT-LAST-NAME
 13269        END-PERFORM
 13270     END-IF
 13271     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13272        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13273        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13274           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13275                                 TO PB-I-INSURED-FIRST-NAME
 13276        END-PERFORM
 13277     END-IF
 13278     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13279        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13280        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13281           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13282                                 TO PB-I-INSURED-LAST-NAME
 13283        END-PERFORM
 13284     END-IF
 13285     if PB-I-JOINT-COVERAGE *> and
 13286*       pb-i-insured-last-name <> spaces
 13287        if pb-i-insured-last-name = pb-i-joint-last-name and
 13288           pb-i-insured-first-name = pb-i-joint-first-name and
 13289           pb-i-birthday = pb-i-joint-birthday
 13290           move er-3069          to ws-error
 13291           perform 9900-error-format
 13292                                 thru 9900-exit
 13293        end-if
 13294     end-if
 13295     IF PB-I-INSURED-LAST-NAME = SPACES
 13296       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13297       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13298           MOVE ER-2660    TO WS-ERROR
 13299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13300
 13301 3136-EDIT-SEX.
 13302
 13303******************************************************************
 13304*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13305******************************************************************
 13306
 13307     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13308        (WS-AH-SPECIAL-CALC-CD = 'O')
 13309        NEXT SENTENCE
 13310     ELSE
 13311        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13312           NEXT SENTENCE
 13313        ELSE
 13314           MOVE ER-2629            TO WS-ERROR
 13315           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13316
 13317 3137-EDIT-EFF-DATE.
 13318
 13319     IF PB-REISSUED-CERT       OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 243
* EL050.cbl
 13320        PB-POLICY-IS-DECLINED  OR
 13321        PB-POLICY-IS-VOIDED
 13322         GO TO 3139-EDIT-COVERAGE-CODES.
 13323
 13324     MOVE SPACE                  TO WS-2671-SW
 13325                                    WS-2672-SW.
 13326
 13327     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13328         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13329             MOVE ER-2703        TO WS-ERROR
 13330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331             GO TO 3139-EDIT-COVERAGE-CODES.
 13332
 13333     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13334         GO TO 3139-EDIT-COVERAGE-CODES.
 13335
 13336     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13337     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13338*    MOVE '1'                    TO DC-OPTION-CODE.
 13339     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13340     MOVE +0                     TO DC-ELAPSED-MONTHS
 13341                                    DC-ELAPSED-DAYS.
 13342     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13343
 13344     IF DATE-CONVERSION-ERROR
 13345         GO TO 3139-EDIT-COVERAGE-CODES.
 13346
 13347     IF DC-ELAPSED-DAYS GREATER +180
 13348         MOVE ER-2672            TO WS-ERROR
 13349         MOVE 'Y'                TO WS-2672-SW
 13350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13351     END-IF
 13352
 13353     IF WS-ERROR = ER-2671  AND
 13354        PB-COMPANY-ID  = 'LBL'
 13355        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13356        MOVE SPACE               TO WS-2671-SW
 13357        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13358
 13359     IF PB-ISSUE-DATE-FORCED  AND
 13360      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13361         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13362         MOVE ER-2673            TO WS-ERROR
 13363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13364         MOVE SPACE              TO WS-2671-SW
 13365                                    WS-2672-SW.
 13366
 13367     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13368         IF PB-ISSUE-DATE-FORCED
 13369             MOVE ER-2600          TO  WS-ERROR
 13370             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13371         ELSE
 13372             MOVE ER-2692          TO  WS-ERROR
 13373             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13374
 13375
 13376 3139-EDIT-COVERAGE-CODES.
 13377
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 244
* EL050.cbl
 13378     if pb-company-id not = 'AHL'
 13379        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13380           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13381           MOVE ER-2787          TO WS-ERROR
 13382           PERFORM 9900-ERROR-FORMAT
 13383                                 THRU 9900-EXIT
 13384        END-IF
 13385     end-if
 13386     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13387        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13388                                 > 250000.00
 13389           MOVE ER-2719          TO WS-ERROR
 13390           PERFORM 9900-ERROR-FORMAT
 13391                                 THRU 9900-EXIT
 13392        END-IF
 13393     END-IF
 13394
 13395     IF PB-POLICY-IS-DECLINED  OR
 13396        PB-POLICY-IS-VOIDED
 13397         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13398
 13399     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13400        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13401         MOVE ER-2630                TO WS-ERROR
 13402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13403
 13404     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13405        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13406        PB-I-LF-PREMIUM-AMT = ZERO
 13407         GO TO 3140-CHECK-AH-FOR-ZERO.
 13408
 13409     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13410        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13411        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13412         GO TO 3140-CHECK-AH-FOR-ZERO.
 13413
 13414     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13415        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13416        MOVE ER-2631             TO WS-ERROR
 13417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13418     END-IF
 13419
 13420
 13421******************************************************************
 13422*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13423******************************************************************
 13424
 13425     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13426        NEXT SENTENCE
 13427     ELSE
 13428        IF PB-I-LF-BENEFIT-AMT = ZERO
 13429           MOVE ER-2632             TO WS-ERROR
 13430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13431
 13432
 13433******************************************************************
 13434*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13435******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 245
* EL050.cbl
 13436
 13437     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13438        CONTINUE
 13439     ELSE
 13440        IF PB-I-LF-PREMIUM-AMT = ZERO
 13441           IF (NOT PB-COMP-LF-PREM)
 13442              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13443              and (ws-lf-ben-category not = 'C')
 13444              MOVE ER-2633       TO WS-ERROR
 13445              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13446           END-IF
 13447        END-IF
 13448     END-IF
 13449     .
 13450 3140-CHECK-AH-FOR-ZERO.
 13451
 13452     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13453        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13454        PB-I-AH-PREMIUM-AMT = ZERO
 13455         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13456
 13457     IF PB-COMPANY-ID = 'CSL'  AND
 13458        PB-I-AH-BENEFIT-CD = ZERO  AND
 13459        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13460        PB-I-AH-PREMIUM-AMT = ZERO
 13461         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13462
 13463     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13464        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13465        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13466         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13467
 13468     IF PB-I-AH-BENEFIT-CD = ZERO
 13469         MOVE ER-2634            TO WS-ERROR
 13470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13471
 13472******************************************************************
 13473*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13474******************************************************************
 13475
 13476     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13477        NEXT SENTENCE
 13478     ELSE
 13479        IF PB-I-AH-BENEFIT-AMT = ZERO
 13480           MOVE ER-2635             TO WS-ERROR
 13481           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13482
 13483******************************************************************
 13484*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13485******************************************************************
 13486
 13487     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13488        NEXT SENTENCE
 13489     ELSE
 13490        IF PB-I-AH-PREMIUM-AMT = ZERO
 13491            IF NOT PB-COMP-AH-PREM
 13492                MOVE ER-2636    TO WS-ERROR
 13493                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 246
* EL050.cbl
 13494
 13495
 13496 3140-EDIT-MAX-AMT-SIZES.
 13497* CUSTOM CODE FOR CLIENT    'DMD'
 13498     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13499                                     WS-RES-MUNI-TAX
 13500                                     PB-I-STATE-TAX
 13501                                     PB-I-MUNI-TAX.
 13502
 13503     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13504
 13505     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13506        GO TO 3150-RATE-OUTSTAND-BAL.
 13507
 13508     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13509        GO TO 3150-RATE-OUTSTAND-BAL.
 13510
 13511     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13512        GO TO 3150-RATE-OUTSTAND-BAL.
 13513
 13514     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13515                             OR 'RIC')
 13516        GO TO 3150-RATE-OUTSTAND-BAL.
 13517
 13518     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13519        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13520            GO TO 3150-RATE-OUTSTAND-BAL
 13521        ELSE
 13522           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13523               GO TO 3150-RATE-OUTSTAND-BAL.
 13524
 13525     IF NOT PB-NO-MONTHS-SKIPPED
 13526        GO TO 3150-RATE-OUTSTAND-BAL.
 13527
 13528     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13529        GO TO 3150-RATE-OUTSTAND-BAL.
 13530
 13531     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13532        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13533           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13534             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13535           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13536           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13537              MOVE ER-2693     TO WS-ERROR
 13538              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13539              GO TO 3150-RATE-OUTSTAND-BAL
 13540           ELSE
 13541              GO TO 3150-RATE-OUTSTAND-BAL.
 13542
 13543 3150-RATE-OUTSTAND-BAL.
 13544
 13545* DMD RATING TEST
 13546     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13547         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13548         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13549         MOVE ER-2687                 TO WS-ERROR
 13550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13551         MOVE 'B'                     TO PB-I-OB-FLAG
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 247
* EL050.cbl
 13552         GO TO 3260-EDIT-CONTINUE.
 13553
 13554     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13555         IF  WS-ERROR    EQUAL    ER-2693
 13556             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13557                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13558                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13559                 MOVE  +0            TO  WS-ERROR.
 13560
 13561     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13562         IF  WS-ERROR    EQUAL    ER-2693
 13563             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13564                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13565                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13566                 MOVE  +0            TO  WS-ERROR.
 13567
 13568     IF PLAN-MASTER-AH-SW = 'Y'
 13569        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13570            IF  WS-ERROR    EQUAL    ER-2693
 13571              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13572                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13573                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13574                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13575                 MOVE  ER-1910           TO  WS-ERROR
 13576                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13577
 13578     IF PLAN-MASTER-AH-SW = 'Y'
 13579        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13580            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13581               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13582               MOVE  ER-1910           TO  WS-ERROR
 13583               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13584
 13585     IF PLAN-MASTER-AH-SW = 'Y'
 13586        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13587            IF  WS-ERROR    EQUAL    ER-2693
 13588                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13589                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13590                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13591                 MOVE  +0       TO  WS-ERROR.
 13592
 13593     IF WS-ERROR = ER-2693
 13594        IF PB-COMPANY-ID = 'JAL' AND
 13595           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13596           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13597           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13598
 13599     IF WS-ERROR = ER-2693
 13600        IF PB-COMPANY-ID = 'NCL'  AND
 13601           PB-I-AH-BENEFIT-CD = 'OA'
 13602           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13603           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13604
 13605     IF WS-ERROR = ER-2693
 13606        IF PB-COMPANY-ID = 'CNL' AND
 13607           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13608           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13609           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 248
* EL050.cbl
 13610
 13611     IF WS-ERROR = ER-2693
 13612        IF PB-COMPANY-ID = 'HER'
 13613           IF WS-LEVEL
 13614              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13615              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13616
 13617     IF ((LF-BENEFIT-FOUND) AND
 13618         (NOT NO-LIFE-COVERAGE)  AND
 13619         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13620       OR   ((AH-BENEFIT-FOUND) AND
 13621             (NOT NO-AH-COVERAGE)    AND
 13622             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13623         NEXT SENTENCE
 13624     ELSE
 13625         GO TO 3215-EDIT-RATES.
 13626
 13627     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13628        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13629           MOVE ER-2674          TO WS-ERROR
 13630           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13631           GO TO 3215-EDIT-RATES.
 13632
 13633     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13634        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13635           MOVE ER-2674          TO WS-ERROR
 13636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13637           GO TO 3215-EDIT-RATES.
 13638
 13639     MOVE 'B'                    TO PB-I-OB-FLAG.
 13640
 13641     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13642         NEXT SENTENCE
 13643     ELSE
 13644         IF NOT NO-LIFE-COVERAGE
 13645             IF WS-ACCT-LF-OB-RT = ZERO
 13646                MOVE ER-2641    TO WS-ERROR
 13647                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13648
 13649     IF PB-COMPANY-ID = 'CRI'
 13650       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13651         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13652         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13653         IF WS-ERROR = ER-2675
 13654            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13655            MOVE ER-2687              TO WS-ERROR
 13656            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13657         ELSE
 13658            MOVE ER-2687              TO WS-ERROR
 13659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13660
 13661
 13662     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13663         NEXT SENTENCE
 13664     ELSE
 13665       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13666            NEXT SENTENCE
 13667       ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 249
* EL050.cbl
 13668         IF NOT NO-AH-COVERAGE
 13669             IF WS-ACCT-AH-OB-RT = ZERO
 13670                MOVE ER-2642    TO WS-ERROR
 13671                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13672
 13673     IF PB-COMPANY-ID = 'CRI'
 13674       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13675         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13676         IF WS-ERROR = ER-2676
 13677            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13678            MOVE ER-2687              TO WS-ERROR
 13679            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13680         ELSE
 13681            MOVE ER-2687              TO WS-ERROR
 13682            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13683
 13684     IF PB-COMPANY-ID NOT = 'GIC'
 13685         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13686            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13687     ELSE
 13688         IF PB-I-LF-PREM-CALC = ZEROS
 13689             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13690                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13691
 13692     IF PB-COMPANY-ID NOT = 'GIC'
 13693         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13694            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13695     ELSE
 13696         IF PB-I-AH-PREM-CALC = ZEROS
 13697             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13698                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13699
 13700     MOVE ZEROS TO PB-I-MORT-CODE.
 13701
 13702     GO TO 3260-EDIT-CONTINUE.
 13703
 13704
 13705 3215-EDIT-RATES.
 13706     IF ACCOUNT-MAST-FOUND
 13707         NEXT SENTENCE
 13708     ELSE
 13709         GO TO 3999-END-EDIT.
 13710
 13711 3220-CHECK-LF-RATES.
 13712
 13713     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13714        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13715        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13716        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13717           AND (NOT WS-LF-CASH))
 13718                           OR
 13719           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13720           AND (NOT WS-AH-CASH)))
 13721                       AND
 13722           (PB-I-ENTRY-STATUS NOT = '5')
 13723           MOVE 'M'              TO PB-BATCH-ENTRY
 13724                                    PB-I-ENTRY-STATUS
 13725        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 250
* EL050.cbl
 13726     END-IF
 13727     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13728                                    PB-I-AH-PREM-CALC
 13729                                    PB-I-LF-ALT-PREM-CALC
 13730                                    PB-I-LF-ALT-RATE
 13731                                    PB-I-LF-REI-RATE
 13732                                    PB-I-LF-ALT-REI-RATE
 13733                                    PB-I-AH-REI-RATE
 13734                                    PB-I-TOT-FEES-CALC.
 13735
 13736     IF PB-COMPANY-ID EQUAL 'DMD'
 13737        NEXT SENTENCE
 13738     ELSE
 13739        MOVE ZEROS               TO PB-I-LF-RATE
 13740                                    PB-I-AH-RATE.
 13741
 13742     IF PB-I-TOT-FEES NOT NUMERIC
 13743        MOVE ZEROS               TO PB-I-TOT-FEES
 13744     END-IF
 13745     IF PB-I-LIVES NOT NUMERIC
 13746         MOVE ZERO               TO PB-I-LIVES.
 13747
 13748     IF PB-I-NUM-BILLED NOT NUMERIC
 13749         MOVE ZERO               TO PB-I-NUM-BILLED.
 13750
 13751     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13752        MOVE +0                  TO PB-I-LF-PREM-TAX
 13753     END-IF
 13754
 13755     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13756        MOVE +0                  TO PB-I-AH-PREM-TAX
 13757     END-IF
 13758
 13759     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13760        PB-I-PAY-FREQUENCY = ZEROS
 13761            MOVE 12 TO CP-PAY-FREQUENCY
 13762     ELSE
 13763            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13764
 13765     IF PB-I-STATE-TAX NOT NUMERIC
 13766         MOVE ZEROS               TO PB-I-STATE-TAX.
 13767
 13768     IF PB-I-MUNI-TAX NOT NUMERIC
 13769         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13770
 13771     MOVE SPACES                 TO CP-BEN-CATEGORY
 13772     IF PB-COMPANY-ID  = 'CSL'  AND
 13773        PB-I-LF-TERM NOT = ZERO
 13774        COMPUTE WS-PAYMENT-AMT =
 13775             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13776        COMPUTE WS-CSL-AMT1 =
 13777             PB-I-LF-TERM * AM-MAX-MON-BEN
 13778        COMPUTE WS-CSL-AMT2 =
 13779             WS-PAYMENT-AMT * PB-I-LF-TERM
 13780        IF CP-PAY-FREQUENCY NOT = 12
 13781           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13782           MOVE '8' TO WS-CSL-CALC-CD
 13783        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 251
* EL050.cbl
 13784           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13785              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13786               AM-MAX-TOT-BEN
 13787               MOVE '6' TO WS-CSL-CALC-CD
 13788           ELSE
 13789              IF (WS-CSL-AMT1  GREATER THAN
 13790                 AM-MAX-TOT-BEN) AND
 13791                 (WS-CSL-AMT2  GREATER THAN
 13792                 AM-MAX-TOT-BEN)
 13793                 MOVE '7' TO WS-CSL-CALC-CD
 13794              ELSE
 13795                 MOVE '5' TO WS-CSL-CALC-CD.
 13796
 13797     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13798         NEXT SENTENCE
 13799     ELSE
 13800         GO TO 3300-CHECK-AH-RATES.
 13801
 13802*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13803
 13804     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13805        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13806              OR
 13807           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13808           MOVE ER-2618          TO WS-ERROR
 13809           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13810           GO TO 3300-CHECK-AH-RATES.
 13811
 13812     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13813           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13814                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13815
 13816     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13817         MOVE ER-2687             TO WS-ERROR
 13818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13819         MOVE 'Z000'              TO PB-I-MORT-CODE
 13820         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13821         GO TO 3300-CHECK-AH-RATES.
 13822
 13823     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13824        IF PB-I-LIVES = ZERO
 13825           MOVE ER-2688          TO WS-ERROR
 13826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13827
 13828     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13829
 13830     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13831     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13832     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13833     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13834     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13835     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13836     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13837     MOVE '3'                    TO CP-PROCESS-TYPE.
 13838     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13839     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13840
 13841******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 252
* EL050.cbl
 13842     IF PB-COMPANY-ID EQUAL 'CDL'
 13843         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13844            CP-EARN-AS-NET-PAY)
 13845             IF PB-CERT-EFF-DT GREATER  WS-931231
 13846                 MOVE '1'        TO CP-EARNING-METHOD.
 13847*******
 13848
 13849     MOVE PB-SV-STATE            TO CP-STATE.
 13850     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13851     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13852     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13853     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13854     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13855                                    CP-RATING-BENEFIT-AMT.
 13856     IF CP-STATE-STD-ABBRV = 'OR'
 13857         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13858                                         PB-I-LF-ALT-BENEFIT-AMT.
 13859     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13860     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13861     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13862     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13863     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13864     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13865     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13866     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13867     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13868                                    CP-REMAINING-TERM
 13869                                    CP-LOAN-TERM.
 13870
 13871     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13872         NEXT SENTENCE
 13873     ELSE
 13874         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13875             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13876                                           PB-I-LF-PREMIUM-AMT.
 13877
 13878     IF PB-COMPANY-ID EQUAL 'CSL'
 13879        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13880           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13881                                         PB-I-LF-PREMIUM-AMT.
 13882
 13883     IF PB-COMPANY-ID EQUAL 'NCB'
 13884         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13885            CP-EARN-AS-NET-PAY
 13886             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13887                 PB-I-LF-PREMIUM-AMT.
 13888
 13889     IF (CP-TRUNCATED-LIFE)
 13890        or ((pb-company-id = 'AHL')
 13891           and (pb-i-loan-term > pb-i-lf-term))
 13892        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13893
 13894     IF PB-COMPANY-ID EQUAL 'CRI'
 13895        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13896
 13897     IF CP-TERM-IS-DAYS
 13898         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13899     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 253
* EL050.cbl
 13900         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13901     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13902        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13903        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13904        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13905        IF WS-LF-BEN-CATEGORY = 'D'
 13906           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13907           MOVE PB-I-LIFE-COMMISSION
 13908                                 TO CP-DCC-ACT-COMM
 13909           MOVE WS-LF-BEN-CATEGORY
 13910                                 TO CP-BEN-CATEGORY
 13911        END-IF
 13912        IF (CP-BENEFIT-CD (1:1) = 'P')
 13913           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13914           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13915           add pb-i-ah-premium-amt to cp-original-premium
 13916        END-IF
 13917     END-IF
 13918     IF PB-COMPANY-ID = 'CSL'
 13919         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13920         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13921         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13922
 13923     IF PB-COMPANY-ID = 'CSL'
 13924        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13925
 13926     IF (CP-SPECIAL-CALC-CD = 'H')
 13927        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13928         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13929                                    TO CP-ALTERNATE-BENEFIT
 13930         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13931     if (pb-company-id = 'CID')
 13932        and (ws-lf-earnings-calc = '4')
 13933        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13934        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13935        move pb-i-term-type      to cp-pmt-mode
 13936        move pb-i-no-of-payments to cp-no-of-pmts
 13937        move pb-i-ah-benefit-amt to cp-monthly-payment
 13938     end-if
 13939     move ws-net-only-state      to cp-net-only-state
 13940     IF (PB-COMPANY-ID = 'CID')
 13941        AND (WS-LF-EARNINGS-CALC = 'B')
 13942        AND (CP-STATE-STD-ABBRV = 'MN')
 13943        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13944                                 TO CP-ALTERNATE-BENEFIT
 13945        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13946     END-IF
 13947     IF (PB-COMPANY-ID = 'CID')
 13948        AND (WS-LF-EARNINGS-CALC = 'B')
 13949        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13950                                 TO CP-ALTERNATE-BENEFIT
 13951        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13952        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13953*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13954*         pb-i-lf-alt-premium-amt
 13955        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13956        IF WS-LF-BEN-CATEGORY = 'P'
 13957           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 254
* EL050.cbl
 13958        ELSE
 13959           IF WS-LF-BEN-CATEGORY = 'I'
 13960              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13961           END-IF
 13962        END-IF
 13963     END-IF
 13964     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13965     MOVE 'R'                   TO CP-RATE-FILE.
 13966     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13967
 13968     IF CP-ERROR-RATE-NOT-FOUND
 13969        MOVE ER-2641            TO WS-ERROR
 13970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13971        GO TO 3300-CHECK-AH-RATES.
 13972
 13973     IF PB-COMPANY-ID EQUAL 'CRI'
 13974        IF CP-ERROR-NO-LIMITS-CRI
 13975           IF NOT ACCOUNT-LIFE-CHECKED
 13976              MOVE ER-2607      TO WS-ERROR
 13977              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13978
 13979******************************************************************
 13980*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13981*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13982******************************************************************
 13983
 13984* CALC LIFE AGE AT EXPIRATION.
 13985
 13986     COMPUTE WS-AGE-AT-EXPIRE =
 13987          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13988
 13989*    IF PB-STATE = 'CO' OR 'UT'
 13990*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13991*        MOVE 'F'            TO PB-FATAL-FLAG
 13992*        MOVE ER-2709        TO WS-ERROR
 13993*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13994*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13995
 13996*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13997*        MOVE 'X'            TO PB-FATAL-FLAG
 13998*        MOVE ER-2718        TO WS-ERROR
 13999*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14000*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14001
 14002* CALC A & H AGE AT EXPIRATION.
 14003
 14004     COMPUTE WS-AGE-AT-EXPIRE =
 14005          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 14006
 14007*    IF PB-STATE = 'CO' OR 'UT'
 14008*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14009*        MOVE 'F'            TO PB-FATAL-FLAG
 14010*        MOVE ER-2709        TO WS-ERROR
 14011*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14012*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14013
 14014*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14015*        MOVE 'X'            TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 255
* EL050.cbl
 14016*        MOVE ER-2718        TO WS-ERROR
 14017*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14018*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14019
 14020     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 14021        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14022
 14023     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14024        and (not pb-monthly-cert)
 14025        GO TO 3221-CHECK-ERROR-RATE-OPEN
 14026     end-if
 14027
 14028     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14029        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14030
 14031     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14032         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14033         MOVE ER-2639        TO WS-ERROR
 14034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14035
 14036
 14037******************************************************************
 14038*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14039******************************************************************
 14040
 14041 PREMIUM-EDITING-IS-BYPASSED.
 14042     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14043        AND (CP-R-MAX-ATT-AGE > +0)
 14044        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14045        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14046           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14047           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14048           MOVE '1'              TO DC-OPTION-CODE
 14049           PERFORM 8500-DATE-CONVERT
 14050                                 THRU 8500-EXIT
 14051           IF NO-CONVERSION-ERROR
 14052              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14053                 MOVE ER-2661       TO WS-ERROR
 14054*                PERFORM 9900-ERROR-FORMAT
 14055*                                THRU 9900-EXIT
 14056              END-IF
 14057           END-IF
 14058        ELSE
 14059           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14060           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14061              MOVE ER-2661       TO WS-ERROR
 14062*             PERFORM 9900-ERROR-FORMAT
 14063*                                THRU 9900-EXIT
 14064           ELSE
 14065              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14066                 MOVE ER-1570    TO WS-ERROR
 14067                 PERFORM 9900-ERROR-FORMAT
 14068                                 THRU 9900-EXIT
 14069              END-IF
 14070           END-IF
 14071        END-IF
 14072        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14073           MOVE PB-I-JOINT-BIRTHDAY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 256
* EL050.cbl
 14074                                 TO DC-BIN-DATE-1
 14075           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14076           MOVE '1'              TO DC-OPTION-CODE
 14077           PERFORM 8500-DATE-CONVERT
 14078                                 THRU 8500-EXIT
 14079           IF NO-CONVERSION-ERROR
 14080              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14081                 MOVE ER-2661       TO WS-ERROR
 14082*                PERFORM 9900-ERROR-FORMAT
 14083*                                THRU 9900-EXIT
 14084              END-IF
 14085           ELSE
 14086              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14087           END-IF
 14088        ELSE
 14089           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14090             (PB-I-LF-TERM / 12)
 14091           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14092              MOVE ER-2661       TO WS-ERROR
 14093*             PERFORM 9900-ERROR-FORMAT
 14094*                                THRU 9900-EXIT
 14095           ELSE
 14096              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14097                 MOVE ER-1571    TO WS-ERROR
 14098                 PERFORM 9900-ERROR-FORMAT
 14099                                 THRU 9900-EXIT
 14100              END-IF
 14101           END-IF
 14102        END-IF
 14103        IF WS-ERROR = ER-2661
 14104           PERFORM 9900-ERROR-FORMAT
 14105                                 THRU 9900-EXIT
 14106        END-IF
 14107     END-IF
 14108*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14109*       MOVE ER-2661             TO WS-ERROR
 14110*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14111
 14112     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14113        MOVE ER-2662             TO WS-ERROR
 14114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14115
 14116     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14117        MOVE ER-2677             TO WS-ERROR
 14118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14119
 14120     IF CP-ERROR-LOAN-TERM
 14121        MOVE ER-2648             TO WS-ERROR
 14122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14123     if cp-error-term-below-minimum
 14124        move er-3070             to ws-error
 14125        perform 9900-error-format thru 9900-exit
 14126     end-if
 14127     .
 14128 3221-CHECK-ERROR-RATE-OPEN.
 14129
 14130     IF CP-ERROR-RATE-FILE-NOTOPEN
 14131         GO TO 3990-FILES-NOT-OPEN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 257
* EL050.cbl
 14132
 14133     IF PB-COMPANY-ID NOT = 'DMD'
 14134        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14135     END-IF
 14136     .
 14137 3221-CONTINUE.
 14138     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14139                                    WS-DCC-AH-RATE
 14140     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14141        IF WS-LF-BEN-CATEGORY = 'D'
 14142           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14143              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14144        END-IF
 14145     END-IF
 14146     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14147*   X'A4FF' = 12/31/2009
 14148     IF (PB-COMPANY-ID = 'CID')
 14149        AND (WS-LF-EARNINGS-CALC = 'B')
 14150        AND (CP-STATE-STD-ABBRV = 'MN')
 14151        AND (PB-CERT-EFF-DT > X'A4FF')
 14152        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14153     END-IF
 14154     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14155
 14156     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14157     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14158        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14159        AND (PB-I-POLICY-IS-MONTHLY)
 14160        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14161        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14162     END-IF
 14163     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14164     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14165     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14166     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14167     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14168        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14169        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14170        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14171        MOVE ER-2786             TO WS-ERROR
 14172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14173     END-IF
 14174
 14175     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14176
 14177******************************************************************
 14178*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14179******************************************************************
 14180     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14181        and ((not pb-monthly-cert)
 14182        or (ws-lf-ben-category = 'C'))
 14183        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14184
 14185     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14186        GO TO 3225-CHECK-ALT-LIFE-RATE
 14187     ELSE
 14188       IF PB-I-LF-RATE = ZERO
 14189          MOVE ER-2641          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 258
* EL050.cbl
 14190          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14191
 14192 3225-CHECK-ALT-LIFE-RATE.
 14193
 14194     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14195        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14196        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14197         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14198
 14199     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14200         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14201             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14202                   OR
 14203              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14204              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14205              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14206             MOVE ER-2720        TO  WS-ERROR
 14207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14208             GO TO 3225-RATING-CONT
 14209         ELSE
 14210             GO TO 3225-RATING-CONT.
 14211     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14212        AND (AM-GPCD = 01 OR 06 OR 15)
 14213        MOVE ER-2798             TO WS-ERROR
 14214        PERFORM 9900-ERROR-FORMAT
 14215                                 THRU 9900-EXIT
 14216*       GO TO 3225-RATING-CONT
 14217     END-IF
 14218     if (pb-company-id = 'CID')
 14219        and (ws-lf-earnings-calc = 'B')
 14220        and (ws-lf-ben-category = 'P' or 'I')
 14221        and (ws-net-only-state = 'Y')
 14222        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14223*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14224        go to 3225-rating-cont
 14225     end-if
 14226     IF (PB-COMPANY-ID = 'CID')
 14227        AND (WS-LF-EARNINGS-CALC = 'B')
 14228        AND (CP-STATE-STD-ABBRV = 'MN')
 14229        AND (PB-CERT-EFF-DT > X'A4FF')
 14230        GO TO 3225-RATING-CONT
 14231     END-IF
 14232     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14233        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14234           AND (PB-I-POLICY-IS-MONTHLY)
 14235           GO TO 3225-RATING-CONT
 14236        END-IF
 14237     END-IF
 14238
 14239     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14240        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14241        CP-EARN-AS-REG-BALLOON
 14242        NEXT SENTENCE
 14243     ELSE
 14244        MOVE '2'                 TO CP-EARNING-METHOD.
 14245
 14246 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14247
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 259
* EL050.cbl
 14248     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14249
 14250     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14251        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14252        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14253         NEXT SENTENCE
 14254     ELSE
 14255         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14256
 14257     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14258     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14259     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14260                                     CP-RATING-BENEFIT-AMT.
 14261     IF CP-STATE-STD-ABBRV = 'OR'
 14262         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14263                                         PB-I-LF-ALT-BENEFIT-AMT.
 14264     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14265        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14266     END-IF
 14267     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14268     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14269     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14270                                    CP-REMAINING-TERM
 14271                                    CP-LOAN-TERM.
 14272     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14273        ADD +1                   TO CP-ORIGINAL-TERM
 14274                                    CP-REMAINING-TERM
 14275                                    CP-LOAN-TERM.
 14276
 14277     MOVE 'R'                   TO CP-RATE-FILE.
 14278     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14279
 14280     IF CP-ERROR-RATE-NOT-FOUND
 14281         MOVE ER-2641            TO WS-ERROR
 14282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14283         GO TO 3300-CHECK-AH-RATES.
 14284
 14285     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14286     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14287
 14288     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14289         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14290
 14291     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14292                               + PB-I-LF-ALT-BENEFIT-AMT.
 14293
 14294     IF ACCOUNT-LIFE-CHECKED  OR
 14295        PB-POLICY-IS-VOIDED   OR
 14296        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14297        and (not pb-monthly-cert))
 14298        GO TO 3225-CONTINUE.
 14299
 14300     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14301        GO TO 3225-CONTINUE.
 14302
 14303     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14304                             EC-RT-LF-MAX-TOT-BEN
 14305        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 260
* EL050.cbl
 14306        MOVE ER-2639       TO WS-ERROR
 14307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14308
 14309 3225-CONTINUE.
 14310     IF PB-I-LF-ALT-RATE = ZERO
 14311         MOVE ER-2659            TO WS-ERROR
 14312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14313
 14314     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14315        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14316        MOVE ER-2698             TO WS-ERROR
 14317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14318
 14319 3225-RATING-CONT.
 14320
 14321     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14322        and (not pb-monthly-cert)
 14323         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14324         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14325         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14326            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14327            CONTINUE
 14328         ELSE
 14329            MOVE ER-2687         TO WS-ERROR
 14330            PERFORM 9900-ERROR-FORMAT
 14331                                 THRU 9900-EXIT
 14332         END-IF
 14333         GO TO 3290-EDIT-LF-REIN-RATE
 14334     END-IF
 14335
 14336* DMD RATING TEST
 14337     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14338         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14339         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14340         MOVE ER-2687                 TO WS-ERROR
 14341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14342         GO TO 3290-EDIT-LF-REIN-RATE.
 14343
 14344 3230-CLIENT-MORT-CD-SPECIALS.
 14345
 14346     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14347     SET BIN-TO-GREG          TO TRUE.
 14348*    MOVE ' '                 TO DC-OPTION-CODE.
 14349     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14350     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14351
 14352 C-POS-3230-MORT-CD.
 14353     IF PB-COMPANY-ID = 'POS' AND
 14354        PB-SV-CARRIER = '2'
 14355         NEXT SENTENCE
 14356     ELSE
 14357         GO TO C-POS-3240-MORT-CD.
 14358
 14359     IF PB-SV-GROUPING = '030'
 14360        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14361         MOVE '2350' TO PB-I-MORT-CODE
 14362      ELSE
 14363         MOVE '3300' TO PB-I-MORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 261
* EL050.cbl
 14364
 14365
 14366 C-POS-3240-MORT-CD.
 14367     IF PB-COMPANY-ID = 'POS' AND
 14368        PB-SV-CARRIER = '1'
 14369         NEXT SENTENCE
 14370     ELSE
 14371         GO TO 3230-CONTINUE.
 14372
 14373     IF PB-SV-STATE = '45' OR '47'
 14374        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14375         MOVE '5200' TO PB-I-MORT-CODE
 14376     ELSE
 14377         MOVE '8300' TO PB-I-MORT-CODE.
 14378
 14379 3230-CONTINUE.
 14380
 14381     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14382        GO TO 3240-CONTINUE
 14383     END-IF
 14384
 14385     IF PB-CERT-EFF-DT > WS-971231
 14386        GO TO 3240-CONTINUE
 14387     END-IF
 14388
 14389     IF LF-BENEFIT-FOUND AND
 14390        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14391         MOVE 'F250'       TO PB-I-MORT-CODE
 14392     ELSE
 14393         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14394             MOVE '7250'   TO PB-I-MORT-CODE
 14395         ELSE
 14396             MOVE '4251'   TO PB-I-MORT-CODE
 14397         END-IF
 14398     END-IF
 14399
 14400     .
 14401 3240-CONTINUE.
 14402
 14403     IF PB-COMPANY-ID NOT = 'GNL'
 14404         GO TO 3256-CONTINUE.
 14405
 14406     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14407         MOVE 'A300' TO PB-I-MORT-CODE
 14408     ELSE
 14409         MOVE '8350' TO PB-I-MORT-CODE.
 14410
 14411 3256-CONTINUE.
 14412     IF PB-COMPANY-ID NOT = 'ABL'
 14413         GO TO 3260-EDIT-CONTINUE.
 14414
 14415     IF PB-I-LF-TERM GREATER THAN 59
 14416         MOVE 'F550' TO PB-I-MORT-CODE
 14417     ELSE
 14418         MOVE 'E550' TO PB-I-MORT-CODE.
 14419
 14420 3260-EDIT-CONTINUE.
 14421     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 262
* EL050.cbl
 14422
 14423 3290-EDIT-LF-REIN-RATE.
 14424     IF LF-REIN-NSP-NOT-USED
 14425         GO TO 3290-RATING-CONT.
 14426
 14427     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14428        GO TO 3290-RATING-CONT.
 14429     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14430     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14431     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14432     MOVE '3'                   TO CP-PROCESS-TYPE.
 14433     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14434
 14435******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14436     IF PB-COMPANY-ID EQUAL 'CDL'
 14437         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14438            CP-EARN-AS-NET-PAY)
 14439             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14440*            MOVE SPACE          TO DC-OPTION-CODE
 14441             SET BIN-TO-GREG     TO TRUE
 14442             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14443***  Y2K PROJ 7744
 14444             IF DC-GREG-DATE-CYMD GREATER 19931231
 14445                 MOVE '1'        TO CP-EARNING-METHOD.
 14446***  Y2K PROJ 7744
 14447*******
 14448
 14449     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14450     MOVE PB-SV-STATE           TO CP-STATE.
 14451     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14452     MOVE ZERO                  TO CP-DEVIATION-CODE
 14453                                   CP-RATE-DEV-PCT.
 14454     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14455     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14456                                   CP-RATING-BENEFIT-AMT.
 14457
 14458************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14459     IF PB-COMPANY-ID EQUAL 'NCB'
 14460         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14461            CP-EARN-AS-NET-PAY
 14462             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14463                 PB-I-LF-PREMIUM-AMT.
 14464************
 14465
 14466     IF CP-STATE-STD-ABBRV = 'OR'
 14467         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14468                                         PB-I-LF-ALT-BENEFIT-AMT.
 14469     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14470     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14471     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14472     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14473     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14474     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14475     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14476     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14477                                   CP-REMAINING-TERM
 14478                                   CP-LOAN-TERM.
 14479     IF CP-TRUNCATED-LIFE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 263
* EL050.cbl
 14480        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14481
 14482     IF CP-TERM-IS-DAYS
 14483         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14484     ELSE
 14485         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14486
 14487     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14488        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14489     END-IF
 14490     IF PB-COMPANY-ID NOT = 'TIC'
 14491          MOVE ZERO          TO CP-CLASS-CODE.
 14492
 14493     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14494
 14495     MOVE 'R'                   TO CP-RATE-FILE.
 14496     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14497
 14498     IF CP-ERROR-RATE-NOT-FOUND
 14499        IF PB-I-OB
 14500           MOVE ER-2625      TO WS-ERROR
 14501           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14502           GO TO 3299-EDIT-CONTINUE
 14503        ELSE
 14504           MOVE ER-2643      TO WS-ERROR
 14505           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14506           GO TO 3299-EDIT-CONTINUE.
 14507
 14508     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14509
 14510     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14511     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14512
 14513     IF PB-I-LF-REI-RATE = ZERO
 14514         MOVE ER-2643        TO WS-ERROR
 14515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14516
 14517 3290-CHECK-ALT-REIN-RATE.
 14518
 14519     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14520        GO TO 3290-RATING-CONT.
 14521
 14522     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14523     MOVE '2'                    TO CP-EARNING-METHOD.
 14524     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14525     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14526     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14527     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14528                                     CP-RATING-BENEFIT-AMT.
 14529     IF CP-STATE-STD-ABBRV = 'OR'
 14530         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14531                                         PB-I-LF-ALT-BENEFIT-AMT.
 14532     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14533        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14534     END-IF
 14535     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14536     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14537     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 264
* EL050.cbl
 14538                                    CP-REMAINING-TERM
 14539                                    CP-LOAN-TERM.
 14540     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14541        ADD +1                   TO CP-ORIGINAL-TERM
 14542                                    CP-REMAINING-TERM
 14543                                    CP-LOAN-TERM.
 14544
 14545     MOVE 'R'                   TO CP-RATE-FILE.
 14546     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14547
 14548     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14549
 14550     IF PB-I-LF-ALT-REI-RATE = ZERO
 14551         MOVE ER-2643            TO WS-ERROR
 14552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14553
 14554 3290-RATING-CONT.
 14555
 14556     IF PB-I-OB
 14557*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14558        GO TO 3300-CHECK-AH-RATES.
 14559
 14560 3299-EDIT-CONTINUE.
 14561
 14562     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14563         NEXT SENTENCE
 14564     ELSE
 14565         MOVE ER-2620           TO WS-ERROR
 14566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14567
 14568 3300-CHECK-AH-RATES.
 14569     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14570         NEXT SENTENCE
 14571     ELSE
 14572         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14573
 14574     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14575        and (not pb-monthly-cert))
 14576                  or
 14577        ((CF-COMPANY-ID = 'DMD') AND
 14578                (NO-DMD-RATING))
 14579         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14580            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14581            CONTINUE
 14582         ELSE
 14583            MOVE ER-2687         TO WS-ERROR
 14584            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14585         END-IF
 14586         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14587         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14588     END-IF
 14589
 14590     IF PB-I-OB
 14591        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14592
 14593     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14594         MOVE ER-2687             TO WS-ERROR
 14595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 265
* EL050.cbl
 14596         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14597         GO TO 3999-END-EDIT.
 14598
 14599*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14600     if pb-company-id = 'AHL'
 14601        go to 3300-skip-crit-per
 14602     end-if
 14603     if (pb-i-ah-crit-per not = zeros)
 14604        and (ws-ah-special-calc-cd not = 'C')
 14605        MOVE ER-1572             TO WS-ERROR
 14606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14607        go to 3300-skip-crit-per
 14608     END-IF
 14609     if (pb-company-id = 'DCC' or 'VPP')
 14610        and (am-dcc-product-code not = spaces)
 14611        go to 3300-skip-crit-per
 14612     end-if
 14613     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14614        IF PB-I-AH-CRIT-PER = ZERO
 14615           move ws-ah-max-bens   to pb-i-ah-crit-per
 14616*          MOVE ER-2618       TO WS-ERROR
 14617*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14618*          GO TO 3999-END-EDIT
 14619        END-IF
 14620     END-IF
 14621     if (ws-ah-special-calc-cd = 'C')
 14622        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14623        MOVE ER-1576             TO WS-ERROR
 14624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14625     end-if
 14626
 14627     .
 14628 3300-skip-crit-per.
 14629     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14630     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14631     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14632     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14633     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14634     MOVE PB-SV-STATE            TO CP-STATE.
 14635     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14636     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14637     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14638*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14639     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14640     MOVE '3'                    TO CP-PROCESS-TYPE.
 14641     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14642     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14643                                    CP-RATING-BENEFIT-AMT.
 14644     IF PB-COMPANY-ID = 'CID'
 14645               OR
 14646        CP-STATE-STD-ABBRV = 'OR'
 14647         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14648                                         PB-I-AH-TERM.
 14649     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14650        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14651           AND (PB-I-POLICY-IS-MONTHLY)
 14652           MOVE PB-I-LF-BENEFIT-AMT
 14653                                 TO CP-NET-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 266
* EL050.cbl
 14654           move pb-i-ah-premium-amt to cp-original-premium
 14655           add pb-i-lf-premium-amt to cp-original-premium
 14656        END-IF
 14657     END-IF
 14658     MOVE SPACES                 TO CP-BEN-CATEGORY
 14659     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14660        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14661        EVALUATE TRUE
 14662           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14663              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14664              MOVE PB-I-LF-BENEFIT-AMT
 14665                                 TO CP-RATING-BENEFIT-AMT
 14666              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14667           WHEN WS-AH-BEN-CATEGORY = 'G'
 14668              MOVE PB-I-UNPAID-CASH-PRICE
 14669                                 TO CP-RATING-BENEFIT-AMT
 14670           WHEN WS-AH-BEN-CATEGORY = 'D'
 14671              MOVE WS-AH-PMF-COMM
 14672                                 TO CP-DCC-PMF-COMM
 14673              MOVE PB-I-AH-COMMISSION
 14674                                 TO CP-DCC-ACT-COMM
 14675        END-EVALUATE
 14676     END-IF
 14677     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14678     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14679     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14680     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14681     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14682     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14683     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14684                                    CP-REMAINING-TERM
 14685                                    WS-WORK-TERM.
 14686     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14687
 14688     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14689     SET BIN-TO-GREG             TO TRUE.
 14690*    MOVE ' '                    TO DC-OPTION-CODE.
 14691     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14692     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14693
 14694     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14695     IF NOT VALID-SKIP-CODE
 14696         MOVE ER-2683            TO WS-ERROR
 14697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14698         GO TO 3320-RATE-CONTINUE.
 14699
 14700     IF PB-NO-MONTHS-SKIPPED
 14701         GO TO 3320-RATE-CONTINUE.
 14702
 14703     MOVE SPACE TO NUMBER-OF-MONTHS.
 14704
 14705     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14706         MOVE 'S'                TO SK-MO (6).
 14707     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14708         MOVE 'S'                TO SK-MO (7).
 14709     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14710         MOVE 'S'                TO SK-MO (8).
 14711     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 267
* EL050.cbl
 14712         MOVE 'S'                TO SK-MO (9).
 14713     IF PB-I-SKIP-CODE = 'A'
 14714         MOVE 'S'                TO SK-MO (10).
 14715
 14716     MOVE 1                      TO SUB2.
 14717     MOVE PB-I-AH-TERM           TO SUB3.
 14718     MOVE WS-MONTH               TO SUB1.
 14719     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14720     GO TO 3320-RATE-CONTINUE.
 14721
 14722 3310-GET-SKIP-MO.
 14723     IF SUB1 = 13
 14724         MOVE 1                  TO SUB1.
 14725
 14726     IF SK-MO (SUB1) = 'S'
 14727         SUBTRACT 1 FROM WS-WORK-TERM.
 14728
 14729     ADD 1 TO SUB2
 14730              SUB1.
 14731
 14732 3320-RATE-CONTINUE.
 14733
 14734     IF WS-WORK-TERM = ZERO
 14735         MOVE 1                  TO WS-WORK-TERM.
 14736
 14737     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14738                                    CP-LOAN-TERM.
 14739
 14740     IF PB-COMPANY-ID EQUAL 'DMD'
 14741         NEXT SENTENCE
 14742     ELSE
 14743         MOVE ZERO               TO PB-I-AH-RATE
 14744                                    PB-I-AH-REI-RATE.
 14745
 14746
 14747     IF PB-COMPANY-ID EQUAL 'CRI'
 14748        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14749
 14750     IF PB-COMPANY-ID = 'CSL'
 14751         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14752         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14753         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14754         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14755
 14756     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14757        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14758           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14759              PB-I-RATE-DEV-PCT-LF
 14760        END-IF
 14761        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14762                                 TO CP-ALTERNATE-BENEFIT
 14763        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14764        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14765        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14766     END-IF
 14767*    if ws-clp-state not = spaces
 14768*       move ws-clp-state to cp-state
 14769*    end-if
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 268
* EL050.cbl
 14770     IF (PB-COMPANY-ID = 'CID')
 14771        AND (WS-LF-EARNINGS-CALC = 'B')
 14772        AND (CP-STATE-STD-ABBRV = 'MN')
 14773        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14774     ELSE
 14775        MOVE ' '                 TO CP-AH-BALLOON-SW
 14776     END-IF
 14777     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14778     MOVE 'R'                   TO CP-RATE-FILE.
 14779     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14780
 14781     IF (CP-ERROR-RATE-NOT-FOUND)
 14782        and (not pb-monthly-cert)
 14783        IF PB-I-OB
 14784           MOVE ER-2624          TO WS-ERROR
 14785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14786           GO TO 3340-CALCULATE-PREMIUM-AMT
 14787        ELSE
 14788          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14789              NEXT SENTENCE
 14790          ELSE
 14791           MOVE ER-2642          TO WS-ERROR
 14792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14793           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14794
 14795     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14796        CP-ERROR-DIV-BY-ZERO
 14797           MOVE ER-3782          TO WS-ERROR
 14798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14799
 14800     IF PB-COMPANY-ID EQUAL 'CRI'
 14801        IF CP-ERROR-NO-LIMITS-CRI
 14802           IF NOT ACCOUNT-AH-CHECKED
 14803              MOVE ER-2607          TO WS-ERROR
 14804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14805
 14806     IF ACCOUNT-AH-CHECKED
 14807        NEXT SENTENCE
 14808     ELSE
 14809       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14810          MOVE ER-2640           TO WS-ERROR
 14811          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14812
 14813     IF PB-COMPANY-ID = 'CRI'
 14814         IF WS-ERROR = ER-2640
 14815             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14816     IF ACCOUNT-AH-CHECKED
 14817        CONTINUE
 14818     ELSE
 14819        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14820           AND (CP-R-MAX-ATT-AGE > +0)
 14821           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14822           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14823              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14824              MOVE PB-I-AH-EXPIRE-DT
 14825                                 TO DC-BIN-DATE-2
 14826              MOVE '1'           TO DC-OPTION-CODE
 14827              PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 269
* EL050.cbl
 14828                                 THRU 8500-EXIT
 14829              IF NO-CONVERSION-ERROR
 14830                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14831                    MOVE ER-2661       TO WS-ERROR
 14832*                   PERFORM 9900-ERROR-FORMAT
 14833*                                THRU 9900-EXIT
 14834                 END-IF
 14835              END-IF
 14836           ELSE
 14837              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14838              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14839                 MOVE ER-2661    TO WS-ERROR
 14840*                PERFORM 9900-ERROR-FORMAT
 14841*                                THRU 9900-EXIT
 14842              ELSE
 14843                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14844                    MOVE ER-1570 TO WS-ERROR
 14845                    PERFORM 9900-ERROR-FORMAT
 14846                                 THRU 9900-EXIT
 14847                 END-IF
 14848              END-IF
 14849           END-IF
 14850           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14851              MOVE PB-I-JOINT-BIRTHDAY
 14852                                    TO DC-BIN-DATE-1
 14853              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14854              MOVE '1'              TO DC-OPTION-CODE
 14855              PERFORM 8500-DATE-CONVERT
 14856                                    THRU 8500-EXIT
 14857              IF NO-CONVERSION-ERROR
 14858                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14859                    MOVE ER-2661       TO WS-ERROR
 14860*                   PERFORM 9900-ERROR-FORMAT
 14861*                                   THRU 9900-EXIT
 14862                 END-IF
 14863              END-IF
 14864           ELSE
 14865              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14866                (PB-I-AH-TERM / 12)
 14867              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14868                 MOVE ER-2661       TO WS-ERROR
 14869*                PERFORM 9900-ERROR-FORMAT
 14870*                                   THRU 9900-EXIT
 14871              ELSE
 14872                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14873                    MOVE ER-1571 TO WS-ERROR
 14874                    PERFORM 9900-ERROR-FORMAT
 14875                                 THRU 9900-EXIT
 14876                 END-IF
 14877              END-IF
 14878           END-IF
 14879           IF WS-ERROR = ER-2661
 14880              PERFORM 9900-ERROR-FORMAT
 14881                                    THRU 9900-EXIT
 14882           END-IF
 14883        END-IF
 14884     END-IF
 14885*    IF ACCOUNT-AH-CHECKED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 270
* EL050.cbl
 14886*       NEXT SENTENCE
 14887*    ELSE
 14888*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14889*          MOVE ER-2661          TO WS-ERROR
 14890*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14891
 14892     IF ACCOUNT-AH-CHECKED
 14893        NEXT SENTENCE
 14894     ELSE
 14895        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14896           MOVE ER-2663          TO WS-ERROR
 14897           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14898
 14899     IF ACCOUNT-AH-CHECKED OR
 14900        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14901         PB-POLICY-IS-VOIDED
 14902        NEXT SENTENCE
 14903     ELSE
 14904        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14905           MOVE ER-2667            TO WS-ERROR
 14906           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14907
 14908     IF PB-COMPANY-ID = 'CRI'
 14909         IF WS-ERROR = ER-2667
 14910             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14911
 14912     IF ACCOUNT-AH-CHECKED
 14913        NEXT SENTENCE
 14914     ELSE
 14915        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14916           MOVE ER-2678            TO WS-ERROR
 14917           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14918
 14919     IF CP-ERROR-RATE-FILE-NOTOPEN
 14920         GO TO 3990-FILES-NOT-OPEN.
 14921
 14922 3321-CONTINUE.
 14923     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14924     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14925     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14926*    IF (PB-COMPANY-ID = 'DCC')
 14927        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14928        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14929                                    PB-I-LF-ALT-PREM-CALC
 14930        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14931        IF WS-AH-BEN-CATEGORY = 'G'
 14932           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14933           + PB-I-ADDL-CLP)
 14934           * (1 + WS-TOL-CLP-PCT)
 14935*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14936        ELSE
 14937           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14938           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14939*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14940        END-IF
 14941        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14942                                 TO PB-I-AH-PREM-CALC
 14943        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 271
* EL050.cbl
 14944           MOVE ER-8152          TO WS-ERROR
 14945           PERFORM 9900-ERROR-FORMAT
 14946                                 THRU 9900-EXIT
 14947        ELSE
 14948           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14949                 PB-I-ADDL-CLP)
 14950              MOVE ER-8148       TO WS-ERROR
 14951              PERFORM 9900-ERROR-FORMAT
 14952                                 THRU 9900-EXIT
 14953           END-IF
 14954        END-IF
 14955     END-IF
 14956     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14957        AND (PB-I-POLICY-IS-MONTHLY)
 14958        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14959        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14960        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14961           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14962        END-IF
 14963     END-IF
 14964     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14965        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14966        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14967        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14968        MOVE ER-2786             TO WS-ERROR
 14969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14970     END-IF
 14971     MOVE +0                     TO PB-I-AH-CLP
 14972     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14973        evaluate true
 14974           when WS-AH-BEN-CATEGORY = 'D'
 14975              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14976                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14977           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14978              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14979           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14980              compute ws-cred-union-fees rounded =
 14981                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14982                    pb-i-ah-commission)
 14983              COMPUTE PB-I-AH-CLP =
 14984                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14985        end-evaluate
 14986     END-IF
 14987     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14988
 14989     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14990         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14991
 14992     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14993         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14994
 14995     if (ws-ah-special-calc-cd = 'E')
 14996        and (pb-monthly-cert)
 14997        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14998     end-if
 14999     IF PB-COMPANY-ID = 'CRI'
 15000         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 15001            PB-I-PAYMENT-AMOUNT = ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 272
* EL050.cbl
 15002             NEXT SENTENCE
 15003         ELSE
 15004             COMPUTE PB-I-AH-PREM-CALC =
 15005                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 15006                 (CP-PREMIUM-RATE / 100)
 15007             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 15008                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 15009                                             PB-I-RATE-DEV-PCT-AH.
 15010
 15011     IF (PB-I-AH-RATE  = ZERO)
 15012        and (not pb-monthly-cert)
 15013       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15014           NEXT SENTENCE
 15015       ELSE
 15016         MOVE ER-2642            TO WS-ERROR
 15017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15018
 15019     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 15020     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 15021     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 15022     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 15023     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 15024     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 15025
 15026     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15027        AND (WS-AH-BEN-CATEGORY = 'G')
 15028        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15029        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15030        IF CP-DEVIATION-CODE NOT = '000'
 15031           MOVE '000'            TO CP-DEVIATION-CODE
 15032           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15033           IF NO-CP-ERROR
 15034              COMPUTE PB-I-DDF-IU-RATE-UP =
 15035              PB-I-AH-CLP - CP-CALC-PREMIUM
 15036           ELSE
 15037              MOVE ER-3057        TO WS-ERROR
 15038              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15039           END-IF
 15040        END-IF
 15041     END-IF
 15042     .
 15043 3335-EDIT-AH-REIN-NSP-RATE.
 15044     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15045        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15046              compute ws-cred-union-fees rounded =
 15047                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15048                    pb-i-ah-commission)
 15049              COMPUTE PB-I-AH-CLP =
 15050                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15051        end-if
 15052     END-IF
 15053     IF AH-REIN-NSP-NOT-USED
 15054         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15055
 15056     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15057     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15058         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15059     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 273
* EL050.cbl
 15060     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15061     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15062     MOVE PB-SV-STATE            TO CP-STATE.
 15063     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15064     MOVE ZERO                   TO CP-DEVIATION-CODE
 15065                                    CP-RATE-DEV-PCT.
 15066*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15067     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15068     MOVE '3'                    TO CP-PROCESS-TYPE.
 15069     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15070     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15071                                    CP-RATING-BENEFIT-AMT.
 15072     IF CP-STATE-STD-ABBRV = 'OR'
 15073         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15074                                         PB-I-AH-TERM.
 15075     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15076     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15077     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15078     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15079     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15080     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15081                                    CP-REMAINING-TERM
 15082                                    WS-WORK-TERM.
 15083     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15084     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15085        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15086     END-IF
 15087     IF  PB-COMPANY-ID = 'TIC'
 15088         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15089            MOVE ZERO TO CP-CLASS-CODE.
 15090
 15091     IF PB-COMPANY-ID NOT = 'TIC'
 15092          MOVE ZERO          TO CP-CLASS-CODE.
 15093
 15094     MOVE ZERO               TO CP-DEVIATION-CODE.
 15095
 15096     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15097
 15098     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15099
 15100     MOVE 'R'                   TO CP-RATE-FILE.
 15101     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15102
 15103     IF CP-ERROR-RATE-NOT-FOUND
 15104         MOVE ER-2645        TO WS-ERROR
 15105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15106         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15107
 15108     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15109
 15110     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15111     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15112
 15113     IF PB-I-AH-REI-RATE = ZERO
 15114         MOVE ER-2645        TO WS-ERROR
 15115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15116
 15117
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 274
* EL050.cbl
 15118 3340-CALCULATE-PREMIUM-AMT.
 15119     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15120     SET BIN-TO-GREG             TO TRUE
 15121     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15122     move dc-greg-date-a-edit    to ws-greg-eff-date
 15123
 15124     IF PB-COMPANY-ID = 'NCL'
 15125         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15126             WS-AH-SPECIAL-CALC-CD = 'O')
 15127             GO TO 3999-END-EDIT.
 15128
 15129     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15130                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15131                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15132                         OR 'AHL'
 15133         NEXT SENTENCE
 15134     ELSE
 15135         IF WS-STATE-ABBREVIATION = 'CT'
 15136             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15137                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15138                 COMPUTE PB-I-LF-PREM-CALC =
 15139                                     PB-I-LF-PREM-CALC * .90
 15140                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15141                                     PB-I-LF-ALT-PREM-CALC * .90
 15142                 COMPUTE PB-I-AH-PREM-CALC =
 15143                                     PB-I-AH-PREM-CALC * .90.
 15144
 15145     IF PB-COMP-LF-PREM
 15146        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15147        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15148
 15149     IF PB-COMP-AH-PREM
 15150        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15151
 15152 3340-CHECK-DCC-TOT-FEES.
 15153     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15154        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15155        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15156        AND (PB-I-POLICY-IS-MONTHLY)
 15157        CONTINUE
 15158     ELSE
 15159        GO TO 3340-EDIT-LF-AH-TOL
 15160     END-IF
 15161     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15162     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15163     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15164        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15165           PB-I-RATE-DEV-PCT-LF
 15166     END-IF
 15167     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15168        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15169           PB-I-RATE-DEV-PCT-AH
 15170     END-IF
 15171     MOVE 'N'                    TO CP-BEN-CATEGORY
 15172     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15173
 15174     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15175     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 275
* EL050.cbl
 15176     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15177     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15178     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15179     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15180     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15181     MOVE '3'                    TO CP-PROCESS-TYPE.
 15182     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15183     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15184
 15185     MOVE PB-SV-STATE            TO CP-STATE.
 15186     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15187     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15188     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15189     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15190     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15191                                    CP-RATING-BENEFIT-AMT.
 15192     IF CP-STATE-STD-ABBRV = 'OR'
 15193         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15194                                         PB-I-LF-ALT-BENEFIT-AMT.
 15195     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15196     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15197     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15198     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15199     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15200     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15201     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15202     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15203     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15204                                    CP-REMAINING-TERM
 15205                                    CP-LOAN-TERM.
 15206     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15207        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15208           PB-I-LF-PREMIUM-AMT
 15209     end-if
 15210
 15211     IF CP-TRUNCATED-LIFE
 15212        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15213
 15214     IF CP-TERM-IS-DAYS
 15215         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15216     ELSE
 15217         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15218
 15219     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15220     IF CP-SPECIAL-CALC-CD = 'H'
 15221         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15222                                    TO CP-ALTERNATE-BENEFIT
 15223         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15224     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15225     MOVE 'R'                    TO CP-RATE-FILE
 15226     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15227     IF NOT CP-ERROR-RATE-NOT-FOUND
 15228        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15229        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15230           AND (CP-BENEFIT-CD (1:1) = 'S')
 15231           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15232                                    PB-I-LF-PREMIUM-AMT
 15233        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 276
* EL050.cbl
 15234     ELSE
 15235        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15236     END-IF
 15237     .
 15238 3340-EDIT-LF-AH-TOL.
 15239
 15240***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15241***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15242***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15243***
 15244     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15245         PB-I-AH-PREMIUM-AMT
 15246          GIVING WS-CALC-WORK.
 15247
 15248     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15249        AND WS-CALC-WORK NOT = ZERO
 15250         MOVE ER-2649            TO WS-ERROR
 15251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15252
 15253     SUBTRACT PB-I-LF-PREM-CALC
 15254             FROM PB-I-LF-PREMIUM-AMT
 15255                 GIVING WS-UNSIGN-WRK1.
 15256
 15257     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15258             FROM PB-I-LF-ALT-PREMIUM-AMT
 15259                 GIVING WS-UNSIGN-WRK4.
 15260
 15261     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15262                                + WS-UNSIGN-WRK4.
 15263
 15264     SUBTRACT PB-I-AH-PREM-CALC
 15265             FROM PB-I-AH-PREMIUM-AMT
 15266                 GIVING WS-UNSIGN-WRK2.
 15267
 15268******************************************************************
 15269*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15270******************************************************************
 15271
 15272     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15273         MOVE ZERO TO WS-UNSIGN-WRK1.
 15274
 15275     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15276         MOVE ZERO TO WS-UNSIGN-WRK2.
 15277
 15278     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15279             GIVING WS-UNSIGN-WRK3.
 15280
 15281 3342-CONTINUE.
 15282
 15283     IF (PB-I-LF-RATE = ZERO  AND
 15284         PB-I-AH-RATE = ZERO)
 15285         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15286            WS-AH-SPECIAL-CALC-CD = 'O'
 15287              NEXT SENTENCE
 15288         ELSE
 15289             GO TO 3345-EDIT-CONTINUE.
 15290
 15291     IF  PB-RECORD-BILL   =  'B' OR  'L'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 277
* EL050.cbl
 15292         NEXT SENTENCE
 15293     ELSE
 15294     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15295        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15296           IF (PB-REISSUED-CERT         OR
 15297               PB-POLICY-IS-DECLINED    OR
 15298               PB-POLICY-IS-VOIDED)
 15299              NEXT SENTENCE
 15300           ELSE
 15301              IF WS-PREM-REJECT-SW = SPACE
 15302                 MOVE ER-2652    TO WS-ERROR
 15303                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15304                 GO TO 3344-CHECK-AH
 15305              ELSE
 15306                 MOVE ER-2650    TO WS-ERROR
 15307                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15308                 GO TO 3344-CHECK-AH.
 15309
 15310***
 15311***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15312***
 15313
 15314     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15315         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15316            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15317             (1 + WS-TOL-LF-PREM-PCT)
 15318         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15319            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15320             (1 - WS-TOL-LF-PREM-PCT)
 15321     ELSE
 15322         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15323         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15324
 15325***
 15326***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15327***
 15328
 15329     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15330         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15331          WS-TOL-LF-PREM.
 15332
 15333     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15334         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15335          WS-TOL-LF-PREM.
 15336
 15337     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15338        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15339
 15340     IF PB-REISSUED-CERT
 15341        or PB-POLICY-IS-DECLINED
 15342        or PB-POLICY-IS-VOIDED
 15343        continue
 15344     ELSE
 15345        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15346              > WS-TOL-LF-HIGH-PREM-AMT)
 15347           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15348              < WS-TOL-LF-LOW-PREM-AMT))
 15349                      or
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 278
* EL050.cbl
 15350           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15351              > WS-TOL-LF-HIGH-PREM-PCT)
 15352           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15353              < WS-TOL-LF-LOW-PREM-PCT))
 15354           IF WS-PREM-REJECT-SW = SPACE
 15355              MOVE ER-2652       TO WS-ERROR
 15356              PERFORM 9900-ERROR-FORMAT
 15357                                 THRU 9900-EXIT
 15358           ELSE
 15359              MOVE ER-2650       TO WS-ERROR
 15360              PERFORM 9900-ERROR-FORMAT
 15361                                 THRU 9900-EXIT
 15362           end-if
 15363        end-if
 15364     end-if
 15365
 15366*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15367*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15368*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15369*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15370
 15371     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15372        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15373                      OR
 15374           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15375           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15376           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15377           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15378        END-IF
 15379     END-IF
 15380
 15381     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15382        IF WS-COMP-MAX-CAP GREATER THAN +0
 15383           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15384              IF (PB-REISSUED-CERT         OR
 15385                  PB-POLICY-IS-DECLINED    OR
 15386                  PB-POLICY-IS-VOIDED)
 15387                 NEXT SENTENCE
 15388              ELSE
 15389                  MOVE ER-2646   TO  WS-ERROR
 15390                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15391
 15392 3344-CVL-TOLERANCE-CHECK.
 15393
 15394      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15395          GO TO 3344-CHECK-AH.
 15396
 15397      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15398          GO TO 3344-CHECK-AH.
 15399
 15400      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15401                                     WS-UNSIGN-WRK6.
 15402
 15403      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15404          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15405                                 + PB-I-LF-PREMIUM-AMT
 15406                                 - PB-I-LF-PREM-CALC.
 15407
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 279
* EL050.cbl
 15408      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15409          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15410                                 + PB-I-LF-ALT-PREMIUM-AMT
 15411                                 - PB-I-LF-ALT-PREM-CALC.
 15412
 15413      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15414          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15415              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15416                 MOVE ER-2652    TO  WS-ERROR
 15417                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15418              ELSE
 15419                 MOVE ER-2650    TO  WS-ERROR
 15420                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15421
 15422      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15423          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15424              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15425                 MOVE ER-2652    TO  WS-ERROR
 15426                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15427              ELSE
 15428                 MOVE ER-2650    TO  WS-ERROR
 15429                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15430
 15431 3344-CHECK-AH.
 15432
 15433****************************************************************
 15434***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15435***
 15436
 15437     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15438         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15439             (1 + WS-TOL-AH-PREM-PCT)
 15440         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15441             (1 - WS-TOL-AH-PREM-PCT)
 15442     ELSE
 15443         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15444         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15445
 15446***
 15447***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15448***
 15449
 15450     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15451         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15452
 15453     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15454         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15455
 15456     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15457        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15458
 15459     IF (PB-REISSUED-CERT)
 15460        OR (PB-POLICY-IS-DECLINED)
 15461        OR (PB-POLICY-IS-VOIDED)
 15462        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15463        CONTINUE
 15464     ELSE
 15465        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 280
* EL050.cbl
 15466              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15467                          or
 15468           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15469              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15470           IF WS-PREM-REJECT-SW = SPACE
 15471              MOVE ER-3052       TO WS-ERROR
 15472              PERFORM 9900-ERROR-FORMAT
 15473                                 THRU 9900-EXIT
 15474           ELSE
 15475              MOVE ER-3050       TO WS-ERROR
 15476              PERFORM 9900-ERROR-FORMAT
 15477                                 THRU 9900-EXIT
 15478           END-IF
 15479        END-IF
 15480     END-IF
 15481     if (pb-company-id = 'DCC' or 'VPP')
 15482        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15483        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15484        and (pb-i-policy-is-monthly)
 15485        compute ws-tol-ah-high-prem-amt =
 15486           pb-i-tot-fees-calc + ws-tol-ah-prem
 15487        compute ws-tol-ah-low-prem-amt =
 15488           pb-i-tot-fees-calc - ws-tol-ah-prem
 15489        if ws-tol-ah-prem-pct > zeros
 15490           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15491              (1 + ws-tol-ah-prem-pct)
 15492           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15493              (1 - ws-tol-ah-prem-pct)
 15494        else
 15495           move +9999999.99      to ws-tol-ah-high-prem-pct
 15496           move +0               to ws-tol-ah-low-prem-pct
 15497        end-if
 15498        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15499            or
 15500           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15501                          or
 15502           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15503           or
 15504           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15505            move er-3049         to ws-error
 15506           perform 9900-error-format
 15507                                 thru 9900-exit
 15508
 15509        end-if
 15510     end-if
 15511     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15512         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15513             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15514             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15515
 15516     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15517        IF WS-COMP-MAX-CAP GREATER THAN +0
 15518           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15519              IF (PB-REISSUED-CERT         OR
 15520                  PB-POLICY-IS-DECLINED    OR
 15521                  PB-POLICY-IS-VOIDED)
 15522                 NEXT SENTENCE
 15523              ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 281
* EL050.cbl
 15524                  MOVE ER-2646   TO  WS-ERROR
 15525                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15526
 15527     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15528        (WS-COMP-MAX-CAP EQUAL +0)
 15529           GO TO 3345-EDIT-CONTINUE.
 15530
 15531     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15532        GREATER THAN WS-COMP-MAX-CAP
 15533           MOVE ER-2646          TO  WS-ERROR
 15534           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15535
 15536 3345-EDIT-CONTINUE.
 15537
 15538*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15539*       IF PB-ENTRY-BATCH   NUMERIC
 15540*          IF PB-ISSUE
 15541*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15542*          ELSE
 15543*              IF PB-CANCELLATION
 15544*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15545
 15546*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15547*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15548*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15549*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15550*        ELSE
 15551*            MOVE  ER-1909            TO  WS-ERROR
 15552*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15553
 15554     IF PB-I-POLICY-ACCEPTED
 15555        IF PB-POLICY-IS-DECLINED  OR
 15556           PB-REISSUED-CERT  OR
 15557           PB-REIN-ONLY-CERT  OR
 15558           PB-POLICY-IS-VOIDED
 15559            MOVE  ER-1891         TO  WS-ERROR
 15560            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15561        ELSE
 15562            MOVE SPACE            TO  PB-BATCH-ENTRY
 15563            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15564
 15565     IF PB-I-POLICY-DECLINED
 15566        IF PB-REISSUED-CERT  OR
 15567           PB-REIN-ONLY-CERT  OR
 15568           PB-POLICY-IS-VOIDED
 15569            MOVE  ER-1906         TO  WS-ERROR
 15570            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15571        ELSE
 15572            MOVE  'D'             TO  PB-BATCH-ENTRY
 15573                                      PB-I-ENTRY-STATUS.
 15574
 15575     IF PB-I-NEEDS-UNDERWRITING
 15576        IF PB-POLICY-IS-DECLINED OR
 15577           PB-REISSUED-CERT  OR
 15578           PB-REIN-ONLY-CERT  OR
 15579           PB-POLICY-IS-VOIDED
 15580            MOVE  ER-1907         TO  WS-ERROR
 15581            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 282
* EL050.cbl
 15582        ELSE
 15583            MOVE 'U'              TO  PB-BATCH-ENTRY
 15584                                      PB-I-ENTRY-STATUS.
 15585
 15586     IF PB-NEEDS-UNDERWRITING
 15587        MOVE  ER-1901             TO  WS-ERROR
 15588        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15589     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15590        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15591        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15592        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15593           AND (NOT WS-LF-CASH))
 15594                           OR
 15595           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15596           AND (NOT WS-AH-CASH)))
 15597                       AND
 15598           (PB-I-ENTRY-STATUS NOT = '5')
 15599           MOVE 'M'              TO PB-BATCH-ENTRY
 15600                                    PB-I-ENTRY-STATUS
 15601        END-IF
 15602     END-IF
 15603     move pending-business       to ws-passed-erpndb
 15604     move ' '                    to ws-exceed-limit-yn
 15605     perform 7780-call-agg       thru 7780-exit
 15606*    display ' el050 exceed ' ws-exceed-limit-yn
 15607     if ws-exceed-limit-yn = 'Y'
 15608        MOVE  ER-9813            TO WS-ERROR
 15609        move 'Y'                 to ws-9813-sw
 15610        PERFORM  9900-ERROR-FORMAT
 15611                                 THRU 9900-EXIT
 15612     end-if
 15613     if (PB-EXCEEDED-LIMIT-FORCED)
 15614        and (ws-9813-sw = 'Y')
 15615        subtract +1 from PB-NO-OF-ERRORS
 15616        move er-9823             to ws-error
 15617        PERFORM  9900-ERROR-FORMAT
 15618                                 THRU 9900-EXIT
 15619     end-if
 15620     IF  PB-COMPANY-ID NOT = 'NCL'
 15621         GO TO 3999-END-EDIT.
 15622
 15623     IF PB-REISSUED-CERT  OR
 15624        PB-POLICY-IS-DECLINED  OR
 15625        PB-POLICY-IS-VOIDED  OR
 15626        PB-I-OB
 15627         GO TO 3999-END-EDIT.
 15628
 15629     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15630         MOVE  ER-2644            TO  WS-ERROR
 15631         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15632         GO TO 3999-END-EDIT.
 15633
 15634     MOVE 'N'                     TO  FORM-MASTER-SW.
 15635     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15636
 15637     IF NOT FORM-MASTER-FOUND
 15638         GO TO 3999-END-EDIT.
 15639
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 283
* EL050.cbl
 15640     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15641                                      FORM-MASTER-AH-SW.
 15642
 15643     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15644         MOVE  +1                 TO SUB6
 15645         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15646
 15647     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15648         MOVE  +1                 TO SUB6
 15649         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15650
 15651     IF LF-FORM-MASTER-FOUND  OR
 15652        AH-FORM-MASTER-FOUND
 15653         GO TO 3360-CHECK-FORM-LIMITS
 15654     ELSE
 15655         GO TO 3999-END-EDIT.
 15656
 15657******************************************************************
 15658*                  3350-GET-ERFORM                               *
 15659*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15660*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15661******************************************************************
 15662
 15663 3350-GET-ERFORM.
 15664
 15665     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15666         GO TO  3350-ERFORM-GETMAIN.
 15667
 15668     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15669     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15670     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15671     MOVE 'Y'                     TO FORM-MASTER-SW.
 15672
 15673     IF PB-CANCELLATION
 15674         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15675            PB-SV-STATE          EQUAL   FO-STATE       AND
 15676            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15677              GO TO 3350-EXIT
 15678         ELSE
 15679             NEXT SENTENCE
 15680     ELSE
 15681         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15682            PB-SV-STATE          EQUAL   FO-STATE       AND
 15683            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15684              GO TO 3350-EXIT.
 15685
 15686 3350-ERFORM-GETMAIN.
 15687
 15688     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15689     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15690
 15691 3350-ERFORM-READ.
 15692
 15693     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15694     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15695     IF PB-CANCELLATION
 15696         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15697     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 284
* EL050.cbl
 15698         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15699     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15700
 15701     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15702
 15703     IF FORM-MASTER-FOUND
 15704       IF PB-CANCELLATION
 15705          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15706             PB-SV-STATE          EQUAL   FO-STATE       AND
 15707             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15708              GO  TO 3350-EXIT
 15709          ELSE
 15710              NEXT SENTENCE
 15711       ELSE
 15712          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15713             PB-SV-STATE          EQUAL   FO-STATE       AND
 15714             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15715              GO  TO 3350-EXIT.
 15716
 15717     MOVE  'N'                    TO  FORM-MASTER-SW.
 15718     MOVE  ER-1895                TO  WS-ERROR.
 15719     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15720
 15721 3350-EXIT.
 15722      EXIT.
 15723
 15724******************************************************************
 15725*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15726*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15727*   VALID FOR THE POLICY FORM USED.                              *
 15728******************************************************************
 15729
 15730 3355-EDIT-FORM-LF-BENEFITS.
 15731
 15732     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15733        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15734         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15735         GO TO   3355-EXIT.
 15736
 15737     IF  SUB6    LESS THAN   +40
 15738         ADD  +1      TO  SUB6
 15739         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15740
 15741     MOVE  ER-1896         TO  WS-ERROR.
 15742     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15743
 15744 3355-EXIT.
 15745      EXIT.
 15746
 15747******************************************************************
 15748*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15749*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15750*   VALID FOR THE POLICY FORM USED.                              *
 15751******************************************************************
 15752
 15753 3356-EDIT-FORM-AH-BENEFITS.
 15754
 15755     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 285
* EL050.cbl
 15756        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15757         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15758         GO TO  3356-EXIT.
 15759
 15760      IF  SUB6    LESS THAN     +40
 15761          ADD  +1      TO  SUB6
 15762          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15763
 15764     MOVE  ER-1897         TO  WS-ERROR.
 15765     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15766
 15767 3356-EXIT.
 15768      EXIT.
 15769
 15770******************************************************************
 15771*                  3357-BENEFIT-SEARCH                           *
 15772*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15773*   CANCELLATIONS ONLY.                                          *
 15774******************************************************************
 15775 3357-BENEFIT-SEARCH.
 15776     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15777         MOVE +1                          TO SUB6
 15778         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15779
 15780     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15781         MOVE +1                          TO SUB6
 15782         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15783
 15784 3357-EXIT.
 15785     EXIT.
 15786
 15787******************************************************************
 15788*                  3358-BENEFIT-LIFE-SEARCH                      *
 15789*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15790*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15791*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15792******************************************************************
 15793 3358-BENEFIT-LIFE-SEARCH.
 15794     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15795       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15796         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15797           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15798              IF FO-PLAN-REFUND-METHOD (SUB6)
 15799                     IS GREATER THAN SPACES
 15800                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15801                                          WS-LF-REFUND-CALC
 15802                 GO TO 3358-EXIT.
 15803
 15804     IF SUB6 LESS THAN +40
 15805         ADD +1                 TO SUB6
 15806         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15807
 15808 3358-EXIT.
 15809     EXIT.
 15810******************************************************************
 15811*                  3359-BENEFIT-AH-SEARCH                        *
 15812*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15813*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 286
* EL050.cbl
 15814*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15815******************************************************************
 15816 3359-BENEFIT-AH-SEARCH.
 15817     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15818       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15819         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15820           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15821              IF FO-PLAN-REFUND-METHOD (SUB6)
 15822                      IS GREATER THAN SPACES
 15823                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15824                                          WS-AH-REFUND-CALC
 15825                 GO TO 3359-EXIT.
 15826
 15827     IF SUB6 LESS THAN +40
 15828         ADD +1                 TO SUB6
 15829         GO TO 3359-BENEFIT-AH-SEARCH.
 15830
 15831 3359-EXIT.
 15832     EXIT.
 15833
 15834******************************************************************
 15835*                  3360-CHECK-FORM-LIMITS                        *
 15836*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15837*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15838******************************************************************
 15839
 15840 3360-CHECK-FORM-LIMITS.
 15841
 15842     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15843         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15844
 15845     IF NOT LF-FORM-MASTER-FOUND
 15846         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15847
 15848 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15849
 15850     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15851       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15852        WS-LF-JOINT-INDICATOR = 'J'  AND
 15853        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15854         IF PB-COMPANY-ID = 'NCL'
 15855            MOVE  ER-1911          TO  WS-ERROR
 15856            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15857         ELSE
 15858            MOVE  ER-1892          TO  WS-ERROR
 15859            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15860
 15861 3360-CHECK-FORM-LF-ATT-AGE.
 15862
 15863     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15864
 15865     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15866         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15867         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15868            IF PB-COMPANY-ID = 'NCL'
 15869                MOVE  ER-1913      TO  WS-ERROR
 15870                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15871            ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 287
* EL050.cbl
 15872                MOVE  ER-1894      TO  WS-ERROR
 15873                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15874
 15875 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15876
 15877     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15878         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15879         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15880            IF PB-COMPANY-ID = 'NCL'
 15881                MOVE  ER-1914      TO  WS-ERROR
 15882                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15883            ELSE
 15884                MOVE  ER-1899      TO  WS-ERROR
 15885                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15886
 15887 3360-CHECK-FORM-LF-TERM-BAMT.
 15888
 15889     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15890         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15891         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15892           IF  PB-COMPANY-ID = 'NCL'
 15893               MOVE  ER-1916       TO  WS-ERROR
 15894               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15895           ELSE
 15896               MOVE  ER-1902       TO  WS-ERROR
 15897               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15898
 15899     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15900                                    PB-I-LF-ALT-BENEFIT-AMT.
 15901
 15902     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15903         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15904         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15905             IF  PB-COMPANY-ID = 'NCL'
 15906                 MOVE  ER-1918     TO  WS-ERROR
 15907                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15908             ELSE
 15909                 MOVE  ER-1904     TO  WS-ERROR
 15910                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15911
 15912******************************************************************
 15913*                  3360-CHECK-FORM-AH-LIMITS                     *
 15914*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15915*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15916******************************************************************
 15917
 15918 3360-CHECK-FORM-AH-LIMITS.
 15919
 15920     IF NOT AH-FORM-MASTER-FOUND
 15921         GO TO 3999-END-EDIT.
 15922
 15923 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15924
 15925     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15926       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15927        WS-AH-JOINT-INDICATOR = 'J'  AND
 15928        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15929         IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 288
* EL050.cbl
 15930            MOVE  ER-1912          TO  WS-ERROR
 15931            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15932         ELSE
 15933            MOVE  ER-1893          TO  WS-ERROR
 15934            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15935
 15936 3360-CHECK-FORM-AH-ATT-AGE.
 15937
 15938     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15939
 15940     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15941         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15942         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15943            IF PB-COMPANY-ID = 'NCL'
 15944                MOVE  ER-1913      TO  WS-ERROR
 15945                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15946            ELSE
 15947                MOVE  ER-1894      TO  WS-ERROR
 15948                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15949
 15950 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15951
 15952     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15953         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15954         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15955            IF PB-COMPANY-ID = 'NCL'
 15956                MOVE  ER-1915      TO  WS-ERROR
 15957                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15958            ELSE
 15959                MOVE  ER-1900      TO  WS-ERROR
 15960                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15961
 15962 3360-CHECK-FORM-AH-TERM-BAMT.
 15963
 15964     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15965         FO-AH-MAX-TERM    GREATER THAN  +0
 15966         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15967             IF  PB-COMPANY-ID = 'NCL'
 15968                 MOVE  ER-1917     TO  WS-ERROR
 15969                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15970             ELSE
 15971                  MOVE  ER-1903    TO  WS-ERROR
 15972                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15973
 15974     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15975         FO-MAX-AH-AMT    GREATER THAN  +0
 15976         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15977             IF  PB-COMPANY-ID = 'NCL'
 15978                 MOVE  ER-1919     TO  WS-ERROR
 15979                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15980             ELSE
 15981                 MOVE  ER-1905     TO  WS-ERROR
 15982                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15983
 15984     GO TO 3999-END-EDIT.
 15985
 15986******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 289
* EL050.cbl
 15988 3400-edit-vin.
 15989
 15990     move spaces                 to hldi-pass-area
 15991     MOVE PB-I-VIN               TO WS-WORK-VIN
 15992     MOVE +8                     TO V2
 15993     MOVE ZEROS                  TO WS-VIN-TOTAL
 15994     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15995      (V1 > 17)
 15996        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15997           MOVE ER-3825          TO WS-ERROR
 15998           PERFORM 9900-ERROR-FORMAT
 15999                                 THRU 9900-EXIT
 16000        ELSE
 16001           IF V1 = 8
 16002              MOVE 10            TO V2
 16003           END-IF
 16004           IF V1 = 9
 16005              MOVE 0             TO V2
 16006           END-IF
 16007           IF V1 = 10
 16008              MOVE 9             TO V2
 16009           END-IF
 16010           IF WS-WORK-VIN (V1:1) NUMERIC
 16011              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16012               + (WS-WORK-VIN-N (V1) * V2)
 16013           ELSE
 16014              MOVE WS-WORK-VIN (V1:1)
 16015                            TO WS-HEX-BYTE
 16016              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 16017              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16018               + (WS-NUM (V3) * V2)
 16019           END-IF
 16020           COMPUTE V2 = V2 - 1
 16021        END-IF
 16022     END-PERFORM
 16023     MOVE ZEROS                  TO WS-VIN-REMAINDER
 16024     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 16025        REMAINDER WS-VIN-REMAINDER
 16026     IF ((WS-WORK-VIN (9:1) = 'X')
 16027        AND (WS-VIN-REMAINDER = 10))
 16028                OR
 16029        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16030        if pb-company-id = 'VPP'
 16031           perform 3410-check-with-hldi
 16032                                 thru 3410-exit
 16033        end-if
 16034     ELSE
 16035        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16036           MOVE ER-3826          TO WS-ERROR
 16037           PERFORM 9900-ERROR-FORMAT
 16038                                 THRU 9900-EXIT
 16039        ELSE
 16040           MOVE ER-3827          TO WS-ERROR
 16041           PERFORM 9900-ERROR-FORMAT
 16042                                 THRU 9900-EXIT
 16043        END-IF
 16044     END-IF
 16045
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 290
* EL050.cbl
 16046     .
 16047 3400-exit.
 16048     exit.
 16049 3410-check-with-hldi.
 16050     move spaces                 to hldi-pass-area
 16051     move pb-i-vin               to pa-vin
 16052     perform 7785-call-hldi      thru 7785-exit
 16053*    display 'PA-VIN        ' PA-VIN
 16054*    display 'PA-ErrorCode  ' PA-ErrorCode
 16055*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16056*    display 'PA-ModelYear  ' PA-ModelYear
 16057*    display 'PA-MakeName   ' PA-MakeName
 16058*    display 'PA-ModelName  ' PA-ModelName
 16059*    display 'PA-SeriesName ' PA-SeriesName
 16060     if pa-errorcode (1:1) not = '0'
 16061        move spaces              to hldi-pass-area
 16062        move pb-i-vin            to pa-vin
 16063*       move pa-errordesc        to pa-seriesname
 16064*       perform 7786-call-hldim  thru 7786-exit
 16065*       display 'PA-VIN        ' PA-VIN
 16066*       display 'PA-ErrorCode  ' PA-ErrorCode
 16067*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16068*       display 'PA-ModelYear  ' PA-ModelYear
 16069*       display 'PA-MakeName   ' PA-MakeName
 16070*       display 'PA-ModelName  ' PA-ModelName
 16071*       display 'PA-SeriesName ' PA-SeriesName
 16072     end-if
 16073     .
 16074 3410-exit.
 16075     exit.
 16076******************************************************************
 16077*                  E D I T   C A N C E L                         *
 16078******************************************************************
 16079
 16080 3700-EDIT-CANCEL.
 16081     IF PB-COMPANY-ID = 'DMD'
 16082         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16083                                         WS-RES-MUNI-TAX
 16084                                         PB-CI-STATE-TAX
 16085                                         PB-CI-MUNI-TAX
 16086         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16087
 16088*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16089*       IF PB-ENTRY-BATCH  NUMERIC
 16090*          IF PB-CANCELLATION
 16091*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16092*          ELSE
 16093*             IF PB-ISSUE
 16094*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16095
 16096     IF PB-C-INT-ON-REFS NOT NUMERIC
 16097        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16098     END-IF
 16099*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16100*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16101
 16102     IF CM-ENTRY-STATUS = 'V'
 16103        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 291
* EL050.cbl
 16104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16105        GO TO 3999-END-EDIT.
 16106
 16107     IF CM-ENTRY-STATUS = 'D'
 16108        MOVE ER-2781             TO WS-ERROR
 16109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16110        GO TO 3999-END-EDIT.
 16111
 16112     IF CM-ENTRY-STATUS = 'U'
 16113        MOVE ER-2782             TO WS-ERROR
 16114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16115
 16116***************************************************************
 16117*                                                             *
 16118*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16119*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16120*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16121*   OF ANOTHER COVERAGE.                                      *
 16122*                                                             *
 16123***************************************************************
 16124
 16125     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16126                                    PB-C-AH-CANCEL-VOID-SW.
 16127
 16128     if pb-company-id = 'DCC' or 'VPP'
 16129        if ((pb-ci-lf-cancel-amt <> zeros)
 16130                       or
 16131            (pb-ci-ah-cancel-amt <> zeros))
 16132           MOVE ER-3068          TO WS-ERROR
 16133           PERFORM 9900-ERROR-FORMAT
 16134                                 THRU 9900-EXIT
 16135           GO TO 3999-END-EDIT
 16136        end-if
 16137     end-if
 16138     IF PB-C-LF-CANCEL-AMT = ZERO
 16139        NEXT SENTENCE
 16140     ELSE
 16141        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16142           AND
 16143           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16144               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16145               MOVE ER-2745           TO WS-ERROR
 16146               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16147
 16148     IF PB-C-AH-CANCEL-AMT = ZERO
 16149        NEXT SENTENCE
 16150     ELSE
 16151        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16152           AND
 16153           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16154               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16155               MOVE ER-2745           TO WS-ERROR
 16156               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16157
 16158     IF WS-LF-EARNINGS-CALC = '4'
 16159        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16160
 16161     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 292
* EL050.cbl
 16162     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16163     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16164     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16165     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16166     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16167
 16168     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16169                                      PB-C-AH-REF-CALC.
 16170     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16171
 16172******************************************************************
 16173*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16174*             TO VALIDATE COVERAGE.                              *
 16175******************************************************************
 16176
 16177     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16178        PB-C-LF-CANCEL-AMT = ZEROS
 16179          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16180      ELSE
 16181          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16182
 16183     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16184        PB-C-AH-CANCEL-AMT = ZEROS
 16185          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16186      ELSE
 16187          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16188
 16189     EVALUATE TRUE
 16190         WHEN PB-CANCEL-FORCE             OR
 16191              PB-CANCEL-DATE-FORCED       OR
 16192              PB-FORCE-OFF
 16193                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16194                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16195                  END-IF
 16196         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16197               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16198              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16199                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16200         WHEN OTHER
 16201              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16202                 MOVE ER-2794              TO WS-ERROR
 16203              ELSE
 16204                 MOVE ER-2749              TO WS-ERROR
 16205              END-IF
 16206              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16207     END-EVALUATE.
 16208
 16209
 16210*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16211*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16212*            MOVE  ER-1909            TO  WS-ERROR
 16213*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16214*        ELSE
 16215*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16216
 16217     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16218     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16219        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 293
* EL050.cbl
 16220     ELSE
 16221        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16222     END-IF
 16223     .
 16224 3705-EDIT-CANCEL-DT.
 16225
 16226     IF LF-COVERAGE-CANCELLED
 16227        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16228         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16229         MOVE WS-CURRENT-MONTH-END
 16230                                 TO DC-BIN-DATE-2
 16231         SET ELAPSED-BETWEEN-BIN TO TRUE
 16232*        MOVE 1                  TO DC-OPTION-CODE
 16233         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16234         IF DATE-CONVERSION-ERROR
 16235            NEXT SENTENCE
 16236          ELSE
 16237             IF DC-ELAPSED-DAYS GREATER +180
 16238                IF PB-CANCEL-DATE-FORCED  OR
 16239                   PB-CANCEL-DATE-FORCED-NO-FEE
 16240                      MOVE ER-2751  TO WS-ERROR
 16241                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16242                 ELSE
 16243                   MOVE ER-2752  TO WS-ERROR
 16244                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16245
 16246     IF AH-COVERAGE-CANCELLED
 16247        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16248         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16249         MOVE WS-CURRENT-MONTH-END
 16250                                 TO DC-BIN-DATE-2
 16251         SET ELAPSED-BETWEEN-BIN TO TRUE
 16252*        MOVE 1                  TO DC-OPTION-CODE
 16253         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16254         IF DATE-CONVERSION-ERROR
 16255            NEXT SENTENCE
 16256          ELSE
 16257             IF DC-ELAPSED-DAYS GREATER +180
 16258                IF PB-CANCEL-DATE-FORCED OR
 16259                   PB-CANCEL-DATE-FORCED-NO-FEE
 16260                      MOVE ER-2751  TO WS-ERROR
 16261                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16262                 ELSE
 16263                   MOVE ER-2752  TO WS-ERROR
 16264                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16265
 16266     IF WS-ERROR = ER-2752
 16267        AND (PB-COMPANY-ID = 'ABL'
 16268         OR  PB-COMPANY-ID = 'FGL'
 16269         OR  PB-COMPANY-ID = 'IST'
 16270         OR  PB-COMPANY-ID = 'JHL'
 16271         OR  PB-COMPANY-ID = 'LAP'
 16272         OR  PB-COMPANY-ID = 'LBL'
 16273         OR  PB-COMPANY-ID = 'NCB'
 16274         OR  PB-COMPANY-ID = 'NLI'
 16275         OR  PB-COMPANY-ID = 'OFI'
 16276         OR  PB-COMPANY-ID = 'PLI'
 16277         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 294
* EL050.cbl
 16278         OR  PB-COMPANY-ID = 'TIC'
 16279         OR  PB-COMPANY-ID = 'HER'
 16280         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16281         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16282            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16283            MOVE ER-2762     TO WS-ERROR
 16284            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16285
 16286     IF LF-COVERAGE-CANCELLED
 16287        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16288        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16289             MOVE ER-2733         TO WS-ERROR
 16290             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16291
 16292     IF AH-COVERAGE-CANCELLED
 16293        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16294        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16295              MOVE ER-2733        TO WS-ERROR
 16296              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16297
 16298     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16299        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16300        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16301           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16302            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16303              IF PB-COMPANY-ID NOT = 'LAP'
 16304               MOVE ER-2704            TO WS-ERROR
 16305               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16306
 16307     IF CERT-WAS-NOT-FOUND
 16308         GO TO 3999-END-EDIT.
 16309
 16310     IF PB-COMPANY-ID EQUAL 'CDC'
 16311        IF LF-COVERAGE-CANCELLED
 16312           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16313            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16314            MOVE PB-C-LF-CANCEL-DT
 16315                                 TO DC-BIN-DATE-2
 16316            SET ELAPSED-BETWEEN-BIN TO TRUE
 16317*           MOVE 1               TO DC-OPTION-CODE
 16318            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16319            IF DATE-CONVERSION-ERROR
 16320               NEXT SENTENCE
 16321             ELSE
 16322                IF DC-ELAPSED-DAYS GREATER +60
 16323                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16324
 16325     IF PB-COMPANY-ID EQUAL 'CDC'
 16326        IF AH-COVERAGE-CANCELLED
 16327           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16328            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16329            MOVE PB-C-AH-CANCEL-DT
 16330                                 TO DC-BIN-DATE-2
 16331            MOVE +0              TO DC-ELAPSED-DAYS
 16332                                    DC-ELAPSED-MONTHS
 16333            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16334*           MOVE 1               TO DC-OPTION-CODE
 16335            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 295
* EL050.cbl
 16336            IF DATE-CONVERSION-ERROR
 16337               NEXT SENTENCE
 16338             ELSE
 16339                IF DC-ELAPSED-DAYS GREATER +60
 16340                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16341
 16342     MOVE +0                     TO DC-ELAPSED-DAYS
 16343                                    DC-ELAPSED-MONTHS.
 16344
 16345     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16346        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16347          MOVE 'Z'                TO PB-CI-OB-FLAG
 16348          MOVE ER-2767            TO WS-ERROR
 16349          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16350          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16351          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16352          GO TO 3775-OVER-REF-CHK
 16353        ELSE
 16354          MOVE ZEROS              TO PB-CI-LIVES
 16355                                     PB-C-LIVES
 16356          IF PB-CI-OB-FLAG NOT = 'B'
 16357             MOVE SPACE           TO PB-CI-OB-FLAG.
 16358
 16359     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16360         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16361     ELSE
 16362         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16363
 16364     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16365        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16366            MOVE ER-2760         TO WS-ERROR
 16367            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16368
 16369     IF LF-COVERAGE-CANCELLED
 16370        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16371         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16372            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16373               MOVE ER-2774       TO WS-ERROR
 16374               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16375
 16376     IF AH-COVERAGE-CANCELLED
 16377        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16378         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16379            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16380               MOVE ER-2775       TO WS-ERROR
 16381               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16382
 16383     IF LF-COVERAGE-CANCELLED
 16384        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16385         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16386            MOVE ER-2776         TO WS-ERROR
 16387            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16388
 16389     IF AH-COVERAGE-CANCELLED
 16390        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16391         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16392            MOVE ER-2777         TO WS-ERROR
 16393            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 296
* EL050.cbl
 16394
 16395     IF LF-COVERAGE-CANCELLED
 16396        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16397        if pb-ci-lf-expire-dt = low-values or spaces
 16398           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16399           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16400           MOVE PB-CI-EXTENTION-DAYS
 16401                                 TO DC-ELAPSED-DAYS
 16402           SET BIN-PLUS-ELAPSED  TO TRUE
 16403           PERFORM 8500-DATE-CONVERT
 16404                                 THRU 8500-EXIT
 16405           IF DATE-CONVERSION-ERROR
 16406              move low-values    to dc-bin-date-2
 16407           end-if
 16408        else
 16409           move pb-ci-lf-expire-dt
 16410                                 to dc-bin-date-2
 16411        end-if
 16412        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16413           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16414                             OR  'FIA'
 16415              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16416           ELSE
 16417              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16418              MOVE ER-2731       TO WS-ERROR
 16419              PERFORM 9900-ERROR-FORMAT
 16420                                 THRU 9900-EXIT
 16421           end-if
 16422        end-if
 16423     end-if
 16424*    IF LF-COVERAGE-CANCELLED
 16425*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16426*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16427*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16428*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16429*        SET BIN-PLUS-ELAPSED      TO TRUE
 16430*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16431*        IF DATE-CONVERSION-ERROR
 16432*           NEXT SENTENCE
 16433*         ELSE
 16434*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16435*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16436*                            OR  'FIA'
 16437*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16438*              ELSE
 16439*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16440*               MOVE ER-2731       TO WS-ERROR
 16441*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16442     .
 16443 3705-EDIT-AH-CANCEL-DT.
 16444     IF AH-COVERAGE-CANCELLED
 16445        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16446        if pb-ci-AH-expire-dt = low-values or spaces
 16447           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16448           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16449           MOVE PB-CI-EXTENTION-DAYS
 16450                                 TO DC-ELAPSED-DAYS
 16451           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 297
* EL050.cbl
 16452           PERFORM 8500-DATE-CONVERT
 16453                                 THRU 8500-EXIT
 16454           IF DATE-CONVERSION-ERROR
 16455              move low-values    to dc-bin-date-2
 16456           end-if
 16457        else
 16458           move pb-ci-ah-expire-dt
 16459                                 to dc-bin-date-2
 16460        end-if
 16461        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16462           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16463                             OR  'FIA'
 16464              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16465           ELSE
 16466              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16467              MOVE ER-2771       TO WS-ERROR
 16468              PERFORM 9900-ERROR-FORMAT
 16469                                 THRU 9900-EXIT
 16470           end-if
 16471        end-if
 16472     end-if
 16473*    IF AH-COVERAGE-CANCELLED
 16474*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16475*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16476*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16477*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16478**       MOVE 6                    TO DC-OPTION-CODE
 16479*        SET BIN-PLUS-ELAPSED      TO TRUE
 16480*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16481*        IF DATE-CONVERSION-ERROR
 16482*           NEXT SENTENCE
 16483*         ELSE
 16484*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16485*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16486*                             OR 'FIA'
 16487*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16488*             ELSE
 16489*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16490*              MOVE ER-2771       TO WS-ERROR
 16491*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492     .
 16493 3705-EDIT-CONTINUED.
 16494
 16495*    IF LF-COVERAGE-CANCELLED
 16496*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16497*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16498*            MOVE ER-2727         TO WS-ERROR
 16499*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16500*
 16501*    IF AH-COVERAGE-CANCELLED
 16502*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16503*        IF PB-COMPANY-ID = 'ACE'
 16504*           MOVE ER-2727        TO WS-ERROR
 16505*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16506*        ELSE
 16507*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16508*              MOVE ER-2727     TO WS-ERROR
 16509*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 298
* EL050.cbl
 16510
 16511     IF PB-COMPANY-ID = 'ACE'
 16512       IF AH-COVERAGE-CANCELLED
 16513         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16514           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16515              MOVE ER-2732      TO WS-ERROR
 16516              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16517
 16518     IF PB-COMPANY-ID      EQUAL   'HER'
 16519        IF WS-ERROR        EQUAL   ER-2727
 16520            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16521            MOVE  ER-2725          TO  WS-ERROR
 16522            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16523
 16524     IF PB-C-CLAIM-CREATED-CANCEL
 16525            MOVE ER-2748         TO WS-ERROR
 16526            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16527
 16528     IF PB-C-LAST-NAME NOT = SPACES
 16529         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16530            MOVE ER-2747         TO WS-ERROR
 16531            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16532
 16533 3710-EDIT-LUMP-SUM-PRIOR.
 16534
 16535     IF AH-COVERAGE-CANCELLED
 16536         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16537             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16538                MOVE ER-2735    TO WS-ERROR
 16539                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16540
 16541     IF LF-COVERAGE-CANCELLED
 16542         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16543             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16544                MOVE ER-2735    TO WS-ERROR
 16545                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16546
 16547 3710-EDIT-PRIOR-DEATH.
 16548
 16549*    IF LF-COVERAGE-CANCELLED
 16550*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16551*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16552*           (NOT PB-CI-OB)
 16553*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16554*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16555*                   MOVE ER-2732  TO WS-ERROR
 16556*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16557*
 16558*    IF AH-COVERAGE-CANCELLED
 16559*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16560*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16561*           (NOT PB-CI-OB)
 16562*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16563*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16564*                   MOVE ER-2732  TO WS-ERROR
 16565*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16566
 16567     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 299
* EL050.cbl
 16568         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16569            (NOT PB-COMP-LF-CANCEL)
 16570             NEXT SENTENCE
 16571         ELSE
 16572           IF PB-C-LF-CANCEL-VOIDED
 16573              NEXT SENTENCE
 16574           ELSE
 16575              MOVE ER-2753      TO WS-ERROR
 16576              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16577
 16578     IF CANCEL-FUTURE-DT
 16579         GO TO 3999-END-EDIT.
 16580
 16581 3715-GET-REMAIN-TERM-LF.
 16582
 16583     IF NO-LF-BENEFIT-MATCH  OR
 16584        WS-LF-BENEFIT-CD = ZEROS
 16585        GO TO 3730-GET-AH-REMAIN-TERM.
 16586
 16587     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16588     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16589     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16590     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16591     MOVE PB-SV-STATE            TO CP-STATE.
 16592     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16593     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16594     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16595     MOVE '2'                    TO CP-PROCESS-TYPE.
 16596     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16597     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16598     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16599     IF (PB-COMPANY-ID = 'CID')
 16600        AND (CP-STATE-STD-ABBRV = 'WI')
 16601        MOVE '7'                 TO CP-REM-TERM-METHOD
 16602        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16603     ELSE
 16604        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16605        MOVE WS-REM-TRM-CALC-OPTION
 16606                                 TO CP-REM-TRM-CALC-OPTION
 16607     END-IF
 16608**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16609     IF (PB-COMPANY-ID = 'CID')
 16610        AND (CP-STATE-STD-ABBRV = 'MO')
 16611        AND (PB-CERT-EFF-DT >= X'9B41')
 16612        AND (PB-CERT-EFF-DT <= X'A2FB')
 16613        MOVE '7'                 TO CP-REM-TERM-METHOD
 16614        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16615     END-IF
 16616     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16617                                    CP-LOAN-TERM.
 16618     IF CP-TRUNCATED-LIFE
 16619        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16620
 16621     IF CP-TERM-IS-DAYS
 16622         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16623     ELSE
 16624         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16625
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 300
* EL050.cbl
 16626     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16627
 16628     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16629
 16630     IF LF-COVERAGE-CANCELLED
 16631        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16632        NEXT SENTENCE
 16633      ELSE
 16634          GO TO 3730-GET-AH-REMAIN-TERM.
 16635
 16636 3720-GET-LF-REFUND.
 16637
 16638     IF PB-C-LF-CANCEL-VOIDED
 16639        GO TO 3730-GET-AH-REMAIN-TERM
 16640     end-if
 16641
 16642     IF PB-COMPANY-ID EQUAL 'BOA'
 16643         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16644         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16645         GO TO 3730-GET-AH-REMAIN-TERM.
 16646
 16647     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16648        (WS-AH-SPECIAL-CALC-CD = 'M')
 16649         MOVE ER-2767            TO WS-ERROR
 16650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16651         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16652         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16653         GO TO 3780-UPDATE-CANCEL-CERT.
 16654
 16655*    if (ws-lf-earnings-calc = '6')
 16656*       or (pb-c-lf-refund-override = '6')
 16657*       move cp-remaining-term-1 to cp-remaining-term-2
 16658*    end-if
 16659     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16660
 16661     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16662     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16663     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16664     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16665     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16666     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16667     IF PB-COMPANY-ID = 'DCC'
 16668        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16669        IF PDEF-MASTER-FOUND
 16670           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16671              (V1 > +8)
 16672              OR (PD-PROD-CODE (V1) = 'L')
 16673           END-PERFORM
 16674           IF V1 < +9
 16675              MOVE PD-MAX-AMT (V1)
 16676                           TO CP-R-MAX-TOT-BEN
 16677                              EC-AM-LF-MAX-TOT-BEN
 16678           END-IF
 16679        ELSE
 16680        MOVE ' '                 TO PDEF-MASTER-SW
 16681        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16682        MOVE PB-STATE            TO ERPDEF-STATE
 16683        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 301
* EL050.cbl
 16684           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16685        END-IF
 16686        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16687        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16688        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16689        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16690        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16691        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16692        IF PDEF-MASTER-FOUND
 16693           MOVE 'N'              TO PDEF-MASTER-SW
 16694           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16695           IF PDEF-MASTER-FOUND
 16696              IF (ERPDEF-KEY-SAVE (1:16) =
 16697                           PD-CONTROL-PRIMARY (1:16))
 16698                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16699                 CONTINUE
 16700              ELSE
 16701                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16702                 IF (ERPDEF-KEY-SAVE (1:16) =
 16703                           PD-CONTROL-PRIMARY (1:16))
 16704                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16705                    CONTINUE
 16706                 ELSE
 16707                    MOVE 'N'     TO PDEF-MASTER-SW
 16708                 END-IF
 16709              END-IF
 16710
 16711              IF PDEF-MASTER-FOUND
 16712                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16713                    (V1 > +8)
 16714                    OR (PD-PROD-CODE (V1) = 'L')
 16715                 END-PERFORM
 16716                 IF V1 < +9
 16717                    MOVE PD-MAX-AMT (V1)
 16718                                 TO CP-R-MAX-TOT-BEN
 16719                                    EC-AM-LF-MAX-TOT-BEN
 16720                 END-IF
 16721              END-IF
 16722           END-IF
 16723           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16724        END-IF
 16725        END-IF
 16726     END-IF
 16727     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16728
 16729     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16730
 16731     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16732                                    PB-C-LF-REM-TERM.
 16733
 16734     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16735     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16736
 16737     IF PB-COMPANY-ID EQUAL 'FLC'
 16738        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16739           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16740           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16741                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 302
* EL050.cbl
 16742                    - CM-LF-ITD-DEATH-AMT
 16743           IF PB-C-LF-REF-CALC LESS THAN +0
 16744              MOVE +0            TO PB-C-LF-REF-CALC
 16745              GO TO 3730-GET-AH-REMAIN-TERM
 16746           ELSE
 16747              GO TO 3730-GET-AH-REMAIN-TERM.
 16748
 16749     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16750                            OR '4' OR '5' OR '6' OR '8'
 16751                            OR '9' OR 'G'
 16752        MOVE PB-C-LF-REFUND-OVERRIDE
 16753                                 TO CP-EARNING-METHOD.
 16754
 16755     if pb-company-id = 'AHL'
 16756        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16757        if cp-class-code = spaces
 16758           move zeros            to cp-class-code
 16759        end-if
 16760     ELSE
 16761        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16762     END-IF
 16763*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16764     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16765     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16766                                    CP-RATING-BENEFIT-AMT.
 16767     IF CP-STATE-STD-ABBRV = 'OR'
 16768         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16769                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16770     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16771     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16772     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16773     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16774     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16775     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16776     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16777     IF WS-DEFAULT-APR NOT NUMERIC
 16778         MOVE ZEROS TO WS-DEFAULT-APR.
 16779****   N O T E   ****
 16780*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16781*      THE OH HARD CODING IN ELCRFNDP
 16782
 16783     IF PB-COMPANY-ID = 'CID'
 16784        IF CP-STATE-STD-ABBRV = 'OH'
 16785           MOVE WS-LF-EARNINGS-CALC
 16786                                 TO CP-EARNING-METHOD
 16787        END-IF
 16788     END-IF
 16789
 16790****   N O T E   ****
 16791
 16792*    IF CP-EARN-AS-NET-PAY
 16793*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16794*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16795*               MOVE WS-DEFAULT-APR
 16796*                                TO  CP-LOAN-APR
 16797*               MOVE ER-3780     TO  WS-ERROR
 16798*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16799*           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 303
* EL050.cbl
 16800*               MOVE ER-3781     TO  WS-ERROR
 16801*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16802*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16803     move ' '                    to cp-ext-days-calc
 16804     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16805
 16806     IF CP-REFUND-TYPE-USED NOT = SPACE
 16807         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16808
 16809     IF CP-ERROR-RATE-IS-ZERO OR
 16810        CP-ERROR-RATE-NOT-FOUND
 16811        MOVE ER-2740             TO WS-ERROR
 16812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16813
 16814     IF CP-ERROR-RATE-FILE-NOTOPEN
 16815        MOVE ER-2617             TO WS-ERROR
 16816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16817
 16818     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16819        AND PB-CI-ENTRY-STATUS = 'M'
 16820        MOVE +0                  TO PB-C-LF-REF-CALC
 16821     ELSE
 16822        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16823     END-IF
 16824
 16825     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16826         GO TO 3730-GET-AH-REMAIN-TERM.
 16827
 16828*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16829*       ADD +1                   TO PB-C-LF-REM-TERM
 16830*                                   CP-REMAINING-TERM
 16831*                                   CP-ORIGINAL-TERM.
 16832
 16833     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16834     MOVE '2'                    TO CP-EARNING-METHOD
 16835                                    CP-RATING-METHOD.
 16836     IF PB-COMPANY-ID = 'CID'
 16837        IF (CP-STATE-STD-ABBRV = 'MN')
 16838           AND (PB-CERT-EFF-DT > X'A4FF')
 16839           AND (WS-LF-EARNINGS-CALC = 'B')
 16840           MOVE '5'              TO CP-EARNING-METHOD
 16841           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16842        END-IF
 16843     END-IF
 16844     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16845                                        CP-REMAINING-BENEFIT
 16846                                        CP-RATING-BENEFIT-AMT.
 16847     IF CP-STATE-STD-ABBRV = 'OR'
 16848         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16849                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16850     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16851     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16852
 16853     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16854
 16855     IF CP-ERROR-RATE-IS-ZERO OR
 16856        CP-ERROR-RATE-NOT-FOUND
 16857        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 304
* EL050.cbl
 16858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16859
 16860     IF CP-ERROR-RATE-FILE-NOTOPEN
 16861        MOVE ER-2617             TO WS-ERROR
 16862        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16863
 16864     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16865
 16866******************************************************************
 16867
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 305
* EL050.cbl
 16869 3730-GET-AH-REMAIN-TERM.
 16870     IF NO-AH-BENEFIT-MATCH  OR
 16871        WS-AH-BENEFIT-CD = ZEROS
 16872         GO TO 3770-CHECK-REFUNDS.
 16873
 16874     IF PB-CI-AH-LUMP-SUM-DISAB
 16875         IF  PB-C-AH-CANCEL-AMT = ZERO
 16876            IF NOT PB-COMP-AH-CANCEL
 16877             GO TO 3770-CHECK-REFUNDS.
 16878
 16879     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16880     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16881     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16882     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16883     MOVE PB-SV-STATE            TO CP-STATE.
 16884     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16885     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16886     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16887     MOVE '2'                    TO CP-PROCESS-TYPE.
 16888     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16889     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16890     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16891     IF (PB-COMPANY-ID = 'CID')
 16892        AND (CP-STATE-STD-ABBRV = 'WI')
 16893        MOVE '7'                 TO CP-REM-TERM-METHOD
 16894        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16895     ELSE
 16896        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16897        MOVE WS-REM-TRM-CALC-OPTION
 16898                                 TO CP-REM-TRM-CALC-OPTION
 16899     END-IF
 16900     IF (PB-COMPANY-ID = 'CID')
 16901        AND (CP-STATE-STD-ABBRV = 'MO')
 16902        AND (PB-CERT-EFF-DT >= X'9B41')
 16903        AND (PB-CERT-EFF-DT <= X'A2FB')
 16904        MOVE '7'                 TO CP-REM-TERM-METHOD
 16905        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16906     END-IF
 16907     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16908                                    CP-LOAN-TERM.
 16909     IF NOT CP-TERM-IS-DAYS
 16910         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16911
 16912     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16913
 16914     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16915
 16916     IF AH-COVERAGE-CANCELLED
 16917        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16918        NEXT SENTENCE
 16919      ELSE
 16920         GO TO 3770-CHECK-REFUNDS.
 16921
 16922 3740-GET-AH-REFUND.
 16923
 16924     IF PB-C-AH-CANCEL-VOIDED
 16925        GO TO 3780-UPDATE-CANCEL-CERT
 16926     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 306
* EL050.cbl
 16927
 16928     IF PB-COMPANY-ID = 'BOA'
 16929         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16930         GO TO 3770-CHECK-REFUNDS.
 16931
 16932     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16933*    MOVE ' '                    TO DC-OPTION-CODE
 16934     SET BIN-TO-GREG             TO TRUE
 16935     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16936     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16937                                    PB-C-AH-REM-TERM.
 16938     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16939     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16940
 16941     IF PB-COMPANY-ID EQUAL 'FLC'
 16942        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16943           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16944           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16945                    - CM-AH-ITD-AH-PMT)
 16946           IF PB-C-AH-REF-CALC LESS THAN +0
 16947              MOVE +0            TO PB-C-AH-REF-CALC
 16948              GO TO 3770-CHECK-REFUNDS
 16949           ELSE
 16950              GO TO 3770-CHECK-REFUNDS.
 16951
 16952     IF PB-COMPANY-ID = 'DCC'
 16953        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16954            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16955           MOVE 'S'              TO CP-EARNING-METHOD
 16956        END-IF
 16957     END-IF
 16958     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16959                            OR '4' OR '5' OR '6' OR '8'
 16960                            OR '9' OR 'G' OR 'S'
 16961        MOVE PB-C-AH-REFUND-OVERRIDE
 16962                                 TO CP-EARNING-METHOD.
 16963
 16964     if pb-company-id = 'AHL'
 16965        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16966        if cp-class-code = spaces
 16967           move zeros            to cp-class-code
 16968        end-if
 16969     ELSE
 16970        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16971     END-IF
 16972*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16973     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16974     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16975                                    CP-RATING-BENEFIT-AMT.
 16976     IF CP-STATE-STD-ABBRV = 'OR'
 16977         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16978                                         PB-CI-AH-TERM.
 16979     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16980     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16981     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16982     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16983     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16984     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 307
* EL050.cbl
 16985
 16986     IF CP-STATE-STD-ABBRV = 'OH'
 16987        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16988                                AND 'CID' AND 'DCC' and 'VPP'
 16989                                AND 'AHL')
 16990           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16991              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16992              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16993              MOVE '6' TO CP-EARNING-METHOD
 16994           END-IF
 16995        END-IF
 16996        IF PB-COMPANY-ID = 'CID'
 16997           IF NO-LIFE-COVERAGE
 16998              IF CP-CRITICAL-PERIOD
 16999                 MOVE '2'       TO CP-EARNING-METHOD
 17000              ELSE
 17001                 MOVE '6'       TO CP-EARNING-METHOD
 17002              END-IF
 17003           ELSE
 17004              IF WS-LF-COVERAGE-TYPE = 'L'
 17005                 MOVE '2'       TO CP-EARNING-METHOD
 17006              ELSE
 17007                 IF (PB-CI-LF-TERM > +60) OR
 17008                    (WS-LF-EARNINGS-CALC = '5')
 17009                    IF CP-CRITICAL-PERIOD
 17010                       MOVE '2'  TO CP-EARNING-METHOD
 17011                    ELSE
 17012                       MOVE '6'  TO CP-EARNING-METHOD
 17013                    END-IF
 17014                 ELSE
 17015                    MOVE '1'     TO CP-EARNING-METHOD
 17016                 END-IF
 17017              END-IF
 17018           END-IF
 17019        END-IF
 17020     END-IF
 17021
 17022*    IF CP-STATE-STD-ABBRV = 'VA'
 17023*       IF DC-GREG-DATE-CYMD GREATER 19921231
 17024*          IF CP-ORIGINAL-TERM GREATER 61
 17025*             MOVE '6' TO CP-EARNING-METHOD
 17026*          ELSE
 17027*             MOVE '1' TO CP-EARNING-METHOD.
 17028
 17029     IF WS-DEFAULT-APR NOT NUMERIC
 17030         MOVE ZEROS TO WS-DEFAULT-APR.
 17031     IF CP-EARN-AS-NET-PAY
 17032         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17033            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17034                MOVE WS-DEFAULT-APR
 17035                                 TO  CP-LOAN-APR
 17036                MOVE ER-3780     TO  WS-ERROR
 17037                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17038            ELSE
 17039                MOVE ER-3781     TO  WS-ERROR
 17040                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17041     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17042     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 308
* EL050.cbl
 17043        AND CP-CANCEL-REASON = 'R'
 17044        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17045        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17046     END-IF
 17047     IF PB-COMPANY-ID = 'DCC'
 17048        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17049        AND (CP-EARNING-METHOD = 'D')
 17050        AND (CP-CANCEL-REASON NOT = 'R')
 17051        CONTINUE
 17052     ELSE
 17053        GO TO 3750-CONTINUE
 17054     END-IF
 17055     MOVE ' '                    TO DD-IU-SW
 17056     IF NOT PDEF-MASTER-FOUND
 17057        MOVE ' '                 TO PDEF-MASTER-SW
 17058        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17059        MOVE PB-STATE            TO ERPDEF-STATE
 17060        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17061           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17062        END-IF
 17063        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17064        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17065        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17066        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17067        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17068        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17069        IF PDEF-MASTER-FOUND
 17070           MOVE 'N'              TO PDEF-MASTER-SW
 17071           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17072           IF PDEF-MASTER-FOUND
 17073              IF (ERPDEF-KEY-SAVE (1:16) =
 17074                           PD-CONTROL-PRIMARY (1:16))
 17075                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17076                 CONTINUE
 17077              ELSE
 17078                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17079                 IF (ERPDEF-KEY-SAVE (1:16) =
 17080                           PD-CONTROL-PRIMARY (1:16))
 17081                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17082                    CONTINUE
 17083                 ELSE
 17084                    MOVE ER-2740 TO WS-ERROR
 17085                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17086                    GO TO 3770-CHECK-REFUNDS
 17087                 END-IF
 17088              END-IF
 17089           END-IF
 17090           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17091        END-IF
 17092     END-IF
 17093     IF PDEF-MASTER-FOUND
 17094        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17095           (V1 > +8)
 17096           OR (PD-PROD-CODE (V1) = 'I')
 17097        END-PERFORM
 17098        IF V1 < +9
 17099           SET DD-IU-PRESENT        TO TRUE
 17100        END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 309
* EL050.cbl
 17101        IF WS-AH-DCC-TRUNC = 'T'
 17102           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17103        ELSE
 17104           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17105        END-IF
 17106        EVALUATE TRUE
 17107           WHEN WS-TERM > +168
 17108              MOVE 15               TO V1
 17109           WHEN WS-TERM > +156
 17110              MOVE 14               TO V1
 17111           WHEN WS-TERM > +144
 17112              MOVE 13               TO V1
 17113           WHEN WS-TERM > +132
 17114              MOVE 12               TO V1
 17115           WHEN WS-TERM > +120
 17116              MOVE 11               TO V1
 17117           WHEN WS-TERM > +108
 17118              MOVE 10               TO V1
 17119           WHEN WS-TERM > +96
 17120              MOVE 9                TO V1
 17121           WHEN WS-TERM > +84
 17122              MOVE 8                TO V1
 17123           WHEN WS-TERM > +72
 17124              MOVE 7                TO V1
 17125           WHEN WS-TERM > +60
 17126              MOVE 6                TO V1
 17127           WHEN WS-TERM > +48
 17128              MOVE 5                TO V1
 17129           WHEN WS-TERM > +36
 17130              MOVE 4                TO V1
 17131           WHEN WS-TERM > +24
 17132              MOVE 3                TO V1
 17133           WHEN WS-TERM > +12
 17134              MOVE 2                TO V1
 17135           WHEN OTHER
 17136              MOVE 1                TO V1
 17137        END-EVALUATE
 17138
 17139        EVALUATE TRUE
 17140*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17141*             < +13)
 17142*             AND (DD-IU-PRESENT)
 17143*             MOVE 2                TO V2
 17144*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17145*             MOVE 1                TO V2
 17146           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17147              MOVE 2                TO V2
 17148           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17149              MOVE 3                TO V2
 17150           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17151              MOVE 4                TO V2
 17152           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17153              MOVE 5                TO V2
 17154           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17155              MOVE 6                TO V2
 17156           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17157              MOVE 7                TO V2
 17158           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 310
* EL050.cbl
 17159              MOVE 8                TO V2
 17160           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17161              MOVE 9                TO V2
 17162           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17163              MOVE 10               TO V2
 17164           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17165              MOVE 11               TO V2
 17166           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17167              MOVE 12               TO V2
 17168           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17169              MOVE 13               TO V2
 17170           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17171              MOVE 14               TO V2
 17172           WHEN OTHER
 17173              MOVE 15               TO V2
 17174        END-EVALUATE
 17175
 17176        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17177                                 TO CP-DDF-LO-FACT
 17178        MOVE PD-UEP-FACTOR (V1 V2)
 17179                                 TO CP-DDF-HI-FACT
 17180
 17181        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17182        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17183        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17184           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17185        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17186        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17187        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17188           + PD-1ST-YR-ADMIN-ALLOW
 17189
 17190        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17191*       IF PI-CLP-YN = 'Y'
 17192*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17193*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17194*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17195*       END-IF
 17196
 17197        IF DD-IU-PRESENT
 17198           MOVE 'I'              TO CP-EARNING-METHOD
 17199        END-IF
 17200        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17201                                     CP-CLP-RATE-UP
 17202        IF CP-IU-RATE-UP NOT = ZEROS
 17203           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17204              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17205           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17206              / (1 - WS-WORK-FACT)
 17207        END-IF
 17208     END-IF
 17209     .
 17210 3750-CONTINUE.
 17211     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17212
 17213     IF CP-REFUND-TYPE-USED NOT = SPACE
 17214         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17215
 17216     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 311
* EL050.cbl
 17217        CP-ERROR-RATE-NOT-FOUND
 17218        MOVE ER-2740             TO WS-ERROR
 17219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17220
 17221     IF CP-ERROR-RATE-FILE-NOTOPEN
 17222        MOVE ER-2617             TO WS-ERROR
 17223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17224     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17225        AND (PB-CI-ENTRY-STATUS = 'M')
 17226        MOVE +0                  TO PB-C-AH-REF-CALC
 17227     ELSE
 17228        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17229     END-IF
 17230     if pb-company-id = 'VPP'
 17231        MOVE cm-ah-clp           to cp-original-premium
 17232        move zeros               to cp-calc-refund
 17233        perform 7600-get-refund  thru 7600-exit
 17234        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17235           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17236        else
 17237           move zeros            to pb-c-ah-rfnd-clp
 17238        end-if
 17239        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17240           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17241           pb-ci-cancel-fee
 17242     end-if
 17243     IF PB-COMPANY-ID = 'DCC'
 17244        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17245        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17246        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17247        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17248        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17249        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17250        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17251        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17252*       if pb-c-cancel-amt < +0
 17253*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17254*       end-if
 17255*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17256     END-IF
 17257     .
 17258 3770-CHECK-REFUNDS.
 17259
 17260     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17261        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17262           MOVE ER-2766          TO WS-ERROR
 17263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17264           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17265           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17266              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17267
 17268     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17269        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17270           MOVE ER-2766          TO WS-ERROR
 17271           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17272           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17273           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17274              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 312
* EL050.cbl
 17275
 17276     IF PB-COMP-LF-CANCEL
 17277        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17278        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17279           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17280              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17281
 17282     IF PB-COMP-AH-CANCEL
 17283        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17284        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17285           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17286              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17287
 17288     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17289             GIVING WS-UNSIGN-WRK1
 17290     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17291             GIVING WS-UNSIGN-WRK2.
 17292
 17293     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17294         MOVE ZERO TO WS-UNSIGN-WRK1.
 17295
 17296     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17297         MOVE ZERO TO WS-UNSIGN-WRK2.
 17298
 17299     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17300
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 313
* EL050.cbl
 17302
 17303 3772-CONTINUE.
 17304
 17305**********************************
 17306*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17307*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17308*** DOUBLES THE TOLERANCE AMOUNT.
 17309***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17310**********************************
 17311     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17312     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17313         IF WS-REF-REJECT-SW = SPACE
 17314             MOVE ER-2754        TO WS-ERROR
 17315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17316           ELSE
 17317             MOVE ER-2736        TO WS-ERROR
 17318             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17319**********************************
 17320
 17321 3773-CONTINUE.
 17322
 17323     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17324        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17325           MOVE ER-2723          TO WS-ERROR
 17326           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17327
 17328     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17329        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17330           MOVE ER-2724          TO WS-ERROR
 17331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17332
 17333     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17334         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17335             (1 + WS-LF-REFUND-OVS-PCT)
 17336     ELSE
 17337         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17338
 17339     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17340         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17341             (1 - WS-TOL-LF-REFUND-PCT)
 17342     ELSE
 17343         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17344
 17345     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17346        AND (PB-CI-ENTRY-STATUS = 'M')
 17347        AND (PB-C-LF-CANCEL-AMT > +0)
 17348        MOVE ER-3843             TO WS-ERROR
 17349        PERFORM 9900-ERROR-FORMAT
 17350                                 THRU 9900-EXIT
 17351     END-IF
 17352     EVALUATE TRUE
 17353        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17354           CONTINUE
 17355        WHEN PB-C-LF-CANCEL-AMT = +0
 17356                 AND PB-C-LF-REF-CALC > +0
 17357           CONTINUE
 17358        WHEN WS-LF-REFUND-OVS-AMT = 0
 17359                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 314
* EL050.cbl
 17360           CONTINUE
 17361        WHEN OTHER
 17362           IF WS-TOL-LF-REFUND  = +0
 17363              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17364           END-IF
 17365           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17366                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17367                          (PB-C-LF-CANCEL-AMT))
 17368              CONTINUE
 17369           ELSE
 17370              IF WS-LF-REFUND-OVS-AMT = +0
 17371                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17372              END-IF
 17373              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17374                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17375                                       PB-C-LF-CANCEL-AMT)
 17376                 CONTINUE
 17377              ELSE
 17378                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17379                   MOVE ER-2754   TO  WS-ERROR
 17380                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17381                 ELSE
 17382                    MOVE ER-2736   TO  WS-ERROR
 17383                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17384                 END-IF
 17385              END-IF
 17386           END-IF
 17387     END-EVALUATE.
 17388
 17389     EVALUATE TRUE
 17390        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17391           CONTINUE
 17392        WHEN PB-C-LF-CANCEL-AMT = +0
 17393                 AND PB-C-LF-REF-CALC > +0
 17394           CONTINUE
 17395        WHEN OTHER
 17396           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17397               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17398              CONTINUE
 17399           ELSE
 17400              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17401               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17402                CONTINUE
 17403              ELSE
 17404                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17405                     MOVE ER-2754   TO  WS-ERROR
 17406                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17407                 ELSE
 17408                     MOVE ER-2736   TO  WS-ERROR
 17409                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17410                 END-IF
 17411              END-IF
 17412           END-IF
 17413     END-EVALUATE.
 17414
 17415     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17416         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17417             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 315
* EL050.cbl
 17418     ELSE
 17419         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17420
 17421     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17422         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17423             (1 - WS-TOL-AH-REFUND-PCT)
 17424     ELSE
 17425         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17426
 17427     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17428        AND (PB-CI-ENTRY-STATUS = 'M')
 17429        AND (PB-C-AH-CANCEL-AMT > +0)
 17430        MOVE ER-3843             TO WS-ERROR
 17431        PERFORM 9900-ERROR-FORMAT
 17432                                 THRU 9900-EXIT
 17433     END-IF
 17434     EVALUATE TRUE
 17435        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17436           CONTINUE
 17437*       WHEN PB-C-AH-REF-CALC = +0 AND
 17438*                  PB-C-AH-CANCEL-AMT > +0
 17439        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17440                   PB-C-AH-REF-CALC > +0
 17441           CONTINUE
 17442        WHEN WS-AH-REFUND-OVS-AMT = +0
 17443                AND WS-TOL-AH-REFUND = +0
 17444           CONTINUE
 17445        WHEN OTHER
 17446           IF WS-TOL-AH-REFUND = +0
 17447              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17448           END-IF
 17449           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17450               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17451                                         PB-C-AH-CANCEL-AMT)
 17452              CONTINUE
 17453           ELSE
 17454              IF WS-AH-REFUND-OVS-AMT = +0
 17455                 MOVE +9999999.99 TO
 17456                         WS-AH-REFUND-OVS-AMT
 17457              END-IF
 17458              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17459                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17460                                         PB-C-AH-CANCEL-AMT)
 17461                 CONTINUE
 17462              ELSE
 17463                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17464                    MOVE ER-2754   TO  WS-ERROR
 17465                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17466                 ELSE
 17467                    MOVE ER-2736   TO  WS-ERROR
 17468                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17469                 END-IF
 17470              END-IF
 17471           END-IF
 17472     END-EVALUATE.
 17473
 17474     EVALUATE TRUE
 17475        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 316
* EL050.cbl
 17476           CONTINUE
 17477*       WHEN PB-C-AH-REF-CALC > +0 AND
 17478*                  PB-C-AH-CANCEL-AMT = +0
 17479        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17480                   PB-C-AH-REF-CALC = +0
 17481           CONTINUE
 17482        WHEN OTHER
 17483           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17484               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17485              CONTINUE
 17486           ELSE
 17487              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17488                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17489                 CONTINUE
 17490              ELSE
 17491                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17492                     MOVE ER-2754   TO  WS-ERROR
 17493                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17494                 ELSE
 17495                     MOVE ER-2736   TO  WS-ERROR
 17496                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17497                 END-IF
 17498              END-IF
 17499           END-IF
 17500     END-EVALUATE.
 17501
 17502     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17503        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17504        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17505           AND  PB-C-LF-REF-CALC < +1.00
 17506           AND  PB-C-AH-REF-CALC < +1.00
 17507           CONTINUE
 17508        ELSE
 17509           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17510              AND (PB-CI-ENTRY-STATUS = 'M')
 17511              CONTINUE
 17512           ELSE
 17513              MOVE ER-2741       TO WS-ERROR
 17514              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17515           END-IF
 17516        END-IF
 17517     END-IF
 17518
 17519     IF (PB-C-LF-CANCEL-AMT = ZERO
 17520        AND WS-LF-BENEFIT-CD NOT = ZERO
 17521        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17522        AND PB-C-LF-REF-CALC NOT = ZERO)
 17523        OR
 17524        (PB-C-LF-CANCEL-AMT = ZERO
 17525        AND WS-LF-BENEFIT-CD NOT = ZERO
 17526        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17527             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17528                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17529                NEXT SENTENCE
 17530             ELSE
 17531                MOVE ER-2739        TO WS-ERROR
 17532                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17533
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 317
* EL050.cbl
 17534     IF (PB-C-AH-CANCEL-AMT = ZERO
 17535        AND WS-AH-BENEFIT-CD NOT = ZERO
 17536        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17537        AND PB-C-AH-REF-CALC NOT = ZERO)
 17538        OR
 17539        (PB-C-AH-CANCEL-AMT = ZERO
 17540        AND WS-AH-BENEFIT-CD NOT = ZERO
 17541        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17542             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17543                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17544                NEXT SENTENCE
 17545             ELSE
 17546                MOVE ER-2738        TO WS-ERROR
 17547                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17548
 17549 3775-OVER-REF-CHK.
 17550
 17551     IF PB-CI-ENTRY-STATUS = '5'
 17552        GO TO 3780-UPDATE-CANCEL-CERT.
 17553
 17554     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17555                              PB-CI-LF-ALT-PREMIUM-AMT.
 17556
 17557     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17558        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17559                                 PB-C-LF-REF-CALC
 17560      ELSE
 17561        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17562                                 PB-C-LF-CANCEL-AMT.
 17563
 17564     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17565        MOVE ER-2755             TO WS-ERROR
 17566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17567
 17568     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17569
 17570     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17571        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17572                                 PB-C-AH-REF-CALC
 17573      ELSE
 17574        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17575                                 PB-C-AH-CANCEL-AMT.
 17576
 17577     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17578        MOVE ER-2778             TO WS-ERROR
 17579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17580
 17581     IF PB-CI-OB-FLAG NOT = 'Z'
 17582        NEXT SENTENCE
 17583       ELSE
 17584         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17585            MOVE ER-2757           TO WS-ERROR
 17586            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17587
 17588 3780-UPDATE-CANCEL-CERT.
 17589
 17590     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17591        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 318
* EL050.cbl
 17592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17593
 17594     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17595         MOVE ER-2729              TO WS-ERROR
 17596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17597
 17598     IF PB-CI-LF-BENEFIT-CD = ZERO
 17599         GO TO 3780-UPDATE-CONT-1.
 17600
 17601     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17602         GO TO 3780-UPDATE-CONT-1.
 17603
 17604     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17605       AND
 17606        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17607       AND
 17608        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17609       AND
 17610        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17611            NEXT SENTENCE
 17612       ELSE
 17613        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17614          AND
 17615***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17616***       AND
 17617           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17618            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17619               MOVE ER-2730      TO WS-ERROR
 17620               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17621               GO TO 3999-END-EDIT
 17622            ELSE
 17623               GO TO 3999-END-EDIT
 17624        ELSE
 17625            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17626               MOVE ER-2765           TO WS-ERROR
 17627               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17628               GO TO 3785-CHECK-REF-INT.
 17629*              GO TO 3999-END-EDIT.
 17630
 17631 3780-UPDATE-CONT-1.
 17632     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17633
 17634     IF PB-CI-AH-BENEFIT-CD = ZERO
 17635         GO TO 3780-UPDATE-CONT-2.
 17636
 17637     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17638         GO TO 3780-UPDATE-CONT-2.
 17639
 17640     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17641
 17642     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17643       AND
 17644        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17645       AND
 17646        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17647       AND
 17648        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17649            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 319
* EL050.cbl
 17650       ELSE
 17651        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17652          AND
 17653***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17654***       AND
 17655           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17656           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17657            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17658               MOVE ER-2773      TO WS-ERROR
 17659               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17660               GO TO 3999-END-EDIT
 17661            ELSE
 17662               GO TO 3999-END-EDIT
 17663            END-IF
 17664           ELSE
 17665             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17666                IF MSTR-CERT-NO = W-CL-CERT-NO
 17667                   MOVE ER-2890 TO WS-ERROR
 17668                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17669                   GO TO 3999-END-EDIT
 17670                ELSE
 17671                   MOVE ER-2898 TO WS-ERROR
 17672                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17673                   GO TO 3999-END-EDIT
 17674                END-IF
 17675             ELSE
 17676                GO TO 3785-CHECK-REF-INT
 17677             END-IF
 17678           END-IF
 17679          ELSE
 17680            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17681              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17682                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17683                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17684                      MOVE ER-2890 TO WS-ERROR
 17685                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17686                      GO TO 3999-END-EDIT
 17687                   ELSE
 17688                      MOVE ER-2898 TO WS-ERROR
 17689                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17690                      GO TO 3999-END-EDIT
 17691                   END-IF
 17692                ELSE
 17693                   MOVE ER-2765 TO WS-ERROR
 17694                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17695                   GO TO 3785-CHECK-REF-INT
 17696                END-IF
 17697              ELSE
 17698               MOVE ER-2765      TO WS-ERROR
 17699               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17700               GO TO 3785-CHECK-REF-INT.
 17701*              GO TO 3999-END-EDIT.
 17702
 17703 3780-UPDATE-CONT-2.
 17704
 17705     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17706        AND WS-LF-BENEFIT-CD = ZERO
 17707           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 320
* EL050.cbl
 17708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17709
 17710     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17711        AND WS-AH-BENEFIT-CD = ZERO
 17712           MOVE ER-2744           TO WS-ERROR
 17713           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17714
 17715     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17716        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17717        AND
 17718        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17719         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17720           MOVE ER-2746           TO WS-ERROR
 17721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17722
 17723     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17724       AND
 17725        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17726             MOVE ER-2737        TO WS-ERROR
 17727             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17728
 17729     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17730       AND
 17731        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17732             MOVE ER-2737        TO WS-ERROR
 17733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17734
 17735     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17736         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17737             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17738             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17739         ELSE
 17740             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17741                 MOVE ER-2768    TO WS-ERROR
 17742                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17743             ELSE
 17744                 MOVE ER-2756    TO WS-ERROR
 17745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17746
 17747     IF CERT-PEND-ISSUE-RETURNED
 17748        MOVE ER-2772             TO WS-ERROR
 17749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17750 3785-CHECK-REF-INT.
 17751*    IF PB-STATE NOT = 'NH' and 'TN'
 17752     IF PB-STATE NOT = 'NH'
 17753        GO TO 3999-END-EDIT
 17754     END-IF
 17755
 17756     MOVE ER-2796                TO WS-ERROR
 17757     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17758     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17759        OR (CM-REF-INTERFACE-SW = 'Y')
 17760        MOVE ER-2793             TO WS-ERROR
 17761        PERFORM 9900-ERROR-FORMAT
 17762                                 THRU 9900-EXIT
 17763     END-IF
 17764     MOVE +0                     TO WS-PAYMENT-AMT
 17765     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 321
* EL050.cbl
 17766        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17767               PB-C-AH-CANCEL-DT
 17768           GO TO 3999-END-EDIT
 17769        END-IF
 17770     end-if
 17771***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17772***-_-
 17773***-_-   For TN it's only flat cancels
 17774***-_-
 17775***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17776     if pb-state = 'TN'
 17777        if ((pb-c-lf-cancel-dt <> low-values)
 17778           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17779                      or
 17780           ((pb-c-ah-cancel-dt <> low-values)
 17781           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17782           GO TO 3999-END-EDIT
 17783        END-IF
 17784     end-if
 17785     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17786        GO TO 3999-END-EDIT
 17787     END-IF
 17788***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17789***-_-
 17790***-_-   if cancel date within 15 days of effective date, bypass
 17791***-_-
 17792***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17793     IF PB-STATE NOT = 'NH'
 17794        GO TO 3785-CONTINUE
 17795     END-IF
 17796     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17797     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17798     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17799        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17800     END-IF
 17801     MOVE '1'                    TO DC-OPTION-CODE
 17802     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17803     IF NO-CONVERSION-ERROR
 17804        IF DC-ELAPSED-DAYS < +16
 17805           GO TO 3999-END-EDIT
 17806        END-IF
 17807     END-IF
 17808***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17809***-_-
 17810***-_-   if cancel date within 30 days of current date then
 17811***-_-   bypass else subtract 15 days from period
 17812***-_-
 17813***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17814     MOVE +0                     TO DC-ELAPSED-DAYS
 17815     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17816     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17817     MOVE '1'                    TO DC-OPTION-CODE
 17818     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17819     IF NO-CONVERSION-ERROR
 17820        IF DC-ELAPSED-DAYS > +30
 17821           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17822        ELSE
 17823           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 322
* EL050.cbl
 17824        END-IF
 17825     ELSE
 17826        GO TO 3999-END-EDIT
 17827     END-IF
 17828     .
 17829 3785-CONTINUE.
 17830     if pb-state = 'TN'
 17831        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17832        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17833        MOVE '1'                 TO DC-OPTION-CODE
 17834        PERFORM 8500-DATE-CONVERT
 17835                                 THRU 8500-EXIT
 17836        IF no-CONVERSION-ERROR
 17837           IF DC-ELAPSED-DAYS < +16
 17838              GO TO 3999-END-EDIT
 17839           END-IF
 17840        END-IF
 17841     end-if
 17842***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17843***-_-
 17844***-_-   'NH' is 10%, TN is 3.5%
 17845***-_-
 17846***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17847*    if pb-state = 'NH'
 17848*       move +1.10               to ws-work-rate
 17849*    else
 17850*       move +1.035              to ws-work-rate
 17851*    end-if
 17852     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17853     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17854        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17855           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17856     IF WS-PAYMENT-AMT < 10.00
 17857        GO TO 3999-END-EDIT
 17858     END-IF
 17859*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17860
 17861     if (cm-soc-sec-no(1:9) numeric)
 17862        and (cm-soc-sec-no(1:9) not = zeros)
 17863        GO TO 3999-END-EDIT
 17864     END-IF
 17865     MOVE ER-2795                TO WS-ERROR
 17866     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17867
 17868     GO TO 3999-END-EDIT.
 17869******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 323
* EL050.cbl
 17871 3990-FILES-NOT-OPEN.
 17872
 17873     MOVE ER-2617                TO WS-ERROR.
 17874     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17875     GO TO 9990-RETURN.
 17876
 17877 3999-END-EDIT.
 17878
 17879     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17880
 17881     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17882         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17883         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17884             PERFORM 9250-UNLOCK-RETURN
 17885             GO TO 9990-RETURN
 17886          ELSE
 17887             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17888             GO TO 9990-RETURN.
 17889
 17890     IF PB-CANCELLATION
 17891          GO TO 9990-RETURN.
 17892
 17893     IF CERT-WAS-NOT-FOUND
 17894        MOVE SPACES              TO CERTIFICATE-MASTER.
 17895
 17896     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17897
 17898     IF CERT-WAS-FOUND
 17899         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17900             PERFORM 9250-UNLOCK-RETURN
 17901          ELSE
 17902            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17903      ELSE
 17904         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17905
 17906*    if pb-company-id = 'VPP'
 17907*       perform 8150-read-elcrtt thru 8150-exit
 17908*       if ws-vehicle-odometer numeric
 17909*          if ws-vehicle-odometer > 6000
 17910*             move er-1583       to ws-error
 17911*             PERFORM 9900-ERROR-FORMAT
 17912*                                THRU 9900-EXIT
 17913*          end-if
 17914*       end-if
 17915*    end-if
 17916     if (pb-cert-sfx not = ' ')
 17917                 or
 17918        (pb-i-entry-status = 'V')
 17919        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17920                                 thru 7320-exit
 17921     end-if
 17922     perform 8145-read-elcrtt-upd thru 8145-exit
 17923     if not elcrtt-found
 17924        move 'CS'                to certificate-trailers
 17925        move cm-control-primary  to cs-control-primary
 17926        move 'C'                 TO cs-trailer-type
 17927        move zeros               to cs-vehicle-odometer
 17928     end-if
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 324
* EL050.cbl
 17929     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17930        IF ((PB-COMPANY-ID = 'DCC')
 17931           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17932                         or
 17933           (pb-company-id = 'CID' or 'VPP')
 17934           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17935               or (hldi-pass-area not = spaces)
 17936               move pa-modelyear        to cs-year
 17937               move pa-makename         to cs-make
 17938               move pa-modelname        to cs-model
 17939               move pa-seriesname       to cs-future
 17940               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17941               move 'Y'                 to elcrtt-update-sw
 17942           end-if
 17943        end-if
 17944     end-if
 17945     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17946        IF WS-INS-AGE-SET = 'Y'
 17947           MOVE WS-INS-AGE-DEFAULTED
 17948                                 TO CS-INS-AGE-DEFAULT-FLAG
 17949           move 'Y'              to elcrtt-update-sw
 17950        END-IF
 17951        IF WS-JNT-AGE-SET = 'Y'
 17952           MOVE WS-JNT-AGE-DEFAULTED
 17953                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17954           move 'Y'              to elcrtt-update-sw
 17955        END-IF
 17956     end-if
 17957     IF PB-I-LETTER-REQD = 'Y'
 17958        MOVE ER-1577             TO WS-ERROR
 17959        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17960     ELSE
 17961     IF PB-I-LETTER-REQD = 'N'
 17962        MOVE ER-1584             TO WS-ERROR
 17963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17964     END-IF.
 17965
 17966     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17967     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17968     move cs-vehicle-odometer    to ws-vehicle-odometer
 17969     if ws-ins-age-defaulted = 'Y'
 17970        move er-1573             to ws-error
 17971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17972     end-if
 17973
 17974     if ws-jnt-age-defaulted = 'Y'
 17975        move er-1574             to ws-error
 17976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17977     end-if
 17978***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17979***                                                           ****
 17980***  Set an error if the state requires verification of agent ****
 17981***  and agent hasn't verified yet and the status is not =    ****
 17982***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17983***  and the entry date > 09/01/2015.                         ****
 17984***                                                           ****
 17985***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17986     if (pb-input-dt >= X'AD81')    *> 09/01/2015
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 325
* EL050.cbl
 17987        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17988        and (pb-account (9:2) not = 'OB')
 17989        if (ws-st-agent-sig-edit = 'Y')
 17990           and (am-report-code-1 not = 'CONLEY')
 17991           evaluate true
 17992              when cs-agent-edit-status = 'C'
 17993                 move er-1743    to ws-error
 17994                 perform 9900-error-format
 17995                                 thru 9900-exit
 17996              when cs-agent-edit-status = 'S'
 17997                 move er-1744    to ws-error
 17998                 perform 9900-error-format
 17999                                 thru 9900-exit
 18000              when cs-agent-edit-status = 'M'
 18001                 move er-1745    to ws-error
 18002                 perform 9900-error-format
 18003                                 thru 9900-exit
 18004              when cs-agent-edit-status = 'R'
 18005                 move er-1747    to ws-error
 18006                 perform 9900-error-format
 18007                                 thru 9900-exit
 18008              when cs-agent-edit-status = 'N'
 18009                 move er-1748    to ws-error
 18010                 perform 9900-error-format
 18011                                 thru 9900-exit
 18012              when cs-agent-edit-status <> 'V' and 'U' and
 18013                                           'R' and 'N' and
 18014                                           'H'
 18015                 move er-1746    to ws-error
 18016                 perform 9900-error-format
 18017                                 thru 9900-exit
 18018           end-evaluate
 18019        end-if
 18020     end-if
 18021*    move ' ' to cs-claim-verification-status
 18022*    move 'Y' to elcrtt-update-sw
 18023     if cs-claim-verification-status = ' ' or 'R'
 18024        move pb-state            to pa-clmhs-state
 18025        move pb-account          to pa-account
 18026        move ws-greg-eff-date    to pa-eff-dt
 18027        move pb-cert-no          to pa-cert-no
 18028        perform 7795-call-sqlclmhs
 18029                                 thru 7795-exit
 18030        if pa-clm-count > 0
 18031           if cs-claim-verification-status = ' '
 18032              move 'R'           to cs-claim-verification-status
 18033*             display 'Updating elcrtt ' pb-state ' '
 18034*                pb-account ' ' pb-cert-no
 18035              move 'Y'           to elcrtt-update-sw
 18036           end-if
 18037        else
 18038           if cs-claim-verification-status = 'R'
 18039              move ' '           to cs-claim-verification-status
 18040              move 'Y'           to elcrtt-update-sw
 18041           end-if
 18042        end-if
 18043     end-if
 18044
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 326
* EL050.cbl
 18045     if cs-claim-verification-status <> ' '
 18046        evaluate true
 18047           when cs-claim-verification-status = 'R'
 18048              move er-1749    to ws-error
 18049              perform 9900-error-format
 18050                              thru 9900-exit
 18051           when cs-claim-verification-status = 'W'
 18052              move er-1750    to ws-error
 18053              perform 9900-error-format
 18054                              thru 9900-exit
 18055           when cs-claim-verification-status = 'I'
 18056              move er-1751    to ws-error
 18057              perform 9900-error-format
 18058                              thru 9900-exit
 18059           when cs-claim-verification-status = 'K'
 18060              move er-1761    to ws-error
 18061              perform 9900-error-format
 18062                              thru 9900-exit
 18063           when cs-claim-verification-status = 'A'
 18064              move er-1752    to ws-error
 18065              perform 9900-error-format
 18066                              thru 9900-exit
 18067           when cs-claim-verification-status = 'B'
 18068              move er-1754    to ws-error
 18069              perform 9900-error-format
 18070                              thru 9900-exit
 18071           when cs-claim-verification-status = 'C'
 18072              move er-1753    to ws-error
 18073              perform 9900-error-format
 18074                              thru 9900-exit
 18075           when cs-claim-verification-status = 'D'
 18076              move er-1757    to ws-error
 18077              perform 9900-error-format
 18078                              thru 9900-exit
 18079           when cs-claim-verification-status = 'E'
 18080              move er-1758    to ws-error
 18081              perform 9900-error-format
 18082                              thru 9900-exit
 18083           when cs-claim-verification-status = 'F'
 18084              move er-1759    to ws-error
 18085              perform 9900-error-format
 18086                              thru 9900-exit
 18087           when cs-claim-verification-status = 'G'
 18088              move er-1760    to ws-error
 18089              perform 9900-error-format
 18090                              thru 9900-exit
 18091*          when cs-claim-verification-status = 'H'
 18092*             move er-1756    to ws-error
 18093*             perform 9900-error-format
 18094*                             thru 9900-exit
 18095*          when cs-claim-verification-status = 'J'
 18096*             move er-1755    to ws-error
 18097*             perform 9900-error-format
 18098*                             thru 9900-exit
 18099        end-evaluate
 18100     end-if
 18101
 18102     IF ELCRTT-UPDATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 327
* EL050.cbl
 18103        perform 8150-update-elcrtt thru 8150-exit
 18104*       display ' back from 8150 ' elcrtt-file-status
 18105     else
 18106        if elcrtt-found
 18107           perform 8155-unlock-elcrtt
 18108                                 thru 8155-exit
 18109        end-if
 18110     end-if
 18111     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18112     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18113        AND (WS-NO-SECURE-PAY))
 18114                  OR
 18115        (WS-LF-SPECIAL-CALC-CD = 'O'
 18116        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18117        SET SKIP-ADDR-EDIT       TO TRUE
 18118     END-IF
 18119     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18120        AND (NOT SKIP-ADDR-EDIT)
 18121        MOVE ER-2963             TO WS-ERROR
 18122        PERFORM 9900-ERROR-FORMAT
 18123                                 THRU 9900-EXIT
 18124        GO TO 9990-RETURN
 18125     END-IF
 18126     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18127     IF ERPNDM-FOUND NOT = 'X'
 18128        move 'Y'                 to erpndm-unlock-sw
 18129        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18130           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18131           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18132           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18133           or (pm-zip-code    = zeros)
 18134           or (pm-zip-code not numeric))
 18135           AND (NOT SKIP-ADDR-EDIT)
 18136           MOVE ER-2694          TO WS-ERROR
 18137           PERFORM 9900-ERROR-FORMAT
 18138                                 THRU 9900-EXIT
 18139        END-IF
 18140        MOVE ' '                 TO STATE-RECORD-ERROR
 18141        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18142        MOVE PM-STATE            TO CNTL-ACCESS
 18143        MOVE '3'                 TO CNTL-REC-TYPE
 18144        MOVE +0                  TO CNTL-SEQ-NO
 18145        MOVE '0'                 TO RC-SW-2
 18146        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18147        IF (NO-STATE-RECORD)
 18148           OR (CF-RECORD-TYPE NOT = '3')
 18149           OR (PM-STATE NOT = CF-STATE-CODE)
 18150           IF (PM-STATE = SPACES)
 18151              AND (SKIP-ADDR-EDIT)
 18152              CONTINUE
 18153           ELSE
 18154              MOVE ER-2963       TO WS-ERROR
 18155              PERFORM 9900-ERROR-FORMAT
 18156                                 THRU 9900-EXIT
 18157           END-IF
 18158        END-IF
 18159        if (ws-error not = er-2963 and er-2694)
 18160           and (pm-city-st-zip-verified = ' ')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 328
* EL050.cbl
 18161           and (pb-company-id = 'CID')
 18162           move spaces           to zipcd-pass-area
 18163           move pm-zip-code      to pa-zip
 18164           move pm-city          to pa-city
 18165           move pm-state         to pa-state
 18166           perform 7790-call-zip-verify
 18167                                 thru 7790-exit
 18168           if pa-errorcode-zip (1:1) = ' '
 18169                    move 'Y'     to pm-city-st-zip-verified
 18170                    PERFORM 8102-REWRITE-ERPNDM
 18171                                 THRU 8102-EXIT
 18172                    move 'N'     to erpndm-unlock-sw
 18173           else
 18174              MOVE ER-3061       TO WS-ERROR
 18175              PERFORM 9900-ERROR-FORMAT
 18176                                 THRU 9900-EXIT
 18177           end-if
 18178        end-if
 18179        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18180           MOVE ER-2883          TO WS-ERROR
 18181           PERFORM 9900-ERROR-FORMAT
 18182                                 THRU 9900-EXIT
 18183        END-IF
 18184        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18185           MOVE ' '                 TO STATE-RECORD-ERROR
 18186           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18187           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18188           MOVE '3'                 TO CNTL-REC-TYPE
 18189           MOVE +0                  TO CNTL-SEQ-NO
 18190           MOVE '0'                 TO RC-SW-2
 18191           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18192           IF NO-STATE-RECORD
 18193              OR (CF-RECORD-TYPE NOT = '3')
 18194              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18195              MOVE ER-2964          TO WS-ERROR
 18196              PERFORM 9900-ERROR-FORMAT
 18197                                    THRU 9900-EXIT
 18198           END-IF
 18199        END-IF
 18200     ELSE
 18201        IF NOT SKIP-ADDR-EDIT
 18202           MOVE ER-2393          TO WS-ERROR
 18203           PERFORM 9900-ERROR-FORMAT
 18204                                 THRU 9900-EXIT
 18205        END-IF
 18206     END-IF
 18207     if need-to-unlock-erpndm
 18208        perform 8104-unlock-erpndm
 18209                                 thru 8104-exit
 18210     end-if
 18211     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18212
 18213     IF (ERMAIL-FOUND = ' ' AND
 18214        ERPNDM-FOUND = ' ')
 18215        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18216           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18217           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18218          OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 329
* EL050.cbl
 18219           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18220          OR
 18221           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18222           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18223           GO TO 3999-UNLOCK-ERMAIL.
 18224
 18225     IF ERPNDM-FOUND = 'X'
 18226        GO TO 3999-UNLOCK-ERMAIL.
 18227
 18228     IF PM-INSURED-LAST-NAME      = SPACES
 18229        AND PM-INSURED-FIRST-NAME = SPACES
 18230        AND PM-ADDRESS-LINE-1     = SPACES
 18231        AND PM-ADDRESS-LINE-2     = SPACES
 18232        AND PM-CITY-STATE         = SPACES
 18233        AND PM-CRED-BENE-NAME     = SPACES
 18234        AND PM-CRED-BENE-ADDR     = SPACES
 18235        AND PM-CRED-BENE-CTYST    = SPACES
 18236        GO TO 3999-UNLOCK-ERMAIL
 18237     END-IF
 18238
 18239     MOVE SPACES                 TO MAILING-DATA.
 18240
 18241     MOVE 'MA'                   TO MA-RECORD-ID.
 18242     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18243     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18244     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18245     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18246     MOVE PB-SV-STATE            TO MA-STATE.
 18247     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18248     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18249
 18250     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18251     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18252
 18253     IF ERMAIL-FOUND = ' '
 18254        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18255     ELSE
 18256        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18257        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18258        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18259
 18260     GO TO 9990-RETURN.
 18261
 18262 3999-UNLOCK-ERMAIL.
 18263     IF ERMAIL-FOUND = ' '
 18264        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18265
 18266     GO TO 9990-RETURN.
 18267******************************************************************
 18268
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 330
* EL050.cbl
 18270 4000-UPDATE-CANCELLED-CERT.
 18271     IF CERT-WAS-NOT-FOUND
 18272        GO TO 4299-EXIT.
 18273
 18274*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18275     IF PB-C-INT-ON-REFS > ZEROS
 18276        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18277     END-IF
 18278     IF PB-C-REF-INTERFACE-SW = 'Y'
 18279        MOVE PB-C-REF-INTERFACE-SW
 18280                                 TO CM-ref-INTERFACE-SW
 18281     END-IF
 18282*    IF ERMAIL-FOUND = ' '
 18283*       PERFORM 8140-UNLOCK-ERMAIL
 18284*                                THRU 8140-EXIT
 18285*    end-if
 18286     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18287     IF ERMAIL-FOUND = 'X'
 18288        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18289        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18290        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18291        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18292           MOVE ER-2694          TO WS-ERROR
 18293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18294     END-IF
 18295
 18296     IF PB-C-POST-CARD-IND = 'Y'
 18297        MOVE +8                  TO SUB
 18298*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18299        IF ERMAIL-FOUND = ' '
 18300           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18301              (SUB > +7)
 18302              OR (MA-MAIL-STATUS (SUB) = '1')
 18303           END-PERFORM
 18304        END-IF
 18305        IF (SUB > +7)
 18306           OR (ERMAIL-FOUND = 'X')
 18307           MOVE ER-3789          TO WS-ERROR
 18308           PERFORM 9900-ERROR-FORMAT
 18309                                 THRU 9900-EXIT
 18310        END-IF
 18311     ELSE
 18312        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18313     END-IF
 18314
 18315     IF ERMAIL-FOUND = ' '
 18316        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18317     END-IF.
 18318
 18319     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18320
 18321     IF PB-CI-OB-FLAG = 'Z'
 18322        GO TO 4150-SUMMARY-CERT-CANCEL.
 18323     perform 8145-read-elcrtt-upd thru 8145-exit
 18324     if not elcrtt-found
 18325        move 'CS'                to certificate-trailers
 18326        move cm-control-primary  to cs-control-primary
 18327        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 331
* EL050.cbl
 18328        move zeros               to cs-vehicle-odometer
 18329     end-if
 18330
 18331     if pb-lf-refund-type <> cs-lf-refund-method
 18332        move pb-lf-refund-type   to cs-lf-refund-method
 18333        set elcrtt-update to true
 18334     end-if
 18335     if pb-ah-refund-type <> cs-ah-refund-method
 18336        move pb-ah-refund-type   to cs-ah-refund-method
 18337        set elcrtt-update to true
 18338     end-if
 18339     IF PB-C-LF-CANCEL-VOIDED
 18340         PERFORM 4200-REVERSE-LF-CANCEL.
 18341     IF PB-C-AH-CANCEL-VOIDED
 18342         PERFORM 4200-REVERSE-AH-CANCEL.
 18343     IF ELCRTT-UPDATE
 18344        perform 8150-update-elcrtt thru 8150-exit
 18345     else
 18346        if elcrtt-found
 18347           perform 8155-unlock-elcrtt
 18348                                 thru 8155-exit
 18349        end-if
 18350     end-if
 18351     .
 18352 4100-APPLY-LF-CANCEL.
 18353
 18354     MOVE +0                     TO WS-SUB.
 18355
 18356 4100-CHECK-LF-ERRORS.
 18357
 18358     ADD +1                       TO WS-SUB.
 18359
 18360     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18361        IF LF-COVERAGE-CANCELLED
 18362           GO TO 4100-LF-CANCEL-CONT
 18363        ELSE
 18364           GO TO 4100-UPDATE-LF-COVERAGE.
 18365
 18366     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18367                                   ER-2729 OR
 18368                                   ER-2730 OR
 18369                                   ER-2731 OR
 18370                                   ER-2732 OR
 18371                                   ER-2737 OR
 18372                                   ER-2740 OR
 18373                                   ER-2743 OR
 18374                                   ER-2749 OR
 18375                                   ER-2750 OR
 18376                                   ER-2755 OR
 18377                                   ER-2757 OR
 18378                                   ER-2760 OR
 18379                                   ER-2772 OR
 18380                                   ER-2774 OR
 18381                                   ER-2776 OR
 18382                                   ER-2794
 18383        GO TO 4100-UPDATE-LF-COVERAGE.
 18384
 18385     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 332
* EL050.cbl
 18386
 18387 4100-UPDATE-LF-COVERAGE.
 18388
 18389     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18390     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18391     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18392        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18393     END-IF
 18394     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18395                                      TO CM-CREDIT-INTERFACE-SW-2.
 18396     IF CM-LF-CANCEL-DT = LOW-VALUE
 18397         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18398
 18399     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18400         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18401                                         CM-LF-STATUS-AT-CANCEL.
 18402
 18403     GO TO 4100-APPLY-AH-CANCEL.
 18404
 18405 4100-LF-CANCEL-CONT.
 18406     IF PB-C-LF-CANCEL-VOIDED
 18407         GO TO 4100-APPLY-AH-CANCEL.
 18408
 18409     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18410         GO TO 4100-APPLY-AH-CANCEL.
 18411
 18412     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18413        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18414           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18415        ELSE
 18416           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18417
 18418     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18419     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18420
 18421     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18422         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18423
 18424     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18425        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18426         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18427         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18428
 18429     IF PB-RECORD-RETURNED
 18430        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18431      ELSE
 18432        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18433
 18434 4100-APPLY-AH-CANCEL.
 18435
 18436     MOVE +0                      TO WS-SUB.
 18437
 18438 4100-CHECK-AH-ERRORS.
 18439
 18440     ADD +1                       TO WS-SUB.
 18441
 18442     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18443        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 333
* EL050.cbl
 18444           GO TO 4100-AH-CANCEL-CONT
 18445        ELSE
 18446           GO TO 4100-UPDATE-AH-COVERAGE.
 18447
 18448     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18449                                   ER-2729 OR
 18450                                   ER-2732 OR
 18451                                   ER-2737 OR
 18452                                   ER-2740 OR
 18453                                   ER-2744 OR
 18454                                   ER-2749 OR
 18455                                   ER-2750 OR
 18456                                   ER-2755 OR
 18457                                   ER-2757 OR
 18458                                   ER-2760 OR
 18459                                   ER-2771 OR
 18460                                   ER-2772 OR
 18461                                   ER-2773 OR
 18462                                   ER-2775 OR
 18463                                   ER-2777 OR
 18464                                   ER-2778 OR
 18465                                   ER-2794
 18466        GO TO 4100-UPDATE-AH-COVERAGE.
 18467
 18468     GO TO 4100-CHECK-AH-ERRORS.
 18469
 18470 4100-UPDATE-AH-COVERAGE.
 18471
 18472     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18473     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18474     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18475     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18476                                      TO CM-CREDIT-INTERFACE-SW-2.
 18477     IF CM-AH-CANCEL-DT = LOW-VALUE
 18478         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18479
 18480     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18481         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18482                                         CM-AH-STATUS-AT-CANCEL.
 18483
 18484     IF LF-COVERAGE-CANCELLED
 18485         IF PB-RECORD-RETURNED
 18486              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18487          ELSE
 18488              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18489
 18490     GO TO 4299-EXIT.
 18491
 18492 4100-AH-CANCEL-CONT.
 18493     IF PB-C-AH-CANCEL-VOIDED
 18494         GO TO 4299-EXIT.
 18495
 18496     if cm-credit-interface-sw-2 = ' '
 18497        if pb-fatal-errors or pb-unforced-errors
 18498           move '4'              to cm-credit-interface-sw-2
 18499        else
 18500           move '1'              to cm-credit-interface-sw-2
 18501        end-if
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 334
* EL050.cbl
 18502     end-if
 18503     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18504         GO TO 4299-EXIT.
 18505
 18506     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18507        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18508           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18509        ELSE
 18510           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18511
 18512     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18513     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18514
 18515     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18516         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18517
 18518     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18519         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18520         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18521
 18522     IF PB-RECORD-RETURNED
 18523        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18524      ELSE
 18525        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18526
 18527     GO TO 4299-EXIT.
 18528
 18529 4150-SUMMARY-CERT-CANCEL.
 18530     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18531
 18532     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18533        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18534                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18535     ELSE
 18536        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18537                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18538
 18539     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18540        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18541                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18542     ELSE
 18543        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18544                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18545
 18546     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18547        NEXT SENTENCE
 18548     ELSE
 18549        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18550
 18551     GO TO 4299-EXIT.
 18552
 18553 4200-REVERSE-LF-CANCEL.
 18554     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18555
 18556     IF CM-LF-CANCEL-APPLIED
 18557        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18558        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18559        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 335
* EL050.cbl
 18560
 18561     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18562
 18563     IF PB-RECORD-RETURNED
 18564        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18565       ELSE
 18566        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18567
 18568 4200-REVERSE-LF-EXIT.
 18569       EXIT.
 18570
 18571 4200-REVERSE-AH-CANCEL.
 18572     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18573
 18574     IF CM-AH-CANCEL-APPLIED
 18575        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18576        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18577        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18578
 18579     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18580
 18581     IF PB-RECORD-RETURNED
 18582        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18583       ELSE
 18584        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18585
 18586 4200-REVERSE-AH-EXIT.
 18587       EXIT.
 18588
 18589 4299-EXIT.
 18590       EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 336
* EL050.cbl
 18592
 18593 4500-UPDATE-NEW-CERT.
 18594     IF CERT-WAS-FOUND
 18595         NEXT SENTENCE
 18596       ELSE
 18597         GO TO 4520-BUILD-NEW-KEY.
 18598
 18599     IF  CLASIC-CREATED-CERT
 18600         GO TO 4999-EXIT.
 18601
 18602     IF  CERT-WAS-CREATED-FOR-CLAIM
 18603         GO TO 4520-BUILD-NEW-KEY.
 18604
 18605     IF CERT-ADDED-BATCH
 18606        IF CM-RECORD-ID = 'CM'
 18607            GO TO 4999-EXIT.
 18608
 18609 4520-BUILD-NEW-KEY.
 18610* BUILD CONTROL PRIMARY
 18611
 18612     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18613                                       CM-COMPANY-CD-A1
 18614                                       CM-COMPANY-CD-A2
 18615                                       CM-COMPANY-CD-A4
 18616                                       CM-COMPANY-CD-A5.
 18617
 18618     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18619     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18620     MOVE PB-SV-STATE               TO CM-STATE.
 18621     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18622     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18623     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18624     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18625
 18626     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18627
 18628     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18629     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18630     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18631     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18632
 18633     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18634        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18635
 18636     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18637         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18638         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18639         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18640         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18641     ELSE
 18642         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18643
 18644     IF PB-COMPANY-ID   EQUAL  'CRI'
 18645         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18646         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18647         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18648         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18649         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 337
* EL050.cbl
 18650
 18651     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18652        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18653         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18654
 18655     IF PB-COMPANY-ID  = 'LBL'
 18656        IF PB-I-JOINT-COVERAGE
 18657            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18658                                           PB-I-MEMBER-NO
 18659            GO TO 4550-CONT-CERT-PROCESS.
 18660
 18661     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18662        NEXT SENTENCE
 18663     ELSE
 18664        GO TO 4540-BUILD-MEMBER-NO.
 18665
 18666******************************************************************
 18667*                                                                *
 18668*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18669*    FOR 'MON'.                                                  *
 18670*                                                                *
 18671******************************************************************
 18672
 18673     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18674     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18675     MOVE +1                     TO WS-SUB1
 18676                                    WS-SUB2.
 18677
 18678 4530-EDIT-MEMB-NAME.
 18679
 18680     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18681        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18682        ADD +1                       TO WS-SUB2.
 18683
 18684     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18685        ADD +1                       TO WS-SUB1
 18686        GO TO 4530-EDIT-MEMB-NAME.
 18687
 18688     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18689     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18690     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18691*    MOVE SPACE                      TO DC-OPTION-CODE.
 18692     SET  BIN-TO-GREG                TO TRUE.
 18693     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18694     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18695
 18696     GO TO 4550-CONT-CERT-PROCESS.
 18697
 18698******************************************************************
 18699*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18700******************************************************************
 18701
 18702 4540-BUILD-MEMBER-NO.
 18703
 18704     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18705         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18706         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18707         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 338
* EL050.cbl
 18708         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18709     ELSE
 18710         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18711
 18712     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18713        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18714         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18715
 18716 4550-CONT-CERT-PROCESS.
 18717
 18718*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18719*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18720*    ELSE
 18721*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18722
 18723     IF CERT-WAS-CREATED-FOR-CLAIM
 18724        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18725        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18726
 18727     IF CERT-AND-CLAIM-ONLINE
 18728        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18729        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18730
 18731     MOVE 'CM'                     TO CM-RECORD-ID.
 18732     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18733
 18734     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18735        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18736        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18737     ELSE
 18738        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18739        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18740
 18741     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18742     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18743     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18744     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18745     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18746     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18747     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18748                                      CM-LF-ITD-CANCEL-AMT
 18749                                      CM-LF-ITD-DEATH-AMT
 18750                                      CM-AH-ITD-AH-PMT
 18751                                      CM-AH-ITD-LUMP-PMT
 18752                                      CM-AH-ITD-CANCEL-AMT
 18753                                      CM-LF-NSP-PREMIUM-AMT
 18754                                      CM-AH-NSP-PREMIUM-AMT.
 18755*                                     CM-CLAIM-DEDUCT-WITHHELD
 18756*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18757     if pb-i-loan-apr = +99.9999
 18758        move zeros                 to cm-loan-apr
 18759     else
 18760        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18761     end-if
 18762     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18763     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18764     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18765     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 339
* EL050.cbl
 18766     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18767     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18768     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18769     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18770     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18771     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18772     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18773
 18774     IF PB-I-LIVES NOT NUMERIC
 18775         MOVE ZERO                 TO PB-I-LIVES.
 18776
 18777     IF PB-I-NUM-BILLED NOT NUMERIC
 18778         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18779
 18780     MOVE PB-I-LIVES               TO CM-LIVES.
 18781     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18782
 18783     IF PB-COMPANY-ID EQUAL  'DMD'
 18784         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18785         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18786
 18787     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18788     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18789     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18790     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18791     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18792     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18793
 18794     IF PB-I-LF-POLICY-FEE NUMERIC
 18795        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18796     ELSE
 18797        MOVE +0                    TO CM-LF-POLICY-FEE.
 18798
 18799     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18800        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18801        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18802     ELSE
 18803        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18804
 18805     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18806     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18807     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18808     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18809     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18810     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18811     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18812     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18813     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18814
 18815     IF PB-I-CANCEL-FEE NUMERIC
 18816        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18817     ELSE
 18818        MOVE +0                  TO CM-CANCEL-FEE
 18819     END-IF
 18820
 18821     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18822        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18823     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 340
* EL050.cbl
 18824        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18825
 18826     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18827     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18828
 18829     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18830                                      CM-LF-DEATH-EXIT-DT
 18831                                      CM-AH-SETTLEMENT-EXIT-DT.
 18832
 18833*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18834*                       'TIH' OR 'OFL' OR 'FLA' OR
 18835*                       'TII' OR 'TMS' OR 'CRI' OR
 18836*                       'NCL'
 18837     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18838
 18839     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18840         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18841            MOVE '2'                TO CM-PREMIUM-TYPE.
 18842
 18843     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18844         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18845            MOVE '2'                TO CM-PREMIUM-TYPE.
 18846
 18847     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18848         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18849     ELSE
 18850         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18851         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18852
 18853     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18854     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18855     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18856     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18857     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18858     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18859     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18860     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18861
 18862     IF PB-NO-MONTHS-SKIPPED
 18863         MOVE SPACE                 TO CM-SKIP-CODE
 18864     ELSE
 18865         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18866
 18867     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18868     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18869                                       CM-LF-STATUS-AT-CANCEL.
 18870
 18871     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18872     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18873                                       CM-AH-STATUS-AT-CANCEL.
 18874
 18875     MOVE '1'                       TO CM-ENTRY-STATUS.
 18876
 18877     IF PB-REISSUED-CERT
 18878        MOVE '5'                    TO CM-ENTRY-STATUS.
 18879
 18880     IF PB-MONTHLY-CERT
 18881        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 341
* EL050.cbl
 18882
 18883     IF PB-CASH-CERT
 18884        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18885
 18886     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18887     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18888     IF PB-POLICY-IS-DECLINED
 18889        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18890
 18891     IF PB-POLICY-IS-VOIDED
 18892        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18893
 18894     IF PB-NEEDS-UNDERWRITING
 18895        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18896
 18897     IF PB-REIN-ONLY-CERT
 18898        MOVE '9'                    TO CM-ENTRY-STATUS.
 18899
 18900     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18901         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18902     ELSE
 18903         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18904
 18905     IF PB-RECORD-RETURNED
 18906        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18907      ELSE
 18908        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18909
 18910     IF PB-I-MAIL-ADDRS-PRESENT
 18911        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18912
 18913     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18914                                       CM-ENTRY-DT.
 18915
 18916 4999-EXIT.
 18917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 342
* EL050.cbl
 18919
 18920 5000-PROCESS-REPS.
 18921     MOVE ' '                    TO AGTC-MASTER-SW
 18922     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18923     MOVE CO-TYPE                TO AGTC-TYPE
 18924     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18925     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18926     IF (AGTC-MASTER-SW NOT = 'N')
 18927        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18928        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18929        PERFORM 8583-READ-ERAGTC-NEXT
 18930                                 THRU 8583-EXIT
 18931     END-IF
 18932     IF AGTC-MASTER-SW = 'N'
 18933        CONTINUE
 18934     ELSE
 18935        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18936           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18937              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18938              MOVE 'Y'           TO AGTC-MASTER-SW
 18939           END-IF
 18940        END-IF
 18941     END-IF
 18942     .
 18943 5000-EXIT.
 18944     EXIT.
 18945 6370-EDIT-INPUT-LF-CODE.
 18946     move ' ' to ws-benefit-cd-chg-sw
 18947     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18948        MOVE +1                  TO SUB
 18949        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18950        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18951        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18952        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18953        GO TO 6370-SEARCH-LOOP.
 18954
 18955     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18956
 18957     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18958     MOVE SPACES                 TO CNTL-ACCESS.
 18959*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18960     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18961     MOVE +0                     TO CNTL-SEQ-NO.
 18962     MOVE '4' TO RC-SW-2.
 18963     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18964
 18965     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18966        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18967        GO TO 6370-NO-LF-FOUND.
 18968
 18969     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18970     MOVE +1                     TO SUB.
 18971
 18972 6370-SEARCH-LOOP.
 18973     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18974         GO TO 6370-NO-LF-FOUND.
 18975
 18976     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 343
* EL050.cbl
 18977        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18978           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18979           set benefit-code-chg to true
 18980        end-if
 18981        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18982        GO TO 6370-HER-NET-PAY-CHECK.
 18983
 18984     ADD 1   TO SUB.
 18985*    IF SUB GREATER 120
 18986     IF SUB GREATER 200
 18987         GO TO 6370-NO-LF-FOUND.
 18988
 18989     GO TO 6370-SEARCH-LOOP.
 18990
 18991 6370-NO-LF-FOUND.
 18992
 18993     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18994        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18995        set benefit-code-chg to true
 18996     end-if
 18997     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18998
 18999 6370-HER-NET-PAY-CHECK.
 19000
 19001     IF PB-COMPANY-ID = 'CID'
 19002        IF PB-SV-STATE = 'CA' OR 'MN'
 19003           IF PB-I-LF-BENEFIT-CD = '02'
 19004              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19005           ELSE
 19006              IF PB-I-LF-BENEFIT-CD = '04'
 19007                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19008              END-IF
 19009           END-IF
 19010        END-IF
 19011     END-IF
 19012
 19013     IF PB-COMPANY-ID NOT = 'HER'
 19014         GO TO 6370-EXIT.
 19015
 19016     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 19017         GO TO 6370-EXIT.
 19018
 19019     IF PB-I-LF-TERM NOT NUMERIC
 19020         MOVE ZEROS              TO PB-I-LF-TERM.
 19021
 19022     IF PB-I-LOAN-TERM NOT NUMERIC
 19023         MOVE ZEROS              TO PB-I-LOAN-TERM.
 19024
 19025     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 19026         GO TO 6370-EXIT.
 19027
 19028     IF PB-I-LF-BENEFIT-CD = '33'
 19029         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 19030
 19031     IF PB-I-LF-BENEFIT-CD = '34'
 19032         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 19033
 19034 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 344
* EL050.cbl
 19035     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 345
* EL050.cbl
 19037
 19038 6380-EDIT-INPUT-AH-CODE.
 19039     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19040        MOVE +1                  TO SUB
 19041        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19042        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19043        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19044        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19045        GO TO 6380-SEARCH-LOOP.
 19046
 19047     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19048
 19049     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19050     MOVE SPACES                 TO CNTL-ACCESS.
 19051     MOVE 'A'                    TO CNTL-REC-TYPE.
 19052*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19053     MOVE +0                     TO CNTL-SEQ-NO.
 19054     MOVE '5' TO RC-SW-2.
 19055     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19056
 19057     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19058        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19059        GO TO 6380-NO-AH-FOUND.
 19060
 19061     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19062     MOVE +1 TO SUB.
 19063
 19064 6380-SEARCH-LOOP.
 19065     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19066         GO TO 6380-NO-AH-FOUND.
 19067
 19068     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19069         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19070         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19071
 19072     ADD 1   TO SUB.
 19073     IF SUB GREATER THAN 96
 19074*    IF SUB GREATER THAN 300
 19075         GO TO 6380-NO-AH-FOUND.
 19076
 19077     GO TO 6380-SEARCH-LOOP.
 19078
 19079 6380-NO-AH-FOUND.
 19080
 19081     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19082
 19083     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19084         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19085     ELSE
 19086         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19087
 19088 6380-CSO-AH-ONLY-CHECKS.
 19089
 19090     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19091        NEXT SENTENCE
 19092      ELSE
 19093        GO TO 6380-EXIT.
 19094
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 346
* EL050.cbl
 19095     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19096         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19097
 19098
 19099     GO TO 6380-EXIT
 19100     .
 19101 6380-CSO-LIFE-WITH-AH-CHECKS.
 19102
 19103
 19104     .
 19105 6380-EXIT.
 19106     EXIT.
 19107
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 347
* EL050.cbl
 19109
 19110 6400-COMPUTE-EXTENSION-DAYS.
 19111
 19112******************************************************************
 19113*                                                                *
 19114*                   COMPUTE EXTENSION DAYS                       *
 19115*                                                                *
 19116*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19117*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19118*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19119*    THE EXTENSION DAYS.                                         *
 19120*                                                                *
 19121******************************************************************
 19122
 19123     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19124     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19125
 19126******************************************************************
 19127*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19128*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19129******************************************************************
 19130
 19131     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19132        COMPUTE WS-ODD-DAYS-OVER =
 19133               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19134     ELSE
 19135        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19136
 19137     IF WS-ODD-DAYS-OVER = ZEROS
 19138           GO TO 6499-EXIT
 19139     ELSE
 19140        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19141           IF WS-WDF-MONTH = 02
 19142              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19143              ADD 2       TO  WS-ODD-DAYS-OVER
 19144              GO TO 6499-EXIT
 19145           ELSE
 19146              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19147                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19148                 GO TO 6499-EXIT
 19149               ELSE
 19150                 GO TO 6499-EXIT
 19151        ELSE
 19152           GO TO 6499-EXIT.
 19153
 19154 6412-CHECK-TO-DAY.
 19155
 19156        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19157           IF WS-WDT-DAY = 28
 19158              ADD 2              TO WS-ODD-DAYS-OVER
 19159           ELSE
 19160              IF WS-WDT-DAY = 29
 19161                 ADD 1           TO WS-ODD-DAYS-OVER
 19162              ELSE
 19163                 NEXT SENTENCE
 19164        ELSE
 19165           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19166              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 348
* EL050.cbl
 19167
 19168     GO TO 6499-EXIT.
 19169
 19170
 19171 6415-CHECK-LEAP-YEAR.
 19172
 19173     IF DC-DAYS-IN-MONTH = 29
 19174        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19175
 19176 6415-EXIT.
 19177     EXIT.
 19178
 19179 6499-EXIT.
 19180      EXIT.
 19181
 19182 6500-END.
 19183     EXIT.
 19184
 19185
 19186******************************************************************
 19187************* PROCEDURE DIVISION FOR EL050 ***********************
 19188********************** ELC50PD END *******************************
 19189
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 349
* EL050.cbl
 19191
 19192**START***********************************************************
 19193*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19194*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19195******************************************************************
 19196*
 19197 6600-GET-STATE-MUNICIPAL-TAX.
 19198
 19199     IF PB-COMPANY-ID NOT = 'DMD'
 19200         GO TO 6640-EXIT.
 19201
 19202     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19203     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19204     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19205*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19206*
 19207***  Y2K PROJ 7744
 19208     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19209     SET BIN-TO-GREG          TO TRUE.
 19210     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19211
 19212     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19213
 19214     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19215     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19216
 19217
 19218* EXEC CICS HANDLE CONDITION
 19219*        INVREQ    (6610-START-BROWSE)
 19220*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19221*        NOTFND    (6630-END-OF-FILE)
 19222*    END-EXEC.
 19223*    MOVE '"$8JI                 ! # #00019207' TO DFHEIV0
 19224     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19226     MOVE X'2320233030303139323037' TO DFHEIV0(25:11)
 19227     CALL 'kxdfhei1' USING DFHEIV0
 19228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19229
 19230
 19231 6610-START-BROWSE.
 19232
 19233
 19234* EXEC CICS HANDLE CONDITION
 19235*        NOTFND    (6630-END-OF-FILE)
 19236*        DISABLED  (6630-ERRESS-PROBLEM)
 19237*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19238*        ENDFILE   (6630-END-OF-FILE)
 19239*    END-EXEC.
 19240*    MOVE '"$IcJ''                ! $ #00019215' TO DFHEIV0
 19241     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19243     MOVE X'2420233030303139323135' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0
 19245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19246
 19247
 19248
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 350
* EL050.cbl
 19249* EXEC CICS STARTBR
 19250*        DATASET (FILE-ID-ERRESS)
 19251*        RIDFLD  (WS-ERRESS-KEY)
 19252*        GTEQ
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&,         G          &   #00019222' TO DFHEIV0
 19257     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303139323232' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID-ERRESS,
 19262           WS-ERRESS-KEY,
 19263           DFHEIV99,
 19264           DFHEIV11,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269 6620-READ-NEXT-ERRESS-MASTER.
 19270
 19271
 19272* EXEC CICS HANDLE CONDITION
 19273*        NOTFND    (6630-END-OF-FILE)
 19274*        ENDFILE   (6630-END-OF-FILE)
 19275*        DISABLED  (6630-ERRESS-PROBLEM)
 19276*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19277*    END-EXEC.
 19278*    MOVE '"$I''cJ                ! % #00019230' TO DFHEIV0
 19279     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19281     MOVE X'2520233030303139323330' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286
 19287* EXEC CICS READNEXT
 19288*        DATASET (FILE-ID-ERRESS)
 19289*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19290*        RIDFLD  (WS-ERRESS-KEY)
 19291*    END-EXEC.
 19292     MOVE LENGTH OF
 19293      RESIDENT-STATE-TAX-MASTER
 19294       TO DFHEIV12
 19295     MOVE 0
 19296       TO DFHEIV11
 19297*    MOVE '&.IL                  )   #00019237' TO DFHEIV0
 19298     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19299     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19300     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 19301     CALL 'kxdfhei1' USING DFHEIV0,
 19302           FILE-ID-ERRESS,
 19303           RESIDENT-STATE-TAX-MASTER,
 19304           DFHEIV12,
 19305           WS-ERRESS-KEY,
 19306           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 351
* EL050.cbl
 19307           DFHEIV11,
 19308           DFHEIV99,
 19309           DFHEIV99
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19311
 19312
 19313     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19314
 19315* EXEC CICS ENDBR
 19316*            DATASET (FILE-ID-ERRESS)
 19317*       END-EXEC
 19318     MOVE 0
 19319       TO DFHEIV11
 19320*    MOVE '&2                    $   #00019244' TO DFHEIV0
 19321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19323     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0,
 19325           FILE-ID-ERRESS,
 19326           DFHEIV11,
 19327           DFHEIV99
 19328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19329        GO TO 6630-END-OF-FILE.
 19330
 19331     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19332        NEXT SENTENCE
 19333      ELSE
 19334        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19335
 19336*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19337*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19338*
 19339     MOVE +2                     TO WS-SUB1.
 19340
 19341     IF PB-ISSUE
 19342     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19343        MOVE +1                  TO WS-SUB1.
 19344
 19345     IF PB-CANCELLATION
 19346     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19347        MOVE +1                  TO WS-SUB1.
 19348*
 19349*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19350*
 19351***  Y2K PROJ 7744
 19352     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19353***  Y2K PROJ 7744
 19354
 19355*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19356* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19357* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19358
 19359     ADD 1                    TO WS-YEAR-YY.
 19360
 19361     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19362         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19363                              TO WS-RES-STATE-TAX
 19364         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 352
* EL050.cbl
 19365                              TO WS-RES-MUNI-TAX
 19366     ELSE
 19367         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19368                              TO WS-RES-STATE-TAX
 19369         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19370                              TO WS-RES-MUNI-TAX.
 19371
 19372*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19373
 19374     IF PB-CANCELLATION
 19375         GO TO 6640-CANCEL-TAX.
 19376
 19377     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19378         COMPUTE PB-I-STATE-TAX ROUNDED =
 19379                                   PB-I-LF-PREMIUM-AMT
 19380                                 * WS-RES-STATE-TAX
 19381         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19382                                   PB-I-LF-PREMIUM-AMT
 19383                                 * WS-RES-MUNI-TAX
 19384     ELSE
 19385     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19386         COMPUTE PB-I-STATE-TAX ROUNDED =
 19387                                   PB-I-AH-PREMIUM-AMT
 19388                                 * WS-RES-STATE-TAX
 19389         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19390                                   PB-I-AH-PREMIUM-AMT
 19391                                 * WS-RES-MUNI-TAX.
 19392
 19393
 19394* EXEC CICS ENDBR
 19395*         DATASET (FILE-ID-ERRESS)
 19396*    END-EXEC.
 19397     MOVE 0
 19398       TO DFHEIV11
 19399*    MOVE '&2                    $   #00019311' TO DFHEIV0
 19400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19402     MOVE X'2020233030303139333131' TO DFHEIV0(25:11)
 19403     CALL 'kxdfhei1' USING DFHEIV0,
 19404           FILE-ID-ERRESS,
 19405           DFHEIV11,
 19406           DFHEIV99
 19407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19408
 19409
 19410     GO TO 6640-EXIT.
 19411
 19412 6640-CANCEL-TAX.
 19413     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19414
 19415     IF PB-C-LF-CANCEL-AMT > ZEROS
 19416         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19417                                   PB-C-LF-CANCEL-AMT
 19418                                 * WS-RES-STATE-TAX
 19419         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19420                                   PB-C-LF-CANCEL-AMT
 19421                                *  WS-RES-MUNI-TAX
 19422     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 353
* EL050.cbl
 19423     IF PB-C-AH-CANCEL-AMT > ZEROS
 19424         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19425                                   PB-C-AH-CANCEL-AMT
 19426                                 * WS-RES-STATE-TAX
 19427         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19428                                   PB-C-AH-CANCEL-AMT
 19429                                *  WS-RES-MUNI-TAX.
 19430
 19431
 19432* EXEC CICS ENDBR
 19433*         DATASET (FILE-ID-ERRESS)
 19434*    END-EXEC.
 19435     MOVE 0
 19436       TO DFHEIV11
 19437*    MOVE '&2                    $   #00019336' TO DFHEIV0
 19438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19440     MOVE X'2020233030303139333336' TO DFHEIV0(25:11)
 19441     CALL 'kxdfhei1' USING DFHEIV0,
 19442           FILE-ID-ERRESS,
 19443           DFHEIV11,
 19444           DFHEIV99
 19445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19446
 19447
 19448     GO TO 6640-EXIT.
 19449
 19450 6630-END-OF-FILE.
 19451     MOVE ER-8002              TO WS-ERROR.
 19452     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19453
 19454     GO TO 6640-EXIT.
 19455
 19456 6630-ERRESS-PROBLEM.
 19457     MOVE ER-8044              TO WS-ERROR.
 19458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19459
 19460 6640-EXIT.
 19461     EXIT.
 19462
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 354
* EL050.cbl
 19464 6650-GET-RES-STATE-COMM.
 19465
 19466     IF PB-COMPANY-ID NOT = 'DMD'
 19467         GO TO 6700-COMM-EXIT.
 19468
 19469     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19470     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19471     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19472     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19473     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19474     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19475     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19476
 19477*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19478*
 19479***  Y2K PROJ 7744
 19480     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19481     SET BIN-TO-GREG          TO TRUE.
 19482     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19483
 19484     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19485***  Y2K PROJ 7744
 19486
 19487     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19488
 19489
 19490* EXEC CICS HANDLE CONDITION
 19491*        INVREQ    (6660-START-BROWSE)
 19492*        DISABLED  (6690-ERRESC-PROBLEM)
 19493*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19494*        NOTFND    (6690-END-OF-FILE)
 19495*    END-EXEC.
 19496*    MOVE '"$8cJI                ! & #00019381' TO DFHEIV0
 19497     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19499     MOVE X'2620233030303139333831' TO DFHEIV0(25:11)
 19500     CALL 'kxdfhei1' USING DFHEIV0
 19501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19502
 19503
 19504
 19505* EXEC CICS RESETBR
 19506*        DATASET (FILE-ID-ERRESC)
 19507*        RIDFLD  (WS-ERRESC-KEY)
 19508*    END-EXEC.
 19509     MOVE 0
 19510       TO DFHEIV11
 19511*    MOVE '&4         G          &   #00019388' TO DFHEIV0
 19512     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19514     MOVE X'2020233030303139333838' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0,
 19516           FILE-ID-ERRESC,
 19517           WS-ERRESC-KEY,
 19518           DFHEIV99,
 19519           DFHEIV11,
 19520           DFHEIV99
 19521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 355
* EL050.cbl
 19522
 19523
 19524 6660-START-BROWSE.
 19525
 19526
 19527* EXEC CICS HANDLE CONDITION
 19528*        NOTFND    (6690-END-OF-FILE)
 19529*        DISABLED  (6690-ERRESC-PROBLEM)
 19530*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19531*        ENDFILE   (6690-END-OF-FILE)
 19532*    END-EXEC.
 19533*    MOVE '"$IcJ''                ! '' #00019395' TO DFHEIV0
 19534     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19536     MOVE X'2720233030303139333935' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0
 19538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19539
 19540
 19541
 19542* EXEC CICS STARTBR
 19543*        DATASET (FILE-ID-ERRESC)
 19544*        RIDFLD  (WS-ERRESC-KEY)
 19545*        GTEQ
 19546*    END-EXEC.
 19547     MOVE 0
 19548       TO DFHEIV11
 19549*    MOVE '&,         G          &   #00019402' TO DFHEIV0
 19550     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19552     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 19553     CALL 'kxdfhei1' USING DFHEIV0,
 19554           FILE-ID-ERRESC,
 19555           WS-ERRESC-KEY,
 19556           DFHEIV99,
 19557           DFHEIV11,
 19558           DFHEIV99
 19559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19560
 19561
 19562     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19563
 19564 6670-READ-NEXT-ERRESC-MASTER.
 19565
 19566
 19567* EXEC CICS HANDLE CONDITION
 19568*        NOTFND    (6690-END-OF-FILE)
 19569*        DISABLED  (6690-ERRESC-PROBLEM)
 19570*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19571*        ENDFILE   (6690-END-OF-FILE)
 19572*    END-EXEC.
 19573*    MOVE '"$IcJ''                ! ( #00019412' TO DFHEIV0
 19574     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19576     MOVE X'2820233030303139343132' TO DFHEIV0(25:11)
 19577     CALL 'kxdfhei1' USING DFHEIV0
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 356
* EL050.cbl
 19580
 19581
 19582* EXEC CICS READNEXT
 19583*        DATASET (FILE-ID-ERRESC)
 19584*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19585*        RIDFLD  (ERRESC-RECORD-KEY)
 19586*    END-EXEC.
 19587     MOVE LENGTH OF
 19588      ACCOUNT-RESIDENT-ST-COMMISSION
 19589       TO DFHEIV12
 19590     MOVE 0
 19591       TO DFHEIV11
 19592*    MOVE '&.IL                  )   #00019419' TO DFHEIV0
 19593     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19594     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19595     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 19596     CALL 'kxdfhei1' USING DFHEIV0,
 19597           FILE-ID-ERRESC,
 19598           ACCOUNT-RESIDENT-ST-COMMISSION,
 19599           DFHEIV12,
 19600           ERRESC-RECORD-KEY,
 19601           DFHEIV99,
 19602           DFHEIV11,
 19603           DFHEIV99,
 19604           DFHEIV99
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19609        NEXT SENTENCE
 19610     ELSE
 19611
 19612* EXEC CICS ENDBR
 19613*            DATASET (FILE-ID-ERRESC)
 19614*       END-EXEC
 19615     MOVE 0
 19616       TO DFHEIV11
 19617*    MOVE '&2                    $   #00019428' TO DFHEIV0
 19618     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19619     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19620     MOVE X'2020233030303139343238' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0,
 19622           FILE-ID-ERRESC,
 19623           DFHEIV11,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19626        GO TO 6690-END-OF-FILE.
 19627
 19628     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19629
 19630* EXEC CICS ENDBR
 19631*            DATASET (FILE-ID-ERRESC)
 19632*       END-EXEC
 19633     MOVE 0
 19634       TO DFHEIV11
 19635*    MOVE '&2                    $   #00019434' TO DFHEIV0
 19636     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 357
* EL050.cbl
 19638     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 19639     CALL 'kxdfhei1' USING DFHEIV0,
 19640           FILE-ID-ERRESC,
 19641           DFHEIV11,
 19642           DFHEIV99
 19643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19644        GO TO 6690-END-OF-FILE.
 19645
 19646     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19647        NEXT SENTENCE
 19648      ELSE
 19649        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19650
 19651* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19652*
 19653     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19654
 19655     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19656
 19657     IF WS-SUB1 > ZERO
 19658         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19659             PERFORM 6680-SET-COMMISSION
 19660         ELSE
 19661             PERFORM 6680-SET-TABLE-CODE.
 19662
 19663
 19664* EXEC CICS ENDBR
 19665*         DATASET (FILE-ID-ERRESC)
 19666*    END-EXEC.
 19667     MOVE 0
 19668       TO DFHEIV11
 19669*    MOVE '&2                    $   #00019456' TO DFHEIV0
 19670     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19672     MOVE X'2020233030303139343536' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           FILE-ID-ERRESC,
 19675           DFHEIV11,
 19676           DFHEIV99
 19677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19678
 19679
 19680     GO TO 6700-COMM-EXIT.
 19681
 19682 6680-SET-TABLE-CODE.
 19683     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19684        MOVE ZEROS             TO WS-SUB1
 19685     ELSE
 19686* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19687* TO COMPUTE AH COMMISSION.
 19688        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19689        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19690        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19691        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19692        PERFORM 6680-READ-CTBL-TABLE
 19693        IF WS-CTBL-READ-SW NOT = 'Y'
 19694           MOVE ZEROS          TO WS-SUB1.
 19695
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 358
* EL050.cbl
 19696 6680-READ-CTBL-TABLE.
 19697*
 19698* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19699* TO COMPUTE LIFE COMMISSION
 19700
 19701     IF CTBL-SW = '0540'
 19702        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19703        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19704        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19705
 19706     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19707
 19708     IF CTBL-TABLE-FOUND
 19709        IF CTBL-SW = '0530'
 19710             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19711                                    * PB-I-AH-TERM
 19712             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19713             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19714        ELSE
 19715             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19716             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19717             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19718     ELSE
 19719        IF FIRST-TIME-THROUGH
 19720            GO TO 6680-READ-CTBL-TABLE
 19721        ELSE
 19722            MOVE ZEROS         TO WS-SUB1.
 19723
 19724 6680-SET-COMMISSION.
 19725     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19726           MOVE ZEROS          TO WS-SUB1
 19727       ELSE
 19728           MOVE RESC-COMMISSION-PER (WS-SUB)
 19729                               TO WS-COMMISSION
 19730           IF CTBL-SW = '0530'
 19731               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19732           ELSE
 19733               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19734
 19735 6680-SEARCH-CATEGORY.
 19736     ADD +1                   TO WS-SUB.
 19737     IF WS-SUB > +12
 19738         GO TO 6680-EXIT.
 19739
 19740     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19741          MOVE WS-SUB         TO WS-SUB1
 19742          GO TO 6680-EXIT.
 19743
 19744     GO TO 6680-SEARCH-CATEGORY.
 19745
 19746 6680-EXIT.
 19747     EXIT.
 19748
 19749 6690-END-OF-FILE.
 19750     GO TO 6700-COMM-EXIT.
 19751
 19752 6690-ERRESC-PROBLEM.
 19753      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 359
* EL050.cbl
 19754      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19755
 19756      GO TO 6700-COMM-EXIT.
 19757
 19758 6700-COMM-EXIT.
 19759     EXIT.
 19760
 19761 7000-GET-RATE.
 19762
 19763* EXEC CICS LINK
 19764*        PROGRAM    ('ELRATE')
 19765*        COMMAREA   (CALCULATION-PASS-AREA)
 19766*        LENGTH     (CP-COMM-LENGTH)
 19767*    END-EXEC.
 19768     MOVE 'ELRATE' TO DFHEIV1
 19769*    MOVE '."C                   (   #00019542' TO DFHEIV0
 19770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19772     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 19773     CALL 'kxdfhei1' USING DFHEIV0,
 19774           DFHEIV1,
 19775           CALCULATION-PASS-AREA,
 19776           CP-COMM-LENGTH,
 19777           DFHEIV99,
 19778           DFHEIV99,
 19779           DFHEIV99,
 19780           DFHEIV99
 19781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19782
 19783
 19784 7000-EXIT.
 19785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 360
* EL050.cbl
 19787 7100-FIND-BENEFIT-IN-STATE.
 19788     MOVE 'N'                    TO BEN-SEARCH-SW.
 19789
 19790     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19791         VARYING SUB3 FROM 1 BY 1 UNTIL
 19792            ((SUB3 GREATER 50) OR
 19793              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19794               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19795
 19796     IF SUB3 NOT = 51
 19797         MOVE 'Y'                TO BEN-SEARCH-SW.
 19798
 19799     GO TO 7199-EXIT.
 19800
 19801 7100-BENEFIT-DUMMY.
 19802
 19803 7100-DUMMY-EXIT.
 19804     EXIT.
 19805
 19806 7199-EXIT.
 19807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 361
* EL050.cbl
 19809 7200-FIND-BENEFIT.
 19810     MOVE 'N'                    TO BEN-SEARCH-SW.
 19811
 19812     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19813         VARYING SUB3 FROM 1 BY 1 UNTIL
 19814            ((SUB3 GREATER 8) OR
 19815            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19816
 19817     IF SUB3 NOT = 9
 19818         MOVE 'Y'                TO BEN-SEARCH-SW.
 19819
 19820     GO TO 7200-EXIT.
 19821
 19822 7200-BENEFIT-DUMMY.
 19823
 19824 7200-DUMMY-EXIT.
 19825     EXIT.
 19826
 19827 7200-EXIT.
 19828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 362
* EL050.cbl
 19830 7250-LOOK-FOR-RESCINDED-CLAIM.
 19831     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19832                                    W-CL-COMP-CD.
 19833     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19834                                    W-CL-CERT-NO.
 19835
 19836
 19837* EXEC CICS HANDLE CONDITION
 19838*        NOTFND  (7250-CONTINUE)
 19839*        ENDFILE (7250-CONTINUE)
 19840*    END-EXEC.
 19841*    MOVE '"$I''                  ! ) #00019600' TO DFHEIV0
 19842     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19844     MOVE X'2920233030303139363030' TO DFHEIV0(25:11)
 19845     CALL 'kxdfhei1' USING DFHEIV0
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19847
 19848
 19849
 19850* EXEC CICS IGNORE CONDITION
 19851*        DUPKEY
 19852*    END-EXEC.
 19853*    MOVE '"*$                   !   #00019605' TO DFHEIV0
 19854     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19856     MOVE X'2020233030303139363035' TO DFHEIV0(25:11)
 19857     CALL 'kxdfhei1' USING DFHEIV0
 19858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19859
 19860
 19861
 19862* EXEC CICS STARTBR
 19863*        DATASET   (CLMS-ID)
 19864*        RIDFLD    (ELMSTR-KEY)
 19865*        GENERIC   EQUAL
 19866*        KEYLENGTH (ELMSTR-LENGTH)
 19867*    END-EXEC.
 19868     MOVE 0
 19869       TO DFHEIV11
 19870*    MOVE '&,   KG    E          &   #00019609' TO DFHEIV0
 19871     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19872     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19873     MOVE X'2020233030303139363039' TO DFHEIV0(25:11)
 19874     CALL 'kxdfhei1' USING DFHEIV0,
 19875           CLMS-ID,
 19876           ELMSTR-KEY,
 19877           ELMSTR-LENGTH,
 19878           DFHEIV11,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883     MOVE 'Y'                    TO W-BROWSE-SW.
 19884
 19885 7250-NEXT-CLAIM.
 19886
 19887
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 363
* EL050.cbl
 19888* EXEC CICS READNEXT
 19889*        DATASET   (CLMS-ID)
 19890*        RIDFLD    (ELMSTR-KEY)
 19891*        SET       (ADDRESS OF CLAIM-MASTER)
 19892*    END-EXEC.
 19893     MOVE 0
 19894       TO DFHEIV11
 19895*    MOVE '&.S                   )   #00019620' TO DFHEIV0
 19896     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19898     MOVE X'2020233030303139363230' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0,
 19900           CLMS-ID,
 19901           DFHEIV20,
 19902           DFHEIV99,
 19903           ELMSTR-KEY,
 19904           DFHEIV99,
 19905           DFHEIV11,
 19906           DFHEIV99,
 19907           DFHEIV99
 19908     SET ADDRESS OF CLAIM-MASTER TO
 19909         DFHEIV20
 19910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19911
 19912
 19913     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19914        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19915         GO TO 7250-CONTINUE
 19916     END-IF.
 19917
 19918     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19919        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19920        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19921        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19922        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19923         GO TO 7250-NEXT-CLAIM
 19924     END-IF.
 19925
 19926     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19927        OR (CL-CLAIM-TYPE = 'I')
 19928        OR (CL-CLAIM-TYPE = 'G')
 19929        OR (CL-CLAIM-TYPE = 'F')
 19930          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19931              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19932              GO TO 7250-CONTINUE
 19933          END-IF
 19934     END-IF.
 19935
 19936     GO TO 7250-NEXT-CLAIM.
 19937
 19938 7250-CONTINUE.
 19939
 19940     IF W-BROWSE-SW = 'Y'
 19941
 19942* EXEC CICS ENDBR
 19943*            DATASET   (CLMS-ID)
 19944*        END-EXEC
 19945     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 364
* EL050.cbl
 19946       TO DFHEIV11
 19947*    MOVE '&2                    $   #00019654' TO DFHEIV0
 19948     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19949     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19950     MOVE X'2020233030303139363534' TO DFHEIV0(25:11)
 19951     CALL 'kxdfhei1' USING DFHEIV0,
 19952           CLMS-ID,
 19953           DFHEIV11,
 19954           DFHEIV99
 19955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19956         MOVE 'N' TO W-BROWSE-SW
 19957     END-IF.
 19958
 19959 7250-EXIT.
 19960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 365
* EL050.cbl
 19962 7300-CHECK-FOR-OPEN-CLMS.
 19963
 19964*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19965*    MOVE SPACES                 TO CNTL-ACCESS.
 19966*    MOVE '1'                    TO CNTL-REC-TYPE.
 19967*    MOVE +0                     TO CNTL-SEQ-NO.
 19968
 19969*    MOVE '3'                    TO RC-SW-1.
 19970*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19971
 19972*    IF NOT CF-COMPANY-MASTER
 19973*         PERFORM 0099-COMPANY-NOT-FOUND
 19974*         GO TO 7300-EXIT.
 19975
 19976     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19977                                    W-CL-COMP-CD.
 19978     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19979                                    W-CL-CERT-NO.
 19980
 19981
 19982* EXEC CICS HANDLE CONDITION
 19983*        NOTFND  (7300-CONTINUE)
 19984*        ENDFILE (7300-CONTINUE)
 19985*    END-EXEC.
 19986*    MOVE '"$I''                  ! * #00019682' TO DFHEIV0
 19987     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19989     MOVE X'2A20233030303139363832' TO DFHEIV0(25:11)
 19990     CALL 'kxdfhei1' USING DFHEIV0
 19991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19992
 19993
 19994
 19995* EXEC CICS IGNORE CONDITION
 19996*        DUPKEY
 19997*    END-EXEC.
 19998*    MOVE '"*$                   !   #00019687' TO DFHEIV0
 19999     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303139363837' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006
 20007* EXEC CICS STARTBR
 20008*        DATASET   (CLMS-ID)
 20009*        RIDFLD    (ELMSTR-KEY)
 20010*        GENERIC   EQUAL
 20011*        KEYLENGTH (ELMSTR-LENGTH)
 20012*    END-EXEC.
 20013     MOVE 0
 20014       TO DFHEIV11
 20015*    MOVE '&,   KG    E          &   #00019691' TO DFHEIV0
 20016     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20017     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20018     MOVE X'2020233030303139363931' TO DFHEIV0(25:11)
 20019     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 366
* EL050.cbl
 20020           CLMS-ID,
 20021           ELMSTR-KEY,
 20022           ELMSTR-LENGTH,
 20023           DFHEIV11,
 20024           DFHEIV99
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028     MOVE 'Y'                    TO W-BROWSE-SW.
 20029
 20030 7300-NEXT-CLAIM.
 20031
 20032
 20033* EXEC CICS READNEXT
 20034*        DATASET   (CLMS-ID)
 20035*        RIDFLD    (ELMSTR-KEY)
 20036*        SET       (ADDRESS OF CLAIM-MASTER)
 20037*    END-EXEC.
 20038     MOVE 0
 20039       TO DFHEIV11
 20040*    MOVE '&.S                   )   #00019702' TO DFHEIV0
 20041     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20043     MOVE X'2020233030303139373032' TO DFHEIV0(25:11)
 20044     CALL 'kxdfhei1' USING DFHEIV0,
 20045           CLMS-ID,
 20046           DFHEIV20,
 20047           DFHEIV99,
 20048           ELMSTR-KEY,
 20049           DFHEIV99,
 20050           DFHEIV11,
 20051           DFHEIV99,
 20052           DFHEIV99
 20053     SET ADDRESS OF CLAIM-MASTER TO
 20054         DFHEIV20
 20055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20056
 20057
 20058     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20059        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20060         GO TO 7300-CONTINUE.
 20061
 20062     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20063        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20064        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20065        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20066        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20067         GO TO 7300-NEXT-CLAIM.
 20068
 20069*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20070     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20071        OR (CL-CLAIM-TYPE = 'I')
 20072        OR (CL-CLAIM-TYPE = 'G')
 20073        OR (CL-CLAIM-TYPE = 'F')
 20074        IF CLAIM-IS-OPEN
 20075           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20076             AND PB-C-AH-CANCEL-DT > SPACES
 20077              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 367
* EL050.cbl
 20078              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20079           END-IF
 20080           EVALUATE TRUE
 20081             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20082                 MOVE ER-2884      TO WS-ERROR
 20083             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20084                 MOVE ER-2887      TO WS-ERROR
 20085             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20086                 MOVE ER-2886      TO WS-ERROR
 20087             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20088                 MOVE ER-2888      TO WS-ERROR
 20089             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20090                 MOVE ER-2885      TO WS-ERROR
 20091             WHEN OTHER
 20092                 MOVE ER-2768      TO WS-ERROR
 20093           END-EVALUATE
 20094           IF PB-C-AH-CANCEL-VOIDED OR
 20095              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20096                NOT AH-COVERAGE-CANCELLED)
 20097               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20098               MOVE ER-2768      TO WS-ERROR
 20099           END-IF
 20100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20101           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20102              PB-FORCE-CODE NOT EQUAL '8'
 20103               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20104           END-IF
 20105           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20106           GO TO 7300-NEXT-CLAIM
 20107        ELSE
 20108           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20109*****THIS IS A RESCISSION OR REFORMATION
 20110              IF AH-COVERAGE-CANCELLED
 20111                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20112                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20113                    MOVE 1                   TO DC-ELAPSED-DAYS
 20114                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20115                    SET BIN-PLUS-ELAPSED     TO TRUE
 20116                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20117                    IF NO-CONVERSION-ERROR
 20118                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20119                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20120                          MOVE ER-2897 TO WS-ERROR
 20121                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20122                          GO TO 7300-NEXT-CLAIM
 20123                       END-IF
 20124                    END-IF
 20125                 ELSE
 20126                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20127                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20128                         MOVE ER-2890 TO WS-ERROR
 20129                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20130                         GO TO 7300-NEXT-CLAIM
 20131                      ELSE
 20132                         MOVE ER-2898 TO WS-ERROR
 20133                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20134                         GO TO 7300-NEXT-CLAIM
 20135                      END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 368
* EL050.cbl
 20136                   END-IF
 20137                 END-IF
 20138              END-IF
 20139           ELSE
 20140              IF CL-DENIAL-TYPE = '1'  AND
 20141                 CL-TOTAL-PAID-AMT = 0
 20142                    GO TO 7300-NEXT-CLAIM
 20143              END-IF
 20144              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20145               AND PB-C-AH-CANCEL-DT > SPACES
 20146                 MOVE ER-2756        TO WS-ERROR
 20147                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20148                 GO TO 7300-NEXT-CLAIM
 20149              END-IF
 20150           END-IF
 20151        END-IF
 20152     ELSE
 20153*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20154        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20155          OR (CL-CLAIM-TYPE = 'O')
 20156           IF (CLAIM-IS-OPEN)
 20157              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20158                 <> zeros
 20159              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20160                 <> zeros)
 20161              MOVE ER-2889      TO WS-ERROR
 20162              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20163              GO TO 7300-NEXT-CLAIM
 20164           ELSE
 20165              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20166*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20167                 IF (LF-COVERAGE-CANCELLED AND
 20168                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20169                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20170                         MOVE ER-2890 TO WS-ERROR
 20171                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20172                         GO TO 7300-NEXT-CLAIM
 20173                      ELSE
 20174                         MOVE ER-2898 TO WS-ERROR
 20175                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20176                         GO TO 7300-NEXT-CLAIM
 20177                      END-IF
 20178                 END-IF
 20179              ELSE
 20180                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20181                    and (CL-TOTAL-PAID-AMT = 0)
 20182                    GO TO 7300-NEXT-CLAIM
 20183                 END-IF
 20184                 IF (
 20185                      (AH-COVERAGE-CANCELLED)
 20186                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20187                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20188                      and (pb-ci-ah-cancel-amt +
 20189                         pb-c-ah-cancel-amt) <> zeros
 20190                    )
 20191                               OR
 20192                    (
 20193                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 369
* EL050.cbl
 20194                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20195                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20196                      and (pb-ci-lf-cancel-amt +
 20197                         pb-c-lf-cancel-amt) <> zeros
 20198                    )
 20199                       IF CL-CLAIM-TYPE = 'O'
 20200                          MOVE ER-2998 TO WS-ERROR
 20201                       ELSE
 20202                          MOVE ER-2965 TO WS-ERROR
 20203                       END-IF
 20204                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20205                       GO TO 7300-NEXT-CLAIM
 20206                 END-IF
 20207                 IF LF-COVERAGE-CANCELLED
 20208                  IF CL-TOTAL-PAID-AMT > 0
 20209                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20210                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20211                        MOVE ER-2891 TO WS-ERROR
 20212                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20213                        GO TO 7300-NEXT-CLAIM
 20214                      END-IF
 20215                    ELSE
 20216****only show this error if cert num matches exactly
 20217                      IF PB-CERT-NO = CL-CERT-NO
 20218                         IF CL-CLAIM-TYPE = 'O'
 20219                            MOVE ER-2895 TO WS-ERROR
 20220                         ELSE
 20221                            MOVE ER-2892 TO WS-ERROR
 20222                         END-IF
 20223                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20224                         GO TO 7300-NEXT-CLAIM
 20225                      END-IF
 20226                    END-IF
 20227                  END-IF
 20228                 END-IF
 20229              END-IF
 20230           END-IF
 20231        END-IF
 20232     END-IF
 20233
 20234     GO TO 7300-NEXT-CLAIM.
 20235
 20236 7300-CONTINUE.
 20237
 20238     IF W-BROWSE-SW = 'Y'
 20239
 20240* EXEC CICS ENDBR
 20241*            DATASET   (CLMS-ID)
 20242*        END-EXEC.
 20243     MOVE 0
 20244       TO DFHEIV11
 20245*    MOVE '&2                    $   #00019889' TO DFHEIV0
 20246     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20248     MOVE X'2020233030303139383839' TO DFHEIV0(25:11)
 20249     CALL 'kxdfhei1' USING DFHEIV0,
 20250           CLMS-ID,
 20251           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 370
* EL050.cbl
 20252           DFHEIV99
 20253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20254
 20255
 20256 7300-EXIT.
 20257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 371
* EL050.cbl
 20259 7320-CHECK-FOR-OPEN-CLMS-issue.
 20260
 20261     move ' '                    to w-browse-sw
 20262     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20263                                    W-CL-COMP-CD
 20264     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20265                                    W-CL-CERT-NO
 20266
 20267
 20268* EXEC CICS HANDLE CONDITION
 20269*        NOTFND  (7320-CONTINUE)
 20270*        ENDFILE (7320-CONTINUE)
 20271*    END-EXEC.
 20272*    MOVE '"$I''                  ! + #00019904' TO DFHEIV0
 20273     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20275     MOVE X'2B20233030303139393034' TO DFHEIV0(25:11)
 20276     CALL 'kxdfhei1' USING DFHEIV0
 20277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20278
 20279
 20280
 20281* EXEC CICS IGNORE CONDITION
 20282*        DUPKEY
 20283*    END-EXEC.
 20284*    MOVE '"*$                   !   #00019909' TO DFHEIV0
 20285     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20287     MOVE X'2020233030303139393039' TO DFHEIV0(25:11)
 20288     CALL 'kxdfhei1' USING DFHEIV0
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292
 20293* EXEC CICS STARTBR
 20294*        DATASET   (CLMS-ID)
 20295*        RIDFLD    (ELMSTR-KEY)
 20296*        GENERIC   EQUAL
 20297*        KEYLENGTH (ELMSTR-LENGTH)
 20298*    END-EXEC.
 20299     MOVE 0
 20300       TO DFHEIV11
 20301*    MOVE '&,   KG    E          &   #00019913' TO DFHEIV0
 20302     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20304     MOVE X'2020233030303139393133' TO DFHEIV0(25:11)
 20305     CALL 'kxdfhei1' USING DFHEIV0,
 20306           CLMS-ID,
 20307           ELMSTR-KEY,
 20308           ELMSTR-LENGTH,
 20309           DFHEIV11,
 20310           DFHEIV99
 20311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20312
 20313
 20314     MOVE 'Y'                    TO W-BROWSE-SW.
 20315
 20316 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 372
* EL050.cbl
 20317
 20318
 20319* EXEC CICS READNEXT
 20320*        DATASET   (CLMS-ID)
 20321*        RIDFLD    (ELMSTR-KEY)
 20322*        SET       (ADDRESS OF CLAIM-MASTER)
 20323*    END-EXEC.
 20324     MOVE 0
 20325       TO DFHEIV11
 20326*    MOVE '&.S                   )   #00019924' TO DFHEIV0
 20327     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20329     MOVE X'2020233030303139393234' TO DFHEIV0(25:11)
 20330     CALL 'kxdfhei1' USING DFHEIV0,
 20331           CLMS-ID,
 20332           DFHEIV20,
 20333           DFHEIV99,
 20334           ELMSTR-KEY,
 20335           DFHEIV99,
 20336           DFHEIV11,
 20337           DFHEIV99,
 20338           DFHEIV99
 20339     SET ADDRESS OF CLAIM-MASTER TO
 20340         DFHEIV20
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20345        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20346         GO TO 7320-CONTINUE.
 20347
 20348     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20349        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20350        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20351        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20352        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20353         GO TO 7320-NEXT-CLAIM.
 20354
 20355     IF CLAIM-IS-OPEN
 20356        MOVE ER-3273             TO WS-ERROR
 20357        PERFORM 9900-ERROR-FORMAT
 20358                                 THRU 9900-EXIT
 20359     END-IF
 20360     if pb-i-entry-status = 'V'
 20361        IF CLAIM-IS-OPEN
 20362             OR
 20363           CL-LAST-PMT-DT NOT = LOW-VALUES
 20364             OR
 20365           CL-LAST-PMT-AMT > 0
 20366           MOVE ER-3281          TO WS-ERROR
 20367           PERFORM 9900-ERROR-FORMAT
 20368                                 THRU 9900-EXIT
 20369        END-IF
 20370     END-IF
 20371
 20372     GO TO 7320-NEXT-CLAIM.
 20373
 20374 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 373
* EL050.cbl
 20375
 20376     IF W-BROWSE-SW = 'Y'
 20377
 20378* EXEC CICS ENDBR
 20379*            DATASET   (CLMS-ID)
 20380*        END-EXEC.
 20381     MOVE 0
 20382       TO DFHEIV11
 20383*    MOVE '&2                    $   #00019963' TO DFHEIV0
 20384     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20385     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20386     MOVE X'2020233030303139393633' TO DFHEIV0(25:11)
 20387     CALL 'kxdfhei1' USING DFHEIV0,
 20388           CLMS-ID,
 20389           DFHEIV11,
 20390           DFHEIV99
 20391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20392
 20393
 20394 7320-EXIT.
 20395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 374
* EL050.cbl
 20397 7400-GET-REMAIN-TERM.
 20398
 20399* EXEC CICS LINK
 20400*        PROGRAM    ('ELRTRM')
 20401*        COMMAREA   (CALCULATION-PASS-AREA)
 20402*        LENGTH     (CP-COMM-LENGTH)
 20403*    END-EXEC.
 20404     MOVE 'ELRTRM' TO DFHEIV1
 20405*    MOVE '."C                   (   #00019971' TO DFHEIV0
 20406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20408     MOVE X'2020233030303139393731' TO DFHEIV0(25:11)
 20409     CALL 'kxdfhei1' USING DFHEIV0,
 20410           DFHEIV1,
 20411           CALCULATION-PASS-AREA,
 20412           CP-COMM-LENGTH,
 20413           DFHEIV99,
 20414           DFHEIV99,
 20415           DFHEIV99,
 20416           DFHEIV99
 20417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20418
 20419
 20420 7400-EXIT.
 20421     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 375
* EL050.cbl
 20423
 20424 7500-GET-REMAIN-AMOUNT.
 20425
 20426* EXEC CICS LINK
 20427*        PROGRAM    ('ELRAMT')
 20428*        COMMAREA   (CALCULATION-PASS-AREA)
 20429*        LENGTH     (CP-COMM-LENGTH)
 20430*    END-EXEC.
 20431     MOVE 'ELRAMT' TO DFHEIV1
 20432*    MOVE '."C                   (   #00019982' TO DFHEIV0
 20433     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20435     MOVE X'2020233030303139393832' TO DFHEIV0(25:11)
 20436     CALL 'kxdfhei1' USING DFHEIV0,
 20437           DFHEIV1,
 20438           CALCULATION-PASS-AREA,
 20439           CP-COMM-LENGTH,
 20440           DFHEIV99,
 20441           DFHEIV99,
 20442           DFHEIV99,
 20443           DFHEIV99
 20444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20445
 20446
 20447 7500-EXIT.
 20448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 376
* EL050.cbl
 20450
 20451 7600-GET-REFUND.
 20452
 20453* EXEC CICS LINK
 20454*        PROGRAM    ('ELRFND')
 20455*        COMMAREA   (CALCULATION-PASS-AREA)
 20456*        LENGTH     (CP-COMM-LENGTH)
 20457*    END-EXEC.
 20458     MOVE 'ELRFND' TO DFHEIV1
 20459*    MOVE '."C                   (   #00019993' TO DFHEIV0
 20460     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20462     MOVE X'2020233030303139393933' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0,
 20464           DFHEIV1,
 20465           CALCULATION-PASS-AREA,
 20466           CP-COMM-LENGTH,
 20467           DFHEIV99,
 20468           DFHEIV99,
 20469           DFHEIV99,
 20470           DFHEIV99
 20471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20472
 20473
 20474 7600-EXIT.
 20475     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 377
* EL050.cbl
 20477 7700-CALL-DL1.
 20478
 20479* EXEC CICS LINK
 20480*        PROGRAM    ('DLO001')
 20481*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20482*        LENGTH     (DLO001-COMM-LENGTH)
 20483*    END-EXEC.
 20484     MOVE 'DLO001' TO DFHEIV1
 20485*    MOVE '."C                   (   #00020003' TO DFHEIV0
 20486     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20488     MOVE X'2020233030303230303033' TO DFHEIV0(25:11)
 20489     CALL 'kxdfhei1' USING DFHEIV0,
 20490           DFHEIV1,
 20491           WS-DLO-MASTER-POLICY-FORM,
 20492           DLO001-COMM-LENGTH,
 20493           DFHEIV99,
 20494           DFHEIV99,
 20495           DFHEIV99,
 20496           DFHEIV99
 20497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20498
 20499
 20500 7700-EXIT.
 20501     EXIT.
 20502
 20503 7710-CALL-DL2.
 20504
 20505* EXEC CICS LINK
 20506*        PROGRAM    ('DLO002')
 20507*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20508*        LENGTH     (DLO002-COMM-LENGTH)
 20509*    END-EXEC.
 20510     MOVE 'DLO002' TO DFHEIV1
 20511*    MOVE '."C                   (   #00020013' TO DFHEIV0
 20512     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20514     MOVE X'2020233030303230303133' TO DFHEIV0(25:11)
 20515     CALL 'kxdfhei1' USING DFHEIV0,
 20516           DFHEIV1,
 20517           WS-DLO-INTERNAL-POLICY-FORM,
 20518           DLO002-COMM-LENGTH,
 20519           DFHEIV99,
 20520           DFHEIV99,
 20521           DFHEIV99,
 20522           DFHEIV99
 20523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20524
 20525
 20526 7710-EXIT.
 20527     EXIT.
 20528
 20529 7720-CALL-DL3.
 20530
 20531* EXEC CICS LINK
 20532*        PROGRAM    ('DLO003')
 20533*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20534*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 378
* EL050.cbl
 20535*    END-EXEC.
 20536     MOVE 'DLO003' TO DFHEIV1
 20537*    MOVE '."C                   (   #00020023' TO DFHEIV0
 20538     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20540     MOVE X'2020233030303230303233' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0,
 20542           DFHEIV1,
 20543           WS-DLO-VALID-BANK-ID,
 20544           DLO003-COMM-LENGTH,
 20545           DFHEIV99,
 20546           DFHEIV99,
 20547           DFHEIV99,
 20548           DFHEIV99
 20549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20550
 20551
 20552 7720-EXIT.
 20553     EXIT.
 20554
 20555 7730-CALL-DL7.
 20556
 20557* EXEC CICS LINK
 20558*        PROGRAM    ('DLO007')
 20559*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20560*        LENGTH     (DLO007-COMM-LENGTH)
 20561*    END-EXEC.
 20562     MOVE 'DLO007' TO DFHEIV1
 20563*    MOVE '."C                   (   #00020033' TO DFHEIV0
 20564     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20566     MOVE X'2020233030303230303333' TO DFHEIV0(25:11)
 20567     CALL 'kxdfhei1' USING DFHEIV0,
 20568           DFHEIV1,
 20569           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20570           DLO007-COMM-LENGTH,
 20571           DFHEIV99,
 20572           DFHEIV99,
 20573           DFHEIV99,
 20574           DFHEIV99
 20575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20576
 20577
 20578 7730-EXIT.
 20579     EXIT.
 20580
 20581 7740-CALL-DL11.
 20582
 20583* EXEC CICS LINK
 20584*        PROGRAM    ('DLO011')
 20585*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20586*        LENGTH     (DLO011-COMM-LENGTH)
 20587*    END-EXEC.
 20588     MOVE 'DLO011' TO DFHEIV1
 20589*    MOVE '."C                   (   #00020043' TO DFHEIV0
 20590     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20592     MOVE X'2020233030303230303433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 379
* EL050.cbl
 20593     CALL 'kxdfhei1' USING DFHEIV0,
 20594           DFHEIV1,
 20595           WS-DLO-PREM-RATES-BEN-TYPE,
 20596           DLO011-COMM-LENGTH,
 20597           DFHEIV99,
 20598           DFHEIV99,
 20599           DFHEIV99,
 20600           DFHEIV99
 20601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20602
 20603
 20604 7740-EXIT.
 20605     EXIT.
 20606
 20607 7750-CALL-DL17.
 20608
 20609* EXEC CICS LINK
 20610*        PROGRAM    ('DLO017')
 20611*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20612*        LENGTH     (DLO017-COMM-LENGTH)
 20613*    END-EXEC.
 20614     MOVE 'DLO017' TO DFHEIV1
 20615*    MOVE '."C                   (   #00020053' TO DFHEIV0
 20616     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20618     MOVE X'2020233030303230303533' TO DFHEIV0(25:11)
 20619     CALL 'kxdfhei1' USING DFHEIV0,
 20620           DFHEIV1,
 20621           WS-DLO-VALID-RATE-CODE,
 20622           DLO017-COMM-LENGTH,
 20623           DFHEIV99,
 20624           DFHEIV99,
 20625           DFHEIV99,
 20626           DFHEIV99
 20627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20628
 20629
 20630 7750-EXIT.
 20631     EXIT.
 20632
 20633 7755-CALL-DL19.
 20634
 20635* EXEC CICS LINK
 20636*        PROGRAM    ('DLO019')
 20637*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20638*        LENGTH     (DLO019-COMM-LENGTH)
 20639*    END-EXEC.
 20640     MOVE 'DLO019' TO DFHEIV1
 20641*    MOVE '."C                   (   #00020063' TO DFHEIV0
 20642     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20644     MOVE X'2020233030303230303633' TO DFHEIV0(25:11)
 20645     CALL 'kxdfhei1' USING DFHEIV0,
 20646           DFHEIV1,
 20647           WS-DLO-ORIG-COV-CAT,
 20648           DLO019-COMM-LENGTH,
 20649           DFHEIV99,
 20650           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 380
* EL050.cbl
 20651           DFHEIV99,
 20652           DFHEIV99
 20653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20654
 20655
 20656 7755-EXIT.
 20657     EXIT.
 20658
 20659 7760-CALL-DL21.
 20660
 20661* EXEC CICS LINK
 20662*        PROGRAM    ('DLO021')
 20663*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20664*        LENGTH     (DLO021-COMM-LENGTH)
 20665*    END-EXEC.
 20666     MOVE 'DLO021' TO DFHEIV1
 20667*    MOVE '."C                   (   #00020073' TO DFHEIV0
 20668     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20670     MOVE X'2020233030303230303733' TO DFHEIV0(25:11)
 20671     CALL 'kxdfhei1' USING DFHEIV0,
 20672           DFHEIV1,
 20673           WS-DLO-VALID-LOAN-OFFICER,
 20674           DLO021-COMM-LENGTH,
 20675           DFHEIV99,
 20676           DFHEIV99,
 20677           DFHEIV99,
 20678           DFHEIV99
 20679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20680
 20681
 20682 7760-EXIT.
 20683     EXIT.
 20684
 20685 7770-CALL-DL22.
 20686
 20687* EXEC CICS LINK
 20688*        PROGRAM    ('DLO022')
 20689*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20690*        LENGTH     (DLO022-COMM-LENGTH)
 20691*    END-EXEC.
 20692     MOVE 'DLO022' TO DFHEIV1
 20693*    MOVE '."C                   (   #00020083' TO DFHEIV0
 20694     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20696     MOVE X'2020233030303230303833' TO DFHEIV0(25:11)
 20697     CALL 'kxdfhei1' USING DFHEIV0,
 20698           DFHEIV1,
 20699           WS-DLO-VALID-STATE-CODE,
 20700           DLO022-COMM-LENGTH,
 20701           DFHEIV99,
 20702           DFHEIV99,
 20703           DFHEIV99,
 20704           DFHEIV99
 20705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20706
 20707
 20708 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 381
* EL050.cbl
 20709     EXIT.
 20710
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 382
* EL050.cbl
 20712
 20713 7780-CALL-AGG.
 20714
 20715* EXEC CICS LINK
 20716*        PROGRAM    ('ELAGGO')
 20717*        COMMAREA   (WS-PASS-to-pemaggo)
 20718*        LENGTH     (ws-passed-key-LENGTH)
 20719*    END-EXEC.
 20720     MOVE 'ELAGGO' TO DFHEIV1
 20721*    MOVE '."C                   (   #00020095' TO DFHEIV0
 20722     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20724     MOVE X'2020233030303230303935' TO DFHEIV0(25:11)
 20725     CALL 'kxdfhei1' USING DFHEIV0,
 20726           DFHEIV1,
 20727           WS-PASS-to-pemaggo,
 20728           ws-passed-key-LENGTH,
 20729           DFHEIV99,
 20730           DFHEIV99,
 20731           DFHEIV99,
 20732           DFHEIV99
 20733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20734
 20735 7780-EXIT.
 20736     EXIT.
 20737 7785-CALL-HLDI.
 20738
 20739* EXEC CICS LINK
 20740*        PROGRAM    ('ELHLDI')
 20741*        COMMAREA   (HLDI-PASS-AREA)
 20742*        LENGTH     (HLDI-PASS-AREA-LEN)
 20743*    END-EXEC.
 20744     MOVE 'ELHLDI' TO DFHEIV1
 20745*    MOVE '."C                   (   #00020103' TO DFHEIV0
 20746     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20748     MOVE X'2020233030303230313033' TO DFHEIV0(25:11)
 20749     CALL 'kxdfhei1' USING DFHEIV0,
 20750           DFHEIV1,
 20751           HLDI-PASS-AREA,
 20752           HLDI-PASS-AREA-LEN,
 20753           DFHEIV99,
 20754           DFHEIV99,
 20755           DFHEIV99,
 20756           DFHEIV99
 20757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20758
 20759 7785-EXIT.
 20760     EXIT.
 20761 7786-CALL-HLDIM.
 20762
 20763* EXEC CICS LINK
 20764*        PROGRAM    ('ELHLDIM')
 20765*        COMMAREA   (HLDI-PASS-AREA)
 20766*        LENGTH     (HLDI-PASS-AREA-LEN)
 20767*    END-EXEC.
 20768     MOVE 'ELHLDIM' TO DFHEIV1
 20769*    MOVE '."C                   (   #00020111' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 383
* EL050.cbl
 20770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20772     MOVE X'2020233030303230313131' TO DFHEIV0(25:11)
 20773     CALL 'kxdfhei1' USING DFHEIV0,
 20774           DFHEIV1,
 20775           HLDI-PASS-AREA,
 20776           HLDI-PASS-AREA-LEN,
 20777           DFHEIV99,
 20778           DFHEIV99,
 20779           DFHEIV99,
 20780           DFHEIV99
 20781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20782
 20783 7786-EXIT.
 20784     EXIT.
 20785 7790-CALL-ZIP-VERIFY.
 20786
 20787
 20788* EXEC CICS LINK
 20789*        PROGRAM    ('WSZIPCD')
 20790*        COMMAREA   (ZIPCD-PASS-AREA)
 20791*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20792*    END-EXEC.
 20793     MOVE 'WSZIPCD' TO DFHEIV1
 20794*    MOVE '."C                   (   #00020120' TO DFHEIV0
 20795     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20797     MOVE X'2020233030303230313230' TO DFHEIV0(25:11)
 20798     CALL 'kxdfhei1' USING DFHEIV0,
 20799           DFHEIV1,
 20800           ZIPCD-PASS-AREA,
 20801           ZIPCD-PASS-AREA-LEN,
 20802           DFHEIV99,
 20803           DFHEIV99,
 20804           DFHEIV99,
 20805           DFHEIV99
 20806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20807
 20808
 20809 7790-EXIT.
 20810     EXIT.
 20811 7795-call-sqlclmhs.
 20812
 20813
 20814* EXEC CICS LINK
 20815*        PROGRAM    ('SQLCLMHS')
 20816*        COMMAREA   (clmhs-PASS-AREA)
 20817*        LENGTH     (clmhs-PASS-AREA-LEN)
 20818*    END-EXEC.
 20819     MOVE 'SQLCLMHS' TO DFHEIV1
 20820*    MOVE '."C                   (   #00020130' TO DFHEIV0
 20821     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20823     MOVE X'2020233030303230313330' TO DFHEIV0(25:11)
 20824     CALL 'kxdfhei1' USING DFHEIV0,
 20825           DFHEIV1,
 20826           clmhs-PASS-AREA,
 20827           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 384
* EL050.cbl
 20828           DFHEIV99,
 20829           DFHEIV99,
 20830           DFHEIV99,
 20831           DFHEIV99
 20832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20833
 20834
 20835 7795-EXIT.
 20836     EXIT.
 20837 7800-REWRITE-CERT.
 20838******************************************************************
 20839*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20840*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20841******************************************************************
 20842
 20843     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20844        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20845        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20846        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20847
 20848* EXEC CICS REWRITE
 20849*                  DATASET (CERT-ID)
 20850*                  FROM    (CERTIFICATE-MASTER)
 20851*              END-EXEC
 20852     MOVE LENGTH OF
 20853      CERTIFICATE-MASTER
 20854       TO DFHEIV11
 20855*    MOVE '&& L                  %   #00020148' TO DFHEIV0
 20856     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303230313438' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           CERT-ID,
 20861           CERTIFICATE-MASTER,
 20862           DFHEIV11,
 20863           DFHEIV99
 20864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20865        GO TO 7800-EXIT.
 20866
 20867       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20868       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20869
 20870 7800-EXIT.
 20871      EXIT.
 20872
 20873 7900-DELETE-CERT.
 20874
 20875* EXEC CICS DELETE
 20876*        DATASET (CERT-ID)
 20877*    END-EXEC.
 20878*    MOVE '&(                    &   #00020161' TO DFHEIV0
 20879     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20881     MOVE X'2020233030303230313631' TO DFHEIV0(25:11)
 20882     CALL 'kxdfhei1' USING DFHEIV0,
 20883           CERT-ID,
 20884           DFHEIV99,
 20885           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 385
* EL050.cbl
 20886           DFHEIV99,
 20887           DFHEIV99
 20888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20889
 20890
 20891 7900-EXIT.
 20892     EXIT.
 20893
 20894 8000-WRITE-CERT.
 20895
 20896* EXEC CICS HANDLE CONDITION
 20897*        DUPKEY    (8000-FREE-MAIN)
 20898*    END-EXEC.
 20899*    MOVE '"$$                   ! , #00020169' TO DFHEIV0
 20900     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20902     MOVE X'2C20233030303230313639' TO DFHEIV0(25:11)
 20903     CALL 'kxdfhei1' USING DFHEIV0
 20904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20905
 20906
 20907
 20908* EXEC CICS WRITE
 20909*        DATASET     (CERT-ID)
 20910*        FROM        (CERTIFICATE-MASTER)
 20911*        RIDFLD      (ELCERT-KEY)
 20912*    END-EXEC.
 20913     MOVE LENGTH OF
 20914      CERTIFICATE-MASTER
 20915       TO DFHEIV11
 20916*    MOVE '&$ L                  ''   #00020173' TO DFHEIV0
 20917     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20919     MOVE X'2020233030303230313733' TO DFHEIV0(25:11)
 20920     CALL 'kxdfhei1' USING DFHEIV0,
 20921           CERT-ID,
 20922           CERTIFICATE-MASTER,
 20923           DFHEIV11,
 20924           ELCERT-KEY,
 20925           DFHEIV99,
 20926           DFHEIV99
 20927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20928
 20929
 20930 8000-FREE-MAIN.
 20931
 20932 8000-EXIT.
 20933      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 386
* EL050.cbl
 20935
 20936 8100-READ-ERPNDM.
 20937
 20938* EXEC CICS HANDLE CONDITION
 20939*         NOTFND     (8100-NOTFND)
 20940*         ENDFILE    (8100-NOTFND)
 20941*    END-EXEC.
 20942*    MOVE '"$I''                  ! - #00020186' TO DFHEIV0
 20943     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20945     MOVE X'2D20233030303230313836' TO DFHEIV0(25:11)
 20946     CALL 'kxdfhei1' USING DFHEIV0
 20947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20948
 20949
 20950     MOVE SPACES                 TO ERPNDM-FOUND.
 20951     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20952
 20953
 20954* EXEC CICS READ UPDATE
 20955*         DATASET   (FILE-ERPNDM)
 20956*         RIDFLD    (PM-CONTROL-PRIMARY)
 20957*         INTO      (PENDING-MAILING-DATA)
 20958*    END-EXEC.
 20959     MOVE LENGTH OF
 20960      PENDING-MAILING-DATA
 20961       TO DFHEIV11
 20962*    MOVE '&"IL       EU         (   #00020194' TO DFHEIV0
 20963     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20964     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20965     MOVE X'2020233030303230313934' TO DFHEIV0(25:11)
 20966     CALL 'kxdfhei1' USING DFHEIV0,
 20967           FILE-ERPNDM,
 20968           PENDING-MAILING-DATA,
 20969           DFHEIV11,
 20970           PM-CONTROL-PRIMARY,
 20971           DFHEIV99,
 20972           DFHEIV99,
 20973           DFHEIV99
 20974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20975
 20976
 20977     GO TO 8100-EXIT.
 20978
 20979 8100-NOTFND.
 20980
 20981     MOVE 'X'                    TO ERPNDM-FOUND.
 20982     MOVE ER-2694                TO WS-ERROR.
 20983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20984     MOVE ER-2883                TO WS-ERROR
 20985     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20986     .
 20987 8100-EXIT.
 20988     EXIT.
 20989 8102-REWRITE-ERPNDM.
 20990
 20991
 20992* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 387
* EL050.cbl
 20993*         DATASET    (FILE-ERPNDM)
 20994*         FROM       (PENDING-MAILING-DATA)
 20995*    END-EXEC
 20996     MOVE LENGTH OF
 20997      PENDING-MAILING-DATA
 20998       TO DFHEIV11
 20999*    MOVE '&& L                  %   #00020214' TO DFHEIV0
 21000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21002     MOVE X'2020233030303230323134' TO DFHEIV0(25:11)
 21003     CALL 'kxdfhei1' USING DFHEIV0,
 21004           FILE-ERPNDM,
 21005           PENDING-MAILING-DATA,
 21006           DFHEIV11,
 21007           DFHEIV99
 21008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21009
 21010     .
 21011 8102-EXIT.
 21012     EXIT.
 21013 8104-UNLOCK-ERPNDM.
 21014
 21015
 21016* EXEC CICS UNLOCK
 21017*         DATASET   (FILE-ERPNDM)
 21018*    END-EXEC
 21019*    MOVE '&*                    #   #00020224' TO DFHEIV0
 21020     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21022     MOVE X'2020233030303230323234' TO DFHEIV0(25:11)
 21023     CALL 'kxdfhei1' USING DFHEIV0,
 21024           FILE-ERPNDM,
 21025           DFHEIV99
 21026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21027
 21028     .
 21029 8104-EXIT.
 21030     EXIT.
 21031 8110-READ-ERMAIL.
 21032
 21033* EXEC CICS HANDLE CONDITION
 21034*         NOTFND     (8110-NOTFND)
 21035*         ENDFILE    (8110-NOTFND)
 21036*    END-EXEC.
 21037*    MOVE '"$I''                  ! . #00020232' TO DFHEIV0
 21038     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21040     MOVE X'2E20233030303230323332' TO DFHEIV0(25:11)
 21041     CALL 'kxdfhei1' USING DFHEIV0
 21042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21043
 21044
 21045     MOVE SPACES                 TO ERMAIL-FOUND.
 21046     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21047     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21048     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21049     MOVE PB-SV-STATE            TO MA-STATE.
 21050
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 388
* EL050.cbl
 21051
 21052* EXEC CICS READ
 21053*         UPDATE
 21054*         DATASET   (FILE-ERMAIL)
 21055*         RIDFLD    (MA-CONTROL-PRIMARY)
 21056*         INTO      (MAILING-DATA)
 21057*    END-EXEC.
 21058     MOVE LENGTH OF
 21059      MAILING-DATA
 21060       TO DFHEIV11
 21061*    MOVE '&"IL       EU         (   #00020243' TO DFHEIV0
 21062     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21064     MOVE X'2020233030303230323433' TO DFHEIV0(25:11)
 21065     CALL 'kxdfhei1' USING DFHEIV0,
 21066           FILE-ERMAIL,
 21067           MAILING-DATA,
 21068           DFHEIV11,
 21069           MA-CONTROL-PRIMARY,
 21070           DFHEIV99,
 21071           DFHEIV99,
 21072           DFHEIV99
 21073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21074
 21075
 21076     GO TO 8110-EXIT.
 21077
 21078 8110-NOTFND.
 21079     MOVE 'X'                    TO ERMAIL-FOUND.
 21080
 21081 8110-EXIT.
 21082     EXIT.
 21083
 21084 8120-REWRITE-ERMAIL.
 21085
 21086* EXEC CICS REWRITE
 21087*         DATASET    (FILE-ERMAIL)
 21088*         FROM       (MAILING-DATA)
 21089*    END-EXEC.
 21090     MOVE LENGTH OF
 21091      MAILING-DATA
 21092       TO DFHEIV11
 21093*    MOVE '&& L                  %   #00020259' TO DFHEIV0
 21094     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21095     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21096     MOVE X'2020233030303230323539' TO DFHEIV0(25:11)
 21097     CALL 'kxdfhei1' USING DFHEIV0,
 21098           FILE-ERMAIL,
 21099           MAILING-DATA,
 21100           DFHEIV11,
 21101           DFHEIV99
 21102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21103
 21104
 21105 8120-EXIT.
 21106     EXIT.
 21107
 21108 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 389
* EL050.cbl
 21109
 21110* EXEC CICS HANDLE CONDITION
 21111*         DUPKEY   (8130-EXIT)
 21112*    END-EXEC.
 21113*    MOVE '"$$                   ! / #00020268' TO DFHEIV0
 21114     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21116     MOVE X'2F20233030303230323638' TO DFHEIV0(25:11)
 21117     CALL 'kxdfhei1' USING DFHEIV0
 21118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21119
 21120
 21121
 21122* EXEC CICS WRITE
 21123*         DATASET     (FILE-ERMAIL)
 21124*         RIDFLD      (MA-CONTROL-PRIMARY)
 21125*         FROM        (MAILING-DATA)
 21126*    END-EXEC.
 21127     MOVE LENGTH OF
 21128      MAILING-DATA
 21129       TO DFHEIV11
 21130*    MOVE '&$ L                  ''   #00020272' TO DFHEIV0
 21131     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21133     MOVE X'2020233030303230323732' TO DFHEIV0(25:11)
 21134     CALL 'kxdfhei1' USING DFHEIV0,
 21135           FILE-ERMAIL,
 21136           MAILING-DATA,
 21137           DFHEIV11,
 21138           MA-CONTROL-PRIMARY,
 21139           DFHEIV99,
 21140           DFHEIV99
 21141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21142
 21143
 21144 8130-EXIT.
 21145     EXIT.
 21146
 21147 8140-UNLOCK-ERMAIL.
 21148
 21149* EXEC CICS UNLOCK
 21150*         DATASET   (FILE-ERMAIL)
 21151*    END-EXEC.
 21152*    MOVE '&*                    #   #00020282' TO DFHEIV0
 21153     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21155     MOVE X'2020233030303230323832' TO DFHEIV0(25:11)
 21156     CALL 'kxdfhei1' USING DFHEIV0,
 21157           FILE-ERMAIL,
 21158           DFHEIV99
 21159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21160
 21161
 21162 8140-EXIT.
 21163     EXIT.
 21164
 21165 8145-read-elcrtt-upd.
 21166
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 390
* EL050.cbl
 21167     move ' '                    to elcrtt-found-sw
 21168                                    elcrtt-update-sw
 21169
 21170* EXEC CICS HANDLE CONDITION
 21171*        NOTFND   (8145-exit)
 21172*    END-EXEC
 21173*    MOVE '"$I                   ! 0 #00020293' TO DFHEIV0
 21174     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21176     MOVE X'3020233030303230323933' TO DFHEIV0(25:11)
 21177     CALL 'kxdfhei1' USING DFHEIV0
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21179
 21180     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21181     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21182
 21183
 21184* EXEC CICS READ UPDATE
 21185*        DATASET  (CRTT-ID)
 21186*        RIDFLD   (WS-ELCRTT-KEY)
 21187*        INTO     (CERTIFICATE-TRAILERS)
 21188*    END-EXEC
 21189     MOVE LENGTH OF
 21190      CERTIFICATE-TRAILERS
 21191       TO DFHEIV11
 21192*    MOVE '&"IL       EU         (   #00020300' TO DFHEIV0
 21193     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21195     MOVE X'2020233030303230333030' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0,
 21197           CRTT-ID,
 21198           CERTIFICATE-TRAILERS,
 21199           DFHEIV11,
 21200           WS-ELCRTT-KEY,
 21201           DFHEIV99,
 21202           DFHEIV99,
 21203           DFHEIV99
 21204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21205
 21206     set elcrtt-found to true
 21207
 21208     .
 21209 8145-exit.
 21210     exit.
 21211 8150-UPDATE-ELCRTT.
 21212
 21213     if elcrtt-found
 21214
 21215* EXEC CICS REWRITE
 21216*           DATASET  (CRTT-ID)
 21217*           FROM     (CERTIFICATE-TRAILERS)
 21218*        END-EXEC
 21219     MOVE LENGTH OF
 21220      CERTIFICATE-TRAILERS
 21221       TO DFHEIV11
 21222*    MOVE '&& L                  %   #00020314' TO DFHEIV0
 21223     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21224     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 391
* EL050.cbl
 21225     MOVE X'2020233030303230333134' TO DFHEIV0(25:11)
 21226     CALL 'kxdfhei1' USING DFHEIV0,
 21227           CRTT-ID,
 21228           CERTIFICATE-TRAILERS,
 21229           DFHEIV11,
 21230           DFHEIV99
 21231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21232     ELSE
 21233
 21234* EXEC CICS WRITE
 21235*          DATASET  (CRTT-ID)
 21236*          RIDFLD   (WS-ELCRTT-KEY)
 21237*          FROM     (CERTIFICATE-TRAILERS)
 21238*       END-EXEC
 21239     MOVE LENGTH OF
 21240      CERTIFICATE-TRAILERS
 21241       TO DFHEIV11
 21242*    MOVE '&$ L                  ''   #00020319' TO DFHEIV0
 21243     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21245     MOVE X'2020233030303230333139' TO DFHEIV0(25:11)
 21246     CALL 'kxdfhei1' USING DFHEIV0,
 21247           CRTT-ID,
 21248           CERTIFICATE-TRAILERS,
 21249           DFHEIV11,
 21250           WS-ELCRTT-KEY,
 21251           DFHEIV99,
 21252           DFHEIV99
 21253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21254     end-if
 21255
 21256     .
 21257 8150-EXIT.
 21258     EXIT.
 21259
 21260 8155-unlock-elcrtt.
 21261
 21262
 21263* EXEC CICS UNLOCK
 21264*       DATASET  (CRTT-ID)
 21265*    END-EXEC
 21266*    MOVE '&*                    #   #00020332' TO DFHEIV0
 21267     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21269     MOVE X'2020233030303230333332' TO DFHEIV0(25:11)
 21270     CALL 'kxdfhei1' USING DFHEIV0,
 21271           CRTT-ID,
 21272           DFHEIV99
 21273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21274
 21275     .
 21276 8155-exit.
 21277     exit.
 21278
 21279 8190-UPDATE-REFUND-CLAIM-FLAG.
 21280
 21281* EXEC CICS HANDLE CONDITION
 21282*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 392
* EL050.cbl
 21283*    END-EXEC.
 21284*    MOVE '"$I                   ! 1 #00020341' TO DFHEIV0
 21285     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21287     MOVE X'3120233030303230333431' TO DFHEIV0(25:11)
 21288     CALL 'kxdfhei1' USING DFHEIV0
 21289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21290
 21291
 21292     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21293     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21294
 21295
 21296* EXEC CICS READ
 21297*        UPDATE
 21298*        DATASET  (CRTT-ID)
 21299*        RIDFLD   (WS-ELCRTT-KEY)
 21300*        INTO     (CERTIFICATE-TRAILERS)
 21301*    END-EXEC.
 21302     MOVE LENGTH OF
 21303      CERTIFICATE-TRAILERS
 21304       TO DFHEIV11
 21305*    MOVE '&"IL       EU         (   #00020348' TO DFHEIV0
 21306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21308     MOVE X'2020233030303230333438' TO DFHEIV0(25:11)
 21309     CALL 'kxdfhei1' USING DFHEIV0,
 21310           CRTT-ID,
 21311           CERTIFICATE-TRAILERS,
 21312           DFHEIV11,
 21313           WS-ELCRTT-KEY,
 21314           DFHEIV99,
 21315           DFHEIV99,
 21316           DFHEIV99
 21317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21318
 21319
 21320     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21321
 21322* EXEC CICS REWRITE
 21323*       DATASET  (CRTT-ID)
 21324*       FROM     (CERTIFICATE-TRAILERS)
 21325*    END-EXEC.
 21326     MOVE LENGTH OF
 21327      CERTIFICATE-TRAILERS
 21328       TO DFHEIV11
 21329*    MOVE '&& L                  %   #00020356' TO DFHEIV0
 21330     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21331     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21332     MOVE X'2020233030303230333536' TO DFHEIV0(25:11)
 21333     CALL 'kxdfhei1' USING DFHEIV0,
 21334           CRTT-ID,
 21335           CERTIFICATE-TRAILERS,
 21336           DFHEIV11,
 21337           DFHEIV99
 21338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21339
 21340
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 393
* EL050.cbl
 21341     GO TO 8190-EXIT.
 21342
 21343 8190-NOTFND.
 21344
 21345     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21346     MOVE 'CS'         TO CS-RECORD-ID.
 21347     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21348     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21349     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21350     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21351
 21352* EXEC CICS WRITE
 21353*       DATASET  (CRTT-ID)
 21354*       RIDFLD   (WS-ELCRTT-KEY)
 21355*       FROM     (CERTIFICATE-TRAILERS)
 21356*    END-EXEC.
 21357     MOVE LENGTH OF
 21358      CERTIFICATE-TRAILERS
 21359       TO DFHEIV11
 21360*    MOVE '&$ L                  ''   #00020371' TO DFHEIV0
 21361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21363     MOVE X'2020233030303230333731' TO DFHEIV0(25:11)
 21364     CALL 'kxdfhei1' USING DFHEIV0,
 21365           CRTT-ID,
 21366           CERTIFICATE-TRAILERS,
 21367           DFHEIV11,
 21368           WS-ELCRTT-KEY,
 21369           DFHEIV99,
 21370           DFHEIV99
 21371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21372
 21373
 21374 8190-EXIT.
 21375     EXIT.
 21376
 21377 8195-UPDATE-AGE-FLAGS.
 21378
 21379* EXEC CICS HANDLE CONDITION
 21380*        NOTFND   (8195-NOTFND)
 21381*    END-EXEC.
 21382*    MOVE '"$I                   ! 2 #00020381' TO DFHEIV0
 21383     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21385     MOVE X'3220233030303230333831' TO DFHEIV0(25:11)
 21386     CALL 'kxdfhei1' USING DFHEIV0
 21387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21388
 21389
 21390     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21391     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21392
 21393
 21394* EXEC CICS READ
 21395*        UPDATE
 21396*        DATASET  (CRTT-ID)
 21397*        RIDFLD   (WS-ELCRTT-KEY)
 21398*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 394
* EL050.cbl
 21399*    END-EXEC.
 21400     MOVE LENGTH OF
 21401      CERTIFICATE-TRAILERS
 21402       TO DFHEIV11
 21403*    MOVE '&"IL       EU         (   #00020388' TO DFHEIV0
 21404     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21405     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21406     MOVE X'2020233030303230333838' TO DFHEIV0(25:11)
 21407     CALL 'kxdfhei1' USING DFHEIV0,
 21408           CRTT-ID,
 21409           CERTIFICATE-TRAILERS,
 21410           DFHEIV11,
 21411           WS-ELCRTT-KEY,
 21412           DFHEIV99,
 21413           DFHEIV99,
 21414           DFHEIV99
 21415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21416
 21417
 21418     IF WS-INS-AGE-SET = 'Y'
 21419        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21420     END-IF
 21421     IF WS-JNT-AGE-SET = 'Y'
 21422        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21423     END-IF
 21424
 21425
 21426* EXEC CICS REWRITE
 21427*       DATASET  (CRTT-ID)
 21428*       FROM     (CERTIFICATE-TRAILERS)
 21429*    END-EXEC.
 21430     MOVE LENGTH OF
 21431      CERTIFICATE-TRAILERS
 21432       TO DFHEIV11
 21433*    MOVE '&& L                  %   #00020402' TO DFHEIV0
 21434     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21435     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21436     MOVE X'2020233030303230343032' TO DFHEIV0(25:11)
 21437     CALL 'kxdfhei1' USING DFHEIV0,
 21438           CRTT-ID,
 21439           CERTIFICATE-TRAILERS,
 21440           DFHEIV11,
 21441           DFHEIV99
 21442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21443
 21444
 21445     GO TO 8195-EXIT.
 21446
 21447 8195-NOTFND.
 21448
 21449     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21450     MOVE 'CS'         TO CS-RECORD-ID.
 21451     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21452     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21453     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21454     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21455     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21456
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 395
* EL050.cbl
 21457* EXEC CICS WRITE
 21458*       DATASET  (CRTT-ID)
 21459*       RIDFLD   (WS-ELCRTT-KEY)
 21460*       FROM     (CERTIFICATE-TRAILERS)
 21461*    END-EXEC.
 21462     MOVE LENGTH OF
 21463      CERTIFICATE-TRAILERS
 21464       TO DFHEIV11
 21465*    MOVE '&$ L                  ''   #00020418' TO DFHEIV0
 21466     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21468     MOVE X'2020233030303230343138' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0,
 21470           CRTT-ID,
 21471           CERTIFICATE-TRAILERS,
 21472           DFHEIV11,
 21473           WS-ELCRTT-KEY,
 21474           DFHEIV99,
 21475           DFHEIV99
 21476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21477
 21478
 21479 8195-EXIT.
 21480     EXIT.
 21481
 21482 8200-READ-REIN-TABLE.
 21483
 21484* EXEC CICS HANDLE CONDITION
 21485*         NOTFND   (8200-NOTFND)
 21486*    END-EXEC.
 21487*    MOVE '"$I                   ! 3 #00020428' TO DFHEIV0
 21488     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21490     MOVE X'3320233030303230343238' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21493
 21494
 21495
 21496* EXEC CICS READ
 21497*        DATASET     (REIN-ID)
 21498*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21499*        RIDFLD      (ERREIN-KEY)
 21500*    END-EXEC.
 21501*    MOVE '&"S        E          (   #00020432' TO DFHEIV0
 21502     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21504     MOVE X'2020233030303230343332' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0,
 21506           REIN-ID,
 21507           DFHEIV20,
 21508           DFHEIV99,
 21509           ERREIN-KEY,
 21510           DFHEIV99,
 21511           DFHEIV99,
 21512           DFHEIV99
 21513     SET ADDRESS OF REINSURANCE-RECORD TO
 21514         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 396
* EL050.cbl
 21515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21516
 21517
 21518     GO TO 8200-EXIT.
 21519
 21520 8200-NOTFND.
 21521     MOVE 'N'             TO WS-REIN-READ-SW.
 21522
 21523 8200-EXIT.
 21524      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 397
* EL050.cbl
 21526
 21527 8300-READ-CTBL-TABLE.
 21528
 21529* EXEC CICS HANDLE CONDITION
 21530*        NOTFND    (8300-NOTFND)
 21531*        DISABLED  (8300-ERRESS-PROBLEM)
 21532*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21533*        ENDFILE   (8300-NOTFND)
 21534*    END-EXEC.
 21535*    MOVE '"$IcJ''                ! 4 #00020448' TO DFHEIV0
 21536     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21538     MOVE X'3420233030303230343438' TO DFHEIV0(25:11)
 21539     CALL 'kxdfhei1' USING DFHEIV0
 21540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21541
 21542
 21543
 21544* EXEC CICS READ
 21545*        DATASET     (CTBL-ID)
 21546*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21547*        RIDFLD      (ERCTBL-KEY)
 21548*    END-EXEC.
 21549*    MOVE '&"S        E          (   #00020455' TO DFHEIV0
 21550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21552     MOVE X'2020233030303230343535' TO DFHEIV0(25:11)
 21553     CALL 'kxdfhei1' USING DFHEIV0,
 21554           CTBL-ID,
 21555           DFHEIV20,
 21556           DFHEIV99,
 21557           ERCTBL-KEY,
 21558           DFHEIV99,
 21559           DFHEIV99,
 21560           DFHEIV99
 21561     SET ADDRESS OF COMM-TABLE-RECORD TO
 21562         DFHEIV20
 21563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21564
 21565
 21566     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21567
 21568     GO TO 8300-EXIT.
 21569
 21570 8300-NOTFND.
 21571
 21572     IF CTBL-SW = '0530'
 21573         MOVE 'AA'                     TO WS-AH-COMP-CD
 21574         MOVE '0550'                   TO CTBL-SW
 21575         MOVE '1'                      TO WS-CTBL-READ-SW
 21576         GO TO 8300-EXIT.
 21577
 21578     IF CTBL-SW = '0540'
 21579         MOVE 'AA'                     TO WS-LF-COMP-CD
 21580         MOVE '0550'                   TO CTBL-SW
 21581         MOVE '1'                      TO WS-CTBL-READ-SW
 21582         GO TO 8300-EXIT.
 21583
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 398
* EL050.cbl
 21584     IF CTBL-SW = '0550'
 21585         MOVE '2'                      TO WS-CTBL-READ-SW
 21586         GO TO 8300-EXIT.
 21587
 21588     GO TO 8300-EXIT.
 21589
 21590 8300-ERRESS-PROBLEM.
 21591
 21592      MOVE ER-8050              TO WS-ERROR.
 21593      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21594
 21595     GO TO 8300-EXIT.
 21596
 21597 8300-EXIT.
 21598      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 399
* EL050.cbl
 21600
 21601
 21602 8400-GETMAIN-ERFORM.
 21603
 21604
 21605* EXEC CICS   GETMAIN
 21606*        LENGTH  (500)
 21607*        SET     (ADDRESS OF FORM-MASTER)
 21608*    END-EXEC.
 21609     MOVE 500
 21610       TO DFHEIV11
 21611*    MOVE '," L                  $   #00020499' TO DFHEIV0
 21612     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21613     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21614     MOVE X'2020233030303230343939' TO DFHEIV0(25:11)
 21615     CALL 'kxdfhei1' USING DFHEIV0,
 21616           DFHEIV20,
 21617           DFHEIV11,
 21618           DFHEIV99
 21619     SET ADDRESS OF FORM-MASTER TO
 21620         DFHEIV20
 21621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21622
 21623
 21624     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21625
 21626 8400-EXIT.
 21627      EXIT.
 21628
 21629 8450-READ-FORM-MASTER.
 21630
 21631
 21632* EXEC CICS  HANDLE CONDITION
 21633*        NOTFND   (8450-FORM-NOT-FOUND)
 21634*        ENDFILE  (8450-FORM-NOT-FOUND)
 21635*    END-EXEC.
 21636*    MOVE '"$I''                  ! 5 #00020511' TO DFHEIV0
 21637     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21639     MOVE X'3520233030303230353131' TO DFHEIV0(25:11)
 21640     CALL 'kxdfhei1' USING DFHEIV0
 21641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21642
 21643
 21644
 21645* EXEC CICS   READ
 21646*        DATASET   (FORM-ID)
 21647*        RIDFLD    (ERFORM-KEY)
 21648*        INTO      (FORM-MASTER)
 21649*        GTEQ
 21650*    END-EXEC.
 21651     MOVE LENGTH OF
 21652      FORM-MASTER
 21653       TO DFHEIV11
 21654*    MOVE '&"IL       G          (   #00020516' TO DFHEIV0
 21655     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21657     MOVE X'2020233030303230353136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 400
* EL050.cbl
 21658     CALL 'kxdfhei1' USING DFHEIV0,
 21659           FORM-ID,
 21660           FORM-MASTER,
 21661           DFHEIV11,
 21662           ERFORM-KEY,
 21663           DFHEIV99,
 21664           DFHEIV99,
 21665           DFHEIV99
 21666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21667
 21668
 21669     MOVE  'Y'           TO  FORM-MASTER-SW.
 21670
 21671     GO TO  8450-EXIT.
 21672
 21673 8450-FORM-NOT-FOUND.
 21674
 21675     MOVE  'N'           TO  FORM-MASTER-SW.
 21676
 21677 8450-EXIT.
 21678      EXIT.
 21679
 21680 8500-DATE-CONVERT.
 21681
 21682* EXEC CICS LINK
 21683*        PROGRAM    ('ELDATCV')
 21684*        COMMAREA   (DATE-CONVERSION-DATA)
 21685*        LENGTH     (DC-COMM-LENGTH)
 21686*    END-EXEC.
 21687     MOVE 'ELDATCV' TO DFHEIV1
 21688*    MOVE '."C                   (   #00020535' TO DFHEIV0
 21689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21691     MOVE X'2020233030303230353335' TO DFHEIV0(25:11)
 21692     CALL 'kxdfhei1' USING DFHEIV0,
 21693           DFHEIV1,
 21694           DATE-CONVERSION-DATA,
 21695           DC-COMM-LENGTH,
 21696           DFHEIV99,
 21697           DFHEIV99,
 21698           DFHEIV99,
 21699           DFHEIV99
 21700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21701
 21702
 21703 8500-EXIT.
 21704     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 401
* EL050.cbl
 21706
 21707 8555-RELOAD-CONTROL-FILE.
 21708     CONTINUE.
 21709
 21710 8555-EXIT.
 21711     EXIT.
 21712
 21713 8557-GETMAIN-ERPLAN.
 21714
 21715
 21716* EXEC CICS GETMAIN
 21717*        LENGTH    (840)
 21718*        SET       (ADDRESS OF PLAN-RECORDS)
 21719*    END-EXEC.
 21720     MOVE 840
 21721       TO DFHEIV11
 21722*    MOVE '," L                  $   #00020553' TO DFHEIV0
 21723     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21725     MOVE X'2020233030303230353533' TO DFHEIV0(25:11)
 21726     CALL 'kxdfhei1' USING DFHEIV0,
 21727           DFHEIV20,
 21728           DFHEIV11,
 21729           DFHEIV99
 21730     SET ADDRESS OF PLAN-RECORDS TO
 21731         DFHEIV20
 21732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21733
 21734
 21735     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21736
 21737 8557-EXIT.
 21738     EXIT.
 21739
 21740 8560-GETMAIN.
 21741
 21742* EXEC CICS GETMAIN
 21743*        LENGTH    (2000)
 21744*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21745*    END-EXEC.
 21746     MOVE 2000
 21747       TO DFHEIV11
 21748*    MOVE '," L                  $   #00020564' TO DFHEIV0
 21749     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21750     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21751     MOVE X'2020233030303230353634' TO DFHEIV0(25:11)
 21752     CALL 'kxdfhei1' USING DFHEIV0,
 21753           DFHEIV20,
 21754           DFHEIV11,
 21755           DFHEIV99
 21756     SET ADDRESS OF ACCOUNT-MASTER TO
 21757         DFHEIV20
 21758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21759
 21760
 21761     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21762
 21763 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 402
* EL050.cbl
 21764     EXIT.
 21765
 21766 8570-START-ACCOUNT-MASTER.
 21767
 21768* EXEC CICS HANDLE CONDITION
 21769*        NOTFND    (0199-ACCT-NOT-FOUND)
 21770*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21771*    END-EXEC.
 21772*    MOVE '"$I''                  ! 6 #00020575' TO DFHEIV0
 21773     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21775     MOVE X'3620233030303230353735' TO DFHEIV0(25:11)
 21776     CALL 'kxdfhei1' USING DFHEIV0
 21777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21778
 21779
 21780
 21781* EXEC CICS STARTBR
 21782*        DATASET    (ACCT-ID)
 21783*        RIDFLD     (ERACCT-KEY)
 21784*        GTEQ
 21785*    END-EXEC.
 21786     MOVE 0
 21787       TO DFHEIV11
 21788*    MOVE '&,         G          &   #00020580' TO DFHEIV0
 21789     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21790     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21791     MOVE X'2020233030303230353830' TO DFHEIV0(25:11)
 21792     CALL 'kxdfhei1' USING DFHEIV0,
 21793           ACCT-ID,
 21794           ERACCT-KEY,
 21795           DFHEIV99,
 21796           DFHEIV11,
 21797           DFHEIV99
 21798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21799
 21800
 21801 8570-EXIT.
 21802     EXIT.
 21803
 21804 8580-READ-ACCOUNT-MASTER.
 21805
 21806* EXEC CICS HANDLE CONDITION
 21807*        NOTFND    (0199-ACCT-NOT-FOUND)
 21808*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21809*    END-EXEC.
 21810*    MOVE '"$I''                  ! 7 #00020590' TO DFHEIV0
 21811     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21813     MOVE X'3720233030303230353930' TO DFHEIV0(25:11)
 21814     CALL 'kxdfhei1' USING DFHEIV0
 21815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21816
 21817
 21818
 21819* EXEC CICS READNEXT
 21820*        DATASET     (ACCT-ID)
 21821*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 403
* EL050.cbl
 21822*        RIDFLD      (ERACCT-KEY)
 21823*    END-EXEC.
 21824     MOVE LENGTH OF
 21825      ACCOUNT-MASTER
 21826       TO DFHEIV12
 21827     MOVE 0
 21828       TO DFHEIV11
 21829*    MOVE '&.IL                  )   #00020595' TO DFHEIV0
 21830     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21832     MOVE X'2020233030303230353935' TO DFHEIV0(25:11)
 21833     CALL 'kxdfhei1' USING DFHEIV0,
 21834           ACCT-ID,
 21835           ACCOUNT-MASTER,
 21836           DFHEIV12,
 21837           ERACCT-KEY,
 21838           DFHEIV99,
 21839           DFHEIV11,
 21840           DFHEIV99,
 21841           DFHEIV99
 21842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21843
 21844
 21845 8580-EXIT.
 21846     EXIT.
 21847
 21848 8582-READ-COMPENSATION-MASTER.
 21849
 21850* EXEC CICS HANDLE CONDITION
 21851*        NOTFND    (8582-COMP-NOT-FOUND)
 21852*        ENDFILE   (8582-COMP-NOT-FOUND)
 21853*    END-EXEC.
 21854*    MOVE '"$I''                  ! 8 #00020605' TO DFHEIV0
 21855     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21857     MOVE X'3820233030303230363035' TO DFHEIV0(25:11)
 21858     CALL 'kxdfhei1' USING DFHEIV0
 21859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21860
 21861
 21862
 21863* EXEC CICS READ
 21864*        DATASET     (COMP-ID)
 21865*        INTO        (COMPENSATION-MASTER)
 21866*        RIDFLD      (ERCOMP-KEY)
 21867*    END-EXEC.
 21868     MOVE LENGTH OF
 21869      COMPENSATION-MASTER
 21870       TO DFHEIV11
 21871*    MOVE '&"IL       E          (   #00020610' TO DFHEIV0
 21872     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21874     MOVE X'2020233030303230363130' TO DFHEIV0(25:11)
 21875     CALL 'kxdfhei1' USING DFHEIV0,
 21876           COMP-ID,
 21877           COMPENSATION-MASTER,
 21878           DFHEIV11,
 21879           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 404
* EL050.cbl
 21880           DFHEIV99,
 21881           DFHEIV99,
 21882           DFHEIV99
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21884
 21885
 21886     MOVE 'Y'                    TO COMP-MASTER-SW
 21887
 21888     GO TO 8582-EXIT
 21889     .
 21890 8582-COMP-NOT-FOUND.
 21891
 21892     MOVE 'N'                    TO COMP-MASTER-SW.
 21893
 21894 8582-EXIT.
 21895     EXIT.
 21896
 21897 8583-READ-ERAGTC.
 21898
 21899* EXEC CICS HANDLE CONDITION
 21900*        NOTFND    (8583-AGTC-NOT-FOUND)
 21901*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21902*    END-EXEC.
 21903*    MOVE '"$I''                  ! 9 #00020628' TO DFHEIV0
 21904     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21906     MOVE X'3920233030303230363238' TO DFHEIV0(25:11)
 21907     CALL 'kxdfhei1' USING DFHEIV0
 21908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21909
 21910
 21911
 21912* EXEC CICS STARTBR
 21913*        DATASET    (AGTC-ID)
 21914*        RIDFLD     (ERAGTC-KEY)
 21915*        GTEQ
 21916*    END-EXEC.
 21917     MOVE 0
 21918       TO DFHEIV11
 21919*    MOVE '&,         G          &   #00020633' TO DFHEIV0
 21920     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21922     MOVE X'2020233030303230363333' TO DFHEIV0(25:11)
 21923     CALL 'kxdfhei1' USING DFHEIV0,
 21924           AGTC-ID,
 21925           ERAGTC-KEY,
 21926           DFHEIV99,
 21927           DFHEIV11,
 21928           DFHEIV99
 21929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21930
 21931
 21932 8583-READ-ERAGTC-NEXT.
 21933
 21934* EXEC CICS READNEXT
 21935*        DATASET     (AGTC-ID)
 21936*        INTO        (AGENT-COMMISSIONS)
 21937*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 405
* EL050.cbl
 21938*    END-EXEC.
 21939     MOVE LENGTH OF
 21940      AGENT-COMMISSIONS
 21941       TO DFHEIV12
 21942     MOVE 0
 21943       TO DFHEIV11
 21944*    MOVE '&.IL                  )   #00020640' TO DFHEIV0
 21945     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21946     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21947     MOVE X'2020233030303230363430' TO DFHEIV0(25:11)
 21948     CALL 'kxdfhei1' USING DFHEIV0,
 21949           AGTC-ID,
 21950           AGENT-COMMISSIONS,
 21951           DFHEIV12,
 21952           ERAGTC-KEY,
 21953           DFHEIV99,
 21954           DFHEIV11,
 21955           DFHEIV99,
 21956           DFHEIV99
 21957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21958
 21959
 21960*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21961
 21962     GO TO 8583-EXIT
 21963     .
 21964 8583-AGTC-NOT-FOUND.
 21965
 21966     MOVE 'N'                    TO AGTC-MASTER-SW.
 21967
 21968 8583-EXIT.
 21969     EXIT.
 21970
 21971 8584-READ-BANK-CROSS-REF.
 21972
 21973* EXEC CICS HANDLE CONDITION
 21974*        NOTFND    (8584-BXRF-NOT-FOUND)
 21975*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21976*    END-EXEC.
 21977*    MOVE '"$I''                  ! : #00020658' TO DFHEIV0
 21978     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21980     MOVE X'3A20233030303230363538' TO DFHEIV0(25:11)
 21981     CALL 'kxdfhei1' USING DFHEIV0
 21982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21983
 21984
 21985
 21986* EXEC CICS READ
 21987*        DATASET     (BXRF-ID)
 21988*        INTO        (BANK-CROSS-REFERENCE)
 21989*        RIDFLD      (ERBXRF-KEY)
 21990*        LENGTH      (BXRF-REC-LENGTH)
 21991*    END-EXEC.
 21992*    MOVE '&"IL       E          (   #00020663' TO DFHEIV0
 21993     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21995     MOVE X'2020233030303230363633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 406
* EL050.cbl
 21996     CALL 'kxdfhei1' USING DFHEIV0,
 21997           BXRF-ID,
 21998           BANK-CROSS-REFERENCE,
 21999           BXRF-REC-LENGTH,
 22000           ERBXRF-KEY,
 22001           DFHEIV99,
 22002           DFHEIV99,
 22003           DFHEIV99
 22004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22005
 22006
 22007     MOVE 'Y'                    TO BXRF-MASTER-SW
 22008
 22009     GO TO 8584-EXIT
 22010     .
 22011 8584-BXRF-NOT-FOUND.
 22012
 22013     MOVE 'N'                    TO BXRF-MASTER-SW.
 22014
 22015 8584-EXIT.
 22016     EXIT.
 22017
 22018 8585-READ-PLAN-MASTER.
 22019
 22020
 22021* EXEC CICS HANDLE CONDITION
 22022*        NOTFND    (8585-PLAN-NOT-FOUND)
 22023*        ENDFILE   (8585-PLAN-NOT-FOUND)
 22024*    END-EXEC.
 22025*    MOVE '"$I''                  ! ; #00020683' TO DFHEIV0
 22026     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22028     MOVE X'3B20233030303230363833' TO DFHEIV0(25:11)
 22029     CALL 'kxdfhei1' USING DFHEIV0
 22030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22031
 22032
 22033
 22034* EXEC CICS READ
 22035*        DATASET     (PLAN-ID)
 22036*        INTO        (PLAN-MASTER)
 22037*        RIDFLD      (ERPLAN-KEY)
 22038*    END-EXEC.
 22039     MOVE LENGTH OF
 22040      PLAN-MASTER
 22041       TO DFHEIV11
 22042*    MOVE '&"IL       E          (   #00020688' TO DFHEIV0
 22043     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22045     MOVE X'2020233030303230363838' TO DFHEIV0(25:11)
 22046     CALL 'kxdfhei1' USING DFHEIV0,
 22047           PLAN-ID,
 22048           PLAN-MASTER,
 22049           DFHEIV11,
 22050           ERPLAN-KEY,
 22051           DFHEIV99,
 22052           DFHEIV99,
 22053           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 407
* EL050.cbl
 22054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22055
 22056
 22057     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22058
 22059     GO TO 8585-EXIT.
 22060
 22061 8585-PLAN-NOT-FOUND.
 22062
 22063     MOVE 'N'                    TO PLAN-MASTER-SW.
 22064
 22065 8585-EXIT.
 22066     EXIT.
 22067
 22068 8586-READ-LOAN-OFFICER.
 22069
 22070* EXEC CICS READ
 22071*        DATASET     (LOFC-ID)
 22072*        INTO        (LOAN-OFFICER-MASTER)
 22073*        RIDFLD      (ERLOFC-KEY)
 22074*        RESP        (WS-RESPONSE)
 22075*    END-EXEC
 22076     MOVE LENGTH OF
 22077      LOAN-OFFICER-MASTER
 22078       TO DFHEIV11
 22079*    MOVE '&"IL       E          (  N#00020706' TO DFHEIV0
 22080     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22082     MOVE X'204E233030303230373036' TO DFHEIV0(25:11)
 22083     CALL 'kxdfhei1' USING DFHEIV0,
 22084           LOFC-ID,
 22085           LOAN-OFFICER-MASTER,
 22086           DFHEIV11,
 22087           ERLOFC-KEY,
 22088           DFHEIV99,
 22089           DFHEIV99,
 22090           DFHEIV99
 22091     MOVE EIBRESP  TO WS-RESPONSE
 22092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22093
 22094     IF WS-RESP-NORMAL
 22095        MOVE 'Y'                 TO LOFC-MASTER-SW
 22096     ELSE
 22097        MOVE 'N'                 TO LOFC-MASTER-SW
 22098     END-IF
 22099     .
 22100 8586-EXIT.
 22101     EXIT.
 22102 8587-START-ERPDEF.
 22103
 22104* EXEC CICS STARTBR
 22105*       DATASET   (PDEF-ID)
 22106*       RIDFLD    (ERPDEF-KEY)
 22107*       GTEQ
 22108*       RESP      (WS-RESPONSE)
 22109*    END-EXEC
 22110     MOVE 0
 22111       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 408
* EL050.cbl
 22112*    MOVE '&,         G          &  N#00020722' TO DFHEIV0
 22113     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22114     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22115     MOVE X'204E233030303230373232' TO DFHEIV0(25:11)
 22116     CALL 'kxdfhei1' USING DFHEIV0,
 22117           PDEF-ID,
 22118           ERPDEF-KEY,
 22119           DFHEIV99,
 22120           DFHEIV11,
 22121           DFHEIV99
 22122     MOVE EIBRESP  TO WS-RESPONSE
 22123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22124     IF WS-RESP-NORMAL
 22125        MOVE 'Y'                 TO PDEF-MASTER-SW
 22126     ELSE
 22127        MOVE 'N'                 TO PDEF-MASTER-SW
 22128     END-IF
 22129     .
 22130 8587-EXIT.
 22131     EXIT.
 22132 8588-READ-ERPDEF.
 22133
 22134* EXEC CICS READNEXT
 22135*       DATASET   (PDEF-ID)
 22136*       RIDFLD    (ERPDEF-KEY)
 22137*       INTO      (PRODUCT-MASTER)
 22138*       RESP      (WS-RESPONSE)
 22139*    END-EXEC
 22140     MOVE LENGTH OF
 22141      PRODUCT-MASTER
 22142       TO DFHEIV12
 22143     MOVE 0
 22144       TO DFHEIV11
 22145*    MOVE '&.IL                  )  N#00020737' TO DFHEIV0
 22146     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22147     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22148     MOVE X'204E233030303230373337' TO DFHEIV0(25:11)
 22149     CALL 'kxdfhei1' USING DFHEIV0,
 22150           PDEF-ID,
 22151           PRODUCT-MASTER,
 22152           DFHEIV12,
 22153           ERPDEF-KEY,
 22154           DFHEIV99,
 22155           DFHEIV11,
 22156           DFHEIV99,
 22157           DFHEIV99
 22158     MOVE EIBRESP  TO WS-RESPONSE
 22159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22160     IF WS-RESP-NORMAL
 22161        MOVE 'Y'                 TO PDEF-MASTER-SW
 22162     ELSE
 22163        MOVE 'N'                 TO PDEF-MASTER-SW
 22164     END-IF
 22165     .
 22166 8588-EXIT.
 22167     EXIT.
 22168 8589-ENDBR-ERPDEF.
 22169
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 409
* EL050.cbl
 22170* EXEC CICS ENDBR
 22171*       DATASET   (PDEF-ID)
 22172*    END-EXEC
 22173     MOVE 0
 22174       TO DFHEIV11
 22175*    MOVE '&2                    $   #00020752' TO DFHEIV0
 22176     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22178     MOVE X'2020233030303230373532' TO DFHEIV0(25:11)
 22179     CALL 'kxdfhei1' USING DFHEIV0,
 22180           PDEF-ID,
 22181           DFHEIV11,
 22182           DFHEIV99
 22183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22184     .
 22185 8589-EXIT.
 22186     EXIT.
 22187 8590-READ-CERT-MASTER.
 22188     IF PB-COMPANY-ID = 'UCL'
 22189         GO TO 8690-READ-CERT-MASTER-UCL.
 22190
 22191
 22192* EXEC CICS HANDLE CONDITION
 22193*         NOTFND    (0299-CERT-NOT-FOUND)
 22194*    END-EXEC.
 22195*    MOVE '"$I                   ! < #00020762' TO DFHEIV0
 22196     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22198     MOVE X'3C20233030303230373632' TO DFHEIV0(25:11)
 22199     CALL 'kxdfhei1' USING DFHEIV0
 22200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22201
 22202
 22203
 22204* EXEC CICS READ
 22205*        DATASET     (CERT-ID)
 22206*        INTO        (CERTIFICATE-MASTER)
 22207*        RIDFLD      (ELCERT-KEY)
 22208*        UPDATE
 22209*    END-EXEC.
 22210     MOVE LENGTH OF
 22211      CERTIFICATE-MASTER
 22212       TO DFHEIV11
 22213*    MOVE '&"IL       EU         (   #00020766' TO DFHEIV0
 22214     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22215     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22216     MOVE X'2020233030303230373636' TO DFHEIV0(25:11)
 22217     CALL 'kxdfhei1' USING DFHEIV0,
 22218           CERT-ID,
 22219           CERTIFICATE-MASTER,
 22220           DFHEIV11,
 22221           ELCERT-KEY,
 22222           DFHEIV99,
 22223           DFHEIV99,
 22224           DFHEIV99
 22225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22226
 22227
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 410
* EL050.cbl
 22228 8590-EXIT.
 22229     EXIT.
 22230
 22231 8690-READ-CERT-MASTER-UCL.
 22232
 22233* EXEC CICS HANDLE CONDITION
 22234*         NOTFND    (8700-READ-CERT-MASTER)
 22235*    END-EXEC.
 22236*    MOVE '"$I                   ! = #00020777' TO DFHEIV0
 22237     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22239     MOVE X'3D20233030303230373737' TO DFHEIV0(25:11)
 22240     CALL 'kxdfhei1' USING DFHEIV0
 22241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22242
 22243
 22244 8690-READ-CERT-CONT.
 22245
 22246* EXEC CICS READ
 22247*        DATASET     (CERT-ID)
 22248*        INTO        (CERTIFICATE-MASTER)
 22249*        RIDFLD      (ELCERT-KEY)
 22250*        UPDATE
 22251*    END-EXEC.
 22252     MOVE LENGTH OF
 22253      CERTIFICATE-MASTER
 22254       TO DFHEIV11
 22255*    MOVE '&"IL       EU         (   #00020782' TO DFHEIV0
 22256     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22258     MOVE X'2020233030303230373832' TO DFHEIV0(25:11)
 22259     CALL 'kxdfhei1' USING DFHEIV0,
 22260           CERT-ID,
 22261           CERTIFICATE-MASTER,
 22262           DFHEIV11,
 22263           ELCERT-KEY,
 22264           DFHEIV99,
 22265           DFHEIV99,
 22266           DFHEIV99
 22267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22268
 22269
 22270     GO TO 8590-EXIT.
 22271
 22272 8700-READ-CERT-MASTER.
 22273     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22274     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22275
 22276* EXEC CICS HANDLE CONDITION
 22277*         DUPKEY    (8720-COMP-ACCOUNTS)
 22278*         ENDFILE   (8730-END-BROWSE)
 22279*         NOTFND    (8740-NOT-FOUND)
 22280*    END-EXEC.
 22281*    MOVE '"$$''I                 ! > #00020794' TO DFHEIV0
 22282     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22284     MOVE X'3E20233030303230373934' TO DFHEIV0(25:11)
 22285     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 411
* EL050.cbl
 22286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22287
 22288
 22289
 22290* EXEC CICS STARTBR
 22291*        DATASET     ('ELCERT5')
 22292*        RIDFLD      (ELCERT2-KEY)
 22293*        EQUAL
 22294*    END-EXEC.
 22295     MOVE 'ELCERT5' TO DFHEIV1
 22296     MOVE 0
 22297       TO DFHEIV11
 22298*    MOVE '&,         E          &   #00020800' TO DFHEIV0
 22299     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22301     MOVE X'2020233030303230383030' TO DFHEIV0(25:11)
 22302     CALL 'kxdfhei1' USING DFHEIV0,
 22303           DFHEIV1,
 22304           ELCERT2-KEY,
 22305           DFHEIV99,
 22306           DFHEIV11,
 22307           DFHEIV99
 22308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22309
 22310
 22311 8710-READ-NEXT.
 22312
 22313* EXEC CICS READNEXT
 22314*        DATASET     ('ELCERT5')
 22315*        INTO        (CERTIFICATE-MASTER)
 22316*        RIDFLD      (ELCERT2-KEY)
 22317*    END-EXEC.
 22318     MOVE LENGTH OF
 22319      CERTIFICATE-MASTER
 22320       TO DFHEIV12
 22321     MOVE 'ELCERT5' TO DFHEIV1
 22322     MOVE 0
 22323       TO DFHEIV11
 22324*    MOVE '&.IL                  )   #00020807' TO DFHEIV0
 22325     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22326     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22327     MOVE X'2020233030303230383037' TO DFHEIV0(25:11)
 22328     CALL 'kxdfhei1' USING DFHEIV0,
 22329           DFHEIV1,
 22330           CERTIFICATE-MASTER,
 22331           DFHEIV12,
 22332           ELCERT2-KEY,
 22333           DFHEIV99,
 22334           DFHEIV11,
 22335           DFHEIV99,
 22336           DFHEIV99
 22337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22338
 22339
 22340 8720-COMP-ACCOUNTS.
 22341
 22342* EXEC CICS ENTER
 22343*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 412
* EL050.cbl
 22344*         FROM (PB-C-LAST-NAME)
 22345*    END-EXEC.
 22346     MOVE 001
 22347       TO DFHEIV11
 22348*    MOVE ':$F                   %   #00020814' TO DFHEIV0
 22349     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22351     MOVE X'2020233030303230383134' TO DFHEIV0(25:11)
 22352     CALL 'kxdfhei1' USING DFHEIV0,
 22353           DFHEIV11,
 22354           PB-C-LAST-NAME,
 22355           DFHEIV99,
 22356           DFHEIV99
 22357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22358
 22359
 22360
 22361* EXEC CICS ENTER
 22362*         TRACEID (002)
 22363*         FROM (CM-INSURED-LAST-NAME)
 22364*    END-EXEC.
 22365     MOVE 002
 22366       TO DFHEIV11
 22367*    MOVE ':$F                   %   #00020819' TO DFHEIV0
 22368     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22370     MOVE X'2020233030303230383139' TO DFHEIV0(25:11)
 22371     CALL 'kxdfhei1' USING DFHEIV0,
 22372           DFHEIV11,
 22373           CM-INSURED-LAST-NAME,
 22374           DFHEIV99,
 22375           DFHEIV99
 22376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22377
 22378
 22379     IF PB-CERT-NO NOT = CM-CERT-NO
 22380         GO TO 8730-END-BROWSE.
 22381
 22382     IF PB-ACCOUNT = CM-ACCOUNT
 22383         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22384             MOVE ER-2799        TO WS-ERROR
 22385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22386             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22387             GO TO 8730-END-BROWSE.
 22388
 22389     GO TO 8710-READ-NEXT.
 22390
 22391 8730-END-BROWSE.
 22392
 22393* EXEC CICS ENDBR
 22394*         DATASET    ('ELCERT5')
 22395*    END-EXEC.
 22396     MOVE 'ELCERT5' TO DFHEIV1
 22397     MOVE 0
 22398       TO DFHEIV11
 22399*    MOVE '&2                    $   #00020837' TO DFHEIV0
 22400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 413
* EL050.cbl
 22402     MOVE X'2020233030303230383337' TO DFHEIV0(25:11)
 22403     CALL 'kxdfhei1' USING DFHEIV0,
 22404           DFHEIV1,
 22405           DFHEIV11,
 22406           DFHEIV99
 22407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22408
 22409
 22410 8740-NOT-FOUND.
 22411     GO TO 0299-CERT-NOT-FOUND.
 22412
 22413 8750-START-ELSTAT.
 22414
 22415* EXEC CICS STARTBR
 22416*       DATASET   (STAT-ID)
 22417*       RIDFLD    (ELSTAT-KEY)
 22418*       GTEQ
 22419*       RESP      (WS-RESPONSE)
 22420*    END-EXEC
 22421     MOVE 0
 22422       TO DFHEIV11
 22423*    MOVE '&,         G          &  N#00020845' TO DFHEIV0
 22424     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22425     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22426     MOVE X'204E233030303230383435' TO DFHEIV0(25:11)
 22427     CALL 'kxdfhei1' USING DFHEIV0,
 22428           STAT-ID,
 22429           ELSTAT-KEY,
 22430           DFHEIV99,
 22431           DFHEIV11,
 22432           DFHEIV99
 22433     MOVE EIBRESP  TO WS-RESPONSE
 22434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22435     IF WS-RESP-NORMAL
 22436        MOVE 'Y'                 TO STAT-MASTER-SW
 22437     ELSE
 22438        MOVE 'N'                 TO STAT-MASTER-SW
 22439     END-IF
 22440     .
 22441 8750-EXIT.
 22442     EXIT.
 22443 8752-READ-ELSTAT.
 22444
 22445* EXEC CICS READNEXT
 22446*       DATASET   (STAT-ID)
 22447*       RIDFLD    (ELSTAT-KEY)
 22448*       INTO      (STATE-FILE)
 22449*       RESP      (WS-RESPONSE)
 22450*    END-EXEC
 22451     MOVE LENGTH OF
 22452      STATE-FILE
 22453       TO DFHEIV12
 22454     MOVE 0
 22455       TO DFHEIV11
 22456*    MOVE '&.IL                  )  N#00020860' TO DFHEIV0
 22457     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22459     MOVE X'204E233030303230383630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 414
* EL050.cbl
 22460     CALL 'kxdfhei1' USING DFHEIV0,
 22461           STAT-ID,
 22462           STATE-FILE,
 22463           DFHEIV12,
 22464           ELSTAT-KEY,
 22465           DFHEIV99,
 22466           DFHEIV11,
 22467           DFHEIV99,
 22468           DFHEIV99
 22469     MOVE EIBRESP  TO WS-RESPONSE
 22470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22471     IF WS-RESP-NORMAL
 22472        MOVE 'Y'                 TO STAT-MASTER-SW
 22473     ELSE
 22474        MOVE 'N'                 TO STAT-MASTER-SW
 22475     END-IF
 22476     .
 22477 8752-EXIT.
 22478     EXIT.
 22479 8800-GET-COMP-RATE.
 22480     MOVE +1 TO IB.
 22481     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22482         ADD +9 TO IB
 22483         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22484             ADD +9 TO IB
 22485             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22486                MOVE ZEROS       TO WS-WK-RATE
 22487                GO TO 8800-EXIT.
 22488
 22489     IF PB-I-AGE GREATER CT-AGE (1)
 22490         ADD +3 TO IB
 22491         IF PB-I-AGE GREATER CT-AGE (2)
 22492             ADD +3 TO IB
 22493             IF PB-I-AGE GREATER CT-AGE (3)
 22494                MOVE ZEROS       TO WS-WK-RATE
 22495                GO TO 8800-EXIT.
 22496
 22497     IF WS-WORK-TERM GREATER CT-TRM (1)
 22498         ADD +1 TO IB
 22499         IF WS-WORK-TERM GREATER CT-TRM (2)
 22500             ADD +1 TO IB
 22501             IF WS-WORK-TERM GREATER CT-TRM (3)
 22502                MOVE ZEROS       TO WS-WK-RATE
 22503                GO TO 8800-EXIT.
 22504
 22505     IF CT-RT (IB) NOT NUMERIC
 22506         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22507         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22508         GO TO 8800-GET-COMP-RATE.
 22509
 22510     MOVE CT-RT (IB) TO WS-WK-RATE.
 22511
 22512 8800-EXIT.
 22513     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 415
* EL050.cbl
 22515 8900-ADDRESS-FILE.
 22516     IF ERACCT-FILE-ADDRESSED
 22517         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22518         GO TO 8900-ADDRESS-EXIT.
 22519
 22520     IF ELCNTL-FILE-ADDRESSED
 22521         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22522         GO TO 8900-ADDRESS-EXIT.
 22523
 22524     IF ERPLAN-FILE-ADDRESSED
 22525         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22526         GO TO 8900-ADDRESS-EXIT.
 22527
 22528     IF ERFORM-FILE-ADDRESSED
 22529         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22530         GO TO 8900-ADDRESS-EXIT.
 22531
 22532 8900-ADDRESS-EXIT.
 22533     EXIT.
 22534
 22535 9000-READ-CONTROL.
 22536
 22537* EXEC CICS HANDLE CONDITION
 22538*        NOTFND    (9000-NOTFND)
 22539*    END-EXEC.
 22540*    MOVE '"$I                   ! ? #00020931' TO DFHEIV0
 22541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22543     MOVE X'3F20233030303230393331' TO DFHEIV0(25:11)
 22544     CALL 'kxdfhei1' USING DFHEIV0
 22545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22546
 22547
 22548
 22549* EXEC CICS READ
 22550*        DATASET     (CNTL-ID)
 22551*        SET         (ADDRESS OF CONTROL-FILE)
 22552*        RIDFLD      (ELCNTL-KEY)
 22553*        GTEQ
 22554*    END-EXEC.
 22555*    MOVE '&"S        G          (   #00020935' TO DFHEIV0
 22556     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22558     MOVE X'2020233030303230393335' TO DFHEIV0(25:11)
 22559     CALL 'kxdfhei1' USING DFHEIV0,
 22560           CNTL-ID,
 22561           DFHEIV20,
 22562           DFHEIV99,
 22563           ELCNTL-KEY,
 22564           DFHEIV99,
 22565           DFHEIV99,
 22566           DFHEIV99
 22567     SET ADDRESS OF CONTROL-FILE TO
 22568         DFHEIV20
 22569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22570
 22571
 22572     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 416
* EL050.cbl
 22573
 22574 9000-NOTFND.
 22575     IF RC-SW-1 = '1'
 22576        MOVE ER-2616              TO WS-ERROR
 22577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22578        GO TO 9000-EXIT.
 22579
 22580     IF RC-SW-1 = '2'
 22581        MOVE ER-2602              TO WS-ERROR
 22582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22583
 22584 9000-EXIT.
 22585      EXIT.
 22586
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 417
* EL050.cbl
 22588 9100-READ-CONTROL.
 22589
 22590* EXEC CICS HANDLE CONDITION
 22591*        NOTFND  (9100-NOTFND)
 22592*        ENDFILE (9100-NOTFND)
 22593*    END-EXEC.
 22594*    MOVE '"$I''                  ! @ #00020959' TO DFHEIV0
 22595     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22597     MOVE X'4020233030303230393539' TO DFHEIV0(25:11)
 22598     CALL 'kxdfhei1' USING DFHEIV0
 22599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22600
 22601
 22602
 22603* EXEC CICS READ
 22604*        DATASET     (CNTL-ID)
 22605*        INTO        (CONTROL-FILE)
 22606*        RIDFLD      (ELCNTL-KEY)
 22607*        GTEQ
 22608*    END-EXEC.
 22609     MOVE LENGTH OF
 22610      CONTROL-FILE
 22611       TO DFHEIV11
 22612*    MOVE '&"IL       G          (   #00020964' TO DFHEIV0
 22613     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22615     MOVE X'2020233030303230393634' TO DFHEIV0(25:11)
 22616     CALL 'kxdfhei1' USING DFHEIV0,
 22617           CNTL-ID,
 22618           CONTROL-FILE,
 22619           DFHEIV11,
 22620           ELCNTL-KEY,
 22621           DFHEIV99,
 22622           DFHEIV99,
 22623           DFHEIV99
 22624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22625
 22626
 22627     GO TO 9100-EXIT.
 22628
 22629 9100-NOTFND.
 22630     IF RC-SW-2 = '0'
 22631        MOVE '1'                  TO STATE-RECORD-ERROR
 22632        GO TO 9100-EXIT
 22633     END-IF
 22634     IF RC-SW-2 = '1'
 22635        MOVE '1'                  TO LF-BENEFIT-ERROR
 22636        MOVE ER-2604              TO WS-ERROR
 22637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22638        GO TO 9100-EXIT.
 22639
 22640     IF RC-SW-2 = '2'
 22641        MOVE '1'                  TO AH-BENEFIT-ERROR
 22642        MOVE ER-2605              TO WS-ERROR
 22643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22644        GO TO 9100-EXIT.
 22645
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 418
* EL050.cbl
 22646     IF RC-SW-2 = '3'
 22647         MOVE ER-2603           TO WS-ERROR
 22648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22649         GO TO 9100-EXIT.
 22650
 22651     IF RC-SW-2 = '4'
 22652         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22653         GO TO 9100-EXIT.
 22654
 22655     IF RC-SW-2 = '5'
 22656         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22657         IF WS-AH-INPUT-CD-1 = SPACE
 22658             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22659         ELSE
 22660             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22661
 22662 9100-EXIT.
 22663      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 419
* EL050.cbl
 22665 9200-CONTROL-GETMAIN.
 22666
 22667* EXEC CICS GETMAIN
 22668*         LENGTH   (750)
 22669*         SET      (ADDRESS OF CONTROL-FILE)
 22670*    END-EXEC.
 22671     MOVE 750
 22672       TO DFHEIV11
 22673*    MOVE '," L                  $   #00021010' TO DFHEIV0
 22674     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22676     MOVE X'2020233030303231303130' TO DFHEIV0(25:11)
 22677     CALL 'kxdfhei1' USING DFHEIV0,
 22678           DFHEIV20,
 22679           DFHEIV11,
 22680           DFHEIV99
 22681     SET ADDRESS OF CONTROL-FILE TO
 22682         DFHEIV20
 22683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22684
 22685
 22686     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22687
 22688 9200-EXIT.
 22689     EXIT.
 22690
 22691 9250-UNLOCK-RETURN.
 22692
 22693* EXEC CICS UNLOCK
 22694*        DATASET   (CERT-ID)
 22695*    END-EXEC.
 22696*    MOVE '&*                    #   #00021021' TO DFHEIV0
 22697     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22698     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22699     MOVE X'2020233030303231303231' TO DFHEIV0(25:11)
 22700     CALL 'kxdfhei1' USING DFHEIV0,
 22701           CERT-ID,
 22702           DFHEIV99
 22703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22704
 22705
 22706 9300-ABEND.
 22707     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22708
 22709
 22710* EXEC CICS LINK
 22711*        PROGRAM   ('EL004')
 22712*        COMMAREA  (WS-ERROR-LINE)
 22713*        LENGTH    (72)
 22714*    END-EXEC.
 22715     MOVE 'EL004' TO DFHEIV1
 22716     MOVE 72
 22717       TO DFHEIV11
 22718*    MOVE '."C                   (   #00021028' TO DFHEIV0
 22719     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22721     MOVE X'2020233030303231303238' TO DFHEIV0(25:11)
 22722     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 420
* EL050.cbl
 22723           DFHEIV1,
 22724           WS-ERROR-LINE,
 22725           DFHEIV11,
 22726           DFHEIV99,
 22727           DFHEIV99,
 22728           DFHEIV99,
 22729           DFHEIV99
 22730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22731
 22732
 22733     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22734
 22735
 22736* EXEC CICS ABEND
 22737*        ABCODE ('EL50')
 22738*    END-EXEC.
 22739     MOVE 'EL50' TO DFHEIV5
 22740*    MOVE '.,A                   "   #00021036' TO DFHEIV0
 22741     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22742     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22743     MOVE X'2020233030303231303336' TO DFHEIV0(25:11)
 22744     CALL 'kxdfhei1' USING DFHEIV0,
 22745           DFHEIV5
 22746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22747
 22748
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 421
* EL050.cbl
 22750
 22751******************************************************************
 22752*                                                                *
 22753*            E R R O R   F O R M A T   R O U T I N E             *
 22754*                                                                *
 22755******************************************************************
 22756
 22757 9900-ERROR-FORMAT.
 22758
 22759     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22760                    PB-COMMON-ERROR (2) OR
 22761                    PB-COMMON-ERROR (3) OR
 22762                    PB-COMMON-ERROR (4) OR
 22763                    PB-COMMON-ERROR (5) OR
 22764                    PB-COMMON-ERROR (6) OR
 22765                    PB-COMMON-ERROR (7) OR
 22766                    PB-COMMON-ERROR (8) OR
 22767                    PB-COMMON-ERROR (9) OR
 22768                    PB-COMMON-ERROR (10)
 22769        GO TO 9900-EXIT.
 22770
 22771     IF PB-NO-OF-ERRORS = +10
 22772        GO TO 9900-EXIT.
 22773
 22774     ADD +1  TO PB-NO-OF-ERRORS.
 22775     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22776                                       (PB-NO-OF-ERRORS).
 22777 9900-EXIT.
 22778     EXIT.
 22779
 22780 9990-RETURN.
 22781     IF BROWSE-STARTED
 22782
 22783* EXEC CICS ENDBR
 22784*            DATASET  (ACCT-ID)
 22785*       END-EXEC.
 22786     MOVE 0
 22787       TO DFHEIV11
 22788*    MOVE '&2                    $   #00021073' TO DFHEIV0
 22789     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22791     MOVE X'2020233030303231303733' TO DFHEIV0(25:11)
 22792     CALL 'kxdfhei1' USING DFHEIV0,
 22793           ACCT-ID,
 22794           DFHEIV11,
 22795           DFHEIV99
 22796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22797
 22798
 22799 9990-EXIT.
 22800     EXIT.
 22801
 22802
 22803****Check for CRTO record, add one if not found.
 22804 9991-CHECK-FOR-ELCRTO.
 22805
 22806* EXEC CICS HANDLE CONDITION
 22807*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 422
* EL050.cbl
 22808*         ENDFILE (9991-CRTO-NOT-FOUND)
 22809*     END-EXEC.
 22810*    MOVE '"$I''                  ! A #00021083' TO DFHEIV0
 22811     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22813     MOVE X'4120233030303231303833' TO DFHEIV0(25:11)
 22814     CALL 'kxdfhei1' USING DFHEIV0
 22815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22816
 22817     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22818     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22819     MOVE +0                     TO ELCRTO-SEQ-NO
 22820
 22821
 22822* EXEC CICS READ
 22823*       DATASET   ('ELCRTO')
 22824*       INTO      (ORIGINAL-CERTIFICATE)
 22825*       RIDFLD    (ELCRTO-KEY)
 22826*       GTEQ
 22827*       RESP      (WS-RESPONSE)
 22828*    END-EXEC
 22829     MOVE LENGTH OF
 22830      ORIGINAL-CERTIFICATE
 22831       TO DFHEIV11
 22832     MOVE 'ELCRTO' TO DFHEIV1
 22833*    MOVE '&"IL       G          (  N#00021091' TO DFHEIV0
 22834     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22836     MOVE X'204E233030303231303931' TO DFHEIV0(25:11)
 22837     CALL 'kxdfhei1' USING DFHEIV0,
 22838           DFHEIV1,
 22839           ORIGINAL-CERTIFICATE,
 22840           DFHEIV11,
 22841           ELCRTO-KEY,
 22842           DFHEIV99,
 22843           DFHEIV99,
 22844           DFHEIV99
 22845     MOVE EIBRESP  TO WS-RESPONSE
 22846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22847
 22848     IF WS-RESP-NORMAL
 22849        AND (OC-CONTROL-PRIMARY (1:33) =
 22850                 PB-CONTROL-BY-ACCOUNT (1:33))
 22851        AND (OC-RECORD-TYPE =  'I')
 22852           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22853               GO TO 9991-CHECK-INDICATORS
 22854           ELSE
 22855               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22856               GO TO 9991-CRTO-ADD-REC
 22857           END-IF
 22858     END-IF.
 22859
 22860 9991-CRTO-NOT-FOUND.
 22861
 22862     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22863     MOVE 'OC'                TO OC-RECORD-ID
 22864     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22865                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 423
* EL050.cbl
 22866     MOVE +4096               TO OC-KEY-SEQ-NO.
 22867
 22868 9991-CRTO-ADD-REC.
 22869
 22870     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22871     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22872     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22873     MOVE 'I'                 TO OC-RECORD-TYPE
 22874     IF PB-ISSUE
 22875         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22876         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22877         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22878         MOVE PB-I-AGE               TO OC-INS-AGE
 22879         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22880         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22881         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22882         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22883         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22884         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22885         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22886         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22887         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22888         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22889         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22890         IF PB-I-JOINT-COMMISSION > +0
 22891             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22892         ELSE
 22893             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22894         END-IF
 22895         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22896         MOVE +0                     TO OC-LF-CANCEL-AMT
 22897                                        OC-LF-ITD-CANCEL-AMT
 22898         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22899         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22900         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22901         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22902         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22903         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22904         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22905         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22906         MOVE +0                     TO OC-AH-CANCEL-AMT
 22907                                        OC-AH-ITD-CANCEL-AMT
 22908         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22909         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22910         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22911     ELSE
 22912         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22913         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22914         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22915         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22916         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22917         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22918         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22919         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22920         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22921          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22922             MOVE SPACES             TO OC-LF-BENCD
 22923             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 424
* EL050.cbl
 22924                                        OC-LF-BEN-AMT
 22925                                        OC-LF-PRM-AMT
 22926                                        OC-LF-ALT-BEN-AMT
 22927                                        OC-LF-ALT-PRM-AMT
 22928                                        OC-LF-COMM-PCT
 22929                                        OC-LF-CANCEL-AMT
 22930             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22931             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22932         ELSE
 22933             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22934             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22935             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22936             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22937             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22938             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22939             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22940             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22941             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22942             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22943         END-IF
 22944         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22945         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22946          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22947             MOVE SPACES             TO OC-AH-BENCD
 22948             MOVE ZEROS              TO OC-AH-TERM
 22949                                        OC-AH-BEN-AMT
 22950                                        OC-AH-PRM-AMT
 22951                                        OC-AH-COMM-PCT
 22952                                        OC-AH-CANCEL-AMT
 22953                                        OC-AH-CP
 22954             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22955             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22956         ELSE
 22957             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22958             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22959             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22960             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22961             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22962             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22963             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22964             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22965             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22966         END-IF
 22967         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22968         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22969         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22970         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22971     END-IF
 22972     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22973
 22974     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22975
 22976
 22977* EXEC CICS READ
 22978*         DATASET   (FILE-ERMAIL)
 22979*         RIDFLD    (MA-CONTROL-PRIMARY)
 22980*         INTO      (MAILING-DATA)
 22981*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 425
* EL050.cbl
 22982*    END-EXEC
 22983     MOVE LENGTH OF
 22984      MAILING-DATA
 22985       TO DFHEIV11
 22986*    MOVE '&"IL       E          (  N#00021227' TO DFHEIV0
 22987     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22989     MOVE X'204E233030303231323237' TO DFHEIV0(25:11)
 22990     CALL 'kxdfhei1' USING DFHEIV0,
 22991           FILE-ERMAIL,
 22992           MAILING-DATA,
 22993           DFHEIV11,
 22994           MA-CONTROL-PRIMARY,
 22995           DFHEIV99,
 22996           DFHEIV99,
 22997           DFHEIV99
 22998     MOVE EIBRESP  TO WS-RESPONSE
 22999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23000
 23001     IF WS-RESP-NORMAL
 23002         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23003     END-IF.
 23004
 23005     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23006     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23007
 23008
 23009* EXEC CICS READ
 23010*         DATASET  (CRTT-ID)
 23011*         RIDFLD   (WS-ELCRTT-KEY)
 23012*         INTO     (CERTIFICATE-TRAILERS)
 23013*         RESP     (WS-RESPONSE)
 23014*    END-EXEC
 23015     MOVE LENGTH OF
 23016      CERTIFICATE-TRAILERS
 23017       TO DFHEIV11
 23018*    MOVE '&"IL       E          (  N#00021241' TO DFHEIV0
 23019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23021     MOVE X'204E233030303231323431' TO DFHEIV0(25:11)
 23022     CALL 'kxdfhei1' USING DFHEIV0,
 23023           CRTT-ID,
 23024           CERTIFICATE-TRAILERS,
 23025           DFHEIV11,
 23026           WS-ELCRTT-KEY,
 23027           DFHEIV99,
 23028           DFHEIV99,
 23029           DFHEIV99
 23030     MOVE EIBRESP  TO WS-RESPONSE
 23031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23032
 23033     IF WS-RESP-NORMAL
 23034         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 23035         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23036     END-IF.
 23037
 23038
 23039* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 426
* EL050.cbl
 23040*       DATASET   ('ELCRTO')
 23041*       FROM      (ORIGINAL-CERTIFICATE)
 23042*       RIDFLD    (OC-CONTROL-PRIMARY)
 23043*       RESP      (WS-RESPONSE)
 23044*    END-EXEC.
 23045     MOVE LENGTH OF
 23046      ORIGINAL-CERTIFICATE
 23047       TO DFHEIV11
 23048     MOVE 'ELCRTO' TO DFHEIV1
 23049*    MOVE '&$ L                  ''  N#00021253' TO DFHEIV0
 23050     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23052     MOVE X'204E233030303231323533' TO DFHEIV0(25:11)
 23053     CALL 'kxdfhei1' USING DFHEIV0,
 23054           DFHEIV1,
 23055           ORIGINAL-CERTIFICATE,
 23056           DFHEIV11,
 23057           OC-CONTROL-PRIMARY,
 23058           DFHEIV99,
 23059           DFHEIV99
 23060     MOVE EIBRESP  TO WS-RESPONSE
 23061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23062
 23063
 23064     GO TO 9991-EXIT.
 23065
 23066 9991-CHECK-INDICATORS.
 23067
 23068     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23069         GO TO 9991-EXIT
 23070     END-IF.
 23071
 23072     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23073         GO TO 9991-EXIT
 23074     END-IF.
 23075
 23076
 23077* EXEC CICS READ
 23078*       DATASET   ('ELCRTO')
 23079*       INTO      (ORIGINAL-CERTIFICATE)
 23080*       RIDFLD    (OC-CONTROL-PRIMARY)
 23081*       UPDATE
 23082*       RESP      (WS-RESPONSE)
 23083*    END-EXEC
 23084     MOVE LENGTH OF
 23085      ORIGINAL-CERTIFICATE
 23086       TO DFHEIV11
 23087     MOVE 'ELCRTO' TO DFHEIV1
 23088*    MOVE '&"IL       EU         (  N#00021272' TO DFHEIV0
 23089     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23090     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23091     MOVE X'204E233030303231323732' TO DFHEIV0(25:11)
 23092     CALL 'kxdfhei1' USING DFHEIV0,
 23093           DFHEIV1,
 23094           ORIGINAL-CERTIFICATE,
 23095           DFHEIV11,
 23096           OC-CONTROL-PRIMARY,
 23097           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 427
* EL050.cbl
 23098           DFHEIV99,
 23099           DFHEIV99
 23100     MOVE EIBRESP  TO WS-RESPONSE
 23101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23102     IF WS-RESP-NORMAL
 23103        IF PB-ISSUE
 23104          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23105          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23106          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23107          MOVE PB-I-AGE               TO OC-INS-AGE
 23108          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23109          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23110          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23111          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23112          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23113          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23114          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23115          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23116          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23117          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23118          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23119          IF PB-I-JOINT-COMMISSION > +0
 23120              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23121          ELSE
 23122              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23123          END-IF
 23124          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23125          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23126          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23127          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23128          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23129          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23130          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23131          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23132          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23133
 23134          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23135
 23136* EXEC CICS READ
 23137*             DATASET   (FILE-ERMAIL)
 23138*             RIDFLD    (MA-CONTROL-PRIMARY)
 23139*             INTO      (MAILING-DATA)
 23140*             RESP      (WS-RESPONSE)
 23141*         END-EXEC
 23142     MOVE LENGTH OF
 23143      MAILING-DATA
 23144       TO DFHEIV11
 23145*    MOVE '&"IL       E          (  N#00021312' TO DFHEIV0
 23146     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23148     MOVE X'204E233030303231333132' TO DFHEIV0(25:11)
 23149     CALL 'kxdfhei1' USING DFHEIV0,
 23150           FILE-ERMAIL,
 23151           MAILING-DATA,
 23152           DFHEIV11,
 23153           MA-CONTROL-PRIMARY,
 23154           DFHEIV99,
 23155           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 428
* EL050.cbl
 23156           DFHEIV99
 23157     MOVE EIBRESP  TO WS-RESPONSE
 23158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23159          IF WS-RESP-NORMAL
 23160             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23161          END-IF
 23162
 23163          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23164          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23165
 23166* EXEC CICS READ
 23167*             DATASET  (CRTT-ID)
 23168*             RIDFLD   (WS-ELCRTT-KEY)
 23169*             INTO     (CERTIFICATE-TRAILERS)
 23170*             RESP     (WS-RESPONSE)
 23171*         END-EXEC
 23172     MOVE LENGTH OF
 23173      CERTIFICATE-TRAILERS
 23174       TO DFHEIV11
 23175*    MOVE '&"IL       E          (  N#00021324' TO DFHEIV0
 23176     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23178     MOVE X'204E233030303231333234' TO DFHEIV0(25:11)
 23179     CALL 'kxdfhei1' USING DFHEIV0,
 23180           CRTT-ID,
 23181           CERTIFICATE-TRAILERS,
 23182           DFHEIV11,
 23183           WS-ELCRTT-KEY,
 23184           DFHEIV99,
 23185           DFHEIV99,
 23186           DFHEIV99
 23187     MOVE EIBRESP  TO WS-RESPONSE
 23188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23189          IF WS-RESP-NORMAL
 23190             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23191                               OC-INS-AGE-DEFAULT-FLAG
 23192             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23193                               OC-JNT-AGE-DEFAULT-FLAG
 23194          END-IF
 23195
 23196        ELSE
 23197          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23198             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23199             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23200             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23201          END-IF
 23202          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23203             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23204             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23205             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23206          END-IF
 23207          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23208        END-IF
 23209
 23210* EXEC CICS REWRITE
 23211*          DATASET   ('ELCRTO')
 23212*          FROM      (ORIGINAL-CERTIFICATE)
 23213*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 429
* EL050.cbl
 23214*       END-EXEC
 23215     MOVE LENGTH OF
 23216      ORIGINAL-CERTIFICATE
 23217       TO DFHEIV11
 23218     MOVE 'ELCRTO' TO DFHEIV1
 23219*    MOVE '&& L                  %  N#00021350' TO DFHEIV0
 23220     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23221     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23222     MOVE X'204E233030303231333530' TO DFHEIV0(25:11)
 23223     CALL 'kxdfhei1' USING DFHEIV0,
 23224           DFHEIV1,
 23225           ORIGINAL-CERTIFICATE,
 23226           DFHEIV11,
 23227           DFHEIV99
 23228     MOVE EIBRESP  TO WS-RESPONSE
 23229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23230     END-IF.
 23231
 23232 9991-EXIT.
 23233     EXIT.
 23234
 23235
 23236 9999-RETURN.
 23237     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23238
 23239
 23240* EXEC CICS RETURN
 23241*    END-EXEC.
 23242*    MOVE '.(                    ''   #00021364' TO DFHEIV0
 23243     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23245     MOVE X'2020233030303231333634' TO DFHEIV0(25:11)
 23246     CALL 'kxdfhei1' USING DFHEIV0,
 23247           DFHEIV99,
 23248           DFHEIV99,
 23249           DFHEIV99,
 23250           DFHEIV99,
 23251           DFHEIV99,
 23252           DFHEIV99
 23253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23254
 23255
 23256
 23257* GOBACK.
 23258     MOVE '9%                    "   ' TO DFHEIV0
 23259     MOVE 'EL050' TO DFHEIV1
 23260     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23261     GOBACK.
 23262
 23263 9999-DFHBACK SECTION.
 23264     MOVE '9%                    "   ' TO DFHEIV0
 23265     MOVE 'EL050' TO DFHEIV1
 23266     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23267     GOBACK.
 23268 9999-DFHEXIT.
 23269     IF DFHEIGDJ EQUAL 0001
 23270         NEXT SENTENCE
 23271     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 430
* EL050.cbl
 23272         GO TO 9300-ABEND,
 23273               3990-FILES-NOT-OPEN
 23274         DEPENDING ON DFHEIGDI
 23275     ELSE IF DFHEIGDJ EQUAL 3
 23276         GO TO 6610-START-BROWSE,
 23277               6630-ERRESS-PROBLEM,
 23278               6630-END-OF-FILE
 23279         DEPENDING ON DFHEIGDI
 23280     ELSE IF DFHEIGDJ EQUAL 4
 23281         GO TO 6630-END-OF-FILE,
 23282               6630-ERRESS-PROBLEM,
 23283               6630-ERRESS-PROBLEM,
 23284               6630-END-OF-FILE
 23285         DEPENDING ON DFHEIGDI
 23286     ELSE IF DFHEIGDJ EQUAL 5
 23287         GO TO 6630-END-OF-FILE,
 23288               6630-END-OF-FILE,
 23289               6630-ERRESS-PROBLEM,
 23290               6630-ERRESS-PROBLEM
 23291         DEPENDING ON DFHEIGDI
 23292     ELSE IF DFHEIGDJ EQUAL 6
 23293         GO TO 6660-START-BROWSE,
 23294               6690-ERRESC-PROBLEM,
 23295               6690-ERRESC-PROBLEM,
 23296               6690-END-OF-FILE
 23297         DEPENDING ON DFHEIGDI
 23298     ELSE IF DFHEIGDJ EQUAL 7
 23299         GO TO 6690-END-OF-FILE,
 23300               6690-ERRESC-PROBLEM,
 23301               6690-ERRESC-PROBLEM,
 23302               6690-END-OF-FILE
 23303         DEPENDING ON DFHEIGDI
 23304     ELSE IF DFHEIGDJ EQUAL 8
 23305         GO TO 6690-END-OF-FILE,
 23306               6690-ERRESC-PROBLEM,
 23307               6690-ERRESC-PROBLEM,
 23308               6690-END-OF-FILE
 23309         DEPENDING ON DFHEIGDI
 23310     ELSE IF DFHEIGDJ EQUAL 9
 23311         GO TO 7250-CONTINUE,
 23312               7250-CONTINUE
 23313         DEPENDING ON DFHEIGDI
 23314     ELSE IF DFHEIGDJ EQUAL 10
 23315         GO TO 7300-CONTINUE,
 23316               7300-CONTINUE
 23317         DEPENDING ON DFHEIGDI
 23318     ELSE IF DFHEIGDJ EQUAL 11
 23319         GO TO 7320-CONTINUE,
 23320               7320-CONTINUE
 23321         DEPENDING ON DFHEIGDI
 23322     ELSE IF DFHEIGDJ EQUAL 12
 23323         GO TO 8000-FREE-MAIN
 23324         DEPENDING ON DFHEIGDI
 23325     ELSE IF DFHEIGDJ EQUAL 13
 23326         GO TO 8100-NOTFND,
 23327               8100-NOTFND
 23328         DEPENDING ON DFHEIGDI
 23329     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 431
* EL050.cbl
 23330         GO TO 8110-NOTFND,
 23331               8110-NOTFND
 23332         DEPENDING ON DFHEIGDI
 23333     ELSE IF DFHEIGDJ EQUAL 15
 23334         GO TO 8130-EXIT
 23335         DEPENDING ON DFHEIGDI
 23336     ELSE IF DFHEIGDJ EQUAL 16
 23337         GO TO 8145-exit
 23338         DEPENDING ON DFHEIGDI
 23339     ELSE IF DFHEIGDJ EQUAL 17
 23340         GO TO 8190-NOTFND
 23341         DEPENDING ON DFHEIGDI
 23342     ELSE IF DFHEIGDJ EQUAL 18
 23343         GO TO 8195-NOTFND
 23344         DEPENDING ON DFHEIGDI
 23345     ELSE IF DFHEIGDJ EQUAL 19
 23346         GO TO 8200-NOTFND
 23347         DEPENDING ON DFHEIGDI
 23348     ELSE IF DFHEIGDJ EQUAL 20
 23349         GO TO 8300-NOTFND,
 23350               8300-ERRESS-PROBLEM,
 23351               8300-ERRESS-PROBLEM,
 23352               8300-NOTFND
 23353         DEPENDING ON DFHEIGDI
 23354     ELSE IF DFHEIGDJ EQUAL 21
 23355         GO TO 8450-FORM-NOT-FOUND,
 23356               8450-FORM-NOT-FOUND
 23357         DEPENDING ON DFHEIGDI
 23358     ELSE IF DFHEIGDJ EQUAL 22
 23359         GO TO 0199-ACCT-NOT-FOUND,
 23360               0199-ACCT-NOT-FOUND
 23361         DEPENDING ON DFHEIGDI
 23362     ELSE IF DFHEIGDJ EQUAL 23
 23363         GO TO 0199-ACCT-NOT-FOUND,
 23364               0199-ACCT-NOT-FOUND
 23365         DEPENDING ON DFHEIGDI
 23366     ELSE IF DFHEIGDJ EQUAL 24
 23367         GO TO 8582-COMP-NOT-FOUND,
 23368               8582-COMP-NOT-FOUND
 23369         DEPENDING ON DFHEIGDI
 23370     ELSE IF DFHEIGDJ EQUAL 25
 23371         GO TO 8583-AGTC-NOT-FOUND,
 23372               8583-AGTC-NOT-FOUND
 23373         DEPENDING ON DFHEIGDI
 23374     ELSE IF DFHEIGDJ EQUAL 26
 23375         GO TO 8584-BXRF-NOT-FOUND,
 23376               8584-BXRF-NOT-FOUND
 23377         DEPENDING ON DFHEIGDI
 23378     ELSE IF DFHEIGDJ EQUAL 27
 23379         GO TO 8585-PLAN-NOT-FOUND,
 23380               8585-PLAN-NOT-FOUND
 23381         DEPENDING ON DFHEIGDI
 23382     ELSE IF DFHEIGDJ EQUAL 28
 23383         GO TO 0299-CERT-NOT-FOUND
 23384         DEPENDING ON DFHEIGDI
 23385     ELSE IF DFHEIGDJ EQUAL 29
 23386         GO TO 8700-READ-CERT-MASTER
 23387         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-20 09:07 Page 432
* EL050.cbl
 23388     ELSE IF DFHEIGDJ EQUAL 30
 23389         GO TO 8720-COMP-ACCOUNTS,
 23390               8730-END-BROWSE,
 23391               8740-NOT-FOUND
 23392         DEPENDING ON DFHEIGDI
 23393     ELSE IF DFHEIGDJ EQUAL 31
 23394         GO TO 9000-NOTFND
 23395         DEPENDING ON DFHEIGDI
 23396     ELSE IF DFHEIGDJ EQUAL 32
 23397         GO TO 9100-NOTFND,
 23398               9100-NOTFND
 23399         DEPENDING ON DFHEIGDI
 23400     ELSE IF DFHEIGDJ EQUAL 33
 23401         GO TO 9991-CRTO-NOT-FOUND,
 23402               9991-CRTO-NOT-FOUND
 23403         DEPENDING ON DFHEIGDI.
 23404     MOVE '9%                    "   ' TO DFHEIV0
 23405     MOVE 'EL050' TO DFHEIV1
 23406     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23407     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41848     Code:       96015
