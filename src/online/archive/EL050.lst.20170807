* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   3
* EL050.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER   PIC X(32) VALUE '********************************'.
    65 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    66 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    67
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    77                                   USAGE IS POINTER.
    78 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    79 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    80                                   USAGE IS POINTER.
    81
    82 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    83 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    84                                   USAGE IS POINTER.
    85
    86*    COPY ELC50WS.
    87*****************************************************************
    88*                                                               *
    89*                            ELC50WS.                           *
    90*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    91*                            VMOD=2.061.                        *
    92*                                                               *
    93*   THIS IS THE WORKING STORAGE FOR EL050                       *
    94*                                   EL517                       *
    95*****************************************************************
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 123102                   PEMA  ADD DCC PROCESSING
   105* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   106* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   107* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   108* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   109* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   110* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   111* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   112* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   113* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   114* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   115* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   116* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   117* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   118* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   4
* EL050.cbl
   119* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   120* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   121* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   122* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   123* 030309  CR2009021700001  PEMA  ADD ER-2883
   124* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   125* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   127* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   128* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   129* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   130* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   131* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   132* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   133* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   134* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   135* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   136* 061412  CR2011022800001  AJRA  NAPERSOFT
   137* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   138* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   139* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   140* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   141* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   142* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   143* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   144* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   145* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   146* 091114  IR2014091000001  TANA  ADD ERROR 2898
   147* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   148* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   149* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   150*-----------------------------------------------------------------
   151
   152 01  WORK-AREAS.
   153
   154*****************************************************************
   155*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   156*****************************************************************
   157
   158     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   159     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   160     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   161     12  WS-NAME-EDIT-WORK-AREA.
   162         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   163         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   164             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   165         16  WS-WORK-NAME.
   166             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   167             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   168             20  FILLER           PIC X(10)     VALUE SPACES.
   169         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   170             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   171
   172*****************************************************************
   173*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   174*****************************************************************
   175
   176     12  WS-ERRESC-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   5
* EL050.cbl
   177         16 WS-ERRESC-SEARCH-KEY.
   178             20  WS-ERRESC-COMPANY-CD PIC  X.
   179             20  WS-ERRESC-CARRIER    PIC  X.
   180             20  WS-ERRESC-GROUP      PIC X(6).
   181             20  WS-ERRESC-STATE      PIC XX.
   182             20  WS-ERRESC-ACCOUNT    PIC X(10).
   183         16 WS-ERRESC-RESIDUAL-KEY.
   184             20  WS-ERRESC-AGENT      PIC X(10).
   185             20  WS-ERRESC-RES-STATE  PIC XX.
   186             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   187*                                          YYYYMMDD
   188     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   190
   191*RESIDENT STATE TAX MASTER(ERRESS)
   192*
   193     12  WS-ERRESS-KEY.
   194         16  WS-ERRESS-COMPANY-CD      PIC  X.
   195         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   196         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   197         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   198*                                          YYYYMMDD
   199
   200     12  WS-CONTRACT-DATE              PIC 9(8).
   201*                                          YYYYMMDD
   202     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   203     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   204         16 WS-YEAR-YY                 PIC   9999.
   205         16 FILLER                     PIC 9(4).
   206*                                          YYYYMMDD
   207     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   208     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   209     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   210     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   211
   212     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   213         88  DPRB-1ST-TIME                      VALUE ' '.
   214
   215*****************************************************************
   216*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   217*****************************************************************
   218
   219     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   220     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   221     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   223     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   224     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   225     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   226     12  ws-st-agent-sig-edit    pic x          value spaces.
   227     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   228     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   231         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   232         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   233     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   234         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   6
* EL050.cbl
   235         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   236     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   237
   238     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   239     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   240
   241     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   242     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   255     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   256     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   274     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   277     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   278     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   279     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   280     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   289     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   290     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   291     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   292     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   7
* EL050.cbl
   293     12  WS-2671-SW               PIC X         VALUE SPACE.
   294     12  WS-2672-SW               PIC X         VALUE SPACE.
   295     12  ws-9813-sw               pic x         value spaces.
   296     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   297         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   298     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   299         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   300     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   301
   302     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   303         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   304         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   305         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   306         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   307
   308     12  WS-CREDIT-EDIT-CONTROLS.
   309         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   310         16  WS-MIN-AGE           PIC 99                VALUE  0.
   311         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   312         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   313         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   314         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   315
   316     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   317     12  WS-AGE-FIELDS.
   318         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   319         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   320         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   321         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   322
   323     12  WS-SAVE-ALLOWABLE-BENEFIT.
   324         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   325         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   326         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   327         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   328         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   329         16  FILLER                      PIC XX.
   330
   331     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   332     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   333     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   334     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   335     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   336     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   337     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   338     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   339     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   340     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   341
   342     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   343     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   344     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   345     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   346     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   347     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   348     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   349     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   350         88  WS-REDUCING              VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   8
* EL050.cbl
   351         88  WS-LEVEL                 VALUE 'L' 'P'.
   352     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   353
   354     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   355     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   356     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   357     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   358     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   359     12  ws-ah-max-bens           pic 99        value zeros.
   360     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   361     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   362     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   363     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   364
   365     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   367     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   368     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   369     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   370     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   371     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   372     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   373     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   374     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   375     12  WS-ACCT-SIG-SW.
   376         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   377         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   378     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   379     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   380     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   382     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   385     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  WS-INITIALS.
   388         16  WS-INIT-1            PIC X         VALUE SPACES.
   389         16  WS-INIT-2            PIC X         VALUE SPACES.
   390
   391     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   392     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   393     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   394     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   395     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   396*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   397     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   404     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   405     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   407     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   408     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   9
* EL050.cbl
   409     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   410     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419******** FLA
   420     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   424     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   425********
   426     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   427     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   428     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   429     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   430     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   431     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   432     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   433     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   434     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   435     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   436
   437     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   438         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   439                                         '0' THRU '9'.
   440
   441     12  NUMBER-OF-MONTHS.
   442         16  SK-MO OCCURS 12 TIMES PIC X.
   443
   444     12  WS-WORK-DATE.
   445         16  WS-YEAR            PIC 99    VALUE 00.
   446         16  WS-MONTH           PIC 99    VALUE 00.
   447         16  WS-DAY             PIC 99    VALUE 00.
   448
   449     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   450     12  WS-WORK-CRIT-DEV       REDEFINES
   451         WS-WORK-LF-CRIT-PER    PIC X(03).
   452
   453     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   454     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   455
   456     12  WS-WORK-DATE-FROM.
   457         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X  VALUE SPACE.
   459         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X         VALUE SPACE.
   461         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   462
   463     12  WS-WORK-DATE-THRU.
   464         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   465         16  FILLER             PIC X         VALUE SPACE.
   466         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  10
* EL050.cbl
   467         16  FILLER             PIC X         VALUE SPACE.
   468         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   469
   470     12  WS-LF-INPUT-CD.
   471         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   472         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   473
   474     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   475     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   476         16  WS-AH-INPUT-CD-1   PIC X.
   477         16  WS-AH-INPUT-CD-2-3 PIC XX.
   478
   479     12  WS-SWITCHES.
   480         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   481         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   482             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   483         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   484             88  BANK-ACCT-FOUND          VALUE 'Y'.
   485         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   487         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   489         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   490             88  COMP-MASTER-FOUND        VALUE 'Y'.
   491         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   492             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   493         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   494             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   495         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   496             88  STAT-MASTER-FOUND        VALUE 'Y'.
   497         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   498             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   499         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   500             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   501         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   502             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   503         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   504             88  FORM-MASTER-FOUND        VALUE 'Y'.
   505         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   506             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   507         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   508             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   509         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   510             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   511         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   512             88  NO-BENEFIT-FOUND         VALUE 'N'.
   513         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   514             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   515         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   516             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   517         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  AH-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   520         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   521             88  LF-BENEFIT-FOUND         VALUE ' '.
   522             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   523         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   524             88  NO-STATE-RECORD          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  11
* EL050.cbl
   525         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   526             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   527         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   528             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   529         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   530             88  CERT-WAS-FOUND           VALUE ' '.
   531             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   532         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   533             88  BROWSE-STARTED           VALUE 'Y'.
   534         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   535             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   536         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   537             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   538         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   539             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   540         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   541             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   542         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   543             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   544         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   545             88  APP-CERT-USED            VALUE 'Y' 'A'.
   546         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   547             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   548             88  FIRST-TIME-THROUGH       VALUE '1'.
   549             88  CTBL-NOT-FOUND           VALUE '2'.
   550
   551         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   552             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   553
   554         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   555             88  DLO-ERROR-FOUND          VALUE 'Y'.
   556
   557********FLA
   558     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   559     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   560********
   561     12  RC-SW-1                  PIC X           VALUE '0'.
   562     12  RC-SW-2                  PIC X           VALUE '0'.
   563     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   564     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   565     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   573     12  LIT-SPACES               PIC X           VALUE SPACES.
   574     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   575     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   576     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   577     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   578     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   579     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   580     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   581         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   582         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  12
* EL050.cbl
   583     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   584         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   585
   586 01  WS-EXTRA-PERIODS-BY-STATE.
   587     12  WS-INT-PERIODS          PIC 9.
   588     12  WS-EXTRA-PMTS           PIC 9.
   589 01  ws-net-only-state           pic x value 'N'.
   590 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   591     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   592     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   593 01  WS-CRI-SSN-WORK-AREA.
   594     05  WS-CRI-SOC-SEC-NO.
   595         10  WS-SS-REPT-CD       PIC X(5).
   596         10  WS-SS-LAST-NAME     PIC X(5).
   597         10  WS-SS-INITIAL       PIC X.
   598
   599     05  WS-CRI-REPORT-CODE.
   600         10  FILLER              PIC X(5).
   601         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   602
   603     05  WS-CRI-LAST-NAME.
   604         10  WS-CRI-NAME-MOVE    PIC X(5).
   605         10  FILLER              PIC X(10).
   606
   607 01  WS-NUM-TABLE                PIC X(26)  VALUE
   608     '12345678012345070923456789'.
   609 01  FILLER REDEFINES WS-NUM-TABLE.
   610     05  WS-NUM OCCURS 26        PIC 9.
   611 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   612 01  V1                          PIC S999 COMP-3.
   613 01  V2                          PIC S999 COMP-3.
   614 01  V3                          PIC S999 COMP-3.
   615 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   616 01  FILLER REDEFINES WS-WORK-VIN.
   617     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   618 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   619 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   620 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   621 01  WS-HEX-WORK.
   622     05  FILLER                  PIC X  VALUE LOW-VALUES.
   623     05  WS-HEX-BYTE             PIC X.
   624 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   625 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   626 01  WS-WORK-HIN-ROW-B.
   627     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   628
   629 01  ws-benefit-cd-chg-sw      pic x value spaces.
   630     88  benefit-code-chg           value 'Y'.
   631 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   632 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   633     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   634 01  WS-ROW-D-TABLE.
   635     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   636
   637 01  WS-HIN-TABLE-B.
   638     05  F                       PIC XX VALUE 'A2'.
   639     05  F                       PIC XX VALUE 'B3'.
   640     05  F                       PIC XX VALUE 'C4'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  13
* EL050.cbl
   641     05  F                       PIC XX VALUE 'D5'.
   642     05  F                       PIC XX VALUE 'E6'.
   643     05  F                       PIC XX VALUE 'F7'.
   644     05  F                       PIC XX VALUE 'G8'.
   645     05  F                       PIC XX VALUE 'H9'.
   646     05  F                       PIC XX VALUE 'I1'.
   647     05  F                       PIC XX VALUE 'J2'.
   648     05  F                       PIC XX VALUE 'K3'.
   649     05  F                       PIC XX VALUE 'L4'.
   650     05  F                       PIC XX VALUE 'M5'.
   651     05  F                       PIC XX VALUE 'N6'.
   652     05  F                       PIC XX VALUE 'O0'.
   653     05  F                       PIC XX VALUE 'P7'.
   654     05  F                       PIC XX VALUE 'Q0'.
   655     05  F                       PIC XX VALUE 'R8'.
   656     05  F                       PIC XX VALUE 'S9'.
   657     05  F                       PIC XX VALUE 'T2'.
   658     05  F                       PIC XX VALUE 'U3'.
   659     05  F                       PIC XX VALUE 'V4'.
   660     05  F                       PIC XX VALUE 'W5'.
   661     05  F                       PIC XX VALUE 'X6'.
   662     05  F                       PIC XX VALUE 'Y7'.
   663     05  F                       PIC XX VALUE 'Z8'.
   664 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   665     05  WS-VAL-IN               PIC X.
   666     05  WS-VAL-OUT              PIC 9.
   667 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   668 01  WS-COMPARE-BINARY-DATES.
   669     05  WS-971231                PIC XX VALUE X'92FF'.
   670     05  WS-931231                PIC XX VALUE X'8CFF'.
   671     05  WS-791231                PIC XX VALUE X'77FF'.
   672     05  WS-771001                PIC XX VALUE X'74A1'.
   673     05  WS-820301                PIC XX VALUE X'7B41'.
   674     05  WS-831031                PIC XX VALUE X'7DBF'.
   675     05  WS-831231                PIC XX VALUE X'7DFF'.
   676     05  WS-810831                PIC XX VALUE X'7A7F'.
   677     05  WS-830901                PIC XX VALUE X'7D81'.
   678
   679 01  FILE-ACCESS-IDS.
   680     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   681     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   682     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   683     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   684     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   685     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   686     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   687     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   688     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   689     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   690     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   691     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   692     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   693     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   694     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   695     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   696     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   697 01  DD-IU-SW                    PIC X   VALUE ' '.
   698     88  DD-IU-PRESENT                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  14
* EL050.cbl
   699
   700 01  ACCESS-KEYS.
   701     12  ELMSTR-KEY.
   702         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   704     12  W-CLAIM-KEY.
   705         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   706         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   707
   708     12  ELCNTL-KEY.
   709         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   710         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   711         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   712         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   713
   714     12  ELCERT-KEY.
   715         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   716         16  CERT-CARRIER         PIC X       VALUE SPACE.
   717         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   718         16  CERT-STATE           PIC XX      VALUE SPACES.
   719         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   720         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   721         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   722
   723     12  ELCERT2-KEY.
   724         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   725         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   726
   727     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   728
   729     12  ELCERT-SAVE.
   730         16  FILLER                      PIC XX    VALUE SPACES.
   731
   732         16  WCS-CONTROL-PRIMARY.
   733             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   734             20  WCS-CARRIER             PIC X     VALUE SPACE.
   735             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   736             20  WCS-STATE               PIC XX    VALUE SPACES.
   737             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   738             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   739             20  WCS-CERT-NO.
   740                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   741                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   742
   743         16  CS-CONTROL-BY-NAME.
   744             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   745             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   746             20  CS-INSURED-INITIALS.
   747                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   748                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   749
   750         16  CS-CONTROL-BY-SSN.
   751             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   752             20  CS-SOC-SEC-NO.
   753                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   754                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   755                 24  CS-SSN-LN3.
   756                     28 CS-INSURED-INITIALS-A2   PIC XX
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  15
* EL050.cbl
   757                                     VALUE SPACES.
   758                     28 CS-PART-LAST-NAME-A2     PIC X
   759                                     VALUE SPACE.
   760
   761         16  CS-CONTROL-BY-CERT-NO.
   762             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   763             20  CS-CERT-NO-A4           PIC X(11)
   764                                     VALUE SPACES.
   765
   766         16  CS-CONTROL-BY-MEMB.
   767             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   768             20  CS-MEMBER-NO.
   769                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   770                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   771                 24  CS-MEMB-LN4.
   772                     28 CS-INSURED-INITIALS-A5   PIC XX
   773                                      VALUE SPACES.
   774                     28 CS-PART-LAST-NAME-A5     PIC XX
   775                                      VALUE SPACES.
   776
   777         16  FILLER              PIC X(360) VALUE SPACES.
   778
   779     12  ERACCT-KEY.
   780         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   782         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   783         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   784         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   785         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   786
   787     12  ERCOMP-KEY.
   788         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  COMP-CARRIER         PIC X     VALUE SPACES.
   790         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   791         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   792         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   793         16  COMP-TYPE            PIC X     VALUE SPACES.
   794
   795     12  ERLOFC-KEY.
   796         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   797         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   798         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   799         16  LOFC-STATE           PIC XX    VALUE SPACES.
   800         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   801         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   802
   803     12  WS-ELCRTT-KEY.
   804         16  WS-ELCRTT-PRIMARY       PIC X(33).
   805         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   806
   807     12  ERBXRF-KEY.
   808         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   810         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   811         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   812
   813     12  ERAGTC-KEY.
   814         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  16
* EL050.cbl
   815         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   816         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   817         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   818         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   819         16  AGTC-TYPE            PIC X     VALUE SPACES.
   820
   821     12  ERPLAN-KEY.
   822         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   823         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   824         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   825         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   826         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   827         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   828         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   829         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   830
   831     12  ERFORM-KEY.
   832         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   833         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   834         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   835         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   836
   837     12  ERREIN-KEY.
   838         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  REIN-TYPE            PIC X     VALUE SPACES.
   840         16  REIN-TABLE-CO.
   841             20  REIN-CODE-1      PIC X     VALUE SPACE.
   842             20  REIN-CODE-2      PIC X     VALUE SPACE.
   843             20  REIN-CODE-3      PIC X     VALUE SPACE.
   844         16  FILLER               PIC X(3)  VALUE SPACES.
   845
   846     12  ERCTBL-KEY.
   847         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   848         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   849         16  CTBL-CNTRL-2.
   850             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   851             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   852
   853     12  ELCRTO-KEY.
   854         16  ELCRTO-COMPANY-CD       PIC X.
   855         16  ELCRTO-CARRIER          PIC X.
   856         16  ELCRTO-GROUPING         PIC X(6).
   857         16  ELCRTO-STATE            PIC XX.
   858         16  ELCRTO-ACCOUNT          PIC X(10).
   859         16  ELCRTO-CERT-EFF-DT      PIC XX.
   860         16  ELCRTO-CERT-NO.
   861             20  ELCRTO-CERT-PRIME   PIC X(10).
   862             20  ELCRTO-CERT-SFX     PIC X.
   863         16  ELCRTO-RECORD-TYPE      PIC X.
   864         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   865
   866
   867     12  WS-ACCESS.
   868         16  FILLER               PIC XX    VALUE SPACES.
   869         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   870
   871     12  WS-CARR-ACCESS.
   872         16  FILLER               PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  17
* EL050.cbl
   873         16  WS-CARR              PIC X     VALUE SPACE.
   874*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   875*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   876     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   877         88  WS-DMD-LF-RATING   VALUE 'Y'.
   878         88  WS-DMD-AH-RATING   VALUE 'Y'.
   879         88  WS-DMD-NO-RATING   VALUE 'N'.
   880
   881     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   882         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   883                                         'NJ' 'NL'
   884                                         'PJ' 'PL'
   885                                         'SJ' 'SL'.
   886     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   887         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   888                                         'NI' 'NJ' 'NL' 'NU'
   889                                         'PJ' 'PL' 'PI' 'PU'
   890                                         'SI' 'SJ' 'SL' 'SU'
   891                                         'MX' 'MY' 'MZ'.
   892 01  ERPDEF-KEY-SAVE             PIC X(18).
   893 01  ERPDEF-KEY.
   894     12  ERPDEF-COMPANY-CD       PIC X.
   895     12  ERPDEF-STATE            PIC XX.
   896     12  ERPDEF-PROD-CD          PIC XXX.
   897     12  F                       PIC X(7).
   898     12  ERPDEF-BEN-TYPE         PIC X.
   899     12  ERPDEF-BEN-CODE         PIC XX.
   900     12  ERPDEF-EXP-DT           PIC XX.
   901
   902 01  ELSTAT-KEY-SAVE             PIC X(20).
   903 01  ELSTAT-KEY.
   904     12  ELSTAT-COMPANY-ID       PIC XXX.
   905     12  ELSTAT-CARRIER          PIC X.
   906     12  ELSTAT-GROUP            PIC X(6).
   907     12  ELSTAT-STATE            PIC XX.
   908     12  ELSTAT-EXP-DT           PIC 9(8).
   909 01  WS-ERROR-VALUES.
   910     12  ER-1570                     PIC S9(4)   VALUE +1570.
   911     12  ER-1571                     PIC S9(4)   VALUE +1571.
   912     12  er-1572                     pic s9(4)   value +1572.
   913     12  er-1573                     pic s9(4)   value +1573.
   914     12  er-1574                     pic s9(4)   value +1574.
   915     12  ER-1575                     PIC S9(4)   VALUE +1575.
   916     12  er-1576                     pic s9(4)   value +1576.
   917     12  er-1583                     pic s9(4)   value +1583.
   918     12  er-1743                     pic s9(4)   value +1743.
   919     12  er-1744                     pic s9(4)   value +1744.
   920     12  er-1745                     pic s9(4)   value +1745.
   921     12  er-1746                     pic s9(4)   value +1746.
   922     12  er-1747                     pic s9(4)   value +1747.
   923     12  er-1748                     pic s9(4)   value +1748.
   924     12  ER-1891                     PIC S9(4)   VALUE +1891.
   925     12  ER-1892                     PIC S9(4)   VALUE +1892.
   926     12  ER-1893                     PIC S9(4)   VALUE +1893.
   927     12  ER-1894                     PIC S9(4)   VALUE +1894.
   928     12  ER-1895                     PIC S9(4)   VALUE +1895.
   929     12  ER-1896                     PIC S9(4)   VALUE +1896.
   930     12  ER-1897                     PIC S9(4)   VALUE +1897.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  18
* EL050.cbl
   931     12  ER-1898                     PIC S9(4)   VALUE +1898.
   932     12  ER-1899                     PIC S9(4)   VALUE +1899.
   933     12  ER-1900                     PIC S9(4)   VALUE +1900.
   934     12  ER-1901                     PIC S9(4)   VALUE +1901.
   935     12  ER-1902                     PIC S9(4)   VALUE +1902.
   936     12  ER-1903                     PIC S9(4)   VALUE +1903.
   937     12  ER-1904                     PIC S9(4)   VALUE +1904.
   938     12  ER-1905                     PIC S9(4)   VALUE +1905.
   939     12  ER-1906                     PIC S9(4)   VALUE +1906.
   940     12  ER-1907                     PIC S9(4)   VALUE +1907.
   941     12  ER-1909                     PIC S9(4)   VALUE +1909.
   942     12  ER-1910                     PIC S9(4)   VALUE +1910.
   943     12  ER-1911                     PIC S9(4)   VALUE +1911.
   944     12  ER-1912                     PIC S9(4)   VALUE +1912.
   945     12  ER-1913                     PIC S9(4)   VALUE +1913.
   946     12  ER-1914                     PIC S9(4)   VALUE +1914.
   947     12  ER-1915                     PIC S9(4)   VALUE +1915.
   948     12  ER-1916                     PIC S9(4)   VALUE +1916.
   949     12  ER-1917                     PIC S9(4)   VALUE +1917.
   950     12  ER-1918                     PIC S9(4)   VALUE +1918.
   951     12  ER-1919                     PIC S9(4)   VALUE +1919.
   952     12  ER-1920                     PIC S9(4)   VALUE +1920.
   953     12  ER-1921                     PIC S9(4)   VALUE +1921.
   954     12  ER-1922                     PIC S9(4)   VALUE +1922.
   955     12  ER-1923                     PIC S9(4)   VALUE +1923.
   956     12  ER-1924                     PIC S9(4)   VALUE +1924.
   957     12  ER-1925                     PIC S9(4)   VALUE +1925.
   958     12  ER-1926                     PIC S9(4)   VALUE +1926.
   959     12  ER-1927                     PIC S9(4)   VALUE +1927.
   960     12  ER-2393                     PIC S9(4)   VALUE +2393.
   961     12  ER-2600                     PIC S9(4)   VALUE +2600.
   962     12  ER-2601                     PIC S9(4)   VALUE +2601.
   963     12  ER-2602                     PIC S9(4)   VALUE +2602.
   964     12  ER-2603                     PIC S9(4)   VALUE +2603.
   965     12  ER-2604                     PIC S9(4)   VALUE +2604.
   966     12  ER-2605                     PIC S9(4)   VALUE +2605.
   967     12  ER-2606                     PIC S9(4)   VALUE +2606.
   968     12  ER-2607                     PIC S9(4)   VALUE +2607.
   969     12  ER-2608                     PIC S9(4)   VALUE +2608.
   970     12  ER-2609                     PIC S9(4)   VALUE +2609.
   971     12  ER-2610                     PIC S9(4)   VALUE +2610.
   972     12  ER-2611                     PIC S9(4)   VALUE +2611.
   973     12  ER-2612                     PIC S9(4)   VALUE +2612.
   974     12  ER-2613                     PIC S9(4)   VALUE +2613.
   975     12  ER-2614                     PIC S9(4)   VALUE +2614.
   976     12  ER-2615                     PIC S9(4)   VALUE +2615.
   977     12  ER-2616                     PIC S9(4)   VALUE +2616.
   978     12  ER-2617                     PIC S9(4)   VALUE +2617.
   979     12  ER-2618                     PIC S9(4)   VALUE +2618.
   980     12  ER-2619                     PIC S9(4)   VALUE +2619.
   981     12  ER-2620                     PIC S9(4)   VALUE +2620.
   982     12  ER-2621                     PIC S9(4)   VALUE +2621.
   983     12  ER-2622                     PIC S9(4)   VALUE +2622.
   984     12  ER-2623                     PIC S9(4)   VALUE +2623.
   985     12  ER-2624                     PIC S9(4)   VALUE +2624.
   986     12  ER-2625                     PIC S9(4)   VALUE +2625.
   987     12  ER-2626                     PIC S9(4)   VALUE +2626.
   988     12  ER-2627                     PIC S9(4)   VALUE +2627.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  19
* EL050.cbl
   989     12  ER-2628                     PIC S9(4)   VALUE +2628.
   990     12  ER-2629                     PIC S9(4)   VALUE +2629.
   991     12  ER-2630                     PIC S9(4)   VALUE +2630.
   992     12  ER-2631                     PIC S9(4)   VALUE +2631.
   993     12  ER-2632                     PIC S9(4)   VALUE +2632.
   994     12  ER-2633                     PIC S9(4)   VALUE +2633.
   995     12  ER-2634                     PIC S9(4)   VALUE +2634.
   996     12  ER-2635                     PIC S9(4)   VALUE +2635.
   997     12  ER-2636                     PIC S9(4)   VALUE +2636.
   998     12  ER-2637                     PIC S9(4)   VALUE +2637.
   999     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1000     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1001     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1002     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1003     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1004     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1005     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1006     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1007     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1008     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1009     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1010     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1011     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1012     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1013     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1014     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1015     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1016     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1017     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1018     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1019     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1020     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1021     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1022     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1023     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1024     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1025     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1026     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1027     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1028     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1029     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1030     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1031     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1032     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1033     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1034     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1035     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1036     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1037     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1038     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1039     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1040     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1041     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1042     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1043     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1044     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1045     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1046     12  ER-2685                     PIC S9(4)   VALUE +2685.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  20
* EL050.cbl
  1047     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1048     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1049     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1050     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1051     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1052     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1053     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1054     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1055     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1056     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1057     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1058     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1059     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1060     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1061     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1062     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1063     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1064     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1065     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1066     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1067     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1068     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1069     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1070     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1071     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1072     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1073     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1074     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1075     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1076     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1077     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1078     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1079     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1080     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1081     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1082     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1083     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1084     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1085     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1086     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1087     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1088     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1089     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1090     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1091     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1092     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1093     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1094     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1095     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1096     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1097     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1098     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1099     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1100     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1101     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1102     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1103     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1104     12  ER-2753                     PIC S9(4)   VALUE +2753.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  21
* EL050.cbl
  1105     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1106     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1107     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1108     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1109     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1110     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1111     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1112     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1113     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1114     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1115     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1116     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1117     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1118     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1119     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1120     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1121     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1122     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1123     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1124     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1125     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1126     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1127     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1128     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1129     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1130     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1131     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1132     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1133     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1134     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1135     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1136     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1137     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1138     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1139     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1140     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1141     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1142     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1143     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1144     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1145     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1146     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1147     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1148     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1149     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1150     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1151     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1152     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1153     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1154     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1155     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1156     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1157     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1158     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1159     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1160     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1161     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1162     12  ER-2898                     PIC S9(4)   VALUE +2898.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  22
* EL050.cbl
  1163     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1164     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1165     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1166     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1167     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1168     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1169     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1170     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1171     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1172     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1173     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1174     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1175     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1176     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1177     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1178     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1179     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1180     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1181     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1182     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1183     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1184     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1185     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1186     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1187     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1188     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1189     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1190     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1191     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1192     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1193     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1194     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1195     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1196     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1197     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1198     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1199     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1200     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1201     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1202     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1203     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1204     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1205     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1206     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1207     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1208     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1209     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1210     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1211     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1212     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1213     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1214     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1215     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1216     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1217     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1218     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1219     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1220     12  ER-8080                     PIC S9(4)   VALUE +8080.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  23
* EL050.cbl
  1221     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1222     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1223     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1224     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1225     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1226     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1227     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1228     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1229     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1230     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1231     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1232     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1233     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1234     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1235     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1236     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1237     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1238     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1239     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1240     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1241     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1242     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1243     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1244     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1245     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1246     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1247     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1248     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1249     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1250     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1251     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1252     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1253     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1254     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1255     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1256     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1257     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1258     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1259     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1260     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1261     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1262     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1263     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1264     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1265     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1266     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1267     12  er-9823                     pic s9(4)   value +9823.
  1268     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1269******************************************************************
  1270***************   END OF ELC50WS     ****************************
  1271******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  24
* EL050.cbl
  1274 01  WORKING-STORAGE-WORK-AREAS.
  1275     12  WS-RESPONSE             PIC S9(8)  COMP.
  1276         88  WS-RESP-NORMAL           VALUE +00.
  1277         88  WS-RESP-ERROR            VALUE +01.
  1278         88  WS-RESP-NOTFND           VALUE +13.
  1279         88  WS-RESP-DUPREC           VALUE +14.
  1280         88  WS-RESP-ENDFILE          VALUE +20.
  1281     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1282     12  WORK-AREAS.
  1283         16  WK-CONV-GREG.
  1284             24  WCG-CENT             PIC XX.
  1285             24  WCG-REST             PIC X(4).
  1286         16  WORK-GREGORIAN-DATE.
  1287             24  WK-GREG-CENT         PIC XX.
  1288             24  WK-GREG-DATE-YYMMDD.
  1289                 28  WK-GREG-YYMM     PIC X(4).
  1290                 28  WK-GREG-DD       PIC XX.
  1291
  1292         16  WORK-SELECT-DATE.
  1293             24  WK-SELECT-CENT            PIC XX.
  1294             24  WK-SELECT-DATE-YYMMDD.
  1295                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1296                 28  FILLER                PIC XX.
  1297
  1298         16  WK-FORM-NO.
  1299             24  WK-FORM-BANK-ID       PIC X(5).
  1300             24  WK-FORM-UNDRWRTR      PIC X(1).
  1301             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1302
  1303         16  WK-MEMBER-NO.
  1304             24  WK-MEMBER-1-6        PIC X(6).
  1305             24  WK-MEMBER-7-12       PIC X(6).
  1306
  1307         16  WK-FULL-CERT-NO.
  1308             24  WK-CERT-POS-1-2      PIC X(2).
  1309             24  WK-CERT-POS-3        PIC X(1).
  1310             24  WK-CERT-POS-4        PIC X(1).
  1311             24  WK-CERT-POS-5-6      PIC X(2).
  1312             24  WK-CERT-POS-7        PIC X(1).
  1313             24  WK-CERT-POS-8-11     PIC X(4).
  1314
  1315         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1316             88  VALID-RATE-CODE        VALUE 'Y'.
  1317             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1318
  1319         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1320         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1321         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1322         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1323         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1324         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1325         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1326         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1327         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1328         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1329
  1330* DLO001
  1331 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  25
* EL050.cbl
  1332     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1333     12  DMPF-RETURN-CODE          PIC XX.
  1334         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1335         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1336         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1337         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1338         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1339         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1340
  1341* DLO002
  1342 01  WS-DLO-INTERNAL-POLICY-FORM.
  1343     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1344     12  DIPF-RETURN-CODE          PIC XX.
  1345         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1346         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1347         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1348         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1349         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1350         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1351
  1352* DLO003
  1353 01  WS-DLO-VALID-BANK-ID.
  1354     12  DVBI-BANK-ID              PIC X(5).
  1355     12  DVBI-BANK-ID-TYPE         PIC X.
  1356         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1357         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1358         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1359         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1360         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1361     12  DVBI-RETURN-CODE          PIC XX.
  1362         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1363         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1364         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1365         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1366         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1367         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1368         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1369         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1370         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1371
  1372* DLO007
  1373 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1374     12  DCUA-RES-STATE            PIC XX.
  1375     12  DCUA-BEN-TYPE             PIC XX.
  1376     12  DCUA-SYS-IDENT            PIC X.
  1377         88  DCUA-CLAIM                        VALUE 'C'.
  1378         88  DCUA-PREMIUM                      VALUE 'P'.
  1379     12  DCUA-COVERAGE-RULE        PIC X.
  1380     12  DCUA-CLIENT-ID            PIC X(10).
  1381     12  DCUA-EFF-DATE             PIC X(8).
  1382     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1383     12  DCUA-RETURN-CODE          PIC XX.
  1384         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1385     12  DCUA-CERT-NUMBER          PIC X(11).
  1386     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1387     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1388
  1389* DLO011
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  26
* EL050.cbl
  1390 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1391     12  DPRB-RATE-CODE            PIC X(4).
  1392     12  DPRB-COVERAGE-CATEG       PIC X.
  1393     12  DPRB-RETURN-CODE          PIC XX.
  1394         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1395         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1396         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1397         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1398         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1399         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1400         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1401         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1402         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1403     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1404     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1405     12  DPRB-BEN-TYPE             PIC XX.
  1406
  1407* DLO017
  1408 01  WS-DLO-VALID-RATE-CODE.
  1409     12  DVRC-RATE-CODE            PIC X(4).
  1410     12  DVRC-RETURN-CODE          PIC XX.
  1411         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1413         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1414         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1415         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1416         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1417
  1418* DLO019
  1419 01  WS-DLO-ORIG-COV-CAT.
  1420     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1421     12  DOCC-RETURN-CODE          PIC XX.
  1422     12  DOCC-ORIG-COV-CAT         PIC X.
  1423     12  DOCC-UNDERWITER           PIC XX.
  1424     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1425     12  DOCC-FILLER               PIC X(6).
  1426
  1427* DLO021
  1428 01  WS-DLO-VALID-LOAN-OFFICER.
  1429     12  DVLO-LOAN-OFFICER.
  1430         16  DVLO-BILL-TYPE        PIC X.
  1431         16  DVLO-BILL-SOURCE      PIC X.
  1432         16  DVLO-BATCH-TYPE       PIC X.
  1433     12  DVLO-RETURN-CODE          PIC XX.
  1434         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1435         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1436         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1437         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1438         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1439         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1440
  1441* DLO022
  1442 01  WS-DLO-VALID-STATE-CODE.
  1443     12  DVSC-STATE-CODE           PIC XX.
  1444     12  DVSC-RETURN-CODE          PIC XX.
  1445         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1446
  1447* DLO023
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  27
* EL050.cbl
  1448 01  WS-DLO-VALID-CODE-VALUES.
  1449     12  DVCV-SYSTEM-ID            PIC XX.
  1450         88  DVCV-CLAIMS                       VALUE 'CL'.
  1451         88  DVCV-CREDIT                       VALUE 'CR'.
  1452     12  DVCV-RECORD-TYPE          PIC XX.
  1453         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1454         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1455         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1456         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1457         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1458         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1459         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1460         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1461     12  DVCV-RECORD-KEY           PIC X(6).
  1462     12  DVCV-RETURN-CODE          PIC XX.
  1463         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1464         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1465         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1466         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1467         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1468         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1469         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1470     12  DVCV-CODE-DESC            PIC X(60).
  1471     12  DVCV-GEN-DESC-1           PIC X(20).
  1472     12  DVCV-GEN-DESC-2           PIC X(20).
  1473     12  DVCV-GEN-DESC-3           PIC X(20).
  1474
  1475 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1476 01  hldi-pass-area.
  1477     03  PA-VIN                  PIC X(17).
  1478     03  PA-ErrorCode            PIC X(10).
  1479     03  PA-ErrorDesc            PIC X(30).
  1480     03  PA-ModelYear            PIC 9(7).
  1481     03  PA-MakeName             PIC X(50).
  1482     03  PA-ModelName            PIC X(50).
  1483     03  PA-SeriesName           PIC X(50).
  1484****  this is for aggregate report.
  1485****  Length is erpndb + 100 of passed-key-area
  1486 01  ws-passed-key-length        pic s9(4) comp value +587.
  1487 01  ws-pass-to-pemaggo.
  1488     05  ws-passed-erpndb        pic x(585).
  1489     05  ws-exceed-limit-yn      pic x.
  1490     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  28
* EL050.cbl
  1492*    COPY ERCBXRF.
  1493******************************************************************
  1494*                                                                *
  1495*                                                                *
  1496*                            ERCBXRF                             *
  1497*                                                                *
  1498*   ONLINE CREDIT SYSTEM                                         *
  1499*                                                                *
  1500*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1501*                                                                *
  1502*   FILE TYPE = VSAM,KSDS                                        *
  1503*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1504*                                                                *
  1505*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1506*       ALTERNATE PATH = NONE                                    *
  1507*                                                                *
  1508*   LOG = NO                                                     *
  1509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1510*                                                                *
  1511******************************************************************
  1512
  1513 01  BANK-CROSS-REFERENCE.
  1514     12  BK-RECORD-ID                PIC XX.
  1515         88  VALID-BK-ID             VALUE 'BK'.
  1516
  1517     12  BK-CONTROL-PRIMARY.
  1518         16  BK-COMPANY-CD           PIC X.
  1519         16  BK-CARRIER              PIC X.
  1520         16  BK-GROUPING             PIC X(6).
  1521         16  BK-BANK-NO              PIC X(10).
  1522
  1523     12  BK-MAINT-INFORMATION.
  1524         16  BK-LAST-MAINT-DT        PIC XX.
  1525         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1526         16  BK-LAST-MAINT-USER      PIC X(4).
  1527         16  FILLER                  PIC X(9).
  1528
  1529     12  FILLER                      PIC X(37).
  1530
  1531     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1532
  1533     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1534                            DEPENDING ON BK-BANK-POINTER-CNT.
  1535         16  BK-AM-ACCOUNT           PIC X(10).
  1536         16  BK-AM-EXP-DT            PIC XX.
  1537         16  BK-AM-EFF-DT            PIC XX.
  1538         16  BK-AM-STATE             PIC XX.
  1539         16  FILLER                  PIC X(20).
  1540
  1541******************************************************************
  1542
  1543*    COPY ERCCOMP.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCCOMP                             *
  1548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1549*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  29
* EL050.cbl
  1550*                                                                *
  1551*   ONLINE CREDIT SYSTEM                                         *
  1552*                                                                *
  1553*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1557*                                                                *
  1558*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1559*       ALTERNATE PATH = NONE                                    *
  1560*                                                                *
  1561*   LOG = NO                                                     *
  1562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1563*                                                                *
  1564******************************************************************
  1565*                   C H A N G E   L O G
  1566*
  1567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1568*-----------------------------------------------------------------
  1569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1570* EFFECTIVE    NUMBER
  1571*-----------------------------------------------------------------
  1572* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1573* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1574* 092205    2005050300006  PEMA  ADD LEASE FEE
  1575* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1576* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1577* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1578* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1579* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1580* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1581******************************************************************
  1582
  1583 01  COMPENSATION-MASTER.
  1584     12  CO-RECORD-ID                          PIC XX.
  1585         88  VALID-CO-ID                          VALUE 'CO'.
  1586
  1587     12  CO-CONTROL-PRIMARY.
  1588         16  CO-COMPANY-CD                     PIC X.
  1589         16  CO-CONTROL.
  1590             20  CO-CTL-1.
  1591                 24  CO-CARR-GROUP.
  1592                     28  CO-CARRIER            PIC X.
  1593                     28  CO-GROUPING.
  1594                         32  CO-GROUP-PREFIX   PIC XXX.
  1595                         32  CO-GROUP-PRIME    PIC XXX.
  1596                 24  CO-RESP-NO.
  1597                     28  CO-RESP-PREFIX        PIC X(4).
  1598                     28  CO-RESP-PRIME         PIC X(6).
  1599             20  CO-CTL-2.
  1600                 24  CO-ACCOUNT.
  1601                     28  CO-ACCT-PREFIX        PIC X(4).
  1602                     28  CO-ACCT-PRIME         PIC X(6).
  1603         16  CO-TYPE                           PIC X.
  1604             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1605             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1606             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1607
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  30
* EL050.cbl
  1608     12  CO-MAINT-INFORMATION.
  1609         16  CO-LAST-MAINT-DT                  PIC XX.
  1610         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1611         16  CO-LAST-MAINT-USER                PIC X(4).
  1612     12  FILLER                                PIC XX.
  1613     12  CO-STMT-TYPE                          PIC XXX.
  1614     12  CO-COMP-TYPE                          PIC X.
  1615         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1616     12  CO-STMT-OWNER                         PIC X(4).
  1617     12  CO-BALANCE-CONTROL                    PIC X.
  1618         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1619         88  CO-NO-BALANCE                        VALUE 'N'.
  1620
  1621     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1622         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1623         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1624         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1625
  1626     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1627         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1628         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1629
  1630     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1631     12  CO-GA-DIRECT-DEP                      PIC X.
  1632     12  CO-FUTURE-SPACE                       PIC X.
  1633         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1634
  1635     12  CO-ACCT-NAME                          PIC X(30).
  1636     12  CO-MAIL-NAME                          PIC X(30).
  1637     12  CO-ADDR-1                             PIC X(30).
  1638     12  CO-ADDR-2                             PIC X(30).
  1639     12  CO-ADDR-3.
  1640         16  CO-ADDR-CITY                      PIC X(27).
  1641         16  CO-ADDR-STATE                     PIC XX.
  1642     12  CO-CSO-1099                           PIC X.
  1643     12  CO-ZIP.
  1644         16  CO-ZIP-PRIME.
  1645             20  CO-ZIP-PRI-1ST                PIC X.
  1646                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1647             20  FILLER                        PIC X(4).
  1648         16  CO-ZIP-PLUS4                      PIC X(4).
  1649     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1650         16  CO-CAN-POSTAL-1                   PIC XXX.
  1651         16  CO-CAN-POSTAL-2                   PIC XXX.
  1652         16  FILLER                            PIC XXX.
  1653     12  CO-SOC-SEC                            PIC X(13).
  1654     12  CO-TELEPHONE.
  1655         16  CO-AREA-CODE                      PIC XXX.
  1656         16  CO-PREFIX                         PIC XXX.
  1657         16  CO-PHONE                          PIC X(4).
  1658
  1659     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1660
  1661     12  CO-AR-BAL-LEVEL                       PIC X.
  1662         88  CO-AR-REF-LVL                        VALUE '1'.
  1663         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1664         88  CO-AR-BILL-LVL                       VALUE '2'.
  1665         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  31
* EL050.cbl
  1666         88  CO-AR-FR-LVL                         VALUE '4'.
  1667
  1668     12  CO-AR-NORMAL-PRINT                    PIC X.
  1669         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1670         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1671
  1672     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1673
  1674     12  CO-AR-REPORTING                       PIC X.
  1675         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1676         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1677
  1678     12  CO-AR-PULL-CHECK                      PIC X.
  1679         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1680         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1681
  1682     12  CO-AR-BALANCE-PRINT                   PIC X.
  1683         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1684
  1685     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1686         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1687         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1688         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1689
  1690     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1691
  1692     12  CO-USER-CODE                          PIC X.
  1693     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1694
  1695******************************************************************
  1696*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1697*    THE LAST MONTH END RUN.
  1698******************************************************************
  1699
  1700     12  CO-LAST-ACTIVITY-DATE.
  1701         16  CO-ACT-YEAR                       PIC 99.
  1702         16  CO-ACT-MONTH                      PIC 99.
  1703         16  CO-ACT-DAY                        PIC 99.
  1704
  1705     12  CO-LAST-STMT-DT.
  1706         16  CO-LAST-STMT-YEAR                 PIC 99.
  1707         16  CO-LAST-STMT-MONTH                PIC 99.
  1708         16  CO-LAST-STMT-DAY                  PIC 99.
  1709
  1710     12  CO-MO-END-TOTALS.
  1711         16  CO-MONTHLY-TOTALS.
  1712             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1713             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1714             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1715             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1716             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-AGING-TOTALS.
  1719             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1720             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1721             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1722             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1723
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  32
* EL050.cbl
  1724         16  CO-YTD-TOTALS.
  1725             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1726             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1727
  1728         16  CO-OVER-UNDER-TOTALS.
  1729             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1730             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1731
  1732     12  CO-MISCELLANEOUS-TOTALS.
  1733         16  CO-FICA-TOTALS.
  1734             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1735             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1736
  1737         16  CO-CLAIM-TOTALS.
  1738             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1739             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1740
  1741******************************************************************
  1742*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1743*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1744******************************************************************
  1745
  1746     12  CO-CURRENT-TOTALS.
  1747         16  CO-CURRENT-LAST-STMT-DT.
  1748             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1749             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1750             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1751
  1752         16  CO-CURRENT-MONTHLY-TOTALS.
  1753             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1755             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1756             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1757             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1758
  1759         16  CO-CURRENT-AGING-TOTALS.
  1760             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1761             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1762             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1763             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1764
  1765         16  CO-CURRENT-YTD-TOTALS.
  1766             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1767             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1768
  1769     12  CO-PAID-COMM-TOTALS.
  1770         16  CO-YTD-PAID-COMMS.
  1771             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1772             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1775         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1776         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1777
  1778     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1779         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1780         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1781         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  33
* EL050.cbl
  1782         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1783         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1784         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1785         88  CO-FINAL-LETTER                  VALUE 'F'.
  1786         88  CO-RECONCILING                   VALUE 'R'.
  1787         88  CO-PHONE-CALL                    VALUE 'P'.
  1788         88  CO-LEGAL                         VALUE 'L'.
  1789         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1790         88  CO-WRITE-OFF                     VALUE 'W'.
  1791         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1792
  1793     12  CO-CSR-CODE                       PIC X(4).
  1794
  1795     12  CO-GA-STATUS-INFO.
  1796         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1797         16  CO-GA-TERMINATION-DT          PIC XX.
  1798         16  CO-GA-STATUS-CODE             PIC X.
  1799             88  CO-GA-ACTIVE                 VALUE 'A'.
  1800             88  CO-GA-INACTIVE               VALUE 'I'.
  1801             88  CO-GA-PENDING                VALUE 'P'.
  1802         16  CO-GA-COMMENTS.
  1803             20  CO-GA-COMMENT-1           PIC X(40).
  1804             20  CO-GA-COMMENT-2           PIC X(40).
  1805             20  CO-GA-COMMENT-3           PIC X(40).
  1806             20  CO-GA-COMMENT-4           PIC X(40).
  1807
  1808     12  CO-RPTCD2                         PIC X(10).
  1809     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1810         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1811         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1812
  1813     12  CO-TYPE-AGENT                     PIC X(01).
  1814         88  CO-CORPORATION                   VALUE 'C'.
  1815         88  CO-PARTNERSHIP                   VALUE 'P'.
  1816         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1817         88  CO-TRUST                         VALUE 'T'.
  1818         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1819
  1820     12  CO-FAXNO.
  1821         16  CO-FAX-AREA-CODE                  PIC XXX.
  1822         16  CO-FAX-PREFIX                     PIC XXX.
  1823         16  CO-FAX-PHONE                      PIC X(4).
  1824
  1825     12  CO-BANK-INFORMATION.
  1826         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1827         16  CO-BANK-TRANSIT-NON REDEFINES
  1828             CO-BANK-TRANSIT-NO                PIC 9(8).
  1829
  1830         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1831     12  CO-MISC-DEDUCT-INFO REDEFINES
  1832                  CO-BANK-INFORMATION.
  1833         16  CO-MD-GL-ACCT                     PIC X(10).
  1834         16  CO-MD-DIV                         PIC XX.
  1835         16  CO-MD-CENTER                      PIC X(4).
  1836         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1837         16  CO-CREATE-AP-CHECK                PIC X.
  1838         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1839         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  34
* EL050.cbl
  1840     12  CO-ACH-STATUS                         PIC X.
  1841         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1842         88  CO-ACH-PENDING                        VALUE 'P'.
  1843
  1844     12  CO-BILL-SW                            PIC X.
  1845     12  CO-CONTROL-NAME                       PIC X(30).
  1846     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1847     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1848     12  CO-CLP-STATE                          PIC XX.
  1849     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1850     12  CO-SPP-REFUND-EDIT                    PIC X.
  1851
  1852******************************************************************
  1853
  1854*    COPY ERCAGTC.
  1855******************************************************************
  1856*                                                                *
  1857*                                                                *
  1858*                            ERCAGTC                             *
  1859*                            VMOD=2.001                          *
  1860*                                                                *
  1861*   ONLINE CREDIT SYSTEM                                         *
  1862*                                                                *
  1863*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1864*                                                                *
  1865*   FILE TYPE = VSAM,KSDS                                        *
  1866*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1867*                                                                *
  1868*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1869*       ALTERNATE PATH = NONE                                    *
  1870*                                                                *
  1871*   LOG = NO                                                     *
  1872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1873*                                                                *
  1874******************************************************************
  1875*                   C H A N G E   L O G
  1876*
  1877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1878*-----------------------------------------------------------------
  1879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1880* EFFECTIVE    NUMBER
  1881*-----------------------------------------------------------------
  1882* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1883* 111004                         NEW FILE AND COPYBOOK
  1884* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1885******************************************************************
  1886 01  AGENT-COMMISSIONS.
  1887     12  AG-RECORD-ID                          PIC XX.
  1888         88  VALID-CO-ID                          VALUE 'AG'.
  1889     12  AG-CONTROL-PRIMARY.
  1890         16  AG-COMPANY-CD                     PIC X.
  1891         16  AG-CONTROL.
  1892             20  AG-CTL-1.
  1893                 24  AG-CARR-GROUP.
  1894                     28  AG-CARRIER            PIC X.
  1895                     28  AG-GROUPING           PIC X(6).
  1896                 24  AG-BANK                   PIC X(10).
  1897             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  35
* EL050.cbl
  1898                 24  AG-EXP-DT                 PIC XX.
  1899         16  AG-TYPE                           PIC X.
  1900             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1901             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1902     12  AG-MAINT-INFORMATION.
  1903         16  AG-LAST-MAINT-DT                  PIC XX.
  1904         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1905         16  AG-LAST-MAINT-USER                PIC X(4).
  1906         16  FILLER                            PIC X(10).
  1907     12  AG-EFF-DT                             PIC XX.
  1908     12  AG-COMM-STRUCTURE.
  1909         16  AG-AGT-COMMS OCCURS 10.
  1910             20  AG-AGT                PIC X(10).
  1911             20  AG-COM-TYP            PIC X.
  1912             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1913             20  AG-RECALC-LV-INDIC    PIC X.
  1914             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1915             20  AG-LRCALC-LV-INDIC    PIC X.
  1916             20  FILLER                PIC X(05).
  1917     12  FILLER                  PIC X(145).
  1918******************************************************************
  1919*    COPY ERCRESS.
  1920******************************************************************
  1921*                                                                *
  1922*                            ERCRESS                             *
  1923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1924*                            VMOD=2.002                          *
  1925*                                                                *
  1926*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1927*                                                                *
  1928*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1929*   VSAM RESIDENT STATE TAX MASTER                              *
  1930*                                                                *
  1931*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1932*                                                                *
  1933*   FILE TYPE = VSAM,KSDS                                        *
  1934*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1935*                                                                *
  1936*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1937*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1938*                                                                *
  1939*   LOG = NO                                                     *
  1940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1941*                                                                *
  1942*                                                                *
  1943******************************************************************
  1944
  1945 01  RESIDENT-STATE-TAX-MASTER.
  1946
  1947     10  ERRESS-PRIMARY-KEY.
  1948         15  RES-COMPANY-CD        PIC X.
  1949         15  RES-RESIDENT-STATE    PIC XX.
  1950         15  RES-COVERAGE-CATEGORY PIC X.
  1951         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1952*                                      YYYYMMDD
  1953*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1954
  1955     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  36
* EL050.cbl
  1956
  1957         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1958         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1959         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1960         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1961
  1962     10 RES-RECALC-SW              PIC   X.
  1963         88 RECALC                VALUE 'Y'.
  1964         88 NO-RECALC             VALUE 'N'.
  1965     10  RES-MAINT-BY              PIC X(4).
  1966     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1967     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1968*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  37
* EL050.cbl
  1970*    COPY ERCRESC.
  1971******************************************************************
  1972*                                                                *
  1973*                            ERCRESC                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1978*                                                                *
  1979*   FILE TYPE = VSAM,KSDS                                        *
  1980*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1981*                                                                *
  1982*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1983*       ALTERNATE PATH1 = NONE                                   *
  1984*                                                                *
  1985*   LOG = NO                                                     *
  1986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1987*                                                                *
  1988******************************************************************
  1989
  1990 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1991
  1992     10  ERRESC-RECORD-KEY.
  1993         15  RESC-COMPANY-CD           PIC   X.
  1994         15  RESC-CARRIER              PIC   X.
  1995         15  RESC-GROUP                PIC   X(6).
  1996         15  RESC-STATE                PIC   XX.
  1997         15  RESC-ACCOUNT              PIC   X(10).
  1998         15  RESC-AGENT                PIC   X(10).
  1999         15  RESC-RESIDENT-STATE       PIC   XX.
  2000         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2001*                                           YYYYMMDD
  2002     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2003
  2004     10  RESC-COMM-RECORD-DATA.
  2005         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2006             20 RESC-COVERAGE-CAT      PIC    X.
  2007             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2008             20 RESC-COMMISSION-TAB REDEFINES
  2009                RESC-COMMISSION-PER    PIC  XXX.
  2010
  2011     10  RESC-MAINT-BY                 PIC X(4).
  2012     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2013     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2014*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  38
* EL050.cbl
  2016*    COPY ERCPLAN.
  2017******************************************************************
  2018*                                                                *
  2019*                                                                *
  2020*                            ERCPLAN                             *
  2021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2022*                            VMOD=2.003                          *
  2023*                                                                *
  2024*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2025*                                                                *
  2026*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2027*   PLAN MASTER                                                  *
  2028*                                                                *
  2029*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2030*                                                                *
  2031*   FILE TYPE = VSAM,KSDS                                        *
  2032*   RECORD SIZE = 420   RECFORM = FIX                            *
  2033*                                                                *
  2034*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2035*       ALTERNATE PATH1 = N/A                                    *
  2036*                                                                *
  2037*   LOG = NO                                                     *
  2038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2039*                                                                *
  2040*                                                                *
  2041******************************************************************
  2042
  2043 01  PLAN-MASTER.
  2044     12  PL-RECORD-ID                      PIC XX.
  2045         88  VALID-PL-ID                      VALUE 'PL'.
  2046
  2047     12  PL-CONTROL-PRIMARY.
  2048         16  PL-COMPANY-CD                 PIC X.
  2049         16  PL-MSTR-CNTRL.
  2050             20  PL-CONTROL-A.
  2051                 24  PL-CARRIER            PIC X.
  2052                 24  PL-GROUPING           PIC X(6).
  2053                 24  PL-STATE              PIC XX.
  2054                 24  PL-ACCOUNT            PIC X(10).
  2055             20  PL-BENEFIT-TYPE           PIC X.
  2056             20  PL-BENEFIT-CODE           PIC XX.
  2057             20  PL-REVISION-NO            PIC X(3).
  2058
  2059     12  PL-CONTROL-BY-VAR-GRP.
  2060         16  PL-COMPANY-CD-A1              PIC X.
  2061         16  PL-VG-CARRIER                 PIC X.
  2062         16  PL-VG-GROUPING                PIC X(6).
  2063         16  PL-VG-STATE                   PIC XX.
  2064         16  PL-VG-ACCOUNT                 PIC X(10).
  2065         16  PL-BENEFIT-TYPE-A1            PIC X.
  2066         16  PL-BENEFIT-CODE-A1            PIC XX.
  2067         16  PL-REVISION-NO-A1             PIC 999.
  2068
  2069     12  PL-MAINT-INFORMATION.
  2070         16  PL-LAST-MAINT-DT              PIC XX.
  2071         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2072         16  PL-LAST-MAINT-USER            PIC X(4).
  2073         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  39
* EL050.cbl
  2074
  2075     12  PL-LIABILITY-LIMITS.
  2076         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2077         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2078             20  PL-LM-AGE                 PIC S99        COMP-3.
  2079             20  PL-LM-DUR                 PIC S999       COMP-3.
  2080             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2081             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2082
  2083     12  FILLER                            PIC X(30).
  2084
  2085     12  PL-GL-ACCOUNT-NOS.
  2086         16  PL-PREMIUM-GL                 PIC X(8).
  2087         16  PL-COMM-GL                    PIC X(8).
  2088         16  PL-CLAIM-GL                   PIC X(8).
  2089     12  FILLER                            PIC X(24).
  2090     12  PL-TOLERANCES.
  2091         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2092         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2093         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2094         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2095         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2096         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2097     12  PL-OVER-SHORT.
  2098         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2099         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2100     12  FILLER                            PIC X(24).
  2101     12  PLAN-MISC.
  2102         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2103         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2104         16  PL-IG                         PIC X.
  2105         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2106         16  PL-POLICY-FORM                PIC X(12).
  2107         16  PL-EDIT-FOR-FORM              PIC X(01).
  2108         16  PL-DEV-CODE                   PIC XXX.
  2109         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2110         16  PL-CALC-METHOD                PIC X.
  2111         16  PL-BENEFIT-GROUP              PIC X(05).
  2112         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2113
  2114         16  FILLER                        PIC X(99).
  2115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  40
* EL050.cbl
  2117*    COPY ELCCERT.
  2118******************************************************************
  2119*                                                                *
  2120*                            ELCCERT.                            *
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2122*                            VMOD=2.013                          *
  2123*                                                                *
  2124*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2125*                                                                *
  2126*   FILE TYPE = VSAM,KSDS                                        *
  2127*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2128*                                                                *
  2129*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2130*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2131*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2132*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2133*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2134*                                                                *
  2135*   LOG = YES                                                    *
  2136*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2137******************************************************************
  2138*                   C H A N G E   L O G
  2139*
  2140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2141*-----------------------------------------------------------------
  2142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2143* EFFECTIVE    NUMBER
  2144*-----------------------------------------------------------------
  2145* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2146* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2147* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2148* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2149* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2150* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2151* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2152* 032612  CR2011110200001  PEMA  AHL CHANGES
  2153* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2154* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2155******************************************************************
  2156
  2157 01  CERTIFICATE-MASTER.
  2158     12  CM-RECORD-ID                      PIC XX.
  2159         88  VALID-CM-ID                      VALUE 'CM'.
  2160
  2161     12  CM-CONTROL-PRIMARY.
  2162         16  CM-COMPANY-CD                 PIC X.
  2163         16  CM-CARRIER                    PIC X.
  2164         16  CM-GROUPING.
  2165             20  CM-GROUPING-PREFIX        PIC X(3).
  2166             20  CM-GROUPING-PRIME         PIC X(3).
  2167         16  CM-STATE                      PIC XX.
  2168         16  CM-ACCOUNT.
  2169             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2170             20  CM-ACCOUNT-PRIME          PIC X(6).
  2171         16  CM-CERT-EFF-DT                PIC XX.
  2172         16  CM-CERT-NO.
  2173             20  CM-CERT-PRIME             PIC X(10).
  2174             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  41
* EL050.cbl
  2175
  2176     12  CM-CONTROL-BY-NAME.
  2177         16  CM-COMPANY-CD-A1              PIC X.
  2178         16  CM-INSURED-LAST-NAME          PIC X(15).
  2179         16  CM-INSURED-INITIALS.
  2180             20  CM-INSURED-INITIAL1       PIC X.
  2181             20  CM-INSURED-INITIAL2       PIC X.
  2182
  2183     12  CM-CONTROL-BY-SSN.
  2184         16  CM-COMPANY-CD-A2              PIC X.
  2185         16  CM-SOC-SEC-NO.
  2186             20  CM-SSN-STATE              PIC XX.
  2187             20  CM-SSN-ACCOUNT            PIC X(6).
  2188             20  CM-SSN-LN3.
  2189                 25  CM-INSURED-INITIALS-A2.
  2190                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2191                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2192                 25 CM-PART-LAST-NAME-A2         PIC X.
  2193
  2194     12  CM-CONTROL-BY-CERT-NO.
  2195         16  CM-COMPANY-CD-A4              PIC X.
  2196         16  CM-CERT-NO-A4                 PIC X(11).
  2197
  2198     12  CM-CONTROL-BY-MEMB.
  2199         16  CM-COMPANY-CD-A5              PIC X.
  2200         16  CM-MEMBER-NO.
  2201             20  CM-MEMB-STATE             PIC XX.
  2202             20  CM-MEMB-ACCOUNT           PIC X(6).
  2203             20  CM-MEMB-LN4.
  2204                 25  CM-INSURED-INITIALS-A5.
  2205                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2206                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2207                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2208
  2209     12  CM-INSURED-PROFILE-DATA.
  2210         16  CM-INSURED-FIRST-NAME.
  2211             20  CM-INSURED-1ST-INIT       PIC X.
  2212             20  FILLER                    PIC X(9).
  2213         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2214         16  CM-INSURED-SEX                PIC X.
  2215             88  CM-SEX-MALE                  VALUE 'M'.
  2216             88  CM-SEX-FEMAL                 VALUE 'F'.
  2217         16  CM-INSURED-JOINT-AGE          PIC 99.
  2218         16  CM-JOINT-INSURED-NAME.
  2219             20  CM-JT-LAST-NAME           PIC X(15).
  2220             20  CM-JT-FIRST-NAME.
  2221                 24  CM-JT-1ST-INIT        PIC X.
  2222                 24  FILLER                PIC X(9).
  2223             20  CM-JT-INITIAL             PIC X.
  2224
  2225     12  CM-LIFE-DATA.
  2226         16  CM-LF-BENEFIT-CD              PIC XX.
  2227         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2228         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2229         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2230         16  CM-LF-DEV-CODE                PIC XXX.
  2231         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2232         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  42
* EL050.cbl
  2233         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2234         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2235         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2236         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2237         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2238         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2240         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2241         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2242         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2243         16  cm-temp-epiq                  pic xx.
  2244             88  EPIQ-CLASS                  value 'EQ'.
  2245*        16  FILLER                        PIC XX.
  2246
  2247     12  CM-AH-DATA.
  2248         16  CM-AH-BENEFIT-CD              PIC XX.
  2249         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2250         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2251         16  CM-AH-DEV-CODE                PIC XXX.
  2252         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2253         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2254         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2255         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2256         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2257         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2258         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2259         16  CM-AH-PAID-THRU-DT            PIC XX.
  2260             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2261         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2262         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2263         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2264         16  FILLER                        PIC X.
  2265
  2266     12  CM-LOAN-INFORMATION.
  2267         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2268         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2269                                           PIC S9(5)V99  COMP-3.
  2270         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2271         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2272         16  CM-PAY-FREQUENCY              PIC S99.
  2273         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2274         16  CM-RATE-CLASS                 PIC XX.
  2275         16  CM-BENEFICIARY                PIC X(25).
  2276         16  CM-POLICY-FORM-NO             PIC X(12).
  2277         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2278         16  CM-LAST-ADD-ON-DT             PIC XX.
  2279         16  CM-DEDUCTIBLE-AMOUNTS.
  2280             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2281             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2282         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2283             20  CM-RESIDENT-STATE         PIC XX.
  2284             20  CM-RATE-CODE              PIC X(4).
  2285             20  FILLER                    PIC XX.
  2286         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2287             20  CM-LOAN-OFFICER           PIC X(5).
  2288             20  FILLER                    PIC XXX.
  2289         16  CM-CSR-CODE                   PIC XXX.
  2290         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  43
* EL050.cbl
  2291             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2292         16  CM-POST-CARD-IND              PIC X.
  2293         16  CM-NH-INTERFACE-SW            PIC X.
  2294         16  CM-PREMIUM-TYPE               PIC X.
  2295             88  CM-SING-PRM                  VALUE '1'.
  2296             88  CM-O-B-COVERAGE              VALUE '2'.
  2297             88  CM-OPEN-END                  VALUE '3'.
  2298         16  CM-IND-GRP-TYPE               PIC X.
  2299             88  CM-INDIVIDUAL                VALUE 'I'.
  2300             88  CM-GROUP                     VALUE 'G'.
  2301         16  CM-SKIP-CODE                  PIC X.
  2302             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2303             88  SKIP-JULY                    VALUE '1'.
  2304             88  SKIP-AUGUST                  VALUE '2'.
  2305             88  SKIP-SEPTEMBER               VALUE '3'.
  2306             88  SKIP-JULY-AUG                VALUE '4'.
  2307             88  SKIP-AUG-SEPT                VALUE '5'.
  2308             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2309             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2310             88  SKIP-JUNE                    VALUE '8'.
  2311             88  SKIP-JUNE-JULY               VALUE '9'.
  2312             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2313             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2314         16  CM-PAYMENT-MODE               PIC X.
  2315             88  PAY-MONTHLY                  VALUE SPACE.
  2316             88  PAY-WEEKLY                   VALUE '1'.
  2317             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2318             88  PAY-BI-WEEKLY                VALUE '3'.
  2319             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2320         16  CM-LOAN-NUMBER                PIC X(8).
  2321         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2322         16  CM-OLD-LOF                    PIC XXX.
  2323*        16  CM-LOAN-OFFICER               PIC XXX.
  2324         16  CM-REIN-TABLE                 PIC XXX.
  2325         16  CM-SPECIAL-REIN-CODE          PIC X.
  2326         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2327         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2328         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2329
  2330     12  CM-STATUS-DATA.
  2331         16  CM-ENTRY-STATUS               PIC X.
  2332         16  CM-ENTRY-DT                   PIC XX.
  2333
  2334         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2335         16  CM-LF-CANCEL-DT               PIC XX.
  2336         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2337
  2338         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2339         16  CM-LF-DEATH-DT                PIC XX.
  2340         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2341
  2342         16  CM-LF-CURRENT-STATUS          PIC X.
  2343             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2344                                                'M' '4' '5' '9'.
  2345             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2346             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2347             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2348             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  44
* EL050.cbl
  2349             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2350             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2351             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2352             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2353             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2354             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2355             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2356             88  CM-LF-DECLINED               VALUE 'D'.
  2357             88  CM-LF-VOIDED                 VALUE 'V'.
  2358
  2359         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2360         16  CM-AH-CANCEL-DT               PIC XX.
  2361         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2362
  2363         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2364         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2365         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2366
  2367         16  CM-AH-CURRENT-STATUS          PIC X.
  2368             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2369                                                'M' '4' '5' '9'.
  2370             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2371             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2372             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2373             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2374             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2375             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2376             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2377             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2378             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2379             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2380             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2381             88  CM-AH-DECLINED               VALUE 'D'.
  2382             88  CM-AH-VOIDED                 VALUE 'V'.
  2383
  2384         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2385             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2386             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2387             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2388         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2389
  2390         16  CM-ENTRY-BATCH                PIC X(6).
  2391         16  CM-LF-EXIT-BATCH              PIC X(6).
  2392         16  CM-AH-EXIT-BATCH              PIC X(6).
  2393         16  CM-LAST-MONTH-END             PIC XX.
  2394
  2395     12  CM-NOTE-SW                        PIC X.
  2396         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2397         88  CERT-NOTES-PRESENT               VALUE '1'.
  2398         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2399         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2400         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2401         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2402         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2403         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2404     12  CM-COMP-EXCP-SW                   PIC X.
  2405         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2406         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  45
* EL050.cbl
  2407     12  CM-INSURED-ADDRESS-SW             PIC X.
  2408         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2409         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2410
  2411*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2412     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2413     12  FILLER                            PIC X.
  2414
  2415*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2416     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2417     12  FILLER                            PIC X.
  2418*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2419     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2420
  2421     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2422         88  CERT-ADDED-BATCH                 VALUE ' '.
  2423         88  CERT-ADDED-ONLINE                VALUE '1'.
  2424         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2425         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2426         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2427     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2428         88  CERT-AS-LOADED                   VALUE ' '.
  2429         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2430         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2431         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2432         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2433         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2434         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2435         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2436
  2437     12  CM-ACCOUNT-COMM-PCTS.
  2438         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2439         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2440
  2441     12  CM-USER-FIELD                     PIC X.
  2442     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2443     12  CM-CLP-STATE                      PIC XX.
  2444     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2445     12  CM-USER-RESERVED                  PIC XXX.
  2446     12  FILLER REDEFINES CM-USER-RESERVED.
  2447         16  CM-AH-CLASS-CD                PIC XX.
  2448         16  F                             PIC X.
  2449******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  46
* EL050.cbl
  2451*    COPY ERCMAIL.
  2452******************************************************************
  2453*                                                                *
  2454*                                                                *
  2455*                            ERCMAIL                             *
  2456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2457*                            VMOD=2.003                          *
  2458*                                                                *
  2459*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2460*                                                                *
  2461*   FILE TYPE = VSAM,KSDS                                        *
  2462*   RECORD SIZE = 374   RECFORM = FIX                            *
  2463*                                                                *
  2464*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2465*   ALTERNATE PATH    = NOT USED                                 *
  2466*                                                                *
  2467*   LOG = YES                                                    *
  2468*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2469******************************************************************
  2470*                   C H A N G E   L O G
  2471*
  2472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2473*-----------------------------------------------------------------
  2474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2475* EFFECTIVE    NUMBER
  2476*-----------------------------------------------------------------
  2477* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2478* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2479* 111108                   PEMA  ADD CRED BENE ADDR2
  2480******************************************************************
  2481
  2482 01  MAILING-DATA.
  2483     12  MA-RECORD-ID                      PIC XX.
  2484         88  VALID-MA-ID                       VALUE 'MA'.
  2485
  2486     12  MA-CONTROL-PRIMARY.
  2487         16  MA-COMPANY-CD                 PIC X.
  2488         16  MA-CARRIER                    PIC X.
  2489         16  MA-GROUPING.
  2490             20  MA-GROUPING-PREFIX        PIC XXX.
  2491             20  MA-GROUPING-PRIME         PIC XXX.
  2492         16  MA-STATE                      PIC XX.
  2493         16  MA-ACCOUNT.
  2494             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2495             20  MA-ACCOUNT-PRIME          PIC X(6).
  2496         16  MA-CERT-EFF-DT                PIC XX.
  2497         16  MA-CERT-NO.
  2498             20  MA-CERT-PRIME             PIC X(10).
  2499             20  MA-CERT-SFX               PIC X.
  2500
  2501     12  FILLER                            PIC XX.
  2502
  2503     12  MA-ACCESS-CONTROL.
  2504         16  MA-SOURCE-SYSTEM              PIC XX.
  2505             88  MA-FROM-CREDIT                VALUE 'CR'.
  2506             88  MA-FROM-VSI                   VALUE 'VS'.
  2507             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2508             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  47
* EL050.cbl
  2509         16  MA-RECORD-ADD-DT              PIC XX.
  2510         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2511         16  MA-LAST-MAINT-DT              PIC XX.
  2512         16  MA-LAST-MAINT-BY              PIC XXXX.
  2513         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2514
  2515     12  MA-PROFILE-INFO.
  2516         16  MA-QUALIFY-CODE-1             PIC XX.
  2517         16  MA-QUALIFY-CODE-2             PIC XX.
  2518         16  MA-QUALIFY-CODE-3             PIC XX.
  2519         16  MA-QUALIFY-CODE-4             PIC XX.
  2520         16  MA-QUALIFY-CODE-5             PIC XX.
  2521
  2522         16  MA-INSURED-LAST-NAME          PIC X(15).
  2523         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2524         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2525         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2526         16  MA-INSURED-BIRTH-DT           PIC XX.
  2527         16  MA-INSURED-SEX                PIC X.
  2528             88  MA-SEX-MALE                   VALUE 'M'.
  2529             88  MA-SEX-FEMALE                 VALUE 'F'.
  2530         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2531
  2532         16  MA-ADDRESS-CORRECTED          PIC X.
  2533         16  MA-JOINT-BIRTH-DT             PIC XX.
  2534*        16  FILLER                        PIC X(12).
  2535
  2536         16  MA-ADDRESS-LINE-1             PIC X(30).
  2537         16  MA-ADDRESS-LINE-2             PIC X(30).
  2538         16  MA-CITY-STATE.
  2539             20  MA-CITY                   PIC X(28).
  2540             20  MA-ADDR-STATE             PIC XX.
  2541         16  MA-ZIP.
  2542             20  MA-ZIP-CODE.
  2543                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2544                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2545                 24  FILLER                PIC X(4).
  2546             20  MA-ZIP-PLUS4              PIC X(4).
  2547         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2548             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2549             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2550             20  FILLER                    PIC X(3).
  2551
  2552         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2553
  2554         16  FILLER                        PIC XXX.
  2555*        16  FILLER                        PIC X(10).
  2556
  2557     12  MA-CRED-BENE-INFO.
  2558         16  MA-CRED-BENE-NAME                 PIC X(25).
  2559         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2560         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2561         16  MA-CRED-BENE-CTYST.
  2562             20  MA-CRED-BENE-CITY             PIC X(28).
  2563             20  MA-CRED-BENE-STATE            PIC XX.
  2564         16  MA-CRED-BENE-ZIP.
  2565             20  MA-CB-ZIP-CODE.
  2566                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  48
* EL050.cbl
  2567                     88  MA-CB-CANADIAN-POST-CODE
  2568                                           VALUE 'A' THRU 'Z'.
  2569                 24  FILLER                    PIC X(4).
  2570             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2571         16  MA-CB-CANADIAN-POSTAL-CODE
  2572                            REDEFINES MA-CRED-BENE-ZIP.
  2573             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2574             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2575             20  FILLER                        PIC X(3).
  2576     12  MA-POST-CARD-MAIL-DATA.
  2577         16  MA-MAIL-DATA OCCURS 7.
  2578             20  MA-MAIL-TYPE              PIC X.
  2579                 88  MA-12MO-MAILING           VALUE '1'.
  2580                 88  MA-EXP-MAILING            VALUE '2'.
  2581             20  MA-MAIL-STATUS            PIC X.
  2582                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2583                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2584                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2585             20  MA-MAIL-DATE              PIC XX.
  2586     12  FILLER                            PIC XX.
  2587     12  FILLER                            PIC XX.
  2588*    12  FILLER                            PIC X(30).
  2589******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  49
* EL050.cbl
  2591*    COPY ERCPNDM.
  2592******************************************************************
  2593*                                                                *
  2594*                                                                *
  2595*                            ERCPNDM                             *
  2596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2597*                            VMOD=2.003                          *
  2598*                                                                *
  2599*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2600*                                                                *
  2601*   FILE TYPE = VSAM,KSDS                                        *
  2602*   RECORD SIZE = 374   RECFORM = FIX                            *
  2603*                                                                *
  2604*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2605*   ALTERNATE PATH    = NOT USED                                 *
  2606*                                                                *
  2607*   LOG = YES                                                    *
  2608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2609******************************************************************
  2610*                   C H A N G E   L O G
  2611*
  2612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2613*-----------------------------------------------------------------
  2614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2615* EFFECTIVE    NUMBER
  2616*-----------------------------------------------------------------
  2617* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2618* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2619* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2620******************************************************************
  2621
  2622 01  PENDING-MAILING-DATA.
  2623     12  PM-RECORD-ID                      PIC XX.
  2624         88  VALID-MA-ID                       VALUE 'PM'.
  2625
  2626     12  PM-CONTROL-PRIMARY.
  2627         16  PM-COMPANY-CD                 PIC X.
  2628         16  PM-ENTRY-BATCH                PIC X(6).
  2629         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2630         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2631
  2632     12  FILLER                            PIC X(14).
  2633
  2634     12  PM-ACCESS-CONTROL.
  2635         16  PM-SOURCE-SYSTEM              PIC XX.
  2636             88  PM-FROM-CREDIT                VALUE 'CR'.
  2637             88  PM-FROM-VSI                   VALUE 'VS'.
  2638             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2639             88  PM-FROM-OTHER                 VALUE 'OT'.
  2640         16  PM-RECORD-ADD-DT              PIC XX.
  2641         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2642         16  PM-LAST-MAINT-DT              PIC XX.
  2643         16  PM-LAST-MAINT-BY              PIC XXXX.
  2644         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2645
  2646     12  PM-PROFILE-INFO.
  2647         16  PM-QUALIFY-CODE-1             PIC XX.
  2648         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  50
* EL050.cbl
  2649         16  PM-QUALIFY-CODE-3             PIC XX.
  2650         16  PM-QUALIFY-CODE-4             PIC XX.
  2651         16  PM-QUALIFY-CODE-5             PIC XX.
  2652
  2653         16  PM-INSURED-LAST-NAME          PIC X(15).
  2654         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2655         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2656         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2657         16  PM-INSURED-BIRTH-DT           PIC XX.
  2658         16  PM-INSURED-SEX                PIC X.
  2659             88  PM-SEX-MALE                   VALUE 'M'.
  2660             88  PM-SEX-FEMALE                 VALUE 'F'.
  2661         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2662
  2663         16  PM-ADDRESS-CORRECTED          PIC X.
  2664         16  PM-JOINT-BIRTH-DT             PIC XX.
  2665*        16  FILLER                        PIC X(12).
  2666
  2667         16  PM-ADDRESS-LINE-1             PIC X(30).
  2668         16  PM-ADDRESS-LINE-2             PIC X(30).
  2669         16  PM-CITY-STATE.
  2670             20  PM-CITY                   PIC X(28).
  2671             20  PM-STATE                  PIC XX.
  2672         16  PM-ZIP.
  2673             20  PM-ZIP-CODE.
  2674                 24  PM-ZIP-1              PIC X.
  2675                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2676                 24  FILLER                PIC X(4).
  2677             20  PM-ZIP-PLUS4              PIC X(4).
  2678         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2679             20  PM-CAN-POST1              PIC XXX.
  2680             20  PM-CAN-POST2              PIC XXX.
  2681             20  FILLER                    PIC XXX.
  2682
  2683         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2684
  2685         16  FILLER                        PIC X(03).
  2686
  2687     12  PM-CRED-BENE-INFO.
  2688         16  PM-CRED-BENE-NAME             PIC X(25).
  2689         16  PM-CRED-BENE-ADDR             PIC X(30).
  2690         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2691         16  PM-CRED-BENE-CTYST.
  2692             20  PM-CRED-BENE-CITY         PIC X(28).
  2693             20  PM-CRED-BENE-STATE        PIC XX.
  2694         16  PM-CRED-BENE-ZIP.
  2695             20  PM-CB-ZIP-CODE.
  2696                 24  PM-CB-ZIP-1           PIC X.
  2697                     88  PM-CB-CANADIAN-POST-CODE
  2698                                  VALUE 'A' THRU 'Z'.
  2699                 24  FILLER                PIC X(4).
  2700             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2701         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2702             20  PM-CB-CAN-POST1           PIC XXX.
  2703             20  PM-CB-CAN-POST2           PIC XXX.
  2704             20  FILLER                    PIC XXX.
  2705     12  PM-POST-CARD-MAIL-DATA.
  2706         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  51
* EL050.cbl
  2707             20  PM-MAIL-TYPE              PIC X.
  2708                 88  PM-12MO-MAILING           VALUE '1'.
  2709                 88  PM-EXP-MAILING            VALUE '2'.
  2710             20  PM-MAIL-STATUS            PIC X.
  2711                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2712                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2713                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2714             20  PM-MAIL-DATE              PIC XX.
  2715     12  FILLER                            PIC XX.
  2716     12  FILLER                            PIC X(12).
  2717*    12  FILLER                            PIC X(30).
  2718
  2719******************************************************************
  2720*                                COPY ERCLOFC.
  2721******************************************************************
  2722*                                                                *
  2723*                                                                *
  2724*                            ERCLOFC                             *
  2725*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2726*                            VMOD=2.003                          *
  2727*                                                                *
  2728*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2729*                                                                *
  2730*   FILE TYPE = VSAM,KSDS                                        *
  2731*   RECORD SIZE = 670   RECFORM = FIX                            *
  2732*                                                                *
  2733*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2734*                                                                *
  2735*   LOG = YES                                                    *
  2736*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2737*                                                                *
  2738******************************************************************
  2739
  2740 01  LOAN-OFFICER-MASTER.
  2741     12  LO-RECORD-ID                PIC XX.
  2742         88  VALID-LO-ID                VALUE 'LO'.
  2743
  2744     12  LO-CONTROL-PRIMARY.
  2745         16  LO-COMPANY-CD           PIC X.
  2746         16  LO-CARRIER              PIC X.
  2747         16  LO-GROUPING.
  2748             20  LO-GROUPING-PREFIX  PIC XXX.
  2749             20  LO-GROUPING-PRIME   PIC XXX.
  2750         16  LO-STATE                PIC XX.
  2751         16  LO-ACCOUNT.
  2752             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2753             20  LO-ACCOUNT-PRIME    PIC X(6).
  2754         16  LO-OFFICER-CODE         PIC X(5).
  2755
  2756     12  LO-OFFICER-NAME             PIC X(30).
  2757
  2758     12  LO-LAST-MAINT-DT            PIC XX.
  2759     12  LO-LAST-USER                PIC X(4).
  2760     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2761
  2762     12  LO-COMP-CONTROL             PIC X.
  2763             88  LO-SHOW-COMP           VALUE 'Y'.
  2764             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  52
* EL050.cbl
  2765     12  LO-DETAIL-CONTROL           PIC X.
  2766             88  LO-PRINT-DETAIL        VALUE 'D'.
  2767             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2768
  2769     12  LO-SV-CARRIER               PIC X.
  2770     12  LO-SV-GROUPING              PIC X(6).
  2771     12  LO-SV-STATE                 PIC XX.
  2772
  2773     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2774     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2775
  2776     12  LO-OFFICER-INFO.
  2777         16  FILLER OCCURS 12 TIMES.
  2778             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2779             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2780             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2781             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2782             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2783             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2784             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2785             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2786     12  FILLER                      PIC X(198).
  2787******************************************************************
  2788*                                COPY ERCPDEF.
  2789******************************************************************
  2790*                                                                *
  2791*                                                                *
  2792*                            ERCPDEF.                            *
  2793*                                                                *
  2794*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2795*                                                                *
  2796*    FILE TYPE = VSAM,KSDS                                       *
  2797*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2798*                                                                *
  2799*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2800*                                                                *
  2801*    LOG = YES                                                   *
  2802*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2803******************************************************************
  2804*                   C H A N G E   L O G
  2805*
  2806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2807*-----------------------------------------------------------------
  2808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2809* EFFECTIVE    NUMBER
  2810*-----------------------------------------------------------------
  2811* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2812* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2813* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2814******************************************************************
  2815 01  PRODUCT-MASTER.
  2816    12  PD-RECORD-ID                 PIC X(02).
  2817        88  VALID-PD-ID                  VALUE 'PD'.
  2818    12  PD-CONTROL-PRIMARY.
  2819        16  PD-COMPANY-CD            PIC X.
  2820        16  PD-STATE                 PIC XX.
  2821        16  PD-PRODUCT-CD            PIC XXX.
  2822        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  53
* EL050.cbl
  2823        16  PD-BEN-TYPE              PIC X.
  2824        16  PD-BEN-CODE              PIC XX.
  2825        16  PD-PROD-EXP-DT           PIC XX.
  2826    12  FILLER                       PIC X(50).
  2827    12  PD-PRODUCT-DATA OCCURS 8.
  2828        16  PD-PROD-CODE             PIC X.
  2829            88  PD-PROD-LIFE           VALUE 'L'.
  2830            88  PD-PROD-PROP           VALUE 'P'.
  2831            88  PD-PROD-AH             VALUE 'A'.
  2832            88  PD-PROD-IU             VALUE 'I'.
  2833            88  PD-PROD-GAP            VALUE 'G'.
  2834            88  PD-PROD-FAML           VALUE 'F'.
  2835        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2836        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2837        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2838        16  PD-MAX-TERM              PIC S999        COMP-3.
  2839        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2840        16  FILLER                   PIC X.
  2841        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2842        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2843        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2844        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2845        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2846        16  PD-REC-CRIT-PERIOD       PIC 99.
  2847        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2848            20  PD-RECURRING-YN      PIC X.
  2849            20  FILLER               PIC X.
  2850        16  PD-RTW-MOS               PIC 99.
  2851        16  PD-MAX-EXTENSION         PIC 99.
  2852        16  pd-ben-pct               pic sv999 comp-3.
  2853*       16  FILLER                   PIC XX.
  2854    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2855    12  PD-TERM-LIMITS OCCURS 15.
  2856        16  PD-LOW-TERM              PIC S999        COMP-3.
  2857        16  PD-HI-TERM               PIC S999        COMP-3.
  2858*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2859    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2860        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2861        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2862    12  PD-EARN-FACTORS.
  2863        16  FILLER OCCURS 15.
  2864            20  FILLER OCCURS 15.
  2865                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2866    12  PD-PRODUCT-DESC              PIC X(80).
  2867    12  PD-TRUNCATED                 PIC X.
  2868    12  FILLER                       PIC X(59).
  2869    12  PD-MAINT-INFORMATION.
  2870        16  PD-LAST-MAINT-DT         PIC X(02).
  2871        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2872        16  PD-LAST-MAINT-BY         PIC X(04).
  2873*                                COPY ELCSTATE.
  2874******************************************************************
  2875*                                                                *
  2876*                                                                *
  2877*                            ELCSTATE.                           *
  2878*                                                                *
  2879*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2880*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  54
* EL050.cbl
  2881*   FILE TYPE = VSAM,KSDS                                        *
  2882*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2883*                                                                *
  2884*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2885*       ALTERNATE INDEX = NONE                                   *
  2886*                                                                *
  2887*   LOG = YES                                                    *
  2888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2889******************************************************************
  2890*                   C H A N G E   L O G
  2891*
  2892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2893*-----------------------------------------------------------------
  2894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2895* EFFECTIVE    NUMBER
  2896*-----------------------------------------------------------------
  2897* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2898******************************************************************
  2899*
  2900 01  STATE-FILE.
  2901     12  SF-RECORD-ID                       PIC XX.
  2902         88  VALID-CF-ID                        VALUE 'SF'.
  2903     12  SF-CONTROL-PRIMARY.
  2904         16  SF-COMPANY-ID                  PIC XXX.
  2905         16  SF-CARRIER-CODE                PIC X.
  2906         16  SF-GROUPING                    PIC X(6).
  2907         16  SF-STATE-CODE                  PIC XX.
  2908         16  SF-EXPIRE-DATE                 PIC 9(8).
  2909****************************************************************
  2910*             STATE CONTROLS
  2911****************************************************************
  2912     12  SF-LAST-MAINT-DT                   PIC XX.
  2913     12  SF-LAST-MAINT-BY                   PIC X(4).
  2914     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2915     12  SF-STATE-RT-CONTROLS.
  2916         16  SF-ST-RT-CALC                  PIC X.
  2917     12  SF-ST-TAX-CONTROLS.
  2918         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2919         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2920         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2921     12  SF-ST-REFUND-OPTIONS.
  2922         16  SF-ST-RF-LR-CALC               PIC X.
  2923         16  SF-ST-RF-LL-CALC               PIC X.
  2924         16  SF-ST-RF-LN-CALC               PIC X.
  2925         16  SF-ST-RF-AH-CALC               PIC X.
  2926         16  SF-ST-RF-CP-CALC               PIC X.
  2927     12  SF-ST-UNEARN-PREM-OPTIONS.
  2928         16  SF-ST-LUEP-R78                 PIC X.
  2929         16  SF-ST-LUEP-PRO                 PIC X.
  2930         16  SF-ST-LUEP-ST                  PIC X.
  2931         16  SF-ST-LUEP-DOM                 PIC X.
  2932         16  SF-ST-AUEP-R78                 PIC X.
  2933         16  SF-ST-AUEP-PRO                 PIC X.
  2934         16  SF-ST-AUEP-ST                  PIC X.
  2935         16  SF-ST-AUEP-DOM                 PIC X.
  2936         16  SF-ST-CUEP-R78                 PIC X.
  2937         16  SF-ST-CUEP-PRO                 PIC X.
  2938         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  55
* EL050.cbl
  2939         16  SF-ST-CUEP-DOM                 PIC X.
  2940     12  SF-ST-EARN-PREM-OPTIONS.
  2941         16  SF-ST-LEP-R78                  PIC X.
  2942         16  SF-ST-LEP-PRO                  PIC X.
  2943         16  SF-ST-LEP-ST                   PIC X.
  2944         16  SF-ST-LEP-DOM                  PIC X.
  2945         16  SF-ST-AEP-R78                  PIC X.
  2946         16  SF-ST-AEP-PRO                  PIC X.
  2947         16  SF-ST-AEP-ST                   PIC X.
  2948         16  SF-ST-AEP-DOM                  PIC X.
  2949         16  SF-ST-CEP-R78                  PIC X.
  2950         16  SF-ST-CEP-PRO                  PIC X.
  2951         16  SF-ST-CEP-ST                   PIC X.
  2952         16  SF-ST-CEP-DOM                  PIC X.
  2953     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  56
* EL050.cbl
  2955*    COPY ELCCRTT.
  2956******************************************************************
  2957*                                                                *
  2958*                            ELCCRTT.                            *
  2959*                                                                *
  2960*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2961*                                                                *
  2962*   FILE TYPE = VSAM,KSDS                                        *
  2963*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2964*                                                                *
  2965*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2966*                                                                *
  2967*   LOG = YES                                                    *
  2968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2969******************************************************************
  2970*                   C H A N G E   L O G
  2971*
  2972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2973*-----------------------------------------------------------------
  2974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2975* EFFECTIVE    NUMBER
  2976*-----------------------------------------------------------------
  2977* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2978* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2979* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2980* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2981* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2982* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2983* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2984* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2985* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2986******************************************************************
  2987
  2988 01  CERTIFICATE-TRAILERS.
  2989     12  CS-RECORD-ID                      PIC XX.
  2990         88  VALID-CS-ID                      VALUE 'CS'.
  2991
  2992     12  CS-CONTROL-PRIMARY.
  2993         16  CS-COMPANY-CD                 PIC X.
  2994         16  CS-CARRIER                    PIC X.
  2995         16  CS-GROUPING                   PIC X(6).
  2996         16  CS-STATE                      PIC XX.
  2997         16  CS-ACCOUNT                    PIC X(10).
  2998         16  CS-CERT-EFF-DT                PIC XX.
  2999         16  CS-CERT-NO.
  3000             20  CS-CERT-PRIME             PIC X(10).
  3001             20  CS-CERT-SFX               PIC X.
  3002         16  CS-TRAILER-TYPE               PIC X.
  3003             88  COMM-TRLR           VALUE 'A'.
  3004             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3005             88  CERT-DATA-TRLR      VALUE 'C'.
  3006
  3007     12  CS-DATA-AREA                      PIC X(516).
  3008
  3009     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3010         16  CS-BANK-COMMISSION-AREA.
  3011             20  CS-BANK-COMMS       OCCURS 10.
  3012                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  57
* EL050.cbl
  3013                 24  CS-COM-TYP            PIC X.
  3014                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3015                 24  CS-RECALC-LV-INDIC    PIC X.
  3016                 24  FILLER                PIC X(10).
  3017         16  FILLER                        PIC X(256).
  3018
  3019     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3020****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3021         16  CS-MB-CLAIM-DATA OCCURS 24.
  3022             20  CS-CLAIM-NO               PIC X(7).
  3023             20  CS-CLAIM-TYPE             PIC X.
  3024                 88  CS-AH-CLM               VALUE 'A'.
  3025                 88  CS-IU-CLM               VALUE 'I'.
  3026                 88  CS-GP-CLM               VALUE 'G'.
  3027                 88  CS-LF-CLM               VALUE 'L'.
  3028                 88  CS-PR-CLM               VALUE 'P'.
  3029                 88  CS-FL-CLM               VALUE 'F'.
  3030             20  CS-INSURED-TYPE           PIC X.
  3031                 88  CS-PRIM-INSURED          VALUE 'P'.
  3032                 88  CS-CO-BORROWER           VALUE 'C'.
  3033             20  CS-BENEFIT-PERIOD         PIC 99.
  3034             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3035             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3036             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3037         16  FILLER                        PIC X(12).
  3038     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3039         16  CS-VIN-NUMBER                 PIC X(17).
  3040         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3041         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3042         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3043         16  cs-agent-name.
  3044             20  cs-agent-fname            pic x(20).
  3045             20  cs-agent-mi               pic x.
  3046             20  cs-agent-lname            pic x(25).
  3047         16  cs-license-no                 pic x(15).
  3048         16  cs-npn-number                 pic x(10).
  3049         16  cs-agent-edit-status          pic x.
  3050             88  cs-ae-refer-to-manager      value 'M'.
  3051             88  cs-ae-cover-sheet           value 'C'.
  3052             88  cs-ae-sig-form              value 'S'.
  3053             88  cs-ae-verified              value 'V'.
  3054             88  cs-unidentified-signature   value 'U'.
  3055             88  cs-cert-returned            value 'R'.
  3056             88  cs-accept-no-commission     value 'N'.
  3057         16  cs-year                       pic 9999.
  3058         16  cs-make                       pic x(20).
  3059         16  cs-model                      pic x(20).
  3060         16  cs-future                     pic x(20).
  3061         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3062         16  FILLER                        PIC X(356). *> was 420
  3063*        16  FILLER                        PIC X(496).
  3064*    COPY ELCCRTO.
  3065******************************************************************
  3066*                                                                *
  3067*                            ELCCRTO.                            *
  3068*                                                                *
  3069*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3070*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  58
* EL050.cbl
  3071*   FILE TYPE = VSAM,KSDS                                        *
  3072*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3073*                                                                *
  3074*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3075*                                                                *
  3076*   LOG = YES                                                    *
  3077*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3078******************************************************************
  3079*                   C H A N G E   L O G
  3080*
  3081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3082*-----------------------------------------------------------------
  3083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3084* EFFECTIVE    NUMBER
  3085*-----------------------------------------------------------------
  3086* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3087* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3088* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3089* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3090* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3091******************************************************************
  3092 01  ORIGINAL-CERTIFICATE.
  3093     12  OC-RECORD-ID                      PIC XX.
  3094         88  VALID-OC-ID                      VALUE 'OC'.
  3095     12  OC-CONTROL-PRIMARY.
  3096         16  OC-COMPANY-CD                 PIC X.
  3097         16  OC-CARRIER                    PIC X.
  3098         16  OC-GROUPING                   PIC X(6).
  3099         16  OC-STATE                      PIC XX.
  3100         16  OC-ACCOUNT                    PIC X(10).
  3101         16  OC-CERT-EFF-DT                PIC XX.
  3102         16  OC-CERT-NO.
  3103             20  OC-CERT-PRIME             PIC X(10).
  3104             20  OC-CERT-SFX               PIC X.
  3105         16  OC-RECORD-TYPE                PIC X.
  3106         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3107     12  OC-LAST-MAINT-DT                  PIC XX.
  3108     12  OC-LAST-MAINT-BY                  PIC X(4).
  3109     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3110     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3111     12  FILLER                            PIC X(49).
  3112     12  OC-ORIG-REC.
  3113         16  OC-INS-LAST-NAME              PIC X(15).
  3114         16  OC-INS-FIRST-NAME             PIC X(10).
  3115         16  OC-INS-MIDDLE-INIT            PIC X.
  3116         16  OC-INS-AGE                    PIC S999     COMP-3.
  3117         16  OC-JNT-LAST-NAME              PIC X(15).
  3118         16  OC-JNT-FIRST-NAME             PIC X(10).
  3119         16  OC-JNT-MIDDLE-INIT            PIC X.
  3120         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3121         16  OC-LF-BENCD                   PIC XX.
  3122         16  OC-LF-TERM                    PIC S999      COMP-3.
  3123         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3124         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3125         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3126         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3127         16  OC-LF-EXP-DT                  PIC XX.
  3128         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  59
* EL050.cbl
  3129         16  OC-LF-CANCEL-DT               PIC XX.
  3130         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3131         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3132         16  OC-AH-BENCD                   PIC XX.
  3133         16  OC-AH-TERM                    PIC S999      COMP-3.
  3134         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3135         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3136         16  OC-AH-EXP-DT                  PIC XX.
  3137         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3138         16  OC-AH-CP                      PIC 99.
  3139         16  OC-AH-CANCEL-DT               PIC XX.
  3140         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3141         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3142         16  OC-CRED-BENE-NAME             PIC X(25).
  3143         16  OC-1ST-PMT-DT                 PIC XX.
  3144         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3145         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3146         16  OC-ISSUE-TRAN-IND             PIC X.
  3147         16  OC-CANCEL-TRAN-IND            PIC X.
  3148         16  FILLER                        PIC X(211).
  3149
  3150     12  FILLER                            PIC X(50).
  3151******************************************************************
  3152
  3153*    COPY ELCDATE.
  3154******************************************************************
  3155*                                                                *
  3156*                                                                *
  3157*                            ELCDATE.                            *
  3158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3159*                            VMOD=2.003
  3160*                                                                *
  3161*                                                                *
  3162*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3163*                 LENGTH = 200                                   *
  3164******************************************************************
  3165
  3166 01  DATE-CONVERSION-DATA.
  3167     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3168     12  DC-OPTION-CODE                PIC X.
  3169         88  BIN-TO-GREG                VALUE ' '.
  3170         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3171         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3172         88  YMD-GREG-TO-BIN            VALUE '3'.
  3173         88  MDY-GREG-TO-BIN            VALUE '4'.
  3174         88  JULIAN-TO-BIN              VALUE '5'.
  3175         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3176         88  FIND-CENTURY               VALUE '7'.
  3177         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3178         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3179         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3180         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3181         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3182         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3183         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3184         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3185         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3186         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  60
* EL050.cbl
  3187         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3188         88  BIN-3-TO-GREG              VALUE 'I'.
  3189         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3190         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3191         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3192         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3193         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3194         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3195         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3196         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3197         88  THREE-CHARACTER-BIN
  3198                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3199         88  GREGORIAN-TO-BIN
  3200                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3201         88  BIN-TO-GREGORIAN
  3202                  VALUES ' ' '1' 'I' '8' 'G'.
  3203         88  JULIAN-TO-BINARY
  3204                  VALUES '5' 'C' 'E' 'F'.
  3205     12  DC-ERROR-CODE                 PIC X.
  3206         88  NO-CONVERSION-ERROR        VALUE ' '.
  3207         88  DATE-CONVERSION-ERROR
  3208                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3209         88  DATE-IS-ZERO               VALUE '1'.
  3210         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3211         88  DATE-IS-INVALID            VALUE '3'.
  3212         88  DATE1-GREATER-DATE2        VALUE '4'.
  3213         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3214         88  DATE-INVALID-OPTION        VALUE '9'.
  3215         88  INVALID-CENTURY            VALUE 'A'.
  3216         88  ONLY-CENTURY               VALUE 'B'.
  3217         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3218         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3219     12  DC-END-OF-MONTH               PIC X.
  3220         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3221     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3222         88  USE-NORMAL-PROCESS         VALUE ' '.
  3223         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3224         88  ADJUST-UP-100-YRS          VALUE '2'.
  3225     12  FILLER                        PIC X.
  3226     12  DC-CONVERSION-DATES.
  3227         16  DC-BIN-DATE-1             PIC XX.
  3228         16  DC-BIN-DATE-2             PIC XX.
  3229         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3230         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3231                       DC-GREG-DATE-1-EDIT.
  3232             20  DC-EDIT1-MONTH        PIC 99.
  3233             20  SLASH1-1              PIC X.
  3234             20  DC-EDIT1-DAY          PIC 99.
  3235             20  SLASH1-2              PIC X.
  3236             20  DC-EDIT1-YEAR         PIC 99.
  3237         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3238         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3239                     DC-GREG-DATE-2-EDIT.
  3240             20  DC-EDIT2-MONTH        PIC 99.
  3241             20  SLASH2-1              PIC X.
  3242             20  DC-EDIT2-DAY          PIC 99.
  3243             20  SLASH2-2              PIC X.
  3244             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  61
* EL050.cbl
  3245         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3246         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3247                     DC-GREG-DATE-1-YMD.
  3248             20  DC-YMD-YEAR           PIC 99.
  3249             20  DC-YMD-MONTH          PIC 99.
  3250             20  DC-YMD-DAY            PIC 99.
  3251         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3252         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3253                      DC-GREG-DATE-1-MDY.
  3254             20  DC-MDY-MONTH          PIC 99.
  3255             20  DC-MDY-DAY            PIC 99.
  3256             20  DC-MDY-YEAR           PIC 99.
  3257         16  DC-GREG-DATE-1-ALPHA.
  3258             20  DC-ALPHA-MONTH        PIC X(10).
  3259             20  DC-ALPHA-DAY          PIC 99.
  3260             20  FILLER                PIC XX.
  3261             20  DC-ALPHA-CENTURY.
  3262                 24 DC-ALPHA-CEN-N     PIC 99.
  3263             20  DC-ALPHA-YEAR         PIC 99.
  3264         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3265         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3266         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3267         16  DC-JULIAN-DATE            PIC 9(05).
  3268         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3269                                       PIC 9(05).
  3270         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3271             20  DC-JULIAN-YEAR        PIC 99.
  3272             20  DC-JULIAN-DAYS        PIC 999.
  3273         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3274         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3275         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3276     12  DATE-CONVERSION-VARIBLES.
  3277         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3278         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3279             20  FILLER                PIC 9(3).
  3280             20  HOLD-CEN-1-CCYY.
  3281                 24  HOLD-CEN-1-CC     PIC 99.
  3282                 24  HOLD-CEN-1-YY     PIC 99.
  3283             20  HOLD-CEN-1-MO         PIC 99.
  3284             20  HOLD-CEN-1-DA         PIC 99.
  3285         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3286             20  HOLD-CEN-1-R-MO       PIC 99.
  3287             20  HOLD-CEN-1-R-DA       PIC 99.
  3288             20  HOLD-CEN-1-R-CCYY.
  3289                 24  HOLD-CEN-1-R-CC   PIC 99.
  3290                 24  HOLD-CEN-1-R-YY   PIC 99.
  3291             20  FILLER                PIC 9(3).
  3292         16  HOLD-CENTURY-1-X.
  3293             20  FILLER                PIC X(3)  VALUE SPACES.
  3294             20  HOLD-CEN-1-X-CCYY.
  3295                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3296                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3297             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3298             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3299         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3300             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3301             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3302             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  62
* EL050.cbl
  3303                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3304                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3305             20  FILLER                PIC XXX.
  3306         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3307         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3308         16  DC-JULIAN-DATE-1          PIC 9(07).
  3309         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3310             20  DC-JULIAN-1-CCYY.
  3311                 24  DC-JULIAN-1-CC    PIC 99.
  3312                 24  DC-JULIAN-1-YR    PIC 99.
  3313             20  DC-JULIAN-DA-1        PIC 999.
  3314         16  DC-JULIAN-DATE-2          PIC 9(07).
  3315         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3316             20  DC-JULIAN-2-CCYY.
  3317                 24  DC-JULIAN-2-CC    PIC 99.
  3318                 24  DC-JULIAN-2-YR    PIC 99.
  3319             20  DC-JULIAN-DA-2        PIC 999.
  3320         16  DC-GREG-DATE-A-EDIT.
  3321             20  DC-EDITA-MONTH        PIC 99.
  3322             20  SLASHA-1              PIC X VALUE '/'.
  3323             20  DC-EDITA-DAY          PIC 99.
  3324             20  SLASHA-2              PIC X VALUE '/'.
  3325             20  DC-EDITA-CCYY.
  3326                 24  DC-EDITA-CENT     PIC 99.
  3327                 24  DC-EDITA-YEAR     PIC 99.
  3328         16  DC-GREG-DATE-B-EDIT.
  3329             20  DC-EDITB-MONTH        PIC 99.
  3330             20  SLASHB-1              PIC X VALUE '/'.
  3331             20  DC-EDITB-DAY          PIC 99.
  3332             20  SLASHB-2              PIC X VALUE '/'.
  3333             20  DC-EDITB-CCYY.
  3334                 24  DC-EDITB-CENT     PIC 99.
  3335                 24  DC-EDITB-YEAR     PIC 99.
  3336         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3337         16  DC-GREG-DATE-CYMD-R REDEFINES
  3338                              DC-GREG-DATE-CYMD.
  3339             20  DC-CYMD-CEN           PIC 99.
  3340             20  DC-CYMD-YEAR          PIC 99.
  3341             20  DC-CYMD-MONTH         PIC 99.
  3342             20  DC-CYMD-DAY           PIC 99.
  3343         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3344         16  DC-GREG-DATE-MDCY-R REDEFINES
  3345                              DC-GREG-DATE-MDCY.
  3346             20  DC-MDCY-MONTH         PIC 99.
  3347             20  DC-MDCY-DAY           PIC 99.
  3348             20  DC-MDCY-CEN           PIC 99.
  3349             20  DC-MDCY-YEAR          PIC 99.
  3350    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3351        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3352    12  DC-EL310-DATE                  PIC X(21).
  3353    12  FILLER                         PIC X(28).
  3354
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  63
* EL050.cbl
  3356*    COPY ELCCALC.
  3357******************************************************************
  3358*                                                                *
  3359*                           ELCCALC.                            *
  3360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3361*                            VMOD=2.025                          *
  3362*                                                                *
  3363*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3364*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3365*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3366*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3367*                                                                *
  3368*  PASSED TO ELRTRM                                              *
  3369*  -----------------                                             *
  3370*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3371*  ORIGINAL TERM                                                 *
  3372*  BEGINNING DATE                                                *
  3373*  ENDING DATE                                                   *
  3374*  COMPANY I.D.                                                  *
  3375*  ACCOUNT MASTER USER FIELD                                     *
  3376*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3377*  FREE LOOK DAYS                                                *
  3378*                                                                *
  3379*  RETURNED FROM ELRTRM                                          *
  3380*  ---------------------                                         *
  3381*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3382*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3383*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3384*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3385*----------------------------------------------------------------*
  3386*  PASSED TO ELRAMT                                              *
  3387*  ----------------                                              *
  3388*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3389*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3390*  ORIGINAL AMOUNT                                               *
  3391*  ALTERNATE BENEFIT (BALLON)                                    *
  3392*  A.P.R. - NET PAY ONLY                                         *
  3393*  METHOD
  3394*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3395*  COMPANY I.D.                                                  *
  3396*  BENEFIT TYPE                                                  *
  3397*                                                                *
  3398*  RETURNED FROM ELRAMT                                          *
  3399*  --------------------                                          *
  3400*  REMAINING AMOUNT 1 - CURRENT                                  *
  3401*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3402*  REMAINING AMOUNT FACTOR
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRESV                                              *
  3405*  -----------------                                             *
  3406*  CERTIFICATE EFFECTIVE DATE                                    *
  3407*  VALUATION DATE                                                *
  3408*  PAID THRU DATE                                                *
  3409*  BENEFIT                                                       *
  3410*  INCURRED DATE                                                 *
  3411*  REPORTED DATE                                                 *
  3412*  ISSUE AGE                                                     *
  3413*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  64
* EL050.cbl
  3414*  CDT PERCENT                                                   *
  3415*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3416* *CLAIM TYPE (LIFE, A/H)                                        *
  3417* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3418* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3419*                                                                *
  3420*  RETURNED FROM ELRESV                                          *
  3421*  --------------------                                          *
  3422*  CDT TABLE USED                                                *
  3423*  CDT FACTOR USED                                               *
  3424*  PAY TO CURRENT RESERVE                                        *
  3425*  I.B.N.R. - A/H ONLY                                           *
  3426*  FUTURE (ACCRUED) AH ONLY                                      *
  3427*----------------------------------------------------------------*
  3428*  PASSED TO ELRATE                                              *
  3429*  ----------------                                              *
  3430*  CERT ISSUE DATE                                               *
  3431*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3432*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3433*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3434*  STATE CODE (CLIENT DEFINED)                                   *
  3435*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3436*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3437*  DEVIATION CODE                                                *
  3438*  ISSUE AGE                                                     *
  3439*  ORIGINAL BENEFIT AMOUNT                                       *
  3440*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3441*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3442*  BENEFIT KIND (LIFE OR A/H)                                    *
  3443*  A.P.R.                                                        *
  3444*  METHOD
  3445*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3446*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3447*  COMPANY I.D. (3 CHARACTER)                                    *
  3448*  BENEFIT CODE                                                  *
  3449*  BENEFIT OVERRIDE CODE                                         *
  3450*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3451*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3452*  JOINT INDICATOR (CSL ONLY)                                    *
  3453*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3454*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3455*                                                                *
  3456*  RETURNED FROM ELRATE                                          *
  3457*  --------------------                                          *
  3458*  CALCULATED PREMIUM                                            *
  3459*  PREMIUM RATE                                                  *
  3460*  MORTALITY CODE                                                *
  3461*  MAX ATTAINED AGE                                              *
  3462*  MAX AGE                                                       *
  3463*  MAX TERM                                                      *
  3464*  MAX MONTHLY BENEFIT                                           *
  3465*  MAX TOTAL BENIFIT                                             *
  3466*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3467*----------------------------------------------------------------*
  3468*  PASSED TO ELRFND                                              *
  3469*  ----------------                                              *
  3470*  CERT ISSUE DATE                                               *
  3471*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  65
* EL050.cbl
  3472*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3473*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3474*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3475*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3476*  STATE CODE (CLIENT DEFINED)                                   *
  3477*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3478*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3479*  DEVIATION CODE                                                *
  3480*  ISSUE AGE                                                     *
  3481*  ORIGINAL BENEFIT AMOUNT                                       *
  3482*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3483*  PROCESS TYPE (CANCEL)                                         *
  3484*  BENEFIT KIND (LIFE OR A/H)                                    *
  3485*  A.P.R.                                                        *
  3486*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3487*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3488*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3489*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3490*  COMPANY I.D. (3 CHARACTER)                                    *
  3491*  BENEFIT CODE                                                  *
  3492*  BENEFIT OVERRIDE CODE                                         *
  3493*                                                                *
  3494*  RETURNED FROM ELRFND                                          *
  3495*  --------------------                                          *
  3496*  CALCULATED REFUND                                             *
  3497*----------------------------------------------------------------*
  3498*  PASSED TO ELEARN                                              *
  3499*  ----------------                                              *
  3500*  CERT ISSUE DATE                                               *
  3501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3502*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3503*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3504*  STATE CODE (CLIENT DEFINED)                                   *
  3505*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3506*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3507*  DEVIATION CODE                                                *
  3508*  ISSUE AGE                                                     *
  3509*  ORIGINAL BENEFIT AMOUNT                                       *
  3510*  BENEFIT KIND (LIFE OR A/H)                                    *
  3511*  A.P.R.                                                        *
  3512*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3513*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3514*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3515*  COMPANY I.D. (3 CHARACTER)                                    *
  3516*  BENEFIT CODE                                                  *
  3517*  BENEFIT OVERRIDE CODE                                         *
  3518*                                                                *
  3519*  RETURNED FROM ELEARN                                          *
  3520*  --------------------                                          *
  3521*  INDICATED  EARNINGS                                           *
  3522*----------------------------------------------------------------*
  3523*                 LENGTH = 450                                   *
  3524*                                                                *
  3525******************************************************************
  3526******************************************************************
  3527*                   C H A N G E   L O G
  3528*
  3529* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  66
* EL050.cbl
  3530*-----------------------------------------------------------------
  3531*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3532* EFFECTIVE    NUMBER
  3533*-----------------------------------------------------------------
  3534* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3535* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3536* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3537* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3538* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3539* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3540* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3541* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3542* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3543* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3544* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3545******************************************************************
  3546
  3547 01  CALCULATION-PASS-AREA.
  3548     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3549                                     COMP.
  3550
  3551     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3552       88  NO-CP-ERROR                             VALUE ZERO.
  3553       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3554                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3555       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3556       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3557       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3558       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3559       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3560       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3561       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3562       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3563       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3564       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3565       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3566       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3567       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3568       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3569       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3570       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3571       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3572
  3573     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3574       88  NO-CP-ERROR-2                           VALUE ZERO.
  3575***********************  INPUT AREAS ****************************
  3576
  3577     12  CP-CALCULATION-AREA.
  3578         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3579         16  CP-CERT-EFF-DT        PIC XX.
  3580         16  CP-VALUATION-DT       PIC XX.
  3581         16  CP-PAID-THRU-DT       PIC XX.
  3582         16  CP-BENEFIT-TYPE       PIC X.
  3583           88  CP-AH                               VALUE 'A' 'D'
  3584                                                   'I' 'U'.
  3585           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3586           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3587         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  67
* EL050.cbl
  3588         16  CP-REPORTED-DT        PIC XX.
  3589         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3590         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3591         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-CDT-METHOD         PIC X.
  3596           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3597           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3598           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3599         16  CP-CLAIM-TYPE         PIC X.
  3600           88  CP-AH-CLAIM                         VALUE 'A'.
  3601           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3602         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3609                                     COMP-3.
  3610         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3611                                     COMP-3.
  3612         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-REM-TERM-METHOD    PIC X.
  3617           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3618           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3619           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3620           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3621           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3622           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3623           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3624         16  CP-EARNING-METHOD     PIC X.
  3625           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3626           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3627           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3628           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3629           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3630           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3631           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3632           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3633           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3634           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3635           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3636           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3637           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3638           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3639         16  CP-PROCESS-TYPE       PIC X.
  3640           88  CP-CLAIM                            VALUE '1'.
  3641           88  CP-CANCEL                           VALUE '2'.
  3642           88  CP-ISSUE                            VALUE '3'.
  3643         16  CP-SPECIAL-CALC-CD    PIC X.
  3644           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3645           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  68
* EL050.cbl
  3646           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3647           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3648           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3649           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3650           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3651           88  CP-FARM-PLAN                    VALUE 'F'.
  3652           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3653           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3654           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3655           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3656           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3657           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3658           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3659           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3660           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3661           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3662                                                     'W' 'X'.
  3663           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3664           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3665           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3666           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3667           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3668           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3669           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3670           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3671           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3672           88  CP-CSL-METH-1                   VALUE '5'.
  3673           88  CP-CSL-METH-2                   VALUE '6'.
  3674           88  CP-CSL-METH-3                   VALUE '7'.
  3675           88  CP-CSL-METH-4                   VALUE '8'.
  3676
  3677         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3680         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3681         16  CP-STATE              PIC XX          VALUE SPACE.
  3682         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3683         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3684           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3685               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3686         16  CP-R78-OPTION         PIC X.
  3687           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3688           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3689
  3690         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3691         16  CP-IBNR-RESERVE-SW    PIC X.
  3692         16  CP-CLAIM-STATUS       PIC X.
  3693         16  CP-RATE-FILE          PIC X.
  3694         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3695                                     COMP-3.
  3696
  3697         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3698         16  CP-AH-OVERRIDE-CODE   PIC X.
  3699
  3700         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3703                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  69
* EL050.cbl
  3704         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3711                                  PIC S9(7)V99 COMP-3.
  3712
  3713         16  CP-PAID-FROM-DATE     PIC X(02).
  3714         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3715         16  CP-EXT-DAYS-CALC      PIC X.
  3716           88  CP-EXT-NO-CHG                   VALUE ' '.
  3717           88  CP-EXT-CHG-LF                   VALUE '1'.
  3718           88  CP-EXT-CHG-AH                   VALUE '2'.
  3719           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3720         16  CP-DOMICILE-STATE     PIC XX.
  3721         16  CP-CARRIER            PIC X.
  3722         16  CP-REIN-FLAG          PIC X.
  3723         16  CP-REM-TRM-CALC-OPTION PIC X.
  3724           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3725                      '2' '3' '4' '5'.
  3726           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3727           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3728           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3729           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3730           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3731           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3732           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3733           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3734         16  CP-SIG-SWITCH         PIC X.
  3735         16  CP-RATING-METHOD      PIC X.
  3736           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3737           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3738           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3739           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3740           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3741           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3742           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3743           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3744           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3745         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3746                                     COMP-3.
  3747         16  CP-BEN-CATEGORY       PIC X.
  3748         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3749         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3750                                   PIC S99V9(5) COMP-3.
  3751         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3752         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3753                                   PIC S99V9(5) COMP-3.
  3754         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3755         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3756         16  CP-EXPIRE-DT          PIC XX.
  3757         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3758         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3759         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3760         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3761         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  70
* EL050.cbl
  3762             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3763             88  CP-CALC-CLP              VALUE 'C'.
  3764         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3765         16  CP-CANCEL-REASON      PIC X.
  3766         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3767         16  CP-PMT-MODE           PIC X.
  3768         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3769         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3770         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3771         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3772         16  FILLER                PIC X.
  3773
  3774***************    OUTPUT FROM ELRESV   ************************
  3775
  3776         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3777
  3778         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  FILLER                PIC X(09).
  3787***************    OUTPUT FROM ELRTRM   *************************
  3788
  3789         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3796                                     COMP-3.
  3797         16  FILLER                PIC X(12).
  3798
  3799***************    OUTPUT FROM ELRAMT   *************************
  3800
  3801         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  FILLER                PIC X(12).
  3806
  3807***************    OUTPUT FROM ELRATE   *************************
  3808
  3809         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-MORTALITY-CODE     PIC X(4).
  3814         16  CP-RATE-EDIT-FLAG     PIC X.
  3815             88  CP-RATES-NEED-APR                  VALUE '1'.
  3816         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3819         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  71
* EL050.cbl
  3820         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3821                                   PIC S9(7)V99 COMP-3.
  3822         16  FILLER                PIC X(07).
  3823
  3824***************    OUTPUT FROM ELRFND   *************************
  3825
  3826         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-REFUND-TYPE-USED   PIC X.
  3829           88  CP-R-AS-R78                         VALUE '1'.
  3830           88  CP-R-AS-PRORATA                     VALUE '2'.
  3831           88  CP-R-AS-CALIF                       VALUE '3'.
  3832           88  CP-R-AS-TEXAS                       VALUE '4'.
  3833           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3834           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3835           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3836           88  CP-R-AS-MEAN                        VALUE '8'.
  3837           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3838           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3839           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3840           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3841           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3842           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3843         16  FILLER                PIC X(12).
  3844
  3845***************    OUTPUT FROM ELEARN   *************************
  3846
  3847         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3850                                     COMP-3.
  3851         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3852                                     COMP-3.
  3853         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-EARNING-TYPE-USED  PIC X.
  3860           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3861           88  CP-E-AS-R78                         VALUE '1'.
  3862           88  CP-E-AS-PRORATA                     VALUE '2'.
  3863           88  CP-E-AS-TEXAS                       VALUE '4'.
  3864           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3865           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3866           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3867           88  CP-E-AS-MEAN                        VALUE '8'.
  3868           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3869         16  FILLER                PIC X(12).
  3870
  3871***************    OUTPUT FROM ELPMNT   *************************
  3872
  3873         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  72
* EL050.cbl
  3878
  3879***************   MISC WORK AREAS    *****************************
  3880         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3885                                     COMP-3.
  3886         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3887                                     COMP-3.
  3888         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3889                                     COMP-3.
  3890         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3891                                     COMP-3.
  3892         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3893             88  OPEN-RATE-FILE                   VALUE 'O'.
  3894             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3895             88  IO-ERROR                         VALUE 'E'.
  3896
  3897         16  CP-FIRST-PAY-DATE     PIC XX.
  3898
  3899         16  CP-JOINT-INDICATOR    PIC X.
  3900
  3901         16  CP-RESERVE-REMAINING-TERM
  3902                                   PIC S9(4)V9    VALUE ZERO
  3903                                     COMP-3.
  3904
  3905         16  CP-INSURED-BIRTH-DT   PIC XX.
  3906
  3907         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3908                                     COMP-3.
  3909
  3910         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3911                                     COMP-3.
  3912
  3913         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3914                                     COMP-3.
  3915
  3916         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3917                                     COMP-3.
  3918
  3919         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3920                                     COMP-3.
  3921
  3922         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3923                                     COMP-3.
  3924
  3925         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3926                                     COMP-3.
  3927
  3928         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3929             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3930
  3931         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3934                                     COMP-3.
  3935         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  73
* EL050.cbl
  3936         16  cp-extra-periods      pic 9 value zeros.
  3937         16  cp-net-only-state     pic x value spaces.
  3938         16  FILLER                PIC X(13).
  3939******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  74
* EL050.cbl
  3941******************************************************************
  3942*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3943*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3944*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3945*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3946*** MODIFICATION.                                              ***
  3947*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3948*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3949******************************************************************
  3950*    COPY ERCPNDB.
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*                            ERCPNDB.                            *
  3955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3956*                            VMOD=2.025                          *
  3957*                                                                *
  3958*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3959*                                                                *
  3960******************************************************************
  3961*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3962*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3963******************************************************************
  3964*                                                                *
  3965*                                                                *
  3966*   FILE TYPE = VSAM,KSDS                                        *
  3967*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3968*                                                                *
  3969*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3970*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3971*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3972*                                                 RKP=13,LEN=36  *
  3973*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3974*                                      AND CHG-SEQ.)             *
  3975*                                                RKP=49,LEN=11   *
  3976*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3977*                                      AND CHG-SEQ.)             *
  3978*                                                RKP=60,LEN=15   *
  3979*                                                                *
  3980*   LOG = NO                                                     *
  3981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3982******************************************************************
  3983******************************************************************
  3984*                   C H A N G E   L O G
  3985*
  3986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3987*-----------------------------------------------------------------
  3988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3989* EFFECTIVE    NUMBER
  3990*-----------------------------------------------------------------
  3991* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3992* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3993* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3994* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3995* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3996* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3997* 032306                   PEMA  ADD BOW LOAN NUMBER
  3998* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  75
* EL050.cbl
  3999* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4000* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4001* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4002* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4003* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4004* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4005* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4006* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4007* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4008* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4009******************************************************************
  4010
  4011 01  PENDING-BUSINESS.
  4012     12  PB-RECORD-ID                     PIC XX.
  4013         88  VALID-PB-ID                        VALUE 'PB'.
  4014
  4015     12  PB-CONTROL-PRIMARY.
  4016         16  PB-COMPANY-CD                PIC X.
  4017         16  PB-ENTRY-BATCH               PIC X(6).
  4018         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4019         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4020
  4021     12  PB-CONTROL-BY-ACCOUNT.
  4022         16  PB-COMPANY-CD-A1             PIC X.
  4023         16  PB-CARRIER                   PIC X.
  4024         16  PB-GROUPING.
  4025             20  PB-GROUPING-PREFIX       PIC XXX.
  4026             20  PB-GROUPING-PRIME        PIC XXX.
  4027         16  PB-STATE                     PIC XX.
  4028         16  PB-ACCOUNT.
  4029             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4030             20  PB-ACCOUNT-PRIME         PIC X(6).
  4031         16  PB-CERT-EFF-DT               PIC XX.
  4032         16  PB-CERT-NO.
  4033             20  PB-CERT-PRIME            PIC X(10).
  4034             20  PB-CERT-SFX              PIC X.
  4035         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4036
  4037         16  PB-RECORD-TYPE               PIC X.
  4038             88  PB-MAILING-DATA                VALUE '0'.
  4039             88  PB-ISSUE                       VALUE '1'.
  4040             88  PB-CANCELLATION                VALUE '2'.
  4041             88  PB-BATCH-TRAILER               VALUE '9'.
  4042
  4043     12  PB-CONTROL-BY-ORIG-BATCH.
  4044         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4045         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4046         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4047         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4048
  4049     12  PB-CONTROL-BY-CSR.
  4050         16  PB-CSR-COMPANY-CD            PIC X.
  4051         16  PB-CSR-ID                    PIC X(4).
  4052         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4053         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4054         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4055******************************************************************
  4056*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  76
* EL050.cbl
  4057******************************************************************
  4058
  4059     12  PB-LAST-MAINT-DT                 PIC XX.
  4060     12  PB-LAST-MAINT-BY                 PIC X(4).
  4061     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4062
  4063     12  PB-RECORD-BODY                   PIC X(375).
  4064
  4065     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4066         16  PB-CERT-ORIGIN               PIC X.
  4067             88  CLASIC-CREATED-CERT         VALUE '1'.
  4068         16  PB-I-NAME.
  4069             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4070             20  PB-I-INSURED-FIRST-NAME.
  4071                 24  PB-I-INSURED-1ST-INIT PIC X.
  4072                 24  FILLER                PIC X(9).
  4073             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4074         16  PB-I-AGE                     PIC S99   COMP-3.
  4075         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4076         16  PB-I-BIRTHDAY                PIC XX.
  4077         16  PB-I-INSURED-SEX             PIC X.
  4078             88  PB-SEX-MALE     VALUE 'M'.
  4079             88  PB-SEX-FEMALE   VALUE 'F'.
  4080
  4081         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4082         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4083         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4084         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4085         16  PB-I-SKIP-CODE               PIC X.
  4086             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4087             88  PB-SKIP-JULY              VALUE '1'.
  4088             88  PB-SKIP-AUGUST            VALUE '2'.
  4089             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4090             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4091             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4092             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4093             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4094             88  PB-SKIP-JUNE              VALUE '8'.
  4095             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4096             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4097             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4098         16  PB-I-TERM-TYPE               PIC X.
  4099             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4100             88  PB-PAID-WEEKLY            VALUE 'W'.
  4101             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4102             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4103             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4104         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4105         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4106         16  PB-I-DATA-ENTRY-SW           PIC X.
  4107             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4108             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4109             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4110             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4111         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4112         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4113*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4114         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  77
* EL050.cbl
  4115         16  FILLER                       PIC X.
  4116
  4117         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4118             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4119             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4120                                                   '90' THRU '99'.
  4121         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4122                                          PIC XX.
  4123         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4124         16  PB-I-AMOUNT-FINANCED REDEFINES
  4125                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4126         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4127         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4128                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4129         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4130         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4131         16  PB-I-CLP-AMOUNT REDEFINES
  4132                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4133         16  PB-I-LF-CALC-FLAG            PIC X.
  4134             88 PB-COMP-LF-PREM               VALUE '?'.
  4135         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4136         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4137         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4138         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4139         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4140         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4141         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4142         16  PB-I-LF-ABBR                 PIC XXX.
  4143         16  PB-I-LF-INPUT-CD             PIC XX.
  4144
  4145         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4146             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4147             88  PB-INVALID-AH               VALUE '  ' '00'
  4148                                                   '90' THRU '99'.
  4149         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4150         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4151         16  PB-I-AH-CALC-FLAG            PIC X.
  4152             88 PB-COMP-AH-PREM                  VALUE '?'.
  4153         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4154         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4155         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4156         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4157         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4158         16  PB-I-AH-ABBR                 PIC XXX.
  4159         16  PB-I-AH-INPUT-CD             PIC XXX.
  4160
  4161         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4162         16  PB-I-REIN-TABLE              PIC XXX.
  4163         16  PB-I-BUSINESS-TYPE           PIC 99.
  4164         16  PB-I-INDV-GRP-CD             PIC X.
  4165         16  PB-I-MORT-CODE.
  4166             20  PB-I-TABLE               PIC X.
  4167             20  PB-I-INTEREST            PIC XX.
  4168             20  PB-I-MORT-TYP            PIC X.
  4169         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4170         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4171         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4172         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  78
* EL050.cbl
  4173         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4174         16  PB-I-SIG-SW                  PIC X.
  4175             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4176         16  PB-I-RATE-CLASS              PIC XX.
  4177         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4178         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4179         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4180         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4181         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4182         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4183         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4184         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4185         16  PB-I-OB-FLAG                 PIC X.
  4186             88  PB-I-OB                      VALUE 'B'.
  4187             88  PB-I-SUMMARY                 VALUE 'Z'.
  4188         16  PB-I-ENTRY-STATUS            PIC X.
  4189             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4190                                              'M' '5' '9' '2'.
  4191             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4192             88  PB-I-POLICY-PENDING          VALUE '2'.
  4193             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4194             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4195             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4196             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4197             88  PB-I-REIN-ONLY               VALUE '9'.
  4198             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4199             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4200             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4201             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4202         16  PB-I-INT-CODE                PIC X.
  4203             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4204             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4205         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4206         16  PB-I-SOC-SEC-NO              PIC X(11).
  4207         16  PB-I-MEMBER-NO               PIC X(12).
  4208         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4209*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4210         16  PB-I-OLD-LOF                 PIC XXX.
  4211         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4212         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4213         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4214         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4215         16  PB-I-LIFE-INDICATOR          PIC X.
  4216             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4217         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4218         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4219                                          PIC S9(5)V99    COMP-3.
  4220         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4221             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4222             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4223         16  PB-I-1ST-PMT-DT              PIC XX.
  4224         16  PB-I-JOINT-INSURED.
  4225             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4226             20 PB-I-JOINT-FIRST-NAME.
  4227                24  PB-I-JOINT-FIRST-INIT PIC X.
  4228                24  FILLER                PIC X(9).
  4229             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4230*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  79
* EL050.cbl
  4231         16  PB-I-BENEFICIARY-NAME.
  4232             20  PB-I-BANK-NUMBER         PIC X(10).
  4233             20  FILLER                   PIC X(15).
  4234         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4235         16  PB-I-REFERENCE               PIC X(12).
  4236         16  FILLER REDEFINES PB-I-REFERENCE.
  4237             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4238             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4239             20  PB-I-CLP-STATE           PIC XX.
  4240         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4241             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4242             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4243             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4244         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4245         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4246         16  PB-I-RESIDENT-STATE          PIC XX.
  4247         16  PB-I-RATE-CODE               PIC X(4).
  4248         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4249         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4250         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4251         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4252         16  PB-I-BANK-NOCHRGB            PIC 99.
  4253         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4254         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4255
  4256     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4257         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4258             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4259         16  PB-C-CANCEL-ORIGIN           PIC X.
  4260             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4261         16  PB-C-LF-CANCEL-DT            PIC XX.
  4262         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4263         16  PB-C-LF-CALC-REQ             PIC X.
  4264             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4265         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4266         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4267         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4268             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4269         16  PB-C-AH-CANCEL-DT            PIC XX.
  4270         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4271         16  PB-C-AH-CALC-REQ             PIC X.
  4272             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4273         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4274         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4275         16  PB-C-LAST-NAME               PIC X(15).
  4276         16  PB-C-REFUND-SW               PIC X.
  4277             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4278             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4279         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4280         16  PB-C-PAYEE-CODE              PIC X(6).
  4281         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4282         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4283         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4284         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4285         16  PB-C-REFERENCE               PIC X(12).
  4286         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4287         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4288         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  80
* EL050.cbl
  4289         16  PB-C-CANCEL-REASON           PIC X.
  4290         16  PB-C-REF-INTERFACE-SW        PIC X.
  4291         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4292         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4293         16  FILLER                       PIC X(01).
  4294*        16  FILLER                       PIC X(18).
  4295         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4296*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4297         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4298         16  PB-CANCELED-CERT-DATA.
  4299             20  PB-CI-INSURED-NAME.
  4300                 24  PB-CI-LAST-NAME      PIC X(15).
  4301                 24  PB-CI-INITIALS       PIC XX.
  4302             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4303             20  PB-CI-INSURED-SEX        PIC X.
  4304             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4305             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4306             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4307             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4308             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4309             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4310             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4311             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4312             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4313             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4314             20  PB-CI-RATE-CLASS         PIC XX.
  4315             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4316             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4317             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4318             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4319             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4320             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4321             20  PB-CI-LF-ABBR            PIC X(3).
  4322             20  PB-CI-AH-ABBR            PIC X(3).
  4323             20  PB-CI-OB-FLAG            PIC X.
  4324                 88  PB-CI-OB                VALUE 'B'.
  4325             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4326                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4327                                           'M' '4' '5' '9' '2'.
  4328                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4329                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4330                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4331                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4332                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4333                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4334                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4335                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4336                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4337                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4338                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4339                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4340                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4341             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4342                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4343                                           'M' '4' '5' '9' '2'.
  4344                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4345                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4346                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  81
* EL050.cbl
  4347                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4348                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4349                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4350                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4351                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4352                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4353                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4354                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4355                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4356                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4357             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4358             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4359             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4360             20  PB-CI-MEMBER-NO          PIC X(12).
  4361             20  PB-CI-INT-CODE           PIC X.
  4362                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4363                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4364             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4365             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4366             20  PB-CI-COMP-EXCP-SW       PIC X.
  4367                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4368                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4369             20  PB-CI-ENTRY-STATUS       PIC X.
  4370             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4371             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4372             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4373             20  PB-CI-DEATH-DT           PIC XX.
  4374             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4375             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4376             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4377             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4378             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4379             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4380             20  PB-CI-ENTRY-DT              PIC XX.
  4381             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4382             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4383             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4384             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4385             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4386             20  PB-CI-OLD-LOF               PIC XXX.
  4387*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4388             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4389             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4390             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4391             20  PB-CI-INDV-GRP-CD           PIC X.
  4392             20  PB-CI-BENEFICIARY-NAME.
  4393                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4394                 24  FILLER                  PIC X(15).
  4395             20  PB-CI-NOTE-SW               PIC X.
  4396             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4397             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4398             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4399             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4400             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4401             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4402             20  PB-CI-FIRST-NAME            PIC X(10).
  4403             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4404
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  82
* EL050.cbl
  4405         16  FILLER                       PIC X(13).
  4406*032306  16  FILLER                       PIC X(27).
  4407*        16  FILLER                       PIC X(46).
  4408
  4409     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4410         16  FILLER                       PIC X(10).
  4411         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4412         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4413         16  PB-M-INSURED-MID-INIT        PIC X.
  4414         16  PB-M-INSURED-AGE             PIC 99.
  4415         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4416         16  PB-M-INSURED-SEX             PIC X.
  4417         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4418         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4419         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4420         16  PB-M-INSURED-CITY-STATE.
  4421             20  PB-M-INSURED-CITY        PIC X(28).
  4422             20  PB-M-INSURED-STATE       PIC XX.
  4423         16  PB-M-INSURED-ZIP-CODE.
  4424             20  PB-M-INSURED-ZIP-PRIME.
  4425                 24  PB-M-INSURED-ZIP-1   PIC X.
  4426                     88  PB-M-CANADIAN-POST-CODE
  4427                                             VALUE 'A' THRU 'Z'.
  4428                 24  FILLER               PIC X(4).
  4429             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4430         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4431                                        PB-M-INSURED-ZIP-CODE.
  4432             20  PM-M-INS-CAN-POST1       PIC XXX.
  4433             20  PM-M-INS-CAN-POST2       PIC XXX.
  4434             20  FILLER                   PIC XXX.
  4435         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4436         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4437         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4438         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4439         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4440         16  PB-M-CRED-BENE-CITYST.
  4441             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4442             20  PB-M-CRED-BENE-STATE     PIC XX.
  4443         16  FILLER                       PIC X(92).
  4444
  4445     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4446         16  FILLER                       PIC X(10).
  4447         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4448         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4449         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4450         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4451         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4452         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4453         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4454         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4455         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4456         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4457         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4458         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4459         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4460         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4461         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4462         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  83
* EL050.cbl
  4463         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4464         16  PB-ACCOUNT-NAME              PIC X(30).
  4465         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4466         16  PB-REFERENCE                 PIC X(12).
  4467         16  PB-B-RECEIVED-DT             PIC XX.
  4468         16  FILLER                       PIC X(234).
  4469
  4470     12  PB-RECORD-STATUS.
  4471         16  PB-CREDIT-SELECT-DT          PIC XX.
  4472         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4473         16  PB-BILLED-DT                 PIC XX.
  4474         16  PB-BILLING-STATUS            PIC X.
  4475             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4476             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4477             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4478         16  PB-RECORD-BILL               PIC X.
  4479             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4480             88  PB-RECORD-RETURNED           VALUE 'R'.
  4481             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4482             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4483             88  PB-OVERRIDE-AH               VALUE 'A'.
  4484             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4485         16  PB-BATCH-ENTRY               PIC X.
  4486             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4487             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4488             88  PB-REISSUED-CERT             VALUE 'E'.
  4489             88  PB-CASH-CERT                 VALUE 'C'.
  4490             88  PB-MONTHLY-CERT              VALUE 'M'.
  4491             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4492             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4493             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4494         16  PB-FORCE-CODE                PIC X.
  4495             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4496             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4497             88  PB-CANCEL-FORCE              VALUE '8'.
  4498             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4499             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4500             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4501             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4502             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4503             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4504             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4505             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4506         16  PB-FATAL-FLAG                PIC X.
  4507             88  PB-FATAL-ERRORS              VALUE 'X'.
  4508         16  PB-FORCE-ER-CD               PIC X.
  4509             88  PB-FORCE-ERRORS              VALUE 'F'.
  4510             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4511         16  PB-WARN-ER-CD                PIC X.
  4512             88  PB-WARNING-ERRORS            VALUE 'W'.
  4513         16  FILLER                       PIC X.
  4514         16  PB-OUT-BAL-CD                PIC X.
  4515             88  PB-OUT-OF-BAL                VALUE 'O'.
  4516         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4517         16  PB-AH-OVERRIDE-L1            PIC X.
  4518         16  PB-INPUT-DT                  PIC XX.
  4519         16  PB-INPUT-BY                  PIC X(4).
  4520         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  84
* EL050.cbl
  4521         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4522         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4523         16  PB-LF-EARNING-METHOD         PIC X.
  4524         16  PB-AH-EARNING-METHOD         PIC X.
  4525         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4526         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4527         16  PB-REIN-CD                   PIC XXX.
  4528         16  PB-LF-REFUND-TYPE            PIC X.
  4529         16  PB-AH-REFUND-TYPE            PIC X.
  4530         16  PB-ACCT-EFF-DT               PIC XX.
  4531         16  PB-ACCT-EXP-DT               PIC XX.
  4532         16  PB-COMPANY-ID                PIC X(3).
  4533         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4534         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4535         16  PB-SV-CARRIER                PIC X.
  4536         16  PB-SV-GROUPING               PIC X(6).
  4537         16  PB-SV-STATE                  PIC XX.
  4538         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4539         16  PB-GA-BILLING-INFO.
  4540             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4541                                          PIC XX.
  4542         16  PB-SV-REMIT-TO  REDEFINES
  4543             PB-GA-BILLING-INFO           PIC X(10).
  4544         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4545         16  PB-I-LOAN-OFFICER            PIC X(5).
  4546         16  PB-I-VIN                     PIC X(17).
  4547
  4548         16  FILLER                       PIC X(04).
  4549         16  IMNET-BYPASS-SW              PIC X.
  4550
  4551******************************************************************
  4552*                COMMON EDIT ERRORS                              *
  4553******************************************************************
  4554
  4555     12  PB-COMMON-ERRORS.
  4556         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4557                                           PIC S9(4)     COMP.
  4558
  4559******************************************************************
  4560
  4561* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4562*    COPY ELC50W1.
  4563******************************************************************
  4564*                                                                *
  4565*                                                                *
  4566*                             ELC50W1                            *
  4567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4568*                            VMOD=2.004                          *
  4569*                                                                *
  4570*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4571*                                                                *
  4572*                                                                *
  4573******************************************************************
  4574
  4575     12  WK-WORK-AREA.
  4576         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4577         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4578         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  85
* EL050.cbl
  4579         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4580         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4581         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4582         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4583         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4584         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4585         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4586         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4587         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4588         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4589         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4590         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4591         16  WK-CREDIT-EDIT-CONTROLS.
  4592             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4593             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4594             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4595             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4596             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4597             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4598         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4599         16  WK-SAVE-REIN-DATA.
  4600             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4601             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4602             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4603         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4604             88  ENTRY-FROM-EL6311       VALUE '6'.
  4605         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4606         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4607     12  WK-RECORD-ADDRESSES.
  4608         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4609         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4610         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4611         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4612         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4613         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4614         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4615         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4616     12  WK-OVER-SHORT-AREA.
  4617         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4618         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4619         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4620             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4621         16  FILLER                   PIC X(5) VALUE SPACES.
  4622
  4623*    COPY ELCEDITC.
  4624******************************************************************
  4625*                                                                *
  4626*                                                                *
  4627*                            ELCEDITC                            *
  4628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4629*                            VMOD=2.012                          *
  4630*                                                                *
  4631*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4632*                     EL6313, EL050 AND EL517.                   *
  4633*                                                                *
  4634******************************************************************
  4635******************************************************************
  4636*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  86
* EL050.cbl
  4637*
  4638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4639*-----------------------------------------------------------------
  4640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4641* EFFECTIVE    NUMBER
  4642*-----------------------------------------------------------------
  4643* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4644******************************************************************
  4645
  4646     12  EDIT-CRITERIA-DATA.
  4647         16  EC-CO-MONTH-END-DT       PIC XX.
  4648         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4649         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4650         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4651         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4652         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4653         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4654         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4655         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4656         16  EC-CO-REM-TERM-CALC      PIC X.
  4657               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4658               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4659               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4660               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4661
  4662         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4663               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4664               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4665               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4666               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4667               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4668               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4669               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4670               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4671               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4672               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4673
  4674         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4675               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4676               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4677               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4678               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4679               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4680               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4681               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4682               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4683
  4684         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4685                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4686                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4687
  4688         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4689                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4690                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4691                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4692                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4693                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4694                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  87
* EL050.cbl
  4695                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4696                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4697
  4698         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4699               88  EC-BR-REDUCING                   VALUE 'R'.
  4700               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4701
  4702         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4703         16  EC-BR-LF-DESC             PIC X(10).
  4704         16  EC-BR-AH-DESC             PIC X(10).
  4705         16  EC-BR-LF-COMMENT          PIC X(10).
  4706         16  EC-BR-AH-COMMENT          PIC X(10).
  4707
  4708         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4709               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4710               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4711               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4712               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4713
  4714         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4715               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4716               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4717               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4718               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4719
  4720         16  EC-BR-LF-REFUND-CALC      PIC X.
  4721                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4722                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4723                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4724                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4725                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4726                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4727                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4728
  4729         16  EC-BR-AH-REFUND-CALC      PIC X.
  4730                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4731                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4732                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4733                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4734                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4735                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4736                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4737                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4738
  4739         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4740                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4741                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4742                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4743
  4744         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4745                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4746                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4747                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4748
  4749         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4750         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4751         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4752         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  88
* EL050.cbl
  4753
  4754         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4755         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4756                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4757                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4758                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4759                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4760
  4761         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4762               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4763               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4764               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4765               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4766               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4767
  4768         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4769               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4770               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4771               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4772               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4773               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4774
  4775         16  EC-ST-LF-REFUND-CALC      PIC X.
  4776                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4777                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4778                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4779                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4780                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4781                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4782                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4783                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4784
  4785         16  EC-ST-AH-REFUND-CALC      PIC X.
  4786                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4787                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4788                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4789                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4790                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4791                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4792                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4793                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4794
  4795         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4796         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4797         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4798         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4799         16  EC-AM-EXPIRATION-DT       PIC XX.
  4800         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4801         16  EC-AM-CLASS-CD            PIC XX.
  4802         16  EC-AM-LF-DEVIATION        PIC XXX.
  4803         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4804         16  EC-AM-AH-DEVIATION        PIC XXX.
  4805         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4806         16  EC-AM-PHONE-NO            PIC X(10).
  4807
  4808         16  EC-AM-LF-REFUND-CALC      PIC X.
  4809                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4810                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  89
* EL050.cbl
  4811                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4812                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4813                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4814                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4815                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4816
  4817         16  EC-AM-AH-REFUND-CALC      PIC X.
  4818                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4819                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4820                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4821                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4822                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4823                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4824                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4825
  4826         16  EC-AM-BEN-I-G-CD          PIC X.
  4827                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4828                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4829                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4830
  4831         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4832         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4833         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4834         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4836         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4837         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4838         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4839         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4840
  4841         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4842         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4843         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4844         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4845         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4846         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4847         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4848         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4849         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4850         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4851         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4852         16  EC-RT-LF-NSP-ST           PIC XX.
  4853         16  EC-RT-AH-NSP-ST           PIC XX.
  4854         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4855         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4856
  4857         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4858             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4859                                             'M' '5' '9' '2'.
  4860             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4861             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4862             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4863             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4864             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4865             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4866             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4867             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4868             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  90
* EL050.cbl
  4869             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4870
  4871         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4872             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4873                                             'M' '5' '9' '2'.
  4874             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4875             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4876             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4877             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4878             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4879             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4880             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4881             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4882             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4883             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4884
  4885         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4886         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4887         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4888         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4889         16  EC-CM-DEATH-DT            PIC XX.
  4890
  4891*DMD CUSTOM CODING FIELDS BELOW
  4892*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4893         16  EC-BR-DMD-RATING-SW       PIC X.
  4894                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4895                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4896                 88  NO-DMD-RATING               VALUE 'N'.
  4897
  4898         16  EC-NEW-CERT               PIC X(11).
  4899         16  EC-NEW-STATE              PIC XX.
  4900         16  FILLER                    PIC X.
  4901*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4902         16  OVER-SHORT-EDIT-FIELDS.
  4903             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4904             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4905             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4906             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4907             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4908             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4909             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4910             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4911             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4912         16  FILLER                    PIC X(71).
  4913******************************************************************
  4914
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  91
* EL050.cbl
  4916*    COPY ELCDIFRD.
  4917******************************************************************
  4918*                                                                *
  4919*                                                                *
  4920*                            ELCDIFRD.                           *
  4921*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4922*                            VMOD=2.004                          *
  4923*                                                                *
  4924*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4925*                                                                *
  4926******************************************************************
  4927*
  4928  01  WS-DIFFERENCE-CALCULATION.
  4929        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4930        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4931        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4932        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4933        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4934        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4935        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4936        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4937        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4938        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4939        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4940
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  92
* EL050.cbl
  4942****************************************************************
  4943*
  4944* Copyright (c) 2007-2013 Dell Inc.
  4945* All rights reserved.
  4946*
  4947****************************************************************
  4948 01  DFHEIV.
  4949   02  DFHEIV0               PIC X(35).
  4950   02  DFHEIV1               PIC X(08).
  4951   02  DFHEIV2               PIC X(08).
  4952   02  DFHEIV3               PIC X(08).
  4953   02  DFHEIV4               PIC X(06).
  4954   02  DFHEIV5               PIC X(04).
  4955   02  DFHEIV6               PIC X(04).
  4956   02  DFHEIV7               PIC X(02).
  4957   02  DFHEIV8               PIC X(02).
  4958   02  DFHEIV9               PIC X(01).
  4959   02  DFHEIV10              PIC S9(7) COMP-3.
  4960   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4961   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4962   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4963   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4964   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4965   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4966   02  DFHEIV17              PIC X(04).
  4967   02  DFHEIV18              PIC X(04).
  4968   02  DFHEIV19              PIC X(04).
  4969   02  DFHEIV20              USAGE IS POINTER.
  4970   02  DFHEIV21              USAGE IS POINTER.
  4971   02  DFHEIV22              USAGE IS POINTER.
  4972   02  DFHEIV23              USAGE IS POINTER.
  4973   02  DFHEIV24              USAGE IS POINTER.
  4974   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4975   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4976   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4977   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4978   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4979   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4980   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4981   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4982   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4983   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4984   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4985   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4986   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4987   02  FILLER                PIC X(02).
  4988   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4989   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4990   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4991   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4992   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4993   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4994   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4995 LINKAGE  SECTION.
  4996*****************************************************************
  4997*                                                               *
  4998* Copyright (c) 2007-2013 Dell Inc.                             *
  4999* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  93
* EL050.cbl
  5000*                                                               *
  5001*****************************************************************
  5002 01  dfheiblk.
  5003     02  eibtime          pic s9(7) comp-3.
  5004     02  eibdate          pic s9(7) comp-3.
  5005     02  eibtrnid         pic x(4).
  5006     02  eibtaskn         pic s9(7) comp-3.
  5007     02  eibtrmid         pic x(4).
  5008     02  dfheigdi         pic s9(4) comp.
  5009     02  eibcposn         pic s9(4) comp.
  5010     02  eibcalen         pic s9(4) comp.
  5011     02  eibaid           pic x(1).
  5012     02  eibfiller1       pic x(1).
  5013     02  eibfn            pic x(2).
  5014     02  eibfiller2       pic x(2).
  5015     02  eibrcode         pic x(6).
  5016     02  eibfiller3       pic x(2).
  5017     02  eibds            pic x(8).
  5018     02  eibreqid         pic x(8).
  5019     02  eibrsrce         pic x(8).
  5020     02  eibsync          pic x(1).
  5021     02  eibfree          pic x(1).
  5022     02  eibrecv          pic x(1).
  5023     02  eibsend          pic x(1).
  5024     02  eibatt           pic x(1).
  5025     02  eibeoc           pic x(1).
  5026     02  eibfmh           pic x(1).
  5027     02  eibcompl         pic x(1).
  5028     02  eibsig           pic x(1).
  5029     02  eibconf          pic x(1).
  5030     02  eiberr           pic x(1).
  5031     02  eibrldbk         pic x(1).
  5032     02  eiberrcd         pic x(4).
  5033     02  eibsynrb         pic x(1).
  5034     02  eibnodat         pic x(1).
  5035     02  eibfiller5       pic x(2).
  5036     02  eibresp          pic s9(8) comp.
  5037     02  eibresp2         pic s9(8) comp.
  5038     02  dfheigdj         pic s9(4) comp.
  5039     02  dfheigdk         pic s9(4) comp.
  5040
  5041 01  DFHCOMMAREA                   PIC X(1036).
  5042
  5043*01 PARMLIST .
  5044*    02  FILLER                    PIC S9(8)   COMP.
  5045*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5046*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5047*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5048*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5049*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5050*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5051*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5052
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  94
* EL050.cbl
  5054*    COPY ELCCNTL.
  5055******************************************************************
  5056*                                                                *
  5057*                                                                *
  5058*                            ELCCNTL.                            *
  5059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5060*                            VMOD=2.059                          *
  5061*                                                                *
  5062*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5063*                                                                *
  5064*   FILE TYPE = VSAM,KSDS                                        *
  5065*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5066*                                                                *
  5067*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5068*       ALTERNATE INDEX = NONE                                   *
  5069*                                                                *
  5070*   LOG = YES                                                    *
  5071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5072******************************************************************
  5073*                   C H A N G E   L O G
  5074*
  5075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5076*-----------------------------------------------------------------
  5077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5078* EFFECTIVE    NUMBER
  5079*-----------------------------------------------------------------
  5080* 082503                   PEMA  ADD BENEFIT GROUP
  5081* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5082* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5083* 092705    2005050300006  PEMA  ADD SPP LEASES
  5084* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5085* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5086* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5087* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5088* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5089* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5090* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5091* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5092* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5093* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5094******************************************************************
  5095*
  5096 01  CONTROL-FILE.
  5097     12  CF-RECORD-ID                       PIC XX.
  5098         88  VALID-CF-ID                        VALUE 'CF'.
  5099
  5100     12  CF-CONTROL-PRIMARY.
  5101         16  CF-COMPANY-ID                  PIC XXX.
  5102         16  CF-RECORD-TYPE                 PIC X.
  5103             88  CF-COMPANY-MASTER              VALUE '1'.
  5104             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5105             88  CF-STATE-MASTER                VALUE '3'.
  5106             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5107             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5108             88  CF-CARRIER-MASTER              VALUE '6'.
  5109             88  CF-MORTALITY-MASTER            VALUE '7'.
  5110             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5111             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  95
* EL050.cbl
  5112             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5113             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5114             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5115             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5116             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5117             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5118             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5119             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5120             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5121         16  CF-ACCESS-CD-GENL              PIC X(4).
  5122         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5123             20  CF-PROCESSOR               PIC X(4).
  5124         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5125             20  CF-STATE-CODE              PIC XX.
  5126             20  FILLER                     PIC XX.
  5127         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5128             20  FILLER                     PIC XX.
  5129             20  CF-HI-BEN-IN-REC           PIC XX.
  5130         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5131             20  FILLER                     PIC XXX.
  5132             20  CF-CARRIER-CNTL            PIC X.
  5133         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5134             20  FILLER                     PIC XX.
  5135             20  CF-HI-TYPE-IN-REC          PIC 99.
  5136         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5137             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5138                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5139             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5140             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5141         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5142             20  FILLER                     PIC X.
  5143             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5144         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5145             20  FILLER                     PIC XX.
  5146             20  CF-MORTGAGE-PLAN           PIC XX.
  5147         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5148
  5149     12  CF-LAST-MAINT-DT                   PIC XX.
  5150     12  CF-LAST-MAINT-BY                   PIC X(4).
  5151     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5152
  5153     12  CF-RECORD-BODY                     PIC X(728).
  5154
  5155
  5156****************************************************************
  5157*             COMPANY MASTER RECORD                            *
  5158****************************************************************
  5159
  5160     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5161         16  CF-COMPANY-ADDRESS.
  5162             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5163             20  CF-CL-IN-CARE-OF           PIC X(30).
  5164             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5165             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5166             20  CF-CL-CITY-STATE           PIC X(30).
  5167             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5168             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5169         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  96
* EL050.cbl
  5170         16  CF-COMPANY-PASSWORD            PIC X(8).
  5171         16  CF-SECURITY-OPTION             PIC X.
  5172             88  ALL-SECURITY                   VALUE '1'.
  5173             88  COMPANY-VERIFY                 VALUE '2'.
  5174             88  PROCESSOR-VERIFY               VALUE '3'.
  5175             88  NO-SECURITY                    VALUE '4'.
  5176             88  ALL-BUT-TERM                   VALUE '5'.
  5177         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5178             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5179         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5180             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5181         16  CF-INFORCE-LOCATION            PIC X.
  5182             88  CERTS-ARE-ONLINE               VALUE '1'.
  5183             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5184             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5185         16  CF-LOWER-CASE-LETTERS          PIC X.
  5186         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5187             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5188             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5189             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5190             88  CF-ACCNT-CNTL                  VALUE '3'.
  5191             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5192
  5193         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5194         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5195
  5196         16  CF-LGX-CREDIT-USER             PIC X.
  5197             88  CO-IS-NOT-USER                 VALUE 'N'.
  5198             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5199
  5200         16 CF-CREDIT-CALC-CODES.
  5201             20  CF-CR-REM-TERM-CALC PIC X.
  5202               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5203               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5204               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5205               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5206               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5207               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5208               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5209             20  CF-CR-R78-METHOD           PIC X.
  5210               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5211               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5212
  5213         16  CF-CLAIM-CONTROL-COUNTS.
  5214             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5215                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5216
  5217             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5218                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5219
  5220             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5221                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5222
  5223             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5224                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5225
  5226         16  CF-CURRENT-MONTH-END           PIC XX.
  5227
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  97
* EL050.cbl
  5228         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5229             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5230             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5231             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5232             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5233                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5234                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5235             20  CF-CO-PREM-REJECT-SW       PIC X.
  5236                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5237                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5238             20  CF-CO-REF-REJECT-SW        PIC X.
  5239                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5240                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5241
  5242         16  CF-CO-REPORTING-DT             PIC XX.
  5243         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5244         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5245           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5246           88  CF-CO-MONTH-END                  VALUE '1'.
  5247
  5248         16  CF-LGX-CLAIM-USER              PIC X.
  5249             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5250             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5251
  5252         16  CF-CREDIT-EDIT-CONTROLS.
  5253             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5254             20  CF-MIN-AGE                 PIC 99.
  5255             20  CF-DEFAULT-AGE             PIC 99.
  5256             20  CF-MIN-TERM                PIC S999      COMP-3.
  5257             20  CF-MAX-TERM                PIC S999      COMP-3.
  5258             20  CF-DEFAULT-SEX             PIC X.
  5259             20  CF-JOINT-AGE-INPUT         PIC X.
  5260                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5261             20  CF-BIRTH-DATE-INPUT        PIC X.
  5262                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5263             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5264                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5265                 88  CF-ZERO-CARRIER            VALUE '1'.
  5266                 88  CF-ZERO-GROUPING           VALUE '2'.
  5267                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5268             20  CF-EDIT-SW                 PIC X.
  5269                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5270             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5271             20  CF-CR-PR-METHOD            PIC X.
  5272               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5273               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5274             20  FILLER                     PIC X.
  5275
  5276         16  CF-CREDIT-MISC-CONTROLS.
  5277             20  CF-REIN-TABLE-SW           PIC X.
  5278                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5279             20  CF-COMP-TABLE-SW           PIC X.
  5280                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5281             20  CF-EXPERIENCE-RETENTION-AGE
  5282                                            PIC S9        COMP-3.
  5283             20  CF-CONVERSION-DT           PIC XX.
  5284             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5285             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  98
* EL050.cbl
  5286                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5287                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5288
  5289             20  CF-CR-CHECK-NO-CONTROL.
  5290                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5291                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5292                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5293                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5294                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5295                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5296
  5297                 24  CF-CR-CHECK-COUNT       REDEFINES
  5298                     CF-CR-CHECK-COUNTER      PIC X(4).
  5299
  5300                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5301                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5302
  5303                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5304                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5305                 24  CF-MAIL-PROCESSING       PIC X.
  5306                     88  MAIL-PROCESSING          VALUE 'Y'.
  5307
  5308         16  CF-MISC-SYSTEM-CONTROL.
  5309             20  CF-SYSTEM-C                 PIC X.
  5310                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5311             20  CF-SYSTEM-D                 PIC X.
  5312                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5313             20  CF-SOC-SEC-NO-SW            PIC X.
  5314                 88  SOC-SEC-NO-USED             VALUE '1'.
  5315             20  CF-MEMBER-NO-SW             PIC X.
  5316                 88  MEMBER-NO-USED              VALUE '1'.
  5317             20  CF-TAX-ID-NUMBER            PIC X(11).
  5318             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5319             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5320                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5321                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5322                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5323                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5324             20  CF-SYSTEM-E                 PIC X.
  5325                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5326
  5327         16  CF-LGX-LIFE-USER               PIC X.
  5328             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5329             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5330
  5331         16  CF-CR-MONTH-END-DT             PIC XX.
  5332
  5333         16  CF-FILE-MAINT-DATES.
  5334             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5335                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5336             20  CF-LAST-BATCH       REDEFINES
  5337                 CF-LAST-BATCH-NO               PIC X(4).
  5338             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5339             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5340             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5341             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5342             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5343             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  99
* EL050.cbl
  5344             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5345             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5346             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5347             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5348
  5349         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5350         16  FILLER                         PIC X.
  5351
  5352         16  CF-ALT-MORT-CODE               PIC X(4).
  5353         16  CF-MEMBER-CAPTION              PIC X(10).
  5354
  5355         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5356             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5357             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5358             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5359             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5360             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5361
  5362         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5363
  5364         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5365         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5366         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5367         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5368
  5369         16  CF-AH-OVERRIDE-L1              PIC X.
  5370         16  CF-AH-OVERRIDE-L2              PIC XX.
  5371         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5372         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5373
  5374         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5375         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5376
  5377         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5378         16  CF-AR-LAST-EL860-DT            PIC XX.
  5379         16  CF-MP-MONTH-END-DT             PIC XX.
  5380
  5381         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5382         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5383             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5384
  5385         16  CF-AR-MONTH-END-DT             PIC XX.
  5386
  5387         16  CF-CRDTCRD-USER                PIC X.
  5388             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5389             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5390
  5391         16  CF-CC-MONTH-END-DT             PIC XX.
  5392
  5393         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5394
  5395         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5396             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5397             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5398             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5399         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5400         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5401         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 100
* EL050.cbl
  5402         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5403             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5404             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5405         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5406         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5407         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5408             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5409         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5410
  5411         16  CF-CL-ZIP-CODE.
  5412             20  CF-CL-ZIP-PRIME.
  5413                 24  CF-CL-ZIP-1ST          PIC X.
  5414                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5415                 24  FILLER                 PIC X(4).
  5416             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5417         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5418             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5419             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5420             20  FILLER                     PIC XXX.
  5421
  5422         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5423         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5424         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5425         16  CF-CO-OPTION-START-DATE        PIC XX.
  5426         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5427           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5428                                                      '3' '4'.
  5429           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5430           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5431           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5432           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5433           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5434           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5435
  5436         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5437
  5438         16  CF-PAYMENT-APPROVAL-LEVELS.
  5439             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5440             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5441             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5442             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5443             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5444             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5445
  5446         16  CF-END-USER-REPORTING-USER     PIC X.
  5447             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5448             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5451             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5452             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5453
  5454         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5455
  5456         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5457         16  FILLER                         PIC X.
  5458
  5459         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 101
* EL050.cbl
  5460             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5461             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5462             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5463
  5464         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5465
  5466         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5467             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5468             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5469
  5470         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5471             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5472             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5473
  5474         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5475
  5476         16  CF-CO-ACH-ID-CODE              PIC  X.
  5477             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5478             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5479             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5480         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5481         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5482         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5483         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5484         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5485         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5486         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5487         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5488         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5489                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5490         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5491                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5492
  5493         16  CF-CO-OVER-SHORT.
  5494             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5495             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5496
  5497*         16  FILLER                         PIC X(102).
  5498         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5499             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5500             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5501
  5502         16  CF-AH-APPROVAL-DAYS.
  5503             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5504             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5505             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5506             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5507
  5508         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5509
  5510         16  CF-APPROV-LEV-5.
  5511             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5512             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5513             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5514
  5515         16  FILLER                         PIC X(68).
  5516****************************************************************
  5517*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 102
* EL050.cbl
  5518****************************************************************
  5519
  5520     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5521         16  CF-PROCESSOR-NAME              PIC X(30).
  5522         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5523         16  CF-PROCESSOR-TITLE             PIC X(26).
  5524         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5525                 88  MESSAGE-YES                VALUE 'Y'.
  5526                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5527
  5528*****************************************************
  5529****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5530****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5531****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5532****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5533*****************************************************
  5534
  5535         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5536             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5537             20  CF-APPLICATION-FORCE       PIC X.
  5538             20  CF-INDIVIDUAL-APP.
  5539                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5540                     28  CF-BROWSE-APP      PIC X.
  5541                     28  CF-UPDATE-APP      PIC X.
  5542
  5543         16  CF-CURRENT-TERM-ON             PIC X(4).
  5544         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5545             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5546             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5547             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5548             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5549             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5550             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5551             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5552         16  CF-PROCESSOR-CARRIER           PIC X.
  5553             88  NO-CARRIER-SECURITY            VALUE ' '.
  5554         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5555             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5556         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5557             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5558         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5559             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5560
  5561         16  CF-PROC-SYS-ACCESS-SW.
  5562             20  CF-PROC-CREDIT-CLAIMS-SW.
  5563                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5564                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5565                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5566                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5567             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5568                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5569                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5570             20  CF-PROC-LIFE-GNRLDGR-SW.
  5571                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5572                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5573                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5574                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5575             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 103
* EL050.cbl
  5576                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5577                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5578         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5579             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5580             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5581         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5582
  5583         16  CF-APPROVAL-LEVEL                  PIC X.
  5584             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5585             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5586             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5587             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5588             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5589
  5590         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5591
  5592         16  CF-LANGUAGE-TYPE                   PIC X.
  5593             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5594             88  CF-LANG-IS-FR                      VALUE 'F'.
  5595
  5596         16  CF-CSR-IND                         PIC X.
  5597         16  FILLER                             PIC X(239).
  5598
  5599****************************************************************
  5600*             PROCESSOR/REMINDERS RECORD                       *
  5601****************************************************************
  5602
  5603     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5604         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5605             20  CF-START-REMIND-DT         PIC XX.
  5606             20  CF-END-REMIND-DT           PIC XX.
  5607             20  CF-REMINDER-TEXT           PIC X(50).
  5608         16  FILLER                         PIC X(296).
  5609
  5610
  5611****************************************************************
  5612*             STATE MASTER RECORD                              *
  5613****************************************************************
  5614
  5615     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5616         16  CF-STATE-ABBREVIATION          PIC XX.
  5617         16  CF-STATE-NAME                  PIC X(25).
  5618         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5619         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5620             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5621             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5622             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5623             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5624                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5625                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5626             20  CF-ST-PREM-REJECT-SW       PIC X.
  5627                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5628                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5629             20  CF-ST-REF-REJECT-SW        PIC X.
  5630                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5631                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5632         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5633         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 104
* EL050.cbl
  5634         16  CF-ST-REFUND-RULES.
  5635             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5636             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5637             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5638         16  CF-ST-FST-PMT-EXTENSION.
  5639             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5640             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5641                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5642                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5643                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5644                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5645         16  CF-ST-STATE-CALL.
  5646             20  CF-ST-CALL-UNEARNED        PIC X.
  5647             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5648             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5649         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5650             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5651             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5652         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5653         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5654         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5655         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5656         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5657         16  FILLER                         PIC X.
  5658         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5659             20  CF-ST-BENEFIT-CD           PIC XX.
  5660             20  CF-ST-BENEFIT-KIND         PIC X.
  5661                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5662                 88  CF-ST-AH-KIND              VALUE 'A'.
  5663             20  CF-ST-REM-TERM-CALC        PIC X.
  5664                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5665                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5666                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5667                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5668                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5669                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5670                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5671                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5672
  5673             20  CF-ST-REFUND-CALC          PIC X.
  5674                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5675                 88  ST-REFD-BY-R78             VALUE '1'.
  5676                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5678                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-REFD-UTAH               VALUE '7'.
  5682                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5683                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5684                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5685
  5686             20  CF-ST-EARNING-CALC         PIC X.
  5687                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5688                 88  ST-EARN-BY-R78             VALUE '1'.
  5689                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5690                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5691                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 105
* EL050.cbl
  5692                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5693                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5694                 88  ST-EARN-MEAN               VALUE '8'.
  5695                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5696
  5697             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5698                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5699                 88  ST-OVRD-BY-R78             VALUE '1'.
  5700                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5701                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5702                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5703                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5704                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5705                 88  ST-OVRD-MEAN               VALUE '8'.
  5706                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5707             20  cf-st-extra-periods        pic 9.
  5708*            20  FILLER                     PIC X.
  5709
  5710         16  CF-ST-COMMISSION-CAPS.
  5711             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5712             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5713             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5714             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5715         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5716                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5717
  5718         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5719
  5720         16  CF-ST-STATUTORY-INTEREST.
  5721             20  CF-ST-STAT-DATE-FROM       PIC X.
  5722                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5723                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5724             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5725             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5726             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5727             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5728             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5729
  5730         16  CF-ST-OVER-SHORT.
  5731             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5732             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5733
  5734         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5735
  5736         16  CF-ST-RT-CALC                  PIC X.
  5737
  5738         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5739         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5740         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5741         16  CF-ST-RF-LR-CALC               PIC X.
  5742         16  CF-ST-RF-LL-CALC               PIC X.
  5743         16  CF-ST-RF-LN-CALC               PIC X.
  5744         16  CF-ST-RF-AH-CALC               PIC X.
  5745         16  CF-ST-RF-CP-CALC               PIC X.
  5746*        16  FILLER                         PIC X(206).
  5747*CIDMOD         16  FILLER                         PIC X(192).
  5748         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5749             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 106
* EL050.cbl
  5750         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5751         16  CF-ST-VFY-2ND-BENE             PIC X.
  5752         16  CF-ST-CAUSAL-STATE             PIC X.
  5753         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5754         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5755         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5756             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5757         16  CF-ST-NET-ONLY-STATE           PIC X.
  5758             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5759         16  FILLER                         PIC X(181).
  5760
  5761****************************************************************
  5762*             BENEFIT MASTER RECORD                            *
  5763****************************************************************
  5764
  5765     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5766         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5767             20  CF-BENEFIT-CODE            PIC XX.
  5768             20  CF-BENEFIT-NUMERIC  REDEFINES
  5769                 CF-BENEFIT-CODE            PIC XX.
  5770             20  CF-BENEFIT-ALPHA           PIC XXX.
  5771             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5772             20  CF-BENEFIT-COMMENT         PIC X(10).
  5773
  5774             20  CF-LF-COVERAGE-TYPE        PIC X.
  5775                 88  CF-REDUCING                VALUE 'R'.
  5776                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5777
  5778             20  CF-SPECIAL-CALC-CD         PIC X.
  5779                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5780                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5781                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5782                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5783                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5784                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5785                 88  CF-FARM-PLAN               VALUE 'F'.
  5786                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5787                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5788                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5789                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5790                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5791                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5792                 88  CF-PRUDENTIAL              VALUE 'P'.
  5793                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5794                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5795                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5796                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5797                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5798                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5799
  5800             20  CF-JOINT-INDICATOR         PIC X.
  5801                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5802
  5803*            20  FILLER                     PIC X(12).
  5804             20  cf-maximum-benefits        pic s999 comp-3.
  5805             20  FILLER                     PIC X(09).
  5806             20  CF-BENEFIT-CATEGORY        PIC X.
  5807             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 107
* EL050.cbl
  5808
  5809             20  CF-CO-REM-TERM-CALC        PIC X.
  5810                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5811                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5812                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5813                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5814                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5815
  5816             20  CF-CO-EARNINGS-CALC        PIC X.
  5817                 88  CO-EARN-BY-R78             VALUE '1'.
  5818                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5820                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5821                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5823                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5824                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-REFUND-CALC          PIC X.
  5827                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5828                 88  CO-REFD-BY-R78             VALUE '1'.
  5829                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5830                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5831                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5832                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5833                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5834                 88  CO-REFD-MEAN               VALUE '8'.
  5835                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5836                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5837                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5838
  5839             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5840                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5841                 88  CO-OVRD-BY-R78             VALUE '1'.
  5842                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5843                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5844                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5845                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5846                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5847                 88  CO-OVRD-MEAN               VALUE '8'.
  5848                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5849
  5850             20  CF-CO-BEN-I-G-CD           PIC X.
  5851                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5852                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5853                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5854
  5855         16  FILLER                         PIC X(304).
  5856
  5857
  5858****************************************************************
  5859*             CARRIER MASTER RECORD                            *
  5860****************************************************************
  5861
  5862     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5863         16  CF-ADDRESS-DATA.
  5864             20  CF-MAIL-TO-NAME            PIC X(30).
  5865             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 108
* EL050.cbl
  5866             20  CF-ADDRESS-LINE-1          PIC X(30).
  5867             20  CF-ADDRESS-LINE-2          PIC X(30).
  5868             20  CF-CITY-STATE              PIC X(30).
  5869             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5870             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5871
  5872         16  CF-CLAIM-NO-CONTROL.
  5873             20  CF-CLAIM-NO-METHOD         PIC X.
  5874                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5875                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5876                 88  CLAIM-NO-SEQ               VALUE '3'.
  5877                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5878             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5879                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5880                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5881                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5882
  5883         16  CF-CHECK-NO-CONTROL.
  5884             20  CF-CHECK-NO-METHOD         PIC X.
  5885                 88  CHECK-NO-MANUAL            VALUE '1'.
  5886                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5887                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5888                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5889             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5890                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5891
  5892         16  CF-DOMICILE-STATE              PIC XX.
  5893
  5894         16  CF-EXPENSE-CONTROLS.
  5895             20  CF-EXPENSE-METHOD          PIC X.
  5896                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5897                 88  DOLLARS-PER-PMT            VALUE '2'.
  5898                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5899                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5900             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5901             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5902
  5903         16  CF-CORRESPONDENCE-CONTROL.
  5904             20  CF-LETTER-RESEND-OPT       PIC X.
  5905                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5906                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5907             20  FILLER                     PIC X(4).
  5908
  5909         16  CF-RESERVE-CONTROLS.
  5910             20  CF-MANUAL-SW               PIC X.
  5911                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5912             20  CF-FUTURE-SW               PIC X.
  5913                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5914             20  CF-PTC-SW                  PIC X.
  5915                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5916             20  CF-IBNR-SW                 PIC X.
  5917                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5918             20  CF-PTC-LF-SW               PIC X.
  5919                 88  CF-LF-PTC-USED             VALUE '1'.
  5920             20  CF-CDT-ACCESS-METHOD       PIC X.
  5921                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5922                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5923                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 109
* EL050.cbl
  5924             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5925
  5926         16  CF-CLAIM-CALC-METHOD           PIC X.
  5927             88  360-PLUS-MONTHS                VALUE '1'.
  5928             88  365-PLUS-MONTHS                VALUE '2'.
  5929             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5930             88  360-DAILY                      VALUE '4'.
  5931             88  365-DAILY                      VALUE '5'.
  5932
  5933         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5934         16  FILLER                         PIC X(11).
  5935
  5936         16  CF-LIMIT-AMOUNTS.
  5937             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5938             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5939             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5940             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5941             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5942             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5943             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5944             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5945             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5946             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5947
  5948         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5949         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5950         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5951
  5952         16  CF-ZIP-CODE.
  5953             20  CF-ZIP-PRIME.
  5954                 24  CF-ZIP-1ST             PIC X.
  5955                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5956                 24  FILLER                 PIC X(4).
  5957             20  CF-ZIP-PLUS4               PIC X(4).
  5958         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5959             20  CF-CAN-POSTAL-1            PIC XXX.
  5960             20  CF-CAN-POSTAL-2            PIC XXX.
  5961             20  FILLER                     PIC XXX.
  5962
  5963         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5964         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5965         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5966
  5967         16  CF-RATING-SWITCH               PIC X.
  5968             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5969             88  CF-NO-RATING                   VALUE 'N'.
  5970
  5971         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5972
  5973         16  CF-CARRIER-OVER-SHORT.
  5974             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5975             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5976
  5977         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5978         16  CF-SECPAY-SWITCH               PIC X.
  5979             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5980             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5981         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 110
* EL050.cbl
  5982         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5983         16  FILLER                         PIC X(444).
  5984*        16  FILLER                         PIC X(452).
  5985
  5986
  5987****************************************************************
  5988*             MORTALITY MASTER RECORD                          *
  5989****************************************************************
  5990
  5991     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5992         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5993                                INDEXED BY CF-MORT-NDX.
  5994             20  CF-MORT-TABLE              PIC X(5).
  5995             20  CF-MORT-TABLE-TYPE         PIC X.
  5996                 88  CF-MORT-JOINT              VALUE 'J'.
  5997                 88  CF-MORT-SINGLE             VALUE 'S'.
  5998                 88  CF-MORT-COMBINED           VALUE 'C'.
  5999                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6000                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6001             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6002             20  CF-MORT-AGE-METHOD         PIC XX.
  6003                 88  CF-AGE-LAST                VALUE 'AL'.
  6004                 88  CF-AGE-NEAR                VALUE 'AN'.
  6005             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6006             20  CF-MORT-ADJUSTMENT-DIRECTION
  6007                                            PIC X.
  6008                 88  CF-MINUS                   VALUE '-'.
  6009                 88  CF-PLUS                    VALUE '+'.
  6010             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6011             20  CF-MORT-JOINT-CODE         PIC X.
  6012                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6013             20  CF-MORT-PC-Q               PIC X.
  6014                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6015             20  CF-MORT-TABLE-CODE         PIC X(4).
  6016             20  CF-MORT-COMMENTS           PIC X(15).
  6017             20  FILLER                     PIC X(14).
  6018
  6019         16  FILLER                         PIC X(251).
  6020
  6021
  6022****************************************************************
  6023*             BUSSINESS TYPE MASTER RECORD                     *
  6024****************************************************************
  6025
  6026     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6027* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6028* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6029* AND RECORD 05 IS TYPES 81-99
  6030         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6031             20  CF-BUSINESS-TITLE          PIC  X(19).
  6032             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6033                                            PIC S9V9(4) COMP-3.
  6034             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6035             20  FILLER                     PIC  X.
  6036         16  FILLER                         PIC  X(248).
  6037
  6038
  6039****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 111
* EL050.cbl
  6040*             TERMINAL MASTER RECORD                           *
  6041****************************************************************
  6042
  6043     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6044
  6045         16  CF-COMPANY-TERMINALS.
  6046             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6047                                  PIC X(4).
  6048         16  FILLER               PIC X(248).
  6049
  6050
  6051****************************************************************
  6052*             LIFE EDIT MASTER RECORD                          *
  6053****************************************************************
  6054
  6055     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6056         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6057             20  CF-LIFE-CODE-IN            PIC XX.
  6058             20  CF-LIFE-CODE-OUT           PIC XX.
  6059         16  FILLER                         PIC X(248).
  6060
  6061
  6062****************************************************************
  6063*             AH EDIT MASTER RECORD                            *
  6064****************************************************************
  6065
  6066     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6067         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6068             20  CF-AH-CODE-IN              PIC XXX.
  6069             20  CF-AH-CODE-OUT             PIC XX.
  6070         16  FILLER                         PIC X(248).
  6071
  6072
  6073****************************************************************
  6074*             CREDIBILITY TABLES                               *
  6075****************************************************************
  6076
  6077     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6078         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6079                             INDEXED BY CF-CRDB-NDX.
  6080             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6081             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6082             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6083         16  FILLER                         PIC  X(332).
  6084
  6085
  6086****************************************************************
  6087*             REPORT CUSTOMIZATION RECORD                      *
  6088****************************************************************
  6089
  6090     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6091         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6092             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6093             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6094             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6095**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6096****       A T-TRANSFER.                                   ****
  6097             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 112
* EL050.cbl
  6098
  6099         16  FILLER                         PIC XX.
  6100
  6101         16  CF-CARRIER-CNTL-OPT.
  6102             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6103                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6105             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6106                                            PIC X.
  6107         16  CF-GROUP-CNTL-OPT.
  6108             20  CF-GROUP-OPT-SEQ           PIC 9.
  6109                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6110                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6111             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6112                                            PIC X(6).
  6113         16  CF-STATE-CNTL-OPT.
  6114             20  CF-STATE-OPT-SEQ           PIC 9.
  6115                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6116                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6117             20  CF-STATE-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-ACCOUNT-CNTL-OPT.
  6120             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6121                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6123             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-BUS-TYP-CNTL-OPT.
  6126             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6127                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6129             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6130                                            PIC XX.
  6131         16  CF-LF-TYP-CNTL-OPT.
  6132             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6133                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6134                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6135             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6136                                            PIC XX.
  6137         16  CF-AH-TYP-CNTL-OPT.
  6138             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6139                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6140                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6141             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6142                                            PIC XX.
  6143         16  CF-REPTCD1-CNTL-OPT.
  6144             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6145                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6146                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6147             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-REPTCD2-CNTL-OPT.
  6150             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6151                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6152                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6153             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 113
* EL050.cbl
  6156             20  CF-USER1-OPT-SEQ           PIC 9.
  6157                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER1-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-USER2-CNTL-OPT.
  6162             20  CF-USER2-OPT-SEQ           PIC 9.
  6163                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6165             20  CF-USER2-SELECT OCCURS 3 TIMES
  6166                                            PIC X(10).
  6167         16  CF-USER3-CNTL-OPT.
  6168             20  CF-USER3-OPT-SEQ           PIC 9.
  6169                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6170                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6171             20  CF-USER3-SELECT OCCURS 3 TIMES
  6172                                            PIC X(10).
  6173         16  CF-USER4-CNTL-OPT.
  6174             20  CF-USER4-OPT-SEQ           PIC 9.
  6175                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6176                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6177             20  CF-USER4-SELECT OCCURS 3 TIMES
  6178                                            PIC X(10).
  6179         16  CF-USER5-CNTL-OPT.
  6180             20  CF-USER5-OPT-SEQ           PIC 9.
  6181                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6183             20  CF-USER5-SELECT OCCURS 3 TIMES
  6184                                            PIC X(10).
  6185         16  CF-REINS-CNTL-OPT.
  6186             20  CF-REINS-OPT-SEQ           PIC 9.
  6187                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6188                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6189             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6190                 24  CF-REINS-PRIME         PIC XXX.
  6191                 24  CF-REINS-SUB           PIC XXX.
  6192
  6193         16  CF-AGENT-CNTL-OPT.
  6194             20  CF-AGENT-OPT-SEQ           PIC 9.
  6195                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6196                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6197             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6198                                            PIC X(10).
  6199
  6200         16  FILLER                         PIC X(43).
  6201
  6202         16  CF-LOSS-RATIO-SELECT.
  6203             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6204             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6205         16  CF-ENTRY-DATE-SELECT.
  6206             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6207             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6208         16  CF-EFFECTIVE-DATE-SELECT.
  6209             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6210             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6211
  6212         16  CF-EXCEPTION-LIST-IND          PIC X.
  6213             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 114
* EL050.cbl
  6214
  6215         16  FILLER                         PIC X(318).
  6216
  6217****************************************************************
  6218*                  EXCEPTION REPORTING RECORD                  *
  6219****************************************************************
  6220
  6221     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6222         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6223             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6224
  6225         16  CF-COMBINED-LIFE-AH-OPT.
  6226             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6227             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6228             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6229             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6230
  6231         16  CF-LIFE-OPT.
  6232             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6233             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6234             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6235             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6236             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6237             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6238             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6239             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6240             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6241             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6242
  6243         16  CF-AH-OPT.
  6244             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6245             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6246             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6247             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6248             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6249             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6250             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6251             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6252             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6253             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6254
  6255         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6256             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6257             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6258             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6259
  6260         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6261
  6262         16  FILLER                         PIC X(673).
  6263
  6264
  6265****************************************************************
  6266*             MORTGAGE SYSTEM PLAN RECORD                      *
  6267****************************************************************
  6268
  6269     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6270         16  CF-PLAN-TYPE                   PIC X.
  6271             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 115
* EL050.cbl
  6272             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6273             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6274         16  CF-PLAN-ABBREV                 PIC XXX.
  6275         16  CF-PLAN-DESCRIPT               PIC X(10).
  6276         16  CF-PLAN-NOTES                  PIC X(20).
  6277         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6278         16  CF-PLAN-UNDERWRITING.
  6279             20  CF-PLAN-TERM-DATA.
  6280                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6281                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6282             20  CF-PLAN-AGE-DATA.
  6283                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6284                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6285                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6286             20  CF-PLAN-BENEFIT-DATA.
  6287                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6288                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6289                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6290                                            PIC S9(7)V99  COMP-3.
  6291         16  CF-PLAN-POLICY-FORMS.
  6292             20  CF-POLICY-FORM             PIC X(12).
  6293             20  CF-MASTER-APPLICATION      PIC X(12).
  6294             20  CF-MASTER-POLICY           PIC X(12).
  6295         16  CF-PLAN-RATING.
  6296             20  CF-RATE-CODE               PIC X(5).
  6297             20  CF-SEX-RATING              PIC X.
  6298                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6299                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6300             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6301             20  CF-SUB-STD-TYPE            PIC X.
  6302                 88  CF-PCT-OF-PREM            VALUE '1'.
  6303                 88  CF-PCT-OF-BENE            VALUE '2'.
  6304         16  CF-PLAN-PREM-TOLERANCES.
  6305             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6306             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6307         16  CF-PLAN-PYMT-TOLERANCES.
  6308             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6309             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6310         16  CF-PLAN-MISC-DATA.
  6311             20  FILLER                     PIC X.
  6312             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6313             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6314         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6315         16  CF-PLAN-IND-GRP                PIC X.
  6316             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6317                                                     '1'.
  6318             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6319                                                     '2'.
  6320         16  CF-MIB-SEARCH-SW               PIC X.
  6321             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6322             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6323             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6324             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6325         16  CF-ALPHA-SEARCH-SW             PIC X.
  6326             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6327             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6328             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6329             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 116
* EL050.cbl
  6330             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6331             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6332             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6333             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6334             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6335             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6336                                                     'A' 'B' 'C'
  6337                                                     'X' 'Y' 'Z'.
  6338         16  CF-EFF-DT-RULE-SW              PIC X.
  6339             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6340             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6341             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6342             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6343             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6344         16  FILLER                         PIC X(4).
  6345         16  CF-HEALTH-QUESTIONS            PIC X.
  6346             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6347         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6348         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6349         16  CF-PLAN-SNGL-JNT               PIC X.
  6350             88  CF-COMBINED-PLAN              VALUE 'C'.
  6351             88  CF-JNT-PLAN                   VALUE 'J'.
  6352             88  CF-SNGL-PLAN                  VALUE 'S'.
  6353         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6354         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6355         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6356         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6357         16  CF-RERATE-CNTL                 PIC  X.
  6358             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6359             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6360             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6361             88  CF-AUTO-RECALC                 VALUE '4'.
  6362         16  CF-BENEFIT-TYPE                PIC  X.
  6363             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6364             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6365         16  CF-POLICY-FEE                  PIC S999V99
  6366                                                    COMP-3.
  6367         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6368         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6369         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6370         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6371         16  FILLER                         PIC  X(32).
  6372         16  CF-TERMINATION-FORM            PIC  X(04).
  6373         16  FILLER                         PIC  X(08).
  6374         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6375                                                       COMP-3.
  6376         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6377         16  CF-ISSUE-LETTER                PIC  X(4).
  6378         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6379         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6380             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6381             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6382         16  CF-MP-REFUND-CALC              PIC X.
  6383             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6384             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6385             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6386             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6387             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 117
* EL050.cbl
  6388             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6389             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6390             88  CF-MP-REFD-MEAN                VALUE '8'.
  6391         16  CF-ALT-RATE-CODE               PIC  X(5).
  6392
  6393
  6394         16  FILLER                         PIC X(498).
  6395****************************************************************
  6396*             MORTGAGE COMPANY MASTER RECORD                   *
  6397****************************************************************
  6398
  6399     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6400         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6401         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6402             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6403             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6404             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6405             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6406             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6407
  6408         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6409         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6410         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6411         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6412         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6413
  6414         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6415             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6416         16  CF-MP-RECON-USE-IND            PIC X(1).
  6417             88  CF-MP-USE-RECON             VALUE 'Y'.
  6418         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6419             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6420         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6421             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6422             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6423         16  FILLER                         PIC X(1).
  6424         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6425             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6426         16  CF-MORTG-MIB-VERSION           PIC X.
  6427             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6428             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6429             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6430         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6431             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6432                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6433             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6434                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6435             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6436                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6437             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6438                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6439             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6440                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6441             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6442                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6443         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6444         16  FILLER                         PIC X(7).
  6445         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 118
* EL050.cbl
  6446             20  CF-MORTG-MIB-COMM          PIC X(5).
  6447             20  CF-MORTG-MIB-TERM          PIC X(5).
  6448         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6449             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6450         16  FILLER                         PIC X(03).
  6451         16  CF-MP-CHECK-NO-CONTROL.
  6452             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6453                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6454                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6455                                                ' ' LOW-VALUES.
  6456                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6457                                               VALUE '3'.
  6458         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6459         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6460         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6461             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6462                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6463             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6464                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6465             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6466                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6467             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6468                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6469             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6470                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6471             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6472                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6473         16  CF-MORTG-BILLING-AREA.
  6474             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6475                                            PIC X.
  6476         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6477         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6478         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6479         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6480             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6481             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6482         16  FILLER                         PIC X.
  6483         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6484             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6485             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6486         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6487         16  FILLER                         PIC X(8).
  6488         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6489         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6490         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6491         16  CF-ACH-COMPANY-ID.
  6492             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6493                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6494                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6495                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6496             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6497         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6498             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6499         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6500             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6501             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6502         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6503         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 119
* EL050.cbl
  6504         16  FILLER                         PIC X(536).
  6505
  6506****************************************************************
  6507*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6508****************************************************************
  6509
  6510     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6511         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6512             20  CF-FEMALE-HEIGHT.
  6513                 24  CF-FEMALE-FT           PIC 99.
  6514                 24  CF-FEMALE-IN           PIC 99.
  6515             20  CF-FEMALE-MIN-WT           PIC 999.
  6516             20  CF-FEMALE-MAX-WT           PIC 999.
  6517         16  FILLER                         PIC X(428).
  6518
  6519     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6520         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6521             20  CF-MALE-HEIGHT.
  6522                 24  CF-MALE-FT             PIC 99.
  6523                 24  CF-MALE-IN             PIC 99.
  6524             20  CF-MALE-MIN-WT             PIC 999.
  6525             20  CF-MALE-MAX-WT             PIC 999.
  6526         16  FILLER                         PIC X(428).
  6527******************************************************************
  6528*             AUTOMATIC ACTIVITY RECORD                          *
  6529******************************************************************
  6530     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6531         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6532             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6533             20  CF-SYS-LETTER-ID           PIC X(04).
  6534             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6535             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6536             20  CF-SYS-RESET-SW            PIC X(01).
  6537             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6538             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6539
  6540         16  FILLER                         PIC X(50).
  6541
  6542         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6543             20  CF-USER-ACTIVE-SW          PIC X(01).
  6544             20  CF-USER-LETTER-ID          PIC X(04).
  6545             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6546             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6547             20  CF-USER-RESET-SW           PIC X(01).
  6548             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6549             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6550             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6551
  6552         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 120
* EL050.cbl
  6554*    COPY ERCACCT.
  6555******************************************************************
  6556*                                                                *
  6557*                                                                *
  6558*                            ERCACCT                             *
  6559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6560*                            VMOD=2.031                          *
  6561*                                                                *
  6562*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6563*                                                                *
  6564*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6565*   VSAM ACCOUNT MASTER FILES.                                   *
  6566*                                                                *
  6567*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6568*                                                                *
  6569*   FILE TYPE = VSAM,KSDS                                        *
  6570*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6571*                                                                *
  6572*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6573*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6574*                                                                *
  6575*   LOG = NO                                                     *
  6576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6577*                                                                *
  6578*                                                                *
  6579******************************************************************
  6580*                   C H A N G E   L O G
  6581*
  6582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6583*-----------------------------------------------------------------
  6584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6585* EFFECTIVE    NUMBER
  6586*-----------------------------------------------------------------
  6587* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6588* 092705    2005050300006  PEMA  ADD SPP LEASES
  6589* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6590* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6591* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6592* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6593* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6594* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6595******************************************************************
  6596
  6597 01  ACCOUNT-MASTER.
  6598     12  AM-RECORD-ID                      PIC XX.
  6599         88  VALID-AM-ID                      VALUE 'AM'.
  6600
  6601     12  AM-CONTROL-PRIMARY.
  6602         16  AM-COMPANY-CD                 PIC X.
  6603         16  AM-MSTR-CNTRL.
  6604             20  AM-CONTROL-A.
  6605                 24  AM-CARRIER            PIC X.
  6606                 24  AM-GROUPING.
  6607                     28 AM-GROUPING-PREFIX PIC XXX.
  6608                     28 AM-GROUPING-PRIME  PIC XXX.
  6609                 24  AM-STATE              PIC XX.
  6610                 24  AM-ACCOUNT.
  6611                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 121
* EL050.cbl
  6612                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6613             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6614                                           PIC X(19).
  6615             20  AM-CNTRL-B.
  6616                 24  AM-EXPIRATION-DT      PIC XX.
  6617                 24  FILLER                PIC X(4).
  6618             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6619                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6620
  6621     12  AM-CONTROL-BY-VAR-GRP.
  6622         16  AM-COMPANY-CD-A1              PIC X.
  6623         16  AM-VG-CARRIER                 PIC X.
  6624         16  AM-VG-GROUPING                PIC X(6).
  6625         16  AM-VG-STATE                   PIC XX.
  6626         16  AM-VG-ACCOUNT                 PIC X(10).
  6627         16  AM-VG-DATE.
  6628             20  AM-VG-EXPIRATION-DT       PIC XX.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6631                                           PIC 9(11)      COMP-3.
  6632     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6633         16  FILLER                        PIC X(10).
  6634         16  AM-VG-KEY3.
  6635             20  AM-VG3-ACCOUNT            PIC X(10).
  6636             20  AM-VG3-EXP-DT             PIC XX.
  6637         16  FILLER                        PIC X(4).
  6638     12  AM-MAINT-INFORMATION.
  6639         16  AM-LAST-MAINT-DT              PIC XX.
  6640         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6641         16  AM-LAST-MAINT-USER            PIC X(4).
  6642         16  FILLER                        PIC XX.
  6643
  6644     12  AM-EFFECTIVE-DT                   PIC XX.
  6645     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6646
  6647     12  AM-PREV-DATES  COMP-3.
  6648         16  AM-PREV-EXP-DT                PIC 9(11).
  6649         16  AM-PREV-EFF-DT                PIC 9(11).
  6650
  6651     12  AM-REPORT-CODE-1                  PIC X(10).
  6652     12  AM-REPORT-CODE-2                  PIC X(10).
  6653
  6654     12  AM-CITY-CODE                      PIC X(4).
  6655     12  AM-COUNTY-PARISH                  PIC X(6).
  6656
  6657     12  AM-NAME                           PIC X(30).
  6658     12  AM-PERSON                         PIC X(30).
  6659     12  AM-ADDRS                          PIC X(30).
  6660     12  AM-CITY.
  6661         16  AM-ADDR-CITY                  PIC X(28).
  6662         16  AM-ADDR-STATE                 PIC XX.
  6663     12  AM-ZIP.
  6664         16  AM-ZIP-PRIME.
  6665             20  AM-ZIP-PRI-1ST            PIC X.
  6666                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6667             20  FILLER                    PIC X(4).
  6668         16  AM-ZIP-PLUS4                  PIC X(4).
  6669     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 122
* EL050.cbl
  6670         16  AM-CAN-POSTAL-1               PIC XXX.
  6671         16  AM-CAN-POSTAL-2               PIC XXX.
  6672         16  FILLER                        PIC XXX.
  6673     12  AM-TEL-NO.
  6674         16  AM-AREA-CODE                  PIC 999.
  6675         16  AM-TEL-PRE                    PIC 999.
  6676         16  AM-TEL-NBR                    PIC 9(4).
  6677     12  AM-TEL-LOC                        PIC X.
  6678         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6679         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6680
  6681     12  AM-COMM-STRUCTURE.
  6682         16  AM-DEFN-1.
  6683             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6684                 24  AM-AGT.
  6685                     28  AM-AGT-PREFIX     PIC X(4).
  6686                     28  AM-AGT-PRIME      PIC X(6).
  6687                 24  AM-COM-TYP            PIC X.
  6688                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6689                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6690                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6691                 24  AM-RECALC-LV-INDIC    PIC X.
  6692                 24  AM-RETRO-LV-INDIC     PIC X.
  6693                 24  AM-GL-CODES           PIC X.
  6694                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6695                 24  FILLER                PIC X(01).
  6696         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6697             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6698                 24  FILLER                PIC X(11).
  6699                 24  AM-L-COMA             PIC XXX.
  6700                 24  AM-J-COMA             PIC XXX.
  6701                 24  AM-A-COMA             PIC XXX.
  6702                 24  FILLER                PIC X(6).
  6703
  6704     12  AM-COMM-CHANGE-STATUS             PIC X.
  6705         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6706
  6707     12  AM-CSR-CODE                       PIC X(4).
  6708
  6709     12  AM-BILLING-STATUS                 PIC X.
  6710         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6711         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6712     12  AM-AUTO-REFUND-SW                 PIC X.
  6713         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6714         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6715     12  AM-GPCD                           PIC 99.
  6716     12  AM-IG                             PIC X.
  6717         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6718         88  AM-HAS-GROUP                     VALUE '2'.
  6719     12  AM-STATUS                         PIC X.
  6720         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6721         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6722         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6723         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6724         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6725         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6726         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6727         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 123
* EL050.cbl
  6728         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6729         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6730     12  AM-REMIT-TO                       PIC 99.
  6731     12  AM-ID-NO                          PIC X(11).
  6732
  6733     12  AM-CAL-TABLE                      PIC XX.
  6734     12  AM-LF-DEVIATION                   PIC XXX.
  6735     12  AM-AH-DEVIATION                   PIC XXX.
  6736     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6737     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6738     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6739     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6740     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6741     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6742
  6743     12  AM-USER-FIELDS.
  6744         16  AM-FLD-1                      PIC XX.
  6745         16  AM-FLD-2                      PIC XX.
  6746         16  AM-FLD-3                      PIC XX.
  6747         16  AM-FLD-4                      PIC XX.
  6748         16  AM-FLD-5                      PIC XX.
  6749
  6750     12  AM-1ST-PROD-DATE.
  6751         16  AM-1ST-PROD-YR                PIC XX.
  6752         16  AM-1ST-PROD-MO                PIC XX.
  6753         16  AM-1ST-PROD-DA                PIC XX.
  6754     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6755     12  AM-CERTS-PURGED-DATE.
  6756         16  AM-PUR-YR                     PIC XX.
  6757         16  AM-PUR-MO                     PIC XX.
  6758         16  AM-PUR-DA                     PIC XX.
  6759     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6760     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6761     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6762     12  AM-INACTIVE-DATE.
  6763         16  AM-INA-MO                     PIC 99.
  6764         16  AM-INA-DA                     PIC 99.
  6765         16  AM-INA-YR                     PIC 99.
  6766     12  AM-AR-HI-CERT-DATE                PIC XX.
  6767
  6768     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6769     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6770
  6771     12  AM-OB-PAYMENT-MODE                PIC X.
  6772         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6773         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6774         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6775         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6776
  6777     12  AM-AH-ONLY-INDICATOR              PIC X.
  6778         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6779         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6780
  6781     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6782
  6783     12  AM-OVER-SHORT.
  6784         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6785         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 124
* EL050.cbl
  6786
  6787     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6788     12  AM-DCC-CLP-STATE                  PIC XX.
  6789
  6790     12  AM-RECALC-COMM                    PIC X.
  6791     12  AM-RECALC-REIN                    PIC X.
  6792
  6793     12  AM-REI-TABLE                      PIC XXX.
  6794     12  AM-REI-ET-LF                      PIC X.
  6795     12  AM-REI-ET-AH                      PIC X.
  6796     12  AM-REI-PE-LF                      PIC X.
  6797     12  AM-REI-PE-AH                      PIC X.
  6798     12  AM-REI-PRT-ST                     PIC X.
  6799     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6800     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6801     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6802     12  AM-REI-GROUP-A                    PIC X(6).
  6803     12  AM-REI-MORT                       PIC X(4).
  6804     12  AM-REI-PRT-OW                     PIC X.
  6805     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6806     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6807     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6808     12  AM-REI-GROUP-B                    PIC X(6).
  6809
  6810     12  AM-TRUST-TYPE                     PIC X(2).
  6811
  6812     12  AM-EMPLOYER-STMT-USED             PIC X.
  6813     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6814
  6815     12  AM-STD-AH-TYPE                    PIC XX.
  6816     12  AM-EARN-METHODS.
  6817         16  AM-EARN-METHOD-R              PIC X.
  6818             88 AM-REF-RL-R78                 VALUE 'R'.
  6819             88 AM-REF-RL-PR                  VALUE 'P'.
  6820             88 AM-REF-RL-MEAN                VALUE 'M'.
  6821             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6822         16  AM-EARN-METHOD-L              PIC X.
  6823             88 AM-REF-LL-R78                 VALUE 'R'.
  6824             88 AM-REF-LL-PR                  VALUE 'P'.
  6825             88 AM-REF-LL-MEAN                VALUE 'M'.
  6826             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6827         16  AM-EARN-METHOD-A              PIC X.
  6828             88 AM-REF-AH-R78                 VALUE 'R'.
  6829             88 AM-REF-AH-PR                  VALUE 'P'.
  6830             88 AM-REF-AH-MEAN                VALUE 'M'.
  6831             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6832             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6833             88 AM-REF-AH-NET                 VALUE 'N'.
  6834
  6835     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6836     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6837     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6838
  6839     12  AM-RET-Y-N                        PIC X.
  6840     12  AM-RET-P-E                        PIC X.
  6841     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6842     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6843     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 125
* EL050.cbl
  6844     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6845         16  AM-POOL-PRIME                 PIC XXX.
  6846         16  AM-POOL-SUB                   PIC XXX.
  6847     12  AM-RETRO-EARNINGS.
  6848         16  AM-RET-EARN-R                 PIC X.
  6849         16  AM-RET-EARN-L                 PIC X.
  6850         16  AM-RET-EARN-A                 PIC X.
  6851     12  AM-RET-ST-TAX-USE                 PIC X.
  6852         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6853         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6854     12  AM-RETRO-BEG-EARNINGS.
  6855         16  AM-RET-BEG-EARN-R             PIC X.
  6856         16  AM-RET-BEG-EARN-L             PIC X.
  6857         16  AM-RET-BEG-EARN-A             PIC X.
  6858     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6859     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6860
  6861     12  AM-USER-SELECT-OPTIONS.
  6862         16  AM-USER-SELECT-1              PIC X(10).
  6863         16  AM-USER-SELECT-2              PIC X(10).
  6864         16  AM-USER-SELECT-3              PIC X(10).
  6865         16  AM-USER-SELECT-4              PIC X(10).
  6866         16  AM-USER-SELECT-5              PIC X(10).
  6867
  6868     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6869
  6870     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6871
  6872     12  AM-RPT045A-SWITCH                 PIC X.
  6873         88  RPT045A-OFF                   VALUE 'N'.
  6874
  6875     12  AM-INSURANCE-LIMITS.
  6876         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6877         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6878
  6879     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6880         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6881
  6882     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6883         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6884         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6885
  6886     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6887
  6888     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6889     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6890     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6891     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6892     12  AM-DCC-UEF-STATE                  PIC XX.
  6893     12  FILLER                            PIC XXX.
  6894     12  AM-REPORT-CODE-3                  PIC X(10).
  6895*    12  FILLER                            PIC X(22).
  6896
  6897     12  AM-RESERVE-DATE.
  6898         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6899         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6900         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6901
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 126
* EL050.cbl
  6902     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6903     12  AM-NOTIFICATION-TYPES.
  6904         16  AM-NOTIF-OF-LETTERS           PIC X.
  6905         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6906         16  AM-NOTIF-OF-REPORTS           PIC X.
  6907         16  AM-NOTIF-OF-STATUS            PIC X.
  6908
  6909     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6910         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6911         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6912         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6913         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6914
  6915     12  AM-BENEFIT-CONTROLS.
  6916         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6917             20  AM-BENEFIT-CODE           PIC XX.
  6918             20  AM-BENEFIT-TYPE           PIC X.
  6919             20  AM-BENEFIT-REVISION       PIC XXX.
  6920             20  AM-BENEFIT-REM-TERM       PIC X.
  6921             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6922             20  FILLER                    PIC XX.
  6923         16  FILLER                        PIC X(80).
  6924
  6925     12  AM-TRANSFER-DATA.
  6926         16  AM-TRANSFERRED-FROM.
  6927             20  AM-TRNFROM-CARRIER        PIC X.
  6928             20  AM-TRNFROM-GROUPING.
  6929                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6930                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6931             20  AM-TRNFROM-STATE          PIC XX.
  6932             20  AM-TRNFROM-ACCOUNT.
  6933                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6934                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6935             20  AM-TRNFROM-DTE            PIC XX.
  6936         16  AM-TRANSFERRED-TO.
  6937             20  AM-TRNTO-CARRIER          PIC X.
  6938             20  AM-TRNTO-GROUPING.
  6939                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6940                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6941             20  AM-TRNTO-STATE            PIC XX.
  6942             20  AM-TRNTO-ACCOUNT.
  6943                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6944                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6945             20  AM-TRNTO-DTE              PIC XX.
  6946         16  FILLER                        PIC X(10).
  6947
  6948     12  AM-SAVED-REMIT-TO                 PIC 99.
  6949
  6950     12  AM-COMM-STRUCTURE-SAVED.
  6951         16  AM-DEFN-1-SAVED.
  6952             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6953                 24  AM-AGT-SV             PIC X(10).
  6954                 24  AM-COM-TYP-SV         PIC X.
  6955                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6956                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6957                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6958                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6959                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 127
* EL050.cbl
  6960                 24  AM-GL-CODES-SV        PIC X.
  6961                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6962                 24  FILLER                PIC X.
  6963         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6964             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6965                 24  FILLER                PIC X(11).
  6966                 24  AM-L-COMA-SV          PIC XXX.
  6967                 24  AM-J-COMA-SV          PIC XXX.
  6968                 24  AM-A-COMA-SV          PIC XXX.
  6969                 24  FILLER                PIC X(6).
  6970
  6971     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6972         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6973            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6974            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6975            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6976
  6977     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6978     12  FILLER                            PIC X(120).
  6979
  6980     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6981         16  AM-CONTROL-NAME               PIC X(30).
  6982         16  AM-EXECUTIVE-ONE.
  6983             20  AM-EXEC1-NAME             PIC X(15).
  6984             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6985                                                          COMP-3.
  6986             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6987                                                          COMP-3.
  6988         16  AM-EXECUTIVE-TWO.
  6989             20  AM-EXEC2-NAME             PIC X(15).
  6990             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6991                                                          COMP-3.
  6992             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6993                                                          COMP-3.
  6994
  6995     12  AM-RETRO-ADDITIONAL-DATA.
  6996         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6997         16  AM-RETRO-PREM-P-E             PIC X.
  6998         16  AM-RETRO-CLMS-P-I             PIC X.
  6999         16  AM-RETRO-RET-BRACKET-LF.
  7000             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7001                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7002                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7003             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7004                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7005                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7006             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7007                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7008                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7009         16  AM-RETRO-RET-BRACKET-AH.
  7010             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7011                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7012                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7013                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7014             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7015                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7016                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7017             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 128
* EL050.cbl
  7018                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7019                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7020
  7021     12  AM-COMMENTS.
  7022         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7023
  7024     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7025         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7026         16  AM-FLI-BILLING-CODE           PIC X.
  7027         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7028         16  AM-FLI-UNITED-IDENT           PIC X.
  7029         16  AM-FLI-INTEREST-LOST-DATA.
  7030             20  AM-FLI-BANK-NO            PIC X(5).
  7031             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7032             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7033             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7034         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7035             20  AM-FLI-AGT                PIC X(9).
  7036             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7037             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7038         16  FILLER                        PIC X(102).
  7039
  7040     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7041         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7042             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7043             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7044             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7045             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7046             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7047         16  FILLER                          PIC X(10).
  7048******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 129
* EL050.cbl
  7050*    COPY ERCREIN.
  7051******************************************************************
  7052*                                                                *
  7053*                            ERCREIN                             *
  7054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7055*                            VMOD=2.010                          *
  7056*                                                                *
  7057*   ONLINE CREDIT SYSTEM                                         *
  7058*                                                                *
  7059*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7060*                                                                *
  7061*   FILE TYPE = VSAM,KSDS                                        *
  7062*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7063*                                                                *
  7064*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7065*       ALTERNATE PATH = NONE                                    *
  7066*                                                                *
  7067*   LOG = NO                                                     *
  7068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7069*                                                                *
  7070******************************************************************
  7071*                   C H A N G E   L O G
  7072*
  7073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7074*-----------------------------------------------------------------
  7075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7076* EFFECTIVE    NUMBER
  7077*-----------------------------------------------------------------
  7078* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7079* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7080******************************************************************
  7081 01  REINSURANCE-RECORD.
  7082     12  RE-RECORD-ID                      PIC XX.
  7083         88  VALID-RE-ID                      VALUE 'RE'.
  7084
  7085     12  RE-CONTROL-PRIMARY.
  7086         16  RE-COMPANY-CD                 PIC X.
  7087         16  RE-KEY.
  7088             20  RE-CODE                   PIC X.
  7089                 88  RE-TABLE-RECORD          VALUE 'A'.
  7090                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7091             20  RE-TABLE                  PIC XXX.
  7092             20  FILLER                    PIC XXX.
  7093         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7094             20  FILLER                    PIC X.
  7095             20  RE-COMPANY.
  7096                 24  RE-COMP-PRIME         PIC XXX.
  7097                 24  RE-COMP-SUB           PIC XXX.
  7098
  7099     12  RE-MAINT-INFORMATION.
  7100         16  RE-LAST-MAINT-DT              PIC XX.
  7101         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7102         16  RE-LAST-MAINT-USER            PIC X(4).
  7103         16  FILLER                        PIC X(10).
  7104
  7105     12  RE-TABLE-DATA.
  7106         16  RE-100-COMP                   PIC 99.
  7107
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 130
* EL050.cbl
  7108         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7109             20  RE-REI-COMP-NO.
  7110                 24  RE-REI-COMP           PIC XXX.
  7111                 24  RE-REI-COMP-SUB       PIC XXX.
  7112             20  RE-LF-QC                  PIC X.
  7113             20  RE-AH-QC                  PIC X.
  7114             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7115             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7116             20  RE-LFAGE-LO               PIC 99.
  7117             20  RE-LFAGE-HI               PIC 99.
  7118             20  RE-AHAGE-LO               PIC 99.
  7119             20  RE-AHAGE-HI               PIC 99.
  7120             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7121             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7122             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7123             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7124             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7125             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7126             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7127             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7128             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7129             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7130             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7131             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7132             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7133             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7134             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7135             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7136             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7137             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7138             20  RE-LF-BEN-CODE            PIC X.
  7139             20  RE-AH-BEN-CODE            PIC X.
  7140             20  RE-INTERACTIVE            PIC X.
  7141             20  RE-REMAINING              PIC X.
  7142             20  RE-LF-RUNOFF-SW           PIC X.
  7143             20  RE-AH-RUNOFF-SW           PIC X.
  7144             20  FILLER                    PIC X(19).
  7145
  7146         16  RE-COMP-INFO-END              PIC X(6).
  7147         16  RE-NSP-ST-CD-LF               PIC XX.
  7148         16  RE-NSP-ST-CD-AH               PIC XX.
  7149         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7150             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7151
  7152         16  FILLER                        PIC X(27).
  7153
  7154     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7155         16  RE-NAME                       PIC X(30).
  7156         16  RE-LF-PE                      PIC X.
  7157         16  RE-AH-PE                      PIC X.
  7158         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7159         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7160         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7161         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7162         16  RE-PRT-ST                     PIC X.
  7163         16  RE-PRT-OW                     PIC X.
  7164         16  RE-MORT-CODE                  PIC X(4).
  7165         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 131
* EL050.cbl
  7166         16  RE-ZERO-LF-FEE                PIC X.
  7167         16  RE-ZERO-AH-FEE                PIC X.
  7168         16  RE-CEDE-NAME                  PIC X(30).
  7169         16  RE-LF-COMM                    PIC X.
  7170         16  RE-AH-COMM                    PIC X.
  7171         16  RE-LF-TAX                     PIC X.
  7172         16  RE-AH-TAX                     PIC X.
  7173         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7174         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7175         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7176
  7177         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7178             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7179
  7180         16  RE-LF-CEDING-FEE-BRACKETS.
  7181             20  RE-LF-FEE-METHOD          PIC X.
  7182                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7183                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7184                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7185                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7186             20  RE-LF-FEE-BASIS           PIC X.
  7187                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7188                 88  RE-LF-NET-CEDED               VALUE '2'.
  7189                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7190                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7191                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7192                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7193                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7194                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7195             20  FILLER                    PIC XXX.
  7196             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7197                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7198                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7199
  7200         16  RE-AH-CEDING-FEE-BRACKETS.
  7201             20  RE-AH-FEE-METHOD          PIC X.
  7202                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7203                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7204                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7205                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7206             20  RE-AH-FEE-BASIS           PIC X.
  7207                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7208                 88  RE-AH-NET-CEDED               VALUE '2'.
  7209                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7210                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7211                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7212                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7213                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7214                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7215             20  FILLER                    PIC XXX.
  7216             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7217                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7218                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7219
  7220         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7221
  7222         16  RE-OLD-CEDING-STMT            PIC X.
  7223
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 132
* EL050.cbl
  7224         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7225         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7226         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7227         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7228         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7229         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7230         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7231         16  RE-MORT-SW                    PIC X.
  7232         16  RE-CEDING-TYPE-FLAG           PIC X.
  7233             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7234             88  RE-CEDED                          VALUE 'C'.
  7235             88  RE-ASSUMED                        VALUE 'A'.
  7236             88  RE-PHANTOM                        VALUE 'P'.
  7237
  7238         16  RE-CEDING-STMT-OPT-A          PIC X.
  7239             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7240         16  RE-CEDING-STMT-OPT-B          PIC X.
  7241             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7242         16  RE-CEDING-STMT-OPT-C          PIC X.
  7243             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7244         16  RE-CEDING-STMT-OPT-D          PIC X.
  7245             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7246         16  RE-CEDING-STMT-OPT-E          PIC X.
  7247             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7248
  7249         16  RE-PRT-CRSV                   PIC X.
  7250
  7251         16  RE-GL-CENTER                  PIC X(4).
  7252
  7253         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7254
  7255         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7256
  7257         16  RE-EARN-STOP-CODE             PIC X.
  7258             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7259             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7260
  7261         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7262             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7263
  7264         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7265         16  FILLER                        PIC X(2281).
  7266
  7267         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7268
  7269******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 133
* EL050.cbl
  7271*    COPY ERCCTBL.
  7272******************************************************************
  7273*                                                                *
  7274*                                                                *
  7275*                            ERCCTBL                             *
  7276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7277*                            VMOD=2.003
  7278*                                                                *
  7279*   ONLINE CREDIT SYSTEM                                         *
  7280*                                                                *
  7281*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7282*                                                                *
  7283*   FILE TYPE = VSAM,KSDS                                        *
  7284*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7285*                                                                *
  7286*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7287*       ALTERNATE PATH = NONE                                    *
  7288*                                                                *
  7289*   LOG = NO                                                     *
  7290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7291*                                                                *
  7292*                                                                *
  7293******************************************************************
  7294
  7295 01  COMM-TABLE-RECORD.
  7296     12  CT-RECORD-ID                      PIC XX.
  7297         88  VALID-CT-ID                      VALUE 'CT'.
  7298
  7299     12  CT-CONTROL-PRIMARY.
  7300         16  CT-COMPANY-CD                 PIC X.
  7301         16  CT-TABLE                      PIC XXX.
  7302         16  CT-CNTRL-2.
  7303             20  CT-BEN-TYPE               PIC X.
  7304             20  CT-BEN-CODE               PIC XX.
  7305
  7306     12  CT-MAINT-INFORMATION.
  7307         16  CT-LAST-MAINT-DT              PIC XX.
  7308         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7309         16  CT-LAST-MAINT-USER            PIC X(4).
  7310         16  FILLER                        PIC X(31).
  7311
  7312     12  CT-LIMITS.
  7313         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7314
  7315         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7316
  7317         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7318
  7319     12  CT-RATES.
  7320         16  CT-RTX          OCCURS 27 TIMES.
  7321             20  CT-RT                     PIC SV9(5)     COMP-3.
  7322             20  CT-RT-R   REDEFINES
  7323                 CT-RT                     PIC XXX.
  7324
  7325     12  FILLER                            PIC  X(42).
  7326
  7327******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 134
* EL050.cbl
  7329*    COPY ERCFORM.
  7330******************************************************************
  7331*                                                                *
  7332*                                                                *
  7333*                            ERCFORM.                            *
  7334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7335*                            VMOD=2.003                          *
  7336*                                                                *
  7337*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7338*                                                                *
  7339*    FILE TYPE = VSAM,KSDS                                       *
  7340*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7341*                                                                *
  7342*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7343*                                                                *
  7344*    LOG = YES                                                   *
  7345*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7346******************************************************************
  7347 01  FORM-MASTER.
  7348    12  FO-RECORD-ID                 PIC X(02).
  7349        88  VALID-FO-ID                  VALUE 'FO'.
  7350
  7351    12  FO-CONTROL-PRIMARY.
  7352        16  FO-COMPANY-CD            PIC X(01).
  7353        16  FO-STATE                 PIC X(02).
  7354        16  FO-FORM-ID               PIC X(12).
  7355        16  FO-FORM-EXP-DT           PIC X(02).
  7356
  7357    12  FO-POLICY-FORM-DATA.
  7358        16  FO-IND-GRP-CD            PIC X(01).
  7359        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7360        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7361        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7362        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7363        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7364        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7365        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7366        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7367        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7368        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7369        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7370        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7371        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7372        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7373        16  FO-APP-CERT-USE-CD       PIC X(01).
  7374
  7375    12  FILLER                       PIC X(29).
  7376
  7377    12  FO-FORM-PLAN-TABLE.
  7378        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7379            20  FO-PLAN-TYPE         PIC X(01).
  7380            20  FO-PLAN-ID           PIC X(02).
  7381            20  FO-PLAN-TERM         PIC 9(03).
  7382            20  FO-PLAN-REFUND-METHOD
  7383                                     PIC X.
  7384
  7385    12  FILLER                       PIC X(30).
  7386
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 135
* EL050.cbl
  7387    12  FO-COMMENTS-AREA.
  7388        16  FO-COMMENT-LINE-1        PIC X(78).
  7389
  7390    12  FILLER                       PIC X(20).
  7391
  7392    12  FO-MAINT-INFORMATION.
  7393        16  FO-LAST-MAINT-DT         PIC X(02).
  7394        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7395        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 136
* EL050.cbl
  7397*    COPY ELCMSTR.
  7398******************************************************************
  7399*                                                                *
  7400*                            ELCMSTR.                            *
  7401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7402*                            VMOD=2.012                          *
  7403*                                                                *
  7404*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7405*                                                                *
  7406*   FILE TYPE = VSAM,KSDS                                        *
  7407*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7408*                                                                *
  7409*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7410*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7411*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7412*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7413*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7414*                                                 RKP=75,LEN=21  *
  7415*                                                                *
  7416*   **** NOTE ****                                               *
  7417*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7418*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7419*                                                                *
  7420*   LOG = YES                                                    *
  7421*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7422******************************************************************
  7423*                   C H A N G E   L O G
  7424*
  7425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7426*-----------------------------------------------------------------
  7427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7428* EFFECTIVE    NUMBER
  7429*-----------------------------------------------------------------
  7430* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7431* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7432* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7433* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7434* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7435******************************************************************
  7436 01  CLAIM-MASTER.
  7437     12  CL-RECORD-ID                PIC XX.
  7438         88  VALID-CL-ID         VALUE 'CL'.
  7439
  7440     12  CL-CONTROL-PRIMARY.
  7441         16  CL-COMPANY-CD           PIC X.
  7442         16  CL-CARRIER              PIC X.
  7443         16  CL-CLAIM-NO             PIC X(7).
  7444         16  CL-CERT-NO.
  7445             20  CL-CERT-PRIME       PIC X(10).
  7446             20  CL-CERT-SFX         PIC X.
  7447
  7448     12  CL-CONTROL-BY-NAME.
  7449         16  CL-COMPANY-CD-A1        PIC X.
  7450         16  CL-INSURED-LAST-NAME    PIC X(15).
  7451         16  CL-INSURED-NAME.
  7452             20  CL-INSURED-1ST-NAME PIC X(12).
  7453             20  CL-INSURED-MID-INIT PIC X.
  7454
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 137
* EL050.cbl
  7455     12  CL-CONTROL-BY-SSN.
  7456         16  CL-COMPANY-CD-A2        PIC X.
  7457         16  CL-SOC-SEC-NO.
  7458             20  CL-SSN-STATE        PIC XX.
  7459             20  CL-SSN-ACCOUNT      PIC X(6).
  7460             20  CL-SSN-LN3          PIC X(3).
  7461
  7462     12  CL-CONTROL-BY-CERT-NO.
  7463         16  CL-COMPANY-CD-A4        PIC X.
  7464         16  CL-CERT-NO-A4.
  7465             20  CL-CERT-A4-PRIME    PIC X(10).
  7466             20  CL-CERT-A4-SFX      PIC X.
  7467
  7468     12  CL-CONTROL-BY-CCN.
  7469         16  CL-COMPANY-CD-A5        PIC X.
  7470         16  CL-CCN-A5.
  7471             20  CL-CCN.
  7472                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7473                 24  CL-CCN-PRIME-A5 PIC X(12).
  7474             20  CL-CCN-FILLER-A5    PIC X(4).
  7475
  7476     12  CL-INSURED-PROFILE-DATA.
  7477         16  CL-INSURED-BIRTH-DT     PIC XX.
  7478         16  CL-INSURED-SEX-CD       PIC X.
  7479             88  INSURED-IS-MALE        VALUE 'M'.
  7480             88  INSURED-IS-FEMALE      VALUE 'F'.
  7481             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7482         16  CL-INSURED-OCC-CD       PIC X(6).
  7483         16  FILLER                  PIC X(5).
  7484
  7485     12  CL-PROCESSING-INFO.
  7486         16  CL-PROCESSOR-ID         PIC X(4).
  7487         16  CL-CLAIM-STATUS         PIC X.
  7488             88  CLAIM-IS-OPEN          VALUE 'O'.
  7489             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7490         16  CL-CLAIM-TYPE           PIC X.
  7491*            88  AH-CLAIM               VALUE 'A'.
  7492*            88  LIFE-CLAIM             VALUE 'L'.
  7493*            88  PROPERTY-CLAIM         VALUE 'P'.
  7494*            88  IUI-CLAIM              VALUE 'I'.
  7495*            88  GAP-CLAIM              VALUE 'G'.
  7496*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7497         16  CL-CLAIM-PREM-TYPE      PIC X.
  7498             88  SINGLE-PREMIUM         VALUE '1'.
  7499             88  O-B-COVERAGE           VALUE '2'.
  7500             88  OPEN-END-COVERAGE      VALUE '3'.
  7501         16  CL-INCURRED-DT          PIC XX.
  7502         16  CL-REPORTED-DT          PIC XX.
  7503         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7504         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7505         16  CL-LAST-PMT-DT          PIC XX.
  7506         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7507         16  CL-PAID-THRU-DT         PIC XX.
  7508         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7509         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7510         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7511         16  CL-PMT-CALC-METHOD      PIC X.
  7512             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 138
* EL050.cbl
  7513             88  CL-365-DAY-YR          VALUE '2'.
  7514             88  CL-FULL-MONTHS         VALUE '3'.
  7515         16  CL-CAUSE-CD             PIC X(6).
  7516
  7517         16  CL-PRIME-CERT-NO.
  7518             20  CL-PRIME-CERT-PRIME PIC X(10).
  7519             20  CL-PRIME-CERT-SFX   PIC X.
  7520
  7521         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7522             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7523             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7524
  7525         16  CL-MICROFILM-NO         PIC X(10).
  7526         16  FILLER REDEFINES CL-MICROFILM-NO.
  7527             20  CL-BENEFIT-PERIOD   PIC 99.
  7528             20  FILLER              PIC X(8).
  7529         16  CL-PROG-FORM-TYPE       PIC X.
  7530         16  CL-LAST-ADD-ON-DT       PIC XX.
  7531
  7532         16  CL-LAST-REOPEN-DT       PIC XX.
  7533         16  CL-LAST-CLOSE-DT        PIC XX.
  7534         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7535             88  FINAL-PAID             VALUE '1'.
  7536             88  CLAIM-DENIED           VALUE '2'.
  7537             88  AUTO-CLOSE             VALUE '3'.
  7538             88  MANUAL-CLOSE           VALUE '4'.
  7539             88  BENEFITS-CHANGED       VALUE 'C'.
  7540             88  SETUP-ERRORS           VALUE 'E'.
  7541         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7542         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7543         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7544             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7545         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7546         16  FILLER                  PIC X.
  7547
  7548     12  CL-CERTIFICATE-DATA.
  7549         16  CL-CERT-ORIGIN          PIC X.
  7550             88  CERT-WAS-ONLINE        VALUE '1'.
  7551             88  CERT-WAS-CREATED       VALUE '2'.
  7552             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7553         16  CL-CERT-KEY-DATA.
  7554             20  CL-CERT-CARRIER     PIC X.
  7555             20  CL-CERT-GROUPING    PIC X(6).
  7556             20  CL-CERT-STATE       PIC XX.
  7557             20  CL-CERT-ACCOUNT.
  7558                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7559                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7560             20  CL-CERT-EFF-DT      PIC XX.
  7561
  7562     12  CL-STATUS-CONTROLS.
  7563         16  CL-PRIORITY-CD          PIC X.
  7564             88  CONFIDENTIAL-DATA      VALUE '8'.
  7565             88  HIGHEST-PRIORITY       VALUE '9'.
  7566         16  CL-SUPV-ATTN-CD         PIC X.
  7567             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7568             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7569         16  CL-PURGED-DT            PIC XX.
  7570         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 139
* EL050.cbl
  7571         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7572         16  CL-NEXT-RESEND-DT       PIC XX.
  7573         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7574         16  CL-CRITICAL-PERIOD      PIC 99.
  7575*        16  FILLER                  PIC XX.
  7576         16  CL-LAST-MAINT-DT        PIC XX.
  7577         16  CL-LAST-MAINT-USER      PIC X(4).
  7578         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7579         16  CL-LAST-MAINT-TYPE      PIC X.
  7580             88  CLAIM-SET-UP           VALUE ' '.
  7581             88  PAYMENT-MADE           VALUE '1'.
  7582             88  LETTER-SENT            VALUE '2'.
  7583             88  MASTER-WAS-ALTERED     VALUE '3'.
  7584             88  MASTER-WAS-RESTORED    VALUE '4'.
  7585             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7586             88  FILE-CONVERTED         VALUE '6'.
  7587             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7588             88  ERROR-CORRECTION       VALUE 'E'.
  7589         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7590         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7591         16  CL-BENEFICIARY          PIC X(10).
  7592         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7593         16  CL-DENIAL-TYPE          PIC X.
  7594             88  CL-TYPE-DENIAL          VALUE '1'.
  7595             88  CL-TYPE-RESCISSION      VALUE '2'.
  7596             88  CL-TYPE-REFORMATION     VALUE '3'.
  7597             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7598             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7599         16  filler                  pic x(5).
  7600*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7601*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7602*        16  CL-RTW-DT               PIC XX.
  7603
  7604     12  CL-TRAILER-CONTROLS.
  7605         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7606             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7607             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7608             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7609         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7610         16  FILLER                  PIC XX.
  7611         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7612         16  CL-ADDRESS-TRAILER-CNT.
  7613             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7614                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7615             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7616                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7617             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7618                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7619             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7620                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7621             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7622                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7623             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7624                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7625             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7626                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7627
  7628     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 140
* EL050.cbl
  7629         16  CL-CV-REFNO-PRIME       PIC X(18).
  7630         16  CL-CV-REFNO-SFX         PIC XX.
  7631
  7632     12  CL-FILE-LOCATION            PIC X(4).
  7633
  7634     12  CL-PROCESS-ERRORS.
  7635         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7636             88  NO-FATAL-ERRORS        VALUE ZERO.
  7637         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7638             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7639
  7640     12  CL-PRODUCT-CD               PIC X.
  7641
  7642     12  CL-CURRENT-KEY-DATA.
  7643         16  CL-CURRENT-CARRIER      PIC X.
  7644         16  CL-CURRENT-GROUPING     PIC X(6).
  7645         16  CL-CURRENT-STATE        PIC XX.
  7646         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7647
  7648     12  CL-ASSOCIATES               PIC X.
  7649         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7650         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7651         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7652         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7653
  7654     12  CL-ACTIVITY-CODE            PIC 99.
  7655     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7656     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7657
  7658     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7659     12  CL-LAG-REPORT-CODE          PIC 9.
  7660     12  CL-LOAN-TYPE                PIC XX.
  7661     12  CL-LEGAL-STATE              PIC XX.
  7662
  7663     12  CL-YESNOSW                  PIC X.
  7664     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7665         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7666         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7667         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7668     12  cl-insured-type             pic x.
  7669         88  cl-claim-on-primary         value 'P'.
  7670         88  cl-claim-on-co-borrower     value 'C'.
  7671     12  cl-benefit-expiration-dt    PIC XX.
  7672
  7673 01  PLAN-RECORDS.
  7674     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7675     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7676
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 141
* EL050.cbl
  7678 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7679                          ACCOUNT-MASTER REINSURANCE-RECORD
  7680                          COMM-TABLE-RECORD FORM-MASTER
  7681                          CLAIM-MASTER PLAN-RECORDS.
  7682 0000-DFHEXIT SECTION.
  7683     MOVE '9#                    $   ' TO DFHEIV0.
  7684     MOVE 'EL050' TO DFHEIV1.
  7685     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7686
  7687     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7688
  7689
  7690* EXEC CICS  HANDLE CONDITION
  7691*           ERROR    (9300-ABEND)
  7692*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7693*    END-EXEC.
  7694*    MOVE '"$.J                  ! " #00007685' TO DFHEIV0
  7695     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7697     MOVE X'2220233030303037363835' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7700
  7701
  7702 0000-COPY-PROCEDURE-DIV.
  7703*                          COPY ELC50PD.
  7704******************************************************************
  7705*                                                                *
  7706*                            ELC50PD                             *
  7707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7708*                            VMOD=2.188                          *
  7709*                                                                *
  7710******************************************************************
  7711*                   C H A N G E   L O G
  7712*
  7713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7714*-----------------------------------------------------------------
  7715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7716* EFFECTIVE    NUMBER
  7717*-----------------------------------------------------------------
  7718* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7719* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7720* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7721*                             2709 AND 2718
  7722* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7723* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7724* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7725* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7726* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7727*                                IS OPEN OR CNC DT < PD THRU
  7728* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7729* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7730* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7731* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7732* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7733* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7734* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7735* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 142
* EL050.cbl
  7736* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7737* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7738* 020906                   PEMA  EXPAND LOAN OFFICER
  7739* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7740* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7741* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7742* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7743* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7744* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7745* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7746* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7747* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7748* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7749* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7750* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7751* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7752* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7753* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7754* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7755* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7756* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7757* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7758* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7759* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7760* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7761* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7762* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7763* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7764*                                UPDATE VIN ON CERT TRAILER
  7765* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7766* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7767* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7768* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7769* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7770* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7771* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7772* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7773* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7774* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7775* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7776* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7777* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7778* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7779* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7780* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7781* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7782* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7783* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7784* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7785* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7786* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7787* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7788* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7789* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7790* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7791* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7792* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7793* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 143
* EL050.cbl
  7794* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7795* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7796* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7797* 032912  CR2011110200001  PEMA  AHL CHANGES
  7798* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7799* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7800* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7801* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7802* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7803* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7804* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7805* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7806* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7807* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7808* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7809* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7810* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7811* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7812* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7813* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7814* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7815* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7816* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7817* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7818* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7819* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7820* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7821* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7822* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7823* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7824* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7825*                                CERT #, ADD 2898 FORCIBLE ERROR
  7826* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7827* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7828* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7829* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7830* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7831* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7832* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7833* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7834* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7835* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7836* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7837* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7838* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7839******************************************************************
  7840************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7841******************************************************************
  7842
  7843     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7844
  7845     MOVE SPACES                 TO PB-FATAL-FLAG
  7846                                    PB-FORCE-ER-CD
  7847                                    PB-WARN-ER-CD
  7848                                    PB-OUT-BAL-CD.
  7849
  7850     MOVE SPACE                  TO WS-IG-OVRD-AH
  7851                                    WS-IG-OVRD-LF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 144
* EL050.cbl
  7852                                    WS-IG-OVRD-AM
  7853                                    WS-IG-OVRD
  7854                                    WS-IG-OVRD-AH-PL
  7855                                    WS-IG-OVRD-LF-PL
  7856                                    WS-IG-OVRD-AH-BEN
  7857                                    WS-IG-OVRD-LF-BEN.
  7858
  7859******************************************************************
  7860*************       INITIALIZE COMMON ERRORS       ***************
  7861******************************************************************
  7862
  7863     MOVE +0                     TO PB-NO-OF-ERRORS.
  7864     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7865
  7866******************************************************************
  7867
  7868     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7869     SET JULIAN-TO-BIN           TO TRUE.
  7870*    MOVE 5                      TO DC-OPTION-CODE.
  7871     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7872     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7873
  7874     MOVE ZERO                   TO  SUB4.
  7875
  7876 0040-INITIALIZE-GA-BILL-DT.
  7877
  7878     ADD +1                      TO  SUB4.
  7879
  7880     IF  SUB4 GREATER THAN +5
  7881         GO TO 0050-CHECK-CNTL-FOUND.
  7882
  7883     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7884         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7885
  7886     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7887
  7888 0050-CHECK-CNTL-FOUND.
  7889
  7890     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7891        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7892                                         WS-AH-REM-TERM-CALC
  7893                                         EC-CO-REM-TERM-CALC
  7894        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7895        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7896        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7897                                         WS-TOL-AH-CLAIM
  7898        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7899                                         WS-TOL-AH-PREM
  7900                                         EC-CO-TOL-PREM
  7901        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7902                                         WS-TOL-AH-REFUND
  7903                                         EC-CO-TOL-REFUND
  7904        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7905                                         WS-AH-REFUND-OVS-AMT
  7906                                         EC-CO-OVR-SHT-AMT
  7907        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7908                                         WS-TOL-AH-PREM-PCT
  7909                                         EC-CO-TOL-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 145
* EL050.cbl
  7910        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7911                                         WS-TOL-AH-REFUND-PCT
  7912                                         EC-CO-TOL-REFUND-PCT
  7913        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7914                                         WS-AH-REFUND-OVS-PCT
  7915                                         EC-CO-OVR-SHT-PCT
  7916        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7917        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7918        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7919        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7920        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7921        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7922        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7923        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7924        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7925        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7926        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7927        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7928                                         EC-CO-MONTH-END-DT
  7929        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7930          GO TO 0100-READ-ACCT.
  7931
  7932     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7933     MOVE SPACES                 TO CNTL-ACCESS.
  7934     MOVE '1'                    TO CNTL-REC-TYPE.
  7935     MOVE +0                     TO CNTL-SEQ-NO.
  7936
  7937     MOVE '1' TO RC-SW-1.
  7938     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7939     IF NOT CF-COMPANY-MASTER
  7940         MOVE ZEROS             TO WK-CO-TOL-PREM
  7941                                   WK-CO-TOL-CLAIM
  7942                                   WK-CO-TOL-REFUND
  7943                                   WK-REFUND-OVS-AMT
  7944                                   WK-REFUND-OVS-PCT
  7945                                   WK-CO-TOL-PREM-PCT
  7946                                   WK-CO-TOL-REFUND-PCT
  7947                                   WK-DEFAULT-APR
  7948                                   WK-CO-MAX-CAP
  7949        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7950                                   WK-CR-R78-METHOD
  7951                                   WK-CO-REF-REJECT-SW
  7952                                   WK-CO-PREM-REJECT-SW
  7953                                   WK-REM-TRM-CALC-OPTION
  7954                                   WK-BIRTH-DATE-INPUT
  7955                                   WK-JOINT-AGE-INPUT
  7956        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7957        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7958        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7959        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7960          GO TO 0099-COMPANY-NOT-FOUND.
  7961
  7962     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7963        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7964     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7965        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7966     IF CF-CO-TOL-CAP NOT NUMERIC
  7967        MOVE +0                    TO CF-CO-TOL-CAP.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 146
* EL050.cbl
  7968     IF CF-DEFAULT-APR NOT NUMERIC
  7969        MOVE +0                    TO CF-DEFAULT-APR.
  7970
  7971     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7972     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7973     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7974     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7975     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7976     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7977     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7978     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7979     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7980     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7981     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7982     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7983
  7984     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7985          CF-CO-OVR-SHT-AMT > +0
  7986        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7987
  7988     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7989          CF-CO-OVR-SHT-PCT > +0
  7990        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7991
  7992     IF CF-VALID-REM-TRM-OPTION
  7993         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7994     ELSE
  7995         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7996
  7997     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7998     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7999     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8000     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8001
  8002     GO TO 0050-CHECK-CNTL-FOUND.
  8003
  8004 0099-COMPANY-NOT-FOUND.
  8005
  8006     MOVE ER-2616                TO WS-ERROR.
  8007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8008
  8009 0100-READ-ACCT.
  8010
  8011     MOVE SPACES                 TO DATE-RANGE-SW.
  8012
  8013     IF WK-ACCT-ADDR = ZEROS
  8014        GO TO 0102-ACCT-GETMAIN.
  8015
  8016     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8017     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8018     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8019
  8020     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8021        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8022        GO TO 0105-READ-ACCT
  8023     END-IF
  8024
  8025     IF PB-CARRIER NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 147
* EL050.cbl
  8026        IF PB-CARRIER NOT = AM-VG-CARRIER
  8027           GO TO 0105-READ-ACCT.
  8028
  8029     IF PB-STATE NOT = SPACES
  8030        IF PB-STATE NOT = AM-VG-STATE
  8031           GO TO 0105-READ-ACCT.
  8032
  8033     IF PB-GROUPING NOT = SPACES
  8034        IF PB-GROUPING NOT = AM-VG-GROUPING
  8035           GO TO 0105-READ-ACCT.
  8036
  8037     MOVE 'X'                 TO DATE-RANGE-SW.
  8038
  8039     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8040        MOVE 'X'                 TO DATE-RANGE-SW
  8041        GO TO 0105-READ-ACCT.
  8042
  8043     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8044        GO TO 0105-READ-ACCT.
  8045
  8046     GO TO 0180-ACCOUNT-FOUND.
  8047
  8048 0102-ACCT-GETMAIN.
  8049     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8050     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8051
  8052 0105-READ-ACCT.
  8053     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8054     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8055     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8056     MOVE PB-STATE               TO ACCT-STATE.
  8057     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8058     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8059
  8060     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8061
  8062     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8063
  8064 0110-FIND-ACCT-TOLERANCES-LOOP.
  8065     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8066
  8067     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8068        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8069        GO TO 0199-ACCT-NOT-FOUND
  8070     END-IF
  8071     IF PB-CARRIER NOT = SPACES
  8072        IF PB-CARRIER NOT = AM-VG-CARRIER
  8073           GO TO 0199-ACCT-NOT-FOUND.
  8074
  8075     IF PB-STATE NOT = SPACES
  8076        IF PB-STATE NOT = AM-VG-STATE
  8077           GO TO 0199-ACCT-NOT-FOUND.
  8078
  8079     IF PB-GROUPING NOT = SPACES
  8080        IF PB-GROUPING NOT = AM-VG-GROUPING
  8081           GO TO 0199-ACCT-NOT-FOUND.
  8082
  8083     MOVE 'X'                    TO DATE-RANGE-SW.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 148
* EL050.cbl
  8084
  8085     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8086        MOVE 'X'                 TO DATE-RANGE-SW
  8087        GO TO 0199-ACCT-NOT-FOUND.
  8088
  8089     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8090        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8091
  8092 0180-ACCOUNT-FOUND.
  8093     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8094     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8095     MOVE AM-STATE               TO PB-SV-STATE.
  8096     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8097
  8098     IF AM-CANCEL-FEE  NOT NUMERIC
  8099        MOVE ZEROS TO AM-CANCEL-FEE.
  8100
  8101     IF AM-MAX-MON-BEN NOT NUMERIC
  8102        MOVE ZEROS TO AM-MAX-MON-BEN.
  8103
  8104     IF AM-MAX-TOT-BEN NOT NUMERIC
  8105        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8106
  8107     IF AM-CLP-TOL-PCT NOT NUMERIC
  8108        MOVE +0                  TO AM-CLP-TOL-PCT
  8109     END-IF
  8110     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8111        MOVE +0                  TO AM-SPP-LEASE-COMM
  8112     END-IF
  8113     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8114        MOVE ER-2611             TO   WS-ERROR
  8115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8116
  8117     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8118        MOVE ER-2621             TO   WS-ERROR
  8119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8120
  8121     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8122        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8123        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8124        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8125         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8126
  8127     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8128     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8129     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8130     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8131     IF AM-CLP-TOL-PCT NOT = ZEROS
  8132        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8133     END-IF
  8134     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8135        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8136     END-IF
  8137*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8138*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8139*                                   WS-ADMIN-FEES
  8140*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8141*          (SUB5 > +10)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 149
* EL050.cbl
  8142*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8143*             AND (AM-A-COM (SUB5) NUMERIC)
  8144*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8145*                + (AM-A-COM (SUB5) * 1000)
  8146*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8147*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8148*                + (AM-A-COM (SUB5) * 1000)
  8149*             END-IF
  8150*             IF AM-COM-TYP (SUB5) = 'N'
  8151*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8152*                + (AM-A-COM (SUB5) * 1000)
  8153*             END-IF
  8154*          END-IF
  8155*       END-PERFORM
  8156*    END-IF
  8157     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8158        AND (PB-ISSUE)
  8159        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8160                                    ws-cred-union-fees
  8161        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8162           (SUB5 > +10)
  8163           MOVE +0 TO WS-WK-RATE
  8164           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8165                                   'O' OR 'S')
  8166              IF (AM-A-COM (SUB5) NUMERIC)
  8167                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8168                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8169              ELSE
  8170                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8171                 IF PB-ISSUE
  8172                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8173                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8174                 ELSE
  8175                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8176                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8177                 END-IF
  8178                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8179                 MOVE ZEROS             TO WS-SUB1
  8180                                           WS-COMMISSION
  8181                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8182                 MOVE '0530'               TO CTBL-SW
  8183                 MOVE ' '                  TO WS-CTBL-READ-SW
  8184                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8185                 IF FIRST-TIME-THROUGH
  8186                    MOVE 'AA'              TO CTBL-BEN-CODE
  8187                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8188                 END-IF
  8189                 IF CTBL-TABLE-FOUND
  8190                    IF PB-ISSUE
  8191                       COMPUTE WS-COMM-CK-AMT =
  8192                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8193                    ELSE
  8194                       COMPUTE WS-COMM-CK-AMT =
  8195                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8196                    END-IF
  8197                    PERFORM 8800-GET-COMP-RATE
  8198                              THRU 8800-EXIT
  8199                 END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 150
* EL050.cbl
  8200              END-IF
  8201              if am-com-typ (sub5) = 'O' or 'S'
  8202                 compute ws-cred-union-fees rounded =
  8203                    ws-cred-union-fees +
  8204                    (pb-i-ah-premium-amt * ws-wk-rate)
  8205              else
  8206                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8207                + (WS-WK-RATE * 1000)
  8208              end-if
  8209           END-IF
  8210        END-PERFORM
  8211     END-IF
  8212     IF PB-COMPANY-ID EQUAL 'CRI'
  8213         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8214
  8215     IF PB-COMPANY-ID EQUAL 'NCL'
  8216         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8217     END-IF
  8218
  8219     GO TO 0200-READ-CERT.
  8220
  8221 0199-ACCT-NOT-FOUND.
  8222
  8223     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8224
  8225     IF DATE-RANGE-SW NOT = SPACES
  8226        MOVE ER-2601             TO WS-ERROR
  8227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8228     ELSE
  8229        MOVE ER-2619             TO WS-ERROR
  8230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8231
  8232     GO TO 9990-RETURN.
  8233
  8234 0200-READ-CERT.
  8235
  8236     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8237     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8238     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8239     MOVE PB-SV-STATE            TO CERT-STATE.
  8240     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8241     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8242     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8243
  8244     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8245
  8246     IF CERT-WAS-NOT-FOUND
  8247        GO TO 0299-CERT-NOT-FOUND.
  8248
  8249     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8250        MOVE ER-2759             TO WS-ERROR
  8251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8252        GO TO 0298-UNLOCK-RETURN.
  8253
  8254     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8255         MOVE ER-2758            TO WS-ERROR
  8256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257         GO TO 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 151
* EL050.cbl
  8258
  8259     IF PB-ISSUE
  8260        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8261           IF CERT-WAS-CREATED-FOR-CLAIM
  8262              NEXT SENTENCE
  8263            ELSE
  8264              MOVE ER-2626       TO WS-ERROR
  8265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8266              GO TO 0298-UNLOCK-RETURN.
  8267
  8268     IF NOT PB-CANCELLATION
  8269        GO TO 0300-CONTINUE-EDIT.
  8270
  8271     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8272     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8273     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8274     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8275     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8276     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8277
  8278     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8279     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8280     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8281     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8282     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8283     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8284     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8285     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8286     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8287
  8288     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8289     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8290     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8291     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8292     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8293     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8294     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8295
  8296     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8297     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8298
  8299     MOVE CM-CREDIT-INTERFACE-SW-1
  8300                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8301     MOVE CM-CREDIT-INTERFACE-SW-2
  8302                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8303
  8304     IF CM-O-B-COVERAGE
  8305         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8306
  8307     IF CM-LIVES NOT NUMERIC
  8308         MOVE ZERO                TO CM-LIVES.
  8309
  8310     IF CM-BILLED NOT NUMERIC
  8311         MOVE ZERO                TO CM-BILLED.
  8312
  8313     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8314         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8315         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 152
* EL050.cbl
  8316         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8317         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8318         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8319         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8320         MOVE CM-LIVES             TO PB-CI-LIVES
  8321*The next line causes a problem with my change  I dont think it is
  8322*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8323
  8324     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8325     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8326     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8327     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8328     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8329     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8330
  8331     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8332     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8333     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8334     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8335
  8336     IF CM-LIFE-COMM-PCT NUMERIC
  8337         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8338     ELSE
  8339         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8340
  8341     IF CM-AH-COMM-PCT NUMERIC
  8342         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8343     ELSE
  8344         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8345
  8346     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8347
  8348     IF CM-LOAN-APR       NOT NUMERIC
  8349           MOVE ZERO               TO CM-LOAN-APR.
  8350
  8351     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8352           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8353
  8354     IF CM-LOAN-TERM      NOT NUMERIC
  8355           MOVE ZERO               TO CM-LOAN-TERM.
  8356
  8357     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8358           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8359
  8360     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8361           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8362
  8363     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8364     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8365     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8366     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8367     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8368     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8369     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8370     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8371     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8372     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8373     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 153
* EL050.cbl
  8374     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8375
  8376     IF CM-STATE = CM-SSN-STATE
  8377         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8378
  8379     IF CM-STATE NOT = CM-MEMB-STATE
  8380         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8381
  8382     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8383
  8384     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8385        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8386        IF CM-ADDL-CLP NOT NUMERIC
  8387           MOVE +0               TO CM-ADDL-CLP
  8388        END-IF
  8389        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8390        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8391           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8392        END-IF
  8393     END-IF
  8394     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8395        MOVE +0                  TO WS-ADMIN-FEES
  8396                                    WS-CSO-ADMIN-FEE
  8397                                    WS-COMM-AND-MFEE
  8398                                    WS-1ST-YR-ALLOW
  8399        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8400           (SUB5 > +10)
  8401           MOVE +0 TO WS-WK-RATE
  8402           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8403              IF (AM-A-COM (SUB5) NUMERIC)
  8404                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8405                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8406              ELSE
  8407                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8408                 IF PB-ISSUE
  8409                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8410                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8411                 ELSE
  8412                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8413                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8414                 END-IF
  8415                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8416                 MOVE ZEROS             TO WS-SUB1
  8417                                           WS-COMMISSION
  8418                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8419                 MOVE '0530'               TO CTBL-SW
  8420                 MOVE ' '                  TO WS-CTBL-READ-SW
  8421                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8422                 IF FIRST-TIME-THROUGH
  8423                    MOVE 'AA'              TO CTBL-BEN-CODE
  8424                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8425                 END-IF
  8426                 IF CTBL-TABLE-FOUND
  8427                    IF PB-ISSUE
  8428                       COMPUTE WS-COMM-CK-AMT =
  8429                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8430                    ELSE
  8431                       COMPUTE WS-COMM-CK-AMT =
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 154
* EL050.cbl
  8432                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8433                    END-IF
  8434                    PERFORM 8800-GET-COMP-RATE
  8435                              THRU 8800-EXIT
  8436                 END-IF
  8437              END-IF
  8438              IF AM-COM-TYP (SUB5) = 'I'
  8439                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8440                   + (WS-WK-RATE * 1000)
  8441              END-IF
  8442              IF AM-COM-TYP (SUB5) = 'N'
  8443                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8444                   + (WS-WK-RATE * 1000)
  8445              END-IF
  8446              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8447                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8448                   + (WS-WK-RATE * 1000)
  8449              END-IF
  8450              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8451                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8452                   + (WS-WK-RATE * 1000)
  8453              END-IF
  8454           END-IF
  8455        END-PERFORM
  8456     END-IF
  8457     GO TO 0300-CONTINUE-EDIT.
  8458
  8459 0298-UNLOCK-RETURN.
  8460      PERFORM 9250-UNLOCK-RETURN
  8461      GO TO 9990-RETURN.
  8462
  8463 0299-CERT-NOT-FOUND.
  8464
  8465     MOVE '1'                     TO CERT-STATUS-SW.
  8466
  8467     IF PB-COMPANY-ID = 'UCL'
  8468         IF WS-ERROR = ER-2799
  8469             GO TO 3000-CONTINUE-EDIT.
  8470
  8471     IF NOT PB-CANCELLATION
  8472         GO TO 0300-CONTINUE-EDIT.
  8473
  8474     MOVE ER-2726                  TO  WS-ERROR.
  8475     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8476     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8477     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8478                                    PB-CI-LF-TERM
  8479                                    PB-C-LF-REM-TERM
  8480                                    PB-CI-AH-TERM
  8481                                    PB-C-AH-REM-TERM
  8482                                    PB-CI-LF-BENEFIT-CD
  8483                                    PB-CI-LF-BENEFIT-AMT
  8484                                    PB-CI-LF-ALT-BENEFIT-AMT
  8485                                    PB-CI-LF-PREMIUM-AMT
  8486                                    PB-CI-LF-ALT-PREMIUM-AMT
  8487                                    PB-CI-AH-BENEFIT-CD
  8488                                    PB-CI-AH-BENEFIT-AMT
  8489                                    PB-CI-AH-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 155
* EL050.cbl
  8490                                    PB-CI-PAY-FREQUENCY
  8491                                    PB-CI-LOAN-APR
  8492                                    PB-CI-LOAN-TERM
  8493                                    PB-CI-LIFE-COMMISSION
  8494                                    PB-CI-AH-COMMISSION
  8495                                    PB-CI-CURR-SEQ
  8496                                    PB-CI-AH-CANCEL-AMT
  8497                                    PB-CI-LF-CANCEL-AMT
  8498                                    PB-CI-RATE-DEV-PCT-LF
  8499                                    PB-CI-RATE-DEV-PCT-AH
  8500                                    PB-CI-EXTENTION-DAYS
  8501                                    PB-CI-TERM-IN-DAYS
  8502                                    PB-CI-LIVES
  8503                                    PB-CI-LF-CRIT-PER
  8504                                    PB-CI-AH-CRIT-PER
  8505                                    PB-CI-ADDL-CLP
  8506                                    PB-CI-DDF-IU-RATE-UP.
  8507
  8508     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8509                                    PB-CI-AH-SETTLEMENT-DT
  8510                                    PB-CI-DEATH-DT
  8511                                    PB-CI-LF-PRIOR-CANCEL-DT
  8512                                    PB-CI-AH-PRIOR-CANCEL-DT
  8513                                    PB-CI-ENTRY-DT
  8514                                    PB-CI-LF-EXPIRE-DT
  8515                                    PB-CI-AH-EXPIRE-DT
  8516                                    PB-CI-LOAN-1ST-PMT-DT.
  8517
  8518     IF ACCOUNT-MAST-FOUND
  8519        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8520        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8521
  8522
  8523 0300-CONTINUE-EDIT.
  8524
  8525     IF PB-ISSUE
  8526        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8527            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8528
  8529     IF PB-ISSUE
  8530        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8531            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8532
  8533     IF PB-ISSUE
  8534       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8535          (AM-NO-AH-ONLY)
  8536           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8537               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8538                   MOVE ER-2679 TO WS-ERROR
  8539                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8540
  8541     IF PB-ISSUE
  8542        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8543        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8544        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8545     ELSE
  8546        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8547        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 156
* EL050.cbl
  8548        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8549
  8550     MOVE 'N'                    TO PLAN-MASTER-SW
  8551                                    PLAN-MASTER-LIFE-SW
  8552                                    FORM-MASTER-SW
  8553                                    WS-APP-CERT-SW.
  8554
  8555     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8556                                    WS-PL-TOL-LF-REFUND
  8557                                    WS-PL-REF-OVS-AMT
  8558                                    WS-PL-TOL-LF-PREM-PCT
  8559                                    WS-PL-TOL-LF-REFUND-PCT
  8560                                    WS-PL-REF-OVS-PCT
  8561                                    WS-PL-TOL-LF-CLAIM.
  8562
  8563     IF PB-COMPANY-ID = 'NCL'
  8564       IF PB-ISSUE
  8565         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8566             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8567             IF FORM-MASTER-FOUND
  8568                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8569
  8570     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8571        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8572
  8573********************** MON CODE **********************
  8574     IF PB-COMPANY-ID = 'MON'
  8575     IF PB-ISSUE
  8576     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8577        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8578             PB-I-LOAN-APR = ZERO)
  8579               MOVE 14.0         TO PB-I-LOAN-APR.
  8580******************************************************
  8581
  8582     IF PB-COMPANY-ID = 'NCL'
  8583       IF PB-ISSUE
  8584           IF FORM-MASTER-FOUND
  8585             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8586                AM-DISMBR-COVERAGE
  8587                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8588                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8589                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8590                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8591                                           PB-I-LIFE-BENEFIT-CD.
  8592
  8593     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8594
  8595     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8596         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8597         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8598         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8599         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8600         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8601           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8602             GO TO 0301-LIFE-BENEFIT-SEARCH
  8603         ELSE
  8604             NEXT SENTENCE
  8605     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 157
* EL050.cbl
  8606         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8607
  8608     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8609     MOVE '4'                    TO CNTL-REC-TYPE.
  8610     MOVE +0                     TO CNTL-SEQ-NO.
  8611     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8612
  8613     MOVE '1' TO RC-SW-2.
  8614     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8615
  8616     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8617        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8618         GO TO 0305-BENEFIT-NOT-FOUND.
  8619
  8620     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8621
  8622 0301-LIFE-BENEFIT-SEARCH.
  8623
  8624     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8625
  8626     IF NO-BENEFIT-FOUND
  8627        GO TO 0305-BENEFIT-NOT-FOUND.
  8628
  8629     IF WS-BEN-CD = '99'
  8630        GO TO 0305-BENEFIT-NOT-FOUND.
  8631
  8632     IF PB-COMPANY-ID = 'NCL'
  8633         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8634             GO TO 0304-LIFE-BENEFIT-FOUND.
  8635
  8636     MOVE +1                     TO SUB5.
  8637     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8638
  8639* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8640* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8641     IF PB-COMPANY-ID = 'DMD'
  8642         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8643
  8644 0302-EDIT-ACCT-LF-BENEFITS.
  8645
  8646     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8647        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8648           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8649                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8650           GO TO 03XX-GET-LIFE-ERPLAN.
  8651
  8652     IF SUB5 LESS THAN +20
  8653        ADD +1                   TO SUB5
  8654        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8655
  8656     MOVE +1                     TO SUB5.
  8657
  8658     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8659        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8660
  8661 0303-EDIT-DMD-EXTRA-BENEFITS.
  8662
  8663     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 158
* EL050.cbl
  8664        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8665           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8666                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8667           GO TO 03XX-GET-LIFE-ERPLAN.
  8668
  8669     IF SUB5 LESS THAN +30
  8670        ADD +1                   TO SUB5
  8671        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8672
  8673     MOVE +1                     TO SUB5.
  8674
  8675 03XX-EDIT-FOR-NINETY-LF.
  8676
  8677***************************************************************
  8678*                                                             *
  8679*    NINETY BENEFIT PLAN TYPES:                               *
  8680*                                                             *
  8681*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8682*      92 = ALL GROUP REDUCING BENEFITS                       *
  8683*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8684*      94 = ALL GROUP LEVEL BENEFITS                          *
  8685*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8686*           BENEFIT CONTROLS.                                 *
  8687*      99 = ALL BENEFITS                                      *
  8688*                                                             *
  8689***************************************************************
  8690
  8691     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8692                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8693
  8694     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8695       AND
  8696        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8697        GO TO 03XX-GET-LIFE-ERPLAN.
  8698
  8699     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8700       AND
  8701        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8702        IF CF-REDUCING (SUB3)
  8703           IF (PB-I-INDV-GRP-OVRD = 'I')
  8704              OR
  8705           ((AM-IG = '1') AND
  8706           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8707              OR
  8708           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8709           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8710           (AM-IG NOT = '2'))
  8711              GO TO 03XX-GET-LIFE-ERPLAN.
  8712
  8713     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8714       AND
  8715        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8716        IF CF-REDUCING (SUB3)
  8717           IF (PB-I-INDV-GRP-OVRD = 'G')
  8718              OR
  8719           ((AM-IG = '2') AND
  8720           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8721              OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 159
* EL050.cbl
  8722           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8723           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8724           (AM-IG NOT = '1'))
  8725              GO TO 03XX-GET-LIFE-ERPLAN.
  8726
  8727     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8728       AND
  8729        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8730        IF CF-LEVEL    (SUB3)
  8731           IF (PB-I-INDV-GRP-OVRD = 'I')
  8732              OR
  8733           ((AM-IG = '1') AND
  8734           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8735              OR
  8736           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8737           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8738            (AM-IG NOT = '2'))
  8739              GO TO 03XX-GET-LIFE-ERPLAN.
  8740
  8741     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8742       AND
  8743        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8744        IF CF-LEVEL    (SUB3)
  8745           IF (PB-I-INDV-GRP-OVRD = 'G')
  8746              OR
  8747           ((AM-IG = '2') AND
  8748           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8749              OR
  8750           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8751           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8752           (AM-IG NOT = '1'))
  8753              GO TO 03XX-GET-LIFE-ERPLAN.
  8754
  8755     IF SUB5 LESS THAN +20
  8756        ADD +1                   TO SUB5
  8757        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8758
  8759     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8760
  8761     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8762        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8763
  8764     MOVE +1                     TO SUB5.
  8765
  8766 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8767
  8768     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8769                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8770
  8771     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8772       AND
  8773        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8774        GO TO 03XX-GET-LIFE-ERPLAN.
  8775
  8776     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8777       AND
  8778        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8779        IF CF-REDUCING (SUB3)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 160
* EL050.cbl
  8780           IF (PB-I-INDV-GRP-OVRD = 'I')
  8781              OR
  8782           ((AM-IG = '1') AND
  8783           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8784              OR
  8785           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8786           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8787           (AM-IG NOT = '2'))
  8788              GO TO 03XX-GET-LIFE-ERPLAN.
  8789
  8790     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8791       AND
  8792        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8793        IF CF-REDUCING (SUB3)
  8794           IF (PB-I-INDV-GRP-OVRD = 'G')
  8795              OR
  8796           ((AM-IG = '2') AND
  8797           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8798              OR
  8799           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8800           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8801           (AM-IG NOT = '1'))
  8802              GO TO 03XX-GET-LIFE-ERPLAN.
  8803
  8804     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8805       AND
  8806        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8807        IF CF-LEVEL    (SUB3)
  8808           IF (PB-I-INDV-GRP-OVRD = 'I')
  8809              OR
  8810           ((AM-IG = '1') AND
  8811           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8812              OR
  8813           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8814           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8815            (AM-IG NOT = '2'))
  8816              GO TO 03XX-GET-LIFE-ERPLAN.
  8817
  8818     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8819       AND
  8820        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8821        IF CF-LEVEL    (SUB3)
  8822           IF (PB-I-INDV-GRP-OVRD = 'G')
  8823              OR
  8824           ((AM-IG = '2') AND
  8825           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8826              OR
  8827           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8828           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8829           (AM-IG NOT = '1'))
  8830              GO TO 03XX-GET-LIFE-ERPLAN.
  8831
  8832     IF SUB5 LESS THAN +30
  8833        ADD +1                   TO SUB5
  8834        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8835
  8836     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8837
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 161
* EL050.cbl
  8838 03XX-EDIT-FOR-NINETY-LF-CONT.
  8839
  8840     MOVE +99                    TO SUB5.
  8841
  8842     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8843        IF PB-ISSUE
  8844           MOVE ER-1924          TO  WS-ERROR
  8845           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8846
  8847     GO TO 0304-LIFE-BENEFIT-FOUND.
  8848
  8849 03XX-GET-LIFE-ERPLAN.
  8850
  8851     IF WK-PLAN-ADDR EQUAL +0
  8852        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8853
  8854     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8855     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8856     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8857     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8858     MOVE 'Y'                    TO PLAN-MASTER-SW
  8859                                    PLAN-MASTER-LIFE-SW.
  8860     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8861
  8862 03XX-ERPLAN-LIFE-GETMAIN.
  8863
  8864     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8865     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8866
  8867 03XX-ERPLAN-LIFE-READ.
  8868
  8869     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8870     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8871     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8872     MOVE PB-SV-STATE            TO PLAN-STATE.
  8873     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8874     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8875     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8876     MOVE WS-SAVE-BENEFIT-REVISION
  8877                                 TO PLAN-REVISION-NO.
  8878
  8879     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8880     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8881
  8882     IF PB-COMPANY-ID = 'NCL'
  8883       IF NOT LF-PLAN-MASTER-FOUND
  8884         IF NOT PB-POLICY-IS-DECLINED  AND
  8885            NOT PB-POLICY-IS-VOIDED
  8886             MOVE  ER-1921         TO  WS-ERROR
  8887             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8888             GO TO 0304-LIFE-BENEFIT-FOUND.
  8889
  8890     IF NOT LF-PLAN-MASTER-FOUND
  8891        GO TO 0304-LIFE-BENEFIT-FOUND.
  8892
  8893 XXXX-CHECK-LF-PLAN-KEY.
  8894
  8895     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 162
* EL050.cbl
  8896        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8897        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8898        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8899        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8900        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8901        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8902        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8903        MOVE 'N'                 TO PLAN-MASTER-SW
  8904          GO TO 03XX-ERPLAN-LIFE-READ.
  8905
  8906     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8907
  8908     IF  PB-CANCELLATION
  8909         GO TO  0303-LF-ACCT-BEN-FOUND.
  8910
  8911     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8912        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8913           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8914           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8915              MOVE ER-2644             TO WS-ERROR
  8916              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8917           ELSE
  8918              NEXT SENTENCE
  8919        ELSE
  8920           IF PB-COMPANY-ID NOT = 'NCL'
  8921              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8922                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8923
  8924 0303-LF-ACCT-BEN-FOUND.
  8925
  8926     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8927
  8928     IF PL-DEV-CODE NOT = SPACES
  8929        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8930
  8931     IF PL-DEV-PCT NUMERIC AND
  8932        PL-DEV-PCT NOT = ZEROS
  8933        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8934
  8935     IF PL-TOL-PREM-AMT GREATER THAN +0
  8936        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8937
  8938     IF PL-TOL-REF-AMT GREATER THAN +0
  8939        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8940
  8941     IF PL-TOL-PREM-PCT GREATER THAN +0
  8942        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8943
  8944     IF PL-TOL-REF-PCT GREATER THAN +0
  8945        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8946
  8947     IF PL-TOL-CLM-AMT GREATER THAN +0
  8948        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8949
  8950     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8951                          PL-OVER-SHORT-AMT > +0
  8952        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8953
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 163
* EL050.cbl
  8954     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8955                          PL-OVER-SHORT-PCT > +0
  8956        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8957
  8958     IF PL-SALES-TAX NUMERIC AND
  8959                          PL-SALES-TAX > +0
  8960         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8961
  8962     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8963        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8964                                    WS-IG-OVRD-AM.
  8965
  8966 0304-LIFE-BENEFIT-FOUND.
  8967
  8968     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8969
  8970     IF PB-ISSUE
  8971        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8972     ELSE
  8973        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8974
  8975     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8976     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8977     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8978     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8979     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8980                                         WS-LF-REFUND-CALC.
  8981     if (ws-lf-earnings-calc = '5')
  8982        and (pb-i-loan-apr = zeros)
  8983        and (benefit-code-chg)
  8984        move +99.9999 to pb-i-loan-apr
  8985     end-if
  8986
  8987     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8988        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8989
  8990     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8991        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8992     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8993
  8994     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8995     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8996     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8997     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8998     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8999     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9000
  9001     IF PB-COMPANY-ID = 'NCL'  AND
  9002        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9003         NEXT SENTENCE
  9004     ELSE
  9005         IF SUB5 NOT GREATER THAN +20
  9006            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9007               MOVE WS-SAVE-BENEFIT-REM-TERM
  9008                                      TO WS-AM-LF-BENE-REM-TERM
  9009                                         EC-BR-LF-REM-TERM-CALC.
  9010
  9011     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 164
* EL050.cbl
  9012     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9013
  9014     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9015
  9016 0305-BENEFIT-NOT-FOUND.
  9017
  9018     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9019     MOVE ER-2604                TO WS-ERROR.
  9020     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9021
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 165
* EL050.cbl
  9023
  9024 0310-FIND-AH-BENEFIT-RECORD.
  9025
  9026     MOVE 'N'                    TO PLAN-MASTER-SW
  9027                                    PLAN-MASTER-AH-SW.
  9028
  9029     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9030                                    WS-PL-TOL-AH-REFUND
  9031                                    WS-AH-PL-REF-OVS-AMT
  9032                                    WS-PL-TOL-AH-PREM-PCT
  9033                                    WS-PL-TOL-AH-REFUND-PCT
  9034                                    WS-AH-PL-REF-OVS-PCT
  9035                                    WS-PL-TOL-AH-CLAIM.
  9036     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9037
  9038
  9039     if pb-issue
  9040        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9041           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9042        end-if
  9043        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9044           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9045           GO TO 0399-BENEFIT-NOT-FOUND
  9046        end-if
  9047     end-if
  9048
  9049     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9050        GO TO 0400-FIND-CARRIER.
  9051
  9052     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9053
  9054     IF WK-AH-BEN-ADDR NOT = ZEROS
  9055         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9056         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9057         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9058         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9059           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9060             GO TO 0311-AH-BENEFIT-SEARCH
  9061         ELSE
  9062             NEXT SENTENCE
  9063     ELSE
  9064         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9065
  9066     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9067     MOVE '5'                    TO CNTL-REC-TYPE.
  9068     MOVE +0                     TO CNTL-SEQ-NO.
  9069     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9070
  9071     MOVE '2' TO RC-SW-2.
  9072     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9073
  9074     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9075        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9076          GO TO 0399-BENEFIT-NOT-FOUND.
  9077
  9078     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9079
  9080 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 166
* EL050.cbl
  9081
  9082     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9083
  9084     IF NO-BENEFIT-FOUND
  9085         GO TO 0399-BENEFIT-NOT-FOUND.
  9086
  9087     IF WS-BEN-CD = '99'
  9088        GO TO 0399-BENEFIT-NOT-FOUND.
  9089
  9090     IF PB-COMPANY-ID  =  'NCL'
  9091         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9092             GO TO 0314-A-H-BENEFIT-FOUND.
  9093
  9094     MOVE +1                     TO SUB5.
  9095     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9096
  9097* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9098* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9099     IF PB-COMPANY-ID = 'DMD'
  9100         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9101
  9102 0312-EDIT-ACCT-AH-BENEFITS.
  9103
  9104     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9105        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9106           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9107                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9108           GO TO 03XX-GET-AH-ERPLAN.
  9109
  9110     IF SUB5 LESS THAN +20
  9111        ADD +1                   TO SUB5
  9112        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9113
  9114     MOVE +1                     TO SUB5.
  9115
  9116     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9117        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9118
  9119 0313-EDIT-DMD-EXTRA-BENEFITS.
  9120
  9121     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9122        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9123           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9124                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9125           GO TO 03XX-GET-AH-ERPLAN.
  9126
  9127     IF SUB5 LESS THAN +30
  9128        ADD +1                   TO SUB5
  9129        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9130
  9131     MOVE +1                     TO SUB5.
  9132
  9133 03XX-EDIT-FOR-NINETY-AH.
  9134
  9135***************************************************************
  9136*                                                             *
  9137*    NINETY BENEFIT PLAN TYPES:                               *
  9138*                                                             *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 167
* EL050.cbl
  9139*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9140*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9141*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9142*           BENEFIT CONTROLS.                                 *
  9143*      99 = ALL BENEFITS.                                     *
  9144*                                                             *
  9145***************************************************************
  9146
  9147     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9148                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9149
  9150     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9151       AND
  9152        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9153        GO TO 03XX-GET-AH-ERPLAN.
  9154
  9155     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9156       AND
  9157        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9158           IF (PB-I-INDV-GRP-OVRD = 'I')
  9159              OR
  9160           ((AM-IG = '1') AND
  9161           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9162              OR
  9163           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9164           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9165           (AM-IG NOT = '2'))
  9166              GO TO 03XX-GET-AH-ERPLAN.
  9167
  9168     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9169       AND
  9170        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9171           IF (PB-I-INDV-GRP-OVRD = 'G')
  9172              OR
  9173           ((AM-IG = '2') AND
  9174           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9175              OR
  9176           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9177           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9178           (AM-IG NOT = '1'))
  9179              GO TO 03XX-GET-AH-ERPLAN.
  9180
  9181     IF SUB5 LESS THAN +20
  9182        ADD +1                   TO SUB5
  9183        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9184
  9185     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9186        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9187
  9188     MOVE +1                    TO SUB5.
  9189
  9190 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9191
  9192     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9193                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9194
  9195     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9196       AND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 168
* EL050.cbl
  9197        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9198        GO TO 03XX-GET-AH-ERPLAN.
  9199
  9200     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9201       AND
  9202        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9203           IF (PB-I-INDV-GRP-OVRD = 'I')
  9204              OR
  9205           ((AM-IG = '1') AND
  9206           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9207              OR
  9208           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9209           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9210           (AM-IG NOT = '2'))
  9211              GO TO 03XX-GET-AH-ERPLAN.
  9212
  9213     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9214       AND
  9215        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9216           IF (PB-I-INDV-GRP-OVRD = 'G')
  9217              OR
  9218           ((AM-IG = '2') AND
  9219           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9220              OR
  9221           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9222           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9223           (AM-IG NOT = '1'))
  9224              GO TO 03XX-GET-AH-ERPLAN.
  9225
  9226     IF SUB5 LESS THAN +30
  9227        ADD +1                   TO SUB5
  9228        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9229
  9230 03XX-EDIT-FOR-NINETY-AH-CONT.
  9231
  9232     MOVE +99                    TO SUB5.
  9233
  9234     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9235
  9236     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9237        IF PB-ISSUE
  9238           MOVE ER-1925          TO  WS-ERROR
  9239           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9240
  9241     GO TO 0314-A-H-BENEFIT-FOUND.
  9242
  9243 03XX-GET-AH-ERPLAN.
  9244
  9245     IF WK-PLAN-ADDR EQUAL +0
  9246         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9247
  9248     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9249     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9250     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9251     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9252     MOVE 'Y'                    TO PLAN-MASTER-SW
  9253                                    PLAN-MASTER-AH-SW.
  9254*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 169
* EL050.cbl
  9255     GO TO 03XX-ERPLAN-AH-READ.
  9256
  9257 03XX-ERPLAN-AH-GETMAIN.
  9258
  9259     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9260     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9261
  9262 03XX-ERPLAN-AH-READ.
  9263
  9264     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9265     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9266     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9267     MOVE PB-SV-STATE            TO PLAN-STATE.
  9268     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9269     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9270     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9271     MOVE WS-SAVE-BENEFIT-REVISION
  9272                                 TO PLAN-REVISION-NO.
  9273
  9274     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9275     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9276
  9277     IF PB-COMPANY-ID = 'NCL'
  9278       IF NOT AH-PLAN-MASTER-FOUND
  9279         IF NOT PB-POLICY-IS-DECLINED  AND
  9280            NOT PB-POLICY-IS-VOIDED
  9281             MOVE  ER-1922         TO  WS-ERROR
  9282             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9283             GO TO 0314-A-H-BENEFIT-FOUND.
  9284
  9285     IF NOT AH-PLAN-MASTER-FOUND
  9286        GO TO 0314-A-H-BENEFIT-FOUND.
  9287
  9288 XXXX-CHECK-AH-PLAN-KEY.
  9289
  9290     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9291        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9292        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9293        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9294        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9295        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9296        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9297        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9298        MOVE 'N'                 TO PLAN-MASTER-SW
  9299          GO TO 03XX-ERPLAN-AH-READ.
  9300
  9301     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9302
  9303     IF  PB-CANCELLATION
  9304         GO TO  0313-AH-ACCT-BEN-FOUND.
  9305
  9306     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9307       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9308          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9309          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9310             MOVE ER-2644             TO WS-ERROR
  9311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312          ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 170
* EL050.cbl
  9313             NEXT SENTENCE
  9314       ELSE
  9315          IF PB-COMPANY-ID NOT = 'NCL'
  9316             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9317                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9318
  9319 0313-AH-ACCT-BEN-FOUND.
  9320
  9321     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9322
  9323     IF PL-DEV-CODE NOT = SPACES
  9324        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9325
  9326     IF PL-DEV-PCT NUMERIC AND
  9327        PL-DEV-PCT NOT = ZEROS
  9328        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9329
  9330     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9331        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9332
  9333     IF PL-TOL-REF-AMT NOT EQUAL +0
  9334        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9335
  9336     IF PL-TOL-PREM-PCT GREATER THAN +0
  9337        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9338
  9339     IF PL-TOL-REF-PCT GREATER THAN +0
  9340        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9341
  9342     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9343        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9344
  9345     IF PL-OVER-SHORT-AMT NUMERIC AND
  9346                          PL-OVER-SHORT-AMT > +0
  9347        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9348
  9349     IF PL-OVER-SHORT-PCT NUMERIC AND
  9350                          PL-OVER-SHORT-PCT > +0
  9351        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9352
  9353     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9354        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9355        IF WS-IG-OVRD-AM EQUAL SPACES
  9356            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9357
  9358 0314-A-H-BENEFIT-FOUND.
  9359
  9360     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9361
  9362     IF PB-ISSUE
  9363        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9364       ELSE
  9365        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9366
  9367     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9368     if cf-maximum-benefits (sub3) numeric
  9369        move cf-maximum-benefits (sub3)
  9370                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 171
* EL050.cbl
  9371     else
  9372        move zeros               to ws-ah-max-bens
  9373     end-if
  9374     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9375     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9376     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9377                                         WS-AH-REFUND-CALC.
  9378
  9379     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9380        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9381
  9382     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9383        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9384     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9385
  9386     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9387     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9388     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9389     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9390     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9391     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9392
  9393     IF PB-COMPANY-ID = 'NCL'  AND
  9394        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9395         NEXT SENTENCE
  9396     ELSE
  9397         IF SUB5 NOT GREATER THAN +20
  9398            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9399                MOVE WS-SAVE-BENEFIT-REM-TERM
  9400                                      TO WS-AM-AH-BENE-REM-TERM
  9401                                         EC-BR-AH-REM-TERM-CALC.
  9402
  9403     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9404     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9405
  9406     GO TO 0400-FIND-CARRIER.
  9407
  9408 0399-BENEFIT-NOT-FOUND.
  9409
  9410     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9411     MOVE ER-2605                TO WS-ERROR.
  9412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9413
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 172
* EL050.cbl
  9415
  9416 0400-FIND-CARRIER.
  9417
  9418     MOVE PB-SV-CARRIER          TO WS-CARR.
  9419
  9420     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9421     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9422     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9423     MOVE '6'                    TO CNTL-REC-TYPE.
  9424
  9425*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9426     MOVE SPACE                  TO WS-DMD-RATING-SW
  9427                                    EC-BR-DMD-RATING-SW.
  9428
  9429     MOVE '2'                    TO RC-SW-1.
  9430     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9431
  9432     IF NOT CF-CARRIER-MASTER
  9433        GO TO 0400-CARRIER-NOT-FOUND.
  9434
  9435 0400-BUILD-CARR-TOL.
  9436
  9437     IF CF-CR-TOL-PREM NUMERIC AND
  9438        CF-CR-TOL-PREM GREATER THAN +0
  9439        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9440                                    WS-TOL-AH-PREM.
  9441
  9442     IF CF-CR-TOL-REFUND NUMERIC AND
  9443        CF-CR-TOL-REFUND GREATER THAN +0
  9444        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9445                                    WS-TOL-AH-REFUND.
  9446
  9447     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9448        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9449        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9450                                    WS-AH-REFUND-OVS-AMT.
  9451
  9452     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9453        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9454        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9455                                    WS-AH-REFUND-OVS-PCT.
  9456
  9457     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9458        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9459        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9460                                    WS-TOL-AH-PREM-PCT.
  9461
  9462     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9463        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9464        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9465                                     WS-TOL-AH-REFUND-PCT.
  9466
  9467     IF CF-COMPANY-ID EQUAL 'DMD'
  9468         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9469                                    EC-BR-DMD-RATING-SW.
  9470
  9471     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9472     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 173
* EL050.cbl
  9473        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9474     END-IF
  9475     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9476        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9477     END-IF
  9478     IF WS-TOL-CLP-PCT = ZEROS
  9479        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9480     END-IF
  9481
  9482     IF WS-SPP-LEASE-COMM = ZEROS
  9483        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9484     END-IF
  9485     GO TO 0400-FIND-ERPDEF.
  9486
  9487 0400-CARRIER-NOT-FOUND.
  9488
  9489     MOVE ER-2602                TO WS-ERROR.
  9490     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9491
  9492 0400-FIND-ERPDEF.
  9493*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9494     IF (PB-COMPANY-ID = 'DCC')
  9495        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9496        CONTINUE
  9497     ELSE
  9498        GO TO 0400-FIND-ERCOMP
  9499     END-IF
  9500     MOVE ' '                    TO PDEF-MASTER-SW
  9501     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9502     MOVE PB-STATE               TO ERPDEF-STATE
  9503     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9504        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9505     END-IF
  9506     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9507     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9508     IF PB-ISSUE
  9509        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9510     ELSE
  9511        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9512     END-IF
  9513     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9514     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9515     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9516     IF PDEF-MASTER-FOUND
  9517        MOVE 'N'                 TO PDEF-MASTER-SW
  9518        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9519        IF PDEF-MASTER-FOUND
  9520           IF (ERPDEF-KEY-SAVE (1:16) =
  9521                        PD-CONTROL-PRIMARY (1:16))
  9522              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9523              CONTINUE
  9524           ELSE
  9525              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9526              IF (ERPDEF-KEY-SAVE (1:16) =
  9527                        PD-CONTROL-PRIMARY (1:16))
  9528                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9529                 CONTINUE
  9530              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 174
* EL050.cbl
  9531                 MOVE 'N'        TO PDEF-MASTER-SW
  9532              END-IF
  9533           END-IF
  9534        END-IF
  9535        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9536     END-IF
  9537     IF PDEF-MASTER-FOUND
  9538        IF PD-TRUNCATED = 'Y'
  9539           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9540        END-IF
  9541     END-IF
  9542     .
  9543 0400-FIND-ERCOMP.
  9544     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9545        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9546           (WS-SUB1 > +10)
  9547           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9548                 OR 'A' OR 'N'
  9549              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9550              MOVE PB-CARRIER    TO COMP-CARRIER
  9551              MOVE PB-GROUPING   TO COMP-GROUPING
  9552              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9553              MOVE AM-AGT (WS-SUB1)
  9554                                 TO COMP-FIN-RESP
  9555              MOVE 'G'           TO COMP-TYPE
  9556              PERFORM 8582-READ-COMPENSATION-MASTER
  9557                                 THRU 8582-EXIT
  9558              IF COMP-MASTER-FOUND
  9559                 IF CO-GA-INACTIVE
  9560                    MOVE ER-2763 TO WS-ERROR
  9561                    PERFORM 9900-ERROR-FORMAT
  9562                                 THRU 9900-EXIT
  9563                    MOVE +11     TO WS-SUB1
  9564                 END-IF
  9565                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9566                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9567                    MOVE ER-2788 TO WS-ERROR
  9568                    PERFORM 9900-ERROR-FORMAT
  9569                                 THRU 9900-EXIT
  9570                    MOVE +11     TO WS-SUB1
  9571                 END-IF
  9572              END-IF
  9573           END-IF
  9574        END-PERFORM
  9575     END-IF
  9576     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9577        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9578           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9579                                    WS-CLP-STATE
  9580        ELSE
  9581           MOVE SPACES           TO PB-I-CLP-STATE
  9582                                    WS-CLP-STATE
  9583        END-IF
  9584     END-IF
  9585
  9586     IF (PB-COMPANY-ID = 'DCC')
  9587        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9588        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 175
* EL050.cbl
  9589        CONTINUE
  9590     ELSE
  9591        GO TO 0400-FIND-STATE-RECORD
  9592     END-IF
  9593     MOVE SPACES                 TO WS-CLP-STATE
  9594     MOVE +0                     TO WS-BANK-FEE
  9595                                    WS-BANK-LFEE
  9596                                    WS-BANK-NOCHRGB
  9597
  9598     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9599     IF (PB-ISSUE)
  9600        AND (PB-I-BANK-NUMBER NOT =
  9601            SPACES AND ZEROS AND LOW-VALUES)
  9602        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9603     ELSE
  9604        IF (PB-CANCELLATION)
  9605           AND (PB-CI-BANK-NUMBER NOT =
  9606                SPACES AND ZEROS AND LOW-VALUES)
  9607           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9608        END-IF
  9609     END-IF
  9610     IF COMP-FIN-RESP NOT = LOW-VALUES
  9611        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9612        MOVE PB-CARRIER          TO COMP-CARRIER
  9613        MOVE PB-GROUPING         TO COMP-GROUPING
  9614        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9615        MOVE 'B'                 TO COMP-TYPE
  9616        PERFORM 8582-READ-COMPENSATION-MASTER
  9617                                 THRU 8582-EXIT
  9618        IF COMP-MASTER-FOUND
  9619           IF CO-MAX-BANK-FEE NOT NUMERIC
  9620              MOVE +0            TO CO-MAX-BANK-FEE
  9621           END-IF
  9622           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9623              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9624           END-IF
  9625           IF CO-GA-INACTIVE
  9626              MOVE ER-2763       TO WS-ERROR
  9627              PERFORM 9900-ERROR-FORMAT
  9628                                 THRU 9900-EXIT
  9629           END-IF
  9630           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9631              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9632              MOVE ER-2788 TO WS-ERROR
  9633              PERFORM 9900-ERROR-FORMAT
  9634                                 THRU 9900-EXIT
  9635              MOVE +11     TO WS-SUB1
  9636           END-IF
  9637           IF WS-AH-BEN-CATEGORY = 'G'
  9638              MOVE CO-MAX-BANK-FEE
  9639                                 TO WS-BANK-FEE
  9640                                    PB-I-BANK-FEE
  9641           ELSE
  9642              MOVE CO-MAX-BANK-FEE-LEASE
  9643                                 TO WS-BANK-LFEE
  9644                                    PB-I-BANK-FEE
  9645           END-IF
  9646           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 176
* EL050.cbl
  9647              AND (WS-AH-REFUND-CALC = 'G'))
  9648                        OR
  9649              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9650              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9651              CONTINUE
  9652           ELSE
  9653              MOVE ER-2789 TO WS-ERROR
  9654              PERFORM 9900-ERROR-FORMAT
  9655                                 THRU 9900-EXIT
  9656           END-IF
  9657           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9658                                    PB-I-CLP-STATE
  9659           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9660           MOVE CO-CARRIER       TO BXRF-CARRIER
  9661           MOVE CO-GROUPING      TO BXRF-GROUPING
  9662           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9663           MOVE BXRF-MAX-REC-LENGTH
  9664                                 TO BXRF-REC-LENGTH
  9665           PERFORM 8584-READ-BANK-CROSS-REF
  9666                                 THRU 8584-EXIT
  9667           IF BXRF-MASTER-FOUND
  9668              MOVE ' '           TO BANK-ACCT-SW
  9669              MOVE BK-BANK-POINTER-CNT
  9670                                 TO BK-BANK-POINTER-CNT
  9671              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9672                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9673                 OR (BANK-ACCT-FOUND)
  9674                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9675                    AND (BK-AM-EXP-DT (WS-SUB1)
  9676                                 > PB-CERT-EFF-DT)
  9677                    AND (BK-AM-EFF-DT (WS-SUB1)
  9678                                 NOT > PB-CERT-EFF-DT)
  9679                    SET BANK-ACCT-FOUND TO TRUE
  9680                 END-IF
  9681              END-PERFORM
  9682              IF NOT BANK-ACCT-FOUND
  9683                 MOVE ZEROS      TO WS-BANK-FEE
  9684                                    WS-BANK-LFEE
  9685                 MOVE ER-2869    TO WS-ERROR
  9686                 PERFORM 9900-ERROR-FORMAT
  9687                                 THRU 9900-EXIT
  9688              ELSE
  9689                 PERFORM 5000-PROCESS-REPS
  9690                                 THRU 5000-EXIT
  9691                 IF AGENT-MASTER-FOUND
  9692                    MOVE +0      TO WS-BANK-FEE
  9693                                    WS-BANK-LFEE
  9694*                   MOVE AG-SPP-FEES (1)
  9695*                                TO PB-I-BANK-FEE
  9696*                                   WS-BANK-FEE
  9697                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9698                       (WS-SUB1 > +10)
  9699                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9700                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9701                       END-IF
  9702                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9703                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9704                       END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 177
* EL050.cbl
  9705                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9706                          AG-SPP-FEES (WS-SUB1)
  9707                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9708                          AG-SPP-LFEES (WS-SUB1)
  9709                    END-PERFORM
  9710                    IF WS-AH-BEN-CATEGORY = 'G'
  9711                       MOVE WS-BANK-FEE
  9712                                 TO PB-I-BANK-FEE
  9713                    ELSE
  9714                       MOVE WS-BANK-LFEE
  9715                                 TO PB-I-BANK-FEE
  9716                    END-IF
  9717                 END-IF
  9718              END-IF
  9719           END-IF
  9720        ELSE
  9721           MOVE ER-2879          TO WS-ERROR
  9722           PERFORM 9900-ERROR-FORMAT
  9723                                 THRU 9900-EXIT
  9724        END-IF
  9725     ELSE
  9726        MOVE ER-2879             TO WS-ERROR
  9727        PERFORM 9900-ERROR-FORMAT
  9728                                 THRU 9900-EXIT
  9729     END-IF
  9730     IF WS-AH-BEN-CATEGORY = 'G'
  9731        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9732        + WS-BANK-FEE
  9733     ELSE
  9734        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9735        + WS-BANK-LFEE
  9736     END-IF
  9737     .
  9738 0400-FIND-STATE-RECORD.
  9739
  9740     IF WK-STATE-ADDR NOT = ZEROS
  9741         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9742         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9743         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9744         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9745         IF PB-SV-STATE = CF-STATE-CODE
  9746             GO TO 0405-CONTINUE-EDIT
  9747         ELSE
  9748             NEXT SENTENCE
  9749     ELSE
  9750         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9751
  9752     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9753     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9754     MOVE '3'                    TO CNTL-REC-TYPE.
  9755     MOVE +0                     TO CNTL-SEQ-NO.
  9756
  9757     MOVE '3'                    TO RC-SW-2.
  9758     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9759
  9760     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9761        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9762        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 178
* EL050.cbl
  9763        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9764                                    WS-TOL-AH-CLAIM
  9765                                    WS-MINIMUM-REFUND
  9766                                    WS-TOL-LF-PREM
  9767                                    WS-TOL-AH-PREM
  9768                                    WS-TOL-LF-REFUND
  9769                                    WS-TOL-AH-REFUND
  9770                                    EC-ST-TOL-PREM-PCT
  9771                                    WS-TOL-LF-PREM-PCT
  9772                                    WS-TOL-AH-PREM-PCT
  9773                                    EC-ST-TOL-REFUND-PCT
  9774                                    WS-TOL-LF-REFUND-PCT
  9775                                    WS-TOL-AH-REFUND-PCT
  9776                                    EC-ST-TOL-PREM
  9777                                    EC-ST-TOL-REFUND
  9778                                    EC-ST-FST-PMT-DAYS-MAX
  9779                                    WS-FREE-LOOK-PERIOD
  9780                                    WS-ST-LF-PREM-TAX
  9781                                    WS-ST-AH-PREM-TAX-I
  9782                                    WS-ST-AH-PREM-TAX-G
  9783                                    WS-BANK-FEE
  9784                                    WS-BANK-LFEE
  9785                                    WS-TOL-CLP-PCT
  9786                                    WS-SPP-LEASE-COMM
  9787                                    WS-INT-PERIODS
  9788                                    WS-EXTRA-PMTS
  9789        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9790                                    EC-ST-FST-PMT-DAYS-CHG
  9791                                    WS-LF-REM-TERM-CALC
  9792                                    WS-LF-REFUND-CALC
  9793                                    EC-ST-LF-REM-TERM-CALC
  9794                                    EC-ST-LF-REFUND-CALC
  9795                                    WS-AH-REM-TERM-CALC
  9796                                    WS-AH-REFUND-CALC
  9797                                    WS-LF-BEN-CATEGORY
  9798                                    WS-AH-BEN-CATEGORY
  9799                                    WS-CLP-STATE
  9800                                    WS-ST-REFUND-CLAIM-FLAG
  9801                                    WS-ST-CAUSAL-STATE
  9802                                    ws-st-agent-sig-edit
  9803                                    EC-ST-AH-REM-TERM-CALC
  9804                                    EC-ST-AH-REFUND-CALC
  9805          GO TO 0499-STATE-NOT-FOUND.
  9806
  9807     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9808
  9809 0405-CONTINUE-EDIT.
  9810
  9811     if pb-company-id = 'AHL'
  9812        continue
  9813     else
  9814        IF PB-CERT-PRIME NOT NUMERIC
  9815           MOVE ER-2722          TO WS-ERROR
  9816           PERFORM 9900-ERROR-FORMAT
  9817                                 THRU 9900-EXIT
  9818        end-if
  9819     END-IF
  9820*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 179
* EL050.cbl
  9821*       MOVE +0                  TO SUB3
  9822*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9823*       IF SUB3 > +0
  9824*          MOVE ER-2722          TO WS-ERROR
  9825*          PERFORM 9900-ERROR-FORMAT
  9826*                                THRU 9900-EXIT
  9827*       END-IF
  9828*    END-IF
  9829*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9830*       IF PB-CERT-PRIME NOT NUMERIC
  9831*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9832*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9833*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9834*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9835*
  9836*          MOVE ER-2722          TO WS-ERROR
  9837*          PERFORM 9900-ERROR-FORMAT
  9838*                                THRU 9900-EXIT
  9839*       END-IF
  9840*    END-IF
  9841
  9842     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9843
  9844     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9845        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9846                                    WS-TOL-AH-CLAIM.
  9847
  9848     IF CF-ST-REFUND-MIN NOT NUMERIC
  9849        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9850
  9851     IF CF-ST-REFUND-MIN NOT = ZEROS
  9852        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9853
  9854     IF CF-ST-TOL-PREM  NOT = ZEROS
  9855        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9856                                    WS-TOL-AH-PREM
  9857        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9858
  9859     IF CF-ST-TOL-REFUND NOT = ZEROS
  9860        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9861                                    WS-TOL-AH-REFUND
  9862        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9863
  9864     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9865        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9866        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9867                                    WS-AH-REFUND-OVS-AMT
  9868                                    EC-ST-OVR-SHT-AMT.
  9869
  9870     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9871        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9872        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9873                                    WS-TOL-LF-PREM-PCT
  9874                                    WS-TOL-AH-PREM-PCT.
  9875
  9876     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9877        CF-ST-TOL-REF-PCT GREATER THAN +0
  9878        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 180
* EL050.cbl
  9879                                    WS-TOL-LF-REFUND-PCT
  9880                                    WS-TOL-AH-REFUND-PCT.
  9881
  9882     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9883        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9884        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9885                                    WS-AH-REFUND-OVS-PCT
  9886                                    EC-ST-OVR-SHT-PCT.
  9887
  9888     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9889     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9890
  9891     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9892          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9893
  9894     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9895     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9896     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9897
  9898     IF CF-ST-LF-PREM-TAX NUMERIC
  9899        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9900     END-IF
  9901     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9902        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9903     END-IF
  9904     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9905        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9906     END-IF
  9907
  9908     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9909         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9910     END-IF.
  9911
  9912     IF CF-ST-CAUSAL-STATE > SPACES
  9913         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9914     END-IF.
  9915     if cf-st-extra-interest-periods not numeric
  9916        move zeros               to cf-st-extra-interest-periods
  9917     end-if
  9918     if cf-st-extra-payments not numeric
  9919        move zeros               to cf-st-extra-payments
  9920     end-if
  9921
  9922     move cf-st-extra-interest-periods
  9923                                 to ws-int-periods
  9924     move cf-st-extra-payments   to ws-extra-pmts
  9925     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9926     move cf-st-net-only-state   to ws-net-only-state
  9927     IF WS-LF-BENEFIT-CD = ZEROS
  9928        GO TO 0410-CHECK-AH.
  9929
  9930     IF CF-ST-RT-CALC NOT = SPACES
  9931        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9932                                    EC-ST-LF-REM-TERM-CALC
  9933     END-IF
  9934
  9935     IF WS-LF-COVERAGE-TYPE = 'R'
  9936        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 181
* EL050.cbl
  9937           IF CF-ST-RF-LN-CALC > '0'
  9938              MOVE CF-ST-RF-LN-CALC
  9939                                 TO WS-LF-REFUND-CALC
  9940                                    EC-ST-LF-REFUND-CALC
  9941           END-IF
  9942        ELSE
  9943           IF CF-ST-RF-LR-CALC > '0'
  9944              MOVE CF-ST-RF-LR-CALC
  9945                                 TO WS-LF-REFUND-CALC
  9946                                    EC-ST-LF-REFUND-CALC
  9947           END-IF
  9948        END-IF
  9949     ELSE
  9950        IF CF-ST-RF-LL-CALC > '0'
  9951           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9952                                    EC-ST-LF-REFUND-CALC
  9953        END-IF
  9954     END-IF
  9955
  9956     IF CF-ST-RT-CALC NOT = SPACES
  9957        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9958                                    EC-ST-LF-REM-TERM-CALC
  9959     END-IF
  9960
  9961     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9962     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9963
  9964     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9965
  9966     IF NO-BENEFIT-FOUND
  9967        GO TO 0410-CHECK-AH.
  9968
  9969     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9970        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9971                                 TO EC-ST-LF-REM-TERM-CALC
  9972                                    WS-LF-REM-TERM-CALC
  9973     END-IF
  9974
  9975     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9976        MOVE CF-ST-REFUND-CALC (SUB3)
  9977                                 TO WS-LF-REFUND-CALC
  9978                                    EC-ST-LF-REFUND-CALC
  9979     END-IF
  9980*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9981     if cf-st-extra-periods (sub3) not numeric
  9982        move zeros               to cf-st-extra-periods (sub3)
  9983     end-if
  9984     if cf-st-extra-periods (sub3) > zeros
  9985        if ws-lf-ben-category = 'P'
  9986           move cf-st-extra-periods (sub3)
  9987                                 to ws-extra-pmts
  9988        else
  9989           if ws-lf-ben-category = 'I'
  9990              move cf-st-extra-periods (sub3)
  9991                                 to ws-int-periods
  9992           end-if
  9993        end-if
  9994     end-if
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 182
* EL050.cbl
  9995     .
  9996 0410-CHECK-AH.
  9997
  9998     IF WS-AH-BENEFIT-CD = ZEROS
  9999        GO TO 0500-SET-ACCOUNT.
 10000
 10001     IF CF-ST-RT-CALC NOT = SPACES
 10002        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10003                                    EC-ST-AH-REM-TERM-CALC
 10004     END-IF
 10005
 10006     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10007        IF CF-ST-RF-CP-CALC > '0'
 10008           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10009                                    EC-ST-AH-REFUND-CALC
 10010        END-IF
 10011     ELSE
 10012        IF CF-ST-RF-AH-CALC > '0'
 10013           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10014                                    EC-ST-AH-REFUND-CALC
 10015        END-IF
 10016     END-IF
 10017     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10018     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10019
 10020     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10021
 10022     IF NO-BENEFIT-FOUND
 10023        GO TO 0500-SET-ACCOUNT.
 10024
 10025     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10026        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10027                                 TO WS-AH-REM-TERM-CALC
 10028                                    EC-ST-AH-REM-TERM-CALC
 10029     END-IF
 10030
 10031     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10032        MOVE CF-ST-REFUND-CALC (SUB3)
 10033                                 TO WS-AH-REFUND-CALC
 10034                                    EC-ST-AH-REFUND-CALC
 10035     END-IF
 10036
 10037*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10038
 10039     GO TO 0500-SET-ACCOUNT.
 10040
 10041 0499-STATE-NOT-FOUND.
 10042
 10043     MOVE ER-2603                TO WS-ERROR.
 10044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10045
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 183
* EL050.cbl
 10047
 10048 0500-SET-ACCOUNT.
 10049*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10050     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10051        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10052        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10053        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10054        MOVE '3'                 TO CNTL-REC-TYPE
 10055        MOVE +0                  TO CNTL-SEQ-NO
 10056
 10057        MOVE '3'                 TO RC-SW-2
 10058        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10059
 10060        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10061           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10062           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10063           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10064                                    WS-ST-AH-PREM-TAX-I
 10065                                    WS-ST-AH-PREM-TAX-G
 10066        ELSE
 10067           IF CF-ST-LF-PREM-TAX NUMERIC
 10068              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10069           END-IF
 10070           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10071              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10072           END-IF
 10073           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10074              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10075           END-IF
 10076        END-IF
 10077        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10078     END-IF
 10079*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10080*  FOR DCC ONLY
 10081     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10082
 10083        MOVE ' '                 TO STAT-MASTER-SW
 10084        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10085        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10086        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10087        MOVE PB-STATE            TO ELSTAT-STATE
 10088        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10089           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10090        END-IF
 10091
 10092        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10093        SET BIN-TO-GREG          TO TRUE
 10094        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10095        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10096        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10097
 10098        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10099        IF STAT-MASTER-FOUND
 10100           MOVE 'N'              TO STAT-MASTER-SW
 10101           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10102           IF STAT-MASTER-FOUND
 10103              IF (ELSTAT-KEY-SAVE (1:12) =
 10104                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 184
* EL050.cbl
 10105                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10106                    MOVE 'F'        TO STAT-MASTER-SW
 10107                 ELSE
 10108                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10109                    IF (STAT-MASTER-FOUND)
 10110                       AND (ELSTAT-KEY-SAVE (1:12) =
 10111                           SF-CONTROL-PRIMARY (1:12))
 10112                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10113                       MOVE 'F'     TO STAT-MASTER-SW
 10114                    END-IF
 10115                 END-IF
 10116              END-IF
 10117           END-IF
 10118        END-IF
 10119
 10120        IF STAT-MASTER-SW = 'F'
 10121           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10122              and (sf-st-lf-prem-tax > zeros)
 10123              MOVE SF-ST-LF-PREM-TAX
 10124                                 TO WS-ST-LF-PREM-TAX
 10125           END-IF
 10126           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10127              and (sf-st-ah-prem-tax-i > zeros)
 10128              MOVE SF-ST-AH-PREM-TAX-I
 10129                                 TO WS-ST-AH-PREM-TAX-I
 10130           END-IF
 10131           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10132              and (sf-st-ah-prem-tax-g > zeros)
 10133              MOVE SF-ST-AH-PREM-TAX-G
 10134                                 TO WS-ST-AH-PREM-TAX-G
 10135           END-IF
 10136        END-IF
 10137     END-IF
 10138     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10139        AND (PB-ISSUE)
 10140        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10141        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10142        AND (AM-GPCD = 06)
 10143        MOVE 'Y'                 TO WS-GOOD-HIN
 10144        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10145           MOVE PB-I-VIN         TO WS-WORK-VIN
 10146           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10147              (V1 > 16)
 10148              IF WS-WORK-VIN (V1:1) NUMERIC
 10149                 MOVE WS-WORK-VIN-N (V1)
 10150                                 TO WS-ROW-B-VAL (V1)
 10151              ELSE
 10152                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10153                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10154                    OR (V2 > 26)
 10155                 END-PERFORM
 10156                 IF V2 < 27
 10157                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10158                 ELSE
 10159                    MOVE 'N'     TO WS-GOOD-HIN
 10160                 END-IF
 10161              END-IF
 10162              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 185
* EL050.cbl
 10163                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10164              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10165                 WS-ROW-D-VAL (V1)
 10166           END-PERFORM
 10167           MOVE ZEROS            TO WS-VIN-REMAINDER
 10168           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10169             REMAINDER WS-VIN-REMAINDER
 10170           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10171              CONTINUE
 10172           ELSE
 10173              MOVE 'N'           TO WS-GOOD-HIN
 10174           END-IF
 10175        ELSE
 10176           MOVE 'N'              TO WS-GOOD-HIN
 10177        END-IF
 10178        IF WS-GOOD-HIN NOT = 'Y'
 10179           MOVE ER-3826           TO WS-ERROR
 10180           PERFORM 9900-ERROR-FORMAT
 10181                                 THRU 9900-EXIT
 10182        END-IF
 10183     END-IF
 10184     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10185        AND (PB-ISSUE)
 10186        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10187        AND (AM-GPCD NOT = 06)
 10188        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10189           perform 3400-edit-vin thru 3400-exit
 10190        ELSE
 10191          MOVE ER-3826           TO WS-ERROR
 10192          PERFORM 9900-ERROR-FORMAT
 10193                                 THRU 9900-EXIT
 10194        END-IF
 10195     END-IF
 10196     if (pb-company-id = 'CID')
 10197        and (pb-issue)
 10198        and (pb-i-vin not = spaces and low-values and zeros)
 10199        perform 3400-edit-vin    thru 3400-exit
 10200     end-if
 10201******************************************************************
 10202******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10203******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10204******* METHODS.
 10205******************************************************************
 10206     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10207        IF PB-CANCELLATION
 10208           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10209              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10210                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10211                IF FORM-MASTER-FOUND
 10212                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10213******************************************************************
 10214
 10215     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10216     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10217
 10218     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10219     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10220     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 186
* EL050.cbl
 10221     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10222
 10223
 10224     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10225     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10226     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10227
 10228     IF AM-LF-OB-RATE NOT NUMERIC
 10229         MOVE ZERO               TO AM-LF-OB-RATE.
 10230
 10231     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10232         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10233
 10234     IF AM-AH-OB-RATE NOT NUMERIC
 10235         MOVE ZERO               TO AM-AH-OB-RATE.
 10236
 10237     IF WS-LF-JOINT-INDICATOR = 'J'
 10238         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10239     ELSE
 10240         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10241
 10242     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10243
 10244     IF WS-IG-OVRD-AM  EQUAL SPACE
 10245         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10246
 10247     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10248         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10249                                       WS-IG-OVRD
 10250     ELSE
 10251         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10252             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10253                                       WS-IG-OVRD
 10254         ELSE
 10255             MOVE AM-IG             TO WS-IG-OVRD-AH
 10256                                       WS-IG-OVRD.
 10257
 10258     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10259         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10260                                       WS-IG-OVRD
 10261     ELSE
 10262         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10263             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10264                                       WS-IG-OVRD
 10265         ELSE
 10266             MOVE AM-IG             TO WS-IG-OVRD-LF
 10267                                       WS-IG-OVRD.
 10268
 10269     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10270     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10271     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10272     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10273*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10274     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10275                                              TO 'PRLDSFCTIA'.
 10276
 10277     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10278     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 187
* EL050.cbl
 10279     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10280     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10281
 10282     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10283     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10284     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10285     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10286     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10287     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10288     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10289
 10290     IF WS-ACCT-AH-DEV-PCT > +0
 10291        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10292     ELSE
 10293        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10294
 10295     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10296        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10297     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10298        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10299
 10300        IF AM-EARN-METHOD-L = 'S'
 10301            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10302                                        WS-LF-REFUND-CALC.
 10303
 10304        IF AM-EARN-METHOD-R = 'S'
 10305            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10306                                        WS-LF-REFUND-CALC.
 10307
 10308     IF WS-LF-COVERAGE-TYPE = 'R'
 10309         IF AM-EARN-METHOD-R = 'R'
 10310            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10311                                    WS-LF-REFUND-CALC.
 10312     IF WS-LF-COVERAGE-TYPE = 'R'
 10313         IF AM-EARN-METHOD-R = 'P'
 10314            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10315                                    WS-LF-REFUND-CALC.
 10316     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10317         IF AM-EARN-METHOD-L = 'R'
 10318            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10319                                    WS-LF-REFUND-CALC.
 10320     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10321         IF AM-EARN-METHOD-L = 'P'
 10322            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10323                                    WS-LF-REFUND-CALC.
 10324     IF WS-LF-COVERAGE-TYPE = 'R'
 10325         IF AM-EARN-METHOD-R = 'A'
 10326            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10327                                    WS-LF-REFUND-CALC.
 10328     IF WS-LF-COVERAGE-TYPE = 'R'
 10329         IF AM-EARN-METHOD-R = 'M'
 10330            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10331                                    WS-LF-REFUND-CALC.
 10332     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10333         IF AM-EARN-METHOD-L = 'A'
 10334            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10335                                    WS-LF-REFUND-CALC.
 10336     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 188
* EL050.cbl
 10337         IF AM-EARN-METHOD-L = 'M'
 10338            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10339                                    WS-LF-REFUND-CALC.
 10340
 10341     IF AM-EARN-METHOD-A = 'R'
 10342        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10343                                    WS-AH-REFUND-CALC.
 10344     IF AM-EARN-METHOD-A = 'P'
 10345        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10346                                    WS-AH-REFUND-CALC.
 10347     IF AM-EARN-METHOD-A = 'C'
 10348        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10349                                    WS-AH-REFUND-CALC.
 10350     IF AM-EARN-METHOD-A = 'A'
 10351        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10352                                    WS-AH-REFUND-CALC.
 10353     IF AM-EARN-METHOD-A = 'M'
 10354        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10355                                    WS-AH-REFUND-CALC.
 10356     IF AM-EARN-METHOD-A = 'N'
 10357        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10358                                    WS-AH-REFUND-CALC.
 10359     IF AM-EARN-METHOD-A = 'S'
 10360        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10361                                    WS-AH-REFUND-CALC.
 10362
 10363     IF AM-TOL-PREM NOT = ZEROS
 10364        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10365                                    WS-TOL-AH-PREM.
 10366
 10367     IF AM-OVR-SHT-AMT NUMERIC AND
 10368                  AM-OVR-SHT-AMT > 0
 10369        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10370                                    EC-AM-LF-OVR-SHT-AMT
 10371                                    WS-AH-REFUND-OVS-AMT
 10372                                    EC-AM-AH-OVR-SHT-AMT.
 10373
 10374     IF AM-OVR-SHT-PCT NUMERIC AND
 10375                    AM-OVR-SHT-PCT > 0
 10376        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10377                                    EC-AM-LF-OVR-SHT-PCT
 10378                                    WS-AH-REFUND-OVS-PCT
 10379                                    EC-AM-AH-OVR-SHT-PCT.
 10380
 10381     IF AM-TOL-REF-PCT NUMERIC AND
 10382                  AM-TOL-REF-PCT > 0
 10383        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10384                                    WS-TOL-AH-REFUND-PCT.
 10385
 10386     IF AM-TOL-REF  NOT = ZEROS  AND
 10387                  AM-TOL-REF NUMERIC
 10388        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10389                                    EC-AM-LF-TOL-REFUND
 10390                                    WS-TOL-AH-REFUND
 10391                                    EC-AM-AH-TOL-REFUND.
 10392
 10393     IF AM-TOL-CLM  NOT = ZEROS
 10394        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 189
* EL050.cbl
 10395                                    WS-TOL-AH-CLAIM.
 10396
 10397     IF AM-CLP-TOL-PCT NOT NUMERIC
 10398        MOVE +0                  TO AM-CLP-TOL-PCT
 10399     END-IF
 10400
 10401     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10402        MOVE +0                  TO AM-SPP-LEASE-COMM
 10403     END-IF
 10404     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10405        MOVE WS-PL-TOL-LF-PREM-PCT
 10406                                 TO WS-TOL-LF-PREM-PCT.
 10407
 10408     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10409        MOVE WS-PL-TOL-AH-PREM-PCT
 10410                                 TO WS-TOL-AH-PREM-PCT.
 10411
 10412     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10413        MOVE WS-PL-TOL-LF-REFUND-PCT
 10414                                 TO WS-TOL-LF-REFUND-PCT.
 10415
 10416     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10417        MOVE WS-PL-TOL-AH-REFUND-PCT
 10418                                 TO WS-TOL-AH-REFUND-PCT.
 10419
 10420     IF WS-PL-REF-OVS-AMT > +0
 10421        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10422
 10423     IF WS-PL-REF-OVS-PCT > +0
 10424        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10425
 10426     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10427        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10428     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10429        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10430     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10431        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10432     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10433        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10434     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10435        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10436     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10437        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10438
 10439     IF WS-AH-PL-REF-OVS-AMT > +0
 10440        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10441
 10442     IF WS-AH-PL-REF-OVS-PCT > +0
 10443        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10444
 10445     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10446     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10447
 10448     IF PB-CANCELLATION
 10449        GO TO 3000-CONTINUE-EDIT.
 10450
 10451     MOVE +1 TO SUB1.
 10452     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 190
* EL050.cbl
 10453     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10454
 10455     IF CF-COMPANY-ID = 'DMD'
 10456       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10457         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10458        ELSE
 10459         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10460
 10461  0525-FIND-ACCT-COMM.
 10462     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10463        NEXT SENTENCE
 10464      ELSE
 10465         ADD +1 TO SUB1
 10466         IF SUB1 LESS +11
 10467            GO TO 0525-FIND-ACCT-COMM
 10468          ELSE
 10469             GO TO 0560-EDIT-CONTINUE.
 10470
 10471     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10472     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10473                                    PB-I-LIFE-COMMISSION.
 10474***  IF PB-COMPANY-ID = 'CRI'
 10475     IF PB-PREM-ACCTNG-ONLY
 10476         GO TO 0560-EDIT-CONTINUE.
 10477
 10478     MOVE '0530' TO CTBL-SW.
 10479     MOVE ' '    TO WS-CTBL-READ-SW.
 10480
 10481
 10482 0530-GET-AH-COMP.
 10483     IF NO-AH-COVERAGE  OR
 10484        NO-AH-BENEFIT-MATCH
 10485           GO TO 0540-NEXT-READ-STEP.
 10486
 10487     IF AM-A-COM (SUB1) NUMERIC
 10488        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10489         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10490         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10491         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10492         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10493     ELSE
 10494          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10495          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10496          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10497          MOVE ZEROS             TO WS-SUB1
 10498                                    WS-COMMISSION
 10499          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10500          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10501          IF WS-COMMISSION > ZEROS
 10502             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10503             GO TO 0540-NEXT-READ-STEP
 10504          END-IF
 10505          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10506          IF CTBL-TABLE-FOUND
 10507             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10508                                        PB-I-AH-TERM
 10509             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10510             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 191
* EL050.cbl
 10511             GO TO 0540-NEXT-READ-STEP
 10512          ELSE
 10513             IF FIRST-TIME-THROUGH
 10514                 GO TO 0530-GET-AH-COMP
 10515             ELSE
 10516                 MOVE ER-2609                TO WS-ERROR
 10517                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10518
 10519 0540-NEXT-READ-STEP.
 10520     MOVE '0540' TO CTBL-SW.
 10521     MOVE ' '    TO WS-CTBL-READ-SW.
 10522
 10523 0540-GET-LF-COMP.
 10524     IF NO-LIFE-COVERAGE  OR
 10525        NO-LF-BENEFIT-MATCH
 10526           GO TO 0560-EDIT-CONTINUE.
 10527
 10528     IF WS-LF-JOINT-INDICATOR = 'J'
 10529        IF AM-J-COM (SUB1) NUMERIC
 10530           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10531           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10532           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10533           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10534           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10535        ELSE
 10536           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10537           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10538           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10539           MOVE ZEROS                TO WS-SUB1
 10540                                        WS-COMMISSION
 10541           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10542           IF WS-COMMISSION > ZEROS
 10543              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10544              GO TO 0560-EDIT-CONTINUE
 10545           END-IF
 10546           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10547           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10548           IF CTBL-TABLE-FOUND
 10549              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10550              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10551              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10552              GO TO 0560-EDIT-CONTINUE
 10553           ELSE
 10554              IF FIRST-TIME-THROUGH
 10555                  GO TO 0540-GET-LF-COMP
 10556              ELSE
 10557                  MOVE ER-2609                TO WS-ERROR
 10558                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10559                  GO TO 0560-EDIT-CONTINUE.
 10560
 10561     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10562        IF AM-L-COM (SUB1) NUMERIC
 10563           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10564           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10565           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10566           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10567           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10568        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 192
* EL050.cbl
 10569           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10570           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10571           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10572           MOVE ZEROS                TO WS-SUB1
 10573                                        WS-COMMISSION
 10574           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10575           IF WS-COMMISSION IS GREATER THAN ZEROS
 10576              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10577              GO TO 0560-EDIT-CONTINUE
 10578           END-IF
 10579           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10580           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10581           IF CTBL-TABLE-FOUND
 10582              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10583              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10584              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10585              GO TO 0560-EDIT-CONTINUE
 10586           ELSE
 10587              IF FIRST-TIME-THROUGH
 10588                  GO TO 0540-GET-LF-COMP
 10589              ELSE
 10590                  MOVE ER-2609                TO WS-ERROR
 10591                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10592
 10593*    GO TO 0560-EDIT-CONTINUE.
 10594
 10595 0560-EDIT-CONTINUE.
 10596     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10597                                    WS-AH-PMF-COMM
 10598*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10599*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10600     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10601        (SUB1 > +10)
 10602        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10603           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10604           MOVE '0530'           TO CTBL-SW
 10605           MOVE ' '              TO WS-CTBL-READ-SW
 10606           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10607           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10608           MOVE '0540'           TO CTBL-SW
 10609           MOVE ' '              TO WS-CTBL-READ-SW
 10610           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10611        END-IF
 10612     END-PERFORM
 10613     GO TO 0564-EDIT-CONTINUE
 10614     .
 10615 0561-CHECK-AH.
 10616     IF (NO-AH-COVERAGE)
 10617        OR (NO-AH-BENEFIT-MATCH)
 10618        CONTINUE
 10619     ELSE
 10620        IF (AM-A-COM (SUB1) NUMERIC)
 10621           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10622           IF (AM-COM-TYP (SUB1) = 'A')
 10623              AND (WS-AH-PMF-COMM = ZEROS)
 10624              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10625           END-IF
 10626           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 193
* EL050.cbl
 10627        ELSE
 10628           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10629           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10630           MOVE PB-AH-OVERRIDE-L1
 10631                                 TO CTBL-BEN-TYPE
 10632           MOVE ZEROS            TO WS-SUB1
 10633                                    WS-COMMISSION
 10634           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10635           PERFORM 8300-READ-CTBL-TABLE
 10636                                 THRU 8300-EXIT
 10637           IF CTBL-TABLE-FOUND
 10638              IF (AM-COM-TYP (SUB1) = 'A')
 10639                 AND (WS-AH-PMF-COMM = ZEROS)
 10640                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10641                                        PB-I-AH-TERM
 10642                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10643                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10644              END-IF
 10645              CONTINUE
 10646           ELSE
 10647              IF FIRST-TIME-THROUGH
 10648                 GO TO 0561-CHECK-AH
 10649              ELSE
 10650                 MOVE ER-2609    TO WS-ERROR
 10651                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10652              END-IF
 10653           END-IF
 10654        END-IF
 10655     END-IF
 10656     .
 10657 0561-EXIT.
 10658     EXIT.
 10659 0563-CHECK-LF.
 10660     IF (NO-LIFE-COVERAGE)
 10661        OR (NO-LF-BENEFIT-MATCH)
 10662        CONTINUE
 10663     ELSE
 10664        IF WS-LF-JOINT-INDICATOR = 'J'
 10665           IF AM-J-COM (SUB1) NUMERIC
 10666              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10667              IF (AM-COM-TYP (SUB1) = 'A')
 10668                 AND (WS-LF-PMF-COMM = ZEROS)
 10669                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10670              END-IF
 10671              CONTINUE
 10672           ELSE
 10673              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10674              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10675              MOVE PB-LIFE-OVERRIDE-L1
 10676                                 TO CTBL-BEN-TYPE
 10677              MOVE ZEROS         TO WS-SUB1
 10678                                    WS-COMMISSION
 10679              MOVE AM-J-COMA (SUB1)
 10680                                 TO CTBL-TABLE
 10681              PERFORM 8300-READ-CTBL-TABLE
 10682                                 THRU 8300-EXIT
 10683              IF CTBL-TABLE-FOUND
 10684                 IF (AM-COM-TYP (SUB1) = 'A')
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 194
* EL050.cbl
 10685                    AND (WS-LF-PMF-COMM = ZEROS)
 10686                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10687                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10688                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10689                 END-IF
 10690                 CONTINUE
 10691              ELSE
 10692                 IF FIRST-TIME-THROUGH
 10693                    GO TO 0563-CHECK-LF
 10694                 ELSE
 10695                    MOVE ER-2609 TO WS-ERROR
 10696                    PERFORM 9900-ERROR-FORMAT
 10697                                 THRU 9900-EXIT
 10698*                   GO TO 0560-EDIT-CONTINUE
 10699                 END-IF
 10700              END-IF
 10701           END-IF
 10702        ELSE
 10703           IF AM-L-COM (SUB1) NUMERIC
 10704              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10705              IF (AM-COM-TYP (SUB1) = 'A')
 10706                 AND (WS-LF-PMF-COMM = ZEROS)
 10707                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10708              END-IF
 10709              CONTINUE
 10710           ELSE
 10711              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10712              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10713              MOVE PB-LIFE-OVERRIDE-L1
 10714                                 TO CTBL-BEN-TYPE
 10715              MOVE ZEROS         TO WS-SUB1
 10716                                    WS-COMMISSION
 10717              MOVE AM-L-COMA (SUB1)
 10718                                 TO CTBL-TABLE
 10719              PERFORM 8300-READ-CTBL-TABLE
 10720                                 THRU 8300-EXIT
 10721              IF CTBL-TABLE-FOUND
 10722                 CONTINUE
 10723              ELSE
 10724                 IF FIRST-TIME-THROUGH
 10725                    GO TO 0563-CHECK-LF
 10726                 ELSE
 10727                    MOVE ER-2609 TO WS-ERROR
 10728                    PERFORM 9900-ERROR-FORMAT
 10729                                 THRU 9900-EXIT
 10730                 END-IF
 10731              END-IF
 10732           END-IF
 10733        END-IF
 10734     END-IF
 10735     .
 10736 0563-EXIT.
 10737     EXIT.
 10738 0564-EDIT-CONTINUE.
 10739
 10740     IF  PB-COMPANY-ID EQUAL 'DMD'
 10741         IF PB-I-NUM-BILLED EQUAL ZEROS
 10742            MOVE ER-8148       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 195
* EL050.cbl
 10743            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10744
 10745*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10746*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10747*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10748*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10749*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10750*         IF NO-CONVERSION-ERROR
 10751*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10752*         ELSE
 10753*             IF PB-COMPANY-ID EQUAL 'HAN'
 10754*                 MOVE ZEROS     TO PB-I-AGE.
 10755     IF PB-I-BIRTHDAY > LOW-VALUES
 10756        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10757        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10758        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10759        PERFORM 8500-DATE-CONVERT
 10760                                 THRU 8500-EXIT
 10761        IF NO-CONVERSION-ERROR
 10762           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10763           IF PB-I-AGE > ZEROS
 10764              IF WS-WORK-AGE NOT = PB-I-AGE
 10765                 MOVE ER-9501    TO WS-ERROR
 10766                 PERFORM 9900-ERROR-FORMAT
 10767                                 THRU 9900-EXIT
 10768              END-IF
 10769           ELSE
 10770              MOVE WS-WORK-AGE   TO PB-I-AGE
 10771           END-IF
 10772        END-IF
 10773     END-IF
 10774     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10775                                   WS-INS-AGE-SET
 10776     IF PB-I-AGE = ZEROS
 10777        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10778           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10779                                   WS-INS-AGE-SET
 10780           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10781
 10782     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10783                                   WS-AH-EDIT-AGE.
 10784
 10785     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10786        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10787        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10788        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10789        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10790        IF NO-CONVERSION-ERROR
 10791           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10792           IF PB-I-JOINT-AGE > 0
 10793              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10794                 MOVE ER-9503    TO WS-ERROR
 10795                 PERFORM 9900-ERROR-FORMAT
 10796                                 THRU 9900-EXIT
 10797              END-IF
 10798           ELSE
 10799              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10800           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 196
* EL050.cbl
 10801        ELSE
 10802           MOVE ZEROS            TO PB-I-JOINT-AGE
 10803        END-IF
 10804     END-IF
 10805     IF PB-I-JOINT-AGE NOT NUMERIC
 10806        MOVE ZERO               TO PB-I-JOINT-AGE.
 10807
 10808     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10809                                   WS-JNT-AGE-SET
 10810     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10811        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10812           (WS-AH-JOINT-INDICATOR = 'J')
 10813           IF PB-I-JOINT-AGE = ZEROS
 10814               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10815                                          WS-JNT-AGE-SET
 10816               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10817           END-IF
 10818        END-IF
 10819     END-IF
 10820
 10821     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10822     IF WS-LF-JOINT-INDICATOR = 'J'
 10823        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10824        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10825            IF  PB-I-JOINT-AGE = ZERO
 10826                MOVE ER-2686       TO WS-ERROR
 10827                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10828            ELSE
 10829                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10830                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10831                    IF PB-COMPANY-ID NOT = 'LBL'
 10832                        MOVE ER-2685    TO WS-ERROR
 10833                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10834
 10835     IF WS-AH-JOINT-INDICATOR = 'J'
 10836        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10837            IF  PB-I-JOINT-AGE = ZERO
 10838                MOVE ER-2686       TO WS-ERROR
 10839                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10840            ELSE
 10841                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10842                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10843                                           WS-EDIT-AGE
 10844                    IF PB-COMPANY-ID NOT = 'LBL'
 10845                        MOVE ER-2685    TO WS-ERROR
 10846                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10847
 10848******************************************************************
 10849*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10850******************************************************************
 10851
 10852     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10853        (WS-AH-SPECIAL-CALC-CD = 'O')
 10854        NEXT SENTENCE
 10855     ELSE
 10856        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10857          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10858           (WS-LF-JOINT-INDICATOR = 'J'  OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 197
* EL050.cbl
 10859            WS-AH-JOINT-INDICATOR = 'J')  AND
 10860           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10861            MOVE ER-2627             TO WS-ERROR
 10862            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10863
 10864     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10865        (WS-AH-SPECIAL-CALC-CD = 'O')
 10866         NEXT SENTENCE
 10867     ELSE
 10868         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10869            WS-AH-JOINT-INDICATOR = 'J'
 10870             IF PB-I-JOINT-INSURED = SPACES
 10871                 IF PB-COMPANY-ID NOT = 'JAL'
 10872                     MOVE ER-2696    TO WS-ERROR
 10873                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10874
 10875     IF PB-COMPANY-ID NOT = 'BOA'
 10876        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10877           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10878           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10879               PB-I-JOINT-INSURED NOT = SPACES)
 10880                MOVE ER-2691         TO WS-ERROR
 10881                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10882
 10883     IF PB-COMPANY-ID = 'BOA'
 10884        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10885           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10886            IF PB-I-JOINT-AGE NOT = ZEROS
 10887                MOVE ER-2691         TO WS-ERROR
 10888                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10889
 10890     IF PB-COMPANY-ID = 'CRI'
 10891        IF PB-I-SIG-SW = 'J'
 10892           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10893              WS-AH-JOINT-INDICATOR NOT = 'J'
 10894              MOVE ER-2675       TO WS-ERROR
 10895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10896
 10897     IF PB-COMPANY-ID = 'CRI'
 10898        IF PB-I-SIG-SW = 'S'
 10899           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10900              WS-AH-JOINT-INDICATOR = 'J'
 10901              MOVE ER-2676       TO WS-ERROR
 10902              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10903
 10904     IF PB-COMPANY-ID = 'CVL'
 10905         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10906            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10907              MOVE ER-2783           TO WS-ERROR
 10908              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10909     IF (WS-LF-JOINT-INDICATOR = 'J')
 10910        AND (WS-AH-JOINT-INDICATOR = 'J')
 10911        AND (PB-I-LF-TERM > 120)
 10912        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10913        MOVE ER-2783             TO WS-ERROR
 10914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10915     END-IF
 10916     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 198
* EL050.cbl
 10917
 10918     IF PB-I-INDV-GRP-OVRD = 'I'
 10919        MOVE ER-2666             TO WS-ERROR
 10920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10921        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10922
 10923     IF PB-I-INDV-GRP-OVRD = 'G'
 10924        MOVE ER-2666             TO WS-ERROR
 10925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10926        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10927
 10928     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10929        NEXT SENTENCE
 10930     ELSE
 10931        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10932
 10933     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10934        IF WS-ERROR = ER-2666
 10935           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10936           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10937
 10938     IF PB-COMPANY-ID = 'CID'
 10939        IF PB-STATE = 'UT' OR 'MO'
 10940           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10941                 OR '76' OR '77')
 10942                      OR
 10943               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10944                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10945                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10946                   OR '2K' OR '2L'))
 10947              AND PB-I-INDV-GRP-CD = 'I'
 10948              MOVE ER-2721             TO WS-ERROR
 10949              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10950           END-IF
 10951        END-IF
 10952     END-IF
 10953
 10954     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10955     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10956        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10957     ELSE
 10958        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10959     END-IF
 10960
 10961*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10962*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10963     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10964                                    ACCOUNT-AH-CK-SW.
 10965
 10966     IF PB-REISSUED-CERT       OR
 10967        PB-REIN-ONLY-CERT      OR
 10968        PB-POLICY-IS-DECLINED  OR
 10969        PB-POLICY-IS-VOIDED
 10970*       OR PB-MONTHLY-CERT
 10971         GO TO 3000-CONTINUE-EDIT.
 10972
 10973     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10974        IF WS-EDIT-AGE           > +65
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 199
* EL050.cbl
 10975           MOVE ER-2709          TO WS-ERROR
 10976           PERFORM 9900-ERROR-FORMAT
 10977                                 THRU 9900-EXIT
 10978        ELSE
 10979           IF WS-EDIT-AGE        > +55
 10980              MOVE ER-2718       TO WS-ERROR
 10981              PERFORM 9900-ERROR-FORMAT
 10982                                 THRU 9900-EXIT
 10983           END-IF
 10984        END-IF
 10985     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10986        IF WS-EDIT-AGE           > +65
 10987           MOVE ER-2709          TO WS-ERROR
 10988           PERFORM 9900-ERROR-FORMAT
 10989                                 THRU 9900-EXIT
 10990        END-IF
 10991     END-IF
 10992     .
 10993
 10994 0565-LIFE-PLAN-LIMIT-EDITS.
 10995
 10996     IF NOT LF-PLAN-MASTER-FOUND
 10997        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10998                                    EC-AM-LF-MAX-TOT-BEN
 10999        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11000
 11001     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11002
 11003     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11004         IF PL-LM-AGE (1) = ZEROS
 11005             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11006
 11007     IF NO-LF-BENEFIT-MATCH          OR
 11008        WS-LF-BENEFIT-CD = ZEROS     OR
 11009        WS-LF-SPECIAL-CALC-CD = 'M'
 11010        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11011
 11012     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11013     MOVE +1                     TO SUB2.
 11014
 11015     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11016        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11017           MOVE +5   TO SUB2
 11018           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11019              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11020              (PL-LM-AGE (SUB2) EQUAL +0)
 11021              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11022              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11023
 11024     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11025
 11026     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11027                               + PB-I-LF-ALT-BENEFIT-AMT.
 11028
 11029 0568-CHECK-LIFE-ATT-AGE.
 11030
 11031     IF PL-ATT-AGE NUMERIC AND
 11032        PL-ATT-AGE > +0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 200
* EL050.cbl
 11033        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11034     END-IF
 11035*    IF PL-ATT-AGE NUMERIC AND
 11036*       PL-ATT-AGE > +0
 11037*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11038*       IF PB-I-BIRTHDAY > LOW-VALUES
 11039*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11040*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11041*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11042*          SET BIN-PLUS-ELAPSED  TO TRUE
 11043*          PERFORM 8500-DATE-CONVERT
 11044*                                THRU 8500-EXIT
 11045*          IF NO-CONVERSION-ERROR
 11046*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11047*             MOVE ER-2669       TO WS-ERROR
 11048*             PERFORM 9900-ERROR-FORMAT
 11049*                                THRU 9900-EXIT
 11050*          END-IF
 11051*       ELSE
 11052*          IF WS-ATT-AGE >= PL-ATT-AGE
 11053*             MOVE ER-2669       TO WS-ERROR
 11054*             PERFORM 9900-ERROR-FORMAT
 11055*                                THRU 9900-EXIT
 11056*          END-IF
 11057*       END-IF
 11058*    END-IF
 11059     .
 11060 0570-CHECK-LIFE-LIMITS.
 11061
 11062     IF PB-COMPANY-ID EQUAL 'CRI'
 11063        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11064           IF SUB2 GREATER THAN +4
 11065              MOVE ER-2637 TO WS-ERROR
 11066              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11067              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11068
 11069     IF PB-COMPANY-ID  =  'NCL'
 11070        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11071            SUB2 GREATER THAN +8
 11072             MOVE 'U'         TO PB-BATCH-ENTRY
 11073             MOVE ER-2637     TO WS-ERROR
 11074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11075             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11076
 11077     IF SUB2 > +8
 11078        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11079           AND (PB-I-SIG-SW = 'Y')
 11080           CONTINUE
 11081        ELSE
 11082           MOVE ER-2637          TO WS-ERROR
 11083           PERFORM 9900-ERROR-FORMAT
 11084                                 THRU 9900-EXIT
 11085        END-IF
 11086        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11087     END-IF
 11088     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11089     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11090     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 201
* EL050.cbl
 11091
 11092     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11093        ADD +1  TO SUB2
 11094        GO TO 0570-CHECK-LIFE-LIMITS.
 11095
 11096     IF PB-COMPANY-ID = 'NCL'
 11097         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11098
 11099     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11100        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11101        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11102           AND (PB-I-SIG-SW = 'Y')
 11103           CONTINUE
 11104        ELSE
 11105           MOVE ER-2637          TO WS-ERROR
 11106           PERFORM 9900-ERROR-FORMAT
 11107                                 THRU 9900-EXIT
 11108        END-IF
 11109     END-IF
 11110     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11111
 11112
 11113 0570-CHECK-NCL-LIFE-LIMITS.
 11114
 11115     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11116        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11117         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11118
 11119     IF APP-CERT-USED
 11120         IF SUB2  LESS THAN  +5
 11121             MOVE +5          TO SUB2
 11122             GO TO 0570-CHECK-LIFE-LIMITS.
 11123
 11124     MOVE ER-2637             TO WS-ERROR.
 11125     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11126
 11127     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11128
 11129 0575-CHECK-NCL-SIG-SWITCH.
 11130
 11131     IF NOT APP-CERT-USED
 11132         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11133
 11134     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11135        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11136        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11137        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11138         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11139
 11140     IF SUB2 GREATER THAN +4
 11141         IF PL-LM-AGE (5) = ZEROS  AND
 11142            PL-LM-AGE (6) = ZEROS  AND
 11143            PL-LM-AGE (7) = ZEROS  AND
 11144            PL-LM-AGE (8) = ZEROS
 11145             MOVE  ER-1927        TO WS-ERROR
 11146             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11147             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11148         ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 202
* EL050.cbl
 11149             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11150                 MOVE  ER-1920    TO WS-ERROR
 11151                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11152
 11153     IF PB-I-SIG-SW  = 'Y'
 11154       IF NOT PB-I-POLICY-ACCEPTED  AND
 11155          NOT PB-I-POLICY-DECLINED
 11156           MOVE 'U'               TO PB-BATCH-ENTRY
 11157           MOVE  ER-1926          TO WS-ERROR
 11158           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11159
 11160
 11161 0580-AH-PLAN-LIMIT-EDITS.
 11162
 11163     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11164        IF PB-I-AH-BENEFIT-AMT > +1250
 11165           MOVE ER-2702          TO WS-ERROR
 11166           PERFORM 9900-ERROR-FORMAT
 11167                                 THRU 9900-EXIT
 11168        END-IF
 11169     END-IF
 11170
 11171     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11172        AND (PB-MONTHLY-CERT)
 11173        IF PB-I-AH-BENEFIT-AMT > +3000
 11174           MOVE ER-2881          TO WS-ERROR
 11175           PERFORM 9900-ERROR-FORMAT
 11176                                 THRU 9900-EXIT
 11177        END-IF
 11178     END-IF
 11179     IF NOT AH-PLAN-MASTER-FOUND
 11180        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11181        GO TO 3000-CONTINUE-EDIT.
 11182
 11183     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11184
 11185     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11186         IF PL-LM-AGE (1) = ZEROS
 11187             GO TO 3000-CONTINUE-EDIT.
 11188
 11189     IF NO-AH-BENEFIT-MATCH          OR
 11190        WS-AH-BENEFIT-CD = ZEROS     OR
 11191        WS-AH-SPECIAL-CALC-CD = 'M'
 11192        GO TO 3000-CONTINUE-EDIT.
 11193
 11194     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11195     MOVE +1                     TO SUB2.
 11196
 11197     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11198        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11199           MOVE +5 TO SUB2
 11200           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11201              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11202              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11203              (PL-LM-AGE (SUB2) EQUAL +0)
 11204              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11205              GO TO 3000-CONTINUE-EDIT.
 11206
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 203
* EL050.cbl
 11207     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11208
 11209 0590-CHECK-AH-ATT-AGE.
 11210
 11211     IF PL-ATT-AGE NUMERIC AND
 11212        PL-ATT-AGE GREATER THAN +0
 11213        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11214     END-IF
 11215*       IF WS-ATT-AGE >= PL-ATT-AGE
 11216*          MOVE ER-3054          TO WS-ERROR
 11217*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11218     .
 11219 0597-CHECK-AH-LIMITS.
 11220
 11221     IF PB-COMPANY-ID EQUAL 'CRI'
 11222        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11223           IF SUB2 GREATER THAN +4
 11224              MOVE ER-2638       TO WS-ERROR
 11225              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11226              GO TO 3000-CONTINUE-EDIT.
 11227
 11228     IF PB-COMPANY-ID  =  'NCL'
 11229        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11230            SUB2 GREATER THAN +8
 11231             MOVE 'U'            TO PB-BATCH-ENTRY
 11232             MOVE ER-2638        TO WS-ERROR
 11233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11234             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11235
 11236     IF SUB2 > +8
 11237        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11238           AND (PB-I-SIG-SW = 'Y')
 11239           CONTINUE
 11240        ELSE
 11241           MOVE ER-2638          TO WS-ERROR
 11242           PERFORM 9900-ERROR-FORMAT
 11243                                 THRU 9900-EXIT
 11244        END-IF
 11245        GO TO 3000-CONTINUE-EDIT
 11246     END-IF
 11247
 11248     IF PB-COMPANY-ID = 'CRI'
 11249        IF WS-ERROR = ER-2638
 11250           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11251
 11252     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11253     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11254     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11255     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11256
 11257     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11258        ADD +1                   TO SUB2
 11259        GO TO 0597-CHECK-AH-LIMITS.
 11260
 11261     IF PB-COMPANY-ID = 'NCL'
 11262         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11263
 11264     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 204
* EL050.cbl
 11265        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11266        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11267                                 > PL-LM-AMT (SUB2))
 11268        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11269           AND (PB-I-SIG-SW = 'Y')
 11270           CONTINUE
 11271        ELSE
 11272           MOVE ER-2638          TO WS-ERROR
 11273           PERFORM 9900-ERROR-FORMAT
 11274                                 THRU 9900-EXIT
 11275        END-IF
 11276     END-IF
 11277
 11278     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11279         IF  WS-ERROR    EQUAL    ER-2638
 11280             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11281                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11282                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11283                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11284                MOVE  ER-1910    TO  WS-ERROR
 11285                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11286
 11287     IF PB-COMPANY-ID = 'CRI'
 11288        IF WS-ERROR = ER-2638
 11289            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11290            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11291            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11292
 11293     GO TO 3000-CONTINUE-EDIT.
 11294
 11295 0597-CHECK-NCL-AH-LIMITS.
 11296
 11297     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11298        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11299        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11300                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11301         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11302
 11303     IF APP-CERT-USED
 11304         IF SUB2  LESS THAN  +5
 11305             MOVE +5             TO SUB2
 11306             GO TO 0597-CHECK-AH-LIMITS.
 11307
 11308     MOVE ER-2638                TO WS-ERROR.
 11309     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11310
 11311     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11312
 11313 0599-CHECK-NCL-SIG-SWITCH.
 11314
 11315     IF NOT APP-CERT-USED
 11316         GO TO 3000-CONTINUE-EDIT.
 11317
 11318     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11319        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11320        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11321        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11322         GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 205
* EL050.cbl
 11323
 11324     IF SUB2 GREATER THAN +4
 11325         IF PL-LM-AGE (5) = ZEROS  AND
 11326            PL-LM-AGE (6) = ZEROS  AND
 11327            PL-LM-AGE (7) = ZEROS  AND
 11328            PL-LM-AGE (8) = ZEROS
 11329             MOVE  ER-1927        TO WS-ERROR
 11330             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11331             GO TO 3000-CONTINUE-EDIT
 11332         ELSE
 11333             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11334                 MOVE  ER-1920    TO WS-ERROR
 11335                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11336
 11337     IF PB-I-SIG-SW  = 'Y'
 11338       IF NOT PB-I-POLICY-ACCEPTED  AND
 11339          NOT PB-I-POLICY-DECLINED
 11340           MOVE 'U'               TO PB-BATCH-ENTRY
 11341           MOVE  ER-1926          TO WS-ERROR
 11342           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11343
 11344******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 206
* EL050.cbl
 11346
 11347 3000-CONTINUE-EDIT.
 11348
 11349     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11350     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11351     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11352     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11353     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11354
 11355     IF BROWSE-STARTED
 11356        PERFORM 9990-RETURN THRU 9990-EXIT
 11357        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11358
 11359     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11360        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11361        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11362        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11363*       MOVE 1                   TO DC-OPTION-CODE
 11364        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11365        IF DATE-CONVERSION-ERROR
 11366           MOVE ER-2622          TO WS-ERROR
 11367           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11368        ELSE
 11369           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11370              MOVE ER-2623       TO WS-ERROR
 11371              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11372           ELSE
 11373              MOVE ER-2622       TO WS-ERROR
 11374              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11375
 11376     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11377     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11378     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11379*    MOVE 1                      TO DC-OPTION-CODE.
 11380     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11381     IF DATE-CONVERSION-ERROR
 11382        GO TO 3005-EDIT-CONTINUE
 11383     ELSE
 11384        IF DC-ELAPSED-DAYS GREATER +180
 11385           MOVE ER-2613          TO WS-ERROR
 11386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387        ELSE
 11388           IF DC-ELAPSED-DAYS GREATER +90
 11389              MOVE ER-2612       TO WS-ERROR
 11390              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11391           ELSE
 11392             IF DC-ELAPSED-DAYS GREATER +60
 11393                MOVE ER-2614     TO WS-ERROR
 11394                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11395
 11396 3005-EDIT-CONTINUE.
 11397
 11398     IF PB-CANCELLATION
 11399         GO TO 3700-EDIT-CANCEL.
 11400
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 207
* EL050.cbl
 11402******************************************************************
 11403*                  E D I T   I S S U E                           *
 11404******************************************************************
 11405
 11406 3020-EDIT-ISSUE.
 11407
 11408      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11409      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11410      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11411      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11412      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11413
 11414     IF PB-ISSUE-FORCE
 11415        OR PB-ISSUE-DATE-FORCED
 11416        OR PB-FORCE-OFF
 11417        OR PB-OVERCHARGE-FORCE
 11418        or pb-exceeded-limit-forced
 11419        CONTINUE
 11420     ELSE
 11421        MOVE ER-2670             TO WS-ERROR
 11422        PERFORM 9900-ERROR-FORMAT
 11423                                 THRU 9900-EXIT
 11424     END-IF
 11425     .
 11426 3022-SET-POLICY-STATUS.
 11427
 11428     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11429
 11430     IF (PB-REISSUED-CERT)
 11431             OR
 11432        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11433         AND (PB-MONTHLY-CERT))
 11434         MOVE '5'                TO PB-I-ENTRY-STATUS
 11435         MOVE 'E'                TO PB-BATCH-ENTRY
 11436     END-IF
 11437
 11438     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11439        IF PB-MONTHLY-CERT
 11440           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11441        END-IF
 11442        IF PB-CASH-CERT
 11443           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11444        END-IF
 11445     END-IF
 11446     IF PB-POLICY-IS-DECLINED
 11447         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11448     IF PB-POLICY-IS-VOIDED
 11449         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11450     IF PB-NEEDS-UNDERWRITING
 11451         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11452     IF PB-REIN-ONLY-CERT
 11453         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11454     IF PB-PREM-ACCTNG-ONLY
 11455         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11456
 11457     MOVE SPACE                  TO PB-I-OB-FLAG.
 11458
 11459     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 208
* EL050.cbl
 11460         MOVE ER-2665            TO WS-ERROR
 11461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11462         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11463
 11464     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11465        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11466           MOVE 'Z'             TO PB-I-OB-FLAG.
 11467
 11468     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11469        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11470           MOVE 'Z'             TO PB-I-OB-FLAG.
 11471
 11472     IF ACCOUNT-MAST-FOUND
 11473         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11474         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11475         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11476         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11477         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11478         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11479         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11480     END-IF
 11481
 11482     IF ACCOUNT-MAST-FOUND
 11483        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11484         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11485
 11486     IF (ACCOUNT-MAST-FOUND)
 11487*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11488        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11489        IF PB-REISSUED-CERT
 11490           CONTINUE
 11491        ELSE
 11492           MOVE ER-2608          TO WS-ERROR
 11493           PERFORM 9900-ERROR-FORMAT
 11494                                 THRU 9900-EXIT
 11495         END-IF
 11496     END-IF
 11497
 11498     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11499        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11500        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11501
 11502**********   DMD CUSTOM CODE FOLLOWS  **********
 11503 3024-EDIT-DMD-FIELDS.
 11504     IF PB-COMPANY-ID NOT = 'DMD'
 11505        GO TO 3025-EDIT-REINSURANCE.
 11506
 11507*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11508*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11509*** ERROR IF THEY ARE NOT EQUAL.
 11510
 11511     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11512     SET BIN-TO-GREG               TO TRUE.
 11513     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11514     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11515**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11516
 11517     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 209
* EL050.cbl
 11518     SET BIN-TO-GREG               TO TRUE.
 11519     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11520     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11521**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11522
 11523     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11524        MOVE ER-8116               TO WS-ERROR
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11526
 11527     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11528
 11529     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11530                                      WK-FULL-CERT-NO.
 11531     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11532
 11533     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11534
 11535     IF PB-VALID-LIFE
 11536        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11537     ELSE
 11538        IF PB-VALID-AH
 11539          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11540
 11541
 11542     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11543     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11544     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11545                                      DCUA-UNDRWRTR-CODE
 11546                                      DCUA-UNDRWRTR-GROUP-CODE
 11547                                      DCUA-RETURN-CODE.
 11548
 11549****************************************************************
 11550*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11551***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11552***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11553***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11554***   TO THIS RECORD.                                        ***
 11555****************************************************************
 11556     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11557     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11558     IF DCUA-SUCCESSFUL-PROCESS
 11559        GO TO 3024-EDIT-DL7-CONT.
 11560
 11561     IF DCUA-RETURN-CODE EQUAL '01'
 11562        MOVE ER-8110               TO WS-ERROR
 11563        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11565        GO TO 3024-EDIT-DL7-CONT.
 11566
 11567     IF DCUA-RETURN-CODE EQUAL '02'
 11568        MOVE ER-8111               TO WS-ERROR
 11569        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL7-CONT.
 11572
 11573     IF DCUA-RETURN-CODE EQUAL '03'
 11574        MOVE ER-8074               TO WS-ERROR
 11575        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 210
* EL050.cbl
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL7-CONT.
 11578
 11579     IF DCUA-RETURN-CODE EQUAL '04'
 11580        MOVE ER-8075               TO WS-ERROR
 11581        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583        GO TO 3024-EDIT-DL7-CONT.
 11584
 11585     IF DCUA-RETURN-CODE EQUAL '05'
 11586        MOVE ER-8076               TO WS-ERROR
 11587        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11589        GO TO 3024-EDIT-DL7-CONT.
 11590
 11591     IF DCUA-RETURN-CODE EQUAL '06'
 11592        MOVE ER-8077               TO WS-ERROR
 11593        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595        GO TO 3024-EDIT-DL7-CONT.
 11596
 11597     IF DCUA-RETURN-CODE EQUAL '07'
 11598        MOVE ER-8078               TO WS-ERROR
 11599        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL7-CONT.
 11602
 11603     IF DCUA-RETURN-CODE EQUAL 'E1'
 11604        MOVE ER-8079               TO WS-ERROR
 11605        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11607        GO TO 3024-EDIT-DL7-CONT.
 11608
 11609     IF DCUA-RETURN-CODE EQUAL 'E2'
 11610        MOVE ER-8080               TO WS-ERROR
 11611        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613        GO TO 3024-EDIT-DL7-CONT.
 11614
 11615     IF DCUA-RETURN-CODE EQUAL 'E3'
 11616        MOVE ER-8098               TO WS-ERROR
 11617        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL7-CONT.
 11620
 11621     IF DCUA-RETURN-CODE EQUAL 'C1'
 11622        MOVE ER-8099               TO WS-ERROR
 11623        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL7-CONT.
 11626
 11627     IF DCUA-RETURN-CODE EQUAL 'U1'
 11628        MOVE ER-8109               TO WS-ERROR
 11629        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11631        GO TO 3024-EDIT-DL7-CONT.
 11632
 11633     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 211
* EL050.cbl
 11634        MOVE ER-8112               TO WS-ERROR
 11635        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11637        GO TO 3024-EDIT-DL7-CONT.
 11638
 11639     IF DCUA-RETURN-CODE EQUAL 'N2'
 11640        MOVE ER-8113               TO WS-ERROR
 11641        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11643        GO TO 3024-EDIT-DL7-CONT.
 11644
 11645     IF DCUA-RETURN-CODE EQUAL 'N3'
 11646        MOVE ER-8114               TO WS-ERROR
 11647        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649        GO TO 3024-EDIT-DL7-CONT.
 11650
 11651     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11652     MOVE ER-8097                  TO WS-ERROR.
 11653     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11654     GO TO 3024-EDIT-DL7-CONT.
 11655
 11656 3024-EDIT-DL7-CONT.
 11657
 11658     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11659     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11660     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11661        NEXT SENTENCE
 11662     ELSE
 11663        MOVE ER-9263               TO WS-ERROR
 11664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11665
 11666******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11667******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11668     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11669        NEXT SENTENCE
 11670     ELSE
 11671        MOVE ER-8039               TO WS-ERROR
 11672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11673
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 212
* EL050.cbl
 11675****************************************************************
 11676*** VALIDATE STATE  : DLO022                                 ***
 11677****************************************************************
 11678     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11679     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11680
 11681     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11682     IF DVSC-SUCCESSFUL-EDIT
 11683        GO TO 3024-EDIT-DL22-CONT.
 11684
 11685     IF DVSC-RETURN-CODE EQUAL '01'
 11686        MOVE ER-8300               TO WS-ERROR
 11687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11688        GO TO 3024-EDIT-DL22-CONT.
 11689
 11690     IF DVSC-RETURN-CODE EQUAL '02'
 11691        MOVE ER-8301               TO WS-ERROR
 11692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693        GO TO 3024-EDIT-DL22-CONT.
 11694
 11695     IF DVSC-RETURN-CODE EQUAL '03'
 11696        MOVE ER-8302               TO WS-ERROR
 11697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698        GO TO 3024-EDIT-DL22-CONT.
 11699
 11700     IF DVSC-RETURN-CODE EQUAL 'N1'
 11701        MOVE ER-8304               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL22-CONT.
 11704
 11705     MOVE ER-8303                  TO WS-ERROR
 11706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11707
 11708 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 213
* EL050.cbl
 11710****************************************************************
 11711*** VALIDATE LOAN OFFICER : DLO021                           ***
 11712****************************************************************
 11713
 11714     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11715     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11716     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11717     IF DVLO-SUCCESSFUL-EDIT
 11718        GO TO 3024-EDIT-DL21-CONT.
 11719
 11720     IF DVLO-RETURN-CODE EQUAL '01'
 11721        MOVE ER-8081               TO WS-ERROR
 11722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11723        GO TO 3024-EDIT-DL21-CONT.
 11724
 11725     IF DVLO-RETURN-CODE EQUAL '02'
 11726        MOVE ER-8082               TO WS-ERROR
 11727        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11728        GO TO 3024-EDIT-DL21-CONT.
 11729
 11730     IF DVLO-RETURN-CODE EQUAL '03'
 11731        MOVE ER-8083               TO WS-ERROR
 11732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11733        GO TO 3024-EDIT-DL21-CONT.
 11734
 11735     IF DVLO-RETURN-CODE EQUAL '04'
 11736        MOVE ER-8084               TO WS-ERROR
 11737        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11738        GO TO 3024-EDIT-DL21-CONT.
 11739
 11740     IF DVLO-RETURN-CODE EQUAL '05'
 11741        MOVE ER-8085               TO WS-ERROR
 11742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11743        GO TO 3024-EDIT-DL21-CONT.
 11744
 11745     MOVE ER-7825                  TO WS-ERROR
 11746     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11747     GO TO 3024-EDIT-DL21-CONT.
 11748
 11749 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 214
* EL050.cbl
 11751
 11752****************************************************************
 11753*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11754****************************************************************
 11755
 11756     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11757     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11758     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11759     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11760     IF DIPF-SUCCESSFUL-EDIT
 11761        GO TO 3024-EDIT-DL02-CONT.
 11762
 11763     IF DIPF-RETURN-CODE EQUAL '01'
 11764        MOVE ER-8086               TO WS-ERROR
 11765        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11766        GO TO 3024-EDIT-DL02-CONT.
 11767
 11768     IF DIPF-RETURN-CODE EQUAL '02'
 11769        MOVE ER-8087               TO WS-ERROR
 11770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11771        GO TO 3024-EDIT-DL02-CONT.
 11772
 11773     IF DIPF-RETURN-CODE EQUAL '03'
 11774        MOVE ER-8088               TO WS-ERROR
 11775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776        GO TO 3024-EDIT-DL02-CONT.
 11777
 11778     MOVE ER-8095                  TO WS-ERROR
 11779     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11780     GO TO 3024-EDIT-DL02-CONT.
 11781
 11782 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 215
* EL050.cbl
 11784
 11785****************************************************************
 11786*** VALIDATE BANK ID : DLO003                                ***
 11787****************************************************************
 11788
 11789     MOVE WK-GREG-CENT           TO WCG-CENT.
 11790     MOVE WK-GREG-YYMM           TO WCG-REST.
 11791     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11792        MOVE ER-8040               TO WS-ERROR
 11793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11794
 11795     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11796     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11797     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11798     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11799     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11800     IF DVBI-SUCCESSFUL-EDIT
 11801        GO TO 3024-EDIT-DL03-CONT.
 11802
 11803     IF DVBI-RETURN-CODE EQUAL '01'
 11804        MOVE ER-8089               TO WS-ERROR
 11805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11806        GO TO 3024-EDIT-DL03-CONT.
 11807
 11808     IF DVBI-RETURN-CODE EQUAL '02'
 11809        MOVE ER-8090               TO WS-ERROR
 11810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11811        GO TO 3024-EDIT-DL03-CONT.
 11812
 11813     IF DVBI-RETURN-CODE EQUAL '03'
 11814        MOVE ER-8091               TO WS-ERROR
 11815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11816        GO TO 3024-EDIT-DL03-CONT.
 11817
 11818     IF DVBI-RETURN-CODE EQUAL '04'
 11819        MOVE ER-8092               TO WS-ERROR
 11820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11821        GO TO 3024-EDIT-DL03-CONT.
 11822
 11823     IF DVBI-RETURN-CODE EQUAL '05'
 11824        MOVE ER-8093               TO WS-ERROR
 11825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11826        GO TO 3024-EDIT-DL03-CONT.
 11827
 11828     IF DVBI-RETURN-CODE EQUAL '06'
 11829        MOVE ER-8094               TO WS-ERROR
 11830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831        GO TO 3024-EDIT-DL03-CONT.
 11832
 11833     MOVE ER-8096                  TO WS-ERROR
 11834     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11835     GO TO 3024-EDIT-DL03-CONT.
 11836
 11837 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 216
* EL050.cbl
 11839
 11840     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11841        NEXT SENTENCE
 11842     ELSE
 11843        MOVE ER-8042               TO WS-ERROR
 11844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11845
 11846     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11847     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11848     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11849
 11850     IF DMPF-RETURN-CODE = '01'
 11851        MOVE ER-8067               TO WS-ERROR
 11852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11853        GO TO 3024-EDIT-DL01-CONT.
 11854
 11855     IF DMPF-RETURN-CODE = '02'
 11856        MOVE ER-8068               TO WS-ERROR
 11857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11858        GO TO 3024-EDIT-DL01-CONT.
 11859
 11860     IF DMPF-RETURN-CODE = '03'
 11861        MOVE ER-8069               TO WS-ERROR
 11862        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11863        GO TO 3024-EDIT-DL01-CONT.
 11864
 11865     IF DMPF-RETURN-CODE = 'E1'
 11866        MOVE ER-8070               TO WS-ERROR
 11867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11868        GO TO 3024-EDIT-DL01-CONT.
 11869
 11870     IF DMPF-RETURN-CODE = 'N1'
 11871        MOVE ER-8071               TO WS-ERROR
 11872        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11873        GO TO 3024-EDIT-DL01-CONT.
 11874
 11875     IF DMPF-RETURN-CODE NOT = 'OK'
 11876        MOVE ER-8072               TO WS-ERROR
 11877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11878
 11879 3024-EDIT-DL01-CONT.
 11880******************************************************************
 11881***  VALIDATES RATE CODES : DLO017                             ***
 11882******************************************************************
 11883
 11884      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11885      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11886      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11887      IF DVRC-SUCCESSFUL-EDIT
 11888        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11889        GO TO 3024-CHECK-VALID-RATE.
 11890
 11891      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11892
 11893      IF DVRC-RETURN-CODE EQUAL '01'
 11894         MOVE ER-7817                   TO WS-ERROR
 11895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11896         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 217
* EL050.cbl
 11897
 11898      IF DVRC-RETURN-CODE EQUAL '02'
 11899         MOVE ER-7818                   TO WS-ERROR
 11900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11901         GO TO 3025-EDIT-REINSURANCE.
 11902
 11903      IF DVRC-RETURN-CODE EQUAL '03'
 11904         MOVE ER-7819                   TO WS-ERROR
 11905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11906         GO TO 3025-EDIT-REINSURANCE.
 11907
 11908       MOVE ER-7820                     TO WS-ERROR.
 11909       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11910       GO TO 3025-EDIT-REINSURANCE.
 11911
 11912******************************************************************
 11913***  GET PREMIUM RATES : DLO011                                ***
 11914******************************************************************
 11915
 11916 3024-CHECK-VALID-RATE.
 11917
 11918     IF VALID-RATE-CODE
 11919        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11920        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11921        MOVE SPACES                TO DPRB-RETURN-CODE
 11922        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11923     ELSE
 11924         GO TO 3025-EDIT-REINSURANCE.
 11925
 11926      IF DPRB-SUCCESSFUL-PROCESS
 11927         IF PB-VALID-LIFE
 11928             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11929             GO TO 3025-EDIT-REINSURANCE
 11930         ELSE
 11931             IF PB-VALID-AH
 11932                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11933                 GO TO 3025-EDIT-REINSURANCE.
 11934
 11935      IF DPRB-RETURN-CODE EQUAL '01'
 11936         MOVE ER-7812                   TO WS-ERROR
 11937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11938         GO TO 3025-EDIT-REINSURANCE.
 11939
 11940      IF DPRB-RETURN-CODE EQUAL '02'
 11941         MOVE ER-7813                   TO WS-ERROR
 11942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11943         GO TO 3025-EDIT-REINSURANCE.
 11944
 11945      IF DPRB-RETURN-CODE EQUAL '03'
 11946         MOVE ER-7814                   TO WS-ERROR
 11947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11948         GO TO 3025-EDIT-REINSURANCE.
 11949
 11950      IF DPRB-RETURN-CODE EQUAL '04'
 11951         IF NOT DPRB-1ST-TIME
 11952            MOVE ER-7815                   TO WS-ERROR
 11953            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11954            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 218
* EL050.cbl
 11955          ELSE
 11956         IF PB-VALID-LIFE
 11957            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11958          ELSE
 11959            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11960         END-IF
 11961         MOVE SPACES                TO DOCC-RETURN-CODE
 11962         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11963         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11964         IF DOCC-RETURN-CODE = 'OK'
 11965             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11966             GO TO 3024-CHECK-VALID-RATE
 11967           ELSE
 11968             MOVE ER-7823               TO WS-ERROR
 11969             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11970             GO TO 3025-EDIT-REINSURANCE.
 11971
 11972       MOVE ER-7816                     TO WS-ERROR.
 11973       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11974       GO TO 3025-EDIT-REINSURANCE.
 11975
 11976**********   DMD CUSTOM CODE ABOVE    **********
 11977
 11978 3025-EDIT-REINSURANCE.
 11979     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11980         GO TO 3027-EDIT-CONTINUE.
 11981
 11982     MOVE LOW-VALUES               TO ERREIN-KEY.
 11983     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11984     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11985                                      REIN-CODE-2
 11986                                      REIN-CODE-3.
 11987     MOVE 'A'                      TO REIN-TYPE.
 11988
 11989     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11990
 11991     MOVE '3026' TO REIN-SW.
 11992     MOVE ' '                   TO WS-REIN-READ-SW.
 11993
 11994     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11995     IF REIN-TABLE-NOT-FOUND
 11996         GO TO 3026-NO-SPEC-TABLE.
 11997
 11998     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11999     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12000                                   WS-NSP-ST-CD-LF.
 12001     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12002                                   WS-NSP-ST-CD-AH.
 12003
 12004     GO TO 3040-EDIT-CONTINUE.
 12005
 12006 3026-NO-SPEC-TABLE.
 12007
 12008     MOVE ER-2664                TO WS-ERROR.
 12009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12010     GO TO 3040-EDIT-CONTINUE.
 12011
 12012 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 219
* EL050.cbl
 12013
 12014     IF PB-I-REIN-TABLE = SPACES
 12015       GO TO 3040-EDIT-CONTINUE.
 12016
 12017     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12018          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12019          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12020           GO TO 3040-EDIT-CONTINUE.
 12021
 12022     MOVE LOW-VALUES            TO ERREIN-KEY.
 12023     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12024     MOVE 'A'                   TO REIN-TYPE.
 12025     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12026
 12027     MOVE '3028'                TO REIN-SW.
 12028     MOVE ' '                   TO WS-REIN-READ-SW.
 12029
 12030     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12031     IF REIN-TABLE-NOT-FOUND
 12032         GO TO 3028-NO-REIN-TABLE.
 12033
 12034     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12035     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12036                                   WS-NSP-ST-CD-LF.
 12037     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12038                                   WS-NSP-ST-CD-AH.
 12039
 12040     GO TO 3040-EDIT-CONTINUE.
 12041
 12042 3028-NO-REIN-TABLE.
 12043
 12044     MOVE ER-2615                TO WS-ERROR.
 12045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12046     GO TO 3040-EDIT-CONTINUE.
 12047
 12048 3040-EDIT-CONTINUE.
 12049
 12050     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12051         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12052
 12053     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12054         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12055
 12056     IF (NOT PB-REISSUED-CERT)
 12057        AND (NOT PB-MONTHLY-CERT)
 12058        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12059            MOVE '001'           TO PB-I-LF-TERM
 12060            MOVE 'M'             TO PB-I-INSURED-SEX.
 12061
 12062     IF (NOT PB-REISSUED-CERT)
 12063        AND (NOT PB-MONTHLY-CERT)
 12064        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12065            MOVE '001'           TO PB-I-AH-TERM
 12066            MOVE 'M'             TO PB-I-INSURED-SEX.
 12067
 12068 3040-EDIT-1ST-PMT-DT.
 12069     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12070     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 220
* EL050.cbl
 12071         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12072
 12073******************************************************************
 12074*                                                                *
 12075*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12076*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12077*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12078*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12079*                                                                *
 12080******************************************************************
 12081
 12082     IF PB-EFF-DT-PROCESSING
 12083        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12084                                    PB-I-LF-EXPIRE-DT
 12085                                    PB-I-AH-EXPIRE-DT
 12086        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12087        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12088        MOVE ZERO                TO DC-ELAPSED-DAYS
 12089        MOVE +1                  TO DC-ELAPSED-MONTHS
 12090        SET BIN-PLUS-ELAPSED     TO TRUE
 12091*       MOVE 6                   TO DC-OPTION-CODE
 12092        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12093        IF NO-CONVERSION-ERROR
 12094           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12095
 12096******************************************************************
 12097*                                                                *
 12098*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12099*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12100*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12101*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12102*                                                                *
 12103******************************************************************
 12104
 12105     IF PB-EXT-DAYS-PROCESSING
 12106          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12107                                         PB-I-LF-EXPIRE-DT
 12108                                         PB-I-AH-EXPIRE-DT
 12109          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12110          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12111          MOVE +1                     TO DC-ELAPSED-MONTHS
 12112          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12113          SET BIN-PLUS-ELAPSED        TO TRUE
 12114*         MOVE 6                      TO DC-OPTION-CODE
 12115          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12116          IF NO-CONVERSION-ERROR
 12117             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12118
 12119******************************************************************
 12120*                                                                *
 12121*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12122*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12123*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12124*        (EXPIRE DATE - (TERM -1))  *  -1.
 12125*                                                                *
 12126******************************************************************
 12127
 12128     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 221
* EL050.cbl
 12129        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12130           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12131              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12132              MOVE PB-I-AH-TERM      TO WS-TERM
 12133           ELSE
 12134              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12135              MOVE PB-I-LF-TERM      TO WS-TERM
 12136        ELSE
 12137           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12138              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12139              MOVE PB-I-LF-TERM      TO WS-TERM
 12140           ELSE
 12141              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12142              MOVE PB-I-AH-TERM      TO WS-TERM.
 12143
 12144     IF PB-EXPIRE-DT-PROCESSING
 12145        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12146        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12147        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12148        MOVE ZERO                TO DC-ELAPSED-DAYS
 12149                                    DC-ODD-DAYS-OVER
 12150          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12151          SET BIN-PLUS-ELAPSED    TO TRUE
 12152*         MOVE 6                  TO DC-OPTION-CODE
 12153          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12154          IF NO-CONVERSION-ERROR
 12155             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12156
 12157******************************************************************
 12158*                                                                *
 12159*            1ST PAYMENT DATE PROCESSING                         *
 12160*                                                                *
 12161******************************************************************
 12162
 12163     IF PB-1ST-PMT-DT-PROCESSING
 12164        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12165                                    PB-I-AH-EXPIRE-DT
 12166        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12167
 12168     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12169         NEXT SENTENCE
 12170     ELSE
 12171         MOVE ER-2680                 TO WS-ERROR
 12172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173         GO TO 3060-ORIG-TERM-CHECK.
 12174
 12175     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12176     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12177     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12178*    MOVE 1                      TO DC-OPTION-CODE.
 12179     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12180                                    DC-ELAPSED-DAYS
 12181                                    DC-ODD-DAYS-OVER.
 12182
 12183     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12184
 12185     IF DATE-CONVERSION-ERROR
 12186        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 222
* EL050.cbl
 12187
 12188     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12189     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12190        AND (WS-LF-COVERAGE-TYPE = 'L')
 12191        IF (DC-ELAPSED-MONTHS > 1)
 12192                      OR
 12193           ((DC-ELAPSED-MONTHS = 1)
 12194           AND (DC-ODD-DAYS-OVER > 0))
 12195           MOVE ER-2882          TO WS-ERROR
 12196           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12197        END-IF
 12198     END-IF
 12199     if dc-elapsed-months > 0
 12200        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12201        + dc-odd-days-over
 12202     end-if
 12203     IF PB-EXT-DAYS-PROCESSING
 12204        CONTINUE
 12205     ELSE
 12206        IF DC-ELAPSED-MONTHS = +0
 12207           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12208        ELSE
 12209           IF (WS-LF-EARNINGS-CALC = '4')
 12210              AND (DC-ELAPSED-MONTHS > ZERO)
 12211              AND (DC-ELAPSED-DAYS > ZERO)
 12212              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12213           ELSE
 12214              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12215                                 THRU 6499-EXIT
 12216              MOVE WS-ODD-DAYS-OVER
 12217                                 TO PB-I-EXTENTION-DAYS
 12218           END-IF
 12219        END-IF
 12220     END-IF
 12221******************************************************************
 12222*                                                                *
 12223*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12224*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12225*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12226*            AND ANY ODD DAYS.                                   *
 12227*                                                                *
 12228******************************************************************
 12229
 12230     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12231                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12232     IF WS-LF-EARNINGS-CALC NOT = '4'
 12233        IF DC-ELAPSED-DAYS > ZEROS
 12234           MOVE ER-2681          TO WS-ERROR
 12235           PERFORM 9900-ERROR-FORMAT
 12236                                 THRU 9900-EXIT
 12237        END-IF
 12238     END-IF
 12239
 12240     IF WS-LF-EARNINGS-CALC NOT = '4'
 12241        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12242           MOVE ER-2681          TO WS-ERROR
 12243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12244
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 223
* EL050.cbl
 12245     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12246        (PB-I-LF-TERM NOT = ZERO) AND
 12247         NOT NO-LIFE-COVERAGE
 12248          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12249          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12250          IF WS-LF-EARNINGS-CALC = '4'
 12251             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12252             PB-I-PAY-FREQUENCY
 12253          END-IF
 12254          MOVE ZERO              TO DC-ELAPSED-DAYS
 12255                                    DC-ODD-DAYS-OVER
 12256          MOVE 1                 TO DC-END-OF-MONTH
 12257          SET BIN-PLUS-ELAPSED        TO TRUE
 12258*         MOVE 6                 TO DC-OPTION-CODE
 12259          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12260          IF NO-CONVERSION-ERROR
 12261             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12262             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12263                (WS-LF-SPECIAL-CALC-CD = 'L')
 12264                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12265                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12266                  MOVE +1             TO DC-ELAPSED-MONTHS
 12267                  SET BIN-PLUS-ELAPSED  TO TRUE
 12268*                 MOVE 6              TO DC-OPTION-CODE
 12269                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12270                  IF NO-CONVERSION-ERROR
 12271                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12272
 12273* okay, i had to move the new att age edit down here because the
 12274* expiration date could get recalculated and i need the exp date
 12275     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12276        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12277        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12278        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12279           AND ZEROS
 12280           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12281           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12282           SET ELAPSED-BETWEEN-BIN TO TRUE
 12283           PERFORM 8500-DATE-CONVERT
 12284                                 THRU 8500-EXIT
 12285           IF NO-CONVERSION-ERROR
 12286              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12287                 MOVE ER-2669       TO WS-ERROR
 12288*                PERFORM 9900-ERROR-FORMAT
 12289*                                THRU 9900-EXIT
 12290              END-IF
 12291           END-IF
 12292        ELSE
 12293           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12294           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12295              MOVE ER-2669       TO WS-ERROR
 12296*             PERFORM 9900-ERROR-FORMAT
 12297*                                THRU 9900-EXIT
 12298           ELSE
 12299              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12300                 MOVE ER-1570    TO WS-ERROR
 12301                 PERFORM 9900-ERROR-FORMAT
 12302                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 224
* EL050.cbl
 12303              END-IF
 12304           END-IF
 12305        END-IF
 12306        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12307           AND ZEROS
 12308           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12309           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12310           SET ELAPSED-BETWEEN-BIN TO TRUE
 12311           PERFORM 8500-DATE-CONVERT
 12312                                 THRU 8500-EXIT
 12313           IF NO-CONVERSION-ERROR
 12314              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12315                 MOVE ER-2669       TO WS-ERROR
 12316*                PERFORM 9900-ERROR-FORMAT
 12317*                                THRU 9900-EXIT
 12318              END-IF
 12319           END-IF
 12320        ELSE
 12321           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12322             (PB-I-LF-TERM / 12)
 12323           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12324              MOVE ER-2669       TO WS-ERROR
 12325*             PERFORM 9900-ERROR-FORMAT
 12326*                                THRU 9900-EXIT
 12327           ELSE
 12328              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12329                 MOVE ER-1571    TO WS-ERROR
 12330                 PERFORM 9900-ERROR-FORMAT
 12331                                 THRU 9900-EXIT
 12332              END-IF
 12333           END-IF
 12334        END-IF
 12335        IF WS-ERROR = ER-2669
 12336           PERFORM 9900-ERROR-FORMAT
 12337                                 THRU 9900-EXIT
 12338        END-IF
 12339     END-IF
 12340     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12341        (PB-I-AH-TERM NOT = ZERO) AND
 12342         NOT NO-AH-COVERAGE
 12343          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12344             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12345             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12346             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12347          ELSE
 12348             IF WS-LF-EARNINGS-CALC = '4'
 12349                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12350                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12351                PB-I-PAY-FREQUENCY
 12352             ELSE
 12353                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12354                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12355             END-IF
 12356          END-IF
 12357          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12358                                         DC-ODD-DAYS-OVER
 12359          MOVE 1                      TO DC-END-OF-MONTH
 12360          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 225
* EL050.cbl
 12361*         MOVE 6                      TO DC-OPTION-CODE
 12362          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12363          IF NO-CONVERSION-ERROR
 12364             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12365     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12366        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12367        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12368        IF PB-I-BIRTHDAY > LOW-VALUES
 12369           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12370           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12371           SET ELAPSED-BETWEEN-BIN TO TRUE
 12372           PERFORM 8500-DATE-CONVERT
 12373                                 THRU 8500-EXIT
 12374           IF NO-CONVERSION-ERROR
 12375              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12376                 MOVE ER-3054       TO WS-ERROR
 12377*                PERFORM 9900-ERROR-FORMAT
 12378*                                THRU 9900-EXIT
 12379              END-IF
 12380           END-IF
 12381        ELSE
 12382           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12383           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12384              MOVE ER-3054       TO WS-ERROR
 12385*             PERFORM 9900-ERROR-FORMAT
 12386*                                THRU 9900-EXIT
 12387           END-IF
 12388        END-IF
 12389        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12390           AND ZEROS
 12391           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12392           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12393           SET ELAPSED-BETWEEN-BIN TO TRUE
 12394           PERFORM 8500-DATE-CONVERT
 12395                                 THRU 8500-EXIT
 12396           IF NO-CONVERSION-ERROR
 12397              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12398                 MOVE ER-3054       TO WS-ERROR
 12399*                PERFORM 9900-ERROR-FORMAT
 12400*                                THRU 9900-EXIT
 12401              END-IF
 12402           END-IF
 12403        ELSE
 12404           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12405             (PB-I-AH-TERM / 12)
 12406           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12407              MOVE ER-3054       TO WS-ERROR
 12408*             PERFORM 9900-ERROR-FORMAT
 12409*                                THRU 9900-EXIT
 12410           END-IF
 12411        END-IF
 12412        IF WS-ERROR = ER-3054
 12413           PERFORM 9900-ERROR-FORMAT
 12414                                 THRU 9900-EXIT
 12415        END-IF
 12416     END-IF
 12417     MOVE SPACE                       TO DC-END-OF-MONTH.
 12418
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 226
* EL050.cbl
 12419     IF PB-COMPANY-ID = 'NCB'
 12420        GO TO 3040-EDIT-EXTENSION-DAYS.
 12421
 12422     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12423       AND
 12424        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12425        NEXT SENTENCE
 12426     ELSE
 12427        GO TO 3040-EDIT-EXTENSION-DAYS.
 12428
 12429     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12430        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12431        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12432     ELSE
 12433        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12434        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12435
 12436     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12437*    MOVE '1'      TO DC-OPTION-CODE
 12438     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12439     IF (NO-CONVERSION-ERROR)
 12440        AND (DC-ELAPSED-MONTHS > +1)
 12441        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12442        MOVE ER-2668   TO WS-ERROR
 12443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12444
 12445 3040-EDIT-EXTENSION-DAYS.
 12446
 12447     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12448        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12449         GO TO 3050-EDIT-TERM-IN-DAYS
 12450     ELSE
 12451         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12452
 12453     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12454         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12455     ELSE
 12456        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12457           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12458           MOVE ER-2681         TO WS-ERROR
 12459           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12460
 12461     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12462        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12463        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12464         GO TO 3060-ORIG-TERM-CHECK.
 12465
 12466     GO TO 3060-ORIG-TERM-CHECK.
 12467
 12468 3050-EDIT-TERM-IN-DAYS.
 12469
 12470     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12471
 12472     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12473         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12474     ELSE
 12475         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12476            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 227
* EL050.cbl
 12477            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12478
 12479     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12480                                       REMAINDER WS-WORK-TERM.
 12481     IF WS-WORK-TERM GREATER THAN ZERO
 12482         ADD +1 TO PB-I-LF-TERM.
 12483
 12484     IF NOT NO-AH-COVERAGE
 12485         MOVE ER-2684            TO WS-ERROR
 12486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12487
 12488
 12489 3060-ORIG-TERM-CHECK.
 12490
 12491******************************************************************
 12492*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12493******************************************************************
 12494
 12495     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12496        NEXT SENTENCE
 12497     ELSE
 12498        IF NOT NO-LIFE-COVERAGE
 12499           IF PB-I-LF-TERM NUMERIC
 12500              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12501              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12502              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12503                  NEXT SENTENCE
 12504           ELSE
 12505              MOVE ER-2647       TO WS-ERROR
 12506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12507
 12508     IF NOT NO-AH-COVERAGE
 12509         IF PB-I-AH-TERM NUMERIC
 12510            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12511            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12512            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12513             NEXT SENTENCE
 12514          ELSE
 12515              MOVE ER-2658       TO WS-ERROR
 12516              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517
 12518     IF PB-COMPANY-ID = 'NCB'
 12519        GO TO 3070-LOAN-TERM-CHECK.
 12520
 12521     IF POLICY-HAS-AH
 12522       AND
 12523        POLICY-HAS-LIFE
 12524       AND
 12525        PB-I-LF-TERM NUMERIC
 12526       AND
 12527        PB-I-AH-TERM NUMERIC
 12528        NEXT SENTENCE
 12529     ELSE
 12530        GO TO 3070-LOAN-TERM-CHECK.
 12531
 12532     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12533     IF WS-TEX-FACT-2 LESS THAN +0
 12534        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 228
* EL050.cbl
 12535
 12536     IF WS-TEX-FACT-2 GREATER THAN +1
 12537        MOVE ER-2668             TO WS-ERROR
 12538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12539
 12540 3070-LOAN-TERM-CHECK.
 12541
 12542     IF (WS-LF-BENEFIT-CD = ZERO)
 12543         OR (NO-LF-BENEFIT-MATCH)
 12544            GO TO 3125-EDIT-PMT-FREQ.
 12545*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12546*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12547*          AND 'V' AND 'W' AND 'X'
 12548*          GO TO 3125-EDIT-PMT-FREQ
 12549*       END-IF
 12550*    ELSE
 12551*       IF WS-AH-DCC-TRUNC = 'T'
 12552*          CONTINUE
 12553*       ELSE
 12554*          GO TO 3125-EDIT-PMT-FREQ
 12555*       END-IF
 12556*    END-IF
 12557     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12558                    OR
 12559        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12560        AND (WS-AH-DCC-TRUNC = 'T'))
 12561        CONTINUE
 12562     ELSE
 12563        GO TO 3125-EDIT-PMT-FREQ
 12564     END-IF
 12565     IF PB-I-LOAN-TERM NOT NUMERIC
 12566         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12567
 12568     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12569        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12570*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12571        PB-I-LOAN-TERM NOT GREATER THAN +360
 12572         NEXT SENTENCE
 12573     ELSE
 12574         MOVE ER-2648            TO WS-ERROR
 12575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12576
 12577     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12578        MOVE ER-3058             TO WS-ERROR
 12579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12580     end-if
 12581
 12582     IF WS-STATE-ABBREVIATION = 'NC'
 12583        IF PB-I-LOAN-TERM > +59
 12584           CONTINUE
 12585        ELSE
 12586           MOVE ER-2792          TO WS-ERROR
 12587           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12588        END-IF
 12589     END-IF
 12590
 12591     .
 12592 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 229
* EL050.cbl
 12593     IF (WS-LF-BENEFIT-CD = ZERO)
 12594         OR (NO-LF-BENEFIT-MATCH)
 12595            GO TO 3127-EDIT-LOAN-OFFICER.
 12596     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12597                    OR
 12598        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12599        AND (WS-AH-DCC-TRUNC = 'T'))
 12600                    OR
 12601         (PB-COMPANY-ID = 'AHL')
 12602        CONTINUE
 12603     ELSE
 12604        IF (PB-I-LOAN-TERM > ZEROS)
 12605           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12606           MOVE ER-1575          TO WS-ERROR
 12607           PERFORM 9900-ERROR-FORMAT
 12608                                 THRU 9900-EXIT
 12609        END-IF
 12610     END-IF
 12611     IF WS-LF-EARNINGS-CALC NOT = '4'
 12612         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12613            MOVE ER-2653         TO WS-ERROR
 12614            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12615            GO TO 3127-EDIT-LOAN-OFFICER
 12616         ELSE
 12617            GO TO 3127-EDIT-LOAN-OFFICER.
 12618
 12619     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12620         MOVE ER-2655            TO WS-ERROR
 12621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12622         GO TO 3127-EDIT-LOAN-OFFICER.
 12623
 12624     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12625         MOVE ER-2654            TO WS-ERROR
 12626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12627         GO TO 3127-EDIT-LOAN-OFFICER.
 12628
 12629     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12630         GIVING WS-TEX-FACT-2
 12631             REMAINDER WS-TEX-FACT-3.
 12632
 12633*    IF WS-TEX-FACT-3 NOT = ZERO
 12634*       MOVE ER-2654             TO WS-ERROR
 12635*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12636
 12637
 12638 3127-EDIT-LOAN-OFFICER.
 12639
 12640     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12641        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12642           MOVE ER-2690          TO WS-ERROR
 12643           PERFORM 9900-ERROR-FORMAT
 12644                                 THRU 9900-EXIT
 12645        ELSE
 12646           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12647           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12648           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12649           MOVE PB-SV-STATE      TO LOFC-STATE
 12650           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 230
* EL050.cbl
 12651           MOVE PB-I-LOAN-OFFICER
 12652                                 TO LOFC-CODE
 12653           PERFORM 8586-READ-LOAN-OFFICER
 12654                                 THRU 8586-EXIT
 12655           IF (NOT LOFC-MASTER-FOUND)
 12656              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12657              MOVE ER-3006       TO WS-ERROR
 12658              PERFORM 9900-ERROR-FORMAT
 12659                                 THRU 9900-EXIT
 12660           END-IF
 12661        END-IF
 12662     END-IF
 12663     .
 12664 3129-EDIT-APR.
 12665
 12666     IF (WS-LF-BENEFIT-CD = ZERO)
 12667        OR (NO-LF-BENEFIT-MATCH)
 12668        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12669           GO TO 3130-EDIT-AGE
 12670*       ELSE
 12671*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12672*             GO TO 3130-EDIT-AGE
 12673*          END-IF
 12674        END-IF
 12675     END-IF
 12676
 12677     IF (WS-STATE-ABBREVIATION = 'OH')
 12678         AND (PB-I-RATE-CLASS NOT = 'L ')
 12679         AND (PB-I-LF-TERM GREATER THAN 60)
 12680         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12681         GO TO 3129-APR-CONT.
 12682
 12683     IF (WS-STATE-ABBREVIATION = 'RI')
 12684         AND (PB-I-LF-TERM GREATER THAN 60)
 12685         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12686         GO TO 3129-APR-CONT.
 12687
 12688     IF (WS-STATE-ABBREVIATION = 'UT')
 12689         AND (PB-I-LF-TERM GREATER THAN 62)
 12690         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12691         AND (PB-CERT-EFF-DT LESS WS-830901)
 12692         GO TO 3129-APR-CONT.
 12693
 12694     IF PB-COMPANY-ID = 'LAP'
 12695        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12696           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12697              MOVE ER-2656         TO WS-ERROR
 12698              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12699              GO TO 3130-EDIT-AGE.
 12700
 12701     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12702        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12703        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12704        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12705        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12706        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12707         GO TO 3130-EDIT-AGE.
 12708
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 231
* EL050.cbl
 12709 3129-APR-CONT.
 12710     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12711         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12712         GO TO 3130-EDIT-AGE.
 12713
 12714     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12715         WS-AH-BENEFIT-CD (1:1) = 'S')
 12716        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12717        AND (PB-I-LOAN-APR = ZERO)
 12718        MOVE ER-2657             TO WS-ERROR
 12719        PERFORM 9900-ERROR-FORMAT
 12720                                 THRU 9900-EXIT
 12721        GO TO 3130-EDIT-AGE
 12722     END-IF
 12723*    IF PB-I-LOAN-APR = ZERO
 12724*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12725*    END-IF
 12726
 12727     if pb-i-loan-apr = +99.9999
 12728        move er-2656             to ws-error
 12729        PERFORM 9900-ERROR-FORMAT
 12730                                 THRU 9900-EXIT
 12731        GO TO 3130-EDIT-AGE
 12732     end-if
 12733*    IF PB-I-LOAN-APR = ZERO
 12734*       MOVE ER-2656             TO WS-ERROR
 12735*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12736*       GO TO 3130-EDIT-AGE.
 12737
 12738*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12739     if pb-i-loan-apr not = +99.9999
 12740        IF PB-I-LOAN-APR > +30.000
 12741           MOVE ER-2657          TO WS-ERROR
 12742           PERFORM 9900-ERROR-FORMAT
 12743                                 THRU 9900-EXIT
 12744        end-if
 12745     end-if
 12746     .
 12747 3130-EDIT-AGE.
 12748
 12749******************************************************************
 12750*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12751******************************************************************
 12752
 12753     IF NOT NO-LIFE-COVERAGE
 12754        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12755           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12756               MOVE ER-2628             TO WS-ERROR
 12757               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12758
 12759     IF NOT NO-AH-COVERAGE
 12760        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12761           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12762               MOVE ER-2628         TO WS-ERROR
 12763               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765 3133-SEX-CODE.
 12766     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 232
* EL050.cbl
 12767         IF WS-DEFAULT-SEX = 'M'
 12768             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12769          ELSE
 12770             IF WS-DEFAULT-SEX = 'F'
 12771             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12772
 12773     IF PB-I-INSURED-SEX = '1'
 12774         MOVE 'M' TO PB-I-INSURED-SEX.
 12775
 12776     IF PB-I-INSURED-SEX = '2'
 12777         MOVE 'F' TO PB-I-INSURED-SEX.
 12778
 12779 3134-SIG-SW-EDIT.
 12780     IF PB-I-SIG-SW = SPACE
 12781         MOVE 'N'                TO  PB-I-SIG-SW.
 12782
 12783     IF PB-COMPANY-ID = 'NCL'
 12784         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12785             NEXT SENTENCE
 12786         ELSE
 12787             MOVE ER-1923        TO  WS-ERROR
 12788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12789     ELSE
 12790     IF PB-COMPANY-ID = 'CRI'
 12791         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12792             NEXT SENTENCE
 12793         ELSE
 12794             MOVE ER-2606        TO  WS-ERROR
 12795             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12796     ELSE
 12797     IF PB-COMPANY-ID = 'TMS'
 12798         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12799             NEXT SENTENCE
 12800         ELSE
 12801             MOVE ER-2689        TO  WS-ERROR
 12802             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12803     ELSE
 12804         IF PB-I-SIG-SW = 'Y' OR 'N'
 12805             NEXT SENTENCE
 12806         ELSE
 12807             MOVE ER-2651        TO  WS-ERROR
 12808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12809
 12810     IF PB-COMPANY-ID = 'FLA'
 12811         IF (WS-EDIT-AGE GREATER 54  OR
 12812             WS-AH-EDIT-AGE GREATER 54)  AND
 12813            PB-I-SIG-SW = 'N'
 12814            MOVE ER-2651         TO  WS-ERROR
 12815            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12816
 12817 3135-NAME-EDIT.
 12818
 12819     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12820        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12821        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12822           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12823                                 TO PB-I-JOINT-FIRST-NAME
 12824        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 233
* EL050.cbl
 12825     END-IF
 12826     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12827        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12828        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12829           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12830                                 TO PB-I-JOINT-LAST-NAME
 12831        END-PERFORM
 12832     END-IF
 12833     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12834        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12835        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12836           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12837                                 TO PB-I-INSURED-FIRST-NAME
 12838        END-PERFORM
 12839     END-IF
 12840     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12841        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12842        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12843           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12844                                 TO PB-I-INSURED-LAST-NAME
 12845        END-PERFORM
 12846     END-IF
 12847     IF PB-I-INSURED-LAST-NAME = SPACES
 12848       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12849       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12850           MOVE ER-2660    TO WS-ERROR
 12851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12852
 12853 3136-EDIT-SEX.
 12854
 12855******************************************************************
 12856*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12857******************************************************************
 12858
 12859     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12860        (WS-AH-SPECIAL-CALC-CD = 'O')
 12861        NEXT SENTENCE
 12862     ELSE
 12863        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12864           NEXT SENTENCE
 12865        ELSE
 12866           MOVE ER-2629            TO WS-ERROR
 12867           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12868
 12869 3137-EDIT-EFF-DATE.
 12870
 12871     IF PB-REISSUED-CERT       OR
 12872        PB-POLICY-IS-DECLINED  OR
 12873        PB-POLICY-IS-VOIDED
 12874         GO TO 3139-EDIT-COVERAGE-CODES.
 12875
 12876     MOVE SPACE                  TO WS-2671-SW
 12877                                    WS-2672-SW.
 12878
 12879     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12880         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12881             MOVE ER-2703        TO WS-ERROR
 12882             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 234
* EL050.cbl
 12883             GO TO 3139-EDIT-COVERAGE-CODES.
 12884
 12885     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12886         GO TO 3139-EDIT-COVERAGE-CODES.
 12887
 12888     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12889     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12890*    MOVE '1'                    TO DC-OPTION-CODE.
 12891     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12892     MOVE +0                     TO DC-ELAPSED-MONTHS
 12893                                    DC-ELAPSED-DAYS.
 12894     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12895
 12896     IF DATE-CONVERSION-ERROR
 12897         GO TO 3139-EDIT-COVERAGE-CODES.
 12898
 12899     IF DC-ELAPSED-DAYS GREATER +180
 12900         MOVE ER-2672            TO WS-ERROR
 12901         MOVE 'Y'                TO WS-2672-SW
 12902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12903     END-IF
 12904
 12905     IF WS-ERROR = ER-2671  AND
 12906        PB-COMPANY-ID  = 'LBL'
 12907        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12908        MOVE SPACE               TO WS-2671-SW
 12909        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12910
 12911     IF PB-ISSUE-DATE-FORCED  AND
 12912      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12913         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12914         MOVE ER-2673            TO WS-ERROR
 12915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12916         MOVE SPACE              TO WS-2671-SW
 12917                                    WS-2672-SW.
 12918
 12919     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12920         IF PB-ISSUE-DATE-FORCED
 12921             MOVE ER-2600          TO  WS-ERROR
 12922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12923         ELSE
 12924             MOVE ER-2692          TO  WS-ERROR
 12925             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12926
 12927
 12928 3139-EDIT-COVERAGE-CODES.
 12929
 12930     if pb-company-id not = 'AHL'
 12931        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12932           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12933           MOVE ER-2787          TO WS-ERROR
 12934           PERFORM 9900-ERROR-FORMAT
 12935                                 THRU 9900-EXIT
 12936        END-IF
 12937     end-if
 12938     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12939        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12940                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 235
* EL050.cbl
 12941           MOVE ER-2719          TO WS-ERROR
 12942           PERFORM 9900-ERROR-FORMAT
 12943                                 THRU 9900-EXIT
 12944        END-IF
 12945     END-IF
 12946
 12947     IF PB-POLICY-IS-DECLINED  OR
 12948        PB-POLICY-IS-VOIDED
 12949         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12950
 12951     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12952        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12953         MOVE ER-2630                TO WS-ERROR
 12954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12955
 12956     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12957        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12958        PB-I-LF-PREMIUM-AMT = ZERO
 12959         GO TO 3140-CHECK-AH-FOR-ZERO.
 12960
 12961     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12962        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12963        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12964         GO TO 3140-CHECK-AH-FOR-ZERO.
 12965
 12966     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12967        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12968        MOVE ER-2631             TO WS-ERROR
 12969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12970     END-IF
 12971
 12972
 12973******************************************************************
 12974*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12975******************************************************************
 12976
 12977     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12978        NEXT SENTENCE
 12979     ELSE
 12980        IF PB-I-LF-BENEFIT-AMT = ZERO
 12981           MOVE ER-2632             TO WS-ERROR
 12982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12983
 12984
 12985******************************************************************
 12986*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12987******************************************************************
 12988
 12989     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12990        CONTINUE
 12991     ELSE
 12992        IF PB-I-LF-PREMIUM-AMT = ZERO
 12993           IF (NOT PB-COMP-LF-PREM)
 12994              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12995              and (ws-lf-ben-category not = 'C')
 12996              MOVE ER-2633       TO WS-ERROR
 12997              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12998           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 236
* EL050.cbl
 12999        END-IF
 13000     END-IF
 13001     .
 13002 3140-CHECK-AH-FOR-ZERO.
 13003
 13004     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13005        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13006        PB-I-AH-PREMIUM-AMT = ZERO
 13007         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13008
 13009     IF PB-COMPANY-ID = 'CSL'  AND
 13010        PB-I-AH-BENEFIT-CD = ZERO  AND
 13011        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13012        PB-I-AH-PREMIUM-AMT = ZERO
 13013         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13014
 13015     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13016        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13017        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13018         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13019
 13020     IF PB-I-AH-BENEFIT-CD = ZERO
 13021         MOVE ER-2634            TO WS-ERROR
 13022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13023
 13024******************************************************************
 13025*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13026******************************************************************
 13027
 13028     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13029        NEXT SENTENCE
 13030     ELSE
 13031        IF PB-I-AH-BENEFIT-AMT = ZERO
 13032           MOVE ER-2635             TO WS-ERROR
 13033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13034
 13035******************************************************************
 13036*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13037******************************************************************
 13038
 13039     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13040        NEXT SENTENCE
 13041     ELSE
 13042        IF PB-I-AH-PREMIUM-AMT = ZERO
 13043            IF NOT PB-COMP-AH-PREM
 13044                MOVE ER-2636    TO WS-ERROR
 13045                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13046
 13047
 13048 3140-EDIT-MAX-AMT-SIZES.
 13049* CUSTOM CODE FOR CLIENT    'DMD'
 13050     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13051                                     WS-RES-MUNI-TAX
 13052                                     PB-I-STATE-TAX
 13053                                     PB-I-MUNI-TAX.
 13054
 13055     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13056
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 237
* EL050.cbl
 13057     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13058        GO TO 3150-RATE-OUTSTAND-BAL.
 13059
 13060     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13061        GO TO 3150-RATE-OUTSTAND-BAL.
 13062
 13063     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13064        GO TO 3150-RATE-OUTSTAND-BAL.
 13065
 13066     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13067                             OR 'RIC')
 13068        GO TO 3150-RATE-OUTSTAND-BAL.
 13069
 13070     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13071        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13072            GO TO 3150-RATE-OUTSTAND-BAL
 13073        ELSE
 13074           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13075               GO TO 3150-RATE-OUTSTAND-BAL.
 13076
 13077     IF NOT PB-NO-MONTHS-SKIPPED
 13078        GO TO 3150-RATE-OUTSTAND-BAL.
 13079
 13080     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13081        GO TO 3150-RATE-OUTSTAND-BAL.
 13082
 13083     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13084        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13085           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13086             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13087           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13088           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13089              MOVE ER-2693     TO WS-ERROR
 13090              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13091              GO TO 3150-RATE-OUTSTAND-BAL
 13092           ELSE
 13093              GO TO 3150-RATE-OUTSTAND-BAL.
 13094
 13095 3150-RATE-OUTSTAND-BAL.
 13096
 13097* DMD RATING TEST
 13098     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13099         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13100         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13101         MOVE ER-2687                 TO WS-ERROR
 13102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103         MOVE 'B'                     TO PB-I-OB-FLAG
 13104         GO TO 3260-EDIT-CONTINUE.
 13105
 13106     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13107         IF  WS-ERROR    EQUAL    ER-2693
 13108             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13109                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13110                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13111                 MOVE  +0            TO  WS-ERROR.
 13112
 13113     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13114         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 238
* EL050.cbl
 13115             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13116                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13117                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13118                 MOVE  +0            TO  WS-ERROR.
 13119
 13120     IF PLAN-MASTER-AH-SW = 'Y'
 13121        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13122            IF  WS-ERROR    EQUAL    ER-2693
 13123              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13124                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13125                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13126                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13127                 MOVE  ER-1910           TO  WS-ERROR
 13128                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13129
 13130     IF PLAN-MASTER-AH-SW = 'Y'
 13131        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13132            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13133               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13134               MOVE  ER-1910           TO  WS-ERROR
 13135               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13136
 13137     IF PLAN-MASTER-AH-SW = 'Y'
 13138        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13139            IF  WS-ERROR    EQUAL    ER-2693
 13140                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13141                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13142                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13143                 MOVE  +0       TO  WS-ERROR.
 13144
 13145     IF WS-ERROR = ER-2693
 13146        IF PB-COMPANY-ID = 'JAL' AND
 13147           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13148           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13149           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13150
 13151     IF WS-ERROR = ER-2693
 13152        IF PB-COMPANY-ID = 'NCL'  AND
 13153           PB-I-AH-BENEFIT-CD = 'OA'
 13154           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13155           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13156
 13157     IF WS-ERROR = ER-2693
 13158        IF PB-COMPANY-ID = 'CNL' AND
 13159           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13160           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13161           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13162
 13163     IF WS-ERROR = ER-2693
 13164        IF PB-COMPANY-ID = 'HER'
 13165           IF WS-LEVEL
 13166              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13167              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13168
 13169     IF ((LF-BENEFIT-FOUND) AND
 13170         (NOT NO-LIFE-COVERAGE)  AND
 13171         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13172       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 239
* EL050.cbl
 13173             (NOT NO-AH-COVERAGE)    AND
 13174             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13175         NEXT SENTENCE
 13176     ELSE
 13177         GO TO 3215-EDIT-RATES.
 13178
 13179     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13180        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13181           MOVE ER-2674          TO WS-ERROR
 13182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13183           GO TO 3215-EDIT-RATES.
 13184
 13185     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13186        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13187           MOVE ER-2674          TO WS-ERROR
 13188           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13189           GO TO 3215-EDIT-RATES.
 13190
 13191     MOVE 'B'                    TO PB-I-OB-FLAG.
 13192
 13193     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13194         NEXT SENTENCE
 13195     ELSE
 13196         IF NOT NO-LIFE-COVERAGE
 13197             IF WS-ACCT-LF-OB-RT = ZERO
 13198                MOVE ER-2641    TO WS-ERROR
 13199                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13200
 13201     IF PB-COMPANY-ID = 'CRI'
 13202       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13203         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13204         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13205         IF WS-ERROR = ER-2675
 13206            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13207            MOVE ER-2687              TO WS-ERROR
 13208            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13209         ELSE
 13210            MOVE ER-2687              TO WS-ERROR
 13211            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13212
 13213
 13214     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13215         NEXT SENTENCE
 13216     ELSE
 13217       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13218            NEXT SENTENCE
 13219       ELSE
 13220         IF NOT NO-AH-COVERAGE
 13221             IF WS-ACCT-AH-OB-RT = ZERO
 13222                MOVE ER-2642    TO WS-ERROR
 13223                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13224
 13225     IF PB-COMPANY-ID = 'CRI'
 13226       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13227         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13228         IF WS-ERROR = ER-2676
 13229            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13230            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 240
* EL050.cbl
 13231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13232         ELSE
 13233            MOVE ER-2687              TO WS-ERROR
 13234            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13235
 13236     IF PB-COMPANY-ID NOT = 'GIC'
 13237         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13238            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13239     ELSE
 13240         IF PB-I-LF-PREM-CALC = ZEROS
 13241             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13242                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13243
 13244     IF PB-COMPANY-ID NOT = 'GIC'
 13245         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13246            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13247     ELSE
 13248         IF PB-I-AH-PREM-CALC = ZEROS
 13249             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13250                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13251
 13252     MOVE ZEROS TO PB-I-MORT-CODE.
 13253
 13254     GO TO 3260-EDIT-CONTINUE.
 13255
 13256
 13257 3215-EDIT-RATES.
 13258     IF ACCOUNT-MAST-FOUND
 13259         NEXT SENTENCE
 13260     ELSE
 13261         GO TO 3999-END-EDIT.
 13262
 13263 3220-CHECK-LF-RATES.
 13264
 13265     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13266        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13267        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13268        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13269           AND (NOT WS-LF-CASH))
 13270                           OR
 13271           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13272           AND (NOT WS-AH-CASH)))
 13273                       AND
 13274           (PB-I-ENTRY-STATUS NOT = '5')
 13275           MOVE 'M'              TO PB-BATCH-ENTRY
 13276                                    PB-I-ENTRY-STATUS
 13277        END-IF
 13278     END-IF
 13279     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13280                                    PB-I-AH-PREM-CALC
 13281                                    PB-I-LF-ALT-PREM-CALC
 13282                                    PB-I-LF-ALT-RATE
 13283                                    PB-I-LF-REI-RATE
 13284                                    PB-I-LF-ALT-REI-RATE
 13285                                    PB-I-AH-REI-RATE
 13286                                    PB-I-TOT-FEES-CALC.
 13287
 13288     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 241
* EL050.cbl
 13289        NEXT SENTENCE
 13290     ELSE
 13291        MOVE ZEROS               TO PB-I-LF-RATE
 13292                                    PB-I-AH-RATE.
 13293
 13294     IF PB-I-TOT-FEES NOT NUMERIC
 13295        MOVE ZEROS               TO PB-I-TOT-FEES
 13296     END-IF
 13297     IF PB-I-LIVES NOT NUMERIC
 13298         MOVE ZERO               TO PB-I-LIVES.
 13299
 13300     IF PB-I-NUM-BILLED NOT NUMERIC
 13301         MOVE ZERO               TO PB-I-NUM-BILLED.
 13302
 13303     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13304        MOVE +0                  TO PB-I-LF-PREM-TAX
 13305     END-IF
 13306
 13307     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13308        MOVE +0                  TO PB-I-AH-PREM-TAX
 13309     END-IF
 13310
 13311     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13312        PB-I-PAY-FREQUENCY = ZEROS
 13313            MOVE 12 TO CP-PAY-FREQUENCY
 13314     ELSE
 13315            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13316
 13317     IF PB-I-STATE-TAX NOT NUMERIC
 13318         MOVE ZEROS               TO PB-I-STATE-TAX.
 13319
 13320     IF PB-I-MUNI-TAX NOT NUMERIC
 13321         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13322
 13323     MOVE SPACES                 TO CP-BEN-CATEGORY
 13324     IF PB-COMPANY-ID  = 'CSL'  AND
 13325        PB-I-LF-TERM NOT = ZERO
 13326        COMPUTE WS-PAYMENT-AMT =
 13327             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13328        COMPUTE WS-CSL-AMT1 =
 13329             PB-I-LF-TERM * AM-MAX-MON-BEN
 13330        COMPUTE WS-CSL-AMT2 =
 13331             WS-PAYMENT-AMT * PB-I-LF-TERM
 13332        IF CP-PAY-FREQUENCY NOT = 12
 13333           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13334           MOVE '8' TO WS-CSL-CALC-CD
 13335        ELSE
 13336           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13337              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13338               AM-MAX-TOT-BEN
 13339               MOVE '6' TO WS-CSL-CALC-CD
 13340           ELSE
 13341              IF (WS-CSL-AMT1  GREATER THAN
 13342                 AM-MAX-TOT-BEN) AND
 13343                 (WS-CSL-AMT2  GREATER THAN
 13344                 AM-MAX-TOT-BEN)
 13345                 MOVE '7' TO WS-CSL-CALC-CD
 13346              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 242
* EL050.cbl
 13347                 MOVE '5' TO WS-CSL-CALC-CD.
 13348
 13349     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13350         NEXT SENTENCE
 13351     ELSE
 13352         GO TO 3300-CHECK-AH-RATES.
 13353
 13354*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13355
 13356     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13357        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13358              OR
 13359           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13360           MOVE ER-2618          TO WS-ERROR
 13361           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13362           GO TO 3300-CHECK-AH-RATES.
 13363
 13364     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13365           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13366                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13367
 13368     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13369         MOVE ER-2687             TO WS-ERROR
 13370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13371         MOVE 'Z000'              TO PB-I-MORT-CODE
 13372         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13373         GO TO 3300-CHECK-AH-RATES.
 13374
 13375     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13376        IF PB-I-LIVES = ZERO
 13377           MOVE ER-2688          TO WS-ERROR
 13378           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13379
 13380     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13381
 13382     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13383     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13384     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13385     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13386     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13387     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13388     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13389     MOVE '3'                    TO CP-PROCESS-TYPE.
 13390     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13391     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13392
 13393******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13394     IF PB-COMPANY-ID EQUAL 'CDL'
 13395         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13396            CP-EARN-AS-NET-PAY)
 13397             IF PB-CERT-EFF-DT GREATER  WS-931231
 13398                 MOVE '1'        TO CP-EARNING-METHOD.
 13399*******
 13400
 13401     MOVE PB-SV-STATE            TO CP-STATE.
 13402     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13403     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13404     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 243
* EL050.cbl
 13405     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13406     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13407                                    CP-RATING-BENEFIT-AMT.
 13408     IF CP-STATE-STD-ABBRV = 'OR'
 13409         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13410                                         PB-I-LF-ALT-BENEFIT-AMT.
 13411     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13412     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13413     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13414     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13415     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13416     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13417     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13418     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13419     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13420                                    CP-REMAINING-TERM
 13421                                    CP-LOAN-TERM.
 13422
 13423     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13424         NEXT SENTENCE
 13425     ELSE
 13426         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13427             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13428                                           PB-I-LF-PREMIUM-AMT.
 13429
 13430     IF PB-COMPANY-ID EQUAL 'CSL'
 13431        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13432           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13433                                         PB-I-LF-PREMIUM-AMT.
 13434
 13435     IF PB-COMPANY-ID EQUAL 'NCB'
 13436         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13437            CP-EARN-AS-NET-PAY
 13438             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13439                 PB-I-LF-PREMIUM-AMT.
 13440
 13441     IF (CP-TRUNCATED-LIFE)
 13442        or ((pb-company-id = 'AHL')
 13443           and (pb-i-loan-term > pb-i-lf-term))
 13444        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13445
 13446     IF PB-COMPANY-ID EQUAL 'CRI'
 13447        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13448
 13449     IF CP-TERM-IS-DAYS
 13450         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13451     ELSE
 13452         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13453     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13454        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13455        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13456        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13457        IF WS-LF-BEN-CATEGORY = 'D'
 13458           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13459           MOVE PB-I-LIFE-COMMISSION
 13460                                 TO CP-DCC-ACT-COMM
 13461           MOVE WS-LF-BEN-CATEGORY
 13462                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 244
* EL050.cbl
 13463        END-IF
 13464        IF (CP-BENEFIT-CD (1:1) = 'P')
 13465           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13466           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13467           add pb-i-ah-premium-amt to cp-original-premium
 13468        END-IF
 13469     END-IF
 13470     IF PB-COMPANY-ID = 'CSL'
 13471         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13472         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13473         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13474
 13475     IF PB-COMPANY-ID = 'CSL'
 13476        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13477
 13478     IF (CP-SPECIAL-CALC-CD = 'H')
 13479        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13480         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13481                                    TO CP-ALTERNATE-BENEFIT
 13482         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13483     if (pb-company-id = 'CID')
 13484        and (ws-lf-earnings-calc = '4')
 13485        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13486        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13487        move pb-i-term-type      to cp-pmt-mode
 13488        move pb-i-no-of-payments to cp-no-of-pmts
 13489     end-if
 13490     move ws-net-only-state      to cp-net-only-state
 13491     IF (PB-COMPANY-ID = 'CID')
 13492        AND (WS-LF-EARNINGS-CALC = 'B')
 13493        AND (CP-STATE-STD-ABBRV = 'MN')
 13494        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13495                                 TO CP-ALTERNATE-BENEFIT
 13496        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13497     END-IF
 13498     IF (PB-COMPANY-ID = 'CID')
 13499        AND (WS-LF-EARNINGS-CALC = 'B')
 13500        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13501                                 TO CP-ALTERNATE-BENEFIT
 13502        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13503        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13504*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13505*         pb-i-lf-alt-premium-amt
 13506        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13507        IF WS-LF-BEN-CATEGORY = 'P'
 13508           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13509        ELSE
 13510           IF WS-LF-BEN-CATEGORY = 'I'
 13511              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13512           END-IF
 13513        END-IF
 13514     END-IF
 13515     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13516     MOVE 'R'                   TO CP-RATE-FILE.
 13517     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13518
 13519     IF CP-ERROR-RATE-NOT-FOUND
 13520        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 245
* EL050.cbl
 13521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522        GO TO 3300-CHECK-AH-RATES.
 13523
 13524     IF PB-COMPANY-ID EQUAL 'CRI'
 13525        IF CP-ERROR-NO-LIMITS-CRI
 13526           IF NOT ACCOUNT-LIFE-CHECKED
 13527              MOVE ER-2607      TO WS-ERROR
 13528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13529
 13530******************************************************************
 13531*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13532*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13533******************************************************************
 13534
 13535* CALC LIFE AGE AT EXPIRATION.
 13536
 13537     COMPUTE WS-AGE-AT-EXPIRE =
 13538          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13539
 13540*    IF PB-STATE = 'CO' OR 'UT'
 13541*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13542*        MOVE 'F'            TO PB-FATAL-FLAG
 13543*        MOVE ER-2709        TO WS-ERROR
 13544*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13545*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13546
 13547*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13548*        MOVE 'X'            TO PB-FATAL-FLAG
 13549*        MOVE ER-2718        TO WS-ERROR
 13550*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13551*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13552
 13553* CALC A & H AGE AT EXPIRATION.
 13554
 13555     COMPUTE WS-AGE-AT-EXPIRE =
 13556          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13557
 13558*    IF PB-STATE = 'CO' OR 'UT'
 13559*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13560*        MOVE 'F'            TO PB-FATAL-FLAG
 13561*        MOVE ER-2709        TO WS-ERROR
 13562*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13563*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13564
 13565*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13566*        MOVE 'X'            TO PB-FATAL-FLAG
 13567*        MOVE ER-2718        TO WS-ERROR
 13568*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13569*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13570
 13571     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13572        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13573
 13574     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13575        and (not pb-monthly-cert)
 13576        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13577     end-if
 13578
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 246
* EL050.cbl
 13579     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13580        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13581
 13582     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13583         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13584         MOVE ER-2639        TO WS-ERROR
 13585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13586
 13587
 13588******************************************************************
 13589*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13590******************************************************************
 13591
 13592 PREMIUM-EDITING-IS-BYPASSED.
 13593     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13594        AND (CP-R-MAX-ATT-AGE > +0)
 13595        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13596        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13597           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13598           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13599           MOVE '1'              TO DC-OPTION-CODE
 13600           PERFORM 8500-DATE-CONVERT
 13601                                 THRU 8500-EXIT
 13602           IF NO-CONVERSION-ERROR
 13603              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13604                 MOVE ER-2661       TO WS-ERROR
 13605*                PERFORM 9900-ERROR-FORMAT
 13606*                                THRU 9900-EXIT
 13607              END-IF
 13608           END-IF
 13609        ELSE
 13610           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13611           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13612              MOVE ER-2661       TO WS-ERROR
 13613*             PERFORM 9900-ERROR-FORMAT
 13614*                                THRU 9900-EXIT
 13615           ELSE
 13616              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13617                 MOVE ER-1570    TO WS-ERROR
 13618                 PERFORM 9900-ERROR-FORMAT
 13619                                 THRU 9900-EXIT
 13620              END-IF
 13621           END-IF
 13622        END-IF
 13623        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13624           MOVE PB-I-JOINT-BIRTHDAY
 13625                                 TO DC-BIN-DATE-1
 13626           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13627           MOVE '1'              TO DC-OPTION-CODE
 13628           PERFORM 8500-DATE-CONVERT
 13629                                 THRU 8500-EXIT
 13630           IF NO-CONVERSION-ERROR
 13631              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13632                 MOVE ER-2661       TO WS-ERROR
 13633*                PERFORM 9900-ERROR-FORMAT
 13634*                                THRU 9900-EXIT
 13635              END-IF
 13636           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 247
* EL050.cbl
 13637              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13638           END-IF
 13639        ELSE
 13640           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13641             (PB-I-LF-TERM / 12)
 13642           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13643              MOVE ER-2661       TO WS-ERROR
 13644*             PERFORM 9900-ERROR-FORMAT
 13645*                                THRU 9900-EXIT
 13646           ELSE
 13647              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13648                 MOVE ER-1571    TO WS-ERROR
 13649                 PERFORM 9900-ERROR-FORMAT
 13650                                 THRU 9900-EXIT
 13651              END-IF
 13652           END-IF
 13653        END-IF
 13654        IF WS-ERROR = ER-2661
 13655           PERFORM 9900-ERROR-FORMAT
 13656                                 THRU 9900-EXIT
 13657        END-IF
 13658     END-IF
 13659*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13660*       MOVE ER-2661             TO WS-ERROR
 13661*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13662
 13663     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13664        MOVE ER-2662             TO WS-ERROR
 13665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13666
 13667     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13668        MOVE ER-2677             TO WS-ERROR
 13669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13670
 13671     IF CP-ERROR-LOAN-TERM
 13672        MOVE ER-2648             TO WS-ERROR
 13673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13674
 13675 3221-CHECK-ERROR-RATE-OPEN.
 13676
 13677     IF CP-ERROR-RATE-FILE-NOTOPEN
 13678         GO TO 3990-FILES-NOT-OPEN.
 13679
 13680     IF PB-COMPANY-ID NOT = 'DMD'
 13681        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13682     END-IF
 13683     .
 13684 3221-CONTINUE.
 13685     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13686                                    WS-DCC-AH-RATE
 13687     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13688        IF WS-LF-BEN-CATEGORY = 'D'
 13689           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13690              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13691        END-IF
 13692     END-IF
 13693     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13694*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 248
* EL050.cbl
 13695     IF (PB-COMPANY-ID = 'CID')
 13696        AND (WS-LF-EARNINGS-CALC = 'B')
 13697        AND (CP-STATE-STD-ABBRV = 'MN')
 13698        AND (PB-CERT-EFF-DT > X'A4FF')
 13699        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13700     END-IF
 13701     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13702
 13703     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13704     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13705        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13706        AND (PB-I-POLICY-IS-MONTHLY)
 13707        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13708        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13709     END-IF
 13710     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13711     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13712     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13713     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13714     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13715        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13716        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13717        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13718        MOVE ER-2786             TO WS-ERROR
 13719        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13720     END-IF
 13721
 13722     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13723
 13724******************************************************************
 13725*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13726******************************************************************
 13727     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13728        and ((not pb-monthly-cert)
 13729        or (ws-lf-ben-category = 'C'))
 13730        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13731
 13732     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13733        GO TO 3225-CHECK-ALT-LIFE-RATE
 13734     ELSE
 13735       IF PB-I-LF-RATE = ZERO
 13736          MOVE ER-2641          TO WS-ERROR
 13737          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13738
 13739 3225-CHECK-ALT-LIFE-RATE.
 13740
 13741     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13742        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13743        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13744         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13745
 13746     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13747         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13748             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13749                   OR
 13750              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13751              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13752              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 249
* EL050.cbl
 13753             MOVE ER-2720        TO  WS-ERROR
 13754             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13755             GO TO 3225-RATING-CONT
 13756         ELSE
 13757             GO TO 3225-RATING-CONT.
 13758     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13759        AND (AM-GPCD = 01 OR 06 OR 15)
 13760        MOVE ER-2798             TO WS-ERROR
 13761        PERFORM 9900-ERROR-FORMAT
 13762                                 THRU 9900-EXIT
 13763*       GO TO 3225-RATING-CONT
 13764     END-IF
 13765     if (pb-company-id = 'CID')
 13766        and (ws-lf-earnings-calc = 'B')
 13767        and (ws-lf-ben-category = 'P' or 'I')
 13768        and (ws-net-only-state = 'Y')
 13769        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13770        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13771        go to 3225-rating-cont
 13772     end-if
 13773     IF (PB-COMPANY-ID = 'CID')
 13774        AND (WS-LF-EARNINGS-CALC = 'B')
 13775        AND (CP-STATE-STD-ABBRV = 'MN')
 13776        AND (PB-CERT-EFF-DT > X'A4FF')
 13777        GO TO 3225-RATING-CONT
 13778     END-IF
 13779     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13780        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13781           AND (PB-I-POLICY-IS-MONTHLY)
 13782           GO TO 3225-RATING-CONT
 13783        END-IF
 13784     END-IF
 13785
 13786     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13787        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13788        CP-EARN-AS-REG-BALLOON
 13789        NEXT SENTENCE
 13790     ELSE
 13791        MOVE '2'                 TO CP-EARNING-METHOD.
 13792
 13793 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13794
 13795     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13796
 13797     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13798        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13799        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13800         NEXT SENTENCE
 13801     ELSE
 13802         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13803
 13804     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13805     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13806     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13807                                     CP-RATING-BENEFIT-AMT.
 13808     IF CP-STATE-STD-ABBRV = 'OR'
 13809         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13810                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 250
* EL050.cbl
 13811     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13812        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13813     END-IF
 13814     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13815     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13816     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13817                                    CP-REMAINING-TERM
 13818                                    CP-LOAN-TERM.
 13819     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13820        ADD +1                   TO CP-ORIGINAL-TERM
 13821                                    CP-REMAINING-TERM
 13822                                    CP-LOAN-TERM.
 13823
 13824     MOVE 'R'                   TO CP-RATE-FILE.
 13825     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13826
 13827     IF CP-ERROR-RATE-NOT-FOUND
 13828         MOVE ER-2641            TO WS-ERROR
 13829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13830         GO TO 3300-CHECK-AH-RATES.
 13831
 13832     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13833     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13834
 13835     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13836         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13837
 13838     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13839                               + PB-I-LF-ALT-BENEFIT-AMT.
 13840
 13841     IF ACCOUNT-LIFE-CHECKED  OR
 13842        PB-POLICY-IS-VOIDED   OR
 13843        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13844        and (not pb-monthly-cert))
 13845        GO TO 3225-CONTINUE.
 13846
 13847     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13848        GO TO 3225-CONTINUE.
 13849
 13850     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13851                             EC-RT-LF-MAX-TOT-BEN
 13852        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13853        MOVE ER-2639       TO WS-ERROR
 13854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13855
 13856 3225-CONTINUE.
 13857     IF PB-I-LF-ALT-RATE = ZERO
 13858         MOVE ER-2659            TO WS-ERROR
 13859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13860
 13861     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13862        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13863        MOVE ER-2698             TO WS-ERROR
 13864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13865
 13866 3225-RATING-CONT.
 13867
 13868     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 251
* EL050.cbl
 13869        and (not pb-monthly-cert)
 13870         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13871         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13872         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13873            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13874            CONTINUE
 13875         ELSE
 13876            MOVE ER-2687         TO WS-ERROR
 13877            PERFORM 9900-ERROR-FORMAT
 13878                                 THRU 9900-EXIT
 13879         END-IF
 13880         GO TO 3290-EDIT-LF-REIN-RATE
 13881     END-IF
 13882
 13883* DMD RATING TEST
 13884     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13885         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13886         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13887         MOVE ER-2687                 TO WS-ERROR
 13888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889         GO TO 3290-EDIT-LF-REIN-RATE.
 13890
 13891 3230-CLIENT-MORT-CD-SPECIALS.
 13892
 13893     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13894     SET BIN-TO-GREG          TO TRUE.
 13895*    MOVE ' '                 TO DC-OPTION-CODE.
 13896     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13897     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13898
 13899 C-POS-3230-MORT-CD.
 13900     IF PB-COMPANY-ID = 'POS' AND
 13901        PB-SV-CARRIER = '2'
 13902         NEXT SENTENCE
 13903     ELSE
 13904         GO TO C-POS-3240-MORT-CD.
 13905
 13906     IF PB-SV-GROUPING = '030'
 13907        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13908         MOVE '2350' TO PB-I-MORT-CODE
 13909      ELSE
 13910         MOVE '3300' TO PB-I-MORT-CODE.
 13911
 13912
 13913 C-POS-3240-MORT-CD.
 13914     IF PB-COMPANY-ID = 'POS' AND
 13915        PB-SV-CARRIER = '1'
 13916         NEXT SENTENCE
 13917     ELSE
 13918         GO TO 3230-CONTINUE.
 13919
 13920     IF PB-SV-STATE = '45' OR '47'
 13921        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13922         MOVE '5200' TO PB-I-MORT-CODE
 13923     ELSE
 13924         MOVE '8300' TO PB-I-MORT-CODE.
 13925
 13926 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 252
* EL050.cbl
 13927
 13928     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13929        GO TO 3240-CONTINUE
 13930     END-IF
 13931
 13932     IF PB-CERT-EFF-DT > WS-971231
 13933        GO TO 3240-CONTINUE
 13934     END-IF
 13935
 13936     IF LF-BENEFIT-FOUND AND
 13937        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13938         MOVE 'F250'       TO PB-I-MORT-CODE
 13939     ELSE
 13940         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13941             MOVE '7250'   TO PB-I-MORT-CODE
 13942         ELSE
 13943             MOVE '4251'   TO PB-I-MORT-CODE
 13944         END-IF
 13945     END-IF
 13946
 13947     .
 13948 3240-CONTINUE.
 13949
 13950     IF PB-COMPANY-ID NOT = 'GNL'
 13951         GO TO 3256-CONTINUE.
 13952
 13953     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13954         MOVE 'A300' TO PB-I-MORT-CODE
 13955     ELSE
 13956         MOVE '8350' TO PB-I-MORT-CODE.
 13957
 13958 3256-CONTINUE.
 13959     IF PB-COMPANY-ID NOT = 'ABL'
 13960         GO TO 3260-EDIT-CONTINUE.
 13961
 13962     IF PB-I-LF-TERM GREATER THAN 59
 13963         MOVE 'F550' TO PB-I-MORT-CODE
 13964     ELSE
 13965         MOVE 'E550' TO PB-I-MORT-CODE.
 13966
 13967 3260-EDIT-CONTINUE.
 13968     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13969
 13970 3290-EDIT-LF-REIN-RATE.
 13971     IF LF-REIN-NSP-NOT-USED
 13972         GO TO 3290-RATING-CONT.
 13973
 13974     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13975        GO TO 3290-RATING-CONT.
 13976     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13977     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13978     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13979     MOVE '3'                   TO CP-PROCESS-TYPE.
 13980     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13981
 13982******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13983     IF PB-COMPANY-ID EQUAL 'CDL'
 13984         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 253
* EL050.cbl
 13985            CP-EARN-AS-NET-PAY)
 13986             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13987*            MOVE SPACE          TO DC-OPTION-CODE
 13988             SET BIN-TO-GREG     TO TRUE
 13989             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13990***  Y2K PROJ 7744
 13991             IF DC-GREG-DATE-CYMD GREATER 19931231
 13992                 MOVE '1'        TO CP-EARNING-METHOD.
 13993***  Y2K PROJ 7744
 13994*******
 13995
 13996     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13997     MOVE PB-SV-STATE           TO CP-STATE.
 13998     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13999     MOVE ZERO                  TO CP-DEVIATION-CODE
 14000                                   CP-RATE-DEV-PCT.
 14001     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14002     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14003                                   CP-RATING-BENEFIT-AMT.
 14004
 14005************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14006     IF PB-COMPANY-ID EQUAL 'NCB'
 14007         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14008            CP-EARN-AS-NET-PAY
 14009             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14010                 PB-I-LF-PREMIUM-AMT.
 14011************
 14012
 14013     IF CP-STATE-STD-ABBRV = 'OR'
 14014         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14015                                         PB-I-LF-ALT-BENEFIT-AMT.
 14016     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14017     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14018     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14019     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14020     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14021     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14022     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14023     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14024                                   CP-REMAINING-TERM
 14025                                   CP-LOAN-TERM.
 14026     IF CP-TRUNCATED-LIFE
 14027        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14028
 14029     IF CP-TERM-IS-DAYS
 14030         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14031     ELSE
 14032         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14033
 14034     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14035        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14036     END-IF
 14037     IF PB-COMPANY-ID NOT = 'TIC'
 14038          MOVE ZERO          TO CP-CLASS-CODE.
 14039
 14040     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14041
 14042     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 254
* EL050.cbl
 14043     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14044
 14045     IF CP-ERROR-RATE-NOT-FOUND
 14046        IF PB-I-OB
 14047           MOVE ER-2625      TO WS-ERROR
 14048           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14049           GO TO 3299-EDIT-CONTINUE
 14050        ELSE
 14051           MOVE ER-2643      TO WS-ERROR
 14052           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14053           GO TO 3299-EDIT-CONTINUE.
 14054
 14055     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14056
 14057     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14058     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14059
 14060     IF PB-I-LF-REI-RATE = ZERO
 14061         MOVE ER-2643        TO WS-ERROR
 14062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14063
 14064 3290-CHECK-ALT-REIN-RATE.
 14065
 14066     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14067        GO TO 3290-RATING-CONT.
 14068
 14069     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14070     MOVE '2'                    TO CP-EARNING-METHOD.
 14071     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14072     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14073     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14074     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14075                                     CP-RATING-BENEFIT-AMT.
 14076     IF CP-STATE-STD-ABBRV = 'OR'
 14077         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14078                                         PB-I-LF-ALT-BENEFIT-AMT.
 14079     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14080        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14081     END-IF
 14082     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14083     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14084     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14085                                    CP-REMAINING-TERM
 14086                                    CP-LOAN-TERM.
 14087     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14088        ADD +1                   TO CP-ORIGINAL-TERM
 14089                                    CP-REMAINING-TERM
 14090                                    CP-LOAN-TERM.
 14091
 14092     MOVE 'R'                   TO CP-RATE-FILE.
 14093     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14094
 14095     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14096
 14097     IF PB-I-LF-ALT-REI-RATE = ZERO
 14098         MOVE ER-2643            TO WS-ERROR
 14099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14100
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 255
* EL050.cbl
 14101 3290-RATING-CONT.
 14102
 14103     IF PB-I-OB
 14104*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14105        GO TO 3300-CHECK-AH-RATES.
 14106
 14107 3299-EDIT-CONTINUE.
 14108
 14109     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14110         NEXT SENTENCE
 14111     ELSE
 14112         MOVE ER-2620           TO WS-ERROR
 14113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14114
 14115 3300-CHECK-AH-RATES.
 14116     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14117         NEXT SENTENCE
 14118     ELSE
 14119         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14120
 14121     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14122        and (not pb-monthly-cert))
 14123                  or
 14124        ((CF-COMPANY-ID = 'DMD') AND
 14125                (NO-DMD-RATING))
 14126         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14127            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14128            CONTINUE
 14129         ELSE
 14130            MOVE ER-2687         TO WS-ERROR
 14131            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14132         END-IF
 14133         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14134         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14135     END-IF
 14136
 14137     IF PB-I-OB
 14138        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14139
 14140     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14141         MOVE ER-2687             TO WS-ERROR
 14142         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14143         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14144         GO TO 3999-END-EDIT.
 14145
 14146*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14147     if pb-company-id = 'AHL'
 14148        go to 3300-skip-crit-per
 14149     end-if
 14150     if (pb-i-ah-crit-per not = zeros)
 14151        and (ws-ah-special-calc-cd not = 'C')
 14152        MOVE ER-1572             TO WS-ERROR
 14153        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14154        go to 3300-skip-crit-per
 14155     END-IF
 14156     if (pb-company-id = 'DCC' or 'VPP')
 14157        and (am-dcc-product-code not = spaces)
 14158        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 256
* EL050.cbl
 14159     end-if
 14160     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14161        IF PB-I-AH-CRIT-PER = ZERO
 14162           move ws-ah-max-bens   to pb-i-ah-crit-per
 14163*          MOVE ER-2618       TO WS-ERROR
 14164*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14165*          GO TO 3999-END-EDIT
 14166        END-IF
 14167     END-IF
 14168     if (ws-ah-special-calc-cd = 'C')
 14169        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14170        MOVE ER-1576             TO WS-ERROR
 14171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14172     end-if
 14173
 14174     .
 14175 3300-skip-crit-per.
 14176     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14177     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14178     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14179     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14180     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14181     MOVE PB-SV-STATE            TO CP-STATE.
 14182     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14183     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14184     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14185*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14186     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14187     MOVE '3'                    TO CP-PROCESS-TYPE.
 14188     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14189     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14190                                    CP-RATING-BENEFIT-AMT.
 14191     IF PB-COMPANY-ID = 'CID'
 14192               OR
 14193        CP-STATE-STD-ABBRV = 'OR'
 14194         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14195                                         PB-I-AH-TERM.
 14196     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14197        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14198           AND (PB-I-POLICY-IS-MONTHLY)
 14199           MOVE PB-I-LF-BENEFIT-AMT
 14200                                 TO CP-NET-BENEFIT-AMT
 14201           move pb-i-ah-premium-amt to cp-original-premium
 14202           add pb-i-lf-premium-amt to cp-original-premium
 14203        END-IF
 14204     END-IF
 14205     MOVE SPACES                 TO CP-BEN-CATEGORY
 14206     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14207        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14208        EVALUATE TRUE
 14209           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14210              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14211              MOVE PB-I-LF-BENEFIT-AMT
 14212                                 TO CP-RATING-BENEFIT-AMT
 14213              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14214           WHEN WS-AH-BEN-CATEGORY = 'G'
 14215              MOVE PB-I-UNPAID-CASH-PRICE
 14216                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 257
* EL050.cbl
 14217           WHEN WS-AH-BEN-CATEGORY = 'D'
 14218              MOVE WS-AH-PMF-COMM
 14219                                 TO CP-DCC-PMF-COMM
 14220              MOVE PB-I-AH-COMMISSION
 14221                                 TO CP-DCC-ACT-COMM
 14222        END-EVALUATE
 14223     END-IF
 14224     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14225     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14226     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14227     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14228     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14229     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14230     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14231                                    CP-REMAINING-TERM
 14232                                    WS-WORK-TERM.
 14233     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14234
 14235     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14236     SET BIN-TO-GREG             TO TRUE.
 14237*    MOVE ' '                    TO DC-OPTION-CODE.
 14238     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14239     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14240
 14241     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14242     IF NOT VALID-SKIP-CODE
 14243         MOVE ER-2683            TO WS-ERROR
 14244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14245         GO TO 3320-RATE-CONTINUE.
 14246
 14247     IF PB-NO-MONTHS-SKIPPED
 14248         GO TO 3320-RATE-CONTINUE.
 14249
 14250     MOVE SPACE TO NUMBER-OF-MONTHS.
 14251
 14252     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14253         MOVE 'S'                TO SK-MO (6).
 14254     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14255         MOVE 'S'                TO SK-MO (7).
 14256     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14257         MOVE 'S'                TO SK-MO (8).
 14258     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14259         MOVE 'S'                TO SK-MO (9).
 14260     IF PB-I-SKIP-CODE = 'A'
 14261         MOVE 'S'                TO SK-MO (10).
 14262
 14263     MOVE 1                      TO SUB2.
 14264     MOVE PB-I-AH-TERM           TO SUB3.
 14265     MOVE WS-MONTH               TO SUB1.
 14266     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14267     GO TO 3320-RATE-CONTINUE.
 14268
 14269 3310-GET-SKIP-MO.
 14270     IF SUB1 = 13
 14271         MOVE 1                  TO SUB1.
 14272
 14273     IF SK-MO (SUB1) = 'S'
 14274         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 258
* EL050.cbl
 14275
 14276     ADD 1 TO SUB2
 14277              SUB1.
 14278
 14279 3320-RATE-CONTINUE.
 14280
 14281     IF WS-WORK-TERM = ZERO
 14282         MOVE 1                  TO WS-WORK-TERM.
 14283
 14284     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14285                                    CP-LOAN-TERM.
 14286
 14287     IF PB-COMPANY-ID EQUAL 'DMD'
 14288         NEXT SENTENCE
 14289     ELSE
 14290         MOVE ZERO               TO PB-I-AH-RATE
 14291                                    PB-I-AH-REI-RATE.
 14292
 14293
 14294     IF PB-COMPANY-ID EQUAL 'CRI'
 14295        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14296
 14297     IF PB-COMPANY-ID = 'CSL'
 14298         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14299         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14300         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14301         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14302
 14303     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14304        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14305           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14306              PB-I-RATE-DEV-PCT-LF
 14307        END-IF
 14308        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14309                                 TO CP-ALTERNATE-BENEFIT
 14310        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14311        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14312        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14313     END-IF
 14314*    if ws-clp-state not = spaces
 14315*       move ws-clp-state to cp-state
 14316*    end-if
 14317     IF (PB-COMPANY-ID = 'CID')
 14318        AND (WS-LF-EARNINGS-CALC = 'B')
 14319        AND (CP-STATE-STD-ABBRV = 'MN')
 14320        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14321     ELSE
 14322        MOVE ' '                 TO CP-AH-BALLOON-SW
 14323     END-IF
 14324     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14325     MOVE 'R'                   TO CP-RATE-FILE.
 14326     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14327
 14328     IF (CP-ERROR-RATE-NOT-FOUND)
 14329        and (not pb-monthly-cert)
 14330        IF PB-I-OB
 14331           MOVE ER-2624          TO WS-ERROR
 14332           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 259
* EL050.cbl
 14333           GO TO 3340-CALCULATE-PREMIUM-AMT
 14334        ELSE
 14335          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14336              NEXT SENTENCE
 14337          ELSE
 14338           MOVE ER-2642          TO WS-ERROR
 14339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14340           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14341
 14342     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14343        CP-ERROR-DIV-BY-ZERO
 14344           MOVE ER-3782          TO WS-ERROR
 14345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14346
 14347     IF PB-COMPANY-ID EQUAL 'CRI'
 14348        IF CP-ERROR-NO-LIMITS-CRI
 14349           IF NOT ACCOUNT-AH-CHECKED
 14350              MOVE ER-2607          TO WS-ERROR
 14351              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14352
 14353     IF ACCOUNT-AH-CHECKED
 14354        NEXT SENTENCE
 14355     ELSE
 14356       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14357          MOVE ER-2640           TO WS-ERROR
 14358          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14359
 14360     IF PB-COMPANY-ID = 'CRI'
 14361         IF WS-ERROR = ER-2640
 14362             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14363     IF ACCOUNT-AH-CHECKED
 14364        CONTINUE
 14365     ELSE
 14366        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14367           AND (CP-R-MAX-ATT-AGE > +0)
 14368           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14369           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14370              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14371              MOVE PB-I-AH-EXPIRE-DT
 14372                                 TO DC-BIN-DATE-2
 14373              MOVE '1'           TO DC-OPTION-CODE
 14374              PERFORM 8500-DATE-CONVERT
 14375                                 THRU 8500-EXIT
 14376              IF NO-CONVERSION-ERROR
 14377                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14378                    MOVE ER-2661       TO WS-ERROR
 14379*                   PERFORM 9900-ERROR-FORMAT
 14380*                                THRU 9900-EXIT
 14381                 END-IF
 14382              END-IF
 14383           ELSE
 14384              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14385              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14386                 MOVE ER-2661    TO WS-ERROR
 14387*                PERFORM 9900-ERROR-FORMAT
 14388*                                THRU 9900-EXIT
 14389              ELSE
 14390                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 260
* EL050.cbl
 14391                    MOVE ER-1570 TO WS-ERROR
 14392                    PERFORM 9900-ERROR-FORMAT
 14393                                 THRU 9900-EXIT
 14394                 END-IF
 14395              END-IF
 14396           END-IF
 14397           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14398              MOVE PB-I-JOINT-BIRTHDAY
 14399                                    TO DC-BIN-DATE-1
 14400              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14401              MOVE '1'              TO DC-OPTION-CODE
 14402              PERFORM 8500-DATE-CONVERT
 14403                                    THRU 8500-EXIT
 14404              IF NO-CONVERSION-ERROR
 14405                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14406                    MOVE ER-2661       TO WS-ERROR
 14407*                   PERFORM 9900-ERROR-FORMAT
 14408*                                   THRU 9900-EXIT
 14409                 END-IF
 14410              END-IF
 14411           ELSE
 14412              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14413                (PB-I-AH-TERM / 12)
 14414              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14415                 MOVE ER-2661       TO WS-ERROR
 14416*                PERFORM 9900-ERROR-FORMAT
 14417*                                   THRU 9900-EXIT
 14418              ELSE
 14419                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14420                    MOVE ER-1571 TO WS-ERROR
 14421                    PERFORM 9900-ERROR-FORMAT
 14422                                 THRU 9900-EXIT
 14423                 END-IF
 14424              END-IF
 14425           END-IF
 14426           IF WS-ERROR = ER-2661
 14427              PERFORM 9900-ERROR-FORMAT
 14428                                    THRU 9900-EXIT
 14429           END-IF
 14430        END-IF
 14431     END-IF
 14432*    IF ACCOUNT-AH-CHECKED
 14433*       NEXT SENTENCE
 14434*    ELSE
 14435*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14436*          MOVE ER-2661          TO WS-ERROR
 14437*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14438
 14439     IF ACCOUNT-AH-CHECKED
 14440        NEXT SENTENCE
 14441     ELSE
 14442        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14443           MOVE ER-2663          TO WS-ERROR
 14444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14445
 14446     IF ACCOUNT-AH-CHECKED OR
 14447        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14448         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 261
* EL050.cbl
 14449        NEXT SENTENCE
 14450     ELSE
 14451        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14452           MOVE ER-2667            TO WS-ERROR
 14453           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14454
 14455     IF PB-COMPANY-ID = 'CRI'
 14456         IF WS-ERROR = ER-2667
 14457             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14458
 14459     IF ACCOUNT-AH-CHECKED
 14460        NEXT SENTENCE
 14461     ELSE
 14462        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14463           MOVE ER-2678            TO WS-ERROR
 14464           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14465
 14466     IF CP-ERROR-RATE-FILE-NOTOPEN
 14467         GO TO 3990-FILES-NOT-OPEN.
 14468
 14469 3321-CONTINUE.
 14470     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14471     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14472     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14473*    IF (PB-COMPANY-ID = 'DCC')
 14474        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14475        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14476                                    PB-I-LF-ALT-PREM-CALC
 14477        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14478        IF WS-AH-BEN-CATEGORY = 'G'
 14479           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14480           + PB-I-ADDL-CLP)
 14481           * (1 + WS-TOL-CLP-PCT)
 14482*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14483        ELSE
 14484           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14485           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14486*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14487        END-IF
 14488        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14489                                 TO PB-I-AH-PREM-CALC
 14490        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14491           MOVE ER-8152          TO WS-ERROR
 14492           PERFORM 9900-ERROR-FORMAT
 14493                                 THRU 9900-EXIT
 14494        ELSE
 14495           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14496                 PB-I-ADDL-CLP)
 14497              MOVE ER-8148       TO WS-ERROR
 14498              PERFORM 9900-ERROR-FORMAT
 14499                                 THRU 9900-EXIT
 14500           END-IF
 14501        END-IF
 14502     END-IF
 14503     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14504        AND (PB-I-POLICY-IS-MONTHLY)
 14505        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14506        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 262
* EL050.cbl
 14507        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14508           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14509        END-IF
 14510     END-IF
 14511     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14512        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14513        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14514        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14515        MOVE ER-2786             TO WS-ERROR
 14516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14517     END-IF
 14518     MOVE +0                     TO PB-I-AH-CLP
 14519     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14520        evaluate true
 14521           when WS-AH-BEN-CATEGORY = 'D'
 14522              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14523                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14524           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14525              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14526           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14527              compute ws-cred-union-fees rounded =
 14528                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14529                    pb-i-ah-commission)
 14530              COMPUTE PB-I-AH-CLP =
 14531                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14532        end-evaluate
 14533     END-IF
 14534     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14535
 14536     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14537         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14538
 14539     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14540         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14541
 14542     if (ws-ah-special-calc-cd = 'E')
 14543        and (pb-monthly-cert)
 14544        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14545     end-if
 14546     IF PB-COMPANY-ID = 'CRI'
 14547         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14548            PB-I-PAYMENT-AMOUNT = ZERO
 14549             NEXT SENTENCE
 14550         ELSE
 14551             COMPUTE PB-I-AH-PREM-CALC =
 14552                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14553                 (CP-PREMIUM-RATE / 100)
 14554             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14555                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14556                                             PB-I-RATE-DEV-PCT-AH.
 14557
 14558     IF (PB-I-AH-RATE  = ZERO)
 14559        and (not pb-monthly-cert)
 14560       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14561           NEXT SENTENCE
 14562       ELSE
 14563         MOVE ER-2642            TO WS-ERROR
 14564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 263
* EL050.cbl
 14565
 14566     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14567     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14568     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14569     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14570     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14571     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14572
 14573     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14574        AND (WS-AH-BEN-CATEGORY = 'G')
 14575        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14576        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14577        IF CP-DEVIATION-CODE NOT = '000'
 14578           MOVE '000'            TO CP-DEVIATION-CODE
 14579           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14580           IF NO-CP-ERROR
 14581              COMPUTE PB-I-DDF-IU-RATE-UP =
 14582              PB-I-AH-CLP - CP-CALC-PREMIUM
 14583           ELSE
 14584              MOVE ER-3057        TO WS-ERROR
 14585              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14586           END-IF
 14587        END-IF
 14588     END-IF
 14589     .
 14590 3335-EDIT-AH-REIN-NSP-RATE.
 14591     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14592        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14593              compute ws-cred-union-fees rounded =
 14594                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14595                    pb-i-ah-commission)
 14596              COMPUTE PB-I-AH-CLP =
 14597                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14598        end-if
 14599     END-IF
 14600     IF AH-REIN-NSP-NOT-USED
 14601         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14602
 14603     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14604     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14605         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14606     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14607     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14608     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14609     MOVE PB-SV-STATE            TO CP-STATE.
 14610     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14611     MOVE ZERO                   TO CP-DEVIATION-CODE
 14612                                    CP-RATE-DEV-PCT.
 14613*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14614     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14615     MOVE '3'                    TO CP-PROCESS-TYPE.
 14616     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14617     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14618                                    CP-RATING-BENEFIT-AMT.
 14619     IF CP-STATE-STD-ABBRV = 'OR'
 14620         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14621                                         PB-I-AH-TERM.
 14622     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 264
* EL050.cbl
 14623     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14624     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14625     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14626     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14627     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14628                                    CP-REMAINING-TERM
 14629                                    WS-WORK-TERM.
 14630     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14631     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14632        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14633     END-IF
 14634     IF  PB-COMPANY-ID = 'TIC'
 14635         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14636            MOVE ZERO TO CP-CLASS-CODE.
 14637
 14638     IF PB-COMPANY-ID NOT = 'TIC'
 14639          MOVE ZERO          TO CP-CLASS-CODE.
 14640
 14641     MOVE ZERO               TO CP-DEVIATION-CODE.
 14642
 14643     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14644
 14645     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14646
 14647     MOVE 'R'                   TO CP-RATE-FILE.
 14648     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14649
 14650     IF CP-ERROR-RATE-NOT-FOUND
 14651         MOVE ER-2645        TO WS-ERROR
 14652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14653         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14654
 14655     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14656
 14657     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14658     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14659
 14660     IF PB-I-AH-REI-RATE = ZERO
 14661         MOVE ER-2645        TO WS-ERROR
 14662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14663
 14664
 14665 3340-CALCULATE-PREMIUM-AMT.
 14666
 14667     IF PB-COMPANY-ID = 'NCL'
 14668         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14669             WS-AH-SPECIAL-CALC-CD = 'O')
 14670             GO TO 3999-END-EDIT.
 14671
 14672     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14673                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14674                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14675                         OR 'AHL'
 14676         NEXT SENTENCE
 14677     ELSE
 14678         IF WS-STATE-ABBREVIATION = 'CT'
 14679             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14680                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 265
* EL050.cbl
 14681                 COMPUTE PB-I-LF-PREM-CALC =
 14682                                     PB-I-LF-PREM-CALC * .90
 14683                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14684                                     PB-I-LF-ALT-PREM-CALC * .90
 14685                 COMPUTE PB-I-AH-PREM-CALC =
 14686                                     PB-I-AH-PREM-CALC * .90.
 14687
 14688     IF PB-COMP-LF-PREM
 14689        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14690        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14691
 14692     IF PB-COMP-AH-PREM
 14693        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14694
 14695 3340-CHECK-DCC-TOT-FEES.
 14696     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14697        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14698        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14699        AND (PB-I-POLICY-IS-MONTHLY)
 14700        CONTINUE
 14701     ELSE
 14702        GO TO 3340-EDIT-LF-AH-TOL
 14703     END-IF
 14704     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14705     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14706     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14707        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14708           PB-I-RATE-DEV-PCT-LF
 14709     END-IF
 14710     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14711        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14712           PB-I-RATE-DEV-PCT-AH
 14713     END-IF
 14714     MOVE 'N'                    TO CP-BEN-CATEGORY
 14715     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14716
 14717     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14718     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14719     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14720     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14721     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14722     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14723     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14724     MOVE '3'                    TO CP-PROCESS-TYPE.
 14725     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14726     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14727
 14728     MOVE PB-SV-STATE            TO CP-STATE.
 14729     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14730     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14731     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14732     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14733     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14734                                    CP-RATING-BENEFIT-AMT.
 14735     IF CP-STATE-STD-ABBRV = 'OR'
 14736         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14737                                         PB-I-LF-ALT-BENEFIT-AMT.
 14738     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 266
* EL050.cbl
 14739     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14740     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14741     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14742     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14743     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14744     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14745     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14746     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14747                                    CP-REMAINING-TERM
 14748                                    CP-LOAN-TERM.
 14749     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14750        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14751           PB-I-LF-PREMIUM-AMT
 14752     end-if
 14753
 14754     IF CP-TRUNCATED-LIFE
 14755        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14756
 14757     IF CP-TERM-IS-DAYS
 14758         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14759     ELSE
 14760         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14761
 14762     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14763     IF CP-SPECIAL-CALC-CD = 'H'
 14764         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14765                                    TO CP-ALTERNATE-BENEFIT
 14766         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14767     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14768     MOVE 'R'                    TO CP-RATE-FILE
 14769     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14770     IF NOT CP-ERROR-RATE-NOT-FOUND
 14771        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14772        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14773           AND (CP-BENEFIT-CD (1:1) = 'S')
 14774           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14775                                    PB-I-LF-PREMIUM-AMT
 14776        END-IF
 14777     ELSE
 14778        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14779     END-IF
 14780     .
 14781 3340-EDIT-LF-AH-TOL.
 14782
 14783***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14784***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14785***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14786***
 14787     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14788         PB-I-AH-PREMIUM-AMT
 14789          GIVING WS-CALC-WORK.
 14790
 14791     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14792        AND WS-CALC-WORK NOT = ZERO
 14793         MOVE ER-2649            TO WS-ERROR
 14794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14795
 14796     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 267
* EL050.cbl
 14797             FROM PB-I-LF-PREMIUM-AMT
 14798                 GIVING WS-UNSIGN-WRK1.
 14799
 14800     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14801             FROM PB-I-LF-ALT-PREMIUM-AMT
 14802                 GIVING WS-UNSIGN-WRK4.
 14803
 14804     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14805                                + WS-UNSIGN-WRK4.
 14806
 14807     SUBTRACT PB-I-AH-PREM-CALC
 14808             FROM PB-I-AH-PREMIUM-AMT
 14809                 GIVING WS-UNSIGN-WRK2.
 14810
 14811******************************************************************
 14812*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14813******************************************************************
 14814
 14815     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14816         MOVE ZERO TO WS-UNSIGN-WRK1.
 14817
 14818     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14819         MOVE ZERO TO WS-UNSIGN-WRK2.
 14820
 14821     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14822             GIVING WS-UNSIGN-WRK3.
 14823
 14824 3342-CONTINUE.
 14825
 14826     IF (PB-I-LF-RATE = ZERO  AND
 14827         PB-I-AH-RATE = ZERO)
 14828         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14829            WS-AH-SPECIAL-CALC-CD = 'O'
 14830              NEXT SENTENCE
 14831         ELSE
 14832             GO TO 3345-EDIT-CONTINUE.
 14833
 14834     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14835         NEXT SENTENCE
 14836     ELSE
 14837     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14838        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14839           IF (PB-REISSUED-CERT         OR
 14840               PB-POLICY-IS-DECLINED    OR
 14841               PB-POLICY-IS-VOIDED)
 14842              NEXT SENTENCE
 14843           ELSE
 14844              IF WS-PREM-REJECT-SW = SPACE
 14845                 MOVE ER-2652    TO WS-ERROR
 14846                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14847                 GO TO 3344-CHECK-AH
 14848              ELSE
 14849                 MOVE ER-2650    TO WS-ERROR
 14850                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14851                 GO TO 3344-CHECK-AH.
 14852
 14853***
 14854***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 268
* EL050.cbl
 14855***
 14856
 14857     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14858         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14859            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14860             (1 + WS-TOL-LF-PREM-PCT)
 14861         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14862            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14863             (1 - WS-TOL-LF-PREM-PCT)
 14864     ELSE
 14865         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14866         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14867
 14868***
 14869***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14870***
 14871
 14872     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14873         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14874          WS-TOL-LF-PREM.
 14875
 14876     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14877         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14878          WS-TOL-LF-PREM.
 14879
 14880     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14881        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14882
 14883     IF PB-REISSUED-CERT
 14884        or PB-POLICY-IS-DECLINED
 14885        or PB-POLICY-IS-VOIDED
 14886        continue
 14887     ELSE
 14888        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14889              > WS-TOL-LF-HIGH-PREM-AMT)
 14890           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14891              < WS-TOL-LF-LOW-PREM-AMT))
 14892                      or
 14893           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14894              > WS-TOL-LF-HIGH-PREM-PCT)
 14895           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14896              < WS-TOL-LF-LOW-PREM-PCT))
 14897           IF WS-PREM-REJECT-SW = SPACE
 14898              MOVE ER-2652       TO WS-ERROR
 14899              PERFORM 9900-ERROR-FORMAT
 14900                                 THRU 9900-EXIT
 14901           ELSE
 14902              MOVE ER-2650       TO WS-ERROR
 14903              PERFORM 9900-ERROR-FORMAT
 14904                                 THRU 9900-EXIT
 14905           end-if
 14906        end-if
 14907     end-if
 14908
 14909*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14910*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14911*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14912*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 269
* EL050.cbl
 14913
 14914     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14915        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14916                      OR
 14917           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14918           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14919           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14920           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14921        END-IF
 14922     END-IF
 14923
 14924     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14925        IF WS-COMP-MAX-CAP GREATER THAN +0
 14926           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14927              IF (PB-REISSUED-CERT         OR
 14928                  PB-POLICY-IS-DECLINED    OR
 14929                  PB-POLICY-IS-VOIDED)
 14930                 NEXT SENTENCE
 14931              ELSE
 14932                  MOVE ER-2646   TO  WS-ERROR
 14933                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14934
 14935 3344-CVL-TOLERANCE-CHECK.
 14936
 14937      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14938          GO TO 3344-CHECK-AH.
 14939
 14940      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14941          GO TO 3344-CHECK-AH.
 14942
 14943      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14944                                     WS-UNSIGN-WRK6.
 14945
 14946      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14947          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14948                                 + PB-I-LF-PREMIUM-AMT
 14949                                 - PB-I-LF-PREM-CALC.
 14950
 14951      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14952          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14953                                 + PB-I-LF-ALT-PREMIUM-AMT
 14954                                 - PB-I-LF-ALT-PREM-CALC.
 14955
 14956      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14957          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14958              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14959                 MOVE ER-2652    TO  WS-ERROR
 14960                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14961              ELSE
 14962                 MOVE ER-2650    TO  WS-ERROR
 14963                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14964
 14965      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14966          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14967              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14968                 MOVE ER-2652    TO  WS-ERROR
 14969                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14970              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 270
* EL050.cbl
 14971                 MOVE ER-2650    TO  WS-ERROR
 14972                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14973
 14974 3344-CHECK-AH.
 14975
 14976****************************************************************
 14977***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14978***
 14979
 14980     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14981         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14982             (1 + WS-TOL-AH-PREM-PCT)
 14983         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14984             (1 - WS-TOL-AH-PREM-PCT)
 14985     ELSE
 14986         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14987         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14988
 14989***
 14990***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14991***
 14992
 14993     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14994         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14995
 14996     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14997         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14998
 14999     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15000        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15001
 15002     IF (PB-REISSUED-CERT)
 15003        OR (PB-POLICY-IS-DECLINED)
 15004        OR (PB-POLICY-IS-VOIDED)
 15005        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15006        CONTINUE
 15007     ELSE
 15008        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15009              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15010                          or
 15011           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15012              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15013           IF WS-PREM-REJECT-SW = SPACE
 15014              MOVE ER-3052       TO WS-ERROR
 15015              PERFORM 9900-ERROR-FORMAT
 15016                                 THRU 9900-EXIT
 15017           ELSE
 15018              MOVE ER-3050       TO WS-ERROR
 15019              PERFORM 9900-ERROR-FORMAT
 15020                                 THRU 9900-EXIT
 15021           END-IF
 15022        END-IF
 15023     END-IF
 15024     if (pb-company-id = 'DCC' or 'VPP')
 15025        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15026        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15027        and (pb-i-policy-is-monthly)
 15028        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 271
* EL050.cbl
 15029           pb-i-tot-fees-calc + ws-tol-ah-prem
 15030        compute ws-tol-ah-low-prem-amt =
 15031           pb-i-tot-fees-calc - ws-tol-ah-prem
 15032        if ws-tol-ah-prem-pct > zeros
 15033           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15034              (1 + ws-tol-ah-prem-pct)
 15035           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15036              (1 - ws-tol-ah-prem-pct)
 15037        else
 15038           move +9999999.99      to ws-tol-ah-high-prem-pct
 15039           move +0               to ws-tol-ah-low-prem-pct
 15040        end-if
 15041        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15042            or
 15043           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15044                          or
 15045           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15046           or
 15047           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15048            move er-3049         to ws-error
 15049           perform 9900-error-format
 15050                                 thru 9900-exit
 15051
 15052        end-if
 15053     end-if
 15054     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15055         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15056             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15057             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15058
 15059     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15060        IF WS-COMP-MAX-CAP GREATER THAN +0
 15061           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15062              IF (PB-REISSUED-CERT         OR
 15063                  PB-POLICY-IS-DECLINED    OR
 15064                  PB-POLICY-IS-VOIDED)
 15065                 NEXT SENTENCE
 15066              ELSE
 15067                  MOVE ER-2646   TO  WS-ERROR
 15068                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15069
 15070     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15071        (WS-COMP-MAX-CAP EQUAL +0)
 15072           GO TO 3345-EDIT-CONTINUE.
 15073
 15074     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15075        GREATER THAN WS-COMP-MAX-CAP
 15076           MOVE ER-2646          TO  WS-ERROR
 15077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15078
 15079 3345-EDIT-CONTINUE.
 15080
 15081*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15082*       IF PB-ENTRY-BATCH   NUMERIC
 15083*          IF PB-ISSUE
 15084*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15085*          ELSE
 15086*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 272
* EL050.cbl
 15087*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15088
 15089*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15090*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15091*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15092*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15093*        ELSE
 15094*            MOVE  ER-1909            TO  WS-ERROR
 15095*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15096
 15097     IF PB-I-POLICY-ACCEPTED
 15098        IF PB-POLICY-IS-DECLINED  OR
 15099           PB-REISSUED-CERT  OR
 15100           PB-REIN-ONLY-CERT  OR
 15101           PB-POLICY-IS-VOIDED
 15102            MOVE  ER-1891         TO  WS-ERROR
 15103            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15104        ELSE
 15105            MOVE SPACE            TO  PB-BATCH-ENTRY
 15106            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15107
 15108     IF PB-I-POLICY-DECLINED
 15109        IF PB-REISSUED-CERT  OR
 15110           PB-REIN-ONLY-CERT  OR
 15111           PB-POLICY-IS-VOIDED
 15112            MOVE  ER-1906         TO  WS-ERROR
 15113            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15114        ELSE
 15115            MOVE  'D'             TO  PB-BATCH-ENTRY
 15116                                      PB-I-ENTRY-STATUS.
 15117
 15118     IF PB-I-NEEDS-UNDERWRITING
 15119        IF PB-POLICY-IS-DECLINED OR
 15120           PB-REISSUED-CERT  OR
 15121           PB-REIN-ONLY-CERT  OR
 15122           PB-POLICY-IS-VOIDED
 15123            MOVE  ER-1907         TO  WS-ERROR
 15124            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15125        ELSE
 15126            MOVE 'U'              TO  PB-BATCH-ENTRY
 15127                                      PB-I-ENTRY-STATUS.
 15128
 15129     IF PB-NEEDS-UNDERWRITING
 15130        MOVE  ER-1901             TO  WS-ERROR
 15131        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15132     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15133        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15134        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15135        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15136           AND (NOT WS-LF-CASH))
 15137                           OR
 15138           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15139           AND (NOT WS-AH-CASH)))
 15140                       AND
 15141           (PB-I-ENTRY-STATUS NOT = '5')
 15142           MOVE 'M'              TO PB-BATCH-ENTRY
 15143                                    PB-I-ENTRY-STATUS
 15144        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 273
* EL050.cbl
 15145     END-IF
 15146     move pending-business       to ws-passed-erpndb
 15147     move ' '                    to ws-exceed-limit-yn
 15148     perform 7780-call-agg       thru 7780-exit
 15149*    display ' el050 exceed ' ws-exceed-limit-yn
 15150     if ws-exceed-limit-yn = 'Y'
 15151        MOVE  ER-9813            TO WS-ERROR
 15152        move 'Y'                 to ws-9813-sw
 15153        PERFORM  9900-ERROR-FORMAT
 15154                                 THRU 9900-EXIT
 15155     end-if
 15156     if (PB-EXCEEDED-LIMIT-FORCED)
 15157        and (ws-9813-sw = 'Y')
 15158        subtract +1 from PB-NO-OF-ERRORS
 15159        move er-9823             to ws-error
 15160        PERFORM  9900-ERROR-FORMAT
 15161                                 THRU 9900-EXIT
 15162     end-if
 15163     IF  PB-COMPANY-ID NOT = 'NCL'
 15164         GO TO 3999-END-EDIT.
 15165
 15166     IF PB-REISSUED-CERT  OR
 15167        PB-POLICY-IS-DECLINED  OR
 15168        PB-POLICY-IS-VOIDED  OR
 15169        PB-I-OB
 15170         GO TO 3999-END-EDIT.
 15171
 15172     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15173         MOVE  ER-2644            TO  WS-ERROR
 15174         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15175         GO TO 3999-END-EDIT.
 15176
 15177     MOVE 'N'                     TO  FORM-MASTER-SW.
 15178     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15179
 15180     IF NOT FORM-MASTER-FOUND
 15181         GO TO 3999-END-EDIT.
 15182
 15183     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15184                                      FORM-MASTER-AH-SW.
 15185
 15186     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15187         MOVE  +1                 TO SUB6
 15188         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15189
 15190     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15191         MOVE  +1                 TO SUB6
 15192         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15193
 15194     IF LF-FORM-MASTER-FOUND  OR
 15195        AH-FORM-MASTER-FOUND
 15196         GO TO 3360-CHECK-FORM-LIMITS
 15197     ELSE
 15198         GO TO 3999-END-EDIT.
 15199
 15200******************************************************************
 15201*                  3350-GET-ERFORM                               *
 15202*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 274
* EL050.cbl
 15203*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15204******************************************************************
 15205
 15206 3350-GET-ERFORM.
 15207
 15208     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15209         GO TO  3350-ERFORM-GETMAIN.
 15210
 15211     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15212     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15213     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15214     MOVE 'Y'                     TO FORM-MASTER-SW.
 15215
 15216     IF PB-CANCELLATION
 15217         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15218            PB-SV-STATE          EQUAL   FO-STATE       AND
 15219            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15220              GO TO 3350-EXIT
 15221         ELSE
 15222             NEXT SENTENCE
 15223     ELSE
 15224         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15225            PB-SV-STATE          EQUAL   FO-STATE       AND
 15226            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15227              GO TO 3350-EXIT.
 15228
 15229 3350-ERFORM-GETMAIN.
 15230
 15231     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15232     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15233
 15234 3350-ERFORM-READ.
 15235
 15236     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15237     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15238     IF PB-CANCELLATION
 15239         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15240     ELSE
 15241         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15242     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15243
 15244     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15245
 15246     IF FORM-MASTER-FOUND
 15247       IF PB-CANCELLATION
 15248          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15249             PB-SV-STATE          EQUAL   FO-STATE       AND
 15250             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15251              GO  TO 3350-EXIT
 15252          ELSE
 15253              NEXT SENTENCE
 15254       ELSE
 15255          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15256             PB-SV-STATE          EQUAL   FO-STATE       AND
 15257             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15258              GO  TO 3350-EXIT.
 15259
 15260     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 275
* EL050.cbl
 15261     MOVE  ER-1895                TO  WS-ERROR.
 15262     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15263
 15264 3350-EXIT.
 15265      EXIT.
 15266
 15267******************************************************************
 15268*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15269*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15270*   VALID FOR THE POLICY FORM USED.                              *
 15271******************************************************************
 15272
 15273 3355-EDIT-FORM-LF-BENEFITS.
 15274
 15275     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15276        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15277         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15278         GO TO   3355-EXIT.
 15279
 15280     IF  SUB6    LESS THAN   +40
 15281         ADD  +1      TO  SUB6
 15282         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15283
 15284     MOVE  ER-1896         TO  WS-ERROR.
 15285     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15286
 15287 3355-EXIT.
 15288      EXIT.
 15289
 15290******************************************************************
 15291*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15292*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15293*   VALID FOR THE POLICY FORM USED.                              *
 15294******************************************************************
 15295
 15296 3356-EDIT-FORM-AH-BENEFITS.
 15297
 15298     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15299        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15300         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15301         GO TO  3356-EXIT.
 15302
 15303      IF  SUB6    LESS THAN     +40
 15304          ADD  +1      TO  SUB6
 15305          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15306
 15307     MOVE  ER-1897         TO  WS-ERROR.
 15308     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15309
 15310 3356-EXIT.
 15311      EXIT.
 15312
 15313******************************************************************
 15314*                  3357-BENEFIT-SEARCH                           *
 15315*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15316*   CANCELLATIONS ONLY.                                          *
 15317******************************************************************
 15318 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 276
* EL050.cbl
 15319     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15320         MOVE +1                          TO SUB6
 15321         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15322
 15323     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15324         MOVE +1                          TO SUB6
 15325         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15326
 15327 3357-EXIT.
 15328     EXIT.
 15329
 15330******************************************************************
 15331*                  3358-BENEFIT-LIFE-SEARCH                      *
 15332*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15333*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15334*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15335******************************************************************
 15336 3358-BENEFIT-LIFE-SEARCH.
 15337     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15338       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15339         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15340           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15341              IF FO-PLAN-REFUND-METHOD (SUB6)
 15342                     IS GREATER THAN SPACES
 15343                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15344                                          WS-LF-REFUND-CALC
 15345                 GO TO 3358-EXIT.
 15346
 15347     IF SUB6 LESS THAN +40
 15348         ADD +1                 TO SUB6
 15349         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15350
 15351 3358-EXIT.
 15352     EXIT.
 15353******************************************************************
 15354*                  3359-BENEFIT-AH-SEARCH                        *
 15355*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15356*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15357*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15358******************************************************************
 15359 3359-BENEFIT-AH-SEARCH.
 15360     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15361       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15362         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15363           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15364              IF FO-PLAN-REFUND-METHOD (SUB6)
 15365                      IS GREATER THAN SPACES
 15366                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15367                                          WS-AH-REFUND-CALC
 15368                 GO TO 3359-EXIT.
 15369
 15370     IF SUB6 LESS THAN +40
 15371         ADD +1                 TO SUB6
 15372         GO TO 3359-BENEFIT-AH-SEARCH.
 15373
 15374 3359-EXIT.
 15375     EXIT.
 15376
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 277
* EL050.cbl
 15377******************************************************************
 15378*                  3360-CHECK-FORM-LIMITS                        *
 15379*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15380*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15381******************************************************************
 15382
 15383 3360-CHECK-FORM-LIMITS.
 15384
 15385     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15386         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15387
 15388     IF NOT LF-FORM-MASTER-FOUND
 15389         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15390
 15391 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15392
 15393     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15394       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15395        WS-LF-JOINT-INDICATOR = 'J'  AND
 15396        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15397         IF PB-COMPANY-ID = 'NCL'
 15398            MOVE  ER-1911          TO  WS-ERROR
 15399            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15400         ELSE
 15401            MOVE  ER-1892          TO  WS-ERROR
 15402            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15403
 15404 3360-CHECK-FORM-LF-ATT-AGE.
 15405
 15406     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15407
 15408     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15409         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15410         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15411            IF PB-COMPANY-ID = 'NCL'
 15412                MOVE  ER-1913      TO  WS-ERROR
 15413                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15414            ELSE
 15415                MOVE  ER-1894      TO  WS-ERROR
 15416                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15417
 15418 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15419
 15420     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15421         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15422         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15423            IF PB-COMPANY-ID = 'NCL'
 15424                MOVE  ER-1914      TO  WS-ERROR
 15425                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15426            ELSE
 15427                MOVE  ER-1899      TO  WS-ERROR
 15428                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15429
 15430 3360-CHECK-FORM-LF-TERM-BAMT.
 15431
 15432     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15433         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15434         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 278
* EL050.cbl
 15435           IF  PB-COMPANY-ID = 'NCL'
 15436               MOVE  ER-1916       TO  WS-ERROR
 15437               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15438           ELSE
 15439               MOVE  ER-1902       TO  WS-ERROR
 15440               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15441
 15442     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15443                                    PB-I-LF-ALT-BENEFIT-AMT.
 15444
 15445     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15446         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15447         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15448             IF  PB-COMPANY-ID = 'NCL'
 15449                 MOVE  ER-1918     TO  WS-ERROR
 15450                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15451             ELSE
 15452                 MOVE  ER-1904     TO  WS-ERROR
 15453                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15454
 15455******************************************************************
 15456*                  3360-CHECK-FORM-AH-LIMITS                     *
 15457*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15458*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15459******************************************************************
 15460
 15461 3360-CHECK-FORM-AH-LIMITS.
 15462
 15463     IF NOT AH-FORM-MASTER-FOUND
 15464         GO TO 3999-END-EDIT.
 15465
 15466 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15467
 15468     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15469       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15470        WS-AH-JOINT-INDICATOR = 'J'  AND
 15471        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15472         IF PB-COMPANY-ID = 'NCL'
 15473            MOVE  ER-1912          TO  WS-ERROR
 15474            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15475         ELSE
 15476            MOVE  ER-1893          TO  WS-ERROR
 15477            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15478
 15479 3360-CHECK-FORM-AH-ATT-AGE.
 15480
 15481     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15482
 15483     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15484         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15485         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15486            IF PB-COMPANY-ID = 'NCL'
 15487                MOVE  ER-1913      TO  WS-ERROR
 15488                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15489            ELSE
 15490                MOVE  ER-1894      TO  WS-ERROR
 15491                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15492
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 279
* EL050.cbl
 15493 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15494
 15495     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15496         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15497         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15498            IF PB-COMPANY-ID = 'NCL'
 15499                MOVE  ER-1915      TO  WS-ERROR
 15500                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15501            ELSE
 15502                MOVE  ER-1900      TO  WS-ERROR
 15503                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15504
 15505 3360-CHECK-FORM-AH-TERM-BAMT.
 15506
 15507     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15508         FO-AH-MAX-TERM    GREATER THAN  +0
 15509         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15510             IF  PB-COMPANY-ID = 'NCL'
 15511                 MOVE  ER-1917     TO  WS-ERROR
 15512                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15513             ELSE
 15514                  MOVE  ER-1903    TO  WS-ERROR
 15515                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15516
 15517     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15518         FO-MAX-AH-AMT    GREATER THAN  +0
 15519         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15520             IF  PB-COMPANY-ID = 'NCL'
 15521                 MOVE  ER-1919     TO  WS-ERROR
 15522                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15523             ELSE
 15524                 MOVE  ER-1905     TO  WS-ERROR
 15525                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15526
 15527     GO TO 3999-END-EDIT.
 15528
 15529******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 280
* EL050.cbl
 15531 3400-edit-vin.
 15532
 15533     move spaces                 to hldi-pass-area
 15534     MOVE PB-I-VIN               TO WS-WORK-VIN
 15535     MOVE +8                     TO V2
 15536     MOVE ZEROS                  TO WS-VIN-TOTAL
 15537     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15538      (V1 > 17)
 15539        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15540           MOVE ER-3825          TO WS-ERROR
 15541           PERFORM 9900-ERROR-FORMAT
 15542                                 THRU 9900-EXIT
 15543        ELSE
 15544           IF V1 = 8
 15545              MOVE 10            TO V2
 15546           END-IF
 15547           IF V1 = 9
 15548              MOVE 0             TO V2
 15549           END-IF
 15550           IF V1 = 10
 15551              MOVE 9             TO V2
 15552           END-IF
 15553           IF WS-WORK-VIN (V1:1) NUMERIC
 15554              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15555               + (WS-WORK-VIN-N (V1) * V2)
 15556           ELSE
 15557              MOVE WS-WORK-VIN (V1:1)
 15558                            TO WS-HEX-BYTE
 15559              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15560              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15561               + (WS-NUM (V3) * V2)
 15562           END-IF
 15563           COMPUTE V2 = V2 - 1
 15564        END-IF
 15565     END-PERFORM
 15566     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15567     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15568        REMAINDER WS-VIN-REMAINDER
 15569     IF ((WS-WORK-VIN (9:1) = 'X')
 15570        AND (WS-VIN-REMAINDER = 10))
 15571                OR
 15572        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15573        if pb-company-id = 'VPP'
 15574           perform 3410-check-with-hldi
 15575                                 thru 3410-exit
 15576        end-if
 15577     ELSE
 15578        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15579           MOVE ER-3826          TO WS-ERROR
 15580           PERFORM 9900-ERROR-FORMAT
 15581                                 THRU 9900-EXIT
 15582        ELSE
 15583           MOVE ER-3827          TO WS-ERROR
 15584           PERFORM 9900-ERROR-FORMAT
 15585                                 THRU 9900-EXIT
 15586        END-IF
 15587     END-IF
 15588
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 281
* EL050.cbl
 15589     .
 15590 3400-exit.
 15591     exit.
 15592 3410-check-with-hldi.
 15593     move spaces                 to hldi-pass-area
 15594     move pb-i-vin               to pa-vin
 15595     perform 7785-call-hldi      thru 7785-exit
 15596*    display 'PA-VIN        ' PA-VIN
 15597*    display 'PA-ErrorCode  ' PA-ErrorCode
 15598*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15599*    display 'PA-ModelYear  ' PA-ModelYear
 15600*    display 'PA-MakeName   ' PA-MakeName
 15601*    display 'PA-ModelName  ' PA-ModelName
 15602*    display 'PA-SeriesName ' PA-SeriesName
 15603     if pa-errorcode (1:1) not = '0'
 15604        move spaces              to hldi-pass-area
 15605        move pb-i-vin            to pa-vin
 15606*       move pa-errordesc        to pa-seriesname
 15607*       perform 7786-call-hldim  thru 7786-exit
 15608*       display 'PA-VIN        ' PA-VIN
 15609*       display 'PA-ErrorCode  ' PA-ErrorCode
 15610*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15611*       display 'PA-ModelYear  ' PA-ModelYear
 15612*       display 'PA-MakeName   ' PA-MakeName
 15613*       display 'PA-ModelName  ' PA-ModelName
 15614*       display 'PA-SeriesName ' PA-SeriesName
 15615     end-if
 15616     .
 15617 3410-exit.
 15618     exit.
 15619******************************************************************
 15620*                  E D I T   C A N C E L                         *
 15621******************************************************************
 15622
 15623 3700-EDIT-CANCEL.
 15624     IF PB-COMPANY-ID = 'DMD'
 15625         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15626                                         WS-RES-MUNI-TAX
 15627                                         PB-CI-STATE-TAX
 15628                                         PB-CI-MUNI-TAX
 15629         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15630
 15631*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15632*       IF PB-ENTRY-BATCH  NUMERIC
 15633*          IF PB-CANCELLATION
 15634*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15635*          ELSE
 15636*             IF PB-ISSUE
 15637*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15638
 15639     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15640        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15641     END-IF
 15642*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15643*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15644
 15645     IF CM-ENTRY-STATUS = 'V'
 15646        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 282
* EL050.cbl
 15647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15648        GO TO 3999-END-EDIT.
 15649
 15650     IF CM-ENTRY-STATUS = 'D'
 15651        MOVE ER-2781             TO WS-ERROR
 15652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15653        GO TO 3999-END-EDIT.
 15654
 15655     IF CM-ENTRY-STATUS = 'U'
 15656        MOVE ER-2782             TO WS-ERROR
 15657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15658
 15659***************************************************************
 15660*                                                             *
 15661*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15662*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15663*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15664*   OF ANOTHER COVERAGE.                                      *
 15665*                                                             *
 15666***************************************************************
 15667
 15668     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15669                                    PB-C-AH-CANCEL-VOID-SW.
 15670
 15671     IF PB-C-LF-CANCEL-AMT = ZERO
 15672        NEXT SENTENCE
 15673     ELSE
 15674        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15675           AND
 15676           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15677               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15678               MOVE ER-2745           TO WS-ERROR
 15679               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15680
 15681     IF PB-C-AH-CANCEL-AMT = ZERO
 15682        NEXT SENTENCE
 15683     ELSE
 15684        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15685           AND
 15686           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15687               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15688               MOVE ER-2745           TO WS-ERROR
 15689               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15690
 15691     IF WS-LF-EARNINGS-CALC = '4'
 15692        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15693
 15694     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15695     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15696     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15697     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15698     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15699     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15700
 15701     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15702                                      PB-C-AH-REF-CALC.
 15703     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15704
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 283
* EL050.cbl
 15705******************************************************************
 15706*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15707*             TO VALIDATE COVERAGE.                              *
 15708******************************************************************
 15709
 15710     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15711        PB-C-LF-CANCEL-AMT = ZEROS
 15712          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15713      ELSE
 15714          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15715
 15716     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15717        PB-C-AH-CANCEL-AMT = ZEROS
 15718          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15719      ELSE
 15720          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15721
 15722     EVALUATE TRUE
 15723         WHEN PB-CANCEL-FORCE             OR
 15724              PB-CANCEL-DATE-FORCED       OR
 15725              PB-FORCE-OFF
 15726                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15727                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15728                  END-IF
 15729         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15730               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15731              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15732                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15733         WHEN OTHER
 15734              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15735                 MOVE ER-2794              TO WS-ERROR
 15736              ELSE
 15737                 MOVE ER-2749              TO WS-ERROR
 15738              END-IF
 15739              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15740     END-EVALUATE.
 15741
 15742
 15743*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15744*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15745*            MOVE  ER-1909            TO  WS-ERROR
 15746*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15747*        ELSE
 15748*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15749
 15750     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15751     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15752        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15753     ELSE
 15754        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15755     END-IF
 15756     .
 15757 3705-EDIT-CANCEL-DT.
 15758
 15759     IF LF-COVERAGE-CANCELLED
 15760        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15761         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15762         MOVE WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 284
* EL050.cbl
 15763                                 TO DC-BIN-DATE-2
 15764         SET ELAPSED-BETWEEN-BIN TO TRUE
 15765*        MOVE 1                  TO DC-OPTION-CODE
 15766         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15767         IF DATE-CONVERSION-ERROR
 15768            NEXT SENTENCE
 15769          ELSE
 15770             IF DC-ELAPSED-DAYS GREATER +180
 15771                IF PB-CANCEL-DATE-FORCED  OR
 15772                   PB-CANCEL-DATE-FORCED-NO-FEE
 15773                      MOVE ER-2751  TO WS-ERROR
 15774                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15775                 ELSE
 15776                   MOVE ER-2752  TO WS-ERROR
 15777                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15778
 15779     IF AH-COVERAGE-CANCELLED
 15780        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15781         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15782         MOVE WS-CURRENT-MONTH-END
 15783                                 TO DC-BIN-DATE-2
 15784         SET ELAPSED-BETWEEN-BIN TO TRUE
 15785*        MOVE 1                  TO DC-OPTION-CODE
 15786         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15787         IF DATE-CONVERSION-ERROR
 15788            NEXT SENTENCE
 15789          ELSE
 15790             IF DC-ELAPSED-DAYS GREATER +180
 15791                IF PB-CANCEL-DATE-FORCED OR
 15792                   PB-CANCEL-DATE-FORCED-NO-FEE
 15793                      MOVE ER-2751  TO WS-ERROR
 15794                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15795                 ELSE
 15796                   MOVE ER-2752  TO WS-ERROR
 15797                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15798
 15799     IF WS-ERROR = ER-2752
 15800        AND (PB-COMPANY-ID = 'ABL'
 15801         OR  PB-COMPANY-ID = 'FGL'
 15802         OR  PB-COMPANY-ID = 'IST'
 15803         OR  PB-COMPANY-ID = 'JHL'
 15804         OR  PB-COMPANY-ID = 'LAP'
 15805         OR  PB-COMPANY-ID = 'LBL'
 15806         OR  PB-COMPANY-ID = 'NCB'
 15807         OR  PB-COMPANY-ID = 'NLI'
 15808         OR  PB-COMPANY-ID = 'OFI'
 15809         OR  PB-COMPANY-ID = 'PLI'
 15810         OR  PB-COMPANY-ID = 'TAO'
 15811         OR  PB-COMPANY-ID = 'TIC'
 15812         OR  PB-COMPANY-ID = 'HER'
 15813         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15814         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15815            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15816            MOVE ER-2762     TO WS-ERROR
 15817            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15818
 15819     IF LF-COVERAGE-CANCELLED
 15820        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 285
* EL050.cbl
 15821        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15822             MOVE ER-2733         TO WS-ERROR
 15823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15824
 15825     IF AH-COVERAGE-CANCELLED
 15826        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15827        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15828              MOVE ER-2733        TO WS-ERROR
 15829              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15830
 15831     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15832        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15833        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15834           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15835            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15836              IF PB-COMPANY-ID NOT = 'LAP'
 15837               MOVE ER-2704            TO WS-ERROR
 15838               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15839
 15840     IF CERT-WAS-NOT-FOUND
 15841         GO TO 3999-END-EDIT.
 15842
 15843     IF PB-COMPANY-ID EQUAL 'CDC'
 15844        IF LF-COVERAGE-CANCELLED
 15845           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15846            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15847            MOVE PB-C-LF-CANCEL-DT
 15848                                 TO DC-BIN-DATE-2
 15849            SET ELAPSED-BETWEEN-BIN TO TRUE
 15850*           MOVE 1               TO DC-OPTION-CODE
 15851            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15852            IF DATE-CONVERSION-ERROR
 15853               NEXT SENTENCE
 15854             ELSE
 15855                IF DC-ELAPSED-DAYS GREATER +60
 15856                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15857
 15858     IF PB-COMPANY-ID EQUAL 'CDC'
 15859        IF AH-COVERAGE-CANCELLED
 15860           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15861            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15862            MOVE PB-C-AH-CANCEL-DT
 15863                                 TO DC-BIN-DATE-2
 15864            MOVE +0              TO DC-ELAPSED-DAYS
 15865                                    DC-ELAPSED-MONTHS
 15866            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15867*           MOVE 1               TO DC-OPTION-CODE
 15868            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15869            IF DATE-CONVERSION-ERROR
 15870               NEXT SENTENCE
 15871             ELSE
 15872                IF DC-ELAPSED-DAYS GREATER +60
 15873                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15874
 15875     MOVE +0                     TO DC-ELAPSED-DAYS
 15876                                    DC-ELAPSED-MONTHS.
 15877
 15878     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 286
* EL050.cbl
 15879        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15880          MOVE 'Z'                TO PB-CI-OB-FLAG
 15881          MOVE ER-2767            TO WS-ERROR
 15882          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15883          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15884          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15885          GO TO 3775-OVER-REF-CHK
 15886        ELSE
 15887          MOVE ZEROS              TO PB-CI-LIVES
 15888                                     PB-C-LIVES
 15889          IF PB-CI-OB-FLAG NOT = 'B'
 15890             MOVE SPACE           TO PB-CI-OB-FLAG.
 15891
 15892     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15893         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15894     ELSE
 15895         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15896
 15897     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15898        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15899            MOVE ER-2760         TO WS-ERROR
 15900            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15901
 15902     IF LF-COVERAGE-CANCELLED
 15903        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15904         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15905            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15906               MOVE ER-2774       TO WS-ERROR
 15907               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15908
 15909     IF AH-COVERAGE-CANCELLED
 15910        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15911         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15912            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15913               MOVE ER-2775       TO WS-ERROR
 15914               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15915
 15916     IF LF-COVERAGE-CANCELLED
 15917        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15918         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15919            MOVE ER-2776         TO WS-ERROR
 15920            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15921
 15922     IF AH-COVERAGE-CANCELLED
 15923        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15924         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15925            MOVE ER-2777         TO WS-ERROR
 15926            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15927
 15928     IF LF-COVERAGE-CANCELLED
 15929        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15930        if pb-ci-lf-expire-dt = low-values or spaces
 15931           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15932           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15933           MOVE PB-CI-EXTENTION-DAYS
 15934                                 TO DC-ELAPSED-DAYS
 15935           SET BIN-PLUS-ELAPSED  TO TRUE
 15936           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 287
* EL050.cbl
 15937                                 THRU 8500-EXIT
 15938           IF DATE-CONVERSION-ERROR
 15939              move low-values    to dc-bin-date-2
 15940           end-if
 15941        else
 15942           move pb-ci-lf-expire-dt
 15943                                 to dc-bin-date-2
 15944        end-if
 15945        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15946           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15947                             OR  'FIA'
 15948              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15949           ELSE
 15950              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15951              MOVE ER-2731       TO WS-ERROR
 15952              PERFORM 9900-ERROR-FORMAT
 15953                                 THRU 9900-EXIT
 15954           end-if
 15955        end-if
 15956     end-if
 15957*    IF LF-COVERAGE-CANCELLED
 15958*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15959*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15960*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15961*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15962*        SET BIN-PLUS-ELAPSED      TO TRUE
 15963*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15964*        IF DATE-CONVERSION-ERROR
 15965*           NEXT SENTENCE
 15966*         ELSE
 15967*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15968*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15969*                            OR  'FIA'
 15970*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15971*              ELSE
 15972*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15973*               MOVE ER-2731       TO WS-ERROR
 15974*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15975     .
 15976 3705-EDIT-AH-CANCEL-DT.
 15977     IF AH-COVERAGE-CANCELLED
 15978        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15979        if pb-ci-AH-expire-dt = low-values or spaces
 15980           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15981           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15982           MOVE PB-CI-EXTENTION-DAYS
 15983                                 TO DC-ELAPSED-DAYS
 15984           SET BIN-PLUS-ELAPSED  TO TRUE
 15985           PERFORM 8500-DATE-CONVERT
 15986                                 THRU 8500-EXIT
 15987           IF DATE-CONVERSION-ERROR
 15988              move low-values    to dc-bin-date-2
 15989           end-if
 15990        else
 15991           move pb-ci-ah-expire-dt
 15992                                 to dc-bin-date-2
 15993        end-if
 15994        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 288
* EL050.cbl
 15995           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15996                             OR  'FIA'
 15997              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15998           ELSE
 15999              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16000              MOVE ER-2771       TO WS-ERROR
 16001              PERFORM 9900-ERROR-FORMAT
 16002                                 THRU 9900-EXIT
 16003           end-if
 16004        end-if
 16005     end-if
 16006*    IF AH-COVERAGE-CANCELLED
 16007*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16008*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16009*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16010*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16011**       MOVE 6                    TO DC-OPTION-CODE
 16012*        SET BIN-PLUS-ELAPSED      TO TRUE
 16013*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16014*        IF DATE-CONVERSION-ERROR
 16015*           NEXT SENTENCE
 16016*         ELSE
 16017*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16018*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16019*                             OR 'FIA'
 16020*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16021*             ELSE
 16022*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16023*              MOVE ER-2771       TO WS-ERROR
 16024*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16025     .
 16026 3705-EDIT-CONTINUED.
 16027
 16028*    IF LF-COVERAGE-CANCELLED
 16029*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16030*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16031*            MOVE ER-2727         TO WS-ERROR
 16032*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16033*
 16034*    IF AH-COVERAGE-CANCELLED
 16035*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16036*        IF PB-COMPANY-ID = 'ACE'
 16037*           MOVE ER-2727        TO WS-ERROR
 16038*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16039*        ELSE
 16040*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16041*              MOVE ER-2727     TO WS-ERROR
 16042*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16043
 16044     IF PB-COMPANY-ID = 'ACE'
 16045       IF AH-COVERAGE-CANCELLED
 16046         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16047           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16048              MOVE ER-2732      TO WS-ERROR
 16049              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16050
 16051     IF PB-COMPANY-ID      EQUAL   'HER'
 16052        IF WS-ERROR        EQUAL   ER-2727
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 289
* EL050.cbl
 16053            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16054            MOVE  ER-2725          TO  WS-ERROR
 16055            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16056
 16057     IF PB-C-CLAIM-CREATED-CANCEL
 16058            MOVE ER-2748         TO WS-ERROR
 16059            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16060
 16061     IF PB-C-LAST-NAME NOT = SPACES
 16062         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16063            MOVE ER-2747         TO WS-ERROR
 16064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16065
 16066 3710-EDIT-LUMP-SUM-PRIOR.
 16067
 16068     IF AH-COVERAGE-CANCELLED
 16069         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16070             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16071                MOVE ER-2735    TO WS-ERROR
 16072                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16073
 16074     IF LF-COVERAGE-CANCELLED
 16075         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16076             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16077                MOVE ER-2735    TO WS-ERROR
 16078                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16079
 16080 3710-EDIT-PRIOR-DEATH.
 16081
 16082*    IF LF-COVERAGE-CANCELLED
 16083*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16084*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16085*           (NOT PB-CI-OB)
 16086*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16087*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16088*                   MOVE ER-2732  TO WS-ERROR
 16089*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16090*
 16091*    IF AH-COVERAGE-CANCELLED
 16092*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16093*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16094*           (NOT PB-CI-OB)
 16095*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16096*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16097*                   MOVE ER-2732  TO WS-ERROR
 16098*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16099
 16100     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16101         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16102            (NOT PB-COMP-LF-CANCEL)
 16103             NEXT SENTENCE
 16104         ELSE
 16105           IF PB-C-LF-CANCEL-VOIDED
 16106              NEXT SENTENCE
 16107           ELSE
 16108              MOVE ER-2753      TO WS-ERROR
 16109              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16110
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 290
* EL050.cbl
 16111     IF CANCEL-FUTURE-DT
 16112         GO TO 3999-END-EDIT.
 16113
 16114 3715-GET-REMAIN-TERM-LF.
 16115
 16116     IF NO-LF-BENEFIT-MATCH  OR
 16117        WS-LF-BENEFIT-CD = ZEROS
 16118        GO TO 3730-GET-AH-REMAIN-TERM.
 16119
 16120     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16121     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16122     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16123     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16124     MOVE PB-SV-STATE            TO CP-STATE.
 16125     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16126     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16127     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16128     MOVE '2'                    TO CP-PROCESS-TYPE.
 16129     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16130     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16131     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16132     IF (PB-COMPANY-ID = 'CID')
 16133        AND (CP-STATE-STD-ABBRV = 'WI')
 16134        MOVE '7'                 TO CP-REM-TERM-METHOD
 16135        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16136     ELSE
 16137        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16138        MOVE WS-REM-TRM-CALC-OPTION
 16139                                 TO CP-REM-TRM-CALC-OPTION
 16140     END-IF
 16141**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16142     IF (PB-COMPANY-ID = 'CID')
 16143        AND (CP-STATE-STD-ABBRV = 'MO')
 16144        AND (PB-CERT-EFF-DT >= X'9B41')
 16145        AND (PB-CERT-EFF-DT <= X'A2FB')
 16146        MOVE '7'                 TO CP-REM-TERM-METHOD
 16147        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16148     END-IF
 16149     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16150                                    CP-LOAN-TERM.
 16151     IF CP-TRUNCATED-LIFE
 16152        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16153
 16154     IF CP-TERM-IS-DAYS
 16155         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16156     ELSE
 16157         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16158
 16159     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16160
 16161     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16162
 16163     IF LF-COVERAGE-CANCELLED
 16164        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16165        NEXT SENTENCE
 16166      ELSE
 16167          GO TO 3730-GET-AH-REMAIN-TERM.
 16168
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 291
* EL050.cbl
 16169 3720-GET-LF-REFUND.
 16170
 16171     IF PB-C-LF-CANCEL-VOIDED
 16172        GO TO 3730-GET-AH-REMAIN-TERM
 16173     end-if
 16174
 16175     IF PB-COMPANY-ID EQUAL 'BOA'
 16176         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16177         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16178         GO TO 3730-GET-AH-REMAIN-TERM.
 16179
 16180     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16181        (WS-AH-SPECIAL-CALC-CD = 'M')
 16182         MOVE ER-2767            TO WS-ERROR
 16183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16184         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16185         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16186         GO TO 3780-UPDATE-CANCEL-CERT.
 16187
 16188*    if (ws-lf-earnings-calc = '6')
 16189*       or (pb-c-lf-refund-override = '6')
 16190*       move cp-remaining-term-1 to cp-remaining-term-2
 16191*    end-if
 16192     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16193
 16194     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16195     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16196     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16197     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16198     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16199     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16200     IF PB-COMPANY-ID = 'DCC'
 16201        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16202        IF PDEF-MASTER-FOUND
 16203           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16204              (V1 > +8)
 16205              OR (PD-PROD-CODE (V1) = 'L')
 16206           END-PERFORM
 16207           IF V1 < +9
 16208              MOVE PD-MAX-AMT (V1)
 16209                           TO CP-R-MAX-TOT-BEN
 16210                              EC-AM-LF-MAX-TOT-BEN
 16211           END-IF
 16212        ELSE
 16213        MOVE ' '                 TO PDEF-MASTER-SW
 16214        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16215        MOVE PB-STATE            TO ERPDEF-STATE
 16216        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16217           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16218        END-IF
 16219        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16220        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16221        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16222        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16223        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16224        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16225        IF PDEF-MASTER-FOUND
 16226           MOVE 'N'              TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 292
* EL050.cbl
 16227           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16228           IF PDEF-MASTER-FOUND
 16229              IF (ERPDEF-KEY-SAVE (1:16) =
 16230                           PD-CONTROL-PRIMARY (1:16))
 16231                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16232                 CONTINUE
 16233              ELSE
 16234                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16235                 IF (ERPDEF-KEY-SAVE (1:16) =
 16236                           PD-CONTROL-PRIMARY (1:16))
 16237                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16238                    CONTINUE
 16239                 ELSE
 16240                    MOVE 'N'     TO PDEF-MASTER-SW
 16241                 END-IF
 16242              END-IF
 16243
 16244              IF PDEF-MASTER-FOUND
 16245                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16246                    (V1 > +8)
 16247                    OR (PD-PROD-CODE (V1) = 'L')
 16248                 END-PERFORM
 16249                 IF V1 < +9
 16250                    MOVE PD-MAX-AMT (V1)
 16251                                 TO CP-R-MAX-TOT-BEN
 16252                                    EC-AM-LF-MAX-TOT-BEN
 16253                 END-IF
 16254              END-IF
 16255           END-IF
 16256           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16257        END-IF
 16258        END-IF
 16259     END-IF
 16260     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16261
 16262     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16263
 16264     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16265                                    PB-C-LF-REM-TERM.
 16266
 16267     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16268     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16269
 16270     IF PB-COMPANY-ID EQUAL 'FLC'
 16271        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16272           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16273           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16274                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16275                    - CM-LF-ITD-DEATH-AMT
 16276           IF PB-C-LF-REF-CALC LESS THAN +0
 16277              MOVE +0            TO PB-C-LF-REF-CALC
 16278              GO TO 3730-GET-AH-REMAIN-TERM
 16279           ELSE
 16280              GO TO 3730-GET-AH-REMAIN-TERM.
 16281
 16282     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16283                            OR '4' OR '5' OR '6' OR '8'
 16284                            OR '9' OR 'G'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 293
* EL050.cbl
 16285        MOVE PB-C-LF-REFUND-OVERRIDE
 16286                                 TO CP-EARNING-METHOD.
 16287
 16288     if pb-company-id = 'AHL'
 16289        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16290        if cp-class-code = spaces
 16291           move zeros            to cp-class-code
 16292        end-if
 16293     ELSE
 16294        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16295     END-IF
 16296*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16297     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16298     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16299                                    CP-RATING-BENEFIT-AMT.
 16300     IF CP-STATE-STD-ABBRV = 'OR'
 16301         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16302                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16303     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16304     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16305     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16306     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16307     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16308     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16309     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16310     IF WS-DEFAULT-APR NOT NUMERIC
 16311         MOVE ZEROS TO WS-DEFAULT-APR.
 16312****   N O T E   ****
 16313*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16314*      THE OH HARD CODING IN ELCRFNDP
 16315
 16316     IF PB-COMPANY-ID = 'CID'
 16317        IF CP-STATE-STD-ABBRV = 'OH'
 16318           MOVE WS-LF-EARNINGS-CALC
 16319                                 TO CP-EARNING-METHOD
 16320        END-IF
 16321     END-IF
 16322
 16323****   N O T E   ****
 16324
 16325     IF CP-EARN-AS-NET-PAY
 16326         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16327            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16328                MOVE WS-DEFAULT-APR
 16329                                 TO  CP-LOAN-APR
 16330                MOVE ER-3780     TO  WS-ERROR
 16331                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16332            ELSE
 16333                MOVE ER-3781     TO  WS-ERROR
 16334                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16335*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16336     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16337
 16338     IF CP-REFUND-TYPE-USED NOT = SPACE
 16339         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16340
 16341     IF CP-ERROR-RATE-IS-ZERO OR
 16342        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 294
* EL050.cbl
 16343        MOVE ER-2740             TO WS-ERROR
 16344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16345
 16346     IF CP-ERROR-RATE-FILE-NOTOPEN
 16347        MOVE ER-2617             TO WS-ERROR
 16348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16349
 16350     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16351        AND PB-CI-ENTRY-STATUS = 'M'
 16352        MOVE +0                  TO PB-C-LF-REF-CALC
 16353     ELSE
 16354        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16355     END-IF
 16356
 16357     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16358         GO TO 3730-GET-AH-REMAIN-TERM.
 16359
 16360*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16361*       ADD +1                   TO PB-C-LF-REM-TERM
 16362*                                   CP-REMAINING-TERM
 16363*                                   CP-ORIGINAL-TERM.
 16364
 16365     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16366     MOVE '2'                    TO CP-EARNING-METHOD
 16367                                    CP-RATING-METHOD.
 16368     IF PB-COMPANY-ID = 'CID'
 16369        IF (CP-STATE-STD-ABBRV = 'MN')
 16370           AND (PB-CERT-EFF-DT > X'A4FF')
 16371           AND (WS-LF-EARNINGS-CALC = 'B')
 16372           MOVE '5'              TO CP-EARNING-METHOD
 16373           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16374        END-IF
 16375     END-IF
 16376     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16377                                        CP-REMAINING-BENEFIT
 16378                                        CP-RATING-BENEFIT-AMT.
 16379     IF CP-STATE-STD-ABBRV = 'OR'
 16380         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16381                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16382     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16383     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16384
 16385     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16386
 16387     IF CP-ERROR-RATE-IS-ZERO OR
 16388        CP-ERROR-RATE-NOT-FOUND
 16389        MOVE ER-2740             TO WS-ERROR
 16390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16391
 16392     IF CP-ERROR-RATE-FILE-NOTOPEN
 16393        MOVE ER-2617             TO WS-ERROR
 16394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16395
 16396     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16397
 16398******************************************************************
 16399
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 295
* EL050.cbl
 16401 3730-GET-AH-REMAIN-TERM.
 16402     IF NO-AH-BENEFIT-MATCH  OR
 16403        WS-AH-BENEFIT-CD = ZEROS
 16404         GO TO 3770-CHECK-REFUNDS.
 16405
 16406     IF PB-CI-AH-LUMP-SUM-DISAB
 16407         IF  PB-C-AH-CANCEL-AMT = ZERO
 16408            IF NOT PB-COMP-AH-CANCEL
 16409             GO TO 3770-CHECK-REFUNDS.
 16410
 16411     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16412     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16413     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16414     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16415     MOVE PB-SV-STATE            TO CP-STATE.
 16416     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16417     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16418     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16419     MOVE '2'                    TO CP-PROCESS-TYPE.
 16420     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16421     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16422     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16423     IF (PB-COMPANY-ID = 'CID')
 16424        AND (CP-STATE-STD-ABBRV = 'WI')
 16425        MOVE '7'                 TO CP-REM-TERM-METHOD
 16426        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16427     ELSE
 16428        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16429        MOVE WS-REM-TRM-CALC-OPTION
 16430                                 TO CP-REM-TRM-CALC-OPTION
 16431     END-IF
 16432     IF (PB-COMPANY-ID = 'CID')
 16433        AND (CP-STATE-STD-ABBRV = 'MO')
 16434        AND (PB-CERT-EFF-DT >= X'9B41')
 16435        AND (PB-CERT-EFF-DT <= X'A2FB')
 16436        MOVE '7'                 TO CP-REM-TERM-METHOD
 16437        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16438     END-IF
 16439     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16440                                    CP-LOAN-TERM.
 16441     IF NOT CP-TERM-IS-DAYS
 16442         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16443
 16444     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16445
 16446     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16447
 16448     IF AH-COVERAGE-CANCELLED
 16449        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16450        NEXT SENTENCE
 16451      ELSE
 16452         GO TO 3770-CHECK-REFUNDS.
 16453
 16454 3740-GET-AH-REFUND.
 16455
 16456     IF PB-C-AH-CANCEL-VOIDED
 16457        GO TO 3780-UPDATE-CANCEL-CERT
 16458     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 296
* EL050.cbl
 16459
 16460     IF PB-COMPANY-ID = 'BOA'
 16461         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16462         GO TO 3770-CHECK-REFUNDS.
 16463
 16464     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16465*    MOVE ' '                    TO DC-OPTION-CODE
 16466     SET BIN-TO-GREG             TO TRUE
 16467     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16468     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16469                                    PB-C-AH-REM-TERM.
 16470     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16471     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16472
 16473     IF PB-COMPANY-ID EQUAL 'FLC'
 16474        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16475           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16476           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16477                    - CM-AH-ITD-AH-PMT)
 16478           IF PB-C-AH-REF-CALC LESS THAN +0
 16479              MOVE +0            TO PB-C-AH-REF-CALC
 16480              GO TO 3770-CHECK-REFUNDS
 16481           ELSE
 16482              GO TO 3770-CHECK-REFUNDS.
 16483
 16484     IF PB-COMPANY-ID = 'DCC'
 16485        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16486            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16487           MOVE 'S'              TO CP-EARNING-METHOD
 16488        END-IF
 16489     END-IF
 16490     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16491                            OR '4' OR '5' OR '6' OR '8'
 16492                            OR '9' OR 'G' OR 'S'
 16493        MOVE PB-C-AH-REFUND-OVERRIDE
 16494                                 TO CP-EARNING-METHOD.
 16495
 16496     if pb-company-id = 'AHL'
 16497        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16498        if cp-class-code = spaces
 16499           move zeros            to cp-class-code
 16500        end-if
 16501     ELSE
 16502        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16503     END-IF
 16504*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16505     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16506     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16507                                    CP-RATING-BENEFIT-AMT.
 16508     IF CP-STATE-STD-ABBRV = 'OR'
 16509         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16510                                         PB-CI-AH-TERM.
 16511     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16512     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16513     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16514     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16515     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16516     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 297
* EL050.cbl
 16517
 16518     IF CP-STATE-STD-ABBRV = 'OH'
 16519        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16520                                AND 'CID' AND 'DCC' and 'VPP'
 16521                                AND 'AHL')
 16522           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16523              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16524              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16525              MOVE '6' TO CP-EARNING-METHOD
 16526           END-IF
 16527        END-IF
 16528        IF PB-COMPANY-ID = 'CID'
 16529           IF NO-LIFE-COVERAGE
 16530              IF CP-CRITICAL-PERIOD
 16531                 MOVE '2'       TO CP-EARNING-METHOD
 16532              ELSE
 16533                 MOVE '6'       TO CP-EARNING-METHOD
 16534              END-IF
 16535           ELSE
 16536              IF WS-LF-COVERAGE-TYPE = 'L'
 16537                 MOVE '2'       TO CP-EARNING-METHOD
 16538              ELSE
 16539                 IF (PB-CI-LF-TERM > +60) OR
 16540                    (WS-LF-EARNINGS-CALC = '5')
 16541                    IF CP-CRITICAL-PERIOD
 16542                       MOVE '2'  TO CP-EARNING-METHOD
 16543                    ELSE
 16544                       MOVE '6'  TO CP-EARNING-METHOD
 16545                    END-IF
 16546                 ELSE
 16547                    MOVE '1'     TO CP-EARNING-METHOD
 16548                 END-IF
 16549              END-IF
 16550           END-IF
 16551        END-IF
 16552     END-IF
 16553
 16554*    IF CP-STATE-STD-ABBRV = 'VA'
 16555*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16556*          IF CP-ORIGINAL-TERM GREATER 61
 16557*             MOVE '6' TO CP-EARNING-METHOD
 16558*          ELSE
 16559*             MOVE '1' TO CP-EARNING-METHOD.
 16560
 16561     IF WS-DEFAULT-APR NOT NUMERIC
 16562         MOVE ZEROS TO WS-DEFAULT-APR.
 16563     IF CP-EARN-AS-NET-PAY
 16564         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16565            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16566                MOVE WS-DEFAULT-APR
 16567                                 TO  CP-LOAN-APR
 16568                MOVE ER-3780     TO  WS-ERROR
 16569                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16570            ELSE
 16571                MOVE ER-3781     TO  WS-ERROR
 16572                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16573     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16574     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 298
* EL050.cbl
 16575        AND CP-CANCEL-REASON = 'R'
 16576        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16577        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16578     END-IF
 16579     IF PB-COMPANY-ID = 'DCC'
 16580        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16581        AND (CP-EARNING-METHOD = 'D')
 16582        AND (CP-CANCEL-REASON NOT = 'R')
 16583        CONTINUE
 16584     ELSE
 16585        GO TO 3750-CONTINUE
 16586     END-IF
 16587     MOVE ' '                    TO DD-IU-SW
 16588     IF NOT PDEF-MASTER-FOUND
 16589        MOVE ' '                 TO PDEF-MASTER-SW
 16590        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16591        MOVE PB-STATE            TO ERPDEF-STATE
 16592        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16593           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16594        END-IF
 16595        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16596        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16597        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16598        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16599        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16600        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16601        IF PDEF-MASTER-FOUND
 16602           MOVE 'N'              TO PDEF-MASTER-SW
 16603           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16604           IF PDEF-MASTER-FOUND
 16605              IF (ERPDEF-KEY-SAVE (1:16) =
 16606                           PD-CONTROL-PRIMARY (1:16))
 16607                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16608                 CONTINUE
 16609              ELSE
 16610                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16611                 IF (ERPDEF-KEY-SAVE (1:16) =
 16612                           PD-CONTROL-PRIMARY (1:16))
 16613                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16614                    CONTINUE
 16615                 ELSE
 16616                    MOVE ER-2740 TO WS-ERROR
 16617                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16618                    GO TO 3770-CHECK-REFUNDS
 16619                 END-IF
 16620              END-IF
 16621           END-IF
 16622           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16623        END-IF
 16624     END-IF
 16625     IF PDEF-MASTER-FOUND
 16626        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16627           (V1 > +8)
 16628           OR (PD-PROD-CODE (V1) = 'I')
 16629        END-PERFORM
 16630        IF V1 < +9
 16631           SET DD-IU-PRESENT        TO TRUE
 16632        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 299
* EL050.cbl
 16633        IF WS-AH-DCC-TRUNC = 'T'
 16634           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16635        ELSE
 16636           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16637        END-IF
 16638        EVALUATE TRUE
 16639           WHEN WS-TERM > +168
 16640              MOVE 15               TO V1
 16641           WHEN WS-TERM > +156
 16642              MOVE 14               TO V1
 16643           WHEN WS-TERM > +144
 16644              MOVE 13               TO V1
 16645           WHEN WS-TERM > +132
 16646              MOVE 12               TO V1
 16647           WHEN WS-TERM > +120
 16648              MOVE 11               TO V1
 16649           WHEN WS-TERM > +108
 16650              MOVE 10               TO V1
 16651           WHEN WS-TERM > +96
 16652              MOVE 9                TO V1
 16653           WHEN WS-TERM > +84
 16654              MOVE 8                TO V1
 16655           WHEN WS-TERM > +72
 16656              MOVE 7                TO V1
 16657           WHEN WS-TERM > +60
 16658              MOVE 6                TO V1
 16659           WHEN WS-TERM > +48
 16660              MOVE 5                TO V1
 16661           WHEN WS-TERM > +36
 16662              MOVE 4                TO V1
 16663           WHEN WS-TERM > +24
 16664              MOVE 3                TO V1
 16665           WHEN WS-TERM > +12
 16666              MOVE 2                TO V1
 16667           WHEN OTHER
 16668              MOVE 1                TO V1
 16669        END-EVALUATE
 16670
 16671        EVALUATE TRUE
 16672*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16673*             < +13)
 16674*             AND (DD-IU-PRESENT)
 16675*             MOVE 2                TO V2
 16676*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16677*             MOVE 1                TO V2
 16678           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16679              MOVE 2                TO V2
 16680           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16681              MOVE 3                TO V2
 16682           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16683              MOVE 4                TO V2
 16684           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16685              MOVE 5                TO V2
 16686           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16687              MOVE 6                TO V2
 16688           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16689              MOVE 7                TO V2
 16690           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 300
* EL050.cbl
 16691              MOVE 8                TO V2
 16692           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16693              MOVE 9                TO V2
 16694           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16695              MOVE 10               TO V2
 16696           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16697              MOVE 11               TO V2
 16698           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16699              MOVE 12               TO V2
 16700           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16701              MOVE 13               TO V2
 16702           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16703              MOVE 14               TO V2
 16704           WHEN OTHER
 16705              MOVE 15               TO V2
 16706        END-EVALUATE
 16707
 16708        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16709                                 TO CP-DDF-LO-FACT
 16710        MOVE PD-UEP-FACTOR (V1 V2)
 16711                                 TO CP-DDF-HI-FACT
 16712
 16713        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16714        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16715        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16716           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16717        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16718        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16719        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16720           + PD-1ST-YR-ADMIN-ALLOW
 16721
 16722        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16723*       IF PI-CLP-YN = 'Y'
 16724*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16725*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16726*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16727*       END-IF
 16728
 16729        IF DD-IU-PRESENT
 16730           MOVE 'I'              TO CP-EARNING-METHOD
 16731        END-IF
 16732        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16733                                     CP-CLP-RATE-UP
 16734        IF CP-IU-RATE-UP NOT = ZEROS
 16735           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16736              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16737           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16738              / (1 - WS-WORK-FACT)
 16739        END-IF
 16740     END-IF
 16741     .
 16742 3750-CONTINUE.
 16743     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16744
 16745     IF CP-REFUND-TYPE-USED NOT = SPACE
 16746         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16747
 16748     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 301
* EL050.cbl
 16749        CP-ERROR-RATE-NOT-FOUND
 16750        MOVE ER-2740             TO WS-ERROR
 16751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16752
 16753     IF CP-ERROR-RATE-FILE-NOTOPEN
 16754        MOVE ER-2617             TO WS-ERROR
 16755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16756     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16757        AND (PB-CI-ENTRY-STATUS = 'M')
 16758        MOVE +0                  TO PB-C-AH-REF-CALC
 16759     ELSE
 16760        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16761     END-IF
 16762     if pb-company-id = 'VPP'
 16763        MOVE cm-ah-clp           to cp-original-premium
 16764        move zeros               to cp-calc-refund
 16765        perform 7600-get-refund  thru 7600-exit
 16766        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16767           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16768        else
 16769           move zeros            to pb-c-ah-rfnd-clp
 16770        end-if
 16771        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16772           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16773           pb-ci-cancel-fee
 16774     end-if
 16775     IF PB-COMPANY-ID = 'DCC'
 16776        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16777        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16778        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16779        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16780        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16781        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16782        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16783        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16784*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16785     END-IF
 16786     .
 16787 3770-CHECK-REFUNDS.
 16788
 16789     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16790        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16791           MOVE ER-2766          TO WS-ERROR
 16792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16793           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16794           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16795              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16796
 16797     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16798        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16799           MOVE ER-2766          TO WS-ERROR
 16800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16802           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16803              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16804
 16805     IF PB-COMP-LF-CANCEL
 16806        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 302
* EL050.cbl
 16807        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16808           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16809              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16810
 16811     IF PB-COMP-AH-CANCEL
 16812        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16813        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16814           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16815              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16816
 16817     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16818             GIVING WS-UNSIGN-WRK1
 16819     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16820             GIVING WS-UNSIGN-WRK2.
 16821
 16822     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16823         MOVE ZERO TO WS-UNSIGN-WRK1.
 16824
 16825     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16826         MOVE ZERO TO WS-UNSIGN-WRK2.
 16827
 16828     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16829
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 303
* EL050.cbl
 16831
 16832 3772-CONTINUE.
 16833
 16834**********************************
 16835*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16836*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16837*** DOUBLES THE TOLERANCE AMOUNT.
 16838***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16839**********************************
 16840     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16841     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16842         IF WS-REF-REJECT-SW = SPACE
 16843             MOVE ER-2754        TO WS-ERROR
 16844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16845           ELSE
 16846             MOVE ER-2736        TO WS-ERROR
 16847             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16848**********************************
 16849
 16850 3773-CONTINUE.
 16851
 16852     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16853        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16854           MOVE ER-2723          TO WS-ERROR
 16855           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16856
 16857     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16858        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16859           MOVE ER-2724          TO WS-ERROR
 16860           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16861
 16862     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16863         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16864             (1 + WS-LF-REFUND-OVS-PCT)
 16865     ELSE
 16866         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16867
 16868     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16869         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16870             (1 - WS-TOL-LF-REFUND-PCT)
 16871     ELSE
 16872         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16873
 16874     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16875        AND (PB-CI-ENTRY-STATUS = 'M')
 16876        AND (PB-C-LF-CANCEL-AMT > +0)
 16877        MOVE ER-3843             TO WS-ERROR
 16878        PERFORM 9900-ERROR-FORMAT
 16879                                 THRU 9900-EXIT
 16880     END-IF
 16881     EVALUATE TRUE
 16882        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16883           CONTINUE
 16884        WHEN PB-C-LF-CANCEL-AMT = +0
 16885                 AND PB-C-LF-REF-CALC > +0
 16886           CONTINUE
 16887        WHEN WS-LF-REFUND-OVS-AMT = 0
 16888                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 304
* EL050.cbl
 16889           CONTINUE
 16890        WHEN OTHER
 16891           IF WS-TOL-LF-REFUND  = +0
 16892              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16893           END-IF
 16894           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16895                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16896                          (PB-C-LF-CANCEL-AMT))
 16897              CONTINUE
 16898           ELSE
 16899              IF WS-LF-REFUND-OVS-AMT = +0
 16900                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16901              END-IF
 16902              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16903                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16904                                       PB-C-LF-CANCEL-AMT)
 16905                 CONTINUE
 16906              ELSE
 16907                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16908                   MOVE ER-2754   TO  WS-ERROR
 16909                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16910                 ELSE
 16911                    MOVE ER-2736   TO  WS-ERROR
 16912                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16913                 END-IF
 16914              END-IF
 16915           END-IF
 16916     END-EVALUATE.
 16917
 16918     EVALUATE TRUE
 16919        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16920           CONTINUE
 16921        WHEN PB-C-LF-CANCEL-AMT = +0
 16922                 AND PB-C-LF-REF-CALC > +0
 16923           CONTINUE
 16924        WHEN OTHER
 16925           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16926               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16927              CONTINUE
 16928           ELSE
 16929              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16930               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16931                CONTINUE
 16932              ELSE
 16933                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16934                     MOVE ER-2754   TO  WS-ERROR
 16935                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16936                 ELSE
 16937                     MOVE ER-2736   TO  WS-ERROR
 16938                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16939                 END-IF
 16940              END-IF
 16941           END-IF
 16942     END-EVALUATE.
 16943
 16944     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16945         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16946             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 305
* EL050.cbl
 16947     ELSE
 16948         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16949
 16950     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16951         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16952             (1 - WS-TOL-AH-REFUND-PCT)
 16953     ELSE
 16954         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16955
 16956     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16957        AND (PB-CI-ENTRY-STATUS = 'M')
 16958        AND (PB-C-AH-CANCEL-AMT > +0)
 16959        MOVE ER-3843             TO WS-ERROR
 16960        PERFORM 9900-ERROR-FORMAT
 16961                                 THRU 9900-EXIT
 16962     END-IF
 16963     EVALUATE TRUE
 16964        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16965           CONTINUE
 16966*       WHEN PB-C-AH-REF-CALC = +0 AND
 16967*                  PB-C-AH-CANCEL-AMT > +0
 16968        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16969                   PB-C-AH-REF-CALC > +0
 16970           CONTINUE
 16971        WHEN WS-AH-REFUND-OVS-AMT = +0
 16972                AND WS-TOL-AH-REFUND = +0
 16973           CONTINUE
 16974        WHEN OTHER
 16975           IF WS-TOL-AH-REFUND = +0
 16976              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16977           END-IF
 16978           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16979               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16980                                         PB-C-AH-CANCEL-AMT)
 16981              CONTINUE
 16982           ELSE
 16983              IF WS-AH-REFUND-OVS-AMT = +0
 16984                 MOVE +9999999.99 TO
 16985                         WS-AH-REFUND-OVS-AMT
 16986              END-IF
 16987              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16988                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16989                                         PB-C-AH-CANCEL-AMT)
 16990                 CONTINUE
 16991              ELSE
 16992                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16993                    MOVE ER-2754   TO  WS-ERROR
 16994                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16995                 ELSE
 16996                    MOVE ER-2736   TO  WS-ERROR
 16997                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16998                 END-IF
 16999              END-IF
 17000           END-IF
 17001     END-EVALUATE.
 17002
 17003     EVALUATE TRUE
 17004        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 306
* EL050.cbl
 17005           CONTINUE
 17006*       WHEN PB-C-AH-REF-CALC > +0 AND
 17007*                  PB-C-AH-CANCEL-AMT = +0
 17008        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17009                   PB-C-AH-REF-CALC = +0
 17010           CONTINUE
 17011        WHEN OTHER
 17012           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17013               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17014              CONTINUE
 17015           ELSE
 17016              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17017                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17018                 CONTINUE
 17019              ELSE
 17020                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17021                     MOVE ER-2754   TO  WS-ERROR
 17022                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17023                 ELSE
 17024                     MOVE ER-2736   TO  WS-ERROR
 17025                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17026                 END-IF
 17027              END-IF
 17028           END-IF
 17029     END-EVALUATE.
 17030
 17031     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17032        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17033        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17034           AND  PB-C-LF-REF-CALC < +1.00
 17035           AND  PB-C-AH-REF-CALC < +1.00
 17036           CONTINUE
 17037        ELSE
 17038           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17039              AND (PB-CI-ENTRY-STATUS = 'M')
 17040              CONTINUE
 17041           ELSE
 17042              MOVE ER-2741       TO WS-ERROR
 17043              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17044           END-IF
 17045        END-IF
 17046     END-IF
 17047
 17048     IF (PB-C-LF-CANCEL-AMT = ZERO
 17049        AND WS-LF-BENEFIT-CD NOT = ZERO
 17050        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17051        AND PB-C-LF-REF-CALC NOT = ZERO)
 17052        OR
 17053        (PB-C-LF-CANCEL-AMT = ZERO
 17054        AND WS-LF-BENEFIT-CD NOT = ZERO
 17055        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17056             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17057                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17058                NEXT SENTENCE
 17059             ELSE
 17060                MOVE ER-2739        TO WS-ERROR
 17061                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17062
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 307
* EL050.cbl
 17063     IF (PB-C-AH-CANCEL-AMT = ZERO
 17064        AND WS-AH-BENEFIT-CD NOT = ZERO
 17065        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17066        AND PB-C-AH-REF-CALC NOT = ZERO)
 17067        OR
 17068        (PB-C-AH-CANCEL-AMT = ZERO
 17069        AND WS-AH-BENEFIT-CD NOT = ZERO
 17070        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17071             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17072                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17073                NEXT SENTENCE
 17074             ELSE
 17075                MOVE ER-2738        TO WS-ERROR
 17076                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17077
 17078 3775-OVER-REF-CHK.
 17079
 17080     IF PB-CI-ENTRY-STATUS = '5'
 17081        GO TO 3780-UPDATE-CANCEL-CERT.
 17082
 17083     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17084                              PB-CI-LF-ALT-PREMIUM-AMT.
 17085
 17086     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17087        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17088                                 PB-C-LF-REF-CALC
 17089      ELSE
 17090        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17091                                 PB-C-LF-CANCEL-AMT.
 17092
 17093     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17094        MOVE ER-2755             TO WS-ERROR
 17095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17096
 17097     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17098
 17099     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17100        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17101                                 PB-C-AH-REF-CALC
 17102      ELSE
 17103        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17104                                 PB-C-AH-CANCEL-AMT.
 17105
 17106     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17107        MOVE ER-2778             TO WS-ERROR
 17108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17109
 17110     IF PB-CI-OB-FLAG NOT = 'Z'
 17111        NEXT SENTENCE
 17112       ELSE
 17113         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17114            MOVE ER-2757           TO WS-ERROR
 17115            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17116
 17117 3780-UPDATE-CANCEL-CERT.
 17118
 17119     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17120        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 308
* EL050.cbl
 17121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17122
 17123     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17124         MOVE ER-2729              TO WS-ERROR
 17125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17126
 17127     IF PB-CI-LF-BENEFIT-CD = ZERO
 17128         GO TO 3780-UPDATE-CONT-1.
 17129
 17130     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17131         GO TO 3780-UPDATE-CONT-1.
 17132
 17133     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17134       AND
 17135        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17136       AND
 17137        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17138       AND
 17139        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17140            NEXT SENTENCE
 17141       ELSE
 17142        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17143          AND
 17144***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17145***       AND
 17146           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17147            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17148               MOVE ER-2730      TO WS-ERROR
 17149               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17150               GO TO 3999-END-EDIT
 17151            ELSE
 17152               GO TO 3999-END-EDIT
 17153        ELSE
 17154            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17155               MOVE ER-2765           TO WS-ERROR
 17156               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17157               GO TO 3785-CHECK-NH.
 17158*              GO TO 3999-END-EDIT.
 17159
 17160 3780-UPDATE-CONT-1.
 17161     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17162
 17163     IF PB-CI-AH-BENEFIT-CD = ZERO
 17164         GO TO 3780-UPDATE-CONT-2.
 17165
 17166     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17167         GO TO 3780-UPDATE-CONT-2.
 17168
 17169     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17170
 17171     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17172       AND
 17173        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17174       AND
 17175        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17176       AND
 17177        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17178            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 309
* EL050.cbl
 17179       ELSE
 17180        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17181          AND
 17182***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17183***       AND
 17184           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17185           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17186            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17187               MOVE ER-2773      TO WS-ERROR
 17188               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17189               GO TO 3999-END-EDIT
 17190            ELSE
 17191               GO TO 3999-END-EDIT
 17192            END-IF
 17193           ELSE
 17194             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17195                IF MSTR-CERT-NO = W-CL-CERT-NO
 17196                   MOVE ER-2890 TO WS-ERROR
 17197                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17198                   GO TO 3999-END-EDIT
 17199                ELSE
 17200                   MOVE ER-2898 TO WS-ERROR
 17201                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17202                   GO TO 3999-END-EDIT
 17203                END-IF
 17204             ELSE
 17205                GO TO 3785-CHECK-NH
 17206             END-IF
 17207           END-IF
 17208          ELSE
 17209            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17210              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17211                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17212                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17213                      MOVE ER-2890 TO WS-ERROR
 17214                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17215                      GO TO 3999-END-EDIT
 17216                   ELSE
 17217                      MOVE ER-2898 TO WS-ERROR
 17218                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17219                      GO TO 3999-END-EDIT
 17220                   END-IF
 17221                ELSE
 17222                   MOVE ER-2765 TO WS-ERROR
 17223                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17224                   GO TO 3785-CHECK-NH
 17225                END-IF
 17226              ELSE
 17227               MOVE ER-2765      TO WS-ERROR
 17228               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17229               GO TO 3785-CHECK-NH.
 17230*              GO TO 3999-END-EDIT.
 17231
 17232 3780-UPDATE-CONT-2.
 17233
 17234     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17235        AND WS-LF-BENEFIT-CD = ZERO
 17236           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 310
* EL050.cbl
 17237           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17238
 17239     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17240        AND WS-AH-BENEFIT-CD = ZERO
 17241           MOVE ER-2744           TO WS-ERROR
 17242           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17243
 17244     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17245        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17246        AND
 17247        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17248         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17249           MOVE ER-2746           TO WS-ERROR
 17250           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17251
 17252     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17253       AND
 17254        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17255             MOVE ER-2737        TO WS-ERROR
 17256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17257
 17258     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17259       AND
 17260        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17261             MOVE ER-2737        TO WS-ERROR
 17262             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17263
 17264     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17265         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17266             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17267             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17268         ELSE
 17269             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17270                 MOVE ER-2768    TO WS-ERROR
 17271                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17272             ELSE
 17273                 MOVE ER-2756    TO WS-ERROR
 17274                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17275
 17276     IF CERT-PEND-ISSUE-RETURNED
 17277        MOVE ER-2772             TO WS-ERROR
 17278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17279 3785-CHECK-NH.
 17280*    IF PB-STATE NOT = 'NH' and 'TN'
 17281     IF PB-STATE NOT = 'NH'
 17282        GO TO 3999-END-EDIT
 17283     END-IF
 17284
 17285     MOVE ER-2796                TO WS-ERROR
 17286     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17287     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17288        OR (CM-NH-INTERFACE-SW = 'Y')
 17289        MOVE ER-2793             TO WS-ERROR
 17290        PERFORM 9900-ERROR-FORMAT
 17291                                 THRU 9900-EXIT
 17292     END-IF
 17293     MOVE +0                     TO WS-PAYMENT-AMT
 17294     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 311
* EL050.cbl
 17295        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17296               PB-C-AH-CANCEL-DT
 17297           GO TO 3999-END-EDIT
 17298        END-IF
 17299     end-if
 17300***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17301***-_-
 17302***-_-   For TN it's only flat cancels
 17303***-_-
 17304***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17305     if pb-state = 'TN'
 17306        if ((pb-c-lf-cancel-dt <> low-values)
 17307           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17308                      or
 17309           ((pb-c-ah-cancel-dt <> low-values)
 17310           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17311           GO TO 3999-END-EDIT
 17312        END-IF
 17313     end-if
 17314     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17315        GO TO 3999-END-EDIT
 17316     END-IF
 17317***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17318***-_-
 17319***-_-   if cancel date within 15 days of effective date, bypass
 17320***-_-
 17321***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17322     IF PB-STATE NOT = 'NH'
 17323        GO TO 3785-CONTINUE
 17324     END-IF
 17325     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17326     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17327     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17328        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17329     END-IF
 17330     MOVE '1'                    TO DC-OPTION-CODE
 17331     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17332     IF NO-CONVERSION-ERROR
 17333        IF DC-ELAPSED-DAYS < +16
 17334           GO TO 3999-END-EDIT
 17335        END-IF
 17336     END-IF
 17337***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17338***-_-
 17339***-_-   if cancel date within 30 days of current date then
 17340***-_-   bypass else subtract 15 days from period
 17341***-_-
 17342***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17343     MOVE +0                     TO DC-ELAPSED-DAYS
 17344     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17345     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17346     MOVE '1'                    TO DC-OPTION-CODE
 17347     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17348     IF NO-CONVERSION-ERROR
 17349        IF DC-ELAPSED-DAYS > +30
 17350           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17351        ELSE
 17352           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 312
* EL050.cbl
 17353        END-IF
 17354     ELSE
 17355        GO TO 3999-END-EDIT
 17356     END-IF
 17357     .
 17358 3785-CONTINUE.
 17359     if pb-state = 'TN'
 17360        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17361        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17362        MOVE '1'                 TO DC-OPTION-CODE
 17363        PERFORM 8500-DATE-CONVERT
 17364                                 THRU 8500-EXIT
 17365        IF no-CONVERSION-ERROR
 17366           IF DC-ELAPSED-DAYS < +16
 17367              GO TO 3999-END-EDIT
 17368           END-IF
 17369        END-IF
 17370     end-if
 17371***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17372***-_-
 17373***-_-   'NH' is 10%, TN is 3.5%
 17374***-_-
 17375***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17376     if pb-state = 'NH'
 17377        move +1.10               to ws-work-rate
 17378     else
 17379        move +1.035              to ws-work-rate
 17380     end-if
 17381     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17382        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17383           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17384     IF WS-PAYMENT-AMT < 600.00
 17385        GO TO 3999-END-EDIT
 17386     END-IF
 17387     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17388
 17389     IF (ERMAIL-FOUND = ' ')
 17390         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17391         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17392        GO TO 3999-END-EDIT
 17393     END-IF
 17394     MOVE ER-2795                TO WS-ERROR
 17395     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17396
 17397     GO TO 3999-END-EDIT.
 17398******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 313
* EL050.cbl
 17400 3990-FILES-NOT-OPEN.
 17401
 17402     MOVE ER-2617                TO WS-ERROR.
 17403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17404     GO TO 9990-RETURN.
 17405
 17406 3999-END-EDIT.
 17407
 17408     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17409
 17410     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17411         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17412         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17413             PERFORM 9250-UNLOCK-RETURN
 17414             GO TO 9990-RETURN
 17415          ELSE
 17416             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17417             GO TO 9990-RETURN.
 17418
 17419     IF PB-CANCELLATION
 17420          GO TO 9990-RETURN.
 17421
 17422     IF CERT-WAS-NOT-FOUND
 17423        MOVE SPACES              TO CERTIFICATE-MASTER.
 17424
 17425     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17426
 17427     IF CERT-WAS-FOUND
 17428         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17429             PERFORM 9250-UNLOCK-RETURN
 17430          ELSE
 17431            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17432      ELSE
 17433         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17434
 17435*    if pb-company-id = 'VPP'
 17436*       perform 8150-read-elcrtt thru 8150-exit
 17437*       if ws-vehicle-odometer numeric
 17438*          if ws-vehicle-odometer > 6000
 17439*             move er-1583       to ws-error
 17440*             PERFORM 9900-ERROR-FORMAT
 17441*                                THRU 9900-EXIT
 17442*          end-if
 17443*       end-if
 17444*    end-if
 17445     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17446        IF ((PB-COMPANY-ID = 'DCC')
 17447           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17448                         or
 17449            (pb-company-id = 'CID' or 'VPP')
 17450            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17451        END-IF
 17452     END-IF.
 17453
 17454     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17455         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17456     END-IF.
 17457     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 314
* EL050.cbl
 17458     perform 8150-read-elcrtt    thru 8150-exit
 17459     if ws-ins-age-defaulted = 'Y'
 17460        move er-1573             to ws-error
 17461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17462     end-if
 17463
 17464     if ws-jnt-age-defaulted = 'Y'
 17465        move er-1574             to ws-error
 17466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17467     end-if
 17468***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17469***                                                           ****
 17470***  Set an error if the state requires verification of agent ****
 17471***  and agent hasn't verified yet and the status is not =    ****
 17472***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17473***  and the entry date > 09/01/2015.                         ****
 17474***                                                           ****
 17475***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17476     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17477        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17478        and (pb-account (9:2) not = 'OB')
 17479        if (ws-st-agent-sig-edit = 'Y')
 17480           and (am-report-code-1 not = 'CONLEY')
 17481           evaluate true
 17482              when cs-agent-edit-status = 'C'
 17483                 move er-1743    to ws-error
 17484                 perform 9900-error-format
 17485                                 thru 9900-exit
 17486              when cs-agent-edit-status = 'S'
 17487                 move er-1744    to ws-error
 17488                 perform 9900-error-format
 17489                                 thru 9900-exit
 17490              when cs-agent-edit-status = 'M'
 17491                 move er-1745    to ws-error
 17492                 perform 9900-error-format
 17493                                 thru 9900-exit
 17494              when cs-agent-edit-status = 'R'
 17495                 move er-1747    to ws-error
 17496                 perform 9900-error-format
 17497                                 thru 9900-exit
 17498              when cs-agent-edit-status = 'N'
 17499                 move er-1748    to ws-error
 17500                 perform 9900-error-format
 17501                                 thru 9900-exit
 17502              when cs-agent-edit-status <> 'V' and 'U' and
 17503                                           'R' and 'N'
 17504                 move er-1746    to ws-error
 17505                 perform 9900-error-format
 17506                                 thru 9900-exit
 17507           end-evaluate
 17508        end-if
 17509     end-if
 17510     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17511     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17512        AND (WS-NO-SECURE-PAY))
 17513                  OR
 17514        (WS-LF-SPECIAL-CALC-CD = 'O'
 17515        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 315
* EL050.cbl
 17516        SET SKIP-ADDR-EDIT       TO TRUE
 17517     END-IF
 17518     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17519        AND (NOT SKIP-ADDR-EDIT)
 17520        MOVE ER-2963             TO WS-ERROR
 17521        PERFORM 9900-ERROR-FORMAT
 17522                                 THRU 9900-EXIT
 17523        GO TO 9990-RETURN
 17524     END-IF
 17525     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17526     IF ERPNDM-FOUND NOT = 'X'
 17527        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17528           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17529           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17530           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17531           AND (NOT SKIP-ADDR-EDIT)
 17532           MOVE ER-2694          TO WS-ERROR
 17533           PERFORM 9900-ERROR-FORMAT
 17534                                 THRU 9900-EXIT
 17535        END-IF
 17536        MOVE ' '                 TO STATE-RECORD-ERROR
 17537        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17538        MOVE PM-STATE            TO CNTL-ACCESS
 17539        MOVE '3'                 TO CNTL-REC-TYPE
 17540        MOVE +0                  TO CNTL-SEQ-NO
 17541        MOVE '0'                 TO RC-SW-2
 17542        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17543        IF (NO-STATE-RECORD)
 17544           OR (CF-RECORD-TYPE NOT = '3')
 17545           OR (PM-STATE NOT = CF-STATE-CODE)
 17546           IF (PM-STATE = SPACES)
 17547              AND (SKIP-ADDR-EDIT)
 17548              CONTINUE
 17549           ELSE
 17550              MOVE ER-2963       TO WS-ERROR
 17551              PERFORM 9900-ERROR-FORMAT
 17552                                 THRU 9900-EXIT
 17553           END-IF
 17554        END-IF
 17555        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17556           MOVE ER-2883          TO WS-ERROR
 17557           PERFORM 9900-ERROR-FORMAT
 17558                                 THRU 9900-EXIT
 17559        END-IF
 17560        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17561           MOVE ' '                 TO STATE-RECORD-ERROR
 17562           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17563           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17564           MOVE '3'                 TO CNTL-REC-TYPE
 17565           MOVE +0                  TO CNTL-SEQ-NO
 17566           MOVE '0'                 TO RC-SW-2
 17567           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17568           IF NO-STATE-RECORD
 17569              OR (CF-RECORD-TYPE NOT = '3')
 17570              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17571              MOVE ER-2964          TO WS-ERROR
 17572              PERFORM 9900-ERROR-FORMAT
 17573                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 316
* EL050.cbl
 17574           END-IF
 17575        END-IF
 17576     ELSE
 17577        IF NOT SKIP-ADDR-EDIT
 17578           MOVE ER-2393          TO WS-ERROR
 17579           PERFORM 9900-ERROR-FORMAT
 17580                                 THRU 9900-EXIT
 17581        END-IF
 17582     END-IF
 17583
 17584     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17585
 17586     IF (ERMAIL-FOUND = ' ' AND
 17587        ERPNDM-FOUND = ' ')
 17588        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17589           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17590           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17591          OR
 17592           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17593          OR
 17594           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17595           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17596           GO TO 3999-UNLOCK-ERMAIL.
 17597
 17598     IF ERPNDM-FOUND = 'X'
 17599        GO TO 3999-UNLOCK-ERMAIL.
 17600
 17601     IF PM-INSURED-LAST-NAME      = SPACES
 17602        AND PM-INSURED-FIRST-NAME = SPACES
 17603        AND PM-ADDRESS-LINE-1     = SPACES
 17604        AND PM-ADDRESS-LINE-2     = SPACES
 17605        AND PM-CITY-STATE         = SPACES
 17606        AND PM-CRED-BENE-NAME     = SPACES
 17607        AND PM-CRED-BENE-ADDR     = SPACES
 17608        AND PM-CRED-BENE-CTYST    = SPACES
 17609        GO TO 3999-UNLOCK-ERMAIL
 17610     END-IF
 17611
 17612     MOVE SPACES                 TO MAILING-DATA.
 17613
 17614     MOVE 'MA'                   TO MA-RECORD-ID.
 17615     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17616     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17617     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17618     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17619     MOVE PB-SV-STATE            TO MA-STATE.
 17620     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17621     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17622
 17623     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17624     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17625
 17626     IF ERMAIL-FOUND = ' '
 17627        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17628     ELSE
 17629        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17630        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17631        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 317
* EL050.cbl
 17632
 17633     GO TO 9990-RETURN.
 17634
 17635 3999-UNLOCK-ERMAIL.
 17636     IF ERMAIL-FOUND = ' '
 17637        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17638
 17639     GO TO 9990-RETURN.
 17640******************************************************************
 17641
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 318
* EL050.cbl
 17643 4000-UPDATE-CANCELLED-CERT.
 17644     IF CERT-WAS-NOT-FOUND
 17645        GO TO 4299-EXIT.
 17646
 17647*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17648     IF PB-C-NH-INT-ON-REFS > ZEROS
 17649        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17650     END-IF
 17651     IF PB-C-REF-INTERFACE-SW = 'Y'
 17652        MOVE PB-C-REF-INTERFACE-SW
 17653                                 TO CM-NH-INTERFACE-SW
 17654     END-IF
 17655     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17656     IF ERMAIL-FOUND = 'X'
 17657        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17658        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17659        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17660        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17661           MOVE ER-2694          TO WS-ERROR
 17662           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17663     END-IF
 17664
 17665     IF PB-C-POST-CARD-IND = 'Y'
 17666        MOVE +8                  TO SUB
 17667*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17668        IF ERMAIL-FOUND = ' '
 17669           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17670              (SUB > +7)
 17671              OR (MA-MAIL-STATUS (SUB) = '1')
 17672           END-PERFORM
 17673        END-IF
 17674        IF (SUB > +7)
 17675           OR (ERMAIL-FOUND = 'X')
 17676           MOVE ER-3789          TO WS-ERROR
 17677           PERFORM 9900-ERROR-FORMAT
 17678                                 THRU 9900-EXIT
 17679        END-IF
 17680     ELSE
 17681        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17682     END-IF
 17683
 17684     IF ERMAIL-FOUND = ' '
 17685        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17686     END-IF.
 17687
 17688     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17689
 17690     IF PB-CI-OB-FLAG = 'Z'
 17691        GO TO 4150-SUMMARY-CERT-CANCEL.
 17692
 17693     IF PB-C-LF-CANCEL-VOIDED
 17694         PERFORM 4200-REVERSE-LF-CANCEL.
 17695     IF PB-C-AH-CANCEL-VOIDED
 17696         PERFORM 4200-REVERSE-AH-CANCEL.
 17697
 17698 4100-APPLY-LF-CANCEL.
 17699
 17700     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 319
* EL050.cbl
 17701
 17702 4100-CHECK-LF-ERRORS.
 17703
 17704     ADD +1                       TO WS-SUB.
 17705
 17706     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17707        IF LF-COVERAGE-CANCELLED
 17708           GO TO 4100-LF-CANCEL-CONT
 17709        ELSE
 17710           GO TO 4100-UPDATE-LF-COVERAGE.
 17711
 17712     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17713                                   ER-2729 OR
 17714                                   ER-2730 OR
 17715                                   ER-2731 OR
 17716                                   ER-2732 OR
 17717                                   ER-2737 OR
 17718                                   ER-2740 OR
 17719                                   ER-2743 OR
 17720                                   ER-2749 OR
 17721                                   ER-2750 OR
 17722                                   ER-2755 OR
 17723                                   ER-2757 OR
 17724                                   ER-2760 OR
 17725                                   ER-2772 OR
 17726                                   ER-2774 OR
 17727                                   ER-2776 OR
 17728                                   ER-2794
 17729        GO TO 4100-UPDATE-LF-COVERAGE.
 17730
 17731     GO TO 4100-CHECK-LF-ERRORS.
 17732
 17733 4100-UPDATE-LF-COVERAGE.
 17734
 17735     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17736     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17737     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17738        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17739     END-IF
 17740     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17741                                      TO CM-CREDIT-INTERFACE-SW-2.
 17742     IF CM-LF-CANCEL-DT = LOW-VALUE
 17743         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17744
 17745     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17746         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17747                                         CM-LF-STATUS-AT-CANCEL.
 17748
 17749     GO TO 4100-APPLY-AH-CANCEL.
 17750
 17751 4100-LF-CANCEL-CONT.
 17752     IF PB-C-LF-CANCEL-VOIDED
 17753         GO TO 4100-APPLY-AH-CANCEL.
 17754
 17755     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17756         GO TO 4100-APPLY-AH-CANCEL.
 17757
 17758     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 320
* EL050.cbl
 17759        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17760           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17761        ELSE
 17762           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17763
 17764     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17765     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17766
 17767     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17768         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17769
 17770     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17771        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17772         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17773         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17774
 17775     IF PB-RECORD-RETURNED
 17776        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17777      ELSE
 17778        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17779
 17780 4100-APPLY-AH-CANCEL.
 17781
 17782     MOVE +0                      TO WS-SUB.
 17783
 17784 4100-CHECK-AH-ERRORS.
 17785
 17786     ADD +1                       TO WS-SUB.
 17787
 17788     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17789        IF AH-COVERAGE-CANCELLED
 17790           GO TO 4100-AH-CANCEL-CONT
 17791        ELSE
 17792           GO TO 4100-UPDATE-AH-COVERAGE.
 17793
 17794     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17795                                   ER-2729 OR
 17796                                   ER-2732 OR
 17797                                   ER-2737 OR
 17798                                   ER-2740 OR
 17799                                   ER-2744 OR
 17800                                   ER-2749 OR
 17801                                   ER-2750 OR
 17802                                   ER-2755 OR
 17803                                   ER-2757 OR
 17804                                   ER-2760 OR
 17805                                   ER-2771 OR
 17806                                   ER-2772 OR
 17807                                   ER-2773 OR
 17808                                   ER-2775 OR
 17809                                   ER-2777 OR
 17810                                   ER-2778 OR
 17811                                   ER-2794
 17812        GO TO 4100-UPDATE-AH-COVERAGE.
 17813
 17814     GO TO 4100-CHECK-AH-ERRORS.
 17815
 17816 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 321
* EL050.cbl
 17817
 17818     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17819     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17820     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17821     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17822                                      TO CM-CREDIT-INTERFACE-SW-2.
 17823     IF CM-AH-CANCEL-DT = LOW-VALUE
 17824         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17825
 17826     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17827         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17828                                         CM-AH-STATUS-AT-CANCEL.
 17829
 17830     IF LF-COVERAGE-CANCELLED
 17831         IF PB-RECORD-RETURNED
 17832              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17833          ELSE
 17834              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17835
 17836     GO TO 4299-EXIT.
 17837
 17838 4100-AH-CANCEL-CONT.
 17839     IF PB-C-AH-CANCEL-VOIDED
 17840         GO TO 4299-EXIT.
 17841
 17842     if cm-credit-interface-sw-2 = ' '
 17843        if pb-fatal-errors or pb-unforced-errors
 17844           move '4'              to cm-credit-interface-sw-2
 17845        else
 17846           move '1'              to cm-credit-interface-sw-2
 17847        end-if
 17848     end-if
 17849     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17850         GO TO 4299-EXIT.
 17851
 17852     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17853        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17854           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17855        ELSE
 17856           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17857
 17858     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17859     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17860
 17861     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17862         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17863
 17864     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17865         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17866         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17867
 17868     IF PB-RECORD-RETURNED
 17869        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17870      ELSE
 17871        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17872
 17873     GO TO 4299-EXIT.
 17874
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 322
* EL050.cbl
 17875 4150-SUMMARY-CERT-CANCEL.
 17876     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17877
 17878     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17879        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17880                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17881     ELSE
 17882        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17883                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17884
 17885     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17886        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17887                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17888     ELSE
 17889        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17890                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17891
 17892     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17893        NEXT SENTENCE
 17894     ELSE
 17895        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17896
 17897     GO TO 4299-EXIT.
 17898
 17899 4200-REVERSE-LF-CANCEL.
 17900     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17901
 17902     IF CM-LF-CANCEL-APPLIED
 17903        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17904        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17905        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17906
 17907     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17908
 17909     IF PB-RECORD-RETURNED
 17910        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17911       ELSE
 17912        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17913
 17914 4200-REVERSE-LF-EXIT.
 17915       EXIT.
 17916
 17917 4200-REVERSE-AH-CANCEL.
 17918     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17919
 17920     IF CM-AH-CANCEL-APPLIED
 17921        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17922        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17923        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17924
 17925     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17926
 17927     IF PB-RECORD-RETURNED
 17928        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17929       ELSE
 17930        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17931
 17932 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 323
* EL050.cbl
 17933       EXIT.
 17934
 17935 4299-EXIT.
 17936       EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 324
* EL050.cbl
 17938
 17939 4500-UPDATE-NEW-CERT.
 17940     IF CERT-WAS-FOUND
 17941         NEXT SENTENCE
 17942       ELSE
 17943         GO TO 4520-BUILD-NEW-KEY.
 17944
 17945     IF  CLASIC-CREATED-CERT
 17946         GO TO 4999-EXIT.
 17947
 17948     IF  CERT-WAS-CREATED-FOR-CLAIM
 17949         GO TO 4520-BUILD-NEW-KEY.
 17950
 17951     IF CERT-ADDED-BATCH
 17952        IF CM-RECORD-ID = 'CM'
 17953            GO TO 4999-EXIT.
 17954
 17955 4520-BUILD-NEW-KEY.
 17956* BUILD CONTROL PRIMARY
 17957
 17958     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17959                                       CM-COMPANY-CD-A1
 17960                                       CM-COMPANY-CD-A2
 17961                                       CM-COMPANY-CD-A4
 17962                                       CM-COMPANY-CD-A5.
 17963
 17964     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17965     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17966     MOVE PB-SV-STATE               TO CM-STATE.
 17967     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17968     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17969     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17970     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17971
 17972     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17973
 17974     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17975     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17976     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17977     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17978
 17979     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17980        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17981
 17982     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17983         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17984         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17985         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17986         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17987     ELSE
 17988         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17989
 17990     IF PB-COMPANY-ID   EQUAL  'CRI'
 17991         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17992         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17993         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17994         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17995         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 325
* EL050.cbl
 17996
 17997     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17998        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17999         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18000
 18001     IF PB-COMPANY-ID  = 'LBL'
 18002        IF PB-I-JOINT-COVERAGE
 18003            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18004                                           PB-I-MEMBER-NO
 18005            GO TO 4550-CONT-CERT-PROCESS.
 18006
 18007     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18008        NEXT SENTENCE
 18009     ELSE
 18010        GO TO 4540-BUILD-MEMBER-NO.
 18011
 18012******************************************************************
 18013*                                                                *
 18014*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18015*    FOR 'MON'.                                                  *
 18016*                                                                *
 18017******************************************************************
 18018
 18019     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18020     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18021     MOVE +1                     TO WS-SUB1
 18022                                    WS-SUB2.
 18023
 18024 4530-EDIT-MEMB-NAME.
 18025
 18026     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18027        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18028        ADD +1                       TO WS-SUB2.
 18029
 18030     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18031        ADD +1                       TO WS-SUB1
 18032        GO TO 4530-EDIT-MEMB-NAME.
 18033
 18034     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18035     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18036     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18037*    MOVE SPACE                      TO DC-OPTION-CODE.
 18038     SET  BIN-TO-GREG                TO TRUE.
 18039     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18040     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18041
 18042     GO TO 4550-CONT-CERT-PROCESS.
 18043
 18044******************************************************************
 18045*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18046******************************************************************
 18047
 18048 4540-BUILD-MEMBER-NO.
 18049
 18050     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18051         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18052         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18053         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 326
* EL050.cbl
 18054         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18055     ELSE
 18056         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18057
 18058     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18059        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18060         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18061
 18062 4550-CONT-CERT-PROCESS.
 18063
 18064*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18065*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18066*    ELSE
 18067*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18068
 18069     IF CERT-WAS-CREATED-FOR-CLAIM
 18070        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18071        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18072
 18073     IF CERT-AND-CLAIM-ONLINE
 18074        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18075        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18076
 18077     MOVE 'CM'                     TO CM-RECORD-ID.
 18078     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18079
 18080     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18081        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18082        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18083     ELSE
 18084        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18085        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18086
 18087     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18088     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18089     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18090     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18091     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18092     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18093     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18094                                      CM-LF-ITD-CANCEL-AMT
 18095                                      CM-LF-ITD-DEATH-AMT
 18096                                      CM-AH-ITD-AH-PMT
 18097                                      CM-AH-ITD-LUMP-PMT
 18098                                      CM-AH-ITD-CANCEL-AMT
 18099                                      CM-LF-NSP-PREMIUM-AMT
 18100                                      CM-AH-NSP-PREMIUM-AMT.
 18101*                                     CM-CLAIM-DEDUCT-WITHHELD
 18102*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18103     if pb-i-loan-apr = +99.9999
 18104        move zeros                 to cm-loan-apr
 18105     else
 18106        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18107     end-if
 18108     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18109     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18110     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18111     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 327
* EL050.cbl
 18112     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18113     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18114     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18115     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18116     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18117     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18118     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18119
 18120     IF PB-I-LIVES NOT NUMERIC
 18121         MOVE ZERO                 TO PB-I-LIVES.
 18122
 18123     IF PB-I-NUM-BILLED NOT NUMERIC
 18124         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18125
 18126     MOVE PB-I-LIVES               TO CM-LIVES.
 18127     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18128
 18129     IF PB-COMPANY-ID EQUAL  'DMD'
 18130         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18131         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18132
 18133     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18134     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18135     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18136     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18137     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18138     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18139
 18140     IF PB-I-LF-POLICY-FEE NUMERIC
 18141        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18142     ELSE
 18143        MOVE +0                    TO CM-LF-POLICY-FEE.
 18144
 18145     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18146        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18147        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18148     ELSE
 18149        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18150
 18151     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18152     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18153     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18154     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18155     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18156     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18157     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18158     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18159     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18160
 18161     IF PB-I-CANCEL-FEE NUMERIC
 18162        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18163     ELSE
 18164        MOVE +0                  TO CM-CANCEL-FEE
 18165     END-IF
 18166
 18167     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18168        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18169     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 328
* EL050.cbl
 18170        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18171
 18172     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18173     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18174
 18175     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18176                                      CM-LF-DEATH-EXIT-DT
 18177                                      CM-AH-SETTLEMENT-EXIT-DT.
 18178
 18179*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18180*                       'TIH' OR 'OFL' OR 'FLA' OR
 18181*                       'TII' OR 'TMS' OR 'CRI' OR
 18182*                       'NCL'
 18183     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18184
 18185     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18186         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18187            MOVE '2'                TO CM-PREMIUM-TYPE.
 18188
 18189     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18190         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18191            MOVE '2'                TO CM-PREMIUM-TYPE.
 18192
 18193     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18194         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18195     ELSE
 18196         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18197         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18198
 18199     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18200     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18201     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18202     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18203     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18204     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18205     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18206     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18207
 18208     IF PB-NO-MONTHS-SKIPPED
 18209         MOVE SPACE                 TO CM-SKIP-CODE
 18210     ELSE
 18211         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18212
 18213     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18214     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18215                                       CM-LF-STATUS-AT-CANCEL.
 18216
 18217     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18218     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18219                                       CM-AH-STATUS-AT-CANCEL.
 18220
 18221     MOVE '1'                       TO CM-ENTRY-STATUS.
 18222
 18223     IF PB-REISSUED-CERT
 18224        MOVE '5'                    TO CM-ENTRY-STATUS.
 18225
 18226     IF PB-MONTHLY-CERT
 18227        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 329
* EL050.cbl
 18228
 18229     IF PB-CASH-CERT
 18230        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18231
 18232     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18233     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18234     IF PB-POLICY-IS-DECLINED
 18235        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18236
 18237     IF PB-POLICY-IS-VOIDED
 18238        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18239
 18240     IF PB-NEEDS-UNDERWRITING
 18241        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18242
 18243     IF PB-REIN-ONLY-CERT
 18244        MOVE '9'                    TO CM-ENTRY-STATUS.
 18245
 18246     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18247         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18248     ELSE
 18249         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18250
 18251     IF PB-RECORD-RETURNED
 18252        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18253      ELSE
 18254        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18255
 18256     IF PB-I-MAIL-ADDRS-PRESENT
 18257        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18258
 18259     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18260                                       CM-ENTRY-DT.
 18261
 18262 4999-EXIT.
 18263     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 330
* EL050.cbl
 18265
 18266 5000-PROCESS-REPS.
 18267     MOVE ' '                    TO AGTC-MASTER-SW
 18268     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18269     MOVE CO-TYPE                TO AGTC-TYPE
 18270     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18271     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18272     IF (AGTC-MASTER-SW NOT = 'N')
 18273        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18274        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18275        PERFORM 8583-READ-ERAGTC-NEXT
 18276                                 THRU 8583-EXIT
 18277     END-IF
 18278     IF AGTC-MASTER-SW = 'N'
 18279        CONTINUE
 18280     ELSE
 18281        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18282           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18283              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18284              MOVE 'Y'           TO AGTC-MASTER-SW
 18285           END-IF
 18286        END-IF
 18287     END-IF
 18288     .
 18289 5000-EXIT.
 18290     EXIT.
 18291 6370-EDIT-INPUT-LF-CODE.
 18292     move ' ' to ws-benefit-cd-chg-sw
 18293     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18294        MOVE +1                  TO SUB
 18295        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18296        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18297        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18298        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18299        GO TO 6370-SEARCH-LOOP.
 18300
 18301     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18302
 18303     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18304     MOVE SPACES                 TO CNTL-ACCESS.
 18305*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18306     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18307     MOVE +0                     TO CNTL-SEQ-NO.
 18308     MOVE '4' TO RC-SW-2.
 18309     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18310
 18311     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18312        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18313        GO TO 6370-NO-LF-FOUND.
 18314
 18315     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18316     MOVE +1                     TO SUB.
 18317
 18318 6370-SEARCH-LOOP.
 18319     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18320         GO TO 6370-NO-LF-FOUND.
 18321
 18322     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 331
* EL050.cbl
 18323        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18324           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18325           set benefit-code-chg to true
 18326        end-if
 18327        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18328        GO TO 6370-HER-NET-PAY-CHECK.
 18329
 18330     ADD 1   TO SUB.
 18331*    IF SUB GREATER 120
 18332     IF SUB GREATER 200
 18333         GO TO 6370-NO-LF-FOUND.
 18334
 18335     GO TO 6370-SEARCH-LOOP.
 18336
 18337 6370-NO-LF-FOUND.
 18338
 18339     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18340        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18341        set benefit-code-chg to true
 18342     end-if
 18343     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18344
 18345 6370-HER-NET-PAY-CHECK.
 18346
 18347     IF PB-COMPANY-ID = 'CID'
 18348        IF PB-SV-STATE = 'CA' OR 'MN'
 18349           IF PB-I-LF-BENEFIT-CD = '02'
 18350              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18351           ELSE
 18352              IF PB-I-LF-BENEFIT-CD = '04'
 18353                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18354              END-IF
 18355           END-IF
 18356        END-IF
 18357     END-IF
 18358
 18359     IF PB-COMPANY-ID NOT = 'HER'
 18360         GO TO 6370-EXIT.
 18361
 18362     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18363         GO TO 6370-EXIT.
 18364
 18365     IF PB-I-LF-TERM NOT NUMERIC
 18366         MOVE ZEROS              TO PB-I-LF-TERM.
 18367
 18368     IF PB-I-LOAN-TERM NOT NUMERIC
 18369         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18370
 18371     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18372         GO TO 6370-EXIT.
 18373
 18374     IF PB-I-LF-BENEFIT-CD = '33'
 18375         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18376
 18377     IF PB-I-LF-BENEFIT-CD = '34'
 18378         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18379
 18380 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 332
* EL050.cbl
 18381     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 333
* EL050.cbl
 18383
 18384 6380-EDIT-INPUT-AH-CODE.
 18385     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18386        MOVE +1                  TO SUB
 18387        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18388        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18389        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18390        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18391        GO TO 6380-SEARCH-LOOP.
 18392
 18393     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18394
 18395     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18396     MOVE SPACES                 TO CNTL-ACCESS.
 18397     MOVE 'A'                    TO CNTL-REC-TYPE.
 18398*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18399     MOVE +0                     TO CNTL-SEQ-NO.
 18400     MOVE '5' TO RC-SW-2.
 18401     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18402
 18403     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18404        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18405        GO TO 6380-NO-AH-FOUND.
 18406
 18407     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18408     MOVE +1 TO SUB.
 18409
 18410 6380-SEARCH-LOOP.
 18411     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18412         GO TO 6380-NO-AH-FOUND.
 18413
 18414     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18415         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18416         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18417
 18418     ADD 1   TO SUB.
 18419     IF SUB GREATER THAN 96
 18420*    IF SUB GREATER THAN 300
 18421         GO TO 6380-NO-AH-FOUND.
 18422
 18423     GO TO 6380-SEARCH-LOOP.
 18424
 18425 6380-NO-AH-FOUND.
 18426
 18427     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18428
 18429     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18430         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18431     ELSE
 18432         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18433
 18434 6380-CSO-AH-ONLY-CHECKS.
 18435
 18436     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18437        NEXT SENTENCE
 18438      ELSE
 18439        GO TO 6380-EXIT.
 18440
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 334
* EL050.cbl
 18441     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18442         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18443
 18444
 18445     GO TO 6380-EXIT
 18446     .
 18447 6380-CSO-LIFE-WITH-AH-CHECKS.
 18448
 18449
 18450     .
 18451 6380-EXIT.
 18452     EXIT.
 18453
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 335
* EL050.cbl
 18455
 18456 6400-COMPUTE-EXTENSION-DAYS.
 18457
 18458******************************************************************
 18459*                                                                *
 18460*                   COMPUTE EXTENSION DAYS                       *
 18461*                                                                *
 18462*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18463*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18464*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18465*    THE EXTENSION DAYS.                                         *
 18466*                                                                *
 18467******************************************************************
 18468
 18469     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18470     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18471
 18472******************************************************************
 18473*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18474*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18475******************************************************************
 18476
 18477     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18478        COMPUTE WS-ODD-DAYS-OVER =
 18479               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18480     ELSE
 18481        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18482
 18483     IF WS-ODD-DAYS-OVER = ZEROS
 18484           GO TO 6499-EXIT
 18485     ELSE
 18486        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18487           IF WS-WDF-MONTH = 02
 18488              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18489              ADD 2       TO  WS-ODD-DAYS-OVER
 18490              GO TO 6499-EXIT
 18491           ELSE
 18492              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18493                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18494                 GO TO 6499-EXIT
 18495               ELSE
 18496                 GO TO 6499-EXIT
 18497        ELSE
 18498           GO TO 6499-EXIT.
 18499
 18500 6412-CHECK-TO-DAY.
 18501
 18502        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18503           IF WS-WDT-DAY = 28
 18504              ADD 2              TO WS-ODD-DAYS-OVER
 18505           ELSE
 18506              IF WS-WDT-DAY = 29
 18507                 ADD 1           TO WS-ODD-DAYS-OVER
 18508              ELSE
 18509                 NEXT SENTENCE
 18510        ELSE
 18511           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18512              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 336
* EL050.cbl
 18513
 18514     GO TO 6499-EXIT.
 18515
 18516
 18517 6415-CHECK-LEAP-YEAR.
 18518
 18519     IF DC-DAYS-IN-MONTH = 29
 18520        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18521
 18522 6415-EXIT.
 18523     EXIT.
 18524
 18525 6499-EXIT.
 18526      EXIT.
 18527
 18528 6500-END.
 18529     EXIT.
 18530
 18531
 18532******************************************************************
 18533************* PROCEDURE DIVISION FOR EL050 ***********************
 18534********************** ELC50PD END *******************************
 18535
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 337
* EL050.cbl
 18537
 18538**START***********************************************************
 18539*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18540*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18541******************************************************************
 18542*
 18543 6600-GET-STATE-MUNICIPAL-TAX.
 18544
 18545     IF PB-COMPANY-ID NOT = 'DMD'
 18546         GO TO 6640-EXIT.
 18547
 18548     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18549     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18550     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18551*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18552*
 18553***  Y2K PROJ 7744
 18554     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18555     SET BIN-TO-GREG          TO TRUE.
 18556     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18557
 18558     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18559
 18560     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18561     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18562
 18563
 18564* EXEC CICS HANDLE CONDITION
 18565*        INVREQ    (6610-START-BROWSE)
 18566*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18567*        NOTFND    (6630-END-OF-FILE)
 18568*    END-EXEC.
 18569*    MOVE '"$8JI                 ! # #00018553' TO DFHEIV0
 18570     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18572     MOVE X'2320233030303138353533' TO DFHEIV0(25:11)
 18573     CALL 'kxdfhei1' USING DFHEIV0
 18574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18575
 18576
 18577 6610-START-BROWSE.
 18578
 18579
 18580* EXEC CICS HANDLE CONDITION
 18581*        NOTFND    (6630-END-OF-FILE)
 18582*        DISABLED  (6630-ERRESS-PROBLEM)
 18583*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18584*        ENDFILE   (6630-END-OF-FILE)
 18585*    END-EXEC.
 18586*    MOVE '"$IcJ''                ! $ #00018561' TO DFHEIV0
 18587     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18589     MOVE X'2420233030303138353631' TO DFHEIV0(25:11)
 18590     CALL 'kxdfhei1' USING DFHEIV0
 18591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18592
 18593
 18594
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 338
* EL050.cbl
 18595* EXEC CICS STARTBR
 18596*        DATASET (FILE-ID-ERRESS)
 18597*        RIDFLD  (WS-ERRESS-KEY)
 18598*        GTEQ
 18599*    END-EXEC.
 18600     MOVE 0
 18601       TO DFHEIV11
 18602*    MOVE '&,         G          &   #00018568' TO DFHEIV0
 18603     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18605     MOVE X'2020233030303138353638' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           FILE-ID-ERRESS,
 18608           WS-ERRESS-KEY,
 18609           DFHEIV99,
 18610           DFHEIV11,
 18611           DFHEIV99
 18612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18613
 18614
 18615 6620-READ-NEXT-ERRESS-MASTER.
 18616
 18617
 18618* EXEC CICS HANDLE CONDITION
 18619*        NOTFND    (6630-END-OF-FILE)
 18620*        ENDFILE   (6630-END-OF-FILE)
 18621*        DISABLED  (6630-ERRESS-PROBLEM)
 18622*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18623*    END-EXEC.
 18624*    MOVE '"$I''cJ                ! % #00018576' TO DFHEIV0
 18625     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18627     MOVE X'2520233030303138353736' TO DFHEIV0(25:11)
 18628     CALL 'kxdfhei1' USING DFHEIV0
 18629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18630
 18631
 18632
 18633* EXEC CICS READNEXT
 18634*        DATASET (FILE-ID-ERRESS)
 18635*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18636*        RIDFLD  (WS-ERRESS-KEY)
 18637*    END-EXEC.
 18638     MOVE LENGTH OF
 18639      RESIDENT-STATE-TAX-MASTER
 18640       TO DFHEIV12
 18641     MOVE 0
 18642       TO DFHEIV11
 18643*    MOVE '&.IL                  )   #00018583' TO DFHEIV0
 18644     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18645     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18646     MOVE X'2020233030303138353833' TO DFHEIV0(25:11)
 18647     CALL 'kxdfhei1' USING DFHEIV0,
 18648           FILE-ID-ERRESS,
 18649           RESIDENT-STATE-TAX-MASTER,
 18650           DFHEIV12,
 18651           WS-ERRESS-KEY,
 18652           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 339
* EL050.cbl
 18653           DFHEIV11,
 18654           DFHEIV99,
 18655           DFHEIV99
 18656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18657
 18658
 18659     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18660
 18661* EXEC CICS ENDBR
 18662*            DATASET (FILE-ID-ERRESS)
 18663*       END-EXEC
 18664     MOVE 0
 18665       TO DFHEIV11
 18666*    MOVE '&2                    $   #00018590' TO DFHEIV0
 18667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18669     MOVE X'2020233030303138353930' TO DFHEIV0(25:11)
 18670     CALL 'kxdfhei1' USING DFHEIV0,
 18671           FILE-ID-ERRESS,
 18672           DFHEIV11,
 18673           DFHEIV99
 18674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18675        GO TO 6630-END-OF-FILE.
 18676
 18677     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18678        NEXT SENTENCE
 18679      ELSE
 18680        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18681
 18682*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18683*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18684*
 18685     MOVE +2                     TO WS-SUB1.
 18686
 18687     IF PB-ISSUE
 18688     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18689        MOVE +1                  TO WS-SUB1.
 18690
 18691     IF PB-CANCELLATION
 18692     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18693        MOVE +1                  TO WS-SUB1.
 18694*
 18695*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18696*
 18697***  Y2K PROJ 7744
 18698     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18699***  Y2K PROJ 7744
 18700
 18701*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18702* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18703* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18704
 18705     ADD 1                    TO WS-YEAR-YY.
 18706
 18707     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18708         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18709                              TO WS-RES-STATE-TAX
 18710         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 340
* EL050.cbl
 18711                              TO WS-RES-MUNI-TAX
 18712     ELSE
 18713         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18714                              TO WS-RES-STATE-TAX
 18715         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18716                              TO WS-RES-MUNI-TAX.
 18717
 18718*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18719
 18720     IF PB-CANCELLATION
 18721         GO TO 6640-CANCEL-TAX.
 18722
 18723     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18724         COMPUTE PB-I-STATE-TAX ROUNDED =
 18725                                   PB-I-LF-PREMIUM-AMT
 18726                                 * WS-RES-STATE-TAX
 18727         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18728                                   PB-I-LF-PREMIUM-AMT
 18729                                 * WS-RES-MUNI-TAX
 18730     ELSE
 18731     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18732         COMPUTE PB-I-STATE-TAX ROUNDED =
 18733                                   PB-I-AH-PREMIUM-AMT
 18734                                 * WS-RES-STATE-TAX
 18735         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18736                                   PB-I-AH-PREMIUM-AMT
 18737                                 * WS-RES-MUNI-TAX.
 18738
 18739
 18740* EXEC CICS ENDBR
 18741*         DATASET (FILE-ID-ERRESS)
 18742*    END-EXEC.
 18743     MOVE 0
 18744       TO DFHEIV11
 18745*    MOVE '&2                    $   #00018657' TO DFHEIV0
 18746     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18748     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 18749     CALL 'kxdfhei1' USING DFHEIV0,
 18750           FILE-ID-ERRESS,
 18751           DFHEIV11,
 18752           DFHEIV99
 18753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18754
 18755
 18756     GO TO 6640-EXIT.
 18757
 18758 6640-CANCEL-TAX.
 18759     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18760
 18761     IF PB-C-LF-CANCEL-AMT > ZEROS
 18762         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18763                                   PB-C-LF-CANCEL-AMT
 18764                                 * WS-RES-STATE-TAX
 18765         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18766                                   PB-C-LF-CANCEL-AMT
 18767                                *  WS-RES-MUNI-TAX
 18768     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 341
* EL050.cbl
 18769     IF PB-C-AH-CANCEL-AMT > ZEROS
 18770         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18771                                   PB-C-AH-CANCEL-AMT
 18772                                 * WS-RES-STATE-TAX
 18773         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18774                                   PB-C-AH-CANCEL-AMT
 18775                                *  WS-RES-MUNI-TAX.
 18776
 18777
 18778* EXEC CICS ENDBR
 18779*         DATASET (FILE-ID-ERRESS)
 18780*    END-EXEC.
 18781     MOVE 0
 18782       TO DFHEIV11
 18783*    MOVE '&2                    $   #00018682' TO DFHEIV0
 18784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18786     MOVE X'2020233030303138363832' TO DFHEIV0(25:11)
 18787     CALL 'kxdfhei1' USING DFHEIV0,
 18788           FILE-ID-ERRESS,
 18789           DFHEIV11,
 18790           DFHEIV99
 18791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18792
 18793
 18794     GO TO 6640-EXIT.
 18795
 18796 6630-END-OF-FILE.
 18797     MOVE ER-8002              TO WS-ERROR.
 18798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18799
 18800     GO TO 6640-EXIT.
 18801
 18802 6630-ERRESS-PROBLEM.
 18803     MOVE ER-8044              TO WS-ERROR.
 18804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18805
 18806 6640-EXIT.
 18807     EXIT.
 18808
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 342
* EL050.cbl
 18810 6650-GET-RES-STATE-COMM.
 18811
 18812     IF PB-COMPANY-ID NOT = 'DMD'
 18813         GO TO 6700-COMM-EXIT.
 18814
 18815     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18816     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18817     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18818     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18819     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18820     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18821     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18822
 18823*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18824*
 18825***  Y2K PROJ 7744
 18826     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18827     SET BIN-TO-GREG          TO TRUE.
 18828     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18829
 18830     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18831***  Y2K PROJ 7744
 18832
 18833     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18834
 18835
 18836* EXEC CICS HANDLE CONDITION
 18837*        INVREQ    (6660-START-BROWSE)
 18838*        DISABLED  (6690-ERRESC-PROBLEM)
 18839*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18840*        NOTFND    (6690-END-OF-FILE)
 18841*    END-EXEC.
 18842*    MOVE '"$8cJI                ! & #00018727' TO DFHEIV0
 18843     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18845     MOVE X'2620233030303138373237' TO DFHEIV0(25:11)
 18846     CALL 'kxdfhei1' USING DFHEIV0
 18847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18848
 18849
 18850
 18851* EXEC CICS RESETBR
 18852*        DATASET (FILE-ID-ERRESC)
 18853*        RIDFLD  (WS-ERRESC-KEY)
 18854*    END-EXEC.
 18855     MOVE 0
 18856       TO DFHEIV11
 18857*    MOVE '&4         G          &   #00018734' TO DFHEIV0
 18858     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18860     MOVE X'2020233030303138373334' TO DFHEIV0(25:11)
 18861     CALL 'kxdfhei1' USING DFHEIV0,
 18862           FILE-ID-ERRESC,
 18863           WS-ERRESC-KEY,
 18864           DFHEIV99,
 18865           DFHEIV11,
 18866           DFHEIV99
 18867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 343
* EL050.cbl
 18868
 18869
 18870 6660-START-BROWSE.
 18871
 18872
 18873* EXEC CICS HANDLE CONDITION
 18874*        NOTFND    (6690-END-OF-FILE)
 18875*        DISABLED  (6690-ERRESC-PROBLEM)
 18876*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18877*        ENDFILE   (6690-END-OF-FILE)
 18878*    END-EXEC.
 18879*    MOVE '"$IcJ''                ! '' #00018741' TO DFHEIV0
 18880     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18882     MOVE X'2720233030303138373431' TO DFHEIV0(25:11)
 18883     CALL 'kxdfhei1' USING DFHEIV0
 18884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18885
 18886
 18887
 18888* EXEC CICS STARTBR
 18889*        DATASET (FILE-ID-ERRESC)
 18890*        RIDFLD  (WS-ERRESC-KEY)
 18891*        GTEQ
 18892*    END-EXEC.
 18893     MOVE 0
 18894       TO DFHEIV11
 18895*    MOVE '&,         G          &   #00018748' TO DFHEIV0
 18896     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303138373438' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0,
 18900           FILE-ID-ERRESC,
 18901           WS-ERRESC-KEY,
 18902           DFHEIV99,
 18903           DFHEIV11,
 18904           DFHEIV99
 18905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18906
 18907
 18908     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18909
 18910 6670-READ-NEXT-ERRESC-MASTER.
 18911
 18912
 18913* EXEC CICS HANDLE CONDITION
 18914*        NOTFND    (6690-END-OF-FILE)
 18915*        DISABLED  (6690-ERRESC-PROBLEM)
 18916*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18917*        ENDFILE   (6690-END-OF-FILE)
 18918*    END-EXEC.
 18919*    MOVE '"$IcJ''                ! ( #00018758' TO DFHEIV0
 18920     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18922     MOVE X'2820233030303138373538' TO DFHEIV0(25:11)
 18923     CALL 'kxdfhei1' USING DFHEIV0
 18924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18925
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 344
* EL050.cbl
 18926
 18927
 18928* EXEC CICS READNEXT
 18929*        DATASET (FILE-ID-ERRESC)
 18930*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18931*        RIDFLD  (ERRESC-RECORD-KEY)
 18932*    END-EXEC.
 18933     MOVE LENGTH OF
 18934      ACCOUNT-RESIDENT-ST-COMMISSION
 18935       TO DFHEIV12
 18936     MOVE 0
 18937       TO DFHEIV11
 18938*    MOVE '&.IL                  )   #00018765' TO DFHEIV0
 18939     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18940     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18941     MOVE X'2020233030303138373635' TO DFHEIV0(25:11)
 18942     CALL 'kxdfhei1' USING DFHEIV0,
 18943           FILE-ID-ERRESC,
 18944           ACCOUNT-RESIDENT-ST-COMMISSION,
 18945           DFHEIV12,
 18946           ERRESC-RECORD-KEY,
 18947           DFHEIV99,
 18948           DFHEIV11,
 18949           DFHEIV99,
 18950           DFHEIV99
 18951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18952
 18953
 18954     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18955        NEXT SENTENCE
 18956     ELSE
 18957
 18958* EXEC CICS ENDBR
 18959*            DATASET (FILE-ID-ERRESC)
 18960*       END-EXEC
 18961     MOVE 0
 18962       TO DFHEIV11
 18963*    MOVE '&2                    $   #00018774' TO DFHEIV0
 18964     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18965     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18966     MOVE X'2020233030303138373734' TO DFHEIV0(25:11)
 18967     CALL 'kxdfhei1' USING DFHEIV0,
 18968           FILE-ID-ERRESC,
 18969           DFHEIV11,
 18970           DFHEIV99
 18971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18972        GO TO 6690-END-OF-FILE.
 18973
 18974     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18975
 18976* EXEC CICS ENDBR
 18977*            DATASET (FILE-ID-ERRESC)
 18978*       END-EXEC
 18979     MOVE 0
 18980       TO DFHEIV11
 18981*    MOVE '&2                    $   #00018780' TO DFHEIV0
 18982     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 345
* EL050.cbl
 18984     MOVE X'2020233030303138373830' TO DFHEIV0(25:11)
 18985     CALL 'kxdfhei1' USING DFHEIV0,
 18986           FILE-ID-ERRESC,
 18987           DFHEIV11,
 18988           DFHEIV99
 18989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18990        GO TO 6690-END-OF-FILE.
 18991
 18992     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18993        NEXT SENTENCE
 18994      ELSE
 18995        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18996
 18997* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18998*
 18999     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19000
 19001     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19002
 19003     IF WS-SUB1 > ZERO
 19004         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19005             PERFORM 6680-SET-COMMISSION
 19006         ELSE
 19007             PERFORM 6680-SET-TABLE-CODE.
 19008
 19009
 19010* EXEC CICS ENDBR
 19011*         DATASET (FILE-ID-ERRESC)
 19012*    END-EXEC.
 19013     MOVE 0
 19014       TO DFHEIV11
 19015*    MOVE '&2                    $   #00018802' TO DFHEIV0
 19016     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19017     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19018     MOVE X'2020233030303138383032' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0,
 19020           FILE-ID-ERRESC,
 19021           DFHEIV11,
 19022           DFHEIV99
 19023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19024
 19025
 19026     GO TO 6700-COMM-EXIT.
 19027
 19028 6680-SET-TABLE-CODE.
 19029     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19030        MOVE ZEROS             TO WS-SUB1
 19031     ELSE
 19032* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19033* TO COMPUTE AH COMMISSION.
 19034        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19035        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19036        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19037        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19038        PERFORM 6680-READ-CTBL-TABLE
 19039        IF WS-CTBL-READ-SW NOT = 'Y'
 19040           MOVE ZEROS          TO WS-SUB1.
 19041
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 346
* EL050.cbl
 19042 6680-READ-CTBL-TABLE.
 19043*
 19044* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19045* TO COMPUTE LIFE COMMISSION
 19046
 19047     IF CTBL-SW = '0540'
 19048        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19049        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19050        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19051
 19052     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19053
 19054     IF CTBL-TABLE-FOUND
 19055        IF CTBL-SW = '0530'
 19056             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19057                                    * PB-I-AH-TERM
 19058             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19059             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19060        ELSE
 19061             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19062             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19063             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19064     ELSE
 19065        IF FIRST-TIME-THROUGH
 19066            GO TO 6680-READ-CTBL-TABLE
 19067        ELSE
 19068            MOVE ZEROS         TO WS-SUB1.
 19069
 19070 6680-SET-COMMISSION.
 19071     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19072           MOVE ZEROS          TO WS-SUB1
 19073       ELSE
 19074           MOVE RESC-COMMISSION-PER (WS-SUB)
 19075                               TO WS-COMMISSION
 19076           IF CTBL-SW = '0530'
 19077               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19078           ELSE
 19079               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19080
 19081 6680-SEARCH-CATEGORY.
 19082     ADD +1                   TO WS-SUB.
 19083     IF WS-SUB > +12
 19084         GO TO 6680-EXIT.
 19085
 19086     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19087          MOVE WS-SUB         TO WS-SUB1
 19088          GO TO 6680-EXIT.
 19089
 19090     GO TO 6680-SEARCH-CATEGORY.
 19091
 19092 6680-EXIT.
 19093     EXIT.
 19094
 19095 6690-END-OF-FILE.
 19096     GO TO 6700-COMM-EXIT.
 19097
 19098 6690-ERRESC-PROBLEM.
 19099      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 347
* EL050.cbl
 19100      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19101
 19102      GO TO 6700-COMM-EXIT.
 19103
 19104 6700-COMM-EXIT.
 19105     EXIT.
 19106
 19107 7000-GET-RATE.
 19108
 19109* EXEC CICS LINK
 19110*        PROGRAM    ('ELRATE')
 19111*        COMMAREA   (CALCULATION-PASS-AREA)
 19112*        LENGTH     (CP-COMM-LENGTH)
 19113*    END-EXEC.
 19114     MOVE 'ELRATE' TO DFHEIV1
 19115*    MOVE '."C                   (   #00018888' TO DFHEIV0
 19116     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19118     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19119     CALL 'kxdfhei1' USING DFHEIV0,
 19120           DFHEIV1,
 19121           CALCULATION-PASS-AREA,
 19122           CP-COMM-LENGTH,
 19123           DFHEIV99,
 19124           DFHEIV99,
 19125           DFHEIV99,
 19126           DFHEIV99
 19127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19128
 19129
 19130 7000-EXIT.
 19131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 348
* EL050.cbl
 19133 7100-FIND-BENEFIT-IN-STATE.
 19134     MOVE 'N'                    TO BEN-SEARCH-SW.
 19135
 19136     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19137         VARYING SUB3 FROM 1 BY 1 UNTIL
 19138            ((SUB3 GREATER 50) OR
 19139              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19140               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19141
 19142     IF SUB3 NOT = 51
 19143         MOVE 'Y'                TO BEN-SEARCH-SW.
 19144
 19145     GO TO 7199-EXIT.
 19146
 19147 7100-BENEFIT-DUMMY.
 19148
 19149 7100-DUMMY-EXIT.
 19150     EXIT.
 19151
 19152 7199-EXIT.
 19153     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 349
* EL050.cbl
 19155 7200-FIND-BENEFIT.
 19156     MOVE 'N'                    TO BEN-SEARCH-SW.
 19157
 19158     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19159         VARYING SUB3 FROM 1 BY 1 UNTIL
 19160            ((SUB3 GREATER 8) OR
 19161            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19162
 19163     IF SUB3 NOT = 9
 19164         MOVE 'Y'                TO BEN-SEARCH-SW.
 19165
 19166     GO TO 7200-EXIT.
 19167
 19168 7200-BENEFIT-DUMMY.
 19169
 19170 7200-DUMMY-EXIT.
 19171     EXIT.
 19172
 19173 7200-EXIT.
 19174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 350
* EL050.cbl
 19176 7250-LOOK-FOR-RESCINDED-CLAIM.
 19177     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19178                                    W-CL-COMP-CD.
 19179     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19180                                    W-CL-CERT-NO.
 19181
 19182
 19183* EXEC CICS HANDLE CONDITION
 19184*        NOTFND  (7250-CONTINUE)
 19185*        ENDFILE (7250-CONTINUE)
 19186*    END-EXEC.
 19187*    MOVE '"$I''                  ! ) #00018946' TO DFHEIV0
 19188     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19190     MOVE X'2920233030303138393436' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195
 19196* EXEC CICS IGNORE CONDITION
 19197*        DUPKEY
 19198*    END-EXEC.
 19199*    MOVE '"*$                   !   #00018951' TO DFHEIV0
 19200     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19202     MOVE X'2020233030303138393531' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19205
 19206
 19207
 19208* EXEC CICS STARTBR
 19209*        DATASET   (CLMS-ID)
 19210*        RIDFLD    (ELMSTR-KEY)
 19211*        GENERIC   EQUAL
 19212*        KEYLENGTH (ELMSTR-LENGTH)
 19213*    END-EXEC.
 19214     MOVE 0
 19215       TO DFHEIV11
 19216*    MOVE '&,   KG    E          &   #00018955' TO DFHEIV0
 19217     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19219     MOVE X'2020233030303138393535' TO DFHEIV0(25:11)
 19220     CALL 'kxdfhei1' USING DFHEIV0,
 19221           CLMS-ID,
 19222           ELMSTR-KEY,
 19223           ELMSTR-LENGTH,
 19224           DFHEIV11,
 19225           DFHEIV99
 19226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19227
 19228
 19229     MOVE 'Y'                    TO W-BROWSE-SW.
 19230
 19231 7250-NEXT-CLAIM.
 19232
 19233
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 351
* EL050.cbl
 19234* EXEC CICS READNEXT
 19235*        DATASET   (CLMS-ID)
 19236*        RIDFLD    (ELMSTR-KEY)
 19237*        SET       (ADDRESS OF CLAIM-MASTER)
 19238*    END-EXEC.
 19239     MOVE 0
 19240       TO DFHEIV11
 19241*    MOVE '&.S                   )   #00018966' TO DFHEIV0
 19242     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19244     MOVE X'2020233030303138393636' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0,
 19246           CLMS-ID,
 19247           DFHEIV20,
 19248           DFHEIV99,
 19249           ELMSTR-KEY,
 19250           DFHEIV99,
 19251           DFHEIV11,
 19252           DFHEIV99,
 19253           DFHEIV99
 19254     SET ADDRESS OF CLAIM-MASTER TO
 19255         DFHEIV20
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19260        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19261         GO TO 7250-CONTINUE
 19262     END-IF.
 19263
 19264     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19265        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19266        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19267        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19268        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19269         GO TO 7250-NEXT-CLAIM
 19270     END-IF.
 19271
 19272     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19273        OR (CL-CLAIM-TYPE = 'I')
 19274        OR (CL-CLAIM-TYPE = 'G')
 19275        OR (CL-CLAIM-TYPE = 'F')
 19276          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19277              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19278              GO TO 7250-CONTINUE
 19279          END-IF
 19280     END-IF.
 19281
 19282     GO TO 7250-NEXT-CLAIM.
 19283
 19284 7250-CONTINUE.
 19285
 19286     IF W-BROWSE-SW = 'Y'
 19287
 19288* EXEC CICS ENDBR
 19289*            DATASET   (CLMS-ID)
 19290*        END-EXEC
 19291     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 352
* EL050.cbl
 19292       TO DFHEIV11
 19293*    MOVE '&2                    $   #00019000' TO DFHEIV0
 19294     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303139303030' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           CLMS-ID,
 19299           DFHEIV11,
 19300           DFHEIV99
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19302         MOVE 'N' TO W-BROWSE-SW
 19303     END-IF.
 19304
 19305 7250-EXIT.
 19306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 353
* EL050.cbl
 19308 7300-CHECK-FOR-OPEN-CLMS.
 19309
 19310*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19311*    MOVE SPACES                 TO CNTL-ACCESS.
 19312*    MOVE '1'                    TO CNTL-REC-TYPE.
 19313*    MOVE +0                     TO CNTL-SEQ-NO.
 19314
 19315*    MOVE '3'                    TO RC-SW-1.
 19316*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19317
 19318*    IF NOT CF-COMPANY-MASTER
 19319*         PERFORM 0099-COMPANY-NOT-FOUND
 19320*         GO TO 7300-EXIT.
 19321
 19322     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19323                                    W-CL-COMP-CD.
 19324     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19325                                    W-CL-CERT-NO.
 19326
 19327
 19328* EXEC CICS HANDLE CONDITION
 19329*        NOTFND  (7300-CONTINUE)
 19330*        ENDFILE (7300-CONTINUE)
 19331*    END-EXEC.
 19332*    MOVE '"$I''                  ! * #00019028' TO DFHEIV0
 19333     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19335     MOVE X'2A20233030303139303238' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0
 19337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19338
 19339
 19340
 19341* EXEC CICS IGNORE CONDITION
 19342*        DUPKEY
 19343*    END-EXEC.
 19344*    MOVE '"*$                   !   #00019033' TO DFHEIV0
 19345     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19347     MOVE X'2020233030303139303333' TO DFHEIV0(25:11)
 19348     CALL 'kxdfhei1' USING DFHEIV0
 19349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19350
 19351
 19352
 19353* EXEC CICS STARTBR
 19354*        DATASET   (CLMS-ID)
 19355*        RIDFLD    (ELMSTR-KEY)
 19356*        GENERIC   EQUAL
 19357*        KEYLENGTH (ELMSTR-LENGTH)
 19358*    END-EXEC.
 19359     MOVE 0
 19360       TO DFHEIV11
 19361*    MOVE '&,   KG    E          &   #00019037' TO DFHEIV0
 19362     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19363     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19364     MOVE X'2020233030303139303337' TO DFHEIV0(25:11)
 19365     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 354
* EL050.cbl
 19366           CLMS-ID,
 19367           ELMSTR-KEY,
 19368           ELMSTR-LENGTH,
 19369           DFHEIV11,
 19370           DFHEIV99
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
 19374     MOVE 'Y'                    TO W-BROWSE-SW.
 19375
 19376 7300-NEXT-CLAIM.
 19377
 19378
 19379* EXEC CICS READNEXT
 19380*        DATASET   (CLMS-ID)
 19381*        RIDFLD    (ELMSTR-KEY)
 19382*        SET       (ADDRESS OF CLAIM-MASTER)
 19383*    END-EXEC.
 19384     MOVE 0
 19385       TO DFHEIV11
 19386*    MOVE '&.S                   )   #00019048' TO DFHEIV0
 19387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19389     MOVE X'2020233030303139303438' TO DFHEIV0(25:11)
 19390     CALL 'kxdfhei1' USING DFHEIV0,
 19391           CLMS-ID,
 19392           DFHEIV20,
 19393           DFHEIV99,
 19394           ELMSTR-KEY,
 19395           DFHEIV99,
 19396           DFHEIV11,
 19397           DFHEIV99,
 19398           DFHEIV99
 19399     SET ADDRESS OF CLAIM-MASTER TO
 19400         DFHEIV20
 19401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19402
 19403
 19404     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19405        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19406         GO TO 7300-CONTINUE.
 19407
 19408     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19409        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19410        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19411        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19412        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19413         GO TO 7300-NEXT-CLAIM.
 19414
 19415*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19416     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19417        OR (CL-CLAIM-TYPE = 'I')
 19418        OR (CL-CLAIM-TYPE = 'G')
 19419        OR (CL-CLAIM-TYPE = 'F')
 19420        IF CLAIM-IS-OPEN
 19421           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19422             AND PB-C-AH-CANCEL-DT > SPACES
 19423              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 355
* EL050.cbl
 19424              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19425           END-IF
 19426           EVALUATE TRUE
 19427             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19428                 MOVE ER-2884      TO WS-ERROR
 19429             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19430                 MOVE ER-2887      TO WS-ERROR
 19431             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19432                 MOVE ER-2886      TO WS-ERROR
 19433             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19434                 MOVE ER-2888      TO WS-ERROR
 19435             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19436                 MOVE ER-2885      TO WS-ERROR
 19437             WHEN OTHER
 19438                 MOVE ER-2768      TO WS-ERROR
 19439           END-EVALUATE
 19440           IF PB-C-AH-CANCEL-VOIDED OR
 19441              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19442                NOT AH-COVERAGE-CANCELLED)
 19443               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19444               MOVE ER-2768      TO WS-ERROR
 19445           END-IF
 19446           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19447           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19448              PB-FORCE-CODE NOT EQUAL '8'
 19449               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19450           END-IF
 19451           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19452           GO TO 7300-NEXT-CLAIM
 19453        ELSE
 19454           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19455*****THIS IS A RESCISSION OR REFORMATION
 19456              IF AH-COVERAGE-CANCELLED
 19457                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19458                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19459                    MOVE 1                   TO DC-ELAPSED-DAYS
 19460                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19461                    SET BIN-PLUS-ELAPSED     TO TRUE
 19462                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19463                    IF NO-CONVERSION-ERROR
 19464                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19465                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19466                          MOVE ER-2897 TO WS-ERROR
 19467                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19468                          GO TO 7300-NEXT-CLAIM
 19469                       END-IF
 19470                    END-IF
 19471                 ELSE
 19472                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19473                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19474                         MOVE ER-2890 TO WS-ERROR
 19475                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19476                         GO TO 7300-NEXT-CLAIM
 19477                      ELSE
 19478                         MOVE ER-2898 TO WS-ERROR
 19479                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19480                         GO TO 7300-NEXT-CLAIM
 19481                      END-IF
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 356
* EL050.cbl
 19482                   END-IF
 19483                 END-IF
 19484              END-IF
 19485           ELSE
 19486              IF CL-DENIAL-TYPE = '1'  AND
 19487                 CL-TOTAL-PAID-AMT = 0
 19488                    GO TO 7300-NEXT-CLAIM
 19489              END-IF
 19490              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19491               AND PB-C-AH-CANCEL-DT > SPACES
 19492                 MOVE ER-2756        TO WS-ERROR
 19493                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19494                 GO TO 7300-NEXT-CLAIM
 19495              END-IF
 19496           END-IF
 19497        END-IF
 19498     ELSE
 19499*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19500        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19501           IF (CLAIM-IS-OPEN)
 19502              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19503                 <> zeros
 19504              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19505                 <> zeros)
 19506              MOVE ER-2889      TO WS-ERROR
 19507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19508              GO TO 7300-NEXT-CLAIM
 19509           ELSE
 19510              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19511*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19512                 IF (LF-COVERAGE-CANCELLED AND
 19513                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19514                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19515                         MOVE ER-2890 TO WS-ERROR
 19516                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19517                         GO TO 7300-NEXT-CLAIM
 19518                      ELSE
 19519                         MOVE ER-2898 TO WS-ERROR
 19520                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19521                         GO TO 7300-NEXT-CLAIM
 19522                      END-IF
 19523                 END-IF
 19524              ELSE
 19525                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19526                    and (CL-TOTAL-PAID-AMT = 0)
 19527                    GO TO 7300-NEXT-CLAIM
 19528                 END-IF
 19529                 IF (
 19530                      (AH-COVERAGE-CANCELLED)
 19531                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19532                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19533                      and (pb-ci-ah-cancel-amt +
 19534                         pb-c-ah-cancel-amt) <> zeros
 19535                    )
 19536                               OR
 19537                    (
 19538                      (LF-COVERAGE-CANCELLED)
 19539                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 357
* EL050.cbl
 19540                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19541                      and (pb-ci-lf-cancel-amt +
 19542                         pb-c-lf-cancel-amt) <> zeros
 19543                    )
 19544                       MOVE ER-2965 TO WS-ERROR
 19545                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19546                       GO TO 7300-NEXT-CLAIM
 19547                 END-IF
 19548                 IF LF-COVERAGE-CANCELLED
 19549                  IF CL-TOTAL-PAID-AMT > 0
 19550                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19551                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19552                        MOVE ER-2891 TO WS-ERROR
 19553                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19554                        GO TO 7300-NEXT-CLAIM
 19555                      END-IF
 19556                    ELSE
 19557****only show this error if cert num matches exactly
 19558                      IF PB-CERT-NO = CL-CERT-NO
 19559                         MOVE ER-2892 TO WS-ERROR
 19560                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19561                         GO TO 7300-NEXT-CLAIM
 19562                      END-IF
 19563                    END-IF
 19564                  END-IF
 19565                 END-IF
 19566              END-IF
 19567           END-IF
 19568        END-IF
 19569     END-IF
 19570
 19571     GO TO 7300-NEXT-CLAIM.
 19572
 19573 7300-CONTINUE.
 19574
 19575     IF W-BROWSE-SW = 'Y'
 19576
 19577* EXEC CICS ENDBR
 19578*            DATASET   (CLMS-ID)
 19579*        END-EXEC.
 19580     MOVE 0
 19581       TO DFHEIV11
 19582*    MOVE '&2                    $   #00019226' TO DFHEIV0
 19583     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19585     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0,
 19587           CLMS-ID,
 19588           DFHEIV11,
 19589           DFHEIV99
 19590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19591
 19592
 19593 7300-EXIT.
 19594     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 358
* EL050.cbl
 19596
 19597 7400-GET-REMAIN-TERM.
 19598
 19599* EXEC CICS LINK
 19600*        PROGRAM    ('ELRTRM')
 19601*        COMMAREA   (CALCULATION-PASS-AREA)
 19602*        LENGTH     (CP-COMM-LENGTH)
 19603*    END-EXEC.
 19604     MOVE 'ELRTRM' TO DFHEIV1
 19605*    MOVE '."C                   (   #00019235' TO DFHEIV0
 19606     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19608     MOVE X'2020233030303139323335' TO DFHEIV0(25:11)
 19609     CALL 'kxdfhei1' USING DFHEIV0,
 19610           DFHEIV1,
 19611           CALCULATION-PASS-AREA,
 19612           CP-COMM-LENGTH,
 19613           DFHEIV99,
 19614           DFHEIV99,
 19615           DFHEIV99,
 19616           DFHEIV99
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19618
 19619
 19620 7400-EXIT.
 19621     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 359
* EL050.cbl
 19623
 19624 7500-GET-REMAIN-AMOUNT.
 19625
 19626* EXEC CICS LINK
 19627*        PROGRAM    ('ELRAMT')
 19628*        COMMAREA   (CALCULATION-PASS-AREA)
 19629*        LENGTH     (CP-COMM-LENGTH)
 19630*    END-EXEC.
 19631     MOVE 'ELRAMT' TO DFHEIV1
 19632*    MOVE '."C                   (   #00019246' TO DFHEIV0
 19633     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19635     MOVE X'2020233030303139323436' TO DFHEIV0(25:11)
 19636     CALL 'kxdfhei1' USING DFHEIV0,
 19637           DFHEIV1,
 19638           CALCULATION-PASS-AREA,
 19639           CP-COMM-LENGTH,
 19640           DFHEIV99,
 19641           DFHEIV99,
 19642           DFHEIV99,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647 7500-EXIT.
 19648     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 360
* EL050.cbl
 19650
 19651 7600-GET-REFUND.
 19652
 19653* EXEC CICS LINK
 19654*        PROGRAM    ('ELRFND')
 19655*        COMMAREA   (CALCULATION-PASS-AREA)
 19656*        LENGTH     (CP-COMM-LENGTH)
 19657*    END-EXEC.
 19658     MOVE 'ELRFND' TO DFHEIV1
 19659*    MOVE '."C                   (   #00019257' TO DFHEIV0
 19660     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19661     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19662     MOVE X'2020233030303139323537' TO DFHEIV0(25:11)
 19663     CALL 'kxdfhei1' USING DFHEIV0,
 19664           DFHEIV1,
 19665           CALCULATION-PASS-AREA,
 19666           CP-COMM-LENGTH,
 19667           DFHEIV99,
 19668           DFHEIV99,
 19669           DFHEIV99,
 19670           DFHEIV99
 19671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19672
 19673
 19674 7600-EXIT.
 19675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 361
* EL050.cbl
 19677 7700-CALL-DL1.
 19678
 19679* EXEC CICS LINK
 19680*        PROGRAM    ('DLO001')
 19681*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19682*        LENGTH     (DLO001-COMM-LENGTH)
 19683*    END-EXEC.
 19684     MOVE 'DLO001' TO DFHEIV1
 19685*    MOVE '."C                   (   #00019267' TO DFHEIV0
 19686     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19688     MOVE X'2020233030303139323637' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0,
 19690           DFHEIV1,
 19691           WS-DLO-MASTER-POLICY-FORM,
 19692           DLO001-COMM-LENGTH,
 19693           DFHEIV99,
 19694           DFHEIV99,
 19695           DFHEIV99,
 19696           DFHEIV99
 19697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19698
 19699
 19700 7700-EXIT.
 19701     EXIT.
 19702
 19703 7710-CALL-DL2.
 19704
 19705* EXEC CICS LINK
 19706*        PROGRAM    ('DLO002')
 19707*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19708*        LENGTH     (DLO002-COMM-LENGTH)
 19709*    END-EXEC.
 19710     MOVE 'DLO002' TO DFHEIV1
 19711*    MOVE '."C                   (   #00019277' TO DFHEIV0
 19712     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19714     MOVE X'2020233030303139323737' TO DFHEIV0(25:11)
 19715     CALL 'kxdfhei1' USING DFHEIV0,
 19716           DFHEIV1,
 19717           WS-DLO-INTERNAL-POLICY-FORM,
 19718           DLO002-COMM-LENGTH,
 19719           DFHEIV99,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99
 19723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19724
 19725
 19726 7710-EXIT.
 19727     EXIT.
 19728
 19729 7720-CALL-DL3.
 19730
 19731* EXEC CICS LINK
 19732*        PROGRAM    ('DLO003')
 19733*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19734*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 362
* EL050.cbl
 19735*    END-EXEC.
 19736     MOVE 'DLO003' TO DFHEIV1
 19737*    MOVE '."C                   (   #00019287' TO DFHEIV0
 19738     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19740     MOVE X'2020233030303139323837' TO DFHEIV0(25:11)
 19741     CALL 'kxdfhei1' USING DFHEIV0,
 19742           DFHEIV1,
 19743           WS-DLO-VALID-BANK-ID,
 19744           DLO003-COMM-LENGTH,
 19745           DFHEIV99,
 19746           DFHEIV99,
 19747           DFHEIV99,
 19748           DFHEIV99
 19749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19750
 19751
 19752 7720-EXIT.
 19753     EXIT.
 19754
 19755 7730-CALL-DL7.
 19756
 19757* EXEC CICS LINK
 19758*        PROGRAM    ('DLO007')
 19759*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19760*        LENGTH     (DLO007-COMM-LENGTH)
 19761*    END-EXEC.
 19762     MOVE 'DLO007' TO DFHEIV1
 19763*    MOVE '."C                   (   #00019297' TO DFHEIV0
 19764     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19766     MOVE X'2020233030303139323937' TO DFHEIV0(25:11)
 19767     CALL 'kxdfhei1' USING DFHEIV0,
 19768           DFHEIV1,
 19769           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19770           DLO007-COMM-LENGTH,
 19771           DFHEIV99,
 19772           DFHEIV99,
 19773           DFHEIV99,
 19774           DFHEIV99
 19775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19776
 19777
 19778 7730-EXIT.
 19779     EXIT.
 19780
 19781 7740-CALL-DL11.
 19782
 19783* EXEC CICS LINK
 19784*        PROGRAM    ('DLO011')
 19785*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19786*        LENGTH     (DLO011-COMM-LENGTH)
 19787*    END-EXEC.
 19788     MOVE 'DLO011' TO DFHEIV1
 19789*    MOVE '."C                   (   #00019307' TO DFHEIV0
 19790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19792     MOVE X'2020233030303139333037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 363
* EL050.cbl
 19793     CALL 'kxdfhei1' USING DFHEIV0,
 19794           DFHEIV1,
 19795           WS-DLO-PREM-RATES-BEN-TYPE,
 19796           DLO011-COMM-LENGTH,
 19797           DFHEIV99,
 19798           DFHEIV99,
 19799           DFHEIV99,
 19800           DFHEIV99
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19802
 19803
 19804 7740-EXIT.
 19805     EXIT.
 19806
 19807 7750-CALL-DL17.
 19808
 19809* EXEC CICS LINK
 19810*        PROGRAM    ('DLO017')
 19811*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19812*        LENGTH     (DLO017-COMM-LENGTH)
 19813*    END-EXEC.
 19814     MOVE 'DLO017' TO DFHEIV1
 19815*    MOVE '."C                   (   #00019317' TO DFHEIV0
 19816     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19818     MOVE X'2020233030303139333137' TO DFHEIV0(25:11)
 19819     CALL 'kxdfhei1' USING DFHEIV0,
 19820           DFHEIV1,
 19821           WS-DLO-VALID-RATE-CODE,
 19822           DLO017-COMM-LENGTH,
 19823           DFHEIV99,
 19824           DFHEIV99,
 19825           DFHEIV99,
 19826           DFHEIV99
 19827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19828
 19829
 19830 7750-EXIT.
 19831     EXIT.
 19832
 19833 7755-CALL-DL19.
 19834
 19835* EXEC CICS LINK
 19836*        PROGRAM    ('DLO019')
 19837*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19838*        LENGTH     (DLO019-COMM-LENGTH)
 19839*    END-EXEC.
 19840     MOVE 'DLO019' TO DFHEIV1
 19841*    MOVE '."C                   (   #00019327' TO DFHEIV0
 19842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19844     MOVE X'2020233030303139333237' TO DFHEIV0(25:11)
 19845     CALL 'kxdfhei1' USING DFHEIV0,
 19846           DFHEIV1,
 19847           WS-DLO-ORIG-COV-CAT,
 19848           DLO019-COMM-LENGTH,
 19849           DFHEIV99,
 19850           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 364
* EL050.cbl
 19851           DFHEIV99,
 19852           DFHEIV99
 19853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19854
 19855
 19856 7755-EXIT.
 19857     EXIT.
 19858
 19859 7760-CALL-DL21.
 19860
 19861* EXEC CICS LINK
 19862*        PROGRAM    ('DLO021')
 19863*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19864*        LENGTH     (DLO021-COMM-LENGTH)
 19865*    END-EXEC.
 19866     MOVE 'DLO021' TO DFHEIV1
 19867*    MOVE '."C                   (   #00019337' TO DFHEIV0
 19868     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19869     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19870     MOVE X'2020233030303139333337' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0,
 19872           DFHEIV1,
 19873           WS-DLO-VALID-LOAN-OFFICER,
 19874           DLO021-COMM-LENGTH,
 19875           DFHEIV99,
 19876           DFHEIV99,
 19877           DFHEIV99,
 19878           DFHEIV99
 19879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19880
 19881
 19882 7760-EXIT.
 19883     EXIT.
 19884
 19885 7770-CALL-DL22.
 19886
 19887* EXEC CICS LINK
 19888*        PROGRAM    ('DLO022')
 19889*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19890*        LENGTH     (DLO022-COMM-LENGTH)
 19891*    END-EXEC.
 19892     MOVE 'DLO022' TO DFHEIV1
 19893*    MOVE '."C                   (   #00019347' TO DFHEIV0
 19894     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303139333437' TO DFHEIV0(25:11)
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           DFHEIV1,
 19899           WS-DLO-VALID-STATE-CODE,
 19900           DLO022-COMM-LENGTH,
 19901           DFHEIV99,
 19902           DFHEIV99,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19906
 19907
 19908 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 365
* EL050.cbl
 19909     EXIT.
 19910
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 366
* EL050.cbl
 19912
 19913 7780-CALL-AGG.
 19914
 19915* EXEC CICS LINK
 19916*        PROGRAM    ('ELAGGO')
 19917*        COMMAREA   (WS-PASS-to-pemaggo)
 19918*        LENGTH     (ws-passed-key-LENGTH)
 19919*    END-EXEC.
 19920     MOVE 'ELAGGO' TO DFHEIV1
 19921*    MOVE '."C                   (   #00019359' TO DFHEIV0
 19922     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19924     MOVE X'2020233030303139333539' TO DFHEIV0(25:11)
 19925     CALL 'kxdfhei1' USING DFHEIV0,
 19926           DFHEIV1,
 19927           WS-PASS-to-pemaggo,
 19928           ws-passed-key-LENGTH,
 19929           DFHEIV99,
 19930           DFHEIV99,
 19931           DFHEIV99,
 19932           DFHEIV99
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935 7780-EXIT.
 19936     EXIT.
 19937 7785-CALL-HLDI.
 19938
 19939* EXEC CICS LINK
 19940*        PROGRAM    ('ELHLDI')
 19941*        COMMAREA   (HLDI-PASS-AREA)
 19942*        LENGTH     (HLDI-PASS-AREA-LEN)
 19943*    END-EXEC.
 19944     MOVE 'ELHLDI' TO DFHEIV1
 19945*    MOVE '."C                   (   #00019367' TO DFHEIV0
 19946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303139333637' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           DFHEIV1,
 19951           HLDI-PASS-AREA,
 19952           HLDI-PASS-AREA-LEN,
 19953           DFHEIV99,
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959 7785-EXIT.
 19960     EXIT.
 19961 7786-CALL-HLDIM.
 19962
 19963* EXEC CICS LINK
 19964*        PROGRAM    ('ELHLDIM')
 19965*        COMMAREA   (HLDI-PASS-AREA)
 19966*        LENGTH     (HLDI-PASS-AREA-LEN)
 19967*    END-EXEC.
 19968     MOVE 'ELHLDIM' TO DFHEIV1
 19969*    MOVE '."C                   (   #00019375' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 367
* EL050.cbl
 19970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19972     MOVE X'2020233030303139333735' TO DFHEIV0(25:11)
 19973     CALL 'kxdfhei1' USING DFHEIV0,
 19974           DFHEIV1,
 19975           HLDI-PASS-AREA,
 19976           HLDI-PASS-AREA-LEN,
 19977           DFHEIV99,
 19978           DFHEIV99,
 19979           DFHEIV99,
 19980           DFHEIV99
 19981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19982
 19983 7786-EXIT.
 19984     EXIT.
 19985 7800-REWRITE-CERT.
 19986******************************************************************
 19987*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19988*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19989******************************************************************
 19990
 19991     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19992        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19993        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19994        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19995
 19996* EXEC CICS REWRITE
 19997*                  DATASET (CERT-ID)
 19998*                  FROM    (CERTIFICATE-MASTER)
 19999*              END-EXEC
 20000     MOVE LENGTH OF
 20001      CERTIFICATE-MASTER
 20002       TO DFHEIV11
 20003*    MOVE '&& L                  %   #00019392' TO DFHEIV0
 20004     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20006     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 20007     CALL 'kxdfhei1' USING DFHEIV0,
 20008           CERT-ID,
 20009           CERTIFICATE-MASTER,
 20010           DFHEIV11,
 20011           DFHEIV99
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20013        GO TO 7800-EXIT.
 20014
 20015       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20016       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20017
 20018 7800-EXIT.
 20019      EXIT.
 20020
 20021 7900-DELETE-CERT.
 20022
 20023* EXEC CICS DELETE
 20024*        DATASET (CERT-ID)
 20025*    END-EXEC.
 20026*    MOVE '&(                    &   #00019405' TO DFHEIV0
 20027     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 368
* EL050.cbl
 20028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20029     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 20030     CALL 'kxdfhei1' USING DFHEIV0,
 20031           CERT-ID,
 20032           DFHEIV99,
 20033           DFHEIV99,
 20034           DFHEIV99,
 20035           DFHEIV99
 20036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20037
 20038
 20039 7900-EXIT.
 20040     EXIT.
 20041
 20042 8000-WRITE-CERT.
 20043
 20044* EXEC CICS HANDLE CONDITION
 20045*        DUPKEY    (8000-FREE-MAIN)
 20046*    END-EXEC.
 20047*    MOVE '"$$                   ! + #00019413' TO DFHEIV0
 20048     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20050     MOVE X'2B20233030303139343133' TO DFHEIV0(25:11)
 20051     CALL 'kxdfhei1' USING DFHEIV0
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055
 20056* EXEC CICS WRITE
 20057*        DATASET     (CERT-ID)
 20058*        FROM        (CERTIFICATE-MASTER)
 20059*        RIDFLD      (ELCERT-KEY)
 20060*    END-EXEC.
 20061     MOVE LENGTH OF
 20062      CERTIFICATE-MASTER
 20063       TO DFHEIV11
 20064*    MOVE '&$ L                  ''   #00019417' TO DFHEIV0
 20065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20067     MOVE X'2020233030303139343137' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0,
 20069           CERT-ID,
 20070           CERTIFICATE-MASTER,
 20071           DFHEIV11,
 20072           ELCERT-KEY,
 20073           DFHEIV99,
 20074           DFHEIV99
 20075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20076
 20077
 20078 8000-FREE-MAIN.
 20079
 20080 8000-EXIT.
 20081      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 369
* EL050.cbl
 20083
 20084 8100-READ-ERPNDM.
 20085
 20086* EXEC CICS HANDLE CONDITION
 20087*         NOTFND     (8100-NOTFND)
 20088*         ENDFILE    (8100-NOTFND)
 20089*    END-EXEC.
 20090*    MOVE '"$I''                  ! , #00019430' TO DFHEIV0
 20091     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20093     MOVE X'2C20233030303139343330' TO DFHEIV0(25:11)
 20094     CALL 'kxdfhei1' USING DFHEIV0
 20095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20096
 20097
 20098     MOVE SPACES                 TO ERPNDM-FOUND.
 20099     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20100
 20101
 20102* EXEC CICS READ
 20103*         DATASET   (FILE-ERPNDM)
 20104*         RIDFLD    (PM-CONTROL-PRIMARY)
 20105*         INTO      (PENDING-MAILING-DATA)
 20106*    END-EXEC.
 20107     MOVE LENGTH OF
 20108      PENDING-MAILING-DATA
 20109       TO DFHEIV11
 20110*    MOVE '&"IL       E          (   #00019438' TO DFHEIV0
 20111     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139343338' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           FILE-ERPNDM,
 20116           PENDING-MAILING-DATA,
 20117           DFHEIV11,
 20118           PM-CONTROL-PRIMARY,
 20119           DFHEIV99,
 20120           DFHEIV99,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20123
 20124
 20125     GO TO 8100-EXIT.
 20126
 20127 8100-NOTFND.
 20128
 20129     MOVE 'X'                    TO ERPNDM-FOUND.
 20130     MOVE ER-2694                TO WS-ERROR.
 20131     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20132     MOVE ER-2883                TO WS-ERROR
 20133     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20134     .
 20135 8100-EXIT.
 20136     EXIT.
 20137
 20138 8110-READ-ERMAIL.
 20139
 20140* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 370
* EL050.cbl
 20141*         NOTFND     (8110-NOTFND)
 20142*         ENDFILE    (8110-NOTFND)
 20143*    END-EXEC.
 20144*    MOVE '"$I''                  ! - #00019458' TO DFHEIV0
 20145     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20147     MOVE X'2D20233030303139343538' TO DFHEIV0(25:11)
 20148     CALL 'kxdfhei1' USING DFHEIV0
 20149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20150
 20151
 20152     MOVE SPACES                 TO ERMAIL-FOUND.
 20153     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20154     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20155     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20156     MOVE PB-SV-STATE            TO MA-STATE.
 20157
 20158
 20159* EXEC CICS READ
 20160*         UPDATE
 20161*         DATASET   (FILE-ERMAIL)
 20162*         RIDFLD    (MA-CONTROL-PRIMARY)
 20163*         INTO      (MAILING-DATA)
 20164*    END-EXEC.
 20165     MOVE LENGTH OF
 20166      MAILING-DATA
 20167       TO DFHEIV11
 20168*    MOVE '&"IL       EU         (   #00019469' TO DFHEIV0
 20169     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20170     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20171     MOVE X'2020233030303139343639' TO DFHEIV0(25:11)
 20172     CALL 'kxdfhei1' USING DFHEIV0,
 20173           FILE-ERMAIL,
 20174           MAILING-DATA,
 20175           DFHEIV11,
 20176           MA-CONTROL-PRIMARY,
 20177           DFHEIV99,
 20178           DFHEIV99,
 20179           DFHEIV99
 20180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20181
 20182
 20183     GO TO 8110-EXIT.
 20184
 20185 8110-NOTFND.
 20186     MOVE 'X'                    TO ERMAIL-FOUND.
 20187
 20188 8110-EXIT.
 20189     EXIT.
 20190
 20191 8120-REWRITE-ERMAIL.
 20192
 20193* EXEC CICS REWRITE
 20194*         DATASET    (FILE-ERMAIL)
 20195*         FROM       (MAILING-DATA)
 20196*    END-EXEC.
 20197     MOVE LENGTH OF
 20198      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 371
* EL050.cbl
 20199       TO DFHEIV11
 20200*    MOVE '&& L                  %   #00019485' TO DFHEIV0
 20201     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20202     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20203     MOVE X'2020233030303139343835' TO DFHEIV0(25:11)
 20204     CALL 'kxdfhei1' USING DFHEIV0,
 20205           FILE-ERMAIL,
 20206           MAILING-DATA,
 20207           DFHEIV11,
 20208           DFHEIV99
 20209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20210
 20211
 20212 8120-EXIT.
 20213     EXIT.
 20214
 20215 8130-WRITE-ERMAIL.
 20216
 20217* EXEC CICS HANDLE CONDITION
 20218*         DUPKEY   (8130-EXIT)
 20219*    END-EXEC.
 20220*    MOVE '"$$                   ! . #00019494' TO DFHEIV0
 20221     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20223     MOVE X'2E20233030303139343934' TO DFHEIV0(25:11)
 20224     CALL 'kxdfhei1' USING DFHEIV0
 20225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20226
 20227
 20228
 20229* EXEC CICS WRITE
 20230*         DATASET     (FILE-ERMAIL)
 20231*         RIDFLD      (MA-CONTROL-PRIMARY)
 20232*         FROM        (MAILING-DATA)
 20233*    END-EXEC.
 20234     MOVE LENGTH OF
 20235      MAILING-DATA
 20236       TO DFHEIV11
 20237*    MOVE '&$ L                  ''   #00019498' TO DFHEIV0
 20238     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20240     MOVE X'2020233030303139343938' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0,
 20242           FILE-ERMAIL,
 20243           MAILING-DATA,
 20244           DFHEIV11,
 20245           MA-CONTROL-PRIMARY,
 20246           DFHEIV99,
 20247           DFHEIV99
 20248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20249
 20250
 20251 8130-EXIT.
 20252     EXIT.
 20253
 20254 8140-UNLOCK-ERMAIL.
 20255
 20256* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 372
* EL050.cbl
 20257*         DATASET   (FILE-ERMAIL)
 20258*    END-EXEC.
 20259*    MOVE '&*                    #   #00019508' TO DFHEIV0
 20260     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20262     MOVE X'2020233030303139353038' TO DFHEIV0(25:11)
 20263     CALL 'kxdfhei1' USING DFHEIV0,
 20264           FILE-ERMAIL,
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269 8140-EXIT.
 20270     EXIT.
 20271
 20272 8150-read-elcrtt.
 20273
 20274
 20275* EXEC CICS HANDLE CONDITION
 20276*        NOTFND   (8150-exit)
 20277*    END-EXEC
 20278*    MOVE '"$I                   ! / #00019517' TO DFHEIV0
 20279     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20281     MOVE X'2F20233030303139353137' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0
 20283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20284
 20285     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20286     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20287
 20288
 20289* EXEC CICS READ
 20290*        DATASET  (CRTT-ID)
 20291*        RIDFLD   (WS-ELCRTT-KEY)
 20292*        INTO     (CERTIFICATE-TRAILERS)
 20293*    END-EXEC
 20294     MOVE LENGTH OF
 20295      CERTIFICATE-TRAILERS
 20296       TO DFHEIV11
 20297*    MOVE '&"IL       E          (   #00019524' TO DFHEIV0
 20298     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20300     MOVE X'2020233030303139353234' TO DFHEIV0(25:11)
 20301     CALL 'kxdfhei1' USING DFHEIV0,
 20302           CRTT-ID,
 20303           CERTIFICATE-TRAILERS,
 20304           DFHEIV11,
 20305           WS-ELCRTT-KEY,
 20306           DFHEIV99,
 20307           DFHEIV99,
 20308           DFHEIV99
 20309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20310
 20311     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20312     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20313     move cs-vehicle-odometer    to ws-vehicle-odometer
 20314
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 373
* EL050.cbl
 20315     .
 20316 8150-exit.
 20317     exit.
 20318 8180-UPDATE-VIN-NUMBER.
 20319
 20320* EXEC CICS HANDLE CONDITION
 20321*        NOTFND   (8180-NOTFND)
 20322*    END-EXEC.
 20323*    MOVE '"$I                   ! 0 #00019538' TO DFHEIV0
 20324     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20326     MOVE X'3020233030303139353338' TO DFHEIV0(25:11)
 20327     CALL 'kxdfhei1' USING DFHEIV0
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20332     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20333
 20334
 20335* EXEC CICS READ
 20336*        UPDATE
 20337*        DATASET  (CRTT-ID)
 20338*        RIDFLD   (WS-ELCRTT-KEY)
 20339*        INTO     (CERTIFICATE-TRAILERS)
 20340*    END-EXEC.
 20341     MOVE LENGTH OF
 20342      CERTIFICATE-TRAILERS
 20343       TO DFHEIV11
 20344*    MOVE '&"IL       EU         (   #00019545' TO DFHEIV0
 20345     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20346     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20347     MOVE X'2020233030303139353435' TO DFHEIV0(25:11)
 20348     CALL 'kxdfhei1' USING DFHEIV0,
 20349           CRTT-ID,
 20350           CERTIFICATE-TRAILERS,
 20351           DFHEIV11,
 20352           WS-ELCRTT-KEY,
 20353           DFHEIV99,
 20354           DFHEIV99,
 20355           DFHEIV99
 20356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20357
 20358
 20359     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20360        or (hldi-pass-area not = spaces)
 20361        move pa-modelyear        to cs-year
 20362        move pa-makename         to cs-make
 20363        move pa-modelname        to cs-model
 20364        move pa-seriesname       to cs-future
 20365        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20366
 20367* EXEC CICS REWRITE
 20368*           DATASET  (CRTT-ID)
 20369*           FROM     (CERTIFICATE-TRAILERS)
 20370*        END-EXEC
 20371     MOVE LENGTH OF
 20372      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 374
* EL050.cbl
 20373       TO DFHEIV11
 20374*    MOVE '&& L                  %   #00019559' TO DFHEIV0
 20375     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303139353539' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           CRTT-ID,
 20380           CERTIFICATE-TRAILERS,
 20381           DFHEIV11,
 20382           DFHEIV99
 20383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20384     ELSE
 20385
 20386* EXEC CICS UNLOCK
 20387*          DATASET  (CRTT-ID)
 20388*       END-EXEC
 20389*    MOVE '&*                    #   #00019564' TO DFHEIV0
 20390     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20391     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20392     MOVE X'2020233030303139353634' TO DFHEIV0(25:11)
 20393     CALL 'kxdfhei1' USING DFHEIV0,
 20394           CRTT-ID,
 20395           DFHEIV99
 20396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20397     END-IF.
 20398
 20399     GO TO 8180-EXIT.
 20400
 20401 8180-NOTFND.
 20402
 20403     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20404     MOVE 'CS'         TO CS-RECORD-ID.
 20405     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20406     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20407     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20408     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20409
 20410* EXEC CICS WRITE
 20411*       DATASET  (CRTT-ID)
 20412*       RIDFLD   (WS-ELCRTT-KEY)
 20413*       FROM     (CERTIFICATE-TRAILERS)
 20414*    END-EXEC.
 20415     MOVE LENGTH OF
 20416      CERTIFICATE-TRAILERS
 20417       TO DFHEIV11
 20418*    MOVE '&$ L                  ''   #00019579' TO DFHEIV0
 20419     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20420     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20421     MOVE X'2020233030303139353739' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0,
 20423           CRTT-ID,
 20424           CERTIFICATE-TRAILERS,
 20425           DFHEIV11,
 20426           WS-ELCRTT-KEY,
 20427           DFHEIV99,
 20428           DFHEIV99
 20429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20430
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 375
* EL050.cbl
 20431
 20432 8180-EXIT.
 20433     EXIT.
 20434
 20435 8190-UPDATE-REFUND-CLAIM-FLAG.
 20436
 20437* EXEC CICS HANDLE CONDITION
 20438*        NOTFND   (8190-NOTFND)
 20439*    END-EXEC.
 20440*    MOVE '"$I                   ! 1 #00019589' TO DFHEIV0
 20441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20443     MOVE X'3120233030303139353839' TO DFHEIV0(25:11)
 20444     CALL 'kxdfhei1' USING DFHEIV0
 20445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20446
 20447
 20448     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20449     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20450
 20451
 20452* EXEC CICS READ
 20453*        UPDATE
 20454*        DATASET  (CRTT-ID)
 20455*        RIDFLD   (WS-ELCRTT-KEY)
 20456*        INTO     (CERTIFICATE-TRAILERS)
 20457*    END-EXEC.
 20458     MOVE LENGTH OF
 20459      CERTIFICATE-TRAILERS
 20460       TO DFHEIV11
 20461*    MOVE '&"IL       EU         (   #00019596' TO DFHEIV0
 20462     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20464     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0,
 20466           CRTT-ID,
 20467           CERTIFICATE-TRAILERS,
 20468           DFHEIV11,
 20469           WS-ELCRTT-KEY,
 20470           DFHEIV99,
 20471           DFHEIV99,
 20472           DFHEIV99
 20473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20474
 20475
 20476     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20477
 20478* EXEC CICS REWRITE
 20479*       DATASET  (CRTT-ID)
 20480*       FROM     (CERTIFICATE-TRAILERS)
 20481*    END-EXEC.
 20482     MOVE LENGTH OF
 20483      CERTIFICATE-TRAILERS
 20484       TO DFHEIV11
 20485*    MOVE '&& L                  %   #00019604' TO DFHEIV0
 20486     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20487     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20488     MOVE X'2020233030303139363034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 376
* EL050.cbl
 20489     CALL 'kxdfhei1' USING DFHEIV0,
 20490           CRTT-ID,
 20491           CERTIFICATE-TRAILERS,
 20492           DFHEIV11,
 20493           DFHEIV99
 20494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20495
 20496
 20497     GO TO 8190-EXIT.
 20498
 20499 8190-NOTFND.
 20500
 20501     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20502     MOVE 'CS'         TO CS-RECORD-ID.
 20503     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20504     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20505     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20506     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20507
 20508* EXEC CICS WRITE
 20509*       DATASET  (CRTT-ID)
 20510*       RIDFLD   (WS-ELCRTT-KEY)
 20511*       FROM     (CERTIFICATE-TRAILERS)
 20512*    END-EXEC.
 20513     MOVE LENGTH OF
 20514      CERTIFICATE-TRAILERS
 20515       TO DFHEIV11
 20516*    MOVE '&$ L                  ''   #00019619' TO DFHEIV0
 20517     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20519     MOVE X'2020233030303139363139' TO DFHEIV0(25:11)
 20520     CALL 'kxdfhei1' USING DFHEIV0,
 20521           CRTT-ID,
 20522           CERTIFICATE-TRAILERS,
 20523           DFHEIV11,
 20524           WS-ELCRTT-KEY,
 20525           DFHEIV99,
 20526           DFHEIV99
 20527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20528
 20529
 20530 8190-EXIT.
 20531     EXIT.
 20532
 20533 8195-UPDATE-AGE-FLAGS.
 20534
 20535* EXEC CICS HANDLE CONDITION
 20536*        NOTFND   (8195-NOTFND)
 20537*    END-EXEC.
 20538*    MOVE '"$I                   ! 2 #00019629' TO DFHEIV0
 20539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20541     MOVE X'3220233030303139363239' TO DFHEIV0(25:11)
 20542     CALL 'kxdfhei1' USING DFHEIV0
 20543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20544
 20545
 20546     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 377
* EL050.cbl
 20547     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20548
 20549
 20550* EXEC CICS READ
 20551*        UPDATE
 20552*        DATASET  (CRTT-ID)
 20553*        RIDFLD   (WS-ELCRTT-KEY)
 20554*        INTO     (CERTIFICATE-TRAILERS)
 20555*    END-EXEC.
 20556     MOVE LENGTH OF
 20557      CERTIFICATE-TRAILERS
 20558       TO DFHEIV11
 20559*    MOVE '&"IL       EU         (   #00019636' TO DFHEIV0
 20560     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20561     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303139363336' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           CRTT-ID,
 20565           CERTIFICATE-TRAILERS,
 20566           DFHEIV11,
 20567           WS-ELCRTT-KEY,
 20568           DFHEIV99,
 20569           DFHEIV99,
 20570           DFHEIV99
 20571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20572
 20573
 20574     IF WS-INS-AGE-SET = 'Y'
 20575        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20576     END-IF
 20577     IF WS-JNT-AGE-SET = 'Y'
 20578        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20579     END-IF
 20580
 20581
 20582* EXEC CICS REWRITE
 20583*       DATASET  (CRTT-ID)
 20584*       FROM     (CERTIFICATE-TRAILERS)
 20585*    END-EXEC.
 20586     MOVE LENGTH OF
 20587      CERTIFICATE-TRAILERS
 20588       TO DFHEIV11
 20589*    MOVE '&& L                  %   #00019650' TO DFHEIV0
 20590     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20592     MOVE X'2020233030303139363530' TO DFHEIV0(25:11)
 20593     CALL 'kxdfhei1' USING DFHEIV0,
 20594           CRTT-ID,
 20595           CERTIFICATE-TRAILERS,
 20596           DFHEIV11,
 20597           DFHEIV99
 20598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20599
 20600
 20601     GO TO 8195-EXIT.
 20602
 20603 8195-NOTFND.
 20604
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 378
* EL050.cbl
 20605     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20606     MOVE 'CS'         TO CS-RECORD-ID.
 20607     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20608     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20609     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20610     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20611     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20612
 20613* EXEC CICS WRITE
 20614*       DATASET  (CRTT-ID)
 20615*       RIDFLD   (WS-ELCRTT-KEY)
 20616*       FROM     (CERTIFICATE-TRAILERS)
 20617*    END-EXEC.
 20618     MOVE LENGTH OF
 20619      CERTIFICATE-TRAILERS
 20620       TO DFHEIV11
 20621*    MOVE '&$ L                  ''   #00019666' TO DFHEIV0
 20622     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20623     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20624     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 20625     CALL 'kxdfhei1' USING DFHEIV0,
 20626           CRTT-ID,
 20627           CERTIFICATE-TRAILERS,
 20628           DFHEIV11,
 20629           WS-ELCRTT-KEY,
 20630           DFHEIV99,
 20631           DFHEIV99
 20632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20633
 20634
 20635 8195-EXIT.
 20636     EXIT.
 20637
 20638 8200-READ-REIN-TABLE.
 20639
 20640* EXEC CICS HANDLE CONDITION
 20641*         NOTFND   (8200-NOTFND)
 20642*    END-EXEC.
 20643*    MOVE '"$I                   ! 3 #00019676' TO DFHEIV0
 20644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20646     MOVE X'3320233030303139363736' TO DFHEIV0(25:11)
 20647     CALL 'kxdfhei1' USING DFHEIV0
 20648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20649
 20650
 20651
 20652* EXEC CICS READ
 20653*        DATASET     (REIN-ID)
 20654*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20655*        RIDFLD      (ERREIN-KEY)
 20656*    END-EXEC.
 20657*    MOVE '&"S        E          (   #00019680' TO DFHEIV0
 20658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20660     MOVE X'2020233030303139363830' TO DFHEIV0(25:11)
 20661     CALL 'kxdfhei1' USING DFHEIV0,
 20662           REIN-ID,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 379
* EL050.cbl
 20663           DFHEIV20,
 20664           DFHEIV99,
 20665           ERREIN-KEY,
 20666           DFHEIV99,
 20667           DFHEIV99,
 20668           DFHEIV99
 20669     SET ADDRESS OF REINSURANCE-RECORD TO
 20670         DFHEIV20
 20671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20672
 20673
 20674     GO TO 8200-EXIT.
 20675
 20676 8200-NOTFND.
 20677     MOVE 'N'             TO WS-REIN-READ-SW.
 20678
 20679 8200-EXIT.
 20680      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 380
* EL050.cbl
 20682
 20683 8300-READ-CTBL-TABLE.
 20684
 20685* EXEC CICS HANDLE CONDITION
 20686*        NOTFND    (8300-NOTFND)
 20687*        DISABLED  (8300-ERRESS-PROBLEM)
 20688*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20689*        ENDFILE   (8300-NOTFND)
 20690*    END-EXEC.
 20691*    MOVE '"$IcJ''                ! 4 #00019696' TO DFHEIV0
 20692     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20694     MOVE X'3420233030303139363936' TO DFHEIV0(25:11)
 20695     CALL 'kxdfhei1' USING DFHEIV0
 20696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20697
 20698
 20699
 20700* EXEC CICS READ
 20701*        DATASET     (CTBL-ID)
 20702*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20703*        RIDFLD      (ERCTBL-KEY)
 20704*    END-EXEC.
 20705*    MOVE '&"S        E          (   #00019703' TO DFHEIV0
 20706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20708     MOVE X'2020233030303139373033' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           CTBL-ID,
 20711           DFHEIV20,
 20712           DFHEIV99,
 20713           ERCTBL-KEY,
 20714           DFHEIV99,
 20715           DFHEIV99,
 20716           DFHEIV99
 20717     SET ADDRESS OF COMM-TABLE-RECORD TO
 20718         DFHEIV20
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20723
 20724     GO TO 8300-EXIT.
 20725
 20726 8300-NOTFND.
 20727
 20728     IF CTBL-SW = '0530'
 20729         MOVE 'AA'                     TO WS-AH-COMP-CD
 20730         MOVE '0550'                   TO CTBL-SW
 20731         MOVE '1'                      TO WS-CTBL-READ-SW
 20732         GO TO 8300-EXIT.
 20733
 20734     IF CTBL-SW = '0540'
 20735         MOVE 'AA'                     TO WS-LF-COMP-CD
 20736         MOVE '0550'                   TO CTBL-SW
 20737         MOVE '1'                      TO WS-CTBL-READ-SW
 20738         GO TO 8300-EXIT.
 20739
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 381
* EL050.cbl
 20740     IF CTBL-SW = '0550'
 20741         MOVE '2'                      TO WS-CTBL-READ-SW
 20742         GO TO 8300-EXIT.
 20743
 20744     GO TO 8300-EXIT.
 20745
 20746 8300-ERRESS-PROBLEM.
 20747
 20748      MOVE ER-8050              TO WS-ERROR.
 20749      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20750
 20751     GO TO 8300-EXIT.
 20752
 20753 8300-EXIT.
 20754      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 382
* EL050.cbl
 20756
 20757
 20758 8400-GETMAIN-ERFORM.
 20759
 20760
 20761* EXEC CICS   GETMAIN
 20762*        LENGTH  (500)
 20763*        SET     (ADDRESS OF FORM-MASTER)
 20764*    END-EXEC.
 20765     MOVE 500
 20766       TO DFHEIV11
 20767*    MOVE '," L                  $   #00019747' TO DFHEIV0
 20768     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20770     MOVE X'2020233030303139373437' TO DFHEIV0(25:11)
 20771     CALL 'kxdfhei1' USING DFHEIV0,
 20772           DFHEIV20,
 20773           DFHEIV11,
 20774           DFHEIV99
 20775     SET ADDRESS OF FORM-MASTER TO
 20776         DFHEIV20
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20778
 20779
 20780     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20781
 20782 8400-EXIT.
 20783      EXIT.
 20784
 20785 8450-READ-FORM-MASTER.
 20786
 20787
 20788* EXEC CICS  HANDLE CONDITION
 20789*        NOTFND   (8450-FORM-NOT-FOUND)
 20790*        ENDFILE  (8450-FORM-NOT-FOUND)
 20791*    END-EXEC.
 20792*    MOVE '"$I''                  ! 5 #00019759' TO DFHEIV0
 20793     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20795     MOVE X'3520233030303139373539' TO DFHEIV0(25:11)
 20796     CALL 'kxdfhei1' USING DFHEIV0
 20797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20798
 20799
 20800
 20801* EXEC CICS   READ
 20802*        DATASET   (FORM-ID)
 20803*        RIDFLD    (ERFORM-KEY)
 20804*        INTO      (FORM-MASTER)
 20805*        GTEQ
 20806*    END-EXEC.
 20807     MOVE LENGTH OF
 20808      FORM-MASTER
 20809       TO DFHEIV11
 20810*    MOVE '&"IL       G          (   #00019764' TO DFHEIV0
 20811     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20813     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 383
* EL050.cbl
 20814     CALL 'kxdfhei1' USING DFHEIV0,
 20815           FORM-ID,
 20816           FORM-MASTER,
 20817           DFHEIV11,
 20818           ERFORM-KEY,
 20819           DFHEIV99,
 20820           DFHEIV99,
 20821           DFHEIV99
 20822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20823
 20824
 20825     MOVE  'Y'           TO  FORM-MASTER-SW.
 20826
 20827     GO TO  8450-EXIT.
 20828
 20829 8450-FORM-NOT-FOUND.
 20830
 20831     MOVE  'N'           TO  FORM-MASTER-SW.
 20832
 20833 8450-EXIT.
 20834      EXIT.
 20835
 20836 8500-DATE-CONVERT.
 20837
 20838* EXEC CICS LINK
 20839*        PROGRAM    ('ELDATCV')
 20840*        COMMAREA   (DATE-CONVERSION-DATA)
 20841*        LENGTH     (DC-COMM-LENGTH)
 20842*    END-EXEC.
 20843     MOVE 'ELDATCV' TO DFHEIV1
 20844*    MOVE '."C                   (   #00019783' TO DFHEIV0
 20845     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20847     MOVE X'2020233030303139373833' TO DFHEIV0(25:11)
 20848     CALL 'kxdfhei1' USING DFHEIV0,
 20849           DFHEIV1,
 20850           DATE-CONVERSION-DATA,
 20851           DC-COMM-LENGTH,
 20852           DFHEIV99,
 20853           DFHEIV99,
 20854           DFHEIV99,
 20855           DFHEIV99
 20856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20857
 20858
 20859 8500-EXIT.
 20860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 384
* EL050.cbl
 20862
 20863 8555-RELOAD-CONTROL-FILE.
 20864     CONTINUE.
 20865
 20866 8555-EXIT.
 20867     EXIT.
 20868
 20869 8557-GETMAIN-ERPLAN.
 20870
 20871
 20872* EXEC CICS GETMAIN
 20873*        LENGTH    (840)
 20874*        SET       (ADDRESS OF PLAN-RECORDS)
 20875*    END-EXEC.
 20876     MOVE 840
 20877       TO DFHEIV11
 20878*    MOVE '," L                  $   #00019801' TO DFHEIV0
 20879     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20881     MOVE X'2020233030303139383031' TO DFHEIV0(25:11)
 20882     CALL 'kxdfhei1' USING DFHEIV0,
 20883           DFHEIV20,
 20884           DFHEIV11,
 20885           DFHEIV99
 20886     SET ADDRESS OF PLAN-RECORDS TO
 20887         DFHEIV20
 20888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20889
 20890
 20891     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20892
 20893 8557-EXIT.
 20894     EXIT.
 20895
 20896 8560-GETMAIN.
 20897
 20898* EXEC CICS GETMAIN
 20899*        LENGTH    (2000)
 20900*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20901*    END-EXEC.
 20902     MOVE 2000
 20903       TO DFHEIV11
 20904*    MOVE '," L                  $   #00019812' TO DFHEIV0
 20905     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20906     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20907     MOVE X'2020233030303139383132' TO DFHEIV0(25:11)
 20908     CALL 'kxdfhei1' USING DFHEIV0,
 20909           DFHEIV20,
 20910           DFHEIV11,
 20911           DFHEIV99
 20912     SET ADDRESS OF ACCOUNT-MASTER TO
 20913         DFHEIV20
 20914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20915
 20916
 20917     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20918
 20919 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 385
* EL050.cbl
 20920     EXIT.
 20921
 20922 8570-START-ACCOUNT-MASTER.
 20923
 20924* EXEC CICS HANDLE CONDITION
 20925*        NOTFND    (0199-ACCT-NOT-FOUND)
 20926*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20927*    END-EXEC.
 20928*    MOVE '"$I''                  ! 6 #00019823' TO DFHEIV0
 20929     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20931     MOVE X'3620233030303139383233' TO DFHEIV0(25:11)
 20932     CALL 'kxdfhei1' USING DFHEIV0
 20933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20934
 20935
 20936
 20937* EXEC CICS STARTBR
 20938*        DATASET    (ACCT-ID)
 20939*        RIDFLD     (ERACCT-KEY)
 20940*        GTEQ
 20941*    END-EXEC.
 20942     MOVE 0
 20943       TO DFHEIV11
 20944*    MOVE '&,         G          &   #00019828' TO DFHEIV0
 20945     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20947     MOVE X'2020233030303139383238' TO DFHEIV0(25:11)
 20948     CALL 'kxdfhei1' USING DFHEIV0,
 20949           ACCT-ID,
 20950           ERACCT-KEY,
 20951           DFHEIV99,
 20952           DFHEIV11,
 20953           DFHEIV99
 20954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20955
 20956
 20957 8570-EXIT.
 20958     EXIT.
 20959
 20960 8580-READ-ACCOUNT-MASTER.
 20961
 20962* EXEC CICS HANDLE CONDITION
 20963*        NOTFND    (0199-ACCT-NOT-FOUND)
 20964*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20965*    END-EXEC.
 20966*    MOVE '"$I''                  ! 7 #00019838' TO DFHEIV0
 20967     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20969     MOVE X'3720233030303139383338' TO DFHEIV0(25:11)
 20970     CALL 'kxdfhei1' USING DFHEIV0
 20971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20972
 20973
 20974
 20975* EXEC CICS READNEXT
 20976*        DATASET     (ACCT-ID)
 20977*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 386
* EL050.cbl
 20978*        RIDFLD      (ERACCT-KEY)
 20979*    END-EXEC.
 20980     MOVE LENGTH OF
 20981      ACCOUNT-MASTER
 20982       TO DFHEIV12
 20983     MOVE 0
 20984       TO DFHEIV11
 20985*    MOVE '&.IL                  )   #00019843' TO DFHEIV0
 20986     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20987     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20988     MOVE X'2020233030303139383433' TO DFHEIV0(25:11)
 20989     CALL 'kxdfhei1' USING DFHEIV0,
 20990           ACCT-ID,
 20991           ACCOUNT-MASTER,
 20992           DFHEIV12,
 20993           ERACCT-KEY,
 20994           DFHEIV99,
 20995           DFHEIV11,
 20996           DFHEIV99,
 20997           DFHEIV99
 20998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20999
 21000
 21001 8580-EXIT.
 21002     EXIT.
 21003
 21004 8582-READ-COMPENSATION-MASTER.
 21005
 21006* EXEC CICS HANDLE CONDITION
 21007*        NOTFND    (8582-COMP-NOT-FOUND)
 21008*        ENDFILE   (8582-COMP-NOT-FOUND)
 21009*    END-EXEC.
 21010*    MOVE '"$I''                  ! 8 #00019853' TO DFHEIV0
 21011     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21013     MOVE X'3820233030303139383533' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0
 21015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21016
 21017
 21018
 21019* EXEC CICS READ
 21020*        DATASET     (COMP-ID)
 21021*        INTO        (COMPENSATION-MASTER)
 21022*        RIDFLD      (ERCOMP-KEY)
 21023*    END-EXEC.
 21024     MOVE LENGTH OF
 21025      COMPENSATION-MASTER
 21026       TO DFHEIV11
 21027*    MOVE '&"IL       E          (   #00019858' TO DFHEIV0
 21028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21030     MOVE X'2020233030303139383538' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           COMP-ID,
 21033           COMPENSATION-MASTER,
 21034           DFHEIV11,
 21035           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 387
* EL050.cbl
 21036           DFHEIV99,
 21037           DFHEIV99,
 21038           DFHEIV99
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21040
 21041
 21042     MOVE 'Y'                    TO COMP-MASTER-SW
 21043
 21044     GO TO 8582-EXIT
 21045     .
 21046 8582-COMP-NOT-FOUND.
 21047
 21048     MOVE 'N'                    TO COMP-MASTER-SW.
 21049
 21050 8582-EXIT.
 21051     EXIT.
 21052
 21053 8583-READ-ERAGTC.
 21054
 21055* EXEC CICS HANDLE CONDITION
 21056*        NOTFND    (8583-AGTC-NOT-FOUND)
 21057*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21058*    END-EXEC.
 21059*    MOVE '"$I''                  ! 9 #00019876' TO DFHEIV0
 21060     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21062     MOVE X'3920233030303139383736' TO DFHEIV0(25:11)
 21063     CALL 'kxdfhei1' USING DFHEIV0
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067
 21068* EXEC CICS STARTBR
 21069*        DATASET    (AGTC-ID)
 21070*        RIDFLD     (ERAGTC-KEY)
 21071*        GTEQ
 21072*    END-EXEC.
 21073     MOVE 0
 21074       TO DFHEIV11
 21075*    MOVE '&,         G          &   #00019881' TO DFHEIV0
 21076     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21078     MOVE X'2020233030303139383831' TO DFHEIV0(25:11)
 21079     CALL 'kxdfhei1' USING DFHEIV0,
 21080           AGTC-ID,
 21081           ERAGTC-KEY,
 21082           DFHEIV99,
 21083           DFHEIV11,
 21084           DFHEIV99
 21085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21086
 21087
 21088 8583-READ-ERAGTC-NEXT.
 21089
 21090* EXEC CICS READNEXT
 21091*        DATASET     (AGTC-ID)
 21092*        INTO        (AGENT-COMMISSIONS)
 21093*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 388
* EL050.cbl
 21094*    END-EXEC.
 21095     MOVE LENGTH OF
 21096      AGENT-COMMISSIONS
 21097       TO DFHEIV12
 21098     MOVE 0
 21099       TO DFHEIV11
 21100*    MOVE '&.IL                  )   #00019888' TO DFHEIV0
 21101     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21102     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21103     MOVE X'2020233030303139383838' TO DFHEIV0(25:11)
 21104     CALL 'kxdfhei1' USING DFHEIV0,
 21105           AGTC-ID,
 21106           AGENT-COMMISSIONS,
 21107           DFHEIV12,
 21108           ERAGTC-KEY,
 21109           DFHEIV99,
 21110           DFHEIV11,
 21111           DFHEIV99,
 21112           DFHEIV99
 21113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21114
 21115
 21116*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21117
 21118     GO TO 8583-EXIT
 21119     .
 21120 8583-AGTC-NOT-FOUND.
 21121
 21122     MOVE 'N'                    TO AGTC-MASTER-SW.
 21123
 21124 8583-EXIT.
 21125     EXIT.
 21126
 21127 8584-READ-BANK-CROSS-REF.
 21128
 21129* EXEC CICS HANDLE CONDITION
 21130*        NOTFND    (8584-BXRF-NOT-FOUND)
 21131*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21132*    END-EXEC.
 21133*    MOVE '"$I''                  ! : #00019906' TO DFHEIV0
 21134     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21136     MOVE X'3A20233030303139393036' TO DFHEIV0(25:11)
 21137     CALL 'kxdfhei1' USING DFHEIV0
 21138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21139
 21140
 21141
 21142* EXEC CICS READ
 21143*        DATASET     (BXRF-ID)
 21144*        INTO        (BANK-CROSS-REFERENCE)
 21145*        RIDFLD      (ERBXRF-KEY)
 21146*        LENGTH      (BXRF-REC-LENGTH)
 21147*    END-EXEC.
 21148*    MOVE '&"IL       E          (   #00019911' TO DFHEIV0
 21149     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21151     MOVE X'2020233030303139393131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 389
* EL050.cbl
 21152     CALL 'kxdfhei1' USING DFHEIV0,
 21153           BXRF-ID,
 21154           BANK-CROSS-REFERENCE,
 21155           BXRF-REC-LENGTH,
 21156           ERBXRF-KEY,
 21157           DFHEIV99,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163     MOVE 'Y'                    TO BXRF-MASTER-SW
 21164
 21165     GO TO 8584-EXIT
 21166     .
 21167 8584-BXRF-NOT-FOUND.
 21168
 21169     MOVE 'N'                    TO BXRF-MASTER-SW.
 21170
 21171 8584-EXIT.
 21172     EXIT.
 21173
 21174 8585-READ-PLAN-MASTER.
 21175
 21176
 21177* EXEC CICS HANDLE CONDITION
 21178*        NOTFND    (8585-PLAN-NOT-FOUND)
 21179*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21180*    END-EXEC.
 21181*    MOVE '"$I''                  ! ; #00019931' TO DFHEIV0
 21182     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21184     MOVE X'3B20233030303139393331' TO DFHEIV0(25:11)
 21185     CALL 'kxdfhei1' USING DFHEIV0
 21186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21187
 21188
 21189
 21190* EXEC CICS READ
 21191*        DATASET     (PLAN-ID)
 21192*        INTO        (PLAN-MASTER)
 21193*        RIDFLD      (ERPLAN-KEY)
 21194*    END-EXEC.
 21195     MOVE LENGTH OF
 21196      PLAN-MASTER
 21197       TO DFHEIV11
 21198*    MOVE '&"IL       E          (   #00019936' TO DFHEIV0
 21199     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21201     MOVE X'2020233030303139393336' TO DFHEIV0(25:11)
 21202     CALL 'kxdfhei1' USING DFHEIV0,
 21203           PLAN-ID,
 21204           PLAN-MASTER,
 21205           DFHEIV11,
 21206           ERPLAN-KEY,
 21207           DFHEIV99,
 21208           DFHEIV99,
 21209           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 390
* EL050.cbl
 21210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21211
 21212
 21213     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21214
 21215     GO TO 8585-EXIT.
 21216
 21217 8585-PLAN-NOT-FOUND.
 21218
 21219     MOVE 'N'                    TO PLAN-MASTER-SW.
 21220
 21221 8585-EXIT.
 21222     EXIT.
 21223
 21224 8586-READ-LOAN-OFFICER.
 21225
 21226* EXEC CICS READ
 21227*        DATASET     (LOFC-ID)
 21228*        INTO        (LOAN-OFFICER-MASTER)
 21229*        RIDFLD      (ERLOFC-KEY)
 21230*        RESP        (WS-RESPONSE)
 21231*    END-EXEC
 21232     MOVE LENGTH OF
 21233      LOAN-OFFICER-MASTER
 21234       TO DFHEIV11
 21235*    MOVE '&"IL       E          (  N#00019954' TO DFHEIV0
 21236     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21237     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21238     MOVE X'204E233030303139393534' TO DFHEIV0(25:11)
 21239     CALL 'kxdfhei1' USING DFHEIV0,
 21240           LOFC-ID,
 21241           LOAN-OFFICER-MASTER,
 21242           DFHEIV11,
 21243           ERLOFC-KEY,
 21244           DFHEIV99,
 21245           DFHEIV99,
 21246           DFHEIV99
 21247     MOVE EIBRESP  TO WS-RESPONSE
 21248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21249
 21250     IF WS-RESP-NORMAL
 21251        MOVE 'Y'                 TO LOFC-MASTER-SW
 21252     ELSE
 21253        MOVE 'N'                 TO LOFC-MASTER-SW
 21254     END-IF
 21255     .
 21256 8586-EXIT.
 21257     EXIT.
 21258 8587-START-ERPDEF.
 21259
 21260* EXEC CICS STARTBR
 21261*       DATASET   (PDEF-ID)
 21262*       RIDFLD    (ERPDEF-KEY)
 21263*       GTEQ
 21264*       RESP      (WS-RESPONSE)
 21265*    END-EXEC
 21266     MOVE 0
 21267       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 391
* EL050.cbl
 21268*    MOVE '&,         G          &  N#00019970' TO DFHEIV0
 21269     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21271     MOVE X'204E233030303139393730' TO DFHEIV0(25:11)
 21272     CALL 'kxdfhei1' USING DFHEIV0,
 21273           PDEF-ID,
 21274           ERPDEF-KEY,
 21275           DFHEIV99,
 21276           DFHEIV11,
 21277           DFHEIV99
 21278     MOVE EIBRESP  TO WS-RESPONSE
 21279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21280     IF WS-RESP-NORMAL
 21281        MOVE 'Y'                 TO PDEF-MASTER-SW
 21282     ELSE
 21283        MOVE 'N'                 TO PDEF-MASTER-SW
 21284     END-IF
 21285     .
 21286 8587-EXIT.
 21287     EXIT.
 21288 8588-READ-ERPDEF.
 21289
 21290* EXEC CICS READNEXT
 21291*       DATASET   (PDEF-ID)
 21292*       RIDFLD    (ERPDEF-KEY)
 21293*       INTO      (PRODUCT-MASTER)
 21294*       RESP      (WS-RESPONSE)
 21295*    END-EXEC
 21296     MOVE LENGTH OF
 21297      PRODUCT-MASTER
 21298       TO DFHEIV12
 21299     MOVE 0
 21300       TO DFHEIV11
 21301*    MOVE '&.IL                  )  N#00019985' TO DFHEIV0
 21302     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21304     MOVE X'204E233030303139393835' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0,
 21306           PDEF-ID,
 21307           PRODUCT-MASTER,
 21308           DFHEIV12,
 21309           ERPDEF-KEY,
 21310           DFHEIV99,
 21311           DFHEIV11,
 21312           DFHEIV99,
 21313           DFHEIV99
 21314     MOVE EIBRESP  TO WS-RESPONSE
 21315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21316     IF WS-RESP-NORMAL
 21317        MOVE 'Y'                 TO PDEF-MASTER-SW
 21318     ELSE
 21319        MOVE 'N'                 TO PDEF-MASTER-SW
 21320     END-IF
 21321     .
 21322 8588-EXIT.
 21323     EXIT.
 21324 8589-ENDBR-ERPDEF.
 21325
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 392
* EL050.cbl
 21326* EXEC CICS ENDBR
 21327*       DATASET   (PDEF-ID)
 21328*    END-EXEC
 21329     MOVE 0
 21330       TO DFHEIV11
 21331*    MOVE '&2                    $   #00020000' TO DFHEIV0
 21332     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21334     MOVE X'2020233030303230303030' TO DFHEIV0(25:11)
 21335     CALL 'kxdfhei1' USING DFHEIV0,
 21336           PDEF-ID,
 21337           DFHEIV11,
 21338           DFHEIV99
 21339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21340     .
 21341 8589-EXIT.
 21342     EXIT.
 21343 8590-READ-CERT-MASTER.
 21344     IF PB-COMPANY-ID = 'UCL'
 21345         GO TO 8690-READ-CERT-MASTER-UCL.
 21346
 21347
 21348* EXEC CICS HANDLE CONDITION
 21349*         NOTFND    (0299-CERT-NOT-FOUND)
 21350*    END-EXEC.
 21351*    MOVE '"$I                   ! < #00020010' TO DFHEIV0
 21352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21354     MOVE X'3C20233030303230303130' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21357
 21358
 21359
 21360* EXEC CICS READ
 21361*        DATASET     (CERT-ID)
 21362*        INTO        (CERTIFICATE-MASTER)
 21363*        RIDFLD      (ELCERT-KEY)
 21364*        UPDATE
 21365*    END-EXEC.
 21366     MOVE LENGTH OF
 21367      CERTIFICATE-MASTER
 21368       TO DFHEIV11
 21369*    MOVE '&"IL       EU         (   #00020014' TO DFHEIV0
 21370     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21371     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21372     MOVE X'2020233030303230303134' TO DFHEIV0(25:11)
 21373     CALL 'kxdfhei1' USING DFHEIV0,
 21374           CERT-ID,
 21375           CERTIFICATE-MASTER,
 21376           DFHEIV11,
 21377           ELCERT-KEY,
 21378           DFHEIV99,
 21379           DFHEIV99,
 21380           DFHEIV99
 21381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21382
 21383
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 393
* EL050.cbl
 21384 8590-EXIT.
 21385     EXIT.
 21386
 21387 8690-READ-CERT-MASTER-UCL.
 21388
 21389* EXEC CICS HANDLE CONDITION
 21390*         NOTFND    (8700-READ-CERT-MASTER)
 21391*    END-EXEC.
 21392*    MOVE '"$I                   ! = #00020025' TO DFHEIV0
 21393     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21395     MOVE X'3D20233030303230303235' TO DFHEIV0(25:11)
 21396     CALL 'kxdfhei1' USING DFHEIV0
 21397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21398
 21399
 21400 8690-READ-CERT-CONT.
 21401
 21402* EXEC CICS READ
 21403*        DATASET     (CERT-ID)
 21404*        INTO        (CERTIFICATE-MASTER)
 21405*        RIDFLD      (ELCERT-KEY)
 21406*        UPDATE
 21407*    END-EXEC.
 21408     MOVE LENGTH OF
 21409      CERTIFICATE-MASTER
 21410       TO DFHEIV11
 21411*    MOVE '&"IL       EU         (   #00020030' TO DFHEIV0
 21412     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21413     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21414     MOVE X'2020233030303230303330' TO DFHEIV0(25:11)
 21415     CALL 'kxdfhei1' USING DFHEIV0,
 21416           CERT-ID,
 21417           CERTIFICATE-MASTER,
 21418           DFHEIV11,
 21419           ELCERT-KEY,
 21420           DFHEIV99,
 21421           DFHEIV99,
 21422           DFHEIV99
 21423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21424
 21425
 21426     GO TO 8590-EXIT.
 21427
 21428 8700-READ-CERT-MASTER.
 21429     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21430     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21431
 21432* EXEC CICS HANDLE CONDITION
 21433*         DUPKEY    (8720-COMP-ACCOUNTS)
 21434*         ENDFILE   (8730-END-BROWSE)
 21435*         NOTFND    (8740-NOT-FOUND)
 21436*    END-EXEC.
 21437*    MOVE '"$$''I                 ! > #00020042' TO DFHEIV0
 21438     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21440     MOVE X'3E20233030303230303432' TO DFHEIV0(25:11)
 21441     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 394
* EL050.cbl
 21442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21443
 21444
 21445
 21446* EXEC CICS STARTBR
 21447*        DATASET     ('ELCERT5')
 21448*        RIDFLD      (ELCERT2-KEY)
 21449*        EQUAL
 21450*    END-EXEC.
 21451     MOVE 'ELCERT5' TO DFHEIV1
 21452     MOVE 0
 21453       TO DFHEIV11
 21454*    MOVE '&,         E          &   #00020048' TO DFHEIV0
 21455     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21456     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21457     MOVE X'2020233030303230303438' TO DFHEIV0(25:11)
 21458     CALL 'kxdfhei1' USING DFHEIV0,
 21459           DFHEIV1,
 21460           ELCERT2-KEY,
 21461           DFHEIV99,
 21462           DFHEIV11,
 21463           DFHEIV99
 21464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21465
 21466
 21467 8710-READ-NEXT.
 21468
 21469* EXEC CICS READNEXT
 21470*        DATASET     ('ELCERT5')
 21471*        INTO        (CERTIFICATE-MASTER)
 21472*        RIDFLD      (ELCERT2-KEY)
 21473*    END-EXEC.
 21474     MOVE LENGTH OF
 21475      CERTIFICATE-MASTER
 21476       TO DFHEIV12
 21477     MOVE 'ELCERT5' TO DFHEIV1
 21478     MOVE 0
 21479       TO DFHEIV11
 21480*    MOVE '&.IL                  )   #00020055' TO DFHEIV0
 21481     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21482     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21483     MOVE X'2020233030303230303535' TO DFHEIV0(25:11)
 21484     CALL 'kxdfhei1' USING DFHEIV0,
 21485           DFHEIV1,
 21486           CERTIFICATE-MASTER,
 21487           DFHEIV12,
 21488           ELCERT2-KEY,
 21489           DFHEIV99,
 21490           DFHEIV11,
 21491           DFHEIV99,
 21492           DFHEIV99
 21493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21494
 21495
 21496 8720-COMP-ACCOUNTS.
 21497
 21498* EXEC CICS ENTER
 21499*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 395
* EL050.cbl
 21500*         FROM (PB-C-LAST-NAME)
 21501*    END-EXEC.
 21502     MOVE 001
 21503       TO DFHEIV11
 21504*    MOVE ':$F                   %   #00020062' TO DFHEIV0
 21505     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21506     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21507     MOVE X'2020233030303230303632' TO DFHEIV0(25:11)
 21508     CALL 'kxdfhei1' USING DFHEIV0,
 21509           DFHEIV11,
 21510           PB-C-LAST-NAME,
 21511           DFHEIV99,
 21512           DFHEIV99
 21513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21514
 21515
 21516
 21517* EXEC CICS ENTER
 21518*         TRACEID (002)
 21519*         FROM (CM-INSURED-LAST-NAME)
 21520*    END-EXEC.
 21521     MOVE 002
 21522       TO DFHEIV11
 21523*    MOVE ':$F                   %   #00020067' TO DFHEIV0
 21524     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21525     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21526     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 21527     CALL 'kxdfhei1' USING DFHEIV0,
 21528           DFHEIV11,
 21529           CM-INSURED-LAST-NAME,
 21530           DFHEIV99,
 21531           DFHEIV99
 21532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21533
 21534
 21535     IF PB-CERT-NO NOT = CM-CERT-NO
 21536         GO TO 8730-END-BROWSE.
 21537
 21538     IF PB-ACCOUNT = CM-ACCOUNT
 21539         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21540             MOVE ER-2799        TO WS-ERROR
 21541             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21542             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21543             GO TO 8730-END-BROWSE.
 21544
 21545     GO TO 8710-READ-NEXT.
 21546
 21547 8730-END-BROWSE.
 21548
 21549* EXEC CICS ENDBR
 21550*         DATASET    ('ELCERT5')
 21551*    END-EXEC.
 21552     MOVE 'ELCERT5' TO DFHEIV1
 21553     MOVE 0
 21554       TO DFHEIV11
 21555*    MOVE '&2                    $   #00020085' TO DFHEIV0
 21556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 396
* EL050.cbl
 21558     MOVE X'2020233030303230303835' TO DFHEIV0(25:11)
 21559     CALL 'kxdfhei1' USING DFHEIV0,
 21560           DFHEIV1,
 21561           DFHEIV11,
 21562           DFHEIV99
 21563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21564
 21565
 21566 8740-NOT-FOUND.
 21567     GO TO 0299-CERT-NOT-FOUND.
 21568
 21569 8750-START-ELSTAT.
 21570
 21571* EXEC CICS STARTBR
 21572*       DATASET   (STAT-ID)
 21573*       RIDFLD    (ELSTAT-KEY)
 21574*       GTEQ
 21575*       RESP      (WS-RESPONSE)
 21576*    END-EXEC
 21577     MOVE 0
 21578       TO DFHEIV11
 21579*    MOVE '&,         G          &  N#00020093' TO DFHEIV0
 21580     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21582     MOVE X'204E233030303230303933' TO DFHEIV0(25:11)
 21583     CALL 'kxdfhei1' USING DFHEIV0,
 21584           STAT-ID,
 21585           ELSTAT-KEY,
 21586           DFHEIV99,
 21587           DFHEIV11,
 21588           DFHEIV99
 21589     MOVE EIBRESP  TO WS-RESPONSE
 21590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21591     IF WS-RESP-NORMAL
 21592        MOVE 'Y'                 TO STAT-MASTER-SW
 21593     ELSE
 21594        MOVE 'N'                 TO STAT-MASTER-SW
 21595     END-IF
 21596     .
 21597 8750-EXIT.
 21598     EXIT.
 21599 8752-READ-ELSTAT.
 21600
 21601* EXEC CICS READNEXT
 21602*       DATASET   (STAT-ID)
 21603*       RIDFLD    (ELSTAT-KEY)
 21604*       INTO      (STATE-FILE)
 21605*       RESP      (WS-RESPONSE)
 21606*    END-EXEC
 21607     MOVE LENGTH OF
 21608      STATE-FILE
 21609       TO DFHEIV12
 21610     MOVE 0
 21611       TO DFHEIV11
 21612*    MOVE '&.IL                  )  N#00020108' TO DFHEIV0
 21613     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21614     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21615     MOVE X'204E233030303230313038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 397
* EL050.cbl
 21616     CALL 'kxdfhei1' USING DFHEIV0,
 21617           STAT-ID,
 21618           STATE-FILE,
 21619           DFHEIV12,
 21620           ELSTAT-KEY,
 21621           DFHEIV99,
 21622           DFHEIV11,
 21623           DFHEIV99,
 21624           DFHEIV99
 21625     MOVE EIBRESP  TO WS-RESPONSE
 21626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21627     IF WS-RESP-NORMAL
 21628        MOVE 'Y'                 TO STAT-MASTER-SW
 21629     ELSE
 21630        MOVE 'N'                 TO STAT-MASTER-SW
 21631     END-IF
 21632     .
 21633 8752-EXIT.
 21634     EXIT.
 21635 8800-GET-COMP-RATE.
 21636     MOVE +1 TO IB.
 21637     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21638         ADD +9 TO IB
 21639         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21640             ADD +9 TO IB
 21641             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21642                MOVE ZEROS       TO WS-WK-RATE
 21643                GO TO 8800-EXIT.
 21644
 21645     IF PB-I-AGE GREATER CT-AGE (1)
 21646         ADD +3 TO IB
 21647         IF PB-I-AGE GREATER CT-AGE (2)
 21648             ADD +3 TO IB
 21649             IF PB-I-AGE GREATER CT-AGE (3)
 21650                MOVE ZEROS       TO WS-WK-RATE
 21651                GO TO 8800-EXIT.
 21652
 21653     IF WS-WORK-TERM GREATER CT-TRM (1)
 21654         ADD +1 TO IB
 21655         IF WS-WORK-TERM GREATER CT-TRM (2)
 21656             ADD +1 TO IB
 21657             IF WS-WORK-TERM GREATER CT-TRM (3)
 21658                MOVE ZEROS       TO WS-WK-RATE
 21659                GO TO 8800-EXIT.
 21660
 21661     IF CT-RT (IB) NOT NUMERIC
 21662         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21663         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21664         GO TO 8800-GET-COMP-RATE.
 21665
 21666     MOVE CT-RT (IB) TO WS-WK-RATE.
 21667
 21668 8800-EXIT.
 21669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 398
* EL050.cbl
 21671 8900-ADDRESS-FILE.
 21672     IF ERACCT-FILE-ADDRESSED
 21673         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21674         GO TO 8900-ADDRESS-EXIT.
 21675
 21676     IF ELCNTL-FILE-ADDRESSED
 21677         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21678         GO TO 8900-ADDRESS-EXIT.
 21679
 21680     IF ERPLAN-FILE-ADDRESSED
 21681         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21682         GO TO 8900-ADDRESS-EXIT.
 21683
 21684     IF ERFORM-FILE-ADDRESSED
 21685         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21686         GO TO 8900-ADDRESS-EXIT.
 21687
 21688 8900-ADDRESS-EXIT.
 21689     EXIT.
 21690
 21691 9000-READ-CONTROL.
 21692
 21693* EXEC CICS HANDLE CONDITION
 21694*        NOTFND    (9000-NOTFND)
 21695*    END-EXEC.
 21696*    MOVE '"$I                   ! ? #00020179' TO DFHEIV0
 21697     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21699     MOVE X'3F20233030303230313739' TO DFHEIV0(25:11)
 21700     CALL 'kxdfhei1' USING DFHEIV0
 21701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21702
 21703
 21704
 21705* EXEC CICS READ
 21706*        DATASET     (CNTL-ID)
 21707*        SET         (ADDRESS OF CONTROL-FILE)
 21708*        RIDFLD      (ELCNTL-KEY)
 21709*        GTEQ
 21710*    END-EXEC.
 21711*    MOVE '&"S        G          (   #00020183' TO DFHEIV0
 21712     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21714     MOVE X'2020233030303230313833' TO DFHEIV0(25:11)
 21715     CALL 'kxdfhei1' USING DFHEIV0,
 21716           CNTL-ID,
 21717           DFHEIV20,
 21718           DFHEIV99,
 21719           ELCNTL-KEY,
 21720           DFHEIV99,
 21721           DFHEIV99,
 21722           DFHEIV99
 21723     SET ADDRESS OF CONTROL-FILE TO
 21724         DFHEIV20
 21725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21726
 21727
 21728     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 399
* EL050.cbl
 21729
 21730 9000-NOTFND.
 21731     IF RC-SW-1 = '1'
 21732        MOVE ER-2616              TO WS-ERROR
 21733        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21734        GO TO 9000-EXIT.
 21735
 21736     IF RC-SW-1 = '2'
 21737        MOVE ER-2602              TO WS-ERROR
 21738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21739
 21740 9000-EXIT.
 21741      EXIT.
 21742
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 400
* EL050.cbl
 21744 9100-READ-CONTROL.
 21745
 21746* EXEC CICS HANDLE CONDITION
 21747*        NOTFND  (9100-NOTFND)
 21748*        ENDFILE (9100-NOTFND)
 21749*    END-EXEC.
 21750*    MOVE '"$I''                  ! @ #00020207' TO DFHEIV0
 21751     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21753     MOVE X'4020233030303230323037' TO DFHEIV0(25:11)
 21754     CALL 'kxdfhei1' USING DFHEIV0
 21755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21756
 21757
 21758
 21759* EXEC CICS READ
 21760*        DATASET     (CNTL-ID)
 21761*        INTO        (CONTROL-FILE)
 21762*        RIDFLD      (ELCNTL-KEY)
 21763*        GTEQ
 21764*    END-EXEC.
 21765     MOVE LENGTH OF
 21766      CONTROL-FILE
 21767       TO DFHEIV11
 21768*    MOVE '&"IL       G          (   #00020212' TO DFHEIV0
 21769     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21771     MOVE X'2020233030303230323132' TO DFHEIV0(25:11)
 21772     CALL 'kxdfhei1' USING DFHEIV0,
 21773           CNTL-ID,
 21774           CONTROL-FILE,
 21775           DFHEIV11,
 21776           ELCNTL-KEY,
 21777           DFHEIV99,
 21778           DFHEIV99,
 21779           DFHEIV99
 21780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21781
 21782
 21783     GO TO 9100-EXIT.
 21784
 21785 9100-NOTFND.
 21786     IF RC-SW-2 = '0'
 21787        MOVE '1'                  TO STATE-RECORD-ERROR
 21788        GO TO 9100-EXIT
 21789     END-IF
 21790     IF RC-SW-2 = '1'
 21791        MOVE '1'                  TO LF-BENEFIT-ERROR
 21792        MOVE ER-2604              TO WS-ERROR
 21793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21794        GO TO 9100-EXIT.
 21795
 21796     IF RC-SW-2 = '2'
 21797        MOVE '1'                  TO AH-BENEFIT-ERROR
 21798        MOVE ER-2605              TO WS-ERROR
 21799        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21800        GO TO 9100-EXIT.
 21801
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 401
* EL050.cbl
 21802     IF RC-SW-2 = '3'
 21803         MOVE ER-2603           TO WS-ERROR
 21804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21805         GO TO 9100-EXIT.
 21806
 21807     IF RC-SW-2 = '4'
 21808         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21809         GO TO 9100-EXIT.
 21810
 21811     IF RC-SW-2 = '5'
 21812         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21813         IF WS-AH-INPUT-CD-1 = SPACE
 21814             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21815         ELSE
 21816             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21817
 21818 9100-EXIT.
 21819      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 402
* EL050.cbl
 21821 9200-CONTROL-GETMAIN.
 21822
 21823* EXEC CICS GETMAIN
 21824*         LENGTH   (750)
 21825*         SET      (ADDRESS OF CONTROL-FILE)
 21826*    END-EXEC.
 21827     MOVE 750
 21828       TO DFHEIV11
 21829*    MOVE '," L                  $   #00020258' TO DFHEIV0
 21830     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21832     MOVE X'2020233030303230323538' TO DFHEIV0(25:11)
 21833     CALL 'kxdfhei1' USING DFHEIV0,
 21834           DFHEIV20,
 21835           DFHEIV11,
 21836           DFHEIV99
 21837     SET ADDRESS OF CONTROL-FILE TO
 21838         DFHEIV20
 21839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21840
 21841
 21842     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21843
 21844 9200-EXIT.
 21845     EXIT.
 21846
 21847 9250-UNLOCK-RETURN.
 21848
 21849* EXEC CICS UNLOCK
 21850*        DATASET   (CERT-ID)
 21851*    END-EXEC.
 21852*    MOVE '&*                    #   #00020269' TO DFHEIV0
 21853     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21855     MOVE X'2020233030303230323639' TO DFHEIV0(25:11)
 21856     CALL 'kxdfhei1' USING DFHEIV0,
 21857           CERT-ID,
 21858           DFHEIV99
 21859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21860
 21861
 21862 9300-ABEND.
 21863     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21864
 21865
 21866* EXEC CICS LINK
 21867*        PROGRAM   ('EL004')
 21868*        COMMAREA  (WS-ERROR-LINE)
 21869*        LENGTH    (72)
 21870*    END-EXEC.
 21871     MOVE 'EL004' TO DFHEIV1
 21872     MOVE 72
 21873       TO DFHEIV11
 21874*    MOVE '."C                   (   #00020276' TO DFHEIV0
 21875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21877     MOVE X'2020233030303230323736' TO DFHEIV0(25:11)
 21878     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 403
* EL050.cbl
 21879           DFHEIV1,
 21880           WS-ERROR-LINE,
 21881           DFHEIV11,
 21882           DFHEIV99,
 21883           DFHEIV99,
 21884           DFHEIV99,
 21885           DFHEIV99
 21886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21887
 21888
 21889     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21890
 21891
 21892* EXEC CICS ABEND
 21893*        ABCODE ('EL50')
 21894*    END-EXEC.
 21895     MOVE 'EL50' TO DFHEIV5
 21896*    MOVE '.,A                   "   #00020284' TO DFHEIV0
 21897     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21898     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21899     MOVE X'2020233030303230323834' TO DFHEIV0(25:11)
 21900     CALL 'kxdfhei1' USING DFHEIV0,
 21901           DFHEIV5
 21902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21903
 21904
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 404
* EL050.cbl
 21906
 21907******************************************************************
 21908*                                                                *
 21909*            E R R O R   F O R M A T   R O U T I N E             *
 21910*                                                                *
 21911******************************************************************
 21912
 21913 9900-ERROR-FORMAT.
 21914
 21915     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21916                    PB-COMMON-ERROR (2) OR
 21917                    PB-COMMON-ERROR (3) OR
 21918                    PB-COMMON-ERROR (4) OR
 21919                    PB-COMMON-ERROR (5) OR
 21920                    PB-COMMON-ERROR (6) OR
 21921                    PB-COMMON-ERROR (7) OR
 21922                    PB-COMMON-ERROR (8) OR
 21923                    PB-COMMON-ERROR (9) OR
 21924                    PB-COMMON-ERROR (10)
 21925        GO TO 9900-EXIT.
 21926
 21927     IF PB-NO-OF-ERRORS = +10
 21928        GO TO 9900-EXIT.
 21929
 21930     ADD +1  TO PB-NO-OF-ERRORS.
 21931     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21932                                       (PB-NO-OF-ERRORS).
 21933 9900-EXIT.
 21934     EXIT.
 21935
 21936 9990-RETURN.
 21937     IF BROWSE-STARTED
 21938
 21939* EXEC CICS ENDBR
 21940*            DATASET  (ACCT-ID)
 21941*       END-EXEC.
 21942     MOVE 0
 21943       TO DFHEIV11
 21944*    MOVE '&2                    $   #00020321' TO DFHEIV0
 21945     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21947     MOVE X'2020233030303230333231' TO DFHEIV0(25:11)
 21948     CALL 'kxdfhei1' USING DFHEIV0,
 21949           ACCT-ID,
 21950           DFHEIV11,
 21951           DFHEIV99
 21952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21953
 21954
 21955 9990-EXIT.
 21956     EXIT.
 21957
 21958
 21959****Check for CRTO record, add one if not found.
 21960 9991-CHECK-FOR-ELCRTO.
 21961
 21962* EXEC CICS HANDLE CONDITION
 21963*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 405
* EL050.cbl
 21964*         ENDFILE (9991-CRTO-NOT-FOUND)
 21965*     END-EXEC.
 21966*    MOVE '"$I''                  ! A #00020331' TO DFHEIV0
 21967     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21969     MOVE X'4120233030303230333331' TO DFHEIV0(25:11)
 21970     CALL 'kxdfhei1' USING DFHEIV0
 21971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21972
 21973     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21974     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21975     MOVE +0                     TO ELCRTO-SEQ-NO
 21976
 21977
 21978* EXEC CICS READ
 21979*       DATASET   ('ELCRTO')
 21980*       INTO      (ORIGINAL-CERTIFICATE)
 21981*       RIDFLD    (ELCRTO-KEY)
 21982*       GTEQ
 21983*       RESP      (WS-RESPONSE)
 21984*    END-EXEC
 21985     MOVE LENGTH OF
 21986      ORIGINAL-CERTIFICATE
 21987       TO DFHEIV11
 21988     MOVE 'ELCRTO' TO DFHEIV1
 21989*    MOVE '&"IL       G          (  N#00020339' TO DFHEIV0
 21990     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21992     MOVE X'204E233030303230333339' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0,
 21994           DFHEIV1,
 21995           ORIGINAL-CERTIFICATE,
 21996           DFHEIV11,
 21997           ELCRTO-KEY,
 21998           DFHEIV99,
 21999           DFHEIV99,
 22000           DFHEIV99
 22001     MOVE EIBRESP  TO WS-RESPONSE
 22002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22003
 22004     IF WS-RESP-NORMAL
 22005        AND (OC-CONTROL-PRIMARY (1:33) =
 22006                 PB-CONTROL-BY-ACCOUNT (1:33))
 22007        AND (OC-RECORD-TYPE =  'I')
 22008           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22009               GO TO 9991-CHECK-INDICATORS
 22010           ELSE
 22011               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22012               GO TO 9991-CRTO-ADD-REC
 22013           END-IF
 22014     END-IF.
 22015
 22016 9991-CRTO-NOT-FOUND.
 22017
 22018     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22019     MOVE 'OC'                TO OC-RECORD-ID
 22020     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22021                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 406
* EL050.cbl
 22022     MOVE +4096               TO OC-KEY-SEQ-NO.
 22023
 22024 9991-CRTO-ADD-REC.
 22025
 22026     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22027     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22028     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22029     MOVE 'I'                 TO OC-RECORD-TYPE
 22030     IF PB-ISSUE
 22031         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22032         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22033         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22034         MOVE PB-I-AGE               TO OC-INS-AGE
 22035         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22036         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22037         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22038         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22039         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22040         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22041         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22042         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22043         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22044         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22045         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22046         IF PB-I-JOINT-COMMISSION > +0
 22047             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22048         ELSE
 22049             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22050         END-IF
 22051         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22052         MOVE +0                     TO OC-LF-CANCEL-AMT
 22053                                        OC-LF-ITD-CANCEL-AMT
 22054         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22055         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22056         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22057         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22058         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22059         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22060         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22061         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22062         MOVE +0                     TO OC-AH-CANCEL-AMT
 22063                                        OC-AH-ITD-CANCEL-AMT
 22064         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22065         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22066         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22067     ELSE
 22068         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22069         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22070         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22071         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22072         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22073         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22074         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22075         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22076         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22077          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22078             MOVE SPACES             TO OC-LF-BENCD
 22079             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 407
* EL050.cbl
 22080                                        OC-LF-BEN-AMT
 22081                                        OC-LF-PRM-AMT
 22082                                        OC-LF-ALT-BEN-AMT
 22083                                        OC-LF-ALT-PRM-AMT
 22084                                        OC-LF-COMM-PCT
 22085                                        OC-LF-CANCEL-AMT
 22086             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22087             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22088         ELSE
 22089             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22090             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22091             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22092             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22093             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22094             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22095             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22096             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22097             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22098             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22099         END-IF
 22100         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22101         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22102          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22103             MOVE SPACES             TO OC-AH-BENCD
 22104             MOVE ZEROS              TO OC-AH-TERM
 22105                                        OC-AH-BEN-AMT
 22106                                        OC-AH-PRM-AMT
 22107                                        OC-AH-COMM-PCT
 22108                                        OC-AH-CANCEL-AMT
 22109                                        OC-AH-CP
 22110             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22111             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22112         ELSE
 22113             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22114             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22115             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22116             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22117             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22118             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22119             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22120             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22121             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22122         END-IF
 22123         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22124         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22125         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22126         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22127     END-IF
 22128     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22129
 22130     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22131
 22132
 22133* EXEC CICS READ
 22134*         DATASET   (FILE-ERMAIL)
 22135*         RIDFLD    (MA-CONTROL-PRIMARY)
 22136*         INTO      (MAILING-DATA)
 22137*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 408
* EL050.cbl
 22138*    END-EXEC
 22139     MOVE LENGTH OF
 22140      MAILING-DATA
 22141       TO DFHEIV11
 22142*    MOVE '&"IL       E          (  N#00020475' TO DFHEIV0
 22143     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22145     MOVE X'204E233030303230343735' TO DFHEIV0(25:11)
 22146     CALL 'kxdfhei1' USING DFHEIV0,
 22147           FILE-ERMAIL,
 22148           MAILING-DATA,
 22149           DFHEIV11,
 22150           MA-CONTROL-PRIMARY,
 22151           DFHEIV99,
 22152           DFHEIV99,
 22153           DFHEIV99
 22154     MOVE EIBRESP  TO WS-RESPONSE
 22155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22156
 22157     IF WS-RESP-NORMAL
 22158         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22159     END-IF.
 22160
 22161     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22162     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22163
 22164
 22165* EXEC CICS READ
 22166*         DATASET  (CRTT-ID)
 22167*         RIDFLD   (WS-ELCRTT-KEY)
 22168*         INTO     (CERTIFICATE-TRAILERS)
 22169*         RESP     (WS-RESPONSE)
 22170*    END-EXEC
 22171     MOVE LENGTH OF
 22172      CERTIFICATE-TRAILERS
 22173       TO DFHEIV11
 22174*    MOVE '&"IL       E          (  N#00020489' TO DFHEIV0
 22175     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22177     MOVE X'204E233030303230343839' TO DFHEIV0(25:11)
 22178     CALL 'kxdfhei1' USING DFHEIV0,
 22179           CRTT-ID,
 22180           CERTIFICATE-TRAILERS,
 22181           DFHEIV11,
 22182           WS-ELCRTT-KEY,
 22183           DFHEIV99,
 22184           DFHEIV99,
 22185           DFHEIV99
 22186     MOVE EIBRESP  TO WS-RESPONSE
 22187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22188
 22189     IF WS-RESP-NORMAL
 22190         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22191         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22192     END-IF.
 22193
 22194
 22195* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 409
* EL050.cbl
 22196*       DATASET   ('ELCRTO')
 22197*       FROM      (ORIGINAL-CERTIFICATE)
 22198*       RIDFLD    (OC-CONTROL-PRIMARY)
 22199*       RESP      (WS-RESPONSE)
 22200*    END-EXEC.
 22201     MOVE LENGTH OF
 22202      ORIGINAL-CERTIFICATE
 22203       TO DFHEIV11
 22204     MOVE 'ELCRTO' TO DFHEIV1
 22205*    MOVE '&$ L                  ''  N#00020501' TO DFHEIV0
 22206     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22207     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22208     MOVE X'204E233030303230353031' TO DFHEIV0(25:11)
 22209     CALL 'kxdfhei1' USING DFHEIV0,
 22210           DFHEIV1,
 22211           ORIGINAL-CERTIFICATE,
 22212           DFHEIV11,
 22213           OC-CONTROL-PRIMARY,
 22214           DFHEIV99,
 22215           DFHEIV99
 22216     MOVE EIBRESP  TO WS-RESPONSE
 22217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22218
 22219
 22220     GO TO 9991-EXIT.
 22221
 22222 9991-CHECK-INDICATORS.
 22223
 22224     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22225         GO TO 9991-EXIT
 22226     END-IF.
 22227
 22228     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22229         GO TO 9991-EXIT
 22230     END-IF.
 22231
 22232
 22233* EXEC CICS READ
 22234*       DATASET   ('ELCRTO')
 22235*       INTO      (ORIGINAL-CERTIFICATE)
 22236*       RIDFLD    (OC-CONTROL-PRIMARY)
 22237*       UPDATE
 22238*       RESP      (WS-RESPONSE)
 22239*    END-EXEC
 22240     MOVE LENGTH OF
 22241      ORIGINAL-CERTIFICATE
 22242       TO DFHEIV11
 22243     MOVE 'ELCRTO' TO DFHEIV1
 22244*    MOVE '&"IL       EU         (  N#00020520' TO DFHEIV0
 22245     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22246     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22247     MOVE X'204E233030303230353230' TO DFHEIV0(25:11)
 22248     CALL 'kxdfhei1' USING DFHEIV0,
 22249           DFHEIV1,
 22250           ORIGINAL-CERTIFICATE,
 22251           DFHEIV11,
 22252           OC-CONTROL-PRIMARY,
 22253           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 410
* EL050.cbl
 22254           DFHEIV99,
 22255           DFHEIV99
 22256     MOVE EIBRESP  TO WS-RESPONSE
 22257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22258     IF WS-RESP-NORMAL
 22259        IF PB-ISSUE
 22260          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22261          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22262          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22263          MOVE PB-I-AGE               TO OC-INS-AGE
 22264          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22265          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22266          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22267          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22268          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22269          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22270          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22271          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22272          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22273          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22274          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22275          IF PB-I-JOINT-COMMISSION > +0
 22276              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22277          ELSE
 22278              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22279          END-IF
 22280          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22281          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22282          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22283          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22284          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22285          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22286          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22287          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22288          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22289
 22290          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22291
 22292* EXEC CICS READ
 22293*             DATASET   (FILE-ERMAIL)
 22294*             RIDFLD    (MA-CONTROL-PRIMARY)
 22295*             INTO      (MAILING-DATA)
 22296*             RESP      (WS-RESPONSE)
 22297*         END-EXEC
 22298     MOVE LENGTH OF
 22299      MAILING-DATA
 22300       TO DFHEIV11
 22301*    MOVE '&"IL       E          (  N#00020560' TO DFHEIV0
 22302     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22304     MOVE X'204E233030303230353630' TO DFHEIV0(25:11)
 22305     CALL 'kxdfhei1' USING DFHEIV0,
 22306           FILE-ERMAIL,
 22307           MAILING-DATA,
 22308           DFHEIV11,
 22309           MA-CONTROL-PRIMARY,
 22310           DFHEIV99,
 22311           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 411
* EL050.cbl
 22312           DFHEIV99
 22313     MOVE EIBRESP  TO WS-RESPONSE
 22314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22315          IF WS-RESP-NORMAL
 22316             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22317          END-IF
 22318
 22319          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22320          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22321
 22322* EXEC CICS READ
 22323*             DATASET  (CRTT-ID)
 22324*             RIDFLD   (WS-ELCRTT-KEY)
 22325*             INTO     (CERTIFICATE-TRAILERS)
 22326*             RESP     (WS-RESPONSE)
 22327*         END-EXEC
 22328     MOVE LENGTH OF
 22329      CERTIFICATE-TRAILERS
 22330       TO DFHEIV11
 22331*    MOVE '&"IL       E          (  N#00020572' TO DFHEIV0
 22332     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22334     MOVE X'204E233030303230353732' TO DFHEIV0(25:11)
 22335     CALL 'kxdfhei1' USING DFHEIV0,
 22336           CRTT-ID,
 22337           CERTIFICATE-TRAILERS,
 22338           DFHEIV11,
 22339           WS-ELCRTT-KEY,
 22340           DFHEIV99,
 22341           DFHEIV99,
 22342           DFHEIV99
 22343     MOVE EIBRESP  TO WS-RESPONSE
 22344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22345          IF WS-RESP-NORMAL
 22346             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22347                               OC-INS-AGE-DEFAULT-FLAG
 22348             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22349                               OC-JNT-AGE-DEFAULT-FLAG
 22350          END-IF
 22351
 22352        ELSE
 22353          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22354             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22355             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22356             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22357          END-IF
 22358          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22359             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22360             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22361             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22362          END-IF
 22363          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22364        END-IF
 22365
 22366* EXEC CICS REWRITE
 22367*          DATASET   ('ELCRTO')
 22368*          FROM      (ORIGINAL-CERTIFICATE)
 22369*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 412
* EL050.cbl
 22370*       END-EXEC
 22371     MOVE LENGTH OF
 22372      ORIGINAL-CERTIFICATE
 22373       TO DFHEIV11
 22374     MOVE 'ELCRTO' TO DFHEIV1
 22375*    MOVE '&& L                  %  N#00020598' TO DFHEIV0
 22376     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22377     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22378     MOVE X'204E233030303230353938' TO DFHEIV0(25:11)
 22379     CALL 'kxdfhei1' USING DFHEIV0,
 22380           DFHEIV1,
 22381           ORIGINAL-CERTIFICATE,
 22382           DFHEIV11,
 22383           DFHEIV99
 22384     MOVE EIBRESP  TO WS-RESPONSE
 22385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22386     END-IF.
 22387
 22388 9991-EXIT.
 22389     EXIT.
 22390
 22391
 22392 9999-RETURN.
 22393     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22394
 22395
 22396* EXEC CICS RETURN
 22397*    END-EXEC.
 22398*    MOVE '.(                    ''   #00020612' TO DFHEIV0
 22399     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22401     MOVE X'2020233030303230363132' TO DFHEIV0(25:11)
 22402     CALL 'kxdfhei1' USING DFHEIV0,
 22403           DFHEIV99,
 22404           DFHEIV99,
 22405           DFHEIV99,
 22406           DFHEIV99,
 22407           DFHEIV99,
 22408           DFHEIV99
 22409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22410
 22411
 22412
 22413* GOBACK.
 22414     MOVE '9%                    "   ' TO DFHEIV0
 22415     MOVE 'EL050' TO DFHEIV1
 22416     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22417     GOBACK.
 22418
 22419 9999-DFHBACK SECTION.
 22420     MOVE '9%                    "   ' TO DFHEIV0
 22421     MOVE 'EL050' TO DFHEIV1
 22422     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22423     GOBACK.
 22424 9999-DFHEXIT.
 22425     IF DFHEIGDJ EQUAL 0001
 22426         NEXT SENTENCE
 22427     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 413
* EL050.cbl
 22428         GO TO 9300-ABEND,
 22429               3990-FILES-NOT-OPEN
 22430         DEPENDING ON DFHEIGDI
 22431     ELSE IF DFHEIGDJ EQUAL 3
 22432         GO TO 6610-START-BROWSE,
 22433               6630-ERRESS-PROBLEM,
 22434               6630-END-OF-FILE
 22435         DEPENDING ON DFHEIGDI
 22436     ELSE IF DFHEIGDJ EQUAL 4
 22437         GO TO 6630-END-OF-FILE,
 22438               6630-ERRESS-PROBLEM,
 22439               6630-ERRESS-PROBLEM,
 22440               6630-END-OF-FILE
 22441         DEPENDING ON DFHEIGDI
 22442     ELSE IF DFHEIGDJ EQUAL 5
 22443         GO TO 6630-END-OF-FILE,
 22444               6630-END-OF-FILE,
 22445               6630-ERRESS-PROBLEM,
 22446               6630-ERRESS-PROBLEM
 22447         DEPENDING ON DFHEIGDI
 22448     ELSE IF DFHEIGDJ EQUAL 6
 22449         GO TO 6660-START-BROWSE,
 22450               6690-ERRESC-PROBLEM,
 22451               6690-ERRESC-PROBLEM,
 22452               6690-END-OF-FILE
 22453         DEPENDING ON DFHEIGDI
 22454     ELSE IF DFHEIGDJ EQUAL 7
 22455         GO TO 6690-END-OF-FILE,
 22456               6690-ERRESC-PROBLEM,
 22457               6690-ERRESC-PROBLEM,
 22458               6690-END-OF-FILE
 22459         DEPENDING ON DFHEIGDI
 22460     ELSE IF DFHEIGDJ EQUAL 8
 22461         GO TO 6690-END-OF-FILE,
 22462               6690-ERRESC-PROBLEM,
 22463               6690-ERRESC-PROBLEM,
 22464               6690-END-OF-FILE
 22465         DEPENDING ON DFHEIGDI
 22466     ELSE IF DFHEIGDJ EQUAL 9
 22467         GO TO 7250-CONTINUE,
 22468               7250-CONTINUE
 22469         DEPENDING ON DFHEIGDI
 22470     ELSE IF DFHEIGDJ EQUAL 10
 22471         GO TO 7300-CONTINUE,
 22472               7300-CONTINUE
 22473         DEPENDING ON DFHEIGDI
 22474     ELSE IF DFHEIGDJ EQUAL 11
 22475         GO TO 8000-FREE-MAIN
 22476         DEPENDING ON DFHEIGDI
 22477     ELSE IF DFHEIGDJ EQUAL 12
 22478         GO TO 8100-NOTFND,
 22479               8100-NOTFND
 22480         DEPENDING ON DFHEIGDI
 22481     ELSE IF DFHEIGDJ EQUAL 13
 22482         GO TO 8110-NOTFND,
 22483               8110-NOTFND
 22484         DEPENDING ON DFHEIGDI
 22485     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 414
* EL050.cbl
 22486         GO TO 8130-EXIT
 22487         DEPENDING ON DFHEIGDI
 22488     ELSE IF DFHEIGDJ EQUAL 15
 22489         GO TO 8150-exit
 22490         DEPENDING ON DFHEIGDI
 22491     ELSE IF DFHEIGDJ EQUAL 16
 22492         GO TO 8180-NOTFND
 22493         DEPENDING ON DFHEIGDI
 22494     ELSE IF DFHEIGDJ EQUAL 17
 22495         GO TO 8190-NOTFND
 22496         DEPENDING ON DFHEIGDI
 22497     ELSE IF DFHEIGDJ EQUAL 18
 22498         GO TO 8195-NOTFND
 22499         DEPENDING ON DFHEIGDI
 22500     ELSE IF DFHEIGDJ EQUAL 19
 22501         GO TO 8200-NOTFND
 22502         DEPENDING ON DFHEIGDI
 22503     ELSE IF DFHEIGDJ EQUAL 20
 22504         GO TO 8300-NOTFND,
 22505               8300-ERRESS-PROBLEM,
 22506               8300-ERRESS-PROBLEM,
 22507               8300-NOTFND
 22508         DEPENDING ON DFHEIGDI
 22509     ELSE IF DFHEIGDJ EQUAL 21
 22510         GO TO 8450-FORM-NOT-FOUND,
 22511               8450-FORM-NOT-FOUND
 22512         DEPENDING ON DFHEIGDI
 22513     ELSE IF DFHEIGDJ EQUAL 22
 22514         GO TO 0199-ACCT-NOT-FOUND,
 22515               0199-ACCT-NOT-FOUND
 22516         DEPENDING ON DFHEIGDI
 22517     ELSE IF DFHEIGDJ EQUAL 23
 22518         GO TO 0199-ACCT-NOT-FOUND,
 22519               0199-ACCT-NOT-FOUND
 22520         DEPENDING ON DFHEIGDI
 22521     ELSE IF DFHEIGDJ EQUAL 24
 22522         GO TO 8582-COMP-NOT-FOUND,
 22523               8582-COMP-NOT-FOUND
 22524         DEPENDING ON DFHEIGDI
 22525     ELSE IF DFHEIGDJ EQUAL 25
 22526         GO TO 8583-AGTC-NOT-FOUND,
 22527               8583-AGTC-NOT-FOUND
 22528         DEPENDING ON DFHEIGDI
 22529     ELSE IF DFHEIGDJ EQUAL 26
 22530         GO TO 8584-BXRF-NOT-FOUND,
 22531               8584-BXRF-NOT-FOUND
 22532         DEPENDING ON DFHEIGDI
 22533     ELSE IF DFHEIGDJ EQUAL 27
 22534         GO TO 8585-PLAN-NOT-FOUND,
 22535               8585-PLAN-NOT-FOUND
 22536         DEPENDING ON DFHEIGDI
 22537     ELSE IF DFHEIGDJ EQUAL 28
 22538         GO TO 0299-CERT-NOT-FOUND
 22539         DEPENDING ON DFHEIGDI
 22540     ELSE IF DFHEIGDJ EQUAL 29
 22541         GO TO 8700-READ-CERT-MASTER
 22542         DEPENDING ON DFHEIGDI
 22543     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 415
* EL050.cbl
 22544         GO TO 8720-COMP-ACCOUNTS,
 22545               8730-END-BROWSE,
 22546               8740-NOT-FOUND
 22547         DEPENDING ON DFHEIGDI
 22548     ELSE IF DFHEIGDJ EQUAL 31
 22549         GO TO 9000-NOTFND
 22550         DEPENDING ON DFHEIGDI
 22551     ELSE IF DFHEIGDJ EQUAL 32
 22552         GO TO 9100-NOTFND,
 22553               9100-NOTFND
 22554         DEPENDING ON DFHEIGDI
 22555     ELSE IF DFHEIGDJ EQUAL 33
 22556         GO TO 9991-CRTO-NOT-FOUND,
 22557               9991-CRTO-NOT-FOUND
 22558         DEPENDING ON DFHEIGDI.
 22559     MOVE '9%                    "   ' TO DFHEIV0
 22560     MOVE 'EL050' TO DFHEIV1
 22561     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22562     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41464     Code:       91989
