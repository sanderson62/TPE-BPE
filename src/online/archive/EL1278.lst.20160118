* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    56* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    57* 050713  CR2011062300001  PEMA  REM CHG FOR EXT DYS FOR ROA REF
    58* 041514  CR2012110200003  AJRA  REMOVE PF11 FROM SCREEN,
    59*                                CANCEL QUOTE SCRIPT WILL DO PF11
    60******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   3
* EL1278.cbl
    62 ENVIRONMENT DIVISION.
    63 DATA DIVISION.
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66 77  FILLER  PIC  X(32) VALUE '********************************'.
    67 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    68 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    69 77  S1                          PIC S999 COMP-3 VALUE +0.
    70 77  P1                          PIC S999 COMP-3 VALUE +0.
    71 77  P2                          PIC S999 COMP-3 VALUE +0.
    72 77  C0                          PIC S999 COMP-3 VALUE +0.
    73 77  C1                          PIC S999 COMP-3 VALUE +0.
    74 77  C2                          PIC S999 COMP-3 VALUE +0.
    75 77  C3                          PIC S999 COMP-3 VALUE +0.
    76 77  WS-STOP-SW                  PIC X  VALUE ' '.
    77     88  I-SAY-TO-STOP      VALUE 'Y'.
    78 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    79     88  OPEN-LF-CLAIM              VALUE 'Y'.
    80 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    81     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    82 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    83     88  OPEN-AH-CLAIM              VALUE 'Y'.
    84 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    85     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    86 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    87     88  FOUND-A-CLAIM              VALUE 'Y'.
    88 77  WS-ST-REF-IND               PIC X.
    89 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    90 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    91 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    92 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    93 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    94 77  DD-IU-SW                    PIC X   VALUE ' '.
    95     88  DD-IU-PRESENT                 VALUE 'Y'.
    96 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   100 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   101 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   102 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   103 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   104 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   105     88  NO-CERT-RW                 VALUE 'N'.
   106     88  CERT-RW                    VALUE 'Y'.
   107 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   108     88  ERMAIL-FOUND                 VALUE 'Y'.
   109 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE ZERO.
   110
   111*                            COPY ELCSCTM.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCTM                             *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   119*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   4
* EL1278.cbl
   120******************************************************************
   121 01  SECURITY-MESSAGE.
   122     12  FILLER                          PIC X(30)
   123            VALUE '** LOGIC SECURITY VIOLATION -'.
   124     12  SM-READ                         PIC X(6).
   125     12  FILLER                          PIC X(5)
   126            VALUE ' PGM='.
   127     12  SM-PGM                          PIC X(6).
   128     12  FILLER                          PIC X(5)
   129            VALUE ' OPR='.
   130     12  SM-PROCESSOR-ID                 PIC X(4).
   131     12  FILLER                          PIC X(6)
   132            VALUE ' TERM='.
   133     12  SM-TERMID                       PIC X(4).
   134     12  FILLER                          PIC XX   VALUE SPACE.
   135     12  SM-JUL-DATE                     PIC 9(5).
   136     12  FILLER                          PIC X    VALUE SPACE.
   137     12  SM-TIME                         PIC 99.99.
   138
   139
   140*                            COPY ELCSCRTY.
   141******************************************************************
   142*                                                                *
   143*                                                                *
   144*                            ELCSCRTY                            *
   145*                            VMOD=2.001                          *
   146*                                                                *
   147*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   148*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   149*        SAVED IN PI-SECURITY-ADDRESS.                           *
   150*                                                                *
   151******************************************************************
   152 01  SECURITY-CONTROL.
   153     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   154     12  FILLER                       PIC XX    VALUE 'SC'.
   155     12  SC-CREDIT-CODES.
   156         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   157             20  SC-CREDIT-DISPLAY    PIC X.
   158             20  SC-CREDIT-UPDATE     PIC X.
   159     12  SC-CLAIMS-CODES.
   160         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   161             20  SC-CLAIMS-DISPLAY    PIC X.
   162             20  SC-CLAIMS-UPDATE     PIC X.
   163
   164 01  FILLER          COMP-3.
   165     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   166     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   167     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   168     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   169     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   170     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   171     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   172     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   173     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   174
   175 01  WS-DATE-AREA.
   176     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   177     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   5
* EL1278.cbl
   178     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   179     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   180     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   181     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   182
   183 01  ERPDEF-KEY-SAVE             PIC X(18).
   184 01  ERPDEF-KEY.
   185     12  ERPDEF-COMPANY-CD       PIC X.
   186     12  ERPDEF-STATE            PIC XX.
   187     12  ERPDEF-PROD-CD          PIC XXX.
   188     12  F                       PIC X(7).
   189     12  ERPDEF-BEN-TYPE         PIC X.
   190     12  ERPDEF-BEN-CODE         PIC XX.
   191     12  ERPDEF-EXP-DT           PIC XX.
   192 01  ELMSTR-KEY.
   193     12  ELMSTR-COMP-CD          PIC X.
   194     12  ELMSTR-CERT-NO          PIC X(11).
   195 01  ELCRTT-KEY.
   196     12  ELCRTT-PRIMARY          PIC X(33).
   197     12  ELCRTT-REC-TYPE         PIC X(1).
   198
   199 01  ELCRTO-KEY.
   200     05  ELCRTO-COMPANY-CD       PIC X.
   201     05  ELCRTO-CARRIER          PIC X.
   202     05  ELCRTO-GROUPING         PIC X(6).
   203     05  ELCRTO-STATE            PIC XX.
   204     05  ELCRTO-ACCOUNT          PIC X(10).
   205     05  ELCRTO-CERT-EFF-DT      PIC XX.
   206     05  ELCRTO-CERT-NO.
   207         10  ELCRTO-CERT-PRIME   PIC X(10).
   208         10  ELCRTO-CERT-SFX     PIC X.
   209     05  ELCRTO-RECORD-TYPE      PIC X.
   210     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   211
   212 01  STANDARD-AREAS.
   213     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   214     12  SUB3                    PIC S9(04) COMP VALUE +0.
   215     12  SUB4                    PIC S9(04) COMP VALUE +0.
   216     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   217     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   218     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   219     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   220     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   221     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   222     12  PGM-NAME                PIC  X(08).
   223     12  TIME-IN                 PIC S9(07).
   224     12  TIME-OUT-R  REDEFINES  TIME-IN.
   225         16  FILLER              PIC  X(01).
   226         16  TIME-OUT            PIC  9(02)V99.
   227         16  FILLER              PIC  X(02).
   228     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   229     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   230     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   231     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   232     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   233     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   234     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   235     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   6
* EL1278.cbl
   236     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   237     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   238     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   239     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   240     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   241     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   242     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   243     12  ELCRTT-ID               PIC  X(08)      VALUE 'ELCRTT'.
   244     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   245     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   246         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   247     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   248         88  BROWSE-STARTED                      VALUE 'Y'.
   249     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   250         88  FORM-FOUND                          VALUE 'Y'.
   251     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   252         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   253     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   254         88  WS-REDUCING                         VALUE 'R'.
   255         88  WS-LEVEL                            VALUE 'L'  'P'.
   256     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   257         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   258     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   259         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   260     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   261     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   262         'CLAIM PMTS'.
   263     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   264         'ITD REFUND'.
   265     12  WS-ACCESS.
   266         16  FILLER              PIC  X(02).
   267         16  WS-BEN-CD           PIC  X(02).
   268     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   269     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   270     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   271     12  WS-LOOKUP-TYPE          PIC  X(01).
   272     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   273     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   274     12  WS-CALC-CD              PIC  X(01).
   275     12  DEEDIT-FIELD            PIC  X(15).
   276     12  DEEDIT-FIELD-V0  REDEFINES
   277         DEEDIT-FIELD            PIC S9(15).
   278     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   279     12  RETURN-FROM             PIC  X(08).
   280     12  QID.
   281         16  QID-TERM            PIC  X(04).
   282         16  FILLER              PIC  X(04)      VALUE '127H'.
   283     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   284         88  FIRST-ENTRY                         VALUE 'Y'.
   285     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   286         88  PDEF-FOUND                          VALUE 'Y'.
   287     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   288         88  CERT-FOUND                          VALUE 'Y'.
   289         88  CERT-NOT-FOUND                      VALUE 'N'.
   290     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   291         88  CNTL-FOUND                          VALUE 'Y'.
   292         88  CNTL-NOT-FOUND                      VALUE 'N'.
   293     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   7
* EL1278.cbl
   294         88  BEN-FOUND                           VALUE 'Y'.
   295     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   296         88  STATE-FOUND                         VALUE 'Y'.
   297     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   298         88  ST-BEN-FOUND                        VALUE 'Y'.
   299     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   300         88  ACCT-FOUND                          VALUE 'Y'.
   301     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   302         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   303     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   304                                                 VALUE ZERO.
   305         88  BENEFIT-FOUND                       VALUE +1.
   306     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   307                                                 VALUE ZERO.
   308     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   309                                                 VALUE ZERO.
   310     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   311     12  WS-SUB1                 PIC S99    COMP.
   312     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   313     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   314     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   315     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   316     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   317     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   318     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   321     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   322     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   323     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   324     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   325     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   326     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   327     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   328     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   329     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   330     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   331     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   332     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   333     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   334     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   335     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   336     12  ERROR-MESSAGES.
   337         16  ER-0000             PIC  X(04)      VALUE '0000'.
   338         16  ER-0004             PIC  X(04)      VALUE '0004'.
   339         16  ER-0008             PIC  X(04)      VALUE '0008'.
   340         16  ER-0028             PIC  X(04)      VALUE '0028'.
   341         16  ER-0029             PIC  X(04)      VALUE '0029'.
   342         16  ER-0070             PIC  X(04)      VALUE '0070'.
   343         16  ER-0142             PIC  X(04)      VALUE '0142'.
   344         16  ER-0214             PIC  X(04)      VALUE '0214'.
   345         16  ER-0681             PIC  X(04)      VALUE '0681'.
   346         16  ER-0682             PIC  X(04)      VALUE '0682'.
   347         16  ER-0683             PIC  X(04)      VALUE '0683'.
   348         16  ER-0684             PIC  X(04)      VALUE '0684'.
   349         16  ER-2227             PIC  X(04)      VALUE '2227'.
   350         16  ER-2601             PIC  X(04)      VALUE '2601'.
   351         16  ER-2616             PIC  X(04)      VALUE '2616'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   8
* EL1278.cbl
   352         16  ER-2617             PIC  X(04)      VALUE '2617'.
   353         16  ER-2619             PIC  X(04)      VALUE '2619'.
   354         16  ER-2740             PIC  X(04)      VALUE '2740'.
   355         16  ER-2756             PIC  X(04)      VALUE '2756'.
   356         16  ER-2768             PIC  X(04)      VALUE '2768'.
   357         16  ER-2774             PIC  X(04)      VALUE '2774'.
   358         16  ER-2775             PIC  X(04)      VALUE '2775'.
   359         16  ER-2965             PIC  X(04)      VALUE '2965'.
   360         16  ER-2966             PIC  X(04)      VALUE '2966'.
   361         16  ER-2967             PIC  X(04)      VALUE '2967'.
   362         16  ER-2968             PIC  X(04)      VALUE '2968'.
   363         16  ER-2969             PIC  X(04)      VALUE '2969'.
   364         16  ER-3037             PIC  X(04)      VALUE '3037'.
   365         16  ER-3038             PIC  X(04)      VALUE '3038'.
   366         16  ER-3039             PIC  X(04)      VALUE '3039'.
   367         16  ER-3780             PIC  X(04)      VALUE '3780'.
   368         16  ER-3781             PIC  X(04)      VALUE '3781'.
   369         16  ER-3830             PIC  X(04)      VALUE '3830'.
   370         16  ER-8160             PIC  X(04)      VALUE '8160'.
   371         16  ER-8161             PIC  X(04)      VALUE '8161'.
   372         16  ER-9999             PIC  X(04)      VALUE '9999'.
   373     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   374     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   375     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   376     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   377
   378     12  WS-RESPONSE             PIC S9(8)       COMP.
   379         88  WS-RESP-NORMAL                      VALUE +00.
   380         88  WS-RESP-NOTFND                      VALUE +13.
   381         88  WS-RESP-DUPREC                      VALUE +14.
   382         88  WS-RESP-DUPKEY                      VALUE +15.
   383         88  WS-RESP-NOTOPEN                     VALUE +19.
   384         88  WS-RESP-ENDFILE                     VALUE +20.
   385
   386     12  WS-01-CANCEL-ERR        PIC X(25)
   387         VALUE 'CANCEL DATE ERROR'.
   388     12  WS-02-CANCEL-ERR        PIC X(25)
   389         VALUE 'CERT NOT FOUND'.
   390     12  WS-04-CANCEL-ERR        PIC X(25)
   391         VALUE 'CANCEL AMOUNT ERROR'.
   392     12  WS-05-CANCEL-ERR        PIC X(25)
   393         VALUE 'CANCEL OPTION ERROR'.
   394     12  WS-06-CANCEL-ERR        PIC X(25)
   395         VALUE 'PREVIOUSLY CANCELLED'.
   396     12  WS-07-CANCEL-ERR        PIC X(25)
   397         VALUE 'INVALID DATA'.
   398     12  WS-08-CANCEL-ERR        PIC X(25)
   399         VALUE 'NO ACCOUNT MASTER'.
   400     12  WS-09-CANCEL-ERR        PIC X(25)
   401         VALUE 'SUFFIX ALREADY EXISTS'.
   402     12  WS-99-CANCEL-ERR        PIC X(25)
   403         VALUE 'MISC CANCEL ERROR'.
   404
   405 01  WS-SAVE-ALLOWABLE-BENEFIT.
   406     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   407     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   408     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   409     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page   9
* EL1278.cbl
   410     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   411     16  FILLER                    PIC XX.
   412 01  CTBL-KEY-SAVE               PIC X(5).
   413 01  CTBL-KEY.
   414     05  CTBL-COMPANY-CD         PIC X.
   415     05  CTBL-TABLE              PIC XXX.
   416     05  CTBL-BEN-TYPE           PIC X.
   417     05  CTBL-BEN-CODE           PIC XX.
   418 01  CANCEL-GEN-PASS-AREA.
   419     05  CG-OPTION-CODE          PIC X.
   420         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   421         88  CG-FLAT-CANCEL        VALUE '1'.
   422         88  CG-CANCEL             VALUE '2'.
   423         88  CG-CANCEL-REISSUE     VALUE '3'.
   424     05  CG-ERROR-CODE           PIC 99.
   425         88  CG-SUCCESS            VALUE 00.
   426         88  CG-DATE-ERROR         VALUE 01.
   427         88  CG-CERT-NOT-FOUND     VALUE 02.
   428         88  CG-AMOUNT-ERROR       VALUE 04.
   429         88  CG-OPTION-ERROR       VALUE 05.
   430         88  CG-PREV-CAN           VALUE 06.
   431         88  CG-INVALID-DATA       VALUE 07.
   432         88  CG-NO-ACCT-MSTR       VALUE 08.
   433         88  CG-SFX-A-EXIST        VALUE 09.
   434         88  CG-MISC-ERROR         VALUE 99.
   435     05  CG-COMPANY-ID           PIC XXX.
   436     05  CG-PROC-ID              PIC XXXX.
   437     05  CG-CURRENT-DT           PIC XX.
   438     05  CG-MONTH-END-DT         PIC XX.
   439     05  CG-CERT-KEY.
   440         10  CG-CERT-COMPANY-CD  PIC X.
   441         10  CG-CERT-CARRIER     PIC X.
   442         10  CG-CERT-GROUP       PIC X(6).
   443         10  CG-CERT-STATE       PIC XX.
   444         10  CG-CERT-ACCOUNT     PIC X(10).
   445         10  CG-CERT-EFF-DT      PIC XX.
   446         10  CG-CERT-CERT-NO     PIC X(11).
   447     05  CG-LF-CAN-DATA.
   448         10  CG-LF-CAN-DT        PIC XX.
   449         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   450     05  CG-AH-CAN-DATA.
   451         10  CG-AH-CAN-DT        PIC XX.
   452         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   453     05  CG-CERT-PROFILE-DATA.
   454         10  CG-INS-LNAME        PIC X(15).
   455         10  CG-INS-FNAME        PIC X(10).
   456         10  CG-INS-MID-INIT     PIC X.
   457         10  CG-INS-AGE          PIC 99.
   458         10  CG-JNT-LNAME        PIC X(15).
   459         10  CG-JNT-FNAME        PIC X(10).
   460         10  CG-JNT-MID-INIT     PIC X.
   461         10  CG-JNT-AGE          PIC 99.
   462     05  CG-LF-ISS-DATA.
   463         10  CG-LF-BENCD         PIC XX.
   464         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   465         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   466     05  CG-AH-ISS-DATA.
   467         10  CG-AH-BENCD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  10
* EL1278.cbl
   468         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   469     05  CG-BATCH-NO             PIC X(6).
   470     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   471     05  FILLER                  PIC X(306).
   472 01  WS-CAN-QUOTE-NOTE.
   473     12  WS-CN-CANCEL-DT         PIC  X(09).
   474     12  FILLER                  PIC  X(10)      VALUE
   475         'RF QUOTE: '.
   476     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   477     12  FILLER                  PIC  X(4)       VALUE
   478         ' LF '.
   479     12  WS-CN-LF-REF-METH       PIC  X.
   480     12  FILLER                  PIC  X          VALUE ','.
   481     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   482     12  FILLER                  PIC  X(5)       VALUE
   483         ' AH '.
   484     12  WS-CN-AH-REF-METH       PIC  X.
   485     12  FILLER                  PIC  XX         VALUE ','.
   486     12  FILLER                  PIC  X(6)       VALUE
   487         'TOTAL '.
   488     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   489     12  FILLER                  PIC  X(01)      VALUE ' '.
   490     12  WS-CN-DT-QUOTED         PIC  X(08).
   491     12  FILLER                  PIC  X(01)      VALUE ';'.
   492     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   493
   494 01  WS-CM-CONTROL-PRIMARY.
   495     12  WS-CM-COMPANY-CD        PIC  X(01).
   496     12  WS-CM-CARRIER           PIC  X(01).
   497     12  WS-CM-GROUPING          PIC  X(06).
   498     12  WS-CM-STATE             PIC  X(02).
   499     12  WS-CM-ACCOUNT           PIC  X(10).
   500     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   501     12  WS-CM-CERT-NO.
   502         16  WS-CM-CERT-PRIME    PIC  X(10).
   503         16  WS-CM-CERT-SFX      PIC  X(01).
   504
   505 01  WS-MA-CONTROL-PRIMARY.
   506     12  WS-MA-COMPANY-CD        PIC  X(01).
   507     12  WS-MA-CARRIER           PIC  X(01).
   508     12  WS-MA-GROUPING          PIC  X(06).
   509     12  WS-MA-STATE             PIC  X(02).
   510     12  WS-MA-ACCOUNT           PIC  X(10).
   511     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   512     12  WS-MA-CERT-NO.
   513         16  WS-MA-CERT-PRIME    PIC  X(10).
   514         16  WS-MA-CERT-SFX      PIC  X(01).
   515 01  WS-CF-CONTROL-PRIMARY.
   516     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   517     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   518*        88  COMPANY-MASTER                      VALUE '1'.
   519*        88  STATE-MASTER                        VALUE '3'.
   520*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   521*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   522     12  WS-CF-ACCESS.
   523         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   524         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   525             20  FILLER          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  11
* EL1278.cbl
   526             20  WS-CF-CARRIER   PIC  X(01).
   527     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   528
   529 01  WS-AM-CONTROL-PRIMARY.
   530     12  WS-AM-COMPANY-CD        PIC  X(01).
   531     12  WS-AM-CARRIER           PIC  X(01).
   532     12  WS-AM-GROUPING          PIC  X(06).
   533     12  WS-AM-STATE             PIC  X(02).
   534     12  WS-AM-ACCOUNT           PIC  X(10).
   535     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   536     12  WS-AM-FILLER            PIC  X(04).
   537
   538 01  WS-CN-CONTROL-PRIMARY.
   539     12  WS-CN-COMPANY-CD        PIC  X(01).
   540     12  WS-CN-CARRIER           PIC  X(01).
   541     12  WS-CN-GROUPING          PIC  X(06).
   542     12  WS-CN-STATE             PIC  X(02).
   543     12  WS-CN-ACCOUNT           PIC  X(10).
   544     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   545     12  WS-CN-CERT-NO.
   546         16  WS-CN-CERT-PRIME    PIC  X(10).
   547         16  WS-CN-CERT-SFX      PIC  X.
   548     12  WS-CN-REC-TYPE          PIC X.
   549     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   550
   551 01  WS-FO-CONTROL-PRIMARY.
   552     12  WS-FO-COMPANY-CD        PIC  X(01).
   553     12  WS-FO-STATE             PIC  X(02).
   554     12  WS-FO-FORM-ID           PIC  X(12).
   555     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  12
* EL1278.cbl
   557*                            COPY ERCCNOT.
   558******************************************************************
   559*                                                                *
   560*                            ERCCNOT                             *
   561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   562*                            VMOD=2.003                          *
   563*                                                                *
   564*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   565*                                                                *
   566*        FILE TYPE= VSAM,KSDS                                    *
   567*        RECORD SIZE = 150    RECFORM = FIXED                    *
   568*                                                                *
   569*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   570*                                                                *
   571*        LOG = YES                                               *
   572*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   573*                                                                *
   574******************************************************************
   575*                   C H A N G E   L O G
   576*
   577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   578*-----------------------------------------------------------------
   579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   580* EFFECTIVE    NUMBER
   581*-----------------------------------------------------------------
   582* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   583******************************************************************
   584
   585 01  CERT-NOTE-FILE.
   586     12  CZ-RECORD-ID                PIC  XX.
   587         88  VALID-CZ-ID                  VALUE 'CZ'.
   588
   589     12  CZ-CONTROL-PRIMARY.
   590         16  CZ-COMPANY-CD           PIC X.
   591         16  CZ-CARRIER              PIC X.
   592         16  CZ-GROUPING.
   593             20 CZ-GROUPING-PREFIX   PIC XXX.
   594             20 CZ-GROUPING-PRIME    PIC XXX.
   595         16  CZ-STATE                PIC XX.
   596         16  CZ-ACCOUNT.
   597             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   598             20 CZ-ACCOUNT-PRIME     PIC X(6).
   599         16  CZ-CERT-EFF-DT          PIC XX.
   600         16  CZ-CERT-NO.
   601             20  CZ-CERT-PRIME       PIC X(10).
   602             20  CZ-CERT-SFX         PIC X.
   603         16  CZ-RECORD-TYPE          PIC X.
   604             88  CERT-NOTE           VALUE '1'.
   605             88  CLAIM-CERT-NOTE     VALUE '2'.
   606         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   607
   608     12  CZ-LAST-MAINT-DT            PIC XX.
   609     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   610     12  CZ-LAST-MAINT-USER          PIC X(4).
   611
   612     12  CZ-NOTE-INFORMATION.
   613         16  CZ-NOTE                 PIC X(63).
   614         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  13
* EL1278.cbl
   615******************************************************************
   616*                            COPY ELCDATE.
   617******************************************************************
   618*                                                                *
   619*                                                                *
   620*                            ELCDATE.                            *
   621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   622*                            VMOD=2.003
   623*                                                                *
   624*                                                                *
   625*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   626*                 LENGTH = 200                                   *
   627******************************************************************
   628
   629 01  DATE-CONVERSION-DATA.
   630     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   631     12  DC-OPTION-CODE                PIC X.
   632         88  BIN-TO-GREG                VALUE ' '.
   633         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   634         88  EDIT-GREG-TO-BIN           VALUE '2'.
   635         88  YMD-GREG-TO-BIN            VALUE '3'.
   636         88  MDY-GREG-TO-BIN            VALUE '4'.
   637         88  JULIAN-TO-BIN              VALUE '5'.
   638         88  BIN-PLUS-ELAPSED           VALUE '6'.
   639         88  FIND-CENTURY               VALUE '7'.
   640         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   641         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   642         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   643         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   644         88  JULIAN-TO-BIN-3            VALUE 'C'.
   645         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   646         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   647         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   648         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   649         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   650         88  CHECK-LEAP-YEAR            VALUE 'H'.
   651         88  BIN-3-TO-GREG              VALUE 'I'.
   652         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   653         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   654         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   655         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   656         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   657         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   658         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   659         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   660         88  THREE-CHARACTER-BIN
   661                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   662         88  GREGORIAN-TO-BIN
   663                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   664         88  BIN-TO-GREGORIAN
   665                  VALUES ' ' '1' 'I' '8' 'G'.
   666         88  JULIAN-TO-BINARY
   667                  VALUES '5' 'C' 'E' 'F'.
   668     12  DC-ERROR-CODE                 PIC X.
   669         88  NO-CONVERSION-ERROR        VALUE ' '.
   670         88  DATE-CONVERSION-ERROR
   671                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   672         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  14
* EL1278.cbl
   673         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   674         88  DATE-IS-INVALID            VALUE '3'.
   675         88  DATE1-GREATER-DATE2        VALUE '4'.
   676         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   677         88  DATE-INVALID-OPTION        VALUE '9'.
   678         88  INVALID-CENTURY            VALUE 'A'.
   679         88  ONLY-CENTURY               VALUE 'B'.
   680         88  ONLY-LEAP-YEAR             VALUE 'C'.
   681         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   682     12  DC-END-OF-MONTH               PIC X.
   683         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   684     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   685         88  USE-NORMAL-PROCESS         VALUE ' '.
   686         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   687         88  ADJUST-UP-100-YRS          VALUE '2'.
   688     12  FILLER                        PIC X.
   689     12  DC-CONVERSION-DATES.
   690         16  DC-BIN-DATE-1             PIC XX.
   691         16  DC-BIN-DATE-2             PIC XX.
   692         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   693         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   694                       DC-GREG-DATE-1-EDIT.
   695             20  DC-EDIT1-MONTH        PIC 99.
   696             20  SLASH1-1              PIC X.
   697             20  DC-EDIT1-DAY          PIC 99.
   698             20  SLASH1-2              PIC X.
   699             20  DC-EDIT1-YEAR         PIC 99.
   700         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   701         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   702                     DC-GREG-DATE-2-EDIT.
   703             20  DC-EDIT2-MONTH        PIC 99.
   704             20  SLASH2-1              PIC X.
   705             20  DC-EDIT2-DAY          PIC 99.
   706             20  SLASH2-2              PIC X.
   707             20  DC-EDIT2-YEAR         PIC 99.
   708         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   709         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   710                     DC-GREG-DATE-1-YMD.
   711             20  DC-YMD-YEAR           PIC 99.
   712             20  DC-YMD-MONTH          PIC 99.
   713             20  DC-YMD-DAY            PIC 99.
   714         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   715         16  DC-GREG-DATE-1-MDY-R REDEFINES
   716                      DC-GREG-DATE-1-MDY.
   717             20  DC-MDY-MONTH          PIC 99.
   718             20  DC-MDY-DAY            PIC 99.
   719             20  DC-MDY-YEAR           PIC 99.
   720         16  DC-GREG-DATE-1-ALPHA.
   721             20  DC-ALPHA-MONTH        PIC X(10).
   722             20  DC-ALPHA-DAY          PIC 99.
   723             20  FILLER                PIC XX.
   724             20  DC-ALPHA-CENTURY.
   725                 24 DC-ALPHA-CEN-N     PIC 99.
   726             20  DC-ALPHA-YEAR         PIC 99.
   727         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   728         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   729         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   730         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  15
* EL1278.cbl
   731         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   732                                       PIC 9(05).
   733         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   734             20  DC-JULIAN-YEAR        PIC 99.
   735             20  DC-JULIAN-DAYS        PIC 999.
   736         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   737         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   738         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   739     12  DATE-CONVERSION-VARIBLES.
   740         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   741         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   742             20  FILLER                PIC 9(3).
   743             20  HOLD-CEN-1-CCYY.
   744                 24  HOLD-CEN-1-CC     PIC 99.
   745                 24  HOLD-CEN-1-YY     PIC 99.
   746             20  HOLD-CEN-1-MO         PIC 99.
   747             20  HOLD-CEN-1-DA         PIC 99.
   748         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   749             20  HOLD-CEN-1-R-MO       PIC 99.
   750             20  HOLD-CEN-1-R-DA       PIC 99.
   751             20  HOLD-CEN-1-R-CCYY.
   752                 24  HOLD-CEN-1-R-CC   PIC 99.
   753                 24  HOLD-CEN-1-R-YY   PIC 99.
   754             20  FILLER                PIC 9(3).
   755         16  HOLD-CENTURY-1-X.
   756             20  FILLER                PIC X(3)  VALUE SPACES.
   757             20  HOLD-CEN-1-X-CCYY.
   758                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   759                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   760             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   761             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   762         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   763             20  HOLD-CEN-1-R-X-MO     PIC XX.
   764             20  HOLD-CEN-1-R-X-DA     PIC XX.
   765             20  HOLD-CEN-1-R-X-CCYY.
   766                 24  HOLD-CEN-1-R-X-CC PIC XX.
   767                 24  HOLD-CEN-1-R-X-YY PIC XX.
   768             20  FILLER                PIC XXX.
   769         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   770         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   771         16  DC-JULIAN-DATE-1          PIC 9(07).
   772         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   773             20  DC-JULIAN-1-CCYY.
   774                 24  DC-JULIAN-1-CC    PIC 99.
   775                 24  DC-JULIAN-1-YR    PIC 99.
   776             20  DC-JULIAN-DA-1        PIC 999.
   777         16  DC-JULIAN-DATE-2          PIC 9(07).
   778         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   779             20  DC-JULIAN-2-CCYY.
   780                 24  DC-JULIAN-2-CC    PIC 99.
   781                 24  DC-JULIAN-2-YR    PIC 99.
   782             20  DC-JULIAN-DA-2        PIC 999.
   783         16  DC-GREG-DATE-A-EDIT.
   784             20  DC-EDITA-MONTH        PIC 99.
   785             20  SLASHA-1              PIC X VALUE '/'.
   786             20  DC-EDITA-DAY          PIC 99.
   787             20  SLASHA-2              PIC X VALUE '/'.
   788             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  16
* EL1278.cbl
   789                 24  DC-EDITA-CENT     PIC 99.
   790                 24  DC-EDITA-YEAR     PIC 99.
   791         16  DC-GREG-DATE-B-EDIT.
   792             20  DC-EDITB-MONTH        PIC 99.
   793             20  SLASHB-1              PIC X VALUE '/'.
   794             20  DC-EDITB-DAY          PIC 99.
   795             20  SLASHB-2              PIC X VALUE '/'.
   796             20  DC-EDITB-CCYY.
   797                 24  DC-EDITB-CENT     PIC 99.
   798                 24  DC-EDITB-YEAR     PIC 99.
   799         16  DC-GREG-DATE-CYMD         PIC 9(08).
   800         16  DC-GREG-DATE-CYMD-R REDEFINES
   801                              DC-GREG-DATE-CYMD.
   802             20  DC-CYMD-CEN           PIC 99.
   803             20  DC-CYMD-YEAR          PIC 99.
   804             20  DC-CYMD-MONTH         PIC 99.
   805             20  DC-CYMD-DAY           PIC 99.
   806         16  DC-GREG-DATE-MDCY         PIC 9(08).
   807         16  DC-GREG-DATE-MDCY-R REDEFINES
   808                              DC-GREG-DATE-MDCY.
   809             20  DC-MDCY-MONTH         PIC 99.
   810             20  DC-MDCY-DAY           PIC 99.
   811             20  DC-MDCY-CEN           PIC 99.
   812             20  DC-MDCY-YEAR          PIC 99.
   813    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   814        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   815    12  DC-EL310-DATE                  PIC X(21).
   816    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  17
* EL1278.cbl
   818*                            COPY ELCLOGOF.
   819******************************************************************
   820*                                                                *
   821*                                                                *
   822*                            ELCLOGOF.                           *
   823*                            VMOD=2.001                          *
   824*                                                                *
   825*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   826*                                                                *
   827******************************************************************
   828 01  CLASIC-LOGOFF.
   829     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   830     12  LOGOFF-TEXT.
   831         16  FILLER          PIC X(5)    VALUE SPACES.
   832         16  LOGOFF-MSG.
   833             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   834             20  FILLER      PIC X       VALUE SPACES.
   835             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   836         16  FILLER          PIC X(80)
   837           VALUE '* YOU ARE NOW LOGGED OFF'.
   838         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   839         16  FILLER          PIC X       VALUE QUOTE.
   840         16  LOGOFF-SYS-MSG  PIC X(17)
   841           VALUE 'S CLAS-IC SYSTEM '.
   842     12  TEXT-MESSAGES.
   843         16  UNACCESS-MSG    PIC X(29)
   844             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   845         16  PGMIDERR-MSG    PIC X(17)
   846             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  18
* EL1278.cbl
   848*                            COPY ELCATTR.
   849******************************************************************
   850*                                                                *
   851*                            ELCATTR.                            *
   852*                            VMOD=2.001                          *
   853*                                                                *
   854*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   855*                                                                *
   856*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   857*                                                                *
   858*                   POS 1   P=PROTECTED                          *
   859*                           U=UNPROTECTED                        *
   860*                           S=ASKIP                              *
   861*                   POS 2   A=ALPHA/NUMERIC                      *
   862*                           N=NUMERIC                            *
   863*                   POS 3   N=NORMAL                             *
   864*                           B=BRIGHT                             *
   865*                           D=DARK                               *
   866*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   867*                           OF=MODIFIED DATA TAG OFF             *
   868*                                                                *
   869*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   870******************************************************************
   871 01  ATTRIBUTE-LIST.
   872     12  AL-PABOF            PIC X       VALUE 'Y'.
   873     12  AL-PABON            PIC X       VALUE 'Z'.
   874     12  AL-PADOF            PIC X       VALUE '%'.
   875     12  AL-PADON            PIC X       VALUE '_'.
   876     12  AL-PANOF            PIC X       VALUE '-'.
   877     12  AL-PANON            PIC X       VALUE '/'.
   878     12  AL-SABOF            PIC X       VALUE '8'.
   879     12  AL-SABON            PIC X       VALUE '9'.
   880     12  AL-SADOF            PIC X       VALUE '@'.
   881     12  AL-SADON            PIC X       VALUE QUOTE.
   882     12  AL-SANOF            PIC X       VALUE '0'.
   883     12  AL-SANON            PIC X       VALUE '1'.
   884     12  AL-UABOF            PIC X       VALUE 'H'.
   885     12  AL-UABON            PIC X       VALUE 'I'.
   886     12  AL-UADOF            PIC X       VALUE '<'.
   887     12  AL-UADON            PIC X       VALUE '('.
   888     12  AL-UANOF            PIC X       VALUE ' '.
   889     12  AL-UANON            PIC X       VALUE 'A'.
   890     12  AL-UNBOF            PIC X       VALUE 'Q'.
   891     12  AL-UNBON            PIC X       VALUE 'R'.
   892     12  AL-UNDOF            PIC X       VALUE '*'.
   893     12  AL-UNDON            PIC X       VALUE ')'.
   894     12  AL-UNNOF            PIC X       VALUE '&'.
   895     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  19
* EL1278.cbl
   897*                            COPY ELCEMIB.
   898******************************************************************
   899*                                                                *
   900*                                                                *
   901*                            ELCEMIB.                            *
   902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   903*                            VMOD=2.005                          *
   904*                                                                *
   905*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   906*                                                                *
   907******************************************************************
   908 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   909     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   910     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   911     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   912     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   913     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   914     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   915     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   916     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   917     12  EMI-SWITCH1             PIC X        VALUE '1'.
   918         88  EMI-NO-ERRORS                    VALUE '1'.
   919         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   920         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   921     12  EMI-SWITCH2             PIC X        VALUE '1'.
   922         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   923     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   924         88  EMI-AREA1-EMPTY                  VALUE '1'.
   925         88  EMI-AREA1-FULL                   VALUE '2'.
   926     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   927         88  EMI-AREA2-EMPTY                  VALUE '1'.
   928         88  EMI-AREA2-FULL                   VALUE '2'.
   929     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   930         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   931         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   932         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   933         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   934         88  EMI-BYPASS-FATALS                VALUE 'X'.
   935     12  EMI-ERROR-LINES.
   936         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   937         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   938         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   939         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   940             20  EMI-ERR-CODES OCCURS 10 TIMES.
   941                 24  EMI-ERR-NUM         PIC X(4).
   942                 24  EMI-FILLER          PIC X.
   943                 24  EMI-SEV             PIC X.
   944                 24  FILLER              PIC X.
   945             20  FILLER                  PIC X(02).
   946     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   947         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   948             20  EMI-ERROR-NUMBER    PIC X(4).
   949             20  EMI-FILL            PIC X.
   950             20  EMI-SEVERITY        PIC X.
   951             20  FILLER              PIC X.
   952             20  EMI-ERROR-TEXT.
   953                 24  EMI-TEXT-VARIABLE   PIC X(10).
   954                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  20
* EL1278.cbl
   955     12  EMI-SEVERITY-SAVE           PIC X.
   956         88  EMI-NOTE                    VALUE 'N'.
   957         88  EMI-WARNING                 VALUE 'W'.
   958         88  EMI-FORCABLE                VALUE 'F'.
   959         88  EMI-FATAL                   VALUE 'X'.
   960     12  EMI-MESSAGE-FLAG            PIC X.
   961         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   962         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   963     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   964     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   965         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   966         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   967         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   968     12  emi-claim-no                pic x(7).
   969     12  emi-claim-type              pic x(6).
   970     12  FILLER                      PIC X(124)  VALUE SPACES.
   971     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   972     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   973     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   974     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  21
* EL1278.cbl
   976 01  WS-PASS-631.
   977     12  WS-PASS-WORK-AREA         PIC X(384).
   978     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   979     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   980*        COPY ELC631PI.
   981******************************************************************
   982*                                                                *
   983*                                                                *
   984*                            ELC631PI                            *
   985*                            VMOD=2.012                          *
   986*                                                                *
   987*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   988*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   989*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   990*                                                                *
   991*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   992*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   993*    BETWEEN PROGRAMS.                                           *
   994*                                                                *
   995*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   996*                                                                *
   997*               EL631 - EL6311 - EL6312 - EL6313                 *
   998*                                                                *
   999******************************************************************
  1000*                   C H A N G E   L O G
  1001*
  1002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1003*-----------------------------------------------------------------
  1004*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1005* EFFECTIVE    NUMBER
  1006*-----------------------------------------------------------------
  1007* 021414    2003053000001  PEMA  changes for auto chk request
  1008******************************************************************
  1009
  1010         16  PI-631-DATA.
  1011             20  PI-ERPNDB-KEY.
  1012                 24  PI-PB-COMPANY-CD     PIC X.
  1013                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1014                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1015                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1016
  1017             20  PI-ERPNDB-ALT-KEY.
  1018                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1019                 24  PI-PB-CARRIER        PIC X.
  1020                 24  PI-PB-GROUPING       PIC X(6).
  1021                 24  PI-PB-STATE          PIC XX.
  1022                 24  PI-PB-ACCOUNT        PIC X(10).
  1023                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1024                 24  PI-PB-CERT-NO.
  1025                     28  PI-PB-CERT-PRIME PIC X(10).
  1026                     28  PI-PB-CERT-SFX   PIC X.
  1027                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1028                 24  PI-PB-RECORD-TYPE    PIC X.
  1029
  1030             20  PI-ERPNDB-CSR-KEY.
  1031                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1032                 24  PI-PB-CSR-ID             PIC X(4).
  1033                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  22
* EL1278.cbl
  1034                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1035                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1036
  1037             20  PI-BROWSE-TYPE               PIC X.
  1038                 88  PI-FILE-BROWSE             VALUE ' '.
  1039                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1040                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1041                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1042                 88  PI-CSR-BROWSE              VALUE '4'.
  1043
  1044             20  PI-MAINT-FUNCTION            PIC X.
  1045                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1046                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1047                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1048                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1049                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1050                 88  PI-PF5-FUNCTION            VALUE '5'.
  1051                 88  PI-PF6-FUNCTION            VALUE '6'.
  1052
  1053             20  PI-FILE-SWITCHES.
  1054                 24  PI-ALL-ISSUES-SW         PIC X.
  1055                     88  ALL-ISSUES             VALUE 'Y'.
  1056                 24  PI-ALL-CANCELS-SW        PIC X.
  1057                     88  ALL-CANCELS            VALUE 'Y'.
  1058                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1059                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1060                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1061                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1062                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1063                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1064                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1065                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1066                 24  PI-HOLD-REC-SW           PIC X.
  1067                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1068                 24  PI-CHANGE-REC-SW         PIC X.
  1069                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1070                 24  PI-CHK-REQ-REC-SW        PIC X.
  1071                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1072                 24  PI-ISSUE-WARNING-SW      PIC X.
  1073                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1074                 24  PI-CANCEL-WARNING-SW     PIC X.
  1075                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1076             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1077                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1078             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1079                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1080
  1081             20  PI-MAP-NAME                  PIC X(8).
  1082
  1083             20  PI-CURSOR                    PIC S9(4) COMP.
  1084
  1085             20  PI-PREV-ALT-KEY              PIC X(36).
  1086             20  PI-PREV-CSR-KEY              PIC X(15).
  1087             20  PI-PREV-KEY.
  1088                 24  PI-PREV-COMPANY-CD       PIC X.
  1089                 24  PI-PREV-BATCH            PIC X(6).
  1090                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1091                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  23
* EL1278.cbl
  1092             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1093             20  PI-BROWSE-SW                 PIC X.
  1094                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1095                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1096             20  PI-SV-CARRIER                PIC X.
  1097             20  PI-SV-GROUPING               PIC X(6).
  1098             20  PI-SV-STATE                  PIC XX.
  1099             20  PI-EDIT-SW                   PIC X.
  1100             20  PI-DISPLAY-SW                PIC XX.
  1101                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1102                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1103             20  PI-CRITERIA-DATA             PIC X(350).
  1104             20  PI-BMODE                     PIC X.
  1105             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1106             20  PI-BPMTS                     PIC S999     COMP-3.
  1107             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1108             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1109             20  PI-CSR-SESSION-SW            PIC X.
  1110                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1111             20  PI-ERRORS-SW                 PIC X.
  1112                 88  FATAL-ERRORS               VALUE 'X'.
  1113*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1114             20  pi-unforced-sw               pic x.
  1115                 88  unforced-errors            value 'X'.
  1116             20  FILLER                       PIC X(4).
  1117
  1118         16  FILLER                PIC X(94).
  1119
  1120
  1121*                            COPY ELCINTF.
  1122******************************************************************
  1123*                                                                *
  1124*                                                                *
  1125*                            ELCINTF.                            *
  1126*                            VMOD=2.017                          *
  1127*                                                                *
  1128*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1129*                                                                *
  1130*       LENGTH = 1024                                            *
  1131*                                                                *
  1132******************************************************************
  1133*                   C H A N G E   L O G
  1134*
  1135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1136*-----------------------------------------------------------------
  1137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1138* EFFECTIVE    NUMBER
  1139*-----------------------------------------------------------------
  1140* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1141******************************************************************
  1142 01  PROGRAM-INTERFACE-BLOCK.
  1143     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1144     12  PI-CALLING-PROGRAM              PIC X(8).
  1145     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1146     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1147     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1148     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1149     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  24
* EL1278.cbl
  1150     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1151     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1152     12  PI-COMPANY-ID                   PIC XXX.
  1153     12  PI-COMPANY-CD                   PIC X.
  1154
  1155     12  PI-COMPANY-PASSWORD             PIC X(8).
  1156
  1157     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1158
  1159     12  PI-CONTROL-IN-PROGRESS.
  1160         16  PI-CARRIER                  PIC X.
  1161         16  PI-GROUPING                 PIC X(6).
  1162         16  PI-STATE                    PIC XX.
  1163         16  PI-ACCOUNT                  PIC X(10).
  1164         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1165                                         PIC X(10).
  1166         16  PI-CLAIM-CERT-GRP.
  1167             20  PI-CLAIM-NO             PIC X(7).
  1168             20  PI-CERT-NO.
  1169                 25  PI-CERT-PRIME       PIC X(10).
  1170                 25  PI-CERT-SFX         PIC X.
  1171             20  PI-CERT-EFF-DT          PIC XX.
  1172         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1173             20  PI-PLAN-CODE            PIC X(2).
  1174             20  PI-REVISION-NUMBER      PIC X(3).
  1175             20  PI-PLAN-EFF-DT          PIC X(2).
  1176             20  PI-PLAN-EXP-DT          PIC X(2).
  1177             20  FILLER                  PIC X(11).
  1178         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1179             20  PI-OE-REFERENCE-1.
  1180                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1181                 25  PI-OE-REF-1-SUFF    PIC XX.
  1182
  1183     12  PI-SESSION-IN-PROGRESS          PIC X.
  1184         88  CLAIM-SESSION                   VALUE '1'.
  1185         88  CREDIT-SESSION                  VALUE '2'.
  1186         88  WARRANTY-SESSION                VALUE '3'.
  1187         88  MORTGAGE-SESSION                VALUE '4'.
  1188         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1189
  1190
  1191*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1192
  1193     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1194     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1195
  1196     12  PI-CREDIT-USER                  PIC X.
  1197         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1198         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1199
  1200     12  PI-CLAIM-USER                   PIC X.
  1201         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1202         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1203
  1204     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1205         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1206         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1207         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  25
* EL1278.cbl
  1208         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1209         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1210
  1211     12  PI-PROCESSOR-ID                 PIC X(4).
  1212
  1213     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1214
  1215     12  PI-MEMBER-CAPTION               PIC X(10).
  1216
  1217     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1218         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1219
  1220     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1221     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1222     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1223     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1224
  1225     12  PI-AH-OVERRIDE-L1               PIC X.
  1226     12  PI-AH-OVERRIDE-L2               PIC XX.
  1227     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1228     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1229
  1230     12  PI-NEW-SYSTEM                   PIC X(2).
  1231
  1232     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1233     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1234         88  PI-USES-PAID-TO                 VALUE '1'.
  1235     12  PI-CRDTCRD-SYSTEM.
  1236         16  PI-CRDTCRD-USER             PIC X.
  1237             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1238             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1239         16  PI-CC-MONTH-END-DT          PIC XX.
  1240     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1241
  1242     12  PI-OE-REFERENCE-2.
  1243         16  PI-OE-REF-2-PRIME           PIC X(10).
  1244         16  PI-OE-REF-2-SUFF            PIC X.
  1245
  1246     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1247
  1248     12  PI-LANGUAGE-TYPE                PIC X.
  1249             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1250             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1251             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1252
  1253     12  PI-POLICY-LINKAGE-IND           PIC X.
  1254         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1255         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1256                                                   LOW-VALUES.
  1257
  1258     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1259     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1260         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1261         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1262
  1263     12  PI-PROCESSOR-CSR-IND            PIC X.
  1264         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1265         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  26
* EL1278.cbl
  1266
  1267     12  FILLER                          PIC X(3).
  1268
  1269     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1270
  1271     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1272         PI-SYSTEM-LEVEL.
  1273
  1274         16  PI-ENTRY-CODES.
  1275             20  PI-ENTRY-CD-1           PIC X.
  1276             20  PI-ENTRY-CD-2           PIC X.
  1277
  1278         16  PI-RETURN-CODES.
  1279             20  PI-RETURN-CD-1          PIC X.
  1280             20  PI-RETURN-CD-2          PIC X.
  1281
  1282         16  PI-UPDATE-STATUS-SAVE.
  1283             20  PI-UPDATE-BY            PIC X(4).
  1284             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1285
  1286         16  PI-LOWER-CASE-LETTERS       PIC X.
  1287             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1288
  1289*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1290*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1291*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1292
  1293         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1294             88  ST-ACCNT-CNTL               VALUE ' '.
  1295             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1296             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1297             88  ACCNT-CNTL                  VALUE '3'.
  1298             88  CARR-ACCNT-CNTL             VALUE '4'.
  1299
  1300         16  PI-PROCESSOR-CAP-LIST.
  1301             20  PI-SYSTEM-CONTROLS.
  1302                24 PI-SYSTEM-DISPLAY     PIC X.
  1303                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1304                24 PI-SYSTEM-MODIFY      PIC X.
  1305                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1306             20  FILLER                  PIC XX.
  1307             20  PI-DISPLAY-CAP          PIC X.
  1308                 88  DISPLAY-CAP             VALUE 'Y'.
  1309             20  PI-MODIFY-CAP           PIC X.
  1310                 88  MODIFY-CAP              VALUE 'Y'.
  1311             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1312                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1313             20  PI-FORCE-CAP            PIC X.
  1314                 88  FORCE-CAP               VALUE 'Y'.
  1315
  1316         16  PI-PROGRAM-CONTROLS.
  1317             20  PI-PGM-PRINT-OPT        PIC X.
  1318             20  PI-PGM-FORMAT-OPT       PIC X.
  1319             20  PI-PGM-PROCESS-OPT      PIC X.
  1320             20  PI-PGM-TOTALS-OPT       PIC X.
  1321
  1322         16  PI-HELP-INTERFACE.
  1323             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  27
* EL1278.cbl
  1324             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1325
  1326         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1327             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1328
  1329         16  PI-CR-CONTROL-IN-PROGRESS.
  1330             20  PI-CR-CARRIER           PIC X.
  1331             20  PI-CR-GROUPING          PIC X(6).
  1332             20  PI-CR-STATE             PIC XX.
  1333             20  PI-CR-ACCOUNT           PIC X(10).
  1334             20  PI-CR-FIN-RESP          PIC X(10).
  1335             20  PI-CR-TYPE              PIC X.
  1336
  1337         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1338
  1339         16  PI-CR-MONTH-END-DT          PIC XX.
  1340
  1341         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1342             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1343             88  PI-ZERO-CARRIER             VALUE '1'.
  1344             88  PI-ZERO-GROUPING            VALUE '2'.
  1345             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1346
  1347         16  PI-CARRIER-SECURITY         PIC X.
  1348             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1349
  1350         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1351             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1352             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1353
  1354         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1355             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1356                                         INDEXED BY PI-ACCESS-NDX
  1357                                         PIC X.
  1358
  1359         16  PI-GA-BILLING-CONTROL       PIC X.
  1360             88  PI-GA-BILLING               VALUE '1'.
  1361
  1362         16  PI-MAIL-PROCESSING          PIC X.
  1363             88  PI-MAIL-YES                 VALUE 'Y'.
  1364
  1365         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1366
  1367         16  PI-AR-SYSTEM.
  1368             20  PI-AR-PROCESSING-CNTL   PIC X.
  1369                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1370             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1371             20  PI-AR-MONTH-END-DT      PIC XX.
  1372
  1373         16  PI-MP-SYSTEM.
  1374             20  PI-MORTGAGE-USER            PIC X.
  1375                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1376                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1377             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1378                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1379                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1380                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1381                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  28
* EL1278.cbl
  1382                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1383             20  PI-MP-MONTH-END-DT          PIC XX.
  1384             20  PI-MP-REFERENCE-NO.
  1385                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1386                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1387
  1388         16  PI-LABEL-CONTROL            PIC X(01).
  1389             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1390             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1391
  1392         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1393             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1394
  1395         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1396             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1397             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1398
  1399         16  FILLER                      PIC X(14).
  1400
  1401     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1402******************************************************************
  1403     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1404         16  FILLER                PIC  X(500).
  1405         16  PI-PEND-SW            PIC  X(01).
  1406         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1407         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1408         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1409         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1410         16  PI-EARNING-METHOD-LF  PIC  X.
  1411         16  PI-EARNING-METHOD-AH  PIC  X.
  1412         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1413         16  PI-LF-REFUND-METH     PIC  X.
  1414         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1415         16  PI-AH-REFUND-METH     PIC  X.
  1416         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1417         16  PI-MODIFY-CERT-CAP    PIC  X.
  1418             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1419         16  PI-CLP-YN             PIC X.
  1420         16  PI-CANCEL-REASON      PIC X.
  1421         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  29
* EL1278.cbl
  1423*                            COPY ELCAID.
  1424******************************************************************
  1425*                                                                *
  1426*                            ELCAID.                             *
  1427*                            VMOD=2.001                          *
  1428*                                                                *
  1429*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1430*                                                                *
  1431*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1432*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1433******************************************************************
  1434
  1435 01  DFHAID.
  1436   02  DFHNULL   PIC  X  VALUE  ' '.
  1437   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1438   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1439   02  DFHPEN    PIC  X  VALUE  '='.
  1440   02  DFHOPID   PIC  X  VALUE  'W'.
  1441   02  DFHPA1    PIC  X  VALUE  '%'.
  1442   02  DFHPA2    PIC  X  VALUE  '>'.
  1443   02  DFHPA3    PIC  X  VALUE  ','.
  1444   02  DFHPF1    PIC  X  VALUE  '1'.
  1445   02  DFHPF2    PIC  X  VALUE  '2'.
  1446   02  DFHPF3    PIC  X  VALUE  '3'.
  1447   02  DFHPF4    PIC  X  VALUE  '4'.
  1448   02  DFHPF5    PIC  X  VALUE  '5'.
  1449   02  DFHPF6    PIC  X  VALUE  '6'.
  1450   02  DFHPF7    PIC  X  VALUE  '7'.
  1451   02  DFHPF8    PIC  X  VALUE  '8'.
  1452   02  DFHPF9    PIC  X  VALUE  '9'.
  1453   02  DFHPF10   PIC  X  VALUE  ':'.
  1454   02  DFHPF11   PIC  X  VALUE  '#'.
  1455   02  DFHPF12   PIC  X  VALUE  '@'.
  1456   02  DFHPF13   PIC  X  VALUE  'A'.
  1457   02  DFHPF14   PIC  X  VALUE  'B'.
  1458   02  DFHPF15   PIC  X  VALUE  'C'.
  1459   02  DFHPF16   PIC  X  VALUE  'D'.
  1460   02  DFHPF17   PIC  X  VALUE  'E'.
  1461   02  DFHPF18   PIC  X  VALUE  'F'.
  1462   02  DFHPF19   PIC  X  VALUE  'G'.
  1463   02  DFHPF20   PIC  X  VALUE  'H'.
  1464   02  DFHPF21   PIC  X  VALUE  'I'.
  1465*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1466   02  DFHPF22   PIC  X  VALUE  '['.
  1467   02  DFHPF23   PIC  X  VALUE  '.'.
  1468   02  DFHPF24   PIC  X  VALUE  '<'.
  1469   02  DFHMSRE   PIC  X  VALUE  'X'.
  1470   02  DFHSTRF   PIC  X  VALUE  'h'.
  1471   02  DFHTRIG   PIC  X  VALUE  '"'.
  1472
  1473 01  FILLER  REDEFINES  DFHAID.
  1474     12  FILLER                  PIC  X(08).
  1475     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  30
* EL1278.cbl
  1477*                            COPY EL1278S.
  1478 01  EL127HI.
  1479     05  FILLER            PIC  X(0012).
  1480*    -------------------------------
  1481     05  HDATEL PIC S9(0004) COMP.
  1482     05  HDATEF PIC  X(0001).
  1483     05  FILLER REDEFINES HDATEF.
  1484         10  HDATEA PIC  X(0001).
  1485     05  HDATEI PIC  X(0008).
  1486*    -------------------------------
  1487     05  HTIMEL PIC S9(0004) COMP.
  1488     05  HTIMEF PIC  X(0001).
  1489     05  FILLER REDEFINES HTIMEF.
  1490         10  HTIMEA PIC  X(0001).
  1491     05  HTIMEI PIC  999V99.
  1492*    -------------------------------
  1493     05  CMPNYIDL PIC S9(0004) COMP.
  1494     05  CMPNYIDF PIC  X(0001).
  1495     05  FILLER REDEFINES CMPNYIDF.
  1496         10  CMPNYIDA PIC  X(0001).
  1497     05  CMPNYIDI PIC  X(0003).
  1498*    -------------------------------
  1499     05  USERIDL PIC S9(0004) COMP.
  1500     05  USERIDF PIC  X(0001).
  1501     05  FILLER REDEFINES USERIDF.
  1502         10  USERIDA PIC  X(0001).
  1503     05  USERIDI PIC  X(0004).
  1504*    -------------------------------
  1505     05  HCARIERL PIC S9(0004) COMP.
  1506     05  HCARIERF PIC  X(0001).
  1507     05  FILLER REDEFINES HCARIERF.
  1508         10  HCARIERA PIC  X(0001).
  1509     05  HCARIERI PIC  X(0001).
  1510*    -------------------------------
  1511     05  HGROUPL PIC S9(0004) COMP.
  1512     05  HGROUPF PIC  X(0001).
  1513     05  FILLER REDEFINES HGROUPF.
  1514         10  HGROUPA PIC  X(0001).
  1515     05  HGROUPI PIC  X(0006).
  1516*    -------------------------------
  1517     05  HSTATEL PIC S9(0004) COMP.
  1518     05  HSTATEF PIC  X(0001).
  1519     05  FILLER REDEFINES HSTATEF.
  1520         10  HSTATEA PIC  X(0001).
  1521     05  HSTATEI PIC  X(0002).
  1522*    -------------------------------
  1523     05  HACCTNOL PIC S9(0004) COMP.
  1524     05  HACCTNOF PIC  X(0001).
  1525     05  FILLER REDEFINES HACCTNOF.
  1526         10  HACCTNOA PIC  X(0001).
  1527     05  HACCTNOI PIC  X(0010).
  1528*    -------------------------------
  1529     05  HEFFDTL PIC S9(0004) COMP.
  1530     05  HEFFDTF PIC  X(0001).
  1531     05  FILLER REDEFINES HEFFDTF.
  1532         10  HEFFDTA PIC  X(0001).
  1533     05  HEFFDTI PIC  X(0008).
  1534*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  31
* EL1278.cbl
  1535     05  HCERTNOL PIC S9(0004) COMP.
  1536     05  HCERTNOF PIC  X(0001).
  1537     05  FILLER REDEFINES HCERTNOF.
  1538         10  HCERTNOA PIC  X(0001).
  1539     05  HCERTNOI PIC  X(0010).
  1540*    -------------------------------
  1541     05  HCRTSFXL PIC S9(0004) COMP.
  1542     05  HCRTSFXF PIC  X(0001).
  1543     05  FILLER REDEFINES HCRTSFXF.
  1544         10  HCRTSFXA PIC  X(0001).
  1545     05  HCRTSFXI PIC  X(0001).
  1546*    -------------------------------
  1547     05  HLNAMEL PIC S9(0004) COMP.
  1548     05  HLNAMEF PIC  X(0001).
  1549     05  FILLER REDEFINES HLNAMEF.
  1550         10  HLNAMEA PIC  X(0001).
  1551     05  HLNAMEI PIC  X(0015).
  1552*    -------------------------------
  1553     05  HFNAMEL PIC S9(0004) COMP.
  1554     05  HFNAMEF PIC  X(0001).
  1555     05  FILLER REDEFINES HFNAMEF.
  1556         10  HFNAMEA PIC  X(0001).
  1557     05  HFNAMEI PIC  X(0010).
  1558*    -------------------------------
  1559     05  HINITL PIC S9(0004) COMP.
  1560     05  HINITF PIC  X(0001).
  1561     05  FILLER REDEFINES HINITF.
  1562         10  HINITA PIC  X(0001).
  1563     05  HINITI PIC  X(0001).
  1564*    -------------------------------
  1565     05  LCLMDTHL PIC S9(0004) COMP.
  1566     05  LCLMDTHF PIC  X(0001).
  1567     05  FILLER REDEFINES LCLMDTHF.
  1568         10  LCLMDTHA PIC  X(0001).
  1569     05  LCLMDTHI PIC  X(0022).
  1570*    -------------------------------
  1571     05  LCLMDTL PIC S9(0004) COMP.
  1572     05  LCLMDTF PIC  X(0001).
  1573     05  FILLER REDEFINES LCLMDTF.
  1574         10  LCLMDTA PIC  X(0001).
  1575     05  LCLMDTI PIC  X(0008).
  1576*    -------------------------------
  1577     05  HPCYNL PIC S9(0004) COMP.
  1578     05  HPCYNF PIC  X(0001).
  1579     05  FILLER REDEFINES HPCYNF.
  1580         10  HPCYNA PIC  X(0001).
  1581     05  HPCYNI PIC  X(0001).
  1582*    -------------------------------
  1583     05  ACLMDTHL PIC S9(0004) COMP.
  1584     05  ACLMDTHF PIC  X(0001).
  1585     05  FILLER REDEFINES ACLMDTHF.
  1586         10  ACLMDTHA PIC  X(0001).
  1587     05  ACLMDTHI PIC  X(0023).
  1588*    -------------------------------
  1589     05  ACLMDTL PIC S9(0004) COMP.
  1590     05  ACLMDTF PIC  X(0001).
  1591     05  FILLER REDEFINES ACLMDTF.
  1592         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  32
* EL1278.cbl
  1593     05  ACLMDTI PIC  X(0008).
  1594*    -------------------------------
  1595     05  PMTHDL PIC S9(0004) COMP.
  1596     05  PMTHDF PIC  X(0001).
  1597     05  FILLER REDEFINES PMTHDF.
  1598         10  PMTHDA PIC  X(0001).
  1599     05  PMTHDI PIC  X(0010).
  1600*    -------------------------------
  1601     05  CNCDTHDL PIC S9(0004) COMP.
  1602     05  CNCDTHDF PIC  X(0001).
  1603     05  FILLER REDEFINES CNCDTHDF.
  1604         10  CNCDTHDA PIC  X(0001).
  1605     05  CNCDTHDI PIC  X(0007).
  1606*    -------------------------------
  1607     05  HLKINDL PIC S9(0004) COMP.
  1608     05  HLKINDF PIC  X(0001).
  1609     05  FILLER REDEFINES HLKINDF.
  1610         10  HLKINDA PIC  X(0001).
  1611     05  HLKINDI PIC  X(0002).
  1612*    -------------------------------
  1613     05  HLCDL PIC S9(0004) COMP.
  1614     05  HLCDF PIC  X(0001).
  1615     05  FILLER REDEFINES HLCDF.
  1616         10  HLCDA PIC  X(0001).
  1617     05  HLCDI PIC  X(0002).
  1618*    -------------------------------
  1619     05  HLEDESCL PIC S9(0004) COMP.
  1620     05  HLEDESCF PIC  X(0001).
  1621     05  FILLER REDEFINES HLEDESCF.
  1622         10  HLEDESCA PIC  X(0001).
  1623     05  HLEDESCI PIC  X(0003).
  1624*    -------------------------------
  1625     05  HLTERML PIC S9(0004) COMP.
  1626     05  HLTERMF PIC  X(0001).
  1627     05  FILLER REDEFINES HLTERMF.
  1628         10  HLTERMA PIC  X(0001).
  1629     05  HLTERMI PIC  9(3).
  1630*    -------------------------------
  1631     05  HLREML PIC S9(0004) COMP.
  1632     05  HLREMF PIC  X(0001).
  1633     05  FILLER REDEFINES HLREMF.
  1634         10  HLREMA PIC  X(0001).
  1635     05  HLREMI PIC  X(0003).
  1636*    -------------------------------
  1637     05  HLPREML PIC S9(0004) COMP.
  1638     05  HLPREMF PIC  X(0001).
  1639     05  FILLER REDEFINES HLPREMF.
  1640         10  HLPREMA PIC  X(0001).
  1641     05  HLPREMI PIC  X(0011).
  1642*    -------------------------------
  1643     05  HLITDRL PIC S9(0004) COMP.
  1644     05  HLITDRF PIC  X(0001).
  1645     05  FILLER REDEFINES HLITDRF.
  1646         10  HLITDRA PIC  X(0001).
  1647     05  HLITDRI PIC  X(0011).
  1648*    -------------------------------
  1649     05  HLREFNDL PIC S9(0004) COMP.
  1650     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  33
* EL1278.cbl
  1651     05  FILLER REDEFINES HLREFNDF.
  1652         10  HLREFNDA PIC  X(0001).
  1653     05  HLREFNDI PIC  X(0011).
  1654*    -------------------------------
  1655     05  HLCANCL PIC S9(0004) COMP.
  1656     05  HLCANCF PIC  X(0001).
  1657     05  FILLER REDEFINES HLCANCF.
  1658         10  HLCANCA PIC  X(0001).
  1659     05  HLCANCI PIC  X(0008).
  1660*    -------------------------------
  1661     05  HLCAL1L PIC S9(0004) COMP.
  1662     05  HLCAL1F PIC  X(0001).
  1663     05  FILLER REDEFINES HLCAL1F.
  1664         10  HLCAL1A PIC  X(0001).
  1665     05  HLCAL1I PIC  X(0001).
  1666*    -------------------------------
  1667     05  HLCALCL PIC S9(0004) COMP.
  1668     05  HLCALCF PIC  X(0001).
  1669     05  FILLER REDEFINES HLCALCF.
  1670         10  HLCALCA PIC  X(0001).
  1671     05  HLCALCI PIC  X(0012).
  1672*    -------------------------------
  1673     05  HAKINDL PIC S9(0004) COMP.
  1674     05  HAKINDF PIC  X(0001).
  1675     05  FILLER REDEFINES HAKINDF.
  1676         10  HAKINDA PIC  X(0001).
  1677     05  HAKINDI PIC  X(0002).
  1678*    -------------------------------
  1679     05  HACDL PIC S9(0004) COMP.
  1680     05  HACDF PIC  X(0001).
  1681     05  FILLER REDEFINES HACDF.
  1682         10  HACDA PIC  X(0001).
  1683     05  HACDI PIC  X(0002).
  1684*    -------------------------------
  1685     05  HAEDESCL PIC S9(0004) COMP.
  1686     05  HAEDESCF PIC  X(0001).
  1687     05  FILLER REDEFINES HAEDESCF.
  1688         10  HAEDESCA PIC  X(0001).
  1689     05  HAEDESCI PIC  X(0003).
  1690*    -------------------------------
  1691     05  HATERML PIC S9(0004) COMP.
  1692     05  HATERMF PIC  X(0001).
  1693     05  FILLER REDEFINES HATERMF.
  1694         10  HATERMA PIC  X(0001).
  1695     05  HATERMI PIC  9(3).
  1696*    -------------------------------
  1697     05  HAREML PIC S9(0004) COMP.
  1698     05  HAREMF PIC  X(0001).
  1699     05  FILLER REDEFINES HAREMF.
  1700         10  HAREMA PIC  X(0001).
  1701     05  HAREMI PIC  X(0003).
  1702*    -------------------------------
  1703     05  HAPREML PIC S9(0004) COMP.
  1704     05  HAPREMF PIC  X(0001).
  1705     05  FILLER REDEFINES HAPREMF.
  1706         10  HAPREMA PIC  X(0001).
  1707     05  HAPREMI PIC  X(0011).
  1708*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  34
* EL1278.cbl
  1709     05  HAITDRL PIC S9(0004) COMP.
  1710     05  HAITDRF PIC  X(0001).
  1711     05  FILLER REDEFINES HAITDRF.
  1712         10  HAITDRA PIC  X(0001).
  1713     05  HAITDRI PIC  X(0011).
  1714*    -------------------------------
  1715     05  HAREFNDL PIC S9(0004) COMP.
  1716     05  HAREFNDF PIC  X(0001).
  1717     05  FILLER REDEFINES HAREFNDF.
  1718         10  HAREFNDA PIC  X(0001).
  1719     05  HAREFNDI PIC  X(0011).
  1720*    -------------------------------
  1721     05  HACANCL PIC S9(0004) COMP.
  1722     05  HACANCF PIC  X(0001).
  1723     05  FILLER REDEFINES HACANCF.
  1724         10  HACANCA PIC  X(0001).
  1725     05  HACANCI PIC  X(0008).
  1726*    -------------------------------
  1727     05  HACAL1L PIC S9(0004) COMP.
  1728     05  HACAL1F PIC  X(0001).
  1729     05  FILLER REDEFINES HACAL1F.
  1730         10  HACAL1A PIC  X(0001).
  1731     05  HACAL1I PIC  X(0001).
  1732*    -------------------------------
  1733     05  HACALCL PIC S9(0004) COMP.
  1734     05  HACALCF PIC  X(0001).
  1735     05  FILLER REDEFINES HACALCF.
  1736         10  HACALCA PIC  X(0001).
  1737     05  HACALCI PIC  X(0012).
  1738*    -------------------------------
  1739     05  TOPREML PIC S9(0004) COMP.
  1740     05  TOPREMF PIC  X(0001).
  1741     05  FILLER REDEFINES TOPREMF.
  1742         10  TOPREMA PIC  X(0001).
  1743     05  TOPREMI PIC  X(0011).
  1744*    -------------------------------
  1745     05  TOITDRL PIC S9(0004) COMP.
  1746     05  TOITDRF PIC  X(0001).
  1747     05  FILLER REDEFINES TOITDRF.
  1748         10  TOITDRA PIC  X(0001).
  1749     05  TOITDRI PIC  X(0011).
  1750*    -------------------------------
  1751     05  TORFNDL PIC S9(0004) COMP.
  1752     05  TORFNDF PIC  X(0001).
  1753     05  FILLER REDEFINES TORFNDF.
  1754         10  TORFNDA PIC  X(0001).
  1755     05  TORFNDI PIC  X(0011).
  1756*    -------------------------------
  1757     05  CANREAHL PIC S9(0004) COMP.
  1758     05  CANREAHF PIC  X(0001).
  1759     05  FILLER REDEFINES CANREAHF.
  1760         10  CANREAHA PIC  X(0001).
  1761     05  CANREAHI PIC  X(0015).
  1762*    -------------------------------
  1763     05  CANREAL PIC S9(0004) COMP.
  1764     05  CANREAF PIC  X(0001).
  1765     05  FILLER REDEFINES CANREAF.
  1766         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  35
* EL1278.cbl
  1767     05  CANREAI PIC  X(0001).
  1768*    -------------------------------
  1769     05  CLPYNHL PIC S9(0004) COMP.
  1770     05  CLPYNHF PIC  X(0001).
  1771     05  FILLER REDEFINES CLPYNHF.
  1772         10  CLPYNHA PIC  X(0001).
  1773     05  CLPYNHI PIC  X(0005).
  1774*    -------------------------------
  1775     05  CLPYNL PIC S9(0004) COMP.
  1776     05  CLPYNF PIC  X(0001).
  1777     05  FILLER REDEFINES CLPYNF.
  1778         10  CLPYNA PIC  X(0001).
  1779     05  CLPYNI PIC  X(0001).
  1780*    -------------------------------
  1781     05  HLREDL PIC S9(0004) COMP.
  1782     05  HLREDF PIC  X(0001).
  1783     05  FILLER REDEFINES HLREDF.
  1784         10  HLREDA PIC  X(0001).
  1785     05  HLREDI PIC  X(0014).
  1786*    -------------------------------
  1787     05  FREMTRML PIC S9(0004) COMP.
  1788     05  FREMTRMF PIC  X(0001).
  1789     05  FILLER REDEFINES FREMTRMF.
  1790         10  FREMTRMA PIC  X(0001).
  1791     05  FREMTRMI PIC  X(0003).
  1792*    -------------------------------
  1793     05  HERMSG1L PIC S9(0004) COMP.
  1794     05  HERMSG1F PIC  X(0001).
  1795     05  FILLER REDEFINES HERMSG1F.
  1796         10  HERMSG1A PIC  X(0001).
  1797     05  HERMSG1I PIC  X(0079).
  1798*    -------------------------------
  1799     05  HERMSG2L PIC S9(0004) COMP.
  1800     05  HERMSG2F PIC  X(0001).
  1801     05  FILLER REDEFINES HERMSG2F.
  1802         10  HERMSG2A PIC  X(0001).
  1803     05  HERMSG2I PIC  X(0079).
  1804*    -------------------------------
  1805     05  HPFKEYL PIC S9(0004) COMP.
  1806     05  HPFKEYF PIC  X(0001).
  1807     05  FILLER REDEFINES HPFKEYF.
  1808         10  HPFKEYA PIC  X(0001).
  1809     05  HPFKEYI PIC  99.
  1810*    -------------------------------
  1811     05  PFKEY11L PIC S9(0004) COMP.
  1812     05  PFKEY11F PIC  X(0001).
  1813     05  FILLER REDEFINES PFKEY11F.
  1814         10  PFKEY11A PIC  X(0001).
  1815     05  PFKEY11I PIC  X(0014).
  1816 01  EL127HO REDEFINES EL127HI.
  1817     05  FILLER            PIC  X(0012).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  HDATEO PIC  X(0008).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  HTIMEO PIC  99.99.
  1824*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  36
* EL1278.cbl
  1825     05  FILLER            PIC  X(0003).
  1826     05  CMPNYIDO PIC  X(0003).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  USERIDO PIC  X(0004).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  HCARIERO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  HGROUPO PIC  X(0006).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  HSTATEO PIC  X(0002).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  HACCTNOO PIC  X(0010).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  HEFFDTO PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  HCERTNOO PIC  X(0010).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  HCRTSFXO PIC  X(0001).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  HLNAMEO PIC  X(0015).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  HFNAMEO PIC  X(0010).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  HINITO PIC  X(0001).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  LCLMDTHO PIC  X(0022).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  LCLMDTO PIC  X(0008).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  HPCYNO PIC  X(0001).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  ACLMDTHO PIC  X(0023).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ACLMDTO PIC  X(0008).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PMTHDO PIC  X(0010).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  CNCDTHDO PIC  X(0007).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  37
* EL1278.cbl
  1883     05  HLKINDO PIC  X(0002).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  HLCDO PIC  X(0002).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  HLEDESCO PIC  X(0003).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  HLTERMO PIC  ZZ9.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  HLREMO PIC  ZZ9.
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  HLCANCO PIC  X(0008).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  HLCAL1O PIC  X(0001).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  HLCALCO PIC  X(0012).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  HAKINDO PIC  X(0002).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  HACDO PIC  X(0002).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  HAEDESCO PIC  X(0003).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  HATERMO PIC  ZZ9.
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  HAREMO PIC  ZZ9.
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  38
* EL1278.cbl
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  HACAL1O PIC  X(0001).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  HACALCO PIC  X(0012).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  CANREAHO PIC  X(0015).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  CANREAO PIC  X(0001).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  CLPYNHO PIC  X(0005).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  CLPYNO PIC  X(0001).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  FREMTRMO PIC  ZZ9.
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  HERMSG1O PIC  X(0079).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  HERMSG2O PIC  X(0079).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  HPFKEYO PIC  99.
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  PFKEY11O PIC  X(0014).
  1986*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  39
* EL1278.cbl
  1988*                            COPY ELCCALC.
  1989******************************************************************
  1990*                                                                *
  1991*                           ELCCALC.                            *
  1992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1993*                            VMOD=2.025                          *
  1994*                                                                *
  1995*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1996*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1997*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1998*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1999*                                                                *
  2000*  PASSED TO ELRTRM                                              *
  2001*  -----------------                                             *
  2002*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2003*  ORIGINAL TERM                                                 *
  2004*  BEGINNING DATE                                                *
  2005*  ENDING DATE                                                   *
  2006*  COMPANY I.D.                                                  *
  2007*  ACCOUNT MASTER USER FIELD                                     *
  2008*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2009*  FREE LOOK DAYS                                                *
  2010*                                                                *
  2011*  RETURNED FROM ELRTRM                                          *
  2012*  ---------------------                                         *
  2013*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2014*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2015*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2016*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2017*----------------------------------------------------------------*
  2018*  PASSED TO ELRAMT                                              *
  2019*  ----------------                                              *
  2020*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2021*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2022*  ORIGINAL AMOUNT                                               *
  2023*  ALTERNATE BENEFIT (BALLON)                                    *
  2024*  A.P.R. - NET PAY ONLY                                         *
  2025*  METHOD
  2026*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2027*  COMPANY I.D.                                                  *
  2028*  BENEFIT TYPE                                                  *
  2029*                                                                *
  2030*  RETURNED FROM ELRAMT                                          *
  2031*  --------------------                                          *
  2032*  REMAINING AMOUNT 1 - CURRENT                                  *
  2033*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2034*  REMAINING AMOUNT FACTOR
  2035*----------------------------------------------------------------*
  2036*  PASSED TO ELRESV                                              *
  2037*  -----------------                                             *
  2038*  CERTIFICATE EFFECTIVE DATE                                    *
  2039*  VALUATION DATE                                                *
  2040*  PAID THRU DATE                                                *
  2041*  BENEFIT                                                       *
  2042*  INCURRED DATE                                                 *
  2043*  REPORTED DATE                                                 *
  2044*  ISSUE AGE                                                     *
  2045*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  40
* EL1278.cbl
  2046*  CDT PERCENT                                                   *
  2047*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2048* *CLAIM TYPE (LIFE, A/H)                                        *
  2049* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2050* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2051*                                                                *
  2052*  RETURNED FROM ELRESV                                          *
  2053*  --------------------                                          *
  2054*  CDT TABLE USED                                                *
  2055*  CDT FACTOR USED                                               *
  2056*  PAY TO CURRENT RESERVE                                        *
  2057*  I.B.N.R. - A/H ONLY                                           *
  2058*  FUTURE (ACCRUED) AH ONLY                                      *
  2059*----------------------------------------------------------------*
  2060*  PASSED TO ELRATE                                              *
  2061*  ----------------                                              *
  2062*  CERT ISSUE DATE                                               *
  2063*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2064*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2065*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2066*  STATE CODE (CLIENT DEFINED)                                   *
  2067*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2068*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2069*  DEVIATION CODE                                                *
  2070*  ISSUE AGE                                                     *
  2071*  ORIGINAL BENEFIT AMOUNT                                       *
  2072*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2073*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2074*  BENEFIT KIND (LIFE OR A/H)                                    *
  2075*  A.P.R.                                                        *
  2076*  METHOD
  2077*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2078*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2079*  COMPANY I.D. (3 CHARACTER)                                    *
  2080*  BENEFIT CODE                                                  *
  2081*  BENEFIT OVERRIDE CODE                                         *
  2082*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2083*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2084*  JOINT INDICATOR (CSL ONLY)                                    *
  2085*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2086*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2087*                                                                *
  2088*  RETURNED FROM ELRATE                                          *
  2089*  --------------------                                          *
  2090*  CALCULATED PREMIUM                                            *
  2091*  PREMIUM RATE                                                  *
  2092*  MORTALITY CODE                                                *
  2093*  MAX ATTAINED AGE                                              *
  2094*  MAX AGE                                                       *
  2095*  MAX TERM                                                      *
  2096*  MAX MONTHLY BENEFIT                                           *
  2097*  MAX TOTAL BENIFIT                                             *
  2098*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2099*----------------------------------------------------------------*
  2100*  PASSED TO ELRFND                                              *
  2101*  ----------------                                              *
  2102*  CERT ISSUE DATE                                               *
  2103*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  41
* EL1278.cbl
  2104*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2105*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2106*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2107*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2108*  STATE CODE (CLIENT DEFINED)                                   *
  2109*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2110*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2111*  DEVIATION CODE                                                *
  2112*  ISSUE AGE                                                     *
  2113*  ORIGINAL BENEFIT AMOUNT                                       *
  2114*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2115*  PROCESS TYPE (CANCEL)                                         *
  2116*  BENEFIT KIND (LIFE OR A/H)                                    *
  2117*  A.P.R.                                                        *
  2118*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2119*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2120*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2121*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2122*  COMPANY I.D. (3 CHARACTER)                                    *
  2123*  BENEFIT CODE                                                  *
  2124*  BENEFIT OVERRIDE CODE                                         *
  2125*                                                                *
  2126*  RETURNED FROM ELRFND                                          *
  2127*  --------------------                                          *
  2128*  CALCULATED REFUND                                             *
  2129*----------------------------------------------------------------*
  2130*  PASSED TO ELEARN                                              *
  2131*  ----------------                                              *
  2132*  CERT ISSUE DATE                                               *
  2133*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2134*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2135*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2136*  STATE CODE (CLIENT DEFINED)                                   *
  2137*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2138*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2139*  DEVIATION CODE                                                *
  2140*  ISSUE AGE                                                     *
  2141*  ORIGINAL BENEFIT AMOUNT                                       *
  2142*  BENEFIT KIND (LIFE OR A/H)                                    *
  2143*  A.P.R.                                                        *
  2144*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2145*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2146*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2147*  COMPANY I.D. (3 CHARACTER)                                    *
  2148*  BENEFIT CODE                                                  *
  2149*  BENEFIT OVERRIDE CODE                                         *
  2150*                                                                *
  2151*  RETURNED FROM ELEARN                                          *
  2152*  --------------------                                          *
  2153*  INDICATED  EARNINGS                                           *
  2154*----------------------------------------------------------------*
  2155*                 LENGTH = 450                                   *
  2156*                                                                *
  2157******************************************************************
  2158******************************************************************
  2159*                   C H A N G E   L O G
  2160*
  2161* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  42
* EL1278.cbl
  2162*-----------------------------------------------------------------
  2163*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2164* EFFECTIVE    NUMBER
  2165*-----------------------------------------------------------------
  2166* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2167* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2168* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2169* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2170* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2171* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2172* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2173* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2174* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2175******************************************************************
  2176
  2177 01  CALCULATION-PASS-AREA.
  2178     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2179                                     COMP.
  2180
  2181     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2182       88  NO-CP-ERROR                             VALUE ZERO.
  2183       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2184                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2185       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2186       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2187       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2188       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2189       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2190       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2191       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2192       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2193       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2194       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2195       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2196       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2197       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2198       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2199       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2200       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2201       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2202
  2203     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2204       88  NO-CP-ERROR-2                           VALUE ZERO.
  2205***********************  INPUT AREAS ****************************
  2206
  2207     12  CP-CALCULATION-AREA.
  2208         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2209         16  CP-CERT-EFF-DT        PIC XX.
  2210         16  CP-VALUATION-DT       PIC XX.
  2211         16  CP-PAID-THRU-DT       PIC XX.
  2212         16  CP-BENEFIT-TYPE       PIC X.
  2213           88  CP-AH                               VALUE 'A' 'D'
  2214                                                   'I' 'U'.
  2215           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2216           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2217         16  CP-INCURRED-DT        PIC XX.
  2218         16  CP-REPORTED-DT        PIC XX.
  2219         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  43
* EL1278.cbl
  2220         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2221         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2222                                     COMP-3.
  2223         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2224                                     COMP-3.
  2225         16  CP-CDT-METHOD         PIC X.
  2226           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2227           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2228           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2229         16  CP-CLAIM-TYPE         PIC X.
  2230           88  CP-AH-CLAIM                         VALUE 'A'.
  2231           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2232         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2233                                     COMP-3.
  2234         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2235                                     COMP-3.
  2236         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2237                                     COMP-3.
  2238         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2239                                     COMP-3.
  2240         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2241                                     COMP-3.
  2242         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2243                                     COMP-3.
  2244         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2245                                     COMP-3.
  2246         16  CP-REM-TERM-METHOD    PIC X.
  2247           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2248           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2249           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2250           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2251           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2252           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2253           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2254         16  CP-EARNING-METHOD     PIC X.
  2255           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2256           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2257           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2258           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2259           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2260           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2261           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2262           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2263           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2264           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2265           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2266           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2267           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2268           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2269         16  CP-PROCESS-TYPE       PIC X.
  2270           88  CP-CLAIM                            VALUE '1'.
  2271           88  CP-CANCEL                           VALUE '2'.
  2272           88  CP-ISSUE                            VALUE '3'.
  2273         16  CP-SPECIAL-CALC-CD    PIC X.
  2274           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2275           88  CP-1-MTH-INTEREST               VALUE ' '.
  2276           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2277           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  44
* EL1278.cbl
  2278           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2279           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2280           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2281           88  CP-FARM-PLAN                    VALUE 'F'.
  2282           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2283           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2284           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2285           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2286           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2287           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2288           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2289           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2290           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2291           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2292                                                     'W' 'X'.
  2293           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2294           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2295           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2296           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2297           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2298           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2299           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2300           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2301           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2302           88  CP-CSL-METH-1                   VALUE '5'.
  2303           88  CP-CSL-METH-2                   VALUE '6'.
  2304           88  CP-CSL-METH-3                   VALUE '7'.
  2305           88  CP-CSL-METH-4                   VALUE '8'.
  2306
  2307         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2308                                     COMP-3.
  2309         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2310         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2311         16  CP-STATE              PIC XX          VALUE SPACE.
  2312         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2313         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2314           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2315               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2316         16  CP-R78-OPTION         PIC X.
  2317           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2318           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2319
  2320         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2321         16  CP-IBNR-RESERVE-SW    PIC X.
  2322         16  CP-CLAIM-STATUS       PIC X.
  2323         16  CP-RATE-FILE          PIC X.
  2324         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2325                                     COMP-3.
  2326
  2327         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2328         16  CP-AH-OVERRIDE-CODE   PIC X.
  2329
  2330         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2331                                     COMP-3.
  2332         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2333                                   PIC S9(5)V99 COMP-3.
  2334         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2335                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  45
* EL1278.cbl
  2336         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2337                                     COMP-3.
  2338         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2339                                     COMP-3.
  2340         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2341                                  PIC S9(7)V99 COMP-3.
  2342
  2343         16  CP-PAID-FROM-DATE     PIC X(02).
  2344         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2345         16  CP-EXT-DAYS-CALC      PIC X.
  2346           88  CP-EXT-NO-CHG                   VALUE ' '.
  2347           88  CP-EXT-CHG-LF                   VALUE '1'.
  2348           88  CP-EXT-CHG-AH                   VALUE '2'.
  2349           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2350         16  CP-DOMICILE-STATE     PIC XX.
  2351         16  CP-CARRIER            PIC X.
  2352         16  CP-REIN-FLAG          PIC X.
  2353         16  CP-REM-TRM-CALC-OPTION PIC X.
  2354           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2355                      '2' '3' '4' '5'.
  2356           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2357           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2358           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2359           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2360           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2361           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2362           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2363           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2364         16  CP-SIG-SWITCH         PIC X.
  2365         16  CP-RATING-METHOD      PIC X.
  2366           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2367           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2368           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2369           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2370           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2371           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2372           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2373           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2374           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2375         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2376                                     COMP-3.
  2377         16  CP-BEN-CATEGORY       PIC X.
  2378         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2379         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2380                                   PIC S99V9(5) COMP-3.
  2381         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2382         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2383                                   PIC S99V9(5) COMP-3.
  2384         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2385         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2386         16  CP-EXPIRE-DT          PIC XX.
  2387         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2388         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2389         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2390         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2391         16  CP-DDF-SPEC-CALC      PIC X.
  2392             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2393             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  46
* EL1278.cbl
  2394         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2395         16  CP-CANCEL-REASON      PIC X.
  2396         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2397         16  CP-PMT-MODE           PIC X.
  2398         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2399         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2400         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2401         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2402         16  FILLER                PIC X.
  2403
  2404***************    OUTPUT FROM ELRESV   ************************
  2405
  2406         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2407
  2408         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2409                                     COMP-3.
  2410         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2411                                     COMP-3.
  2412         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2413                                     COMP-3.
  2414         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2415                                     COMP-3.
  2416         16  FILLER                PIC X(09).
  2417***************    OUTPUT FROM ELRTRM   *************************
  2418
  2419         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2420                                     COMP-3.
  2421         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2422                                     COMP-3.
  2423         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2424                                     COMP-3.
  2425         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2426                                     COMP-3.
  2427         16  FILLER                PIC X(12).
  2428
  2429***************    OUTPUT FROM ELRAMT   *************************
  2430
  2431         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2432                                     COMP-3.
  2433         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2434                                     COMP-3.
  2435         16  FILLER                PIC X(12).
  2436
  2437***************    OUTPUT FROM ELRATE   *************************
  2438
  2439         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2440                                     COMP-3.
  2441         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2442                                     COMP-3.
  2443         16  CP-MORTALITY-CODE     PIC X(4).
  2444         16  CP-RATE-EDIT-FLAG     PIC X.
  2445             88  CP-RATES-NEED-APR                  VALUE '1'.
  2446         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2447                                     COMP-3.
  2448         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2449         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2450         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2451                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  47
* EL1278.cbl
  2452         16  FILLER                PIC X(07).
  2453
  2454***************    OUTPUT FROM ELRFND   *************************
  2455
  2456         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2457                                     COMP-3.
  2458         16  CP-REFUND-TYPE-USED   PIC X.
  2459           88  CP-R-AS-R78                         VALUE '1'.
  2460           88  CP-R-AS-PRORATA                     VALUE '2'.
  2461           88  CP-R-AS-CALIF                       VALUE '3'.
  2462           88  CP-R-AS-TEXAS                       VALUE '4'.
  2463           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2464           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2465           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2466           88  CP-R-AS-MEAN                        VALUE '8'.
  2467           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2468           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2469           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2470           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2471           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2472           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2473         16  FILLER                PIC X(12).
  2474
  2475***************    OUTPUT FROM ELEARN   *************************
  2476
  2477         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2478                                     COMP-3.
  2479         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2484                                     COMP-3.
  2485         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-EARNING-TYPE-USED  PIC X.
  2490           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2491           88  CP-E-AS-R78                         VALUE '1'.
  2492           88  CP-E-AS-PRORATA                     VALUE '2'.
  2493           88  CP-E-AS-TEXAS                       VALUE '4'.
  2494           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2495           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2496           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2497           88  CP-E-AS-MEAN                        VALUE '8'.
  2498           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2499         16  FILLER                PIC X(12).
  2500
  2501***************    OUTPUT FROM ELPMNT   *************************
  2502
  2503         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2504                                     COMP-3.
  2505         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2506                                     COMP-3.
  2507         16  FILLER                PIC X(12).
  2508
  2509***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  48
* EL1278.cbl
  2510         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2511                                     COMP-3.
  2512         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2513                                     COMP-3.
  2514         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2515                                     COMP-3.
  2516         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2517                                     COMP-3.
  2518         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2519                                     COMP-3.
  2520         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2521                                     COMP-3.
  2522         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2523             88  OPEN-RATE-FILE                   VALUE 'O'.
  2524             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2525             88  IO-ERROR                         VALUE 'E'.
  2526
  2527         16  CP-FIRST-PAY-DATE     PIC XX.
  2528
  2529         16  CP-JOINT-INDICATOR    PIC X.
  2530
  2531         16  CP-RESERVE-REMAINING-TERM
  2532                                   PIC S9(4)V9    VALUE ZERO
  2533                                     COMP-3.
  2534
  2535         16  CP-INSURED-BIRTH-DT   PIC XX.
  2536
  2537         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2538                                     COMP-3.
  2539
  2540         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2541                                     COMP-3.
  2542
  2543         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2544                                     COMP-3.
  2545
  2546         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2547                                     COMP-3.
  2548
  2549         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2550                                     COMP-3.
  2551
  2552         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2553                                     COMP-3.
  2554
  2555         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2556                                     COMP-3.
  2557
  2558         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2559             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2560
  2561         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2566         16  FILLER                PIC X(15).
  2567******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  49
* EL1278.cbl
  2569*                            COPY ERCNOTE.
  2570******************************************************************
  2571*                                                                *
  2572*                                                                *
  2573*                            ERCNOTE                             *
  2574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2575*                            VMOD=2.003                          *
  2576*                                                                *
  2577*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2578*                                                                *
  2579*        FILE TYPE= VSAM,KSDS                                    *
  2580*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2581*                                                                *
  2582*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2583*                                                                *
  2584*        LOG = YES                                               *
  2585*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2586*                                                                *
  2587******************************************************************
  2588*                   C H A N G E   L O G
  2589*
  2590* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2591*-----------------------------------------------------------------
  2592*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2593* EFFECTIVE    NUMBER
  2594*-----------------------------------------------------------------
  2595* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2596*                                FILE WILL CONTAIN BILLING NOTES O
  2597******************************************************************
  2598
  2599 01  CERTIFICATE-NOTE.
  2600     12  CN-RECORD-ID                PIC  XX.
  2601         88  VALID-CN-ID                  VALUE 'CN'.
  2602
  2603     12  CN-CONTROL-PRIMARY.
  2604         16  CN-COMPANY-CD           PIC X.
  2605         16  CN-CARRIER              PIC X.
  2606         16  CN-GROUPING.
  2607             20 CN-GROUPING-PREFIX   PIC XXX.
  2608             20 CN-GROUPING-PRIME    PIC XXX.
  2609         16  CN-STATE                PIC XX.
  2610         16  CN-ACCOUNT.
  2611             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2612             20 CN-ACCOUNT-PRIME     PIC X(6).
  2613         16  CN-CERT-EFF-DT          PIC XX.
  2614         16  CN-CERT-NO.
  2615             20  CN-CERT-PRIME       PIC X(10).
  2616             20  CN-CERT-SFX         PIC X.
  2617
  2618     12  CN-BILLING-START-LINE-NO    PIC 99.
  2619     12  CN-BILLING-END-LINE-NO      PIC 99.
  2620
  2621     12  CN-LINES.
  2622         16  CN-LINE OCCURS 10       PIC X(77).
  2623
  2624     12  CN-LAST-MAINT-DT            PIC XX.
  2625     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2626     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  50
* EL1278.cbl
  2627     12  FILLER                      PIC X(6).
  2628******************************************************************
  2629*                            COPY ERCCTBL.
  2630******************************************************************
  2631*                                                                *
  2632*                                                                *
  2633*                            ERCCTBL                             *
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2635*                            VMOD=2.003
  2636*                                                                *
  2637*   ONLINE CREDIT SYSTEM                                         *
  2638*                                                                *
  2639*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2640*                                                                *
  2641*   FILE TYPE = VSAM,KSDS                                        *
  2642*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2643*                                                                *
  2644*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2645*       ALTERNATE PATH = NONE                                    *
  2646*                                                                *
  2647*   LOG = NO                                                     *
  2648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2649*                                                                *
  2650*                                                                *
  2651******************************************************************
  2652
  2653 01  COMM-TABLE-RECORD.
  2654     12  CT-RECORD-ID                      PIC XX.
  2655         88  VALID-CT-ID                      VALUE 'CT'.
  2656
  2657     12  CT-CONTROL-PRIMARY.
  2658         16  CT-COMPANY-CD                 PIC X.
  2659         16  CT-TABLE                      PIC XXX.
  2660         16  CT-CNTRL-2.
  2661             20  CT-BEN-TYPE               PIC X.
  2662             20  CT-BEN-CODE               PIC XX.
  2663
  2664     12  CT-MAINT-INFORMATION.
  2665         16  CT-LAST-MAINT-DT              PIC XX.
  2666         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2667         16  CT-LAST-MAINT-USER            PIC X(4).
  2668         16  FILLER                        PIC X(31).
  2669
  2670     12  CT-LIMITS.
  2671         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2672
  2673         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2674
  2675         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2676
  2677     12  CT-RATES.
  2678         16  CT-RTX          OCCURS 27 TIMES.
  2679             20  CT-RT                     PIC SV9(5)     COMP-3.
  2680             20  CT-RT-R   REDEFINES
  2681                 CT-RT                     PIC XXX.
  2682
  2683     12  FILLER                            PIC  X(42).
  2684
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  51
* EL1278.cbl
  2685******************************************************************
  2686
  2687****************************************************************
  2688*
  2689* Copyright (c) 2007 by Clerity Solutions, Inc.
  2690* All rights reserved.
  2691*
  2692****************************************************************
  2693 01  DFHEIV.
  2694   02  DFHEIV0               PIC X(35).
  2695   02  DFHEIV1               PIC X(08).
  2696   02  DFHEIV2               PIC X(08).
  2697   02  DFHEIV3               PIC X(08).
  2698   02  DFHEIV4               PIC X(06).
  2699   02  DFHEIV5               PIC X(04).
  2700   02  DFHEIV6               PIC X(04).
  2701   02  DFHEIV7               PIC X(02).
  2702   02  DFHEIV8               PIC X(02).
  2703   02  DFHEIV9               PIC X(01).
  2704   02  DFHEIV10              PIC S9(7) COMP-3.
  2705   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2706   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2707   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2708   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2709   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2710   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2711   02  DFHEIV17              PIC X(04).
  2712   02  DFHEIV18              PIC X(04).
  2713   02  DFHEIV19              PIC X(04).
  2714   02  DFHEIV20              USAGE IS POINTER.
  2715   02  DFHEIV21              USAGE IS POINTER.
  2716   02  DFHEIV22              USAGE IS POINTER.
  2717   02  DFHEIV23              USAGE IS POINTER.
  2718   02  DFHEIV24              USAGE IS POINTER.
  2719   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2720   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2721   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2722   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2723   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2724   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2725   02  FILLER                PIC X(02).
  2726   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2727   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2728   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2729   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2730   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2731 LINKAGE  SECTION.
  2732*****************************************************************
  2733*                                                               *
  2734* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2735* All rights reserved.                                          *
  2736*                                                               *
  2737*****************************************************************
  2738 01  dfheiblk.
  2739     02  eibtime          pic s9(7) comp-3.
  2740     02  eibdate          pic s9(7) comp-3.
  2741     02  eibtrnid         pic x(4).
  2742     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  52
* EL1278.cbl
  2743     02  eibtrmid         pic x(4).
  2744     02  dfheigdi         pic s9(4) comp.
  2745     02  eibcposn         pic s9(4) comp.
  2746     02  eibcalen         pic s9(4) comp.
  2747     02  eibaid           pic x(1).
  2748     02  eibfiller1       pic x(1).
  2749     02  eibfn            pic x(2).
  2750     02  eibfiller2       pic x(2).
  2751     02  eibrcode         pic x(6).
  2752     02  eibfiller3       pic x(2).
  2753     02  eibds            pic x(8).
  2754     02  eibreqid         pic x(8).
  2755     02  eibrsrce         pic x(8).
  2756     02  eibsync          pic x(1).
  2757     02  eibfree          pic x(1).
  2758     02  eibrecv          pic x(1).
  2759     02  eibsend          pic x(1).
  2760     02  eibatt           pic x(1).
  2761     02  eibeoc           pic x(1).
  2762     02  eibfmh           pic x(1).
  2763     02  eibcompl         pic x(1).
  2764     02  eibsig           pic x(1).
  2765     02  eibconf          pic x(1).
  2766     02  eiberr           pic x(1).
  2767     02  eibrldbk         pic x(1).
  2768     02  eiberrcd         pic x(4).
  2769     02  eibsynrb         pic x(1).
  2770     02  eibnodat         pic x(1).
  2771     02  eibfiller5       pic x(2).
  2772     02  eibresp          pic 9(09) comp.
  2773     02  eibresp2         pic 9(09) comp.
  2774     02  dfheigdj         pic s9(4) comp.
  2775     02  dfheigdk         pic s9(4) comp.
  2776
  2777 01  DFHCOMMAREA                 PIC  X(1024).
  2778
  2779*01 PARMLIST .
  2780*    12  FILLER                  PIC S9(08)      COMP.
  2781*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2782*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2783*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2784*                            COPY ELCCNTL.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCCNTL.                            *
  2789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2790*                            VMOD=2.059                          *
  2791*                                                                *
  2792*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2793*                                                                *
  2794*   FILE TYPE = VSAM,KSDS                                        *
  2795*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2796*                                                                *
  2797*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2798*       ALTERNATE INDEX = NONE                                   *
  2799*                                                                *
  2800*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  53
* EL1278.cbl
  2801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2802******************************************************************
  2803*                   C H A N G E   L O G
  2804*
  2805* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2806*-----------------------------------------------------------------
  2807*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2808* EFFECTIVE    NUMBER
  2809*-----------------------------------------------------------------
  2810* 082503                   PEMA  ADD BENEFIT GROUP
  2811* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2812* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2813* 092705    2005050300006  PEMA  ADD SPP LEASES
  2814* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2815* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2816* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2817* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2818* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2819* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2820* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2821* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2822* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2823******************************************************************
  2824*
  2825 01  CONTROL-FILE.
  2826     12  CF-RECORD-ID                       PIC XX.
  2827         88  VALID-CF-ID                        VALUE 'CF'.
  2828
  2829     12  CF-CONTROL-PRIMARY.
  2830         16  CF-COMPANY-ID                  PIC XXX.
  2831         16  CF-RECORD-TYPE                 PIC X.
  2832             88  CF-COMPANY-MASTER              VALUE '1'.
  2833             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2834             88  CF-STATE-MASTER                VALUE '3'.
  2835             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2836             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2837             88  CF-CARRIER-MASTER              VALUE '6'.
  2838             88  CF-MORTALITY-MASTER            VALUE '7'.
  2839             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2840             88  CF-TERMINAL-MASTER             VALUE '9'.
  2841             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2842             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2843             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2844             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2845             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2846             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2847             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2848             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2849             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2850         16  CF-ACCESS-CD-GENL              PIC X(4).
  2851         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2852             20  CF-PROCESSOR               PIC X(4).
  2853         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2854             20  CF-STATE-CODE              PIC XX.
  2855             20  FILLER                     PIC XX.
  2856         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2857             20  FILLER                     PIC XX.
  2858             20  CF-HI-BEN-IN-REC           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  54
* EL1278.cbl
  2859         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2860             20  FILLER                     PIC XXX.
  2861             20  CF-CARRIER-CNTL            PIC X.
  2862         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2863             20  FILLER                     PIC XX.
  2864             20  CF-HI-TYPE-IN-REC          PIC 99.
  2865         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2866             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2867                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2868             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2869             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2870         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2871             20  FILLER                     PIC X.
  2872             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2873         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2874             20  FILLER                     PIC XX.
  2875             20  CF-MORTGAGE-PLAN           PIC XX.
  2876         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2877
  2878     12  CF-LAST-MAINT-DT                   PIC XX.
  2879     12  CF-LAST-MAINT-BY                   PIC X(4).
  2880     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2881
  2882     12  CF-RECORD-BODY                     PIC X(728).
  2883
  2884
  2885****************************************************************
  2886*             COMPANY MASTER RECORD                            *
  2887****************************************************************
  2888
  2889     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2890         16  CF-COMPANY-ADDRESS.
  2891             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2892             20  CF-CL-IN-CARE-OF           PIC X(30).
  2893             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2894             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2895             20  CF-CL-CITY-STATE           PIC X(30).
  2896             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2897             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2898         16  CF-COMPANY-CD                  PIC X.
  2899         16  CF-COMPANY-PASSWORD            PIC X(8).
  2900         16  CF-SECURITY-OPTION             PIC X.
  2901             88  ALL-SECURITY                   VALUE '1'.
  2902             88  COMPANY-VERIFY                 VALUE '2'.
  2903             88  PROCESSOR-VERIFY               VALUE '3'.
  2904             88  NO-SECURITY                    VALUE '4'.
  2905             88  ALL-BUT-TERM                   VALUE '5'.
  2906         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2907             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2908         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2909             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2910         16  CF-INFORCE-LOCATION            PIC X.
  2911             88  CERTS-ARE-ONLINE               VALUE '1'.
  2912             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2913             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2914         16  CF-LOWER-CASE-LETTERS          PIC X.
  2915         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2916             88  CF-ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  55
* EL1278.cbl
  2917             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2918             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2919             88  CF-ACCNT-CNTL                  VALUE '3'.
  2920             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2921
  2922         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2923         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2924
  2925         16  CF-LGX-CREDIT-USER             PIC X.
  2926             88  CO-IS-NOT-USER                 VALUE 'N'.
  2927             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2928
  2929         16 CF-CREDIT-CALC-CODES.
  2930             20  CF-CR-REM-TERM-CALC PIC X.
  2931               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2932               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2933               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2934               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2935               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2936               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2937               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2938             20  CF-CR-R78-METHOD           PIC X.
  2939               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2940               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2941
  2942         16  CF-CLAIM-CONTROL-COUNTS.
  2943             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2944                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2945
  2946             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2947                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2948
  2949             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2950                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2951
  2952             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2953                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2954
  2955         16  CF-CURRENT-MONTH-END           PIC XX.
  2956
  2957         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2958             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2959             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2960             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2961             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2962                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2963                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2964             20  CF-CO-PREM-REJECT-SW       PIC X.
  2965                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2966                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2967             20  CF-CO-REF-REJECT-SW        PIC X.
  2968                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2969                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2970
  2971         16  CF-CO-REPORTING-DT             PIC XX.
  2972         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2973         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2974           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  56
* EL1278.cbl
  2975           88  CF-CO-MONTH-END                  VALUE '1'.
  2976
  2977         16  CF-LGX-CLAIM-USER              PIC X.
  2978             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2979             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2980
  2981         16  CF-CREDIT-EDIT-CONTROLS.
  2982             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2983             20  CF-MIN-AGE                 PIC 99.
  2984             20  CF-DEFAULT-AGE             PIC 99.
  2985             20  CF-MIN-TERM                PIC S999      COMP-3.
  2986             20  CF-MAX-TERM                PIC S999      COMP-3.
  2987             20  CF-DEFAULT-SEX             PIC X.
  2988             20  CF-JOINT-AGE-INPUT         PIC X.
  2989                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2990             20  CF-BIRTH-DATE-INPUT        PIC X.
  2991                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2992             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2993                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2994                 88  CF-ZERO-CARRIER            VALUE '1'.
  2995                 88  CF-ZERO-GROUPING           VALUE '2'.
  2996                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2997             20  CF-EDIT-SW                 PIC X.
  2998                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2999             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3000             20  CF-CR-PR-METHOD            PIC X.
  3001               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3002               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3003             20  FILLER                     PIC X.
  3004
  3005         16  CF-CREDIT-MISC-CONTROLS.
  3006             20  CF-REIN-TABLE-SW           PIC X.
  3007                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3008             20  CF-COMP-TABLE-SW           PIC X.
  3009                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3010             20  CF-EXPERIENCE-RETENTION-AGE
  3011                                            PIC S9        COMP-3.
  3012             20  CF-CONVERSION-DT           PIC XX.
  3013             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3014             20  CF-RUN-FREQUENCY-SW        PIC X.
  3015                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3016                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3017
  3018             20  CF-CR-CHECK-NO-CONTROL.
  3019                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3020                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3021                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3022                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3023                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3024                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3025
  3026                 24  CF-CR-CHECK-COUNT       REDEFINES
  3027                     CF-CR-CHECK-COUNTER      PIC X(4).
  3028
  3029                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3030                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3031
  3032                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  57
* EL1278.cbl
  3033                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3034                 24  CF-MAIL-PROCESSING       PIC X.
  3035                     88  MAIL-PROCESSING          VALUE 'Y'.
  3036
  3037         16  CF-MISC-SYSTEM-CONTROL.
  3038             20  CF-SYSTEM-C                 PIC X.
  3039                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3040             20  CF-SYSTEM-D                 PIC X.
  3041                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3042             20  CF-SOC-SEC-NO-SW            PIC X.
  3043                 88  SOC-SEC-NO-USED             VALUE '1'.
  3044             20  CF-MEMBER-NO-SW             PIC X.
  3045                 88  MEMBER-NO-USED              VALUE '1'.
  3046             20  CF-TAX-ID-NUMBER            PIC X(11).
  3047             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3048             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3049                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3050                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3051                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3052                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3053             20  CF-SYSTEM-E                 PIC X.
  3054                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3055
  3056         16  CF-LGX-LIFE-USER               PIC X.
  3057             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3058             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3059
  3060         16  CF-CR-MONTH-END-DT             PIC XX.
  3061
  3062         16  CF-FILE-MAINT-DATES.
  3063             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3064                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3065             20  CF-LAST-BATCH       REDEFINES
  3066                 CF-LAST-BATCH-NO               PIC X(4).
  3067             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3068             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3069             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3070             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3071             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3072             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3073             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3074             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3075             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3076             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3077
  3078         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3079         16  FILLER                         PIC X.
  3080
  3081         16  CF-ALT-MORT-CODE               PIC X(4).
  3082         16  CF-MEMBER-CAPTION              PIC X(10).
  3083
  3084         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3085             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3086             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3087             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3088             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3089             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3090
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  58
* EL1278.cbl
  3091         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3092
  3093         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3094         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3095         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3096         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3097
  3098         16  CF-AH-OVERRIDE-L1              PIC X.
  3099         16  CF-AH-OVERRIDE-L2              PIC XX.
  3100         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3101         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3102
  3103         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3104         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3105
  3106         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3107         16  CF-AR-LAST-EL860-DT            PIC XX.
  3108         16  CF-MP-MONTH-END-DT             PIC XX.
  3109
  3110         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3111         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3112             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3113
  3114         16  CF-AR-MONTH-END-DT             PIC XX.
  3115
  3116         16  CF-CRDTCRD-USER                PIC X.
  3117             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3118             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3119
  3120         16  CF-CC-MONTH-END-DT             PIC XX.
  3121
  3122         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3123
  3124         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3125             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3126             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3127             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3128         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3129         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3130         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3131         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3132             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3133             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3134         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3135         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3136         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3137             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3138         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3139
  3140         16  CF-CL-ZIP-CODE.
  3141             20  CF-CL-ZIP-PRIME.
  3142                 24  CF-CL-ZIP-1ST          PIC X.
  3143                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3144                 24  FILLER                 PIC X(4).
  3145             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3146         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3147             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3148             20  CF-CL-CAN-POSTAL-2         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  59
* EL1278.cbl
  3149             20  FILLER                     PIC XXX.
  3150
  3151         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3152         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3153         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3154         16  CF-CO-OPTION-START-DATE        PIC XX.
  3155         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3156           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3157                                                      '3' '4'.
  3158           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3159           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3160           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3161           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3162           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3163           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3164
  3165         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3166
  3167         16  CF-PAYMENT-APPROVAL-LEVELS.
  3168             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3169             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3170             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3171             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3172             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3173             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3174
  3175         16  CF-END-USER-REPORTING-USER     PIC X.
  3176             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3177             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3178
  3179         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3180             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3181             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3182
  3183         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3184
  3185         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3186         16  FILLER                         PIC X.
  3187
  3188         16  CF-CREDIT-ARCHIVE-CNTL.
  3189             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3190             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3191             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3192
  3193         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3194
  3195         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3196             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3197             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3198
  3199         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3200             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3201             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3202
  3203         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3204
  3205         16  CF-CO-ACH-ID-CODE              PIC  X.
  3206             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  60
* EL1278.cbl
  3207             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3208             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3209         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3210         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3211         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3212         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3213         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3214         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3215         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3216         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3217         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3218                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3219         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3220                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3221
  3222         16  CF-CO-OVER-SHORT.
  3223             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3224             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3225
  3226*         16  FILLER                         PIC X(102).
  3227         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3228             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3229             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3230
  3231         16  CF-AH-APPROVAL-DAYS.
  3232             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3233             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3234             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3235             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3236
  3237         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3238
  3239         16  CF-APPROV-LEV-5.
  3240             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3241             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3242             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3243
  3244         16  FILLER                         PIC X(68).
  3245****************************************************************
  3246*             PROCESSOR/USER RECORD                            *
  3247****************************************************************
  3248
  3249     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3250         16  CF-PROCESSOR-NAME              PIC X(30).
  3251         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3252         16  CF-PROCESSOR-TITLE             PIC X(26).
  3253         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3254                 88  MESSAGE-YES                VALUE 'Y'.
  3255                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3256
  3257*****************************************************
  3258****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3259****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3260****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3261****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3262*****************************************************
  3263
  3264         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  61
* EL1278.cbl
  3265             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3266             20  CF-APPLICATION-FORCE       PIC X.
  3267             20  CF-INDIVIDUAL-APP.
  3268                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3269                     28  CF-BROWSE-APP      PIC X.
  3270                     28  CF-UPDATE-APP      PIC X.
  3271
  3272         16  CF-CURRENT-TERM-ON             PIC X(4).
  3273         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3274             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3275             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3276             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3277             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3278             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3279             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3280             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3281         16  CF-PROCESSOR-CARRIER           PIC X.
  3282             88  NO-CARRIER-SECURITY            VALUE ' '.
  3283         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3284             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3285         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3286             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3287         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3288             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3289
  3290         16  CF-PROC-SYS-ACCESS-SW.
  3291             20  CF-PROC-CREDIT-CLAIMS-SW.
  3292                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3293                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3294                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3295                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3296             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3297                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3298                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3299             20  CF-PROC-LIFE-GNRLDGR-SW.
  3300                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3301                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3302                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3303                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3304             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3305                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3306                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3307         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3308             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3309             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3310         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3311
  3312         16  CF-APPROVAL-LEVEL                  PIC X.
  3313             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3314             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3315             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3316             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3317             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3318
  3319         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3320
  3321         16  CF-LANGUAGE-TYPE                   PIC X.
  3322             88  CF-LANG-IS-ENG                     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  62
* EL1278.cbl
  3323             88  CF-LANG-IS-FR                      VALUE 'F'.
  3324
  3325         16  CF-CSR-IND                         PIC X.
  3326         16  FILLER                             PIC X(239).
  3327
  3328****************************************************************
  3329*             PROCESSOR/REMINDERS RECORD                       *
  3330****************************************************************
  3331
  3332     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3333         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3334             20  CF-START-REMIND-DT         PIC XX.
  3335             20  CF-END-REMIND-DT           PIC XX.
  3336             20  CF-REMINDER-TEXT           PIC X(50).
  3337         16  FILLER                         PIC X(296).
  3338
  3339
  3340****************************************************************
  3341*             STATE MASTER RECORD                              *
  3342****************************************************************
  3343
  3344     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3345         16  CF-STATE-ABBREVIATION          PIC XX.
  3346         16  CF-STATE-NAME                  PIC X(25).
  3347         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3348         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3349             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3350             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3351             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3352             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3353                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3354                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3355             20  CF-ST-PREM-REJECT-SW       PIC X.
  3356                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3357                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3358             20  CF-ST-REF-REJECT-SW        PIC X.
  3359                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3360                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3361         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3362         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3363         16  CF-ST-REFUND-RULES.
  3364             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3365             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3366             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3367         16  CF-ST-FST-PMT-EXTENSION.
  3368             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3369             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3370                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3371                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3372                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3373                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3374         16  CF-ST-STATE-CALL.
  3375             20  CF-ST-CALL-UNEARNED        PIC X.
  3376             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3377             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3378         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3379             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3380             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  63
* EL1278.cbl
  3381         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3382         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3383         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3384         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3385         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3386         16  FILLER                         PIC X.
  3387         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3388             20  CF-ST-BENEFIT-CD           PIC XX.
  3389             20  CF-ST-BENEFIT-KIND         PIC X.
  3390                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3391                 88  CF-ST-AH-KIND              VALUE 'A'.
  3392             20  CF-ST-REM-TERM-CALC        PIC X.
  3393                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3394                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3395                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3396                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3397                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3398                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3399                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3400                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3401
  3402             20  CF-ST-REFUND-CALC          PIC X.
  3403                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3404                 88  ST-REFD-BY-R78             VALUE '1'.
  3405                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3406                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3407                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3408                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3409                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3410                 88  ST-REFD-UTAH               VALUE '7'.
  3411                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3412                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3413                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3414
  3415             20  CF-ST-EARNING-CALC         PIC X.
  3416                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3417                 88  ST-EARN-BY-R78             VALUE '1'.
  3418                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3419                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3420                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3421                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3422                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3423                 88  ST-EARN-MEAN               VALUE '8'.
  3424                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3425
  3426             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3427                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3428                 88  ST-OVRD-BY-R78             VALUE '1'.
  3429                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3430                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3431                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3432                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3433                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3434                 88  ST-OVRD-MEAN               VALUE '8'.
  3435                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3436             20  FILLER                     PIC X.
  3437
  3438         16  CF-ST-COMMISSION-CAPS.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  64
* EL1278.cbl
  3439             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3440             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3441             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3442             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3443         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3444                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3445
  3446         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3447
  3448         16  CF-ST-STATUTORY-INTEREST.
  3449             20  CF-ST-STAT-DATE-FROM       PIC X.
  3450                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3451                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3452             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3453             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3454             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3455             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3456             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3457
  3458         16  CF-ST-OVER-SHORT.
  3459             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3460             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3461
  3462         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3463
  3464         16  CF-ST-RT-CALC                  PIC X.
  3465
  3466         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3467         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3468         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3469         16  CF-ST-RF-LR-CALC               PIC X.
  3470         16  CF-ST-RF-LL-CALC               PIC X.
  3471         16  CF-ST-RF-LN-CALC               PIC X.
  3472         16  CF-ST-RF-AH-CALC               PIC X.
  3473         16  CF-ST-RF-CP-CALC               PIC X.
  3474*        16  FILLER                         PIC X(206).
  3475*CIDMOD         16  FILLER                         PIC X(192).
  3476         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3477             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3478         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3479         16  CF-ST-VFY-2ND-BENE             PIC X.
  3480         16  CF-ST-CAUSAL-STATE             PIC X.
  3481         16  FILLER                         PIC X(185).
  3482
  3483****************************************************************
  3484*             BENEFIT MASTER RECORD                            *
  3485****************************************************************
  3486
  3487     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3488         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3489             20  CF-BENEFIT-CODE            PIC XX.
  3490             20  CF-BENEFIT-NUMERIC  REDEFINES
  3491                 CF-BENEFIT-CODE            PIC XX.
  3492             20  CF-BENEFIT-ALPHA           PIC XXX.
  3493             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3494             20  CF-BENEFIT-COMMENT         PIC X(10).
  3495
  3496             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  65
* EL1278.cbl
  3497                 88  CF-REDUCING                VALUE 'R'.
  3498                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3499
  3500             20  CF-SPECIAL-CALC-CD         PIC X.
  3501                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3502                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3503                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3504                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3505                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3506                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3507                 88  CF-FARM-PLAN               VALUE 'F'.
  3508                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3509                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3510                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3511                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3512                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3513                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3514                 88  CF-PRUDENTIAL              VALUE 'P'.
  3515                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3516                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3517                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3518                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3519                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3520                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3521
  3522             20  CF-JOINT-INDICATOR         PIC X.
  3523                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3524
  3525*            20  FILLER                     PIC X(12).
  3526             20  FILLER                     PIC X(11).
  3527             20  CF-BENEFIT-CATEGORY        PIC X.
  3528             20  CF-LOAN-TYPE               PIC X(8).
  3529
  3530             20  CF-CO-REM-TERM-CALC        PIC X.
  3531                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3532                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3533                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3534                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3535                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3536
  3537             20  CF-CO-EARNINGS-CALC        PIC X.
  3538                 88  CO-EARN-BY-R78             VALUE '1'.
  3539                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3540                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3541                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3542                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3543                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3544                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3545                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3546
  3547             20  CF-CO-REFUND-CALC          PIC X.
  3548                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3549                 88  CO-REFD-BY-R78             VALUE '1'.
  3550                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3551                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3552                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3553                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3554                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  66
* EL1278.cbl
  3555                 88  CO-REFD-MEAN               VALUE '8'.
  3556                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3557                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3558                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3559
  3560             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3561                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3562                 88  CO-OVRD-BY-R78             VALUE '1'.
  3563                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3564                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3565                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3566                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3567                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3568                 88  CO-OVRD-MEAN               VALUE '8'.
  3569                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3570
  3571             20  CF-CO-BEN-I-G-CD           PIC X.
  3572                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3573                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3574                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3575
  3576         16  FILLER                         PIC X(304).
  3577
  3578
  3579****************************************************************
  3580*             CARRIER MASTER RECORD                            *
  3581****************************************************************
  3582
  3583     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3584         16  CF-ADDRESS-DATA.
  3585             20  CF-MAIL-TO-NAME            PIC X(30).
  3586             20  CF-IN-CARE-OF              PIC X(30).
  3587             20  CF-ADDRESS-LINE-1          PIC X(30).
  3588             20  CF-ADDRESS-LINE-2          PIC X(30).
  3589             20  CF-CITY-STATE              PIC X(30).
  3590             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3591             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3592
  3593         16  CF-CLAIM-NO-CONTROL.
  3594             20  CF-CLAIM-NO-METHOD         PIC X.
  3595                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3596                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3597                 88  CLAIM-NO-SEQ               VALUE '3'.
  3598                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3599             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3600                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3601                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3602                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3603
  3604         16  CF-CHECK-NO-CONTROL.
  3605             20  CF-CHECK-NO-METHOD         PIC X.
  3606                 88  CHECK-NO-MANUAL            VALUE '1'.
  3607                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3608                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3609                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3610             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3611                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3612
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  67
* EL1278.cbl
  3613         16  CF-DOMICILE-STATE              PIC XX.
  3614
  3615         16  CF-EXPENSE-CONTROLS.
  3616             20  CF-EXPENSE-METHOD          PIC X.
  3617                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3618                 88  DOLLARS-PER-PMT            VALUE '2'.
  3619                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3620                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3621             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3622             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3623
  3624         16  CF-CORRESPONDENCE-CONTROL.
  3625             20  CF-LETTER-RESEND-OPT       PIC X.
  3626                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3627                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3628             20  FILLER                     PIC X(4).
  3629
  3630         16  CF-RESERVE-CONTROLS.
  3631             20  CF-MANUAL-SW               PIC X.
  3632                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3633             20  CF-FUTURE-SW               PIC X.
  3634                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3635             20  CF-PTC-SW                  PIC X.
  3636                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3637             20  CF-IBNR-SW                 PIC X.
  3638                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3639             20  CF-PTC-LF-SW               PIC X.
  3640                 88  CF-LF-PTC-USED             VALUE '1'.
  3641             20  CF-CDT-ACCESS-METHOD       PIC X.
  3642                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3643                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3644                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3645             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3646
  3647         16  CF-CLAIM-CALC-METHOD           PIC X.
  3648             88  360-PLUS-MONTHS                VALUE '1'.
  3649             88  365-PLUS-MONTHS                VALUE '2'.
  3650             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3651             88  360-DAILY                      VALUE '4'.
  3652             88  365-DAILY                      VALUE '5'.
  3653
  3654         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3655         16  FILLER                         PIC X(11).
  3656
  3657         16  CF-LIMIT-AMOUNTS.
  3658             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3659             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3660             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3661             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3662             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3663             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3664             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3665             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3666             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3667             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3668
  3669         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3670         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  68
* EL1278.cbl
  3671         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3672
  3673         16  CF-ZIP-CODE.
  3674             20  CF-ZIP-PRIME.
  3675                 24  CF-ZIP-1ST             PIC X.
  3676                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3677                 24  FILLER                 PIC X(4).
  3678             20  CF-ZIP-PLUS4               PIC X(4).
  3679         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3680             20  CF-CAN-POSTAL-1            PIC XXX.
  3681             20  CF-CAN-POSTAL-2            PIC XXX.
  3682             20  FILLER                     PIC XXX.
  3683
  3684         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3685         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3686         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3687
  3688         16  CF-RATING-SWITCH               PIC X.
  3689             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3690             88  CF-NO-RATING                   VALUE 'N'.
  3691
  3692         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3693
  3694         16  CF-CARRIER-OVER-SHORT.
  3695             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3696             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3697
  3698         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3699         16  CF-SECPAY-SWITCH               PIC X.
  3700             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3701             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3702         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3703         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3704         16  FILLER                         PIC X(444).
  3705*        16  FILLER                         PIC X(452).
  3706
  3707
  3708****************************************************************
  3709*             MORTALITY MASTER RECORD                          *
  3710****************************************************************
  3711
  3712     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3713         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3714                                INDEXED BY CF-MORT-NDX.
  3715             20  CF-MORT-TABLE              PIC X(5).
  3716             20  CF-MORT-TABLE-TYPE         PIC X.
  3717                 88  CF-MORT-JOINT              VALUE 'J'.
  3718                 88  CF-MORT-SINGLE             VALUE 'S'.
  3719                 88  CF-MORT-COMBINED           VALUE 'C'.
  3720                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3721                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3722             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3723             20  CF-MORT-AGE-METHOD         PIC XX.
  3724                 88  CF-AGE-LAST                VALUE 'AL'.
  3725                 88  CF-AGE-NEAR                VALUE 'AN'.
  3726             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3727             20  CF-MORT-ADJUSTMENT-DIRECTION
  3728                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  69
* EL1278.cbl
  3729                 88  CF-MINUS                   VALUE '-'.
  3730                 88  CF-PLUS                    VALUE '+'.
  3731             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3732             20  CF-MORT-JOINT-CODE         PIC X.
  3733                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3734             20  CF-MORT-PC-Q               PIC X.
  3735                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3736             20  CF-MORT-TABLE-CODE         PIC X(4).
  3737             20  CF-MORT-COMMENTS           PIC X(15).
  3738             20  FILLER                     PIC X(14).
  3739
  3740         16  FILLER                         PIC X(251).
  3741
  3742
  3743****************************************************************
  3744*             BUSSINESS TYPE MASTER RECORD                     *
  3745****************************************************************
  3746
  3747     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3748* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3749* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3750* AND RECORD 05 IS TYPES 81-99
  3751         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3752             20  CF-BUSINESS-TITLE          PIC  X(19).
  3753             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3754                                            PIC S9V9(4) COMP-3.
  3755             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3756             20  FILLER                     PIC  X.
  3757         16  FILLER                         PIC  X(248).
  3758
  3759
  3760****************************************************************
  3761*             TERMINAL MASTER RECORD                           *
  3762****************************************************************
  3763
  3764     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3765
  3766         16  CF-COMPANY-TERMINALS.
  3767             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3768                                  PIC X(4).
  3769         16  FILLER               PIC X(248).
  3770
  3771
  3772****************************************************************
  3773*             LIFE EDIT MASTER RECORD                          *
  3774****************************************************************
  3775
  3776     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3777         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3778             20  CF-LIFE-CODE-IN            PIC XX.
  3779             20  CF-LIFE-CODE-OUT           PIC XX.
  3780         16  FILLER                         PIC X(248).
  3781
  3782
  3783****************************************************************
  3784*             AH EDIT MASTER RECORD                            *
  3785****************************************************************
  3786
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  70
* EL1278.cbl
  3787     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3788         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3789             20  CF-AH-CODE-IN              PIC XXX.
  3790             20  CF-AH-CODE-OUT             PIC XX.
  3791         16  FILLER                         PIC X(248).
  3792
  3793
  3794****************************************************************
  3795*             CREDIBILITY TABLES                               *
  3796****************************************************************
  3797
  3798     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3799         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3800                             INDEXED BY CF-CRDB-NDX.
  3801             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3802             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3803             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3804         16  FILLER                         PIC  X(332).
  3805
  3806
  3807****************************************************************
  3808*             REPORT CUSTOMIZATION RECORD                      *
  3809****************************************************************
  3810
  3811     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3812         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3813             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3814             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3815             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3816**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3817****       A T-TRANSFER.                                   ****
  3818             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3819
  3820         16  FILLER                         PIC XX.
  3821
  3822         16  CF-CARRIER-CNTL-OPT.
  3823             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3824                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3825                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3826             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3827                                            PIC X.
  3828         16  CF-GROUP-CNTL-OPT.
  3829             20  CF-GROUP-OPT-SEQ           PIC 9.
  3830                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3831                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3832             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3833                                            PIC X(6).
  3834         16  CF-STATE-CNTL-OPT.
  3835             20  CF-STATE-OPT-SEQ           PIC 9.
  3836                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3837                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3838             20  CF-STATE-SELECT OCCURS 3 TIMES
  3839                                            PIC XX.
  3840         16  CF-ACCOUNT-CNTL-OPT.
  3841             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3842                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3843                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3844             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  71
* EL1278.cbl
  3845                                            PIC X(10).
  3846         16  CF-BUS-TYP-CNTL-OPT.
  3847             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3848                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3849                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3850             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3851                                            PIC XX.
  3852         16  CF-LF-TYP-CNTL-OPT.
  3853             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3854                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3855                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3856             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3857                                            PIC XX.
  3858         16  CF-AH-TYP-CNTL-OPT.
  3859             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3860                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3861                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3862             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3863                                            PIC XX.
  3864         16  CF-REPTCD1-CNTL-OPT.
  3865             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3866                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3867                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3868             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3869                                            PIC X(10).
  3870         16  CF-REPTCD2-CNTL-OPT.
  3871             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3872                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3873                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3874             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3875                                            PIC X(10).
  3876         16  CF-USER1-CNTL-OPT.
  3877             20  CF-USER1-OPT-SEQ           PIC 9.
  3878                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3879                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3880             20  CF-USER1-SELECT OCCURS 3 TIMES
  3881                                            PIC X(10).
  3882         16  CF-USER2-CNTL-OPT.
  3883             20  CF-USER2-OPT-SEQ           PIC 9.
  3884                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3885                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3886             20  CF-USER2-SELECT OCCURS 3 TIMES
  3887                                            PIC X(10).
  3888         16  CF-USER3-CNTL-OPT.
  3889             20  CF-USER3-OPT-SEQ           PIC 9.
  3890                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3891                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3892             20  CF-USER3-SELECT OCCURS 3 TIMES
  3893                                            PIC X(10).
  3894         16  CF-USER4-CNTL-OPT.
  3895             20  CF-USER4-OPT-SEQ           PIC 9.
  3896                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3897                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3898             20  CF-USER4-SELECT OCCURS 3 TIMES
  3899                                            PIC X(10).
  3900         16  CF-USER5-CNTL-OPT.
  3901             20  CF-USER5-OPT-SEQ           PIC 9.
  3902                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  72
* EL1278.cbl
  3903                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3904             20  CF-USER5-SELECT OCCURS 3 TIMES
  3905                                            PIC X(10).
  3906         16  CF-REINS-CNTL-OPT.
  3907             20  CF-REINS-OPT-SEQ           PIC 9.
  3908                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3909                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3910             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3911                 24  CF-REINS-PRIME         PIC XXX.
  3912                 24  CF-REINS-SUB           PIC XXX.
  3913
  3914         16  CF-AGENT-CNTL-OPT.
  3915             20  CF-AGENT-OPT-SEQ           PIC 9.
  3916                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3917                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3918             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3919                                            PIC X(10).
  3920
  3921         16  FILLER                         PIC X(43).
  3922
  3923         16  CF-LOSS-RATIO-SELECT.
  3924             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3925             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3926         16  CF-ENTRY-DATE-SELECT.
  3927             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3928             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3929         16  CF-EFFECTIVE-DATE-SELECT.
  3930             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3931             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3932
  3933         16  CF-EXCEPTION-LIST-IND          PIC X.
  3934             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3935
  3936         16  FILLER                         PIC X(318).
  3937
  3938****************************************************************
  3939*                  EXCEPTION REPORTING RECORD                  *
  3940****************************************************************
  3941
  3942     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3943         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3944             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3945
  3946         16  CF-COMBINED-LIFE-AH-OPT.
  3947             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3948             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3949             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3950             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3951
  3952         16  CF-LIFE-OPT.
  3953             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3954             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3955             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3956             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3957             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3958             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3959             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3960             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  73
* EL1278.cbl
  3961             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3962             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3963
  3964         16  CF-AH-OPT.
  3965             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3966             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3967             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3968             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3969             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3970             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3971             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3972             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3973             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3974             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3975
  3976         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3977             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3978             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3979             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3980
  3981         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3982
  3983         16  FILLER                         PIC X(673).
  3984
  3985
  3986****************************************************************
  3987*             MORTGAGE SYSTEM PLAN RECORD                      *
  3988****************************************************************
  3989
  3990     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3991         16  CF-PLAN-TYPE                   PIC X.
  3992             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3993             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3994             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3995         16  CF-PLAN-ABBREV                 PIC XXX.
  3996         16  CF-PLAN-DESCRIPT               PIC X(10).
  3997         16  CF-PLAN-NOTES                  PIC X(20).
  3998         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3999         16  CF-PLAN-UNDERWRITING.
  4000             20  CF-PLAN-TERM-DATA.
  4001                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4002                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4003             20  CF-PLAN-AGE-DATA.
  4004                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4005                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4006                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4007             20  CF-PLAN-BENEFIT-DATA.
  4008                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4009                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4010                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4011                                            PIC S9(7)V99  COMP-3.
  4012         16  CF-PLAN-POLICY-FORMS.
  4013             20  CF-POLICY-FORM             PIC X(12).
  4014             20  CF-MASTER-APPLICATION      PIC X(12).
  4015             20  CF-MASTER-POLICY           PIC X(12).
  4016         16  CF-PLAN-RATING.
  4017             20  CF-RATE-CODE               PIC X(5).
  4018             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  74
* EL1278.cbl
  4019                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4020                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4021             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4022             20  CF-SUB-STD-TYPE            PIC X.
  4023                 88  CF-PCT-OF-PREM            VALUE '1'.
  4024                 88  CF-PCT-OF-BENE            VALUE '2'.
  4025         16  CF-PLAN-PREM-TOLERANCES.
  4026             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4027             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4028         16  CF-PLAN-PYMT-TOLERANCES.
  4029             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4030             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4031         16  CF-PLAN-MISC-DATA.
  4032             20  FILLER                     PIC X.
  4033             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4034             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4035         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4036         16  CF-PLAN-IND-GRP                PIC X.
  4037             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4038                                                     '1'.
  4039             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4040                                                     '2'.
  4041         16  CF-MIB-SEARCH-SW               PIC X.
  4042             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4043             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4044             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4045             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4046         16  CF-ALPHA-SEARCH-SW             PIC X.
  4047             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4048             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4049             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4050             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4051             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4052             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4053             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4054             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4055             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4056             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4057                                                     'A' 'B' 'C'
  4058                                                     'X' 'Y' 'Z'.
  4059         16  CF-EFF-DT-RULE-SW              PIC X.
  4060             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4061             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4062             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4063             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4064             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4065         16  FILLER                         PIC X(4).
  4066         16  CF-HEALTH-QUESTIONS            PIC X.
  4067             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4068         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4069         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4070         16  CF-PLAN-SNGL-JNT               PIC X.
  4071             88  CF-COMBINED-PLAN              VALUE 'C'.
  4072             88  CF-JNT-PLAN                   VALUE 'J'.
  4073             88  CF-SNGL-PLAN                  VALUE 'S'.
  4074         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4075         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4076         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  75
* EL1278.cbl
  4077         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4078         16  CF-RERATE-CNTL                 PIC  X.
  4079             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4080             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4081             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4082             88  CF-AUTO-RECALC                 VALUE '4'.
  4083         16  CF-BENEFIT-TYPE                PIC  X.
  4084             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4085             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4086         16  CF-POLICY-FEE                  PIC S999V99
  4087                                                    COMP-3.
  4088         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4089         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4090         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4091         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4092         16  FILLER                         PIC  X(32).
  4093         16  CF-TERMINATION-FORM            PIC  X(04).
  4094         16  FILLER                         PIC  X(08).
  4095         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4096                                                       COMP-3.
  4097         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4098         16  CF-ISSUE-LETTER                PIC  X(4).
  4099         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4100         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4101             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4102             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4103         16  CF-MP-REFUND-CALC              PIC X.
  4104             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4105             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4106             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4107             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4108             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4109             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4110             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4111             88  CF-MP-REFD-MEAN                VALUE '8'.
  4112         16  CF-ALT-RATE-CODE               PIC  X(5).
  4113
  4114
  4115         16  FILLER                         PIC X(498).
  4116****************************************************************
  4117*             MORTGAGE COMPANY MASTER RECORD                   *
  4118****************************************************************
  4119
  4120     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4121         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4122         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4123             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4124             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4125             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4126             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4127             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4128
  4129         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4130         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4131         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4132         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4133         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4134
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  76
* EL1278.cbl
  4135         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4136             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4137         16  CF-MP-RECON-USE-IND            PIC X(1).
  4138             88  CF-MP-USE-RECON             VALUE 'Y'.
  4139         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4140             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4141         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4142             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4143             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4144         16  FILLER                         PIC X(1).
  4145         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4146             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4147         16  CF-MORTG-MIB-VERSION           PIC X.
  4148             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4149             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4150             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4151         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4152             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4153                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4154             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4155                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4156             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4157                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4158             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4159                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4160             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4161                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4162             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4163                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4164         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4165         16  FILLER                         PIC X(7).
  4166         16  CF-MORTG-DESTINATION-SYMBOL.
  4167             20  CF-MORTG-MIB-COMM          PIC X(5).
  4168             20  CF-MORTG-MIB-TERM          PIC X(5).
  4169         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4170             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4171         16  FILLER                         PIC X(03).
  4172         16  CF-MP-CHECK-NO-CONTROL.
  4173             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4174                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4175                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4176                                                ' ' LOW-VALUES.
  4177                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4178                                               VALUE '3'.
  4179         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4180         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4181         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4182             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4183                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4184             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4185                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4186             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4187                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4188             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4189                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4190             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4191                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4192             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  77
* EL1278.cbl
  4193                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4194         16  CF-MORTG-BILLING-AREA.
  4195             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4196                                            PIC X.
  4197         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4198         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4199         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4200         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4201             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4202             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4203         16  FILLER                         PIC X.
  4204         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4205             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4206             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4207         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4208         16  FILLER                         PIC X(8).
  4209         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4210         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4211         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4212         16  CF-ACH-COMPANY-ID.
  4213             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4214                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4215                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4216                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4217             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4218         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4219             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4220         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4221             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4222             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4223         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4224         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4225         16  FILLER                         PIC X(536).
  4226
  4227****************************************************************
  4228*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4229****************************************************************
  4230
  4231     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4232         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4233             20  CF-FEMALE-HEIGHT.
  4234                 24  CF-FEMALE-FT           PIC 99.
  4235                 24  CF-FEMALE-IN           PIC 99.
  4236             20  CF-FEMALE-MIN-WT           PIC 999.
  4237             20  CF-FEMALE-MAX-WT           PIC 999.
  4238         16  FILLER                         PIC X(428).
  4239
  4240     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4241         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4242             20  CF-MALE-HEIGHT.
  4243                 24  CF-MALE-FT             PIC 99.
  4244                 24  CF-MALE-IN             PIC 99.
  4245             20  CF-MALE-MIN-WT             PIC 999.
  4246             20  CF-MALE-MAX-WT             PIC 999.
  4247         16  FILLER                         PIC X(428).
  4248******************************************************************
  4249*             AUTOMATIC ACTIVITY RECORD                          *
  4250******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  78
* EL1278.cbl
  4251     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4252         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4253             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4254             20  CF-SYS-LETTER-ID           PIC X(04).
  4255             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4256             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4257             20  CF-SYS-RESET-SW            PIC X(01).
  4258             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4259             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4260
  4261         16  FILLER                         PIC X(50).
  4262
  4263         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4264             20  CF-USER-ACTIVE-SW          PIC X(01).
  4265             20  CF-USER-LETTER-ID          PIC X(04).
  4266             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4267             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4268             20  CF-USER-RESET-SW           PIC X(01).
  4269             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4270             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4271             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4272
  4273         16  FILLER                         PIC X(246).
  4274*                            COPY ERCACCT.
  4275******************************************************************
  4276*                                                                *
  4277*                                                                *
  4278*                            ERCACCT                             *
  4279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4280*                            VMOD=2.031                          *
  4281*                                                                *
  4282*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4283*                                                                *
  4284*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4285*   VSAM ACCOUNT MASTER FILES.                                   *
  4286*                                                                *
  4287*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4288*                                                                *
  4289*   FILE TYPE = VSAM,KSDS                                        *
  4290*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4291*                                                                *
  4292*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4293*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4294*                                                                *
  4295*   LOG = NO                                                     *
  4296*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4297*                                                                *
  4298*                                                                *
  4299******************************************************************
  4300*                   C H A N G E   L O G
  4301*
  4302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4303*-----------------------------------------------------------------
  4304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4305* EFFECTIVE    NUMBER
  4306*-----------------------------------------------------------------
  4307* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4308* 092705    2005050300006  PEMA  ADD SPP LEASES
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  79
* EL1278.cbl
  4309* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4310* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4311* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4312* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4313* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4314******************************************************************
  4315
  4316 01  ACCOUNT-MASTER.
  4317     12  AM-RECORD-ID                      PIC XX.
  4318         88  VALID-AM-ID                      VALUE 'AM'.
  4319
  4320     12  AM-CONTROL-PRIMARY.
  4321         16  AM-COMPANY-CD                 PIC X.
  4322         16  AM-MSTR-CNTRL.
  4323             20  AM-CONTROL-A.
  4324                 24  AM-CARRIER            PIC X.
  4325                 24  AM-GROUPING.
  4326                     28 AM-GROUPING-PREFIX PIC XXX.
  4327                     28 AM-GROUPING-PRIME  PIC XXX.
  4328                 24  AM-STATE              PIC XX.
  4329                 24  AM-ACCOUNT.
  4330                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4331                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4332             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4333                                           PIC X(19).
  4334             20  AM-CNTRL-B.
  4335                 24  AM-EXPIRATION-DT      PIC XX.
  4336                 24  FILLER                PIC X(4).
  4337             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4338                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4339
  4340     12  AM-CONTROL-BY-VAR-GRP.
  4341         16  AM-COMPANY-CD-A1              PIC X.
  4342         16  AM-VG-CARRIER                 PIC X.
  4343         16  AM-VG-GROUPING                PIC X(6).
  4344         16  AM-VG-STATE                   PIC XX.
  4345         16  AM-VG-ACCOUNT                 PIC X(10).
  4346         16  AM-VG-DATE.
  4347             20  AM-VG-EXPIRATION-DT       PIC XX.
  4348             20  FILLER                    PIC X(4).
  4349         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4350                                           PIC 9(11)      COMP-3.
  4351     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4352         16  FILLER                        PIC X(10).
  4353         16  AM-VG-KEY3.
  4354             20  AM-VG3-ACCOUNT            PIC X(10).
  4355             20  AM-VG3-EXP-DT             PIC XX.
  4356         16  FILLER                        PIC X(4).
  4357     12  AM-MAINT-INFORMATION.
  4358         16  AM-LAST-MAINT-DT              PIC XX.
  4359         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4360         16  AM-LAST-MAINT-USER            PIC X(4).
  4361         16  FILLER                        PIC XX.
  4362
  4363     12  AM-EFFECTIVE-DT                   PIC XX.
  4364     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4365
  4366     12  AM-PREV-DATES  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  80
* EL1278.cbl
  4367         16  AM-PREV-EXP-DT                PIC 9(11).
  4368         16  AM-PREV-EFF-DT                PIC 9(11).
  4369
  4370     12  AM-REPORT-CODE-1                  PIC X(10).
  4371     12  AM-REPORT-CODE-2                  PIC X(10).
  4372
  4373     12  AM-CITY-CODE                      PIC X(4).
  4374     12  AM-COUNTY-PARISH                  PIC X(6).
  4375
  4376     12  AM-NAME                           PIC X(30).
  4377     12  AM-PERSON                         PIC X(30).
  4378     12  AM-ADDRS                          PIC X(30).
  4379     12  AM-CITY.
  4380         16  AM-ADDR-CITY                  PIC X(28).
  4381         16  AM-ADDR-STATE                 PIC XX.
  4382     12  AM-ZIP.
  4383         16  AM-ZIP-PRIME.
  4384             20  AM-ZIP-PRI-1ST            PIC X.
  4385                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4386             20  FILLER                    PIC X(4).
  4387         16  AM-ZIP-PLUS4                  PIC X(4).
  4388     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4389         16  AM-CAN-POSTAL-1               PIC XXX.
  4390         16  AM-CAN-POSTAL-2               PIC XXX.
  4391         16  FILLER                        PIC XXX.
  4392     12  AM-TEL-NO.
  4393         16  AM-AREA-CODE                  PIC 999.
  4394         16  AM-TEL-PRE                    PIC 999.
  4395         16  AM-TEL-NBR                    PIC 9(4).
  4396     12  AM-TEL-LOC                        PIC X.
  4397         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4398         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4399
  4400     12  AM-COMM-STRUCTURE.
  4401         16  AM-DEFN-1.
  4402             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4403                 24  AM-AGT.
  4404                     28  AM-AGT-PREFIX     PIC X(4).
  4405                     28  AM-AGT-PRIME      PIC X(6).
  4406                 24  AM-COM-TYP            PIC X.
  4407                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4408                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4409                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4410                 24  AM-RECALC-LV-INDIC    PIC X.
  4411                 24  AM-RETRO-LV-INDIC     PIC X.
  4412                 24  AM-GL-CODES           PIC X.
  4413                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4414                 24  FILLER                PIC X(01).
  4415         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4416             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4417                 24  FILLER                PIC X(11).
  4418                 24  AM-L-COMA             PIC XXX.
  4419                 24  AM-J-COMA             PIC XXX.
  4420                 24  AM-A-COMA             PIC XXX.
  4421                 24  FILLER                PIC X(6).
  4422
  4423     12  AM-COMM-CHANGE-STATUS             PIC X.
  4424         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  81
* EL1278.cbl
  4425
  4426     12  AM-CSR-CODE                       PIC X(4).
  4427
  4428     12  AM-BILLING-STATUS                 PIC X.
  4429         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4430         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4431     12  AM-AUTO-REFUND-SW                 PIC X.
  4432         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4433         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4434     12  AM-GPCD                           PIC 99.
  4435     12  AM-IG                             PIC X.
  4436         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4437         88  AM-HAS-GROUP                     VALUE '2'.
  4438     12  AM-STATUS                         PIC X.
  4439         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4440         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4441         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4442         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4443         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4444         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4445     12  AM-REMIT-TO                       PIC 99.
  4446     12  AM-ID-NO                          PIC X(11).
  4447
  4448     12  AM-CAL-TABLE                      PIC XX.
  4449     12  AM-LF-DEVIATION                   PIC XXX.
  4450     12  AM-AH-DEVIATION                   PIC XXX.
  4451     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4452     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4453     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4454     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4455     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4456     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4457
  4458     12  AM-USER-FIELDS.
  4459         16  AM-FLD-1                      PIC XX.
  4460         16  AM-FLD-2                      PIC XX.
  4461         16  AM-FLD-3                      PIC XX.
  4462         16  AM-FLD-4                      PIC XX.
  4463         16  AM-FLD-5                      PIC XX.
  4464
  4465     12  AM-1ST-PROD-DATE.
  4466         16  AM-1ST-PROD-YR                PIC XX.
  4467         16  AM-1ST-PROD-MO                PIC XX.
  4468         16  AM-1ST-PROD-DA                PIC XX.
  4469     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4470     12  AM-CERTS-PURGED-DATE.
  4471         16  AM-PUR-YR                     PIC XX.
  4472         16  AM-PUR-MO                     PIC XX.
  4473         16  AM-PUR-DA                     PIC XX.
  4474     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4475     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4476     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4477     12  AM-INACTIVE-DATE.
  4478         16  AM-INA-MO                     PIC 99.
  4479         16  AM-INA-DA                     PIC 99.
  4480         16  AM-INA-YR                     PIC 99.
  4481     12  AM-AR-HI-CERT-DATE                PIC XX.
  4482
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  82
* EL1278.cbl
  4483     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4484     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4485
  4486     12  AM-OB-PAYMENT-MODE                PIC X.
  4487         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4488         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4489         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4490         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4491
  4492     12  AM-AH-ONLY-INDICATOR              PIC X.
  4493         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4494         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4495
  4496     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4497
  4498     12  AM-OVER-SHORT.
  4499         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4500         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4501
  4502     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4503     12  AM-DCC-CLP-STATE                  PIC XX.
  4504
  4505     12  AM-RECALC-COMM                    PIC X.
  4506     12  AM-RECALC-REIN                    PIC X.
  4507
  4508     12  AM-REI-TABLE                      PIC XXX.
  4509     12  AM-REI-ET-LF                      PIC X.
  4510     12  AM-REI-ET-AH                      PIC X.
  4511     12  AM-REI-PE-LF                      PIC X.
  4512     12  AM-REI-PE-AH                      PIC X.
  4513     12  AM-REI-PRT-ST                     PIC X.
  4514     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4515     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4516     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4517     12  AM-REI-GROUP-A                    PIC X(6).
  4518     12  AM-REI-MORT                       PIC X(4).
  4519     12  AM-REI-PRT-OW                     PIC X.
  4520     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4521     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4522     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4523     12  AM-REI-GROUP-B                    PIC X(6).
  4524
  4525     12  AM-TRUST-TYPE                     PIC X(2).
  4526
  4527     12  AM-EMPLOYER-STMT-USED             PIC X.
  4528     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4529
  4530     12  AM-STD-AH-TYPE                    PIC XX.
  4531     12  AM-EARN-METHODS.
  4532         16  AM-EARN-METHOD-R              PIC X.
  4533             88 AM-REF-RL-R78                 VALUE 'R'.
  4534             88 AM-REF-RL-PR                  VALUE 'P'.
  4535             88 AM-REF-RL-MEAN                VALUE 'M'.
  4536             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4537         16  AM-EARN-METHOD-L              PIC X.
  4538             88 AM-REF-LL-R78                 VALUE 'R'.
  4539             88 AM-REF-LL-PR                  VALUE 'P'.
  4540             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  83
* EL1278.cbl
  4541             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4542         16  AM-EARN-METHOD-A              PIC X.
  4543             88 AM-REF-AH-R78                 VALUE 'R'.
  4544             88 AM-REF-AH-PR                  VALUE 'P'.
  4545             88 AM-REF-AH-MEAN                VALUE 'M'.
  4546             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4547             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4548             88 AM-REF-AH-NET                 VALUE 'N'.
  4549
  4550     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4551     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4552     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4553
  4554     12  AM-RET-Y-N                        PIC X.
  4555     12  AM-RET-P-E                        PIC X.
  4556     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4557     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4558     12  AM-RET-GRP                        PIC X(6).
  4559     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4560         16  AM-POOL-PRIME                 PIC XXX.
  4561         16  AM-POOL-SUB                   PIC XXX.
  4562     12  AM-RETRO-EARNINGS.
  4563         16  AM-RET-EARN-R                 PIC X.
  4564         16  AM-RET-EARN-L                 PIC X.
  4565         16  AM-RET-EARN-A                 PIC X.
  4566     12  AM-RET-ST-TAX-USE                 PIC X.
  4567         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4568         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4569     12  AM-RETRO-BEG-EARNINGS.
  4570         16  AM-RET-BEG-EARN-R             PIC X.
  4571         16  AM-RET-BEG-EARN-L             PIC X.
  4572         16  AM-RET-BEG-EARN-A             PIC X.
  4573     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4574     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4575
  4576     12  AM-USER-SELECT-OPTIONS.
  4577         16  AM-USER-SELECT-1              PIC X(10).
  4578         16  AM-USER-SELECT-2              PIC X(10).
  4579         16  AM-USER-SELECT-3              PIC X(10).
  4580         16  AM-USER-SELECT-4              PIC X(10).
  4581         16  AM-USER-SELECT-5              PIC X(10).
  4582
  4583     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4584
  4585     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4586
  4587     12  AM-RPT045A-SWITCH                 PIC X.
  4588         88  RPT045A-OFF                   VALUE 'N'.
  4589
  4590     12  AM-INSURANCE-LIMITS.
  4591         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4592         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4593
  4594     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4595         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4596
  4597     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4598         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  84
* EL1278.cbl
  4599         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4600
  4601     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4602
  4603     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4604     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4605     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4606     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4607     12  AM-DCC-UEF-STATE                  PIC XX.
  4608     12  FILLER                            PIC XXX.
  4609     12  AM-REPORT-CODE-3                  PIC X(10).
  4610*    12  FILLER                            PIC X(22).
  4611
  4612     12  AM-RESERVE-DATE.
  4613         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4614         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4615         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4616
  4617     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4618     12  AM-NOTIFICATION-TYPES.
  4619         16  AM-NOTIF-OF-LETTERS           PIC X.
  4620         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4621         16  AM-NOTIF-OF-REPORTS           PIC X.
  4622         16  AM-NOTIF-OF-STATUS            PIC X.
  4623
  4624     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4625         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4626         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4627         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4628         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4629
  4630     12  AM-BENEFIT-CONTROLS.
  4631         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4632             20  AM-BENEFIT-CODE           PIC XX.
  4633             20  AM-BENEFIT-TYPE           PIC X.
  4634             20  AM-BENEFIT-REVISION       PIC XXX.
  4635             20  AM-BENEFIT-REM-TERM       PIC X.
  4636             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4637             20  FILLER                    PIC XX.
  4638         16  FILLER                        PIC X(80).
  4639
  4640     12  AM-TRANSFER-DATA.
  4641         16  AM-TRANSFERRED-FROM.
  4642             20  AM-TRNFROM-CARRIER        PIC X.
  4643             20  AM-TRNFROM-GROUPING.
  4644                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4645                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4646             20  AM-TRNFROM-STATE          PIC XX.
  4647             20  AM-TRNFROM-ACCOUNT.
  4648                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4649                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4650             20  AM-TRNFROM-DTE            PIC XX.
  4651         16  AM-TRANSFERRED-TO.
  4652             20  AM-TRNTO-CARRIER          PIC X.
  4653             20  AM-TRNTO-GROUPING.
  4654                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4655                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4656             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  85
* EL1278.cbl
  4657             20  AM-TRNTO-ACCOUNT.
  4658                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4659                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4660             20  AM-TRNTO-DTE              PIC XX.
  4661         16  FILLER                        PIC X(10).
  4662
  4663     12  AM-SAVED-REMIT-TO                 PIC 99.
  4664
  4665     12  AM-COMM-STRUCTURE-SAVED.
  4666         16  AM-DEFN-1-SAVED.
  4667             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4668                 24  AM-AGT-SV             PIC X(10).
  4669                 24  AM-COM-TYP-SV         PIC X.
  4670                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4671                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4672                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4673                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4674                 24  FILLER                PIC X.
  4675                 24  AM-GL-CODES-SV        PIC X.
  4676                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4677                 24  FILLER                PIC X.
  4678         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4679             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4680                 24  FILLER                PIC X(11).
  4681                 24  AM-L-COMA-SV          PIC XXX.
  4682                 24  AM-J-COMA-SV          PIC XXX.
  4683                 24  AM-A-COMA-SV          PIC XXX.
  4684                 24  FILLER                PIC X(6).
  4685
  4686     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4687         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4688            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4689            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4690            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4691
  4692     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4693     12  FILLER                            PIC X(120).
  4694
  4695     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4696         16  AM-CONTROL-NAME               PIC X(30).
  4697         16  AM-EXECUTIVE-ONE.
  4698             20  AM-EXEC1-NAME             PIC X(15).
  4699             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4700                                                          COMP-3.
  4701             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4702                                                          COMP-3.
  4703         16  AM-EXECUTIVE-TWO.
  4704             20  AM-EXEC2-NAME             PIC X(15).
  4705             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4706                                                          COMP-3.
  4707             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4708                                                          COMP-3.
  4709
  4710     12  AM-RETRO-ADDITIONAL-DATA.
  4711         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4712         16  AM-RETRO-PREM-P-E             PIC X.
  4713         16  AM-RETRO-CLMS-P-I             PIC X.
  4714         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  86
* EL1278.cbl
  4715             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4716                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4717                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4718             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4719                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4720                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4721             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4722                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4723                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4724         16  AM-RETRO-RET-BRACKET-AH.
  4725             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4726                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4727                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4728                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4729             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4730                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4731                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4732             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4733                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4734                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4735
  4736     12  AM-COMMENTS.
  4737         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4738
  4739     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4740         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4741         16  AM-FLI-BILLING-CODE           PIC X.
  4742         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4743         16  AM-FLI-UNITED-IDENT           PIC X.
  4744         16  AM-FLI-INTEREST-LOST-DATA.
  4745             20  AM-FLI-BANK-NO            PIC X(5).
  4746             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4747             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4748             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4749         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4750             20  AM-FLI-AGT                PIC X(9).
  4751             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4752             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4753         16  FILLER                        PIC X(102).
  4754
  4755     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4756         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4757             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4758             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4759             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4760             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4761             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4762         16  FILLER                          PIC X(10).
  4763******************************************************************
  4764*                            COPY ELCCERT.
  4765******************************************************************
  4766*                                                                *
  4767*                            ELCCERT.                            *
  4768*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4769*                            VMOD=2.013                          *
  4770*                                                                *
  4771*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4772*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  87
* EL1278.cbl
  4773*   FILE TYPE = VSAM,KSDS                                        *
  4774*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4775*                                                                *
  4776*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4777*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4778*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4779*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4780*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4781*                                                                *
  4782*   LOG = YES                                                    *
  4783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4784******************************************************************
  4785*                   C H A N G E   L O G
  4786*
  4787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4788*-----------------------------------------------------------------
  4789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4790* EFFECTIVE    NUMBER
  4791*-----------------------------------------------------------------
  4792* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4793* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4794* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4795* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4796* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4797* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4798* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4799* 032612  CR2011110200001  PEMA  AHL CHANGES
  4800******************************************************************
  4801
  4802 01  CERTIFICATE-MASTER.
  4803     12  CM-RECORD-ID                      PIC XX.
  4804         88  VALID-CM-ID                      VALUE 'CM'.
  4805
  4806     12  CM-CONTROL-PRIMARY.
  4807         16  CM-COMPANY-CD                 PIC X.
  4808         16  CM-CARRIER                    PIC X.
  4809         16  CM-GROUPING.
  4810             20  CM-GROUPING-PREFIX        PIC X(3).
  4811             20  CM-GROUPING-PRIME         PIC X(3).
  4812         16  CM-STATE                      PIC XX.
  4813         16  CM-ACCOUNT.
  4814             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4815             20  CM-ACCOUNT-PRIME          PIC X(6).
  4816         16  CM-CERT-EFF-DT                PIC XX.
  4817         16  CM-CERT-NO.
  4818             20  CM-CERT-PRIME             PIC X(10).
  4819             20  CM-CERT-SFX               PIC X.
  4820
  4821     12  CM-CONTROL-BY-NAME.
  4822         16  CM-COMPANY-CD-A1              PIC X.
  4823         16  CM-INSURED-LAST-NAME          PIC X(15).
  4824         16  CM-INSURED-INITIALS.
  4825             20  CM-INSURED-INITIAL1       PIC X.
  4826             20  CM-INSURED-INITIAL2       PIC X.
  4827
  4828     12  CM-CONTROL-BY-SSN.
  4829         16  CM-COMPANY-CD-A2              PIC X.
  4830         16  CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  88
* EL1278.cbl
  4831             20  CM-SSN-STATE              PIC XX.
  4832             20  CM-SSN-ACCOUNT            PIC X(6).
  4833             20  CM-SSN-LN3.
  4834                 25  CM-INSURED-INITIALS-A2.
  4835                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4836                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4837                 25 CM-PART-LAST-NAME-A2         PIC X.
  4838
  4839     12  CM-CONTROL-BY-CERT-NO.
  4840         16  CM-COMPANY-CD-A4              PIC X.
  4841         16  CM-CERT-NO-A4                 PIC X(11).
  4842
  4843     12  CM-CONTROL-BY-MEMB.
  4844         16  CM-COMPANY-CD-A5              PIC X.
  4845         16  CM-MEMBER-NO.
  4846             20  CM-MEMB-STATE             PIC XX.
  4847             20  CM-MEMB-ACCOUNT           PIC X(6).
  4848             20  CM-MEMB-LN4.
  4849                 25  CM-INSURED-INITIALS-A5.
  4850                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4851                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4852                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4853
  4854     12  CM-INSURED-PROFILE-DATA.
  4855         16  CM-INSURED-FIRST-NAME.
  4856             20  CM-INSURED-1ST-INIT       PIC X.
  4857             20  FILLER                    PIC X(9).
  4858         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4859         16  CM-INSURED-SEX                PIC X.
  4860             88  CM-SEX-MALE                  VALUE 'M'.
  4861             88  CM-SEX-FEMAL                 VALUE 'F'.
  4862         16  CM-INSURED-JOINT-AGE          PIC 99.
  4863         16  CM-JOINT-INSURED-NAME.
  4864             20  CM-JT-LAST-NAME           PIC X(15).
  4865             20  CM-JT-FIRST-NAME.
  4866                 24  CM-JT-1ST-INIT        PIC X.
  4867                 24  FILLER                PIC X(9).
  4868             20  CM-JT-INITIAL             PIC X.
  4869
  4870     12  CM-LIFE-DATA.
  4871         16  CM-LF-BENEFIT-CD              PIC XX.
  4872         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4873         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4874         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4875         16  CM-LF-DEV-CODE                PIC XXX.
  4876         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4877         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4878         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4879         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4880         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4881         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4882         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4883         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4884         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4885         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4886         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4887         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4888         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  89
* EL1278.cbl
  4889
  4890     12  CM-AH-DATA.
  4891         16  CM-AH-BENEFIT-CD              PIC XX.
  4892         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4893         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4894         16  CM-AH-DEV-CODE                PIC XXX.
  4895         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4896         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4897         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4898         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4899         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4900         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4901         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4902         16  CM-AH-PAID-THRU-DT            PIC XX.
  4903             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4904         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4905         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4906         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4907         16  FILLER                        PIC X.
  4908
  4909     12  CM-LOAN-INFORMATION.
  4910         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4911         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4912                                           PIC S9(5)V99  COMP-3.
  4913         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4914         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4915         16  CM-PAY-FREQUENCY              PIC S99.
  4916         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4917         16  CM-RATE-CLASS                 PIC XX.
  4918         16  CM-BENEFICIARY                PIC X(25).
  4919         16  CM-POLICY-FORM-NO             PIC X(12).
  4920         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4921         16  CM-LAST-ADD-ON-DT             PIC XX.
  4922         16  CM-DEDUCTIBLE-AMOUNTS.
  4923             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4924             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4925         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4926             20  CM-RESIDENT-STATE         PIC XX.
  4927             20  CM-RATE-CODE              PIC X(4).
  4928             20  FILLER                    PIC XX.
  4929         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4930             20  CM-LOAN-OFFICER           PIC X(5).
  4931             20  FILLER                    PIC XXX.
  4932         16  CM-CSR-CODE                   PIC XXX.
  4933         16  CM-UNDERWRITING-CODE          PIC X.
  4934             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4935         16  CM-POST-CARD-IND              PIC X.
  4936         16  CM-NH-INTERFACE-SW            PIC X.
  4937         16  CM-PREMIUM-TYPE               PIC X.
  4938             88  CM-SING-PRM                  VALUE '1'.
  4939             88  CM-O-B-COVERAGE              VALUE '2'.
  4940             88  CM-OPEN-END                  VALUE '3'.
  4941         16  CM-IND-GRP-TYPE               PIC X.
  4942             88  CM-INDIVIDUAL                VALUE 'I'.
  4943             88  CM-GROUP                     VALUE 'G'.
  4944         16  CM-SKIP-CODE                  PIC X.
  4945             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4946             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  90
* EL1278.cbl
  4947             88  SKIP-AUGUST                  VALUE '2'.
  4948             88  SKIP-SEPTEMBER               VALUE '3'.
  4949             88  SKIP-JULY-AUG                VALUE '4'.
  4950             88  SKIP-AUG-SEPT                VALUE '5'.
  4951             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4952             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4953             88  SKIP-JUNE                    VALUE '8'.
  4954             88  SKIP-JUNE-JULY               VALUE '9'.
  4955             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4956             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4957         16  CM-PAYMENT-MODE               PIC X.
  4958             88  PAY-MONTHLY                  VALUE SPACE.
  4959             88  PAY-WEEKLY                   VALUE '1'.
  4960             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4961             88  PAY-BI-WEEKLY                VALUE '3'.
  4962             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4963         16  CM-LOAN-NUMBER                PIC X(8).
  4964         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4965         16  CM-OLD-LOF                    PIC XXX.
  4966*        16  CM-LOAN-OFFICER               PIC XXX.
  4967         16  CM-REIN-TABLE                 PIC XXX.
  4968         16  CM-SPECIAL-REIN-CODE          PIC X.
  4969         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4970         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4971         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4972
  4973     12  CM-STATUS-DATA.
  4974         16  CM-ENTRY-STATUS               PIC X.
  4975         16  CM-ENTRY-DT                   PIC XX.
  4976
  4977         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4978         16  CM-LF-CANCEL-DT               PIC XX.
  4979         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4980
  4981         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4982         16  CM-LF-DEATH-DT                PIC XX.
  4983         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4984
  4985         16  CM-LF-CURRENT-STATUS          PIC X.
  4986             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4987                                                'M' '4' '5' '9'.
  4988             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4989             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4990             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4991             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4992             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4993             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4994             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4995             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4996             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4997             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4998             88  CM-LF-DECLINED               VALUE 'D'.
  4999             88  CM-LF-VOIDED                 VALUE 'V'.
  5000
  5001         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5002         16  CM-AH-CANCEL-DT               PIC XX.
  5003         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5004
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  91
* EL1278.cbl
  5005         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5006         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5007         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5008
  5009         16  CM-AH-CURRENT-STATUS          PIC X.
  5010             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5011                                                'M' '4' '5' '9'.
  5012             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5013             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5014             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5015             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5016             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5017             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5018             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5019             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5020             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5021             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5022             88  CM-AH-DECLINED               VALUE 'D'.
  5023             88  CM-AH-VOIDED                 VALUE 'V'.
  5024
  5025         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5026             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5027             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5028             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5029         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5030
  5031         16  CM-ENTRY-BATCH                PIC X(6).
  5032         16  CM-LF-EXIT-BATCH              PIC X(6).
  5033         16  CM-AH-EXIT-BATCH              PIC X(6).
  5034         16  CM-LAST-MONTH-END             PIC XX.
  5035
  5036     12  CM-NOTE-SW                        PIC X.
  5037         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5038         88  CERT-NOTES-PRESENT               VALUE '1'.
  5039         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5040         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5041         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5042         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5043         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5044         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5045     12  CM-COMP-EXCP-SW                   PIC X.
  5046         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5047         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5048     12  CM-INSURED-ADDRESS-SW             PIC X.
  5049         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5050         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5051
  5052*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5053     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5054     12  FILLER                            PIC X.
  5055
  5056*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5057     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5058     12  FILLER                            PIC X.
  5059*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5060     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5061
  5062     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  92
* EL1278.cbl
  5063         88  CERT-ADDED-BATCH                 VALUE ' '.
  5064         88  CERT-ADDED-ONLINE                VALUE '1'.
  5065         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5066         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5067         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5068     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5069         88  CERT-AS-LOADED                   VALUE ' '.
  5070         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5071         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5072         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5073         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5074         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5075         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5076         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5077
  5078     12  CM-ACCOUNT-COMM-PCTS.
  5079         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5080         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5081
  5082     12  CM-USER-FIELD                     PIC X.
  5083     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5084     12  CM-CLP-STATE                      PIC XX.
  5085     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5086     12  CM-USER-RESERVED                  PIC XXX.
  5087     12  FILLER REDEFINES CM-USER-RESERVED.
  5088         16  CM-AH-CLASS-CD                PIC XX.
  5089         16  F                             PIC X.
  5090******************************************************************
  5091*                            COPY ERCMAIL.
  5092******************************************************************
  5093*                                                                *
  5094*                                                                *
  5095*                            ERCMAIL                             *
  5096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5097*                            VMOD=2.003                          *
  5098*                                                                *
  5099*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5100*                                                                *
  5101*   FILE TYPE = VSAM,KSDS                                        *
  5102*   RECORD SIZE = 374   RECFORM = FIX                            *
  5103*                                                                *
  5104*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5105*   ALTERNATE PATH    = NOT USED                                 *
  5106*                                                                *
  5107*   LOG = YES                                                    *
  5108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5109******************************************************************
  5110*                   C H A N G E   L O G
  5111*
  5112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5113*-----------------------------------------------------------------
  5114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5115* EFFECTIVE    NUMBER
  5116*-----------------------------------------------------------------
  5117* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5119* 111108                   PEMA  ADD CRED BENE ADDR2
  5120******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  93
* EL1278.cbl
  5121
  5122 01  MAILING-DATA.
  5123     12  MA-RECORD-ID                      PIC XX.
  5124         88  VALID-MA-ID                       VALUE 'MA'.
  5125
  5126     12  MA-CONTROL-PRIMARY.
  5127         16  MA-COMPANY-CD                 PIC X.
  5128         16  MA-CARRIER                    PIC X.
  5129         16  MA-GROUPING.
  5130             20  MA-GROUPING-PREFIX        PIC XXX.
  5131             20  MA-GROUPING-PRIME         PIC XXX.
  5132         16  MA-STATE                      PIC XX.
  5133         16  MA-ACCOUNT.
  5134             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5135             20  MA-ACCOUNT-PRIME          PIC X(6).
  5136         16  MA-CERT-EFF-DT                PIC XX.
  5137         16  MA-CERT-NO.
  5138             20  MA-CERT-PRIME             PIC X(10).
  5139             20  MA-CERT-SFX               PIC X.
  5140
  5141     12  FILLER                            PIC XX.
  5142
  5143     12  MA-ACCESS-CONTROL.
  5144         16  MA-SOURCE-SYSTEM              PIC XX.
  5145             88  MA-FROM-CREDIT                VALUE 'CR'.
  5146             88  MA-FROM-VSI                   VALUE 'VS'.
  5147             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5148             88  MA-FROM-OTHER                 VALUE 'OT'.
  5149         16  MA-RECORD-ADD-DT              PIC XX.
  5150         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5151         16  MA-LAST-MAINT-DT              PIC XX.
  5152         16  MA-LAST-MAINT-BY              PIC XXXX.
  5153         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5154
  5155     12  MA-PROFILE-INFO.
  5156         16  MA-QUALIFY-CODE-1             PIC XX.
  5157         16  MA-QUALIFY-CODE-2             PIC XX.
  5158         16  MA-QUALIFY-CODE-3             PIC XX.
  5159         16  MA-QUALIFY-CODE-4             PIC XX.
  5160         16  MA-QUALIFY-CODE-5             PIC XX.
  5161
  5162         16  MA-INSURED-LAST-NAME          PIC X(15).
  5163         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5164         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5165         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5166         16  MA-INSURED-BIRTH-DT           PIC XX.
  5167         16  MA-INSURED-SEX                PIC X.
  5168             88  MA-SEX-MALE                   VALUE 'M'.
  5169             88  MA-SEX-FEMALE                 VALUE 'F'.
  5170         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5171
  5172         16  MA-ADDRESS-CORRECTED          PIC X.
  5173         16  MA-JOINT-BIRTH-DT             PIC XX.
  5174*        16  FILLER                        PIC X(12).
  5175
  5176         16  MA-ADDRESS-LINE-1             PIC X(30).
  5177         16  MA-ADDRESS-LINE-2             PIC X(30).
  5178         16  MA-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  94
* EL1278.cbl
  5179             20  MA-CITY                   PIC X(28).
  5180             20  MA-ADDR-STATE             PIC XX.
  5181         16  MA-ZIP.
  5182             20  MA-ZIP-CODE.
  5183                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5184                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5185                 24  FILLER                PIC X(4).
  5186             20  MA-ZIP-PLUS4              PIC X(4).
  5187         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5188             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5189             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5190             20  FILLER                    PIC X(3).
  5191
  5192         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5193
  5194         16  FILLER                        PIC XXX.
  5195*        16  FILLER                        PIC X(10).
  5196
  5197     12  MA-CRED-BENE-INFO.
  5198         16  MA-CRED-BENE-NAME                 PIC X(25).
  5199         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5200         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5201         16  MA-CRED-BENE-CTYST.
  5202             20  MA-CRED-BENE-CITY             PIC X(28).
  5203             20  MA-CRED-BENE-STATE            PIC XX.
  5204         16  MA-CRED-BENE-ZIP.
  5205             20  MA-CB-ZIP-CODE.
  5206                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5207                     88  MA-CB-CANADIAN-POST-CODE
  5208                                           VALUE 'A' THRU 'Z'.
  5209                 24  FILLER                    PIC X(4).
  5210             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5211         16  MA-CB-CANADIAN-POSTAL-CODE
  5212                            REDEFINES MA-CRED-BENE-ZIP.
  5213             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5214             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5215             20  FILLER                        PIC X(3).
  5216     12  MA-POST-CARD-MAIL-DATA.
  5217         16  MA-MAIL-DATA OCCURS 7.
  5218             20  MA-MAIL-TYPE              PIC X.
  5219                 88  MA-12MO-MAILING           VALUE '1'.
  5220                 88  MA-EXP-MAILING            VALUE '2'.
  5221             20  MA-MAIL-STATUS            PIC X.
  5222                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5223                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5224                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5225             20  MA-MAIL-DATE              PIC XX.
  5226     12  FILLER                            PIC XX.
  5227     12  FILLER                            PIC XX.
  5228*    12  FILLER                            PIC X(30).
  5229******************************************************************
  5230*                            COPY ELCCRTO.
  5231******************************************************************
  5232*                                                                *
  5233*                            ELCCRTO.                            *
  5234*                                                                *
  5235*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5236*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  95
* EL1278.cbl
  5237*   FILE TYPE = VSAM,KSDS                                        *
  5238*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5239*                                                                *
  5240*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5241*                                                                *
  5242*   LOG = YES                                                    *
  5243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5244******************************************************************
  5245*                   C H A N G E   L O G
  5246*
  5247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5248*-----------------------------------------------------------------
  5249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5250* EFFECTIVE    NUMBER
  5251*-----------------------------------------------------------------
  5252* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5253* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5254* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5255* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5256* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  5257******************************************************************
  5258 01  ORIGINAL-CERTIFICATE.
  5259     12  OC-RECORD-ID                      PIC XX.
  5260         88  VALID-OC-ID                      VALUE 'OC'.
  5261     12  OC-CONTROL-PRIMARY.
  5262         16  OC-COMPANY-CD                 PIC X.
  5263         16  OC-CARRIER                    PIC X.
  5264         16  OC-GROUPING                   PIC X(6).
  5265         16  OC-STATE                      PIC XX.
  5266         16  OC-ACCOUNT                    PIC X(10).
  5267         16  OC-CERT-EFF-DT                PIC XX.
  5268         16  OC-CERT-NO.
  5269             20  OC-CERT-PRIME             PIC X(10).
  5270             20  OC-CERT-SFX               PIC X.
  5271         16  OC-RECORD-TYPE                PIC X.
  5272         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5273     12  OC-LAST-MAINT-DT                  PIC XX.
  5274     12  OC-LAST-MAINT-BY                  PIC X(4).
  5275     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5276     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5277     12  FILLER                            PIC X(49).
  5278     12  OC-ORIG-REC.
  5279         16  OC-INS-LAST-NAME              PIC X(15).
  5280         16  OC-INS-FIRST-NAME             PIC X(10).
  5281         16  OC-INS-MIDDLE-INIT            PIC X.
  5282         16  OC-INS-AGE                    PIC S999     COMP-3.
  5283         16  OC-JNT-LAST-NAME              PIC X(15).
  5284         16  OC-JNT-FIRST-NAME             PIC X(10).
  5285         16  OC-JNT-MIDDLE-INIT            PIC X.
  5286         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5287         16  OC-LF-BENCD                   PIC XX.
  5288         16  OC-LF-TERM                    PIC S999      COMP-3.
  5289         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5290         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5291         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5292         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5293         16  OC-LF-EXP-DT                  PIC XX.
  5294         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  96
* EL1278.cbl
  5295         16  OC-LF-CANCEL-DT               PIC XX.
  5296         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5297         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5298         16  OC-AH-BENCD                   PIC XX.
  5299         16  OC-AH-TERM                    PIC S999      COMP-3.
  5300         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5301         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5302         16  OC-AH-EXP-DT                  PIC XX.
  5303         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5304         16  OC-AH-CP                      PIC 99.
  5305         16  OC-AH-CANCEL-DT               PIC XX.
  5306         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5307         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5308         16  OC-CRED-BENE-NAME             PIC X(25).
  5309         16  OC-1ST-PMT-DT                 PIC XX.
  5310         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5311         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5312         16  OC-ISSUE-TRAN-IND             PIC X.
  5313         16  OC-CANCEL-TRAN-IND            PIC X.
  5314         16  FILLER                        PIC X(211).
  5315
  5316     12  FILLER                            PIC X(50).
  5317******************************************************************
  5318*                            COPY ERCFORM.
  5319******************************************************************
  5320*                                                                *
  5321*                                                                *
  5322*                            ERCFORM.                            *
  5323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5324*                            VMOD=2.003                          *
  5325*                                                                *
  5326*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5327*                                                                *
  5328*    FILE TYPE = VSAM,KSDS                                       *
  5329*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5330*                                                                *
  5331*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5332*                                                                *
  5333*    LOG = YES                                                   *
  5334*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5335******************************************************************
  5336 01  FORM-MASTER.
  5337    12  FO-RECORD-ID                 PIC X(02).
  5338        88  VALID-FO-ID                  VALUE 'FO'.
  5339
  5340    12  FO-CONTROL-PRIMARY.
  5341        16  FO-COMPANY-CD            PIC X(01).
  5342        16  FO-STATE                 PIC X(02).
  5343        16  FO-FORM-ID               PIC X(12).
  5344        16  FO-FORM-EXP-DT           PIC X(02).
  5345
  5346    12  FO-POLICY-FORM-DATA.
  5347        16  FO-IND-GRP-CD            PIC X(01).
  5348        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5349        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5350        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5351        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5352        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  97
* EL1278.cbl
  5353        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5354        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5355        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5356        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5357        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5358        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5359        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5360        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5361        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5362        16  FO-APP-CERT-USE-CD       PIC X(01).
  5363
  5364    12  FILLER                       PIC X(29).
  5365
  5366    12  FO-FORM-PLAN-TABLE.
  5367        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5368            20  FO-PLAN-TYPE         PIC X(01).
  5369            20  FO-PLAN-ID           PIC X(02).
  5370            20  FO-PLAN-TERM         PIC 9(03).
  5371            20  FO-PLAN-REFUND-METHOD
  5372                                     PIC X.
  5373
  5374    12  FILLER                       PIC X(30).
  5375
  5376    12  FO-COMMENTS-AREA.
  5377        16  FO-COMMENT-LINE-1        PIC X(78).
  5378
  5379    12  FILLER                       PIC X(20).
  5380
  5381    12  FO-MAINT-INFORMATION.
  5382        16  FO-LAST-MAINT-DT         PIC X(02).
  5383        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5384        16  FO-LAST-MAINT-BY         PIC X(04).
  5385*                            COPY ELCMSTR.
  5386******************************************************************
  5387*                                                                *
  5388*                            ELCMSTR.                            *
  5389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5390*                            VMOD=2.012                          *
  5391*                                                                *
  5392*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5393*                                                                *
  5394*   FILE TYPE = VSAM,KSDS                                        *
  5395*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5396*                                                                *
  5397*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5398*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5399*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5400*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5401*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5402*                                                 RKP=75,LEN=21  *
  5403*                                                                *
  5404*   **** NOTE ****                                               *
  5405*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5406*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5407*                                                                *
  5408*   LOG = YES                                                    *
  5409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5410******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  98
* EL1278.cbl
  5411*                   C H A N G E   L O G
  5412*
  5413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5414*-----------------------------------------------------------------
  5415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5416* EFFECTIVE    NUMBER
  5417*-----------------------------------------------------------------
  5418* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5419* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5420* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  5421******************************************************************
  5422 01  CLAIM-MASTER.
  5423     12  CL-RECORD-ID                PIC XX.
  5424         88  VALID-CL-ID         VALUE 'CL'.
  5425
  5426     12  CL-CONTROL-PRIMARY.
  5427         16  CL-COMPANY-CD           PIC X.
  5428         16  CL-CARRIER              PIC X.
  5429         16  CL-CLAIM-NO             PIC X(7).
  5430         16  CL-CERT-NO.
  5431             20  CL-CERT-PRIME       PIC X(10).
  5432             20  CL-CERT-SFX         PIC X.
  5433
  5434     12  CL-CONTROL-BY-NAME.
  5435         16  CL-COMPANY-CD-A1        PIC X.
  5436         16  CL-INSURED-LAST-NAME    PIC X(15).
  5437         16  CL-INSURED-NAME.
  5438             20  CL-INSURED-1ST-NAME PIC X(12).
  5439             20  CL-INSURED-MID-INIT PIC X.
  5440
  5441     12  CL-CONTROL-BY-SSN.
  5442         16  CL-COMPANY-CD-A2        PIC X.
  5443         16  CL-SOC-SEC-NO.
  5444             20  CL-SSN-STATE        PIC XX.
  5445             20  CL-SSN-ACCOUNT      PIC X(6).
  5446             20  CL-SSN-LN3          PIC X(3).
  5447
  5448     12  CL-CONTROL-BY-CERT-NO.
  5449         16  CL-COMPANY-CD-A4        PIC X.
  5450         16  CL-CERT-NO-A4.
  5451             20  CL-CERT-A4-PRIME    PIC X(10).
  5452             20  CL-CERT-A4-SFX      PIC X.
  5453
  5454     12  CL-CONTROL-BY-CCN.
  5455         16  CL-COMPANY-CD-A5        PIC X.
  5456         16  CL-CCN-A5.
  5457             20  CL-CCN.
  5458                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5459                 24  CL-CCN-PRIME-A5 PIC X(12).
  5460             20  CL-CCN-FILLER-A5    PIC X(4).
  5461
  5462     12  CL-INSURED-PROFILE-DATA.
  5463         16  CL-INSURED-BIRTH-DT     PIC XX.
  5464         16  CL-INSURED-SEX-CD       PIC X.
  5465             88  INSURED-IS-MALE        VALUE 'M'.
  5466             88  INSURED-IS-FEMALE      VALUE 'F'.
  5467             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5468         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page  99
* EL1278.cbl
  5469         16  FILLER                  PIC X(5).
  5470
  5471     12  CL-PROCESSING-INFO.
  5472         16  CL-PROCESSOR-ID         PIC X(4).
  5473         16  CL-CLAIM-STATUS         PIC X.
  5474             88  CLAIM-IS-OPEN          VALUE 'O'.
  5475             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5476         16  CL-CLAIM-TYPE           PIC X.
  5477*            88  AH-CLAIM               VALUE 'A'.
  5478*            88  LIFE-CLAIM             VALUE 'L'.
  5479*            88  PROPERTY-CLAIM         VALUE 'P'.
  5480*            88  IUI-CLAIM              VALUE 'I'.
  5481*            88  GAP-CLAIM              VALUE 'G'.
  5482         16  CL-CLAIM-PREM-TYPE      PIC X.
  5483             88  SINGLE-PREMIUM         VALUE '1'.
  5484             88  O-B-COVERAGE           VALUE '2'.
  5485             88  OPEN-END-COVERAGE      VALUE '3'.
  5486         16  CL-INCURRED-DT          PIC XX.
  5487         16  CL-REPORTED-DT          PIC XX.
  5488         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5489         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5490         16  CL-LAST-PMT-DT          PIC XX.
  5491         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5492         16  CL-PAID-THRU-DT         PIC XX.
  5493         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5494         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5495         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5496         16  CL-PMT-CALC-METHOD      PIC X.
  5497             88  CL-360-DAY-YR          VALUE '1'.
  5498             88  CL-365-DAY-YR          VALUE '2'.
  5499             88  CL-FULL-MONTHS         VALUE '3'.
  5500         16  CL-CAUSE-CD             PIC X(6).
  5501
  5502         16  CL-PRIME-CERT-NO.
  5503             20  CL-PRIME-CERT-PRIME PIC X(10).
  5504             20  CL-PRIME-CERT-SFX   PIC X.
  5505
  5506         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5507             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5508             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5509
  5510         16  CL-MICROFILM-NO         PIC X(10).
  5511         16  CL-PROG-FORM-TYPE       PIC X.
  5512         16  CL-LAST-ADD-ON-DT       PIC XX.
  5513
  5514         16  CL-LAST-REOPEN-DT       PIC XX.
  5515         16  CL-LAST-CLOSE-DT        PIC XX.
  5516         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5517             88  FINAL-PAID             VALUE '1'.
  5518             88  CLAIM-DENIED           VALUE '2'.
  5519             88  AUTO-CLOSE             VALUE '3'.
  5520             88  MANUAL-CLOSE           VALUE '4'.
  5521             88  BENEFITS-CHANGED       VALUE 'C'.
  5522             88  SETUP-ERRORS           VALUE 'E'.
  5523         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5524         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5525         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5526             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 100
* EL1278.cbl
  5527         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5528         16  FILLER                  PIC X.
  5529
  5530     12  CL-CERTIFICATE-DATA.
  5531         16  CL-CERT-ORIGIN          PIC X.
  5532             88  CERT-WAS-ONLINE        VALUE '1'.
  5533             88  CERT-WAS-CREATED       VALUE '2'.
  5534             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5535         16  CL-CERT-KEY-DATA.
  5536             20  CL-CERT-CARRIER     PIC X.
  5537             20  CL-CERT-GROUPING    PIC X(6).
  5538             20  CL-CERT-STATE       PIC XX.
  5539             20  CL-CERT-ACCOUNT.
  5540                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5541                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5542             20  CL-CERT-EFF-DT      PIC XX.
  5543
  5544     12  CL-STATUS-CONTROLS.
  5545         16  CL-PRIORITY-CD          PIC X.
  5546             88  CONFIDENTIAL-DATA      VALUE '8'.
  5547             88  HIGHEST-PRIORITY       VALUE '9'.
  5548         16  CL-SUPV-ATTN-CD         PIC X.
  5549             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5550             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5551         16  CL-PURGED-DT            PIC XX.
  5552         16  CL-RESTORED-DT          PIC XX.
  5553         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5554         16  CL-NEXT-RESEND-DT       PIC XX.
  5555         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5556         16  CL-CRITICAL-PERIOD      PIC 99.
  5557*        16  FILLER                  PIC XX.
  5558         16  CL-LAST-MAINT-DT        PIC XX.
  5559         16  CL-LAST-MAINT-USER      PIC X(4).
  5560         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5561         16  CL-LAST-MAINT-TYPE      PIC X.
  5562             88  CLAIM-SET-UP           VALUE ' '.
  5563             88  PAYMENT-MADE           VALUE '1'.
  5564             88  LETTER-SENT            VALUE '2'.
  5565             88  MASTER-WAS-ALTERED     VALUE '3'.
  5566             88  MASTER-WAS-RESTORED    VALUE '4'.
  5567             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5568             88  FILE-CONVERTED         VALUE '6'.
  5569             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5570             88  ERROR-CORRECTION       VALUE 'E'.
  5571         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5572         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5573         16  CL-BENEFICIARY          PIC X(10).
  5574         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5575         16  CL-DENIAL-TYPE          PIC X.
  5576             88  CL-TYPE-DENIAL          VALUE '1'.
  5577             88  CL-TYPE-RESCISSION      VALUE '2'.
  5578             88  CL-TYPE-REFORMATION     VALUE '3'.
  5579             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5580             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5581         16  CL-CRIT-PER-RECURRENT   PIC X.
  5582         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  5583         16  CL-RTW-DT               PIC XX.
  5584
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 101
* EL1278.cbl
  5585     12  CL-TRAILER-CONTROLS.
  5586         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5587             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5588             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5589             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5590         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5591         16  FILLER                  PIC XX.
  5592         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5593         16  CL-ADDRESS-TRAILER-CNT.
  5594             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5595                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5596             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5597                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5598             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5599                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5600             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5601                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5602             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5603                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5604             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5605                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5606             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5607                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5608
  5609     12  CL-CV-REFERENCE-NO.
  5610         16  CL-CV-REFNO-PRIME       PIC X(18).
  5611         16  CL-CV-REFNO-SFX         PIC XX.
  5612
  5613     12  CL-FILE-LOCATION            PIC X(4).
  5614
  5615     12  CL-PROCESS-ERRORS.
  5616         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5617             88  NO-FATAL-ERRORS        VALUE ZERO.
  5618         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5619             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5620
  5621     12  CL-PRODUCT-CD               PIC X.
  5622
  5623     12  CL-CURRENT-KEY-DATA.
  5624         16  CL-CURRENT-CARRIER      PIC X.
  5625         16  CL-CURRENT-GROUPING     PIC X(6).
  5626         16  CL-CURRENT-STATE        PIC XX.
  5627         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5628
  5629     12  CL-ASSOCIATES               PIC X.
  5630         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5631         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5632         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5633         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5634
  5635     12  CL-ACTIVITY-CODE            PIC 99.
  5636     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5637     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5638
  5639     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5640     12  CL-LAG-REPORT-CODE          PIC 9.
  5641     12  CL-LOAN-TYPE                PIC XX.
  5642     12  CL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 102
* EL1278.cbl
  5643
  5644     12  CL-YESNOSW                  PIC X.
  5645     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  5646         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  5647         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  5648         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  5649     12  cl-insured-claim            pic x.
  5650         88  cl-claim-on-primary         value 'P'.
  5651         88  cl-claim-on-secondary       value 'S'.
  5652     12  cl-benefit-expiration-dt    PIC XX.
  5653*                            COPY ERCPDEF.
  5654******************************************************************
  5655*                                                                *
  5656*                                                                *
  5657*                            ERCPDEF.                            *
  5658*                                                                *
  5659*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5660*                                                                *
  5661*    FILE TYPE = VSAM,KSDS                                       *
  5662*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5663*                                                                *
  5664*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5665*                                                                *
  5666*    LOG = YES                                                   *
  5667*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5668******************************************************************
  5669 01  PRODUCT-MASTER.
  5670    12  PD-RECORD-ID                 PIC X(02).
  5671        88  VALID-PD-ID                  VALUE 'PD'.
  5672    12  PD-CONTROL-PRIMARY.
  5673        16  PD-COMPANY-CD            PIC X.
  5674        16  PD-STATE                 PIC XX.
  5675        16  PD-PRODUCT-CD            PIC XXX.
  5676        16  PD-FILLER                PIC X(7).
  5677        16  PD-BEN-TYPE              PIC X.
  5678        16  PD-BEN-CODE              PIC XX.
  5679        16  PD-PROD-EXP-DT           PIC XX.
  5680    12  FILLER                       PIC X(50).
  5681    12  PD-PRODUCT-DATA OCCURS 8.
  5682        16  PD-PROD-CODE             PIC X.
  5683            88  PD-PROD-LIFE           VALUE 'L'.
  5684            88  PD-PROD-PROP           VALUE 'P'.
  5685            88  PD-PROD-AH             VALUE 'A'.
  5686            88  PD-PROD-IU             VALUE 'I'.
  5687            88  PD-PROD-GAP            VALUE 'G'.
  5688        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5689        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5690        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5691        16  PD-MAX-TERM              PIC S999        COMP-3.
  5692        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5693        16  FILLER                   PIC X.
  5694        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5695        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5696        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5697        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5698        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5699        16  PD-REC-CRIT-PERIOD       PIC X.
  5700        16  PD-RTW-MOS               PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 103
* EL1278.cbl
  5701        16  FILLER                   PIC X(5).
  5702    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5703    12  PD-TERM-LIMITS OCCURS 15.
  5704        16  PD-LOW-TERM              PIC S999        COMP-3.
  5705        16  PD-HI-TERM               PIC S999        COMP-3.
  5706*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5707    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5708        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5709        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5710    12  PD-EARN-FACTORS.
  5711        16  FILLER OCCURS 15.
  5712            20  FILLER OCCURS 15.
  5713                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5714    12  PD-PRODUCT-DESC              PIC X(80).
  5715    12  PD-TRUNCATED                 PIC X.
  5716    12  FILLER                       PIC X(59).
  5717    12  PD-MAINT-INFORMATION.
  5718        16  PD-LAST-MAINT-DT         PIC X(02).
  5719        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5720        16  PD-LAST-MAINT-BY         PIC X(04).
  5721*                            COPY ELCCRTT.
  5722******************************************************************
  5723*                                                                *
  5724*                            ELCCRTT.                            *
  5725*                                                                *
  5726*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5727*                                                                *
  5728*   FILE TYPE = VSAM,KSDS                                        *
  5729*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5730*                                                                *
  5731*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5732*                                                                *
  5733*   LOG = YES                                                    *
  5734*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5735******************************************************************
  5736*                   C H A N G E   L O G
  5737*
  5738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5739*-----------------------------------------------------------------
  5740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5741* EFFECTIVE    NUMBER
  5742*-----------------------------------------------------------------
  5743* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5744* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5745* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5746* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5747* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5748******************************************************************
  5749
  5750 01  CERTIFICATE-TRAILERS.
  5751     12  CS-RECORD-ID                      PIC XX.
  5752         88  VALID-CS-ID                      VALUE 'CS'.
  5753
  5754     12  CS-CONTROL-PRIMARY.
  5755         16  CS-COMPANY-CD                 PIC X.
  5756         16  CS-CARRIER                    PIC X.
  5757         16  CS-GROUPING                   PIC X(6).
  5758         16  CS-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 104
* EL1278.cbl
  5759         16  CS-ACCOUNT                    PIC X(10).
  5760         16  CS-CERT-EFF-DT                PIC XX.
  5761         16  CS-CERT-NO.
  5762             20  CS-CERT-PRIME             PIC X(10).
  5763             20  CS-CERT-SFX               PIC X.
  5764         16  CS-TRAILER-TYPE               PIC X.
  5765             88  COMM-TRLR           VALUE 'A'.
  5766             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5767             88  CERT-DATA-TRLR      VALUE 'C'.
  5768
  5769     12  CS-DATA-AREA                      PIC X(516).
  5770
  5771     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5772         16  CS-BANK-COMMISSION-AREA.
  5773             20  CS-BANK-COMMS       OCCURS 10.
  5774                 24  CS-AGT                PIC X(10).
  5775                 24  CS-COM-TYP            PIC X.
  5776                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5777                 24  CS-RECALC-LV-INDIC    PIC X.
  5778                 24  FILLER                PIC X(10).
  5779         16  FILLER                        PIC X(256).
  5780
  5781     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5782****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5783****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5784         16  CS-MB-CLAIM-DATA OCCURS 2.
  5785             20  FILLER OCCURS 10.
  5786                 24  CS-CLAIM-TYPE         PIC X.
  5787                     88  CS-AH-CLM           VALUE 'A'.
  5788                     88  CS-IU-CLM           VALUE 'I'.
  5789                     88  CS-GP-CLM           VALUE 'G'.
  5790                     88  CS-LF-CLM           VALUE 'L'.
  5791                     88  CS-PR-CLM           VALUE 'P'.
  5792                 24  CS-BANK               PIC S999 COMP-3.
  5793                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5794                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5795                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5796         16  FILLER                        PIC X(216).
  5797     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5798         16  CS-VIN-NUMBER                 PIC X(17).
  5799         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5800         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5801         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5802         16  FILLER                        PIC X(496).
  5803******************************************************************
  5804 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5805                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5806                          MAILING-DATA ORIGINAL-CERTIFICATE
  5807                          FORM-MASTER CLAIM-MASTER
  5808                          PRODUCT-MASTER CERTIFICATE-TRAILERS.
  5809 0000-DFHEXIT SECTION.
  5810     MOVE '9#                    $   ' TO DFHEIV0.
  5811     MOVE 'EL1278' TO DFHEIV1.
  5812     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5813*    SERVICE RELOAD PARMLIST.
  5814
  5815     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5816     MOVE '5'                    TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 105
* EL1278.cbl
  5817
  5818     PERFORM 9600-DATE-LINK.
  5819
  5820     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5821     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5822     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5823     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5824     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5825     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5826     MOVE EIBTRMID               TO  QID-TERM.
  5827
  5828     IF EIBCALEN  IS EQUAL TO  ZERO
  5829         GO TO 8700-UNAUTHORIZED-ACCESS.
  5830
  5831     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5832         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5833             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5834             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5835             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5836             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5837             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5838             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5839             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5840             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5841         ELSE
  5842             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5843             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5844             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5845             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5846             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5847             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5848             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5849             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5850             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5851
  5852     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5853         GO TO 9300-CLEAR.
  5854
  5855     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5856         NEXT SENTENCE
  5857     ELSE
  5858
  5859* EXEC CICS READQ TS
  5860*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5861*            INTO    (SECURITY-CONTROL)
  5862*            LENGTH  (SC-COMM-LENGTH)
  5863*            ITEM    (SC-ITEM)
  5864*        END-EXEC
  5865*    MOVE '*$II   L              ''   #00005854' TO DFHEIV0
  5866     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5868     MOVE X'2020233030303035383534' TO DFHEIV0(25:11)
  5869     CALL 'kxdfhei1' USING DFHEIV0,
  5870           PI-SECURITY-TEMP-STORE-ID,
  5871           SECURITY-CONTROL,
  5872           SC-COMM-LENGTH,
  5873           SC-ITEM,
  5874           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 106
* EL1278.cbl
  5875           DFHEIV99
  5876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5877         MOVE SC-CREDIT-DISPLAY (33)
  5878                                 TO  PI-DISPLAY-CAP
  5879         MOVE SC-CREDIT-UPDATE  (33)
  5880                                 TO  PI-MODIFY-CAP
  5881         MOVE SC-CREDIT-UPDATE  (32)
  5882                                 TO  PI-MODIFY-CERT-CAP
  5883         IF NOT  DISPLAY-CAP
  5884             MOVE 'READ'         TO  SM-READ
  5885             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5886             MOVE ER-0070        TO  EMI-ERROR
  5887             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5888             GO TO 8100-SEND-INITIAL-MAP.
  5889
  5890     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5891         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5892         MOVE LOW-VALUES         TO  EL127HI
  5893         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5894                                     PI-LF-CANCEL-DATE
  5895                                     WS-AH-CANCEL-DATE
  5896                                     PI-AH-CANCEL-DATE
  5897         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5898                                     PI-LF-CANCEL-DATE-ED
  5899                                     WS-AH-CANCEL-DATE-ED
  5900                                     PI-AH-CANCEL-DATE-ED
  5901         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5902                                     PI-EARNING-METHOD-AH
  5903         PERFORM 0500-FORMAT-SCREEN
  5904         GO TO 8100-SEND-INITIAL-MAP.
  5905
  5906     IF NOT  MODIFY-CAP
  5907         MOVE 'UPDATE'           TO  SM-READ
  5908         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5909         MOVE ER-0070            TO  EMI-ERROR
  5910         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5911         GO TO 8100-SEND-INITIAL-MAP.
  5912
  5913
  5914* EXEC CICS HANDLE CONDITION
  5915*        PGMIDERR  (9500-PGMID-ERROR)
  5916*        ERROR     (9900-ABEND)
  5917*    END-EXEC.
  5918*    MOVE '"$L.                  ! " #00005896' TO DFHEIV0
  5919     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5921     MOVE X'2220233030303035383936' TO DFHEIV0(25:11)
  5922     CALL 'kxdfhei1' USING DFHEIV0
  5923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5924
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 107
* EL1278.cbl
  5926 0200-RECEIVE.
  5927     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5928         MOVE ER-0008            TO  EMI-ERROR
  5929         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5930         MOVE -1                 TO  HLCANCL
  5931         GO TO 8200-SEND-DATAONLY.
  5932
  5933
  5934* EXEC CICS RECEIVE
  5935*        MAP     (MAP-NAME)
  5936*        MAPSET  (MAPSET-NAME)
  5937*        INTO    (EL127HI)
  5938*    END-EXEC.
  5939     MOVE LENGTH OF
  5940      EL127HI
  5941       TO DFHEIV11
  5942*    MOVE '8"T I  L              ''   #00005908' TO DFHEIV0
  5943     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5945     MOVE X'2020233030303035393038' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0,
  5947           MAP-NAME,
  5948           EL127HI,
  5949           DFHEIV11,
  5950           MAPSET-NAME,
  5951           DFHEIV99,
  5952           DFHEIV99
  5953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5954
  5955
  5956     IF HPFKEYL  IS EQUAL TO  ZERO
  5957         GO TO 0300-CHECK-PFKEYS.
  5958
  5959     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5960         MOVE ER-0004            TO  EMI-ERROR
  5961         GO TO 0320-INPUT-ERROR.
  5962
  5963     IF HPFKEYI NUMERIC
  5964         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5965             MOVE PF-VALUES (HPFKEYI)
  5966                                 TO  EIBAID
  5967         ELSE
  5968             MOVE ER-0029        TO  EMI-ERROR
  5969             GO TO 0320-INPUT-ERROR.
  5970
  5971 0300-CHECK-PFKEYS.
  5972     IF EIBAID  IS EQUAL TO  DFHPF23
  5973         GO TO 8800-PF23.
  5974
  5975     IF EIBAID  IS EQUAL TO  DFHPF24
  5976         GO TO 9100-RETURN-MAIN-MENU.
  5977
  5978     IF EIBAID = DFHPF11
  5979        GO TO 1700-WRITE-CERT-NOTE
  5980     END-IF
  5981
  5982     IF EIBAID  IS EQUAL TO  DFHPF12
  5983         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 108
* EL1278.cbl
  5984
  5985     IF EIBAID = DFHENTER OR DFHPF10
  5986        GO TO 0400-EDIT-INPUT-DATA
  5987     END-IF
  5988
  5989     MOVE ER-0029                TO  EMI-ERROR.
  5990
  5991 0320-INPUT-ERROR.
  5992     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5993
  5994     MOVE AL-UNBON               TO  HPFKEYA.
  5995
  5996     IF HPFKEYL  IS EQUAL TO  ZERO
  5997         MOVE -1                 TO  HLCANCL
  5998     ELSE
  5999         MOVE -1                 TO  HPFKEYL.
  6000
  6001     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 109
* EL1278.cbl
  6003 0400-EDIT-INPUT-DATA.
  6004     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  6005                                     WS-NEW-LF-CANCEL-SW.
  6006
  6007     IF (HPCYNL > 0)
  6008        AND (HPCYNI = 'Y' OR 'N')
  6009        PERFORM 1800-READ-ELCERT-UPDATE
  6010                                 THRU 1800-EXIT
  6011        IF WS-RESP-NORMAL
  6012           MOVE HPCYNI           TO CM-POST-CARD-IND
  6013           PERFORM 1810-REWRITE-ELCERT
  6014                                 THRU 1810-EXIT
  6015        END-IF
  6016     END-IF
  6017     IF HLCAL1L GREATER ZERO
  6018         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  6019     IF CLPYNI = 'Y'
  6020        MOVE 'Y'                   TO PI-CLP-YN
  6021        MOVE AL-UANON              TO CLPYNA
  6022     ELSE
  6023        MOVE ' '                   TO PI-CLP-YN
  6024        MOVE AL-UANON              TO CLPYNA
  6025     END-IF
  6026     IF CANREAI = 'R'
  6027        MOVE 'R'                 TO PI-CANCEL-REASON
  6028        MOVE AL-UANON            TO CANREAA
  6029     ELSE
  6030        MOVE ' '                 TO PI-CANCEL-REASON
  6031        MOVE AL-UANON            TO CANREAA
  6032     END-IF
  6033
  6034     IF HLCANCL  IS EQUAL TO  ZERO
  6035       AND HACANCL  IS EQUAL TO  ZERO
  6036         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6037         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6038         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6039         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6040         GO TO 0420-CHECK-ERRORS.
  6041
  6042     IF HLCANCL  IS EQUAL TO  ZERO
  6043         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  6044         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  6045         GO TO 0410-CHECK-AH-DATE.
  6046
  6047     IF HLCANCI = SPACES
  6048        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  6049                                      WS-LF-CANCEL-DATE
  6050        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  6051                                      WS-LF-CANCEL-DATE-ED
  6052                                      PI-LF-REFUND-METH
  6053        MOVE +0                    TO PI-LF-REFUND-AMT
  6054        GO TO 0410-CHECK-AH-DATE
  6055     END-IF
  6056
  6057     MOVE AL-UNNON               TO  HLCANCA.
  6058     MOVE HLCANCI                TO  DEEDIT-FIELD.
  6059     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  6060
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 110
* EL1278.cbl
  6061     PERFORM 8600-DEEDIT.
  6062
  6063     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6064     MOVE '4'                    TO  DC-OPTION-CODE.
  6065
  6066     PERFORM 9600-DATE-LINK.
  6067
  6068     IF DATE-CONVERSION-ERROR
  6069         MOVE -1                 TO  HLCANCL
  6070         MOVE AL-UABON           TO  HLCANCA
  6071         MOVE ER-2227            TO  EMI-ERROR
  6072         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6073     ELSE
  6074        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6075           MOVE -1               TO  HACANCL
  6076           MOVE AL-UABON         TO  HACANCA
  6077           MOVE ER-2774          TO  EMI-ERROR
  6078           PERFORM 9700-ERROR-FORMAT
  6079                                 THRU  9799-EXIT
  6080        ELSE
  6081           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  6082                                    PI-LF-CANCEL-DATE
  6083           MOVE DC-GREG-DATE-1-EDIT
  6084                                 TO HLCANCO
  6085                                    WS-LF-CANCEL-DATE-ED
  6086                                    PI-LF-CANCEL-DATE-ED
  6087        END-IF
  6088     END-IF
  6089     .
  6090 0410-CHECK-AH-DATE.
  6091     IF HACAL1L GREATER ZERO
  6092         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  6093
  6094     IF HACANCL  IS EQUAL TO  ZERO
  6095         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  6096         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  6097         GO TO 0420-CHECK-ERRORS.
  6098     IF HACANCI = SPACES
  6099        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  6100                                      WS-AH-CANCEL-DATE
  6101        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  6102                                      WS-AH-CANCEL-DATE-ED
  6103                                      PI-AH-REFUND-METH
  6104        MOVE +0                    TO PI-AH-REFUND-AMT
  6105        GO TO 0420-CHECK-ERRORS
  6106     END-IF
  6107
  6108     MOVE AL-UNNON               TO  HACANCA.
  6109     MOVE HACANCI                TO  DEEDIT-FIELD.
  6110     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  6111
  6112     PERFORM 8600-DEEDIT.
  6113
  6114     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  6115     MOVE '4'                    TO  DC-OPTION-CODE.
  6116
  6117     PERFORM 9600-DATE-LINK.
  6118
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 111
* EL1278.cbl
  6119     IF DATE-CONVERSION-ERROR
  6120         MOVE -1                 TO  HACANCL
  6121         MOVE AL-UABON           TO  HACANCA
  6122         MOVE ER-2227            TO  EMI-ERROR
  6123         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6124     ELSE
  6125        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  6126           MOVE -1               TO  HACANCL
  6127           MOVE AL-UABON         TO  HACANCA
  6128           MOVE ER-2775          TO  EMI-ERROR
  6129           PERFORM 9700-ERROR-FORMAT
  6130                                 THRU  9799-EXIT
  6131        ELSE
  6132           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  6133                                    PI-AH-CANCEL-DATE
  6134           MOVE DC-GREG-DATE-1-EDIT
  6135                                 TO HACANCO
  6136                                    WS-AH-CANCEL-DATE-ED
  6137                                    PI-AH-CANCEL-DATE-ED
  6138        END-IF
  6139     END-IF
  6140     .
  6141 0420-CHECK-ERRORS.
  6142     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6143         NEXT SENTENCE
  6144     ELSE
  6145         GO TO 8200-SEND-DATAONLY.
  6146
  6147     PERFORM 0500-FORMAT-SCREEN.
  6148     IF EIBAID = DFHPF10
  6149        perform 4000-GEN-CANCEL-TRANS
  6150                                 thru 4000-exit
  6151        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6152        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6153        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6154        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6155        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6156        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6157                               PI-ALL-CANCELS-SW
  6158        IF PI-PROCESSOR-IS-CSR
  6159            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6160        ELSE
  6161            MOVE ' '        TO PI-CSR-SESSION-SW
  6162        END-IF
  6163        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6164                               PI-CANCELS-IN-ERROR-SW
  6165                               PI-ONLY-BATCH-HEADERS-SW
  6166                               PI-ALL-OUT-OF-BAL-SW
  6167                               PI-HOLD-REC-SW
  6168                               PI-CHANGE-REC-SW
  6169                               PI-CHK-REQ-REC-SW
  6170                               PI-ISSUE-WARNING-SW
  6171                               PI-CANCEL-WARNING-SW
  6172        MOVE '1'            TO PI-BROWSE-TYPE
  6173        MOVE DFHENTER       TO  EIBAID
  6174
  6175
  6176* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 112
* EL1278.cbl
  6177*           PROGRAM    ('EL6311')
  6178*           COMMAREA   (WS-PASS-631)
  6179*           LENGTH     (1300)
  6180*       END-EXEC
  6181     MOVE 'EL6311' TO DFHEIV1
  6182     MOVE 1300
  6183       TO DFHEIV11
  6184*    MOVE '.$C                   %   #00006133' TO DFHEIV0
  6185     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6187     MOVE X'2020233030303036313333' TO DFHEIV0(25:11)
  6188     CALL 'kxdfhei1' USING DFHEIV0,
  6189           DFHEIV1,
  6190           WS-PASS-631,
  6191           DFHEIV11,
  6192           DFHEIV99
  6193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6194
  6195*        PERFORM 0500-FORMAT-SCREEN
  6196     END-IF
  6197     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 113
* EL1278.cbl
  6199 0500-FORMAT-SCREEN  SECTION.
  6200     MOVE LOW-VALUES             TO  EL127HO.
  6201     MOVE PI-CARRIER             TO  HCARIERO.
  6202     MOVE PI-GROUPING            TO  HGROUPO.
  6203     MOVE PI-STATE               TO  HSTATEO.
  6204     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6205     MOVE ' '                    TO  DC-OPTION-CODE.
  6206     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6207
  6208     PERFORM 9600-DATE-LINK.
  6209
  6210     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6211     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6212     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6213     MOVE PI-CLP-YN              TO  CLPYNO
  6214     MOVE PI-CANCEL-REASON       TO  CANREAO
  6215     .
  6216 0510-GET-CERT.
  6217     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6218     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6219     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6220     MOVE PI-STATE               TO  WS-CM-STATE.
  6221     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6222     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6223     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6224     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6225
  6226     PERFORM 0900-READ-CERT-FILE.
  6227
  6228     IF CERT-NOT-FOUND
  6229         MOVE -1                 TO  HLCANCL
  6230         MOVE AL-SANON           TO  HLCANCA
  6231         MOVE ER-0214            TO  EMI-ERROR
  6232         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6233         GO TO 8100-SEND-INITIAL-MAP.
  6234
  6235     IF CM-CLAIM-ATTACHED-COUNT = +0
  6236        GO TO 0510-SKIP-CLAIM-CHECK
  6237     END-IF
  6238*    DISPLAY ' STARTING CLAIM TEST '
  6239     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6240     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6241
  6242* EXEC CICS STARTBR
  6243*       DATASET     ('ELMSTR5')
  6244*       RIDFLD      (ELMSTR-KEY)
  6245*       RESP        (WS-RESPONSE)
  6246*    END-EXEC
  6247     MOVE 'ELMSTR5' TO DFHEIV1
  6248     MOVE 0
  6249       TO DFHEIV11
  6250*    MOVE '&,         G          &  N#00006185' TO DFHEIV0
  6251     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6252     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6253     MOVE X'204E233030303036313835' TO DFHEIV0(25:11)
  6254     CALL 'kxdfhei1' USING DFHEIV0,
  6255           DFHEIV1,
  6256           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 114
* EL1278.cbl
  6257           DFHEIV99,
  6258           DFHEIV11,
  6259           DFHEIV99
  6260     MOVE EIBRESP  TO WS-RESPONSE
  6261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6262     IF WS-RESP-NORMAL
  6263     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6264
  6265* EXEC CICS READNEXT
  6266*          DATASET   ('ELMSTR5')
  6267*          RIDFLD    (ELMSTR-KEY)
  6268*          SET       (ADDRESS OF CLAIM-MASTER)
  6269*          RESP      (WS-RESPONSE)
  6270*       END-EXEC
  6271     MOVE 'ELMSTR5' TO DFHEIV1
  6272     MOVE 0
  6273       TO DFHEIV11
  6274*    MOVE '&.S                   )  N#00006192' TO DFHEIV0
  6275     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6277     MOVE X'204E233030303036313932' TO DFHEIV0(25:11)
  6278     CALL 'kxdfhei1' USING DFHEIV0,
  6279           DFHEIV1,
  6280           DFHEIV20,
  6281           DFHEIV99,
  6282           ELMSTR-KEY,
  6283           DFHEIV99,
  6284           DFHEIV11,
  6285           DFHEIV99,
  6286           DFHEIV99
  6287     SET ADDRESS OF CLAIM-MASTER TO
  6288         DFHEIV20
  6289     MOVE EIBRESP  TO WS-RESPONSE
  6290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6291        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6292           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6293           AND (CM-CERT-NO = CL-CERT-NO)
  6294           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6295              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6296              SET FOUND-A-CLAIM  TO TRUE
  6297              IF CL-CLAIM-TYPE = 'L'
  6298                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6299                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6300                 END-IF
  6301                 IF CLAIM-IS-OPEN
  6302                    SET OPEN-LF-CLAIM TO TRUE
  6303                 ELSE
  6304                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6305                       MOVE CL-LAST-CLOSE-DT
  6306                                 TO WS-LF-LAST-CLOSE-DT
  6307                    END-IF
  6308                    SET CLOSED-LF-CLAIM TO TRUE
  6309                 END-IF
  6310              ELSE
  6311                 IF CLAIM-IS-OPEN
  6312                    MOVE CL-PAID-THRU-DT
  6313                                 TO WS-AH-PAID-THRU-DT
  6314                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 115
* EL1278.cbl
  6315                 ELSE
  6316                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6317                       MOVE CL-PAID-THRU-DT
  6318                                 TO WS-AH-PAID-THRU-DT
  6319                    END-IF
  6320                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6321                       MOVE CL-LAST-CLOSE-DT
  6322                                 TO WS-AH-LAST-CLOSE-DT
  6323                    END-IF
  6324                    SET CLOSED-AH-CLAIM TO TRUE
  6325                 END-IF
  6326              END-IF
  6327           END-IF
  6328        ELSE
  6329           SET I-SAY-TO-STOP TO TRUE
  6330        END-IF
  6331     END-PERFORM
  6332     END-IF
  6333     IF FOUND-A-CLAIM
  6334        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6335           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6336           MOVE ' '              TO DC-OPTION-CODE
  6337           PERFORM 9600-DATE-LINK
  6338           IF NO-CONVERSION-ERROR
  6339              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6340              MOVE AL-SANOF      TO LCLMDTHA
  6341           END-IF
  6342        END-IF
  6343        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6344           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6345           MOVE ' '              TO DC-OPTION-CODE
  6346           PERFORM 9600-DATE-LINK
  6347           IF NO-CONVERSION-ERROR
  6348              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6349              MOVE AL-SANOF      TO ACLMDTHA
  6350           END-IF
  6351        END-IF
  6352        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6353        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6354        MOVE CM-STATE            TO WS-CF-ACCESS
  6355        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6356
  6357* EXEC CICS READ
  6358*          DATASET  (ELCNTL-ID)
  6359*          SET      (ADDRESS OF CONTROL-FILE)
  6360*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6361*          RESP     (WS-RESPONSE)
  6362*       END-EXEC
  6363*    MOVE '&"S        E          (  N#00006263' TO DFHEIV0
  6364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6366     MOVE X'204E233030303036323633' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0,
  6368           ELCNTL-ID,
  6369           DFHEIV20,
  6370           DFHEIV99,
  6371           WS-CF-CONTROL-PRIMARY,
  6372           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 116
* EL1278.cbl
  6373           DFHEIV99,
  6374           DFHEIV99
  6375     SET ADDRESS OF CONTROL-FILE TO
  6376         DFHEIV20
  6377     MOVE EIBRESP  TO WS-RESPONSE
  6378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6379        IF WS-RESP-NORMAL
  6380           MOVE CF-ST-REF-AH-DEATH-IND
  6381                                 TO WS-ST-REF-IND
  6382        END-IF
  6383     END-IF
  6384     .
  6385 0510-SKIP-CLAIM-CHECK.
  6386     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6387     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6388     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6389     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6390
  6391* EXEC CICS READ
  6392*        DATASET  (ERMAIL-ID)
  6393*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6394*        SET      (ADDRESS OF MAILING-DATA)
  6395*        RESP     (WS-RESPONSE)
  6396*    END-EXEC.
  6397*    MOVE '&"S        E          (  N#00006280' TO DFHEIV0
  6398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6400     MOVE X'204E233030303036323830' TO DFHEIV0(25:11)
  6401     CALL 'kxdfhei1' USING DFHEIV0,
  6402           ERMAIL-ID,
  6403           DFHEIV20,
  6404           DFHEIV99,
  6405           WS-MA-CONTROL-PRIMARY,
  6406           DFHEIV99,
  6407           DFHEIV99,
  6408           DFHEIV99
  6409     SET ADDRESS OF MAILING-DATA TO
  6410         DFHEIV20
  6411     MOVE EIBRESP  TO WS-RESPONSE
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6413
  6414     IF WS-RESP-NORMAL
  6415        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6416           (S1 > +7)
  6417           OR (MA-MAIL-STATUS (S1) = '1')
  6418        END-PERFORM
  6419        IF S1 > +7
  6420           MOVE AL-SANOF         TO HPCYNA
  6421        END-IF
  6422     END-IF
  6423     IF CM-POST-CARD-IND = 'Y'
  6424        MOVE 'Y'                 TO HPCYNO
  6425     ELSE
  6426        MOVE 'N'                 TO HPCYNO
  6427     END-IF
  6428     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6429        OR (NOT CERT-AS-LOADED)
  6430        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 117
* EL1278.cbl
  6431     END-IF
  6432*    IF (CERT-ADDED-BATCH)
  6433*       CONTINUE
  6434*    ELSE
  6435*       MOVE AL-SANOF            TO HPCYNA
  6436*    END-IF
  6437     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6438     MOVE '5'                    TO  DC-OPTION-CODE.
  6439
  6440     PERFORM 9600-DATE-LINK.
  6441
  6442     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6443     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6444     MOVE '1'                    TO  DC-OPTION-CODE.
  6445
  6446     PERFORM 9600-DATE-LINK.
  6447
  6448     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6449
  6450     MOVE ZEROS TO WS-TOT-ITDR.
  6451     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6452
  6453 0510-CHECK-LF-STATUS.
  6454
  6455     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6456         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6457                                    PI-LF-CANCEL-DATE
  6458         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6459                                    PI-LF-CANCEL-DATE-ED
  6460                                    PI-LF-REFUND-METH
  6461         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6462         GO TO 0510-CHECK-AH-STATUS.
  6463
  6464     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6465        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6466          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6467          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6468          IF FIRST-ENTRY
  6469              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6470              MOVE SPACES               TO DC-OPTION-CODE
  6471              PERFORM 9600-DATE-LINK
  6472              IF NOT DATE-CONVERSION-ERROR
  6473                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6474                                            PI-LF-CANCEL-DATE-ED
  6475                                            WS-LF-CANCEL-DATE-ED
  6476                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6477                                            WS-LF-CANCEL-DATE.
  6478
  6479     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6480        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6481          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6482          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6483          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6484        IF FIRST-ENTRY
  6485            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6486            MOVE SPACES               TO DC-OPTION-CODE
  6487            PERFORM 9600-DATE-LINK
  6488            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 118
* EL1278.cbl
  6489                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6490                                          PI-LF-CANCEL-DATE-ED
  6491                                          WS-LF-CANCEL-DATE-ED
  6492                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6493                                          WS-LF-CANCEL-DATE.
  6494
  6495 0510-CHECK-AH-STATUS.
  6496
  6497     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6498         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6499                                    PI-AH-CANCEL-DATE
  6500         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6501                                    PI-AH-CANCEL-DATE-ED
  6502                                    PI-AH-REFUND-METH
  6503         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6504         GO TO 0510-CONT.
  6505
  6506     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6507        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6508          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6509          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6510        IF FIRST-ENTRY
  6511            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6512            MOVE SPACES               TO DC-OPTION-CODE
  6513            PERFORM 9600-DATE-LINK
  6514            IF NOT DATE-CONVERSION-ERROR
  6515                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6516                                            PI-AH-CANCEL-DATE-ED
  6517                                            WS-AH-CANCEL-DATE-ED
  6518                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6519                                            WS-AH-CANCEL-DATE.
  6520
  6521     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6522        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6523          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6524          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6525          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6526         IF FIRST-ENTRY
  6527             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6528             MOVE SPACES               TO DC-OPTION-CODE
  6529             PERFORM 9600-DATE-LINK
  6530             IF NOT DATE-CONVERSION-ERROR
  6531                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6532                                            PI-AH-CANCEL-DATE-ED
  6533                                            WS-AH-CANCEL-DATE-ED
  6534                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6535                                            WS-AH-CANCEL-DATE.
  6536
  6537     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6538         MOVE 'CANC DT'              TO  CNCDTHDO
  6539         GO TO 0510-CONT.
  6540
  6541     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6542         MOVE 'DTH DT '              TO  CNCDTHDO
  6543         IF FIRST-ENTRY
  6544             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6545             MOVE ' '                TO  DC-OPTION-CODE
  6546             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 119
* EL1278.cbl
  6547             IF NOT DATE-CONVERSION-ERROR
  6548                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6549                                             PI-AH-CANCEL-DATE-ED
  6550                                             WS-AH-CANCEL-DATE-ED
  6551                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6552                                             WS-AH-CANCEL-DATE.
  6553
  6554 0510-CONT.
  6555
  6556     IF WS-TOT-ITDR GREATER THAN ZEROS
  6557         MOVE WS-TOT-ITDR TO TOITDRO.
  6558
  6559 0520-GET-COMPANY-RECORD.
  6560     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6561     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6562     MOVE SPACES                 TO  WS-CF-ACCESS.
  6563     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6564
  6565     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6566
  6567     IF CNTL-NOT-FOUND
  6568         MOVE -1                 TO  HLCANCL
  6569         MOVE AL-SANON           TO  HLCANCA
  6570         MOVE ER-2616            TO  EMI-ERROR
  6571         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6572         GO TO 8100-SEND-INITIAL-MAP.
  6573
  6574     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6575       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6576         MOVE CF-LIFE-OVERRIDE-L1
  6577                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6578         MOVE CF-LIFE-OVERRIDE-L2
  6579                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6580         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6581         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6582         MOVE CF-CR-REM-TERM-CALC
  6583                                 TO  WS-CF-CR-REM-TERM-CALC
  6584         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6585         IF CF-DEFAULT-APR NUMERIC
  6586             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6587             GO TO 0525-GET-LF-BENEFIT
  6588         ELSE
  6589             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6590             GO TO 0525-GET-LF-BENEFIT.
  6591
  6592     MOVE -1                     TO  HLCANCL.
  6593     MOVE AL-SANON               TO  HLCANCA.
  6594     MOVE ER-2616                TO  EMI-ERROR.
  6595
  6596     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6597
  6598     GO TO 8100-SEND-INITIAL-MAP.
  6599
  6600 0525-GET-LF-BENEFIT.
  6601
  6602     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6603        GO TO 0527-GET-AH-BENEFIT
  6604     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 120
* EL1278.cbl
  6605
  6606     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6607     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6608                                     HLCDO.
  6609     MOVE WS-CF-LIFE-OVERRIDE-L2
  6610                                 TO  HLKINDO.
  6611
  6612     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6613
  6614     IF BENEFIT-FOUND
  6615         NEXT SENTENCE
  6616     ELSE
  6617         MOVE -1                 TO  HLCDL
  6618         MOVE AL-SANON           TO  HLCDA
  6619         MOVE ER-0028            TO  EMI-ERROR
  6620         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6621         GO TO 8100-SEND-INITIAL-MAP.
  6622
  6623     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6624         MOVE AL-UNNOF           TO  HLTERMA.
  6625
  6626*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6627     MOVE WS-KIND                TO WS-LF-KIND
  6628     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6629                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6630
  6631     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6632         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6633                                 TO  WS-LF-CO-REM-TERM-CALC.
  6634
  6635     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6636         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6637                                 TO  WS-LF-CO-EARNINGS-CALC
  6638                                     WS-LF-CO-REFUND-CALC.
  6639
  6640     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6641         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6642                                 TO  WS-LF-SPECIAL-CALC-CD.
  6643
  6644     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6645         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6646                                 TO  WS-LF-CO-REFUND-CALC.
  6647
  6648 0527-GET-AH-BENEFIT.
  6649
  6650     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6651        GO TO 0530-GET-STATE-RECORD
  6652     END-IF
  6653
  6654     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6655     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6656                                     HACDO.
  6657     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6658
  6659     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6660
  6661     IF BENEFIT-FOUND
  6662         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 121
* EL1278.cbl
  6663     ELSE
  6664         MOVE -1                 TO  HACDL
  6665         MOVE AL-SANON           TO  HACDA
  6666         MOVE ER-0028            TO  EMI-ERROR
  6667         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6668         GO TO 8100-SEND-INITIAL-MAP.
  6669
  6670     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6671         MOVE AL-UNNOF           TO  HATERMA.
  6672
  6673*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6674     MOVE WS-KIND                TO  WS-AH-KIND
  6675
  6676     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6677         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6678                                 TO  WS-AH-CO-REM-TERM-CALC.
  6679
  6680     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6681         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6682                                 TO  WS-AH-CO-EARNINGS-CALC
  6683                                     WS-AH-CO-REFUND-CALC.
  6684
  6685     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6686         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6687                                 TO  WS-AH-SPECIAL-CALC-CD.
  6688
  6689     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6690         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6691                                 TO  WS-AH-CO-REFUND-CALC.
  6692     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6693        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6694                                 TO WS-AH-BEN-CATEGORY
  6695     END-IF
  6696     .
  6697 0530-GET-STATE-RECORD.
  6698     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6699     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6700     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6701     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6702
  6703     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6704
  6705     IF CNTL-NOT-FOUND
  6706         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6707                                     WS-LF-ST-REM-TERM-CALC
  6708         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6709         GO TO 0560-FIND-ACCOUNT.
  6710
  6711     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6712       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6713       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6714         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6715     ELSE
  6716         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6717                                     WS-LF-ST-REM-TERM-CALC
  6718         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6719         GO TO 0560-FIND-ACCOUNT.
  6720
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 122
* EL1278.cbl
  6721     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6722     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6723
  6724     IF CM-LF-BENEFIT-CD  = '00'
  6725         GO TO 0550-GET-AH-BEN-IN-STATE.
  6726
  6727 0540-GET-LF-BEN-IN-STATE.
  6728     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6729     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6730
  6731     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6732     IF CF-ST-RT-CALC NOT = SPACES
  6733        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6734     END-IF
  6735
  6736     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6737        IF CF-ST-RF-LR-CALC > '0'
  6738           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6739        END-IF
  6740        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6741           IF CF-ST-RF-LN-CALC > '0'
  6742              MOVE CF-ST-RF-LN-CALC
  6743                                 TO WS-LF-ST-REFUND-CALC
  6744           END-IF
  6745        END-IF
  6746     ELSE
  6747        IF CF-ST-RF-LL-CALC > '0'
  6748           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6749        END-IF
  6750     END-IF
  6751
  6752     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6753
  6754     IF NO-BENEFIT-FOUND
  6755*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6756         GO TO 0550-GET-AH-BEN-IN-STATE.
  6757
  6758     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6759         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6760                                 TO  WS-LF-ST-REM-TERM-CALC.
  6761
  6762     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6763         MOVE CF-ST-REFUND-CALC (SUB3)
  6764                                 TO  WS-LF-ST-REFUND-CALC.
  6765
  6766 0550-GET-AH-BEN-IN-STATE.
  6767     IF CM-AH-BENEFIT-CD  = '00'
  6768         GO TO 0560-FIND-ACCOUNT.
  6769
  6770     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6771     IF CF-ST-RT-CALC NOT = SPACES
  6772        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6773     END-IF
  6774
  6775     IF CF-ST-RF-AH-CALC > '0'
  6776        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6777     END-IF
  6778     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 123
* EL1278.cbl
  6779        IF CF-ST-RF-CP-CALC > '0'
  6780           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6781        END-IF
  6782     END-IF
  6783
  6784     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6785     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6786
  6787     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6788
  6789     IF NO-BENEFIT-FOUND
  6790*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6791         GO TO 0560-FIND-ACCOUNT.
  6792
  6793     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6794         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6795                                 TO  WS-AH-ST-REM-TERM-CALC.
  6796
  6797     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6798         MOVE CF-ST-REFUND-CALC (SUB3)
  6799                                 TO  WS-AH-ST-REFUND-CALC.
  6800
  6801 0560-FIND-ACCOUNT.
  6802     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6803     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6804     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6805     MOVE CM-STATE               TO  WS-AM-STATE.
  6806     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6807     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6808     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6809
  6810     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6811
  6812     IF ACCT-FOUND
  6813         NEXT SENTENCE
  6814     ELSE
  6815         GO TO 0585-NO-ACCT.
  6816
  6817 0570-READ-NEXT-RANGE.
  6818     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6819
  6820     IF ACCT-FOUND
  6821         NEXT SENTENCE
  6822     ELSE
  6823         GO TO 0580-ACCT-NOT-FOUND.
  6824
  6825     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6826       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6827       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6828       AND CM-STATE  IS EQUAL TO  AM-STATE
  6829       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6830         NEXT SENTENCE
  6831     ELSE
  6832         GO TO 0580-ACCT-NOT-FOUND.
  6833
  6834     MOVE 'X'                    TO  DATE-RANGE-SW.
  6835
  6836     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 124
* EL1278.cbl
  6837         MOVE 'X'                TO  DATE-RANGE-SW
  6838         GO TO 0580-ACCT-NOT-FOUND.
  6839
  6840     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6841         GO TO 0570-READ-NEXT-RANGE.
  6842
  6843     IF WS-BROWSE-STARTED-SW = 'Y'
  6844
  6845* EXEC CICS ENDBR
  6846*          DATASET    ('ERACCT')
  6847*       END-EXEC
  6848     MOVE 'ERACCT' TO DFHEIV1
  6849     MOVE 0
  6850       TO DFHEIV11
  6851*    MOVE '&2                    $   #00006716' TO DFHEIV0
  6852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6854     MOVE X'2020233030303036373136' TO DFHEIV0(25:11)
  6855     CALL 'kxdfhei1' USING DFHEIV0,
  6856           DFHEIV1,
  6857           DFHEIV11,
  6858           DFHEIV99
  6859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6860        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6861     END-IF
  6862     MOVE ' '                    TO  DATE-RANGE-SW.
  6863     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6864
  6865     GO TO 0590-SET-ACCOUNT.
  6866
  6867 0580-ACCT-NOT-FOUND.
  6868     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6869         MOVE ER-2601            TO  EMI-ERROR
  6870     ELSE
  6871         MOVE ER-2619            TO  EMI-ERROR.
  6872
  6873     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6874
  6875     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6876
  6877 0585-NO-ACCT.
  6878     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6879     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6880                                     WS-AM-EARN-METHOD-R
  6881                                     WS-AM-EARN-METHOD-A
  6882                                     WS-LF-AM-REM-TERM-CALC
  6883                                     WS-AH-AM-REM-TERM-CALC.
  6884
  6885     GO TO 0600-CHECK-FOR-LIFE.
  6886
  6887 0590-SET-ACCOUNT.
  6888******************************************************************
  6889******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6890******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6891******* METHODS.
  6892******************************************************************
  6893     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6894     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 125
* EL1278.cbl
  6895     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6896          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6897                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6898                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6899                  IF FORM-FOUND
  6900                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6901******************************************************************
  6902
  6903     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6904     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6905                                     WS-AM-EARN-METHOD-R
  6906                                     WS-AM-EARN-METHOD-A.
  6907
  6908*    EVALUATE AM-EARN-METHOD-R
  6909*       WHEN 'R'
  6910*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6911*       WHEN 'P'
  6912*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6913*       WHEN 'C'
  6914*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6915*       WHEN 'A'
  6916*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6917*       WHEN 'M'
  6918*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6919*       WHEN 'S'
  6920*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6921*    END-EVALUATE.
  6922
  6923*    EVALUATE AM-EARN-METHOD-L
  6924*       WHEN 'R'
  6925*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6926*       WHEN 'P'
  6927*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6928*       WHEN 'C'
  6929*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6930*       WHEN 'A'
  6931*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6932*       WHEN 'M'
  6933*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6934*       WHEN 'S'
  6935*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6936*    END-EVALUATE.
  6937
  6938*    EVALUATE AM-EARN-METHOD-A
  6939*       WHEN 'R'
  6940*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6941*       WHEN 'P'
  6942*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6943*       WHEN 'C'
  6944*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6945*       WHEN 'A'
  6946*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6947*       WHEN 'M'
  6948*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6949*       WHEN 'N'
  6950*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6951*       WHEN 'S'
  6952*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 126
* EL1278.cbl
  6953*    END-EVALUATE.
  6954
  6955     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6956                                     WS-TOT-LF-PREM
  6957                                     WS-TOT-AH-RFND
  6958                                     WS-TOT-LF-RFND.
  6959
  6960 0600-CHECK-FOR-LIFE.
  6961     IF CM-LF-BENEFIT-CD  = '00'
  6962         GO TO 0640-AH-BENEFIT.
  6963
  6964 0610-GET-LIFE-BENEFIT.
  6965
  6966     IF ACCT-FOUND
  6967         MOVE +1                 TO SUB3
  6968         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6969     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6970     MOVE WS-LF-KIND             TO  HLEDESCO.
  6971     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6972     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6973        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6974                             + CM-LF-ALT-PREMIUM-AMT
  6975     ELSE
  6976        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6977     END-IF
  6978
  6979     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6980     EVALUATE TRUE
  6981        WHEN ((OPEN-LF-CLAIM)
  6982           OR (CLOSED-LF-CLAIM))
  6983           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6984           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6985                                    WS-TOT-LF-RFND
  6986                                    PI-LF-REFUND-AMT
  6987           IF CM-AH-BENEFIT-CD NOT = '00'
  6988              MOVE ZEROS         TO HAREFNDO
  6989                                    WS-TOT-AH-RFND
  6990                                    PI-AH-REFUND-AMT
  6991              MOVE SPACES        TO PI-AH-REFUND-METH
  6992           END-IF
  6993           MOVE ER-2965          TO EMI-ERROR
  6994           PERFORM 9700-ERROR-FORMAT
  6995                                 THRU  9799-EXIT
  6996           GO TO 0640-AH-BENEFIT
  6997        WHEN OPEN-LF-CLAIM
  6998           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6999           AND WS-ST-REF-IND = '4'
  7000           MOVE ER-2966          TO EMI-ERROR
  7001           PERFORM 9700-ERROR-FORMAT
  7002                                 THRU  9799-EXIT
  7003        WHEN OPEN-LF-CLAIM
  7004           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7005           AND WS-ST-REF-IND NOT = '4'
  7006           MOVE ER-2967          TO EMI-ERROR
  7007           PERFORM 9700-ERROR-FORMAT
  7008                                 THRU  9799-EXIT
  7009           GO TO 0640-AH-BENEFIT
  7010        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 127
* EL1278.cbl
  7011           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7012           AND WS-ST-REF-IND = '4'
  7013           MOVE ER-2968          TO EMI-ERROR
  7014           PERFORM 9700-ERROR-FORMAT
  7015                                 THRU  9799-EXIT
  7016        WHEN CLOSED-LF-CLAIM
  7017           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  7018           AND WS-ST-REF-IND NOT = '4'
  7019           MOVE ER-2969          TO EMI-ERROR
  7020           PERFORM 9700-ERROR-FORMAT
  7021                                 THRU  9799-EXIT
  7022           GO TO 0640-AH-BENEFIT
  7023        WHEN OTHER
  7024           CONTINUE
  7025     END-EVALUATE
  7026     .
  7027 0620-GET-REM-TERM.
  7028     MOVE WS-CF-LIFE-OVERRIDE-L1
  7029                                 TO  CP-LIFE-OVERRIDE-CODE.
  7030     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7031     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7032     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  7033     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  7034     MOVE CM-STATE               TO  CP-STATE.
  7035     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7036     MOVE WS-CF-LF-COVERAGE-TYPE
  7037                                 TO  CP-BENEFIT-TYPE.
  7038     MOVE WS-LF-KIND             TO  HLEDESCO.
  7039     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7040     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7041     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7042     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7043     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7044     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7045     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7046     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7047     MOVE WS-CF-CR-REM-TERM-CALC
  7048                                 TO  CP-REM-TERM-METHOD.
  7049
  7050     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7051         MOVE WS-LF-CO-REM-TERM-CALC
  7052                                 TO  CP-REM-TERM-METHOD.
  7053
  7054     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7055         MOVE WS-LF-ST-REM-TERM-CALC
  7056                                 TO  CP-REM-TERM-METHOD.
  7057
  7058     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7059         MOVE WS-LF-AM-REM-TERM-CALC
  7060                                 TO  CP-REM-TERM-METHOD.
  7061
  7062     IF (PI-COMPANY-ID = 'CID')
  7063        AND (CP-STATE-STD-ABBRV = 'WI')
  7064        MOVE '7'                 TO CP-REM-TERM-METHOD
  7065        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7066     END-IF
  7067     IF (PI-COMPANY-ID = 'CID')
  7068        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 128
* EL1278.cbl
  7069        AND (CM-CERT-EFF-DT >= X'9B41')
  7070        AND (CM-CERT-EFF-DT <= X'A2FB')
  7071        MOVE '7'                 TO CP-REM-TERM-METHOD
  7072        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7073     END-IF
  7074     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  7075                                     CP-ORIGINAL-TERM
  7076                                     CP-LOAN-TERM.
  7077
  7078     IF CP-TRUNCATED-LIFE
  7079         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  7080
  7081     IF CP-TERM-IS-DAYS
  7082         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  7083             MOVE CM-LF-TERM-IN-DAYS
  7084                                 TO  CP-TERM-OR-EXT-DAYS
  7085         ELSE
  7086             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  7087     ELSE
  7088         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7089             MOVE CM-PMT-EXTENSION-DAYS
  7090                                 TO  CP-TERM-OR-EXT-DAYS
  7091         ELSE
  7092             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7093
  7094*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7095     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7096     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7097     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7098     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7099
  7100
  7101* EXEC CICS READ
  7102*        DATASET  (ELCNTL-ID)
  7103*        SET      (ADDRESS OF CONTROL-FILE)
  7104*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7105*        RESP     (WS-RESPONSE)
  7106*    END-EXEC.
  7107*    MOVE '&"S        E          (  N#00006959' TO DFHEIV0
  7108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7110     MOVE X'204E233030303036393539' TO DFHEIV0(25:11)
  7111     CALL 'kxdfhei1' USING DFHEIV0,
  7112           ELCNTL-ID,
  7113           DFHEIV20,
  7114           DFHEIV99,
  7115           WS-CF-CONTROL-PRIMARY,
  7116           DFHEIV99,
  7117           DFHEIV99,
  7118           DFHEIV99
  7119     SET ADDRESS OF CONTROL-FILE TO
  7120         DFHEIV20
  7121     MOVE EIBRESP  TO WS-RESPONSE
  7122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7123
  7124
  7125     IF WS-RESP-NOTOPEN
  7126         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 129
* EL1278.cbl
  7127         GO TO 0320-INPUT-ERROR.
  7128
  7129     IF WS-RESP-NOTFND
  7130         MOVE ZERO               TO  CP-FREE-LOOK
  7131     ELSE
  7132         MOVE CF-ST-FREE-LOOK-PERIOD
  7133                                 TO CP-FREE-LOOK.
  7134
  7135     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7136        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7137        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7138     END-IF
  7139
  7140     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7141
  7142     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7143        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7144        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7145        COMPUTE CP-REMAINING-TERM-1 =
  7146                CP-REMAINING-TERM-1 - +1
  7147        COMPUTE CP-REMAINING-TERM-2 =
  7148                CP-REMAINING-TERM-2 - +1
  7149     END-IF
  7150
  7151     IF CP-REMAINING-TERM-1 NEGATIVE
  7152        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7153     END-IF
  7154     IF CP-REMAINING-TERM-2 NEGATIVE
  7155        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7156     END-IF
  7157     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7158
  7159     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7160         GO TO 0640-AH-BENEFIT.
  7161*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7162*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7163
  7164     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7165         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7166             MOVE ER-0681        TO  EMI-ERROR
  7167             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7168
  7169     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7170         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7171             MOVE ER-0682        TO  EMI-ERROR
  7172             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7173
  7174 0630-CONTINUE-LIFE.
  7175
  7176     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7177        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7178        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7179                                    FREMTRMO
  7180     ELSE
  7181        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7182                                     FREMTRMO
  7183     END-IF
  7184     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 130
* EL1278.cbl
  7185     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7186     if pi-company-id = 'AHL'
  7187        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7188        if cp-class-code = spaces
  7189           move zeros            to cp-class-code
  7190        end-if
  7191     ELSE
  7192        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7193     END-IF
  7194     IF (PI-COMPANY-ID = 'DCC')
  7195        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7196        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7197        PERFORM 0730-GET-DDF-FACTORS
  7198                                 THRU 0730-EXIT
  7199        IF PDEF-FOUND
  7200           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7201              (P1 > +8)
  7202              OR (PD-PROD-CODE (P1) = 'L')
  7203           END-PERFORM
  7204           IF P1 < +9
  7205              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7206           END-IF
  7207        END-IF
  7208     END-IF
  7209     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7210
  7211     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7212
  7213     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7214        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7215                             + CM-LF-ALT-PREMIUM-AMT
  7216     ELSE
  7217        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7218     END-IF
  7219
  7220     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7221                                     WS-TOT-LF-PREM.
  7222
  7223     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7224        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7225        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7226     ELSE
  7227        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7228     END-IF
  7229
  7230     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7231     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7232
  7233     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7234         MOVE WS-LF-ST-REFUND-CALC
  7235                                 TO  CP-EARNING-METHOD.
  7236
  7237     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7238         MOVE WS-LF-FO-REFUND-CALC
  7239                                 TO  CP-EARNING-METHOD.
  7240
  7241     if (pi-company-id = 'CID')
  7242        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 131
* EL1278.cbl
  7243        continue
  7244     else
  7245        IF CP-RATING-METHOD = '4'
  7246           MOVE '4'              TO CP-EARNING-METHOD
  7247        END-IF
  7248     end-if
  7249*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7250*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7251*            MOVE WS-AM-EARN-METHOD-R
  7252*                                TO  CP-EARNING-METHOD
  7253*        END-IF
  7254*    ELSE
  7255*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7256*            MOVE WS-AM-EARN-METHOD-L
  7257*                                TO  CP-EARNING-METHOD.
  7258
  7259     if pi-company-id = 'AHL'
  7260        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7261        if cp-class-code = spaces
  7262           move zeros            to cp-class-code
  7263        end-if
  7264     ELSE
  7265        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7266     END-IF
  7267     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7268     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7269                                     CP-RATING-BENEFIT-AMT.
  7270     IF CP-STATE-STD-ABBRV = 'OR'
  7271         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7272                                         CM-LF-ALT-BENEFIT-AMT.
  7273****   N O T E   ****
  7274*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7275*      THE OH HARD CODING IN ELCRFNDP
  7276
  7277     IF PI-COMPANY-ID = 'CID'
  7278        IF CP-STATE-STD-ABBRV = 'OH'
  7279           MOVE WS-LF-CO-EARNINGS-CALC
  7280                                 TO CP-EARNING-METHOD
  7281        END-IF
  7282     END-IF
  7283
  7284****   N O T E   ****
  7285
  7286****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7287****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7288****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7289****     THE APPROPRIATE OPTIONS HERE
  7290*    IF PI-COMPANY-ID = 'CID'
  7291*       IF (CP-STATE-STD-ABBRV = 'MN')
  7292*          AND (CM-CERT-EFF-DT > X'A4FF')
  7293*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7294*          MOVE '5'              TO CP-EARNING-METHOD
  7295*       END-IF
  7296*    END-IF
  7297     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7298     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7299     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7300     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 132
* EL1278.cbl
  7301     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7302     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7303
  7304*    IF CP-EARN-AS-NET-PAY
  7305*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7306*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7307*               MOVE WS-CF-DEFAULT-APR
  7308*                                TO  CP-LOAN-APR
  7309*               MOVE ER-3780     TO  EMI-ERROR
  7310*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7311*           ELSE
  7312*               MOVE ER-3781     TO  EMI-ERROR
  7313*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7314
  7315*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7316*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7317*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7318*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7319*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7320*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7321*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7322*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7323*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7324*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7325*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7326*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7327*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7328*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7329*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7330*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7331*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7332*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7333     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7334
  7335     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7336
  7337     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7338
  7339     IF CP-ERROR-RATE-IS-ZERO
  7340       OR CP-ERROR-RATE-NOT-FOUND
  7341         MOVE ER-2740            TO  EMI-ERROR
  7342         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7343
  7344     IF CP-ERROR-RATE-FILE-NOTOPEN
  7345         MOVE ER-2617            TO  EMI-ERROR
  7346         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7347
  7348     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7349     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7350                                     WS-TOT-LF-RFND
  7351                                     PI-LF-REFUND-AMT.
  7352     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7353
  7354     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7355
  7356     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7357         GO TO 0640-AH-BENEFIT.
  7358
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 133
* EL1278.cbl
  7359*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7360*        ADD +1                  TO  CP-REMAINING-TERM
  7361*                                    CP-ORIGINAL-TERM.
  7362
  7363     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7364     MOVE '2'                    TO  CP-EARNING-METHOD
  7365                                     CP-RATING-METHOD.
  7366     IF PI-COMPANY-ID = 'CID'
  7367        IF (CP-STATE-STD-ABBRV = 'MN')
  7368           AND (CM-CERT-EFF-DT > X'A4FF')
  7369           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7370           MOVE '5'              TO CP-EARNING-METHOD
  7371           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7372        END-IF
  7373     END-IF
  7374     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7375                                     CP-REMAINING-BENEFIT
  7376                                     CP-RATING-BENEFIT-AMT.
  7377     IF CP-STATE-STD-ABBRV = 'OR'
  7378         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7379                                         CM-LF-ALT-BENEFIT-AMT.
  7380     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7381     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7382
  7383     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7384
  7385     IF CP-ERROR-RATE-IS-ZERO
  7386       OR CP-ERROR-RATE-NOT-FOUND
  7387         MOVE ER-2740            TO  EMI-ERROR
  7388         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7389
  7390     IF CP-ERROR-RATE-FILE-NOTOPEN
  7391         MOVE ER-2617            TO  EMI-ERROR
  7392         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7393
  7394     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7395
  7396     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7397                                     WS-TOT-LF-RFND
  7398                                     PI-LF-REFUND-AMT.
  7399
  7400     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7401
  7402 0640-AH-BENEFIT.
  7403     IF CM-AH-BENEFIT-CD = '00'
  7404         GO TO 0680-CONTINUE.
  7405
  7406 0650-GET-AH-BENEFIT.
  7407     IF ACCT-FOUND
  7408         MOVE +1                 TO SUB3
  7409         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7410     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7411     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7412     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7413     MOVE WS-AH-KIND             TO  HAEDESCO.
  7414     EVALUATE TRUE
  7415        WHEN ((OPEN-LF-CLAIM)
  7416           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 134
* EL1278.cbl
  7417           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7418           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7419                                    WS-TOT-AH-RFND
  7420                                    PI-AH-REFUND-AMT
  7421           MOVE SPACES           TO PI-AH-REFUND-METH
  7422           MOVE ER-2965          TO EMI-ERROR
  7423           PERFORM 9700-ERROR-FORMAT
  7424                                 THRU  9799-EXIT
  7425           GO TO 0680-CONTINUE
  7426        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7427           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7428           AND (EMI-ERROR = ER-2965)
  7429           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7430           MOVE ZEROS            TO HAREFNDO
  7431                                    WS-TOT-AH-RFND
  7432                                    PI-AH-REFUND-AMT
  7433           MOVE SPACES           TO PI-AH-REFUND-METH
  7434           GO TO 0680-CONTINUE
  7435        WHEN (OPEN-AH-CLAIM)
  7436           AND (WS-ST-REF-IND = '1')
  7437           MOVE ZEROS            TO HAREFNDO
  7438                                    WS-TOT-AH-RFND
  7439                                    PI-AH-REFUND-AMT
  7440           MOVE ER-3039          TO EMI-ERROR
  7441           PERFORM 9700-ERROR-FORMAT
  7442                                 THRU  9799-EXIT
  7443           GO TO 0680-CONTINUE
  7444        WHEN (OPEN-AH-CLAIM)
  7445           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7446           MOVE ER-3037          TO EMI-ERROR
  7447           PERFORM 9700-ERROR-FORMAT
  7448                                 THRU  9799-EXIT
  7449*          CONTINUE
  7450        WHEN (OPEN-AH-CLAIM)
  7451           AND (WS-ST-REF-IND = '5')
  7452           MOVE ER-3038          TO EMI-ERROR
  7453           PERFORM 9700-ERROR-FORMAT
  7454                                 THRU  9799-EXIT
  7455*          CONTINUE
  7456        WHEN (OPEN-AH-CLAIM)
  7457           AND (WS-ST-REF-IND = ' ')
  7458           MOVE ER-2768          TO EMI-ERROR
  7459           PERFORM 9700-ERROR-FORMAT
  7460                                 THRU  9799-EXIT
  7461        WHEN (CLOSED-AH-CLAIM)
  7462           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7463           MOVE ZEROS            TO HAREFNDO
  7464                                    WS-TOT-AH-RFND
  7465                                    PI-AH-REFUND-AMT
  7466           MOVE ER-2756          TO EMI-ERROR
  7467           PERFORM 9700-ERROR-FORMAT
  7468                                 THRU  9799-EXIT
  7469           IF WS-TOT-LF-RFND > 0
  7470              MOVE ZEROS         TO HLREFNDO
  7471                                    WS-TOT-LF-RFND
  7472                                    PI-LF-REFUND-AMT
  7473              MOVE SPACES        TO PI-LF-REFUND-METH
  7474           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 135
* EL1278.cbl
  7475           GO TO 0680-CONTINUE
  7476*       WHEN OTHER
  7477*          CONTINUE
  7478     END-EVALUATE
  7479     .
  7480 0660-GET-REM-TERM.
  7481     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7482     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7483     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7484     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7485     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7486*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7487     MOVE WS-AH-KIND             TO  HAEDESCO.
  7488     MOVE CM-STATE               TO  CP-STATE.
  7489     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7490     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7491     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7492     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7493     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7494     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7495     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7496     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7497     MOVE WS-CF-CR-REM-TERM-CALC
  7498                                 TO  CP-REM-TERM-METHOD.
  7499
  7500     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7501         MOVE WS-AH-CO-REM-TERM-CALC
  7502                                 TO  CP-REM-TERM-METHOD.
  7503
  7504     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7505         MOVE WS-AH-ST-REM-TERM-CALC
  7506                                 TO  CP-REM-TERM-METHOD.
  7507
  7508     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7509         MOVE WS-AH-AM-REM-TERM-CALC
  7510                                 TO  CP-REM-TERM-METHOD.
  7511     IF (PI-COMPANY-ID = 'CID')
  7512        AND (CP-STATE-STD-ABBRV = 'WI')
  7513        MOVE '7'                 TO CP-REM-TERM-METHOD
  7514        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7515     END-IF
  7516     IF (PI-COMPANY-ID = 'CID')
  7517        AND (CP-STATE-STD-ABBRV = 'MO')
  7518        AND (CM-CERT-EFF-DT >= X'9B41')
  7519        AND (CM-CERT-EFF-DT <= X'A2FB')
  7520        MOVE '7'                 TO CP-REM-TERM-METHOD
  7521        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7522     END-IF
  7523
  7524     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7525                                     CP-ORIGINAL-TERM
  7526                                     CP-LOAN-TERM.
  7527
  7528     IF  NOT  CP-TERM-IS-DAYS
  7529         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7530             MOVE CM-PMT-EXTENSION-DAYS
  7531                                 TO  CP-TERM-OR-EXT-DAYS
  7532         ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 136
* EL1278.cbl
  7533             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7534
  7535*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7536     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7537     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7538     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7539     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7540
  7541
  7542* EXEC CICS READ
  7543*        DATASET  (ELCNTL-ID)
  7544*        SET      (ADDRESS OF CONTROL-FILE)
  7545*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7546*        RESP     (WS-RESPONSE)
  7547*    END-EXEC.
  7548*    MOVE '&"S        E          (  N#00007382' TO DFHEIV0
  7549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7551     MOVE X'204E233030303037333832' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0,
  7553           ELCNTL-ID,
  7554           DFHEIV20,
  7555           DFHEIV99,
  7556           WS-CF-CONTROL-PRIMARY,
  7557           DFHEIV99,
  7558           DFHEIV99,
  7559           DFHEIV99
  7560     SET ADDRESS OF CONTROL-FILE TO
  7561         DFHEIV20
  7562     MOVE EIBRESP  TO WS-RESPONSE
  7563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7564
  7565
  7566     IF WS-RESP-NOTOPEN
  7567         MOVE ER-2617            TO  EMI-ERROR
  7568         GO TO 0320-INPUT-ERROR.
  7569
  7570     IF WS-RESP-NOTFND
  7571         MOVE ZERO               TO CP-FREE-LOOK
  7572     ELSE
  7573         MOVE CF-ST-FREE-LOOK-PERIOD
  7574                                 TO CP-FREE-LOOK.
  7575
  7576     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7577
  7578     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7579
  7580     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7581         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7582             MOVE ER-0683        TO  EMI-ERROR
  7583             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7584
  7585     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7586         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7587             MOVE ER-0684        TO  EMI-ERROR
  7588             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7589
  7590 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 137
* EL1278.cbl
  7591     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7592                                     WS-TOT-AH-PREM.
  7593     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7594
  7595     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7596         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7597
  7598     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7599        GO TO 0680-CONTINUE.
  7600     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7601     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7602     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7603
  7604     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7605         MOVE WS-AH-ST-REFUND-CALC
  7606                                 TO  CP-EARNING-METHOD.
  7607
  7608     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7609         MOVE WS-AH-FO-REFUND-CALC
  7610                                 TO  CP-EARNING-METHOD.
  7611
  7612*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7613*        MOVE WS-AM-EARN-METHOD-A
  7614*                                TO  CP-EARNING-METHOD.
  7615
  7616     if pi-company-id = 'AHL'
  7617        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7618        if cp-class-code = spaces
  7619           move zeros            to cp-class-code
  7620        end-if
  7621     ELSE
  7622        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7623     END-IF
  7624     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7625     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7626                                     CP-RATING-BENEFIT-AMT.
  7627     IF CP-STATE-STD-ABBRV = 'OR'
  7628         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7629                                         CM-AH-ORIG-TERM.
  7630     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7631     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7632     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7633     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7634     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7635     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7636
  7637     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7638     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7639     MOVE ' '                    TO  DC-OPTION-CODE.
  7640
  7641     PERFORM 9600-DATE-LINK.
  7642
  7643     IF CP-STATE-STD-ABBRV = 'OH'
  7644        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7645         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7646           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7647           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7648             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 138
* EL1278.cbl
  7649         END-IF
  7650        END-IF
  7651        IF PI-COMPANY-ID = 'CID'
  7652           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7653                           LOW-VALUES)
  7654              IF CP-CRITICAL-PERIOD
  7655                 MOVE '2'       TO CP-EARNING-METHOD
  7656              ELSE
  7657                 MOVE '6'       TO CP-EARNING-METHOD
  7658              END-IF
  7659           ELSE
  7660              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7661                 MOVE '2'       TO CP-EARNING-METHOD
  7662              ELSE
  7663                 IF ((CM-LF-ORIG-TERM > 60) AND
  7664                    (CM-RATE-CLASS NOT = 'L '))
  7665                               OR
  7666                    (WS-LF-CO-EARNINGS-CALC = '5')
  7667                    IF CP-CRITICAL-PERIOD
  7668                       MOVE '2'  TO CP-EARNING-METHOD
  7669                    ELSE
  7670                       MOVE '6'  TO CP-EARNING-METHOD
  7671                    END-IF
  7672                 ELSE
  7673                    MOVE '1'     TO CP-EARNING-METHOD
  7674                 END-IF
  7675              END-IF
  7676           END-IF
  7677        END-IF
  7678     END-IF
  7679
  7680     IF CP-STATE-STD-ABBRV = 'VA'
  7681       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7682         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7683            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7684                MOVE '6'            TO  CP-EARNING-METHOD
  7685            ELSE
  7686                MOVE '1'            TO  CP-EARNING-METHOD.
  7687
  7688     IF CP-EARN-AS-NET-PAY
  7689         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7690            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7691                MOVE WS-CF-DEFAULT-APR
  7692                                 TO  CP-LOAN-APR
  7693                MOVE ER-3780     TO  EMI-ERROR
  7694                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7695            ELSE
  7696                MOVE ER-3781     TO  EMI-ERROR
  7697                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7698     IF PI-COMPANY-ID = 'DCC'
  7699        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7700           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7701           MOVE 'S'              TO CP-EARNING-METHOD
  7702        END-IF
  7703     END-IF
  7704     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7705     IF (PI-COMPANY-ID = 'DCC')
  7706        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 139
* EL1278.cbl
  7707        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7708                                    WS-DDF-CSO-ADMIN-FEE
  7709                                    WS-DDF-1ST-YR-TOT-EXP
  7710                                    WS-DDF-COMM-AND-MFEE
  7711        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7712           S1 > +10
  7713           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7714              IF (AM-A-COM (S1) NUMERIC)
  7715                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7716                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7717              ELSE
  7718                 MOVE +0         TO WS-COMM-PCT C0
  7719                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7720                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7721              END-IF
  7722              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7723                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7724                    + WS-COMM-PCT
  7725              END-IF
  7726              IF AM-COM-TYP (S1) = 'N'
  7727                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7728                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7729              END-IF
  7730              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7731                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7732                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7733              END-IF
  7734              IF AM-COM-TYP (S1) = 'I'
  7735                 COMPUTE WS-DDF-COMM-AND-MFEE
  7736                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7737              END-IF
  7738           END-IF
  7739        END-PERFORM
  7740        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7741        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7742        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7743           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7744     END-IF
  7745     IF (PI-COMPANY-ID = 'DCC')
  7746        AND (CP-EARNING-METHOD = 'D')
  7747        AND (PI-CANCEL-REASON NOT = 'R')
  7748        PERFORM 0730-GET-DDF-FACTORS
  7749                                 THRU 0730-EXIT
  7750        IF NOT PDEF-FOUND
  7751           MOVE ER-9999          TO EMI-ERROR
  7752           PERFORM 9700-ERROR-FORMAT
  7753                                 THRU 9799-EXIT
  7754           GO TO 8200-SEND-DATAONLY
  7755        END-IF
  7756        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7757                                 TO CP-DDF-LO-FACT
  7758        MOVE PD-UEP-FACTOR (P1 P2)
  7759                                 TO CP-DDF-HI-FACT
  7760        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7761        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7762        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7763        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7764           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 140
* EL1278.cbl
  7765        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7766        IF PI-CLP-YN = 'Y'
  7767           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7768           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7769                                    CP-DDF-CLP
  7770           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7771        END-IF
  7772        IF DD-IU-PRESENT
  7773           MOVE 'I'              TO CP-EARNING-METHOD
  7774        END-IF
  7775        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7776                                    CP-CLP-RATE-UP
  7777        IF (CP-CALC-GROSS-FEE)
  7778           AND (CP-IU-RATE-UP NOT = ZEROS)
  7779           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7780              / CP-ORIGINAL-PREMIUM)
  7781           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7782              / (1 - TEX-FACT-8)
  7783        END-IF
  7784     END-IF
  7785     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7786
  7787     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7788
  7789     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7790
  7791     IF CP-ERROR-RATE-IS-ZERO
  7792       OR CP-ERROR-RATE-NOT-FOUND
  7793         MOVE ER-2740            TO  EMI-ERROR
  7794         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7795
  7796     IF CP-ERROR-RATE-FILE-NOTOPEN
  7797         MOVE ER-2617            TO  EMI-ERROR
  7798         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7799
  7800     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7801     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7802                                     WS-TOT-AH-RFND
  7803                                     PI-AH-REFUND-AMT.
  7804
  7805     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7806
  7807     MOVE AL-UANON               TO  HACANCA.
  7808
  7809 0680-CONTINUE.
  7810     IF BROWSE-STARTED
  7811         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7812         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7813
  7814     IF CM-LF-BENEFIT-CD = '00'
  7815         MOVE -1                 TO  HACANCL
  7816     ELSE
  7817         MOVE -1                 TO  HLCANCL.
  7818
  7819     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7820                           WS-TOT-PREM.
  7821     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7822                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 141
* EL1278.cbl
  7823
  7824     MOVE WS-TOT-PREM            TO  TOPREMO.
  7825     MOVE WS-TOT-RFND            TO  TORFNDO.
  7826
  7827 0680-EXIT.
  7828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 142
* EL1278.cbl
  7830 0700-LINK-REM-TERM SECTION.
  7831
  7832* EXEC CICS LINK
  7833*        PROGRAM   (ELRTRM-ID)
  7834*        COMMAREA  (CALCULATION-PASS-AREA)
  7835*        LENGTH    (CP-COMM-LENGTH)
  7836*    END-EXEC.
  7837*    MOVE '."C                   (   #00007654' TO DFHEIV0
  7838     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7840     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  7841     CALL 'kxdfhei1' USING DFHEIV0,
  7842           ELRTRM-ID,
  7843           CALCULATION-PASS-AREA,
  7844           CP-COMM-LENGTH,
  7845           DFHEIV99,
  7846           DFHEIV99,
  7847           DFHEIV99,
  7848           DFHEIV99
  7849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7850
  7851
  7852 0700-EXIT.
  7853     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 143
* EL1278.cbl
  7855 0710-LINK-REM-AMOUNT SECTION.
  7856
  7857* EXEC CICS LINK
  7858*        PROGRAM   (ELRAMT-ID)
  7859*        COMMAREA  (CALCULATION-PASS-AREA)
  7860*        LENGTH    (CP-COMM-LENGTH)
  7861*    END-EXEC.
  7862*    MOVE '."C                   (   #00007664' TO DFHEIV0
  7863     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037363634' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           ELRAMT-ID,
  7868           CALCULATION-PASS-AREA,
  7869           CP-COMM-LENGTH,
  7870           DFHEIV99,
  7871           DFHEIV99,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7875
  7876
  7877 0710-EXIT.
  7878     EXIT.
  7879 0730-GET-DDF-FACTORS.
  7880     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7881     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7882     MOVE CM-STATE               TO ERPDEF-STATE
  7883     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7884     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7885     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7886     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7887     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7888
  7889* EXEC CICS STARTBR
  7890*        DATASET  ('ERPDEF')
  7891*        RIDFLD   (ERPDEF-KEY)
  7892*        GTEQ
  7893*        RESP     (WS-RESPONSE)
  7894*    END-EXEC
  7895     MOVE 'ERPDEF' TO DFHEIV1
  7896     MOVE 0
  7897       TO DFHEIV11
  7898*    MOVE '&,         G          &  N#00007681' TO DFHEIV0
  7899     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7900     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7901     MOVE X'204E233030303037363831' TO DFHEIV0(25:11)
  7902     CALL 'kxdfhei1' USING DFHEIV0,
  7903           DFHEIV1,
  7904           ERPDEF-KEY,
  7905           DFHEIV99,
  7906           DFHEIV11,
  7907           DFHEIV99
  7908     MOVE EIBRESP  TO WS-RESPONSE
  7909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7910     IF NOT WS-RESP-NORMAL
  7911        GO TO 0730-EXIT
  7912     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 144
* EL1278.cbl
  7913     .
  7914 0730-READNEXT.
  7915
  7916* EXEC CICS READNEXT
  7917*       DATASET  ('ERPDEF')
  7918*       SET      (ADDRESS OF PRODUCT-MASTER)
  7919*       RIDFLD   (ERPDEF-KEY)
  7920*       RESP     (WS-RESPONSE)
  7921*    END-EXEC
  7922     MOVE 'ERPDEF' TO DFHEIV1
  7923     MOVE 0
  7924       TO DFHEIV11
  7925*    MOVE '&.S                   )  N#00007692' TO DFHEIV0
  7926     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7927     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7928     MOVE X'204E233030303037363932' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           DFHEIV1,
  7931           DFHEIV20,
  7932           DFHEIV99,
  7933           ERPDEF-KEY,
  7934           DFHEIV99,
  7935           DFHEIV11,
  7936           DFHEIV99,
  7937           DFHEIV99
  7938     SET ADDRESS OF PRODUCT-MASTER TO
  7939         DFHEIV20
  7940     MOVE EIBRESP  TO WS-RESPONSE
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7942     IF NOT WS-RESP-NORMAL
  7943        GO TO 0730-ENDBR
  7944     END-IF
  7945     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7946        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7947           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7948        ELSE
  7949           GO TO 0730-READNEXT
  7950        END-IF
  7951     ELSE
  7952        GO TO 0730-ENDBR
  7953     END-IF
  7954     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7955        (P1 > +8)
  7956        OR (PD-PROD-CODE (P1) = 'I')
  7957     END-PERFORM
  7958     IF P1 < +9
  7959        SET DD-IU-PRESENT        TO TRUE
  7960     END-IF
  7961     IF CM-LOAN-TERM = ZEROS
  7962        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7963     END-IF
  7964     IF PD-TRUNCATED = 'Y'
  7965        MOVE CM-LOAN-TERM        TO WS-TERM
  7966     ELSE
  7967        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7968     END-IF
  7969     EVALUATE TRUE
  7970        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 145
* EL1278.cbl
  7971           MOVE 15               TO P1
  7972        WHEN WS-TERM > +156
  7973           MOVE 14               TO P1
  7974        WHEN WS-TERM > +144
  7975           MOVE 13               TO P1
  7976        WHEN WS-TERM > +132
  7977           MOVE 12               TO P1
  7978        WHEN WS-TERM > +120
  7979           MOVE 11               TO P1
  7980        WHEN WS-TERM > +108
  7981           MOVE 10               TO P1
  7982        WHEN WS-TERM > +96
  7983           MOVE 9                TO P1
  7984        WHEN WS-TERM > +84
  7985           MOVE 8                TO P1
  7986        WHEN WS-TERM > +72
  7987           MOVE 7                TO P1
  7988        WHEN WS-TERM > +60
  7989           MOVE 6                TO P1
  7990        WHEN WS-TERM > +48
  7991           MOVE 5                TO P1
  7992        WHEN WS-TERM > +36
  7993           MOVE 4                TO P1
  7994        WHEN WS-TERM > +24
  7995           MOVE 3                TO P1
  7996        WHEN WS-TERM > +12
  7997           MOVE 2                TO P1
  7998        WHEN OTHER
  7999           MOVE 1                TO P1
  8000     END-EVALUATE
  8001     EVALUATE TRUE
  8002*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  8003*          AND (DD-IU-PRESENT)
  8004*          MOVE 2                TO P2
  8005*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  8006*          MOVE 1                TO P2
  8007        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  8008           MOVE 2                TO P2
  8009        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  8010           MOVE 3                TO P2
  8011        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  8012           MOVE 4                TO P2
  8013        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  8014           MOVE 5                TO P2
  8015        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  8016           MOVE 6                TO P2
  8017        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  8018           MOVE 7                TO P2
  8019        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  8020           MOVE 8                TO P2
  8021        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  8022           MOVE 9                TO P2
  8023        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  8024           MOVE 10               TO P2
  8025        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  8026           MOVE 11               TO P2
  8027        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  8028           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 146
* EL1278.cbl
  8029        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  8030           MOVE 13               TO P2
  8031        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  8032           MOVE 14               TO P2
  8033        WHEN OTHER
  8034           MOVE 15               TO P2
  8035     END-EVALUATE
  8036     .
  8037 0730-ENDBR.
  8038
  8039* EXEC CICS ENDBR
  8040*       DATASET  ('ERPDEF')
  8041*    END-EXEC
  8042     MOVE 'ERPDEF' TO DFHEIV1
  8043     MOVE 0
  8044       TO DFHEIV11
  8045*    MOVE '&2                    $   #00007794' TO DFHEIV0
  8046     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8048     MOVE X'2020233030303037373934' TO DFHEIV0(25:11)
  8049     CALL 'kxdfhei1' USING DFHEIV0,
  8050           DFHEIV1,
  8051           DFHEIV11,
  8052           DFHEIV99
  8053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8054     .
  8055 0730-EXIT.
  8056     EXIT.
  8057 0740-GET-ERCTBL.
  8058     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8059     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8060     MOVE 'A'                    TO CTBL-BEN-TYPE
  8061     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  8062     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8063     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8064     IF WS-RESP-NORMAL
  8065        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8066     ELSE
  8067        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  8068        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  8069        MOVE 'A'                    TO CTBL-BEN-TYPE
  8070        MOVE 'AA'                   TO CTBL-BEN-CODE
  8071        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  8072        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  8073        IF WS-RESP-NORMAL
  8074           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  8075        END-IF
  8076     END-IF
  8077     .
  8078 0740-EXIT.
  8079     EXIT.
  8080 0750-READ-ERCTBL.
  8081
  8082* EXEC CICS READ
  8083*         INTO    (COMM-TABLE-RECORD)
  8084*         DATASET ('ERCTBL')
  8085*         RIDFLD  (CTBL-KEY)
  8086*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 147
* EL1278.cbl
  8087*    END-EXEC
  8088     MOVE LENGTH OF
  8089      COMM-TABLE-RECORD
  8090       TO DFHEIV11
  8091     MOVE 'ERCTBL' TO DFHEIV1
  8092*    MOVE '&"IL       E          (  N#00007824' TO DFHEIV0
  8093     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8095     MOVE X'204E233030303037383234' TO DFHEIV0(25:11)
  8096     CALL 'kxdfhei1' USING DFHEIV0,
  8097           DFHEIV1,
  8098           COMM-TABLE-RECORD,
  8099           DFHEIV11,
  8100           CTBL-KEY,
  8101           DFHEIV99,
  8102           DFHEIV99,
  8103           DFHEIV99
  8104     MOVE EIBRESP  TO WS-RESPONSE
  8105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8106     .
  8107 0750-EXIT.
  8108     EXIT.
  8109 0760-FIND-COMM.
  8110     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  8111        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  8112        OR (C1 > +3)
  8113     END-PERFORM
  8114     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  8115        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  8116        OR (C2 > +3)
  8117     END-PERFORM
  8118     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  8119        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  8120        OR (C3 > +3)
  8121     END-PERFORM
  8122     IF C1 > +3
  8123        MOVE +1                  TO C1
  8124     END-IF
  8125     IF C2 > +3
  8126        MOVE +1                  TO C2
  8127     END-IF
  8128     IF C3 > +3
  8129        MOVE +1                  TO C3
  8130     END-IF
  8131     IF C1 = +3
  8132        MOVE +18                 TO C0
  8133     ELSE
  8134        IF C1 = +2
  8135           MOVE +9               TO C0
  8136        END-IF
  8137     END-IF
  8138     IF C2 = +3
  8139        ADD +6                   TO C0
  8140     ELSE
  8141        IF C2 = +2
  8142           ADD +3                TO C0
  8143        END-IF
  8144     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 148
* EL1278.cbl
  8145     ADD C3                      TO C0
  8146     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8147     .
  8148 0760-EXIT.
  8149     EXIT.
  8150 0800-LINK-REFUND SECTION.
  8151     IF CP-AH
  8152       IF PI-EARNING-METHOD-AH NOT = SPACES
  8153         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8154        ELSE
  8155         NEXT SENTENCE
  8156      ELSE
  8157       IF PI-EARNING-METHOD-LF NOT = SPACES
  8158         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8159
  8160
  8161* EXEC CICS LINK
  8162*        PROGRAM   (ELRFND-ID)
  8163*        COMMAREA  (CALCULATION-PASS-AREA)
  8164*        LENGTH    (CP-COMM-LENGTH)
  8165*    END-EXEC.
  8166*    MOVE '."C                   (   #00007884' TO DFHEIV0
  8167     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8169     MOVE X'2020233030303037383834' TO DFHEIV0(25:11)
  8170     CALL 'kxdfhei1' USING DFHEIV0,
  8171           ELRFND-ID,
  8172           CALCULATION-PASS-AREA,
  8173           CP-COMM-LENGTH,
  8174           DFHEIV99,
  8175           DFHEIV99,
  8176           DFHEIV99,
  8177           DFHEIV99
  8178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8179
  8180
  8181 0899-EXIT.
  8182     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 149
* EL1278.cbl
  8184 0900-READ-CERT-FILE  SECTION.
  8185
  8186* EXEC CICS HANDLE CONDITION
  8187*        NOTFND  (0910-NOT-FOUND)
  8188*    END-EXEC.
  8189*    MOVE '"$I                   ! # #00007894' TO DFHEIV0
  8190     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8192     MOVE X'2320233030303037383934' TO DFHEIV0(25:11)
  8193     CALL 'kxdfhei1' USING DFHEIV0
  8194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8195
  8196
  8197
  8198* EXEC CICS READ
  8199*        DATASET  (ELCERT-ID)
  8200*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8201*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8202*    END-EXEC.
  8203*    MOVE '&"S        E          (   #00007898' TO DFHEIV0
  8204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8206     MOVE X'2020233030303037383938' TO DFHEIV0(25:11)
  8207     CALL 'kxdfhei1' USING DFHEIV0,
  8208           ELCERT-ID,
  8209           DFHEIV20,
  8210           DFHEIV99,
  8211           WS-CM-CONTROL-PRIMARY,
  8212           DFHEIV99,
  8213           DFHEIV99,
  8214           DFHEIV99
  8215     SET ADDRESS OF CERTIFICATE-MASTER TO
  8216         DFHEIV20
  8217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8218
  8219
  8220*    SERVICE RELOAD CERTIFICATE-MASTER.
  8221
  8222     GO TO 0999-EXIT.
  8223
  8224 0910-NOT-FOUND.
  8225     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8226
  8227 0999-EXIT.
  8228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 150
* EL1278.cbl
  8230 1000-READ-CONTROL  SECTION.
  8231
  8232* EXEC CICS HANDLE CONDITION
  8233*        NOTFND   (1010-NOTFND)
  8234*        NOTOPEN  (1020-NOTOPEN)
  8235*    END-EXEC.
  8236*    MOVE '"$IJ                  ! $ #00007915' TO DFHEIV0
  8237     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8239     MOVE X'2420233030303037393135' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0
  8241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8242
  8243
  8244
  8245* EXEC CICS READ
  8246*        DATASET  (ELCNTL-ID)
  8247*        SET      (ADDRESS OF CONTROL-FILE)
  8248*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8249*        GTEQ
  8250*    END-EXEC.
  8251*    MOVE '&"S        G          (   #00007920' TO DFHEIV0
  8252     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8254     MOVE X'2020233030303037393230' TO DFHEIV0(25:11)
  8255     CALL 'kxdfhei1' USING DFHEIV0,
  8256           ELCNTL-ID,
  8257           DFHEIV20,
  8258           DFHEIV99,
  8259           WS-CF-CONTROL-PRIMARY,
  8260           DFHEIV99,
  8261           DFHEIV99,
  8262           DFHEIV99
  8263     SET ADDRESS OF CONTROL-FILE TO
  8264         DFHEIV20
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267
  8268*    SERVICE RELOAD CONTROL-FILE.
  8269
  8270     GO TO 1099-EXIT.
  8271
  8272 1010-NOTFND.
  8273     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8274
  8275     GO TO 1099-EXIT.
  8276
  8277 1020-NOTOPEN.
  8278     MOVE ER-2617                TO  EMI-ERROR.
  8279
  8280     GO TO 0320-INPUT-ERROR.
  8281
  8282 1099-EXIT.
  8283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 151
* EL1278.cbl
  8285 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8286     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8287
  8288     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8289         VARYING  SUB3  FROM  1  BY  1
  8290             UNTIL  ((SUB3  IS GREATER THAN  50)
  8291               OR ((CF-ST-BENEFIT-CD (SUB3)
  8292                      IS EQUAL TO  WS-BEN-CD)
  8293               AND (WS-LOOKUP-TYPE
  8294                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8295
  8296     IF SUB3  IS NOT EQUAL TO  51
  8297         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8298
  8299     GO TO 1199-EXIT.
  8300
  8301 1110-BENEFIT-DUMMY.
  8302
  8303 1119-EXIT.
  8304     EXIT.
  8305
  8306 1199-EXIT.
  8307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 152
* EL1278.cbl
  8309 1200-START-ACCOUNT-MASTER  SECTION.
  8310
  8311* EXEC CICS HANDLE CONDITION
  8312*        NOTFND   (1290-ACCT-NOT-FOUND)
  8313*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8314*    END-EXEC.
  8315*    MOVE '"$I''                  ! % #00007969' TO DFHEIV0
  8316     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8318     MOVE X'2520233030303037393639' TO DFHEIV0(25:11)
  8319     CALL 'kxdfhei1' USING DFHEIV0
  8320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8321
  8322
  8323     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8324
  8325
  8326* EXEC CICS STARTBR
  8327*        DATASET  (ERACCT-ID)
  8328*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8329*        GTEQ
  8330*    END-EXEC.
  8331     MOVE 0
  8332       TO DFHEIV11
  8333*    MOVE '&,         G          &   #00007976' TO DFHEIV0
  8334     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8335     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8336     MOVE X'2020233030303037393736' TO DFHEIV0(25:11)
  8337     CALL 'kxdfhei1' USING DFHEIV0,
  8338           ERACCT-ID,
  8339           WS-AM-CONTROL-PRIMARY,
  8340           DFHEIV99,
  8341           DFHEIV11,
  8342           DFHEIV99
  8343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8344
  8345
  8346     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8347     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8348
  8349     GO TO 1299-EXIT.
  8350
  8351 1290-ACCT-NOT-FOUND.
  8352     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8353
  8354 1299-EXIT.
  8355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 153
* EL1278.cbl
  8357 1300-READ-ACCOUNT-MASTER  SECTION.
  8358
  8359* EXEC CICS HANDLE CONDITION
  8360*        NOTFND   (0580-ACCT-NOT-FOUND)
  8361*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8362*    END-EXEC.
  8363*    MOVE '"$I''                  ! & #00007994' TO DFHEIV0
  8364     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8366     MOVE X'2620233030303037393934' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0
  8368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8369
  8370
  8371
  8372* EXEC CICS READNEXT
  8373*        DATASET  (ERACCT-ID)
  8374*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8375*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8376*    END-EXEC.
  8377     MOVE 0
  8378       TO DFHEIV11
  8379*    MOVE '&.S                   )   #00007999' TO DFHEIV0
  8380     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8381     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8382     MOVE X'2020233030303037393939' TO DFHEIV0(25:11)
  8383     CALL 'kxdfhei1' USING DFHEIV0,
  8384           ERACCT-ID,
  8385           DFHEIV20,
  8386           DFHEIV99,
  8387           WS-AM-CONTROL-PRIMARY,
  8388           DFHEIV99,
  8389           DFHEIV11,
  8390           DFHEIV99,
  8391           DFHEIV99
  8392     SET ADDRESS OF ACCOUNT-MASTER TO
  8393         DFHEIV20
  8394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8395
  8396
  8397*    SERVICE RELOAD ACCOUNT-MASTER.
  8398
  8399 1399-EXIT.
  8400     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 154
* EL1278.cbl
  8402 1400-GET-REFUND-TYPE  SECTION.
  8403     IF LIFE-REFUND-SEARCH
  8404         NEXT SENTENCE
  8405     ELSE
  8406         GO TO 1410-AH-REFUND-TYPE.
  8407
  8408     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8409         MOVE SPACES             TO  HLCALCO
  8410                                     HLCAL1O
  8411         GO TO 1499-EXIT.
  8412
  8413     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8414
  8415     EVALUATE TRUE
  8416        WHEN CP-R-AS-REPOSSESSION
  8417           MOVE 'REPOSSESSION'     TO  HLCALCO
  8418        WHEN CP-R-AS-R78
  8419           MOVE 'RULE 78'          TO  HLCALCO
  8420        WHEN  CP-R-AS-PRORATA
  8421           MOVE 'PRO RATA'         TO  HLCALCO
  8422        WHEN CP-R-AS-CALIF
  8423           MOVE 'CALIF'            TO  HLCALCO
  8424        WHEN CP-R-AS-TEXAS
  8425           MOVE 'IRREG'            TO  HLCALCO
  8426        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8427           MOVE 'UTAH'             TO  HLCALCO
  8428        WHEN CP-R-AS-FARM-PLAN
  8429           MOVE 'FARM PLAN'        TO  HLCALCO
  8430        WHEN CP-R-AS-NET-PAY
  8431           MOVE 'NET PAY'          TO  HLCALCO
  8432        WHEN CP-R-AS-ANTICIPATION
  8433           MOVE 'ANTICIPATION'     TO  HLCALCO
  8434        WHEN CP-R-AS-MEAN
  8435           MOVE 'MEAN'             TO  HLCALCO
  8436        WHEN CP-R-AS-SUM-OF-DIGITS
  8437           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8438        WHEN OTHER
  8439           MOVE 'UNDEFINED'        TO  HLCALCO
  8440     END-EVALUATE.
  8441
  8442     GO TO 1499-EXIT.
  8443
  8444 1410-AH-REFUND-TYPE.
  8445     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8446         MOVE SPACES             TO  HACALCO
  8447                                     HACAL1O
  8448         GO TO 1499-EXIT.
  8449
  8450     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8451
  8452     EVALUATE TRUE
  8453        WHEN CP-R-AS-REPOSSESSION
  8454           MOVE 'REPOSSESSION'     TO HACALCO
  8455        WHEN CP-R-AS-R78
  8456           MOVE 'RULE 78'          TO HACALCO
  8457        WHEN CP-R-AS-PRORATA
  8458           MOVE 'PRO RATA'         TO HACALCO
  8459        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 155
* EL1278.cbl
  8460           MOVE 'CALIF'            TO HACALCO
  8461        WHEN CP-R-AS-TEXAS
  8462           MOVE 'IRREG'            TO HACALCO
  8463        WHEN CP-R-AS-FARM-PLAN
  8464           MOVE 'FARM PLAN'        TO HACALCO
  8465        WHEN CP-R-AS-NET-PAY
  8466           MOVE 'NET PAY'          TO HACALCO
  8467        WHEN CP-R-AS-ANTICIPATION
  8468           MOVE 'ANTICIPATION'     TO HACALCO
  8469        WHEN CP-R-AS-MEAN
  8470           MOVE 'MEAN'             TO HACALCO
  8471        WHEN CP-R-AS-SUM-OF-DIGITS
  8472           MOVE 'SUM OF DIGIT'     TO HACALCO
  8473        WHEN CP-GAP-ACTUARIAL
  8474           MOVE 'SP ACTUARIAL'     TO HACALCO
  8475        WHEN CP-R-AS-SPP-DDF
  8476           MOVE 'SPEC DDF'         TO HACALCO
  8477        WHEN CP-R-AS-SPP-DDF-IU
  8478           MOVE 'SPEC DDF IU'      TO HACALCO
  8479        WHEN OTHER
  8480           MOVE 'UNKNOWN'          TO HLCALCO
  8481     END-EVALUATE
  8482     .
  8483 1499-EXIT.
  8484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 156
* EL1278.cbl
  8486 1500-END-BROWSE  SECTION.
  8487     IF BROWSE-STARTED
  8488
  8489* EXEC CICS ENDBR
  8490*            DATASET  (ERACCT-ID)
  8491*        END-EXEC.
  8492     MOVE 0
  8493       TO DFHEIV11
  8494*    MOVE '&2                    $   #00008096' TO DFHEIV0
  8495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8497     MOVE X'2020233030303038303936' TO DFHEIV0(25:11)
  8498     CALL 'kxdfhei1' USING DFHEIV0,
  8499           ERACCT-ID,
  8500           DFHEIV11,
  8501           DFHEIV99
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8503
  8504
  8505 1599-EXIT.
  8506     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 157
* EL1278.cbl
  8508 1600-LOCATE-BENEFIT  SECTION.
  8509
  8510* EXEC CICS HANDLE CONDITION
  8511*        NOTFND  (1699-EXIT)
  8512*    END-EXEC.
  8513*    MOVE '"$I                   ! '' #00008104' TO DFHEIV0
  8514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8516     MOVE X'2720233030303038313034' TO DFHEIV0(25:11)
  8517     CALL 'kxdfhei1' USING DFHEIV0
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8519
  8520
  8521     MOVE SPACES                 TO  WS-KIND.
  8522     MOVE ZERO                   TO  WS-NOT-FOUND.
  8523     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8524     MOVE SPACES                 TO  WS-CF-STATE.
  8525     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8526
  8527
  8528* EXEC CICS READ
  8529*        DATASET  (ELCNTL-ID)
  8530*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8531*        SET      (ADDRESS OF CONTROL-FILE)
  8532*        GTEQ
  8533*    END-EXEC.
  8534*    MOVE '&"S        G          (   #00008114' TO DFHEIV0
  8535     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8537     MOVE X'2020233030303038313134' TO DFHEIV0(25:11)
  8538     CALL 'kxdfhei1' USING DFHEIV0,
  8539           ELCNTL-ID,
  8540           DFHEIV20,
  8541           DFHEIV99,
  8542           WS-CF-CONTROL-PRIMARY,
  8543           DFHEIV99,
  8544           DFHEIV99,
  8545           DFHEIV99
  8546     SET ADDRESS OF CONTROL-FILE TO
  8547         DFHEIV20
  8548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8549
  8550
  8551*    SERVICE RELOAD CONTROL-FILE.
  8552
  8553     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8554       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8555         GO TO 1699-EXIT.
  8556
  8557     MOVE +1                     TO  WS-INDEX.
  8558
  8559 1610-LOOKUP-BENEFIT.
  8560     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8561         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8562                                 TO  WS-KIND
  8563         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8564                                 TO  WS-CALC-CD
  8565         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 158
* EL1278.cbl
  8566                                 TO  WS-BENEFIT-DESCRIP
  8567         MOVE +1                 TO  WS-NOT-FOUND
  8568         GO TO 1699-EXIT.
  8569
  8570     IF CF-BENEFIT-CODE (WS-INDEX)
  8571             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8572         GO TO 1699-EXIT.
  8573
  8574     IF WS-INDEX  IS LESS THAN  +8
  8575         ADD +1                  TO  WS-INDEX
  8576         GO TO 1610-LOOKUP-BENEFIT.
  8577
  8578 1699-EXIT.
  8579     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 159
* EL1278.cbl
  8581 1700-WRITE-CERT-NOTE      SECTION.
  8582     IF NOT MODIFY-CERT-CAP
  8583         MOVE 'UPDATE'           TO  SM-READ
  8584         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8585         MOVE ER-0070            TO  EMI-ERROR
  8586         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8587         GO TO 8200-SEND-DATAONLY.
  8588
  8589**MOVE CANCEL QUOTE NOTE INFO
  8590     IF PI-LF-REFUND-AMT NUMERIC
  8591        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8592        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8593     ELSE
  8594        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8595                                    PI-LF-REFUND-AMT
  8596        MOVE SPACE               TO WS-CN-LF-REF-METH
  8597                                    PI-LF-REFUND-METH.
  8598
  8599     IF PI-AH-REFUND-AMT NUMERIC
  8600        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8601        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8602     ELSE
  8603        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8604                                    PI-AH-REFUND-AMT
  8605        MOVE SPACE               TO WS-CN-AH-REF-METH
  8606                                    PI-AH-REFUND-METH.
  8607
  8608     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8609                                   PI-AH-REFUND-AMT.
  8610
  8611     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8612
  8613     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8614     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8615     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8616        MOVE PI-LF-CANCEL-DATE-ED
  8617                                 TO WS-CN-CANCEL-DT
  8618     ELSE
  8619        MOVE PI-AH-CANCEL-DATE-ED
  8620                                 TO WS-CN-CANCEL-DT
  8621     END-IF
  8622     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8623     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8624     MOVE PI-CARRIER             TO CZ-CARRIER
  8625     MOVE PI-GROUPING            TO CZ-GROUPING
  8626     MOVE PI-STATE               TO CZ-STATE
  8627     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8628     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8629     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8630     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8631     MOVE '1'                    TO CZ-RECORD-TYPE
  8632     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8633     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8634     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8635     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8636     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8637     MOVE ' '                    TO WS-STOP-SW
  8638     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 160
* EL1278.cbl
  8639
  8640* EXEC CICS WRITE
  8641*           FROM      (CERT-NOTE-FILE)
  8642*           DATASET   (ERNOTE-ID)
  8643*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8644*           RESP      (WS-RESPONSE)
  8645*       END-EXEC
  8646     MOVE LENGTH OF
  8647      CERT-NOTE-FILE
  8648       TO DFHEIV11
  8649*    MOVE '&$ L                  ''  N#00008209' TO DFHEIV0
  8650     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8651     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8652     MOVE X'204E233030303038323039' TO DFHEIV0(25:11)
  8653     CALL 'kxdfhei1' USING DFHEIV0,
  8654           ERNOTE-ID,
  8655           CERT-NOTE-FILE,
  8656           DFHEIV11,
  8657           CZ-CONTROL-PRIMARY,
  8658           DFHEIV99,
  8659           DFHEIV99
  8660     MOVE EIBRESP  TO WS-RESPONSE
  8661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8662        IF WS-RESP-DUPREC
  8663           ADD +1                TO CZ-NOTE-SEQUENCE
  8664        ELSE
  8665           SET I-SAY-TO-STOP     TO TRUE
  8666        END-IF
  8667     END-PERFORM
  8668     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8669     IF WS-RESP-NORMAL
  8670        EVALUATE CM-NOTE-SW
  8671           WHEN '1'
  8672           WHEN '3'
  8673           WHEN '5'
  8674           WHEN '7'
  8675              SET NO-CERT-RW     TO TRUE
  8676           WHEN ' '
  8677              MOVE '1'           TO CM-NOTE-SW
  8678           WHEN '2'
  8679              MOVE '3'           TO CM-NOTE-SW
  8680           WHEN '4'
  8681              MOVE '5'           TO CM-NOTE-SW
  8682           WHEN '6'
  8683              MOVE '7'           TO CM-NOTE-SW
  8684        END-EVALUATE
  8685     END-IF
  8686     IF NOT NO-CERT-RW
  8687        PERFORM 1810-REWRITE-ELCERT
  8688                                 THRU 1810-EXIT
  8689     ELSE
  8690
  8691* EXEC CICS UNLOCK
  8692*          DATASET    (ELCERT-ID)
  8693*       END-EXEC
  8694*    MOVE '&*                    #   #00008243' TO DFHEIV0
  8695     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8696     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 161
* EL1278.cbl
  8697     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8698     CALL 'kxdfhei1' USING DFHEIV0,
  8699           ELCERT-ID,
  8700           DFHEIV99
  8701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8702     END-IF
  8703     MOVE ER-8160                TO EMI-ERROR.
  8704     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8705     GO TO 8200-SEND-DATAONLY.
  8706
  8707 1799-EXIT.
  8708     EXIT.
  8709 1800-READ-ELCERT-UPDATE.
  8710     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8711     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8712     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8713     MOVE PI-STATE               TO  WS-CM-STATE.
  8714     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8715     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8716     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8717     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8718
  8719* EXEC CICS READ
  8720*        UPDATE
  8721*        DATASET  (ELCERT-ID)
  8722*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8723*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8724*        RESP     (WS-RESPONSE)
  8725*    END-EXEC
  8726*    MOVE '&"S        EU         (  N#00008262' TO DFHEIV0
  8727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8728     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8729     MOVE X'204E233030303038323632' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           ELCERT-ID,
  8732           DFHEIV20,
  8733           DFHEIV99,
  8734           WS-CM-CONTROL-PRIMARY,
  8735           DFHEIV99,
  8736           DFHEIV99,
  8737           DFHEIV99
  8738     SET ADDRESS OF CERTIFICATE-MASTER TO
  8739         DFHEIV20
  8740     MOVE EIBRESP  TO WS-RESPONSE
  8741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8742     .
  8743 1800-EXIT.
  8744     EXIT.
  8745 1810-REWRITE-ELCERT.
  8746
  8747* EXEC CICS REWRITE
  8748*        FROM      (CERTIFICATE-MASTER)
  8749*        DATASET   (ELCERT-ID)
  8750*        RESP     (WS-RESPONSE)
  8751*    END-EXEC.
  8752     MOVE LENGTH OF
  8753      CERTIFICATE-MASTER
  8754       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 162
* EL1278.cbl
  8755*    MOVE '&& L                  %  N#00008273' TO DFHEIV0
  8756     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8758     MOVE X'204E233030303038323733' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           ELCERT-ID,
  8761           CERTIFICATE-MASTER,
  8762           DFHEIV11,
  8763           DFHEIV99
  8764     MOVE EIBRESP  TO WS-RESPONSE
  8765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8766
  8767     .
  8768 1810-EXIT.
  8769     EXIT.
  8770 4000-GEN-CANCEL-TRANS.
  8771     IF PI-LF-REFUND-AMT NOT NUMERIC
  8772         MOVE +0 TO PI-LF-REFUND-AMT
  8773     END-IF
  8774     IF PI-AH-REFUND-AMT NOT NUMERIC
  8775         MOVE +0 TO PI-AH-REFUND-AMT
  8776     END-IF
  8777
  8778     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8779
  8780     MOVE '2'                    TO CG-OPTION-CODE
  8781     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8782     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8783     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8784     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8785     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8786     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8787     MOVE PI-STATE               TO CG-CERT-STATE
  8788     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8789     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8790     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8791     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8792     MOVE ZEROS                  TO CG-LF-BENCD
  8793                                    CG-AH-BENCD
  8794                                    CG-LF-CAN-AMT
  8795                                    CG-AH-CAN-AMT
  8796     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8797                                    CG-AH-CAN-DT
  8798     MOVE SPACES                 TO CG-BATCH-NO
  8799     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8800       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8801        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8802           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8803           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8804           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8805        END-IF
  8806     END-IF
  8807     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8808       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8809        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8810           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8811           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8812           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 163
* EL1278.cbl
  8813        END-IF
  8814     END-IF
  8815
  8816* EXEC CICS LINK
  8817*        PROGRAM  ('ELCANC')
  8818*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8819*    END-EXEC
  8820     MOVE LENGTH OF
  8821      CANCEL-GEN-PASS-AREA
  8822       TO DFHEIV11
  8823     MOVE 'ELCANC' TO DFHEIV1
  8824*    MOVE '."C                   (   #00008326' TO DFHEIV0
  8825     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8827     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  8828     CALL 'kxdfhei1' USING DFHEIV0,
  8829           DFHEIV1,
  8830           CANCEL-GEN-PASS-AREA,
  8831           DFHEIV11,
  8832           DFHEIV99,
  8833           DFHEIV99,
  8834           DFHEIV99,
  8835           DFHEIV99
  8836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8837     IF CG-SUCCESS
  8838        CONTINUE
  8839     ELSE
  8840        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8841        move '3'                 to emi-switch1
  8842        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8843        EVALUATE TRUE
  8844           WHEN CG-DATE-ERROR
  8845             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8846           WHEN CG-CERT-NOT-FOUND
  8847             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8848           WHEN CG-AMOUNT-ERROR
  8849             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8850           WHEN CG-OPTION-ERROR
  8851             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8852           WHEN CG-PREV-CAN
  8853             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8854           WHEN CG-INVALID-DATA
  8855             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8856           WHEN CG-NO-ACCT-MSTR
  8857             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8858           WHEN CG-SFX-A-EXIST
  8859             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8860           WHEN CG-MISC-ERROR
  8861             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8862           WHEN OTHER
  8863             move ' error - elcanc - return '
  8864                                 to emi-error-text (1) (12:25)
  8865        END-EVALUATE
  8866        go to 8200-send-dataonly
  8867     end-if
  8868     .
  8869 4000-exit.
  8870     exit.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 164
* EL1278.cbl
  8871
  8872 4400-ADD-ORIG-REC.
  8873
  8874     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8875     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8876     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8877     MOVE PI-STATE               TO  WS-CM-STATE.
  8878     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8879     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8880     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8881     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8882
  8883
  8884* EXEC CICS READ
  8885*        DATASET  (ELCERT-ID)
  8886*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8887*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8888*        RESP     (WS-RESPONSE)
  8889*    END-EXEC
  8890*    MOVE '&"S        E          (  N#00008376' TO DFHEIV0
  8891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8893     MOVE X'204E233030303038333736' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0,
  8895           ELCERT-ID,
  8896           DFHEIV20,
  8897           DFHEIV99,
  8898           WS-CM-CONTROL-PRIMARY,
  8899           DFHEIV99,
  8900           DFHEIV99,
  8901           DFHEIV99
  8902     SET ADDRESS OF CERTIFICATE-MASTER TO
  8903         DFHEIV20
  8904     MOVE EIBRESP  TO WS-RESPONSE
  8905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8906     IF WS-RESP-NORMAL
  8907         CONTINUE
  8908     ELSE
  8909        MOVE ER-0142                TO EMI-ERROR
  8910        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8911        GO TO 8100-SEND-INITIAL-MAP
  8912     END-IF
  8913
  8914******************************************************************
  8915*            A D D   O R I G   C E R T   I N F O                 *
  8916******************************************************************
  8917
  8918     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8919
  8920     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8921     MOVE ' '                    TO WS-ERMAIL-SW
  8922
  8923
  8924* EXEC CICS READ
  8925*       DATASET   ('ERMAIL')
  8926*       SET       (ADDRESS OF MAILING-DATA)
  8927*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8928*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 165
* EL1278.cbl
  8929*    END-EXEC
  8930     MOVE 'ERMAIL' TO DFHEIV1
  8931*    MOVE '&"S        E          (  N#00008399' TO DFHEIV0
  8932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8934     MOVE X'204E233030303038333939' TO DFHEIV0(25:11)
  8935     CALL 'kxdfhei1' USING DFHEIV0,
  8936           DFHEIV1,
  8937           DFHEIV20,
  8938           DFHEIV99,
  8939           WS-MA-CONTROL-PRIMARY,
  8940           DFHEIV99,
  8941           DFHEIV99,
  8942           DFHEIV99
  8943     SET ADDRESS OF MAILING-DATA TO
  8944         DFHEIV20
  8945     MOVE EIBRESP  TO WS-RESPONSE
  8946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8947
  8948     IF WS-RESP-NORMAL
  8949        SET ERMAIL-FOUND TO TRUE
  8950     END-IF
  8951
  8952     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTT-PRIMARY
  8953     MOVE 'C'                   TO ELCRTT-REC-TYPE
  8954     MOVE +0                    TO WS-CERT-TRL-REC-NOT-FOUND
  8955
  8956
  8957* EXEC CICS READ
  8958*         DATASET  (ELCRTT-ID)
  8959*         RIDFLD   (ELCRTT-KEY)
  8960*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8961*         RESP     (WS-RESPONSE)
  8962*    END-EXEC
  8963*    MOVE '&"S        E          (  N#00008414' TO DFHEIV0
  8964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8966     MOVE X'204E233030303038343134' TO DFHEIV0(25:11)
  8967     CALL 'kxdfhei1' USING DFHEIV0,
  8968           ELCRTT-ID,
  8969           DFHEIV20,
  8970           DFHEIV99,
  8971           ELCRTT-KEY,
  8972           DFHEIV99,
  8973           DFHEIV99,
  8974           DFHEIV99
  8975     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8976         DFHEIV20
  8977     MOVE EIBRESP  TO WS-RESPONSE
  8978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8979
  8980     IF NOT WS-RESP-NORMAL
  8981        MOVE +1               TO WS-CERT-TRL-REC-NOT-FOUND
  8982     END-IF
  8983
  8984     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8985     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8986     MOVE +0                  TO ELCRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 166
* EL1278.cbl
  8987
  8988
  8989* EXEC CICS READ
  8990*       DATASET   ('ELCRTO')
  8991*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8992*       RIDFLD    (ELCRTO-KEY)
  8993*       GTEQ
  8994*       RESP      (WS-RESPONSE)
  8995*    END-EXEC
  8996     MOVE 'ELCRTO' TO DFHEIV1
  8997*    MOVE '&"S        G          (  N#00008429' TO DFHEIV0
  8998     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9000     MOVE X'204E233030303038343239' TO DFHEIV0(25:11)
  9001     CALL 'kxdfhei1' USING DFHEIV0,
  9002           DFHEIV1,
  9003           DFHEIV20,
  9004           DFHEIV99,
  9005           ELCRTO-KEY,
  9006           DFHEIV99,
  9007           DFHEIV99,
  9008           DFHEIV99
  9009     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9010         DFHEIV20
  9011     MOVE EIBRESP  TO WS-RESPONSE
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9013
  9014     IF WS-RESP-NORMAL
  9015        AND (OC-CONTROL-PRIMARY (1:33) =
  9016                 WS-CM-CONTROL-PRIMARY)
  9017        AND (OC-RECORD-TYPE = 'I')
  9018        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  9019
  9020* EXEC CICS READ
  9021*             DATASET   ('ELCRTO')
  9022*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  9023*             RIDFLD    (OC-CONTROL-PRIMARY)
  9024*             UPDATE
  9025*             RESP      (WS-RESPONSE)
  9026*          END-EXEC
  9027     MOVE 'ELCRTO' TO DFHEIV1
  9028*    MOVE '&"S        EU         (  N#00008442' TO DFHEIV0
  9029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9031     MOVE X'204E233030303038343432' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0,
  9033           DFHEIV1,
  9034           DFHEIV20,
  9035           DFHEIV99,
  9036           OC-CONTROL-PRIMARY,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99
  9040     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  9041         DFHEIV20
  9042     MOVE EIBRESP  TO WS-RESPONSE
  9043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9044           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 167
* EL1278.cbl
  9045           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9046           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9047           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9048           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9049           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9050           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9051           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9052           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9053            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9054               MOVE SPACES             TO OC-LF-BENCD
  9055               MOVE ZEROS              TO OC-LF-TERM
  9056                                          OC-LF-BEN-AMT
  9057                                          OC-LF-PRM-AMT
  9058                                          OC-LF-ALT-BEN-AMT
  9059                                          OC-LF-ALT-PRM-AMT
  9060                                          OC-LF-COMM-PCT
  9061                                          OC-LF-CANCEL-AMT
  9062               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9063               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9064           ELSE
  9065               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  9066               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  9067               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  9068               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  9069               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  9070               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  9071               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  9072               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  9073               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  9074               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  9075           END-IF
  9076           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9077           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9078            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9079               MOVE SPACES             TO OC-AH-BENCD
  9080               MOVE ZEROS              TO OC-AH-TERM
  9081                                          OC-AH-BEN-AMT
  9082                                          OC-AH-PRM-AMT
  9083                                          OC-AH-COMM-PCT
  9084                                          OC-AH-CANCEL-AMT
  9085                                          OC-AH-CP
  9086               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9087               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9088           ELSE
  9089               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9090               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9091               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9092               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9093               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9094               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9095               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9096               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9097               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9098           END-IF
  9099           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9100           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9101           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9102           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 168
* EL1278.cbl
  9103           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9104           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9105           MOVE '5'                    TO DC-OPTION-CODE
  9106           PERFORM 9600-DATE-LINK
  9107           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9108           IF ERMAIL-FOUND
  9109               MOVE MA-CRED-BENE-NAME
  9110                           TO OC-CRED-BENE-NAME
  9111           END-IF
  9112           IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9113               MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9114                                  OC-INS-AGE-DEFAULT-FLAG
  9115               MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9116                                  OC-JNT-AGE-DEFAULT-FLAG
  9117           END-IF
  9118
  9119
  9120* EXEC CICS REWRITE
  9121*             DATASET   ('ELCRTO')
  9122*             FROM      (ORIGINAL-CERTIFICATE)
  9123*             RESP      (WS-RESPONSE)
  9124*          END-EXEC
  9125     MOVE LENGTH OF
  9126      ORIGINAL-CERTIFICATE
  9127       TO DFHEIV11
  9128     MOVE 'ELCRTO' TO DFHEIV1
  9129*    MOVE '&& L                  %  N#00008524' TO DFHEIV0
  9130     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9131     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9132     MOVE X'204E233030303038353234' TO DFHEIV0(25:11)
  9133     CALL 'kxdfhei1' USING DFHEIV0,
  9134           DFHEIV1,
  9135           ORIGINAL-CERTIFICATE,
  9136           DFHEIV11,
  9137           DFHEIV99
  9138     MOVE EIBRESP  TO WS-RESPONSE
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9140           IF NOT WS-RESP-NORMAL
  9141              MOVE ER-3830          TO EMI-ERROR
  9142              PERFORM 9700-ERROR-FORMAT
  9143                                 THRU 9799-EXIT
  9144              GO TO 8200-SEND-DATAONLY
  9145           END-IF
  9146
  9147           GO TO 4400-EXIT
  9148
  9149        ELSE
  9150           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  9151        END-IF
  9152     ELSE
  9153        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  9154        MOVE 'OC'                TO OC-RECORD-ID
  9155        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  9156        MOVE 'I'                 TO OC-RECORD-TYPE
  9157        MOVE +4096               TO OC-KEY-SEQ-NO
  9158     END-IF
  9159
  9160     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 169
* EL1278.cbl
  9161     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  9162     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  9163     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  9164     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  9165     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  9166     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  9167     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  9168     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9169      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9170         MOVE SPACES             TO OC-LF-BENCD
  9171         MOVE ZEROS              TO OC-LF-TERM
  9172                                    OC-LF-BEN-AMT
  9173                                    OC-LF-PRM-AMT
  9174                                    OC-LF-ALT-BEN-AMT
  9175                                    OC-LF-ALT-PRM-AMT
  9176                                    OC-LF-COMM-PCT
  9177                                    OC-LF-CANCEL-AMT
  9178         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9179         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9180     ELSE
  9181         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9182         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9183         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9184         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9185         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9186         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9187         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9188         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9189         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9190         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9191     END-IF
  9192     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9193     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9194      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9195         MOVE SPACES             TO OC-AH-BENCD
  9196         MOVE ZEROS              TO OC-AH-TERM
  9197                                    OC-AH-BEN-AMT
  9198                                    OC-AH-PRM-AMT
  9199                                    OC-AH-COMM-PCT
  9200                                    OC-AH-CANCEL-AMT
  9201                                    OC-AH-CP
  9202         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9203         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9204     ELSE
  9205         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9206         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9207         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9208         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9209         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9210         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9211         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9212         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9213         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9214         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9215     END-IF
  9216     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9217     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9218     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 170
* EL1278.cbl
  9219     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  9220     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9221     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9222     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9223     MOVE '5'                    TO DC-OPTION-CODE
  9224     PERFORM 9600-DATE-LINK
  9225     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9226     IF ERMAIL-FOUND
  9227         MOVE MA-CRED-BENE-NAME
  9228                     TO OC-CRED-BENE-NAME
  9229     END-IF
  9230     IF WS-CERT-TRL-REC-NOT-FOUND = ZERO
  9231         MOVE CS-INS-AGE-DEFAULT-FLAG TO
  9232                            OC-INS-AGE-DEFAULT-FLAG
  9233         MOVE CS-JNT-AGE-DEFAULT-FLAG TO
  9234                            OC-JNT-AGE-DEFAULT-FLAG
  9235     END-IF
  9236
  9237     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9238     .
  9239 4400-WRITE-ELCRTO.
  9240
  9241
  9242* EXEC CICS WRITE
  9243*       DATASET   ('ELCRTO')
  9244*       FROM      (ORIGINAL-CERTIFICATE)
  9245*       RIDFLD    (OC-CONTROL-PRIMARY)
  9246*       RESP      (WS-RESPONSE)
  9247*    END-EXEC
  9248     MOVE LENGTH OF
  9249      ORIGINAL-CERTIFICATE
  9250       TO DFHEIV11
  9251     MOVE 'ELCRTO' TO DFHEIV1
  9252*    MOVE '&$ L                  ''  N#00008630' TO DFHEIV0
  9253     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9255     MOVE X'204E233030303038363330' TO DFHEIV0(25:11)
  9256     CALL 'kxdfhei1' USING DFHEIV0,
  9257           DFHEIV1,
  9258           ORIGINAL-CERTIFICATE,
  9259           DFHEIV11,
  9260           OC-CONTROL-PRIMARY,
  9261           DFHEIV99,
  9262           DFHEIV99
  9263     MOVE EIBRESP  TO WS-RESPONSE
  9264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9265
  9266    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9267        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9268        GO TO 4400-WRITE-ELCRTO
  9269    ELSE
  9270        IF NOT WS-RESP-NORMAL
  9271           MOVE ER-3830          TO EMI-ERROR
  9272           PERFORM 9700-ERROR-FORMAT
  9273                                 THRU 9799-EXIT
  9274           GO TO 8200-SEND-DATAONLY
  9275        END-IF
  9276    END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 171
* EL1278.cbl
  9277
  9278     .
  9279 4400-EXIT.
  9280    EXIT.
  9281
  9282
  9283 5000-GET-LF-AM-REM-TERM.
  9284     MOVE +1                     TO SUB3.
  9285
  9286 5100-GET-LF-AM-REM-TERM.
  9287     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9288        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9289           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9290                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9291           GO TO 5300-MOVE-LF-REM-TERM.
  9292
  9293     IF SUB3 LESS THAN +20
  9294        ADD +1                   TO SUB3
  9295        GO TO 5100-GET-LF-AM-REM-TERM.
  9296
  9297     MOVE +1                     TO SUB3.
  9298
  9299     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9300         GO TO 5200-EDIT-FOR-NINETY-LF.
  9301
  9302 5100-GET-LF-DMD-AM-REM-TERM.
  9303
  9304     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9305        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9306           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9307                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9308           GO TO 5300-MOVE-LF-REM-TERM.
  9309
  9310     IF SUB3 LESS THAN +30
  9311        ADD +1                   TO SUB3
  9312        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9313
  9314     MOVE +1                     TO SUB3.
  9315
  9316 5200-EDIT-FOR-NINETY-LF.
  9317
  9318***************************************************************
  9319*                                                             *
  9320*    NINETY BENEFIT PLAN TYPES:                               *
  9321*                                                             *
  9322*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9323*      92 = ALL GROUP REDUCING BENEFITS                       *
  9324*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9325*      94 = ALL GROUP LEVEL BENEFITS                          *
  9326*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9327*           BENEFIT CONTROLS.                                 *
  9328*      99 = ALL BENEFITS                                      *
  9329*                                                             *
  9330***************************************************************
  9331
  9332     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9333                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9334
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 172
* EL1278.cbl
  9335     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9336       AND
  9337        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9338           GO TO 5300-MOVE-LF-REM-TERM.
  9339
  9340     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9341       AND
  9342        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9343        IF CF-REDUCING (WS-INDEX)
  9344           IF CM-INDIVIDUAL
  9345               GO TO 5300-MOVE-LF-REM-TERM.
  9346
  9347     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9348       AND
  9349        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9350        IF CF-REDUCING (WS-INDEX)
  9351           IF CM-GROUP
  9352               GO TO 5300-MOVE-LF-REM-TERM.
  9353
  9354     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9355       AND
  9356        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9357        IF CF-LEVEL (WS-INDEX)
  9358           IF CM-INDIVIDUAL
  9359               GO TO 5300-MOVE-LF-REM-TERM.
  9360
  9361     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9362       AND
  9363        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9364        IF CF-LEVEL (WS-INDEX)
  9365           IF CM-GROUP
  9366               GO TO 5300-MOVE-LF-REM-TERM.
  9367
  9368     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9369       AND
  9370        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9371            GO TO 5300-MOVE-LF-REM-TERM.
  9372
  9373     IF SUB3 LESS THAN +20
  9374        ADD +1           TO SUB3
  9375          GO TO 5200-EDIT-FOR-NINETY-LF.
  9376
  9377     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9378
  9379     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9380         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9381         GO TO 5900-EXIT.
  9382
  9383     MOVE 1                       TO SUB3.
  9384
  9385 5200-EDIT-FOR-DMD-NINETY-LF.
  9386
  9387     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9388                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9389
  9390     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9391       AND
  9392        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 173
* EL1278.cbl
  9393           GO TO 5300-MOVE-LF-REM-TERM.
  9394
  9395     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9396       AND
  9397        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9398        IF CF-REDUCING (WS-INDEX)
  9399           IF CM-INDIVIDUAL
  9400               GO TO 5300-MOVE-LF-REM-TERM.
  9401
  9402     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9403       AND
  9404        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9405        IF CF-REDUCING (WS-INDEX)
  9406           IF CM-GROUP
  9407               GO TO 5300-MOVE-LF-REM-TERM.
  9408
  9409     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9410       AND
  9411        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9412        IF CF-LEVEL (WS-INDEX)
  9413           IF CM-INDIVIDUAL
  9414               GO TO 5300-MOVE-LF-REM-TERM.
  9415
  9416     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9417       AND
  9418        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9419        IF CF-LEVEL (WS-INDEX)
  9420           IF CM-GROUP
  9421               GO TO 5300-MOVE-LF-REM-TERM.
  9422
  9423     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9424       AND
  9425        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9426            GO TO 5300-MOVE-LF-REM-TERM.
  9427
  9428     IF SUB3 LESS THAN +30
  9429        ADD +1                   TO SUB3
  9430          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9431
  9432     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9433
  9434     GO TO 5900-EXIT.
  9435
  9436 5300-MOVE-LF-REM-TERM.
  9437     MOVE WS-SAVE-BENEFIT-REM-TERM
  9438                                 TO WS-LF-AM-REM-TERM-CALC.
  9439
  9440 5900-EXIT.
  9441      EXIT.
  9442
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 174
* EL1278.cbl
  9444
  9445 6000-GET-AH-AM-REM-TERM.
  9446     MOVE +1                     TO SUB3.
  9447
  9448 6100-GET-AH-AM-REM-TERM.
  9449
  9450     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9451        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9452           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9453                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9454           GO TO 6300-MOVE-AH-REM-TERM.
  9455
  9456     IF SUB3 LESS THAN +20
  9457        ADD +1                   TO SUB3
  9458        GO TO 6100-GET-AH-AM-REM-TERM.
  9459
  9460     MOVE +1                     TO SUB3.
  9461
  9462     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9463         GO TO 6200-EDIT-FOR-NINETY-AH.
  9464
  9465 6100-GET-AH-AM-DMD-REM-TERM.
  9466     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9467        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9468           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9469                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9470           GO TO 6300-MOVE-AH-REM-TERM.
  9471
  9472     IF SUB3 LESS THAN +30
  9473        ADD +1                   TO SUB3
  9474        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9475
  9476     MOVE +1                     TO SUB3.
  9477
  9478 6200-EDIT-FOR-NINETY-AH.
  9479
  9480***************************************************************
  9481*                                                             *
  9482*    NINETY BENEFIT PLAN TYPES:                               *
  9483*                                                             *
  9484*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9485*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9486*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9487*           BENEFIT CONTROLS.                                 *
  9488*      99 = ALL BENEFITS.                                     *
  9489*                                                             *
  9490***************************************************************
  9491
  9492     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9493                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9494
  9495     IF AM-BENEFIT-CODE (SUB3) = '99'
  9496       AND
  9497        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9498           GO TO 6300-MOVE-AH-REM-TERM.
  9499
  9500     IF AM-BENEFIT-CODE (SUB3) = '91'
  9501       AND
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 175
* EL1278.cbl
  9502        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9503           IF CM-INDIVIDUAL
  9504               GO TO 6300-MOVE-AH-REM-TERM.
  9505
  9506     IF AM-BENEFIT-CODE (SUB3) = '92'
  9507       AND
  9508        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9509           IF CM-GROUP
  9510               GO TO 6300-MOVE-AH-REM-TERM.
  9511
  9512     IF AM-BENEFIT-CODE (SUB3) = '98'
  9513       AND
  9514        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9515           GO TO 6300-MOVE-AH-REM-TERM.
  9516
  9517     IF SUB3 LESS THAN +20
  9518        ADD +1                    TO SUB3
  9519        GO TO 6200-EDIT-FOR-NINETY-AH.
  9520
  9521     MOVE +1                      TO SUB3.
  9522
  9523     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9524         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9525         GO TO 6900-EXIT.
  9526
  9527 6200-EDIT-FOR-DMD-NINETY-AH.
  9528
  9529     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9530                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9531
  9532     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9533       AND
  9534        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9535           GO TO 6300-MOVE-AH-REM-TERM.
  9536
  9537     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9538       AND
  9539        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9540           IF CM-INDIVIDUAL
  9541               GO TO 6300-MOVE-AH-REM-TERM.
  9542
  9543     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9544       AND
  9545        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9546           IF CM-GROUP
  9547               GO TO 6300-MOVE-AH-REM-TERM.
  9548
  9549     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9550       AND
  9551        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9552           GO TO 6300-MOVE-AH-REM-TERM.
  9553
  9554     IF SUB3 LESS THAN +30
  9555        ADD +1                   TO SUB3
  9556        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9557
  9558     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9559
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 176
* EL1278.cbl
  9560     GO TO 6900-EXIT.
  9561
  9562 6300-MOVE-AH-REM-TERM.
  9563
  9564     MOVE WS-SAVE-BENEFIT-REM-TERM
  9565                                 TO WS-AH-AM-REM-TERM-CALC.
  9566
  9567 6900-EXIT.
  9568      EXIT.
  9569
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 177
* EL1278.cbl
  9571 7000-GET-ERFORM     SECTION.
  9572
  9573* EXEC CICS HANDLE CONDITION
  9574*        NOTFND  (7000-EXIT)
  9575*    END-EXEC.
  9576*    MOVE '"$I                   ! ( #00008943' TO DFHEIV0
  9577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9579     MOVE X'2820233030303038393433' TO DFHEIV0(25:11)
  9580     CALL 'kxdfhei1' USING DFHEIV0
  9581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9582
  9583
  9584     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9585     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9586     MOVE PI-STATE               TO  WS-FO-STATE.
  9587     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9588     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9589
  9590
  9591* EXEC CICS READ
  9592*        DATASET  (ERFORM-ID)
  9593*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9594*        SET      (ADDRESS OF FORM-MASTER)
  9595*        GTEQ
  9596*    END-EXEC.
  9597*    MOVE '&"S        G          (   #00008953' TO DFHEIV0
  9598     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9600     MOVE X'2020233030303038393533' TO DFHEIV0(25:11)
  9601     CALL 'kxdfhei1' USING DFHEIV0,
  9602           ERFORM-ID,
  9603           DFHEIV20,
  9604           DFHEIV99,
  9605           WS-FO-CONTROL-PRIMARY,
  9606           DFHEIV99,
  9607           DFHEIV99,
  9608           DFHEIV99
  9609     SET ADDRESS OF FORM-MASTER TO
  9610         DFHEIV20
  9611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9612
  9613
  9614     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9615        PI-STATE          EQUAL FO-STATE      AND
  9616        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9617         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9618         GO TO 7000-EXIT.
  9619 7000-EXIT.
  9620     EXIT.
  9621 7100-BENEFIT-SEARCH SECTION.
  9622
  9623     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9624        MOVE +1                  TO  SUB4
  9625        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9626
  9627     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9628        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 178
* EL1278.cbl
  9629        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9630 7100-EXIT.
  9631     EXIT.
  9632 7150-BENEFIT-LIFE-SEARCH.
  9633     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9634       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9635         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9636          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9637            IF FO-PLAN-REFUND-METHOD (SUB4)
  9638                    IS GREATER THAN SPACES
  9639               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9640                                    WS-LF-FO-REFUND-CALC
  9641               GO TO 7150-EXIT.
  9642
  9643     IF SUB4 LESS THAN +40
  9644         ADD +1              TO SUB4
  9645         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9646
  9647 7150-EXIT.
  9648     EXIT.
  9649 7250-BENEFIT-AH-SEARCH.
  9650     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9651       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9652         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9653          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9654            IF FO-PLAN-REFUND-METHOD (SUB4)
  9655                    IS GREATER THAN SPACES
  9656               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9657                                    WS-AH-FO-REFUND-CALC
  9658               GO TO 7250-EXIT.
  9659
  9660     IF SUB4 LESS THAN +40
  9661         ADD +1              TO SUB4
  9662         GO TO 7250-BENEFIT-AH-SEARCH.
  9663
  9664 7250-EXIT.
  9665     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 179
* EL1278.cbl
  9667
  9668 8100-SEND-INITIAL-MAP  SECTION.
  9669     MOVE SAVE-DATE              TO  HDATEO.
  9670     MOVE EIBTIME                TO  TIME-IN.
  9671     MOVE TIME-OUT               TO  HTIMEO.
  9672     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9673     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9674     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9675     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9676
  9677     IF CM-LF-BENEFIT-CD = '00'
  9678         MOVE -1                 TO  HACANCL
  9679     ELSE
  9680         MOVE -1                 TO  HLCANCL.
  9681
  9682     IF PI-COMPANY-ID NOT = 'DCC'
  9683        MOVE AL-SADOF            TO CANREAHA
  9684                                    CLPYNHA
  9685                                    CANREAA
  9686                                    CLPYNA
  9687     END-IF
  9688
  9689
  9690* EXEC CICS SEND
  9691*        FROM    (EL127HO)
  9692*        MAPSET  (MAPSET-NAME)
  9693*        MAP     (MAP-NAME)
  9694*        CURSOR
  9695*        ERASE
  9696*    END-EXEC.
  9697     MOVE LENGTH OF
  9698      EL127HO
  9699       TO DFHEIV12
  9700     MOVE -1
  9701       TO DFHEIV11
  9702*    MOVE '8$     CT  E    H L F ,   #00009035' TO DFHEIV0
  9703     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9704     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9705     MOVE X'2020233030303039303335' TO DFHEIV0(25:11)
  9706     CALL 'kxdfhei1' USING DFHEIV0,
  9707           MAP-NAME,
  9708           EL127HO,
  9709           DFHEIV12,
  9710           MAPSET-NAME,
  9711           DFHEIV99,
  9712           DFHEIV99,
  9713           DFHEIV99,
  9714           DFHEIV11,
  9715           DFHEIV99,
  9716           DFHEIV99,
  9717           DFHEIV99
  9718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9719
  9720
  9721     GO TO 9000-RETURN-TRAN.
  9722
  9723 8200-SEND-DATAONLY  SECTION.
  9724     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 180
* EL1278.cbl
  9725         GO TO 8100-SEND-INITIAL-MAP.
  9726
  9727     MOVE SAVE-DATE              TO  HDATEO.
  9728     MOVE EIBTIME                TO  TIME-IN.
  9729     MOVE TIME-OUT               TO  HTIMEO.
  9730     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9731     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9732     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9733     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9734     MOVE -1                     TO  HLCANCL.
  9735
  9736
  9737* EXEC CICS SEND DATAONLY
  9738*        FROM    (EL127HO)
  9739*        MAPSET  (MAPSET-NAME)
  9740*        MAP     (MAP-NAME)
  9741*        CURSOR
  9742*    END-EXEC.
  9743     MOVE LENGTH OF
  9744      EL127HO
  9745       TO DFHEIV12
  9746     MOVE -1
  9747       TO DFHEIV11
  9748*    MOVE '8$D    CT       H L F ,   #00009058' TO DFHEIV0
  9749     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9750     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9751     MOVE X'2020233030303039303538' TO DFHEIV0(25:11)
  9752     CALL 'kxdfhei1' USING DFHEIV0,
  9753           MAP-NAME,
  9754           EL127HO,
  9755           DFHEIV12,
  9756           MAPSET-NAME,
  9757           DFHEIV99,
  9758           DFHEIV99,
  9759           DFHEIV99,
  9760           DFHEIV11,
  9761           DFHEIV99,
  9762           DFHEIV99,
  9763           DFHEIV99
  9764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9765
  9766
  9767     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 181
* EL1278.cbl
  9769 8300-SEND-TEXT  SECTION.
  9770
  9771* EXEC CICS SEND TEXT
  9772*        FROM    (LOGOFF-TEXT)
  9773*        LENGTH  (LOGOFF-LENGTH)
  9774*        ERASE
  9775*        FREEKB
  9776*    END-EXEC.
  9777*    MOVE '8&      T  E F  H   F -   #00009068' TO DFHEIV0
  9778     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9779     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9780     MOVE X'2020233030303039303638' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0,
  9782           LOGOFF-TEXT,
  9783           LOGOFF-LENGTH,
  9784           DFHEIV99,
  9785           DFHEIV99,
  9786           DFHEIV99,
  9787           DFHEIV99,
  9788           DFHEIV99,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV99,
  9792           DFHEIV99,
  9793           DFHEIV99
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9795
  9796
  9797
  9798* EXEC CICS RETURN
  9799*    END-EXEC.
  9800*    MOVE '.(                    ''   #00009075' TO DFHEIV0
  9801     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9803     MOVE X'2020233030303039303735' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0,
  9805           DFHEIV99,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV99,
  9809           DFHEIV99,
  9810           DFHEIV99
  9811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9812
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 182
* EL1278.cbl
  9814 8600-DEEDIT  SECTION.
  9815
  9816* EXEC CICS BIF DEEDIT
  9817*        FIELD   (DEEDIT-FIELD)
  9818*        LENGTH  (15)
  9819*    END-EXEC.
  9820     MOVE 15
  9821       TO DFHEIV11
  9822*    MOVE '@"L                   #   #00009079' TO DFHEIV0
  9823     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9825     MOVE X'2020233030303039303739' TO DFHEIV0(25:11)
  9826     CALL 'kxdfhei1' USING DFHEIV0,
  9827           DEEDIT-FIELD,
  9828           DFHEIV11
  9829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9830
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 183
* EL1278.cbl
  9832 8700-UNAUTHORIZED-ACCESS  SECTION.
  9833     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9834
  9835     GO TO 8300-SEND-TEXT.
  9836
  9837 8800-PF23  SECTION.
  9838     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9839     MOVE XCTL-005               TO  PGM-NAME.
  9840
  9841     GO TO 9200-XCTL.
  9842
  9843 8900-RETURN-CICS  SECTION.
  9844
  9845* EXEC CICS RETURN
  9846*    END-EXEC.
  9847*    MOVE '.(                    ''   #00009096' TO DFHEIV0
  9848     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9850     MOVE X'2020233030303039303936' TO DFHEIV0(25:11)
  9851     CALL 'kxdfhei1' USING DFHEIV0,
  9852           DFHEIV99,
  9853           DFHEIV99,
  9854           DFHEIV99,
  9855           DFHEIV99,
  9856           DFHEIV99,
  9857           DFHEIV99
  9858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9859
  9860
  9861 9000-RETURN-TRAN  SECTION.
  9862     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9863     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9864
  9865
  9866* EXEC CICS RETURN
  9867*        TRANSID   (TRANS-ID)
  9868*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9869*        LENGTH    (PI-COMM-LENGTH)
  9870*    END-EXEC.
  9871*    MOVE '.(CT                  ''   #00009103' TO DFHEIV0
  9872     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303039313033' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           TRANS-ID,
  9877           PROGRAM-INTERFACE-BLOCK,
  9878           PI-COMM-LENGTH,
  9879           DFHEIV99,
  9880           DFHEIV99,
  9881           DFHEIV99
  9882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9883
  9884
  9885 9100-RETURN-MAIN-MENU  SECTION.
  9886     MOVE XCTL-126               TO  PGM-NAME.
  9887
  9888     GO TO 9200-XCTL.
  9889
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 184
* EL1278.cbl
  9890 9200-XCTL  SECTION.
  9891
  9892* EXEC CICS XCTL
  9893*        PROGRAM   (PGM-NAME)
  9894*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9895*        LENGTH    (PI-COMM-LENGTH)
  9896*    END-EXEC.
  9897*    MOVE '.$C                   %   #00009115' TO DFHEIV0
  9898     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9899     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9900     MOVE X'2020233030303039313135' TO DFHEIV0(25:11)
  9901     CALL 'kxdfhei1' USING DFHEIV0,
  9902           PGM-NAME,
  9903           PROGRAM-INTERFACE-BLOCK,
  9904           PI-COMM-LENGTH,
  9905           DFHEIV99
  9906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9907
  9908
  9909 9300-CLEAR  SECTION.
  9910     MOVE ' '                    TO  PI-PEND-SW.
  9911     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9912
  9913     GO TO 9200-XCTL.
  9914
  9915 9400-PF12  SECTION.
  9916     MOVE XCTL-010               TO  PGM-NAME.
  9917
  9918     GO TO 9200-XCTL.
  9919
  9920 9500-PGMID-ERROR  SECTION.
  9921
  9922* EXEC CICS HANDLE CONDITION
  9923*        PGMIDERR  (8300-SEND-TEXT)
  9924*    END-EXEC.
  9925*    MOVE '"$L                   ! ) #00009133' TO DFHEIV0
  9926     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9928     MOVE X'2920233030303039313333' TO DFHEIV0(25:11)
  9929     CALL 'kxdfhei1' USING DFHEIV0
  9930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9931
  9932
  9933     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9934     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9935     MOVE XCTL-005               TO  PGM-NAME.
  9936     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9937     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9938
  9939     GO TO 9200-XCTL.
  9940
  9941 9600-DATE-LINK  SECTION.
  9942     MOVE LINK-ELDATCV           TO  PGM-NAME
  9943
  9944
  9945* EXEC CICS LINK
  9946*        PROGRAM   (PGM-NAME)
  9947*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 185
* EL1278.cbl
  9948*        LENGTH    (DC-COMM-LENGTH)
  9949*    END-EXEC.
  9950*    MOVE '."C                   (   #00009148' TO DFHEIV0
  9951     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9953     MOVE X'2020233030303039313438' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           PGM-NAME,
  9956           DATE-CONVERSION-DATA,
  9957           DC-COMM-LENGTH,
  9958           DFHEIV99,
  9959           DFHEIV99,
  9960           DFHEIV99,
  9961           DFHEIV99
  9962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9963
  9964
  9965
  9966 9700-ERROR-FORMAT  SECTION.
  9967     IF NOT EMI-ERRORS-COMPLETE
  9968         MOVE LINK-001               TO  PGM-NAME
  9969
  9970* EXEC CICS LINK
  9971*            PROGRAM   (PGM-NAME)
  9972*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9973*            LENGTH    (EMI-COMM-LENGTH)
  9974*        END-EXEC.
  9975*    MOVE '."C                   (   #00009158' TO DFHEIV0
  9976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9978     MOVE X'2020233030303039313538' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0,
  9980           PGM-NAME,
  9981           ERROR-MESSAGE-INTERFACE-BLOCK,
  9982           EMI-COMM-LENGTH,
  9983           DFHEIV99,
  9984           DFHEIV99,
  9985           DFHEIV99,
  9986           DFHEIV99
  9987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9988
  9989
  9990 9799-EXIT.
  9991     EXIT.
  9992
  9993 9800-SECURITY-VIOLATION  SECTION.
  9994*                            COPY ELCSCTP.
  9995******************************************************************
  9996*                                                                *
  9997*                            ELCSCTP                             *
  9998*                            VMOD=2.001                          *
  9999*                                                                *
 10000*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10001******************************************************************
 10002
 10003
 10004     MOVE EIBDATE          TO SM-JUL-DATE.
 10005     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 186
* EL1278.cbl
 10006     MOVE THIS-PGM         TO SM-PGM.
 10007     MOVE EIBTIME          TO TIME-IN.
 10008     MOVE TIME-OUT         TO SM-TIME.
 10009     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10010
 10011
 10012* EXEC CICS LINK
 10013*         PROGRAM  ('EL003')
 10014*         COMMAREA (SECURITY-MESSAGE)
 10015*         LENGTH   (80)
 10016*    END-EXEC.
 10017     MOVE 'EL003' TO DFHEIV1
 10018     MOVE 80
 10019       TO DFHEIV11
 10020*    MOVE '."C                   (   #00009185' TO DFHEIV0
 10021     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10023     MOVE X'2020233030303039313835' TO DFHEIV0(25:11)
 10024     CALL 'kxdfhei1' USING DFHEIV0,
 10025           DFHEIV1,
 10026           SECURITY-MESSAGE,
 10027           DFHEIV11,
 10028           DFHEIV99,
 10029           DFHEIV99,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10033
 10034
 10035******************************************************************
 10036
 10037
 10038 9899-EXIT.
 10039     EXIT.
 10040
 10041 9900-ABEND  SECTION.
 10042     MOVE LINK-004               TO  PGM-NAME.
 10043     MOVE DFHEIBLK               TO  EMI-LINE1.
 10044
 10045
 10046* EXEC CICS LINK
 10047*        PROGRAM   (PGM-NAME)
 10048*        COMMAREA  (EMI-LINE1)
 10049*        LENGTH    (72)
 10050*    END-EXEC.
 10051     MOVE 72
 10052       TO DFHEIV11
 10053*    MOVE '."C                   (   #00009201' TO DFHEIV0
 10054     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10056     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
 10057     CALL 'kxdfhei1' USING DFHEIV0,
 10058           PGM-NAME,
 10059           EMI-LINE1,
 10060           DFHEIV11,
 10061           DFHEIV99,
 10062           DFHEIV99,
 10063           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 187
* EL1278.cbl
 10064           DFHEIV99
 10065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10066
 10067
 10068     MOVE -1                     TO  HLCANCL.
 10069
 10070     GO TO 8200-SEND-DATAONLY.
 10071
 10072 9999-LAST-PARAGRAPH.
 10073
 10074* GOBACK.
 10075     MOVE '9%                    "   ' TO DFHEIV0
 10076     MOVE 'EL1278' TO DFHEIV1
 10077     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10078     GOBACK.
 10079
 10080 9999-DFHBACK SECTION.
 10081     MOVE '9%                    "   ' TO DFHEIV0
 10082     MOVE 'EL1278' TO DFHEIV1
 10083     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10084     GOBACK.
 10085 9999-DFHEXIT.
 10086     IF DFHEIGDJ EQUAL 0001
 10087         NEXT SENTENCE
 10088     ELSE IF DFHEIGDJ EQUAL 2
 10089         GO TO 9500-PGMID-ERROR,
 10090               9900-ABEND
 10091         DEPENDING ON DFHEIGDI
 10092     ELSE IF DFHEIGDJ EQUAL 3
 10093         GO TO 0910-NOT-FOUND
 10094         DEPENDING ON DFHEIGDI
 10095     ELSE IF DFHEIGDJ EQUAL 4
 10096         GO TO 1010-NOTFND,
 10097               1020-NOTOPEN
 10098         DEPENDING ON DFHEIGDI
 10099     ELSE IF DFHEIGDJ EQUAL 5
 10100         GO TO 1290-ACCT-NOT-FOUND,
 10101               1290-ACCT-NOT-FOUND
 10102         DEPENDING ON DFHEIGDI
 10103     ELSE IF DFHEIGDJ EQUAL 6
 10104         GO TO 0580-ACCT-NOT-FOUND,
 10105               0580-ACCT-NOT-FOUND
 10106         DEPENDING ON DFHEIGDI
 10107     ELSE IF DFHEIGDJ EQUAL 7
 10108         GO TO 1699-EXIT
 10109         DEPENDING ON DFHEIGDI
 10110     ELSE IF DFHEIGDJ EQUAL 8
 10111         GO TO 7000-EXIT
 10112         DEPENDING ON DFHEIGDI
 10113     ELSE IF DFHEIGDJ EQUAL 9
 10114         GO TO 8300-SEND-TEXT
 10115         DEPENDING ON DFHEIGDI.
 10116     MOVE '9%                    "   ' TO DFHEIV0
 10117     MOVE 'EL1278' TO DFHEIV1
 10118     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10119     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 16-Apr-14 11:00 Page 188
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8592     Code:       26299
