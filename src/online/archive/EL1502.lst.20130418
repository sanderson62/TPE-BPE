* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1502.cbl
* Options: int("EL1502.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1502.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1502.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1502.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1502.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/04/95 09:35:38.
     7*                            VMOD=2.024.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1502.cbl
    14*REMARKS.    TRANSACTION - E022 - CHRONOLOGICAL CLAIM HISTORY.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 062602    2002030700006  PEMA  Add note type of 'S'
    24*                                  (special review)
    25* 121802    2001061800003  SMVA  REMOVE OBSOLETE CODE
    26* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    27* 071210    2009122800001  AJRA  ADD 'LETTER TO BENE' ON LETTER
    28* 071510    2010070600001  PEMA  INT PMT VOID SHOULD NOT OPEN CLM
    29* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    30* 041612  IR2012041300001  AJRA  REMOVE VOID AND STOP PAY FROM SCR
    31******************************************************************
    32
    33 ENVIRONMENT DIVISION.
    34
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1502.cbl
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*   EL1502 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.024 *********'.
    42
    43*                                    COPY ELCSCTM.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ELCSCTM                             *
    48*                            VMOD=2.001                          *
    49*                                                                *
    50*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    51*                                                                *
    52******************************************************************
    53 01  SECURITY-MESSAGE.
    54     12  FILLER                          PIC X(30)
    55            VALUE '** LOGIC SECURITY VIOLATION -'.
    56     12  SM-READ                         PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' PGM='.
    59     12  SM-PGM                          PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' OPR='.
    62     12  SM-PROCESSOR-ID                 PIC X(4).
    63     12  FILLER                          PIC X(6)
    64            VALUE ' TERM='.
    65     12  SM-TERMID                       PIC X(4).
    66     12  FILLER                          PIC XX   VALUE SPACE.
    67     12  SM-JUL-DATE                     PIC 9(5).
    68     12  FILLER                          PIC X    VALUE SPACE.
    69     12  SM-TIME                         PIC 99.99.
    70
    71
    72*                                    COPY ELCSCRTY.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCRTY                            *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    80*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    81*        SAVED IN PI-SECURITY-ADDRESS.                           *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-CONTROL.
    85     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    86     12  FILLER                       PIC XX    VALUE 'SC'.
    87     12  SC-CREDIT-CODES.
    88         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    89             20  SC-CREDIT-DISPLAY    PIC X.
    90             20  SC-CREDIT-UPDATE     PIC X.
    91     12  SC-CLAIMS-CODES.
    92         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    93             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1502.cbl
    94             20  SC-CLAIMS-UPDATE     PIC X.
    95
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1502.cbl
    97 01  WS-DATE-AREA.
    98     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    99     12  SAVE-DATE-CCYYMMDD.
   100         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   101         16  SAVE-DATE-YMD.
   102             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   103             20  FILLER              PIC X(4)    VALUE SPACES.
   104     12  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   105
   106 01  STANDARD-AREAS.
   107     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   108     12  MAP-NAME                    PIC X(8)    VALUE 'EL150C'.
   109     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1502S'.
   110     12  TRANS-ID                    PIC X(4)    VALUE 'E022'.
   111     12  THIS-PGM                    PIC X(8)    VALUE 'EL1502'.
   112     12  PGM-NAME                    PIC X(8).
   113     12  TIME-IN                     PIC S9(7).
   114     12  TIME-OUT-R  REDEFINES TIME-IN.
   115         16  FILLER                  PIC X.
   116         16  TIME-OUT                PIC 99V99.
   117         16  FILLER                  PIC XX.
   118     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   119     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   120     12  XCTL-126                    PIC X(8)    VALUE 'EL126'.
   121     12  XCTL-142                    PIC X(8)    VALUE 'EL142'.
   122     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   123     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   124     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   125     12  FILE-ID                     PIC X(8).
   126     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   127     12  WS-ITEM-COUNT               PIC S9(4)   VALUE +1    COMP.
   128
   129 01  MISC-WORK-AREAS.
   130     12  WS-CK-Q-CONTROL             PIC S9(8) COMP.
   131     12  W-CALLING-PGM               PIC X(8).
   132     12  QID.
   133         16  QID-TERM                PIC X(4).
   134         16  FILLER                  PIC X(4)    VALUE '150B'.
   135     12  WS-TABLE-QID.
   136         16  WS-QID-TERM             PIC X(4).
   137         16  FILLER                  PIC X(4)    VALUE 'TBLE'.
   138
   139     12  MAP-LENGTH                  PIC S9(4)   VALUE +1920 COMP.
   140     12  WS-TABLE-LENGTH             PIC S9(4)   VALUE +3200 COMP.
   141     12  PASS-SWITCH                 PIC X       VALUE 'A'.
   142     12  DISPLAY-CNT                 PIC S9(4)   VALUE +1    COMP.
   143     12  FILE-SWITCH                 PIC X(4)    VALUE SPACES.
   144     12  WS-SUB                      PIC 9       VALUE 0.
   145     12  SUB                         PIC 9       VALUE 1.
   146     12  SUB-1                       PIC 9       VALUE 1.
   147     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   148     12  DIRECTION-SWITCH            PIC X       VALUE 'N'.
   149     12  WS-RECORDS-READ-SW          PIC X       VALUE 'N'.
   150         88  RECORDS-READ                        VALUE 'Y'.
   151     12  WS-ENDBR-SW                 PIC X       VALUE 'N'.
   152     12  SAVE-CONTROL                PIC X(39).
   153     12  WS-RECEIVED-DATE            PIC XX      VALUE LOW-VALUES.
   154     12  WS-CHECK-WRITTEN-DT         PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1502.cbl
   155     12  WS-PMT-APPROVAL-SW          PIC X       VALUE SPACE.
   156     12  WS-CF-PAYMENT-APPROVAL-SW   PIC X       VALUE ' '.
   157         88  WS-CF-PMT-APPROVAL-USED             VALUE 'Y' 'G'.
   158         88  WS-CF-NO-APPROVAL                   VALUE ' ' 'N'.
   159         88  WS-CF-ALL-APPROVED                  VALUE 'Y'.
   160         88  WS-CF-GRADUATED-APPROVAL            VALUE 'G'.
   161
   162     12  WS-CV-PMT-CODE              PIC X       VALUE SPACE.
   163     12  WS-PAY-TYPE                 PIC X       VALUE SPACE.
   164     12  WS-AMOUNT-PAID              PIC S9(7)V99 VALUE ZEROS.
   165     12  WS-PAYMENT-ORIGIN           PIC X       VALUE SPACE.
   166     12  WS-RECON-SW                 PIC X       VALUE ' '.
   167
   168     12  WS-DEEDIT-LENGTH            PIC S9(4)   VALUE +16   COMP.
   169     12  WS-DEEDIT-FIELD             PIC X(16)   VALUE ZEROS.
   170     12  WS-DEEDIT-FIELD-V0 REDEFINES WS-DEEDIT-FIELD
   171                                     PIC S9(16).
   172
   173     12  WS-LF-COVERAGE-TYPE         PIC X       VALUE SPACE.
   174     12  WS-BEN-SEARCH-SW            PIC X       VALUE 'N'.
   175         88  BENEFIT-FOUND                       VALUE 'Y'.
   176         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   177     12  WS-ACCESS.
   178         16  FILLER                  PIC XX      VALUE SPACES.
   179         16  WS-BEN-CD               PIC XX      VALUE SPACES.
   180     12  WS-FORMAT-CERT-NO.
   181         16  WS-FORMAT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   182         16  FILLER                  PIC X       VALUE SPACE.
   183         16  WS-FORMAT-CERT-SFX      PIC X       VALUE SPACE.
   184     12  WS-PRINTED-SW               PIC X       VALUE 'N'.
   185         88  PAYMENT-HAS-BEEN-PRINTED            VALUE 'Y'.
   186         88  PAYMENT-NOT-PRINTED                 VALUE 'N'.
   187     12  WS-RELEASED-SW              PIC X       VALUE 'N'.
   188         88  PAYMENT-NOT-RELEASED                VALUE 'N'.
   189     12  WS-UPDATE-SW                PIC X       VALUE 'N'.
   190     12  WS-VOID-CODE                PIC X       VALUE ' '.
   191
   192     12  WS-WORK-DATE.
   193         16  WS-WORK-MM              PIC 99      VALUE ZEROS.
   194         16  WS-WORK-DD              PIC 99      VALUE ZEROS.
   195         16  WS-WORK-YY              PIC 99      VALUE ZEROS.
   196
   197     12  WS-RCON-DATE.
   198         16  WS-RCON-YEAR.
   199             20  WS-RCON-YY-1        PIC 99.
   200             20  WS-RCON-YY-2        PIC 99.
   201             20  WS-RCON-MM          PIC 99.
   202             20  WS-RCON-DD          PIC 99.
   203     12  W-NAME-LAST                 PIC  X(15).
   204     12  W-NAME-FIRST                PIC  X(15).
   205     12  W-NAME-MIDDLE.
   206         16  FILLER                  PIC  X.
   207         16  W-NAME-MIDDLE-2         PIC  X.
   208         16  FILLER                  PIC  X(13).
   209
   210     12  HOLD-RECORDED-DT            PIC XX      VALUE LOW-VALUES.
   211     12  HOLD-SUB                    PIC 9(4)    VALUE ZEROS.
   212     12  SUB-2                       PIC 9(4)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1502.cbl
   213     12  SUB-3                       PIC 9(4)    VALUE ZEROS.
   214     12  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
   215
   216 01  WS-UNSORTED-TABLE.
   217     12  WS-UNSRTD-TABLE   OCCURS 200 TIMES.
   218         16  WS-RECORDED-DT          PIC XX.
   219         16  WS-CERT-NO              PIC X(11).
   220         16  WS-TRLR-SEQ             PIC S9(4)   COMP.
   221         16  WS-SORTED-SW            PIC X.
   222
   223 01  WS-SORTED-TABLE.
   224     12  WS-SRTD-TABLE OCCURS 200 TIMES.
   225         16  WS-SRTD-RECORDED-DT     PIC XX.
   226         16  WS-SRTD-CERT            PIC X(11).
   227         16  WS-SRTD-TRLR-SEQ        PIC S9(4)   COMP.
   228         16  WS-SRTD-SW              PIC X.
   229
   230     12  WS-DMO-LENGTH               PIC S9(4)   VALUE +108 COMP.
   231     12  WS-DCT-LENGTH               PIC S9(4)   VALUE +53  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1502.cbl
   233 01  ACCESS-KEYS.
   234     12  ELMSTR-KEY.
   235         16  MSTR-COMP-CD            PIC X.
   236         16  MSTR-CARRIER            PIC X.
   237         16  MSTR-CLAIM-NO           PIC X(7).
   238         16  MSTR-CERT-NO.
   239             20  MSTR-CERT-NO-PRIME  PIC X(10).
   240             20  MSTR-CERT-NO-SUFX   PIC X.
   241     12  ELCNTL-KEY.
   242         16  CNTL-COMP-ID            PIC X(3).
   243         16  CNTL-REC-TYPE           PIC X.
   244         16  CNTL-ACCESS             PIC X(4).
   245         16  CNTL-SEQ-NO             PIC S9(4)     COMP.
   246     12  ELCERT-KEY.
   247         16  CERT-COMP-CD            PIC X.
   248         16  CERT-CARRIER            PIC X.
   249         16  CERT-GROUPING           PIC X(6).
   250         16  CERT-STATE              PIC XX.
   251         16  CERT-ACCOUNT            PIC X(10).
   252         16  CERT-EFF-DT             PIC XX.
   253         16  CERT-CERT-NO.
   254             20  CERT-CERT-NO-PRIME  PIC X(10).
   255             20  CERT-CERT-NO-SUFX   PIC X.
   256     12  ELTRLR-KEY.
   257         16  TRLR-COMP-CD            PIC X.
   258         16  TRLR-CARRIER            PIC X.
   259         16  TRLR-CLAIM-NO           PIC X(7).
   260         16  TRLR-CERT-NO.
   261             20  TRLR-CERT-NO-PRIME  PIC X(10).
   262             20  TRLR-CERT-NO-SUFX   PIC X.
   263         16  TRLR-SEQ-NO             PIC S9(4)   COMP.
   264     12  ELACTQ-KEY.
   265         16  ACTQ-COMP-CD            PIC X.
   266         16  ACTQ-CARRIER            PIC X.
   267         16  ACTQ-CLAIM-NO           PIC X(7).
   268         16  ACTQ-CERT-NO.
   269             20  ACTQ-CERT-NO-PRIME  PIC X(10).
   270             20  ACTQ-CERT-NO-SUFX   PIC X.
   271     12  ELCHKQ-KEY.
   272         16  CHKQ-COMP-CD            PIC X.
   273         16  CHKQ-CONTROL            PIC S9(8)   COMP.
   274         16  CHKQ-SEQ-NO             PIC S9(4)   COMP.
   275     12  ELRCON-KEY.
   276         16  RCON-COMPANY-CD         PIC X.
   277         16  RCON-CHECK-NO           PIC X(7).
   278         16  RCON-CHECK-ORIGIN       PIC X.
   279         16  RCON-GL-ACCOUNT-NO      PIC X(10).
   280     12  EMPLCY-KEY.
   281         16  PLCY-COMPANY-CD         PIC X.
   282         16  PLCY-CARRIER            PIC X.
   283         16  PLCY-GROUPING           PIC X(6).
   284         16  PLCY-STATE              PIC XX.
   285         16  PLCY-PRODUCER           PIC X(10).
   286         16  PLCY-EFF-DT             PIC XX.
   287         16  PLCY-REFERENCE-NO       PIC X(20).
   288     12  W-NOTE-KEY.
   289         16  W-NOTE-COMP-CD          PIC X.
   290         16  W-NOTE-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1502.cbl
   291             20  W-NOTE-CARRIER      PIC X.
   292             20  W-NOTE-GROUPING     PIC X(6).
   293             20  W-NOTE-STATE        PIC XX.
   294             20  W-NOTE-ACCOUNT      PIC X(10).
   295             20  W-NOTE-EFF-DT       PIC XX.
   296             20  W-NOTE-CERT-NO      PIC X(11).
   297
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1502.cbl
   299 01  ERROR-MESSAGES.
   300     12  ER-0000                     PIC X(4)    VALUE '0000'.
   301     12  ER-0004                     PIC X(4)    VALUE '0004'.
   302     12  ER-0008                     PIC X(4)    VALUE '0008'.
   303     12  ER-0029                     PIC X(4)    VALUE '0029'.
   304     12  ER-0033                     PIC X(4)    VALUE '0033'.
   305     12  ER-0042                     PIC X(4)    VALUE '0042'.
   306     12  ER-0068                     PIC X(4)    VALUE '0068'.
   307     12  ER-0070                     PIC X(4)    VALUE '0070'.
   308     12  ER-0130                     PIC X(4)    VALUE '0130'.
   309     12  ER-0154                     PIC X(4)    VALUE '0154'.
   310     12  ER-0169                     PIC X(4)    VALUE '0169'.
   311     12  ER-0172                     PIC X(4)    VALUE '0172'.
   312     12  ER-0190                     PIC X(4)    VALUE '0190'.
   313     12  ER-0204                     PIC X(4)    VALUE '0204'.
   314     12  ER-0206                     PIC X(4)    VALUE '0206'.
   315     12  ER-0282                     PIC X(4)    VALUE '0282'.
   316     12  ER-0303                     PIC X(4)    VALUE '0303'.
   317     12  ER-0334                     PIC X(4)    VALUE '0334'.
   318     12  ER-0335                     PIC X(4)    VALUE '0335'.
   319     12  ER-0336                     PIC X(4)    VALUE '0336'.
   320     12  ER-0337                     PIC X(4)    VALUE '0337'.
   321     12  ER-0338                     PIC X(4)    VALUE '0338'.
   322     12  ER-0376                     PIC X(4)    VALUE '0376'.
   323     12  ER-0412                     PIC X(4)    VALUE '0412'.
   324     12  ER-0413                     PIC X(4)    VALUE '0413'.
   325     12  ER-0660                     PIC X(4)    VALUE '0660'.
   326     12  ER-0661                     PIC X(4)    VALUE '0661'.
   327     12  ER-0662                     PIC X(4)    VALUE '0662'.
   328     12  ER-0663                     PIC X(4)    VALUE '0663'.
   329     12  ER-0664                     PIC X(4)    VALUE '0664'.
   330     12  ER-0665                     PIC X(4)    VALUE '0665'.
   331     12  ER-0666                     PIC X(4)    VALUE '0666'.
   332     12  ER-0667                     PIC X(4)    VALUE '0667'.
   333     12  ER-0672                     PIC X(4)    VALUE '0672'.
   334     12  ER-0776                     PIC X(4)    VALUE '0776'.
   335     12  ER-0800                     PIC X(4)    VALUE '0800'.
   336     12  ER-0801                     PIC X(4)    VALUE '0801'.
   337     12  ER-0816                     PIC X(4)    VALUE '0816'.
   338     12  ER-0823                     PIC X(4)    VALUE '0823'.
   339     12  ER-0833                     PIC X(4)    VALUE '0833'.
   340     12  ER-0835                     PIC X(4)    VALUE '0835'.
   341     12  ER-0849                     PIC X(4)    VALUE '0849'.
   342     12  ER-0919                     PIC X(4)    VALUE '0919'.
   343     12  ER-0920                     PIC X(4)    VALUE '0920'.
   344     12  ER-0921                     PIC X(4)    VALUE '0921'.
   345     12  ER-0922                     PIC X(4)    VALUE '0922'.
   346     12  ER-0923                     PIC X(4)    VALUE '0923'.
   347     12  ER-0925                     PIC X(4)    VALUE '0925'.
   348     12  ER-0939                     PIC X(4)    VALUE '0939'.
   349     12  ER-0940                     PIC X(4)    VALUE '0940'.
   350     12  ER-0941                     PIC X(4)    VALUE '0941'.
   351     12  ER-0942                     PIC X(4)    VALUE '0942'.
   352     12  ER-0946                     PIC X(4)    VALUE '0946'.
   353     12  ER-0947                     PIC X(4)    VALUE '0947'.
   354     12  ER-0948                     PIC X(4)    VALUE '0948'.
   355     12  ER-0949                     PIC X(4)    VALUE '0949'.
   356     12  ER-0950                     PIC X(4)    VALUE '0950'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1502.cbl
   357     12  ER-0951                     PIC X(4)    VALUE '0951'.
   358     12  ER-0952                     PIC X(4)    VALUE '0952'.
   359     12  ER-0954                     PIC X(4)    VALUE '0954'.
   360     12  ER-0974                     PIC X(4)    VALUE '0974'.
   361     12  ER-0975                     PIC X(4)    VALUE '0975'.
   362     12  ER-2378                     PIC X(4)    VALUE '2378'.
   363     12  ER-2379                     PIC X(4)    VALUE '2379'.
   364     12  ER-7999                     PIC X(4)    VALUE '7999'.
   365     12  ER-8003                     PIC X(4)    VALUE '8003'.
   366     12  ER-8051                     PIC X(4)    VALUE '8051'.
   367     12  ER-8052                     PIC X(4)    VALUE '8052'.
   368     12  ER-8053                     PIC X(4)    VALUE '8053'.
   369     12  ER-8054                     PIC X(4)    VALUE '8054'.
   370     12  ER-8055                     PIC X(4)    VALUE '8055'.
   371     12  ER-8056                     PIC X(4)    VALUE '8056'.
   372     12  ER-8057                     PIC X(4)    VALUE '8057'.
   373     12  ER-8058                     PIC X(4)    VALUE '8058'.
   374     12  ER-8059                     PIC X(4)    VALUE '8059'.
   375     12  ER-8060                     PIC X(4)    VALUE '8060'.
   376     12  ER-8061                     PIC X(4)    VALUE '8061'.
   377     12  ER-8062                     PIC X(4)    VALUE '8062'.
   378     12  ER-8063                     PIC X(4)    VALUE '8063'.
   379     12  ER-8064                     PIC X(4)    VALUE '8064'.
   380     12  ER-8065                     PIC X(4)    VALUE '8065'.
   381     12  ER-8066                     PIC X(4)    VALUE '8066'.
   382     12  ER-8152                     PIC X(4)    VALUE '8152'.
   383     12  ER-8153                     PIC X(4)    VALUE '8153'.
   384     12  ER-8154                     PIC X(4)    VALUE '8154'.
   385     12  ER-8155                     PIC X(4)    VALUE '8155'.
   386     12  ER-9211                     PIC X(4)    VALUE '9211'.
   387     12  ER-9883                     PIC X(4)    VALUE '9883'.
   388
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1502.cbl
   390 01  TEXT-WORK-AREAS.
   391     12  PAYMENT-LINE-1.
   392         16  PMT-HDG1.
   393             20  PMT-LINE-NO         PIC X.
   394             20  FILLER              PIC X.
   395             20  PMT-HDG1-LIT        PIC X(8).
   396         16  PMT-TEXT-1.
   397             20  PMT-CERT-NO         PIC X(12).
   398             20  PMT-TYPE-LIT        PIC X(7).
   399             20  PMT-TYPE            PIC X(7).
   400             20  PMT-CHECK-NO-LIT    PIC X(11).
   401             20  PMT-CHECK-NO        PIC X(7).
   402             20  PMT-AMT-PD-LIT      PIC X(5).
   403             20  PMT-AMT-PAID        PIC Z(6).99-.
   404             20  PMT-REC-BY-LIT      PIC X(5).
   405             20  PMT-REC-BY          PIC X(4).
   406     12  PAYMENT-LINE-2.
   407         16  PMT-HDG2.
   408             20  FILLER              PIC XX.
   409             20  PMT-HDG2-LIT        PIC X(8).
   410         16  PMT-TEXT-2.
   411             20  PMT-REC-DT          PIC X(8).
   412             20  FILLER              PIC X(5).
   413             20  PMT-FROM-LIT        PIC X(6).
   414             20  PMT-PAID-FROM       PIC X(8).
   415             20  PMT-THRU-LIT        PIC X(10).
   416             20  PMT-PAID-THRU       PIC X(8).
   417             20  PMT-VOID-LIT        PIC X(9).
   418             20  PMT-VOID-DT         PIC X(8).
   419             20  FILLER              PIC XX.
   420             20  PMT-PAYEE           PIC X(4).
   421     12  AUTO-PMT-LINE-1.
   422         16  AUTO-PMT-HDG1.
   423             20  AUTO-LINE-NO        PIC X.
   424             20  FILLER              PIC X.
   425             20  AUTO-HDG1-LIT       PIC X(8).
   426         16  AUTO-PMT-TEXT1.
   427             20  AUTO-CERT-NO        PIC X(12).
   428             20  AUTO-EFF-DT-LIT     PIC X(7).
   429             20  AUTO-EFF-DT         PIC X(8).
   430             20  AUTO-1ST-PMT-LIT    PIC X(10).
   431             20  AUTO-1ST-PMT-DT     PIC X(8).
   432             20  AUTO-1ST-AMT-LIT    PIC X(6).
   433             20  AUTO-1ST-AMT        PIC Z(5).99.
   434             20  AUTO-REC-BY-LIT     PIC X(5).
   435             20  AUTO-REC-BY         PIC X(4).
   436     12  AUTO-PMT-LINE-2.
   437         16  AUTO-PMT-HDG2.
   438             20  FILLER              PIC XX.
   439             20  AUTO-HDG2-LIT       PIC X(8).
   440         16  AUTO-PMT-TEXT2.
   441             20  AUTO-REC-DT         PIC X(8).
   442             20  FILLER              PIC X(5).
   443             20  AUTO-LST-PMT-LIT    PIC X(6).
   444             20  AUTO-LST-PMT-DT     PIC X(8).
   445             20  AUTO-STATUS-LIT     PIC X(10).
   446             20  AUTO-STATUS         PIC X(6).
   447             20  AUTO-REG-AMT-LIT    PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1502.cbl
   448             20  AUTO-REG-AMT        PIC Z(5).99.
   449             20  AUTO-PAYEE-LIT      PIC X(4).
   450             20  AUTO-PAYEE          PIC X(5).
   451     12  CORRESPONDENCE-LINE-1.
   452         16  CORR-HDG1.
   453             20  CORR-LINE-NO        PIC X.
   454             20  FILLER              PIC X.
   455             20  CORR-HDG1-LIT       PIC X(8).
   456         16  CORR-TEXT-1.
   457             20  CORR-CERT-NO        PIC X(12).
   458             20  CORR-FORM-LIT       PIC X(7).
   459             20  CORR-FORM-TYPE      PIC X(6).
   460             20  CORR-DT-SENT-LIT    PIC X(11).
   461             20  CORR-DT-SENT        PIC X(8).
   462             20  CORR-LET-TO-BEN     PIC X(15).
   463             20  FILLER REDEFINES CORR-LET-TO-BEN.
   464                 25  CORR-PURGE-LIT      PIC X(6).
   465                 25  CORR-PURGE-DT       PIC X(9).
   466             20  CORR-REC-BY-LIT     PIC X(5).
   467             20  CORR-REC-BY         PIC X(4).
   468     12  CORRESPONDENCE-LINE-2.
   469         16  CORR-HDG2.
   470             20  FILLER              PIC XX.
   471             20  CORR-HDG2-LIT       PIC X(8).
   472         16  CORR-TEXT-2.
   473             20  CORR-REC-DT         PIC X(8).
   474             20  FILLER              PIC X(5).
   475             20  CORR-RESEND-LIT     PIC X(6).
   476             20  CORR-RESEND-DT      PIC X(8).
   477             20  CORR-RECVD-LIT      PIC X(10).
   478             20  CORR-RECVD-DT       PIC X(8).
   479             20  CORR-FOLLOW-UP-LIT  PIC X(6).
   480             20  CORR-FOLLOW-UP-DT   PIC X(8).
   481             20  CORR-ADDRESEE-LIT   PIC X(5).
   482             20  CORR-ADDRESEE       PIC X(4).
   483     12  FORM-LINE-1.
   484         16  FORM-HDG1.
   485             20  FORM-LINE-NO        PIC X.
   486             20  FILLER              PIC X.
   487             20  FORM-HDG1-LIT       PIC X(8).
   488         16  FORM-TEXT-1.
   489             20  FORM-CERT-NO        PIC X(12).
   490             20  FORM-TYPE-LIT       PIC X(7).
   491             20  FORM-TYPE           PIC X(8).
   492             20  FORM-SEND-ON-LIT    PIC X(10).
   493             20  FORM-SEND-ON-DT     PIC X(8).
   494             20  FORM-RESEND-LIT     PIC X(6).
   495             20  FORM-RESEND-DT      PIC X(8).
   496             20  FORM-REC-BY-LIT     PIC X(5).
   497             20  FORM-REC-BY         PIC X(4).
   498     12  FORM-LINE-2.
   499         16  FORM-HDG2.
   500             20  FILLER              PIC XX.
   501             20  FORM-HDG2-LIT       PIC X(8).
   502         16  FORM-TEXT-2.
   503             20  FORM-REC-DT         PIC X(8).
   504             20  FILLER              PIC X(5).
   505             20  FORM-REC-INS-LIT    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1502.cbl
   506             20  FORM-REC-INS-DT     PIC X(8).
   507             20  FORM-REC-PHY-LIT    PIC X(10).
   508             20  FORM-REC-PHY-DT     PIC X(8).
   509             20  FORM-REC-EMP-LIT    PIC X(6).
   510             20  FORM-REC-EMP-DT     PIC X(8).
   511             20  FILLER              PIC X(9).
   512     12  INCUR-CHG-LINE-1.
   513         16  INCUR-CHG-HDG1.
   514             20  INCUR-LINE-NO       PIC X.
   515             20  FILLER              PIC X.
   516             20  INCUR-HDG1-LIT      PIC X(8).
   517         16  INCUR-TEXT-1.
   518             20  INCUR-CERT-NO       PIC X(12).
   519             20  INCUR-INCUR-LIT     PIC X(7).
   520             20  INCUR-INCUR-DT      PIC X(8).
   521             20  INCUR-REPORT-LIT    PIC X(10).
   522             20  INCUR-REPORT-DT     PIC X(8).
   523             20  INCUR-ESTAB-LIT     PIC X(6).
   524             20  INCUR-ESTAB-DT      PIC X(8).
   525             20  INCUR-REC-BY-LIT    PIC X(5).
   526             20  INCUR-REC-BY        PIC X(4).
   527     12  INCUR-CHG-LINE-2.
   528         16  INCUR-CHG-HDG2.
   529             20  FILLER              PIC XX.
   530             20  INCUR-HDG2-LIT      PIC X(8).
   531         16  INCUR-TEXT-2.
   532             20  INCUR-REC-DT        PIC X(8).
   533             20  FILLER              PIC X(5).
   534             20  INCUR-PD-THRU-LIT   PIC X(6).
   535             20  INCUR-PD-THRU-DT    PIC X(8).
   536             20  INCUR-TOT-PD-LIT    PIC X(10).
   537             20  INCUR-TOT-PD        PIC Z(5).ZZ.
   538             20  INCUR-TOT-DAYS-LIT  PIC X(6).
   539             20  INCUR-TOT-DAYS-PD   PIC ZZZ.
   540             20  INCUR-NO-PMTS-LIT   PIC X(10).
   541             20  INCUR-NO-PMTS       PIC ZZZ.
   542             20  FILLER              PIC X.
   543     12  DENIAL-LINE-1.
   544         16  DENIAL-HDG1.
   545             20  DENIAL-LINE-NO      PIC X.
   546             20  FILLER              PIC X.
   547             20  DENIAL-HDG1-LIT     PIC X(8).
   548         16  DENIAL-TEXT-1.
   549             20  DENIAL-CERT-NO      PIC X(12).
   550             20  DENIAL-LN1-LIT      PIC X(7).
   551             20  DENIAL-LN1          PIC X(40).
   552             20  DENIAL-REC-BY-LIT   PIC X(5).
   553             20  DENIAL-REC-BY       PIC X(4).
   554     12  DENIAL-LINE-2.
   555         16  DENIAL-HDG2.
   556             20  FILLER              PIC XX.
   557             20  DENIAL-HDG2-LIT     PIC X(8).
   558         16  DENIAL-TEXT-2.
   559             20  DENIAL-REC-DT       PIC X(8).
   560             20  FILLER              PIC X(5).
   561             20  DENIAL-LN2-LIT      PIC X(6).
   562             20  DENIAL-LN2          PIC X(40).
   563             20  FILLER              PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1502.cbl
   564     12  GEN-INFO-LINE-1.
   565         16  GEN-INFO-HDG1.
   566             20  GI-LINE-NO          PIC X.
   567             20  FILLER              PIC X.
   568             20  GI-HDG1-LIT         PIC X(8).
   569         16  GEN-INFO-TEXT-1.
   570             20  GEN-INFO-CERT-NO    PIC X(12).
   571             20  GEN-INFO-MSG-1-LIT  PIC X(7).
   572             20  GEN-INFO-MSG-1      PIC X(40).
   573             20  GEN-INFO-REC-BY-LIT PIC X(5).
   574             20  GEN-INFO-REC-BY     PIC X(4).
   575     12  GEN-INFO-LINE-2.
   576         16  GEN-INFO-HDG2.
   577             20  FILLER              PIC XX.
   578             20  GI-HDG2-LIT         PIC X(8).
   579         16  GEN-INFO-TEXT-2.
   580             20  GEN-INFO-REC-DT     PIC X(8).
   581             20  FILLER              PIC X(5).
   582             20  GEN-INFO-MSG-2-LIT  PIC X(6).
   583             20  GEN-INFO-MSG-2      PIC X(40).
   584             20  FILLER              PIC X(9).
   585     12  REMINDER-LINE-1.
   586         16  REMINDER-HDG1.
   587             20  REM-LINE-NO         PIC X.
   588             20  FILLER              PIC X.
   589             20  REM-HDG1-LIT        PIC X(8).
   590         16  REMINDER-TEXT-1.
   591             20  REM-CERT-NO         PIC X(12).
   592             20  REM-LINE-1-LIT      PIC X(7).
   593             20  REM-LINE-1          PIC X(40).
   594             20  REM-REC-BY-LIT      PIC X(5).
   595             20  REM-REC-BY          PIC X(4).
   596     12  REMINDER-LINE-2.
   597         16  REMINDER-HDG2.
   598             20  FILLER              PIC XX.
   599             20  REM-HDG2-LIT        PIC X(8).
   600         16  REMINDER-TEXT-2.
   601             20  REM-REC-DT          PIC X(8).
   602             20  FILLER              PIC X(5).
   603             20  REM-LINE-2-LIT      PIC X(6).
   604             20  REM-LINE-2          PIC X(40).
   605             20  FILLER              PIC X(9).
   606
   607 01  PAYMENT-DESCRIPTION-TABLE.
   608     12  FILLER                      PIC X(7)    VALUE 'PARTIAL'.
   609     12  FILLER                      PIC X(7)    VALUE 'FINAL  '.
   610     12  FILLER                      PIC X(7)    VALUE 'LMP SUM'.
   611     12  FILLER                      PIC X(7)    VALUE 'ADDL   '.
   612     12  FILLER                      PIC X(7)    VALUE 'CHG EXP'.
   613     12  FILLER                      PIC X(7)    VALUE 'NON-CHG'.
   614     12  FILLER                      PIC X(7)    VALUE 'LF PRM '.
   615     12  FILLER                      PIC X(7)    VALUE 'A/H PRM'.
   616     12  FILLER                      PIC X(7)    VALUE 'ENT COR'.
   617 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   618     12  PAY-DESC                    PIC X(7)    OCCURS 2.
   619
   620 01  CV-PAYMENT-DESCRIPTION-TABLE.
   621     12  FILLER                      PIC X(7)    VALUE 'FUL DTH'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1502.cbl
   622     12  FILLER                      PIC X(7)    VALUE 'HLF DTH'.
   623     12  FILLER                      PIC X(7)    VALUE 'FUL ADD'.
   624     12  FILLER                      PIC X(7)    VALUE 'HLF ADD'.
   625     12  FILLER                      PIC X(7)    VALUE 'FUL RID'.
   626     12  FILLER                      PIC X(7)    VALUE 'HLF RID'.
   627     12  FILLER                      PIC X(7)    VALUE 'NON-CHG'.
   628     12  FILLER                      PIC X(7)    VALUE 'ADDL   '.
   629
   630 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   631     12  CV-PAY-DESC                 PIC X(7)    OCCURS 2.
   632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1502.cbl
   634*                                    COPY ELCDATE.
   635******************************************************************
   636*                                                                *
   637*                                                                *
   638*                            ELCDATE.                            *
   639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   640*                            VMOD=2.003
   641*                                                                *
   642*                                                                *
   643*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   644*                 LENGTH = 200                                   *
   645******************************************************************
   646
   647 01  DATE-CONVERSION-DATA.
   648     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   649     12  DC-OPTION-CODE                PIC X.
   650         88  BIN-TO-GREG                VALUE ' '.
   651         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   652         88  EDIT-GREG-TO-BIN           VALUE '2'.
   653         88  YMD-GREG-TO-BIN            VALUE '3'.
   654         88  MDY-GREG-TO-BIN            VALUE '4'.
   655         88  JULIAN-TO-BIN              VALUE '5'.
   656         88  BIN-PLUS-ELAPSED           VALUE '6'.
   657         88  FIND-CENTURY               VALUE '7'.
   658         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   659         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   660         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   661         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   662         88  JULIAN-TO-BIN-3            VALUE 'C'.
   663         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   664         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   665         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   666         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   667         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   668         88  CHECK-LEAP-YEAR            VALUE 'H'.
   669         88  BIN-3-TO-GREG              VALUE 'I'.
   670         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   671         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   672         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   673         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   674         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   675         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   676         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   677         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   678         88  THREE-CHARACTER-BIN
   679                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   680         88  GREGORIAN-TO-BIN
   681                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   682         88  BIN-TO-GREGORIAN
   683                  VALUES ' ' '1' 'I' '8' 'G'.
   684         88  JULIAN-TO-BINARY
   685                  VALUES '5' 'C' 'E' 'F'.
   686     12  DC-ERROR-CODE                 PIC X.
   687         88  NO-CONVERSION-ERROR        VALUE ' '.
   688         88  DATE-CONVERSION-ERROR
   689                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   690         88  DATE-IS-ZERO               VALUE '1'.
   691         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1502.cbl
   692         88  DATE-IS-INVALID            VALUE '3'.
   693         88  DATE1-GREATER-DATE2        VALUE '4'.
   694         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   695         88  DATE-INVALID-OPTION        VALUE '9'.
   696         88  INVALID-CENTURY            VALUE 'A'.
   697         88  ONLY-CENTURY               VALUE 'B'.
   698         88  ONLY-LEAP-YEAR             VALUE 'C'.
   699         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   700     12  DC-END-OF-MONTH               PIC X.
   701         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   702     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   703         88  USE-NORMAL-PROCESS         VALUE ' '.
   704         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   705         88  ADJUST-UP-100-YRS          VALUE '2'.
   706     12  FILLER                        PIC X.
   707     12  DC-CONVERSION-DATES.
   708         16  DC-BIN-DATE-1             PIC XX.
   709         16  DC-BIN-DATE-2             PIC XX.
   710         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   711         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   712                       DC-GREG-DATE-1-EDIT.
   713             20  DC-EDIT1-MONTH        PIC 99.
   714             20  SLASH1-1              PIC X.
   715             20  DC-EDIT1-DAY          PIC 99.
   716             20  SLASH1-2              PIC X.
   717             20  DC-EDIT1-YEAR         PIC 99.
   718         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   719         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   720                     DC-GREG-DATE-2-EDIT.
   721             20  DC-EDIT2-MONTH        PIC 99.
   722             20  SLASH2-1              PIC X.
   723             20  DC-EDIT2-DAY          PIC 99.
   724             20  SLASH2-2              PIC X.
   725             20  DC-EDIT2-YEAR         PIC 99.
   726         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   727         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   728                     DC-GREG-DATE-1-YMD.
   729             20  DC-YMD-YEAR           PIC 99.
   730             20  DC-YMD-MONTH          PIC 99.
   731             20  DC-YMD-DAY            PIC 99.
   732         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   733         16  DC-GREG-DATE-1-MDY-R REDEFINES
   734                      DC-GREG-DATE-1-MDY.
   735             20  DC-MDY-MONTH          PIC 99.
   736             20  DC-MDY-DAY            PIC 99.
   737             20  DC-MDY-YEAR           PIC 99.
   738         16  DC-GREG-DATE-1-ALPHA.
   739             20  DC-ALPHA-MONTH        PIC X(10).
   740             20  DC-ALPHA-DAY          PIC 99.
   741             20  FILLER                PIC XX.
   742             20  DC-ALPHA-CENTURY.
   743                 24 DC-ALPHA-CEN-N     PIC 99.
   744             20  DC-ALPHA-YEAR         PIC 99.
   745         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   746         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   747         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   748         16  DC-JULIAN-DATE            PIC 9(05).
   749         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1502.cbl
   750                                       PIC 9(05).
   751         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   752             20  DC-JULIAN-YEAR        PIC 99.
   753             20  DC-JULIAN-DAYS        PIC 999.
   754         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   755         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   756         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   757     12  DATE-CONVERSION-VARIBLES.
   758         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   759         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   760             20  FILLER                PIC 9(3).
   761             20  HOLD-CEN-1-CCYY.
   762                 24  HOLD-CEN-1-CC     PIC 99.
   763                 24  HOLD-CEN-1-YY     PIC 99.
   764             20  HOLD-CEN-1-MO         PIC 99.
   765             20  HOLD-CEN-1-DA         PIC 99.
   766         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   767             20  HOLD-CEN-1-R-MO       PIC 99.
   768             20  HOLD-CEN-1-R-DA       PIC 99.
   769             20  HOLD-CEN-1-R-CCYY.
   770                 24  HOLD-CEN-1-R-CC   PIC 99.
   771                 24  HOLD-CEN-1-R-YY   PIC 99.
   772             20  FILLER                PIC 9(3).
   773         16  HOLD-CENTURY-1-X.
   774             20  FILLER                PIC X(3)  VALUE SPACES.
   775             20  HOLD-CEN-1-X-CCYY.
   776                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   777                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   778             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   779             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   780         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   781             20  HOLD-CEN-1-R-X-MO     PIC XX.
   782             20  HOLD-CEN-1-R-X-DA     PIC XX.
   783             20  HOLD-CEN-1-R-X-CCYY.
   784                 24  HOLD-CEN-1-R-X-CC PIC XX.
   785                 24  HOLD-CEN-1-R-X-YY PIC XX.
   786             20  FILLER                PIC XXX.
   787         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   788         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   789         16  DC-JULIAN-DATE-1          PIC 9(07).
   790         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   791             20  DC-JULIAN-1-CCYY.
   792                 24  DC-JULIAN-1-CC    PIC 99.
   793                 24  DC-JULIAN-1-YR    PIC 99.
   794             20  DC-JULIAN-DA-1        PIC 999.
   795         16  DC-JULIAN-DATE-2          PIC 9(07).
   796         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   797             20  DC-JULIAN-2-CCYY.
   798                 24  DC-JULIAN-2-CC    PIC 99.
   799                 24  DC-JULIAN-2-YR    PIC 99.
   800             20  DC-JULIAN-DA-2        PIC 999.
   801         16  DC-GREG-DATE-A-EDIT.
   802             20  DC-EDITA-MONTH        PIC 99.
   803             20  SLASHA-1              PIC X VALUE '/'.
   804             20  DC-EDITA-DAY          PIC 99.
   805             20  SLASHA-2              PIC X VALUE '/'.
   806             20  DC-EDITA-CCYY.
   807                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1502.cbl
   808                 24  DC-EDITA-YEAR     PIC 99.
   809         16  DC-GREG-DATE-B-EDIT.
   810             20  DC-EDITB-MONTH        PIC 99.
   811             20  SLASHB-1              PIC X VALUE '/'.
   812             20  DC-EDITB-DAY          PIC 99.
   813             20  SLASHB-2              PIC X VALUE '/'.
   814             20  DC-EDITB-CCYY.
   815                 24  DC-EDITB-CENT     PIC 99.
   816                 24  DC-EDITB-YEAR     PIC 99.
   817         16  DC-GREG-DATE-CYMD         PIC 9(08).
   818         16  DC-GREG-DATE-CYMD-R REDEFINES
   819                              DC-GREG-DATE-CYMD.
   820             20  DC-CYMD-CEN           PIC 99.
   821             20  DC-CYMD-YEAR          PIC 99.
   822             20  DC-CYMD-MONTH         PIC 99.
   823             20  DC-CYMD-DAY           PIC 99.
   824         16  DC-GREG-DATE-MDCY         PIC 9(08).
   825         16  DC-GREG-DATE-MDCY-R REDEFINES
   826                              DC-GREG-DATE-MDCY.
   827             20  DC-MDCY-MONTH         PIC 99.
   828             20  DC-MDCY-DAY           PIC 99.
   829             20  DC-MDCY-CEN           PIC 99.
   830             20  DC-MDCY-YEAR          PIC 99.
   831    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   832        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   833    12  DC-EL310-DATE                  PIC X(21).
   834    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1502.cbl
   836*                                    COPY ELCLOGOF.
   837******************************************************************
   838*                                                                *
   839*                                                                *
   840*                            ELCLOGOF.                           *
   841*                            VMOD=2.001                          *
   842*                                                                *
   843*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   844*                                                                *
   845******************************************************************
   846 01  CLASIC-LOGOFF.
   847     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   848     12  LOGOFF-TEXT.
   849         16  FILLER          PIC X(5)    VALUE SPACES.
   850         16  LOGOFF-MSG.
   851             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   852             20  FILLER      PIC X       VALUE SPACES.
   853             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   854         16  FILLER          PIC X(80)
   855           VALUE '* YOU ARE NOW LOGGED OFF'.
   856         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   857         16  FILLER          PIC X       VALUE QUOTE.
   858         16  LOGOFF-SYS-MSG  PIC X(17)
   859           VALUE 'S CLAS-IC SYSTEM '.
   860     12  TEXT-MESSAGES.
   861         16  UNACCESS-MSG    PIC X(29)
   862             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   863         16  PGMIDERR-MSG    PIC X(17)
   864             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1502.cbl
   866*                                    COPY ELCATTR.
   867******************************************************************
   868*                                                                *
   869*                            ELCATTR.                            *
   870*                            VMOD=2.001                          *
   871*                                                                *
   872*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   873*                                                                *
   874*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   875*                                                                *
   876*                   POS 1   P=PROTECTED                          *
   877*                           U=UNPROTECTED                        *
   878*                           S=ASKIP                              *
   879*                   POS 2   A=ALPHA/NUMERIC                      *
   880*                           N=NUMERIC                            *
   881*                   POS 3   N=NORMAL                             *
   882*                           B=BRIGHT                             *
   883*                           D=DARK                               *
   884*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   885*                           OF=MODIFIED DATA TAG OFF             *
   886*                                                                *
   887*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   888******************************************************************
   889 01  ATTRIBUTE-LIST.
   890     12  AL-PABOF            PIC X       VALUE 'Y'.
   891     12  AL-PABON            PIC X       VALUE 'Z'.
   892     12  AL-PADOF            PIC X       VALUE '%'.
   893     12  AL-PADON            PIC X       VALUE '_'.
   894     12  AL-PANOF            PIC X       VALUE '-'.
   895     12  AL-PANON            PIC X       VALUE '/'.
   896     12  AL-SABOF            PIC X       VALUE '8'.
   897     12  AL-SABON            PIC X       VALUE '9'.
   898     12  AL-SADOF            PIC X       VALUE '@'.
   899     12  AL-SADON            PIC X       VALUE QUOTE.
   900     12  AL-SANOF            PIC X       VALUE '0'.
   901     12  AL-SANON            PIC X       VALUE '1'.
   902     12  AL-UABOF            PIC X       VALUE 'H'.
   903     12  AL-UABON            PIC X       VALUE 'I'.
   904     12  AL-UADOF            PIC X       VALUE '<'.
   905     12  AL-UADON            PIC X       VALUE '('.
   906     12  AL-UANOF            PIC X       VALUE ' '.
   907     12  AL-UANON            PIC X       VALUE 'A'.
   908     12  AL-UNBOF            PIC X       VALUE 'Q'.
   909     12  AL-UNBON            PIC X       VALUE 'R'.
   910     12  AL-UNDOF            PIC X       VALUE '*'.
   911     12  AL-UNDON            PIC X       VALUE ')'.
   912     12  AL-UNNOF            PIC X       VALUE '&'.
   913     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1502.cbl
   915*                                    COPY ELCEMIB.
   916******************************************************************
   917*                                                                *
   918*                                                                *
   919*                            ELCEMIB.                            *
   920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   921*                            VMOD=2.005                          *
   922*                                                                *
   923*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   924*                                                                *
   925******************************************************************
   926 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   927     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   928     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   929     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   930     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   931     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   932     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   933     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   934     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   935     12  EMI-SWITCH1             PIC X        VALUE '1'.
   936         88  EMI-NO-ERRORS                    VALUE '1'.
   937         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   938         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   939     12  EMI-SWITCH2             PIC X        VALUE '1'.
   940         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   941     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   942         88  EMI-AREA1-EMPTY                  VALUE '1'.
   943         88  EMI-AREA1-FULL                   VALUE '2'.
   944     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   945         88  EMI-AREA2-EMPTY                  VALUE '1'.
   946         88  EMI-AREA2-FULL                   VALUE '2'.
   947     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   948         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   949         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   950         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   951         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   952         88  EMI-BYPASS-FATALS                VALUE 'X'.
   953     12  EMI-ERROR-LINES.
   954         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   955         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   956         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   957         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   958             20  EMI-ERR-CODES OCCURS 10 TIMES.
   959                 24  EMI-ERR-NUM         PIC X(4).
   960                 24  EMI-FILLER          PIC X.
   961                 24  EMI-SEV             PIC X.
   962                 24  FILLER              PIC X.
   963             20  FILLER                  PIC X(02).
   964     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   965         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   966             20  EMI-ERROR-NUMBER    PIC X(4).
   967             20  EMI-FILL            PIC X.
   968             20  EMI-SEVERITY        PIC X.
   969             20  FILLER              PIC X.
   970             20  EMI-ERROR-TEXT.
   971                 24  EMI-TEXT-VARIABLE   PIC X(10).
   972                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1502.cbl
   973     12  EMI-SEVERITY-SAVE           PIC X.
   974         88  EMI-NOTE                    VALUE 'N'.
   975         88  EMI-WARNING                 VALUE 'W'.
   976         88  EMI-FORCABLE                VALUE 'F'.
   977         88  EMI-FATAL                   VALUE 'X'.
   978     12  EMI-MESSAGE-FLAG            PIC X.
   979         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   980         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   981     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   982     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   983         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   984         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   985         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   986     12  FILLER                      PIC X(137)  VALUE SPACES.
   987     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   988     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   989     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   990     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1502.cbl
   992*                                    COPY ELCDCTB.
   993*    EJECT
   994*                                    COPY ELCDMO.
   995*    EJECT
   996*                                    COPY ELCNWA.
   997*    EJECT
   998*                                    COPY MPCPOLUP.
   999*    EJECT
  1000*                                    COPY ELCINTF.
  1001******************************************************************
  1002*                                                                *
  1003*                                                                *
  1004*                            ELCINTF.                            *
  1005*                            VMOD=2.017                          *
  1006*                                                                *
  1007*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1008*                                                                *
  1009*       LENGTH = 1024                                            *
  1010*                                                                *
  1011******************************************************************
  1012 01  PROGRAM-INTERFACE-BLOCK.
  1013     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1014     12  PI-CALLING-PROGRAM              PIC X(8).
  1015     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1016     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1017     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1018     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1019     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1020     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1021     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1022     12  PI-COMPANY-ID                   PIC XXX.
  1023     12  PI-COMPANY-CD                   PIC X.
  1024
  1025     12  PI-COMPANY-PASSWORD             PIC X(8).
  1026
  1027     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1028
  1029     12  PI-CONTROL-IN-PROGRESS.
  1030         16  PI-CARRIER                  PIC X.
  1031         16  PI-GROUPING                 PIC X(6).
  1032         16  PI-STATE                    PIC XX.
  1033         16  PI-ACCOUNT                  PIC X(10).
  1034         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1035                                         PIC X(10).
  1036         16  PI-CLAIM-CERT-GRP.
  1037             20  PI-CLAIM-NO             PIC X(7).
  1038             20  PI-CERT-NO.
  1039                 25  PI-CERT-PRIME       PIC X(10).
  1040                 25  PI-CERT-SFX         PIC X.
  1041             20  PI-CERT-EFF-DT          PIC XX.
  1042         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1043             20  PI-PLAN-CODE            PIC X(2).
  1044             20  PI-REVISION-NUMBER      PIC X(3).
  1045             20  PI-PLAN-EFF-DT          PIC X(2).
  1046             20  PI-PLAN-EXP-DT          PIC X(2).
  1047             20  FILLER                  PIC X(11).
  1048         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1049             20  PI-OE-REFERENCE-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1502.cbl
  1050                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1051                 25  PI-OE-REF-1-SUFF    PIC XX.
  1052
  1053     12  PI-SESSION-IN-PROGRESS          PIC X.
  1054         88  CLAIM-SESSION                   VALUE '1'.
  1055         88  CREDIT-SESSION                  VALUE '2'.
  1056         88  WARRANTY-SESSION                VALUE '3'.
  1057         88  MORTGAGE-SESSION                VALUE '4'.
  1058         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1059
  1060
  1061*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1062
  1063     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1064     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1065
  1066     12  PI-CREDIT-USER                  PIC X.
  1067         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1068         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1069
  1070     12  PI-CLAIM-USER                   PIC X.
  1071         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1072         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1073
  1074     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1075         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1076         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1077         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1078         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1079         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1080
  1081     12  PI-PROCESSOR-ID                 PIC X(4).
  1082
  1083     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1084
  1085     12  PI-MEMBER-CAPTION               PIC X(10).
  1086
  1087     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1088         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1089
  1090     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1091     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1092     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1093     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1094
  1095     12  PI-AH-OVERRIDE-L1               PIC X.
  1096     12  PI-AH-OVERRIDE-L2               PIC XX.
  1097     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1098     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1099
  1100     12  PI-NEW-SYSTEM                   PIC X(2).
  1101
  1102     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1103     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1104         88  PI-USES-PAID-TO                 VALUE '1'.
  1105     12  PI-CRDTCRD-SYSTEM.
  1106         16  PI-CRDTCRD-USER             PIC X.
  1107             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1502.cbl
  1108             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1109         16  PI-CC-MONTH-END-DT          PIC XX.
  1110     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1111
  1112     12  PI-OE-REFERENCE-2.
  1113         16  PI-OE-REF-2-PRIME           PIC X(10).
  1114         16  PI-OE-REF-2-SUFF            PIC X.
  1115
  1116     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1117
  1118     12  PI-LANGUAGE-TYPE                PIC X.
  1119             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1120             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1121             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1122
  1123     12  PI-POLICY-LINKAGE-IND           PIC X.
  1124         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1125         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1126                                                   LOW-VALUES.
  1127
  1128     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1129     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1130         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1131         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1132     12  FILLER                          PIC X(4).
  1133
  1134     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1135
  1136     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1137         PI-SYSTEM-LEVEL.
  1138
  1139         16  PI-ENTRY-CODES.
  1140             20  PI-ENTRY-CD-1           PIC X.
  1141             20  PI-ENTRY-CD-2           PIC X.
  1142
  1143         16  PI-RETURN-CODES.
  1144             20  PI-RETURN-CD-1          PIC X.
  1145             20  PI-RETURN-CD-2          PIC X.
  1146
  1147         16  PI-UPDATE-STATUS-SAVE.
  1148             20  PI-UPDATE-BY            PIC X(4).
  1149             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1150
  1151         16  PI-LOWER-CASE-LETTERS       PIC X.
  1152             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1153
  1154*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1155*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1156*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1157
  1158         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1159             88  ST-ACCNT-CNTL               VALUE ' '.
  1160             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1161             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1162             88  ACCNT-CNTL                  VALUE '3'.
  1163             88  CARR-ACCNT-CNTL             VALUE '4'.
  1164
  1165         16  PI-PROCESSOR-CAP-LIST.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1502.cbl
  1166             20  PI-SYSTEM-CONTROLS.
  1167                24 PI-SYSTEM-DISPLAY     PIC X.
  1168                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1169                24 PI-SYSTEM-MODIFY      PIC X.
  1170                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1171             20  FILLER                  PIC XX.
  1172             20  PI-DISPLAY-CAP          PIC X.
  1173                 88  DISPLAY-CAP             VALUE 'Y'.
  1174             20  PI-MODIFY-CAP           PIC X.
  1175                 88  MODIFY-CAP              VALUE 'Y'.
  1176             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1177                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1178             20  PI-FORCE-CAP            PIC X.
  1179                 88  FORCE-CAP               VALUE 'Y'.
  1180
  1181         16  PI-PROGRAM-CONTROLS.
  1182             20  PI-PGM-PRINT-OPT        PIC X.
  1183             20  PI-PGM-FORMAT-OPT       PIC X.
  1184             20  PI-PGM-PROCESS-OPT      PIC X.
  1185             20  PI-PGM-TOTALS-OPT       PIC X.
  1186
  1187         16  PI-HELP-INTERFACE.
  1188             20  PI-LAST-ERROR-NO        PIC X(4).
  1189             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1190
  1191         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1192             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1193
  1194         16  PI-CR-CONTROL-IN-PROGRESS.
  1195             20  PI-CR-CARRIER           PIC X.
  1196             20  PI-CR-GROUPING          PIC X(6).
  1197             20  PI-CR-STATE             PIC XX.
  1198             20  PI-CR-ACCOUNT           PIC X(10).
  1199             20  PI-CR-FIN-RESP          PIC X(10).
  1200             20  PI-CR-TYPE              PIC X.
  1201
  1202         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1203
  1204         16  PI-CR-MONTH-END-DT          PIC XX.
  1205
  1206         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1207             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1208             88  PI-ZERO-CARRIER             VALUE '1'.
  1209             88  PI-ZERO-GROUPING            VALUE '2'.
  1210             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1211
  1212         16  PI-CARRIER-SECURITY         PIC X.
  1213             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1214
  1215         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1216             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1217             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1218
  1219         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1220             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1221                                         INDEXED BY PI-ACCESS-NDX
  1222                                         PIC X.
  1223
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1502.cbl
  1224         16  PI-GA-BILLING-CONTROL       PIC X.
  1225             88  PI-GA-BILLING               VALUE '1'.
  1226
  1227         16  PI-MAIL-PROCESSING          PIC X.
  1228             88  PI-MAIL-YES                 VALUE 'Y'.
  1229
  1230         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1231
  1232         16  PI-AR-SYSTEM.
  1233             20  PI-AR-PROCESSING-CNTL   PIC X.
  1234                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1235             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1236             20  PI-AR-MONTH-END-DT      PIC XX.
  1237
  1238         16  PI-MP-SYSTEM.
  1239             20  PI-MORTGAGE-USER            PIC X.
  1240                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1241                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1242             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1243                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1244                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1245                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1246                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1247                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1248             20  PI-MP-MONTH-END-DT          PIC XX.
  1249             20  PI-MP-REFERENCE-NO.
  1250                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1251                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1252
  1253         16  PI-LABEL-CONTROL            PIC X(01).
  1254             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1255             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1256
  1257         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1258             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1259
  1260         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1261             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1262             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1263
  1264         16  FILLER                      PIC X(14).
  1265
  1266     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1267******************************************************************
  1268
  1269     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  1270*        16  FILLER                  PIC 9(4).
  1271         16  FILLER                  PIC x(2).
  1272         16  pi-el142-priority       pic x.
  1273         16  filler                  pic x.
  1274         16  PI-MAP-NAME             PIC X(8).
  1275         16  PI-QUALIFICATION-SWITCHES  COMP-3.
  1276             20  PI-REMINDERS-SW     PIC S9.
  1277             20  PI-LETTERS-SW       PIC S9.
  1278             20  PI-PAYMENTS-SW      PIC S9.
  1279             20  PI-AUTO-PAY-SW      PIC S9.
  1280             20  PI-NOTES-SW         PIC S9.
  1281             20  PI-RES-EXP-SW       PIC S9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1502.cbl
  1282             20  PI-DENIALS-SW       PIC S9.
  1283             20  PI-INCURRED-DATE-SW PIC S9.
  1284             20  PI-FORMS-SW         PIC S9.
  1285         16  FILLER                  PIC X(8).
  1286         16  PI-ACTIVITY-TRAILERS-KEY.
  1287             20  PI-ATK-COMPANY-CODE PIC X.
  1288             20  PI-ATK-CARRIER      PIC X.
  1289             20  PI-ATK-CLAIM-NO     PIC X(7).
  1290             20  PI-ATK-CERT-NO      PIC X(11).
  1291             20  PI-ATK-SEQ-NO       PIC S9(4)     COMP.
  1292         16  PI-PREV-ACTIVITY-TRAILERS-KEY.
  1293             20  PI-PREV-ATK-COMPANY-CODE PIC X.
  1294             20  PI-PREV-ATK-CARRIER      PIC X.
  1295             20  PI-PREV-ATK-CLAIM-NO     PIC X(7).
  1296             20  PI-PREV-ATK-CERT-NO      PIC X(11).
  1297             20  PI-PREV-ATK-SEQ-NO       PIC S9(4)     COMP.
  1298         16  PI-SAVE-KEY.
  1299             20  PI-SAVE-ATK-COMPANY-CODE PIC X.
  1300             20  PI-SAVE-ATK-CARRIER      PIC X.
  1301             20  PI-SAVE-ATK-CLAIM-NO     PIC X(7).
  1302             20  PI-SAVE-ATK-CERT-NO      PIC X(11).
  1303             20  PI-SAVE-ATK-SEQ-NO       PIC S9(4)     COMP.
  1304         16  PI-PREV-AID                  PIC X.
  1305         16  PI-RECORD-COUNT              PIC S9        COMP-3.
  1306         16  PI-END-OF-FILE               PIC S9        COMP-3.
  1307         16  PI-SAVE-CURSOR               PIC S9(4)     COMP.
  1308         16  PI-PURGED-SW                 PIC X.
  1309             88  CLAIM-IS-PURGED                 VALUE 'Y'.
  1310         16  PI-LINE-NO                   PIC 9.
  1311         16  PI-PREV-SEQ-NO               PIC S9(4)   COMP.
  1312         16  PI-FIRST-TIME-SW             PIC X.
  1313             88  FIRST-TIME                      VALUE 'Y'.
  1314
  1315         16  PI-SEQ-NUMBERS.
  1316             20  PI-SEQ-NO-TABLE OCCURS 8 TIMES.
  1317                 24  PI-TRLR-LN-NO        PIC 9.
  1318                 24  PI-TRLR-SEQ-NO       PIC S9(4)   COMP.
  1319                 24  PI-TRLR-TYPE         PIC X.
  1320                 24  PI-TRLR-CERT         PIC X(11).
  1321                 24  PI-TRLR-SUB          PIC 9(4).
  1322
  1323         16  PI-PREV-CLAIM-NO             PIC X(7).
  1324         16  PI-PREV-CARRIER              PIC X.
  1325         16  PI-PRIME-CERT-NO.
  1326             20  PI-PRIME-CERT            PIC X(10).
  1327             20  PI-PRIME-SUFX            PIC X.
  1328         16  PI-PRIME-HDG                 PIC X(12).
  1329         16  PI-MAX-SUB                   PIC 9(4).
  1330         16  PI-PAY-TYPE                  PIC X.
  1331         16  PI-FULL-SCREEN-IND           PIC X.
  1332             88  PI-FULL-SCREEN-SHOWN         VALUE 'Y'.
  1333         16  FILLER                  PIC X(346).
  1334
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1502.cbl
  1336*                                    COPY ELCAID.
  1337******************************************************************
  1338*                                                                *
  1339*                            ELCAID.                             *
  1340*                            VMOD=2.001                          *
  1341*                                                                *
  1342*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1343*                                                                *
  1344*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1345*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1346******************************************************************
  1347
  1348 01  DFHAID.
  1349   02  DFHNULL   PIC  X  VALUE  ' '.
  1350   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1351   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1352   02  DFHPEN    PIC  X  VALUE  '='.
  1353   02  DFHOPID   PIC  X  VALUE  'W'.
  1354   02  DFHPA1    PIC  X  VALUE  '%'.
  1355   02  DFHPA2    PIC  X  VALUE  '>'.
  1356   02  DFHPA3    PIC  X  VALUE  ','.
  1357   02  DFHPF1    PIC  X  VALUE  '1'.
  1358   02  DFHPF2    PIC  X  VALUE  '2'.
  1359   02  DFHPF3    PIC  X  VALUE  '3'.
  1360   02  DFHPF4    PIC  X  VALUE  '4'.
  1361   02  DFHPF5    PIC  X  VALUE  '5'.
  1362   02  DFHPF6    PIC  X  VALUE  '6'.
  1363   02  DFHPF7    PIC  X  VALUE  '7'.
  1364   02  DFHPF8    PIC  X  VALUE  '8'.
  1365   02  DFHPF9    PIC  X  VALUE  '9'.
  1366   02  DFHPF10   PIC  X  VALUE  ':'.
  1367   02  DFHPF11   PIC  X  VALUE  '#'.
  1368   02  DFHPF12   PIC  X  VALUE  '@'.
  1369   02  DFHPF13   PIC  X  VALUE  'A'.
  1370   02  DFHPF14   PIC  X  VALUE  'B'.
  1371   02  DFHPF15   PIC  X  VALUE  'C'.
  1372   02  DFHPF16   PIC  X  VALUE  'D'.
  1373   02  DFHPF17   PIC  X  VALUE  'E'.
  1374   02  DFHPF18   PIC  X  VALUE  'F'.
  1375   02  DFHPF19   PIC  X  VALUE  'G'.
  1376   02  DFHPF20   PIC  X  VALUE  'H'.
  1377   02  DFHPF21   PIC  X  VALUE  'I'.
  1378*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1379   02  DFHPF22   PIC  X  VALUE  '['.
  1380   02  DFHPF23   PIC  X  VALUE  '.'.
  1381   02  DFHPF24   PIC  X  VALUE  '<'.
  1382   02  DFHMSRE   PIC  X  VALUE  'X'.
  1383   02  DFHSTRF   PIC  X  VALUE  'h'.
  1384   02  DFHTRIG   PIC  X  VALUE  '"'.
  1385 01  FILLER    REDEFINES DFHAID.
  1386     12  FILLER                      PIC X(8).
  1387     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1502.cbl
  1389*                                    COPY EL1502S.
  1390 01  EL150CI.
  1391     05  FILLER            PIC  X(0012).
  1392*    -------------------------------
  1393     05  RUNDTEL PIC S9(0004) COMP.
  1394     05  RUNDTEF PIC  X(0001).
  1395     05  FILLER REDEFINES RUNDTEF.
  1396         10  RUNDTEA PIC  X(0001).
  1397     05  RUNDTEI PIC  X(0008).
  1398*    -------------------------------
  1399     05  RUNTIMEL PIC S9(0004) COMP.
  1400     05  RUNTIMEF PIC  X(0001).
  1401     05  FILLER REDEFINES RUNTIMEF.
  1402         10  RUNTIMEA PIC  X(0001).
  1403     05  RUNTIMEI PIC  X(0005).
  1404*    -------------------------------
  1405     05  CLMNOL PIC S9(0004) COMP.
  1406     05  CLMNOF PIC  X(0001).
  1407     05  FILLER REDEFINES CLMNOF.
  1408         10  CLMNOA PIC  X(0001).
  1409     05  CLMNOI PIC  X(0007).
  1410*    -------------------------------
  1411     05  CARRL PIC S9(0004) COMP.
  1412     05  CARRF PIC  X(0001).
  1413     05  FILLER REDEFINES CARRF.
  1414         10  CARRA PIC  X(0001).
  1415     05  CARRI PIC  X(0001).
  1416*    -------------------------------
  1417     05  PRIMEHDL PIC S9(0004) COMP.
  1418     05  PRIMEHDF PIC  X(0001).
  1419     05  FILLER REDEFINES PRIMEHDF.
  1420         10  PRIMEHDA PIC  X(0001).
  1421     05  PRIMEHDI PIC  X(0012).
  1422*    -------------------------------
  1423     05  PCERTNOL PIC S9(0004) COMP.
  1424     05  PCERTNOF PIC  X(0001).
  1425     05  FILLER REDEFINES PCERTNOF.
  1426         10  PCERTNOA PIC  X(0001).
  1427     05  PCERTNOI PIC  X(0010).
  1428*    -------------------------------
  1429     05  SUFXL PIC S9(0004) COMP.
  1430     05  SUFXF PIC  X(0001).
  1431     05  FILLER REDEFINES SUFXF.
  1432         10  SUFXA PIC  X(0001).
  1433     05  SUFXI PIC  X(0001).
  1434*    -------------------------------
  1435     05  LN1HDGL PIC S9(0004) COMP.
  1436     05  LN1HDGF PIC  X(0001).
  1437     05  FILLER REDEFINES LN1HDGF.
  1438         10  LN1HDGA PIC  X(0001).
  1439     05  LN1HDGI PIC  X(0010).
  1440*    -------------------------------
  1441     05  LN1TXTL PIC S9(0004) COMP.
  1442     05  LN1TXTF PIC  X(0001).
  1443     05  FILLER REDEFINES LN1TXTF.
  1444         10  LN1TXTA PIC  X(0001).
  1445     05  LN1TXTI PIC  X(0068).
  1446*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1502.cbl
  1447     05  LN2HDGL PIC S9(0004) COMP.
  1448     05  LN2HDGF PIC  X(0001).
  1449     05  FILLER REDEFINES LN2HDGF.
  1450         10  LN2HDGA PIC  X(0001).
  1451     05  LN2HDGI PIC  X(0010).
  1452*    -------------------------------
  1453     05  LN2TXTL PIC S9(0004) COMP.
  1454     05  LN2TXTF PIC  X(0001).
  1455     05  FILLER REDEFINES LN2TXTF.
  1456         10  LN2TXTA PIC  X(0001).
  1457     05  LN2TXTI PIC  X(0068).
  1458*    -------------------------------
  1459     05  LN3HDGL PIC S9(0004) COMP.
  1460     05  LN3HDGF PIC  X(0001).
  1461     05  FILLER REDEFINES LN3HDGF.
  1462         10  LN3HDGA PIC  X(0001).
  1463     05  LN3HDGI PIC  X(0010).
  1464*    -------------------------------
  1465     05  LN3TXTL PIC S9(0004) COMP.
  1466     05  LN3TXTF PIC  X(0001).
  1467     05  FILLER REDEFINES LN3TXTF.
  1468         10  LN3TXTA PIC  X(0001).
  1469     05  LN3TXTI PIC  X(0068).
  1470*    -------------------------------
  1471     05  LN4HDGL PIC S9(0004) COMP.
  1472     05  LN4HDGF PIC  X(0001).
  1473     05  FILLER REDEFINES LN4HDGF.
  1474         10  LN4HDGA PIC  X(0001).
  1475     05  LN4HDGI PIC  X(0010).
  1476*    -------------------------------
  1477     05  LN4TXTL PIC S9(0004) COMP.
  1478     05  LN4TXTF PIC  X(0001).
  1479     05  FILLER REDEFINES LN4TXTF.
  1480         10  LN4TXTA PIC  X(0001).
  1481     05  LN4TXTI PIC  X(0068).
  1482*    -------------------------------
  1483     05  LN5HDGL PIC S9(0004) COMP.
  1484     05  LN5HDGF PIC  X(0001).
  1485     05  FILLER REDEFINES LN5HDGF.
  1486         10  LN5HDGA PIC  X(0001).
  1487     05  LN5HDGI PIC  X(0010).
  1488*    -------------------------------
  1489     05  LN5TXTL PIC S9(0004) COMP.
  1490     05  LN5TXTF PIC  X(0001).
  1491     05  FILLER REDEFINES LN5TXTF.
  1492         10  LN5TXTA PIC  X(0001).
  1493     05  LN5TXTI PIC  X(0068).
  1494*    -------------------------------
  1495     05  LN6HDGL PIC S9(0004) COMP.
  1496     05  LN6HDGF PIC  X(0001).
  1497     05  FILLER REDEFINES LN6HDGF.
  1498         10  LN6HDGA PIC  X(0001).
  1499     05  LN6HDGI PIC  X(0010).
  1500*    -------------------------------
  1501     05  LN6TXTL PIC S9(0004) COMP.
  1502     05  LN6TXTF PIC  X(0001).
  1503     05  FILLER REDEFINES LN6TXTF.
  1504         10  LN6TXTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1502.cbl
  1505     05  LN6TXTI PIC  X(0068).
  1506*    -------------------------------
  1507     05  LN7HDGL PIC S9(0004) COMP.
  1508     05  LN7HDGF PIC  X(0001).
  1509     05  FILLER REDEFINES LN7HDGF.
  1510         10  LN7HDGA PIC  X(0001).
  1511     05  LN7HDGI PIC  X(0010).
  1512*    -------------------------------
  1513     05  LN7TXTL PIC S9(0004) COMP.
  1514     05  LN7TXTF PIC  X(0001).
  1515     05  FILLER REDEFINES LN7TXTF.
  1516         10  LN7TXTA PIC  X(0001).
  1517     05  LN7TXTI PIC  X(0068).
  1518*    -------------------------------
  1519     05  LN8HDGL PIC S9(0004) COMP.
  1520     05  LN8HDGF PIC  X(0001).
  1521     05  FILLER REDEFINES LN8HDGF.
  1522         10  LN8HDGA PIC  X(0001).
  1523     05  LN8HDGI PIC  X(0010).
  1524*    -------------------------------
  1525     05  LN8TXTL PIC S9(0004) COMP.
  1526     05  LN8TXTF PIC  X(0001).
  1527     05  FILLER REDEFINES LN8TXTF.
  1528         10  LN8TXTA PIC  X(0001).
  1529     05  LN8TXTI PIC  X(0068).
  1530*    -------------------------------
  1531     05  LN9HDGL PIC S9(0004) COMP.
  1532     05  LN9HDGF PIC  X(0001).
  1533     05  FILLER REDEFINES LN9HDGF.
  1534         10  LN9HDGA PIC  X(0001).
  1535     05  LN9HDGI PIC  X(0010).
  1536*    -------------------------------
  1537     05  LN9TXTL PIC S9(0004) COMP.
  1538     05  LN9TXTF PIC  X(0001).
  1539     05  FILLER REDEFINES LN9TXTF.
  1540         10  LN9TXTA PIC  X(0001).
  1541     05  LN9TXTI PIC  X(0068).
  1542*    -------------------------------
  1543     05  LN10HDGL PIC S9(0004) COMP.
  1544     05  LN10HDGF PIC  X(0001).
  1545     05  FILLER REDEFINES LN10HDGF.
  1546         10  LN10HDGA PIC  X(0001).
  1547     05  LN10HDGI PIC  X(0010).
  1548*    -------------------------------
  1549     05  LN10TXTL PIC S9(0004) COMP.
  1550     05  LN10TXTF PIC  X(0001).
  1551     05  FILLER REDEFINES LN10TXTF.
  1552         10  LN10TXTA PIC  X(0001).
  1553     05  LN10TXTI PIC  X(0068).
  1554*    -------------------------------
  1555     05  LN11HDGL PIC S9(0004) COMP.
  1556     05  LN11HDGF PIC  X(0001).
  1557     05  FILLER REDEFINES LN11HDGF.
  1558         10  LN11HDGA PIC  X(0001).
  1559     05  LN11HDGI PIC  X(0010).
  1560*    -------------------------------
  1561     05  LN11TXTL PIC S9(0004) COMP.
  1562     05  LN11TXTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1502.cbl
  1563     05  FILLER REDEFINES LN11TXTF.
  1564         10  LN11TXTA PIC  X(0001).
  1565     05  LN11TXTI PIC  X(0068).
  1566*    -------------------------------
  1567     05  LN12HDGL PIC S9(0004) COMP.
  1568     05  LN12HDGF PIC  X(0001).
  1569     05  FILLER REDEFINES LN12HDGF.
  1570         10  LN12HDGA PIC  X(0001).
  1571     05  LN12HDGI PIC  X(0010).
  1572*    -------------------------------
  1573     05  LN12TXTL PIC S9(0004) COMP.
  1574     05  LN12TXTF PIC  X(0001).
  1575     05  FILLER REDEFINES LN12TXTF.
  1576         10  LN12TXTA PIC  X(0001).
  1577     05  LN12TXTI PIC  X(0068).
  1578*    -------------------------------
  1579     05  LN13HDGL PIC S9(0004) COMP.
  1580     05  LN13HDGF PIC  X(0001).
  1581     05  FILLER REDEFINES LN13HDGF.
  1582         10  LN13HDGA PIC  X(0001).
  1583     05  LN13HDGI PIC  X(0010).
  1584*    -------------------------------
  1585     05  LN13TXTL PIC S9(0004) COMP.
  1586     05  LN13TXTF PIC  X(0001).
  1587     05  FILLER REDEFINES LN13TXTF.
  1588         10  LN13TXTA PIC  X(0001).
  1589     05  LN13TXTI PIC  X(0068).
  1590*    -------------------------------
  1591     05  LN14HDGL PIC S9(0004) COMP.
  1592     05  LN14HDGF PIC  X(0001).
  1593     05  FILLER REDEFINES LN14HDGF.
  1594         10  LN14HDGA PIC  X(0001).
  1595     05  LN14HDGI PIC  X(0010).
  1596*    -------------------------------
  1597     05  LN14TXTL PIC S9(0004) COMP.
  1598     05  LN14TXTF PIC  X(0001).
  1599     05  FILLER REDEFINES LN14TXTF.
  1600         10  LN14TXTA PIC  X(0001).
  1601     05  LN14TXTI PIC  X(0068).
  1602*    -------------------------------
  1603     05  LN15HDGL PIC S9(0004) COMP.
  1604     05  LN15HDGF PIC  X(0001).
  1605     05  FILLER REDEFINES LN15HDGF.
  1606         10  LN15HDGA PIC  X(0001).
  1607     05  LN15HDGI PIC  X(0010).
  1608*    -------------------------------
  1609     05  LN15TXTL PIC S9(0004) COMP.
  1610     05  LN15TXTF PIC  X(0001).
  1611     05  FILLER REDEFINES LN15TXTF.
  1612         10  LN15TXTA PIC  X(0001).
  1613     05  LN15TXTI PIC  X(0068).
  1614*    -------------------------------
  1615     05  LN16HDGL PIC S9(0004) COMP.
  1616     05  LN16HDGF PIC  X(0001).
  1617     05  FILLER REDEFINES LN16HDGF.
  1618         10  LN16HDGA PIC  X(0001).
  1619     05  LN16HDGI PIC  X(0010).
  1620*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1502.cbl
  1621     05  LN16TXTL PIC S9(0004) COMP.
  1622     05  LN16TXTF PIC  X(0001).
  1623     05  FILLER REDEFINES LN16TXTF.
  1624         10  LN16TXTA PIC  X(0001).
  1625     05  LN16TXTI PIC  X(0068).
  1626*    -------------------------------
  1627     05  ERRMSG1L PIC S9(0004) COMP.
  1628     05  ERRMSG1F PIC  X(0001).
  1629     05  FILLER REDEFINES ERRMSG1F.
  1630         10  ERRMSG1A PIC  X(0001).
  1631     05  ERRMSG1I PIC  X(0079).
  1632*    -------------------------------
  1633     05  LINENOL PIC S9(0004) COMP.
  1634     05  LINENOF PIC  X(0001).
  1635     05  FILLER REDEFINES LINENOF.
  1636         10  LINENOA PIC  X(0001).
  1637     05  LINENOI PIC  X(0001).
  1638*    -------------------------------
  1639     05  RECVDTL PIC S9(0004) COMP.
  1640     05  RECVDTF PIC  X(0001).
  1641     05  FILLER REDEFINES RECVDTF.
  1642         10  RECVDTA PIC  X(0001).
  1643     05  RECVDTI PIC  X(0008).
  1644*    -------------------------------
  1645     05  RECVTYPL PIC S9(0004) COMP.
  1646     05  RECVTYPF PIC  X(0001).
  1647     05  FILLER REDEFINES RECVTYPF.
  1648         10  RECVTYPA PIC  X(0001).
  1649     05  RECVTYPI PIC  X(0001).
  1650*    -------------------------------
  1651     05  ENTERPFL PIC S9(0004) COMP.
  1652     05  ENTERPFF PIC  X(0001).
  1653     05  FILLER REDEFINES ENTERPFF.
  1654         10  ENTERPFA PIC  X(0001).
  1655     05  ENTERPFI PIC  99.
  1656*    -------------------------------
  1657     05  PF6L PIC S9(0004) COMP.
  1658     05  PF6F PIC  X(0001).
  1659     05  FILLER REDEFINES PF6F.
  1660         10  PF6A PIC  X(0001).
  1661     05  PF6I PIC  X(0016).
  1662 01  EL150CO REDEFINES EL150CI.
  1663     05  FILLER            PIC  X(0012).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  RUNDTEO PIC  X(0008).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  RUNTIMEO PIC  99.99.
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  CLMNOO PIC  X(0007).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  CARRO PIC  X(0001).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  PRIMEHDO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1502.cbl
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  PCERTNOO PIC  X(0010).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  SUFXO PIC  X(0001).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  LN1HDGO PIC  X(0010).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  LN1TXTO PIC  X(0068).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  LN2HDGO PIC  X(0010).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  LN2TXTO PIC  X(0068).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  LN3HDGO PIC  X(0010).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  LN3TXTO PIC  X(0068).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  LN4HDGO PIC  X(0010).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  LN4TXTO PIC  X(0068).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  LN5HDGO PIC  X(0010).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  LN5TXTO PIC  X(0068).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  LN6HDGO PIC  X(0010).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  LN6TXTO PIC  X(0068).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  LN7HDGO PIC  X(0010).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  LN7TXTO PIC  X(0068).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  LN8HDGO PIC  X(0010).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  LN8TXTO PIC  X(0068).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  LN9HDGO PIC  X(0010).
  1736*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1502.cbl
  1737     05  FILLER            PIC  X(0003).
  1738     05  LN9TXTO PIC  X(0068).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  LN10HDGO PIC  X(0010).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  LN10TXTO PIC  X(0068).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  LN11HDGO PIC  X(0010).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  LN11TXTO PIC  X(0068).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  LN12HDGO PIC  X(0010).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  LN12TXTO PIC  X(0068).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  LN13HDGO PIC  X(0010).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  LN13TXTO PIC  X(0068).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  LN14HDGO PIC  X(0010).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  LN14TXTO PIC  X(0068).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  LN15HDGO PIC  X(0010).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  LN15TXTO PIC  X(0068).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  LN16HDGO PIC  X(0010).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  LN16TXTO PIC  X(0068).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  ERRMSG1O PIC  X(0079).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  LINENOO PIC  X(0001).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  RECVDTO PIC  X(0008).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  RECVTYPO PIC  X(0001).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1502.cbl
  1795     05  ENTERPFO PIC  X(0002).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  PF6O PIC  X(0016).
  1799*    -------------------------------
  1800 01  EL150CI-R REDEFINES EL150CI.
  1801     12  FILLER                      PIC X(77).
  1802     12  EL150CI-OCCURS OCCURS 16.
  1803         16  MAP-HDG-LENGTH          PIC S9(4)   COMP.
  1804         16  MAP-HDG-ATTRB           PIC X.
  1805         16  MAP-HDG.
  1806             20  MAP-LINE-NO         PIC X.
  1807             20  FILLER              PIC X.
  1808             20  MAP-HDG-LIT         PIC X(8).
  1809         16  MAP-TEXT-LENGTH         PIC S9(4)   COMP.
  1810         16  MAP-TEXT-ATTRB          PIC X.
  1811         16  MAP-TEXT                PIC X(68).
  1812     12  FILLER                      PIC X(144).
  1813
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1502.cbl
  1815****************************************************************
  1816*
  1817* Copyright (c) 2007 by Clerity Solutions, Inc.
  1818* All rights reserved.
  1819*
  1820****************************************************************
  1821 01  DFHEIV.
  1822   02  DFHEIV0               PIC X(35).
  1823   02  DFHEIV1               PIC X(08).
  1824   02  DFHEIV2               PIC X(08).
  1825   02  DFHEIV3               PIC X(08).
  1826   02  DFHEIV4               PIC X(06).
  1827   02  DFHEIV5               PIC X(04).
  1828   02  DFHEIV6               PIC X(04).
  1829   02  DFHEIV7               PIC X(02).
  1830   02  DFHEIV8               PIC X(02).
  1831   02  DFHEIV9               PIC X(01).
  1832   02  DFHEIV10              PIC S9(7) COMP-3.
  1833   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1834   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1835   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1836   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1837   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1838   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1839   02  DFHEIV17              PIC X(04).
  1840   02  DFHEIV18              PIC X(04).
  1841   02  DFHEIV19              PIC X(04).
  1842   02  DFHEIV20              USAGE IS POINTER.
  1843   02  DFHEIV21              USAGE IS POINTER.
  1844   02  DFHEIV22              USAGE IS POINTER.
  1845   02  DFHEIV23              USAGE IS POINTER.
  1846   02  DFHEIV24              USAGE IS POINTER.
  1847   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1848   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1849   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1850   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1851   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1852   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1853   02  FILLER                PIC X(02).
  1854   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1855   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1856   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1857   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1858   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1859 LINKAGE  SECTION.
  1860*****************************************************************
  1861*                                                               *
  1862* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1863* All rights reserved.                                          *
  1864*                                                               *
  1865*****************************************************************
  1866 01  dfheiblk.
  1867     02  eibtime          pic s9(7) comp-3.
  1868     02  eibdate          pic s9(7) comp-3.
  1869     02  eibtrnid         pic x(4).
  1870     02  eibtaskn         pic s9(7) comp-3.
  1871     02  eibtrmid         pic x(4).
  1872     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1502.cbl
  1873     02  eibcposn         pic s9(4) comp.
  1874     02  eibcalen         pic s9(4) comp.
  1875     02  eibaid           pic x(1).
  1876     02  eibfiller1       pic x(1).
  1877     02  eibfn            pic x(2).
  1878     02  eibfiller2       pic x(2).
  1879     02  eibrcode         pic x(6).
  1880     02  eibfiller3       pic x(2).
  1881     02  eibds            pic x(8).
  1882     02  eibreqid         pic x(8).
  1883     02  eibrsrce         pic x(8).
  1884     02  eibsync          pic x(1).
  1885     02  eibfree          pic x(1).
  1886     02  eibrecv          pic x(1).
  1887     02  eibsend          pic x(1).
  1888     02  eibatt           pic x(1).
  1889     02  eibeoc           pic x(1).
  1890     02  eibfmh           pic x(1).
  1891     02  eibcompl         pic x(1).
  1892     02  eibsig           pic x(1).
  1893     02  eibconf          pic x(1).
  1894     02  eiberr           pic x(1).
  1895     02  eibrldbk         pic x(1).
  1896     02  eiberrcd         pic x(4).
  1897     02  eibsynrb         pic x(1).
  1898     02  eibnodat         pic x(1).
  1899     02  eibfiller5       pic x(2).
  1900     02  eibresp          pic 9(09) comp.
  1901     02  eibresp2         pic 9(09) comp.
  1902     02  dfheigdj         pic s9(4) comp.
  1903     02  dfheigdk         pic s9(4) comp.
  1904 01  DFHCOMMAREA                     PIC X(1024).
  1905
  1906*                                    COPY ELCMSTR.
  1907******************************************************************
  1908*                                                                *
  1909*                            ELCMSTR.                            *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.012                          *
  1912*                                                                *
  1913*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1914*                                                                *
  1915*   FILE TYPE = VSAM,KSDS                                        *
  1916*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1917*                                                                *
  1918*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1919*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1920*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1921*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1922*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1923*                                                 RKP=75,LEN=21  *
  1924*                                                                *
  1925*   **** NOTE ****                                               *
  1926*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1927*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1928*                                                                *
  1929*   LOG = YES                                                    *
  1930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1502.cbl
  1931******************************************************************
  1932*                   C H A N G E   L O G
  1933*
  1934* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1935*-----------------------------------------------------------------
  1936*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1937* EFFECTIVE    NUMBER
  1938*-----------------------------------------------------------------
  1939* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1940* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1941******************************************************************
  1942 01  CLAIM-MASTER.
  1943     12  CL-RECORD-ID                PIC XX.
  1944         88  VALID-CL-ID         VALUE 'CL'.
  1945
  1946     12  CL-CONTROL-PRIMARY.
  1947         16  CL-COMPANY-CD           PIC X.
  1948         16  CL-CARRIER              PIC X.
  1949         16  CL-CLAIM-NO             PIC X(7).
  1950         16  CL-CERT-NO.
  1951             20  CL-CERT-PRIME       PIC X(10).
  1952             20  CL-CERT-SFX         PIC X.
  1953
  1954     12  CL-CONTROL-BY-NAME.
  1955         16  CL-COMPANY-CD-A1        PIC X.
  1956         16  CL-INSURED-LAST-NAME    PIC X(15).
  1957         16  CL-INSURED-NAME.
  1958             20  CL-INSURED-1ST-NAME PIC X(12).
  1959             20  CL-INSURED-MID-INIT PIC X.
  1960
  1961     12  CL-CONTROL-BY-SSN.
  1962         16  CL-COMPANY-CD-A2        PIC X.
  1963         16  CL-SOC-SEC-NO.
  1964             20  CL-SSN-STATE        PIC XX.
  1965             20  CL-SSN-ACCOUNT      PIC X(6).
  1966             20  CL-SSN-LN3          PIC X(3).
  1967
  1968     12  CL-CONTROL-BY-CERT-NO.
  1969         16  CL-COMPANY-CD-A4        PIC X.
  1970         16  CL-CERT-NO-A4.
  1971             20  CL-CERT-A4-PRIME    PIC X(10).
  1972             20  CL-CERT-A4-SFX      PIC X.
  1973
  1974     12  CL-CONTROL-BY-CCN.
  1975         16  CL-COMPANY-CD-A5        PIC X.
  1976         16  CL-CCN-A5.
  1977             20  CL-CCN.
  1978                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1979                 24  CL-CCN-PRIME-A5 PIC X(12).
  1980             20  CL-CCN-FILLER-A5    PIC X(4).
  1981
  1982     12  CL-INSURED-PROFILE-DATA.
  1983         16  CL-INSURED-BIRTH-DT     PIC XX.
  1984         16  CL-INSURED-SEX-CD       PIC X.
  1985             88  INSURED-IS-MALE        VALUE 'M'.
  1986             88  INSURED-IS-FEMALE      VALUE 'F'.
  1987             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1988         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1502.cbl
  1989         16  FILLER                  PIC X(5).
  1990
  1991     12  CL-PROCESSING-INFO.
  1992         16  CL-PROCESSOR-ID         PIC X(4).
  1993         16  CL-CLAIM-STATUS         PIC X.
  1994             88  CLAIM-IS-OPEN          VALUE 'O'.
  1995             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1996         16  CL-CLAIM-TYPE           PIC X.
  1997*            88  AH-CLAIM               VALUE 'A'.
  1998*            88  LIFE-CLAIM             VALUE 'L'.
  1999*            88  PROPERTY-CLAIM         VALUE 'P'.
  2000*            88  IUI-CLAIM              VALUE 'I'.
  2001*            88  GAP-CLAIM              VALUE 'G'.
  2002         16  CL-CLAIM-PREM-TYPE      PIC X.
  2003             88  SINGLE-PREMIUM         VALUE '1'.
  2004             88  O-B-COVERAGE           VALUE '2'.
  2005             88  OPEN-END-COVERAGE      VALUE '3'.
  2006         16  CL-INCURRED-DT          PIC XX.
  2007         16  CL-REPORTED-DT          PIC XX.
  2008         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2009         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2010         16  CL-LAST-PMT-DT          PIC XX.
  2011         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2012         16  CL-PAID-THRU-DT         PIC XX.
  2013         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2014         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2015         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2016         16  CL-PMT-CALC-METHOD      PIC X.
  2017             88  CL-360-DAY-YR          VALUE '1'.
  2018             88  CL-365-DAY-YR          VALUE '2'.
  2019             88  CL-FULL-MONTHS         VALUE '3'.
  2020         16  CL-CAUSE-CD             PIC X(6).
  2021
  2022         16  CL-PRIME-CERT-NO.
  2023             20  CL-PRIME-CERT-PRIME PIC X(10).
  2024             20  CL-PRIME-CERT-SFX   PIC X.
  2025
  2026         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2027             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2028             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2029
  2030         16  CL-MICROFILM-NO         PIC X(10).
  2031         16  CL-PROG-FORM-TYPE       PIC X.
  2032         16  CL-LAST-ADD-ON-DT       PIC XX.
  2033
  2034         16  CL-LAST-REOPEN-DT       PIC XX.
  2035         16  CL-LAST-CLOSE-DT        PIC XX.
  2036         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2037             88  FINAL-PAID             VALUE '1'.
  2038             88  CLAIM-DENIED           VALUE '2'.
  2039             88  AUTO-CLOSE             VALUE '3'.
  2040             88  MANUAL-CLOSE           VALUE '4'.
  2041             88  BENEFITS-CHANGED       VALUE 'C'.
  2042             88  SETUP-ERRORS           VALUE 'E'.
  2043         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2044         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2045         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2046             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1502.cbl
  2047         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2048         16  FILLER                  PIC X.
  2049
  2050     12  CL-CERTIFICATE-DATA.
  2051         16  CL-CERT-ORIGIN          PIC X.
  2052             88  CERT-WAS-ONLINE        VALUE '1'.
  2053             88  CERT-WAS-CREATED       VALUE '2'.
  2054             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2055         16  CL-CERT-KEY-DATA.
  2056             20  CL-CERT-CARRIER     PIC X.
  2057             20  CL-CERT-GROUPING    PIC X(6).
  2058             20  CL-CERT-STATE       PIC XX.
  2059             20  CL-CERT-ACCOUNT.
  2060                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2061                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2062             20  CL-CERT-EFF-DT      PIC XX.
  2063
  2064     12  CL-STATUS-CONTROLS.
  2065         16  CL-PRIORITY-CD          PIC X.
  2066             88  CONFIDENTIAL-DATA      VALUE '8'.
  2067             88  HIGHEST-PRIORITY       VALUE '9'.
  2068         16  CL-SUPV-ATTN-CD         PIC X.
  2069             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2070             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2071         16  CL-PURGED-DT            PIC XX.
  2072         16  CL-RESTORED-DT          PIC XX.
  2073         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2074         16  CL-NEXT-RESEND-DT       PIC XX.
  2075         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2076         16  FILLER                  PIC XX.
  2077         16  CL-LAST-MAINT-DT        PIC XX.
  2078         16  CL-LAST-MAINT-USER      PIC X(4).
  2079         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  2080         16  CL-LAST-MAINT-TYPE      PIC X.
  2081             88  CLAIM-SET-UP           VALUE ' '.
  2082             88  PAYMENT-MADE           VALUE '1'.
  2083             88  LETTER-SENT            VALUE '2'.
  2084             88  MASTER-WAS-ALTERED     VALUE '3'.
  2085             88  MASTER-WAS-RESTORED    VALUE '4'.
  2086             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2087             88  FILE-CONVERTED         VALUE '6'.
  2088             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2089             88  ERROR-CORRECTION       VALUE 'E'.
  2090         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2091         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2092         16  CL-BENEFICIARY          PIC X(10).
  2093         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2094         16  CL-DENIAL-TYPE          PIC X.
  2095             88  CL-TYPE-DENIAL          VALUE '1'.
  2096             88  CL-TYPE-RESCISSION      VALUE '2'.
  2097             88  CL-TYPE-REFORMATION     VALUE '3'.
  2098             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2099             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2100         16  FILLER                  PIC X(5).
  2101
  2102     12  CL-TRAILER-CONTROLS.
  2103         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2104             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1502.cbl
  2105             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2106             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2107         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2108         16  FILLER                  PIC XX.
  2109         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2110         16  CL-ADDRESS-TRAILER-CNT.
  2111             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2112                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2113             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2114                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2115             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2116                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2117             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2118                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  2119             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  2120                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  2121             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  2122                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  2123             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  2124                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  2125
  2126     12  CL-CV-REFERENCE-NO.
  2127         16  CL-CV-REFNO-PRIME       PIC X(18).
  2128         16  CL-CV-REFNO-SFX         PIC XX.
  2129
  2130     12  CL-FILE-LOCATION            PIC X(4).
  2131
  2132     12  CL-PROCESS-ERRORS.
  2133         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  2134             88  NO-FATAL-ERRORS        VALUE ZERO.
  2135         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  2136             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  2137
  2138     12  CL-PRODUCT-CD               PIC X.
  2139
  2140     12  CL-CURRENT-KEY-DATA.
  2141         16  CL-CURRENT-CARRIER      PIC X.
  2142         16  CL-CURRENT-GROUPING     PIC X(6).
  2143         16  CL-CURRENT-STATE        PIC XX.
  2144         16  CL-CURRENT-ACCOUNT      PIC X(10).
  2145
  2146     12  CL-ASSOCIATES               PIC X.
  2147         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  2148         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  2149         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  2150         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  2151
  2152     12  CL-ACTIVITY-CODE            PIC 99.
  2153     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  2154     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  2155
  2156     12  CL-LAPSE-REPORT-CODE        PIC 9.
  2157     12  CL-LAG-REPORT-CODE          PIC 9.
  2158     12  CL-LOAN-TYPE                PIC XX.
  2159     12  CL-LEGAL-STATE              PIC XX.
  2160
  2161*    12  FILLER                      PIC X(5).
  2162     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1502.cbl
  2163     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1502.cbl
  2165*                                    COPY ELCCNTL.
  2166******************************************************************
  2167*                                                                *
  2168*                                                                *
  2169*                            ELCCNTL.                            *
  2170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2171*                            VMOD=2.059                          *
  2172*                                                                *
  2173*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2174*                                                                *
  2175*   FILE TYPE = VSAM,KSDS                                        *
  2176*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2177*                                                                *
  2178*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2179*       ALTERNATE INDEX = NONE                                   *
  2180*                                                                *
  2181*   LOG = YES                                                    *
  2182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2183******************************************************************
  2184*                   C H A N G E   L O G
  2185*
  2186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2187*-----------------------------------------------------------------
  2188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2189* EFFECTIVE    NUMBER
  2190*-----------------------------------------------------------------
  2191* 082503                   PEMA  ADD BENEFIT GROUP
  2192* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2193* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2194* 092705    2005050300006  PEMA  ADD SPP LEASES
  2195* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2196* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2197* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2198* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2199* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2200******************************************************************
  2201*
  2202 01  CONTROL-FILE.
  2203     12  CF-RECORD-ID                       PIC XX.
  2204         88  VALID-CF-ID                        VALUE 'CF'.
  2205
  2206     12  CF-CONTROL-PRIMARY.
  2207         16  CF-COMPANY-ID                  PIC XXX.
  2208         16  CF-RECORD-TYPE                 PIC X.
  2209             88  CF-COMPANY-MASTER              VALUE '1'.
  2210             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2211             88  CF-STATE-MASTER                VALUE '3'.
  2212             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2213             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2214             88  CF-CARRIER-MASTER              VALUE '6'.
  2215             88  CF-MORTALITY-MASTER            VALUE '7'.
  2216             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2217             88  CF-TERMINAL-MASTER             VALUE '9'.
  2218             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2219             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2220             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2221             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2222             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1502.cbl
  2223             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2224             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2225             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2226             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2227         16  CF-ACCESS-CD-GENL              PIC X(4).
  2228         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2229             20  CF-PROCESSOR               PIC X(4).
  2230         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2231             20  CF-STATE-CODE              PIC XX.
  2232             20  FILLER                     PIC XX.
  2233         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2234             20  FILLER                     PIC XX.
  2235             20  CF-HI-BEN-IN-REC           PIC XX.
  2236         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2237             20  FILLER                     PIC XXX.
  2238             20  CF-CARRIER-CNTL            PIC X.
  2239         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2240             20  FILLER                     PIC XX.
  2241             20  CF-HI-TYPE-IN-REC          PIC 99.
  2242         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2243             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2244                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2245             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2246             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2247         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2248             20  FILLER                     PIC X.
  2249             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2250         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2251             20  FILLER                     PIC XX.
  2252             20  CF-MORTGAGE-PLAN           PIC XX.
  2253         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2254
  2255     12  CF-LAST-MAINT-DT                   PIC XX.
  2256     12  CF-LAST-MAINT-BY                   PIC X(4).
  2257     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2258
  2259     12  CF-RECORD-BODY                     PIC X(728).
  2260
  2261
  2262****************************************************************
  2263*             COMPANY MASTER RECORD                            *
  2264****************************************************************
  2265
  2266     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2267         16  CF-COMPANY-ADDRESS.
  2268             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2269             20  CF-CL-IN-CARE-OF           PIC X(30).
  2270             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2271             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2272             20  CF-CL-CITY-STATE           PIC X(30).
  2273             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2274             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2275         16  CF-COMPANY-CD                  PIC X.
  2276         16  CF-COMPANY-PASSWORD            PIC X(8).
  2277         16  CF-SECURITY-OPTION             PIC X.
  2278             88  ALL-SECURITY                   VALUE '1'.
  2279             88  COMPANY-VERIFY                 VALUE '2'.
  2280             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1502.cbl
  2281             88  NO-SECURITY                    VALUE '4'.
  2282             88  ALL-BUT-TERM                   VALUE '5'.
  2283         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2284             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2285         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2286             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2287         16  CF-INFORCE-LOCATION            PIC X.
  2288             88  CERTS-ARE-ONLINE               VALUE '1'.
  2289             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2290             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2291         16  CF-LOWER-CASE-LETTERS          PIC X.
  2292         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2293             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2294             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2295             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2296             88  CF-ACCNT-CNTL                  VALUE '3'.
  2297             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2298
  2299         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2300         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2301
  2302         16  CF-LGX-CREDIT-USER             PIC X.
  2303             88  CO-IS-NOT-USER                 VALUE 'N'.
  2304             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2305
  2306         16 CF-CREDIT-CALC-CODES.
  2307             20  CF-CR-REM-TERM-CALC PIC X.
  2308               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2309               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2310               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2311               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2312               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2313               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2314               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2315             20  CF-CR-R78-METHOD           PIC X.
  2316               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2317               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2318
  2319         16  CF-CLAIM-CONTROL-COUNTS.
  2320             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2321                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2322
  2323             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2324                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2325
  2326             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2327                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2328
  2329             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2330                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2331
  2332         16  CF-CURRENT-MONTH-END           PIC XX.
  2333
  2334         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2335             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2336             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2337             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2338             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1502.cbl
  2339                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2340                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2341             20  CF-CO-PREM-REJECT-SW       PIC X.
  2342                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2343                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2344             20  CF-CO-REF-REJECT-SW        PIC X.
  2345                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2346                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2347
  2348         16  CF-CO-REPORTING-DT             PIC XX.
  2349         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2350         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2351           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2352           88  CF-CO-MONTH-END                  VALUE '1'.
  2353
  2354         16  CF-LGX-CLAIM-USER              PIC X.
  2355             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2356             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2357
  2358         16  CF-CREDIT-EDIT-CONTROLS.
  2359             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2360             20  CF-MIN-AGE                 PIC 99.
  2361             20  CF-DEFAULT-AGE             PIC 99.
  2362             20  CF-MIN-TERM                PIC S999      COMP-3.
  2363             20  CF-MAX-TERM                PIC S999      COMP-3.
  2364             20  CF-DEFAULT-SEX             PIC X.
  2365             20  CF-JOINT-AGE-INPUT         PIC X.
  2366                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2367             20  CF-BIRTH-DATE-INPUT        PIC X.
  2368                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2369             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2370                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2371                 88  CF-ZERO-CARRIER            VALUE '1'.
  2372                 88  CF-ZERO-GROUPING           VALUE '2'.
  2373                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2374             20  CF-EDIT-SW                 PIC X.
  2375                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2376             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2377             20  CF-CR-PR-METHOD            PIC X.
  2378               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2379               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2380             20  FILLER                     PIC X.
  2381
  2382         16  CF-CREDIT-MISC-CONTROLS.
  2383             20  CF-REIN-TABLE-SW           PIC X.
  2384                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2385             20  CF-COMP-TABLE-SW           PIC X.
  2386                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2387             20  CF-EXPERIENCE-RETENTION-AGE
  2388                                            PIC S9        COMP-3.
  2389             20  CF-CONVERSION-DT           PIC XX.
  2390             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2391             20  CF-RUN-FREQUENCY-SW        PIC X.
  2392                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2393                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2394
  2395             20  CF-CR-CHECK-NO-CONTROL.
  2396                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1502.cbl
  2397                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2398                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2399                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2400                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2401                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2402
  2403                 24  CF-CR-CHECK-COUNT       REDEFINES
  2404                     CF-CR-CHECK-COUNTER      PIC X(4).
  2405
  2406                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2407                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2408
  2409                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2410                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2411                 24  CF-MAIL-PROCESSING       PIC X.
  2412                     88  MAIL-PROCESSING          VALUE 'Y'.
  2413
  2414         16  CF-MISC-SYSTEM-CONTROL.
  2415             20  CF-SYSTEM-C                 PIC X.
  2416                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2417             20  CF-SYSTEM-D                 PIC X.
  2418                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2419             20  CF-SOC-SEC-NO-SW            PIC X.
  2420                 88  SOC-SEC-NO-USED             VALUE '1'.
  2421             20  CF-MEMBER-NO-SW             PIC X.
  2422                 88  MEMBER-NO-USED              VALUE '1'.
  2423             20  CF-TAX-ID-NUMBER            PIC X(11).
  2424             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2425             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2426                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2427                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2428                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2429                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2430             20  CF-SYSTEM-E                 PIC X.
  2431                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2432
  2433         16  CF-LGX-LIFE-USER               PIC X.
  2434             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2435             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2436
  2437         16  CF-CR-MONTH-END-DT             PIC XX.
  2438
  2439         16  CF-FILE-MAINT-DATES.
  2440             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2441                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2442             20  CF-LAST-BATCH       REDEFINES
  2443                 CF-LAST-BATCH-NO               PIC X(4).
  2444             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2445             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2446             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2447             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2448             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2449             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2450             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2451             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2452             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2453             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2454
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1502.cbl
  2455         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2456         16  FILLER                         PIC X.
  2457
  2458         16  CF-ALT-MORT-CODE               PIC X(4).
  2459         16  CF-MEMBER-CAPTION              PIC X(10).
  2460
  2461         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2462             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2463             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2464             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2465             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2466             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2467
  2468         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2469
  2470         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2471         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2472         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2473         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2474
  2475         16  CF-AH-OVERRIDE-L1              PIC X.
  2476         16  CF-AH-OVERRIDE-L2              PIC XX.
  2477         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2478         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2479
  2480         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2481         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2482
  2483         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2484         16  CF-AR-LAST-EL860-DT            PIC XX.
  2485         16  CF-MP-MONTH-END-DT             PIC XX.
  2486
  2487         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2488         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2489             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2490
  2491         16  CF-AR-MONTH-END-DT             PIC XX.
  2492
  2493         16  CF-CRDTCRD-USER                PIC X.
  2494             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2495             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2496
  2497         16  CF-CC-MONTH-END-DT             PIC XX.
  2498
  2499         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2500
  2501         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2502             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2503             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2504             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2505         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2506         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2507         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2508         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2509             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2510             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2511         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2512         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL1502.cbl
  2513         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2514             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2515         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2516
  2517         16  CF-CL-ZIP-CODE.
  2518             20  CF-CL-ZIP-PRIME.
  2519                 24  CF-CL-ZIP-1ST          PIC X.
  2520                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2521                 24  FILLER                 PIC X(4).
  2522             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2523         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2524             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2525             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2526             20  FILLER                     PIC XXX.
  2527
  2528         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2529         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2530         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2531         16  CF-CO-OPTION-START-DATE        PIC XX.
  2532         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2533           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2534                                                      '3' '4'.
  2535           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2536           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2537           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2538           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2539           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2540           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2541
  2542         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2543
  2544         16  CF-PAYMENT-APPROVAL-LEVELS.
  2545             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2546             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2547             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2548             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2549             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2550             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2551
  2552         16  CF-END-USER-REPORTING-USER     PIC X.
  2553             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2554             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2555
  2556         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2557             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2558             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2559
  2560         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2561
  2562         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2563         16  FILLER                         PIC X.
  2564
  2565         16  CF-CREDIT-ARCHIVE-CNTL.
  2566             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2567             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2568             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2569
  2570         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL1502.cbl
  2571
  2572         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2573             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2574             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2575
  2576         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2577             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2578             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2579
  2580         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2581
  2582         16  CF-CO-ACH-ID-CODE              PIC  X.
  2583             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2584             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2585             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2586         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2587         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2588         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2589         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2590         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2591         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2592         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2593         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2594         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2595                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2596         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2597                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2598
  2599         16  CF-CO-OVER-SHORT.
  2600             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2601             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2602
  2603*         16  FILLER                         PIC X(102).
  2604         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2605             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2606             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2607
  2608         16  CF-AH-APPROVAL-DAYS.
  2609             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2610             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2611             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2612             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2613
  2614         16  FILLER                         PIC X(82).
  2615****************************************************************
  2616*             PROCESSOR/USER RECORD                            *
  2617****************************************************************
  2618
  2619     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2620         16  CF-PROCESSOR-NAME              PIC X(30).
  2621         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2622         16  CF-PROCESSOR-TITLE             PIC X(26).
  2623         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2624                 88  MESSAGE-YES                VALUE 'Y'.
  2625                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2626
  2627*****************************************************
  2628****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL1502.cbl
  2629****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2630****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2631****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2632*****************************************************
  2633
  2634         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2635             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2636             20  CF-APPLICATION-FORCE       PIC X.
  2637             20  CF-INDIVIDUAL-APP.
  2638                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2639                     28  CF-BROWSE-APP      PIC X.
  2640                     28  CF-UPDATE-APP      PIC X.
  2641
  2642         16  CF-CURRENT-TERM-ON             PIC X(4).
  2643         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2644             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2645             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2646             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2647             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2648             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2649             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2650             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2651         16  CF-PROCESSOR-CARRIER           PIC X.
  2652             88  NO-CARRIER-SECURITY            VALUE ' '.
  2653         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2654             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2655         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2656             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2657         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2658             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2659
  2660         16  CF-PROC-SYS-ACCESS-SW.
  2661             20  CF-PROC-CREDIT-CLAIMS-SW.
  2662                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2663                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2664                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2665                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2666             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2667                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2668                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2669             20  CF-PROC-LIFE-GNRLDGR-SW.
  2670                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2671                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2672                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2673                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2674             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2675                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2676                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2677         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2678             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2679             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2680         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2681
  2682         16  CF-APPROVAL-LEVEL                  PIC X.
  2683             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2684             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2685             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2686             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL1502.cbl
  2687
  2688         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2689
  2690         16  CF-LANGUAGE-TYPE                   PIC X.
  2691             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2692             88  CF-LANG-IS-FR                      VALUE 'F'.
  2693         16  FILLER                             PIC  X(240).
  2694
  2695****************************************************************
  2696*             PROCESSOR/REMINDERS RECORD                       *
  2697****************************************************************
  2698
  2699     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2700         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2701             20  CF-START-REMIND-DT         PIC XX.
  2702             20  CF-END-REMIND-DT           PIC XX.
  2703             20  CF-REMINDER-TEXT           PIC X(50).
  2704         16  FILLER                         PIC X(296).
  2705
  2706
  2707****************************************************************
  2708*             STATE MASTER RECORD                              *
  2709****************************************************************
  2710
  2711     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2712         16  CF-STATE-ABBREVIATION          PIC XX.
  2713         16  CF-STATE-NAME                  PIC X(25).
  2714         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2715         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2716             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2717             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2718             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2719             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2720                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2721                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2722             20  CF-ST-PREM-REJECT-SW       PIC X.
  2723                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2724                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2725             20  CF-ST-REF-REJECT-SW        PIC X.
  2726                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2727                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2728         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2729         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2730         16  CF-ST-REFUND-RULES.
  2731             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2732             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2733             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2734         16  CF-ST-FST-PMT-EXTENSION.
  2735             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2736             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2737                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2738                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2739                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2740                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2741         16  CF-ST-STATE-CALL.
  2742             20  CF-ST-CALL-UNEARNED        PIC X.
  2743             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2744             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL1502.cbl
  2745         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2746             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2747             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2748         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2749         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2750         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2751         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2752         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2753         16  FILLER                         PIC X.
  2754         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2755             20  CF-ST-BENEFIT-CD           PIC XX.
  2756             20  CF-ST-BENEFIT-KIND         PIC X.
  2757                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2758                 88  CF-ST-AH-KIND              VALUE 'A'.
  2759             20  CF-ST-REM-TERM-CALC        PIC X.
  2760                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2761                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2762                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2763                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2764                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2765                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2766                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2767                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2768
  2769             20  CF-ST-REFUND-CALC          PIC X.
  2770                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2771                 88  ST-REFD-BY-R78             VALUE '1'.
  2772                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2773                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2774                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2775                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2776                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2777                 88  ST-REFD-UTAH               VALUE '7'.
  2778                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2779                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2780                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2781
  2782             20  CF-ST-EARNING-CALC         PIC X.
  2783                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2784                 88  ST-EARN-BY-R78             VALUE '1'.
  2785                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2786                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2787                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2788                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2789                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2790                 88  ST-EARN-MEAN               VALUE '8'.
  2791                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2792
  2793             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2794                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2795                 88  ST-OVRD-BY-R78             VALUE '1'.
  2796                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2797                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2798                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2799                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2800                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2801                 88  ST-OVRD-MEAN               VALUE '8'.
  2802                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL1502.cbl
  2803             20  FILLER                     PIC X.
  2804
  2805         16  CF-ST-COMMISSION-CAPS.
  2806             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2807             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2808             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2809             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2810         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2811                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2812
  2813         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2814
  2815         16  CF-ST-STATUTORY-INTEREST.
  2816             20  CF-ST-STAT-DATE-FROM       PIC X.
  2817                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2818                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2819             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2820             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2821             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2822             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2823             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2824
  2825         16  CF-ST-OVER-SHORT.
  2826             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2827             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2828
  2829         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2830
  2831         16  CF-ST-RT-CALC                  PIC X.
  2832
  2833         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2834         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2835         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2836         16  CF-ST-RF-LR-CALC               PIC X.
  2837         16  CF-ST-RF-LL-CALC               PIC X.
  2838         16  CF-ST-RF-LN-CALC               PIC X.
  2839         16  CF-ST-RF-AH-CALC               PIC X.
  2840         16  CF-ST-RF-CP-CALC               PIC X.
  2841*        16  FILLER                         PIC X(206).
  2842*CIDMOD         16  FILLER                         PIC X(192).
  2843         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2844             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2845         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2846         16  CF-ST-VFY-2ND-BENE             PIC X.
  2847         16  FILLER                         PIC X(186).
  2848
  2849****************************************************************
  2850*             BENEFIT MASTER RECORD                            *
  2851****************************************************************
  2852
  2853     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2854         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2855             20  CF-BENEFIT-CODE            PIC XX.
  2856             20  CF-BENEFIT-NUMERIC  REDEFINES
  2857                 CF-BENEFIT-CODE            PIC XX.
  2858             20  CF-BENEFIT-ALPHA           PIC XXX.
  2859             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2860             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL1502.cbl
  2861
  2862             20  CF-LF-COVERAGE-TYPE        PIC X.
  2863                 88  CF-REDUCING                VALUE 'R'.
  2864                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2865
  2866             20  CF-SPECIAL-CALC-CD         PIC X.
  2867                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2868                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2869                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2870                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2871                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2872                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2873                 88  CF-FARM-PLAN               VALUE 'F'.
  2874                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2875                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2876                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2877                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2878                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2879                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2880                 88  CF-PRUDENTIAL              VALUE 'P'.
  2881                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2882                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2883                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2884                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2885                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2886                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2887
  2888             20  CF-JOINT-INDICATOR         PIC X.
  2889                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2890
  2891*            20  FILLER                     PIC X(12).
  2892             20  FILLER                     PIC X(11).
  2893             20  CF-BENEFIT-CATEGORY        PIC X.
  2894             20  CF-LOAN-TYPE               PIC X(8).
  2895
  2896             20  CF-CO-REM-TERM-CALC        PIC X.
  2897                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2898                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2899                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2900                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2901                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2902
  2903             20  CF-CO-EARNINGS-CALC        PIC X.
  2904                 88  CO-EARN-BY-R78             VALUE '1'.
  2905                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2906                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2907                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2908                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2909                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2910                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2911                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2912
  2913             20  CF-CO-REFUND-CALC          PIC X.
  2914                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2915                 88  CO-REFD-BY-R78             VALUE '1'.
  2916                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2917                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2918                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL1502.cbl
  2919                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2920                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2921                 88  CO-REFD-MEAN               VALUE '8'.
  2922                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2923                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2924                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2925
  2926             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2927                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2928                 88  CO-OVRD-BY-R78             VALUE '1'.
  2929                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2930                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2931                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2932                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2933                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2934                 88  CO-OVRD-MEAN               VALUE '8'.
  2935                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2936
  2937             20  CF-CO-BEN-I-G-CD           PIC X.
  2938                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2939                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2940                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2941
  2942         16  FILLER                         PIC X(304).
  2943
  2944
  2945****************************************************************
  2946*             CARRIER MASTER RECORD                            *
  2947****************************************************************
  2948
  2949     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2950         16  CF-ADDRESS-DATA.
  2951             20  CF-MAIL-TO-NAME            PIC X(30).
  2952             20  CF-IN-CARE-OF              PIC X(30).
  2953             20  CF-ADDRESS-LINE-1          PIC X(30).
  2954             20  CF-ADDRESS-LINE-2          PIC X(30).
  2955             20  CF-CITY-STATE              PIC X(30).
  2956             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2957             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2958
  2959         16  CF-CLAIM-NO-CONTROL.
  2960             20  CF-CLAIM-NO-METHOD         PIC X.
  2961                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2962                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2963                 88  CLAIM-NO-SEQ               VALUE '3'.
  2964                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2965             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2966                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2967                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2968                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2969
  2970         16  CF-CHECK-NO-CONTROL.
  2971             20  CF-CHECK-NO-METHOD         PIC X.
  2972                 88  CHECK-NO-MANUAL            VALUE '1'.
  2973                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2974                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2975                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2976             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL1502.cbl
  2977                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2978
  2979         16  CF-DOMICILE-STATE              PIC XX.
  2980
  2981         16  CF-EXPENSE-CONTROLS.
  2982             20  CF-EXPENSE-METHOD          PIC X.
  2983                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2984                 88  DOLLARS-PER-PMT            VALUE '2'.
  2985                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2986                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2987             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2988             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2989
  2990         16  CF-CORRESPONDENCE-CONTROL.
  2991             20  CF-LETTER-RESEND-OPT       PIC X.
  2992                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2993                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2994             20  FILLER                     PIC X(4).
  2995
  2996         16  CF-RESERVE-CONTROLS.
  2997             20  CF-MANUAL-SW               PIC X.
  2998                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2999             20  CF-FUTURE-SW               PIC X.
  3000                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3001             20  CF-PTC-SW                  PIC X.
  3002                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3003             20  CF-IBNR-SW                 PIC X.
  3004                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3005             20  CF-PTC-LF-SW               PIC X.
  3006                 88  CF-LF-PTC-USED             VALUE '1'.
  3007             20  CF-CDT-ACCESS-METHOD       PIC X.
  3008                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3009                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3010                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3011             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3012
  3013         16  CF-CLAIM-CALC-METHOD           PIC X.
  3014             88  360-PLUS-MONTHS                VALUE '1'.
  3015             88  365-PLUS-MONTHS                VALUE '2'.
  3016             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3017             88  360-DAILY                      VALUE '4'.
  3018             88  365-DAILY                      VALUE '5'.
  3019
  3020         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3021         16  FILLER                         PIC X(11).
  3022
  3023         16  CF-LIMIT-AMOUNTS.
  3024             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3025             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3026             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3027             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3028             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3029             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3030             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3031             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3032             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3033             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3034
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL1502.cbl
  3035         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3036         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3037         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3038
  3039         16  CF-ZIP-CODE.
  3040             20  CF-ZIP-PRIME.
  3041                 24  CF-ZIP-1ST             PIC X.
  3042                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3043                 24  FILLER                 PIC X(4).
  3044             20  CF-ZIP-PLUS4               PIC X(4).
  3045         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3046             20  CF-CAN-POSTAL-1            PIC XXX.
  3047             20  CF-CAN-POSTAL-2            PIC XXX.
  3048             20  FILLER                     PIC XXX.
  3049
  3050         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3051         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3052         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3053
  3054         16  CF-RATING-SWITCH               PIC X.
  3055             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3056             88  CF-NO-RATING                   VALUE 'N'.
  3057
  3058         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3059
  3060         16  CF-CARRIER-OVER-SHORT.
  3061             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3062             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3063
  3064         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3065         16  CF-SECPAY-SWITCH               PIC X.
  3066             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3067             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3068         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3069         16  FILLER                         PIC X(448).
  3070*        16  FILLER                         PIC X(452).
  3071
  3072
  3073****************************************************************
  3074*             MORTALITY MASTER RECORD                          *
  3075****************************************************************
  3076
  3077     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3078         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3079                                INDEXED BY CF-MORT-NDX.
  3080             20  CF-MORT-TABLE              PIC X(5).
  3081             20  CF-MORT-TABLE-TYPE         PIC X.
  3082                 88  CF-MORT-JOINT              VALUE 'J'.
  3083                 88  CF-MORT-SINGLE             VALUE 'S'.
  3084                 88  CF-MORT-COMBINED           VALUE 'C'.
  3085                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3086                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3087             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3088             20  CF-MORT-AGE-METHOD         PIC XX.
  3089                 88  CF-AGE-LAST                VALUE 'AL'.
  3090                 88  CF-AGE-NEAR                VALUE 'AN'.
  3091             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3092             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL1502.cbl
  3093                                            PIC X.
  3094                 88  CF-MINUS                   VALUE '-'.
  3095                 88  CF-PLUS                    VALUE '+'.
  3096             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3097             20  CF-MORT-JOINT-CODE         PIC X.
  3098                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3099             20  CF-MORT-PC-Q               PIC X.
  3100                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3101             20  CF-MORT-TABLE-CODE         PIC X(4).
  3102             20  CF-MORT-COMMENTS           PIC X(15).
  3103             20  FILLER                     PIC X(14).
  3104
  3105         16  FILLER                         PIC X(251).
  3106
  3107
  3108****************************************************************
  3109*             BUSSINESS TYPE MASTER RECORD                     *
  3110****************************************************************
  3111
  3112     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3113* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3114* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3115* AND RECORD 05 IS TYPES 81-99
  3116         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3117             20  CF-BUSINESS-TITLE          PIC  X(19).
  3118             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3119                                            PIC S9V9(4) COMP-3.
  3120             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3121             20  FILLER                     PIC  X.
  3122         16  FILLER                         PIC  X(248).
  3123
  3124
  3125****************************************************************
  3126*             TERMINAL MASTER RECORD                           *
  3127****************************************************************
  3128
  3129     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3130
  3131         16  CF-COMPANY-TERMINALS.
  3132             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3133                                  PIC X(4).
  3134         16  FILLER               PIC X(248).
  3135
  3136
  3137****************************************************************
  3138*             LIFE EDIT MASTER RECORD                          *
  3139****************************************************************
  3140
  3141     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3142         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3143             20  CF-LIFE-CODE-IN            PIC XX.
  3144             20  CF-LIFE-CODE-OUT           PIC XX.
  3145         16  FILLER                         PIC X(248).
  3146
  3147
  3148****************************************************************
  3149*             AH EDIT MASTER RECORD                            *
  3150****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL1502.cbl
  3151
  3152     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3153         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3154             20  CF-AH-CODE-IN              PIC XXX.
  3155             20  CF-AH-CODE-OUT             PIC XX.
  3156         16  FILLER                         PIC X(248).
  3157
  3158
  3159****************************************************************
  3160*             CREDIBILITY TABLES                               *
  3161****************************************************************
  3162
  3163     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3164         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3165                             INDEXED BY CF-CRDB-NDX.
  3166             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3167             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3168             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3169         16  FILLER                         PIC  X(332).
  3170
  3171
  3172****************************************************************
  3173*             REPORT CUSTOMIZATION RECORD                      *
  3174****************************************************************
  3175
  3176     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3177         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3178             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3179             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3180             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3181**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3182****       A T-TRANSFER.                                   ****
  3183             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3184
  3185         16  FILLER                         PIC XX.
  3186
  3187         16  CF-CARRIER-CNTL-OPT.
  3188             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3189                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3190                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3191             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3192                                            PIC X.
  3193         16  CF-GROUP-CNTL-OPT.
  3194             20  CF-GROUP-OPT-SEQ           PIC 9.
  3195                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3196                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3197             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3198                                            PIC X(6).
  3199         16  CF-STATE-CNTL-OPT.
  3200             20  CF-STATE-OPT-SEQ           PIC 9.
  3201                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3202                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3203             20  CF-STATE-SELECT OCCURS 3 TIMES
  3204                                            PIC XX.
  3205         16  CF-ACCOUNT-CNTL-OPT.
  3206             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3207                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3208                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL1502.cbl
  3209             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3210                                            PIC X(10).
  3211         16  CF-BUS-TYP-CNTL-OPT.
  3212             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3213                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3214                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3215             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3216                                            PIC XX.
  3217         16  CF-LF-TYP-CNTL-OPT.
  3218             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3219                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3220                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3221             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3222                                            PIC XX.
  3223         16  CF-AH-TYP-CNTL-OPT.
  3224             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3225                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3226                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3227             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3228                                            PIC XX.
  3229         16  CF-REPTCD1-CNTL-OPT.
  3230             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3231                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3232                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3233             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3234                                            PIC X(10).
  3235         16  CF-REPTCD2-CNTL-OPT.
  3236             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3237                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3238                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3239             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3240                                            PIC X(10).
  3241         16  CF-USER1-CNTL-OPT.
  3242             20  CF-USER1-OPT-SEQ           PIC 9.
  3243                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3244                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3245             20  CF-USER1-SELECT OCCURS 3 TIMES
  3246                                            PIC X(10).
  3247         16  CF-USER2-CNTL-OPT.
  3248             20  CF-USER2-OPT-SEQ           PIC 9.
  3249                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3250                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3251             20  CF-USER2-SELECT OCCURS 3 TIMES
  3252                                            PIC X(10).
  3253         16  CF-USER3-CNTL-OPT.
  3254             20  CF-USER3-OPT-SEQ           PIC 9.
  3255                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3256                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3257             20  CF-USER3-SELECT OCCURS 3 TIMES
  3258                                            PIC X(10).
  3259         16  CF-USER4-CNTL-OPT.
  3260             20  CF-USER4-OPT-SEQ           PIC 9.
  3261                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3262                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3263             20  CF-USER4-SELECT OCCURS 3 TIMES
  3264                                            PIC X(10).
  3265         16  CF-USER5-CNTL-OPT.
  3266             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL1502.cbl
  3267                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3268                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3269             20  CF-USER5-SELECT OCCURS 3 TIMES
  3270                                            PIC X(10).
  3271         16  CF-REINS-CNTL-OPT.
  3272             20  CF-REINS-OPT-SEQ           PIC 9.
  3273                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3274                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3275             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3276                 24  CF-REINS-PRIME         PIC XXX.
  3277                 24  CF-REINS-SUB           PIC XXX.
  3278
  3279         16  CF-AGENT-CNTL-OPT.
  3280             20  CF-AGENT-OPT-SEQ           PIC 9.
  3281                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3282                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3283             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3284                                            PIC X(10).
  3285
  3286         16  FILLER                         PIC X(43).
  3287
  3288         16  CF-LOSS-RATIO-SELECT.
  3289             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3290             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3291         16  CF-ENTRY-DATE-SELECT.
  3292             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3293             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3294         16  CF-EFFECTIVE-DATE-SELECT.
  3295             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3296             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3297
  3298         16  CF-EXCEPTION-LIST-IND          PIC X.
  3299             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3300
  3301         16  FILLER                         PIC X(318).
  3302
  3303****************************************************************
  3304*                  EXCEPTION REPORTING RECORD                  *
  3305****************************************************************
  3306
  3307     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3308         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3309             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3310
  3311         16  CF-COMBINED-LIFE-AH-OPT.
  3312             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3313             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3314             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3315             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3316
  3317         16  CF-LIFE-OPT.
  3318             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3319             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3320             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3321             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3322             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3323             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3324             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL1502.cbl
  3325             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3326             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3327             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3328
  3329         16  CF-AH-OPT.
  3330             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3331             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3332             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3333             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3334             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3335             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3336             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3337             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3338             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3339             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3340
  3341         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3342             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3343             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3344             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3345
  3346         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3347
  3348         16  FILLER                         PIC X(673).
  3349
  3350
  3351****************************************************************
  3352*             MORTGAGE SYSTEM PLAN RECORD                      *
  3353****************************************************************
  3354
  3355     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3356         16  CF-PLAN-TYPE                   PIC X.
  3357             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3358             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3359             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3360         16  CF-PLAN-ABBREV                 PIC XXX.
  3361         16  CF-PLAN-DESCRIPT               PIC X(10).
  3362         16  CF-PLAN-NOTES                  PIC X(20).
  3363         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3364         16  CF-PLAN-UNDERWRITING.
  3365             20  CF-PLAN-TERM-DATA.
  3366                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3367                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3368             20  CF-PLAN-AGE-DATA.
  3369                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3370                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3371                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3372             20  CF-PLAN-BENEFIT-DATA.
  3373                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3374                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3375                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3376                                            PIC S9(7)V99  COMP-3.
  3377         16  CF-PLAN-POLICY-FORMS.
  3378             20  CF-POLICY-FORM             PIC X(12).
  3379             20  CF-MASTER-APPLICATION      PIC X(12).
  3380             20  CF-MASTER-POLICY           PIC X(12).
  3381         16  CF-PLAN-RATING.
  3382             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL1502.cbl
  3383             20  CF-SEX-RATING              PIC X.
  3384                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3385                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3386             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3387             20  CF-SUB-STD-TYPE            PIC X.
  3388                 88  CF-PCT-OF-PREM            VALUE '1'.
  3389                 88  CF-PCT-OF-BENE            VALUE '2'.
  3390         16  CF-PLAN-PREM-TOLERANCES.
  3391             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3392             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3393         16  CF-PLAN-PYMT-TOLERANCES.
  3394             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3395             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3396         16  CF-PLAN-MISC-DATA.
  3397             20  FILLER                     PIC X.
  3398             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3399             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3400         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3401         16  CF-PLAN-IND-GRP                PIC X.
  3402             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3403                                                     '1'.
  3404             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3405                                                     '2'.
  3406         16  CF-MIB-SEARCH-SW               PIC X.
  3407             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3408             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3409             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3410             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3411         16  CF-ALPHA-SEARCH-SW             PIC X.
  3412             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3413             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3414             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3415             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3416             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3417             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3418             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3419             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3420             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3421             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3422                                                     'A' 'B' 'C'
  3423                                                     'X' 'Y' 'Z'.
  3424         16  CF-EFF-DT-RULE-SW              PIC X.
  3425             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3426             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3427             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3428             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3429             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3430         16  FILLER                         PIC X(4).
  3431         16  CF-HEALTH-QUESTIONS            PIC X.
  3432             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3433         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3434         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3435         16  CF-PLAN-SNGL-JNT               PIC X.
  3436             88  CF-COMBINED-PLAN              VALUE 'C'.
  3437             88  CF-JNT-PLAN                   VALUE 'J'.
  3438             88  CF-SNGL-PLAN                  VALUE 'S'.
  3439         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3440         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL1502.cbl
  3441         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3442         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3443         16  CF-RERATE-CNTL                 PIC  X.
  3444             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3445             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3446             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3447             88  CF-AUTO-RECALC                 VALUE '4'.
  3448         16  CF-BENEFIT-TYPE                PIC  X.
  3449             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3450             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3451         16  CF-POLICY-FEE                  PIC S999V99
  3452                                                    COMP-3.
  3453         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3454         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3455         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3456         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3457         16  FILLER                         PIC  X(32).
  3458         16  CF-TERMINATION-FORM            PIC  X(04).
  3459         16  FILLER                         PIC  X(08).
  3460         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3461                                                       COMP-3.
  3462         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3463         16  CF-ISSUE-LETTER                PIC  X(4).
  3464         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3465         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3466             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3467             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3468         16  CF-MP-REFUND-CALC              PIC X.
  3469             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3470             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3471             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3472             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3473             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3474             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3475             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3476             88  CF-MP-REFD-MEAN                VALUE '8'.
  3477         16  CF-ALT-RATE-CODE               PIC  X(5).
  3478
  3479
  3480         16  FILLER                         PIC X(498).
  3481****************************************************************
  3482*             MORTGAGE COMPANY MASTER RECORD                   *
  3483****************************************************************
  3484
  3485     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3486         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3487         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3488             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3489             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3490             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3491             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3492             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3493
  3494         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3495         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3496         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3497         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3498         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL1502.cbl
  3499
  3500         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3501             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3502         16  CF-MP-RECON-USE-IND            PIC X(1).
  3503             88  CF-MP-USE-RECON             VALUE 'Y'.
  3504         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3505             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3506         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3507             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3508             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3509         16  FILLER                         PIC X(1).
  3510         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3511             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3512         16  CF-MORTG-MIB-VERSION           PIC X.
  3513             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3514             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3515             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3516         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3517             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3518                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3519             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3520                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3521             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3522                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3523             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3524                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3525             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3526                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3527             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3528                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3529         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3530         16  FILLER                         PIC X(7).
  3531         16  CF-MORTG-DESTINATION-SYMBOL.
  3532             20  CF-MORTG-MIB-COMM          PIC X(5).
  3533             20  CF-MORTG-MIB-TERM          PIC X(5).
  3534         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3535             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3536         16  FILLER                         PIC X(03).
  3537         16  CF-MP-CHECK-NO-CONTROL.
  3538             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3539                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3540                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3541                                                ' ' LOW-VALUES.
  3542                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3543                                               VALUE '3'.
  3544         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3545         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3546         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3547             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3548                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3549             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3550                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3551             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3552                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3553             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3554                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3555             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3556                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL1502.cbl
  3557             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3558                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3559         16  CF-MORTG-BILLING-AREA.
  3560             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3561                                            PIC X.
  3562         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3563         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3564         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3565         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3566             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3567             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3568         16  FILLER                         PIC X.
  3569         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3570             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3571             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3572         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3573         16  FILLER                         PIC X(8).
  3574         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3575         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3576         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3577         16  CF-ACH-COMPANY-ID.
  3578             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3579                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3580                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3581                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3582             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3583         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3584             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3585         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3586             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3587             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3588         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3589         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3590         16  FILLER                         PIC X(536).
  3591
  3592****************************************************************
  3593*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3594****************************************************************
  3595
  3596     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3597         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3598             20  CF-FEMALE-HEIGHT.
  3599                 24  CF-FEMALE-FT           PIC 99.
  3600                 24  CF-FEMALE-IN           PIC 99.
  3601             20  CF-FEMALE-MIN-WT           PIC 999.
  3602             20  CF-FEMALE-MAX-WT           PIC 999.
  3603         16  FILLER                         PIC X(428).
  3604
  3605     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3606         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3607             20  CF-MALE-HEIGHT.
  3608                 24  CF-MALE-FT             PIC 99.
  3609                 24  CF-MALE-IN             PIC 99.
  3610             20  CF-MALE-MIN-WT             PIC 999.
  3611             20  CF-MALE-MAX-WT             PIC 999.
  3612         16  FILLER                         PIC X(428).
  3613******************************************************************
  3614*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL1502.cbl
  3615******************************************************************
  3616     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3617         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3618             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3619             20  CF-SYS-LETTER-ID           PIC X(04).
  3620             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3621             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3622             20  CF-SYS-RESET-SW            PIC X(01).
  3623             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3624             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3625
  3626         16  FILLER                         PIC X(50).
  3627
  3628         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3629             20  CF-USER-ACTIVE-SW          PIC X(01).
  3630             20  CF-USER-LETTER-ID          PIC X(04).
  3631             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3632             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3633             20  CF-USER-RESET-SW           PIC X(01).
  3634             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3635             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3636             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3637
  3638         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL1502.cbl
  3640*                                    COPY ELCCERT.
  3641******************************************************************
  3642*                                                                *
  3643*                            ELCCERT.                            *
  3644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3645*                            VMOD=2.013                          *
  3646*                                                                *
  3647*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3648*                                                                *
  3649*   FILE TYPE = VSAM,KSDS                                        *
  3650*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3651*                                                                *
  3652*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3653*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3654*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3655*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3656*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3657*                                                                *
  3658*   LOG = YES                                                    *
  3659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3660******************************************************************
  3661*                   C H A N G E   L O G
  3662*
  3663* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3664*-----------------------------------------------------------------
  3665*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3666* EFFECTIVE    NUMBER
  3667*-----------------------------------------------------------------
  3668* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3669* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3670* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3671* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3672* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3673* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3674* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3675* 032612  CR2011110200001  PEMA  AHL CHANGES
  3676******************************************************************
  3677
  3678 01  CERTIFICATE-MASTER.
  3679     12  CM-RECORD-ID                      PIC XX.
  3680         88  VALID-CM-ID                      VALUE 'CM'.
  3681
  3682     12  CM-CONTROL-PRIMARY.
  3683         16  CM-COMPANY-CD                 PIC X.
  3684         16  CM-CARRIER                    PIC X.
  3685         16  CM-GROUPING.
  3686             20  CM-GROUPING-PREFIX        PIC X(3).
  3687             20  CM-GROUPING-PRIME         PIC X(3).
  3688         16  CM-STATE                      PIC XX.
  3689         16  CM-ACCOUNT.
  3690             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3691             20  CM-ACCOUNT-PRIME          PIC X(6).
  3692         16  CM-CERT-EFF-DT                PIC XX.
  3693         16  CM-CERT-NO.
  3694             20  CM-CERT-PRIME             PIC X(10).
  3695             20  CM-CERT-SFX               PIC X.
  3696
  3697     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL1502.cbl
  3698         16  CM-COMPANY-CD-A1              PIC X.
  3699         16  CM-INSURED-LAST-NAME          PIC X(15).
  3700         16  CM-INSURED-INITIALS.
  3701             20  CM-INSURED-INITIAL1       PIC X.
  3702             20  CM-INSURED-INITIAL2       PIC X.
  3703
  3704     12  CM-CONTROL-BY-SSN.
  3705         16  CM-COMPANY-CD-A2              PIC X.
  3706         16  CM-SOC-SEC-NO.
  3707             20  CM-SSN-STATE              PIC XX.
  3708             20  CM-SSN-ACCOUNT            PIC X(6).
  3709             20  CM-SSN-LN3.
  3710                 25  CM-INSURED-INITIALS-A2.
  3711                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3712                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3713                 25 CM-PART-LAST-NAME-A2         PIC X.
  3714
  3715     12  CM-CONTROL-BY-CERT-NO.
  3716         16  CM-COMPANY-CD-A4              PIC X.
  3717         16  CM-CERT-NO-A4                 PIC X(11).
  3718
  3719     12  CM-CONTROL-BY-MEMB.
  3720         16  CM-COMPANY-CD-A5              PIC X.
  3721         16  CM-MEMBER-NO.
  3722             20  CM-MEMB-STATE             PIC XX.
  3723             20  CM-MEMB-ACCOUNT           PIC X(6).
  3724             20  CM-MEMB-LN4.
  3725                 25  CM-INSURED-INITIALS-A5.
  3726                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3727                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3728                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3729
  3730     12  CM-INSURED-PROFILE-DATA.
  3731         16  CM-INSURED-FIRST-NAME.
  3732             20  CM-INSURED-1ST-INIT       PIC X.
  3733             20  FILLER                    PIC X(9).
  3734         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3735         16  CM-INSURED-SEX                PIC X.
  3736             88  CM-SEX-MALE                  VALUE 'M'.
  3737             88  CM-SEX-FEMAL                 VALUE 'F'.
  3738         16  CM-INSURED-JOINT-AGE          PIC 99.
  3739         16  CM-JOINT-INSURED-NAME.
  3740             20  CM-JT-LAST-NAME           PIC X(15).
  3741             20  CM-JT-FIRST-NAME.
  3742                 24  CM-JT-1ST-INIT        PIC X.
  3743                 24  FILLER                PIC X(9).
  3744             20  CM-JT-INITIAL             PIC X.
  3745
  3746     12  CM-LIFE-DATA.
  3747         16  CM-LF-BENEFIT-CD              PIC XX.
  3748         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3749         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3750         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3751         16  CM-LF-DEV-CODE                PIC XXX.
  3752         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3753         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3754         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3755         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL1502.cbl
  3756         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3757         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3758         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3759         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3760         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3761         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3762         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3763         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3764         16  FILLER                        PIC XX.
  3765
  3766     12  CM-AH-DATA.
  3767         16  CM-AH-BENEFIT-CD              PIC XX.
  3768         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3769         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3770         16  CM-AH-DEV-CODE                PIC XXX.
  3771         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3772         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3773         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3774         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3775         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3776         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3777         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3778         16  CM-AH-PAID-THRU-DT            PIC XX.
  3779             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3780         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3781         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3782         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3783         16  FILLER                        PIC X.
  3784
  3785     12  CM-LOAN-INFORMATION.
  3786         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3787         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3788                                           PIC S9(5)V99  COMP-3.
  3789         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3790         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3791         16  CM-PAY-FREQUENCY              PIC S99.
  3792         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3793         16  CM-RATE-CLASS                 PIC XX.
  3794         16  CM-BENEFICIARY                PIC X(25).
  3795         16  CM-POLICY-FORM-NO             PIC X(12).
  3796         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3797         16  CM-LAST-ADD-ON-DT             PIC XX.
  3798         16  CM-DEDUCTIBLE-AMOUNTS.
  3799             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3800             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3801         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3802             20  CM-RESIDENT-STATE         PIC XX.
  3803             20  CM-RATE-CODE              PIC X(4).
  3804             20  FILLER                    PIC XX.
  3805         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3806             20  CM-LOAN-OFFICER           PIC X(5).
  3807             20  FILLER                    PIC XXX.
  3808         16  CM-CSR-CODE                   PIC XXX.
  3809         16  CM-UNDERWRITING-CODE          PIC X.
  3810             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3811         16  CM-POST-CARD-IND              PIC X.
  3812         16  CM-NH-INTERFACE-SW            PIC X.
  3813         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL1502.cbl
  3814             88  CM-SING-PRM                  VALUE '1'.
  3815             88  CM-O-B-COVERAGE              VALUE '2'.
  3816             88  CM-OPEN-END                  VALUE '3'.
  3817         16  CM-IND-GRP-TYPE               PIC X.
  3818             88  CM-INDIVIDUAL                VALUE 'I'.
  3819             88  CM-GROUP                     VALUE 'G'.
  3820         16  CM-SKIP-CODE                  PIC X.
  3821             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3822             88  SKIP-JULY                    VALUE '1'.
  3823             88  SKIP-AUGUST                  VALUE '2'.
  3824             88  SKIP-SEPTEMBER               VALUE '3'.
  3825             88  SKIP-JULY-AUG                VALUE '4'.
  3826             88  SKIP-AUG-SEPT                VALUE '5'.
  3827             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3828             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3829             88  SKIP-JUNE                    VALUE '8'.
  3830             88  SKIP-JUNE-JULY               VALUE '9'.
  3831             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3832             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3833         16  CM-PAYMENT-MODE               PIC X.
  3834             88  PAY-MONTHLY                  VALUE SPACE.
  3835             88  PAY-WEEKLY                   VALUE '1'.
  3836             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3837             88  PAY-BI-WEEKLY                VALUE '3'.
  3838             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3839         16  CM-LOAN-NUMBER                PIC X(8).
  3840         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3841         16  CM-OLD-LOF                    PIC XXX.
  3842*        16  CM-LOAN-OFFICER               PIC XXX.
  3843         16  CM-REIN-TABLE                 PIC XXX.
  3844         16  CM-SPECIAL-REIN-CODE          PIC X.
  3845         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3846         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3847         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3848
  3849     12  CM-STATUS-DATA.
  3850         16  CM-ENTRY-STATUS               PIC X.
  3851         16  CM-ENTRY-DT                   PIC XX.
  3852
  3853         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3854         16  CM-LF-CANCEL-DT               PIC XX.
  3855         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3856
  3857         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3858         16  CM-LF-DEATH-DT                PIC XX.
  3859         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3860
  3861         16  CM-LF-CURRENT-STATUS          PIC X.
  3862             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3863                                                'M' '4' '5' '9'.
  3864             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3865             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3866             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3867             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3868             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3869             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3870             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3871             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL1502.cbl
  3872             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3873             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3874             88  CM-LF-DECLINED               VALUE 'D'.
  3875             88  CM-LF-VOIDED                 VALUE 'V'.
  3876
  3877         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3878         16  CM-AH-CANCEL-DT               PIC XX.
  3879         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3880
  3881         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3882         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3883         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3884
  3885         16  CM-AH-CURRENT-STATUS          PIC X.
  3886             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3887                                                'M' '4' '5' '9'.
  3888             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3889             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3890             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3891             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3892             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3893             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3894             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3895             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3896             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3897             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3898             88  CM-AH-DECLINED               VALUE 'D'.
  3899             88  CM-AH-VOIDED                 VALUE 'V'.
  3900
  3901         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3902             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3903             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3904             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3905         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3906
  3907         16  CM-ENTRY-BATCH                PIC X(6).
  3908         16  CM-LF-EXIT-BATCH              PIC X(6).
  3909         16  CM-AH-EXIT-BATCH              PIC X(6).
  3910         16  CM-LAST-MONTH-END             PIC XX.
  3911
  3912     12  CM-NOTE-SW                        PIC X.
  3913         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3914         88  CERT-NOTES-PRESENT               VALUE '1'.
  3915         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3916         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3917         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3918         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3919         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3920         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3921     12  CM-COMP-EXCP-SW                   PIC X.
  3922         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3923         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3924     12  CM-INSURED-ADDRESS-SW             PIC X.
  3925         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3926         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3927
  3928*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3929     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL1502.cbl
  3930     12  FILLER                            PIC X.
  3931
  3932*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3933     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3934     12  FILLER                            PIC X.
  3935*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3936     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3937
  3938     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3939         88  CERT-ADDED-BATCH                 VALUE ' '.
  3940         88  CERT-ADDED-ONLINE                VALUE '1'.
  3941         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3942         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3943         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3944     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3945         88  CERT-AS-LOADED                   VALUE ' '.
  3946         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3947         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3948         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3949         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3950         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3951         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3952         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3953
  3954     12  CM-ACCOUNT-COMM-PCTS.
  3955         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3956         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3957
  3958     12  CM-USER-FIELD                     PIC X.
  3959     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3960     12  CM-CLP-STATE                      PIC XX.
  3961     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3962     12  CM-USER-RESERVED                  PIC XXX.
  3963     12  FILLER REDEFINES CM-USER-RESERVED.
  3964         16  CM-AH-CLASS-CD                PIC XX.
  3965         16  F                             PIC X.
  3966******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL1502.cbl
  3968*                                    COPY ELCTRLR.
  3969******************************************************************
  3970*                                                                *
  3971*                            ELCTRLR.                            *
  3972*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3973*                            VMOD=2.014                          *
  3974*                                                                *
  3975*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3976*                                                                *
  3977*   FILE TYPE = VSAM,KSDS                                        *
  3978*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3979*                                                                *
  3980*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3981*       ALTERNATE INDEX = NONE                                   *
  3982*                                                                *
  3983*   LOG = YES                                                    *
  3984*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3985******************************************************************
  3986*                   C H A N G E   L O G
  3987*
  3988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3989*-----------------------------------------------------------------
  3990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3991* EFFECTIVE    NUMBER
  3992*-----------------------------------------------------------------
  3993* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3994* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3995* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3996* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3997* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3998* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3999* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4000* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4001* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4002* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4003* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4004* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4005* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4006******************************************************************
  4007 01  ACTIVITY-TRAILERS.
  4008     12  AT-RECORD-ID                    PIC XX.
  4009         88  VALID-AT-ID                       VALUE 'AT'.
  4010
  4011     12  AT-CONTROL-PRIMARY.
  4012         16  AT-COMPANY-CD               PIC X.
  4013         16  AT-CARRIER                  PIC X.
  4014         16  AT-CLAIM-NO                 PIC X(7).
  4015         16  AT-CERT-NO.
  4016             20  AT-CERT-PRIME           PIC X(10).
  4017             20  AT-CERT-SFX             PIC X.
  4018         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4019             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4020             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4021             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4022             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4023             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4024             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4025             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL1502.cbl
  4026             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4027             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4028             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4029             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4030             88  AT-BENEFICIARY-TRL           VALUE +91.
  4031             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4032             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4033
  4034     12  AT-TRAILER-TYPE                 PIC X.
  4035         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4036         88  PAYMENT-TR                       VALUE '2'.
  4037         88  AUTO-PAY-TR                      VALUE '3'.
  4038         88  CORRESPONDENCE-TR                VALUE '4'.
  4039         88  ADDRESS-TR                       VALUE '5'.
  4040         88  GENERAL-INFO-TR                  VALUE '6'.
  4041         88  AUTO-PROMPT-TR                   VALUE '7'.
  4042         88  DENIAL-TR                        VALUE '8'.
  4043         88  INCURRED-CHG-TR                  VALUE '9'.
  4044         88  FORM-CONTROL-TR                  VALUE 'A'.
  4045
  4046     12  AT-RECORDED-DT                  PIC XX.
  4047     12  AT-RECORDED-BY                  PIC X(4).
  4048     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4049
  4050     12  AT-TRAILER-BODY                 PIC X(165).
  4051
  4052     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4053         16  AT-RESERVE-CONTROLS.
  4054             20  AT-MANUAL-SW            PIC X.
  4055                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4056             20  AT-FUTURE-SW            PIC X.
  4057                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4058             20  AT-PTC-SW               PIC X.
  4059                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4060             20  AT-IBNR-SW              PIC X.
  4061                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4062             20  AT-PTC-LF-SW            PIC X.
  4063                 88  AT-LF-PTC-USED          VALUE '1'.
  4064             20  AT-CDT-ACCESS-METHOD    PIC X.
  4065                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4066                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4067                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4068             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4069         16  AT-LAST-COMPUTED-DT         PIC XX.
  4070         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4071         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4072         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4073         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4074         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4075         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4076         16  AT-EXPENSE-CONTROLS.
  4077             20  AT-EXPENSE-METHOD       PIC X.
  4078                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4079                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4080                 88  PERCENT-OF-PMT           VALUE '3'.
  4081                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4082             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4083             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL1502.cbl
  4084         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4085         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4086
  4087         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4088         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4089
  4090*        16  FILLER                      PIC X(53).
  4091         16  FILLER                      PIC X(47).
  4092
  4093         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4094         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4095
  4096         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4097             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4098             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4099*                    C = CLOSED
  4100*                    O = OPEN
  4101             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4102*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4103
  4104     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4105         16  AT-PAYMENT-TYPE             PIC X.
  4106             88  PARTIAL-PAYMENT                VALUE '1'.
  4107             88  FINAL-PAYMENT                  VALUE '2'.
  4108             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4109             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4110             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4111             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4112             88  VOIDED-PAYMENT                 VALUE '9'.
  4113             88  TRANSFER                       VALUE 'T'.
  4114             88  LIFE-INTEREST                  VALUE 'I'.
  4115
  4116         16  AT-CLAIM-TYPE               PIC X.
  4117             88  PAID-FOR-AH                    VALUE 'A'.
  4118             88  PAID-FOR-LIFE                  VALUE 'L'.
  4119             88  PAID-FOR-IUI                   VALUE 'I'.
  4120             88  PAID-FOR-GAP                   VALUE 'G'.
  4121         16  AT-CLAIM-PREM-TYPE          PIC X.
  4122             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4123             88  AT-O-B-COVERAGE                VALUE '2'.
  4124             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4125         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4126         16  AT-CHECK-NO                 PIC X(7).
  4127         16  AT-PAID-FROM-DT             PIC XX.
  4128         16  AT-PAID-THRU-DT             PIC XX.
  4129         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4130         16  FILLER                      PIC X.
  4131         16  AT-PAYEES-NAME              PIC X(30).
  4132         16  AT-PAYMENT-ORIGIN           PIC X.
  4133             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4134             88  ONLINE-AUTO-PMT                VALUE '2'.
  4135             88  OFFLINE-PMT                    VALUE '3'.
  4136         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4137         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4138         16  AT-VOID-DATA.
  4139             20  AT-VOID-DT              PIC XX.
  4140*00144       20  AT-VOID-REASON          PIC X(30).
  4141             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL1502.cbl
  4142         16  AT-PMT-APPROVED-BY          PIC X(04).
  4143         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4144         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4145         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4146                                         PIC S99V9(5)  COMP-3.
  4147         16  AT-CREDIT-INTERFACE.
  4148             20  AT-PMT-SELECT-DT        PIC XX.
  4149                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4150             20  AT-PMT-ACCEPT-DT        PIC XX.
  4151                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4152             20  AT-VOID-SELECT-DT       PIC XX.
  4153                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4154             20  AT-VOID-ACCEPT-DT       PIC XX.
  4155                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4156
  4157         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4158                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4159                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4160         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4161
  4162         16  AT-FORCE-CONTROL            PIC X.
  4163             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4164         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4165         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4166         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4167         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4168         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4169         16  AT-BENEFIT-TYPE             PIC X.
  4170
  4171         16  AT-EXPENSE-TYPE             PIC X.
  4172         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4173
  4174         16  AT-PAYEE-TYPE-CD.
  4175             20  AT-PAYEE-TYPE           PIC X.
  4176                 88  INSURED-PAID           VALUE 'I'.
  4177                 88  BENEFICIARY-PAID       VALUE 'B'.
  4178                 88  ACCOUNT-PAID           VALUE 'A'.
  4179                 88  OTHER-1-PAID           VALUE 'O'.
  4180                 88  OTHER-2-PAID           VALUE 'Q'.
  4181                 88  DOCTOR-PAID            VALUE 'P'.
  4182                 88  EMPLOYER-PAID          VALUE 'E'.
  4183             20  AT-PAYEE-SEQ            PIC X.
  4184
  4185         16  AT-CASH-PAYMENT             PIC X.
  4186         16  AT-GROUPED-PAYMENT          PIC X.
  4187         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4188         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4189         16  AT-APPROVED-LEVEL           PIC X.
  4190         16  AT-VOID-TYPE                PIC X.
  4191             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4192             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4193         16  AT-AIG-UNEMP-IND            PIC X.
  4194             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4195         16  AT-ASSOCIATES               PIC X.
  4196             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4197             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4198
  4199         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL1502.cbl
  4200         16  AT-CV-PMT-CODE              PIC X.
  4201             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4202             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4203             88  FULL-ADD-PAYMENT           VALUE '3'.
  4204             88  HALF-ADD-PAYMENT           VALUE '4'.
  4205             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4206             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4207             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4208             88  ADDL-PAYMENT               VALUE '8'.
  4209
  4210         16  AT-EOB-CODE1                PIC XXX.
  4211         16  AT-EOB-CODE2                PIC XXX.
  4212         16  AT-EOB-CODE3                PIC XXX.
  4213         16  AT-EOB-CODE4                PIC XXX.
  4214         16  FILLER REDEFINES AT-EOB-CODE4.
  4215             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4216             20  FILLER                  PIC X.
  4217         16  AT-EOB-CODE5                PIC XXX.
  4218         16  FILLER REDEFINES AT-EOB-CODE5.
  4219             20  AT-PMT-PROOF-DT         PIC XX.
  4220             20  FILLER                  PIC X.
  4221
  4222         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4223             88  AT-PRINT-EOB            VALUE 'Y'.
  4224
  4225         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4226         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4227
  4228     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4229         16  AT-SCHEDULE-START-DT        PIC XX.
  4230         16  AT-SCHEDULE-END-DT          PIC XX.
  4231         16  AT-TERMINATED-DT            PIC XX.
  4232         16  AT-LAST-PMT-TYPE            PIC X.
  4233             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4234             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4235         16  AT-FIRST-PMT-DATA.
  4236             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4237             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4238             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4239         16  AT-REGULAR-PMT-DATA.
  4240             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4241             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4242             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4243         16  AT-AUTO-PAYEE-CD.
  4244             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4245                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4246                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4247                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4248                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4249                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4250             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4251         16  AT-AUTO-PAY-DAY             PIC 99.
  4252         16  AT-AUTO-CASH                PIC X.
  4253             88  AT-CASH                      VALUE 'Y'.
  4254             88  AT-NON-CASH                  VALUE 'N'.
  4255*        16  FILLER                      PIC X(129).
  4256         16  AT-AUTO-END-LETTER          PIC X(4).
  4257         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL1502.cbl
  4258
  4259         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4260         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4261
  4262     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4263         16  AT-LETTER-SENT-DT           PIC XX.
  4264         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4265         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4266         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4267         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4268         16  AT-LETTER-ORIGIN            PIC X.
  4269             88  ONLINE-CREATION              VALUE '1' '3'.
  4270             88  OFFLINE-CREATION             VALUE '2' '4'.
  4271             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4272             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4273         16  AT-STD-LETTER-FORM          PIC X(4).
  4274         16  AT-REASON-TEXT              PIC X(70).
  4275         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4276         16  AT-ADDRESEE-TYPE            PIC X.
  4277              88  INSURED-ADDRESEE            VALUE 'I'.
  4278              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4279              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4280              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4281              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4282              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4283              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4284         16  AT-ADDRESSEE-NAME           PIC X(30).
  4285         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4286         16  AT-RESEND-PRINT-DATE        PIC XX.
  4287         16  AT-CORR-SOL-UNSOL           PIC X.
  4288         16  AT-LETTER-PURGED-DT         PIC XX.
  4289*
  4290*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4291*
  4292         16  AT-CSO-REDEFINITION.
  4293             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4294             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4295             20  AT-LETTER-TO-BENE       PIC X(1).
  4296             20  AT-STOP-LETTER-DT       PIC X(2).
  4297             20  FILLER                  PIC X(19).
  4298*             20  FILLER                  PIC X(27).
  4299             20  AT-CSO-LETTER-STATUS    PIC X.
  4300                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4301                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4302                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4303             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4304             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4305*
  4306*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4307*
  4308*        16  FILLER                      PIC X(26).
  4309*
  4310*        16  AT-DMD-BSR-CODE             PIC X.
  4311*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4312*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4313*
  4314*        16  AT-DMD-LETTER-STATUS        PIC X.
  4315*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL1502.cbl
  4316*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4317*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4318*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4319*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4320
  4321         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4322         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4323
  4324     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4325         16  AT-ADDRESS-TYPE             PIC X.
  4326             88  INSURED-ADDRESS               VALUE 'I'.
  4327             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4328             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4329             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4330             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4331             88  OTHER-ADDRESS-1               VALUE 'O'.
  4332             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4333         16  AT-MAIL-TO-NAME             PIC X(30).
  4334         16  AT-ADDRESS-LINE-1           PIC X(30).
  4335         16  AT-ADDRESS-LINE-2           PIC X(30).
  4336         16  AT-CITY-STATE.
  4337             20  AT-CITY                 PIC X(28).
  4338             20  AT-STATE                PIC XX.
  4339         16  AT-ZIP.
  4340             20  AT-ZIP-CODE.
  4341                 24  AT-ZIP-1ST          PIC X.
  4342                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4343                 24  FILLER              PIC X(4).
  4344             20  AT-ZIP-PLUS4            PIC X(4).
  4345         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4346             20  AT-CAN-POSTAL-1         PIC XXX.
  4347             20  AT-CAN-POSTAL-2         PIC XXX.
  4348             20  FILLER                  PIC XXX.
  4349         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4350*         16  FILLER                      PIC X(23).
  4351         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4352         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4353         16  FILLER                      PIC X(13).
  4354         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4355         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4356
  4357     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4358         16  AT-INFO-LINE-1              PIC X(60).
  4359         16  AT-INFO-LINE-2              PIC X(60).
  4360         16  AT-INFO-TRAILER-TYPE        PIC X.
  4361             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4362             88  AT-CALL-NOTE            VALUE 'C'.
  4363             88  AT-MAINT-NOTE           VALUE 'M'.
  4364             88  AT-CERT-CHANGE          VALUE 'X'.
  4365             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4366             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4367         16  AT-CALL-TYPE                PIC X.
  4368             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4369             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4370         16  AT-NOTE-CONTINUATION        PIC X.
  4371             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4372         16  AT-EOB-CODES-EXIST          PIC X.
  4373             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL1502.cbl
  4374         16  FILLER                      PIC X(35).
  4375         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4376         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4377
  4378     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4379         16  AT-PROMPT-LINE-1            PIC X(60).
  4380         16  AT-PROMPT-LINE-2            PIC X(60).
  4381         16  AT-PROMPT-START-DT          PIC XX.
  4382         16  AT-PROMPT-END-DT            PIC XX.
  4383         16  FILLER                      PIC X(35).
  4384         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4385         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4386
  4387     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4388         16  AT-DENIAL-INFO-1            PIC X(60).
  4389         16  AT-DENIAL-INFO-2            PIC X(60).
  4390         16  AT-DENIAL-DT                PIC XX.
  4391         16  AT-RETRACTION-DT            PIC XX.
  4392         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4393*         16  FILLER                      PIC X(31).
  4394         16  AT-DENIAL-PROOF-DT          PIC XX.
  4395         16  FILLER                      PIC X(29).
  4396         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4397         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4398
  4399     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4400         16  AT-OLD-INCURRED-DT          PIC XX.
  4401         16  AT-OLD-REPORTED-DT          PIC XX.
  4402         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4403         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4404         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4405         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4406         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4407         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4408         16  FILLER                      PIC X(26).
  4409         16  AT-OLD-DIAG-CODE            PIC X(6).
  4410         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4411         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4412         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4413         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4414         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4415         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4416         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4417         16  FILLER                      PIC X(25).
  4418         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4419
  4420     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4421         16  AT-FORM-SEND-ON-DT          PIC XX.
  4422         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4423         16  AT-FORM-RE-SEND-DT          PIC XX.
  4424         16  AT-FORM-ANSWERED-DT         PIC XX.
  4425         16  AT-FORM-PRINTED-DT          PIC XX.
  4426         16  AT-FORM-REPRINT-DT          PIC XX.
  4427         16  AT-FORM-TYPE                PIC X.
  4428             88  INITIAL-FORM                  VALUE '1'.
  4429             88  PROGRESS-FORM                 VALUE '2'.
  4430         16  AT-INSTRUCT-LN-1            PIC X(28).
  4431         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL1502.cbl
  4432         16  AT-INSTRUCT-LN-3            PIC X(28).
  4433         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4434         16  AT-FORM-ADDRESS             PIC X.
  4435             88  FORM-TO-INSURED              VALUE 'I'.
  4436             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4437             88  FORM-TO-OTHER-1              VALUE 'O'.
  4438             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4439         16  AT-RELATED-1.
  4440             20 AT-REL-CARR-1            PIC X.
  4441             20 AT-REL-CLAIM-1           PIC X(7).
  4442             20 AT-REL-CERT-1            PIC X(11).
  4443         16  AT-RELATED-2.
  4444             20 AT-REL-CARR-2            PIC X.
  4445             20 AT-REL-CLAIM-2           PIC X(7).
  4446             20 AT-REL-CERT-2            PIC X(11).
  4447         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4448         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4449         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4450         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4451         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4452         16  AT-STOP-FORM-DT             PIC X(2).
  4453
  4454         16  FILLER                      PIC X(09).
  4455         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4456         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4457******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL1502.cbl
  4459*                                    COPY ELCACTQ.
  4460******************************************************************
  4461*                                                                *
  4462*                            ELCACTQ.                            *
  4463*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  4464*                            VMOD=2.004                          *
  4465*                                                                *
  4466*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  4467*                                                                *
  4468*   FILE TYPE = VSAM,KSDS                                        *
  4469*   RECORD SIZE = 60     RECFORM = FIXED                         *
  4470*                                                                *
  4471*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  4472*       ALTERNATE INDEX = NONE                                   *
  4473*                                                                *
  4474*   LOG = YES                                                    *
  4475*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4476*                                                                *
  4477*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  4478******************************************************************
  4479
  4480 01  ACTIVITY-QUE.
  4481     12  AQ-RECORD-ID                PIC XX.
  4482         88  VALID-AQ-ID                VALUE 'AQ'.
  4483
  4484     12  AQ-CONTROL-PRIMARY.
  4485         16  AQ-COMPANY-CD           PIC X.
  4486         16  AQ-CARRIER              PIC X.
  4487         16  AQ-CLAIM-NO             PIC X(7).
  4488         16  AQ-CERT-NO.
  4489             20  AQ-CERT-PRIME       PIC X(10).
  4490             20  AQ-CERT-SFX         PIC X.
  4491
  4492     12  AQ-PENDING-ACTIVITY-FLAGS.
  4493         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  4494         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  4495             88  PENDING-PAYMENTS       VALUE '1'.
  4496         16  AQ-PENDING-STATUS-FLAG  PIC X.
  4497             88  PENDING-FULL-PRINT     VALUE '1'.
  4498             88  PENDING-PART-PRINT     VALUE '2'.
  4499         16  AQ-PENDING-LETTER-FLAG  PIC X.
  4500             88  PENDING-LETTERS        VALUE '1'.
  4501         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  4502             88  PENDING-RESTORE        VALUE 'C'.
  4503             88  PENDING-RESTORE-LETTER VALUE 'L'.
  4504
  4505     12  FILLER                      PIC X(20).
  4506
  4507     12  AQ-RESEND-DATE              PIC XX.
  4508     12  AQ-FOLLOWUP-DATE            PIC XX.
  4509     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  4510     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  4511     12  AQ-AUTO-LETTER              PIC X(4).
  4512     12  FILLER                      PIC XX.
  4513     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  4514*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL1502.cbl
  4516*                                    COPY ELCCHKQ.
  4517******************************************************************
  4518*                                                                *
  4519*                                                                *
  4520*                            ELCCHKQ.                            *
  4521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4522*                            VMOD=2.007                          *
  4523*                                                                *
  4524*   FILE DESCRIPTION = CHECK QUE FILE                            *
  4525*                                                                *
  4526*   FILE TYPE = VSAM,KSDS                                        *
  4527*   RECORD SIZE = 100  RECFORM = FIXED                           *
  4528*                                                                *
  4529*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  4530*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  4531*                                                                *
  4532*   LOG = YES                                                    *
  4533*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4534******************************************************************
  4535 01  CHECK-QUE.
  4536     12  CQ-RECORD-ID                PIC XX.
  4537         88  VALID-CQ-ID         VALUE 'CQ'.
  4538
  4539     12  CQ-CONTROL-PRIMARY.
  4540         16  CQ-COMPANY-CD           PIC X.
  4541         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  4542         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  4543
  4544     12  CQ-CONTROL-BY-PAYEE.
  4545         16  CQ-CONTROL-BY-NUMBER.
  4546             20  CQ-COMPANY-CD-A1     PIC X.
  4547             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  4548         16  CQ-PAYEE-CARRIER        PIC X.
  4549         16  CQ-PAYEE-GROUPING       PIC X(6).
  4550         16  CQ-PAYEE-STATE          PIC XX.
  4551         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  4552         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  4553
  4554     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  4555         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  4556         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  4557         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  4558         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  4559         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  4560         16  FILLER                  PIC X(3).
  4561
  4562     12  CQ-ENTRY-TYPE               PIC X.
  4563             88  CHECK-ON-QUE           VALUE 'Q'.
  4564             88  ALIGNMENT-CHECK        VALUE 'A'.
  4565             88  SPOILED-CHECK          VALUE 'S'.
  4566             88  PAYMENT-ABORTED        VALUE 'X'.
  4567
  4568     12  CQ-CLAIM-MAST-CNTL.
  4569         16  CQ-CARRIER              PIC X.
  4570         16  CQ-CLAIM-NO             PIC X(7).
  4571         16  CQ-CERT-NO.
  4572             20  CQ-CERT-PRIME       PIC X(10).
  4573             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL1502.cbl
  4574         16  CQ-CLAIM-TYPE           PIC X.
  4575             88  CQ-LIFE-CLAIM          VALUE 'L'.
  4576             88  CQ-AH-CLAIM            VALUE 'A'.
  4577         16  CQ-CLAIM-SUB-TYPE       PIC X.
  4578             88  CQ-FIXED-COVERAGE      VALUE '1'.
  4579             88  CQ-O-B-COVERAGE        VALUE '2'.
  4580             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  4581
  4582     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  4583     12  CQ-CHECK-NUMBER             PIC X(7).
  4584     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  4585     12  CQ-PAYMENT-TYPE             PIC X.
  4586             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  4587             88  CQ-FINAL-PAYMENT          VALUE '2'.
  4588             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  4589             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  4590             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  4591             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  4592             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  4593             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  4594     12  CQ-VOID-INDICATOR           PIC X.
  4595             88  CHECK-IS-STOPPED          VALUE 'S'.
  4596             88  CHECK-IS-VOID             VALUE 'V'.
  4597     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  4598     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  4599     12  CQ-CHECK-BY-USER            PIC X(4).
  4600     12  CQ-PRE-NUMBERING-SW         PIC X.
  4601       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  4602       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  4603
  4604     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  4605     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  4606     12  CQ-LEDGER-FLAG              PIC X(01).
  4607     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  4608     12  CQ-LAST-UPDATED-DT          PIC XX.
  4609     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  4610     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  4611
  4612     12  FILLER                      PIC X(04).
  4613
  4614******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL1502.cbl
  4616*                                    COPY ELCRCON.
  4617******************************************************************
  4618*                                                                *
  4619*
  4620*   THIS COPYBOOK IS NOT BEING USED IN LOGIC
  4621*
  4622*
  4623*                                                                *
  4624*                            ELCRCON.                            *
  4625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4626*                            VMOD=2.003                          *
  4627*                                                                *
  4628*   FILE DESCRIPTION = CHECK RECONCILIATION FILE                 *
  4629*                                                                *
  4630*   FILE TYPE = VSAM,KSDS                                        *
  4631*   RECORD SIZE = 194  RECFORM = FIXED                           *
  4632*                                                                *
  4633*   BASE CLUSTER = ELRCON                         RKP=2,LEN=19   *
  4634*                                                                *
  4635*   LOG = YES                                                    *
  4636*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4637******************************************************************
  4638
  4639 01  CHECK-RECONCILIATION.
  4640     12  RC-RECORD-ID                          PIC XX.
  4641         88  VALID-RC-ID                    VALUE 'RC'.
  4642     12  RC-CONTROL-PRIMARY.
  4643         16  RC-COMPANY-CD                     PIC X.
  4644         16  RC-CHECK-NO                       PIC X(7).
  4645         16  RC-CHECK-ORIGIN                   PIC X.
  4646         16  RC-GL-ACCOUNT-NO                  PIC X(10).
  4647
  4648     12  RC-CHECK-DATA.
  4649         16  RC-ISSUE-DATE.
  4650             20  RC-ISSUE-YYYY.
  4651               22  RC-ISSUE-CC                 PIC XX.
  4652               22  RC-ISSUE-YY                 PIC XX.
  4653             20  RC-ISSUE-MM                   PIC XX.
  4654             20  RC-ISSUE-DD                   PIC XX.
  4655         16  RC-CHECK-AMOUNT                   PIC 9(7)V99.
  4656         16  RC-CARRIER                        PIC X.
  4657         16  RC-CLAIM-NO                       PIC X(7).
  4658         16  RC-REFERENCE-NO                   PIC X(20).
  4659         16  RC-MORTGAGE-REF   REDEFINES  RC-REFERENCE-NO.
  4660             20  RC-MORT-REF-1-18              PIC X(18).
  4661             20  RC-MORT-REF-SUF-19-20         PIC XX.
  4662         16  FILLER  REDEFINES  RC-MORTGAGE-REF.
  4663             20  FILLER                        PIC X(13).
  4664             20  RC-CLAIM-REF.
  4665               22  RC-CLAIM-PREFIX             PIC X.
  4666               22  RC-CLAIM-NO-REF             PIC X(6).
  4667         16  RC-COVERAGE-TYPE                  PIC X.
  4668         16  RC-BENEFIT-CODE                   PIC XX.
  4669         16  RC-BENEFICIARY                    PIC X(10).
  4670         16  RC-PAYMENT-TYPE                   PIC X.
  4671         16  RC-STATUS                         PIC X.
  4672           88  RC-STATUS-ABANDONED                VALUE 'A'.
  4673           88  RC-STATUS-DESTROYED                VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL1502.cbl
  4674           88  RC-STATUS-OUTSTANDING              VALUE 'O'.
  4675           88  RC-STATUS-REDEEMED                 VALUE 'R'.
  4676           88  RC-STATUS-STOP-PAY                 VALUE 'S'.
  4677           88  RC-STATUS-UNREDEEMED               VALUE 'U'.
  4678           88  RC-STATUS-VOIDED                   VALUE 'V'.
  4679         16  RC-STATUS-DATE.
  4680             20  RC-STATUS-YYYY.
  4681               22  RC-STATUS-CC                PIC XX.
  4682               22  RC-STATUS-YY                PIC XX.
  4683             20  RC-STATUS-MM                  PIC XX.
  4684             20  RC-STATUS-DD                  PIC XX.
  4685
  4686     12  RC-MAINT-AREA.
  4687         16  RC-LAST-MAINT-BY                  PIC X(4).
  4688         16  RC-LAST-MAINT-DT                  PIC XX.
  4689         16  RC-LAST-MAINT-HHMMSS    COMP-3    PIC S9(7).
  4690
  4691     12  RC-CHECK-MAINT-AREA.
  4692         16  RC-LAST-CHECK-BY                  PIC X(4).
  4693         16  RC-LAST-CHECK-DT                  PIC XX.
  4694         16  RC-LAST-CHECK-HHMMSS    COMP-3    PIC S9(7).
  4695     12  RC-CASHED-AMOUNT                      PIC 9(7)V99.
  4696
  4697     12  RC-CHECK-NOTE                         PIC X(67).
  4698     12  FILLER                                PIC X(11).
  4699
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL1502.cbl
  4701*                                    COPY ERCDMDNT.
  4702*    EJECT
  4703*                                    COPY MPCPLCY.
  4704*    EJECT
  4705 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  4706                          CONTROL-FILE CERTIFICATE-MASTER
  4707                          ACTIVITY-TRAILERS ACTIVITY-QUE
  4708                          CHECK-QUE CHECK-RECONCILIATION.
  4709 0000-DFHEXIT SECTION.
  4710     MOVE '9#                    $   ' TO DFHEIV0.
  4711     MOVE 'EL1502' TO DFHEIV1.
  4712     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4713
  4714     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4715     MOVE '5'                    TO  DC-OPTION-CODE.
  4716     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  4717     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4718     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4719     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  4720
  4721     IF SAVE-DATE-YY > 70
  4722         MOVE 19                 TO  SAVE-DATE-CC
  4723     ELSE
  4724         MOVE 20                 TO  SAVE-DATE-CC.
  4725
  4726     IF EIBCALEN = 0
  4727         GO TO 8800-UNAUTHORIZED-ACCESS.
  4728
  4729     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4730
  4731     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  4732     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  4733
  4734     MOVE EIBTRMID               TO QID-TERM
  4735                                    WS-QID-TERM.
  4736
  4737
  4738* EXEC CICS HANDLE CONDITION
  4739*        QIDERR   (1000-SHOW-CLAIM-HISTORY)
  4740*        MAPFAIL  (0100-FIRST-TIME-IN)
  4741*        NOTOPEN  (8500-FILE-NOTOPEN)
  4742*        PGMIDERR (9600-PGMID-ERROR)
  4743*        ERROR    (9990-ABEND)
  4744*    END-EXEC.
  4745*    MOVE '"$N?JL.               ! " #00004733' TO DFHEIV0
  4746     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  4747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4748     MOVE X'2220233030303034373333' TO DFHEIV0(25:11)
  4749     CALL 'kxdfhei1' USING DFHEIV0
  4750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4751
  4752
  4753     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4754         MOVE PI-CALLING-PROGRAM       TO RETURNED-FROM.
  4755
  4756     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4757         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4758             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL1502.cbl
  4759             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4760             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4761             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4762             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4763             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4764             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4765             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  4766         ELSE
  4767             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4768             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4769             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4770             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4771             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4772             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  4773             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4774             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4775
  4776     IF RETURNED-FROM NOT = SPACES
  4777         GO TO 0600-RECOVER-TEMP-STORAGE.
  4778
  4779     IF EIBAID = DFHCLEAR
  4780         GO TO 9400-CLEAR.
  4781
  4782     IF PI-PROCESSOR-ID = 'LGXX'
  4783         NEXT SENTENCE
  4784     ELSE
  4785
  4786* EXEC CICS READQ TS
  4787*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4788*            INTO    (SECURITY-CONTROL)
  4789*            LENGTH  (SC-COMM-LENGTH)
  4790*            ITEM    (SC-ITEM)
  4791*        END-EXEC
  4792*    MOVE '*$II   L              ''   #00004773' TO DFHEIV0
  4793     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4794     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4795     MOVE X'2020233030303034373733' TO DFHEIV0(25:11)
  4796     CALL 'kxdfhei1' USING DFHEIV0,
  4797           PI-SECURITY-TEMP-STORE-ID,
  4798           SECURITY-CONTROL,
  4799           SC-COMM-LENGTH,
  4800           SC-ITEM,
  4801           DFHEIV99,
  4802           DFHEIV99
  4803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4804             MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  4805             MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  4806             IF NOT DISPLAY-CAP
  4807                 MOVE 'READ'              TO  SM-READ
  4808                 PERFORM 9995-SECURITY-VIOLATION
  4809                 MOVE ER-0070             TO  EMI-ERROR
  4810                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4811                 GO TO 8100-SEND-INITIAL-MAP.
  4812
  4813     IF EIBTRNID = TRANS-ID
  4814         GO TO 0200-RECEIVE.
  4815
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL1502.cbl
  4817 0100-FIRST-TIME-IN.
  4818     MOVE LOW-VALUES             TO  EL150CO
  4819                                     PI-PROGRAM-WORK-AREA
  4820                                     HOLD-RECORDED-DT.
  4821
  4822     MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  4823                                     WS-RECORDS-READ-SW.
  4824     MOVE 'F'                    TO  DIRECTION-SWITCH.
  4825     MOVE 1                      TO  PI-LINE-NO
  4826                                     SUB-2
  4827                                     SUB-3.
  4828     MOVE ZERO                   TO  WS-MAX-SUB
  4829                                     PI-REMINDERS-SW
  4830                                     PI-LETTERS-SW
  4831                                     PI-PAYMENTS-SW
  4832                                     PI-AUTO-PAY-SW
  4833                                     PI-NOTES-SW
  4834                                     PI-RES-EXP-SW
  4835                                     PI-DENIALS-SW
  4836                                     PI-INCURRED-DATE-SW
  4837                                     PI-FORMS-SW
  4838                                     SUB.
  4839
  4840     PERFORM 7400-DEL-TEMP-STOR-TABLE THRU 7400-EXIT.
  4841
  4842
  4843* EXEC CICS HANDLE CONDITION
  4844*        QIDERR   (0900-BUILD-RELATED-TABLE)
  4845*    END-EXEC.
  4846*    MOVE '"$N                   ! # #00004817' TO DFHEIV0
  4847     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4849     MOVE X'2320233030303034383137' TO DFHEIV0(25:11)
  4850     CALL 'kxdfhei1' USING DFHEIV0
  4851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4852
  4853
  4854
  4855* EXEC CICS DELETEQ TS
  4856*        QUEUE(QID)
  4857*    END-EXEC.
  4858*    MOVE '*&                    #   #00004821' TO DFHEIV0
  4859     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4860     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4861     MOVE X'2020233030303034383231' TO DFHEIV0(25:11)
  4862     CALL 'kxdfhei1' USING DFHEIV0,
  4863           QID,
  4864           DFHEIV99
  4865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4866
  4867
  4868     PERFORM 0900-BUILD-RELATED-TABLE THRU 0999-RELATED-EXIT.
  4869
  4870     GO TO 1000-SHOW-CLAIM-HISTORY.
  4871
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL1502.cbl
  4873 0200-RECEIVE.
  4874     MOVE 'B'                    TO  PASS-SWITCH.
  4875     MOVE LOW-VALUES             TO  EL150CI.
  4876
  4877     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  4878         MOVE ER-0008            TO  EMI-ERROR
  4879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4880         MOVE -1                 TO  ENTERPFL
  4881         GO TO 8200-SEND-DATAONLY.
  4882
  4883
  4884* EXEC CICS RECEIVE
  4885*        MAP      (MAP-NAME)
  4886*        MAPSET   (MAPSET-NAME)
  4887*        INTO     (EL150CI)
  4888*    END-EXEC.
  4889     MOVE LENGTH OF
  4890      EL150CI
  4891       TO DFHEIV11
  4892*    MOVE '8"T I  L              ''   #00004840' TO DFHEIV0
  4893     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4895     MOVE X'2020233030303034383430' TO DFHEIV0(25:11)
  4896     CALL 'kxdfhei1' USING DFHEIV0,
  4897           MAP-NAME,
  4898           EL150CI,
  4899           DFHEIV11,
  4900           MAPSET-NAME,
  4901           DFHEIV99,
  4902           DFHEIV99
  4903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4904
  4905
  4906     IF ENTERPFL = 0
  4907         GO TO 0300-CHECK-PFKEYS.
  4908
  4909     IF EIBAID NOT = DFHENTER
  4910         MOVE ER-0004            TO  EMI-ERROR
  4911         GO TO 0320-INPUT-ERROR.
  4912
  4913     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  4914         MOVE PF-VALUES (ENTERPFI)   TO  EIBAID
  4915     ELSE
  4916         MOVE ER-0029                TO  EMI-ERROR
  4917         GO TO 0320-INPUT-ERROR.
  4918
  4919 0300-CHECK-PFKEYS.
  4920     IF EIBAID = DFHPF23
  4921         GO TO 8810-PF23.
  4922
  4923     IF EIBAID = DFHPF24
  4924         GO TO 9200-RETURN-MAIN-MENU.
  4925
  4926     IF EIBAID = DFHPF12
  4927         GO TO 9500-PF12.
  4928
  4929     IF EIBAID = DFHPF3
  4930         IF LINENOL > +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL1502.cbl
  4931             GO TO 0500-CREATE-TEMP-STORAGE
  4932         ELSE
  4933             MOVE ER-0672        TO  EMI-ERROR
  4934             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4935             MOVE -1             TO  LINENOL
  4936             GO TO 8200-SEND-DATAONLY.
  4937
  4938*    IF EIBAID = DFHPF4
  4939*       IF LINENOL > +0
  4940*          IF (PI-EL142-PRIORITY = '8')
  4941*             AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  4942*                  AND 'AMWA')
  4943*             MOVE ER-8003       TO EMI-ERROR
  4944*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4945*             MOVE -1            TO LINENOL
  4946*             GO TO 8200-SEND-DATAONLY
  4947*          ELSE
  4948*             MOVE 'V'           TO WS-VOID-CODE
  4949*             GO TO 5000-VOID-PAYMENT
  4950*          END-IF
  4951*       ELSE
  4952*          MOVE ER-0663          TO EMI-ERROR
  4953*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4954*          MOVE -1               TO LINENOL
  4955*          GO TO 8200-SEND-DATAONLY
  4956*       END-IF
  4957*    END-IF
  4958*
  4959*    IF EIBAID = DFHPF5
  4960*       IF LINENOL > +0
  4961*          IF (PI-EL142-PRIORITY = '8')
  4962*             AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  4963*                  AND 'AMWA')
  4964*             MOVE ER-8003       TO EMI-ERROR
  4965*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4966*             MOVE -1            TO LINENOL
  4967*             GO TO 8200-SEND-DATAONLY
  4968*          ELSE
  4969*             MOVE 'S'           TO WS-VOID-CODE
  4970*             GO TO 5000-VOID-PAYMENT
  4971*          END-IF
  4972*       ELSE
  4973*          MOVE ER-0835          TO EMI-ERROR
  4974*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4975*          MOVE -1               TO LINENOL
  4976*          GO TO 8200-SEND-DATAONLY
  4977*       END-IF
  4978*    END-IF
  4979
  4980*    IF EIBAID = DFHPF4
  4981*        IF LINENOL > +0
  4982*            MOVE 'V'            TO  WS-VOID-CODE
  4983*            GO TO 5000-VOID-PAYMENT
  4984*        ELSE
  4985*            MOVE ER-0663        TO  EMI-ERROR
  4986*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4987*            MOVE -1             TO  LINENOL
  4988*            GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL1502.cbl
  4989*
  4990*    IF EIBAID = DFHPF5
  4991*        IF LINENOL > +0
  4992*            MOVE 'S'            TO  WS-VOID-CODE
  4993*            GO TO 5000-VOID-PAYMENT
  4994*        ELSE
  4995*            MOVE ER-0835        TO  EMI-ERROR
  4996*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4997*            MOVE -1             TO  LINENOL
  4998*            GO TO 8200-SEND-DATAONLY.
  4999
  5000*    IF EIBAID = DFHPF6
  5001*        IF PI-COMPANY-ID = 'DMD'
  5002*            IF LINENOL NOT = ZEROS
  5003*                MOVE LINENOI        TO SUB-1
  5004*                IF PI-TRLR-TYPE (SUB-1) = '2'
  5005*                    PERFORM 0500-CREATE-TEMP-STORAGE
  5006*                    MOVE 'EL402DMD' TO PGM-NAME
  5007*                    GO TO 9300-XCTL
  5008*                ELSE
  5009*                    MOVE ER-0940    TO EMI-ERROR
  5010*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5011*                    MOVE -1         TO LINENOL
  5012*                    GO TO 8200-SEND-DATAONLY
  5013*            ELSE
  5014*                MOVE ER-0939    TO EMI-ERROR
  5015*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5016*                MOVE -1         TO LINENOL
  5017*                GO TO 8200-SEND-DATAONLY.
  5018
  5019     MOVE SPACES                 TO  ERRMSG1O.
  5020
  5021     IF EIBAID = DFHPF1
  5022         MOVE 'F'                TO  DIRECTION-SWITCH
  5023         PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT
  5024         GO TO 1000-SHOW-CLAIM-HISTORY.
  5025
  5026     IF EIBAID = DFHPF2
  5027         MOVE 'B'                TO  DIRECTION-SWITCH
  5028         PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT
  5029         GO TO 1000-SHOW-CLAIM-HISTORY.
  5030
  5031     IF EIBAID = DFHENTER
  5032         GO TO 0330-EDIT-DATA.
  5033
  5034     MOVE ER-0029                TO EMI-ERROR.
  5035
  5036 0320-INPUT-ERROR.
  5037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5038
  5039     IF ENTERPFL = 0
  5040         MOVE -1                 TO ENTERPFL
  5041     ELSE
  5042         MOVE AL-UNBON           TO ENTERPFA
  5043         MOVE -1                 TO ENTERPFL.
  5044
  5045     GO TO 8200-SEND-DATAONLY.
  5046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL1502.cbl
  5047 0330-EDIT-DATA.
  5048     IF NOT MODIFY-CAP
  5049         MOVE 'UPDATE'           TO  SM-READ
  5050         PERFORM 9995-SECURITY-VIOLATION
  5051         MOVE ER-0070            TO  EMI-ERROR
  5052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5053         GO TO 8100-SEND-INITIAL-MAP.
  5054
  5055     IF LINENOL  > 0 AND
  5056        RECVDTL  > 0 AND
  5057        RECVTYPL > 0
  5058            GO TO 4000-RECEIVE-FORMS.
  5059
  5060     IF LINENOL > 0 AND
  5061        RECVDTL > 0
  5062            GO TO 3000-RECEIVE-LETTERS.
  5063
  5064     IF LINENOL > 0
  5065         MOVE LINENOI            TO  SUB-1
  5066         IF PI-TRLR-TYPE (SUB-1) = 'A'
  5067             MOVE ER-0665        TO  EMI-ERROR
  5068             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5069             MOVE -1             TO  LINENOL
  5070             GO TO 8200-SEND-DATAONLY
  5071         ELSE
  5072         IF PI-TRLR-TYPE (SUB-1) = '4'
  5073             MOVE ER-0666        TO  EMI-ERROR
  5074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5075             MOVE -1             TO  LINENOL
  5076             GO TO 8200-SEND-DATAONLY
  5077         ELSE
  5078         IF PI-TRLR-TYPE (SUB-1) = '2'
  5079             MOVE ER-0667    TO  EMI-ERROR
  5080             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5081             MOVE -1         TO  LINENOL
  5082             GO TO 8200-SEND-DATAONLY.
  5083
  5084     MOVE 'F'                    TO  DIRECTION-SWITCH.
  5085     PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT.
  5086     GO TO 1000-SHOW-CLAIM-HISTORY.
  5087
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL1502.cbl
  5089 0500-CREATE-TEMP-STORAGE.
  5090     MOVE EIBCPOSN               TO  PI-SAVE-CURSOR.
  5091     MOVE SPACES                 TO PI-FULL-SCREEN-IND.
  5092
  5093
  5094* EXEC CICS WRITEQ TS
  5095*        QUEUE    (QID)
  5096*        FROM     (PROGRAM-INTERFACE-BLOCK)
  5097*        LENGTH   (PI-COMM-LENGTH)
  5098*    END-EXEC.
  5099*    MOVE '*"                    ''   #00005033' TO DFHEIV0
  5100     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5102     MOVE X'2020233030303035303333' TO DFHEIV0(25:11)
  5103     CALL 'kxdfhei1' USING DFHEIV0,
  5104           QID,
  5105           PROGRAM-INTERFACE-BLOCK,
  5106           PI-COMM-LENGTH,
  5107           DFHEIV99,
  5108           DFHEIV99,
  5109           DFHEIV99
  5110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5111
  5112
  5113     IF LINENOL > +0
  5114         MOVE LINENOI            TO  SUB-1
  5115         IF PI-TRLR-TYPE (SUB-1) = '2'
  5116            MOVE +1                      TO  PI-PAYMENTS-SW
  5117            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5118                                             PI-SAVE-ATK-SEQ-NO
  5119         ELSE
  5120         IF PI-TRLR-TYPE (SUB-1) = '3'
  5121            MOVE +1                      TO  PI-AUTO-PAY-SW
  5122            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5123                                             PI-SAVE-ATK-SEQ-NO
  5124         ELSE
  5125         IF PI-TRLR-TYPE (SUB-1) = '4'
  5126            MOVE +1                      TO  PI-LETTERS-SW
  5127            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5128                                             PI-SAVE-ATK-SEQ-NO
  5129         ELSE
  5130         IF PI-TRLR-TYPE (SUB-1) = '6'
  5131            MOVE +1                      TO  PI-NOTES-SW
  5132            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5133                                             PI-SAVE-ATK-SEQ-NO
  5134         ELSE
  5135         IF PI-TRLR-TYPE (SUB-1) = '7'
  5136            MOVE +1                      TO  PI-REMINDERS-SW
  5137            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5138                                             PI-SAVE-ATK-SEQ-NO
  5139         ELSE
  5140         IF PI-TRLR-TYPE (SUB-1) = '8'
  5141            MOVE +1                      TO  PI-DENIALS-SW
  5142            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5143                                             PI-SAVE-ATK-SEQ-NO
  5144         ELSE
  5145         IF PI-TRLR-TYPE (SUB-1) = '9'
  5146            MOVE +1                      TO  PI-INCURRED-DATE-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL1502.cbl
  5147            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5148                                             PI-SAVE-ATK-SEQ-NO
  5149         ELSE
  5150            MOVE +1                      TO  PI-FORMS-SW
  5151            MOVE PI-TRLR-SEQ-NO (SUB-1)  TO  PI-ATK-SEQ-NO
  5152                                             PI-SAVE-ATK-SEQ-NO
  5153     ELSE
  5154         MOVE +1                         TO  PI-REMINDERS-SW
  5155                                             PI-LETTERS-SW
  5156                                             PI-PAYMENTS-SW
  5157                                             PI-AUTO-PAY-SW
  5158                                             PI-NOTES-SW
  5159                                             PI-RES-EXP-SW
  5160                                             PI-DENIALS-SW
  5161                                             PI-INCURRED-DATE-SW
  5162                                             PI-FORMS-SW
  5163         MOVE +0                         TO  PI-ATK-SEQ-NO.
  5164
  5165     IF EIBAID = DFHPF6
  5166         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5167                                     PI-ATK-COMPANY-CODE
  5168         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5169                                     PI-ATK-CARRIER
  5170         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5171                                     PI-ATK-CLAIM-NO
  5172         MOVE PI-TRLR-CERT (SUB-1) TO PI-SAVE-ATK-CERT-NO
  5173                                      PI-ATK-CERT-NO
  5174                                      PI-CERT-NO
  5175         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  5176
  5177     IF EIBAID = DFHPF3
  5178         MOVE XCTL-142           TO  PGM-NAME
  5179         MOVE 'EL142A'           TO  PI-MAP-NAME
  5180         MOVE PI-COMPANY-CD      TO  PI-SAVE-ATK-COMPANY-CODE
  5181                                     PI-ATK-COMPANY-CODE
  5182         MOVE PI-CARRIER         TO  PI-SAVE-ATK-CARRIER
  5183                                     PI-ATK-CARRIER
  5184         MOVE PI-CLAIM-NO        TO  PI-SAVE-ATK-CLAIM-NO
  5185                                     PI-ATK-CLAIM-NO
  5186         MOVE PI-TRLR-CERT (SUB-1)   TO  PI-SAVE-ATK-CERT-NO
  5187                                         PI-ATK-CERT-NO
  5188                                         PI-CERT-NO
  5189         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5190         GO TO 9300-XCTL.
  5191
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL1502.cbl
  5193 0600-RECOVER-TEMP-STORAGE.
  5194     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  5195
  5196
  5197* EXEC CICS HANDLE CONDITION
  5198*        QIDERR   (0690-QIDERR)
  5199*    END-EXEC.
  5200*    MOVE '"$N                   ! $ #00005122' TO DFHEIV0
  5201     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5203     MOVE X'2420233030303035313232' TO DFHEIV0(25:11)
  5204     CALL 'kxdfhei1' USING DFHEIV0
  5205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5206
  5207
  5208
  5209* EXEC CICS READQ TS
  5210*        QUEUE    (QID)
  5211*        INTO     (PROGRAM-INTERFACE-BLOCK)
  5212*        LENGTH   (PI-COMM-LENGTH)
  5213*    END-EXEC.
  5214*    MOVE '*$I    L              ''   #00005126' TO DFHEIV0
  5215     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5216     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5217     MOVE X'2020233030303035313236' TO DFHEIV0(25:11)
  5218     CALL 'kxdfhei1' USING DFHEIV0,
  5219           QID,
  5220           PROGRAM-INTERFACE-BLOCK,
  5221           PI-COMM-LENGTH,
  5222           DFHEIV99,
  5223           DFHEIV99,
  5224           DFHEIV99
  5225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5226
  5227
  5228
  5229* EXEC CICS DELETEQ TS
  5230*        QUEUE   (QID)
  5231*    END-EXEC.
  5232*    MOVE '*&                    #   #00005132' TO DFHEIV0
  5233     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5234     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5235     MOVE X'2020233030303035313332' TO DFHEIV0(25:11)
  5236     CALL 'kxdfhei1' USING DFHEIV0,
  5237           QID,
  5238           DFHEIV99
  5239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5240
  5241
  5242     MOVE SAVE-CONTROL           TO  PI-CONTROL-IN-PROGRESS.
  5243     MOVE 'F'                    TO  DIRECTION-SWITCH.
  5244
  5245     PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT.
  5246     GO TO 1000-SHOW-CLAIM-HISTORY.
  5247
  5248 0690-QIDERR.
  5249     MOVE ER-0033                TO  EMI-ERROR.
  5250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL1502.cbl
  5251     MOVE LOW-VALUES             TO  EL150CO.
  5252     MOVE -1                     TO  ENTERPFL.
  5253     GO TO 8100-SEND-INITIAL-MAP.
  5254
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL1502.cbl
  5256 0700-CREATE-TEMP-STORAGE.
  5257
  5258
  5259* EXEC CICS WRITEQ TS
  5260*        QUEUE    (WS-TABLE-QID)
  5261*        FROM     (WS-SORTED-TABLE)
  5262*        LENGTH   (WS-TABLE-LENGTH)
  5263*        ITEM     (WS-ITEM-COUNT)
  5264*    END-EXEC.
  5265*    MOVE '*" I                  ''   #00005152' TO DFHEIV0
  5266     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  5267     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5268     MOVE X'2020233030303035313532' TO DFHEIV0(25:11)
  5269     CALL 'kxdfhei1' USING DFHEIV0,
  5270           WS-TABLE-QID,
  5271           WS-SORTED-TABLE,
  5272           WS-TABLE-LENGTH,
  5273           WS-ITEM-COUNT,
  5274           DFHEIV99,
  5275           DFHEIV99
  5276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5277
  5278
  5279 0700-EXIT.
  5280     EXIT.
  5281
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL1502.cbl
  5283 0800-RECOVER-TEMP-STORAGE.
  5284
  5285
  5286* EXEC CICS HANDLE CONDITION
  5287*        QIDERR   (0890-QIDERR)
  5288*    END-EXEC.
  5289*    MOVE '"$N                   ! % #00005165' TO DFHEIV0
  5290     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5292     MOVE X'2520233030303035313635' TO DFHEIV0(25:11)
  5293     CALL 'kxdfhei1' USING DFHEIV0
  5294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5295
  5296
  5297
  5298* EXEC CICS READQ TS
  5299*        QUEUE    (WS-TABLE-QID)
  5300*        INTO     (WS-SORTED-TABLE)
  5301*        LENGTH   (WS-TABLE-LENGTH)
  5302*        ITEM     (WS-ITEM-COUNT)
  5303*    END-EXEC.
  5304*    MOVE '*$II   L              ''   #00005169' TO DFHEIV0
  5305     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5307     MOVE X'2020233030303035313639' TO DFHEIV0(25:11)
  5308     CALL 'kxdfhei1' USING DFHEIV0,
  5309           WS-TABLE-QID,
  5310           WS-SORTED-TABLE,
  5311           WS-TABLE-LENGTH,
  5312           WS-ITEM-COUNT,
  5313           DFHEIV99,
  5314           DFHEIV99
  5315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5316
  5317
  5318     GO TO 0899-EXIT.
  5319
  5320 0890-QIDERR.
  5321     MOVE ER-0033                TO  EMI-ERROR.
  5322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5323     MOVE LOW-VALUES             TO  EL150CO.
  5324     MOVE -1                     TO  ENTERPFL.
  5325     GO TO 8100-SEND-INITIAL-MAP.
  5326
  5327 0899-EXIT.
  5328     EXIT.
  5329
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL1502.cbl
  5331 0900-BUILD-RELATED-TABLE.
  5332
  5333
  5334* EXEC CICS HANDLE CONDITION
  5335*        ENDFILE   (0950-SORT-ROUTINE)
  5336*    END-EXEC.
  5337*    MOVE '"$''                   ! & #00005191' TO DFHEIV0
  5338     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  5339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5340     MOVE X'2620233030303035313931' TO DFHEIV0(25:11)
  5341     CALL 'kxdfhei1' USING DFHEIV0
  5342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5343
  5344
  5345     MOVE LOW-VALUES             TO  ELMSTR-KEY.
  5346     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
  5347     MOVE PI-CARRIER             TO  MSTR-CARRIER.
  5348     MOVE PI-CLAIM-NO            TO  MSTR-CLAIM-NO.
  5349
  5350
  5351* EXEC CICS STARTBR
  5352*        DATASET   ('ELMSTR')
  5353*        RIDFLD    (ELMSTR-KEY)
  5354*    END-EXEC.
  5355     MOVE 'ELMSTR' TO DFHEIV1
  5356     MOVE 0
  5357       TO DFHEIV11
  5358*    MOVE '&,         G          &   #00005200' TO DFHEIV0
  5359     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5361     MOVE X'2020233030303035323030' TO DFHEIV0(25:11)
  5362     CALL 'kxdfhei1' USING DFHEIV0,
  5363           DFHEIV1,
  5364           ELMSTR-KEY,
  5365           DFHEIV99,
  5366           DFHEIV11,
  5367           DFHEIV99
  5368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5369
  5370
  5371 0910-READNEXT-CLAIM-MASTER.
  5372
  5373
  5374* EXEC CICS HANDLE CONDITION
  5375*        ENDFILE   (0915-ELMSTR-ENDFILE)
  5376*    END-EXEC.
  5377*    MOVE '"$''                   ! '' #00005207' TO DFHEIV0
  5378     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  5379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5380     MOVE X'2720233030303035323037' TO DFHEIV0(25:11)
  5381     CALL 'kxdfhei1' USING DFHEIV0
  5382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5383
  5384
  5385
  5386* EXEC CICS READNEXT
  5387*        DATASET   ('ELMSTR')
  5388*        RIDFLD    (ELMSTR-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL1502.cbl
  5389*        SET       (ADDRESS OF CLAIM-MASTER)
  5390*    END-EXEC.
  5391     MOVE 'ELMSTR' TO DFHEIV1
  5392     MOVE 0
  5393       TO DFHEIV11
  5394*    MOVE '&.S                   )   #00005211' TO DFHEIV0
  5395     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5396     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5397     MOVE X'2020233030303035323131' TO DFHEIV0(25:11)
  5398     CALL 'kxdfhei1' USING DFHEIV0,
  5399           DFHEIV1,
  5400           DFHEIV20,
  5401           DFHEIV99,
  5402           ELMSTR-KEY,
  5403           DFHEIV99,
  5404           DFHEIV11,
  5405           DFHEIV99,
  5406           DFHEIV99
  5407     SET ADDRESS OF CLAIM-MASTER TO
  5408         DFHEIV20
  5409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5410
  5411
  5412     IF PI-FIRST-TIME-SW = 'Y'
  5413         MOVE 'N'                        TO  PI-FIRST-TIME-SW
  5414         MOVE CL-CLAIM-NO                TO  PI-PREV-CLAIM-NO
  5415         MOVE CL-CARRIER                 TO  PI-PREV-CARRIER
  5416         IF CL-ASSOC-CERT-TOTAL > +1
  5417             MOVE CL-PRIME-CERT-PRIME    TO  PI-PRIME-CERT
  5418             MOVE CL-PRIME-CERT-SFX      TO  PI-PRIME-SUFX
  5419             MOVE 'PRIME CERT :'         TO  PI-PRIME-HDG
  5420             MOVE AL-SABON               TO  PRIMEHDA
  5421         ELSE
  5422             MOVE PI-CERT-NO             TO  PI-PRIME-CERT
  5423             MOVE PI-CERT-SFX            TO  PI-PRIME-SUFX
  5424             MOVE 'CERT NO/SFX:'         TO  PI-PRIME-HDG
  5425             MOVE AL-SABON               TO  PRIMEHDA.
  5426
  5427     IF CL-CLAIM-NO = PI-PREV-CLAIM-NO AND
  5428        CL-CARRIER  = PI-PREV-CARRIER
  5429         NEXT SENTENCE
  5430     ELSE
  5431         MOVE HIGH-VALUES        TO  WS-RECORDED-DT (SUB-2)
  5432         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5433         MOVE SUB-2              TO  WS-MAX-SUB
  5434                                     PI-MAX-SUB
  5435         MOVE 1                  TO  SUB-2 SUB-3
  5436         GO TO 0950-SORT-ROUTINE.
  5437
  5438     IF SUB-2 > 200
  5439         MOVE 200                TO  WS-MAX-SUB
  5440                                     PI-MAX-SUB
  5441         MOVE 'Y'                TO  PI-FIRST-TIME-SW
  5442         MOVE 1                  TO  SUB-2 SUB-3
  5443         GO TO 0950-SORT-ROUTINE.
  5444
  5445     MOVE LOW-VALUES             TO  ELTRLR-KEY.
  5446     MOVE CL-COMPANY-CD          TO  TRLR-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL1502.cbl
  5447     MOVE CL-CARRIER             TO  TRLR-CARRIER.
  5448     MOVE CL-CLAIM-NO            TO  TRLR-CLAIM-NO.
  5449     MOVE CL-CERT-NO             TO  TRLR-CERT-NO.
  5450     MOVE ZEROS                  TO  TRLR-SEQ-NO.
  5451
  5452     PERFORM 0925-BUILD-TRAILER-TABLE THRU 0949-BUILD-TABLE-EXIT.
  5453     GO TO 0910-READNEXT-CLAIM-MASTER.
  5454
  5455 0915-ELMSTR-ENDFILE.
  5456
  5457
  5458* EXEC CICS ENDBR
  5459*        DATASET   ('ELMSTR')
  5460*    END-EXEC.
  5461     MOVE 'ELMSTR' TO DFHEIV1
  5462     MOVE 0
  5463       TO DFHEIV11
  5464*    MOVE '&2                    $   #00005262' TO DFHEIV0
  5465     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5466     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5467     MOVE X'2020233030303035323632' TO DFHEIV0(25:11)
  5468     CALL 'kxdfhei1' USING DFHEIV0,
  5469           DFHEIV1,
  5470           DFHEIV11,
  5471           DFHEIV99
  5472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5473
  5474
  5475     MOVE HIGH-VALUES            TO  WS-RECORDED-DT (SUB-2).
  5476     MOVE 'Y'                    TO  PI-FIRST-TIME-SW.
  5477     MOVE SUB-2                  TO  WS-MAX-SUB
  5478                                     PI-MAX-SUB.
  5479     MOVE 1                      TO  SUB-2   SUB-3.
  5480     GO TO 0950-SORT-ROUTINE.
  5481
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL1502.cbl
  5483 0925-BUILD-TRAILER-TABLE.
  5484
  5485
  5486* EXEC CICS HANDLE CONDITION
  5487*        ENDFILE   (0945-ENDBR-ELTRLR)
  5488*    END-EXEC.
  5489*    MOVE '"$''                   ! ( #00005276' TO DFHEIV0
  5490     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  5491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5492     MOVE X'2820233030303035323736' TO DFHEIV0(25:11)
  5493     CALL 'kxdfhei1' USING DFHEIV0
  5494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5495
  5496
  5497
  5498* EXEC CICS STARTBR
  5499*        DATASET   ('ELTRLR')
  5500*        RIDFLD    (ELTRLR-KEY)
  5501*    END-EXEC.
  5502     MOVE 'ELTRLR' TO DFHEIV1
  5503     MOVE 0
  5504       TO DFHEIV11
  5505*    MOVE '&,         G          &   #00005280' TO DFHEIV0
  5506     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5507     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5508     MOVE X'2020233030303035323830' TO DFHEIV0(25:11)
  5509     CALL 'kxdfhei1' USING DFHEIV0,
  5510           DFHEIV1,
  5511           ELTRLR-KEY,
  5512           DFHEIV99,
  5513           DFHEIV11,
  5514           DFHEIV99
  5515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5516
  5517
  5518 0935-READNEXT-TRAILER.
  5519
  5520
  5521* EXEC CICS READNEXT
  5522*        DATASET   ('ELTRLR')
  5523*        RIDFLD    (ELTRLR-KEY)
  5524*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5525*    END-EXEC.
  5526     MOVE 'ELTRLR' TO DFHEIV1
  5527     MOVE 0
  5528       TO DFHEIV11
  5529*    MOVE '&.S                   )   #00005287' TO DFHEIV0
  5530     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5532     MOVE X'2020233030303035323837' TO DFHEIV0(25:11)
  5533     CALL 'kxdfhei1' USING DFHEIV0,
  5534           DFHEIV1,
  5535           DFHEIV20,
  5536           DFHEIV99,
  5537           ELTRLR-KEY,
  5538           DFHEIV99,
  5539           DFHEIV11,
  5540           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL1502.cbl
  5541           DFHEIV99
  5542     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5543         DFHEIV20
  5544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5545
  5546
  5547     IF AT-COMPANY-CD NOT = CL-COMPANY-CD OR
  5548        AT-CARRIER    NOT = CL-CARRIER    OR
  5549        AT-CLAIM-NO   NOT = CL-CLAIM-NO   OR
  5550        AT-CERT-NO    NOT = CL-CERT-NO
  5551         GO TO 0945-ENDBR-ELTRLR.
  5552
  5553     MOVE 'Y'                    TO  WS-ENDBR-SW.
  5554
  5555     IF TRLR-SEQ-NO = 90
  5556         GO TO 0935-READNEXT-TRAILER.
  5557
  5558     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
  5559         GO TO 0935-READNEXT-TRAILER.
  5560
  5561     IF GENERAL-INFO-TR
  5562         IF AT-PAYMENT-NOTE
  5563             GO TO 0935-READNEXT-TRAILER.
  5564
  5565     IF AUTO-PROMPT-TR
  5566         IF SAVE-BIN-DATE > AT-PROMPT-END-DT
  5567             GO TO 0935-READNEXT-TRAILER.
  5568
  5569     MOVE AT-CERT-NO             TO  WS-CERT-NO     (SUB-2).
  5570     MOVE AT-SEQUENCE-NO         TO  WS-TRLR-SEQ    (SUB-2).
  5571     MOVE AT-RECORDED-DT         TO  WS-RECORDED-DT (SUB-2).
  5572
  5573     ADD +1 TO SUB-2.
  5574
  5575     IF SUB-2 > 200
  5576         GO TO 0945-ENDBR-ELTRLR.
  5577
  5578     GO TO 0935-READNEXT-TRAILER.
  5579
  5580 0945-ENDBR-ELTRLR.
  5581
  5582     IF WS-ENDBR-SW = 'N'
  5583         GO TO 0949-BUILD-TABLE-EXIT.
  5584
  5585
  5586* EXEC CICS ENDBR
  5587*        DATASET   ('ELTRLR')
  5588*    END-EXEC.
  5589     MOVE 'ELTRLR' TO DFHEIV1
  5590     MOVE 0
  5591       TO DFHEIV11
  5592*    MOVE '&2                    $   #00005331' TO DFHEIV0
  5593     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5594     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5595     MOVE X'2020233030303035333331' TO DFHEIV0(25:11)
  5596     CALL 'kxdfhei1' USING DFHEIV0,
  5597           DFHEIV1,
  5598           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL1502.cbl
  5599           DFHEIV99
  5600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5601
  5602
  5603 0949-BUILD-TABLE-EXIT.
  5604     EXIT.
  5605
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL1502.cbl
  5607 0950-SORT-ROUTINE.
  5608     IF PI-FIRST-TIME-SW = 'Y'
  5609         MOVE 'N'                        TO  PI-FIRST-TIME-SW
  5610         IF WS-SORTED-SW (SUB-2) = 'Y'
  5611             ADD 1 TO SUB-2
  5612             IF (SUB-3 > 200 OR
  5613                 SUB-3 > WS-MAX-SUB)
  5614                 MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  5615                 PERFORM 0700-CREATE-TEMP-STORAGE THRU 0700-EXIT
  5616                 GO TO 0990-SORT-EXIT
  5617             ELSE
  5618                 MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  5619                 GO TO 0950-SORT-ROUTINE
  5620         ELSE
  5621             MOVE WS-RECORDED-DT (SUB-2) TO  HOLD-RECORDED-DT
  5622             MOVE SUB-2                  TO  HOLD-SUB
  5623             GO TO 0950-SORT-ROUTINE
  5624     ELSE
  5625         ADD 1 TO SUB-2
  5626         IF SUB-3 > 200
  5627             MOVE 'Y'                    TO  PI-FIRST-TIME-SW
  5628             PERFORM 0700-CREATE-TEMP-STORAGE THRU 0700-EXIT
  5629             GO TO 0990-SORT-EXIT.
  5630
  5631     IF WS-SORTED-SW (SUB-2) = 'Y'
  5632         GO TO 0950-SORT-ROUTINE.
  5633
  5634     IF SUB-3 > WS-MAX-SUB
  5635         MOVE 'Y'            TO  PI-FIRST-TIME-SW
  5636         PERFORM 0700-CREATE-TEMP-STORAGE THRU 0700-EXIT
  5637         GO TO 0990-SORT-EXIT.
  5638
  5639     IF WS-RECORDED-DT (SUB-2) = HIGH-VALUES OR
  5640        SUB-2 > WS-MAX-SUB
  5641         MOVE WS-RECORDED-DT (HOLD-SUB) TO
  5642                                  WS-SRTD-RECORDED-DT (SUB-3)
  5643         MOVE WS-CERT-NO     (HOLD-SUB) TO
  5644                                  WS-SRTD-CERT        (SUB-3)
  5645         MOVE WS-TRLR-SEQ    (HOLD-SUB) TO
  5646                                  WS-SRTD-TRLR-SEQ    (SUB-3)
  5647         MOVE 'Y'            TO WS-SORTED-SW       (HOLD-SUB)
  5648                                PI-FIRST-TIME-SW
  5649         ADD 1               TO SUB-3
  5650         MOVE 1              TO SUB-2
  5651         GO TO 0950-SORT-ROUTINE.
  5652
  5653     IF WS-RECORDED-DT (SUB-2) > HOLD-RECORDED-DT
  5654         MOVE WS-RECORDED-DT (SUB-2) TO  HOLD-RECORDED-DT
  5655         MOVE SUB-2                  TO  HOLD-SUB
  5656         GO TO 0950-SORT-ROUTINE.
  5657
  5658     GO TO 0950-SORT-ROUTINE.
  5659
  5660 0990-SORT-EXIT.
  5661     EXIT.
  5662
  5663 0999-RELATED-EXIT.
  5664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL1502.cbl
  5665
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL1502.cbl
  5667 1000-SHOW-CLAIM-HISTORY.
  5668
  5669     IF DIRECTION-SWITCH = 'F'
  5670         IF FIRST-TIME
  5671             PERFORM 2070-INIT-SCREEN-AREA THRU 2070-EXIT
  5672             MOVE 'N'                TO  PI-FIRST-TIME-SW
  5673             MOVE +1                 TO  DISPLAY-CNT
  5674                                         SUB-1
  5675                                         SUB-2
  5676         ELSE
  5677             MOVE PI-TRLR-SUB (8)    TO  SUB-2
  5678             ADD +1                  TO  SUB-2
  5679             IF SUB-2 > PI-MAX-SUB
  5680                 GO TO 8200-SEND-DATAONLY
  5681             ELSE
  5682                 PERFORM 2070-INIT-SCREEN-AREA THRU 2070-EXIT
  5683                 MOVE +1                 TO  DISPLAY-CNT
  5684                                             SUB-1
  5685                                             PI-LINE-NO
  5686                 IF SUB-2 = +9
  5687                    IF WS-SRTD-CERT (SUB-2) = LOW-VALUES
  5688                     MOVE +1             TO  SUB-2.
  5689
  5690     IF DIRECTION-SWITCH = 'B'
  5691         IF FIRST-TIME
  5692             GO TO 8200-SEND-DATAONLY
  5693         ELSE
  5694             PERFORM 2070-INIT-SCREEN-AREA THRU 2070-EXIT
  5695             MOVE PI-TRLR-SUB (1)    TO  SUB-2
  5696             IF SUB-2 > +8
  5697                 SUBTRACT +1        FROM SUB-2
  5698                 MOVE +15            TO  DISPLAY-CNT
  5699                 MOVE +8             TO  SUB-1
  5700                                         PI-LINE-NO
  5701             ELSE
  5702                 MOVE 'F'            TO  DIRECTION-SWITCH
  5703                 MOVE +1             TO  DISPLAY-CNT
  5704                                         SUB-1
  5705                                         SUB-2
  5706                                         PI-LINE-NO.
  5707
  5708 1010-BUILD-HISTORY-SCREEN.
  5709
  5710     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
  5711
  5712     MOVE PI-CARRIER             TO  CARRO.
  5713     MOVE PI-CLAIM-NO            TO  CLMNOO.
  5714
  5715     MOVE -1                     TO  LINENOL.
  5716
  5717     IF RECORDS-READ
  5718         MOVE 'N'                TO  WS-RECORDS-READ-SW
  5719         GO TO 8100-SEND-INITIAL-MAP
  5720     ELSE
  5721         GO TO 8200-SEND-DATAONLY.
  5722
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL1502.cbl
  5724 2000-BUILD-TRAILER-DISPLAY.
  5725
  5726     IF WS-SRTD-CERT (SUB-2) = LOW-VALUES OR
  5727        SUB-2 > PI-MAX-SUB
  5728         GO TO 2999-EXIT.
  5729
  5730     MOVE PI-COMPANY-CD              TO  TRLR-COMP-CD.
  5731     MOVE PI-CARRIER                 TO  TRLR-CARRIER.
  5732     MOVE PI-CLAIM-NO                TO  TRLR-CLAIM-NO.
  5733     MOVE WS-SRTD-CERT (SUB-2)       TO  TRLR-CERT-NO.
  5734     MOVE WS-SRTD-TRLR-SEQ (SUB-2)   TO  TRLR-SEQ-NO.
  5735     MOVE 'TRLR'                     TO  FILE-SWITCH.
  5736
  5737 2020-BROWSE-FORWARD.
  5738
  5739
  5740* EXEC CICS HANDLE CONDITION
  5741*        ENDFILE   (2950-NO-MORE-TRAILERS)
  5742*        NOTFND    (2950-NO-MORE-TRAILERS)
  5743*    END-EXEC.
  5744*    MOVE '"$''I                  ! ) #00005471' TO DFHEIV0
  5745     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  5746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5747     MOVE X'2920233030303035343731' TO DFHEIV0(25:11)
  5748     CALL 'kxdfhei1' USING DFHEIV0
  5749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5750
  5751
  5752
  5753* EXEC CICS READ
  5754*        DATASET   ('ELTRLR')
  5755*        RIDFLD    (ELTRLR-KEY)
  5756*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  5757*    END-EXEC.
  5758     MOVE 'ELTRLR' TO DFHEIV1
  5759*    MOVE '&"S        E          (   #00005476' TO DFHEIV0
  5760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5762     MOVE X'2020233030303035343736' TO DFHEIV0(25:11)
  5763     CALL 'kxdfhei1' USING DFHEIV0,
  5764           DFHEIV1,
  5765           DFHEIV20,
  5766           DFHEIV99,
  5767           ELTRLR-KEY,
  5768           DFHEIV99,
  5769           DFHEIV99,
  5770           DFHEIV99
  5771     SET ADDRESS OF ACTIVITY-TRAILERS TO
  5772         DFHEIV20
  5773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5774
  5775
  5776     MOVE 'Y'                    TO  WS-RECORDS-READ-SW.
  5777     GO TO 2090-DISPLAY-TRAILER.
  5778
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL1502.cbl
  5780 2070-INIT-SCREEN-AREA.
  5781
  5782     MOVE SPACES                 TO  TEXT-WORK-AREAS
  5783                                     MAP-HDG (1)   MAP-TEXT (1)
  5784                                     MAP-HDG (2)   MAP-TEXT (2)
  5785                                     MAP-HDG (3)   MAP-TEXT (3)
  5786                                     MAP-HDG (4)   MAP-TEXT (4)
  5787                                     MAP-HDG (5)   MAP-TEXT (5)
  5788                                     MAP-HDG (6)   MAP-TEXT (6)
  5789                                     MAP-HDG (7)   MAP-TEXT (7)
  5790                                     MAP-HDG (8)   MAP-TEXT (8)
  5791                                     MAP-HDG (9)   MAP-TEXT (9)
  5792                                     MAP-HDG (10)  MAP-TEXT (10)
  5793                                     MAP-HDG (11)  MAP-TEXT (11)
  5794                                     MAP-HDG (12)  MAP-TEXT (12)
  5795                                     MAP-HDG (13)  MAP-TEXT (13)
  5796                                     MAP-HDG (14)  MAP-TEXT (14)
  5797                                     MAP-HDG (15)  MAP-TEXT (15)
  5798                                     MAP-HDG (16)  MAP-TEXT (16).
  5799
  5800     MOVE ZEROS                  TO  PMT-AMT-PAID
  5801                                     AUTO-1ST-AMT
  5802                                     AUTO-REG-AMT
  5803                                     INCUR-TOT-PD.
  5804
  5805 2070-EXIT.
  5806     EXIT.
  5807
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL1502.cbl
  5809 2090-DISPLAY-TRAILER.
  5810
  5811     IF PAYMENT-TR
  5812         GO TO 2100-PAYMENT-TRAILER.
  5813
  5814     IF AUTO-PAY-TR
  5815        GO TO 2200-AUTO-PAYMENT-TRAILER.
  5816
  5817     IF CORRESPONDENCE-TR
  5818         GO TO 2300-CORRESPONDENCE-TRAILER.
  5819
  5820     IF GENERAL-INFO-TR
  5821         GO TO 2400-GENERAL-INFO-TRAILER.
  5822
  5823     IF AUTO-PROMPT-TR
  5824         GO TO 2500-AUTO-PROMPT-TRAILER.
  5825
  5826     IF DENIAL-TR
  5827         GO TO 2600-DENIAL-TRAILER.
  5828
  5829     IF INCURRED-CHG-TR
  5830         GO TO 2700-INCURRED-CHANGE-TRAILER.
  5831
  5832     IF FORM-CONTROL-TR
  5833         GO TO 2710-FORM-CONTROL-TRAILER.
  5834
  5835     GO TO 2020-BROWSE-FORWARD.
  5836
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL1502.cbl
  5838 2100-PAYMENT-TRAILER.
  5839     MOVE SPACES                 TO  PMT-HDG1.
  5840     MOVE ZEROS                  TO  PMT-AMT-PAID.
  5841     MOVE PI-LINE-NO             TO  PMT-LINE-NO.
  5842     MOVE 'PAYMENT '             TO  PMT-HDG1-LIT.
  5843
  5844     MOVE SPACES                 TO  PMT-TEXT-1.
  5845     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  5846     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  5847     MOVE WS-FORMAT-CERT-NO      TO  PMT-CERT-NO.
  5848
  5849     MOVE ' TYPE: '              TO  PMT-TYPE-LIT.
  5850
  5851     IF TRANSFER
  5852        MOVE 'TRANSFR'           TO PMT-TYPE
  5853        GO TO 2100-CONT
  5854     ELSE
  5855        IF AT-PAYMENT-TYPE = 'I'
  5856           MOVE 'INTEREST'       TO PMT-TYPE
  5857           GO TO 2100-CONT
  5858        END-IF
  5859     END-IF
  5860
  5861     IF AT-CV-PMT-CODE = ' '
  5862         MOVE AT-PAYMENT-TYPE            TO  WS-SUB
  5863         IF WS-SUB < 1 OR > 9
  5864             MOVE 2                      TO  WS-SUB
  5865             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5866         ELSE
  5867             MOVE PAY-DESC (WS-SUB)      TO  PMT-TYPE
  5868     ELSE
  5869         MOVE AT-CV-PMT-CODE             TO  WS-SUB
  5870         IF WS-SUB < 1 OR > 8
  5871             MOVE 1                      TO  WS-SUB
  5872             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE
  5873         ELSE
  5874             MOVE CV-PAY-DESC (WS-SUB)   TO  PMT-TYPE.
  5875
  5876 2100-CONT.
  5877
  5878     MOVE ' CHECK NO: '          TO  PMT-CHECK-NO-LIT.
  5879     MOVE AT-CHECK-NO            TO  PMT-CHECK-NO.
  5880
  5881     MOVE ' AMT:'                TO  PMT-AMT-PD-LIT.
  5882     MOVE AT-AMOUNT-PAID         TO  PMT-AMT-PAID.
  5883     MOVE ' BY: '                TO  PMT-REC-BY-LIT.
  5884     MOVE AT-RECORDED-BY         TO  PMT-REC-BY.
  5885
  5886     MOVE SPACES                 TO  PMT-HDG2
  5887                                     PMT-TEXT-2.
  5888     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
  5889     MOVE ' '                    TO  DC-OPTION-CODE.
  5890     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  5891     IF NO-CONVERSION-ERROR
  5892         MOVE DC-GREG-DATE-1-EDIT    TO  PMT-REC-DT
  5893     ELSE
  5894         MOVE SPACES                 TO  PMT-REC-DT.
  5895
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL1502.cbl
  5896     IF AT-PAID-FROM-DT = LOW-VALUES OR SPACES
  5897         MOVE SPACES                     TO  PMT-PAID-FROM
  5898                                             PMT-FROM-LIT
  5899     ELSE
  5900         MOVE 'FROM: '                   TO  PMT-FROM-LIT
  5901         MOVE AT-PAID-FROM-DT            TO  DC-BIN-DATE-1
  5902         MOVE ' '                        TO  DC-OPTION-CODE
  5903         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5904         IF NO-CONVERSION-ERROR
  5905             MOVE DC-GREG-DATE-1-EDIT    TO PMT-PAID-FROM
  5906         ELSE
  5907             MOVE SPACES                 TO  PMT-PAID-FROM.
  5908
  5909     IF AT-PAID-THRU-DT = LOW-VALUES OR SPACES
  5910         MOVE SPACES                     TO  PMT-PAID-THRU
  5911                                             PMT-THRU-LIT
  5912     ELSE
  5913         IF PI-USES-PAID-TO
  5914             MOVE ' PAID TO: '           TO  PMT-THRU-LIT
  5915             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5916             MOVE '6'                    TO  DC-OPTION-CODE
  5917             MOVE +1                     TO  DC-ELAPSED-DAYS
  5918             MOVE +0                     TO  DC-ELAPSED-MONTHS
  5919             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5920             IF NO-CONVERSION-ERROR
  5921                 MOVE DC-GREG-DATE-1-EDIT TO PMT-PAID-THRU
  5922             ELSE
  5923                 MOVE SPACES             TO  PMT-PAID-THRU
  5924         ELSE
  5925             MOVE ' PD THRU: '           TO  PMT-THRU-LIT
  5926             MOVE AT-PAID-THRU-DT        TO  DC-BIN-DATE-1
  5927             MOVE ' '                    TO  DC-OPTION-CODE
  5928             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5929             IF NO-CONVERSION-ERROR
  5930                 MOVE DC-GREG-DATE-1-EDIT TO PMT-PAID-THRU
  5931             ELSE
  5932                 MOVE SPACES             TO  PMT-PAID-THRU.
  5933
  5934     IF INSURED-PAID
  5935         MOVE 'INS '             TO  PMT-PAYEE.
  5936     IF BENEFICIARY-PAID
  5937         MOVE 'BENE'             TO  PMT-PAYEE.
  5938     IF ACCOUNT-PAID
  5939         MOVE 'ACCT'             TO  PMT-PAYEE.
  5940     IF OTHER-1-PAID
  5941         MOVE 'OTH1'             TO  PMT-PAYEE.
  5942     IF OTHER-2-PAID
  5943         MOVE 'OTH2'             TO  PMT-PAYEE.
  5944     IF DOCTOR-PAID
  5945         MOVE 'DOC '             TO  PMT-PAYEE.
  5946     IF EMPLOYER-PAID
  5947         MOVE 'EMP '             TO  PMT-PAYEE.
  5948
  5949     IF AT-VOID-DT = LOW-VALUES OR SPACES
  5950         NEXT SENTENCE
  5951     ELSE
  5952         IF AT-VOID-TYPE = 'S'
  5953             MOVE ' ST PAY: '            TO  PMT-VOID-LIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL1502.cbl
  5954         ELSE
  5955             MOVE ' VOIDED: '            TO  PMT-VOID-LIT.
  5956
  5957     IF AT-VOID-DT = LOW-VALUES OR SPACES
  5958         MOVE SPACES                     TO  PMT-VOID-DT
  5959                                             PMT-VOID-LIT
  5960     ELSE
  5961         MOVE AT-VOID-DT                 TO  DC-BIN-DATE-1
  5962         MOVE ' '                        TO  DC-OPTION-CODE
  5963         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5964         IF NO-CONVERSION-ERROR
  5965             MOVE DC-GREG-DATE-1-EDIT    TO  PMT-VOID-DT
  5966         ELSE
  5967             MOVE SPACES                 TO  PMT-VOID-DT.
  5968
  5969     MOVE PMT-HDG1               TO  MAP-HDG        (DISPLAY-CNT).
  5970     MOVE PMT-TEXT-1             TO  MAP-TEXT       (DISPLAY-CNT).
  5971     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  5972     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  5973     ADD +1 TO DISPLAY-CNT.
  5974     MOVE PMT-HDG2               TO  MAP-HDG        (DISPLAY-CNT).
  5975     MOVE PMT-TEXT-2             TO  MAP-TEXT       (DISPLAY-CNT).
  5976     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  5977                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  5978     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  5979     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  5980     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  5981     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  5982     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  5983
  5984     GO TO 2800-INCR-DISPLAY-CNT.
  5985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL1502.cbl
  5987 2200-AUTO-PAYMENT-TRAILER.
  5988     MOVE SPACES                 TO  AUTO-PMT-HDG1.
  5989     MOVE PI-LINE-NO             TO  AUTO-LINE-NO.
  5990     MOVE 'AUTO PMT'             TO  AUTO-HDG1-LIT.
  5991
  5992     MOVE SPACES                 TO  AUTO-PMT-TEXT1.
  5993     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  5994     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  5995     MOVE WS-FORMAT-CERT-NO      TO  AUTO-CERT-NO.
  5996
  5997     IF AT-SCHEDULE-START-DT = LOW-VALUES OR SPACES
  5998         MOVE SPACES                     TO  AUTO-EFF-DT
  5999                                             AUTO-EFF-DT-LIT
  6000     ELSE
  6001         MOVE ' EFF : '                  TO  AUTO-EFF-DT-LIT
  6002         MOVE AT-SCHEDULE-START-DT       TO  DC-BIN-DATE-1
  6003         MOVE ' '                        TO  DC-OPTION-CODE
  6004         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6005         IF NO-CONVERSION-ERROR
  6006             MOVE DC-GREG-DATE-1-EDIT    TO  AUTO-EFF-DT
  6007         ELSE
  6008             MOVE SPACES                 TO  AUTO-EFF-DT.
  6009
  6010     IF AT-1ST-PAY-THRU-DT = LOW-VALUES OR SPACES
  6011         MOVE SPACES                     TO  AUTO-1ST-PMT-DT
  6012                                             AUTO-1ST-PMT-LIT
  6013     ELSE
  6014         MOVE ' 1ST PMT: '               TO  AUTO-1ST-PMT-LIT
  6015         IF PI-USES-PAID-TO
  6016             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  6017             MOVE '6'                    TO  DC-OPTION-CODE
  6018             MOVE +1                     TO  DC-ELAPSED-DAYS
  6019             MOVE +0                     TO  DC-ELAPSED-MONTHS
  6020             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6021             IF NO-CONVERSION-ERROR
  6022                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  6023             ELSE
  6024                 MOVE SPACES             TO  AUTO-1ST-PMT-DT
  6025         ELSE
  6026             MOVE AT-1ST-PAY-THRU-DT     TO  DC-BIN-DATE-1
  6027             MOVE ' '                    TO  DC-OPTION-CODE
  6028             MOVE +0                     TO  DC-ELAPSED-DAYS
  6029                                             DC-ELAPSED-MONTHS
  6030             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6031             IF NO-CONVERSION-ERROR
  6032                 MOVE DC-GREG-DATE-1-EDIT TO AUTO-1ST-PMT-DT
  6033             ELSE
  6034                 MOVE SPACES             TO  AUTO-1ST-PMT-DT.
  6035
  6036     MOVE ' AMT: '               TO  AUTO-1ST-AMT-LIT.
  6037     MOVE AT-FIRST-PMT-AMT       TO  AUTO-1ST-AMT.
  6038
  6039     MOVE ' BY: '                TO  AUTO-REC-BY-LIT.
  6040     MOVE AT-RECORDED-BY         TO  AUTO-REC-BY.
  6041
  6042     MOVE SPACES                 TO  AUTO-PMT-HDG2
  6043                                     AUTO-PMT-TEXT2.
  6044     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL1502.cbl
  6045     MOVE ' '                    TO  DC-OPTION-CODE.
  6046     MOVE +0                     TO  DC-ELAPSED-DAYS
  6047                                     DC-ELAPSED-MONTHS.
  6048     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6049     IF NO-CONVERSION-ERROR
  6050         MOVE DC-GREG-DATE-1-EDIT    TO  AUTO-REC-DT
  6051     ELSE
  6052         MOVE SPACES                 TO  AUTO-REC-DT.
  6053
  6054     IF AT-TERMINATED-DT = LOW-VALUES OR SPACES
  6055         IF AT-SCHEDULE-END-DT = LOW-VALUES
  6056             MOVE SPACES                     TO  AUTO-LST-PMT-DT
  6057         ELSE
  6058             MOVE 'END : '                   TO  AUTO-LST-PMT-LIT
  6059             IF PI-USES-PAID-TO
  6060                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  6061                 MOVE '6'                    TO  DC-OPTION-CODE
  6062                 MOVE +1                     TO  DC-ELAPSED-DAYS
  6063                 MOVE +0                     TO  DC-ELAPSED-MONTHS
  6064                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6065                 IF NO-CONVERSION-ERROR
  6066                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  6067                 ELSE
  6068                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  6069             ELSE
  6070                 MOVE AT-SCHEDULE-END-DT     TO  DC-BIN-DATE-1
  6071                 MOVE ' '                    TO  DC-OPTION-CODE
  6072                 MOVE +0                     TO  DC-ELAPSED-DAYS
  6073                                                 DC-ELAPSED-MONTHS
  6074                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6075                 IF NO-CONVERSION-ERROR
  6076                     MOVE DC-GREG-DATE-1-EDIT TO AUTO-LST-PMT-DT
  6077                 ELSE
  6078                     MOVE SPACES             TO  AUTO-LST-PMT-DT
  6079     ELSE
  6080         MOVE ' TERM: '                      TO  AUTO-LST-PMT-LIT
  6081         MOVE AT-TERMINATED-DT               TO  DC-BIN-DATE-1
  6082         MOVE ' '                            TO  DC-OPTION-CODE
  6083         MOVE +0                             TO  DC-ELAPSED-DAYS
  6084                                                 DC-ELAPSED-MONTHS
  6085         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6086         IF NO-CONVERSION-ERROR
  6087             MOVE DC-GREG-DATE-1-EDIT        TO  AUTO-LST-PMT-DT
  6088         ELSE
  6089             MOVE SPACES                     TO  AUTO-LST-PMT-DT.
  6090
  6091     MOVE ' STATUS : '           TO  AUTO-STATUS-LIT.
  6092
  6093     IF AT-TERMINATED-DT NOT = LOW-VALUES
  6094         MOVE 'TERM'             TO  AUTO-STATUS
  6095     ELSE
  6096         MOVE 'ACTIVE'           TO  AUTO-STATUS.
  6097
  6098     MOVE '   REG: '             TO  AUTO-REG-AMT-LIT.
  6099     MOVE AT-REGULAR-PMT-AMT     TO  AUTO-REG-AMT.
  6100
  6101     MOVE ' TO: '                TO  AUTO-PAYEE-LIT.
  6102
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL1502.cbl
  6103     IF INSURED-PAID-AUTO
  6104         MOVE ' INS '            TO  AUTO-PAYEE.
  6105     IF BENEFICIARY-PAID-AUTO
  6106         MOVE ' BENE'            TO  AUTO-PAYEE.
  6107     IF ACCOUNT-PAID-AUTO
  6108         MOVE ' ACCT'            TO  AUTO-PAYEE.
  6109     IF OTHER-1-PAID-AUTO
  6110         MOVE ' OTH1'            TO  AUTO-PAYEE.
  6111     IF OTHER-2-PAID
  6112         MOVE ' OTH2'            TO  AUTO-PAYEE.
  6113     IF DOCTOR-PAID
  6114         MOVE ' DOC '            TO  AUTO-PAYEE.
  6115
  6116     MOVE AUTO-PMT-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  6117     MOVE AUTO-PMT-TEXT1         TO  MAP-TEXT       (DISPLAY-CNT).
  6118     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6119     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6120     ADD +1 TO DISPLAY-CNT.
  6121     MOVE AUTO-PMT-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  6122     MOVE AUTO-PMT-TEXT2         TO  MAP-TEXT       (DISPLAY-CNT).
  6123     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6124                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6125     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6126     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6127     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6128     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6129     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6130
  6131     GO TO 2800-INCR-DISPLAY-CNT.
  6132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL1502.cbl
  6134 2300-CORRESPONDENCE-TRAILER.
  6135     MOVE SPACES                 TO  CORR-HDG1.
  6136     MOVE PI-LINE-NO             TO  CORR-LINE-NO.
  6137     MOVE 'LETTER'               TO  CORR-HDG1-LIT.
  6138
  6139     MOVE SPACES                 TO  CORR-TEXT-1.
  6140     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6141     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6142     MOVE WS-FORMAT-CERT-NO      TO  CORR-CERT-NO.
  6143
  6144     MOVE ' FORM: '              TO  CORR-FORM-LIT.
  6145     MOVE AT-STD-LETTER-FORM     TO  CORR-FORM-TYPE.
  6146
  6147     IF AT-LETTER-SENT-DT = LOW-VALUES OR SPACES
  6148         MOVE SPACES                     TO  CORR-DT-SENT
  6149                                             CORR-DT-SENT-LIT
  6150     ELSE
  6151         MOVE '  DT SENT: '              TO  CORR-DT-SENT-LIT
  6152         MOVE AT-LETTER-SENT-DT          TO  DC-BIN-DATE-1
  6153         MOVE ' '                        TO  DC-OPTION-CODE
  6154         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6155         IF NO-CONVERSION-ERROR
  6156             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-DT-SENT
  6157         ELSE
  6158             MOVE SPACES                 TO  CORR-DT-SENT.
  6159
  6160     IF AT-LETTER-PURGED-DT = LOW-VALUES OR SPACES
  6161       IF AT-LETTER-TO-BENE EQUAL 'Y'
  6162          MOVE ' LETTER TO BENE' TO CORR-LET-TO-BEN
  6163       ELSE
  6164         MOVE SPACES                     TO  CORR-PURGE-DT
  6165                                             CORR-PURGE-LIT
  6166       END-IF
  6167     ELSE
  6168         MOVE ' PUR: '                   TO  CORR-PURGE-LIT
  6169         MOVE AT-LETTER-PURGED-DT        TO  DC-BIN-DATE-1
  6170         MOVE ' '                        TO  DC-OPTION-CODE
  6171         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6172         IF NO-CONVERSION-ERROR
  6173             MOVE DC-GREG-DATE-1-EDIT    TO  CORR-PURGE-DT
  6174         ELSE
  6175             MOVE SPACES                 TO  CORR-PURGE-DT.
  6176
  6177     MOVE ' BY: '                TO  CORR-REC-BY-LIT.
  6178     MOVE AT-RECORDED-BY         TO  CORR-REC-BY.
  6179
  6180     MOVE SPACES                 TO  CORR-HDG2
  6181                                     CORR-TEXT-2.
  6182     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
  6183     MOVE ' '                    TO  DC-OPTION-CODE.
  6184     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6185     IF NO-CONVERSION-ERROR
  6186         MOVE DC-GREG-DATE-1-EDIT TO CORR-REC-DT
  6187     ELSE
  6188         MOVE SPACES             TO  CORR-REC-DT.
  6189
  6190     IF AT-RESEND-PRINT-DATE = LOW-VALUES OR SPACES
  6191         IF AT-AUTO-RE-SEND-DT = LOW-VALUES OR SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL1502.cbl
  6192             MOVE SPACES                    TO  CORR-RESEND-DT
  6193         ELSE
  6194             MOVE 'RSND: '                  TO  CORR-RESEND-LIT
  6195             MOVE AT-AUTO-RE-SEND-DT        TO  DC-BIN-DATE-1
  6196             MOVE ' '                       TO  DC-OPTION-CODE
  6197             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6198             IF NO-CONVERSION-ERROR
  6199                 MOVE DC-GREG-DATE-1-EDIT   TO  CORR-RESEND-DT
  6200             ELSE
  6201                 MOVE SPACES                TO  CORR-RESEND-DT
  6202     ELSE
  6203         MOVE 'RSNT :'                      TO  CORR-RESEND-LIT
  6204         MOVE AT-RESEND-PRINT-DATE          TO  DC-BIN-DATE-1
  6205         MOVE ' '                           TO  DC-OPTION-CODE
  6206         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6207         IF NO-CONVERSION-ERROR
  6208             MOVE DC-GREG-DATE-1-EDIT       TO  CORR-RESEND-DT
  6209         ELSE
  6210             MOVE SPACES                    TO  CORR-RESEND-DT.
  6211
  6212     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  6213        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
  6214             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
  6215           MOVE '    STOP:'             TO  CORR-RECVD-LIT
  6216           MOVE AT-STOP-LETTER-DT       TO  DC-BIN-DATE-1
  6217           MOVE ' '                     TO  DC-OPTION-CODE
  6218           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6219           IF NO-CONVERSION-ERROR
  6220              MOVE DC-GREG-DATE-1-EDIT  TO  CORR-RECVD-DT
  6221           ELSE
  6222              MOVE SPACES               TO  CORR-RECVD-DT
  6223                                            CORR-RECVD-LIT
  6224           END-IF
  6225     ELSE
  6226        IF AT-LETTER-ANSWERED-DT = LOW-VALUES
  6227            MOVE SPACES                 TO  CORR-RECVD-DT
  6228                                            CORR-RECVD-LIT
  6229        ELSE
  6230            MOVE ' RECVD  : '           TO  CORR-RECVD-LIT
  6231            MOVE AT-LETTER-ANSWERED-DT  TO  DC-BIN-DATE-1
  6232            MOVE ' '                    TO  DC-OPTION-CODE
  6233            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6234            IF NO-CONVERSION-ERROR
  6235                MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD-DT
  6236            ELSE
  6237                MOVE SPACES             TO  CORR-RECVD-DT
  6238                                            CORR-RECVD-LIT
  6239            END-IF
  6240        END-IF
  6241     END-IF.
  6242
  6243     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES
  6244         MOVE SPACES                    TO  CORR-FOLLOW-UP-DT
  6245                                            CORR-FOLLOW-UP-LIT
  6246     ELSE
  6247         MOVE ' FOL: '                  TO  CORR-FOLLOW-UP-LIT
  6248         MOVE AT-RECEIPT-FOLLOW-UP      TO  DC-BIN-DATE-1
  6249         MOVE ' '                       TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL1502.cbl
  6250         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6251         IF NO-CONVERSION-ERROR
  6252             MOVE DC-GREG-DATE-1-EDIT   TO  CORR-FOLLOW-UP-DT
  6253         ELSE
  6254             MOVE SPACES                TO  CORR-FOLLOW-UP-DT.
  6255
  6256     MOVE ' TO: '                       TO  CORR-ADDRESEE-LIT.
  6257
  6258     IF AT-ADDRESEE-TYPE = 'I'
  6259         MOVE 'INS '                    TO  CORR-ADDRESEE
  6260     ELSE
  6261     IF AT-ADDRESEE-TYPE = 'B'
  6262         MOVE 'BENE'                    TO  CORR-ADDRESEE
  6263     ELSE
  6264     IF AT-ADDRESEE-TYPE = 'A'
  6265         MOVE 'ACCT'                    TO  CORR-ADDRESEE
  6266     ELSE
  6267     IF AT-ADDRESEE-TYPE = 'P'
  6268         MOVE 'DOC '                    TO  CORR-ADDRESEE
  6269     ELSE
  6270     IF AT-ADDRESEE-TYPE = 'E'
  6271         MOVE 'EMP '                    TO  CORR-ADDRESEE
  6272     ELSE
  6273     IF AT-ADDRESEE-TYPE = 'O'
  6274         MOVE 'OTH1'                    TO  CORR-ADDRESEE
  6275     ELSE
  6276         MOVE 'OTH2'                    TO  CORR-ADDRESEE.
  6277
  6278     MOVE CORR-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  6279     MOVE CORR-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
  6280     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6281     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6282     ADD +1 TO DISPLAY-CNT.
  6283     MOVE CORR-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  6284     MOVE CORR-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
  6285     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6286                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6287     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6288     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6289     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6290     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6291     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6292
  6293     GO TO 2800-INCR-DISPLAY-CNT.
  6294
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL1502.cbl
  6296 2400-GENERAL-INFO-TRAILER.
  6297
  6298     MOVE SPACES                 TO  GEN-INFO-LINE-1
  6299                                     GEN-INFO-LINE-2.
  6300     MOVE PI-LINE-NO             TO  GI-LINE-NO.
  6301
  6302     IF AT-MAINT-NOTE
  6303         MOVE 'MAINT'            TO  GI-HDG1-LIT
  6304     ELSE
  6305     IF AT-CALL-NOTE
  6306         MOVE 'CALL'             TO  GI-HDG1-LIT
  6307         IF AT-PHONE-CALL-IN
  6308             MOVE '     IN'      TO  GI-HDG2-LIT
  6309           ELSE
  6310             MOVE '     OUT'     TO  GI-HDG2-LIT
  6311     ELSE
  6312     IF AT-CERT-CHANGE
  6313         MOVE 'CERT CHG'         TO  GI-HDG1-LIT
  6314     ELSE
  6315         MOVE 'NOTE'             TO  GI-HDG1-LIT.
  6316
  6317     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6318     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6319     MOVE WS-FORMAT-CERT-NO      TO  GEN-INFO-CERT-NO.
  6320
  6321     MOVE ' MSG : '              TO  GEN-INFO-MSG-1-LIT.
  6322     MOVE AT-INFO-LINE-1         TO  GEN-INFO-MSG-1.
  6323     MOVE ' BY: '                TO  GEN-INFO-REC-BY-LIT.
  6324     MOVE AT-RECORDED-BY         TO  GEN-INFO-REC-BY.
  6325
  6326     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
  6327     MOVE ' '                    TO  DC-OPTION-CODE.
  6328     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6329     IF NO-CONVERSION-ERROR
  6330         MOVE DC-GREG-DATE-1-EDIT TO GEN-INFO-REC-DT
  6331     ELSE
  6332         MOVE SPACES             TO  GEN-INFO-REC-DT.
  6333
  6334     MOVE 'MSG : '               TO  GEN-INFO-MSG-2-LIT.
  6335     MOVE AT-INFO-LINE-2         TO  GEN-INFO-MSG-2.
  6336
  6337     MOVE GEN-INFO-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  6338     MOVE GEN-INFO-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  6339     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6340     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6341     ADD +1 TO DISPLAY-CNT.
  6342     MOVE GEN-INFO-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  6343     MOVE GEN-INFO-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  6344     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6345                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6346     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6347     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6348     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6349     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6350     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6351
  6352     GO TO 2800-INCR-DISPLAY-CNT.
  6353
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL1502.cbl
  6355 2500-AUTO-PROMPT-TRAILER.
  6356
  6357     MOVE SPACES                 TO  REMINDER-HDG1.
  6358     MOVE PI-LINE-NO             TO  REM-LINE-NO.
  6359     MOVE 'REMINDER'             TO  REM-HDG1-LIT.
  6360
  6361     MOVE SPACES                 TO  REMINDER-TEXT-1.
  6362     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6363     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6364     MOVE WS-FORMAT-CERT-NO      TO  REM-CERT-NO.
  6365
  6366     MOVE ' LN 1: '              TO  REM-LINE-1-LIT.
  6367     MOVE AT-PROMPT-LINE-1       TO  REM-LINE-1.
  6368     MOVE ' BY: '                TO  REM-REC-BY-LIT.
  6369     MOVE AT-RECORDED-BY         TO  REM-REC-BY.
  6370
  6371     MOVE SPACES                 TO  REMINDER-HDG2
  6372                                     REMINDER-TEXT-2.
  6373     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
  6374     MOVE ' '                    TO  DC-OPTION-CODE.
  6375     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6376     IF NO-CONVERSION-ERROR
  6377         MOVE DC-GREG-DATE-1-EDIT TO REM-REC-DT
  6378     ELSE
  6379         MOVE SPACES             TO  REM-REC-DT.
  6380
  6381     MOVE 'LN 2: '               TO  REM-LINE-2-LIT.
  6382     MOVE AT-PROMPT-LINE-2       TO  REM-LINE-2.
  6383
  6384     MOVE REMINDER-HDG1          TO  MAP-HDG        (DISPLAY-CNT).
  6385     MOVE REMINDER-TEXT-1        TO  MAP-TEXT       (DISPLAY-CNT).
  6386     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6387     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6388     ADD +1 TO DISPLAY-CNT.
  6389     MOVE REMINDER-HDG2          TO  MAP-HDG        (DISPLAY-CNT).
  6390     MOVE REMINDER-TEXT-2        TO  MAP-TEXT       (DISPLAY-CNT).
  6391     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6392                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6393     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6394     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6395     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6396     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6397     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6398
  6399     GO TO 2800-INCR-DISPLAY-CNT.
  6400
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL1502.cbl
  6402 2600-DENIAL-TRAILER.
  6403     MOVE SPACES                 TO  DENIAL-HDG1.
  6404     MOVE PI-LINE-NO             TO  DENIAL-LINE-NO.
  6405     MOVE 'DENIAL'               TO  DENIAL-HDG1-LIT.
  6406
  6407     MOVE SPACES                 TO  DENIAL-TEXT-1.
  6408     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6409     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6410     MOVE WS-FORMAT-CERT-NO      TO  DENIAL-CERT-NO.
  6411
  6412     MOVE ' LN 1: '              TO  DENIAL-LN1-LIT.
  6413     MOVE AT-DENIAL-INFO-1       TO  DENIAL-LN1.
  6414     MOVE ' BY: '                TO  DENIAL-REC-BY-LIT.
  6415     MOVE AT-RECORDED-BY         TO  DENIAL-REC-BY.
  6416
  6417     MOVE SPACES                 TO  DENIAL-HDG2
  6418                                     DENIAL-TEXT-2.
  6419     MOVE AT-RECORDED-DT         TO  DC-BIN-DATE-1.
  6420     MOVE ' '                    TO  DC-OPTION-CODE.
  6421     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6422     IF NO-CONVERSION-ERROR
  6423         MOVE DC-GREG-DATE-1-EDIT TO DENIAL-REC-DT
  6424     ELSE
  6425         MOVE SPACES             TO  DENIAL-REC-DT.
  6426
  6427     MOVE 'LN 2: '               TO  DENIAL-LN2-LIT.
  6428     MOVE AT-DENIAL-INFO-2       TO  DENIAL-LN2.
  6429
  6430     MOVE DENIAL-HDG1            TO  MAP-HDG        (DISPLAY-CNT).
  6431     MOVE DENIAL-TEXT-1          TO  MAP-TEXT       (DISPLAY-CNT).
  6432     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6433     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6434     ADD +1 TO DISPLAY-CNT.
  6435     MOVE DENIAL-HDG2            TO  MAP-HDG        (DISPLAY-CNT).
  6436     MOVE DENIAL-TEXT-2          TO  MAP-TEXT       (DISPLAY-CNT).
  6437     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6438                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6439     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6440     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6441     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6442     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6443     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6444
  6445     GO TO 2800-INCR-DISPLAY-CNT.
  6446
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL1502.cbl
  6448 2700-INCURRED-CHANGE-TRAILER.
  6449     MOVE SPACES                 TO  INCUR-CHG-HDG1.
  6450     MOVE PI-LINE-NO             TO  INCUR-LINE-NO.
  6451     MOVE 'INCUR CG'             TO  INCUR-HDG1-LIT.
  6452
  6453     MOVE SPACES                 TO  INCUR-TEXT-1.
  6454     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6455     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6456     MOVE WS-FORMAT-CERT-NO      TO  INCUR-CERT-NO.
  6457
  6458     IF AT-OLD-INCURRED-DT = LOW-VALUES OR SPACES
  6459         MOVE SPACES                     TO  INCUR-INCUR-DT
  6460                                             INCUR-INCUR-LIT
  6461     ELSE
  6462         MOVE ' INCR: '                  TO  INCUR-INCUR-LIT
  6463         MOVE AT-OLD-INCURRED-DT         TO  DC-BIN-DATE-1
  6464         MOVE ' '                        TO  DC-OPTION-CODE
  6465         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6466         IF NO-CONVERSION-ERROR
  6467             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-INCUR-DT
  6468         ELSE
  6469             MOVE SPACES                 TO  INCUR-INCUR-DT.
  6470
  6471     IF AT-OLD-REPORTED-DT = LOW-VALUES OR SPACES
  6472         MOVE SPACES                     TO  INCUR-REPORT-DT
  6473                                             INCUR-REPORT-LIT
  6474     ELSE
  6475         MOVE ' REPORT : '               TO  INCUR-REPORT-LIT
  6476         MOVE AT-OLD-REPORTED-DT         TO  DC-BIN-DATE-1
  6477         MOVE ' '                        TO  DC-OPTION-CODE
  6478         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6479         IF NO-CONVERSION-ERROR
  6480             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-REPORT-DT
  6481         ELSE
  6482             MOVE SPACES                 TO  INCUR-REPORT-DT.
  6483
  6484     IF AT-OLD-ESTABLISHED-DT = LOW-VALUES OR SPACES
  6485         MOVE SPACES                     TO  INCUR-ESTAB-DT
  6486                                             INCUR-ESTAB-LIT
  6487     ELSE
  6488         MOVE ' EST: '                   TO  INCUR-ESTAB-LIT
  6489         MOVE AT-OLD-ESTABLISHED-DT      TO  DC-BIN-DATE-1
  6490         MOVE ' '                        TO  DC-OPTION-CODE
  6491         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6492         IF NO-CONVERSION-ERROR
  6493             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-ESTAB-DT
  6494         ELSE
  6495             MOVE SPACES                 TO  INCUR-ESTAB-DT.
  6496
  6497     MOVE ' BY: '                        TO  INCUR-REC-BY-LIT.
  6498     MOVE AT-RECORDED-BY                 TO  INCUR-REC-BY.
  6499
  6500     MOVE SPACES                         TO  INCUR-CHG-HDG2
  6501                                             INCUR-TEXT-2.
  6502     MOVE AT-RECORDED-DT                 TO  DC-BIN-DATE-1.
  6503     MOVE ' '                            TO  DC-OPTION-CODE.
  6504     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6505     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL1502.cbl
  6506         MOVE DC-GREG-DATE-1-EDIT        TO  INCUR-REC-DT
  6507     ELSE
  6508         MOVE SPACES                     TO  INCUR-REC-DT.
  6509
  6510     IF PI-USES-PAID-TO
  6511         MOVE '  TO: '                   TO  INCUR-PD-THRU-LIT
  6512     ELSE
  6513         MOVE 'THRU: '                   TO  INCUR-PD-THRU-LIT.
  6514
  6515     IF AT-OLD-PAID-THRU-DT = LOW-VALUES OR SPACES
  6516         MOVE SPACES                     TO  INCUR-PD-THRU-DT
  6517     ELSE
  6518         MOVE AT-OLD-PAID-THRU-DT        TO  DC-BIN-DATE-1
  6519         MOVE ' '                        TO  DC-OPTION-CODE
  6520         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6521         IF NO-CONVERSION-ERROR
  6522             MOVE DC-GREG-DATE-1-EDIT    TO  INCUR-PD-THRU-DT
  6523         ELSE
  6524             MOVE SPACES                 TO  INCUR-PD-THRU-DT.
  6525
  6526     IF AT-OLD-TOTAL-PAID = ZEROS
  6527         MOVE ZEROS              TO  INCUR-TOT-PD
  6528         MOVE SPACES             TO  INCUR-TOT-PD-LIT
  6529     ELSE
  6530         MOVE AT-OLD-TOTAL-PAID  TO  INCUR-TOT-PD
  6531         MOVE ' TOT PD : '       TO  INCUR-TOT-PD-LIT.
  6532
  6533     IF AT-OLD-DAYS-PAID = ZEROS
  6534         MOVE ZEROS              TO  INCUR-TOT-DAYS-PD
  6535         MOVE SPACES             TO  INCUR-TOT-DAYS-LIT
  6536     ELSE
  6537         MOVE AT-OLD-DAYS-PAID   TO  INCUR-TOT-DAYS-PD
  6538         MOVE ' DAY: '           TO  INCUR-TOT-DAYS-LIT.
  6539
  6540     IF AT-OLD-NO-OF-PMTS = ZEROS
  6541         MOVE ZEROS              TO  INCUR-NO-PMTS
  6542         MOVE SPACES             TO  INCUR-NO-PMTS-LIT
  6543     ELSE
  6544         MOVE ' NO PMTS : '      TO  INCUR-NO-PMTS-LIT
  6545         MOVE AT-OLD-NO-OF-PMTS  TO  INCUR-NO-PMTS.
  6546
  6547     MOVE INCUR-CHG-HDG1         TO  MAP-HDG        (DISPLAY-CNT).
  6548     MOVE INCUR-TEXT-1           TO  MAP-TEXT       (DISPLAY-CNT).
  6549     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6550     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6551     ADD +1 TO DISPLAY-CNT.
  6552     MOVE INCUR-CHG-HDG2         TO  MAP-HDG        (DISPLAY-CNT).
  6553     MOVE INCUR-TEXT-2           TO  MAP-TEXT       (DISPLAY-CNT).
  6554     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6555                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6556     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6557     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6558     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6559     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6560     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6561
  6562     GO TO 2800-INCR-DISPLAY-CNT.
  6563
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL1502.cbl
  6565 2710-FORM-CONTROL-TRAILER.
  6566     MOVE SPACES                 TO  FORM-HDG1.
  6567     MOVE PI-LINE-NO             TO  FORM-LINE-NO.
  6568     MOVE 'FORM    '             TO  FORM-HDG1-LIT.
  6569
  6570     MOVE SPACES                 TO  FORM-TEXT-1.
  6571     MOVE AT-CERT-PRIME          TO  WS-FORMAT-CERT-PRIME.
  6572     MOVE AT-CERT-SFX            TO  WS-FORMAT-CERT-SFX.
  6573     MOVE WS-FORMAT-CERT-NO      TO  FORM-CERT-NO.
  6574
  6575     MOVE ' TYPE: '              TO  FORM-TYPE-LIT.
  6576
  6577     IF INITIAL-FORM
  6578        MOVE 'INITIAL'           TO  FORM-TYPE
  6579     ELSE
  6580        MOVE 'PROGRESS'          TO  FORM-TYPE.
  6581
  6582     IF AT-FORM-PRINTED-DT = LOW-VALUES OR SPACES
  6583         MOVE ' SEND ON: '                   TO  FORM-SEND-ON-LIT
  6584         IF AT-FORM-SEND-ON-DT = LOW-VALUES OR SPACES
  6585             MOVE SPACES                     TO  FORM-SEND-ON-DT
  6586         ELSE
  6587             MOVE AT-FORM-SEND-ON-DT         TO  DC-BIN-DATE-1
  6588             MOVE ' '                        TO  DC-OPTION-CODE
  6589             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6590             IF NO-CONVERSION-ERROR
  6591                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-SEND-ON-DT
  6592             ELSE
  6593                 MOVE SPACES                 TO  FORM-SEND-ON-DT
  6594     ELSE
  6595         MOVE ' SENT ON: '                   TO  FORM-SEND-ON-LIT
  6596         MOVE AT-FORM-PRINTED-DT             TO  DC-BIN-DATE-1
  6597         MOVE ' '                            TO  DC-OPTION-CODE
  6598         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6599         IF NO-CONVERSION-ERROR
  6600             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-SEND-ON-DT
  6601         ELSE
  6602             MOVE SPACES                     TO  FORM-SEND-ON-DT.
  6603
  6604     IF AT-FORM-REPRINT-DT = LOW-VALUES OR SPACES
  6605         IF AT-FORM-RE-SEND-DT = LOW-VALUES OR SPACES
  6606             MOVE SPACES                     TO  FORM-RESEND-DT
  6607                                                 FORM-RESEND-LIT
  6608         ELSE
  6609             MOVE ' RES: '                   TO  FORM-RESEND-LIT
  6610             MOVE AT-FORM-RE-SEND-DT         TO  DC-BIN-DATE-1
  6611             MOVE ' '                        TO  DC-OPTION-CODE
  6612             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6613             IF NO-CONVERSION-ERROR
  6614                 MOVE DC-GREG-DATE-1-EDIT    TO  FORM-RESEND-DT
  6615             ELSE
  6616                 MOVE SPACES                 TO  FORM-RESEND-DT
  6617     ELSE
  6618         MOVE ' RES: '                       TO  FORM-RESEND-LIT
  6619         MOVE AT-FORM-REPRINT-DT             TO  DC-BIN-DATE-1
  6620         MOVE ' '                            TO  DC-OPTION-CODE
  6621         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6622         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL1502.cbl
  6623             MOVE DC-GREG-DATE-1-EDIT        TO  FORM-RESEND-DT
  6624         ELSE
  6625             MOVE SPACES                     TO  FORM-RESEND-DT.
  6626
  6627     MOVE ' BY: '                        TO  FORM-REC-BY-LIT.
  6628     MOVE AT-RECORDED-BY                 TO  FORM-REC-BY.
  6629
  6630     MOVE SPACES                      TO  FORM-HDG2
  6631                                          FORM-TEXT-2.
  6632     MOVE AT-RECORDED-DT              TO  DC-BIN-DATE-1.
  6633     MOVE ' '                         TO  DC-OPTION-CODE.
  6634     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6635     IF NO-CONVERSION-ERROR
  6636         MOVE DC-GREG-DATE-1-EDIT     TO  FORM-REC-DT
  6637     ELSE
  6638         MOVE SPACES                  TO  FORM-REC-DT.
  6639
  6640     IF AT-FORM-ANSWERED-DT = LOW-VALUES OR SPACES
  6641         MOVE SPACES                  TO  FORM-REC-INS-DT
  6642                                          FORM-REC-INS-LIT
  6643     ELSE
  6644         MOVE 'INS : '                TO  FORM-REC-INS-LIT
  6645         MOVE AT-FORM-ANSWERED-DT     TO  DC-BIN-DATE-1
  6646         MOVE ' '                     TO  DC-OPTION-CODE
  6647         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6648         IF NO-CONVERSION-ERROR
  6649             MOVE DC-GREG-DATE-1-EDIT TO  FORM-REC-INS-DT
  6650         ELSE
  6651             MOVE SPACES              TO  FORM-REC-INS-DT.
  6652
  6653     IF AT-PHY-FORM-ANSWERED-DT = LOW-VALUES OR SPACES
  6654         MOVE SPACES                   TO  FORM-REC-PHY-DT
  6655                                           FORM-REC-PHY-LIT
  6656     ELSE
  6657         MOVE ' PHYS   : '             TO  FORM-REC-PHY-LIT
  6658         MOVE AT-PHY-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6659         MOVE ' '                      TO  DC-OPTION-CODE
  6660         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6661         IF NO-CONVERSION-ERROR
  6662             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-PHY-DT
  6663         ELSE
  6664             MOVE SPACES               TO  FORM-REC-PHY-DT.
  6665
  6666     IF AT-EMP-FORM-ANSWERED-DT = LOW-VALUES OR SPACES
  6667         MOVE SPACES                   TO  FORM-REC-EMP-DT
  6668                                           FORM-REC-EMP-LIT
  6669     ELSE
  6670         MOVE ' EMP: '                 TO  FORM-REC-EMP-LIT
  6671         MOVE AT-EMP-FORM-ANSWERED-DT  TO  DC-BIN-DATE-1
  6672         MOVE ' '                      TO  DC-OPTION-CODE
  6673         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6674         IF NO-CONVERSION-ERROR
  6675             MOVE DC-GREG-DATE-1-EDIT  TO  FORM-REC-EMP-DT
  6676         ELSE
  6677             MOVE SPACES               TO  FORM-REC-EMP-DT.
  6678
  6679     MOVE FORM-HDG1              TO  MAP-HDG        (DISPLAY-CNT).
  6680     MOVE FORM-TEXT-1            TO  MAP-TEXT       (DISPLAY-CNT).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL1502.cbl
  6681     MOVE AL-SABON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT).
  6682     MOVE AL-SANON               TO  MAP-TEXT-ATTRB (DISPLAY-CNT).
  6683     ADD +1 TO DISPLAY-CNT.
  6684     MOVE FORM-HDG2              TO  MAP-HDG        (DISPLAY-CNT).
  6685     MOVE FORM-TEXT-2            TO  MAP-TEXT       (DISPLAY-CNT).
  6686     MOVE AL-SANON               TO  MAP-HDG-ATTRB  (DISPLAY-CNT)
  6687                                     MAP-TEXT-ATTRB (DISPLAY-CNT).
  6688     MOVE TRLR-SEQ-NO            TO  PI-TRLR-SEQ-NO (SUB-1).
  6689     MOVE PI-LINE-NO             TO  PI-TRLR-LN-NO  (SUB-1).
  6690     MOVE AT-TRAILER-TYPE        TO  PI-TRLR-TYPE   (SUB-1).
  6691     MOVE WS-SRTD-CERT (SUB-2)   TO  PI-TRLR-CERT   (SUB-1).
  6692     MOVE SUB-2                  TO  PI-TRLR-SUB    (SUB-1).
  6693
  6694     GO TO 2800-INCR-DISPLAY-CNT.
  6695
  6696 2800-INCR-DISPLAY-CNT.
  6697
  6698     IF DIRECTION-SWITCH = 'F'
  6699         ADD +1 TO DISPLAY-CNT
  6700                   SUB-2
  6701                   PI-LINE-NO
  6702                   SUB-1
  6703         IF DISPLAY-CNT > +16
  6704             GO TO 2999-EXIT
  6705         ELSE
  6706             NEXT SENTENCE
  6707     ELSE
  6708         SUBTRACT +3 FROM DISPLAY-CNT
  6709         SUBTRACT +1 FROM PI-LINE-NO
  6710                          SUB-1
  6711                          SUB-2
  6712         IF DISPLAY-CNT < +1
  6713             GO TO 2999-EXIT.
  6714
  6715     GO TO 2000-BUILD-TRAILER-DISPLAY.
  6716
  6717 2950-NO-MORE-TRAILERS.
  6718     MOVE ER-0303                TO  EMI-ERROR.
  6719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6720
  6721 2999-EXIT.
  6722     EXIT.
  6723
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL1502.cbl
  6725 3000-RECEIVE-LETTERS.
  6726
  6727     MOVE LINENOI                TO  SUB-1.
  6728
  6729     IF PI-TRLR-TYPE (SUB-1) = '4'
  6730         NEXT SENTENCE
  6731     ELSE
  6732     IF PI-TRLR-TYPE (SUB-1) = '2'
  6733         MOVE ER-0667            TO  EMI-ERROR
  6734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6735         MOVE -1                 TO  LINENOL
  6736         GO TO 8200-SEND-DATAONLY
  6737     ELSE
  6738     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6739         MOVE ER-0665            TO  EMI-ERROR
  6740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6741         MOVE -1                 TO  LINENOL
  6742         GO TO 8200-SEND-DATAONLY
  6743     ELSE
  6744         MOVE ER-0660            TO  EMI-ERROR
  6745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6746         MOVE -1                 TO  LINENOL
  6747         GO TO 8200-SEND-DATAONLY.
  6748
  6749     IF RECVDTI = SPACES
  6750         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6751     ELSE
  6752         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6753         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6754         IF WS-DEEDIT-FIELD-V0 NUMERIC
  6755             MOVE '4'                      TO  DC-OPTION-CODE
  6756             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6757             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6758             IF NO-CONVERSION-ERROR
  6759                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6760                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6761                 MOVE AL-UANON             TO  RECVDTA
  6762             ELSE
  6763                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6764
  6765     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6766     MOVE PI-TRLR-CERT   (SUB-1) TO  TRLR-CERT-NO.
  6767     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6768
  6769     MOVE WS-RECEIVED-DATE       TO  AT-LETTER-ANSWERED-DT.
  6770     MOVE PI-PROCESSOR-ID        TO  AT-CORR-LAST-UPDATED-BY.
  6771     MOVE SAVE-BIN-DATE          TO  AT-CORR-LAST-MAINT-DT.
  6772
  6773     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6774
  6775     MOVE PI-TRLR-CERT   (SUB-1) TO  MSTR-CERT-NO.
  6776     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6777
  6778*    IF PI-COMPANY-ID = 'DMD'
  6779*        MOVE 11                 TO CL-ACTIVITY-CODE
  6780*        MOVE SAVE-BIN-DATE      TO CL-ACTIVITY-MAINT-DT
  6781*        MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  6782*        MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL1502.cbl
  6783
  6784     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
  6785
  6786     MOVE ER-0000                TO  EMI-ERROR.
  6787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6788     MOVE -1                     TO  LINENOL.
  6789     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6790                                     RECVTYPA.
  6791     MOVE LOW-VALUES             TO  EL150CO.
  6792     MOVE 'F'                    TO  DIRECTION-SWITCH.
  6793     MOVE +1                     TO  DISPLAY-CNT
  6794                                     SUB-1
  6795                                     PI-LINE-NO.
  6796     MOVE PI-TRLR-SUB (SUB-1)    TO  SUB-2.
  6797     PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT.
  6798     GO TO 1010-BUILD-HISTORY-SCREEN.
  6799
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL1502.cbl
  6801 4000-RECEIVE-FORMS.
  6802
  6803     MOVE LINENOI                TO  SUB-1.
  6804
  6805     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6806         NEXT SENTENCE
  6807     ELSE
  6808     IF PI-TRLR-TYPE (SUB-1) = '4'
  6809         MOVE ER-0666            TO  EMI-ERROR
  6810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6811         MOVE -1                 TO  LINENOL
  6812         GO TO 8200-SEND-DATAONLY
  6813     ELSE
  6814     IF PI-TRLR-TYPE (SUB-1) = '2'
  6815         MOVE ER-0667            TO  EMI-ERROR
  6816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6817         MOVE -1                 TO  LINENOL
  6818         GO TO 8200-SEND-DATAONLY
  6819     ELSE
  6820         MOVE ER-0661            TO  EMI-ERROR
  6821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6822         MOVE -1                 TO  LINENOL
  6823         GO TO 8200-SEND-DATAONLY.
  6824
  6825     IF RECVTYPI = 'I' OR 'P' OR 'E'
  6826         NEXT SENTENCE
  6827     ELSE
  6828         MOVE ER-0662            TO  EMI-ERROR
  6829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6830         MOVE -1                 TO  RECVTYPL
  6831         GO TO 8200-SEND-DATAONLY.
  6832
  6833     IF RECVDTI = SPACES
  6834         MOVE LOW-VALUES                   TO  WS-RECEIVED-DATE
  6835     ELSE
  6836         MOVE RECVDTI                      TO  WS-DEEDIT-FIELD
  6837         PERFORM 9800-DEEDIT THRU 9800-EXIT
  6838         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6839             MOVE '4'                      TO  DC-OPTION-CODE
  6840             MOVE WS-DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY
  6841             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6842             IF NO-CONVERSION-ERROR
  6843                 MOVE DC-BIN-DATE-1        TO  WS-RECEIVED-DATE
  6844                 MOVE DC-GREG-DATE-1-EDIT  TO  RECVDTO
  6845                 MOVE AL-UANON             TO  RECVDTA
  6846             ELSE
  6847                 MOVE LOW-VALUES           TO  WS-RECEIVED-DATE.
  6848
  6849     MOVE PI-TRLR-CERT   (SUB-1)     TO  TRLR-CERT-NO.
  6850     MOVE PI-TRLR-SEQ-NO (SUB-1)     TO  TRLR-SEQ-NO.
  6851     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6852
  6853     IF RECVTYPI = 'I'
  6854         MOVE WS-RECEIVED-DATE       TO  AT-FORM-ANSWERED-DT
  6855     ELSE
  6856     IF RECVTYPI = 'P'
  6857         MOVE WS-RECEIVED-DATE       TO  AT-PHY-FORM-ANSWERED-DT
  6858     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL1502.cbl
  6859         MOVE WS-RECEIVED-DATE       TO  AT-EMP-FORM-ANSWERED-DT.
  6860
  6861     MOVE PI-PROCESSOR-ID            TO  AT-FORM-LAST-UPDATED-BY.
  6862     MOVE SAVE-BIN-DATE              TO  AT-FORM-LAST-MAINT-DT.
  6863
  6864     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  6865
  6866     MOVE ER-0000                TO  EMI-ERROR.
  6867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6868     MOVE -1                     TO  LINENOL.
  6869     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  6870                                     RECVTYPA.
  6871     MOVE LOW-VALUES             TO  EL150CO.
  6872     MOVE 'F'                    TO  DIRECTION-SWITCH
  6873     MOVE +1                     TO  DISPLAY-CNT
  6874                                     SUB-1
  6875                                     PI-LINE-NO.
  6876     MOVE PI-TRLR-SUB (SUB-1)    TO  SUB-2.
  6877     PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT.
  6878
  6879     GO TO 1010-BUILD-HISTORY-SCREEN.
  6880
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL1502.cbl
  6882
  6883 5000-VOID-PAYMENT.
  6884
  6885     MOVE LINENOI                TO  SUB-1.
  6886
  6887     IF PI-TRLR-TYPE (SUB-1) = '2'
  6888         NEXT SENTENCE
  6889     ELSE
  6890     IF PI-TRLR-TYPE (SUB-1) = '4'
  6891         MOVE ER-0666            TO  EMI-ERROR
  6892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6893         MOVE -1                 TO  LINENOL
  6894         GO TO 8200-SEND-DATAONLY
  6895     ELSE
  6896     IF PI-TRLR-TYPE (SUB-1) = 'A'
  6897         MOVE ER-0665            TO  EMI-ERROR
  6898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6899         MOVE -1                 TO  LINENOL
  6900         GO TO 8200-SEND-DATAONLY
  6901     ELSE
  6902         MOVE ER-0664            TO  EMI-ERROR
  6903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6904         MOVE -1                 TO  LINENOL
  6905         GO TO 8200-SEND-DATAONLY.
  6906
  6907     MOVE PI-TRLR-CERT (SUB-1)   TO  MSTR-CERT-NO.
  6908     PERFORM 7500-READ-CLAIM-MSTR-UPDATE THRU 7500-EXIT.
  6909
  6910     MOVE PI-TRLR-CERT   (SUB-1) TO  TRLR-CERT-NO.
  6911     MOVE PI-TRLR-SEQ-NO (SUB-1) TO  TRLR-SEQ-NO.
  6912     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  6913
  6914     IF AT-VOID-DT = LOW-VALUES OR SPACES
  6915         NEXT SENTENCE
  6916     ELSE
  6917         MOVE ER-0800            TO  EMI-ERROR
  6918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6919         MOVE -1                 TO  LINENOL
  6920         PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6921         PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6922         GO TO 8200-SEND-DATAONLY.
  6923
  6924*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6925*        IF AT-CASH-PAYMENT = 'N'
  6926*            IF AT-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES
  6927*                MOVE ER-0833    TO  EMI-ERROR
  6928*                MOVE -1         TO  LINENOL
  6929*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6930*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6931*                PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6932*                GO TO 8200-SEND-DATAONLY.
  6933*
  6934*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6935*      IF AT-CASH-PAYMENT = 'N'
  6936*        IF AT-RECORDED-DT = SAVE-BIN-DATE
  6937*          NEXT SENTENCE
  6938*        ELSE
  6939*          IF PI-PROCESSOR-USER-ALMIGHTY = 'Y'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL1502.cbl
  6940*            NEXT SENTENCE
  6941*          ELSE
  6942*            MOVE ER-0816        TO  EMI-ERROR
  6943*            MOVE -1             TO  LINENOL
  6944*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6945*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6946*            PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6947*            GO TO 8200-SEND-DATAONLY.
  6948*
  6949*    IF PI-COMPANY-ID = 'DMD'
  6950*        IF CLAIM-IS-CLOSED
  6951*            IF SETUP-ERRORS
  6952*                MOVE ER-0941    TO EMI-ERROR
  6953*                MOVE -1         TO LINENOL
  6954*                PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT
  6955*                PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  6956*                PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  6957*                GO TO 8200-SEND-DATAONLY
  6958*            ELSE
  6959*            IF BENEFITS-CHANGED
  6960*                IF SYSTEM-MODIFY-CAP
  6961*                    NEXT SENTENCE
  6962*                  ELSE
  6963*                    MOVE ER-0942  TO EMI-ERROR
  6964*                    MOVE -1       TO LINENOL
  6965*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6966*                    PERFORM 7510-UNLOCK-CLAIM-MSTR
  6967*                       THRU 7510-EXIT
  6968*                    PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6969*                    GO TO 8200-SEND-DATAONLY.
  6970*
  6971*    IF PI-COMPANY-ID = 'DMD'
  6972*        IF AT-CASH-PAYMENT = 'N'
  6973*            IF SYSTEM-MODIFY-CAP
  6974*                NEXT SENTENCE
  6975*            ELSE
  6976*                IF AT-RECORDED-DT = SAVE-BIN-DATE
  6977*                    NEXT SENTENCE
  6978*                ELSE
  6979*                    MOVE ER-0920  TO EMI-ERROR
  6980*                    MOVE -1       TO LINENOL
  6981*                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6982*                    PERFORM 7510-UNLOCK-CLAIM-MSTR
  6983*                       THRU 7510-EXIT
  6984*                    PERFORM 7010-UNLOCK-TRLR THRU 7010-EXIT
  6985*                    GO TO 8200-SEND-DATAONLY.
  6986*
  6987*    IF PI-COMPANY-ID = 'DMD'
  6988*       IF AT-PAYMENT-TYPE NOT = '4' AND '5' AND '6'
  6989*          MOVE 'O'              TO  CL-CLAIM-STATUS
  6990*       END-IF
  6991*       PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
  6992*
  6993     MOVE AT-CHECK-WRITTEN-DT    TO  WS-CHECK-WRITTEN-DT.
  6994     MOVE AT-PAYMENT-APPROVAL-SW TO  WS-PMT-APPROVAL-SW.
  6995     MOVE AT-AMOUNT-PAID         TO  WS-AMOUNT-PAID.
  6996     MOVE AT-PAYMENT-ORIGIN      TO  WS-PAYMENT-ORIGIN.
  6997     MOVE AT-CV-PMT-CODE         TO  WS-CV-PMT-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL1502.cbl
  6998
  6999     IF AT-PAYMENT-TYPE NOT = '5' AND '6' AND 'I'
  7000         SUBTRACT AT-AMOUNT-PAID    FROM CL-TOTAL-PAID-AMT
  7001         SUBTRACT AT-DAYS-IN-PERIOD FROM CL-NO-OF-DAYS-PAID
  7002         IF AT-PAYMENT-TYPE NOT = '4'
  7003             SUBTRACT +1 FROM CL-NO-OF-PMTS-MADE
  7004             IF AT-PAID-THRU-DT NOT = CL-PAID-THRU-DT OR
  7005                AT-RECORDED-BY = 'ZZZZ'
  7006                 NEXT SENTENCE
  7007             ELSE
  7008                 MOVE AT-PREV-LAST-PMT-DT    TO  CL-LAST-PMT-DT
  7009                 MOVE AT-PREV-PAID-THRU-DT   TO  CL-PAID-THRU-DT
  7010                 MOVE AT-PREV-LAST-PMT-AMT   TO  CL-LAST-PMT-AMT.
  7011
  7012     IF CL-NO-OF-DAYS-PAID < ZERO
  7013         MOVE +0                 TO  CL-NO-OF-DAYS-PAID.
  7014
  7015     IF CL-NO-OF-PMTS-MADE < ZERO
  7016         MOVE +0                 TO  CL-NO-OF-PMTS-MADE.
  7017
  7018     MOVE SAVE-BIN-DATE          TO  AT-VOID-DT
  7019                                     CL-LAST-REOPEN-DT.
  7020
  7021     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7022     MOVE '1'                    TO  CNTL-REC-TYPE.
  7023     MOVE SPACES                 TO  CNTL-ACCESS.
  7024     MOVE +0                     TO  CNTL-SEQ-NO.
  7025     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7026
  7027     PERFORM 7900-READ-CONTROL-FILE THRU 7900-EXIT.
  7028
  7029     MOVE CF-PAYMENT-APPROVAL-SW TO  WS-CF-PAYMENT-APPROVAL-SW.
  7030
  7031     IF CF-PMT-APPROVAL-USED
  7032         MOVE 'V'                TO  AT-PAYMENT-APPROVAL-SW.
  7033
  7034******************************************************************
  7035**  1.  BYPASS READING THE RECON RECORD FOR THE FOLLOWING       **
  7036**      REASONS:                                                **
  7037**      A.  NON-CASH PAYMENT                                    **
  7038**      B.  CHECK HAS NOT BEEN PRINTED                          **
  7039**      C.  USER IS NOT A RECON USER                            **
  7040**      D.  PAYMENT IS A MANUAL (OFFLINE) PAYMENT               **
  7041******************************************************************
  7042
  7043     IF AT-CASH-PAYMENT = 'N'
  7044         GO TO 5005-CONT-VOID.
  7045
  7046     IF AT-CHECK-NO = SPACES OR LOW-VALUES
  7047         GO TO 5005-CONT-VOID.
  7048
  7049     IF CF-CLAIMS-CHECK-RECON-USER NOT = 'Y'
  7050         GO TO 5005-CONT-VOID.
  7051
  7052     IF OFFLINE-PMT
  7053         GO TO 5005-CONT-VOID.
  7054
  7055******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL1502.cbl
  7056**  1.  RECON SW VALUES = :                                     **
  7057**      A.  R = CHECK HAS BEEN REDEEMED - CANNOT BE VOIDED      **
  7058**      B.  X = RECON RECORD NOT FOUND                          **
  7059******************************************************************
  7060
  7061     MOVE 'RCON'                     TO  FILE-SWITCH.
  7062     PERFORM 5700-UPDATE-RECON THRU 5700-EXIT.
  7063     IF WS-RECON-SW = 'R'
  7064         PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  7065         PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  7066         GO TO 8200-SEND-DATAONLY.
  7067
  7068*    IF WS-RECON-SW = 'X'
  7069*        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  7070*            PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT
  7071*            PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT
  7072*            GO TO 8200-SEND-DATAONLY.
  7073
  7074 5005-CONT-VOID.
  7075     IF AT-RECORDED-BY = 'ZZZZ'
  7076         GO TO 5010-BYPASS.
  7077
  7078     MOVE '7'                    TO  PI-PAY-TYPE.
  7079     MOVE AT-PAYMENT-TYPE        TO  WS-PAY-TYPE.
  7080
  7081*    IF PI-COMPANY-ID = 'DMD'
  7082*        MOVE 88888888           TO WS-CK-Q-CONTROL
  7083*     ELSE
  7084         MOVE 99999999           TO WS-CK-Q-CONTROL.
  7085
  7086     IF AT-CHECK-QUE-CONTROL > ZEROS AND < WS-CK-Q-CONTROL
  7087         PERFORM 5200-UPDATE-CHECK-QUE THRU 5299-EXIT
  7088     ELSE
  7089         IF AT-CHECK-WRITTEN-DT NOT = LOW-VALUES AND SPACES
  7090             MOVE 'Y'                TO  WS-PRINTED-SW
  7091                                         WS-RELEASED-SW
  7092         ELSE
  7093             MOVE 'N'                TO  WS-PRINTED-SW
  7094                                         WS-RELEASED-SW.
  7095
  7096 5010-BYPASS.
  7097
  7098     IF PAYMENT-HAS-BEEN-PRINTED OR
  7099        OFFLINE-PMT
  7100         MOVE CF-CURRENT-MONTH-END   TO  AT-VOID-SELECT-DT
  7101     ELSE
  7102         MOVE LOW-VALUES             TO  AT-PMT-SELECT-DT
  7103                                         AT-VOID-SELECT-DT.
  7104
  7105     MOVE WS-VOID-CODE               TO  AT-VOID-TYPE.
  7106
  7107     MOVE PI-PROCESSOR-ID        TO  AT-PAYMENT-LAST-UPDATED-BY.
  7108     MOVE SAVE-BIN-DATE          TO  AT-PAYMENT-LAST-MAINT-DT.
  7109
  7110     PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT.
  7111     IF WS-PAY-TYPE NOT = 'I'
  7112        PERFORM 5400-UPDATE-ZERO-TRAILER
  7113                                 THRU 5400-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL1502.cbl
  7114     END-IF
  7115*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  7116*        PERFORM 5500-UPDATE-POLICY-MASTER THRU 5500-EXIT
  7117*    ELSE
  7118         PERFORM 5600-UPDATE-CERT THRU 5600-EXIT.
  7119
  7120     MOVE CL-CONTROL-PRIMARY     TO  ELACTQ-KEY.
  7121
  7122     IF WS-PAY-TYPE = '4' OR '5' OR '6' OR 'I'
  7123         GO TO 5020-CONTINUE-VOID.
  7124
  7125*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  7126*        IF CL-NO-OF-PMTS-MADE > +0
  7127*            GO TO 5020-CONTINUE-VOID.
  7128
  7129     MOVE 'O'                    TO  CL-CLAIM-STATUS.
  7130
  7131 5020-CONTINUE-VOID.
  7132
  7133     PERFORM 7600-REWRITE-CLAIM-MSTR THRU 7600-EXIT.
  7134
  7135     IF WS-PAYMENT-ORIGIN = '3'
  7136         GO TO 5100-CONTINUE.
  7137
  7138     IF PAYMENT-HAS-BEEN-PRINTED AND
  7139        NOT WS-CF-PMT-APPROVAL-USED
  7140         GO TO 5100-CONTINUE.
  7141
  7142     MOVE 'ACTQ'                 TO  FILE-SWITCH.
  7143     PERFORM 7700-READ-ELACTQ THRU 7799-EXIT.
  7144
  7145 5100-CONTINUE.
  7146
  7147     MOVE ER-0000                TO  EMI-ERROR.
  7148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7149     MOVE -1                     TO  LINENOL.
  7150     MOVE AL-UANOF               TO  LINENOA  RECVDTA
  7151                                     RECVTYPA.
  7152     MOVE LOW-VALUES             TO  EL150CO.
  7153     MOVE 'F'                    TO  DIRECTION-SWITCH
  7154     MOVE +1                     TO  DISPLAY-CNT
  7155                                     SUB-1
  7156                                     PI-LINE-NO.
  7157     MOVE PI-TRLR-SUB (SUB-1)    TO  SUB-2.
  7158     PERFORM 0800-RECOVER-TEMP-STORAGE THRU 0899-EXIT.
  7159
  7160     GO TO 1010-BUILD-HISTORY-SCREEN.
  7161
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL1502.cbl
  7163 5200-UPDATE-CHECK-QUE.
  7164
  7165     MOVE PI-COMPANY-CD          TO  CHKQ-COMP-CD.
  7166     MOVE AT-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL.
  7167     MOVE AT-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQ-NO.
  7168
  7169
  7170* EXEC CICS HANDLE CONDITION
  7171*        NOTFND   (5290-NOTFND)
  7172*    END-EXEC.
  7173*    MOVE '"$I                   ! * #00006875' TO DFHEIV0
  7174     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7176     MOVE X'2A20233030303036383735' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0
  7178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7179
  7180
  7181
  7182* EXEC CICS READ
  7183*        DATASET   ('ELCHKQ')
  7184*        RIDFLD    (ELCHKQ-KEY)
  7185*        SET       (ADDRESS OF CHECK-QUE)
  7186*        UPDATE
  7187*    END-EXEC.
  7188     MOVE 'ELCHKQ' TO DFHEIV1
  7189*    MOVE '&"S        EU         (   #00006879' TO DFHEIV0
  7190     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7191     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7192     MOVE X'2020233030303036383739' TO DFHEIV0(25:11)
  7193     CALL 'kxdfhei1' USING DFHEIV0,
  7194           DFHEIV1,
  7195           DFHEIV20,
  7196           DFHEIV99,
  7197           ELCHKQ-KEY,
  7198           DFHEIV99,
  7199           DFHEIV99,
  7200           DFHEIV99
  7201     SET ADDRESS OF CHECK-QUE TO
  7202         DFHEIV20
  7203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7204
  7205
  7206     MOVE 'Y'                    TO  WS-RELEASED-SW.
  7207
  7208     IF CQ-TIMES-PRINTED = +0
  7209         MOVE 'N'                TO  WS-PRINTED-SW
  7210         GO TO 5210-DELETE-CHECK-QUE
  7211     ELSE
  7212         MOVE 'Y'                TO  WS-PRINTED-SW.
  7213
  7214     MOVE WS-VOID-CODE           TO  CQ-VOID-INDICATOR.
  7215
  7216
  7217* EXEC CICS REWRITE
  7218*        DATASET   ('ELCHKQ')
  7219*        FROM      (CHECK-QUE)
  7220*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL1502.cbl
  7221     MOVE LENGTH OF
  7222      CHECK-QUE
  7223       TO DFHEIV11
  7224     MOVE 'ELCHKQ' TO DFHEIV1
  7225*    MOVE '&& L                  %   #00006896' TO DFHEIV0
  7226     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7227     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7228     MOVE X'2020233030303036383936' TO DFHEIV0(25:11)
  7229     CALL 'kxdfhei1' USING DFHEIV0,
  7230           DFHEIV1,
  7231           CHECK-QUE,
  7232           DFHEIV11,
  7233           DFHEIV99
  7234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7235
  7236
  7237     GO TO 5299-EXIT.
  7238
  7239 5210-DELETE-CHECK-QUE.
  7240
  7241
  7242* EXEC CICS DELETE
  7243*        DATASET   ('ELCHKQ')
  7244*    END-EXEC.
  7245     MOVE 'ELCHKQ' TO DFHEIV1
  7246*    MOVE '&(                    &   #00006905' TO DFHEIV0
  7247     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7248     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7249     MOVE X'2020233030303036393035' TO DFHEIV0(25:11)
  7250     CALL 'kxdfhei1' USING DFHEIV0,
  7251           DFHEIV1,
  7252           DFHEIV99,
  7253           DFHEIV99,
  7254           DFHEIV99,
  7255           DFHEIV99
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7257
  7258
  7259     MOVE +0                     TO  AT-CHECK-QUE-CONTROL
  7260                                     AT-CHECK-QUE-SEQUENCE.
  7261     GO TO 5299-EXIT.
  7262
  7263 5290-NOTFND.
  7264     MOVE 'N'                    TO  WS-PRINTED-SW
  7265                                     WS-RELEASED-SW.
  7266 5299-EXIT.
  7267     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL1502.cbl
  7269*5300-CREATE-DMO. Remove as obsolete or dead code
  7270*5300-CONT. Remove as obsolete or dead code
  7271*5300-NOTE-NOT-FOUND. Remove as obsolete or dead code
  7272*5300-EXIT. Remove as obsolete or dead code
  7273*5350-FORMAT-LAST-NAME-1ST. Remove as obsolete or dead code
  7274*5350-EXIT. Remove as dead code
  7275*5360-MOVE-NAME. Remove as dead code
  7276*5360-MOVE-NAME-CYCLE. Remove as dead code
  7277*5360-EXIT. Remove as dead code
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL1502.cbl
  7279 5400-UPDATE-ZERO-TRAILER.
  7280
  7281     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
  7282
  7283     MOVE ZEROS                  TO  TRLR-SEQ-NO.
  7284     PERFORM 7000-READ-TRLR-UPDATE THRU 7000-EXIT.
  7285
  7286     IF WS-PAY-TYPE = '5'
  7287         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-CHARGEABLE-EXPENSE.
  7288
  7289     IF WS-PAY-TYPE = '6'
  7290         SUBTRACT WS-AMOUNT-PAID FROM AT-ITD-PAID-EXPENSES.
  7291
  7292     IF AT-INITIAL-MANUAL-RESERVE NOT = ZEROS
  7293         ADD WS-AMOUNT-PAID      TO  AT-CURRENT-MANUAL-RESERVE.
  7294
  7295 5410-CHECK-OPEN-CLOSE.
  7296
  7297     IF PI-PAY-TYPE = '5' OR '6'
  7298         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7299         GO TO 5400-EXIT.
  7300
  7301     IF PI-PAY-TYPE = '1' OR '4' OR '7'
  7302        IF CLAIM-IS-OPEN
  7303           PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7304           GO TO 5400-EXIT.
  7305
  7306     IF PI-PAY-TYPE = '2' OR '3'
  7307        IF CLAIM-IS-CLOSED
  7308           PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7309           GO TO 5400-EXIT.
  7310
  7311     MOVE 1                      TO  SUB.
  7312
  7313 5420-LOOP.
  7314
  7315     IF AT-OPEN-CLOSE-TYPE (SUB) = SPACES
  7316         MOVE SAVE-BIN-DATE      TO  AT-OPEN-CLOSE-DATE (SUB)
  7317         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB)
  7318         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB)
  7319         PERFORM 7100-REWRITE-TRLR THRU 7100-EXIT
  7320         GO TO 5400-EXIT.
  7321
  7322     IF SUB = 6
  7323      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
  7324      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
  7325      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
  7326      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
  7327      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
  7328      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
  7329      GO TO 5420-LOOP.
  7330
  7331     ADD 1 TO SUB.
  7332     GO TO 5420-LOOP.
  7333
  7334 5400-EXIT.
  7335     EXIT.
  7336
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL1502.cbl
  7338*5500-UPDATE-POLICY-MASTER. Remove as dead code
  7339*5500-UPDATE-LF-POLICY-DATA. Remove as dead code
  7340*5500-UPDATE-AH-POLICY-DATA. Remove as dead code
  7341*5500-UPDATE-CLAIM-HISTORY. Remove as dead code
  7342*5500-FINISH-POLICY-UPDATE. Remove as dead code
  7343*5500-EXIT. Remove as dead code
  7344 5600-UPDATE-CERT.
  7345
  7346     MOVE PI-COMPANY-CD          TO  CERT-COMP-CD.
  7347     MOVE CL-CERT-CARRIER        TO  CERT-CARRIER.
  7348     MOVE CL-CERT-GROUPING       TO  CERT-GROUPING.
  7349     MOVE CL-CERT-STATE          TO  CERT-STATE.
  7350     MOVE CL-CERT-ACCOUNT        TO  CERT-ACCOUNT.
  7351     MOVE CL-CERT-EFF-DT         TO  CERT-EFF-DT.
  7352     MOVE CL-CERT-NO             TO  CERT-CERT-NO.
  7353     MOVE 'CERT'                 TO  FILE-SWITCH.
  7354
  7355     PERFORM 7800-READ-CERT-UPDATE.
  7356
  7357     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
  7358         GO TO 5610-AH-VOID.
  7359
  7360     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  7361     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7362     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7363     MOVE '4'                    TO  CNTL-REC-TYPE.
  7364     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  7365     MOVE 'BENE'                 TO  FILE-SWITCH.
  7366     MOVE +0                     TO  SUB.
  7367     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  7368     IF NO-BENEFIT-FOUND
  7369         GO TO 8400-NOT-FOUND.
  7370
  7371     MOVE CF-LF-COVERAGE-TYPE (SUB)  TO  WS-LF-COVERAGE-TYPE.
  7372
  7373     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  7374        WS-LF-COVERAGE-TYPE = 'P'
  7375         IF WS-PAY-TYPE = '4'
  7376             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7377             IF CM-LF-CURRENT-STATUS = '1' OR '2'
  7378                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7379                 GO TO 5600-EXIT
  7380             ELSE
  7381                 MOVE CM-LF-STATUS-AT-DEATH  TO
  7382                                             CM-LF-CURRENT-STATUS
  7383                 MOVE SPACES             TO  CM-LF-STATUS-AT-DEATH
  7384                 MOVE LOW-VALUES         TO  CM-LF-DEATH-EXIT-DT
  7385                                             CM-LF-DEATH-DT
  7386                 PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7387                 GO TO 5600-EXIT.
  7388
  7389     IF WS-PAY-TYPE = '4'
  7390         SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7391         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7392         GO TO 5600-EXIT.
  7393
  7394     IF WS-PAY-TYPE = '2'
  7395         IF CM-LF-CURRENT-STATUS = '1' OR '2'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL1502.cbl
  7396             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7397             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7398             GO TO 5600-EXIT
  7399         ELSE
  7400             MOVE CM-LF-STATUS-AT-DEATH TO  CM-LF-CURRENT-STATUS
  7401             MOVE SPACES                TO  CM-LF-STATUS-AT-DEATH
  7402             SUBTRACT WS-AMOUNT-PAID FROM CM-LF-ITD-DEATH-AMT
  7403             MOVE LOW-VALUES            TO  CM-LF-DEATH-EXIT-DT
  7404                                            CM-LF-DEATH-DT
  7405             PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7406             GO TO 5600-EXIT
  7407     ELSE
  7408         GO TO 5620-UNLOCK-CERT.
  7409
  7410 5610-AH-VOID.
  7411
  7412     IF WS-PAY-TYPE = '4'
  7413         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7414         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7415         GO TO 5600-EXIT.
  7416
  7417     IF WS-PAY-TYPE = '3'
  7418         MOVE CM-AH-STATUS-AT-SETTLEMENT
  7419                                 TO  CM-AH-CURRENT-STATUS
  7420         MOVE SPACES             TO  CM-AH-STATUS-AT-SETTLEMENT
  7421         SUBTRACT WS-AMOUNT-PAID FROM CM-AH-ITD-LUMP-PMT
  7422         MOVE LOW-VALUES         TO  CM-AH-SETTLEMENT-EXIT-DT
  7423                                     CM-AH-SETTLEMENT-DT
  7424         PERFORM 7810-REWRITE-CERT THRU 7810-EXIT
  7425         GO TO 5600-EXIT
  7426     ELSE
  7427         GO TO 5620-UNLOCK-CERT.
  7428
  7429 5620-UNLOCK-CERT.
  7430
  7431
  7432* EXEC CICS UNLOCK
  7433*        DATASET   ('ELCERT')
  7434*    END-EXEC.
  7435     MOVE 'ELCERT' TO DFHEIV1
  7436*    MOVE '&*                    #   #00007081' TO DFHEIV0
  7437     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7438     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7439     MOVE X'2020233030303037303831' TO DFHEIV0(25:11)
  7440     CALL 'kxdfhei1' USING DFHEIV0,
  7441           DFHEIV1,
  7442           DFHEIV99
  7443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7444
  7445
  7446 5600-EXIT.
  7447     EXIT.
  7448
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL1502.cbl
  7450 5700-UPDATE-RECON.
  7451
  7452
  7453* EXEC CICS HANDLE CONDITION
  7454*        NOTFND    (5700-NOT-FOUND)
  7455*        NOTOPEN   (8500-FILE-NOTOPEN)
  7456*    END-EXEC.
  7457*    MOVE '"$IJ                  ! + #00007091' TO DFHEIV0
  7458     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7460     MOVE X'2B20233030303037303931' TO DFHEIV0(25:11)
  7461     CALL 'kxdfhei1' USING DFHEIV0
  7462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7463
  7464
  7465     MOVE PI-COMPANY-CD               TO  RCON-COMPANY-CD.
  7466     MOVE AT-CHECK-NO                 TO  RCON-CHECK-NO.
  7467     MOVE 'C'                         TO  RCON-CHECK-ORIGIN.
  7468     MOVE SPACES                      TO  RCON-GL-ACCOUNT-NO.
  7469
  7470
  7471* EXEC CICS READ
  7472*        DATASET   ('ELRCON')
  7473*        RIDFLD    (ELRCON-KEY)
  7474*        SET       (ADDRESS OF CHECK-RECONCILIATION)
  7475*        UPDATE
  7476*    END-EXEC.
  7477     MOVE 'ELRCON' TO DFHEIV1
  7478*    MOVE '&"S        EU         (   #00007101' TO DFHEIV0
  7479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7480     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7481     MOVE X'2020233030303037313031' TO DFHEIV0(25:11)
  7482     CALL 'kxdfhei1' USING DFHEIV0,
  7483           DFHEIV1,
  7484           DFHEIV20,
  7485           DFHEIV99,
  7486           ELRCON-KEY,
  7487           DFHEIV99,
  7488           DFHEIV99,
  7489           DFHEIV99
  7490     SET ADDRESS OF CHECK-RECONCILIATION TO
  7491         DFHEIV20
  7492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7493
  7494
  7495******************************************************************
  7496*         IF THE CHECK HAS BEEN REDEEMED - DO NOT VOID
  7497******************************************************************
  7498
  7499     IF RC-STATUS = 'R'
  7500         MOVE 'X'                TO  WS-RECON-SW
  7501         MOVE ER-0823            TO  EMI-ERROR
  7502         MOVE -1                 TO  LINENOL
  7503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7504
  7505* EXEC CICS UNLOCK
  7506*            DATASET   ('ELRCON')
  7507*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL1502.cbl
  7508     MOVE 'ELRCON' TO DFHEIV1
  7509*    MOVE '&*                    #   #00007117' TO DFHEIV0
  7510     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7511     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7512     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
  7513     CALL 'kxdfhei1' USING DFHEIV0,
  7514           DFHEIV1,
  7515           DFHEIV99
  7516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7517         GO TO 5700-EXIT
  7518     ELSE
  7519         MOVE ' '                TO  WS-RECON-SW.
  7520
  7521     MOVE WS-VOID-CODE           TO  RC-STATUS.
  7522
  7523     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  7524     MOVE '5'                    TO  DC-OPTION-CODE.
  7525     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7526     MOVE DC-GREG-DATE-1-MDY     TO  WS-WORK-DATE.
  7527     IF WS-WORK-YY > 50
  7528         MOVE '19'               TO  WS-RCON-YY-1
  7529         MOVE WS-WORK-YY         TO  WS-RCON-YY-2
  7530         MOVE WS-WORK-MM         TO  WS-RCON-MM
  7531         MOVE WS-WORK-DD         TO  WS-RCON-DD
  7532     ELSE
  7533         MOVE '20'               TO  WS-RCON-YY-1
  7534         MOVE WS-WORK-YY         TO  WS-RCON-YY-2
  7535         MOVE WS-WORK-MM         TO  WS-RCON-MM
  7536         MOVE WS-WORK-DD         TO  WS-RCON-DD.
  7537
  7538     MOVE WS-RCON-DATE           TO  RC-STATUS-DATE.
  7539
  7540     MOVE PI-PROCESSOR-ID        TO  RC-LAST-MAINT-BY.
  7541     MOVE SAVE-BIN-DATE          TO  RC-LAST-MAINT-DT.
  7542     MOVE EIBTIME                TO  RC-LAST-MAINT-HHMMSS.
  7543
  7544
  7545* EXEC CICS REWRITE
  7546*        DATASET   ('ELRCON')
  7547*        FROM      (CHECK-RECONCILIATION)
  7548*    END-EXEC.
  7549     MOVE LENGTH OF
  7550      CHECK-RECONCILIATION
  7551       TO DFHEIV11
  7552     MOVE 'ELRCON' TO DFHEIV1
  7553*    MOVE '&& L                  %   #00007147' TO DFHEIV0
  7554     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7556     MOVE X'2020233030303037313437' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0,
  7558           DFHEIV1,
  7559           CHECK-RECONCILIATION,
  7560           DFHEIV11,
  7561           DFHEIV99
  7562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7563
  7564
  7565     GO TO 5700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL1502.cbl
  7566
  7567 5700-NOT-FOUND.
  7568
  7569     MOVE 'X'                    TO  WS-RECON-SW.
  7570     MOVE -1                     TO  LINENOL.
  7571     MOVE ER-0801                TO  EMI-ERROR.
  7572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7573
  7574 5700-EXIT.
  7575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL1502.cbl
  7577 7000-READ-TRLR-UPDATE.
  7578
  7579     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
  7580     MOVE PI-CARRIER             TO  TRLR-CARRIER.
  7581     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
  7582
  7583
  7584* EXEC CICS READ
  7585*        DATASET   ('ELTRLR')
  7586*        RIDFLD    (ELTRLR-KEY)
  7587*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  7588*        UPDATE
  7589*    END-EXEC.
  7590     MOVE 'ELTRLR' TO DFHEIV1
  7591*    MOVE '&"S        EU         (   #00007170' TO DFHEIV0
  7592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7594     MOVE X'2020233030303037313730' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0,
  7596           DFHEIV1,
  7597           DFHEIV20,
  7598           DFHEIV99,
  7599           ELTRLR-KEY,
  7600           DFHEIV99,
  7601           DFHEIV99,
  7602           DFHEIV99
  7603     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7604         DFHEIV20
  7605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7606
  7607
  7608 7000-EXIT.
  7609     EXIT.
  7610
  7611 7010-UNLOCK-TRLR.
  7612
  7613
  7614* EXEC CICS UNLOCK
  7615*        DATASET   ('ELTRLR')
  7616*    END-EXEC.
  7617     MOVE 'ELTRLR' TO DFHEIV1
  7618*    MOVE '&*                    #   #00007182' TO DFHEIV0
  7619     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7621     MOVE X'2020233030303037313832' TO DFHEIV0(25:11)
  7622     CALL 'kxdfhei1' USING DFHEIV0,
  7623           DFHEIV1,
  7624           DFHEIV99
  7625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7626
  7627
  7628 7010-EXIT.
  7629     EXIT.
  7630
  7631 7100-REWRITE-TRLR.
  7632
  7633     MOVE PI-PROCESSOR-ID        TO  PI-UPDATE-BY.
  7634     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL1502.cbl
  7635                                     PI-UPDATE-HHMMSS.
  7636
  7637
  7638* EXEC CICS REWRITE
  7639*        DATASET   ('ELTRLR')
  7640*        FROM      (ACTIVITY-TRAILERS)
  7641*    END-EXEC.
  7642     MOVE LENGTH OF
  7643      ACTIVITY-TRAILERS
  7644       TO DFHEIV11
  7645     MOVE 'ELTRLR' TO DFHEIV1
  7646*    MOVE '&& L                  %   #00007195' TO DFHEIV0
  7647     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7649     MOVE X'2020233030303037313935' TO DFHEIV0(25:11)
  7650     CALL 'kxdfhei1' USING DFHEIV0,
  7651           DFHEIV1,
  7652           ACTIVITY-TRAILERS,
  7653           DFHEIV11,
  7654           DFHEIV99
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658 7100-EXIT.
  7659     EXIT.
  7660
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL1502.cbl
  7662 7200-FIND-BENEFIT.
  7663
  7664     MOVE 'N'                    TO  WS-BEN-SEARCH-SW.
  7665
  7666
  7667* EXEC CICS HANDLE CONDITION
  7668*        ENDFILE   (7200-EXIT)
  7669*        NOTFND    (7200-EXIT)
  7670*    END-EXEC.
  7671*    MOVE '"$''I                  ! , #00007208' TO DFHEIV0
  7672     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7674     MOVE X'2C20233030303037323038' TO DFHEIV0(25:11)
  7675     CALL 'kxdfhei1' USING DFHEIV0
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7677
  7678
  7679
  7680* EXEC CICS READ
  7681*        DATASET   ('ELCNTL')
  7682*        RIDFLD    (ELCNTL-KEY)
  7683*        SET       (ADDRESS OF CONTROL-FILE)
  7684*        GTEQ
  7685*    END-EXEC.
  7686     MOVE 'ELCNTL' TO DFHEIV1
  7687*    MOVE '&"S        G          (   #00007213' TO DFHEIV0
  7688     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7690     MOVE X'2020233030303037323133' TO DFHEIV0(25:11)
  7691     CALL 'kxdfhei1' USING DFHEIV0,
  7692           DFHEIV1,
  7693           DFHEIV20,
  7694           DFHEIV99,
  7695           ELCNTL-KEY,
  7696           DFHEIV99,
  7697           DFHEIV99,
  7698           DFHEIV99
  7699     SET ADDRESS OF CONTROL-FILE TO
  7700         DFHEIV20
  7701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7702
  7703
  7704     IF CNTL-COMP-ID NOT  = CF-COMPANY-ID OR
  7705        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
  7706         GO TO 7200-EXIT.
  7707
  7708     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  7709         VARYING SUB FROM 1 BY 1 UNTIL
  7710         ((SUB > 8) OR
  7711         (CF-BENEFIT-CODE (SUB) = WS-BEN-CD)).
  7712
  7713     IF SUB NOT = 9
  7714         MOVE 'Y'             TO  WS-BEN-SEARCH-SW.
  7715
  7716     GO TO 7200-EXIT.
  7717
  7718 7200-BENEFIT-DUMMY.
  7719
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL1502.cbl
  7720 7200-DUMMY-EXIT.
  7721     EXIT.
  7722
  7723 7200-EXIT.
  7724     EXIT.
  7725 7400-DEL-TEMP-STOR-TABLE.
  7726
  7727
  7728* EXEC CICS HANDLE CONDITION
  7729*        QIDERR   (7400-EXIT)
  7730*    END-EXEC.
  7731*    MOVE '"$N                   ! - #00007243' TO DFHEIV0
  7732     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7734     MOVE X'2D20233030303037323433' TO DFHEIV0(25:11)
  7735     CALL 'kxdfhei1' USING DFHEIV0
  7736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7737
  7738
  7739
  7740* EXEC CICS DELETEQ TS
  7741*        QUEUE    (WS-TABLE-QID)
  7742*    END-EXEC.
  7743*    MOVE '*&                    #   #00007247' TO DFHEIV0
  7744     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7745     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7746     MOVE X'2020233030303037323437' TO DFHEIV0(25:11)
  7747     CALL 'kxdfhei1' USING DFHEIV0,
  7748           WS-TABLE-QID,
  7749           DFHEIV99
  7750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7751
  7752
  7753 7400-EXIT.
  7754     EXIT.
  7755
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL1502.cbl
  7757 7500-READ-CLAIM-MSTR-UPDATE.
  7758
  7759     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
  7760     MOVE PI-CARRIER             TO  MSTR-CARRIER.
  7761     MOVE PI-CLAIM-NO            TO  MSTR-CLAIM-NO.
  7762
  7763
  7764* EXEC CICS READ
  7765*        DATASET   ('ELMSTR')
  7766*        RIDFLD    (ELMSTR-KEY)
  7767*        SET       (ADDRESS OF CLAIM-MASTER)
  7768*        UPDATE
  7769*    END-EXEC.
  7770     MOVE 'ELMSTR' TO DFHEIV1
  7771*    MOVE '&"S        EU         (   #00007261' TO DFHEIV0
  7772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7773     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7774     MOVE X'2020233030303037323631' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0,
  7776           DFHEIV1,
  7777           DFHEIV20,
  7778           DFHEIV99,
  7779           ELMSTR-KEY,
  7780           DFHEIV99,
  7781           DFHEIV99,
  7782           DFHEIV99
  7783     SET ADDRESS OF CLAIM-MASTER TO
  7784         DFHEIV20
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7786
  7787
  7788 7500-EXIT.
  7789     EXIT.
  7790
  7791 7510-UNLOCK-CLAIM-MSTR.
  7792
  7793
  7794* EXEC CICS UNLOCK
  7795*        DATASET   ('ELMSTR')
  7796*    END-EXEC.
  7797     MOVE 'ELMSTR' TO DFHEIV1
  7798*    MOVE '&*                    #   #00007273' TO DFHEIV0
  7799     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7801     MOVE X'2020233030303037323733' TO DFHEIV0(25:11)
  7802     CALL 'kxdfhei1' USING DFHEIV0,
  7803           DFHEIV1,
  7804           DFHEIV99
  7805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7806
  7807
  7808 7510-EXIT.
  7809     EXIT.
  7810
  7811 7600-REWRITE-CLAIM-MSTR.
  7812
  7813     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  7814     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL1502.cbl
  7815     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  7816     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  7817
  7818
  7819* EXEC CICS REWRITE
  7820*        DATASET   ('ELMSTR')
  7821*        FROM      (CLAIM-MASTER)
  7822*    END-EXEC.
  7823     MOVE LENGTH OF
  7824      CLAIM-MASTER
  7825       TO DFHEIV11
  7826     MOVE 'ELMSTR' TO DFHEIV1
  7827*    MOVE '&& L                  %   #00007287' TO DFHEIV0
  7828     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037323837' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           DFHEIV1,
  7833           CLAIM-MASTER,
  7834           DFHEIV11,
  7835           DFHEIV99
  7836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7837
  7838
  7839 7600-EXIT.
  7840     EXIT.
  7841
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL1502.cbl
  7843 7700-READ-ELACTQ.
  7844
  7845
  7846* EXEC CICS HANDLE CONDITION
  7847*        NOTFND   (7799-EXIT)
  7848*    END-EXEC.
  7849*    MOVE '"$I                   ! . #00007298' TO DFHEIV0
  7850     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7852     MOVE X'2E20233030303037323938' TO DFHEIV0(25:11)
  7853     CALL 'kxdfhei1' USING DFHEIV0
  7854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7855
  7856
  7857
  7858* EXEC CICS READ
  7859*        DATASET   ('ELACTQ')
  7860*        RIDFLD    (ELACTQ-KEY)
  7861*        SET       (ADDRESS OF ACTIVITY-QUE)
  7862*        UPDATE
  7863*    END-EXEC.
  7864     MOVE 'ELACTQ' TO DFHEIV1
  7865*    MOVE '&"S        EU         (   #00007302' TO DFHEIV0
  7866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7868     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           DFHEIV1,
  7871           DFHEIV20,
  7872           DFHEIV99,
  7873           ELACTQ-KEY,
  7874           DFHEIV99,
  7875           DFHEIV99,
  7876           DFHEIV99
  7877     SET ADDRESS OF ACTIVITY-QUE TO
  7878         DFHEIV20
  7879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7880
  7881
  7882     IF AQ-PMT-UNAPPROVED-COUNT NOT NUMERIC
  7883         MOVE ZEROS              TO  AQ-PMT-UNAPPROVED-COUNT.
  7884
  7885     IF AQ-PAYMENT-COUNTER NOT NUMERIC
  7886         MOVE +0                 TO  AQ-PAYMENT-COUNTER.
  7887
  7888     IF WS-CF-PMT-APPROVAL-USED
  7889         IF AQ-PMT-UNAPPROVED-COUNT > +0 AND
  7890            WS-CHECK-WRITTEN-DT = LOW-VALUES AND
  7891            WS-PMT-APPROVAL-SW = 'U'
  7892             SUBTRACT +1 FROM AQ-PMT-UNAPPROVED-COUNT
  7893             MOVE 'Y'           TO  WS-UPDATE-SW.
  7894
  7895     IF PAYMENT-NOT-PRINTED OR
  7896        PAYMENT-NOT-RELEASED
  7897         IF AQ-PAYMENT-COUNTER > +0
  7898             SUBTRACT +1 FROM AQ-PAYMENT-COUNTER
  7899             MOVE 'Y'         TO  WS-UPDATE-SW.
  7900
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL1502.cbl
  7901     IF AQ-PAYMENT-COUNTER = +0
  7902         MOVE ' '             TO  AQ-PENDING-PAYMENT-FLAG.
  7903
  7904     IF WS-UPDATE-SW = 'Y'
  7905         IF AQ-PENDING-ACTIVITY-FLAGS = SPACES
  7906             MOVE 'N'            TO  WS-UPDATE-SW
  7907             GO TO 7720-DELETE-ACTIVITY-QUE
  7908         ELSE
  7909             MOVE 'N'            TO  WS-UPDATE-SW
  7910     ELSE
  7911         GO TO 7750-UNLOCK-ACTIVITY-QUE.
  7912
  7913 7710-REWRITE-ACTIVITY-QUE.
  7914
  7915
  7916* EXEC CICS REWRITE
  7917*        DATASET   ('ELACTQ')
  7918*        FROM      (ACTIVITY-QUE)
  7919*    END-EXEC.
  7920     MOVE LENGTH OF
  7921      ACTIVITY-QUE
  7922       TO DFHEIV11
  7923     MOVE 'ELACTQ' TO DFHEIV1
  7924*    MOVE '&& L                  %   #00007342' TO DFHEIV0
  7925     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7926     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7927     MOVE X'2020233030303037333432' TO DFHEIV0(25:11)
  7928     CALL 'kxdfhei1' USING DFHEIV0,
  7929           DFHEIV1,
  7930           ACTIVITY-QUE,
  7931           DFHEIV11,
  7932           DFHEIV99
  7933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7934
  7935
  7936     GO TO 7799-EXIT.
  7937
  7938 7720-DELETE-ACTIVITY-QUE.
  7939
  7940
  7941* EXEC CICS DELETE
  7942*        DATASET   ('ELACTQ')
  7943*    END-EXEC.
  7944     MOVE 'ELACTQ' TO DFHEIV1
  7945*    MOVE '&(                    &   #00007351' TO DFHEIV0
  7946     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7948     MOVE X'2020233030303037333531' TO DFHEIV0(25:11)
  7949     CALL 'kxdfhei1' USING DFHEIV0,
  7950           DFHEIV1,
  7951           DFHEIV99,
  7952           DFHEIV99,
  7953           DFHEIV99,
  7954           DFHEIV99
  7955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7956
  7957
  7958     GO TO 7799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL1502.cbl
  7959
  7960 7750-UNLOCK-ACTIVITY-QUE.
  7961
  7962
  7963* EXEC CICS UNLOCK
  7964*        DATASET   ('ELACTQ')
  7965*    END-EXEC.
  7966     MOVE 'ELACTQ' TO DFHEIV1
  7967*    MOVE '&*                    #   #00007359' TO DFHEIV0
  7968     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7969     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7970     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
  7971     CALL 'kxdfhei1' USING DFHEIV0,
  7972           DFHEIV1,
  7973           DFHEIV99
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7975
  7976
  7977     MOVE 'N'                    TO  WS-UPDATE-SW.
  7978
  7979 7799-EXIT.
  7980     EXIT.
  7981
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL1502.cbl
  7983 7800-READ-CERT-UPDATE.
  7984
  7985
  7986* EXEC CICS READ
  7987*        DATASET   ('ELCERT')
  7988*        RIDFLD    (ELCERT-KEY)
  7989*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  7990*        UPDATE
  7991*    END-EXEC.
  7992     MOVE 'ELCERT' TO DFHEIV1
  7993*    MOVE '&"S        EU         (   #00007371' TO DFHEIV0
  7994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7996     MOVE X'2020233030303037333731' TO DFHEIV0(25:11)
  7997     CALL 'kxdfhei1' USING DFHEIV0,
  7998           DFHEIV1,
  7999           DFHEIV20,
  8000           DFHEIV99,
  8001           ELCERT-KEY,
  8002           DFHEIV99,
  8003           DFHEIV99,
  8004           DFHEIV99
  8005     SET ADDRESS OF CERTIFICATE-MASTER TO
  8006         DFHEIV20
  8007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8008
  8009
  8010 7800-EXIT.
  8011     EXIT.
  8012
  8013 7810-REWRITE-CERT.
  8014
  8015
  8016* EXEC CICS REWRITE
  8017*        DATASET   ('ELCERT')
  8018*        FROM      (CERTIFICATE-MASTER)
  8019*    END-EXEC.
  8020     MOVE LENGTH OF
  8021      CERTIFICATE-MASTER
  8022       TO DFHEIV11
  8023     MOVE 'ELCERT' TO DFHEIV1
  8024*    MOVE '&& L                  %   #00007383' TO DFHEIV0
  8025     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8027     MOVE X'2020233030303037333833' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0,
  8029           DFHEIV1,
  8030           CERTIFICATE-MASTER,
  8031           DFHEIV11,
  8032           DFHEIV99
  8033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8034
  8035
  8036 7810-EXIT.
  8037     EXIT.
  8038
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL1502.cbl
  8040 7900-READ-CONTROL-FILE.
  8041
  8042
  8043* EXEC CICS READ
  8044*        DATASET   ('ELCNTL')
  8045*        RIDFLD    (ELCNTL-KEY)
  8046*        SET       (ADDRESS OF CONTROL-FILE)
  8047*    END-EXEC.
  8048     MOVE 'ELCNTL' TO DFHEIV1
  8049*    MOVE '&"S        E          (   #00007394' TO DFHEIV0
  8050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8052     MOVE X'2020233030303037333934' TO DFHEIV0(25:11)
  8053     CALL 'kxdfhei1' USING DFHEIV0,
  8054           DFHEIV1,
  8055           DFHEIV20,
  8056           DFHEIV99,
  8057           ELCNTL-KEY,
  8058           DFHEIV99,
  8059           DFHEIV99,
  8060           DFHEIV99
  8061     SET ADDRESS OF CONTROL-FILE TO
  8062         DFHEIV20
  8063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8064
  8065
  8066 7900-EXIT.
  8067     EXIT.
  8068
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL1502.cbl
  8070 8000-LOAD-ERROR-MESSAGES.
  8071     IF EMI-NO-ERRORS
  8072         GO TO 8000-EXIT.
  8073
  8074     IF EMI-NUMBER-OF-LINES = 1
  8075         MOVE EMI-LINE1          TO  ERRMSG1O
  8076         GO TO 8000-EXIT.
  8077
  8078     MOVE EMI-LINE1              TO  ERRMSG1O.
  8079
  8080 8000-EXIT.
  8081     EXIT.
  8082
  8083 8100-SEND-INITIAL-MAP.
  8084
  8085     IF PI-FULL-SCREEN-SHOWN
  8086         GO TO 8200-SEND-DATAONLY.
  8087
  8088     MOVE 'Y'                    TO PI-FULL-SCREEN-IND.
  8089     MOVE SAVE-DATE              TO  RUNDTEO.
  8090     MOVE EIBTIME                TO  TIME-IN.
  8091     MOVE TIME-OUT               TO  RUNTIMEO.
  8092     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  8093     MOVE PI-PRIME-CERT          TO  PCERTNOO.
  8094     MOVE PI-PRIME-SUFX          TO  SUFXO.
  8095     MOVE PI-PRIME-HDG           TO  PRIMEHDO.
  8096     MOVE AL-SABON               TO  PCERTNOA
  8097                                     SUFXA
  8098                                     PRIMEHDA.
  8099
  8100*    IF PI-COMPANY-ID NOT = 'DMD'
  8101         MOVE SPACES             TO PF6O.
  8102         MOVE AL-SADOF           TO PF6A.
  8103
  8104
  8105* EXEC CICS SEND
  8106*        MAP      (MAP-NAME)
  8107*        MAPSET   (MAPSET-NAME)
  8108*        FROM     (EL150CO)
  8109*        ERASE
  8110*        CURSOR
  8111*    END-EXEC.
  8112     MOVE LENGTH OF
  8113      EL150CO
  8114       TO DFHEIV12
  8115     MOVE -1
  8116       TO DFHEIV11
  8117*    MOVE '8$     CT  E    H L F ,   #00007438' TO DFHEIV0
  8118     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8119     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8120     MOVE X'2020233030303037343338' TO DFHEIV0(25:11)
  8121     CALL 'kxdfhei1' USING DFHEIV0,
  8122           MAP-NAME,
  8123           EL150CO,
  8124           DFHEIV12,
  8125           MAPSET-NAME,
  8126           DFHEIV99,
  8127           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL1502.cbl
  8128           DFHEIV99,
  8129           DFHEIV11,
  8130           DFHEIV99,
  8131           DFHEIV99,
  8132           DFHEIV99
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8134
  8135
  8136     GO TO 9100-RETURN-TRAN.
  8137
  8138 8200-SEND-DATAONLY.
  8139
  8140     IF NOT PI-FULL-SCREEN-SHOWN
  8141         GO TO 8100-SEND-INITIAL-MAP.
  8142
  8143     MOVE SAVE-DATE              TO  RUNDTEO.
  8144     MOVE EIBTIME                TO  TIME-IN.
  8145     MOVE TIME-OUT               TO  RUNTIMEO.
  8146     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
  8147
  8148     MOVE PI-CARRIER             TO  CARRO.
  8149     MOVE PI-CLAIM-NO            TO  CLMNOO.
  8150     MOVE PI-PRIME-CERT          TO  PCERTNOO.
  8151     MOVE PI-PRIME-SUFX          TO  SUFXO.
  8152     MOVE PI-PRIME-HDG           TO  PRIMEHDO.
  8153     MOVE AL-SABON               TO  PCERTNOA
  8154                                     SUFXA
  8155                                     PRIMEHDA.
  8156
  8157*    IF PI-COMPANY-ID NOT = 'DMD'
  8158         MOVE SPACES             TO PF6O.
  8159         MOVE AL-SADOF           TO PF6A.
  8160
  8161
  8162* EXEC CICS SEND
  8163*        MAP      (MAP-NAME)
  8164*        MAPSET   (MAPSET-NAME)
  8165*        FROM     (EL150CO)
  8166*        DATAONLY
  8167*        CURSOR
  8168*    END-EXEC.
  8169     MOVE LENGTH OF
  8170      EL150CO
  8171       TO DFHEIV12
  8172     MOVE -1
  8173       TO DFHEIV11
  8174*    MOVE '8$D    CT       H L F ,   #00007471' TO DFHEIV0
  8175     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8176     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8177     MOVE X'2020233030303037343731' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0,
  8179           MAP-NAME,
  8180           EL150CO,
  8181           DFHEIV12,
  8182           MAPSET-NAME,
  8183           DFHEIV99,
  8184           DFHEIV99,
  8185           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL1502.cbl
  8186           DFHEIV11,
  8187           DFHEIV99,
  8188           DFHEIV99,
  8189           DFHEIV99
  8190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8191
  8192
  8193     GO TO 9100-RETURN-TRAN.
  8194
  8195 8300-SEND-TEXT.
  8196
  8197* EXEC CICS SEND TEXT
  8198*        FROM     (LOGOFF-TEXT)
  8199*        LENGTH   (LOGOFF-LENGTH)
  8200*        ERASE
  8201*        FREEKB
  8202*    END-EXEC.
  8203*    MOVE '8&      T  E F  H   F -   #00007482' TO DFHEIV0
  8204     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8205     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8206     MOVE X'2020233030303037343832' TO DFHEIV0(25:11)
  8207     CALL 'kxdfhei1' USING DFHEIV0,
  8208           LOGOFF-TEXT,
  8209           LOGOFF-LENGTH,
  8210           DFHEIV99,
  8211           DFHEIV99,
  8212           DFHEIV99,
  8213           DFHEIV99,
  8214           DFHEIV99,
  8215           DFHEIV99,
  8216           DFHEIV99,
  8217           DFHEIV99,
  8218           DFHEIV99,
  8219           DFHEIV99
  8220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8221
  8222
  8223
  8224* EXEC CICS RETURN
  8225*    END-EXEC.
  8226*    MOVE '.(                    &   #00007489' TO DFHEIV0
  8227     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037343839' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           DFHEIV99,
  8232           DFHEIV99,
  8233           DFHEIV99,
  8234           DFHEIV99,
  8235           DFHEIV99
  8236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8237
  8238
  8239 8400-NOT-FOUND.
  8240     IF FILE-SWITCH = 'BENE'
  8241         MOVE ER-0282            TO  EMI-ERROR.
  8242
  8243     MOVE -1                     TO  LINENOL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL1502.cbl
  8244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8245
  8246     IF PASS-SWITCH = 'A'
  8247         GO TO 8100-SEND-INITIAL-MAP
  8248     ELSE
  8249         GO TO 8200-SEND-DATAONLY.
  8250
  8251 8500-FILE-NOTOPEN.
  8252
  8253     IF FILE-SWITCH = 'TRLR'
  8254         MOVE ER-0172            TO  EMI-ERROR.
  8255
  8256     IF FILE-SWITCH = 'CERT'
  8257         MOVE ER-0169            TO  EMI-ERROR.
  8258
  8259     IF FILE-SWITCH = 'CNTL'
  8260         MOVE ER-0042            TO  EMI-ERROR.
  8261
  8262     IF FILE-SWITCH = 'ACTQ'
  8263         MOVE ER-0338            TO  EMI-ERROR.
  8264
  8265     IF FILE-SWITCH = 'MSTR'
  8266         MOVE ER-0154            TO  EMI-ERROR.
  8267
  8268     IF FILE-SWITCH = 'RCON'
  8269         MOVE ER-0776            TO  EMI-ERROR.
  8270
  8271     IF FILE-SWITCH = 'PLCY'
  8272         MOVE ER-9883            TO  EMI-ERROR.
  8273
  8274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8275
  8276     MOVE -1                     TO  LINENOL.
  8277
  8278     IF PASS-SWITCH = 'A'
  8279         GO TO 8100-SEND-INITIAL-MAP
  8280     ELSE
  8281         GO TO 8200-SEND-DATAONLY.
  8282
  8283 8800-UNAUTHORIZED-ACCESS.
  8284     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8285     GO TO 8300-SEND-TEXT.
  8286
  8287 8810-PF23.
  8288     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8289     MOVE XCTL-005               TO  PGM-NAME.
  8290     GO TO 9300-XCTL.
  8291
  8292 9100-RETURN-TRAN.
  8293     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8294     MOVE '150C'                 TO  PI-CURRENT-SCREEN-NO.
  8295
  8296
  8297* EXEC CICS RETURN
  8298*        TRANSID    (TRANS-ID)
  8299*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8300*        LENGTH     (PI-COMM-LENGTH)
  8301*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL1502.cbl
  8302*    MOVE '.(CT                  &   #00007549' TO DFHEIV0
  8303     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8305     MOVE X'2020233030303037353439' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0,
  8307           TRANS-ID,
  8308           PROGRAM-INTERFACE-BLOCK,
  8309           PI-COMM-LENGTH,
  8310           DFHEIV99,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8313
  8314
  8315 9200-RETURN-MAIN-MENU.
  8316     MOVE XCTL-126               TO PGM-NAME.
  8317     GO TO 9300-XCTL.
  8318
  8319 9300-XCTL.
  8320
  8321* EXEC CICS HANDLE CONDITION
  8322*        PGMIDERR   (9350-NOT-FOUND)
  8323*    END-EXEC.
  8324*    MOVE '"$L                   ! / #00007560' TO DFHEIV0
  8325     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8327     MOVE X'2F20233030303037353630' TO DFHEIV0(25:11)
  8328     CALL 'kxdfhei1' USING DFHEIV0
  8329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8330
  8331
  8332
  8333* EXEC CICS XCTL
  8334*        PROGRAM    (PGM-NAME)
  8335*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8336*        LENGTH     (PI-COMM-LENGTH)
  8337*    END-EXEC.
  8338*    MOVE '.$C                   $   #00007564' TO DFHEIV0
  8339     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303037353634' TO DFHEIV0(25:11)
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           PGM-NAME,
  8344           PROGRAM-INTERFACE-BLOCK,
  8345           PI-COMM-LENGTH
  8346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8347
  8348
  8349 9350-NOT-FOUND.
  8350     MOVE ER-0923                TO EMI-ERROR.
  8351     MOVE -1                     TO LINENOL.
  8352     PERFORM 9900-ERROR-FORMAT      THRU 9900-EXIT.
  8353     PERFORM 7510-UNLOCK-CLAIM-MSTR THRU 7510-EXIT.
  8354     PERFORM 7010-UNLOCK-TRLR       THRU 7010-EXIT.
  8355     GO TO 8200-SEND-DATAONLY.
  8356
  8357 9400-CLEAR.
  8358     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8359     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL1502.cbl
  8360
  8361 9500-PF12.
  8362     MOVE XCTL-010               TO  PGM-NAME.
  8363     GO TO 9300-XCTL.
  8364
  8365 9600-PGMID-ERROR.
  8366
  8367* EXEC CICS HANDLE CONDITION
  8368*        PGMIDERR   (8300-SEND-TEXT)
  8369*    END-EXEC.
  8370*    MOVE '"$L                   ! 0 #00007587' TO DFHEIV0
  8371     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8373     MOVE X'3020233030303037353837' TO DFHEIV0(25:11)
  8374     CALL 'kxdfhei1' USING DFHEIV0
  8375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8376
  8377
  8378     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8379     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8380     MOVE XCTL-005               TO  PGM-NAME.
  8381     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8382     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8383     GO TO 9300-XCTL.
  8384
  8385 9700-LINK-DATE-CONVERT.
  8386     MOVE LINK-ELDATCV           TO PGM-NAME.
  8387
  8388
  8389* EXEC CICS LINK
  8390*        PROGRAM    (PGM-NAME)
  8391*        COMMAREA   (DATE-CONVERSION-DATA)
  8392*        LENGTH     (DC-COMM-LENGTH)
  8393*    END-EXEC.
  8394*    MOVE '."C                   ''   #00007601' TO DFHEIV0
  8395     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303037363031' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           PGM-NAME,
  8400           DATE-CONVERSION-DATA,
  8401           DC-COMM-LENGTH,
  8402           DFHEIV99,
  8403           DFHEIV99,
  8404           DFHEIV99
  8405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8406
  8407
  8408 9700-EXIT.
  8409     EXIT.
  8410
  8411 9800-DEEDIT.
  8412
  8413
  8414* EXEC CICS BIF DEEDIT
  8415*        FIELD   (WS-DEEDIT-FIELD)
  8416*        LENGTH  (WS-DEEDIT-LENGTH)
  8417*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL1502.cbl
  8418*    MOVE '@"L                   #   #00007612' TO DFHEIV0
  8419     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8421     MOVE X'2020233030303037363132' TO DFHEIV0(25:11)
  8422     CALL 'kxdfhei1' USING DFHEIV0,
  8423           WS-DEEDIT-FIELD,
  8424           WS-DEEDIT-LENGTH
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427
  8428 9800-EXIT.
  8429     EXIT.
  8430
  8431 9900-ERROR-FORMAT.
  8432     IF NOT EMI-ERRORS-COMPLETE
  8433         MOVE LINK-001           TO PGM-NAME
  8434
  8435* EXEC CICS LINK
  8436*            PROGRAM    (PGM-NAME)
  8437*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8438*            LENGTH     (EMI-COMM-LENGTH)
  8439*        END-EXEC.
  8440*    MOVE '."C                   ''   #00007623' TO DFHEIV0
  8441     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8443     MOVE X'2020233030303037363233' TO DFHEIV0(25:11)
  8444     CALL 'kxdfhei1' USING DFHEIV0,
  8445           PGM-NAME,
  8446           ERROR-MESSAGE-INTERFACE-BLOCK,
  8447           EMI-COMM-LENGTH,
  8448           DFHEIV99,
  8449           DFHEIV99,
  8450           DFHEIV99
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8452
  8453
  8454 9900-EXIT.
  8455     EXIT.
  8456
  8457 9990-ABEND.
  8458     MOVE -1                     TO  ENTERPFL.
  8459     MOVE LINK-004               TO  PGM-NAME.
  8460
  8461     MOVE DFHEIBLK               TO  EMI-LINE1
  8462
  8463* EXEC CICS LINK
  8464*        PROGRAM   (PGM-NAME)
  8465*        COMMAREA  (EMI-LINE1)
  8466*        LENGTH    (72)
  8467*    END-EXEC.
  8468     MOVE 72
  8469       TO DFHEIV11
  8470*    MOVE '."C                   ''   #00007637' TO DFHEIV0
  8471     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8473     MOVE X'2020233030303037363337' TO DFHEIV0(25:11)
  8474     CALL 'kxdfhei1' USING DFHEIV0,
  8475           PGM-NAME,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL1502.cbl
  8476           EMI-LINE1,
  8477           DFHEIV11,
  8478           DFHEIV99,
  8479           DFHEIV99,
  8480           DFHEIV99
  8481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8482
  8483
  8484     MOVE EMI-LINE1              TO  ERRMSG1O.
  8485     GO TO 8200-SEND-DATAONLY.
  8486
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL1502.cbl
  8488 9995-SECURITY-VIOLATION.
  8489*                            COPY ELCSCTP.
  8490******************************************************************
  8491*                                                                *
  8492*                            ELCSCTP                             *
  8493*                            VMOD=2.001                          *
  8494*                                                                *
  8495*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8496******************************************************************
  8497
  8498
  8499     MOVE EIBDATE          TO SM-JUL-DATE.
  8500     MOVE EIBTRMID         TO SM-TERMID.
  8501     MOVE THIS-PGM         TO SM-PGM.
  8502     MOVE EIBTIME          TO TIME-IN.
  8503     MOVE TIME-OUT         TO SM-TIME.
  8504     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8505
  8506
  8507* EXEC CICS LINK
  8508*         PROGRAM  ('EL003')
  8509*         COMMAREA (SECURITY-MESSAGE)
  8510*         LENGTH   (80)
  8511*    END-EXEC.
  8512     MOVE 'EL003' TO DFHEIV1
  8513     MOVE 80
  8514       TO DFHEIV11
  8515*    MOVE '."C                   ''   #00007665' TO DFHEIV0
  8516     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8518     MOVE X'2020233030303037363635' TO DFHEIV0(25:11)
  8519     CALL 'kxdfhei1' USING DFHEIV0,
  8520           DFHEIV1,
  8521           SECURITY-MESSAGE,
  8522           DFHEIV11,
  8523           DFHEIV99,
  8524           DFHEIV99,
  8525           DFHEIV99
  8526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8527
  8528
  8529******************************************************************
  8530
  8531
  8532
  8533 9999-DFHBACK SECTION.
  8534     MOVE '9%                    "   ' TO DFHEIV0
  8535     MOVE 'EL1502' TO DFHEIV1
  8536     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8537     GOBACK.
  8538 9999-DFHEXIT.
  8539     IF DFHEIGDJ EQUAL 0001
  8540         NEXT SENTENCE
  8541     ELSE IF DFHEIGDJ EQUAL 2
  8542         GO TO 1000-SHOW-CLAIM-HISTORY,
  8543               0100-FIRST-TIME-IN,
  8544               8500-FILE-NOTOPEN,
  8545               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL1502.cbl
  8546               9990-ABEND
  8547         DEPENDING ON DFHEIGDI
  8548     ELSE IF DFHEIGDJ EQUAL 3
  8549         GO TO 0900-BUILD-RELATED-TABLE
  8550         DEPENDING ON DFHEIGDI
  8551     ELSE IF DFHEIGDJ EQUAL 4
  8552         GO TO 0690-QIDERR
  8553         DEPENDING ON DFHEIGDI
  8554     ELSE IF DFHEIGDJ EQUAL 5
  8555         GO TO 0890-QIDERR
  8556         DEPENDING ON DFHEIGDI
  8557     ELSE IF DFHEIGDJ EQUAL 6
  8558         GO TO 0950-SORT-ROUTINE
  8559         DEPENDING ON DFHEIGDI
  8560     ELSE IF DFHEIGDJ EQUAL 7
  8561         GO TO 0915-ELMSTR-ENDFILE
  8562         DEPENDING ON DFHEIGDI
  8563     ELSE IF DFHEIGDJ EQUAL 8
  8564         GO TO 0945-ENDBR-ELTRLR
  8565         DEPENDING ON DFHEIGDI
  8566     ELSE IF DFHEIGDJ EQUAL 9
  8567         GO TO 2950-NO-MORE-TRAILERS,
  8568               2950-NO-MORE-TRAILERS
  8569         DEPENDING ON DFHEIGDI
  8570     ELSE IF DFHEIGDJ EQUAL 10
  8571         GO TO 5290-NOTFND
  8572         DEPENDING ON DFHEIGDI
  8573     ELSE IF DFHEIGDJ EQUAL 11
  8574         GO TO 5700-NOT-FOUND,
  8575               8500-FILE-NOTOPEN
  8576         DEPENDING ON DFHEIGDI
  8577     ELSE IF DFHEIGDJ EQUAL 12
  8578         GO TO 7200-EXIT,
  8579               7200-EXIT
  8580         DEPENDING ON DFHEIGDI
  8581     ELSE IF DFHEIGDJ EQUAL 13
  8582         GO TO 7400-EXIT
  8583         DEPENDING ON DFHEIGDI
  8584     ELSE IF DFHEIGDJ EQUAL 14
  8585         GO TO 7799-EXIT
  8586         DEPENDING ON DFHEIGDI
  8587     ELSE IF DFHEIGDJ EQUAL 15
  8588         GO TO 9350-NOT-FOUND
  8589         DEPENDING ON DFHEIGDI
  8590     ELSE IF DFHEIGDJ EQUAL 16
  8591         GO TO 8300-SEND-TEXT
  8592         DEPENDING ON DFHEIGDI.
  8593     MOVE '9%                    "   ' TO DFHEIV0
  8594     MOVE 'EL1502' TO DFHEIV1
  8595     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8596     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13556     Code:       23135
