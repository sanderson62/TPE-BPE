* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   1
* WSMESS01.cbl
* Options: int("WSMESS01.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS01.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS01.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS01.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS01.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 05-Feb-19 08:05.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   2
* WSMESS01.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Returns premium calc based on info passed to me.              *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program
    27* 080117   2017020300002   PEMA  Tol for tot pmts, use totpmts GP
    28* 080817   2017020300002   PEMA  Limit and ben code assign changes
    29******************************************************************
    30 ENVIRONMENT DIVISION.
    31 data division.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35 77  FILLER  PIC X(32) VALUE '   WSMESS01 WORKING STORAGE     '.
    36 77  FILLER  PIC X(32) VALUE '********************************'.
    37*
    38* program buffers
    39*
    40 77  ws-seq-num                  pic s9(8) comp value 0.
    41 77  ws-flags                    pic s9(8) comp value 0.
    42 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
    43 77  ws-comp-id                  pic xxx value spaces.
    44 77  WS-SAVE-ACCOUNT             PIC X(10)  VALUE SPACES.
    45 77  WS-BIN-ORIG-EFF-DT          PIC XX  VALUE LOW-VALUES.
    46 77  WS-ORIG-EFF-DT              PIC X(10)  VALUE SPACES.
    47 77  WS-EFF-DATE                 PIC X(10)  VALUE SPACES.
    48 77  WS-EXP-DATE                 PIC X(10)  VALUE SPACES.
    49 77  X1                          PIC S999 COMP-3 VALUE +0.
    50 77  S1                          PIC S999 COMP-3 VALUE +0.
    51 77  S2                          PIC S999 COMP-3 VALUE +0.
    52 77  S3                          PIC S999 COMP-3 VALUE +0.
    53 77  b1                          pic s999 comp-3 value +0.
    54 77  WS-BUILD-SW                 PIC X.
    55     88  TIME-TO-BUILD              VALUE 'Y'.
    56 77  WS-SAVE-ERACCT              PIC X(2000).
    57 77  WS-DIS-RESP                 PIC 9(05) VALUE ZEROS.
    58 77  WS-PERFORM-SW               PIC X VALUE SPACES.
    59     88  GET-RATES                   VALUE 'R'.
    60     88  GET-ACT-ACCTS               VALUE 'A'.
    61 77  ws-bin-current-dt           pic xx  value low-values.
    62 77  ws-bin-eff-dt               pic xx  value low-values.
    63 77  ws-bin-exp-dt               pic xx  value low-values.
    64 77  ws-bin-1st-pmt-dt           pic xx  value low-values.
    65 77  ws-bin-pri-birth-dt         pic xx  value low-values.
    66 77  ws-bin-cob-birth-dt         pic xx  value low-values.
    67 77  WS-DISP-AMT                 PIC Z,ZZZ,Z99.99.
    68 77  ws-disp-rate                pic z9.99999.
    69 77  WS-ERACCT-SW                PIC X VALUE ' '.
    70     88  END-OF-ERACCT                 VALUE 'Y'.
    71 77  WS-ERCTBL-SW                PIC X VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   3
* WSMESS01.cbl
    72     88  END-OF-ERCTBL                 VALUE 'Y'.
    73 77  WS-STATUS                   PIC X.
    74 77  ws-socket-sw                pic x value ' '.
    75     88  end-of-socket              value 'Y'.
    76 77  rec-cnt                     pic 9(5) value zeros.
    77 77  ws-stop-sw                  pic x value ' '.
    78     88  i-say-stop                 value 'Y'.
    79 77  ws-browse-sw                pic x value ' '.
    80     88  browse-started            value 'Y'.
    81 77  ws-contract-sw              pic x  value ' '.
    82     88  contract-no-assigned      value 'Y'.
    83 77  ws-error-sw                 pic x value ' '.
    84     88  error-in-one-coverage     value 'Y'.
    85 77  ws-connect-sw               pic x value ' '.
    86     88  connected-to-db           value 'Y'.
    87 77  client-id                   pic xxx.
    88 77  ws-error-sub                pic 999  value zeros.
    89 77  ws-error-sup                pic x(25) value spaces.
    90 77  ws-form-limit-name          pic x(50) value spaces.
    91 77  l1                          pic s999 comp-3 value +0.
    92 77  ws-extension-days           pic 999 value zeros.
    93 01  P pointer.
    94 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    95 01  var-ptr pointer.
    96 01  env-var-len                 pic 9(4)  binary.
    97 01  rc                          pic 9(9)  binary.
    98 01  WS-KIXSYS.
    99     05  WS-KIX-FIL1             PIC X(10).
   100     05  WS-KIX-APPS             PIC X(10).
   101     05  WS-KIX-ENV              PIC X(10).
   102     05  WS-KIX-MYENV            PIC X(10).
   103     05  WS-KIX-SYS              PIC X(10).
*  104 EXEC SQL
*  105    INCLUDE SQLDA
*  106 END-EXEC
   107 01 SQLDA sync.
   108    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   109    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   110    05 SQLN                  PIC S9(4) COMP-5 value 0.
   111    05 SQLD                  PIC S9(4) COMP-5 value 0.
   112    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   113       10 SQLTYPE            PIC S9(4) COMP-5.
   114       10 SQLLEN             PIC S9(4) COMP-5.
   115$IF P64 SET
   116X      *> For 64-bit environments, ensure that SQLDATA is
   117X      *> aligned on an 8-byte boundary.
   118X      10 FILLER             PIC S9(9) COMP-5.
   119$END
   120       10 SQLDATA            USAGE POINTER.
   121       10 SQLIND             USAGE POINTER.
   122       10 SQLNAME.
   123          15 SQLNAMEL        PIC S9(4) COMP-5.
   124          15 SQLNAMEC        PIC X(30).
   125
   126* Values for SQLTYPE
   127
   128 78  ESQL-DATE-CHAR              VALUE 384.
   129 78  ESQL-DATE-CHAR-NULL         VALUE 385.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   4
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DATE-REC               VALUE 386.
   131 78  ESQL-DATE-REC-NULL          VALUE 387.
   132 78  ESQL-TIME-CHAR              VALUE 388.
   133 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   134 78  ESQL-TIME-REC               VALUE 390.
   135 78  ESQL-TIME-REC-NULL          VALUE 391.
   136 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   137 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   138 78  ESQL-TIMESTAMP-REC          VALUE 394.
   139 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   140 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   141 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   142 78  ESQL-TS-OFFSET-REC          VALUE 398.
   143 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   144 78  ESQL-LONGVARBINARY          VALUE 404.
   145 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   146 78  ESQL-LONGVARCHAR            VALUE 408.
   147 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   148 78  ESQL-BINARY                 VALUE 444.
   149 78  ESQL-BINARY-NULL            VALUE 445.
   150 78  ESQL-VARBINARY              VALUE 446.
   151 78  ESQL-VARBINARY-NULL         VALUE 447.
   152 78  ESQL-VARCHAR                VALUE 448.
   153 78  ESQL-VARCHAR-NULL           VALUE 449.
   154
   155 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   156 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   157
   158 78  ESQL-CHAR                   VALUE 452.
   159 78  ESQL-CHAR-NULL              VALUE 453.
   160
   161 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   162 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   163
   164 78  ESQL-DOUBLE                 VALUE 480.
   165 78  ESQL-DOUBLE-NULL            VALUE 481.
   166 78  ESQL-REAL                   VALUE 482.
   167 78  ESQL-REAL-NULL              VALUE 483.
   168 78  ESQL-DECIMAL                VALUE 484.
   169 78  ESQL-DECIMAL-NULL           VALUE 485.
   170 78  ESQL-INTEGER                VALUE 496.
   171 78  ESQL-INTEGER-NULL           VALUE 497.
   172 78  ESQL-SMALLINT               VALUE 500.
   173 78  ESQL-SMALLINT-NULL          VALUE 501.
   174 78  ESQL-TINYINT                VALUE 502.
   175 78  ESQL-TINYINT-NULL           VALUE 503.
*  176 EXEC SQL
*  177    INCLUDE SQLCA
*  178 END-EXEC
   179 01 SQLCA.
   180     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   181     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   182     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   183     05  SQLERRM.
   184         49  SQLERRML    PIC S9(4) COMP-5.
   185         49  SQLERRMC    PIC X(70).
   186     05  SQLERRP         PIC X(8).
   187     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   5
* WSMESS01.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLWARN.
   189         10  SQLWARN0    PIC X.
   190         10  SQLWARN1    PIC X.
   191         10  SQLWARN2    PIC X.
   192         10  SQLWARN3    PIC X.
   193         10  SQLWARN4    PIC X.
   194         10  SQLWARN5    PIC X.
   195         10  SQLWARN6    PIC X.
   196         10  SQLWARN7    PIC X.
   197     05  SQLEXT.
   198         10  SQLWARN8    PIC X.
   199         10  SQLWARN9    PIC X.
   200         10  SQLWARN10   PIC X.
   201         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   202     05  SQLSTATE    PIC X(5).
   203 EXEC SQL
   204    BEGIN DECLARE SECTION
   205 END-EXEC
   206 01  ws-dealer-state             pic xx.
   207 01  ws-dealer-id                pic x(10).
   208 01  ws-contract-eff-dt          pic x(10).
   209 01  ws-contract-no              pic x(10) value spaces.
   210 01  ws-contract-suffix          pic x     value spaces.
   211 01  ws-key-stuff.
   212     05  ws-ks-contract-no       pic x(10) value spaces.
   213     05  ws-batch-no             pic x(6) value zeros.
   214     05  ws-batch-no-n redefines
   215         ws-batch-no             pic 9(6).
   216     05  ws-check-key            pic 9(7).
   217     05  ws-check-no             pic x(7).
   218     05  ws-compid               pic xxx.
   219     05  ws-carrier              pic x.
   220     05  ws-grouping             pic x(6).
   221     05  ws-state                pic xx.
   222     05  ws-account              pic x(10).
   223     05  ws-eff-date             pic x(10).
   224     05  ws-certificate          pic x(10).
   225     05  ws-cert-sfx             pic x.
   226     05  ws-seq-no               pic 999.
   227     05  ws-type                 pic 999.
   228 01  ws-status-code-a            pic x(7) value zeros.
   229 01  ws-status-code redefines
   230     ws-status-code-a            pic 9(7).
   231 01  ws-error-message            pic x(50) value spaces.
   232 01  ws-status-date              pic x(10).
   233 01  sqlcmd                      pic x(1024).
   234 01  svr                         pic x(32).
   235 01  usr                         pic x(32).
   236 01  pass                        pic x(32).
   237 01  usr-pass                    pic x(64).
   238 01  ws-disp-code                pic s9(11).
   239***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   240***                                                            ***
   241***  These indicators are used to determine if a variable      ***
   242***  is        null.           The indicator will be -1        ***
   243***  if the value        is null  and +0 if the value is       ***
   244***  something other than null.  Here is an example on how     ***
   245***  to use the indicator variables.                           ***
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   6
* WSMESS01.cbl
   246***                                                            ***
   247***     EXEC SQL                                               ***
   248***        fetch checkapp into                                 ***
   249***           :db-app-status :nu-app-status,                   ***
   250***           :db-app-by     :nu-app-by,                       ***
   251***           :db-app-date   :nu-app-date,                     ***
   252***           :db-app-batch  :nu-app-batch                     ***
   253***     END-EXEC                                               ***
   254***                                                            ***
   255***           OR This way on an update                         ***
   256***                                                            ***
   257***     EXEC SQL                                               ***
   258***        UPDATE                                              ***
   259***           CUC_Logic_Remittance                             ***
   260***        SET                                                 ***
   261***           LogicStatus     = :ws-status-code,               ***
   262***           LogicStatusDate = :ws-status-date,               ***
   263***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   264***        WHERE                                               ***
   265***           RemitId = :ws-remit-id                           ***
   266***     END-EXEC                                               ***
   267***                                                            ***
   268***    Also, when the table has a column with a data type of   ***
   269***  "BIT" and used as true/false move the 1 byte receiving    ***
   270***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   271***  then its false. I think true would be 256.                ***
   272***                                                            ***
   273***                                                            ***
   274***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   275 01  ws-bit                      pic x.
   276 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   277 01  indicator-vaiables-for-nulls.
   278     05  nu-app-status           pic s9(4) comp value +0.
   279     05  nu-app-by               pic s9(4) comp value +0.
   280     05  nu-app-date             pic s9(4) comp value +0.
   281     05  nu-app-batch            pic s9(4) comp value +0.
   282     05  nu-fincar               pic s9(4) comp value +0.
   283     05  nu-batchno              pic s9(4) comp value +0.
   284     05  nu-error-message        pic s9(4) comp value +0.
   285 01  sql-cert-records.
   286     05  sql-dlr-state           pic xx.
   287     05  sql-dlr-id              pic x(10).
   288     05  sql-eff-dt              pic x(10).
   289     05  sql-contr-no            pic x(10).
   290     05  sql-contr-suffix        pic x.
   291 01  ws-limit-issue-age          pic 999.
   292 01  ws-att-age                  pic 999.
   293 01  form-limit-table.
   294     05  ws-limit-name           pic x(50).
   295     05  ws-limit-cov-type       pic xx.
   296     05  ws-limit-lo-age         pic 999.
   297     05  ws-limit-hi-age         pic 999.
   298     05  ws-limit-att-age        pic 999.
   299     05  ws-limit-max-term       pic 999.
   300     05  ws-limit-max-jnt-term   pic 999.
   301     05  ws-limit-max-mo-ben     pic 9(5).
   302     05  ws-limit-max-tot-ben    pic 9(7).
   303
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   7
* WSMESS01.cbl
   304 01  state-benefit-code-table.
   305     05  ws-sbc-state            pic xx.
   306     05  ws-sbc-cov-type         pic xx.
   307     05  ws-sbc-sin-jnt          pic x.
   308     05  ws-sbc-dismember        pic x.
   309     05  ws-sbc-retroelim        pic x.
   310     05  ws-sbc-wait-days        pic 999.
   311     05  ws-sbc-max-bens         pic 999.
   312     05  ws-sbc-logic-ben-code   pic xx.
   313 EXEC SQL
   314    END DECLARE SECTION
   315 END-EXEC
   316 01  filler.
   317     05  ws-work-in              pic x(10).
   318     05  ws-work-out             pic x(10).
   319     05  ws-work-out-v2 redefines
   320         ws-work-out             pic 9(8)v99.
   321     05  ws-work-out-v0 redefines
   322         ws-work-out             pic 9(10).
   323     05  ws-work-out-v5 redefines
   324         ws-work-out             pic 9(5)v9(5).
   325 01  filler.
   326     05  ws-last-suffix          pic x value low-values.
   327     05  ws-tbl-last-suffix      pic x value low-values.
   328     05  filler.  *> Use X1 for this table.
   329         10  ws-codes            pic x(26) value
   330         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   331         10  ws-suffix-value redefines ws-codes
   332           occurs 26             pic x.
   333 01  ws-work-date.
   334     05  ws-work-ccyy            pic x(4).
   335     05  ws-work-mm              pic xx.
   336     05  ws-work-dd              pic xx.
   337 01  ws-work-date-num redefines ws-work-date
   338                                 pic 9(8).
   339 01  raw-message001-area.
   340     05  raw-message-num         pic x(10).
   341     05  raw-state               pic xx.
   342     05  raw-acct-no             pic x(10).
   343     05  raw-vin                 pic x(17).
   344     05  raw-lf-ah               pic x.
   345     05  raw-ben-code            pic xx.
   346     05  raw-earn-meth           pic x.
   347     05  raw-pri-birth-date      pic x(10).
   348     05  raw-cob-birth-date      pic x(10).
   349     05  raw-benefit             pic x(9).
   350     05  raw-eff-date            pic x(10).
   351     05  raw-1st-pmt-dt          pic x(10).
   352     05  raw-premium             pic x(8).
   353     05  raw-loan-term           pic xxx.
   354     05  raw-ins-term            pic XXX.
   355     05  raw-apr                 pic x(8).
   356     05  raw-sin-jnt-ind         pic x.
   357     05  raw-dismemberment       pic x.
   358     05  raw-retro-elim          pic x.
   359     05  raw-waiting-days        pic xx.
   360     05  raw-crit-per            pic xx.
   361     05  raw-total-payments      pic x(9).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   8
* WSMESS01.cbl
   362     05  raw-period-payment      pic x(8).
   363 01  ws-rate-work-area.
   364     05  ws-rate-state           pic xx.
   365     05  ws-rate-acct-no         pic x(10).
   366     05  ws-rate-vin             pic x(17).
   367     05  ws-rate-lf-ah           pic x.
   368     05  ws-rate-ben-code        pic xx.
   369     05  ws-rate-earn-meth       pic x.
   370     05  ws-rate-pri-birth-date  pic x(10).
   371     05  ws-rate-cob-birth-date  pic x(10).
   372     05  ws-rate-eff-date        pic x(10).
   373     05  ws-rate-1st-pmt-dt      pic x(10).
   374     05  ws-rate-benefit-type    pic x.
   375     05  ws-rate-benefit-cd      pic xx.
   376     05  ws-rate-benefit         pic 9(6)v99.
   377     05  ws-rate-tot-pmts        pic 9(6)v99.
   378     05  ws-rate-premium         pic 9(5)v99.
   379     05  ws-rate-apr             pic 99v9(5).
   380     05  ws-rate-loan-term       pic 999  value zeros.
   381     05  ws-rate-ins-term        pic 999  value zeros.
   382     05  ws-issue-age            pic 999  value zeros.
   383     05  ws-cob-age              pic 999  value zeros.
   384     05  ws-rate-age             pic 999  value zeros.
   385     05  ws-max-benefit          pic 9(7)v99 value zeros.
   386     05  ws-rate-crit-per        pic 99.
   387     05  ws-rate-sin-jnt-ind     pic x.
   388     05  ws-rate-dismemberment   pic x.
   389     05  ws-rate-retro-elim      pic x.
   390     05  ws-rate-waiting-days    pic 99.
   391     05  ws-rate-payment         pic 9(5)v99.
   392     05  ws-calc-tot-pmts        pic 9(7)v99 value zeros.
   393 01  WS-AM-KEY.
   394     05  WS-AM-COMPANY-CD        PIC X.
   395     05  WS-AM-CARRIER           PIC X.
   396     05  WS-AM-GROUP             PIC X(6).
   397     05  WS-AM-STATE             PIC XX.
   398     05  WS-AM-ACCOUNT           PIC X(10).
   399     05  WS-AM-EXP-DT            PIC XX.
   400     05  FILLER                  PIC X(4).
   401 01  ws-cm5-compare-key          pic x(12).
   402 01  WS-CM5-KEY.
   403     05  WS-CM5-COMPANY-CD       PIC X.
   404     05  WS-CM5-CERT-NO          PIC X(11).
   405 01  ws-cm-compare-key           pic x(33).
   406 01  WS-CM-KEY.
   407     05  WS-CM-COMPANY-CD        PIC X.
   408     05  WS-CM-CARRIER           PIC X.
   409     05  WS-CM-GROUP             PIC X(6).
   410     05  WS-CM-STATE             PIC XX.
   411     05  WS-CM-ACCOUNT           PIC X(10).
   412     05  WS-CM-EFF-DT            PIC XX.
   413     05  WS-CM-CERT-NO.
   414         10  ws-cm-cert-ten      pic x(10).
   415         10  ws-cm-cert-suffix   pic x.
   416 01  WS-CS-KEY.
   417     05  WS-CS-COMPANY-CD        PIC X.
   418     05  WS-CS-CARRIER           PIC X.
   419     05  WS-CS-GROUP             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   9
* WSMESS01.cbl
   420     05  WS-CS-STATE             PIC XX.
   421     05  WS-CS-ACCOUNT           PIC X(10).
   422     05  WS-CS-EFF-DT            PIC XX.
   423     05  WS-CS-CERT-NO           PIC X(11).
   424     05  WS-CS-TRLR-TYPE         PIC X.
   425 01  WS-AM-ALT-KEY.
   426     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   427     05  WS-AM-ALT-EXP-DT        PIC XX.
   428 01  WS-CF-KEY-SAVE              PIC X(10).
   429 01  WS-CF-KEY.
   430     05  WS-CF-COMPANY-ID        PIC XXX.
   431     05  WS-CF-RECORD-TYPE       PIC X.
   432     05  WS-CF-ACCESS            PIC X(4).
   433     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   434 01  filler.
   435     05  ws-errors-table.
   436         10  filler              pic x(50) value
   437         '0000Transaction successfully completed'.
   438         10  filler              pic x(50) value
   439         '0101Problem with amounts'.
   440         10  filler              pic x(50) value
   441         '0102Problem with dates'.
   442         10  filler              pic x(50) value
   443         '0103Issue age outside limits'.
   444         10  filler              pic x(50) value
   445         '0104Attained age outside limits'.
   446         10  filler              pic x(50) value
   447         '0105Term is not valid must be gt 0 and lt 361'.
   448         10  filler              pic x(50) value
   449         '0106Term is outside limits'.
   450         10  filler              pic x(50) value
   451         '0107Amount is outside limits'.
   452         10  filler              pic x(50) value
   453         '0108Loan term must be ge insurance term'.
   454         10  filler              pic x(50) value
   455         '0109Total benefit is outside limits'.
   456         10  filler              pic x(50) value
   457         '0110Rates found were zero'.
   458         10  filler              pic x(50) value
   459         '0111Rate table was not found'.
   460         10  filler              pic x(50) value
   461         '0112Rate file not open'.
   462         10  filler              pic x(50) value
   463         '0113Premium is out of tolerence'.
   464         10  filler              pic x(50) value
   465         '0114Duplicate contract and VIN on Logic'.
   466         10  filler              pic x(50) value
   467         '0115Problem with loan or insurance term'.
   468         10  filler              pic x(50) value
   469         '0116Total of payments incorrect '.
   470         10  filler              pic x(50) value
   471         '0117No Limits or age outside limits'.
   472         10  filler              pic x(50) value
   473         '0118Life benefit code not found '.
   474         10  filler              pic x(50) value
   475         '0119Disab benefit code not found '.
   476     05  filler redefines ws-errors-table occurs 20.
   477         10  ws-table-error-no   pic x(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  10
* WSMESS01.cbl
   478         10  ws-table-error-mess pic x(46).
   479 01  ws-return-string.
   480     05  ws-return-error-no      pic x(4).
   481     05  ws-sc1                  pic x.
   482     05  ws-return-error-mess    pic x(46).
   483     05  ws-sc2                  pic x.
   484     05  ws-return-contract-no   pic x(11).
   485     05  ws-sc3                  pic x.
   486     05  ws-return-max-ben       pic z,zzz,z99.99.
   487     05  ws-sc4                  pic x.
   488     05  ws-return-prem          pic z,zzz,z99.99.
   489     05  ws-sc5                  pic x.
   490     05  ws-return-rate          pic z9.99999.
   491     05  ws-sc6                  pic x.
   492     05  ws-return-exp-dt        pic x(10).
   493     05  ws-sc7                  pic x.
   494     05  ws-return-benefit-cd    pic xx.
   495 01  ws-mess001-length           pic s9(4) comp value +1024.
   496 01  WS-MESS001-PASS-AREA        PIC X(1024).
   497 01  WS-CID-NO                   PIC X(8).
   498 01  WS-DISP-RESP                PIC 9(5).
   499 01  WS-RESPONSE                 PIC S9(8)   COMP.
   500     88  RESP-NORMAL                  VALUE +00.
   501     88  RESP-NOTFND                  VALUE +13.
   502     88  resp-duprec                  value +14.
   503     88  resp-dupkey                  value +15.
   504     88  RESP-NOTOPEN                 VALUE +19.
   505     88  RESP-ENDFILE                 VALUE +20.
   506*                                 COPY ERCACCT.
   507******************************************************************
   508*                                                                *
   509*                                                                *
   510*                            ERCACCT                             *
   511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   512*                            VMOD=2.031                          *
   513*                                                                *
   514*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   515*                                                                *
   516*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   517*   VSAM ACCOUNT MASTER FILES.                                   *
   518*                                                                *
   519*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   520*                                                                *
   521*   FILE TYPE = VSAM,KSDS                                        *
   522*   RECORD SIZE = 2000  RECFORM = FIX                            *
   523*                                                                *
   524*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   525*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   526*                                                                *
   527*   LOG = NO                                                     *
   528*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   529*                                                                *
   530*                                                                *
   531******************************************************************
   532*                   C H A N G E   L O G
   533*
   534* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   535*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  11
* WSMESS01.cbl
   536*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   537* EFFECTIVE    NUMBER
   538*-----------------------------------------------------------------
   539* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   540* 092705    2005050300006  PEMA  ADD SPP LEASES
   541* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   542* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   543* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   544* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   545* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   546* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   547******************************************************************
   548
   549 01  ACCOUNT-MASTER.
   550     12  AM-RECORD-ID                      PIC XX.
   551         88  VALID-AM-ID                      VALUE 'AM'.
   552
   553     12  AM-CONTROL-PRIMARY.
   554         16  AM-COMPANY-CD                 PIC X.
   555         16  AM-MSTR-CNTRL.
   556             20  AM-CONTROL-A.
   557                 24  AM-CARRIER            PIC X.
   558                 24  AM-GROUPING.
   559                     28 AM-GROUPING-PREFIX PIC XXX.
   560                     28 AM-GROUPING-PRIME  PIC XXX.
   561                 24  AM-STATE              PIC XX.
   562                 24  AM-ACCOUNT.
   563                     28  AM-ACCOUNT-PREFIX PIC X(4).
   564                     28  AM-ACCOUNT-PRIME  PIC X(6).
   565             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   566                                           PIC X(19).
   567             20  AM-CNTRL-B.
   568                 24  AM-EXPIRATION-DT      PIC XX.
   569                 24  FILLER                PIC X(4).
   570             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   571                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   572
   573     12  AM-CONTROL-BY-VAR-GRP.
   574         16  AM-COMPANY-CD-A1              PIC X.
   575         16  AM-VG-CARRIER                 PIC X.
   576         16  AM-VG-GROUPING                PIC X(6).
   577         16  AM-VG-STATE                   PIC XX.
   578         16  AM-VG-ACCOUNT                 PIC X(10).
   579         16  AM-VG-DATE.
   580             20  AM-VG-EXPIRATION-DT       PIC XX.
   581             20  FILLER                    PIC X(4).
   582         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   583                                           PIC 9(11)      COMP-3.
   584     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   585         16  FILLER                        PIC X(10).
   586         16  AM-VG-KEY3.
   587             20  AM-VG3-ACCOUNT            PIC X(10).
   588             20  AM-VG3-EXP-DT             PIC XX.
   589         16  FILLER                        PIC X(4).
   590     12  AM-MAINT-INFORMATION.
   591         16  AM-LAST-MAINT-DT              PIC XX.
   592         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   593         16  AM-LAST-MAINT-USER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  12
* WSMESS01.cbl
   594         16  FILLER                        PIC XX.
   595
   596     12  AM-EFFECTIVE-DT                   PIC XX.
   597     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   598
   599     12  AM-PREV-DATES  COMP-3.
   600         16  AM-PREV-EXP-DT                PIC 9(11).
   601         16  AM-PREV-EFF-DT                PIC 9(11).
   602
   603     12  AM-REPORT-CODE-1                  PIC X(10).
   604     12  AM-REPORT-CODE-2                  PIC X(10).
   605
   606     12  AM-CITY-CODE                      PIC X(4).
   607     12  AM-COUNTY-PARISH                  PIC X(6).
   608
   609     12  AM-NAME                           PIC X(30).
   610     12  AM-PERSON                         PIC X(30).
   611     12  AM-ADDRS                          PIC X(30).
   612     12  AM-CITY.
   613         16  AM-ADDR-CITY                  PIC X(28).
   614         16  AM-ADDR-STATE                 PIC XX.
   615     12  AM-ZIP.
   616         16  AM-ZIP-PRIME.
   617             20  AM-ZIP-PRI-1ST            PIC X.
   618                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   619             20  FILLER                    PIC X(4).
   620         16  AM-ZIP-PLUS4                  PIC X(4).
   621     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   622         16  AM-CAN-POSTAL-1               PIC XXX.
   623         16  AM-CAN-POSTAL-2               PIC XXX.
   624         16  FILLER                        PIC XXX.
   625     12  AM-TEL-NO.
   626         16  AM-AREA-CODE                  PIC 999.
   627         16  AM-TEL-PRE                    PIC 999.
   628         16  AM-TEL-NBR                    PIC 9(4).
   629     12  AM-TEL-LOC                        PIC X.
   630         88  AM-TEL-AT-HOME                   VALUE 'H'.
   631         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   632
   633     12  AM-COMM-STRUCTURE.
   634         16  AM-DEFN-1.
   635             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   636                 24  AM-AGT.
   637                     28  AM-AGT-PREFIX     PIC X(4).
   638                     28  AM-AGT-PRIME      PIC X(6).
   639                 24  AM-COM-TYP            PIC X.
   640                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   641                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   642                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   643                 24  AM-RECALC-LV-INDIC    PIC X.
   644                 24  AM-RETRO-LV-INDIC     PIC X.
   645                 24  AM-GL-CODES           PIC X.
   646                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   647                 24  FILLER                PIC X(01).
   648         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   649             20  AM-COM-TBLS        OCCURS 10 TIMES.
   650                 24  FILLER                PIC X(11).
   651                 24  AM-L-COMA             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  13
* WSMESS01.cbl
   652                 24  AM-J-COMA             PIC XXX.
   653                 24  AM-A-COMA             PIC XXX.
   654                 24  FILLER                PIC X(6).
   655
   656     12  AM-COMM-CHANGE-STATUS             PIC X.
   657         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   658
   659     12  AM-CSR-CODE                       PIC X(4).
   660
   661     12  AM-BILLING-STATUS                 PIC X.
   662         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   663         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   664     12  AM-AUTO-REFUND-SW                 PIC X.
   665         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   666         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   667     12  AM-GPCD                           PIC 99.
   668     12  AM-IG                             PIC X.
   669         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   670         88  AM-HAS-GROUP                     VALUE '2'.
   671     12  AM-STATUS                         PIC X.
   672         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   673         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   674         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   675         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   676         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   677         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   678         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   679         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   680         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   681         88  AM-ACCOUNT-PENDING               VALUE '9'.
   682     12  AM-REMIT-TO                       PIC 99.
   683     12  AM-ID-NO                          PIC X(11).
   684
   685     12  AM-CAL-TABLE                      PIC XX.
   686     12  AM-LF-DEVIATION                   PIC XXX.
   687     12  AM-AH-DEVIATION                   PIC XXX.
   688     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   689     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   690     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   691     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   692     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   693     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   694
   695     12  AM-USER-FIELDS.
   696         16  AM-FLD-1                      PIC XX.
   697         16  AM-FLD-2                      PIC XX.
   698         16  AM-FLD-3                      PIC XX.
   699         16  AM-FLD-4                      PIC XX.
   700         16  AM-FLD-5                      PIC XX.
   701
   702     12  AM-1ST-PROD-DATE.
   703         16  AM-1ST-PROD-YR                PIC XX.
   704         16  AM-1ST-PROD-MO                PIC XX.
   705         16  AM-1ST-PROD-DA                PIC XX.
   706     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   707     12  AM-CERTS-PURGED-DATE.
   708         16  AM-PUR-YR                     PIC XX.
   709         16  AM-PUR-MO                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  14
* WSMESS01.cbl
   710         16  AM-PUR-DA                     PIC XX.
   711     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   712     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   713     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   714     12  AM-INACTIVE-DATE.
   715         16  AM-INA-MO                     PIC 99.
   716         16  AM-INA-DA                     PIC 99.
   717         16  AM-INA-YR                     PIC 99.
   718     12  AM-AR-HI-CERT-DATE                PIC XX.
   719
   720     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   721     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   722
   723     12  AM-OB-PAYMENT-MODE                PIC X.
   724         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   725         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   726         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   727         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   728
   729     12  AM-AH-ONLY-INDICATOR              PIC X.
   730         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   731         88  AM-NO-AH-ONLY                    VALUE 'N'.
   732
   733     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   734
   735     12  AM-OVER-SHORT.
   736         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   737         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   738
   739     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   740     12  AM-DCC-CLP-STATE                  PIC XX.
   741
   742     12  AM-RECALC-COMM                    PIC X.
   743     12  AM-RECALC-REIN                    PIC X.
   744
   745     12  AM-REI-TABLE                      PIC XXX.
   746     12  AM-REI-ET-LF                      PIC X.
   747     12  AM-REI-ET-AH                      PIC X.
   748     12  AM-REI-PE-LF                      PIC X.
   749     12  AM-REI-PE-AH                      PIC X.
   750     12  AM-REI-PRT-ST                     PIC X.
   751     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   752     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   753     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   754     12  AM-REI-GROUP-A                    PIC X(6).
   755     12  AM-REI-MORT                       PIC X(4).
   756     12  AM-REI-PRT-OW                     PIC X.
   757     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   758     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   759     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   760     12  AM-REI-GROUP-B                    PIC X(6).
   761
   762     12  AM-TRUST-TYPE                     PIC X(2).
   763
   764     12  AM-EMPLOYER-STMT-USED             PIC X.
   765     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   766
   767     12  AM-STD-AH-TYPE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  15
* WSMESS01.cbl
   768     12  AM-EARN-METHODS.
   769         16  AM-EARN-METHOD-R              PIC X.
   770             88 AM-REF-RL-R78                 VALUE 'R'.
   771             88 AM-REF-RL-PR                  VALUE 'P'.
   772             88 AM-REF-RL-MEAN                VALUE 'M'.
   773             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   774         16  AM-EARN-METHOD-L              PIC X.
   775             88 AM-REF-LL-R78                 VALUE 'R'.
   776             88 AM-REF-LL-PR                  VALUE 'P'.
   777             88 AM-REF-LL-MEAN                VALUE 'M'.
   778             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   779         16  AM-EARN-METHOD-A              PIC X.
   780             88 AM-REF-AH-R78                 VALUE 'R'.
   781             88 AM-REF-AH-PR                  VALUE 'P'.
   782             88 AM-REF-AH-MEAN                VALUE 'M'.
   783             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   784             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   785             88 AM-REF-AH-NET                 VALUE 'N'.
   786
   787     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   788     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   789     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   790
   791     12  AM-RET-Y-N                        PIC X.
   792     12  AM-RET-P-E                        PIC X.
   793     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   794     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   795     12  AM-RET-GRP                        PIC X(6).
   796     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   797         16  AM-POOL-PRIME                 PIC XXX.
   798         16  AM-POOL-SUB                   PIC XXX.
   799     12  AM-RETRO-EARNINGS.
   800         16  AM-RET-EARN-R                 PIC X.
   801         16  AM-RET-EARN-L                 PIC X.
   802         16  AM-RET-EARN-A                 PIC X.
   803     12  AM-RET-ST-TAX-USE                 PIC X.
   804         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   805         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   806     12  AM-RETRO-BEG-EARNINGS.
   807         16  AM-RET-BEG-EARN-R             PIC X.
   808         16  AM-RET-BEG-EARN-L             PIC X.
   809         16  AM-RET-BEG-EARN-A             PIC X.
   810     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   811     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   812
   813     12  AM-USER-SELECT-OPTIONS.
   814         16  AM-USER-SELECT-1              PIC X(10).
   815         16  AM-USER-SELECT-2              PIC X(10).
   816         16  AM-USER-SELECT-3              PIC X(10).
   817         16  AM-USER-SELECT-4              PIC X(10).
   818         16  AM-USER-SELECT-5              PIC X(10).
   819
   820     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   821
   822     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   823
   824     12  AM-RPT045A-SWITCH                 PIC X.
   825         88  RPT045A-OFF                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  16
* WSMESS01.cbl
   826
   827     12  AM-INSURANCE-LIMITS.
   828         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   829         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   830
   831     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   832         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   833
   834     12  AM-DISMBR-COVERAGE-SW             PIC X.
   835         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   836         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   837
   838     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   839
   840     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   841     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   842     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   843     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   844     12  AM-DCC-UEF-STATE                  PIC XX.
   845     12  FILLER                            PIC XXX.
   846     12  AM-REPORT-CODE-3                  PIC X(10).
   847*    12  FILLER                            PIC X(22).
   848
   849     12  AM-RESERVE-DATE.
   850         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   851         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   852         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   853
   854     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   855     12  AM-NOTIFICATION-TYPES.
   856         16  AM-NOTIF-OF-LETTERS           PIC X.
   857         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   858         16  AM-NOTIF-OF-REPORTS           PIC X.
   859         16  AM-NOTIF-OF-STATUS            PIC X.
   860
   861     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   862         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   863         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   864         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   865         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   866
   867     12  AM-BENEFIT-CONTROLS.
   868         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   869             20  AM-BENEFIT-CODE           PIC XX.
   870             20  AM-BENEFIT-TYPE           PIC X.
   871             20  AM-BENEFIT-REVISION       PIC XXX.
   872             20  AM-BENEFIT-REM-TERM       PIC X.
   873             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   874             20  FILLER                    PIC XX.
   875         16  FILLER                        PIC X(80).
   876
   877     12  AM-TRANSFER-DATA.
   878         16  AM-TRANSFERRED-FROM.
   879             20  AM-TRNFROM-CARRIER        PIC X.
   880             20  AM-TRNFROM-GROUPING.
   881                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   882                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   883             20  AM-TRNFROM-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  17
* WSMESS01.cbl
   884             20  AM-TRNFROM-ACCOUNT.
   885                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   886                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   887             20  AM-TRNFROM-DTE            PIC XX.
   888         16  AM-TRANSFERRED-TO.
   889             20  AM-TRNTO-CARRIER          PIC X.
   890             20  AM-TRNTO-GROUPING.
   891                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   892                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   893             20  AM-TRNTO-STATE            PIC XX.
   894             20  AM-TRNTO-ACCOUNT.
   895                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   896                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   897             20  AM-TRNTO-DTE              PIC XX.
   898         16  FILLER                        PIC X(10).
   899
   900     12  AM-SAVED-REMIT-TO                 PIC 99.
   901
   902     12  AM-COMM-STRUCTURE-SAVED.
   903         16  AM-DEFN-1-SAVED.
   904             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   905                 24  AM-AGT-SV             PIC X(10).
   906                 24  AM-COM-TYP-SV         PIC X.
   907                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   908                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   909                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   910                 24  AM-RECALC-LV-INDIC-SV PIC X.
   911                 24  FILLER                PIC X.
   912                 24  AM-GL-CODES-SV        PIC X.
   913                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   914                 24  FILLER                PIC X.
   915         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   916             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   917                 24  FILLER                PIC X(11).
   918                 24  AM-L-COMA-SV          PIC XXX.
   919                 24  AM-J-COMA-SV          PIC XXX.
   920                 24  AM-A-COMA-SV          PIC XXX.
   921                 24  FILLER                PIC X(6).
   922
   923     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   924         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   925            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   926            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   927            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   928
   929     12  AM-ORIG-DEALER-NO                 PIC X(10).
   930     12  FILLER                            PIC X(120).
   931
   932     12  AM-ACCOUNT-EXECUTIVE-DATA.
   933         16  AM-CONTROL-NAME               PIC X(30).
   934         16  AM-EXECUTIVE-ONE.
   935             20  AM-EXEC1-NAME             PIC X(15).
   936             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   937                                                          COMP-3.
   938             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   939                                                          COMP-3.
   940         16  AM-EXECUTIVE-TWO.
   941             20  AM-EXEC2-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  18
* WSMESS01.cbl
   942             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   943                                                          COMP-3.
   944             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   945                                                          COMP-3.
   946
   947     12  AM-RETRO-ADDITIONAL-DATA.
   948         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   949         16  AM-RETRO-PREM-P-E             PIC X.
   950         16  AM-RETRO-CLMS-P-I             PIC X.
   951         16  AM-RETRO-RET-BRACKET-LF.
   952             20  AM-RETRO-RET-METHOD-LF    PIC X.
   953                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   954                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   955             20  AM-RETRO-RET-BASIS-LF     PIC X.
   956                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   957                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   958             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   959                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   960                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   961         16  AM-RETRO-RET-BRACKET-AH.
   962             20  AM-RETRO-RET-METHOD-AH    PIC X.
   963                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   964                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   965                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   966             20  AM-RETRO-RET-BASIS-AH     PIC X.
   967                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   968                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   969             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   970                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   971                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   972
   973     12  AM-COMMENTS.
   974         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   975
   976     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   977         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   978         16  AM-FLI-BILLING-CODE           PIC X.
   979         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   980         16  AM-FLI-UNITED-IDENT           PIC X.
   981         16  AM-FLI-INTEREST-LOST-DATA.
   982             20  AM-FLI-BANK-NO            PIC X(5).
   983             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   984             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   985             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   986         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   987             20  AM-FLI-AGT                PIC X(9).
   988             20  AM-FLI-AGT-COMM-ACC       PIC X.
   989             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   990         16  FILLER                        PIC X(102).
   991
   992     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   993         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   994             20  AM-BENEFIT-DMD-CODE         PIC XX.
   995             20  AM-BENEFIT-DMD-TYPE         PIC X.
   996             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   997             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   998             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   999         16  FILLER                          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  19
* WSMESS01.cbl
  1000******************************************************************
  1001*                                 COPY ELCCERT.
  1002******************************************************************
  1003*                                                                *
  1004*                            ELCCERT.                            *
  1005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1006*                            VMOD=2.013                          *
  1007*                                                                *
  1008*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1009*                                                                *
  1010*   FILE TYPE = VSAM,KSDS                                        *
  1011*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1012*                                                                *
  1013*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1014*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1015*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1016*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1017*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1018*                                                                *
  1019*   LOG = YES                                                    *
  1020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1021******************************************************************
  1022*                   C H A N G E   L O G
  1023*
  1024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1025*-----------------------------------------------------------------
  1026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1027* EFFECTIVE    NUMBER
  1028*-----------------------------------------------------------------
  1029* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1030* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1031* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1032* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1033* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1034* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1035* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1036* 032612  CR2011110200001  PEMA  AHL CHANGES
  1037* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1038* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1039* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1040******************************************************************
  1041
  1042 01  CERTIFICATE-MASTER.
  1043     12  CM-RECORD-ID                      PIC XX.
  1044         88  VALID-CM-ID                      VALUE 'CM'.
  1045
  1046     12  CM-CONTROL-PRIMARY.
  1047         16  CM-COMPANY-CD                 PIC X.
  1048         16  CM-CARRIER                    PIC X.
  1049         16  CM-GROUPING.
  1050             20  CM-GROUPING-PREFIX        PIC X(3).
  1051             20  CM-GROUPING-PRIME         PIC X(3).
  1052         16  CM-STATE                      PIC XX.
  1053         16  CM-ACCOUNT.
  1054             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1055             20  CM-ACCOUNT-PRIME          PIC X(6).
  1056         16  CM-CERT-EFF-DT                PIC XX.
  1057         16  CM-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  20
* WSMESS01.cbl
  1058             20  CM-CERT-PRIME             PIC X(10).
  1059             20  CM-CERT-SFX               PIC X.
  1060
  1061     12  CM-CONTROL-BY-NAME.
  1062         16  CM-COMPANY-CD-A1              PIC X.
  1063         16  CM-INSURED-LAST-NAME          PIC X(15).
  1064         16  CM-INSURED-INITIALS.
  1065             20  CM-INSURED-INITIAL1       PIC X.
  1066             20  CM-INSURED-INITIAL2       PIC X.
  1067
  1068     12  CM-CONTROL-BY-SSN.
  1069         16  CM-COMPANY-CD-A2              PIC X.
  1070         16  CM-SOC-SEC-NO.
  1071             20  CM-SSN-STATE              PIC XX.
  1072             20  CM-SSN-ACCOUNT            PIC X(6).
  1073             20  CM-SSN-LN3.
  1074                 25  CM-INSURED-INITIALS-A2.
  1075                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1076                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1077                 25 CM-PART-LAST-NAME-A2         PIC X.
  1078
  1079     12  CM-CONTROL-BY-CERT-NO.
  1080         16  CM-COMPANY-CD-A4              PIC X.
  1081         16  CM-CERT-NO-A4                 PIC X(11).
  1082
  1083     12  CM-CONTROL-BY-MEMB.
  1084         16  CM-COMPANY-CD-A5              PIC X.
  1085         16  CM-MEMBER-NO.
  1086             20  CM-MEMB-STATE             PIC XX.
  1087             20  CM-MEMB-ACCOUNT           PIC X(6).
  1088             20  CM-MEMB-LN4.
  1089                 25  CM-INSURED-INITIALS-A5.
  1090                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1091                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1092                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1093
  1094     12  CM-INSURED-PROFILE-DATA.
  1095         16  CM-INSURED-FIRST-NAME.
  1096             20  CM-INSURED-1ST-INIT       PIC X.
  1097             20  FILLER                    PIC X(9).
  1098         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1099         16  CM-INSURED-SEX                PIC X.
  1100             88  CM-SEX-MALE                  VALUE 'M'.
  1101             88  CM-SEX-FEMAL                 VALUE 'F'.
  1102         16  CM-INSURED-JOINT-AGE          PIC 99.
  1103         16  CM-JOINT-INSURED-NAME.
  1104             20  CM-JT-LAST-NAME           PIC X(15).
  1105             20  CM-JT-FIRST-NAME.
  1106                 24  CM-JT-1ST-INIT        PIC X.
  1107                 24  FILLER                PIC X(9).
  1108             20  CM-JT-INITIAL             PIC X.
  1109
  1110     12  CM-LIFE-DATA.
  1111         16  CM-LF-BENEFIT-CD              PIC XX.
  1112         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1113         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1114         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1115         16  CM-LF-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  21
* WSMESS01.cbl
  1116         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1117         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1118         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1119         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1120         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1121         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1122         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1123         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1124         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1125         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1126         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1127         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1128         16  cm-temp-epiq                  pic xx.
  1129             88  EPIQ-CLASS                  value 'EQ'.
  1130*        16  FILLER                        PIC XX.
  1131
  1132     12  CM-AH-DATA.
  1133         16  CM-AH-BENEFIT-CD              PIC XX.
  1134         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1135         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1136         16  CM-AH-DEV-CODE                PIC XXX.
  1137         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1138         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1139         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1140         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1141         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1142         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1143         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1144         16  CM-AH-PAID-THRU-DT            PIC XX.
  1145             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1146         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1147         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1148         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1149         16  FILLER                        PIC X.
  1150
  1151     12  CM-LOAN-INFORMATION.
  1152         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1153         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1154                                           PIC S9(5)V99  COMP-3.
  1155         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1156         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1157         16  CM-PAY-FREQUENCY              PIC S99.
  1158         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1159         16  CM-RATE-CLASS                 PIC XX.
  1160         16  CM-BENEFICIARY                PIC X(25).
  1161         16  CM-POLICY-FORM-NO             PIC X(12).
  1162         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1163         16  CM-LAST-ADD-ON-DT             PIC XX.
  1164         16  CM-DEDUCTIBLE-AMOUNTS.
  1165             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1166             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1167         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1168             20  CM-RESIDENT-STATE         PIC XX.
  1169             20  CM-RATE-CODE              PIC X(4).
  1170             20  FILLER                    PIC XX.
  1171         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1172             20  CM-LOAN-OFFICER           PIC X(5).
  1173             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  22
* WSMESS01.cbl
  1174         16  CM-CSR-CODE                   PIC XXX.
  1175         16  CM-UNDERWRITING-CODE          PIC X.
  1176             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1177         16  CM-POST-CARD-IND              PIC X.
  1178         16  CM-REF-INTERFACE-SW           PIC X.
  1179         16  CM-PREMIUM-TYPE               PIC X.
  1180             88  CM-SING-PRM                  VALUE '1'.
  1181             88  CM-O-B-COVERAGE              VALUE '2'.
  1182             88  CM-OPEN-END                  VALUE '3'.
  1183         16  CM-IND-GRP-TYPE               PIC X.
  1184             88  CM-INDIVIDUAL                VALUE 'I'.
  1185             88  CM-GROUP                     VALUE 'G'.
  1186         16  CM-SKIP-CODE                  PIC X.
  1187             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1188             88  SKIP-JULY                    VALUE '1'.
  1189             88  SKIP-AUGUST                  VALUE '2'.
  1190             88  SKIP-SEPTEMBER               VALUE '3'.
  1191             88  SKIP-JULY-AUG                VALUE '4'.
  1192             88  SKIP-AUG-SEPT                VALUE '5'.
  1193             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1194             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1195             88  SKIP-JUNE                    VALUE '8'.
  1196             88  SKIP-JUNE-JULY               VALUE '9'.
  1197             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1198             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1199         16  CM-PAYMENT-MODE               PIC X.
  1200             88  PAY-MONTHLY                  VALUE SPACE.
  1201             88  PAY-WEEKLY                   VALUE '1'.
  1202             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1203             88  PAY-BI-WEEKLY                VALUE '3'.
  1204             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1205         16  CM-LOAN-NUMBER                PIC X(8).
  1206         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1207         16  CM-OLD-LOF                    PIC XXX.
  1208*        16  CM-LOAN-OFFICER               PIC XXX.
  1209         16  CM-REIN-TABLE                 PIC XXX.
  1210         16  CM-SPECIAL-REIN-CODE          PIC X.
  1211         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1212         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1213         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1214
  1215     12  CM-STATUS-DATA.
  1216         16  CM-ENTRY-STATUS               PIC X.
  1217         16  CM-ENTRY-DT                   PIC XX.
  1218
  1219         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1220         16  CM-LF-CANCEL-DT               PIC XX.
  1221         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1222
  1223         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1224         16  CM-LF-DEATH-DT                PIC XX.
  1225         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1226
  1227         16  CM-LF-CURRENT-STATUS          PIC X.
  1228             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1229                                                'M' '4' '5' '9'.
  1230             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1231             88  CM-LF-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  23
* WSMESS01.cbl
  1232             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1233             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1234             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1235             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1236             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1237             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1238             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1239             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1240             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1241             88  CM-LF-DECLINED               VALUE 'D'.
  1242             88  CM-LF-VOIDED                 VALUE 'V'.
  1243
  1244         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1245         16  CM-AH-CANCEL-DT               PIC XX.
  1246         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1247
  1248         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1249         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1250         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1251
  1252         16  CM-AH-CURRENT-STATUS          PIC X.
  1253             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1254                                                'M' '4' '5' '9'.
  1255             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1256             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1257             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1258             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1259             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1260             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1261             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1262             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1263             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1264             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1265             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1266             88  CM-AH-DECLINED               VALUE 'D'.
  1267             88  CM-AH-VOIDED                 VALUE 'V'.
  1268
  1269         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1270             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1271             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1272             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1273         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1274
  1275         16  CM-ENTRY-BATCH                PIC X(6).
  1276         16  CM-LF-EXIT-BATCH              PIC X(6).
  1277         16  CM-AH-EXIT-BATCH              PIC X(6).
  1278         16  CM-LAST-MONTH-END             PIC XX.
  1279
  1280     12  CM-NOTE-SW                        PIC X.
  1281         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1282         88  CERT-NOTES-PRESENT               VALUE '1'.
  1283         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1284         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1285         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1286         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1287         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1288         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1289     12  CM-COMP-EXCP-SW                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  24
* WSMESS01.cbl
  1290         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1291         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1292     12  CM-INSURED-ADDRESS-SW             PIC X.
  1293         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1294         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1295
  1296*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1297     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1298     12  FILLER                            PIC X.
  1299
  1300*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1301     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1302     12  FILLER                            PIC X.
  1303*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1304     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1305
  1306     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1307         88  CERT-ADDED-BATCH                 VALUE ' '.
  1308         88  CERT-ADDED-ONLINE                VALUE '1'.
  1309         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1310         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1311         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1312     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1313         88  CERT-AS-LOADED                   VALUE ' '.
  1314         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1315         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1316         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1317         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1318         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1319         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1320         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1321
  1322     12  CM-ACCOUNT-COMM-PCTS.
  1323         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1324         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1325
  1326     12  CM-USER-FIELD                     PIC X.
  1327     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1328     12  CM-CLP-STATE                      PIC XX.
  1329     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1330     12  CM-USER-RESERVED                  PIC XXX.
  1331     12  FILLER REDEFINES CM-USER-RESERVED.
  1332         16  CM-AH-CLASS-CD                PIC XX.
  1333         16  F                             PIC X.
  1334******************************************************************
  1335*                                 COPY ELCCRTT.
  1336******************************************************************
  1337*                                                                *
  1338*                            ELCCRTT.                            *
  1339*                                                                *
  1340*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1341*                                                                *
  1342*   FILE TYPE = VSAM,KSDS                                        *
  1343*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1344*                                                                *
  1345*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1346*                                                                *
  1347*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  25
* WSMESS01.cbl
  1348*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1349******************************************************************
  1350*                   C H A N G E   L O G
  1351*
  1352* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1353*-----------------------------------------------------------------
  1354*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1355* EFFECTIVE    NUMBER
  1356*-----------------------------------------------------------------
  1357* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1358* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1359* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1360* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1361* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1362* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1363* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1364* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1365* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1366* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1367* 091318  CR2018073000001  PEMA  ADD Refund methods
  1368* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1369******************************************************************
  1370
  1371 01  CERTIFICATE-TRAILERS.
  1372     12  CS-RECORD-ID                      PIC XX.
  1373         88  VALID-CS-ID                      VALUE 'CS'.
  1374
  1375     12  CS-CONTROL-PRIMARY.
  1376         16  CS-COMPANY-CD                 PIC X.
  1377         16  CS-CARRIER                    PIC X.
  1378         16  CS-GROUPING                   PIC X(6).
  1379         16  CS-STATE                      PIC XX.
  1380         16  CS-ACCOUNT                    PIC X(10).
  1381         16  CS-CERT-EFF-DT                PIC XX.
  1382         16  CS-CERT-NO.
  1383             20  CS-CERT-PRIME             PIC X(10).
  1384             20  CS-CERT-SFX               PIC X.
  1385         16  CS-TRAILER-TYPE               PIC X.
  1386             88  COMM-TRLR           VALUE 'A'.
  1387             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1388             88  CERT-DATA-TRLR      VALUE 'C'.
  1389
  1390     12  CS-DATA-AREA                      PIC X(516).
  1391
  1392     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1393         16  CS-BANK-COMMISSION-AREA.
  1394             20  CS-BANK-COMMS       OCCURS 10.
  1395                 24  CS-AGT                PIC X(10).
  1396                 24  CS-COM-TYP            PIC X.
  1397                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1398                 24  CS-RECALC-LV-INDIC    PIC X.
  1399                 24  FILLER                PIC X(10).
  1400         16  FILLER                        PIC X(256).
  1401
  1402     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1403****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1404         16  CS-MB-CLAIM-DATA OCCURS 24.
  1405             20  CS-CLAIM-NO               PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  26
* WSMESS01.cbl
  1406             20  CS-CLAIM-TYPE             PIC X.
  1407                 88  CS-AH-CLM               VALUE 'A'.
  1408                 88  CS-IU-CLM               VALUE 'I'.
  1409                 88  CS-GP-CLM               VALUE 'G'.
  1410                 88  CS-LF-CLM               VALUE 'L'.
  1411                 88  CS-PR-CLM               VALUE 'P'.
  1412                 88  CS-FL-CLM               VALUE 'F'.
  1413                 88  CS-OT-CLM               VALUE 'O'.
  1414             20  CS-INSURED-TYPE           PIC X.
  1415                 88  CS-PRIM-INSURED          VALUE 'P'.
  1416                 88  CS-CO-BORROWER           VALUE 'C'.
  1417             20  CS-BENEFIT-PERIOD         PIC 99.
  1418             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1419             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1420             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1421         16  FILLER                        PIC X(12).
  1422     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1423         16  CS-VIN-NUMBER                 PIC X(17).
  1424         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1425         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1426         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1427         16  cs-agent-name.
  1428             20  cs-agent-fname            pic x(20).
  1429             20  cs-agent-mi               pic x.
  1430             20  cs-agent-lname            pic x(25).
  1431         16  cs-license-no                 pic x(15).
  1432         16  cs-npn-number                 pic x(10).
  1433         16  cs-agent-edit-status          pic x.
  1434             88  cs-ae-refer-to-manager      value 'M'.
  1435             88  cs-ae-cover-sheet           value 'C'.
  1436             88  cs-ae-sig-form              value 'S'.
  1437             88  cs-ae-verified              value 'V'.
  1438             88  cs-unidentified-signature   value 'U'.
  1439             88  cs-cert-returned            value 'R'.
  1440             88  cs-accept-no-commission     value 'N'.
  1441         16  cs-year                       pic 9999.
  1442         16  cs-make                       pic x(20).
  1443         16  cs-model                      pic x(20).
  1444         16  cs-future                     pic x(20).
  1445         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1446         16  cs-claim-verification-status  pic x.
  1447             88  cs-clm-ver-eligible         value 'A'.
  1448             88  cs-clm-ver-partial-elig     value 'B'.
  1449             88  cs-clm-ver-not-eligible     value 'C'.
  1450             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1451             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1452             88  cs-clm-ver-ND-CERT          value 'F'.
  1453             88  cs-clm-ver-spec-other       value 'G'.
  1454             88  cs-clam-ver-pratial-corrected
  1455                                             value 'H'.
  1456             88  cs-clm-ver-no-matches       value 'I'.
  1457             88  cs-clm-ver-not-elig-corrected
  1458                                             value 'J'.
  1459             88  cs-clm-ver-needs-review     value 'R'.
  1460             88  cs-clm-ver-sent-to-claims   value 'W'.
  1461         16  CS-LF-REFUND-METHOD           PIC X.
  1462         16  CS-AH-REFUND-METHOD           PIC X.
  1463         16  FILLER                        PIC X(353). *> was 420
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  27
* WSMESS01.cbl
  1464*        16  FILLER                        PIC X(496).
  1465*                                 COPY ELCCNTL.
  1466******************************************************************
  1467*                                                                *
  1468*                                                                *
  1469*                            ELCCNTL.                            *
  1470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1471*                            VMOD=2.059                          *
  1472*                                                                *
  1473*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1474*                                                                *
  1475*   FILE TYPE = VSAM,KSDS                                        *
  1476*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1477*                                                                *
  1478*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1479*       ALTERNATE INDEX = NONE                                   *
  1480*                                                                *
  1481*   LOG = YES                                                    *
  1482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1483******************************************************************
  1484*                   C H A N G E   L O G
  1485*
  1486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1487*-----------------------------------------------------------------
  1488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1489* EFFECTIVE    NUMBER
  1490*-----------------------------------------------------------------
  1491* 082503                   PEMA  ADD BENEFIT GROUP
  1492* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1493* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1494* 092705    2005050300006  PEMA  ADD SPP LEASES
  1495* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1496* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1497* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1498* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1499* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1500* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1501* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1502* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1503* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1504* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1505* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1506******************************************************************
  1507*
  1508 01  CONTROL-FILE.
  1509     12  CF-RECORD-ID                       PIC XX.
  1510         88  VALID-CF-ID                        VALUE 'CF'.
  1511
  1512     12  CF-CONTROL-PRIMARY.
  1513         16  CF-COMPANY-ID                  PIC XXX.
  1514         16  CF-RECORD-TYPE                 PIC X.
  1515             88  CF-COMPANY-MASTER              VALUE '1'.
  1516             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1517             88  CF-STATE-MASTER                VALUE '3'.
  1518             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1519             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1520             88  CF-CARRIER-MASTER              VALUE '6'.
  1521             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  28
* WSMESS01.cbl
  1522             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1523             88  CF-TERMINAL-MASTER             VALUE '9'.
  1524             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1525             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1526             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1527             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1528             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1529             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1530             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1531             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1532             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1533         16  CF-ACCESS-CD-GENL              PIC X(4).
  1534         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1535             20  CF-PROCESSOR               PIC X(4).
  1536         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1537             20  CF-STATE-CODE              PIC XX.
  1538             20  FILLER                     PIC XX.
  1539         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1540             20  FILLER                     PIC XX.
  1541             20  CF-HI-BEN-IN-REC           PIC XX.
  1542         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1543             20  FILLER                     PIC XXX.
  1544             20  CF-CARRIER-CNTL            PIC X.
  1545         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1546             20  FILLER                     PIC XX.
  1547             20  CF-HI-TYPE-IN-REC          PIC 99.
  1548         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1549             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1550                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1551             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1552             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1553         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1554             20  FILLER                     PIC X.
  1555             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1556         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1557             20  FILLER                     PIC XX.
  1558             20  CF-MORTGAGE-PLAN           PIC XX.
  1559         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1560
  1561     12  CF-LAST-MAINT-DT                   PIC XX.
  1562     12  CF-LAST-MAINT-BY                   PIC X(4).
  1563     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1564
  1565     12  CF-RECORD-BODY                     PIC X(728).
  1566
  1567
  1568****************************************************************
  1569*             COMPANY MASTER RECORD                            *
  1570****************************************************************
  1571
  1572     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1573         16  CF-COMPANY-ADDRESS.
  1574             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1575             20  CF-CL-IN-CARE-OF           PIC X(30).
  1576             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1577             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1578             20  CF-CL-CITY-STATE           PIC X(30).
  1579             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  29
* WSMESS01.cbl
  1580             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1581         16  CF-COMPANY-CD                  PIC X.
  1582         16  CF-COMPANY-PASSWORD            PIC X(8).
  1583         16  CF-SECURITY-OPTION             PIC X.
  1584             88  ALL-SECURITY                   VALUE '1'.
  1585             88  COMPANY-VERIFY                 VALUE '2'.
  1586             88  PROCESSOR-VERIFY               VALUE '3'.
  1587             88  NO-SECURITY                    VALUE '4'.
  1588             88  ALL-BUT-TERM                   VALUE '5'.
  1589         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1590             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1591         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1592             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1593         16  CF-INFORCE-LOCATION            PIC X.
  1594             88  CERTS-ARE-ONLINE               VALUE '1'.
  1595             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1596             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1597         16  CF-LOWER-CASE-LETTERS          PIC X.
  1598         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1599             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1600             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1601             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1602             88  CF-ACCNT-CNTL                  VALUE '3'.
  1603             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1604
  1605         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1606         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1607
  1608         16  CF-LGX-CREDIT-USER             PIC X.
  1609             88  CO-IS-NOT-USER                 VALUE 'N'.
  1610             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1611
  1612         16 CF-CREDIT-CALC-CODES.
  1613             20  CF-CR-REM-TERM-CALC PIC X.
  1614               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1615               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1616               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1617               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1618               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1619               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1620               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1621             20  CF-CR-R78-METHOD           PIC X.
  1622               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1623               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1624
  1625         16  CF-CLAIM-CONTROL-COUNTS.
  1626             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1627                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1628
  1629             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1630                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1631
  1632             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1633                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1634
  1635             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1636                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1637
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  30
* WSMESS01.cbl
  1638         16  CF-CURRENT-MONTH-END           PIC XX.
  1639
  1640         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1641             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1642             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1643             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1644             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1645                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1646                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1647             20  CF-CO-PREM-REJECT-SW       PIC X.
  1648                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1649                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1650             20  CF-CO-REF-REJECT-SW        PIC X.
  1651                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1652                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1653
  1654         16  CF-CO-REPORTING-DT             PIC XX.
  1655         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1656         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1657           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1658           88  CF-CO-MONTH-END                  VALUE '1'.
  1659
  1660         16  CF-LGX-CLAIM-USER              PIC X.
  1661             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1662             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1663
  1664         16  CF-CREDIT-EDIT-CONTROLS.
  1665             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1666             20  CF-MIN-AGE                 PIC 99.
  1667             20  CF-DEFAULT-AGE             PIC 99.
  1668             20  CF-MIN-TERM                PIC S999      COMP-3.
  1669             20  CF-MAX-TERM                PIC S999      COMP-3.
  1670             20  CF-DEFAULT-SEX             PIC X.
  1671             20  CF-JOINT-AGE-INPUT         PIC X.
  1672                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1673             20  CF-BIRTH-DATE-INPUT        PIC X.
  1674                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1675             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1676                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1677                 88  CF-ZERO-CARRIER            VALUE '1'.
  1678                 88  CF-ZERO-GROUPING           VALUE '2'.
  1679                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1680             20  CF-EDIT-SW                 PIC X.
  1681                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1682             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1683             20  CF-CR-PR-METHOD            PIC X.
  1684               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1685               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1686             20  FILLER                     PIC X.
  1687
  1688         16  CF-CREDIT-MISC-CONTROLS.
  1689             20  CF-REIN-TABLE-SW           PIC X.
  1690                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1691             20  CF-COMP-TABLE-SW           PIC X.
  1692                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1693             20  CF-EXPERIENCE-RETENTION-AGE
  1694                                            PIC S9        COMP-3.
  1695             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  31
* WSMESS01.cbl
  1696             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1697             20  CF-RUN-FREQUENCY-SW        PIC X.
  1698                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1699                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1700
  1701             20  CF-CR-CHECK-NO-CONTROL.
  1702                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1703                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1704                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1705                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1706                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1707                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1708
  1709                 24  CF-CR-CHECK-COUNT       REDEFINES
  1710                     CF-CR-CHECK-COUNTER      PIC X(4).
  1711
  1712                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1713                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1714
  1715                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1716                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1717                 24  CF-MAIL-PROCESSING       PIC X.
  1718                     88  MAIL-PROCESSING          VALUE 'Y'.
  1719
  1720         16  CF-MISC-SYSTEM-CONTROL.
  1721             20  CF-SYSTEM-C                 PIC X.
  1722                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1723             20  CF-SYSTEM-D                 PIC X.
  1724                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1725             20  CF-SOC-SEC-NO-SW            PIC X.
  1726                 88  SOC-SEC-NO-USED             VALUE '1'.
  1727             20  CF-MEMBER-NO-SW             PIC X.
  1728                 88  MEMBER-NO-USED              VALUE '1'.
  1729             20  CF-TAX-ID-NUMBER            PIC X(11).
  1730             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1731             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1732                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1733                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1734                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1735                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1736             20  CF-SYSTEM-E                 PIC X.
  1737                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1738
  1739         16  CF-LGX-LIFE-USER               PIC X.
  1740             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1741             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1742
  1743         16  CF-CR-MONTH-END-DT             PIC XX.
  1744
  1745         16  CF-FILE-MAINT-DATES.
  1746             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1747                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1748             20  CF-LAST-BATCH       REDEFINES
  1749                 CF-LAST-BATCH-NO               PIC X(4).
  1750             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1751             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1752             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1753             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  32
* WSMESS01.cbl
  1754             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1755             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1756             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1757             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1758             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1759             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1760
  1761         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1762         16  FILLER                         PIC X.
  1763
  1764         16  CF-ALT-MORT-CODE               PIC X(4).
  1765         16  CF-MEMBER-CAPTION              PIC X(10).
  1766
  1767         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1768             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1769             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1770             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1771             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1772             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1773
  1774         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1775
  1776         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1777         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1778         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1779         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1780
  1781         16  CF-AH-OVERRIDE-L1              PIC X.
  1782         16  CF-AH-OVERRIDE-L2              PIC XX.
  1783         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1784         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1785
  1786         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1787         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1788
  1789         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1790         16  CF-AR-LAST-EL860-DT            PIC XX.
  1791         16  CF-MP-MONTH-END-DT             PIC XX.
  1792
  1793         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1794         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1795             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1796
  1797         16  CF-AR-MONTH-END-DT             PIC XX.
  1798
  1799         16  CF-CRDTCRD-USER                PIC X.
  1800             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1801             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1802
  1803         16  CF-CC-MONTH-END-DT             PIC XX.
  1804
  1805         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1806
  1807         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1808             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1809             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1810             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1811         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  33
* WSMESS01.cbl
  1812         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1813         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1814         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1815             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1816             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1817         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1818         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1819         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1820             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1821         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1822
  1823         16  CF-CL-ZIP-CODE.
  1824             20  CF-CL-ZIP-PRIME.
  1825                 24  CF-CL-ZIP-1ST          PIC X.
  1826                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1827                 24  FILLER                 PIC X(4).
  1828             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1829         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1830             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1831             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1832             20  FILLER                     PIC XXX.
  1833
  1834         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1835         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1836         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1837         16  CF-CO-OPTION-START-DATE        PIC XX.
  1838         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1839           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1840                                                      '3' '4'.
  1841           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1842           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1843           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1844           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1845           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1846           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1847
  1848         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1849
  1850         16  CF-PAYMENT-APPROVAL-LEVELS.
  1851             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1852             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1853             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1854             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1855             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1856             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1857
  1858         16  CF-END-USER-REPORTING-USER     PIC X.
  1859             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1860             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1861
  1862         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1863             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1864             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1865
  1866         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1867
  1868         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1869         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  34
* WSMESS01.cbl
  1870
  1871         16  CF-CREDIT-ARCHIVE-CNTL.
  1872             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1873             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1874             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1875
  1876         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1877
  1878         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1879             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1880             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1881
  1882         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1883             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1884             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1885
  1886         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1887
  1888         16  CF-CO-ACH-ID-CODE              PIC  X.
  1889             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1890             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1891             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1892         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1893         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1894         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1895         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1896         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1897         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1898         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1899         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1900         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1901                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1902         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1903                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1904
  1905         16  CF-CO-OVER-SHORT.
  1906             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1907             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1908
  1909*         16  FILLER                         PIC X(102).
  1910         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1911             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1912             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1913
  1914         16  CF-AH-APPROVAL-DAYS.
  1915             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1916             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1917             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1918             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1919
  1920         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1921
  1922         16  CF-APPROV-LEV-5.
  1923             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1924             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1925             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1926
  1927         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  35
* WSMESS01.cbl
  1928****************************************************************
  1929*             PROCESSOR/USER RECORD                            *
  1930****************************************************************
  1931
  1932     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1933         16  CF-PROCESSOR-NAME              PIC X(30).
  1934         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1935         16  CF-PROCESSOR-TITLE             PIC X(26).
  1936         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1937                 88  MESSAGE-YES                VALUE 'Y'.
  1938                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1939
  1940*****************************************************
  1941****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1942****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1943****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1944****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1945*****************************************************
  1946
  1947         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1948             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1949             20  CF-APPLICATION-FORCE       PIC X.
  1950             20  CF-INDIVIDUAL-APP.
  1951                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1952                     28  CF-BROWSE-APP      PIC X.
  1953                     28  CF-UPDATE-APP      PIC X.
  1954
  1955         16  CF-CURRENT-TERM-ON             PIC X(4).
  1956         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1957             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1958             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1959             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1960             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1961             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1962             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1963             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1964         16  CF-PROCESSOR-CARRIER           PIC X.
  1965             88  NO-CARRIER-SECURITY            VALUE ' '.
  1966         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1967             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1968         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1969             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1970         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1971             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1972
  1973         16  CF-PROC-SYS-ACCESS-SW.
  1974             20  CF-PROC-CREDIT-CLAIMS-SW.
  1975                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1976                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1977                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1978                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1979             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1980                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1981                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1982             20  CF-PROC-LIFE-GNRLDGR-SW.
  1983                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1984                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1985                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  36
* WSMESS01.cbl
  1986                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1987             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1988                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1989                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1990         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1991             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1992             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1993         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1994
  1995         16  CF-APPROVAL-LEVEL                  PIC X.
  1996             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1997             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1998             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1999             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2000             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2001
  2002         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2003
  2004         16  CF-LANGUAGE-TYPE                   PIC X.
  2005             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2006             88  CF-LANG-IS-FR                      VALUE 'F'.
  2007
  2008         16  CF-CSR-IND                         PIC X.
  2009         16  FILLER                             PIC X(239).
  2010
  2011****************************************************************
  2012*             PROCESSOR/REMINDERS RECORD                       *
  2013****************************************************************
  2014
  2015     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2016         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2017             20  CF-START-REMIND-DT         PIC XX.
  2018             20  CF-END-REMIND-DT           PIC XX.
  2019             20  CF-REMINDER-TEXT           PIC X(50).
  2020         16  FILLER                         PIC X(296).
  2021
  2022
  2023****************************************************************
  2024*             STATE MASTER RECORD                              *
  2025****************************************************************
  2026
  2027     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2028         16  CF-STATE-ABBREVIATION          PIC XX.
  2029         16  CF-STATE-NAME                  PIC X(25).
  2030         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2031         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2032             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2033             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2034             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2035             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2036                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2037                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2038             20  CF-ST-PREM-REJECT-SW       PIC X.
  2039                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2040                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2041             20  CF-ST-REF-REJECT-SW        PIC X.
  2042                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2043                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  37
* WSMESS01.cbl
  2044         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2045         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2046         16  CF-ST-REFUND-RULES.
  2047             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2048             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2049             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2050         16  CF-ST-FST-PMT-EXTENSION.
  2051             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2052             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2053                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2054                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2055                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2056                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2057         16  CF-ST-STATE-CALL.
  2058             20  CF-ST-CALL-UNEARNED        PIC X.
  2059             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2060             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2061         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2062             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2063             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2064         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2065         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2066         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2067         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2068         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2069         16  FILLER                         PIC X.
  2070         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2071             20  CF-ST-BENEFIT-CD           PIC XX.
  2072             20  CF-ST-BENEFIT-KIND         PIC X.
  2073                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2074                 88  CF-ST-AH-KIND              VALUE 'A'.
  2075             20  CF-ST-REM-TERM-CALC        PIC X.
  2076                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2077                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2078                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2079                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2080                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2081                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2082                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2083                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2084
  2085             20  CF-ST-REFUND-CALC          PIC X.
  2086                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2087                 88  ST-REFD-BY-R78             VALUE '1'.
  2088                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2089                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2090                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2091                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2092                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2093                 88  ST-REFD-UTAH               VALUE '7'.
  2094                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2095                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2096                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2097
  2098             20  CF-ST-EARNING-CALC         PIC X.
  2099                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2100                 88  ST-EARN-BY-R78             VALUE '1'.
  2101                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  38
* WSMESS01.cbl
  2102                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2103                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2104                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2105                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2106                 88  ST-EARN-MEAN               VALUE '8'.
  2107                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2108
  2109             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2110                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2111                 88  ST-OVRD-BY-R78             VALUE '1'.
  2112                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2113                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2114                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2115                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2116                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2117                 88  ST-OVRD-MEAN               VALUE '8'.
  2118                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2119             20  cf-st-extra-periods        pic 9.
  2120*            20  FILLER                     PIC X.
  2121
  2122         16  CF-ST-COMMISSION-CAPS.
  2123             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2124             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2125             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2126             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2127         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2128                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2129                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2130                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2131
  2132         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2133
  2134         16  CF-ST-STATUTORY-INTEREST.
  2135             20  CF-ST-STAT-DATE-FROM       PIC X.
  2136                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2137                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2138             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2139             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2140             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2141             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2142             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2143
  2144         16  CF-ST-OVER-SHORT.
  2145             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2146             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2147
  2148         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2149
  2150         16  CF-ST-RT-CALC                  PIC X.
  2151
  2152         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2153         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2154         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2155         16  CF-ST-RF-LR-CALC               PIC X.
  2156         16  CF-ST-RF-LL-CALC               PIC X.
  2157         16  CF-ST-RF-LN-CALC               PIC X.
  2158         16  CF-ST-RF-AH-CALC               PIC X.
  2159         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  39
* WSMESS01.cbl
  2160*        16  FILLER                         PIC X(206).
  2161*CIDMOD         16  FILLER                         PIC X(192).
  2162         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2163             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2164         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2165         16  CF-ST-VFY-2ND-BENE             PIC X.
  2166         16  CF-ST-CAUSAL-STATE             PIC X.
  2167         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2168         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2169         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2170             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2171         16  CF-ST-NET-ONLY-STATE           PIC X.
  2172             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2173         16  cf-commission-cap-required     pic x.
  2174         16  CF-ST-GA-COMMISSION-CAPS.
  2175             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2176             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2177             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2178             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2179         16  CF-ST-TOT-COMMISSION-CAPS.
  2180             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2181             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2182             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2183             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2184         16  FILLER                         PIC X(156).
  2185
  2186****************************************************************
  2187*             BENEFIT MASTER RECORD                            *
  2188****************************************************************
  2189
  2190     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2191         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2192             20  CF-BENEFIT-CODE            PIC XX.
  2193             20  CF-BENEFIT-NUMERIC  REDEFINES
  2194                 CF-BENEFIT-CODE            PIC XX.
  2195             20  CF-BENEFIT-ALPHA           PIC XXX.
  2196             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2197             20  CF-BENEFIT-COMMENT         PIC X(10).
  2198
  2199             20  CF-LF-COVERAGE-TYPE        PIC X.
  2200                 88  CF-REDUCING                VALUE 'R'.
  2201                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2202
  2203             20  CF-SPECIAL-CALC-CD         PIC X.
  2204                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2205                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2206                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2207                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2208                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2209                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2210                 88  CF-FARM-PLAN               VALUE 'F'.
  2211                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2212                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2213                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2214                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2215                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2216                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2217                 88  CF-PRUDENTIAL              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  40
* WSMESS01.cbl
  2218                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2219                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2220                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2221                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2222                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2223                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2224
  2225             20  CF-JOINT-INDICATOR         PIC X.
  2226                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2227
  2228*            20  FILLER                     PIC X(12).
  2229             20  cf-maximum-benefits        pic s999 comp-3.
  2230             20  FILLER                     PIC X(09).
  2231             20  CF-BENEFIT-CATEGORY        PIC X.
  2232             20  CF-LOAN-TYPE               PIC X(8).
  2233
  2234             20  CF-CO-REM-TERM-CALC        PIC X.
  2235                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2236                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2237                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2238                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2239                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2240
  2241             20  CF-CO-EARNINGS-CALC        PIC X.
  2242                 88  CO-EARN-BY-R78             VALUE '1'.
  2243                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2244                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2245                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2246                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2247                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2248                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2249                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2250
  2251             20  CF-CO-REFUND-CALC          PIC X.
  2252                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2253                 88  CO-REFD-BY-R78             VALUE '1'.
  2254                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2255                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2256                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2257                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2258                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2259                 88  CO-REFD-MEAN               VALUE '8'.
  2260                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2261                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2262                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2263
  2264             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2265                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2266                 88  CO-OVRD-BY-R78             VALUE '1'.
  2267                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2268                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2269                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2270                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2271                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2272                 88  CO-OVRD-MEAN               VALUE '8'.
  2273                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2274
  2275             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  41
* WSMESS01.cbl
  2276                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2277                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2278                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2279
  2280         16  FILLER                         PIC X(304).
  2281
  2282
  2283****************************************************************
  2284*             CARRIER MASTER RECORD                            *
  2285****************************************************************
  2286
  2287     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2288         16  CF-ADDRESS-DATA.
  2289             20  CF-MAIL-TO-NAME            PIC X(30).
  2290             20  CF-IN-CARE-OF              PIC X(30).
  2291             20  CF-ADDRESS-LINE-1          PIC X(30).
  2292             20  CF-ADDRESS-LINE-2          PIC X(30).
  2293             20  CF-CITY-STATE              PIC X(30).
  2294             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2295             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2296
  2297         16  CF-CLAIM-NO-CONTROL.
  2298             20  CF-CLAIM-NO-METHOD         PIC X.
  2299                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2300                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2301                 88  CLAIM-NO-SEQ               VALUE '3'.
  2302                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2303             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2304                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2305                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2306                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2307
  2308         16  CF-CHECK-NO-CONTROL.
  2309             20  CF-CHECK-NO-METHOD         PIC X.
  2310                 88  CHECK-NO-MANUAL            VALUE '1'.
  2311                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2312                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2313                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2314             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2315                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2316
  2317         16  CF-DOMICILE-STATE              PIC XX.
  2318
  2319         16  CF-EXPENSE-CONTROLS.
  2320             20  CF-EXPENSE-METHOD          PIC X.
  2321                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2322                 88  DOLLARS-PER-PMT            VALUE '2'.
  2323                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2324                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2325             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2326             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2327
  2328         16  CF-CORRESPONDENCE-CONTROL.
  2329             20  CF-LETTER-RESEND-OPT       PIC X.
  2330                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2331                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2332             20  FILLER                     PIC X(4).
  2333
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  42
* WSMESS01.cbl
  2334         16  CF-RESERVE-CONTROLS.
  2335             20  CF-MANUAL-SW               PIC X.
  2336                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2337             20  CF-FUTURE-SW               PIC X.
  2338                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2339             20  CF-PTC-SW                  PIC X.
  2340                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2341             20  CF-IBNR-SW                 PIC X.
  2342                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2343             20  CF-PTC-LF-SW               PIC X.
  2344                 88  CF-LF-PTC-USED             VALUE '1'.
  2345             20  CF-CDT-ACCESS-METHOD       PIC X.
  2346                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2347                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2348                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2349             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2350
  2351         16  CF-CLAIM-CALC-METHOD           PIC X.
  2352             88  360-PLUS-MONTHS                VALUE '1'.
  2353             88  365-PLUS-MONTHS                VALUE '2'.
  2354             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2355             88  360-DAILY                      VALUE '4'.
  2356             88  365-DAILY                      VALUE '5'.
  2357
  2358         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2359         16  FILLER                         PIC X(11).
  2360
  2361         16  CF-LIMIT-AMOUNTS.
  2362             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2363             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2364             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2365             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2366             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2367             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2368             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2369             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2370             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2371             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2372
  2373         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2374         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2375         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2376
  2377         16  CF-ZIP-CODE.
  2378             20  CF-ZIP-PRIME.
  2379                 24  CF-ZIP-1ST             PIC X.
  2380                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2381                 24  FILLER                 PIC X(4).
  2382             20  CF-ZIP-PLUS4               PIC X(4).
  2383         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2384             20  CF-CAN-POSTAL-1            PIC XXX.
  2385             20  CF-CAN-POSTAL-2            PIC XXX.
  2386             20  FILLER                     PIC XXX.
  2387
  2388         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2389         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2390         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2391
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  43
* WSMESS01.cbl
  2392         16  CF-RATING-SWITCH               PIC X.
  2393             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2394             88  CF-NO-RATING                   VALUE 'N'.
  2395
  2396         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2397
  2398         16  CF-CARRIER-OVER-SHORT.
  2399             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2400             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2401
  2402         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2403         16  CF-SECPAY-SWITCH               PIC X.
  2404             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2405             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2406         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2407         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2408         16  FILLER                         PIC X(444).
  2409*        16  FILLER                         PIC X(452).
  2410
  2411
  2412****************************************************************
  2413*             MORTALITY MASTER RECORD                          *
  2414****************************************************************
  2415
  2416     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2417         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2418                                INDEXED BY CF-MORT-NDX.
  2419             20  CF-MORT-TABLE              PIC X(5).
  2420             20  CF-MORT-TABLE-TYPE         PIC X.
  2421                 88  CF-MORT-JOINT              VALUE 'J'.
  2422                 88  CF-MORT-SINGLE             VALUE 'S'.
  2423                 88  CF-MORT-COMBINED           VALUE 'C'.
  2424                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2425                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2426             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2427             20  CF-MORT-AGE-METHOD         PIC XX.
  2428                 88  CF-AGE-LAST                VALUE 'AL'.
  2429                 88  CF-AGE-NEAR                VALUE 'AN'.
  2430             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2431             20  CF-MORT-ADJUSTMENT-DIRECTION
  2432                                            PIC X.
  2433                 88  CF-MINUS                   VALUE '-'.
  2434                 88  CF-PLUS                    VALUE '+'.
  2435             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2436             20  CF-MORT-JOINT-CODE         PIC X.
  2437                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2438             20  CF-MORT-PC-Q               PIC X.
  2439                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2440             20  CF-MORT-TABLE-CODE         PIC X(4).
  2441             20  CF-MORT-COMMENTS           PIC X(15).
  2442             20  FILLER                     PIC X(14).
  2443
  2444         16  FILLER                         PIC X(251).
  2445
  2446
  2447****************************************************************
  2448*             BUSSINESS TYPE MASTER RECORD                     *
  2449****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  44
* WSMESS01.cbl
  2450
  2451     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2452* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2453* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2454* AND RECORD 05 IS TYPES 81-99
  2455         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2456             20  CF-BUSINESS-TITLE          PIC  X(19).
  2457             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2458                                            PIC S9V9(4) COMP-3.
  2459             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2460             20  FILLER                     PIC  X.
  2461         16  FILLER                         PIC  X(248).
  2462
  2463
  2464****************************************************************
  2465*             TERMINAL MASTER RECORD                           *
  2466****************************************************************
  2467
  2468     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2469
  2470         16  CF-COMPANY-TERMINALS.
  2471             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2472                                  PIC X(4).
  2473         16  FILLER               PIC X(248).
  2474
  2475
  2476****************************************************************
  2477*             LIFE EDIT MASTER RECORD                          *
  2478****************************************************************
  2479
  2480     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2481         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2482             20  CF-LIFE-CODE-IN            PIC XX.
  2483             20  CF-LIFE-CODE-OUT           PIC XX.
  2484         16  FILLER                         PIC X(248).
  2485
  2486
  2487****************************************************************
  2488*             AH EDIT MASTER RECORD                            *
  2489****************************************************************
  2490
  2491     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2492         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2493             20  CF-AH-CODE-IN              PIC XXX.
  2494             20  CF-AH-CODE-OUT             PIC XX.
  2495         16  FILLER                         PIC X(248).
  2496
  2497
  2498****************************************************************
  2499*             CREDIBILITY TABLES                               *
  2500****************************************************************
  2501
  2502     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2503         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2504                             INDEXED BY CF-CRDB-NDX.
  2505             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2506             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2507             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  45
* WSMESS01.cbl
  2508         16  FILLER                         PIC  X(332).
  2509
  2510
  2511****************************************************************
  2512*             REPORT CUSTOMIZATION RECORD                      *
  2513****************************************************************
  2514
  2515     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2516         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2517             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2518             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2519             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2520**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2521****       A T-TRANSFER.                                   ****
  2522             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2523
  2524         16  FILLER                         PIC XX.
  2525
  2526         16  CF-CARRIER-CNTL-OPT.
  2527             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2528                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2529                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2530             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2531                                            PIC X.
  2532         16  CF-GROUP-CNTL-OPT.
  2533             20  CF-GROUP-OPT-SEQ           PIC 9.
  2534                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2535                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2536             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2537                                            PIC X(6).
  2538         16  CF-STATE-CNTL-OPT.
  2539             20  CF-STATE-OPT-SEQ           PIC 9.
  2540                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2541                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2542             20  CF-STATE-SELECT OCCURS 3 TIMES
  2543                                            PIC XX.
  2544         16  CF-ACCOUNT-CNTL-OPT.
  2545             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2546                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2547                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2548             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2549                                            PIC X(10).
  2550         16  CF-BUS-TYP-CNTL-OPT.
  2551             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2552                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2553                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2554             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2555                                            PIC XX.
  2556         16  CF-LF-TYP-CNTL-OPT.
  2557             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2558                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2559                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2560             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2561                                            PIC XX.
  2562         16  CF-AH-TYP-CNTL-OPT.
  2563             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2564                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2565                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  46
* WSMESS01.cbl
  2566             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2567                                            PIC XX.
  2568         16  CF-REPTCD1-CNTL-OPT.
  2569             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2570                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2571                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2572             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2573                                            PIC X(10).
  2574         16  CF-REPTCD2-CNTL-OPT.
  2575             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2576                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2577                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2578             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2579                                            PIC X(10).
  2580         16  CF-USER1-CNTL-OPT.
  2581             20  CF-USER1-OPT-SEQ           PIC 9.
  2582                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2583                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2584             20  CF-USER1-SELECT OCCURS 3 TIMES
  2585                                            PIC X(10).
  2586         16  CF-USER2-CNTL-OPT.
  2587             20  CF-USER2-OPT-SEQ           PIC 9.
  2588                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2589                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2590             20  CF-USER2-SELECT OCCURS 3 TIMES
  2591                                            PIC X(10).
  2592         16  CF-USER3-CNTL-OPT.
  2593             20  CF-USER3-OPT-SEQ           PIC 9.
  2594                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2595                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2596             20  CF-USER3-SELECT OCCURS 3 TIMES
  2597                                            PIC X(10).
  2598         16  CF-USER4-CNTL-OPT.
  2599             20  CF-USER4-OPT-SEQ           PIC 9.
  2600                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2601                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2602             20  CF-USER4-SELECT OCCURS 3 TIMES
  2603                                            PIC X(10).
  2604         16  CF-USER5-CNTL-OPT.
  2605             20  CF-USER5-OPT-SEQ           PIC 9.
  2606                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2607                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2608             20  CF-USER5-SELECT OCCURS 3 TIMES
  2609                                            PIC X(10).
  2610         16  CF-REINS-CNTL-OPT.
  2611             20  CF-REINS-OPT-SEQ           PIC 9.
  2612                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2613                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2614             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2615                 24  CF-REINS-PRIME         PIC XXX.
  2616                 24  CF-REINS-SUB           PIC XXX.
  2617
  2618         16  CF-AGENT-CNTL-OPT.
  2619             20  CF-AGENT-OPT-SEQ           PIC 9.
  2620                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2621                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2622             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2623                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  47
* WSMESS01.cbl
  2624
  2625         16  FILLER                         PIC X(43).
  2626
  2627         16  CF-LOSS-RATIO-SELECT.
  2628             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2629             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2630         16  CF-ENTRY-DATE-SELECT.
  2631             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2632             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2633         16  CF-EFFECTIVE-DATE-SELECT.
  2634             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2635             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2636
  2637         16  CF-EXCEPTION-LIST-IND          PIC X.
  2638             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2639
  2640         16  FILLER                         PIC X(318).
  2641
  2642****************************************************************
  2643*                  EXCEPTION REPORTING RECORD                  *
  2644****************************************************************
  2645
  2646     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2647         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2648             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2649
  2650         16  CF-COMBINED-LIFE-AH-OPT.
  2651             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2652             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2653             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2654             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2655
  2656         16  CF-LIFE-OPT.
  2657             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2658             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2659             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2660             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2661             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2662             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2663             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2664             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2665             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2666             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2667
  2668         16  CF-AH-OPT.
  2669             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2670             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2671             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2672             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2673             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2674             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2675             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2676             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2677             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2678             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2679
  2680         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2681             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  48
* WSMESS01.cbl
  2682             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2683             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2684
  2685         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2686
  2687         16  FILLER                         PIC X(673).
  2688
  2689
  2690****************************************************************
  2691*             MORTGAGE SYSTEM PLAN RECORD                      *
  2692****************************************************************
  2693
  2694     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2695         16  CF-PLAN-TYPE                   PIC X.
  2696             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2697             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2698             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2699         16  CF-PLAN-ABBREV                 PIC XXX.
  2700         16  CF-PLAN-DESCRIPT               PIC X(10).
  2701         16  CF-PLAN-NOTES                  PIC X(20).
  2702         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2703         16  CF-PLAN-UNDERWRITING.
  2704             20  CF-PLAN-TERM-DATA.
  2705                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2706                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2707             20  CF-PLAN-AGE-DATA.
  2708                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2709                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2710                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2711             20  CF-PLAN-BENEFIT-DATA.
  2712                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2713                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2714                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2715                                            PIC S9(7)V99  COMP-3.
  2716         16  CF-PLAN-POLICY-FORMS.
  2717             20  CF-POLICY-FORM             PIC X(12).
  2718             20  CF-MASTER-APPLICATION      PIC X(12).
  2719             20  CF-MASTER-POLICY           PIC X(12).
  2720         16  CF-PLAN-RATING.
  2721             20  CF-RATE-CODE               PIC X(5).
  2722             20  CF-SEX-RATING              PIC X.
  2723                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2724                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2725             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2726             20  CF-SUB-STD-TYPE            PIC X.
  2727                 88  CF-PCT-OF-PREM            VALUE '1'.
  2728                 88  CF-PCT-OF-BENE            VALUE '2'.
  2729         16  CF-PLAN-PREM-TOLERANCES.
  2730             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2731             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2732         16  CF-PLAN-PYMT-TOLERANCES.
  2733             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2734             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2735         16  CF-PLAN-MISC-DATA.
  2736             20  FILLER                     PIC X.
  2737             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2738             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2739         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  49
* WSMESS01.cbl
  2740         16  CF-PLAN-IND-GRP                PIC X.
  2741             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2742                                                     '1'.
  2743             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2744                                                     '2'.
  2745         16  CF-MIB-SEARCH-SW               PIC X.
  2746             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2747             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2748             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2749             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2750         16  CF-ALPHA-SEARCH-SW             PIC X.
  2751             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2752             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2753             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2754             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2755             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2756             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2757             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2758             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2759             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2760             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2761                                                     'A' 'B' 'C'
  2762                                                     'X' 'Y' 'Z'.
  2763         16  CF-EFF-DT-RULE-SW              PIC X.
  2764             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2765             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2766             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2767             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2768             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2769         16  FILLER                         PIC X(4).
  2770         16  CF-HEALTH-QUESTIONS            PIC X.
  2771             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2772         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2773         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2774         16  CF-PLAN-SNGL-JNT               PIC X.
  2775             88  CF-COMBINED-PLAN              VALUE 'C'.
  2776             88  CF-JNT-PLAN                   VALUE 'J'.
  2777             88  CF-SNGL-PLAN                  VALUE 'S'.
  2778         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2779         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2780         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2781         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2782         16  CF-RERATE-CNTL                 PIC  X.
  2783             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2784             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2785             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2786             88  CF-AUTO-RECALC                 VALUE '4'.
  2787         16  CF-BENEFIT-TYPE                PIC  X.
  2788             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2789             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2790         16  CF-POLICY-FEE                  PIC S999V99
  2791                                                    COMP-3.
  2792         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2793         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2794         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2795         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2796         16  FILLER                         PIC  X(32).
  2797         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  50
* WSMESS01.cbl
  2798         16  FILLER                         PIC  X(08).
  2799         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2800                                                       COMP-3.
  2801         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2802         16  CF-ISSUE-LETTER                PIC  X(4).
  2803         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2804         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2805             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2806             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2807         16  CF-MP-REFUND-CALC              PIC X.
  2808             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2809             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2810             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2811             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2812             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2813             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2814             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2815             88  CF-MP-REFD-MEAN                VALUE '8'.
  2816         16  CF-ALT-RATE-CODE               PIC  X(5).
  2817
  2818
  2819         16  FILLER                         PIC X(498).
  2820****************************************************************
  2821*             MORTGAGE COMPANY MASTER RECORD                   *
  2822****************************************************************
  2823
  2824     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2825         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2826         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2827             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2828             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2829             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2830             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2831             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2832
  2833         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2834         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2835         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2836         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2837         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2838
  2839         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2840             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2841         16  CF-MP-RECON-USE-IND            PIC X(1).
  2842             88  CF-MP-USE-RECON             VALUE 'Y'.
  2843         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2844             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2845         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2846             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2847             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2848         16  FILLER                         PIC X(1).
  2849         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2850             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2851         16  CF-MORTG-MIB-VERSION           PIC X.
  2852             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2853             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2854             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2855         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  51
* WSMESS01.cbl
  2856             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2857                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2858             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2859                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2860             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2861                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2862             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2863                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2864             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2865                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2866             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2867                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2868         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2869         16  FILLER                         PIC X(7).
  2870         16  CF-MORTG-DESTINATION-SYMBOL.
  2871             20  CF-MORTG-MIB-COMM          PIC X(5).
  2872             20  CF-MORTG-MIB-TERM          PIC X(5).
  2873         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2874             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2875         16  FILLER                         PIC X(03).
  2876         16  CF-MP-CHECK-NO-CONTROL.
  2877             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2878                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2879                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2880                                                ' ' LOW-VALUES.
  2881                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2882                                               VALUE '3'.
  2883         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2884         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2885         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2886             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2887                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2888             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2889                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2890             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2891                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2892             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2893                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2894             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2895                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2896             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2897                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2898         16  CF-MORTG-BILLING-AREA.
  2899             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2900                                            PIC X.
  2901         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2902         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2903         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2904         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2905             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2906             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2907         16  FILLER                         PIC X.
  2908         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2909             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2910             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2911         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2912         16  FILLER                         PIC X(8).
  2913         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  52
* WSMESS01.cbl
  2914         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2915         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2916         16  CF-ACH-COMPANY-ID.
  2917             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2918                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2919                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2920                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2921             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2922         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2923             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2924         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2925             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2926             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2927         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2928         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2929         16  FILLER                         PIC X(536).
  2930
  2931****************************************************************
  2932*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2933****************************************************************
  2934
  2935     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2936         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2937             20  CF-FEMALE-HEIGHT.
  2938                 24  CF-FEMALE-FT           PIC 99.
  2939                 24  CF-FEMALE-IN           PIC 99.
  2940             20  CF-FEMALE-MIN-WT           PIC 999.
  2941             20  CF-FEMALE-MAX-WT           PIC 999.
  2942         16  FILLER                         PIC X(428).
  2943
  2944     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2945         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2946             20  CF-MALE-HEIGHT.
  2947                 24  CF-MALE-FT             PIC 99.
  2948                 24  CF-MALE-IN             PIC 99.
  2949             20  CF-MALE-MIN-WT             PIC 999.
  2950             20  CF-MALE-MAX-WT             PIC 999.
  2951         16  FILLER                         PIC X(428).
  2952******************************************************************
  2953*             AUTOMATIC ACTIVITY RECORD                          *
  2954******************************************************************
  2955     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2956         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2957             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2958             20  CF-SYS-LETTER-ID           PIC X(04).
  2959             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2960             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2961             20  CF-SYS-RESET-SW            PIC X(01).
  2962             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2963             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2964
  2965         16  FILLER                         PIC X(50).
  2966
  2967         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2968             20  CF-USER-ACTIVE-SW          PIC X(01).
  2969             20  CF-USER-LETTER-ID          PIC X(04).
  2970             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2971             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  53
* WSMESS01.cbl
  2972             20  CF-USER-RESET-SW           PIC X(01).
  2973             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2974             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2975             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2976
  2977         16  FILLER                         PIC X(246).
  2978*                                 COPY ELCFUNDT.
  2979*****************************************************************
  2980*                                                               *
  2981*                            ELCFUNDT.                          *
  2982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  2983*                            VMOD=2.001                         *
  2984*                                                               *
  2985*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  2986*                                                               *
  2987*****************************************************************
  2988
  2989
  2990 01  FUNCTION-DATE.
  2991     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  2992     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  2993         10  WS-FN-CCYR            PIC 9(4).
  2994         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  2995             15  WS-FN-CC          PIC 99.
  2996             15  WS-FN-YR          PIC 99.
  2997         10  WS-FN-MO              PIC 99.
  2998         10  WS-FN-DA              PIC 99.
  2999     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  3000     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  3001     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  3002     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  3003     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  3004         88  WS-BEHIND-GMT                     VALUE '-'.
  3005         88  WS-AFTER-GMT                      VALUE '+'.
  3006         88  WS-NO-GMT                         VALUE ZERO.
  3007     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  3008     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  3009*                                 COPY ELCDATE.
  3010******************************************************************
  3011*                                                                *
  3012*                                                                *
  3013*                            ELCDATE.                            *
  3014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3015*                            VMOD=2.003
  3016*                                                                *
  3017*                                                                *
  3018*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3019*                 LENGTH = 200                                   *
  3020******************************************************************
  3021
  3022 01  DATE-CONVERSION-DATA.
  3023     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3024     12  DC-OPTION-CODE                PIC X.
  3025         88  BIN-TO-GREG                VALUE ' '.
  3026         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3027         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3028         88  YMD-GREG-TO-BIN            VALUE '3'.
  3029         88  MDY-GREG-TO-BIN            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  54
* WSMESS01.cbl
  3030         88  JULIAN-TO-BIN              VALUE '5'.
  3031         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3032         88  FIND-CENTURY               VALUE '7'.
  3033         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3034         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3035         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3036         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3037         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3038         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3039         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3040         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3041         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3042         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3043         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3044         88  BIN-3-TO-GREG              VALUE 'I'.
  3045         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3046         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3047         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3048         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3049         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3050         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3051         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3052         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3053         88  THREE-CHARACTER-BIN
  3054                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3055         88  GREGORIAN-TO-BIN
  3056                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3057         88  BIN-TO-GREGORIAN
  3058                  VALUES ' ' '1' 'I' '8' 'G'.
  3059         88  JULIAN-TO-BINARY
  3060                  VALUES '5' 'C' 'E' 'F'.
  3061     12  DC-ERROR-CODE                 PIC X.
  3062         88  NO-CONVERSION-ERROR        VALUE ' '.
  3063         88  DATE-CONVERSION-ERROR
  3064                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3065         88  DATE-IS-ZERO               VALUE '1'.
  3066         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3067         88  DATE-IS-INVALID            VALUE '3'.
  3068         88  DATE1-GREATER-DATE2        VALUE '4'.
  3069         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3070         88  DATE-INVALID-OPTION        VALUE '9'.
  3071         88  INVALID-CENTURY            VALUE 'A'.
  3072         88  ONLY-CENTURY               VALUE 'B'.
  3073         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3074         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3075     12  DC-END-OF-MONTH               PIC X.
  3076         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3077     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3078         88  USE-NORMAL-PROCESS         VALUE ' '.
  3079         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3080         88  ADJUST-UP-100-YRS          VALUE '2'.
  3081     12  FILLER                        PIC X.
  3082     12  DC-CONVERSION-DATES.
  3083         16  DC-BIN-DATE-1             PIC XX.
  3084         16  DC-BIN-DATE-2             PIC XX.
  3085         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3086         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3087                       DC-GREG-DATE-1-EDIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  55
* WSMESS01.cbl
  3088             20  DC-EDIT1-MONTH        PIC 99.
  3089             20  SLASH1-1              PIC X.
  3090             20  DC-EDIT1-DAY          PIC 99.
  3091             20  SLASH1-2              PIC X.
  3092             20  DC-EDIT1-YEAR         PIC 99.
  3093         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3094         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3095                     DC-GREG-DATE-2-EDIT.
  3096             20  DC-EDIT2-MONTH        PIC 99.
  3097             20  SLASH2-1              PIC X.
  3098             20  DC-EDIT2-DAY          PIC 99.
  3099             20  SLASH2-2              PIC X.
  3100             20  DC-EDIT2-YEAR         PIC 99.
  3101         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3102         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3103                     DC-GREG-DATE-1-YMD.
  3104             20  DC-YMD-YEAR           PIC 99.
  3105             20  DC-YMD-MONTH          PIC 99.
  3106             20  DC-YMD-DAY            PIC 99.
  3107         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3108         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3109                      DC-GREG-DATE-1-MDY.
  3110             20  DC-MDY-MONTH          PIC 99.
  3111             20  DC-MDY-DAY            PIC 99.
  3112             20  DC-MDY-YEAR           PIC 99.
  3113         16  DC-GREG-DATE-1-ALPHA.
  3114             20  DC-ALPHA-MONTH        PIC X(10).
  3115             20  DC-ALPHA-DAY          PIC 99.
  3116             20  FILLER                PIC XX.
  3117             20  DC-ALPHA-CENTURY.
  3118                 24 DC-ALPHA-CEN-N     PIC 99.
  3119             20  DC-ALPHA-YEAR         PIC 99.
  3120         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3121         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3122         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3123         16  DC-JULIAN-DATE            PIC 9(05).
  3124         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3125                                       PIC 9(05).
  3126         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3127             20  DC-JULIAN-YEAR        PIC 99.
  3128             20  DC-JULIAN-DAYS        PIC 999.
  3129         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3130         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3131         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3132     12  DATE-CONVERSION-VARIBLES.
  3133         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3134         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3135             20  FILLER                PIC 9(3).
  3136             20  HOLD-CEN-1-CCYY.
  3137                 24  HOLD-CEN-1-CC     PIC 99.
  3138                 24  HOLD-CEN-1-YY     PIC 99.
  3139             20  HOLD-CEN-1-MO         PIC 99.
  3140             20  HOLD-CEN-1-DA         PIC 99.
  3141         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3142             20  HOLD-CEN-1-R-MO       PIC 99.
  3143             20  HOLD-CEN-1-R-DA       PIC 99.
  3144             20  HOLD-CEN-1-R-CCYY.
  3145                 24  HOLD-CEN-1-R-CC   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  56
* WSMESS01.cbl
  3146                 24  HOLD-CEN-1-R-YY   PIC 99.
  3147             20  FILLER                PIC 9(3).
  3148         16  HOLD-CENTURY-1-X.
  3149             20  FILLER                PIC X(3)  VALUE SPACES.
  3150             20  HOLD-CEN-1-X-CCYY.
  3151                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3152                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3153             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3154             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3155         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3156             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3157             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3158             20  HOLD-CEN-1-R-X-CCYY.
  3159                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3160                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3161             20  FILLER                PIC XXX.
  3162         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3163         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3164         16  DC-JULIAN-DATE-1          PIC 9(07).
  3165         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3166             20  DC-JULIAN-1-CCYY.
  3167                 24  DC-JULIAN-1-CC    PIC 99.
  3168                 24  DC-JULIAN-1-YR    PIC 99.
  3169             20  DC-JULIAN-DA-1        PIC 999.
  3170         16  DC-JULIAN-DATE-2          PIC 9(07).
  3171         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3172             20  DC-JULIAN-2-CCYY.
  3173                 24  DC-JULIAN-2-CC    PIC 99.
  3174                 24  DC-JULIAN-2-YR    PIC 99.
  3175             20  DC-JULIAN-DA-2        PIC 999.
  3176         16  DC-GREG-DATE-A-EDIT.
  3177             20  DC-EDITA-MONTH        PIC 99.
  3178             20  SLASHA-1              PIC X VALUE '/'.
  3179             20  DC-EDITA-DAY          PIC 99.
  3180             20  SLASHA-2              PIC X VALUE '/'.
  3181             20  DC-EDITA-CCYY.
  3182                 24  DC-EDITA-CENT     PIC 99.
  3183                 24  DC-EDITA-YEAR     PIC 99.
  3184         16  DC-GREG-DATE-B-EDIT.
  3185             20  DC-EDITB-MONTH        PIC 99.
  3186             20  SLASHB-1              PIC X VALUE '/'.
  3187             20  DC-EDITB-DAY          PIC 99.
  3188             20  SLASHB-2              PIC X VALUE '/'.
  3189             20  DC-EDITB-CCYY.
  3190                 24  DC-EDITB-CENT     PIC 99.
  3191                 24  DC-EDITB-YEAR     PIC 99.
  3192         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3193         16  DC-GREG-DATE-CYMD-R REDEFINES
  3194                              DC-GREG-DATE-CYMD.
  3195             20  DC-CYMD-CEN           PIC 99.
  3196             20  DC-CYMD-YEAR          PIC 99.
  3197             20  DC-CYMD-MONTH         PIC 99.
  3198             20  DC-CYMD-DAY           PIC 99.
  3199         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3200         16  DC-GREG-DATE-MDCY-R REDEFINES
  3201                              DC-GREG-DATE-MDCY.
  3202             20  DC-MDCY-MONTH         PIC 99.
  3203             20  DC-MDCY-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  57
* WSMESS01.cbl
  3204             20  DC-MDCY-CEN           PIC 99.
  3205             20  DC-MDCY-YEAR          PIC 99.
  3206    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3207        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3208    12  DC-EL310-DATE                  PIC X(21).
  3209    12  FILLER                         PIC X(28).
  3210*                                 COPY ELCCALC.
  3211******************************************************************
  3212*                                                                *
  3213*                           ELCCALC.                            *
  3214*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3215*                            VMOD=2.025                          *
  3216*                                                                *
  3217*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3218*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3219*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3220*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3221*                                                                *
  3222*  PASSED TO ELRTRM                                              *
  3223*  -----------------                                             *
  3224*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3225*  ORIGINAL TERM                                                 *
  3226*  BEGINNING DATE                                                *
  3227*  ENDING DATE                                                   *
  3228*  COMPANY I.D.                                                  *
  3229*  ACCOUNT MASTER USER FIELD                                     *
  3230*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3231*  FREE LOOK DAYS                                                *
  3232*                                                                *
  3233*  RETURNED FROM ELRTRM                                          *
  3234*  ---------------------                                         *
  3235*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3236*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3237*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3238*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3239*----------------------------------------------------------------*
  3240*  PASSED TO ELRAMT                                              *
  3241*  ----------------                                              *
  3242*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3243*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3244*  ORIGINAL AMOUNT                                               *
  3245*  ALTERNATE BENEFIT (BALLON)                                    *
  3246*  A.P.R. - NET PAY ONLY                                         *
  3247*  METHOD
  3248*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3249*  COMPANY I.D.                                                  *
  3250*  BENEFIT TYPE                                                  *
  3251*                                                                *
  3252*  RETURNED FROM ELRAMT                                          *
  3253*  --------------------                                          *
  3254*  REMAINING AMOUNT 1 - CURRENT                                  *
  3255*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3256*  REMAINING AMOUNT FACTOR
  3257*----------------------------------------------------------------*
  3258*  PASSED TO ELRESV                                              *
  3259*  -----------------                                             *
  3260*  CERTIFICATE EFFECTIVE DATE                                    *
  3261*  VALUATION DATE                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  58
* WSMESS01.cbl
  3262*  PAID THRU DATE                                                *
  3263*  BENEFIT                                                       *
  3264*  INCURRED DATE                                                 *
  3265*  REPORTED DATE                                                 *
  3266*  ISSUE AGE                                                     *
  3267*  TERM                                                          *
  3268*  CDT PERCENT                                                   *
  3269*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3270* *CLAIM TYPE (LIFE, A/H)                                        *
  3271* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3272* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3273*                                                                *
  3274*  RETURNED FROM ELRESV                                          *
  3275*  --------------------                                          *
  3276*  CDT TABLE USED                                                *
  3277*  CDT FACTOR USED                                               *
  3278*  PAY TO CURRENT RESERVE                                        *
  3279*  I.B.N.R. - A/H ONLY                                           *
  3280*  FUTURE (ACCRUED) AH ONLY                                      *
  3281*----------------------------------------------------------------*
  3282*  PASSED TO ELRATE                                              *
  3283*  ----------------                                              *
  3284*  CERT ISSUE DATE                                               *
  3285*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3286*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3287*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3288*  STATE CODE (CLIENT DEFINED)                                   *
  3289*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3290*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3291*  DEVIATION CODE                                                *
  3292*  ISSUE AGE                                                     *
  3293*  ORIGINAL BENEFIT AMOUNT                                       *
  3294*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3295*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3296*  BENEFIT KIND (LIFE OR A/H)                                    *
  3297*  A.P.R.                                                        *
  3298*  METHOD
  3299*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3300*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3301*  COMPANY I.D. (3 CHARACTER)                                    *
  3302*  BENEFIT CODE                                                  *
  3303*  BENEFIT OVERRIDE CODE                                         *
  3304*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3305*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3306*  JOINT INDICATOR (CSL ONLY)                                    *
  3307*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3308*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3309*                                                                *
  3310*  RETURNED FROM ELRATE                                          *
  3311*  --------------------                                          *
  3312*  CALCULATED PREMIUM                                            *
  3313*  PREMIUM RATE                                                  *
  3314*  MORTALITY CODE                                                *
  3315*  MAX ATTAINED AGE                                              *
  3316*  MAX AGE                                                       *
  3317*  MAX TERM                                                      *
  3318*  MAX MONTHLY BENEFIT                                           *
  3319*  MAX TOTAL BENIFIT                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  59
* WSMESS01.cbl
  3320*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3321*----------------------------------------------------------------*
  3322*  PASSED TO ELRFND                                              *
  3323*  ----------------                                              *
  3324*  CERT ISSUE DATE                                               *
  3325*  REFUND DATE                                                   *
  3326*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3327*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3328*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3329*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3330*  STATE CODE (CLIENT DEFINED)                                   *
  3331*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3332*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3333*  DEVIATION CODE                                                *
  3334*  ISSUE AGE                                                     *
  3335*  ORIGINAL BENEFIT AMOUNT                                       *
  3336*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3337*  PROCESS TYPE (CANCEL)                                         *
  3338*  BENEFIT KIND (LIFE OR A/H)                                    *
  3339*  A.P.R.                                                        *
  3340*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3341*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3342*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3343*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3344*  COMPANY I.D. (3 CHARACTER)                                    *
  3345*  BENEFIT CODE                                                  *
  3346*  BENEFIT OVERRIDE CODE                                         *
  3347*                                                                *
  3348*  RETURNED FROM ELRFND                                          *
  3349*  --------------------                                          *
  3350*  CALCULATED REFUND                                             *
  3351*----------------------------------------------------------------*
  3352*  PASSED TO ELEARN                                              *
  3353*  ----------------                                              *
  3354*  CERT ISSUE DATE                                               *
  3355*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3356*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3357*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3358*  STATE CODE (CLIENT DEFINED)                                   *
  3359*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3360*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3361*  DEVIATION CODE                                                *
  3362*  ISSUE AGE                                                     *
  3363*  ORIGINAL BENEFIT AMOUNT                                       *
  3364*  BENEFIT KIND (LIFE OR A/H)                                    *
  3365*  A.P.R.                                                        *
  3366*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3367*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3368*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3369*  COMPANY I.D. (3 CHARACTER)                                    *
  3370*  BENEFIT CODE                                                  *
  3371*  BENEFIT OVERRIDE CODE                                         *
  3372*                                                                *
  3373*  RETURNED FROM ELEARN                                          *
  3374*  --------------------                                          *
  3375*  INDICATED  EARNINGS                                           *
  3376*----------------------------------------------------------------*
  3377*                 LENGTH = 450                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  60
* WSMESS01.cbl
  3378*                                                                *
  3379******************************************************************
  3380******************************************************************
  3381*                   C H A N G E   L O G
  3382*
  3383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3384*-----------------------------------------------------------------
  3385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3386* EFFECTIVE    NUMBER
  3387*-----------------------------------------------------------------
  3388* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3389* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3390* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3391* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3392* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3393* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3394* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3395* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3396* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3397* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3398* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3399******************************************************************
  3400
  3401 01  CALCULATION-PASS-AREA.
  3402     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3403                                     COMP.
  3404
  3405     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3406       88  NO-CP-ERROR                             VALUE ZERO.
  3407       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3408                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3409       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3410       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3411       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3412       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3413       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3414       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3415       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3416       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3417       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3418       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3419       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3420       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3421       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3422       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3423       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3424       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3425       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3426
  3427     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3428       88  NO-CP-ERROR-2                           VALUE ZERO.
  3429***********************  INPUT AREAS ****************************
  3430
  3431     12  CP-CALCULATION-AREA.
  3432         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3433         16  CP-CERT-EFF-DT        PIC XX.
  3434         16  CP-VALUATION-DT       PIC XX.
  3435         16  CP-PAID-THRU-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  61
* WSMESS01.cbl
  3436         16  CP-BENEFIT-TYPE       PIC X.
  3437           88  CP-AH                               VALUE 'A' 'D'
  3438                                                   'I' 'U'.
  3439           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3440           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3441         16  CP-INCURRED-DT        PIC XX.
  3442         16  CP-REPORTED-DT        PIC XX.
  3443         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3444         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3445         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3446                                     COMP-3.
  3447         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3448                                     COMP-3.
  3449         16  CP-CDT-METHOD         PIC X.
  3450           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3451           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3452           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3453         16  CP-CLAIM-TYPE         PIC X.
  3454           88  CP-AH-CLAIM                         VALUE 'A'.
  3455           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3456         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3457                                     COMP-3.
  3458         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3463                                     COMP-3.
  3464         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3465                                     COMP-3.
  3466         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3467                                     COMP-3.
  3468         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-REM-TERM-METHOD    PIC X.
  3471           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3472           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3473           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3474           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3475           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3476           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3477           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3478         16  CP-EARNING-METHOD     PIC X.
  3479           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3480           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3481           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3482           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3483           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3484           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3485           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3486           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3487           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3488           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3489           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3490           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3491           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3492           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3493         16  CP-PROCESS-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  62
* WSMESS01.cbl
  3494           88  CP-CLAIM                            VALUE '1'.
  3495           88  CP-CANCEL                           VALUE '2'.
  3496           88  CP-ISSUE                            VALUE '3'.
  3497         16  CP-SPECIAL-CALC-CD    PIC X.
  3498           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3499           88  CP-1-MTH-INTEREST               VALUE ' '.
  3500           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3501           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3502           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3503           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3504           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3505           88  CP-FARM-PLAN                    VALUE 'F'.
  3506           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3507           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3508           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3509           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3510           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3511           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3512           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3513           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3514           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3515           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3516                                                     'W' 'X'.
  3517           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3518           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3519           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3520           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3521           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3522           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3523           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3524           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3525           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3526           88  CP-CSL-METH-1                   VALUE '5'.
  3527           88  CP-CSL-METH-2                   VALUE '6'.
  3528           88  CP-CSL-METH-3                   VALUE '7'.
  3529           88  CP-CSL-METH-4                   VALUE '8'.
  3530
  3531         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3532                                     COMP-3.
  3533         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3534         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3535         16  CP-STATE              PIC XX          VALUE SPACE.
  3536         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3537         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3538           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3539               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3540         16  CP-R78-OPTION         PIC X.
  3541           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3542           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3543
  3544         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3545         16  CP-IBNR-RESERVE-SW    PIC X.
  3546         16  CP-CLAIM-STATUS       PIC X.
  3547         16  CP-RATE-FILE          PIC X.
  3548         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3549                                     COMP-3.
  3550
  3551         16  CP-LIFE-OVERRIDE-CODE PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  63
* WSMESS01.cbl
  3552         16  CP-AH-OVERRIDE-CODE   PIC X.
  3553
  3554         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3555                                     COMP-3.
  3556         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3557                                   PIC S9(5)V99 COMP-3.
  3558         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3559                                     COMP-3.
  3560         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3563                                     COMP-3.
  3564         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3565                                  PIC S9(7)V99 COMP-3.
  3566
  3567         16  CP-PAID-FROM-DATE     PIC X(02).
  3568         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3569         16  CP-EXT-DAYS-CALC      PIC X.
  3570           88  CP-EXT-NO-CHG                   VALUE ' '.
  3571           88  CP-EXT-CHG-LF                   VALUE '1'.
  3572           88  CP-EXT-CHG-AH                   VALUE '2'.
  3573           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3574         16  CP-DOMICILE-STATE     PIC XX.
  3575         16  CP-CARRIER            PIC X.
  3576         16  CP-REIN-FLAG          PIC X.
  3577         16  CP-REM-TRM-CALC-OPTION PIC X.
  3578           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3579                      '2' '3' '4' '5'.
  3580           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3581           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3582           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3583           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3584           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3585           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3586           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3587           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3588         16  CP-SIG-SWITCH         PIC X.
  3589         16  CP-RATING-METHOD      PIC X.
  3590           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3591           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3592           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3593           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3594           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3595           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3596           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3597           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3598           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3599         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3600                                     COMP-3.
  3601         16  CP-BEN-CATEGORY       PIC X.
  3602         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3603         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3604                                   PIC S99V9(5) COMP-3.
  3605         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3606         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3607                                   PIC S99V9(5) COMP-3.
  3608         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3609         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  64
* WSMESS01.cbl
  3610         16  CP-EXPIRE-DT          PIC XX.
  3611         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3612         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3613         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3614         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3615         16  CP-DDF-SPEC-CALC      PIC X.
  3616             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3617             88  CP-CALC-CLP              VALUE 'C'.
  3618         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3619         16  CP-CANCEL-REASON      PIC X.
  3620         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3621         16  CP-PMT-MODE           PIC X.
  3622         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3623         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3624         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3625         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3626         16  FILLER                PIC X.
  3627
  3628***************    OUTPUT FROM ELRESV   ************************
  3629
  3630         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3631
  3632         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3633                                     COMP-3.
  3634         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3635                                     COMP-3.
  3636         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3637                                     COMP-3.
  3638         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3639                                     COMP-3.
  3640         16  FILLER                PIC X(09).
  3641***************    OUTPUT FROM ELRTRM   *************************
  3642
  3643         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3644                                     COMP-3.
  3645         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3650                                     COMP-3.
  3651         16  FILLER                PIC X(12).
  3652
  3653***************    OUTPUT FROM ELRAMT   *************************
  3654
  3655         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3658                                     COMP-3.
  3659         16  FILLER                PIC X(12).
  3660
  3661***************    OUTPUT FROM ELRATE   *************************
  3662
  3663         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-MORTALITY-CODE     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  65
* WSMESS01.cbl
  3668         16  CP-RATE-EDIT-FLAG     PIC X.
  3669             88  CP-RATES-NEED-APR                  VALUE '1'.
  3670         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3673         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3674         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3675                                   PIC S9(7)V99 COMP-3.
  3676         16  FILLER                PIC X(07).
  3677
  3678***************    OUTPUT FROM ELRFND   *************************
  3679
  3680         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3681                                     COMP-3.
  3682         16  CP-REFUND-TYPE-USED   PIC X.
  3683           88  CP-R-AS-R78                         VALUE '1'.
  3684           88  CP-R-AS-PRORATA                     VALUE '2'.
  3685           88  CP-R-AS-CALIF                       VALUE '3'.
  3686           88  CP-R-AS-TEXAS                       VALUE '4'.
  3687           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3688           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3689           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3690           88  CP-R-AS-MEAN                        VALUE '8'.
  3691           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3692           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3693           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3694           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3695           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3696           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3697         16  FILLER                PIC X(12).
  3698
  3699***************    OUTPUT FROM ELEARN   *************************
  3700
  3701         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3704                                     COMP-3.
  3705         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-EARNING-TYPE-USED  PIC X.
  3714           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3715           88  CP-E-AS-R78                         VALUE '1'.
  3716           88  CP-E-AS-PRORATA                     VALUE '2'.
  3717           88  CP-E-AS-TEXAS                       VALUE '4'.
  3718           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3719           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3720           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3721           88  CP-E-AS-MEAN                        VALUE '8'.
  3722           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3723         16  FILLER                PIC X(12).
  3724
  3725***************    OUTPUT FROM ELPMNT   *************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  66
* WSMESS01.cbl
  3726
  3727         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3730                                     COMP-3.
  3731         16  FILLER                PIC X(12).
  3732
  3733***************   MISC WORK AREAS    *****************************
  3734         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3747             88  OPEN-RATE-FILE                   VALUE 'O'.
  3748             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3749             88  IO-ERROR                         VALUE 'E'.
  3750
  3751         16  CP-FIRST-PAY-DATE     PIC XX.
  3752
  3753         16  CP-JOINT-INDICATOR    PIC X.
  3754
  3755         16  CP-RESERVE-REMAINING-TERM
  3756                                   PIC S9(4)V9    VALUE ZERO
  3757                                     COMP-3.
  3758
  3759         16  CP-INSURED-BIRTH-DT   PIC XX.
  3760
  3761         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3762                                     COMP-3.
  3763
  3764         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3765                                     COMP-3.
  3766
  3767         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3768                                     COMP-3.
  3769
  3770         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3771                                     COMP-3.
  3772
  3773         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3774                                     COMP-3.
  3775
  3776         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3777                                     COMP-3.
  3778
  3779         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3780                                     COMP-3.
  3781
  3782         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3783             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  67
* WSMESS01.cbl
  3784
  3785         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3790         16  cp-extra-periods      pic 9 value zeros.
  3791         16  cp-net-only-state     pic x value spaces.
  3792         16  FILLER                PIC X(13).
  3793******************************************************************
  3794****************************************************************
  3795*
  3796* Copyright (c) 2007-2013 Dell Inc.
  3797* All rights reserved.
  3798*
  3799****************************************************************
  3800 01  DFHEIV.
  3801   02  DFHEIV0               PIC X(35).
  3802   02  DFHEIV1               PIC X(08).
  3803   02  DFHEIV2               PIC X(08).
  3804   02  DFHEIV3               PIC X(08).
  3805   02  DFHEIV4               PIC X(06).
  3806   02  DFHEIV5               PIC X(04).
  3807   02  DFHEIV6               PIC X(04).
  3808   02  DFHEIV7               PIC X(02).
  3809   02  DFHEIV8               PIC X(02).
  3810   02  DFHEIV9               PIC X(01).
  3811   02  DFHEIV10              PIC S9(7) COMP-3.
  3812   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3813   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3814   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3815   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3816   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3817   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3818   02  DFHEIV17              PIC X(04).
  3819   02  DFHEIV18              PIC X(04).
  3820   02  DFHEIV19              PIC X(04).
  3821   02  DFHEIV20              USAGE IS POINTER.
  3822   02  DFHEIV21              USAGE IS POINTER.
  3823   02  DFHEIV22              USAGE IS POINTER.
  3824   02  DFHEIV23              USAGE IS POINTER.
  3825   02  DFHEIV24              USAGE IS POINTER.
  3826   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3827   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3828   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3829   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3830   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3831   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3832   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3833   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3834   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3835   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3836   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3837   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3838   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3839   02  FILLER                PIC X(02).
  3840   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3841   02  DFHEIVL0              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  68
* WSMESS01.cbl
  3842   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3843   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3844   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3845   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3846   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3847 LINKAGE  SECTION.
  3848*****************************************************************
  3849*                                                               *
  3850* Copyright (c) 2007-2013 Dell Inc.                             *
  3851* All rights reserved.                                          *
  3852*                                                               *
  3853*****************************************************************
  3854 01  dfheiblk.
  3855     02  eibtime          pic s9(7) comp-3.
  3856     02  eibdate          pic s9(7) comp-3.
  3857     02  eibtrnid         pic x(4).
  3858     02  eibtaskn         pic s9(7) comp-3.
  3859     02  eibtrmid         pic x(4).
  3860     02  dfheigdi         pic s9(4) comp.
  3861     02  eibcposn         pic s9(4) comp.
  3862     02  eibcalen         pic s9(4) comp.
  3863     02  eibaid           pic x(1).
  3864     02  eibfiller1       pic x(1).
  3865     02  eibfn            pic x(2).
  3866     02  eibfiller2       pic x(2).
  3867     02  eibrcode         pic x(6).
  3868     02  eibfiller3       pic x(2).
  3869     02  eibds            pic x(8).
  3870     02  eibreqid         pic x(8).
  3871     02  eibrsrce         pic x(8).
  3872     02  eibsync          pic x(1).
  3873     02  eibfree          pic x(1).
  3874     02  eibrecv          pic x(1).
  3875     02  eibsend          pic x(1).
  3876     02  eibatt           pic x(1).
  3877     02  eibeoc           pic x(1).
  3878     02  eibfmh           pic x(1).
  3879     02  eibcompl         pic x(1).
  3880     02  eibsig           pic x(1).
  3881     02  eibconf          pic x(1).
  3882     02  eiberr           pic x(1).
  3883     02  eibrldbk         pic x(1).
  3884     02  eiberrcd         pic x(4).
  3885     02  eibsynrb         pic x(1).
  3886     02  eibnodat         pic x(1).
  3887     02  eibfiller5       pic x(2).
  3888     02  eibresp          pic s9(8) comp.
  3889     02  eibresp2         pic s9(8) comp.
  3890     02  dfheigdj         pic s9(4) comp.
  3891     02  dfheigdk         pic s9(4) comp.
  3892 01  DFHCOMMAREA                 pic x(1024).
  3893 01  var  pic x(30).
  3894 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3895 0000-DFHEXIT SECTION.
  3896     MOVE '9#                    $   ' TO DFHEIV0.
  3897     MOVE 'WSMESS01' TO DFHEIV1.
  3898     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3899     display ' Entering program WSMESS01 '
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  69
* WSMESS01.cbl
  3900     move dfhcommarea            to ws-mess001-pass-area
  3901     perform 0000-init           thru 0000-exit
  3902     display ' mess001 area ' ws-mess001-pass-area
  3903     perform 0010-process-message
  3904                                 thru 0010-exit
  3905     display ' raw after unstring ' raw-message001-area
  3906*    move ' returning string goes here ' to ws-return-string
  3907     go to 0300-RETURN-CICS
  3908     .
  3909 0000-init.
  3910     move 'CID'                  to client-id
  3911     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3912     move ws-fn-cymd             to dc-greg-date-cymd
  3913     move 'L'                    to dc-option-code
  3914     perform 9700-date-link      thru 9700-exit
  3915     if no-conversion-error
  3916        move dc-bin-date-1       to ws-bin-current-dt
  3917     else
  3918        display ' error current dt invalid ' dc-error-code
  3919     end-if
  3920     set P to address of KIXSYS
  3921     CALL "getenv" using by value P returning var-ptr
  3922     if var-ptr = null then
  3923        display ' kixsys not set '
  3924     else
  3925        set address of var to var-ptr
  3926        move 0 to env-var-len
  3927        inspect var tallying env-var-len
  3928          for characters before X'00'
  3929        unstring var (1:env-var-len) delimited by '/'
  3930           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3931              WS-KIX-SYS
  3932        end-unstring
  3933     end-if
  3934     evaluate client-id
  3935        when 'DCC'
  3936           MOVE X'05'            TO WS-COMP-CD
  3937           MOVE 'DCC'            TO WS-COMP-ID
  3938        when 'CID'
  3939           MOVE X'04'            TO WS-COMP-CD
  3940           MOVE 'CID'            TO WS-COMP-ID
  3941        when 'AHL'
  3942           MOVE X'06'            TO WS-COMP-CD
  3943           MOVE 'AHL'            TO WS-COMP-ID
  3944        when other
  3945           display ' Invalid company id ' client-id
  3946           move 18               to ws-error-sub
  3947           move client-id        to ws-error-sup
  3948           perform 0180-error-handle
  3949                                 thru 0180-exit
  3950           go to 0300-RETURN-CICS
  3951     END-evaluate
  3952     move spaces                 to ws-return-string
  3953     move ';'                    to ws-sc1
  3954                                    ws-sc2
  3955                                    ws-sc3
  3956                                    ws-sc4
  3957                                    ws-sc5
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  70
* WSMESS01.cbl
  3958                                    ws-sc6
  3959                                    ws-sc7
  3960     .
  3961 0000-exit.
  3962     exit.
  3963 0010-process-message.
  3964     perform 0110-unstring       thru 0110-exit
  3965     perform 0120-format-message thru 0120-exit
  3966     perform 0020-edit-received  thru 0020-exit
  3967     perform 0025-assign-ben-cd  thru 0025-exit
  3968     perform 0050-get-account    thru 0050-exit
  3969     if ws-rate-lf-ah = 'L'
  3970        perform 0090-check-qc-lf-limits
  3971                                 thru 0090-exit
  3972     else
  3973        perform 0095-check-qc-ah-limits
  3974                                 thru 0095-exit
  3975     end-if
  3976     perform 0030-get-rate       thru 0030-exit
  3977     if (contract-no-assigned)
  3978            or
  3979        (error-in-one-coverage)
  3980        continue
  3981     else
  3982        perform 0060-check-for-dup
  3983                                 thru 0060-exit
  3984        perform 0070-open-cursor thru 0070-exit
  3985        perform 0080-process-input
  3986                                 thru 0080-exit
  3987     end-if
  3988     perform 0040-format-buffer  thru 0040-exit
  3989     set contract-no-assigned to true
  3990     .
  3991 0010-exit.
  3992     exit.
  3993 0020-edit-received.
  3994     if ws-rate-sin-jnt-ind = 'S' OR 'J'
  3995        continue
  3996     else
  3997        move 'S'                 to ws-rate-sin-jnt-ind
  3998     end-if
  3999     if ws-rate-dismemberment = 'Y'
  4000        continue
  4001     else
  4002        move 'N'                 to ws-rate-dismemberment
  4003     end-if
  4004     if ws-rate-lf-ah = 'A'
  4005        if ws-rate-retro-elim = 'R' or 'E'
  4006           continue
  4007        else
  4008           move 'R'              to ws-rate-retro-elim
  4009        end-if
  4010     else
  4011        move spaces              to ws-rate-retro-elim
  4012     end-if
  4013     if ws-rate-ins-term = zeros
  4014        move '0115;Problem with insurance term '
  4015                                 to ws-return-string
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  71
* WSMESS01.cbl
  4016        go to 0300-RETURN-CICS
  4017     end-if
  4018     if ws-rate-lf-ah = 'L'
  4019        move 'L'                 to ws-rate-benefit-type
  4020     else
  4021        move 'A'                 to ws-rate-benefit-type
  4022     end-if
  4023**==============================================================**
  4024**                                                              **
  4025**  Validate passed effective date. Probably should add edits   **
  4026**                                                              **
  4027**==============================================================**
  4028     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  4029     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  4030     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  4031     move ws-work-date-num       to dc-greg-date-cymd
  4032     move 'L'                    to dc-option-code
  4033     perform 9700-date-link      thru 9700-exit
  4034     if no-conversion-error
  4035        move dc-bin-date-1       to ws-bin-eff-dt
  4036     else
  4037        move 3                   to ws-error-sub
  4038        move '- Eff Date'        to ws-error-sup
  4039        perform 0180-error-handle
  4040                                 thru 0180-exit
  4041        go to 0300-RETURN-CICS
  4042     end-if
  4043     if ws-bin-eff-dt > ws-bin-current-dt
  4044        move 3                   to ws-error-sub
  4045        move '- Future Eff'      to ws-error-sup
  4046        perform 0180-error-handle
  4047                                 thru 0180-exit
  4048        go to 0300-RETURN-CICS
  4049     end-if
  4050**==============================================================**
  4051**                                                              **
  4052**  Validate passed 1st pmt date.   Probably should add edits   **
  4053**                                                              **
  4054**==============================================================**
  4055     move ws-rate-1st-pmt-dt (7:4)
  4056                                 to ws-work-date (1:4)
  4057     move ws-rate-1st-pmt-dt (1:2)
  4058                                 to ws-work-date (5:2)
  4059     move ws-rate-1st-pmt-dt (4:2)
  4060                                 to ws-work-date (7:2)
  4061     move ws-work-date-num       to dc-greg-date-cymd
  4062     move 'L'                    to dc-option-code
  4063     perform 9700-date-link      thru 9700-exit
  4064     if no-conversion-error
  4065        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  4066     else
  4067        move low-values          to ws-bin-1st-pmt-dt
  4068        move 3                   to ws-error-sub
  4069        move '- 1st Pmt Dt'      to ws-error-sup
  4070        perform 0180-error-handle
  4071                                 thru 0180-exit
  4072        go to 0300-RETURN-CICS
  4073     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  72
* WSMESS01.cbl
  4074     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  4075        move low-values          to ws-bin-1st-pmt-dt
  4076        move 3                   to ws-error-sub
  4077        move '- 1st Pmt !> Eff dt' to ws-error-sup
  4078        perform 0180-error-handle
  4079                                 thru 0180-exit
  4080        go to 0300-RETURN-CICS
  4081     end-if
  4082**==============================================================**
  4083**                                                              **
  4084**  Only use the code below if there is a time they don't       **
  4085**  send the 1st pmt date.                                      **
  4086**                                                              **
  4087**==============================================================**
  4088     if ws-bin-1st-pmt-dt = low-values
  4089        move +1                  to dc-elapsed-months
  4090        move +0                  to dc-elapsed-days
  4091        move '6'                 to dc-option-code
  4092        perform 9700-date-link   thru 9700-exit
  4093        if no-conversion-error
  4094           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4095        else
  4096           move 3                to ws-error-sub
  4097           move '- 1st Pmt Dt'   to ws-error-sup
  4098           perform 0180-error-handle
  4099                                 thru 0180-exit
  4100           go to 0300-RETURN-CICS
  4101        end-if
  4102     end-if
  4103**==============================================================**
  4104**                                                              **
  4105**  Calculate the expiration date to be passed back.            **
  4106**                                                              **
  4107**==============================================================**
  4108     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4109     compute dc-elapsed-months = ws-rate-ins-term - 1
  4110     move +0                     to dc-elapsed-days
  4111     move '6'                    to dc-option-code
  4112     perform 9700-date-link      thru 9700-exit
  4113     if no-conversion-error
  4114        move dc-bin-date-2       to ws-bin-exp-dt
  4115        move dc-greg-date-a-edit to ws-exp-date
  4116     else
  4117        move 3                   to ws-error-sub
  4118        move '- Expire Dt'       to ws-error-sup
  4119        perform 0180-error-handle
  4120                                 thru 0180-exit
  4121        go to 0300-RETURN-CICS
  4122     end-if
  4123**==============================================================**
  4124**                                                              **
  4125**  Validate primary borrower birth date.                       **
  4126**                                                              **
  4127**==============================================================**
  4128     move ws-rate-pri-birth-date (7:4)
  4129                                 to ws-work-date (1:4)
  4130     move ws-rate-pri-birth-date (1:2)
  4131                                 to ws-work-date (5:2)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  73
* WSMESS01.cbl
  4132     move ws-rate-pri-birth-date (4:2)
  4133                                 to ws-work-date (7:2)
  4134     move ws-work-date-num       to dc-greg-date-cymd
  4135     move 'L'                    to dc-option-code
  4136     perform 9700-date-link      thru 9700-exit
  4137     if no-conversion-error
  4138        move dc-bin-date-1       to ws-bin-pri-birth-dt
  4139     else
  4140        move 3                   to ws-error-sub
  4141        move '- Pri DOB '        to ws-error-sup
  4142        perform 0180-error-handle
  4143                                 thru 0180-exit
  4144        go to 0300-RETURN-CICS
  4145     end-if
  4146**==============================================================**
  4147**                                                              **
  4148**  Validate co borrowers birth date.                           **
  4149**                                                              **
  4150**==============================================================**
  4151     if ws-rate-cob-birth-date (7:4) = spaces
  4152        move zeros               to ws-rate-cob-birth-date
  4153     end-if
  4154     move ws-rate-cob-birth-date (7:4)
  4155                                 to ws-work-date (1:4)
  4156     move ws-rate-cob-birth-date (1:2)
  4157                                 to ws-work-date (5:2)
  4158     move ws-rate-cob-birth-date (4:2)
  4159                                 to ws-work-date (7:2)
  4160     move low-values             to ws-bin-cob-birth-dt
  4161     if ws-work-date-num not = zeros
  4162        move ws-work-date-num    to dc-greg-date-cymd
  4163        move 'L'                 to dc-option-code
  4164        perform 9700-date-link   thru 9700-exit
  4165        if no-conversion-error
  4166           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4167        else
  4168           move 3                to ws-error-sub
  4169           move '- Cob DOB '     to ws-error-sup
  4170           perform 0180-error-handle
  4171                                 thru 0180-exit
  4172           go to 0300-RETURN-CICS
  4173        end-if
  4174     end-if
  4175**==============================================================**
  4176**                                                              **
  4177**  Calculate primary borrowers age.                            **
  4178**                                                              **
  4179**==============================================================**
  4180     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4181     move ws-bin-eff-dt          to dc-bin-date-2
  4182     move '1'                    to dc-option-code
  4183     perform 9700-date-link      thru 9700-exit
  4184     if no-conversion-error
  4185        compute ws-issue-age = dc-elapsed-months / +12
  4186     else
  4187        move 3                   to ws-error-sub
  4188        move '- Pri DOB '        to ws-error-sup
  4189        perform 0180-error-handle
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  74
* WSMESS01.cbl
  4190                                 thru 0180-exit
  4191        go to 0300-RETURN-CICS
  4192     end-if
  4193**==============================================================**
  4194**                                                              **
  4195**  Calculate co borrowers age.                                 **
  4196**                                                              **
  4197**==============================================================**
  4198     move zeros                  to ws-cob-age
  4199     if ws-bin-cob-birth-dt not = low-values
  4200        move ws-bin-cob-birth-dt to dc-bin-date-1
  4201        move ws-bin-eff-dt       to dc-bin-date-2
  4202        move '1'                 to dc-option-code
  4203        perform 9700-date-link   thru 9700-exit
  4204        if no-conversion-error
  4205           compute ws-cob-age = dc-elapsed-months / +12
  4206        else
  4207           move 3                to ws-error-sub
  4208           move '- Cob DOB '     to ws-error-sup
  4209           perform 0180-error-handle
  4210                                 thru 0180-exit
  4211           go to 0300-RETURN-CICS
  4212        end-if
  4213     end-if
  4214     move ws-issue-age           to ws-rate-age
  4215     if ws-cob-age > ws-rate-age
  4216        move ws-cob-age          to ws-rate-age
  4217     end-if
  4218**==============================================================**
  4219**                                                              **
  4220**  Calculate extension days.                                   **
  4221**                                                              **
  4222**==============================================================**
  4223     move zeros                  to ws-extension-days
  4224     move ws-bin-eff-dt          to dc-bin-date-1
  4225     move ws-bin-1st-pmt-dt      to dc-bin-date-2
  4226     move '1'                    to dc-option-code
  4227     perform 9700-date-link      thru 9700-exit
  4228     if no-conversion-error
  4229        if dc-elapsed-days > 31
  4230           compute ws-extension-days =
  4231              dc-elapsed-days - 30
  4232        end-if
  4233     end-if
  4234**==============================================================**
  4235**                                                              **
  4236**  Validate passed total of payments. loan term * payment      **
  4237**                                                              **
  4238**==============================================================**
  4239     compute ws-calc-tot-pmts =
  4240        ws-rate-loan-term * ws-rate-payment
  4241     if ((ws-calc-tot-pmts - ws-rate-tot-pmts) > 1.00)
  4242                     or
  4243        ((ws-rate-tot-pmts - ws-calc-tot-pmts) > 1.00)
  4244*    if ws-calc-tot-pmts <> ws-rate-tot-pmts
  4245        move 17                  to ws-error-sub
  4246        move spaces              to ws-error-sup
  4247        perform 0180-error-handle
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  75
* WSMESS01.cbl
  4248                                 thru 0180-exit
  4249        go to 0300-RETURN-CICS
  4250     end-if
  4251     .
  4252 0020-exit.
  4253     exit.
  4254 0025-assign-ben-cd.
  4255     if not connected-to-db
  4256        perform 6000-connect-to-db thru 6000-exit
  4257     end-if
  4258
  4259     if ws-rate-benefit-type = 'A'
  4260        go to 0025-get-ah-ben
  4261     end-if
  4262
  4263     move ws-rate-state          to ws-sbc-state
  4264     evaluate true
  4265        when raw-ben-code (1:1) = 'N'
  4266           move 'NP'             to ws-sbc-cov-type
  4267        when raw-ben-code (1:1) = 'T'
  4268           move 'NT'             to ws-sbc-cov-type
  4269        when raw-ben-code (1:1) = 'L'
  4270           move 'LL'             to ws-sbc-cov-type
  4271        when other
  4272           move 'GP'             to ws-sbc-cov-type
  4273     end-evaluate
  4274
  4275     move ws-rate-sin-jnt-ind    to ws-sbc-sin-jnt
  4276     move ws-rate-dismemberment  to ws-sbc-dismember
  4277
  4278     EXEC SQL
  4279        SELECT
  4280           LogicBenCode
  4281        INTO
  4282           :ws-sbc-logic-ben-code
  4283        FROM
  4284           BenefitCodeMapping
  4285        WHERE
  4286           State           = :ws-sbc-state
  4287           and CovType     = :ws-sbc-cov-type
  4288           and SinJnt      = :ws-sbc-sin-jnt
  4289           and Dismem      = :ws-sbc-dismember
  4290     end-exec
  4291
  4292     if sqlcode not = 0
  4293        display "Error: cannot find lf benefit code "
  4294           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4295           ' ' ws-sbc-dismember
  4296        display ' sql return code ' sqlcode
  4297        display ' sql err mess    ' sqlerrmc
  4298        move 19                  to ws-error-sub
  4299        move spaces              to ws-error-sup
  4300        string
  4301           ws-sbc-state ' '
  4302           ws-sbc-cov-type ' '
  4303           ws-sbc-sin-jnt ' '
  4304           ws-sbc-dismember
  4305           delimited by size into ws-error-sup
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  76
* WSMESS01.cbl
  4306        perform 0180-error-handle
  4307                                 thru 0180-exit
  4308        go to 0300-return-cics
  4309     end-if
  4310
  4311     move ws-sbc-logic-ben-code  to ws-rate-benefit-cd
  4312     go to 0025-exit
  4313
  4314     .
  4315 0025-get-ah-ben.
  4316
  4317     move ws-rate-state          to ws-sbc-state
  4318     move 'DI'                   to ws-sbc-cov-type
  4319     move ws-rate-sin-jnt-ind    to ws-sbc-sin-jnt
  4320     move ws-rate-retro-elim     to ws-sbc-retroelim
  4321     move ws-rate-waiting-days   to ws-sbc-wait-days
  4322     move ws-rate-crit-per       to ws-sbc-max-bens
  4323
  4324     EXEC SQL
  4325        SELECT
  4326           LogicBenCode
  4327        INTO
  4328           :ws-sbc-logic-ben-code
  4329        FROM
  4330           BenefitCodeMapping
  4331        WHERE
  4332           State           = :ws-sbc-state
  4333           and CovType     = :ws-sbc-cov-type
  4334           and SinJnt      = :ws-sbc-sin-jnt
  4335           and RetroElim   = :ws-sbc-retroelim
  4336           and WaitDays    = :ws-sbc-wait-days
  4337           and MaxBens     = :ws-sbc-max-bens
  4338     end-exec
  4339
  4340     if sqlcode not = 0
  4341        display "Error: cannot find ah benefit code "
  4342           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4343           ' ' ws-sbc-retroelim ' ' ws-sbc-wait-days ' '
  4344           ws-sbc-max-bens
  4345
  4346        display ' sql return code ' sqlcode
  4347        display ' sql err mess    ' sqlerrmc
  4348        move 20                  to ws-error-sub
  4349        move spaces              to ws-error-sup
  4350        string
  4351           ws-sbc-state ' '
  4352           ws-sbc-cov-type ' '
  4353           ws-sbc-sin-jnt ' '
  4354           ws-sbc-retroelim ' '
  4355           ws-sbc-wait-days ' '
  4356           ws-sbc-max-bens
  4357           delimited by size into ws-error-sup
  4358        perform 0180-error-handle
  4359                                 thru 0180-exit
  4360        go to 0300-return-cics
  4361     end-if
  4362
  4363     move ws-sbc-logic-ben-code  to ws-rate-benefit-cd
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  77
* WSMESS01.cbl
  4364     .
  4365 0025-exit.
  4366     exit.
  4367 0030-get-rate.
  4368*    move spaces                 to calculation-pass-area
  4369     move zeros                  to cp-r-max-mon-ben
  4370                                    cp-r-max-tot-ben
  4371                                    cp-rate-dev-pct
  4372                                    cp-original-premium
  4373                                    cp-critical-months
  4374     move ws-extension-days      to cp-term-or-ext-days
  4375     move am-cal-table           to cp-class-CODE
  4376     if ws-rate-benefit-type = 'L'
  4377        move am-lf-deviation     to cp-deviation-code
  4378        if raw-ben-code (1:1) = 'N' or 'T'
  4379           move ws-rate-benefit  to cp-original-benefit
  4380                                    cp-rating-benefit-amt
  4381        else
  4382           move ws-rate-tot-pmts to cp-original-benefit
  4383                                    cp-rating-benefit-amt
  4384        end-if
  4385     else
  4386        move am-ah-deviation     to cp-deviation-code
  4387        move ws-rate-benefit     to cp-original-benefit
  4388                                    cp-rating-benefit-amt
  4389     end-if
  4390     move ws-rate-state          to cp-state
  4391                                    cp-state-std-abbrv
  4392     move ws-rate-benefit-type   to cp-benefit-type
  4393     move ws-rate-benefit-cd     to cp-benefit-cd
  4394     move ws-rate-age            to cp-issue-age
  4395     move ws-comp-id             to cp-company-id
  4396     move ws-comp-cd             to cp-company-cd
  4397     move ws-rate-apr            to cp-loan-apr
  4398     if ws-rate-loan-term = zeros
  4399        move ws-rate-ins-term    to ws-rate-loan-term
  4400     end-if
  4401     move ws-rate-ins-term       to cp-original-term
  4402     move ws-rate-loan-term      to cp-loan-term
  4403     move 'L'                    to cp-life-override-code
  4404     move 'A'                    to cp-ah-override-code
  4405     move '3'                    to cp-process-type
  4406     move ws-rate-earn-meth      to cp-earning-method
  4407                                    cp-rating-method
  4408     move 'R'                    to cp-rate-file
  4409     move ws-bin-eff-dt          to cp-cert-eff-dt
  4410     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4411     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4412     if (no-cp-error)
  4413        or (cp-return-code = '8' or '9' or 'A' or 'B' or 'C')
  4414        move '0'                 to cp-return-code
  4415        if ((cp-calc-premium - ws-rate-premium) > 9.99)
  4416                        or
  4417           ((ws-rate-premium - cp-calc-premium) > 9.99)
  4418           move 'Z'              to cp-return-code
  4419        end-if
  4420     end-if
  4421**==============================================================**
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  78
* WSMESS01.cbl
  4422**                                                              **
  4423** The below code will change as we add more states and forms   **
  4424** to this process.                                             **
  4425**                                                              **
  4426**==============================================================**
  4427     move cp-original-benefit    to ws-max-benefit
  4428     .
  4429 0030-exit.
  4430     exit.
  4431 0040-format-buffer.
  4432     move spaces                 to ws-return-string
  4433     perform 0045-format-error   thru 0045-exit
  4434     move ';'                    to ws-sc1
  4435                                    ws-sc2
  4436                                    ws-sc3
  4437                                    ws-sc4
  4438                                    ws-sc5
  4439                                    ws-sc6
  4440                                    ws-sc7
  4441     if no-cp-error
  4442        if ws-contract-suffix = spaces or low-values
  4443           move ws-contract-no   to ws-return-contract-no (2:10)
  4444        else
  4445           move ws-contract-no   to ws-return-contract-no (1:10)
  4446           move ws-contract-suffix
  4447                                 to ws-return-contract-no (11:1)
  4448        end-if
  4449        move cp-calc-premium     to ws-return-prem
  4450        move cp-premium-rate     to ws-return-rate
  4451        move ws-max-benefit      to ws-return-max-ben
  4452        move ws-exp-date         to ws-return-exp-dt
  4453        move ws-rate-benefit-cd  to ws-return-benefit-cd
  4454     else
  4455        set error-in-one-coverage to true
  4456        move spaces              to ws-contract-no
  4457                                    ws-contract-suffix
  4458     end-if
  4459     .
  4460 0040-exit.
  4461     exit.
  4462 0045-format-error.
  4463     evaluate true
  4464        when cp-return-code = '0'
  4465           move +1               to s1
  4466        when cp-return-code = '1'
  4467           move +2               to s1
  4468        when cp-return-code = '2'
  4469           move +3               to s1
  4470        when cp-return-code = 'A'
  4471           move +4               to s1
  4472        when cp-return-code = 'B'
  4473           move +5               to s1
  4474        when cp-return-code = '4'
  4475           move +6               to s1
  4476        when cp-return-code = '9'
  4477           move +7               to s1
  4478        when cp-return-code = '8'
  4479           move +8               to s1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  79
* WSMESS01.cbl
  4480        when cp-return-code = 'H'
  4481           move +9               to s1
  4482        when cp-return-code = 'C'
  4483           move +10              to s1
  4484        when cp-return-code = '7'
  4485           move +11              to s1
  4486        when cp-return-code = '6'
  4487           move +12              to s1
  4488        when cp-return-code = 'D'
  4489           move +13              to s1
  4490        when cp-return-code = 'Z'
  4491           move +14              to s1
  4492           move cp-calc-premium  to ws-return-prem
  4493           move cp-premium-rate  to ws-return-rate
  4494           move ws-max-benefit   to ws-return-max-ben
  4495           move ws-exp-date      to ws-return-exp-dt
  4496           move ws-rate-benefit-cd to ws-return-benefit-cd
  4497        when cp-return-code = 'Y'
  4498           move +15              to s1
  4499           move cp-calc-premium  to ws-return-prem
  4500           move cp-premium-rate  to ws-return-rate
  4501           move ws-max-benefit   to ws-return-max-ben
  4502           move ws-exp-date      to ws-return-exp-dt
  4503           move ws-rate-benefit-cd to ws-return-benefit-cd
  4504     end-evaluate
  4505     move ws-table-error-no (s1) to ws-return-error-no
  4506     move ws-table-error-mess (s1)
  4507                                 to ws-return-error-mess
  4508     .
  4509 0045-exit.
  4510     exit.
  4511 0050-get-account.
  4512     move ws-comp-cd             to ws-am-company-cd
  4513     move '9'                    to ws-am-carrier
  4514     move '000000'               to ws-am-group
  4515     move ws-rate-state          to ws-am-state
  4516     move ws-rate-acct-no        to ws-am-account
  4517     move ws-bin-eff-dt          to ws-am-exp-dt
  4518
  4519* exec cics read
  4520*       dataset      ('ERACCT')
  4521*       ridfld       (ws-am-key)
  4522*       into         (account-master)
  4523*       GTEQ
  4524*       resp         (ws-response)
  4525*    end-exec
  4526     MOVE LENGTH OF
  4527      account-master
  4528       TO DFHEIV11
  4529     MOVE 'ERACCT' TO DFHEIV1
  4530*    MOVE '&"IL       G          (  N#00004421' TO DFHEIV0
  4531     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4533     MOVE X'204E233030303034343231' TO DFHEIV0(25:11)
  4534     CALL 'kxdfhei1' USING DFHEIV0,
  4535           DFHEIV1,
  4536           account-master,
  4537           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  80
* WSMESS01.cbl
  4538           ws-am-key,
  4539           DFHEIV99,
  4540           DFHEIV99,
  4541           DFHEIV99
  4542     MOVE EIBRESP  TO ws-response
  4543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4544     if resp-normal
  4545        and (ws-comp-cd = am-company-cd)
  4546        and (ws-rate-state = am-state)
  4547        and (ws-rate-acct-no = am-account)
  4548        and (ws-bin-eff-dt >= am-effective-dt)
  4549        and (ws-bin-eff-dt < am-expiration-dt)
  4550        continue
  4551     else
  4552        move '0114;No account mstr found ' to ws-return-string
  4553        go to 0300-RETURN-CICS
  4554     end-if
  4555     move am-comment-line (1)    to ws-form-limit-name
  4556     move spaces                 to ws-limit-name
  4557     perform varying l1 from +50 by -1 until
  4558        (l1 < +1)
  4559        or (ws-form-limit-name (l1:1) <> ' ')
  4560     end-perform
  4561     if l1 > +3
  4562        perform varying l1 from l1 by -1 until
  4563           (l1 < +1)
  4564           or (ws-form-limit-name (l1:1) = ' ')
  4565        end-perform
  4566        if l1 > +3
  4567           subtract +1 from l1
  4568           move ws-form-limit-name (1:l1)
  4569                                 to ws-limit-name
  4570        end-if
  4571     end-if
  4572     .
  4573 0050-exit.
  4574     exit.
  4575 0060-check-for-dup.
  4576**==============================================================**
  4577**                                                              **
  4578**    All i'm going to do here is check for a dup using         **
  4579**  the state, account, eff dt and last six of vin and a space  **
  4580**  in the cert suffix. If I do find one then I will have to    **
  4581**  find the last suffix and use the next available one in the  **
  4582**  suffix table.                                               **
  4583**                                                              **
  4584**==============================================================**
  4585     move +1                     to x1
  4586     move ' '                    to ws-browse-sw
  4587     move ws-comp-cd             to ws-cm-key
  4588     move '9'                    to ws-cm-carrier
  4589     move '000000'               to ws-cm-group
  4590     move ws-rate-state          to ws-cm-state
  4591     move ws-rate-acct-no        to ws-cm-account
  4592     move ws-bin-eff-dt          to ws-cm-eff-dt
  4593     string
  4594        '0000'
  4595        ws-rate-vin (12:6)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  81
* WSMESS01.cbl
  4596        ' ' delimited by size into ws-cm-cert-no
  4597     end-string
  4598     move ws-cm-key              to ws-cm-compare-key
  4599     move ws-cm-cert-ten         to ws-contract-no
  4600     move low-values             to ws-last-suffix
  4601
  4602* exec cics startbr
  4603*       dataset      ('ELCERT')
  4604*       ridfld       (ws-cm-key)
  4605*       gteq
  4606*       resp         (ws-response)
  4607*    end-exec
  4608     MOVE 'ELCERT' TO DFHEIV1
  4609     MOVE 0
  4610       TO DFHEIV11
  4611*    MOVE '&,         G          &  N#00004485' TO DFHEIV0
  4612     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4614     MOVE X'204E233030303034343835' TO DFHEIV0(25:11)
  4615     CALL 'kxdfhei1' USING DFHEIV0,
  4616           DFHEIV1,
  4617           ws-cm-key,
  4618           DFHEIV99,
  4619           DFHEIV11,
  4620           DFHEIV99
  4621     MOVE EIBRESP  TO ws-response
  4622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4623     evaluate true
  4624        when resp-normal
  4625           set browse-started to true
  4626        when resp-notfnd or resp-endfile
  4627           set i-say-stop to true
  4628        when other
  4629           move ws-response to ws-disp-resp
  4630           string
  4631              '9999' ';'
  4632              'Bad elcert startbr ' ';'
  4633              ws-disp-resp delimited by size
  4634                                 into ws-return-string
  4635           end-string
  4636           display ' something went wrong with start br '
  4637              ws-response
  4638           go to 0300-RETURN-CICS
  4639     end-evaluate
  4640     perform until i-say-stop
  4641
  4642* exec cics readnext
  4643*          dataset      ('ELCERT')
  4644*          ridfld       (ws-cm-key)
  4645*          into         (certificate-master)
  4646*          resp         (ws-response)
  4647*       end-exec
  4648     MOVE LENGTH OF
  4649      certificate-master
  4650       TO DFHEIV12
  4651     MOVE 'ELCERT' TO DFHEIV1
  4652     MOVE 0
  4653       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  82
* WSMESS01.cbl
  4654*    MOVE '&.IL                  )  N#00004509' TO DFHEIV0
  4655     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4656     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4657     MOVE X'204E233030303034353039' TO DFHEIV0(25:11)
  4658     CALL 'kxdfhei1' USING DFHEIV0,
  4659           DFHEIV1,
  4660           certificate-master,
  4661           DFHEIV12,
  4662           ws-cm-key,
  4663           DFHEIV99,
  4664           DFHEIV11,
  4665           DFHEIV99,
  4666           DFHEIV99
  4667     MOVE EIBRESP  TO ws-response
  4668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4669        if resp-normal
  4670           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  4671              move ws-cm-cert-suffix
  4672                                 to ws-last-suffix
  4673           else
  4674              set i-say-stop to true
  4675           end-if
  4676        else
  4677           set i-say-stop to true
  4678        end-if
  4679     end-perform
  4680     if browse-started
  4681
  4682* exec cics endbr
  4683*          dataset   ('ELCERT')
  4684*       END-EXEC
  4685     MOVE 'ELCERT' TO DFHEIV1
  4686     MOVE 0
  4687       TO DFHEIV11
  4688*    MOVE '&2                    $   #00004527' TO DFHEIV0
  4689     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4691     MOVE X'2020233030303034353237' TO DFHEIV0(25:11)
  4692     CALL 'kxdfhei1' USING DFHEIV0,
  4693           DFHEIV1,
  4694           DFHEIV11,
  4695           DFHEIV99
  4696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4697     end-if
  4698     if ws-last-suffix not = low-values
  4699        perform varying x1 from +1 by +1 until
  4700           (x1 > +26)
  4701           or (ws-last-suffix = ws-suffix-value (x1))
  4702        end-perform
  4703        if x1 < +27
  4704           move ws-suffix-value (x1 + 1)
  4705                                 to ws-contract-suffix
  4706        else
  4707           display ' more than 26 suffix codes ' ws-last-suffix
  4708           move 15               to ws-error-sub
  4709           move spaces           to ws-error-sup
  4710           perform 0180-error-handle
  4711                                 thru 0180-exit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  83
* WSMESS01.cbl
  4712           go to 0300-return-cics
  4713        end-if
  4714     end-if
  4715     .
  4716 0060-exit.
  4717     exit.
  4718 0070-open-cursor.
  4719*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  4720***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4721***                                                            ***
  4722***  The dates on the sql table have values in the time        ***
  4723***  so I convert it to a string and just use mm/dd/yyyy       ***
  4724***  to perform the comparison.                                ***
  4725***                                                            ***
  4726***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4727     if not connected-to-db
  4728        perform 6000-connect-to-db thru 6000-exit
  4729     end-if
  4730     move ws-rate-state          to ws-dealer-state
  4731     move ws-rate-acct-no        to ws-dealer-id
  4732     move ws-rate-eff-date       to ws-contract-eff-dt
  4733     move zeros                  to ws-ks-contract-no
  4734     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  4735     EXEC SQL
  4736        DECLARE
  4737           contracts cursor for
  4738        SELECT
  4739           DlrState,
  4740           DlrId,
  4741           EffDt,
  4742           ContractNo,
  4743           ContractSuffix
  4744        FROM
  4745           PendingContracts
  4746        WHERE
  4747           DlrState     = :ws-dealer-state
  4748           and DlrId    = :ws-dealer-id
  4749           and EffDt    = :ws-contract-eff-dt
  4750           and ContractNo  = :ws-ks-contract-no
  4751        ORDER BY
  4752           dlrstate,
  4753           dlrid,
  4754           effdt,
  4755           contractno,
  4756           contractsuffix
  4757     end-exec
  4758     if sqlcode not = 0
  4759        display "Error: cannot declare cursor "
  4760        display ' sql retrun code ' sqlcode
  4761        display ' sql err mess    ' sqlerrmc
  4762        go to 0070-exit
  4763     end-if
  4764     EXEC SQL
  4765        open contracts
  4766     END-EXEC
  4767     if sqlcode not = 0
  4768        display "Error: cannot open cursor "
  4769        display ' sql retrun code ' sqlcode
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  84
* WSMESS01.cbl
  4770        display ' sql err mess    ' sqlerrmc
  4771        go to 0070-exit
  4772     end-if
  4773     .
  4774 0070-exit.
  4775     exit.
  4776 0080-process-input.
  4777     perform until sqlcode not = 0
  4778        EXEC SQL
  4779           fetch contracts into
  4780              :sql-dlr-state,
  4781              :sql-dlr-id,
  4782              :sql-eff-dt,
  4783              :sql-contr-no,
  4784              :sql-contr-suffix
  4785        END-EXEC
  4786        if sqlcode = 0
  4787           move sql-contr-suffix to ws-tbl-last-suffix
  4788        else
  4789           if sqlcode not = 0 and 100
  4790              display "Error: cannot fetch row "
  4791              display ' sql return code ' sqlcode
  4792              display ' sql err mess    ' sqlerrmc
  4793           end-if
  4794        end-if
  4795     end-perform
  4796     if ws-tbl-last-suffix not = low-values
  4797        and (ws-tbl-last-suffix > ws-last-suffix)
  4798        perform varying x1 from +1 by +1 until
  4799           (x1 > +26)
  4800           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  4801        end-perform
  4802        if x1 < +27
  4803           move ws-suffix-value (x1 + 1)
  4804                                 to ws-contract-suffix
  4805        else
  4806           display ' more than 26 suffix codes ' ws-last-suffix
  4807           move 15               to ws-error-sub
  4808           move spaces           to ws-error-sup
  4809           perform 0180-error-handle
  4810                                 thru 0180-exit
  4811           go to 0300-return-cics
  4812        end-if
  4813     end-if
  4814     EXEC SQL
  4815         close contracts
  4816     END-EXEC
  4817     if sqlcode not = 0
  4818        display "Error: cannot close cursor "
  4819        display ' sql retrun code ' sqlcode
  4820        display ' sql err mess    ' sqlerrmc
  4821     end-if
  4822     .
  4823 0080-exit.
  4824     exit.
  4825 0090-check-qc-lf-limits.
  4826
  4827     if not connected-to-db
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  85
* WSMESS01.cbl
  4828        perform 6000-connect-to-db thru 6000-exit
  4829     end-if
  4830
  4831     if ws-rate-ben-code (1:1) = 'L'
  4832        move 'LL'                to ws-limit-cov-type
  4833     else
  4834        move 'RL'                to ws-limit-cov-type
  4835     end-if
  4836
  4837     move ws-rate-age            to ws-limit-issue-age
  4838
  4839     EXEC SQL
  4840        SELECT distinct top 1
  4841           AttainedAge,
  4842           MaxTerm,
  4843           MaxTotBen
  4844        INTO
  4845           :ws-limit-att-age,
  4846           :ws-limit-max-term,
  4847           :ws-limit-max-tot-ben
  4848        FROM
  4849           FormLimits
  4850        WHERE
  4851           Limit           = :ws-limit-name
  4852           and CovType     = :ws-limit-cov-type
  4853           and LoIssueAge <= :ws-limit-issue-age
  4854           and HiIssueAge >= :ws-limit-issue-age
  4855     end-exec
  4856
  4857     if sqlcode not = 0
  4858        display "Error: cannot find lf limits " ws-limit-name ' '
  4859        ws-limit-cov-type ' ' ws-limit-issue-age
  4860        display ' sql retrun code ' sqlcode
  4861        display ' sql err mess    ' sqlerrmc
  4862        move 18                  to ws-error-sub
  4863        move ws-limit-name       to ws-error-sup
  4864        perform 0180-error-handle
  4865                                 thru 0180-exit
  4866        go to 0300-return-cics
  4867     end-if
  4868
  4869     if ws-rate-benefit <= ws-limit-max-tot-ben
  4870        continue
  4871     else
  4872        move 8                   to ws-error-sub
  4873        move '- Lf Benefit '     to ws-error-sup
  4874        perform 0180-error-handle
  4875                                 thru 0180-exit
  4876        go to 0300-return-cics
  4877     end-if
  4878
  4879     if ws-rate-ins-term <= ws-limit-max-term
  4880        continue
  4881     else
  4882        move 7                   to ws-error-sub
  4883        move '- Lf Term '        to ws-error-sup
  4884        perform 0180-error-handle
  4885                                 thru 0180-exit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  86
* WSMESS01.cbl
  4886        go to 0300-return-cics
  4887     end-if
  4888     if ws-att-age <= ws-limit-att-age
  4889        continue
  4890     else
  4891        move 5                   to ws-error-sub
  4892        move ws-att-age          to ws-error-sup
  4893        perform 0180-error-handle
  4894                                 thru 0180-exit
  4895        go to 0300-return-cics
  4896     end-if
  4897
  4898     .
  4899 0090-exit.
  4900     exit.
  4901
  4902 0095-check-qc-ah-limits.
  4903
  4904     if not connected-to-db
  4905        perform 6000-connect-to-db thru 6000-exit
  4906     end-if
  4907
  4908     move 'DI'                   to ws-limit-cov-type
  4909     move ws-rate-age            to ws-limit-issue-age
  4910
  4911     EXEC SQL
  4912        SELECT
  4913           AttainedAge,
  4914           MaxTerm,
  4915           MaxMoBen,
  4916           MaxTotBen
  4917        INTO
  4918           :ws-limit-att-age,
  4919           :ws-limit-max-term,
  4920           :ws-limit-max-mo-ben,
  4921           :ws-limit-max-tot-ben
  4922        FROM
  4923           FormLimits
  4924        WHERE
  4925           Limit           = :ws-limit-name
  4926           and CovType     = :ws-limit-cov-type
  4927           and LoIssueAge <= :ws-limit-issue-age
  4928           and HiIssueAge >= :ws-limit-issue-age
  4929     end-exec
  4930
  4931     if sqlcode not = 0
  4932        display "Error: cannot find ah limits " ws-limit-name
  4933        display ' sql retrun code ' sqlcode
  4934        display ' sql err mess    ' sqlerrmc
  4935        move 18                  to ws-error-sub
  4936        move ws-limit-name       to ws-error-sup
  4937        perform 0180-error-handle
  4938                                 thru 0180-exit
  4939        go to 0300-return-cics
  4940     end-if
  4941
  4942     if ws-rate-benefit <= ws-limit-max-mo-ben
  4943        continue
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  87
* WSMESS01.cbl
  4944     else
  4945        move 8                   to ws-error-sub
  4946        move '- Ah Benefit '     to ws-error-sup
  4947        perform 0180-error-handle
  4948                                 thru 0180-exit
  4949        go to 0300-return-cics
  4950     end-if
  4951
  4952     if (ws-rate-benefit * ws-rate-ins-term)
  4953           <= ws-limit-max-tot-ben
  4954        continue
  4955     else
  4956        move 10                  to ws-error-sub
  4957        move '- Ah Tot Benefit ' to ws-error-sup
  4958        perform 0180-error-handle
  4959                                 thru 0180-exit
  4960        go to 0300-return-cics
  4961     end-if
  4962
  4963     if ws-rate-ins-term <= ws-limit-max-term
  4964        continue
  4965     else
  4966        move 7                   to ws-error-sub
  4967        move '- Ah Term '        to ws-error-sup
  4968        perform 0180-error-handle
  4969                                 thru 0180-exit
  4970        go to 0300-return-cics
  4971     end-if
  4972     if ws-att-age <= ws-limit-att-age
  4973        continue
  4974     else
  4975        move 5                   to ws-error-sub
  4976        move ws-att-age          to ws-error-sup
  4977        perform 0180-error-handle
  4978                                 thru 0180-exit
  4979        go to 0300-return-cics
  4980     end-if
  4981
  4982     .
  4983 0095-exit.
  4984     exit.
  4985 0110-unstring.
  4986***____________________________________________________________***
  4987**|                                                            |**
  4988**|    Unstring the raw data into data elements                |**
  4989**|                                                            |**
  4990***____________________________________________________________***
  4991        unstring dfhcommarea
  4992           delimited by '|' into
  4993              raw-message-num
  4994              raw-state
  4995              raw-acct-no
  4996              raw-vin
  4997              raw-lf-ah
  4998              raw-ben-code
  4999              raw-earn-meth
  5000              raw-pri-birth-date
  5001              raw-cob-birth-date
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  88
* WSMESS01.cbl
  5002              raw-benefit
  5003              raw-eff-date
  5004              raw-1st-pmt-dt
  5005              raw-premium
  5006              raw-loan-term
  5007              raw-ins-term
  5008              raw-apr
  5009              raw-sin-jnt-ind
  5010              raw-dismemberment
  5011              raw-retro-elim
  5012              raw-waiting-days
  5013              raw-crit-per
  5014              raw-total-payments
  5015              raw-period-payment
  5016        end-unstring
  5017     .
  5018 0110-exit.
  5019     exit.
  5020 0120-format-message.
  5021***____________________________________________________________***
  5022**|                                                            |**
  5023**|    Format each data element to be consistant with          |**
  5024**|  COBOL rate copybook model                                 |**
  5025**|                                                            |**
  5026***____________________________________________________________***
  5027     inspect
  5028        raw-acct-no replacing leading spaces by zeros
  5029     inspect
  5030        raw-loan-term replacing leading spaces by zeros
  5031     inspect
  5032        raw-ins-term replacing leading spaces by zeros
  5033     inspect
  5034        raw-waiting-days replacing leading spaces by zeros
  5035     inspect
  5036        raw-crit-per replacing leading spaces by zeros
  5037     inspect
  5038        raw-benefit replacing all spaces by zeros
  5039     inspect
  5040        raw-premium replacing all spaces by zeros
  5041     inspect
  5042        raw-apr replacing all spaces by zeros
  5043     inspect
  5044        raw-total-payments replacing all spaces by zeros
  5045     inspect
  5046        raw-period-payment replacing all spaces by zeros
  5047     move raw-benefit            to ws-work-in
  5048     perform 0130-format-amt     thru 0130-exit
  5049     move ws-work-out-v2         to ws-rate-benefit
  5050*    display ' ben  in *' ws-work-in '*'
  5051*    display ' ben  out *' ws-work-out '*'
  5052     move raw-total-payments     to ws-work-in
  5053     perform 0130-format-amt     thru 0130-exit
  5054     move ws-work-out-v2         to ws-rate-tot-pmts
  5055*    display ' tot pmts  in *' ws-work-in '*'
  5056*    display ' tot pmts  out *' ws-work-out '*'
  5057     move raw-premium            to ws-work-in
  5058     perform 0130-format-amt     thru 0130-exit
  5059     move ws-work-out-v2         to ws-rate-premium
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  89
* WSMESS01.cbl
  5060*    display ' prem in *' ws-work-in '*'
  5061*    display ' prem out *' ws-work-out '*'
  5062     move raw-period-payment     to ws-work-in
  5063     perform 0130-format-amt     thru 0130-exit
  5064     move ws-work-out-v2         to ws-rate-payment
  5065*    display ' pmt  in *' ws-work-in '*'
  5066*    display ' pmt  out *' ws-work-out '*'
  5067     move raw-loan-term          to ws-work-in
  5068     perform 0140-format-term    thru 0140-exit
  5069     move ws-work-out-v0         to ws-rate-loan-term
  5070*    display ' rate loan term *' ws-rate-loan-term '*'
  5071*    display ' ln term in *' ws-work-in '*'
  5072*    display ' ln term out *' ws-work-out '*'
  5073     move raw-ins-term           to ws-work-in
  5074     perform 0140-format-term    thru 0140-exit
  5075     move ws-work-out-v0         to ws-rate-ins-term
  5076*    display ' rate ins  term *' ws-rate-ins-term '*'
  5077*    display ' ins term in *' ws-work-in '*'
  5078*    display ' ins term out *' ws-work-out '*'
  5079     move raw-waiting-days       to ws-work-in
  5080     perform 0140-format-term    thru 0140-exit
  5081     move ws-work-out-v0         to ws-rate-waiting-days
  5082*    display ' wait day in *' ws-work-in '*'
  5083*    display ' wait day out *' ws-work-out '*'
  5084     move raw-crit-per           to ws-work-in
  5085     perform 0140-format-term    thru 0140-exit
  5086     move ws-work-out-v0         to ws-rate-crit-per
  5087*    display ' crit per in *' ws-work-in '*'
  5088*    display ' crit per out *' ws-work-out '*'
  5089     move raw-apr                to ws-work-in
  5090     perform 0150-format-apr     thru 0150-exit
  5091     move ws-work-out-v5         to ws-rate-apr
  5092*    display ' ins apr  in *' ws-work-in '*'
  5093*    display ' ins apr  out *' ws-work-out '*'
  5094     move raw-state              to ws-rate-state
  5095     move raw-acct-no            to ws-rate-acct-no
  5096     move raw-vin                to ws-rate-vin
  5097     move raw-lf-ah              to ws-rate-lf-ah
  5098     move raw-ben-code           to ws-rate-ben-code
  5099     move raw-earn-meth          to ws-rate-earn-meth
  5100     move raw-pri-birth-date     to ws-rate-pri-birth-date
  5101     move raw-cob-birth-date     to ws-rate-cob-birth-date
  5102     move raw-eff-date           to ws-rate-eff-date
  5103     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  5104     move raw-sin-jnt-ind        to ws-rate-sin-jnt-ind
  5105     move raw-dismemberment      to ws-rate-dismemberment
  5106     move raw-retro-elim         to ws-rate-retro-elim
  5107     .
  5108 0120-exit.
  5109     exit.
  5110 0130-format-amt.
  5111     move zeros                  to ws-work-out
  5112     perform varying s2 from +10 by -1 until
  5113        (s2 < +1)
  5114        or (ws-work-in (s2:1) = '.')
  5115     end-perform
  5116     if s2 < +9
  5117        move ws-work-in (s2 + 1:2)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  90
* WSMESS01.cbl
  5118                              to ws-work-out (9:2)
  5119        move +8               to s3
  5120        subtract +1 from s2
  5121        perform varying s2 from s2 by -1 until
  5122           (s2 < +1)
  5123           or (s3 = 0)
  5124           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5125           subtract +1 from s3
  5126        end-perform
  5127     end-if
  5128     .
  5129 0130-exit.
  5130     exit.
  5131 0140-format-term.
  5132     move zeros                  to ws-work-out
  5133     perform varying s2 from +10 by -1 until
  5134        (s2 < +1)
  5135        or (ws-work-in (s2:1) numeric)
  5136     end-perform
  5137     if s2 > +0
  5138        move ws-work-in (s2:1)
  5139                              to ws-work-out (10:1)
  5140        move +9               to s3
  5141        subtract +1 from s2
  5142        perform varying s2 from s2 by -1 until
  5143           (s2 < +1)
  5144           or (s3 = 7)
  5145           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5146           subtract +1 from s3
  5147        end-perform
  5148     end-if
  5149     .
  5150 0140-exit.
  5151     exit.
  5152 0150-format-apr.
  5153     move zeros                  to ws-work-out
  5154     perform varying s2 from +10 by -1 until
  5155        (s2 < +1)
  5156        or (ws-work-in (s2:1) = '.')
  5157     end-perform
  5158     if s2 < +5
  5159        move ws-work-in (s2 + 1:5)
  5160                              to ws-work-out (6:5)
  5161        move +5               to s3
  5162        subtract +1 from s2
  5163        perform varying s2 from s2 by -1 until
  5164           (s2 < +1)
  5165           or (s3 = 0)
  5166           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5167           subtract +1 from s3
  5168        end-perform
  5169     end-if
  5170     .
  5171 0150-exit.
  5172     exit.
  5173 0180-error-handle.
  5174     move ws-table-error-no (ws-error-sub)
  5175                                 to ws-return-error-no
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  91
* WSMESS01.cbl
  5176     move spaces                 to ws-return-error-mess
  5177     string
  5178        ws-table-error-mess (ws-error-sub)
  5179        ws-error-sup
  5180        delimited by '  ' into ws-return-error-mess
  5181     end-string
  5182
  5183     .
  5184 0180-exit.
  5185     exit.
  5186 0300-RETURN-CICS.
  5187     perform 0400-disconnect     thru 0400-exit
  5188     move ws-return-string       to dfhcommarea
  5189
  5190* exec cics return end-exec
  5191*    MOVE '.(                    ''   #00005022' TO DFHEIV0
  5192     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5194     MOVE X'2020233030303035303232' TO DFHEIV0(25:11)
  5195     CALL 'kxdfhei1' USING DFHEIV0,
  5196           DFHEIV99,
  5197           DFHEIV99,
  5198           DFHEIV99,
  5199           DFHEIV99,
  5200           DFHEIV99,
  5201           DFHEIV99
  5202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5203
  5204* goback
  5205
  5206     MOVE '9%                    "   ' TO DFHEIV0
  5207     MOVE 'WSMESS01' TO DFHEIV1
  5208     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5209     goback
  5210     .
  5211 0300-exit.
  5212     exit.
  5213 0400-disconnect.
  5214
  5215     if connected-to-db
  5216        EXEC SQL
  5217            disconnect all
  5218        END-EXEC
  5219        move ' ' to ws-connect-sw
  5220     end-if
  5221
  5222     .
  5223 0400-exit.
  5224     exit.
  5225 6000-CONNECT-TO-DB.
  5226***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5227***                                                            ***
  5228***                                                            ***
  5229***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  5230     evaluate true
  5231        when ws-kix-myenv = 'cid1p'
  5232           MOVE 'NTCSO2_CrtManage'
  5233                                 TO SVR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  92
* WSMESS01.cbl
  5234           move 'sa'             to usr
  5235           move 'ntcso2'         to pass
  5236        when ws-kix-myenv = 'mdoff'
  5237           MOVE 'NTSQLTST2UAT_CrtManage'
  5238                                 TO SVR
  5239           move 'sa'             to usr
  5240           move 'sql2008r2'      to pass
  5241        when other
  5242           MOVE 'NTSQLTST2_CrtManage'
  5243                                 TO SVR
  5244           move 'sa'             to usr
  5245           move 'sql2008r2'      to pass
  5246     end-evaluate
  5247     string
  5248         usr delimited space
  5249         "." delimited size
  5250         pass delimited space into usr-pass
  5251     end-string
  5252     EXEC SQL
  5253        CONNECT TO :svr USER :usr-pass
  5254     END-EXEC
  5255     if sqlcode not = 0
  5256        display "Error: cannot connect to " svr
  5257        display sqlcode
  5258        display sqlerrmc
  5259     else
  5260        display ' Successful Connect ' sqlcode
  5261        set connected-to-db to true
  5262     end-if
  5263     .
  5264 6000-EXIT.
  5265     EXIT.
  5266 7000-GET-RATE.
  5267
  5268* EXEC CICS LINK
  5269*       PROGRAM ('ELRATE')
  5270*       COMMAREA (CALCULATION-PASS-AREA)
  5271*       LENGTH   (CP-COMM-LENGTH)
  5272*    END-EXEC
  5273     MOVE 'ELRATE' TO DFHEIV1
  5274*    MOVE '."C                   (   #00005081' TO DFHEIV0
  5275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5277     MOVE X'2020233030303035303831' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0,
  5279           DFHEIV1,
  5280           CALCULATION-PASS-AREA,
  5281           CP-COMM-LENGTH,
  5282           DFHEIV99,
  5283           DFHEIV99,
  5284           DFHEIV99,
  5285           DFHEIV99
  5286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5287     .
  5288 7000-EXIT.
  5289     EXIT.
  5290 9700-DATE-LINK.
  5291
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  93
* WSMESS01.cbl
  5292* EXEC CICS LINK
  5293*         PROGRAM  ('ELDATCV')
  5294*         COMMAREA (DATE-CONVERSION-DATA)
  5295*         LENGTH   (DC-COMM-LENGTH)
  5296*    END-EXEC.
  5297     MOVE 'ELDATCV' TO DFHEIV1
  5298*    MOVE '."C                   (   #00005090' TO DFHEIV0
  5299     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5301     MOVE X'2020233030303035303930' TO DFHEIV0(25:11)
  5302     CALL 'kxdfhei1' USING DFHEIV0,
  5303           DFHEIV1,
  5304           DATE-CONVERSION-DATA,
  5305           DC-COMM-LENGTH,
  5306           DFHEIV99,
  5307           DFHEIV99,
  5308           DFHEIV99,
  5309           DFHEIV99
  5310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5311
  5312 9700-EXIT.
  5313      EXIT.
  5314
  5315 9999-DFHBACK SECTION.
  5316     MOVE '9%                    "   ' TO DFHEIV0
  5317     MOVE 'WSMESS01' TO DFHEIV1
  5318     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5319     GOBACK.
  5320 9999-DFHEXIT.
  5321     IF DFHEIGDJ EQUAL 0001
  5322         NEXT SENTENCE.
  5323     MOVE '9%                    "   ' TO DFHEIV0
  5324     MOVE 'WSMESS01' TO DFHEIV1
  5325     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5326     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      144932     Code:       16416
