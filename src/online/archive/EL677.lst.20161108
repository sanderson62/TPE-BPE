* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 101216  IR2016101000002  PEMA  Fix negative amount also per DJWB
    37*  REMOVE ERROR 3445.
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    47 77  s1                          pic s999 comp-3 value +0.
    48 77  s2                          pic s999 comp-3 value +0.
    49 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    50 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-browse-sw                pic x value spaces.
    54     88  i-say-when                 value 'Y'.
    55 77  ws-delete-sw                pic x value ' '.
    56     88  row-deleted                 value 'Y'.
    57 77  ws-sql-code                 pic s9(7) value zeros.
    58 77  ws-dis-sql-code             pic -9999999 value zeros.
    59 77  ws-match-sw                 pic x  value ' '.
    60     88  found-a-match             value 'Y'.
    61 77  ws-commit-sw                pic x value ' '.
    62     88  tbl-commited                value 'Y'.
    63 01  P pointer.
    64 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    65 01  var-ptr pointer.
    66 01  env-var-len                 pic 9(4)  binary.
    67 01  rc                          pic 9(9)  binary.
    68
    69 01  WS-KIXSYS.
    70     05  WS-KIX-FIL1             PIC X(10).
    71     05  WS-KIX-APPS             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   3
* EL677.cbl
    72     05  WS-KIX-ENV              PIC X(10).
    73     05  WS-KIX-MYENV            PIC X(10).
    74     05  WS-KIX-SYS              PIC X(10).
*   75 EXEC SQL
*   76    INCLUDE SQLDA
*   77 END-EXEC
    78 01 SQLDA sync.
    79    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    80    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    81    05 SQLN                  PIC S9(4) COMP-5 value 0.
    82    05 SQLD                  PIC S9(4) COMP-5 value 0.
    83    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    84       10 SQLTYPE            PIC S9(4) COMP-5.
    85       10 SQLLEN             PIC S9(4) COMP-5.
    86$IF P64 SET
    87X      *> For 64-bit environments, ensure that SQLDATA is
    88X      *> aligned on an 8-byte boundary.
    89X      10 FILLER             PIC S9(9) COMP-5.
    90$END
    91       10 SQLDATA            USAGE POINTER.
    92       10 SQLIND             USAGE POINTER.
    93       10 SQLNAME.
    94          15 SQLNAMEL        PIC S9(4) COMP-5.
    95          15 SQLNAMEC        PIC X(30).
    96
    97* Values for SQLTYPE
    98
    99 78  ESQL-DATE-CHAR              VALUE 384.
   100 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   101 78  ESQL-DATE-REC               VALUE 386.
   102 78  ESQL-DATE-REC-NULL          VALUE 387.
   103 78  ESQL-TIME-CHAR              VALUE 388.
   104 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   105 78  ESQL-TIME-REC               VALUE 390.
   106 78  ESQL-TIME-REC-NULL          VALUE 391.
   107 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   108 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   109 78  ESQL-TIMESTAMP-REC          VALUE 394.
   110 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   111 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   112 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   113 78  ESQL-TS-OFFSET-REC          VALUE 398.
   114 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   115 78  ESQL-LONGVARBINARY          VALUE 404.
   116 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   117 78  ESQL-LONGVARCHAR            VALUE 408.
   118 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   119 78  ESQL-BINARY                 VALUE 444.
   120 78  ESQL-BINARY-NULL            VALUE 445.
   121 78  ESQL-VARBINARY              VALUE 446.
   122 78  ESQL-VARBINARY-NULL         VALUE 447.
   123 78  ESQL-VARCHAR                VALUE 448.
   124 78  ESQL-VARCHAR-NULL           VALUE 449.
   125
   126 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   127 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   128
   129 78  ESQL-CHAR                   VALUE 452.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR-NULL              VALUE 453.
   131
   132 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   133 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   134
   135 78  ESQL-DOUBLE                 VALUE 480.
   136 78  ESQL-DOUBLE-NULL            VALUE 481.
   137 78  ESQL-REAL                   VALUE 482.
   138 78  ESQL-REAL-NULL              VALUE 483.
   139 78  ESQL-DECIMAL                VALUE 484.
   140 78  ESQL-DECIMAL-NULL           VALUE 485.
   141 78  ESQL-INTEGER                VALUE 496.
   142 78  ESQL-INTEGER-NULL           VALUE 497.
   143 78  ESQL-SMALLINT               VALUE 500.
   144 78  ESQL-SMALLINT-NULL          VALUE 501.
   145 78  ESQL-TINYINT                VALUE 502.
   146 78  ESQL-TINYINT-NULL           VALUE 503.
*  147 EXEC SQL
*  148    INCLUDE SQLCA
*  149 END-EXEC
   150 01 SQLCA.
   151     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   152     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   153     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   154     05  SQLERRM.
   155         49  SQLERRML    PIC S9(4) COMP-5.
   156         49  SQLERRMC    PIC X(70).
   157     05  SQLERRP         PIC X(8).
   158     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   159     05  SQLWARN.
   160         10  SQLWARN0    PIC X.
   161         10  SQLWARN1    PIC X.
   162         10  SQLWARN2    PIC X.
   163         10  SQLWARN3    PIC X.
   164         10  SQLWARN4    PIC X.
   165         10  SQLWARN5    PIC X.
   166         10  SQLWARN6    PIC X.
   167         10  SQLWARN7    PIC X.
   168     05  SQLEXT.
   169         10  SQLWARN8    PIC X.
   170         10  SQLWARN9    PIC X.
   171         10  SQLWARN10   PIC X.
   172         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   173     05  SQLSTATE    PIC X(5).
   174 EXEC SQL
   175    BEGIN DECLARE SECTION
   176 END-EXEC
   177 01  ws-paid-bank-work-area.
   178     05  ws-pb-compid            pic x(9).
   179     05  ws-pb-check-no          pic x(10).
   180     05  ws-pb-bad-check-no      pic x(10).
   181     05  ws-check-amount         pic x(10).
   182 01  Paid-Bank-Info.
   183     05  pb-check-no             pic 9(10).
   184     05  pb-tran-type            pic x.
   185     05  pb-bank-acct-desc       pic x(50).
   186     05  pb-amount               pic x(12).
   187     05  pb-paid-date            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   5
* EL677.cbl
   188 01  ws-key-stuff.
   189     05  ws-compid               pic xxx.
   190     05  ws-carrier              pic x.
   191     05  ws-grouping             pic x(6).
   192     05  ws-state                pic xx.
   193     05  ws-account              pic x(10).
   194     05  ws-eff-date             pic x(10).
   195     05  ws-certificate          pic x(10).
   196     05  ws-cert-sfx             pic x.
   197     05  ws-seq-no               pic 999.
   198     05  ws-type                 pic x.
   199     05  ws-check-sub-type       pic x.
   200 01  sqlcmd                      pic x(1024).
   201 01  WS-MOE-DATE                 pic x(10).
   202 01  svr                         pic x(32).
   203 01  usr                         pic x(32).
   204 01  pass                        pic x(32).
   205 01  usr-pass                    pic x(64).
   206 01  ws-disp-code                pic s9(11).
   207***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   208***                                                            ***
   209***  These indicators are used to determine if a variable      ***
   210***  is passed nulls from sql. The indicator will be -1        ***
   211***  if the value on sql is nulls and +0 if the value is       ***
   212***  something other than nulls. Here is an example on how     ***
   213***  to use the indicator variables.                           ***
   214***                                                            ***
   215***     EXEC SQL                                               ***
   216***        fetch checkapp into                                 ***
   217***           :db-app-status :nu-app-status,                   ***
   218***           :db-app-by     :nu-app-by,                       ***
   219***           :db-app-date   :nu-app-date,                     ***
   220***           :db-app-batch  :nu-app-batch                     ***
   221***     END-EXEC                                               ***
   222***                                                            ***
   223***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   224 01  indicator-vaiables-for-nulls.
   225     05  nu-app-status           pic s9(4) comp value +0.
   226     05  nu-app-by               pic s9(4) comp value +0.
   227     05  nu-app-date             pic s9(4) comp value +0.
   228     05  nu-app-batch            pic s9(4) comp value +0.
   229     05  nu-fincar               pic s9(4) comp value +0.
   230 01  daily-check-request-rec.
   231     05  db-compid               pic xxx.
   232     05  db-carrier              pic x.
   233     05  db-grouping             pic x(6).
   234     05  db-state                pic xx.
   235     05  db-account              pic x(10).
   236     05  db-effdate              pic x(10).
   237     05  db-certificate          pic x(10).
   238     05  db-cert-sfx             pic x.
   239     05  db-seq-no               pic 999.
   240     05  db-type                 pic x.
   241     05  db-amount-n             pic 9(7).99.
   242     05  db-amount redefines db-amount-n
   243                                 pic x(10).
   244     05  db-checkno              pic x(15).
   245     05  db-checkdate            pic x(10).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   6
* EL677.cbl
   246     05  db-checkstatus          pic 9(5).
   247     05  db-releasebatch         pic 9(5).
   248     05  db-releasedt            pic x(10).
   249     05  db-releaseby            pic x(4).
   250     05  db-payeename1           pic x(30).
   251     05  db-payeename2           pic x(30).
   252     05  db-payeeaddr1           pic x(30).
   253     05  db-payeeaddr2           pic x(30).
   254     05  db-payeecity            pic x(30).
   255     05  db-payeest              pic xx.
   256     05  db-payeezip             pic x(10).
   257     05  db-fincar               pic x.
   258     05  db-fingrp               pic x(6).
   259     05  db-finresp              pic x(10).
   260     05  db-finacct              pic x(10).
   261     05  db-preparer             pic x(4).
   262     05  db-app-status           pic x(9).
   263     05  dp-app-status-n redefines db-app-status
   264                                 pic 9(9).
   265     05  db-app-by               pic x(20).
   266     05  db-app-date             pic x(30).
   267     05  db-app-batch            pic x(10).
   268     05  db-return-to            pic x(30).
   269     05  db-insured-name         pic x(30).
   270     05  db-check-sub-type       pic x.
   271 EXEC SQL
   272    END DECLARE SECTION
   273 END-EXEC
   274*                            COPY ELCSCTM.
   275******************************************************************
   276*                                                                *
   277*                                                                *
   278*                            ELCSCTM                             *
   279*                            VMOD=2.001                          *
   280*                                                                *
   281*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   282*                                                                *
   283******************************************************************
   284 01  SECURITY-MESSAGE.
   285     12  FILLER                          PIC X(30)
   286            VALUE '** LOGIC SECURITY VIOLATION -'.
   287     12  SM-READ                         PIC X(6).
   288     12  FILLER                          PIC X(5)
   289            VALUE ' PGM='.
   290     12  SM-PGM                          PIC X(6).
   291     12  FILLER                          PIC X(5)
   292            VALUE ' OPR='.
   293     12  SM-PROCESSOR-ID                 PIC X(4).
   294     12  FILLER                          PIC X(6)
   295            VALUE ' TERM='.
   296     12  SM-TERMID                       PIC X(4).
   297     12  FILLER                          PIC XX   VALUE SPACE.
   298     12  SM-JUL-DATE                     PIC 9(5).
   299     12  FILLER                          PIC X    VALUE SPACE.
   300     12  SM-TIME                         PIC 99.99.
   301
   302*                            COPY ELCSCRTY.
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   7
* EL677.cbl
   304*                                                                *
   305*                                                                *
   306*                            ELCSCRTY                            *
   307*                            VMOD=2.001                          *
   308*                                                                *
   309*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   310*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   311*        SAVED IN PI-SECURITY-ADDRESS.                           *
   312*                                                                *
   313******************************************************************
   314 01  SECURITY-CONTROL.
   315     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   316     12  FILLER                       PIC XX    VALUE 'SC'.
   317     12  SC-CREDIT-CODES.
   318         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   319             20  SC-CREDIT-DISPLAY    PIC X.
   320             20  SC-CREDIT-UPDATE     PIC X.
   321     12  SC-CLAIMS-CODES.
   322         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   323             20  SC-CLAIMS-DISPLAY    PIC X.
   324             20  SC-CLAIMS-UPDATE     PIC X.
   325 01  ws-dummy-erchek             pic x(600).
   326 01  filler.
   327     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   328     05  WS-CHECK-AMT-TMPX REDEFINES
   329         WS-CHECK-AMT-TMP        PIC X(10).
   330     05  ws-ind                     pic s9(4) comp value +0.
   331     05  ws-ind-red redefines ws-ind pic xx.
   332     05  ws-display-ind             pic s9(7) value zeros.
   333 01  ws-compare-erchek-key          pic x(33) value low-values.
   334 01  ws-eracct-sw                   pic x value ' '.
   335     88  eracct-found                 value 'Y'.
   336 01  ws-eracct-start-sw             pic x value ' '.
   337     88  eracct-start                 value 'Y'.
   338 01  WS-MISC-AREA.
   339     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   340     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   341     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   342
   343 01  ws-work-amt-alpha           pic x(10).
   344 01  ws-work-amt-num redefines ws-work-amt-alpha
   345                                 pic 9(8)v99.
   346 01  ws-user-defined.
   347     05  ws-user-reason         pic xxx.
   348     05  ws-user-cert-no        pic x(11).
   349     05  ws-user-name           pic x(28).
   350 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   351 01  STANDARD-AREAS.
   352     12  ws-connect-sw               pic x  value ' '.
   353         88  connected-to-db             value 'Y'.
   354     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   355     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   356     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   357     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   358     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   359     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   360     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   361     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   8
* EL677.cbl
   362     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   363     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   364     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   365     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   366     12  TIME-OUT-R  REDEFINES TIME-IN.
   367         16  FILLER                  PIC X.
   368         16  TIME-OUT                PIC 99V99.
   369         16  FILLER                  PIC XX.
   370     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   371     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   372     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   373     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   374     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   375     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   376     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   377     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   378     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   379     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   380     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   381     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   382     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   383     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   384     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   385     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   386     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   387     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   388     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   389     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   390     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   391     12  QID.
   392         16  QID-TERM                PIC X(4)    VALUE SPACES.
   393         16  FILLER                  PIC X(4)    VALUE '677A'.
   394
   395 01  WORK-AREAS.
   396     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   397     12  WS-AM-WK REDEFINES WS-AM-WORK.
   398         16  WS-AM-NUM               PIC S9(7)V99.
   399         16  WS-AM-SIGN              PIC X.
   400     12  WS-CHECK-WORK.
   401         16  FILLER                  PIC X        VALUE SPACE.
   402         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   403     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   404     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   405     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   406     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   407     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   408     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   409     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   410     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   411     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   412     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   413     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   414         WS-DT-DEEDIT-FIELD.
   415         16  FILLER                  PIC X(4).
   416         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   417     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   418     12  WS-DEEDIT-FIELD-V0          REDEFINES
   419         WS-DEEDIT-FIELD-A           PIC S9(15).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page   9
* EL677.cbl
   420
   421     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   422     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   423         88 WS-CERT-FOUND                        VALUE 'Y'.
   424         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   425     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   426         88 WS-PNDB-FOUND                        VALUE 'Y'.
   427         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   428     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   429         88  WS-PROCESS-CERT                     VALUE 'Y'.
   430     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   431         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   432     12  WS-PY-ENTRY-COMMENT.
   433         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   434         16  FILLER                  PIC X(13)   VALUE
   435            ' MISC. CHECK '.
   436         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   437         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   438     12  WS-PY-REF-COMMENT.
   439         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   440         16  FILLER                  PIC X(13)   VALUE
   441            ' REFUND PYMT '.
   442         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   443         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   444     12  WS-PY-END-COMMENT.
   445         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   446         16  FILLER                  PIC X(13)   VALUE
   447            ' ENDORSEMENT '.
   448         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   449         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   450     12  WS-PY-DED-COMMENT.
   451         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   452         16  FILLER                  PIC X(13)   VALUE
   453            ' STAT DEDUCT '.
   454         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   455         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   456     12  WS-PY-ADDL-COMMENT.
   457         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   458         16  FILLER                  PIC X(13)   VALUE
   459            ' ADDL CHARGE '.
   460         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   461         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   462     12  WS-PY-REVERSAL-COMMENT.
   463         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   464         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   465            ' VOID REFUND '.
   466         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   467         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   468     12  WS-TMS-ENTRY-COMMENT.
   469         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   470         16  FILLER                  PIC XX      VALUE SPACES.
   471         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   472     12  WS-ZIP-CODE.
   473         16  WS-ZIP-PRIME.
   474             20  WS-ZIP-PRI-1ST      PIC X.
   475                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   476             20  FILLER              PIC X(4).
   477         16  WS-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  10
* EL677.cbl
   478     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   479         16  WS-CAN-POST1-1          PIC XXX.
   480         16  WS-CAN-POST1-2.
   481             20  WS-CAN-POST-4TH     PIC X.
   482             20  FILLER              PIC XX.
   483         16  FILLER                  PIC XXX.
   484     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   485         16  WS-CAN-POST2-1          PIC XXX.
   486         16  FILLER                  PIC X.
   487         16  WS-CAN-POST2-2          PIC XXX.
   488         16  FILLER                  PIC XX.
   489
   490*                                    COPY ELCNWA.
   491*****************************************************************
   492*                                                               *
   493*                                                               *
   494*                            ELCNWA.                            *
   495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   496*                            VMOD=2.003                         *
   497*                                                               *
   498*            M O V E   N A M E   W O R K   A R E A.             *
   499*                                                               *
   500*****************************************************************.
   501
   502 01  WS-NAME-WORK-AREA.
   503     05  WS-INSURED-LAST-NAME        PIC X(15).
   504     05  WS-INSURED-1ST-NAME         PIC X(12).
   505     05  WS-INSURED-MID-INIT         PIC X.
   506
   507     05  WS-NAME-WORK.
   508         10  WS-NW                   PIC X
   509             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   510
   511     05  WS-NAME-WORK2.
   512         10  WS-NW2                  PIC X
   513             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   514                                        NWA-INDEX0.
   515
   516     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   517                                     COMP-3.
   518
   519 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   520     88  RESP-NORMAL                    VALUE +0.
   521     88  resp-file-notfnd               value +12.
   522     88  RESP-NOTFND                    VALUE +13.
   523     88  resp-duprec                    value +14.
   524     88  resp-dupkey                    value +15.
   525     88  resp-invreq                    value +16.
   526     88  RESP-NOTOPEN                   VALUE +19.
   527     88  RESP-ENDFILE                   VALUE +20.
   528     88  resp-lengtherr                 value +22.
   529 01  ACCESS-KEYS.
   530     12  ELCNTL-KEY.
   531         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   532         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   533         16 ELCNTL-ACCESS.
   534             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   535             20  FILLER              PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  11
* EL677.cbl
   536             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   537         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   538
   539     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   540
   541     12  ERACCT-KEY.
   542         16  ERACCT-CO               PIC X       VALUE SPACES.
   543         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   544         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   545         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   546         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   547         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   548         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   549
   550     12  SAVE-ERACCT-KEY.
   551         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   552         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   553         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   554         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   555         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   556         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   557         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   558
   559     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   560
   561     12  ERCOMP-KEY.
   562         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   563         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   564         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   565         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   566         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   567         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   568
   569     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   570
   571     12  ELCERT-KEY.
   572         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   573         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   574         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   575         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   576         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   577         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   578         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   579         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   580
   581     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   582
   583     12  ERPNDB-PRIMARY-KEY.
   584         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   585         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   586         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   587         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   588
   589     12  ERPNDB-ALT-KEY.
   590         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   591         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   592         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   593         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   595         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   596         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   597         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   598         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   599         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   600
   601     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   602
   603     12  ERPNDM-PRIMARY-KEY.
   604         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   605         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   606         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   607         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   608
   609     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   610
   611     12  ERCHEK-KEY.
   612         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   613         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   614         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   615         16  CHEK-STATE              PIC XX      VALUE SPACES.
   616         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   617         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   618         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   619         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   620         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   621
   622     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   623     12  ERPYAJ-KEY.
   624         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   625         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   626         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   627         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   628         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   629         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   630         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   631
   632     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   633
   634 01  ERROR-NUMBERS.
   635     12  ER-0000                     PIC X(4)    VALUE '0000'.
   636     12  ER-0004                     PIC X(4)    VALUE '0004'.
   637     12  ER-0008                     PIC X(4)    VALUE '0008'.
   638     12  ER-0013                     PIC X(4)    VALUE '0013'.
   639     12  ER-0022                     PIC X(4)    VALUE '0022'.
   640     12  ER-0023                     PIC X(4)    VALUE '0023'.
   641     12  ER-0026                     PIC X(4)    VALUE '0026'.
   642     12  ER-0029                     PIC X(4)    VALUE '0029'.
   643     12  ER-0070                     PIC X(4)    VALUE '0070'.
   644     12  ER-0194                     PIC X(4)    VALUE '0194'.
   645     12  ER-0195                     PIC X(4)    VALUE '0195'.
   646     12  ER-0196                     PIC X(4)    VALUE '0196'.
   647     12  ER-0197                     PIC X(4)    VALUE '0197'.
   648     12  ER-0203                     PIC X(4)    VALUE '0203'.
   649     12  ER-0215                     PIC X(4)    VALUE '0215'.
   650     12  ER-0216                     PIC X(4)    VALUE '0216'.
   651     12  ER-0433                     PIC X(4)    VALUE '0433'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  13
* EL677.cbl
   652     12  ER-0565                     PIC X(4)    VALUE '0565'.
   653     12  ER-1159                     PIC X(4)    VALUE '1159'.
   654     12  ER-1162                     PIC X(4)    VALUE '1162'.
   655     12  ER-2056                     PIC X(4)    VALUE '2056'.
   656     12  ER-2208                     PIC X(4)    VALUE '2208'.
   657     12  ER-2209                     PIC X(4)    VALUE '2209'.
   658     12  ER-2210                     PIC X(4)    VALUE '2210'.
   659     12  ER-2230                     PIC X(4)    VALUE '2230'.
   660     12  ER-2237                     PIC X(4)    VALUE '2237'.
   661     12  ER-2238                     PIC X(4)    VALUE '2238'.
   662     12  ER-2294                     PIC X(4)    VALUE '2294'.
   663     12  ER-2394                     PIC X(4)    VALUE '2394'.
   664     12  ER-2438                     PIC X(4)    VALUE '2438'.
   665     12  ER-2439                     PIC X(4)    VALUE '2439'.
   666     12  ER-2583                     PIC X(4)    VALUE '2583'.
   667     12  ER-2600                     PIC X(4)    VALUE '2600'.
   668     12  ER-2726                     PIC X(4)    VALUE '2726'.
   669     12  ER-2905                     PIC X(4)    VALUE '2905'.
   670     12  ER-2906                     PIC X(4)    VALUE '2906'.
   671     12  ER-2907                     PIC X(4)    VALUE '2907'.
   672     12  ER-2908                     PIC X(4)    VALUE '2908'.
   673     12  ER-2909                     PIC X(4)    VALUE '2909'.
   674     12  ER-3044                     PIC X(4)    VALUE '3044'.
   675     12  ER-3046                     PIC X(4)    VALUE '3046'.
   676     12  ER-3047                     PIC X(4)    VALUE '3047'.
   677     12  ER-3445                     PIC X(4)    VALUE '3445'.
   678     12  er-3450                     pic x(4)    value '3450'.
   679     12  er-3451                     pic x(4)    value '3451'.
   680     12  er-3452                     pic x(4)    value '3452'.
   681     12  er-3453                     pic x(4)    value '3453'.
   682     12  er-3454                     pic x(4)    value '3454'.
   683     12  er-3455                     pic x(4)    value '3455'.
   684     12  er-3459                     pic x(4)    value '3459'.
   685     12  ER-7389                     PIC X(4)    VALUE '7389'.
   686*                                    COPY ELCLOGOF.
   687******************************************************************
   688*                                                                *
   689*                                                                *
   690*                            ELCLOGOF.                           *
   691*                            VMOD=2.001                          *
   692*                                                                *
   693*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   694*                                                                *
   695******************************************************************
   696 01  CLASIC-LOGOFF.
   697     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   698     12  LOGOFF-TEXT.
   699         16  FILLER          PIC X(5)    VALUE SPACES.
   700         16  LOGOFF-MSG.
   701             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   702             20  FILLER      PIC X       VALUE SPACES.
   703             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   704         16  FILLER          PIC X(80)
   705           VALUE '* YOU ARE NOW LOGGED OFF'.
   706         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   707         16  FILLER          PIC X       VALUE QUOTE.
   708         16  LOGOFF-SYS-MSG  PIC X(17)
   709           VALUE 'S CLAS-IC SYSTEM '.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  14
* EL677.cbl
   710     12  TEXT-MESSAGES.
   711         16  UNACCESS-MSG    PIC X(29)
   712             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   713         16  PGMIDERR-MSG    PIC X(17)
   714             VALUE 'PROGRAM NOT FOUND'.
   715*                                    COPY ELCDATE.
   716******************************************************************
   717*                                                                *
   718*                                                                *
   719*                            ELCDATE.                            *
   720*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   721*                            VMOD=2.003
   722*                                                                *
   723*                                                                *
   724*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   725*                 LENGTH = 200                                   *
   726******************************************************************
   727
   728 01  DATE-CONVERSION-DATA.
   729     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   730     12  DC-OPTION-CODE                PIC X.
   731         88  BIN-TO-GREG                VALUE ' '.
   732         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   733         88  EDIT-GREG-TO-BIN           VALUE '2'.
   734         88  YMD-GREG-TO-BIN            VALUE '3'.
   735         88  MDY-GREG-TO-BIN            VALUE '4'.
   736         88  JULIAN-TO-BIN              VALUE '5'.
   737         88  BIN-PLUS-ELAPSED           VALUE '6'.
   738         88  FIND-CENTURY               VALUE '7'.
   739         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   740         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   741         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   742         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   743         88  JULIAN-TO-BIN-3            VALUE 'C'.
   744         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   745         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   746         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   747         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   748         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   749         88  CHECK-LEAP-YEAR            VALUE 'H'.
   750         88  BIN-3-TO-GREG              VALUE 'I'.
   751         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   752         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   753         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   754         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   755         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   756         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   757         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   758         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   759         88  THREE-CHARACTER-BIN
   760                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   761         88  GREGORIAN-TO-BIN
   762                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   763         88  BIN-TO-GREGORIAN
   764                  VALUES ' ' '1' 'I' '8' 'G'.
   765         88  JULIAN-TO-BINARY
   766                  VALUES '5' 'C' 'E' 'F'.
   767     12  DC-ERROR-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  15
* EL677.cbl
   768         88  NO-CONVERSION-ERROR        VALUE ' '.
   769         88  DATE-CONVERSION-ERROR
   770                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   771         88  DATE-IS-ZERO               VALUE '1'.
   772         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   773         88  DATE-IS-INVALID            VALUE '3'.
   774         88  DATE1-GREATER-DATE2        VALUE '4'.
   775         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   776         88  DATE-INVALID-OPTION        VALUE '9'.
   777         88  INVALID-CENTURY            VALUE 'A'.
   778         88  ONLY-CENTURY               VALUE 'B'.
   779         88  ONLY-LEAP-YEAR             VALUE 'C'.
   780         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   781     12  DC-END-OF-MONTH               PIC X.
   782         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   783     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   784         88  USE-NORMAL-PROCESS         VALUE ' '.
   785         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   786         88  ADJUST-UP-100-YRS          VALUE '2'.
   787     12  FILLER                        PIC X.
   788     12  DC-CONVERSION-DATES.
   789         16  DC-BIN-DATE-1             PIC XX.
   790         16  DC-BIN-DATE-2             PIC XX.
   791         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   792         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   793                       DC-GREG-DATE-1-EDIT.
   794             20  DC-EDIT1-MONTH        PIC 99.
   795             20  SLASH1-1              PIC X.
   796             20  DC-EDIT1-DAY          PIC 99.
   797             20  SLASH1-2              PIC X.
   798             20  DC-EDIT1-YEAR         PIC 99.
   799         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   800         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   801                     DC-GREG-DATE-2-EDIT.
   802             20  DC-EDIT2-MONTH        PIC 99.
   803             20  SLASH2-1              PIC X.
   804             20  DC-EDIT2-DAY          PIC 99.
   805             20  SLASH2-2              PIC X.
   806             20  DC-EDIT2-YEAR         PIC 99.
   807         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   808         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   809                     DC-GREG-DATE-1-YMD.
   810             20  DC-YMD-YEAR           PIC 99.
   811             20  DC-YMD-MONTH          PIC 99.
   812             20  DC-YMD-DAY            PIC 99.
   813         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   814         16  DC-GREG-DATE-1-MDY-R REDEFINES
   815                      DC-GREG-DATE-1-MDY.
   816             20  DC-MDY-MONTH          PIC 99.
   817             20  DC-MDY-DAY            PIC 99.
   818             20  DC-MDY-YEAR           PIC 99.
   819         16  DC-GREG-DATE-1-ALPHA.
   820             20  DC-ALPHA-MONTH        PIC X(10).
   821             20  DC-ALPHA-DAY          PIC 99.
   822             20  FILLER                PIC XX.
   823             20  DC-ALPHA-CENTURY.
   824                 24 DC-ALPHA-CEN-N     PIC 99.
   825             20  DC-ALPHA-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  16
* EL677.cbl
   826         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   827         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   828         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   829         16  DC-JULIAN-DATE            PIC 9(05).
   830         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   831                                       PIC 9(05).
   832         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   833             20  DC-JULIAN-YEAR        PIC 99.
   834             20  DC-JULIAN-DAYS        PIC 999.
   835         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   836         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   837         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   838     12  DATE-CONVERSION-VARIBLES.
   839         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   840         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   841             20  FILLER                PIC 9(3).
   842             20  HOLD-CEN-1-CCYY.
   843                 24  HOLD-CEN-1-CC     PIC 99.
   844                 24  HOLD-CEN-1-YY     PIC 99.
   845             20  HOLD-CEN-1-MO         PIC 99.
   846             20  HOLD-CEN-1-DA         PIC 99.
   847         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   848             20  HOLD-CEN-1-R-MO       PIC 99.
   849             20  HOLD-CEN-1-R-DA       PIC 99.
   850             20  HOLD-CEN-1-R-CCYY.
   851                 24  HOLD-CEN-1-R-CC   PIC 99.
   852                 24  HOLD-CEN-1-R-YY   PIC 99.
   853             20  FILLER                PIC 9(3).
   854         16  HOLD-CENTURY-1-X.
   855             20  FILLER                PIC X(3)  VALUE SPACES.
   856             20  HOLD-CEN-1-X-CCYY.
   857                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   858                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   859             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   860             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   861         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   862             20  HOLD-CEN-1-R-X-MO     PIC XX.
   863             20  HOLD-CEN-1-R-X-DA     PIC XX.
   864             20  HOLD-CEN-1-R-X-CCYY.
   865                 24  HOLD-CEN-1-R-X-CC PIC XX.
   866                 24  HOLD-CEN-1-R-X-YY PIC XX.
   867             20  FILLER                PIC XXX.
   868         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   869         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   870         16  DC-JULIAN-DATE-1          PIC 9(07).
   871         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   872             20  DC-JULIAN-1-CCYY.
   873                 24  DC-JULIAN-1-CC    PIC 99.
   874                 24  DC-JULIAN-1-YR    PIC 99.
   875             20  DC-JULIAN-DA-1        PIC 999.
   876         16  DC-JULIAN-DATE-2          PIC 9(07).
   877         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   878             20  DC-JULIAN-2-CCYY.
   879                 24  DC-JULIAN-2-CC    PIC 99.
   880                 24  DC-JULIAN-2-YR    PIC 99.
   881             20  DC-JULIAN-DA-2        PIC 999.
   882         16  DC-GREG-DATE-A-EDIT.
   883             20  DC-EDITA-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  17
* EL677.cbl
   884             20  SLASHA-1              PIC X VALUE '/'.
   885             20  DC-EDITA-DAY          PIC 99.
   886             20  SLASHA-2              PIC X VALUE '/'.
   887             20  DC-EDITA-CCYY.
   888                 24  DC-EDITA-CENT     PIC 99.
   889                 24  DC-EDITA-YEAR     PIC 99.
   890         16  DC-GREG-DATE-B-EDIT.
   891             20  DC-EDITB-MONTH        PIC 99.
   892             20  SLASHB-1              PIC X VALUE '/'.
   893             20  DC-EDITB-DAY          PIC 99.
   894             20  SLASHB-2              PIC X VALUE '/'.
   895             20  DC-EDITB-CCYY.
   896                 24  DC-EDITB-CENT     PIC 99.
   897                 24  DC-EDITB-YEAR     PIC 99.
   898         16  DC-GREG-DATE-CYMD         PIC 9(08).
   899         16  DC-GREG-DATE-CYMD-R REDEFINES
   900                              DC-GREG-DATE-CYMD.
   901             20  DC-CYMD-CEN           PIC 99.
   902             20  DC-CYMD-YEAR          PIC 99.
   903             20  DC-CYMD-MONTH         PIC 99.
   904             20  DC-CYMD-DAY           PIC 99.
   905         16  DC-GREG-DATE-MDCY         PIC 9(08).
   906         16  DC-GREG-DATE-MDCY-R REDEFINES
   907                              DC-GREG-DATE-MDCY.
   908             20  DC-MDCY-MONTH         PIC 99.
   909             20  DC-MDCY-DAY           PIC 99.
   910             20  DC-MDCY-CEN           PIC 99.
   911             20  DC-MDCY-YEAR          PIC 99.
   912    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   913        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   914    12  DC-EL310-DATE                  PIC X(21).
   915    12  FILLER                         PIC X(28).
   916*                                    COPY ELCATTR.
   917******************************************************************
   918*                                                                *
   919*                            ELCATTR.                            *
   920*                            VMOD=2.001                          *
   921*                                                                *
   922*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   923*                                                                *
   924*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   925*                                                                *
   926*                   POS 1   P=PROTECTED                          *
   927*                           U=UNPROTECTED                        *
   928*                           S=ASKIP                              *
   929*                   POS 2   A=ALPHA/NUMERIC                      *
   930*                           N=NUMERIC                            *
   931*                   POS 3   N=NORMAL                             *
   932*                           B=BRIGHT                             *
   933*                           D=DARK                               *
   934*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   935*                           OF=MODIFIED DATA TAG OFF             *
   936*                                                                *
   937*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   938******************************************************************
   939 01  ATTRIBUTE-LIST.
   940     12  AL-PABOF            PIC X       VALUE 'Y'.
   941     12  AL-PABON            PIC X       VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  18
* EL677.cbl
   942     12  AL-PADOF            PIC X       VALUE '%'.
   943     12  AL-PADON            PIC X       VALUE '_'.
   944     12  AL-PANOF            PIC X       VALUE '-'.
   945     12  AL-PANON            PIC X       VALUE '/'.
   946     12  AL-SABOF            PIC X       VALUE '8'.
   947     12  AL-SABON            PIC X       VALUE '9'.
   948     12  AL-SADOF            PIC X       VALUE '@'.
   949     12  AL-SADON            PIC X       VALUE QUOTE.
   950     12  AL-SANOF            PIC X       VALUE '0'.
   951     12  AL-SANON            PIC X       VALUE '1'.
   952     12  AL-UABOF            PIC X       VALUE 'H'.
   953     12  AL-UABON            PIC X       VALUE 'I'.
   954     12  AL-UADOF            PIC X       VALUE '<'.
   955     12  AL-UADON            PIC X       VALUE '('.
   956     12  AL-UANOF            PIC X       VALUE ' '.
   957     12  AL-UANON            PIC X       VALUE 'A'.
   958     12  AL-UNBOF            PIC X       VALUE 'Q'.
   959     12  AL-UNBON            PIC X       VALUE 'R'.
   960     12  AL-UNDOF            PIC X       VALUE '*'.
   961     12  AL-UNDON            PIC X       VALUE ')'.
   962     12  AL-UNNOF            PIC X       VALUE '&'.
   963     12  AL-UNNON            PIC X       VALUE 'J'.
   964*                                    COPY ELCEMIB.
   965******************************************************************
   966*                                                                *
   967*                                                                *
   968*                            ELCEMIB.                            *
   969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   970*                            VMOD=2.005                          *
   971*                                                                *
   972*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   973*                                                                *
   974******************************************************************
   975 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   976     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   977     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   978     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   979     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   980     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   981     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   982     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   983     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   984     12  EMI-SWITCH1             PIC X        VALUE '1'.
   985         88  EMI-NO-ERRORS                    VALUE '1'.
   986         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   987         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   988     12  EMI-SWITCH2             PIC X        VALUE '1'.
   989         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   990     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   991         88  EMI-AREA1-EMPTY                  VALUE '1'.
   992         88  EMI-AREA1-FULL                   VALUE '2'.
   993     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   994         88  EMI-AREA2-EMPTY                  VALUE '1'.
   995         88  EMI-AREA2-FULL                   VALUE '2'.
   996     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   997         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   998         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   999         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  19
* EL677.cbl
  1000         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1001         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1002     12  EMI-ERROR-LINES.
  1003         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1004         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1005         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1006         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1007             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1008                 24  EMI-ERR-NUM         PIC X(4).
  1009                 24  EMI-FILLER          PIC X.
  1010                 24  EMI-SEV             PIC X.
  1011                 24  FILLER              PIC X.
  1012             20  FILLER                  PIC X(02).
  1013     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1014         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1015             20  EMI-ERROR-NUMBER    PIC X(4).
  1016             20  EMI-FILL            PIC X.
  1017             20  EMI-SEVERITY        PIC X.
  1018             20  FILLER              PIC X.
  1019             20  EMI-ERROR-TEXT.
  1020                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1021                 24  FILLER          PIC X(55).
  1022     12  EMI-SEVERITY-SAVE           PIC X.
  1023         88  EMI-NOTE                    VALUE 'N'.
  1024         88  EMI-WARNING                 VALUE 'W'.
  1025         88  EMI-FORCABLE                VALUE 'F'.
  1026         88  EMI-FATAL                   VALUE 'X'.
  1027     12  EMI-MESSAGE-FLAG            PIC X.
  1028         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1029         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1030     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1031     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1032         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1033         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1034         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1035     12  emi-claim-no                pic x(7).
  1036     12  emi-claim-type              pic x(6).
  1037     12  FILLER                      PIC X(124)  VALUE SPACES.
  1038     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1039     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1040     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1041     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1042*                                    COPY ELCINTF.
  1043******************************************************************
  1044*                                                                *
  1045*                                                                *
  1046*                            ELCINTF.                            *
  1047*                            VMOD=2.017                          *
  1048*                                                                *
  1049*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1050*                                                                *
  1051*       LENGTH = 1024                                            *
  1052*                                                                *
  1053******************************************************************
  1054*                   C H A N G E   L O G
  1055*
  1056* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1057*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  20
* EL677.cbl
  1058*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1059* EFFECTIVE    NUMBER
  1060*-----------------------------------------------------------------
  1061* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1062******************************************************************
  1063 01  PROGRAM-INTERFACE-BLOCK.
  1064     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1065     12  PI-CALLING-PROGRAM              PIC X(8).
  1066     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1067     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1072     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1073     12  PI-COMPANY-ID                   PIC XXX.
  1074     12  PI-COMPANY-CD                   PIC X.
  1075
  1076     12  PI-COMPANY-PASSWORD             PIC X(8).
  1077
  1078     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1079
  1080     12  PI-CONTROL-IN-PROGRESS.
  1081         16  PI-CARRIER                  PIC X.
  1082         16  PI-GROUPING                 PIC X(6).
  1083         16  PI-STATE                    PIC XX.
  1084         16  PI-ACCOUNT                  PIC X(10).
  1085         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1086                                         PIC X(10).
  1087         16  PI-CLAIM-CERT-GRP.
  1088             20  PI-CLAIM-NO             PIC X(7).
  1089             20  PI-CERT-NO.
  1090                 25  PI-CERT-PRIME       PIC X(10).
  1091                 25  PI-CERT-SFX         PIC X.
  1092             20  PI-CERT-EFF-DT          PIC XX.
  1093         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1094             20  PI-PLAN-CODE            PIC X(2).
  1095             20  PI-REVISION-NUMBER      PIC X(3).
  1096             20  PI-PLAN-EFF-DT          PIC X(2).
  1097             20  PI-PLAN-EXP-DT          PIC X(2).
  1098             20  FILLER                  PIC X(11).
  1099         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1100             20  PI-OE-REFERENCE-1.
  1101                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1102                 25  PI-OE-REF-1-SUFF    PIC XX.
  1103
  1104     12  PI-SESSION-IN-PROGRESS          PIC X.
  1105         88  CLAIM-SESSION                   VALUE '1'.
  1106         88  CREDIT-SESSION                  VALUE '2'.
  1107         88  WARRANTY-SESSION                VALUE '3'.
  1108         88  MORTGAGE-SESSION                VALUE '4'.
  1109         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1110
  1111
  1112*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1113
  1114     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1115     12  PI-ORIGINAL-COMPANY-CD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  21
* EL677.cbl
  1116
  1117     12  PI-CREDIT-USER                  PIC X.
  1118         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1119         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1120
  1121     12  PI-CLAIM-USER                   PIC X.
  1122         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1123         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1124
  1125     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1126         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1127         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1128         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1129         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1130         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1131
  1132     12  PI-PROCESSOR-ID                 PIC X(4).
  1133
  1134     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1135
  1136     12  PI-MEMBER-CAPTION               PIC X(10).
  1137
  1138     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1139         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1140
  1141     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1142     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1143     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1144     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1145
  1146     12  PI-AH-OVERRIDE-L1               PIC X.
  1147     12  PI-AH-OVERRIDE-L2               PIC XX.
  1148     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1149     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1150
  1151     12  PI-NEW-SYSTEM                   PIC X(2).
  1152
  1153     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1154     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1155         88  PI-USES-PAID-TO                 VALUE '1'.
  1156     12  PI-CRDTCRD-SYSTEM.
  1157         16  PI-CRDTCRD-USER             PIC X.
  1158             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1159             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1160         16  PI-CC-MONTH-END-DT          PIC XX.
  1161     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1162
  1163     12  PI-OE-REFERENCE-2.
  1164         16  PI-OE-REF-2-PRIME           PIC X(10).
  1165         16  PI-OE-REF-2-SUFF            PIC X.
  1166
  1167     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1168
  1169     12  PI-LANGUAGE-TYPE                PIC X.
  1170             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1171             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1172             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1173
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  22
* EL677.cbl
  1174     12  PI-POLICY-LINKAGE-IND           PIC X.
  1175         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1176         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1177                                                   LOW-VALUES.
  1178
  1179     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1180     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1181         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1182         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1183
  1184     12  PI-PROCESSOR-CSR-IND            PIC X.
  1185         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1186         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1187
  1188     12  FILLER                          PIC X(3).
  1189
  1190     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1191
  1192     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1193         PI-SYSTEM-LEVEL.
  1194
  1195         16  PI-ENTRY-CODES.
  1196             20  PI-ENTRY-CD-1           PIC X.
  1197             20  PI-ENTRY-CD-2           PIC X.
  1198
  1199         16  PI-RETURN-CODES.
  1200             20  PI-RETURN-CD-1          PIC X.
  1201             20  PI-RETURN-CD-2          PIC X.
  1202
  1203         16  PI-UPDATE-STATUS-SAVE.
  1204             20  PI-UPDATE-BY            PIC X(4).
  1205             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1206
  1207         16  PI-LOWER-CASE-LETTERS       PIC X.
  1208             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1209
  1210*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1211*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1212*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1213
  1214         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1215             88  ST-ACCNT-CNTL               VALUE ' '.
  1216             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1217             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1218             88  ACCNT-CNTL                  VALUE '3'.
  1219             88  CARR-ACCNT-CNTL             VALUE '4'.
  1220
  1221         16  PI-PROCESSOR-CAP-LIST.
  1222             20  PI-SYSTEM-CONTROLS.
  1223                24 PI-SYSTEM-DISPLAY     PIC X.
  1224                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1225                24 PI-SYSTEM-MODIFY      PIC X.
  1226                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1227             20  FILLER                  PIC XX.
  1228             20  PI-DISPLAY-CAP          PIC X.
  1229                 88  DISPLAY-CAP             VALUE 'Y'.
  1230             20  PI-MODIFY-CAP           PIC X.
  1231                 88  MODIFY-CAP              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  23
* EL677.cbl
  1232             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1233                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1234             20  PI-FORCE-CAP            PIC X.
  1235                 88  FORCE-CAP               VALUE 'Y'.
  1236
  1237         16  PI-PROGRAM-CONTROLS.
  1238             20  PI-PGM-PRINT-OPT        PIC X.
  1239             20  PI-PGM-FORMAT-OPT       PIC X.
  1240             20  PI-PGM-PROCESS-OPT      PIC X.
  1241             20  PI-PGM-TOTALS-OPT       PIC X.
  1242
  1243         16  PI-HELP-INTERFACE.
  1244             20  PI-LAST-ERROR-NO        PIC X(4).
  1245             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1246
  1247         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1248             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1249
  1250         16  PI-CR-CONTROL-IN-PROGRESS.
  1251             20  PI-CR-CARRIER           PIC X.
  1252             20  PI-CR-GROUPING          PIC X(6).
  1253             20  PI-CR-STATE             PIC XX.
  1254             20  PI-CR-ACCOUNT           PIC X(10).
  1255             20  PI-CR-FIN-RESP          PIC X(10).
  1256             20  PI-CR-TYPE              PIC X.
  1257
  1258         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1259
  1260         16  PI-CR-MONTH-END-DT          PIC XX.
  1261
  1262         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1263             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1264             88  PI-ZERO-CARRIER             VALUE '1'.
  1265             88  PI-ZERO-GROUPING            VALUE '2'.
  1266             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1267
  1268         16  PI-CARRIER-SECURITY         PIC X.
  1269             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1270
  1271         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1272             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1273             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1274
  1275         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1276             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1277                                         INDEXED BY PI-ACCESS-NDX
  1278                                         PIC X.
  1279
  1280         16  PI-GA-BILLING-CONTROL       PIC X.
  1281             88  PI-GA-BILLING               VALUE '1'.
  1282
  1283         16  PI-MAIL-PROCESSING          PIC X.
  1284             88  PI-MAIL-YES                 VALUE 'Y'.
  1285
  1286         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1287
  1288         16  PI-AR-SYSTEM.
  1289             20  PI-AR-PROCESSING-CNTL   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  24
* EL677.cbl
  1290                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1291             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1292             20  PI-AR-MONTH-END-DT      PIC XX.
  1293
  1294         16  PI-MP-SYSTEM.
  1295             20  PI-MORTGAGE-USER            PIC X.
  1296                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1297                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1298             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1299                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1300                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1301                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1302                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1303                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1304             20  PI-MP-MONTH-END-DT          PIC XX.
  1305             20  PI-MP-REFERENCE-NO.
  1306                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1307                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1308
  1309         16  PI-LABEL-CONTROL            PIC X(01).
  1310             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1311             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1312
  1313         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1314             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1315
  1316         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1317             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1318             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1319
  1320         16  FILLER                      PIC X(14).
  1321
  1322     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1323******************************************************************
  1324     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1325         16  PI-EOF-SW               PIC X.
  1326             88  PI-FILE-EOF                     VALUE 'Y'.
  1327         16  PI-PREV-MAINT           PIC X.
  1328         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1329         16  PI-ERCHEK-KEY.
  1330             20  PI-CHEK-COMP-CD     PIC X.
  1331             20  PI-CHEK-CARRIER     PIC X.
  1332             20  PI-CHEK-GROUPING    PIC X(6).
  1333             20  PI-CHEK-STATE       PIC XX.
  1334             20  PI-CHEK-ACCOUNT     PIC X(10).
  1335             20  PI-CHEK-EFF-DT      PIC XX.
  1336             20  PI-CHEK-CERT-NO     PIC X(10).
  1337             20  PI-CHEK-SUF-NO      PIC X.
  1338             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1339         16  PI-ACCOUNT-ADDRESS.
  1340             20  PI-AM-NAME          PIC X(30).
  1341             20  PI-AM-ADDRS         PIC X(30).
  1342             20  PI-AM-CITY-st.
  1343                 24  pi-am-city      PIC X(28).
  1344                 24  pi-am-st        pic xx.
  1345             20  PI-AM-ZIP-CODE.
  1346                 24  PI-AM-ZIP-PRIME PIC X(5).
  1347                 24  PI-AM-ZIP-PLUS4 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  25
* EL677.cbl
  1348         16  PI-PROCESS-CERT-SW          PIC X.
  1349             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1350         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1351             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1352         16  PI-PAYTO1                   PIC X(30).
  1353         16  PI-REFERENCE                PIC X(12).
  1354         16  PI-CANC-DT                  PIC XX.
  1355         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1356         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1357         16  PI-INSURED-NAME             PIC X(28).
  1358         16  PI-PFKEY                    PIC XXX.
  1359             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1360             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1361         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1362         16  PI-TYPE                     PIC X.
  1363         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1364         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1365         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1366         16  pi-chek-rec-cnt             pic s999 comp-3.
  1367         16  pi-am-csr                   pic x(4).
  1368         16  pi-return-to                pic x(30).
  1369         16  pi-prev-ded-comm            pic x.
  1370         16  pi-table-name               pic x(30).
  1371         16  pi-check-cashed             pic x.
  1372         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1373         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1374         16  pi-check-type               pic x.
  1375             88  ws-corr-check              value 'C'.
  1376             88  ws-ref-check               value 'R'.
  1377         16  pi-check-cut                pic x.
  1378         16  FILLER                      PIC X(311). *> wass 322
  1379*                                    COPY ELCAID.
  1380******************************************************************
  1381*                                                                *
  1382*                            ELCAID.                             *
  1383*                            VMOD=2.001                          *
  1384*                                                                *
  1385*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1386*                                                                *
  1387*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1388*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1389******************************************************************
  1390
  1391 01  DFHAID.
  1392   02  DFHNULL   PIC  X  VALUE  ' '.
  1393   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1394   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1395   02  DFHPEN    PIC  X  VALUE  '='.
  1396   02  DFHOPID   PIC  X  VALUE  'W'.
  1397   02  DFHPA1    PIC  X  VALUE  '%'.
  1398   02  DFHPA2    PIC  X  VALUE  '>'.
  1399   02  DFHPA3    PIC  X  VALUE  ','.
  1400   02  DFHPF1    PIC  X  VALUE  '1'.
  1401   02  DFHPF2    PIC  X  VALUE  '2'.
  1402   02  DFHPF3    PIC  X  VALUE  '3'.
  1403   02  DFHPF4    PIC  X  VALUE  '4'.
  1404   02  DFHPF5    PIC  X  VALUE  '5'.
  1405   02  DFHPF6    PIC  X  VALUE  '6'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  26
* EL677.cbl
  1406   02  DFHPF7    PIC  X  VALUE  '7'.
  1407   02  DFHPF8    PIC  X  VALUE  '8'.
  1408   02  DFHPF9    PIC  X  VALUE  '9'.
  1409   02  DFHPF10   PIC  X  VALUE  ':'.
  1410   02  DFHPF11   PIC  X  VALUE  '#'.
  1411   02  DFHPF12   PIC  X  VALUE  '@'.
  1412   02  DFHPF13   PIC  X  VALUE  'A'.
  1413   02  DFHPF14   PIC  X  VALUE  'B'.
  1414   02  DFHPF15   PIC  X  VALUE  'C'.
  1415   02  DFHPF16   PIC  X  VALUE  'D'.
  1416   02  DFHPF17   PIC  X  VALUE  'E'.
  1417   02  DFHPF18   PIC  X  VALUE  'F'.
  1418   02  DFHPF19   PIC  X  VALUE  'G'.
  1419   02  DFHPF20   PIC  X  VALUE  'H'.
  1420   02  DFHPF21   PIC  X  VALUE  'I'.
  1421*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1422   02  DFHPF22   PIC  X  VALUE  '['.
  1423   02  DFHPF23   PIC  X  VALUE  '.'.
  1424   02  DFHPF24   PIC  X  VALUE  '<'.
  1425   02  DFHMSRE   PIC  X  VALUE  'X'.
  1426   02  DFHSTRF   PIC  X  VALUE  'h'.
  1427   02  DFHTRIG   PIC  X  VALUE  '"'.
  1428 01  FILLER    REDEFINES DFHAID.
  1429     12  FILLER                      PIC X(8).
  1430     12  PF-VALUES                   PIC X       OCCURS 24.
  1431     12  FILLER                      PIC X(3).
  1432*                                    COPY EL677S.
  1433 01  EL677AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  DATEL PIC S9(0004) COMP.
  1437     05  DATEF PIC  X(0001).
  1438     05  FILLER REDEFINES DATEF.
  1439         10  DATEA PIC  X(0001).
  1440     05  DATEI PIC  X(0008).
  1441*    -------------------------------
  1442     05  TIMEL PIC S9(0004) COMP.
  1443     05  TIMEF PIC  X(0001).
  1444     05  FILLER REDEFINES TIMEF.
  1445         10  TIMEA PIC  X(0001).
  1446     05  TIMEI PIC  X(0005).
  1447*    -------------------------------
  1448     05  MAINTL PIC S9(0004) COMP.
  1449     05  MAINTF PIC  X(0001).
  1450     05  FILLER REDEFINES MAINTF.
  1451         10  MAINTA PIC  X(0001).
  1452     05  MAINTI PIC  X(0001).
  1453*    -------------------------------
  1454     05  DMAINT1L PIC S9(0004) COMP.
  1455     05  DMAINT1F PIC  X(0001).
  1456     05  FILLER REDEFINES DMAINT1F.
  1457         10  DMAINT1A PIC  X(0001).
  1458     05  DMAINT1I PIC  X(0009).
  1459*    -------------------------------
  1460     05  DMAINT2L PIC S9(0004) COMP.
  1461     05  DMAINT2F PIC  X(0001).
  1462     05  FILLER REDEFINES DMAINT2F.
  1463         10  DMAINT2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  27
* EL677.cbl
  1464     05  DMAINT2I PIC  X(0029).
  1465*    -------------------------------
  1466     05  CARRIERL PIC S9(0004) COMP.
  1467     05  CARRIERF PIC  X(0001).
  1468     05  FILLER REDEFINES CARRIERF.
  1469         10  CARRIERA PIC  X(0001).
  1470     05  CARRIERI PIC  X(0001).
  1471*    -------------------------------
  1472     05  GROUPL PIC S9(0004) COMP.
  1473     05  GROUPF PIC  X(0001).
  1474     05  FILLER REDEFINES GROUPF.
  1475         10  GROUPA PIC  X(0001).
  1476     05  GROUPI PIC  X(0006).
  1477*    -------------------------------
  1478     05  STATEL PIC S9(0004) COMP.
  1479     05  STATEF PIC  X(0001).
  1480     05  FILLER REDEFINES STATEF.
  1481         10  STATEA PIC  X(0001).
  1482     05  STATEI PIC  X(0002).
  1483*    -------------------------------
  1484     05  ACCTL PIC S9(0004) COMP.
  1485     05  ACCTF PIC  X(0001).
  1486     05  FILLER REDEFINES ACCTF.
  1487         10  ACCTA PIC  X(0001).
  1488     05  ACCTI PIC  X(0010).
  1489*    -------------------------------
  1490     05  EFFDTL PIC S9(0004) COMP.
  1491     05  EFFDTF PIC  X(0001).
  1492     05  FILLER REDEFINES EFFDTF.
  1493         10  EFFDTA PIC  X(0001).
  1494     05  EFFDTI PIC  X(0008).
  1495*    -------------------------------
  1496     05  CERTNOL PIC S9(0004) COMP.
  1497     05  CERTNOF PIC  X(0001).
  1498     05  FILLER REDEFINES CERTNOF.
  1499         10  CERTNOA PIC  X(0001).
  1500     05  CERTNOI PIC  X(0010).
  1501*    -------------------------------
  1502     05  SFXL PIC S9(0004) COMP.
  1503     05  SFXF PIC  X(0001).
  1504     05  FILLER REDEFINES SFXF.
  1505         10  SFXA PIC  X(0001).
  1506     05  SFXI PIC  X(0001).
  1507*    -------------------------------
  1508     05  SEQL PIC S9(0004) COMP.
  1509     05  SEQF PIC  X(0001).
  1510     05  FILLER REDEFINES SEQF.
  1511         10  SEQA PIC  X(0001).
  1512     05  SEQI PIC  99.
  1513*    -------------------------------
  1514     05  PAYTO1L PIC S9(0004) COMP.
  1515     05  PAYTO1F PIC  X(0001).
  1516     05  FILLER REDEFINES PAYTO1F.
  1517         10  PAYTO1A PIC  X(0001).
  1518     05  PAYTO1I PIC  X(0030).
  1519*    -------------------------------
  1520     05  CREATEDL PIC S9(0004) COMP.
  1521     05  CREATEDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  28
* EL677.cbl
  1522     05  FILLER REDEFINES CREATEDF.
  1523         10  CREATEDA PIC  X(0001).
  1524     05  CREATEDI PIC  X(0008).
  1525*    -------------------------------
  1526     05  CBYL PIC S9(0004) COMP.
  1527     05  CBYF PIC  X(0001).
  1528     05  FILLER REDEFINES CBYF.
  1529         10  CBYA PIC  X(0001).
  1530     05  CBYI PIC  X(0004).
  1531*    -------------------------------
  1532     05  PAYTO2L PIC S9(0004) COMP.
  1533     05  PAYTO2F PIC  X(0001).
  1534     05  FILLER REDEFINES PAYTO2F.
  1535         10  PAYTO2A PIC  X(0001).
  1536     05  PAYTO2I PIC  X(0030).
  1537*    -------------------------------
  1538     05  PAYEEL PIC S9(0004) COMP.
  1539     05  PAYEEF PIC  X(0001).
  1540     05  FILLER REDEFINES PAYEEF.
  1541         10  PAYEEA PIC  X(0001).
  1542     05  PAYEEI PIC  X(0006).
  1543*    -------------------------------
  1544     05  APVSTATL PIC S9(0004) COMP.
  1545     05  APVSTATF PIC  X(0001).
  1546     05  FILLER REDEFINES APVSTATF.
  1547         10  APVSTATA PIC  X(0001).
  1548     05  APVSTATI PIC  X(0009).
  1549*    -------------------------------
  1550     05  PAYAD1L PIC S9(0004) COMP.
  1551     05  PAYAD1F PIC  X(0001).
  1552     05  FILLER REDEFINES PAYAD1F.
  1553         10  PAYAD1A PIC  X(0001).
  1554     05  PAYAD1I PIC  X(0030).
  1555*    -------------------------------
  1556     05  APVDTL PIC S9(0004) COMP.
  1557     05  APVDTF PIC  X(0001).
  1558     05  FILLER REDEFINES APVDTF.
  1559         10  APVDTA PIC  X(0001).
  1560     05  APVDTI PIC  X(0008).
  1561*    -------------------------------
  1562     05  APVBYL PIC S9(0004) COMP.
  1563     05  APVBYF PIC  X(0001).
  1564     05  FILLER REDEFINES APVBYF.
  1565         10  APVBYA PIC  X(0001).
  1566     05  APVBYI PIC  X(0004).
  1567*    -------------------------------
  1568     05  PAYAD2L PIC S9(0004) COMP.
  1569     05  PAYAD2F PIC  X(0001).
  1570     05  FILLER REDEFINES PAYAD2F.
  1571         10  PAYAD2A PIC  X(0001).
  1572     05  PAYAD2I PIC  X(0030).
  1573*    -------------------------------
  1574     05  VOIDEDL PIC S9(0004) COMP.
  1575     05  VOIDEDF PIC  X(0001).
  1576     05  FILLER REDEFINES VOIDEDF.
  1577         10  VOIDEDA PIC  X(0001).
  1578     05  VOIDEDI PIC  X(0008).
  1579*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  29
* EL677.cbl
  1580     05  VBYL PIC S9(0004) COMP.
  1581     05  VBYF PIC  X(0001).
  1582     05  FILLER REDEFINES VBYF.
  1583         10  VBYA PIC  X(0001).
  1584     05  VBYI PIC  X(0004).
  1585*    -------------------------------
  1586     05  PAYCTYL PIC S9(0004) COMP.
  1587     05  PAYCTYF PIC  X(0001).
  1588     05  FILLER REDEFINES PAYCTYF.
  1589         10  PAYCTYA PIC  X(0001).
  1590     05  PAYCTYI PIC  X(0028).
  1591*    -------------------------------
  1592     05  PAYSTL PIC S9(0004) COMP.
  1593     05  PAYSTF PIC  X(0001).
  1594     05  FILLER REDEFINES PAYSTF.
  1595         10  PAYSTA PIC  X(0001).
  1596     05  PAYSTI PIC  X(0002).
  1597*    -------------------------------
  1598     05  PRINTEDL PIC S9(0004) COMP.
  1599     05  PRINTEDF PIC  X(0001).
  1600     05  FILLER REDEFINES PRINTEDF.
  1601         10  PRINTEDA PIC  X(0001).
  1602     05  PRINTEDI PIC  X(0008).
  1603*    -------------------------------
  1604     05  PTOZIPL PIC S9(0004) COMP.
  1605     05  PTOZIPF PIC  X(0001).
  1606     05  FILLER REDEFINES PTOZIPF.
  1607         10  PTOZIPA PIC  X(0001).
  1608     05  PTOZIPI PIC  X(0009).
  1609*    -------------------------------
  1610     05  DEDCYNL PIC S9(0004) COMP.
  1611     05  DEDCYNF PIC  X(0001).
  1612     05  FILLER REDEFINES DEDCYNF.
  1613         10  DEDCYNA PIC  X(0001).
  1614     05  DEDCYNI PIC  X(0001).
  1615*    -------------------------------
  1616     05  CASHEDL PIC S9(0004) COMP.
  1617     05  CASHEDF PIC  X(0001).
  1618     05  FILLER REDEFINES CASHEDF.
  1619         10  CASHEDA PIC  X(0001).
  1620     05  CASHEDI PIC  X(0008).
  1621*    -------------------------------
  1622     05  RETTOL PIC S9(0004) COMP.
  1623     05  RETTOF PIC  X(0001).
  1624     05  FILLER REDEFINES RETTOF.
  1625         10  RETTOA PIC  X(0001).
  1626     05  RETTOI PIC  X(0030).
  1627*    -------------------------------
  1628     05  DPREML PIC S9(0004) COMP.
  1629     05  DPREMF PIC  X(0001).
  1630     05  FILLER REDEFINES DPREMF.
  1631         10  DPREMA PIC  X(0001).
  1632     05  DPREMI PIC  X(0005).
  1633*    -------------------------------
  1634     05  PREML PIC S9(0004) COMP.
  1635     05  PREMF PIC  X(0001).
  1636     05  FILLER REDEFINES PREMF.
  1637         10  PREMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  30
* EL677.cbl
  1638     05  PREMI PIC  X(0008).
  1639*    -------------------------------
  1640     05  DCOMML PIC S9(0004) COMP.
  1641     05  DCOMMF PIC  X(0001).
  1642     05  FILLER REDEFINES DCOMMF.
  1643         10  DCOMMA PIC  X(0001).
  1644     05  DCOMMI PIC  X(0005).
  1645*    -------------------------------
  1646     05  ISSCOMML PIC S9(0004) COMP.
  1647     05  ISSCOMMF PIC  X(0001).
  1648     05  FILLER REDEFINES ISSCOMMF.
  1649         10  ISSCOMMA PIC  X(0001).
  1650     05  ISSCOMMI PIC  X(0008).
  1651*    -------------------------------
  1652     05  DREFL PIC S9(0004) COMP.
  1653     05  DREFF PIC  X(0001).
  1654     05  FILLER REDEFINES DREFF.
  1655         10  DREFA PIC  X(0001).
  1656     05  DREFI PIC  X(0004).
  1657*    -------------------------------
  1658     05  REFL PIC S9(0004) COMP.
  1659     05  REFF PIC  X(0001).
  1660     05  FILLER REDEFINES REFF.
  1661         10  REFA PIC  X(0001).
  1662     05  REFI PIC  X(0008).
  1663*    -------------------------------
  1664     05  DUECOMML PIC S9(0004) COMP.
  1665     05  DUECOMMF PIC  X(0001).
  1666     05  FILLER REDEFINES DUECOMMF.
  1667         10  DUECOMMA PIC  X(0001).
  1668     05  DUECOMMI PIC  X(0007).
  1669*    -------------------------------
  1670     05  UECOMML PIC S9(0004) COMP.
  1671     05  UECOMMF PIC  X(0001).
  1672     05  FILLER REDEFINES UECOMMF.
  1673         10  UECOMMA PIC  X(0001).
  1674     05  UECOMMI PIC  X(0008).
  1675*    -------------------------------
  1676     05  DPREPDL PIC S9(0004) COMP.
  1677     05  DPREPDF PIC  X(0001).
  1678     05  FILLER REDEFINES DPREPDF.
  1679         10  DPREPDA PIC  X(0001).
  1680     05  DPREPDI PIC  X(0006).
  1681*    -------------------------------
  1682     05  PREPDL PIC S9(0004) COMP.
  1683     05  PREPDF PIC  X(0001).
  1684     05  FILLER REDEFINES PREPDF.
  1685         10  PREPDA PIC  X(0001).
  1686     05  PREPDI PIC  X(0008).
  1687*    -------------------------------
  1688     05  AMOUNTL PIC S9(0004) COMP.
  1689     05  AMOUNTF PIC  X(0001).
  1690     05  FILLER REDEFINES AMOUNTF.
  1691         10  AMOUNTA PIC  X(0001).
  1692     05  AMOUNTI PIC  S9(9)V99.
  1693*    -------------------------------
  1694     05  CHECKL PIC S9(0004) COMP.
  1695     05  CHECKF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  31
* EL677.cbl
  1696     05  FILLER REDEFINES CHECKF.
  1697         10  CHECKA PIC  X(0001).
  1698     05  CHECKI PIC  X(0007).
  1699*    -------------------------------
  1700     05  TYPEL PIC S9(0004) COMP.
  1701     05  TYPEF PIC  X(0001).
  1702     05  FILLER REDEFINES TYPEF.
  1703         10  TYPEA PIC  X(0001).
  1704     05  TYPEI PIC  X(0001).
  1705*    -------------------------------
  1706     05  REASONL PIC S9(0004) COMP.
  1707     05  REASONF PIC  X(0001).
  1708     05  FILLER REDEFINES REASONF.
  1709         10  REASONA PIC  X(0001).
  1710     05  REASONI PIC  X(0025).
  1711*    -------------------------------
  1712     05  VREASONL PIC S9(0004) COMP.
  1713     05  VREASONF PIC  X(0001).
  1714     05  FILLER REDEFINES VREASONF.
  1715         10  VREASONA PIC  X(0001).
  1716     05  VREASONI PIC  X(0024).
  1717*    -------------------------------
  1718     05  STUBL PIC S9(0004) COMP.
  1719     05  STUBF PIC  X(0001).
  1720     05  FILLER REDEFINES STUBF.
  1721         10  STUBA PIC  X(0001).
  1722     05  STUBI PIC  X(0030).
  1723*    -------------------------------
  1724     05  TEXT1L PIC S9(0004) COMP.
  1725     05  TEXT1F PIC  X(0001).
  1726     05  FILLER REDEFINES TEXT1F.
  1727         10  TEXT1A PIC  X(0001).
  1728     05  TEXT1I PIC  X(0050).
  1729*    -------------------------------
  1730     05  TEXT2L PIC S9(0004) COMP.
  1731     05  TEXT2F PIC  X(0001).
  1732     05  FILLER REDEFINES TEXT2F.
  1733         10  TEXT2A PIC  X(0001).
  1734     05  TEXT2I PIC  X(0050).
  1735*    -------------------------------
  1736     05  TEXT3L PIC S9(0004) COMP.
  1737     05  TEXT3F PIC  X(0001).
  1738     05  FILLER REDEFINES TEXT3F.
  1739         10  TEXT3A PIC  X(0001).
  1740     05  TEXT3I PIC  X(0040).
  1741*    -------------------------------
  1742     05  ERRMSG1L PIC S9(0004) COMP.
  1743     05  ERRMSG1F PIC  X(0001).
  1744     05  FILLER REDEFINES ERRMSG1F.
  1745         10  ERRMSG1A PIC  X(0001).
  1746     05  ERRMSG1I PIC  X(0079).
  1747*    -------------------------------
  1748     05  ERRMSG2L PIC S9(0004) COMP.
  1749     05  ERRMSG2F PIC  X(0001).
  1750     05  FILLER REDEFINES ERRMSG2F.
  1751         10  ERRMSG2A PIC  X(0001).
  1752     05  ERRMSG2I PIC  X(0079).
  1753*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  32
* EL677.cbl
  1754     05  PFENTERL PIC S9(0004) COMP.
  1755     05  PFENTERF PIC  X(0001).
  1756     05  FILLER REDEFINES PFENTERF.
  1757         10  PFENTERA PIC  X(0001).
  1758     05  PFENTERI PIC  9(2).
  1759*    -------------------------------
  1760     05  PF357L PIC S9(0004) COMP.
  1761     05  PF357F PIC  X(0001).
  1762     05  FILLER REDEFINES PF357F.
  1763         10  PF357A PIC  X(0001).
  1764     05  PF357I PIC  X(0050).
  1765*    -------------------------------
  1766     05  PF46L PIC S9(0004) COMP.
  1767     05  PF46F PIC  X(0001).
  1768     05  FILLER REDEFINES PF46F.
  1769         10  PF46A PIC  X(0001).
  1770     05  PF46I PIC  X(0033).
  1771 01  EL677AO REDEFINES EL677AI.
  1772     05  FILLER            PIC  X(0012).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  DATEO PIC  X(0008).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  TIMEO PIC  99.99.
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  MAINTO PIC  X(0001).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  DMAINT1O PIC  X(0009).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  DMAINT2O PIC  X(0029).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  CARRIERO PIC  X(0001).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  GROUPO PIC  X(0006).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  STATEO PIC  X(0002).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  ACCTO PIC  X(0010).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  EFFDTO PIC  99B99B99.
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  CERTNOO PIC  X(0010).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  SFXO PIC  X(0001).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  SEQO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  PAYTO1O PIC  X(0030).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  CREATEDO PIC  X(0008).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  CBYO PIC  X(0004).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  PAYTO2O PIC  X(0030).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  PAYEEO PIC  X(0006).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  APVSTATO PIC  X(0009).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  PAYAD1O PIC  X(0030).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  APVDTO PIC  X(0008).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  APVBYO PIC  X(0004).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PAYAD2O PIC  X(0030).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  VOIDEDO PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  VBYO PIC  X(0004).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  PAYCTYO PIC  X(0028).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  PAYSTO PIC  X(0002).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  PRINTEDO PIC  99B99B99.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  PTOZIPO PIC  X(0009).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  DEDCYNO PIC  X(0001).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  CASHEDO PIC  X(0008).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  RETTOO PIC  X(0030).
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  DPREMO PIC  X(0005).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  PREMO PIC  Z(5).99.
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  DCOMMO PIC  X(0005).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  ISSCOMMO PIC  Z(5).99.
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  DREFO PIC  X(0004).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  REFO PIC  Z(5).99.
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  DUECOMMO PIC  X(0007).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  UECOMMO PIC  Z(5).99.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  DPREPDO PIC  X(0006).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  PREPDO PIC  Z(5).99.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  AMOUNTO PIC  Z(7).ZZ-.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  CHECKO PIC  X(0007).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  TYPEO PIC  X(0001).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  REASONO PIC  X(0025).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  VREASONO PIC  X(0024).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  STUBO PIC  X(0030).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  TEXT1O PIC  X(0050).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  TEXT2O PIC  X(0050).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  TEXT3O PIC  X(0040).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  35
* EL677.cbl
  1928     05  ERRMSG1O PIC  X(0079).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ERRMSG2O PIC  X(0079).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  PFENTERO PIC  99.
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  PF357O PIC  X(0050).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  PF46O PIC  X(0033).
  1941*    -------------------------------
  1942****************************************************************
  1943*
  1944* Copyright (c) 2007 by Clerity Solutions, Inc.
  1945* All rights reserved.
  1946*
  1947****************************************************************
  1948 01  DFHEIV.
  1949   02  DFHEIV0               PIC X(35).
  1950   02  DFHEIV1               PIC X(08).
  1951   02  DFHEIV2               PIC X(08).
  1952   02  DFHEIV3               PIC X(08).
  1953   02  DFHEIV4               PIC X(06).
  1954   02  DFHEIV5               PIC X(04).
  1955   02  DFHEIV6               PIC X(04).
  1956   02  DFHEIV7               PIC X(02).
  1957   02  DFHEIV8               PIC X(02).
  1958   02  DFHEIV9               PIC X(01).
  1959   02  DFHEIV10              PIC S9(7) COMP-3.
  1960   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1961   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1962   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1963   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1964   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1965   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1966   02  DFHEIV17              PIC X(04).
  1967   02  DFHEIV18              PIC X(04).
  1968   02  DFHEIV19              PIC X(04).
  1969   02  DFHEIV20              USAGE IS POINTER.
  1970   02  DFHEIV21              USAGE IS POINTER.
  1971   02  DFHEIV22              USAGE IS POINTER.
  1972   02  DFHEIV23              USAGE IS POINTER.
  1973   02  DFHEIV24              USAGE IS POINTER.
  1974   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1975   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1976   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1977   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1978   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1979   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1980   02  FILLER                PIC X(02).
  1981   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1982   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1983   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1984   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1985   02  DFHEIVL3              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  36
* EL677.cbl
  1986 LINKAGE  SECTION.
  1987*****************************************************************
  1988*                                                               *
  1989* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1990* All rights reserved.                                          *
  1991*                                                               *
  1992*****************************************************************
  1993 01  dfheiblk.
  1994     02  eibtime          pic s9(7) comp-3.
  1995     02  eibdate          pic s9(7) comp-3.
  1996     02  eibtrnid         pic x(4).
  1997     02  eibtaskn         pic s9(7) comp-3.
  1998     02  eibtrmid         pic x(4).
  1999     02  dfheigdi         pic s9(4) comp.
  2000     02  eibcposn         pic s9(4) comp.
  2001     02  eibcalen         pic s9(4) comp.
  2002     02  eibaid           pic x(1).
  2003     02  eibfiller1       pic x(1).
  2004     02  eibfn            pic x(2).
  2005     02  eibfiller2       pic x(2).
  2006     02  eibrcode         pic x(6).
  2007     02  eibfiller3       pic x(2).
  2008     02  eibds            pic x(8).
  2009     02  eibreqid         pic x(8).
  2010     02  eibrsrce         pic x(8).
  2011     02  eibsync          pic x(1).
  2012     02  eibfree          pic x(1).
  2013     02  eibrecv          pic x(1).
  2014     02  eibsend          pic x(1).
  2015     02  eibatt           pic x(1).
  2016     02  eibeoc           pic x(1).
  2017     02  eibfmh           pic x(1).
  2018     02  eibcompl         pic x(1).
  2019     02  eibsig           pic x(1).
  2020     02  eibconf          pic x(1).
  2021     02  eiberr           pic x(1).
  2022     02  eibrldbk         pic x(1).
  2023     02  eiberrcd         pic x(4).
  2024     02  eibsynrb         pic x(1).
  2025     02  eibnodat         pic x(1).
  2026     02  eibfiller5       pic x(2).
  2027     02  eibresp          pic 9(09) comp.
  2028     02  eibresp2         pic 9(09) comp.
  2029     02  dfheigdj         pic s9(4) comp.
  2030     02  dfheigdk         pic s9(4) comp.
  2031 01  DFHCOMMAREA.
  2032     05  filler                  PIC X(1024).
  2033 01  var  pic x(30).
  2034*                                    COPY ELCCNTL.
  2035******************************************************************
  2036*                                                                *
  2037*                                                                *
  2038*                            ELCCNTL.                            *
  2039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2040*                            VMOD=2.059                          *
  2041*                                                                *
  2042*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2043*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  37
* EL677.cbl
  2044*   FILE TYPE = VSAM,KSDS                                        *
  2045*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2046*                                                                *
  2047*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2048*       ALTERNATE INDEX = NONE                                   *
  2049*                                                                *
  2050*   LOG = YES                                                    *
  2051*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2052******************************************************************
  2053*                   C H A N G E   L O G
  2054*
  2055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2056*-----------------------------------------------------------------
  2057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2058* EFFECTIVE    NUMBER
  2059*-----------------------------------------------------------------
  2060* 082503                   PEMA  ADD BENEFIT GROUP
  2061* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2062* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2063* 092705    2005050300006  PEMA  ADD SPP LEASES
  2064* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2065* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2066* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2067* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2068* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2069* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2070* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2071* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2072* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2073* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2074******************************************************************
  2075*
  2076 01  CONTROL-FILE.
  2077     12  CF-RECORD-ID                       PIC XX.
  2078         88  VALID-CF-ID                        VALUE 'CF'.
  2079
  2080     12  CF-CONTROL-PRIMARY.
  2081         16  CF-COMPANY-ID                  PIC XXX.
  2082         16  CF-RECORD-TYPE                 PIC X.
  2083             88  CF-COMPANY-MASTER              VALUE '1'.
  2084             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2085             88  CF-STATE-MASTER                VALUE '3'.
  2086             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2087             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2088             88  CF-CARRIER-MASTER              VALUE '6'.
  2089             88  CF-MORTALITY-MASTER            VALUE '7'.
  2090             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2091             88  CF-TERMINAL-MASTER             VALUE '9'.
  2092             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2093             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2094             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2095             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2096             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2097             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2098             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2099             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2100             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2101         16  CF-ACCESS-CD-GENL              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  38
* EL677.cbl
  2102         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2103             20  CF-PROCESSOR               PIC X(4).
  2104         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2105             20  CF-STATE-CODE              PIC XX.
  2106             20  FILLER                     PIC XX.
  2107         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2108             20  FILLER                     PIC XX.
  2109             20  CF-HI-BEN-IN-REC           PIC XX.
  2110         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2111             20  FILLER                     PIC XXX.
  2112             20  CF-CARRIER-CNTL            PIC X.
  2113         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2114             20  FILLER                     PIC XX.
  2115             20  CF-HI-TYPE-IN-REC          PIC 99.
  2116         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2117             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2118                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2119             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2120             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2121         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2122             20  FILLER                     PIC X.
  2123             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2124         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2125             20  FILLER                     PIC XX.
  2126             20  CF-MORTGAGE-PLAN           PIC XX.
  2127         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2128
  2129     12  CF-LAST-MAINT-DT                   PIC XX.
  2130     12  CF-LAST-MAINT-BY                   PIC X(4).
  2131     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2132
  2133     12  CF-RECORD-BODY                     PIC X(728).
  2134
  2135
  2136****************************************************************
  2137*             COMPANY MASTER RECORD                            *
  2138****************************************************************
  2139
  2140     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2141         16  CF-COMPANY-ADDRESS.
  2142             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2143             20  CF-CL-IN-CARE-OF           PIC X(30).
  2144             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2145             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2146             20  CF-CL-CITY-STATE           PIC X(30).
  2147             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2148             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2149         16  CF-COMPANY-CD                  PIC X.
  2150         16  CF-COMPANY-PASSWORD            PIC X(8).
  2151         16  CF-SECURITY-OPTION             PIC X.
  2152             88  ALL-SECURITY                   VALUE '1'.
  2153             88  COMPANY-VERIFY                 VALUE '2'.
  2154             88  PROCESSOR-VERIFY               VALUE '3'.
  2155             88  NO-SECURITY                    VALUE '4'.
  2156             88  ALL-BUT-TERM                   VALUE '5'.
  2157         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2158             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2159         16  CF-LGX-INTERFACE-CNTL          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  39
* EL677.cbl
  2160             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2161         16  CF-INFORCE-LOCATION            PIC X.
  2162             88  CERTS-ARE-ONLINE               VALUE '1'.
  2163             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2164             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2165         16  CF-LOWER-CASE-LETTERS          PIC X.
  2166         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2167             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2168             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2169             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2170             88  CF-ACCNT-CNTL                  VALUE '3'.
  2171             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2172
  2173         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2174         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2175
  2176         16  CF-LGX-CREDIT-USER             PIC X.
  2177             88  CO-IS-NOT-USER                 VALUE 'N'.
  2178             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2179
  2180         16 CF-CREDIT-CALC-CODES.
  2181             20  CF-CR-REM-TERM-CALC PIC X.
  2182               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2183               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2184               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2185               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2186               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2187               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2188               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2189             20  CF-CR-R78-METHOD           PIC X.
  2190               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2191               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2192
  2193         16  CF-CLAIM-CONTROL-COUNTS.
  2194             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2195                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2196
  2197             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2198                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2199
  2200             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2201                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2202
  2203             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2204                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2205
  2206         16  CF-CURRENT-MONTH-END           PIC XX.
  2207
  2208         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2209             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2210             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2211             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2212             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2213                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2214                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2215             20  CF-CO-PREM-REJECT-SW       PIC X.
  2216                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2217                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  40
* EL677.cbl
  2218             20  CF-CO-REF-REJECT-SW        PIC X.
  2219                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2220                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2221
  2222         16  CF-CO-REPORTING-DT             PIC XX.
  2223         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2224         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2225           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2226           88  CF-CO-MONTH-END                  VALUE '1'.
  2227
  2228         16  CF-LGX-CLAIM-USER              PIC X.
  2229             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2230             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2231
  2232         16  CF-CREDIT-EDIT-CONTROLS.
  2233             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2234             20  CF-MIN-AGE                 PIC 99.
  2235             20  CF-DEFAULT-AGE             PIC 99.
  2236             20  CF-MIN-TERM                PIC S999      COMP-3.
  2237             20  CF-MAX-TERM                PIC S999      COMP-3.
  2238             20  CF-DEFAULT-SEX             PIC X.
  2239             20  CF-JOINT-AGE-INPUT         PIC X.
  2240                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2241             20  CF-BIRTH-DATE-INPUT        PIC X.
  2242                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2243             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2244                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2245                 88  CF-ZERO-CARRIER            VALUE '1'.
  2246                 88  CF-ZERO-GROUPING           VALUE '2'.
  2247                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2248             20  CF-EDIT-SW                 PIC X.
  2249                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2250             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2251             20  CF-CR-PR-METHOD            PIC X.
  2252               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2253               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2254             20  FILLER                     PIC X.
  2255
  2256         16  CF-CREDIT-MISC-CONTROLS.
  2257             20  CF-REIN-TABLE-SW           PIC X.
  2258                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2259             20  CF-COMP-TABLE-SW           PIC X.
  2260                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2261             20  CF-EXPERIENCE-RETENTION-AGE
  2262                                            PIC S9        COMP-3.
  2263             20  CF-CONVERSION-DT           PIC XX.
  2264             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2265             20  CF-RUN-FREQUENCY-SW        PIC X.
  2266                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2267                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2268
  2269             20  CF-CR-CHECK-NO-CONTROL.
  2270                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2271                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2272                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2273                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2274                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2275                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  41
* EL677.cbl
  2276
  2277                 24  CF-CR-CHECK-COUNT       REDEFINES
  2278                     CF-CR-CHECK-COUNTER      PIC X(4).
  2279
  2280                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2281                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2282
  2283                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2284                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2285                 24  CF-MAIL-PROCESSING       PIC X.
  2286                     88  MAIL-PROCESSING          VALUE 'Y'.
  2287
  2288         16  CF-MISC-SYSTEM-CONTROL.
  2289             20  CF-SYSTEM-C                 PIC X.
  2290                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2291             20  CF-SYSTEM-D                 PIC X.
  2292                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2293             20  CF-SOC-SEC-NO-SW            PIC X.
  2294                 88  SOC-SEC-NO-USED             VALUE '1'.
  2295             20  CF-MEMBER-NO-SW             PIC X.
  2296                 88  MEMBER-NO-USED              VALUE '1'.
  2297             20  CF-TAX-ID-NUMBER            PIC X(11).
  2298             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2299             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2300                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2301                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2302                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2303                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2304             20  CF-SYSTEM-E                 PIC X.
  2305                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2306
  2307         16  CF-LGX-LIFE-USER               PIC X.
  2308             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2309             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2310
  2311         16  CF-CR-MONTH-END-DT             PIC XX.
  2312
  2313         16  CF-FILE-MAINT-DATES.
  2314             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2315                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2316             20  CF-LAST-BATCH       REDEFINES
  2317                 CF-LAST-BATCH-NO               PIC X(4).
  2318             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2319             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2320             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2321             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2322             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2323             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2324             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2325             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2326             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2327             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2328
  2329         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2330         16  FILLER                         PIC X.
  2331
  2332         16  CF-ALT-MORT-CODE               PIC X(4).
  2333         16  CF-MEMBER-CAPTION              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  42
* EL677.cbl
  2334
  2335         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2336             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2337             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2338             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2339             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2340             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2341
  2342         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2343
  2344         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2345         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2346         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2347         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2348
  2349         16  CF-AH-OVERRIDE-L1              PIC X.
  2350         16  CF-AH-OVERRIDE-L2              PIC XX.
  2351         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2352         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2353
  2354         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2355         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2356
  2357         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2358         16  CF-AR-LAST-EL860-DT            PIC XX.
  2359         16  CF-MP-MONTH-END-DT             PIC XX.
  2360
  2361         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2362         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2363             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2364
  2365         16  CF-AR-MONTH-END-DT             PIC XX.
  2366
  2367         16  CF-CRDTCRD-USER                PIC X.
  2368             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2369             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2370
  2371         16  CF-CC-MONTH-END-DT             PIC XX.
  2372
  2373         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2374
  2375         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2376             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2377             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2378             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2379         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2380         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2381         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2382         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2383             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2384             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2385         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2386         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2387         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2388             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2389         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2390
  2391         16  CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  43
* EL677.cbl
  2392             20  CF-CL-ZIP-PRIME.
  2393                 24  CF-CL-ZIP-1ST          PIC X.
  2394                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2395                 24  FILLER                 PIC X(4).
  2396             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2397         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2398             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2399             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2400             20  FILLER                     PIC XXX.
  2401
  2402         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2403         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2404         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2405         16  CF-CO-OPTION-START-DATE        PIC XX.
  2406         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2407           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2408                                                      '3' '4'.
  2409           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2410           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2411           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2412           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2413           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2414           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2415
  2416         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2417
  2418         16  CF-PAYMENT-APPROVAL-LEVELS.
  2419             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2420             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2421             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2422             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2423             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2424             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2425
  2426         16  CF-END-USER-REPORTING-USER     PIC X.
  2427             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2428             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2429
  2430         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2431             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2432             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2433
  2434         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2435
  2436         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2437         16  FILLER                         PIC X.
  2438
  2439         16  CF-CREDIT-ARCHIVE-CNTL.
  2440             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2441             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2442             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2443
  2444         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2445
  2446         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2447             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2448             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2449
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  44
* EL677.cbl
  2450         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2451             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2452             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2453
  2454         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2455
  2456         16  CF-CO-ACH-ID-CODE              PIC  X.
  2457             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2458             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2459             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2460         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2461         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2462         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2463         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2464         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2465         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2466         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2467         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2468         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2469                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2470         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2471                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2472
  2473         16  CF-CO-OVER-SHORT.
  2474             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2475             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2476
  2477*         16  FILLER                         PIC X(102).
  2478         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2479             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2480             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2481
  2482         16  CF-AH-APPROVAL-DAYS.
  2483             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2484             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2485             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2486             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2487
  2488         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2489
  2490         16  CF-APPROV-LEV-5.
  2491             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2492             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2493             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2494
  2495         16  FILLER                         PIC X(68).
  2496****************************************************************
  2497*             PROCESSOR/USER RECORD                            *
  2498****************************************************************
  2499
  2500     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2501         16  CF-PROCESSOR-NAME              PIC X(30).
  2502         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2503         16  CF-PROCESSOR-TITLE             PIC X(26).
  2504         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2505                 88  MESSAGE-YES                VALUE 'Y'.
  2506                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2507
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  45
* EL677.cbl
  2508*****************************************************
  2509****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2510****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2511****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2512****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2513*****************************************************
  2514
  2515         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2516             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2517             20  CF-APPLICATION-FORCE       PIC X.
  2518             20  CF-INDIVIDUAL-APP.
  2519                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2520                     28  CF-BROWSE-APP      PIC X.
  2521                     28  CF-UPDATE-APP      PIC X.
  2522
  2523         16  CF-CURRENT-TERM-ON             PIC X(4).
  2524         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2525             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2526             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2527             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2528             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2529             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2530             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2531             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2532         16  CF-PROCESSOR-CARRIER           PIC X.
  2533             88  NO-CARRIER-SECURITY            VALUE ' '.
  2534         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2535             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2536         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2537             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2538         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2539             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2540
  2541         16  CF-PROC-SYS-ACCESS-SW.
  2542             20  CF-PROC-CREDIT-CLAIMS-SW.
  2543                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2544                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2545                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2546                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2547             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2548                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2549                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2550             20  CF-PROC-LIFE-GNRLDGR-SW.
  2551                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2552                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2553                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2554                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2555             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2556                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2557                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2558         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2559             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2560             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2561         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2562
  2563         16  CF-APPROVAL-LEVEL                  PIC X.
  2564             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2565             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  46
* EL677.cbl
  2566             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2567             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2568             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2569
  2570         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2571
  2572         16  CF-LANGUAGE-TYPE                   PIC X.
  2573             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2574             88  CF-LANG-IS-FR                      VALUE 'F'.
  2575
  2576         16  CF-CSR-IND                         PIC X.
  2577         16  FILLER                             PIC X(239).
  2578
  2579****************************************************************
  2580*             PROCESSOR/REMINDERS RECORD                       *
  2581****************************************************************
  2582
  2583     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2584         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2585             20  CF-START-REMIND-DT         PIC XX.
  2586             20  CF-END-REMIND-DT           PIC XX.
  2587             20  CF-REMINDER-TEXT           PIC X(50).
  2588         16  FILLER                         PIC X(296).
  2589
  2590
  2591****************************************************************
  2592*             STATE MASTER RECORD                              *
  2593****************************************************************
  2594
  2595     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2596         16  CF-STATE-ABBREVIATION          PIC XX.
  2597         16  CF-STATE-NAME                  PIC X(25).
  2598         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2599         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2600             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2601             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2602             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2603             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2604                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2605                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2606             20  CF-ST-PREM-REJECT-SW       PIC X.
  2607                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2608                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2609             20  CF-ST-REF-REJECT-SW        PIC X.
  2610                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2611                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2612         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2613         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2614         16  CF-ST-REFUND-RULES.
  2615             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2616             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2617             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2618         16  CF-ST-FST-PMT-EXTENSION.
  2619             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2620             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2621                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2622                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2623                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  47
* EL677.cbl
  2624                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2625         16  CF-ST-STATE-CALL.
  2626             20  CF-ST-CALL-UNEARNED        PIC X.
  2627             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2628             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2629         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2630             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2631             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2632         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2633         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2634         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2635         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2636         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2637         16  FILLER                         PIC X.
  2638         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2639             20  CF-ST-BENEFIT-CD           PIC XX.
  2640             20  CF-ST-BENEFIT-KIND         PIC X.
  2641                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2642                 88  CF-ST-AH-KIND              VALUE 'A'.
  2643             20  CF-ST-REM-TERM-CALC        PIC X.
  2644                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2645                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2646                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2647                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2648                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2649                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2650                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2651                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2652
  2653             20  CF-ST-REFUND-CALC          PIC X.
  2654                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2655                 88  ST-REFD-BY-R78             VALUE '1'.
  2656                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2657                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2658                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2659                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2660                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2661                 88  ST-REFD-UTAH               VALUE '7'.
  2662                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2663                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2664                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2665
  2666             20  CF-ST-EARNING-CALC         PIC X.
  2667                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2668                 88  ST-EARN-BY-R78             VALUE '1'.
  2669                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2670                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2671                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2672                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2673                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2674                 88  ST-EARN-MEAN               VALUE '8'.
  2675                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2676
  2677             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2678                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2679                 88  ST-OVRD-BY-R78             VALUE '1'.
  2680                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2681                 88  ST-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  48
* EL677.cbl
  2682                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2683                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2684                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2685                 88  ST-OVRD-MEAN               VALUE '8'.
  2686                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2687             20  cf-st-extra-periods        pic 9.
  2688*            20  FILLER                     PIC X.
  2689
  2690         16  CF-ST-COMMISSION-CAPS.
  2691             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2692             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2693             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2694             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2695         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2696                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2697
  2698         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2699
  2700         16  CF-ST-STATUTORY-INTEREST.
  2701             20  CF-ST-STAT-DATE-FROM       PIC X.
  2702                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2703                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2704             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2705             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2706             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2707             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2708             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2709
  2710         16  CF-ST-OVER-SHORT.
  2711             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2712             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2713
  2714         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2715
  2716         16  CF-ST-RT-CALC                  PIC X.
  2717
  2718         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2719         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2720         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2721         16  CF-ST-RF-LR-CALC               PIC X.
  2722         16  CF-ST-RF-LL-CALC               PIC X.
  2723         16  CF-ST-RF-LN-CALC               PIC X.
  2724         16  CF-ST-RF-AH-CALC               PIC X.
  2725         16  CF-ST-RF-CP-CALC               PIC X.
  2726*        16  FILLER                         PIC X(206).
  2727*CIDMOD         16  FILLER                         PIC X(192).
  2728         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2729             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2730         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2731         16  CF-ST-VFY-2ND-BENE             PIC X.
  2732         16  CF-ST-CAUSAL-STATE             PIC X.
  2733         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2734         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2735         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2736             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2737         16  CF-ST-NET-ONLY-STATE           PIC X.
  2738             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2739         16  FILLER                         PIC X(181).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  49
* EL677.cbl
  2740
  2741****************************************************************
  2742*             BENEFIT MASTER RECORD                            *
  2743****************************************************************
  2744
  2745     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2746         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2747             20  CF-BENEFIT-CODE            PIC XX.
  2748             20  CF-BENEFIT-NUMERIC  REDEFINES
  2749                 CF-BENEFIT-CODE            PIC XX.
  2750             20  CF-BENEFIT-ALPHA           PIC XXX.
  2751             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2752             20  CF-BENEFIT-COMMENT         PIC X(10).
  2753
  2754             20  CF-LF-COVERAGE-TYPE        PIC X.
  2755                 88  CF-REDUCING                VALUE 'R'.
  2756                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2757
  2758             20  CF-SPECIAL-CALC-CD         PIC X.
  2759                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2760                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2761                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2762                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2763                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2764                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2765                 88  CF-FARM-PLAN               VALUE 'F'.
  2766                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2767                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2768                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2769                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2770                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2771                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2772                 88  CF-PRUDENTIAL              VALUE 'P'.
  2773                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2774                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2775                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2776                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2777                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2778                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2779
  2780             20  CF-JOINT-INDICATOR         PIC X.
  2781                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2782
  2783*            20  FILLER                     PIC X(12).
  2784             20  cf-maximum-benefits        pic s999 comp-3.
  2785             20  FILLER                     PIC X(09).
  2786             20  CF-BENEFIT-CATEGORY        PIC X.
  2787             20  CF-LOAN-TYPE               PIC X(8).
  2788
  2789             20  CF-CO-REM-TERM-CALC        PIC X.
  2790                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2791                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2792                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2793                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2794                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2795
  2796             20  CF-CO-EARNINGS-CALC        PIC X.
  2797                 88  CO-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  50
* EL677.cbl
  2798                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2799                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2800                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2801                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2802                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2803                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2804                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2805
  2806             20  CF-CO-REFUND-CALC          PIC X.
  2807                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2808                 88  CO-REFD-BY-R78             VALUE '1'.
  2809                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2810                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2811                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2812                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2813                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2814                 88  CO-REFD-MEAN               VALUE '8'.
  2815                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2816                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2817                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2818
  2819             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2820                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2821                 88  CO-OVRD-BY-R78             VALUE '1'.
  2822                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2823                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2824                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2825                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2826                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2827                 88  CO-OVRD-MEAN               VALUE '8'.
  2828                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2829
  2830             20  CF-CO-BEN-I-G-CD           PIC X.
  2831                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2832                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2833                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2834
  2835         16  FILLER                         PIC X(304).
  2836
  2837
  2838****************************************************************
  2839*             CARRIER MASTER RECORD                            *
  2840****************************************************************
  2841
  2842     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2843         16  CF-ADDRESS-DATA.
  2844             20  CF-MAIL-TO-NAME            PIC X(30).
  2845             20  CF-IN-CARE-OF              PIC X(30).
  2846             20  CF-ADDRESS-LINE-1          PIC X(30).
  2847             20  CF-ADDRESS-LINE-2          PIC X(30).
  2848             20  CF-CITY-STATE              PIC X(30).
  2849             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2850             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2851
  2852         16  CF-CLAIM-NO-CONTROL.
  2853             20  CF-CLAIM-NO-METHOD         PIC X.
  2854                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2855                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  51
* EL677.cbl
  2856                 88  CLAIM-NO-SEQ               VALUE '3'.
  2857                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2858             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2859                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2860                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2861                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2862
  2863         16  CF-CHECK-NO-CONTROL.
  2864             20  CF-CHECK-NO-METHOD         PIC X.
  2865                 88  CHECK-NO-MANUAL            VALUE '1'.
  2866                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2867                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2868                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2869             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2870                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2871
  2872         16  CF-DOMICILE-STATE              PIC XX.
  2873
  2874         16  CF-EXPENSE-CONTROLS.
  2875             20  CF-EXPENSE-METHOD          PIC X.
  2876                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2877                 88  DOLLARS-PER-PMT            VALUE '2'.
  2878                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2879                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2880             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2881             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2882
  2883         16  CF-CORRESPONDENCE-CONTROL.
  2884             20  CF-LETTER-RESEND-OPT       PIC X.
  2885                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2886                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2887             20  FILLER                     PIC X(4).
  2888
  2889         16  CF-RESERVE-CONTROLS.
  2890             20  CF-MANUAL-SW               PIC X.
  2891                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2892             20  CF-FUTURE-SW               PIC X.
  2893                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2894             20  CF-PTC-SW                  PIC X.
  2895                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2896             20  CF-IBNR-SW                 PIC X.
  2897                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2898             20  CF-PTC-LF-SW               PIC X.
  2899                 88  CF-LF-PTC-USED             VALUE '1'.
  2900             20  CF-CDT-ACCESS-METHOD       PIC X.
  2901                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2902                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2903                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2904             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2905
  2906         16  CF-CLAIM-CALC-METHOD           PIC X.
  2907             88  360-PLUS-MONTHS                VALUE '1'.
  2908             88  365-PLUS-MONTHS                VALUE '2'.
  2909             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2910             88  360-DAILY                      VALUE '4'.
  2911             88  365-DAILY                      VALUE '5'.
  2912
  2913         16  CF-LAST-ALPHA-CHARACTER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  52
* EL677.cbl
  2914         16  FILLER                         PIC X(11).
  2915
  2916         16  CF-LIMIT-AMOUNTS.
  2917             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2918             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2919             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2920             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2921             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2922             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2923             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2924             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2925             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2926             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2927
  2928         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2929         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2930         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2931
  2932         16  CF-ZIP-CODE.
  2933             20  CF-ZIP-PRIME.
  2934                 24  CF-ZIP-1ST             PIC X.
  2935                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2936                 24  FILLER                 PIC X(4).
  2937             20  CF-ZIP-PLUS4               PIC X(4).
  2938         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2939             20  CF-CAN-POSTAL-1            PIC XXX.
  2940             20  CF-CAN-POSTAL-2            PIC XXX.
  2941             20  FILLER                     PIC XXX.
  2942
  2943         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2944         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2945         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2946
  2947         16  CF-RATING-SWITCH               PIC X.
  2948             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2949             88  CF-NO-RATING                   VALUE 'N'.
  2950
  2951         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2952
  2953         16  CF-CARRIER-OVER-SHORT.
  2954             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2955             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2956
  2957         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2958         16  CF-SECPAY-SWITCH               PIC X.
  2959             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2960             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2961         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2962         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2963         16  FILLER                         PIC X(444).
  2964*        16  FILLER                         PIC X(452).
  2965
  2966
  2967****************************************************************
  2968*             MORTALITY MASTER RECORD                          *
  2969****************************************************************
  2970
  2971     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  53
* EL677.cbl
  2972         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2973                                INDEXED BY CF-MORT-NDX.
  2974             20  CF-MORT-TABLE              PIC X(5).
  2975             20  CF-MORT-TABLE-TYPE         PIC X.
  2976                 88  CF-MORT-JOINT              VALUE 'J'.
  2977                 88  CF-MORT-SINGLE             VALUE 'S'.
  2978                 88  CF-MORT-COMBINED           VALUE 'C'.
  2979                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2980                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2981             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2982             20  CF-MORT-AGE-METHOD         PIC XX.
  2983                 88  CF-AGE-LAST                VALUE 'AL'.
  2984                 88  CF-AGE-NEAR                VALUE 'AN'.
  2985             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2986             20  CF-MORT-ADJUSTMENT-DIRECTION
  2987                                            PIC X.
  2988                 88  CF-MINUS                   VALUE '-'.
  2989                 88  CF-PLUS                    VALUE '+'.
  2990             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2991             20  CF-MORT-JOINT-CODE         PIC X.
  2992                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2993             20  CF-MORT-PC-Q               PIC X.
  2994                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2995             20  CF-MORT-TABLE-CODE         PIC X(4).
  2996             20  CF-MORT-COMMENTS           PIC X(15).
  2997             20  FILLER                     PIC X(14).
  2998
  2999         16  FILLER                         PIC X(251).
  3000
  3001
  3002****************************************************************
  3003*             BUSSINESS TYPE MASTER RECORD                     *
  3004****************************************************************
  3005
  3006     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3007* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3008* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3009* AND RECORD 05 IS TYPES 81-99
  3010         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3011             20  CF-BUSINESS-TITLE          PIC  X(19).
  3012             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3013                                            PIC S9V9(4) COMP-3.
  3014             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3015             20  FILLER                     PIC  X.
  3016         16  FILLER                         PIC  X(248).
  3017
  3018
  3019****************************************************************
  3020*             TERMINAL MASTER RECORD                           *
  3021****************************************************************
  3022
  3023     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3024
  3025         16  CF-COMPANY-TERMINALS.
  3026             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3027                                  PIC X(4).
  3028         16  FILLER               PIC X(248).
  3029
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  54
* EL677.cbl
  3030
  3031****************************************************************
  3032*             LIFE EDIT MASTER RECORD                          *
  3033****************************************************************
  3034
  3035     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3036         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3037             20  CF-LIFE-CODE-IN            PIC XX.
  3038             20  CF-LIFE-CODE-OUT           PIC XX.
  3039         16  FILLER                         PIC X(248).
  3040
  3041
  3042****************************************************************
  3043*             AH EDIT MASTER RECORD                            *
  3044****************************************************************
  3045
  3046     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3047         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3048             20  CF-AH-CODE-IN              PIC XXX.
  3049             20  CF-AH-CODE-OUT             PIC XX.
  3050         16  FILLER                         PIC X(248).
  3051
  3052
  3053****************************************************************
  3054*             CREDIBILITY TABLES                               *
  3055****************************************************************
  3056
  3057     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3058         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3059                             INDEXED BY CF-CRDB-NDX.
  3060             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3061             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3062             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3063         16  FILLER                         PIC  X(332).
  3064
  3065
  3066****************************************************************
  3067*             REPORT CUSTOMIZATION RECORD                      *
  3068****************************************************************
  3069
  3070     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3071         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3072             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3073             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3074             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3075**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3076****       A T-TRANSFER.                                   ****
  3077             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3078
  3079         16  FILLER                         PIC XX.
  3080
  3081         16  CF-CARRIER-CNTL-OPT.
  3082             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3083                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3084                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3085             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3086                                            PIC X.
  3087         16  CF-GROUP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  55
* EL677.cbl
  3088             20  CF-GROUP-OPT-SEQ           PIC 9.
  3089                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3090                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3091             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3092                                            PIC X(6).
  3093         16  CF-STATE-CNTL-OPT.
  3094             20  CF-STATE-OPT-SEQ           PIC 9.
  3095                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3096                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3097             20  CF-STATE-SELECT OCCURS 3 TIMES
  3098                                            PIC XX.
  3099         16  CF-ACCOUNT-CNTL-OPT.
  3100             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3101                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3102                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3103             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3104                                            PIC X(10).
  3105         16  CF-BUS-TYP-CNTL-OPT.
  3106             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3107                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3108                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3109             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3110                                            PIC XX.
  3111         16  CF-LF-TYP-CNTL-OPT.
  3112             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3113                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3114                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3115             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3116                                            PIC XX.
  3117         16  CF-AH-TYP-CNTL-OPT.
  3118             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3119                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3120                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3121             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3122                                            PIC XX.
  3123         16  CF-REPTCD1-CNTL-OPT.
  3124             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3125                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3126                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3127             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3128                                            PIC X(10).
  3129         16  CF-REPTCD2-CNTL-OPT.
  3130             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3131                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3132                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3133             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3134                                            PIC X(10).
  3135         16  CF-USER1-CNTL-OPT.
  3136             20  CF-USER1-OPT-SEQ           PIC 9.
  3137                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3138                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3139             20  CF-USER1-SELECT OCCURS 3 TIMES
  3140                                            PIC X(10).
  3141         16  CF-USER2-CNTL-OPT.
  3142             20  CF-USER2-OPT-SEQ           PIC 9.
  3143                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3144                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3145             20  CF-USER2-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  56
* EL677.cbl
  3146                                            PIC X(10).
  3147         16  CF-USER3-CNTL-OPT.
  3148             20  CF-USER3-OPT-SEQ           PIC 9.
  3149                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3150                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3151             20  CF-USER3-SELECT OCCURS 3 TIMES
  3152                                            PIC X(10).
  3153         16  CF-USER4-CNTL-OPT.
  3154             20  CF-USER4-OPT-SEQ           PIC 9.
  3155                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3156                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3157             20  CF-USER4-SELECT OCCURS 3 TIMES
  3158                                            PIC X(10).
  3159         16  CF-USER5-CNTL-OPT.
  3160             20  CF-USER5-OPT-SEQ           PIC 9.
  3161                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3162                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3163             20  CF-USER5-SELECT OCCURS 3 TIMES
  3164                                            PIC X(10).
  3165         16  CF-REINS-CNTL-OPT.
  3166             20  CF-REINS-OPT-SEQ           PIC 9.
  3167                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3168                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3169             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3170                 24  CF-REINS-PRIME         PIC XXX.
  3171                 24  CF-REINS-SUB           PIC XXX.
  3172
  3173         16  CF-AGENT-CNTL-OPT.
  3174             20  CF-AGENT-OPT-SEQ           PIC 9.
  3175                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3176                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3177             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3178                                            PIC X(10).
  3179
  3180         16  FILLER                         PIC X(43).
  3181
  3182         16  CF-LOSS-RATIO-SELECT.
  3183             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3184             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3185         16  CF-ENTRY-DATE-SELECT.
  3186             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3187             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3188         16  CF-EFFECTIVE-DATE-SELECT.
  3189             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3190             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3191
  3192         16  CF-EXCEPTION-LIST-IND          PIC X.
  3193             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3194
  3195         16  FILLER                         PIC X(318).
  3196
  3197****************************************************************
  3198*                  EXCEPTION REPORTING RECORD                  *
  3199****************************************************************
  3200
  3201     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3202         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3203             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  57
* EL677.cbl
  3204
  3205         16  CF-COMBINED-LIFE-AH-OPT.
  3206             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3207             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3208             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3209             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3210
  3211         16  CF-LIFE-OPT.
  3212             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3213             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3214             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3215             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3216             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3217             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3218             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3219             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3220             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3221             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3222
  3223         16  CF-AH-OPT.
  3224             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3225             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3226             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3227             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3228             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3229             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3230             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3231             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3232             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3233             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3234
  3235         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3236             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3237             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3238             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3239
  3240         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3241
  3242         16  FILLER                         PIC X(673).
  3243
  3244
  3245****************************************************************
  3246*             MORTGAGE SYSTEM PLAN RECORD                      *
  3247****************************************************************
  3248
  3249     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3250         16  CF-PLAN-TYPE                   PIC X.
  3251             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3252             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3253             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3254         16  CF-PLAN-ABBREV                 PIC XXX.
  3255         16  CF-PLAN-DESCRIPT               PIC X(10).
  3256         16  CF-PLAN-NOTES                  PIC X(20).
  3257         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3258         16  CF-PLAN-UNDERWRITING.
  3259             20  CF-PLAN-TERM-DATA.
  3260                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3261                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  58
* EL677.cbl
  3262             20  CF-PLAN-AGE-DATA.
  3263                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3264                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3265                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3266             20  CF-PLAN-BENEFIT-DATA.
  3267                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3268                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3269                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3270                                            PIC S9(7)V99  COMP-3.
  3271         16  CF-PLAN-POLICY-FORMS.
  3272             20  CF-POLICY-FORM             PIC X(12).
  3273             20  CF-MASTER-APPLICATION      PIC X(12).
  3274             20  CF-MASTER-POLICY           PIC X(12).
  3275         16  CF-PLAN-RATING.
  3276             20  CF-RATE-CODE               PIC X(5).
  3277             20  CF-SEX-RATING              PIC X.
  3278                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3279                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3280             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3281             20  CF-SUB-STD-TYPE            PIC X.
  3282                 88  CF-PCT-OF-PREM            VALUE '1'.
  3283                 88  CF-PCT-OF-BENE            VALUE '2'.
  3284         16  CF-PLAN-PREM-TOLERANCES.
  3285             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3286             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3287         16  CF-PLAN-PYMT-TOLERANCES.
  3288             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3289             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3290         16  CF-PLAN-MISC-DATA.
  3291             20  FILLER                     PIC X.
  3292             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3293             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3294         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3295         16  CF-PLAN-IND-GRP                PIC X.
  3296             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3297                                                     '1'.
  3298             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3299                                                     '2'.
  3300         16  CF-MIB-SEARCH-SW               PIC X.
  3301             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3302             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3303             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3304             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3305         16  CF-ALPHA-SEARCH-SW             PIC X.
  3306             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3307             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3308             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3309             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3310             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3311             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3312             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3313             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3314             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3315             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3316                                                     'A' 'B' 'C'
  3317                                                     'X' 'Y' 'Z'.
  3318         16  CF-EFF-DT-RULE-SW              PIC X.
  3319             88  CF-EFF-DT-ENTER               VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  59
* EL677.cbl
  3320             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3321             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3322             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3323             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3324         16  FILLER                         PIC X(4).
  3325         16  CF-HEALTH-QUESTIONS            PIC X.
  3326             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3327         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3328         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3329         16  CF-PLAN-SNGL-JNT               PIC X.
  3330             88  CF-COMBINED-PLAN              VALUE 'C'.
  3331             88  CF-JNT-PLAN                   VALUE 'J'.
  3332             88  CF-SNGL-PLAN                  VALUE 'S'.
  3333         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3334         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3335         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3336         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3337         16  CF-RERATE-CNTL                 PIC  X.
  3338             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3339             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3340             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3341             88  CF-AUTO-RECALC                 VALUE '4'.
  3342         16  CF-BENEFIT-TYPE                PIC  X.
  3343             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3344             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3345         16  CF-POLICY-FEE                  PIC S999V99
  3346                                                    COMP-3.
  3347         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3348         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3349         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3350         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3351         16  FILLER                         PIC  X(32).
  3352         16  CF-TERMINATION-FORM            PIC  X(04).
  3353         16  FILLER                         PIC  X(08).
  3354         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3355                                                       COMP-3.
  3356         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3357         16  CF-ISSUE-LETTER                PIC  X(4).
  3358         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3359         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3360             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3361             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3362         16  CF-MP-REFUND-CALC              PIC X.
  3363             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3364             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3365             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3366             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3367             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3368             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3369             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3370             88  CF-MP-REFD-MEAN                VALUE '8'.
  3371         16  CF-ALT-RATE-CODE               PIC  X(5).
  3372
  3373
  3374         16  FILLER                         PIC X(498).
  3375****************************************************************
  3376*             MORTGAGE COMPANY MASTER RECORD                   *
  3377****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  60
* EL677.cbl
  3378
  3379     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3380         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3381         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3382             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3383             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3384             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3385             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3386             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3387
  3388         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3389         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3390         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3391         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3392         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3393
  3394         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3395             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3396         16  CF-MP-RECON-USE-IND            PIC X(1).
  3397             88  CF-MP-USE-RECON             VALUE 'Y'.
  3398         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3399             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3400         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3401             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3402             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3403         16  FILLER                         PIC X(1).
  3404         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3405             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3406         16  CF-MORTG-MIB-VERSION           PIC X.
  3407             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3408             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3409             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3410         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3411             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3412                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3413             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3414                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3415             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3416                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3417             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3418                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3419             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3420                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3421             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3422                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3423         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3424         16  FILLER                         PIC X(7).
  3425         16  CF-MORTG-DESTINATION-SYMBOL.
  3426             20  CF-MORTG-MIB-COMM          PIC X(5).
  3427             20  CF-MORTG-MIB-TERM          PIC X(5).
  3428         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3429             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3430         16  FILLER                         PIC X(03).
  3431         16  CF-MP-CHECK-NO-CONTROL.
  3432             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3433                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3434                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3435                                                ' ' LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  61
* EL677.cbl
  3436                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3437                                               VALUE '3'.
  3438         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3439         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3440         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3441             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3442                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3443             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3444                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3445             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3446                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3447             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3448                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3449             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3450                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3451             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3452                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3453         16  CF-MORTG-BILLING-AREA.
  3454             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3455                                            PIC X.
  3456         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3457         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3458         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3459         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3460             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3461             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3462         16  FILLER                         PIC X.
  3463         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3464             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3465             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3466         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3467         16  FILLER                         PIC X(8).
  3468         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3469         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3470         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3471         16  CF-ACH-COMPANY-ID.
  3472             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3473                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3474                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3475                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3476             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3477         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3478             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3479         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3480             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3481             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3482         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3483         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3484         16  FILLER                         PIC X(536).
  3485
  3486****************************************************************
  3487*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3488****************************************************************
  3489
  3490     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3491         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3492             20  CF-FEMALE-HEIGHT.
  3493                 24  CF-FEMALE-FT           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  62
* EL677.cbl
  3494                 24  CF-FEMALE-IN           PIC 99.
  3495             20  CF-FEMALE-MIN-WT           PIC 999.
  3496             20  CF-FEMALE-MAX-WT           PIC 999.
  3497         16  FILLER                         PIC X(428).
  3498
  3499     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3500         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3501             20  CF-MALE-HEIGHT.
  3502                 24  CF-MALE-FT             PIC 99.
  3503                 24  CF-MALE-IN             PIC 99.
  3504             20  CF-MALE-MIN-WT             PIC 999.
  3505             20  CF-MALE-MAX-WT             PIC 999.
  3506         16  FILLER                         PIC X(428).
  3507******************************************************************
  3508*             AUTOMATIC ACTIVITY RECORD                          *
  3509******************************************************************
  3510     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3511         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3512             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3513             20  CF-SYS-LETTER-ID           PIC X(04).
  3514             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3515             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3516             20  CF-SYS-RESET-SW            PIC X(01).
  3517             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3518             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3519
  3520         16  FILLER                         PIC X(50).
  3521
  3522         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3523             20  CF-USER-ACTIVE-SW          PIC X(01).
  3524             20  CF-USER-LETTER-ID          PIC X(04).
  3525             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3526             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3527             20  CF-USER-RESET-SW           PIC X(01).
  3528             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3529             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3530             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3531
  3532         16  FILLER                         PIC X(246).
  3533*                                    COPY ERCCHEK.
  3534******************************************************************
  3535*                                                                *
  3536*                                                                *
  3537*                            ERCCHEK                             *
  3538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3539*                            VMOD=2.008                          *
  3540*                                                                *
  3541*   FILE DESCRIPTION = CHECK RECORDS                             *
  3542*                                                                *
  3543*   FILE TYPE = VSAM,KSDS                                        *
  3544*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3545*                                                                *
  3546*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3547*       ALTERNATE INDEX = NONE                                   *
  3548*                                                                *
  3549*   LOG = YES                                                    *
  3550*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3551******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  63
* EL677.cbl
  3552*                   C H A N G E   L O G
  3553*
  3554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3555*-----------------------------------------------------------------
  3556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3557* EFFECTIVE    NUMBER
  3558*-----------------------------------------------------------------
  3559* 021414    2003053000001  PEMA  changes for auto chk request
  3560******************************************************************
  3561 01  CHECK-RECORDS.
  3562     12  CH-RECORD-ID                      PIC XX.
  3563         88  VALID-CH-ID                      VALUE 'CH'.
  3564
  3565     12  CH-CONTROL-PRIMARY.
  3566         16  CH-COMPANY-CD                 PIC X.
  3567         16  CH-CARRIER                    PIC X.
  3568         16  CH-GROUPING                   PIC X(6).
  3569         16  CH-STATE                      PIC XX.
  3570         16  CH-ACCOUNT                    PIC X(10).
  3571         16  CH-CERT-EFF-DT                PIC XX.
  3572         16  CH-CERT-NO.
  3573             20  CH-CERT-PRIME             PIC X(10).
  3574             20  CH-CERT-SFX               PIC X.
  3575         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3576
  3577     12  CH-RECORDED-DT                    PIC XX.
  3578     12  CH-RECORDED-BY                    PIC X(4).
  3579     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3580
  3581     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3582     12  CH-CHECK-NO                       PIC X(7).
  3583     12  CH-REASON-FOR-CHECK               PIC X(25).
  3584     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3585     12  FILLER                            PIC X.
  3586
  3587     12  CH-PAYEE-INFO.
  3588         16  CH-PAYEE-NAME-1               PIC X(30).
  3589         16  CH-PAYEE-NAME-2               PIC X(30).
  3590         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3591         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3592         16  CH-PAYEE-CITY-ST.
  3593             20  CH-PAYEE-CITY             PIC X(28).
  3594             20  CH-PAYEE-STATE            PIC XX.
  3595         16  CH-PAYEE-ZIP-CODE.
  3596             20  CH-PAYEE-ZIP.
  3597                 24  CH-ZIP-PRI-1ST        PIC X.
  3598                     88  CH-CANADIAN-POST-CODE
  3599                                           VALUES 'A' THRU 'Z'.
  3600                 24  FILLER                PIC X(4).
  3601             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3602         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3603             20  CH-CAN-POSTAL-1           PIC XXX.
  3604             20  CH-CAN-POSTAL-2           PIC XXX.
  3605             20  FILLER                    PIC XXX.
  3606
  3607     12  CH-CHECK-STUB-TEXT.
  3608         16  CH-STUB-LINE-1                PIC X(30).
  3609         16  CH-TEXT-LINE-1                PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  64
* EL677.cbl
  3610         16  CH-TEXT-LINE-2                PIC X(50).
  3611         16  CH-TEXT-LINE-3                PIC X(40).
  3612     12  CH-RETURN-TO                      PIC X(30).
  3613
  3614     12  CH-COMPENSATION-CONTROL.
  3615         16  CH-COMP-CARRIER               PIC X.
  3616         16  CH-COMP-GROUPING              PIC X(6).
  3617         16  CH-COMP-FIN-RESP              PIC X(10).
  3618         16  CH-COMP-ACCOUNT               PIC X(10).
  3619
  3620     12  CH-CREDIT-SELECT-DT               PIC XX.
  3621     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3622     12  CH-PAYEE-CODE                     PIC X(6).
  3623
  3624     12  CH-VOID-DATA.
  3625         20  CH-VOID-DT                    PIC XX.
  3626         20  CH-VOID-BY                    PIC X(4).
  3627         20  CH-VOID-REASON                PIC X(25).
  3628
  3629     12  CH-APPROVAL-DATA.
  3630         20  CH-APPROVAL-DT                PIC XX.
  3631         20  CH-APPROVAL-STATUS            PIC X.
  3632             88  CH-IN-LIMBO                  VALUE ' '.
  3633             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3634             88  CH-APPROVED                  VALUE 'A'.
  3635             88  CH-DENIED                    VALUE 'D'.
  3636         20  CH-APPROVED-BY                PIC XXXX.
  3637     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3638             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3639     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3640
  3641     12  ch-released-dt                    pic xx.
  3642     12  ch-check-cashed-dt                pic xx.
  3643     12  FILLER                            PIC X.
  3644*    12  CH-CHECK-REFERENCE                PIC X(12).
  3645     12  CH-CHECK-ORIGIN-SW                PIC X.
  3646             88  CH-REFUND-CHECK              VALUE 'R'.
  3647             88  CH-MAINT-CHECK               VALUE 'M'.
  3648
  3649     12  CH-CANC-DT                        PIC XX.
  3650     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3651     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3652
  3653     12  CH-INSURED-NAME                   PIC X(28).
  3654
  3655     12  ch-released-by                    pic x(4).
  3656     12  ch-csr                            pic x(4).
  3657     12  ch-deduct-commission              pic x.
  3658         88  ch-deduct-comm                  value 'Y'.
  3659         88  ch-do-not-deduct-comm           value 'N'.
  3660
  3661     12  FILLER                            PIC X(11).
  3662*    12  CH-LETTER-TABLE.
  3663*        16  CH-LETTERS OCCURS 3 TIMES
  3664*                       INDEXED BY CH-LT-NDX
  3665*                                          PIC X(04).
  3666
  3667     12  FILLER                            PIC X(07).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  65
* EL677.cbl
  3668
  3669*                                    COPY ERCACCT.
  3670******************************************************************
  3671*                                                                *
  3672*                                                                *
  3673*                            ERCACCT                             *
  3674*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3675*                            VMOD=2.031                          *
  3676*                                                                *
  3677*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3678*                                                                *
  3679*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3680*   VSAM ACCOUNT MASTER FILES.                                   *
  3681*                                                                *
  3682*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3683*                                                                *
  3684*   FILE TYPE = VSAM,KSDS                                        *
  3685*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3686*                                                                *
  3687*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3688*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3689*                                                                *
  3690*   LOG = NO                                                     *
  3691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3692*                                                                *
  3693*                                                                *
  3694******************************************************************
  3695*                   C H A N G E   L O G
  3696*
  3697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3698*-----------------------------------------------------------------
  3699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3700* EFFECTIVE    NUMBER
  3701*-----------------------------------------------------------------
  3702* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3703* 092705    2005050300006  PEMA  ADD SPP LEASES
  3704* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3705* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3706* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3707* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3708* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3709* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3710******************************************************************
  3711
  3712 01  ACCOUNT-MASTER.
  3713     12  AM-RECORD-ID                      PIC XX.
  3714         88  VALID-AM-ID                      VALUE 'AM'.
  3715
  3716     12  AM-CONTROL-PRIMARY.
  3717         16  AM-COMPANY-CD                 PIC X.
  3718         16  AM-MSTR-CNTRL.
  3719             20  AM-CONTROL-A.
  3720                 24  AM-CARRIER            PIC X.
  3721                 24  AM-GROUPING.
  3722                     28 AM-GROUPING-PREFIX PIC XXX.
  3723                     28 AM-GROUPING-PRIME  PIC XXX.
  3724                 24  AM-STATE              PIC XX.
  3725                 24  AM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  66
* EL677.cbl
  3726                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3727                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3728             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3729                                           PIC X(19).
  3730             20  AM-CNTRL-B.
  3731                 24  AM-EXPIRATION-DT      PIC XX.
  3732                 24  FILLER                PIC X(4).
  3733             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3734                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3735
  3736     12  AM-CONTROL-BY-VAR-GRP.
  3737         16  AM-COMPANY-CD-A1              PIC X.
  3738         16  AM-VG-CARRIER                 PIC X.
  3739         16  AM-VG-GROUPING                PIC X(6).
  3740         16  AM-VG-STATE                   PIC XX.
  3741         16  AM-VG-ACCOUNT                 PIC X(10).
  3742         16  AM-VG-DATE.
  3743             20  AM-VG-EXPIRATION-DT       PIC XX.
  3744             20  FILLER                    PIC X(4).
  3745         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3746                                           PIC 9(11)      COMP-3.
  3747     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3748         16  FILLER                        PIC X(10).
  3749         16  AM-VG-KEY3.
  3750             20  AM-VG3-ACCOUNT            PIC X(10).
  3751             20  AM-VG3-EXP-DT             PIC XX.
  3752         16  FILLER                        PIC X(4).
  3753     12  AM-MAINT-INFORMATION.
  3754         16  AM-LAST-MAINT-DT              PIC XX.
  3755         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3756         16  AM-LAST-MAINT-USER            PIC X(4).
  3757         16  FILLER                        PIC XX.
  3758
  3759     12  AM-EFFECTIVE-DT                   PIC XX.
  3760     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3761
  3762     12  AM-PREV-DATES  COMP-3.
  3763         16  AM-PREV-EXP-DT                PIC 9(11).
  3764         16  AM-PREV-EFF-DT                PIC 9(11).
  3765
  3766     12  AM-REPORT-CODE-1                  PIC X(10).
  3767     12  AM-REPORT-CODE-2                  PIC X(10).
  3768
  3769     12  AM-CITY-CODE                      PIC X(4).
  3770     12  AM-COUNTY-PARISH                  PIC X(6).
  3771
  3772     12  AM-NAME                           PIC X(30).
  3773     12  AM-PERSON                         PIC X(30).
  3774     12  AM-ADDRS                          PIC X(30).
  3775     12  AM-CITY.
  3776         16  AM-ADDR-CITY                  PIC X(28).
  3777         16  AM-ADDR-STATE                 PIC XX.
  3778     12  AM-ZIP.
  3779         16  AM-ZIP-PRIME.
  3780             20  AM-ZIP-PRI-1ST            PIC X.
  3781                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3782             20  FILLER                    PIC X(4).
  3783         16  AM-ZIP-PLUS4                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  67
* EL677.cbl
  3784     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3785         16  AM-CAN-POSTAL-1               PIC XXX.
  3786         16  AM-CAN-POSTAL-2               PIC XXX.
  3787         16  FILLER                        PIC XXX.
  3788     12  AM-TEL-NO.
  3789         16  AM-AREA-CODE                  PIC 999.
  3790         16  AM-TEL-PRE                    PIC 999.
  3791         16  AM-TEL-NBR                    PIC 9(4).
  3792     12  AM-TEL-LOC                        PIC X.
  3793         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3794         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3795
  3796     12  AM-COMM-STRUCTURE.
  3797         16  AM-DEFN-1.
  3798             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3799                 24  AM-AGT.
  3800                     28  AM-AGT-PREFIX     PIC X(4).
  3801                     28  AM-AGT-PRIME      PIC X(6).
  3802                 24  AM-COM-TYP            PIC X.
  3803                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3804                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3805                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3806                 24  AM-RECALC-LV-INDIC    PIC X.
  3807                 24  AM-RETRO-LV-INDIC     PIC X.
  3808                 24  AM-GL-CODES           PIC X.
  3809                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3810                 24  FILLER                PIC X(01).
  3811         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3812             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3813                 24  FILLER                PIC X(11).
  3814                 24  AM-L-COMA             PIC XXX.
  3815                 24  AM-J-COMA             PIC XXX.
  3816                 24  AM-A-COMA             PIC XXX.
  3817                 24  FILLER                PIC X(6).
  3818
  3819     12  AM-COMM-CHANGE-STATUS             PIC X.
  3820         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3821
  3822     12  AM-CSR-CODE                       PIC X(4).
  3823
  3824     12  AM-BILLING-STATUS                 PIC X.
  3825         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3826         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3827     12  AM-AUTO-REFUND-SW                 PIC X.
  3828         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3829         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3830     12  AM-GPCD                           PIC 99.
  3831     12  AM-IG                             PIC X.
  3832         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3833         88  AM-HAS-GROUP                     VALUE '2'.
  3834     12  AM-STATUS                         PIC X.
  3835         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3836         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3837         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3838         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3839         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3840         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3841         88  AM-ACCOUNT-DROPPED               VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  68
* EL677.cbl
  3842         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3843         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3844         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3845     12  AM-REMIT-TO                       PIC 99.
  3846     12  AM-ID-NO                          PIC X(11).
  3847
  3848     12  AM-CAL-TABLE                      PIC XX.
  3849     12  AM-LF-DEVIATION                   PIC XXX.
  3850     12  AM-AH-DEVIATION                   PIC XXX.
  3851     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3852     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3853     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3854     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3855     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3856     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3857
  3858     12  AM-USER-FIELDS.
  3859         16  AM-FLD-1                      PIC XX.
  3860         16  AM-FLD-2                      PIC XX.
  3861         16  AM-FLD-3                      PIC XX.
  3862         16  AM-FLD-4                      PIC XX.
  3863         16  AM-FLD-5                      PIC XX.
  3864
  3865     12  AM-1ST-PROD-DATE.
  3866         16  AM-1ST-PROD-YR                PIC XX.
  3867         16  AM-1ST-PROD-MO                PIC XX.
  3868         16  AM-1ST-PROD-DA                PIC XX.
  3869     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3870     12  AM-CERTS-PURGED-DATE.
  3871         16  AM-PUR-YR                     PIC XX.
  3872         16  AM-PUR-MO                     PIC XX.
  3873         16  AM-PUR-DA                     PIC XX.
  3874     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3875     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3876     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3877     12  AM-INACTIVE-DATE.
  3878         16  AM-INA-MO                     PIC 99.
  3879         16  AM-INA-DA                     PIC 99.
  3880         16  AM-INA-YR                     PIC 99.
  3881     12  AM-AR-HI-CERT-DATE                PIC XX.
  3882
  3883     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3884     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3885
  3886     12  AM-OB-PAYMENT-MODE                PIC X.
  3887         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3888         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3889         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3890         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3891
  3892     12  AM-AH-ONLY-INDICATOR              PIC X.
  3893         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3894         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3895
  3896     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3897
  3898     12  AM-OVER-SHORT.
  3899         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  69
* EL677.cbl
  3900         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3901
  3902     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3903     12  AM-DCC-CLP-STATE                  PIC XX.
  3904
  3905     12  AM-RECALC-COMM                    PIC X.
  3906     12  AM-RECALC-REIN                    PIC X.
  3907
  3908     12  AM-REI-TABLE                      PIC XXX.
  3909     12  AM-REI-ET-LF                      PIC X.
  3910     12  AM-REI-ET-AH                      PIC X.
  3911     12  AM-REI-PE-LF                      PIC X.
  3912     12  AM-REI-PE-AH                      PIC X.
  3913     12  AM-REI-PRT-ST                     PIC X.
  3914     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3915     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3916     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3917     12  AM-REI-GROUP-A                    PIC X(6).
  3918     12  AM-REI-MORT                       PIC X(4).
  3919     12  AM-REI-PRT-OW                     PIC X.
  3920     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3921     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3922     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3923     12  AM-REI-GROUP-B                    PIC X(6).
  3924
  3925     12  AM-TRUST-TYPE                     PIC X(2).
  3926
  3927     12  AM-EMPLOYER-STMT-USED             PIC X.
  3928     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3929
  3930     12  AM-STD-AH-TYPE                    PIC XX.
  3931     12  AM-EARN-METHODS.
  3932         16  AM-EARN-METHOD-R              PIC X.
  3933             88 AM-REF-RL-R78                 VALUE 'R'.
  3934             88 AM-REF-RL-PR                  VALUE 'P'.
  3935             88 AM-REF-RL-MEAN                VALUE 'M'.
  3936             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3937         16  AM-EARN-METHOD-L              PIC X.
  3938             88 AM-REF-LL-R78                 VALUE 'R'.
  3939             88 AM-REF-LL-PR                  VALUE 'P'.
  3940             88 AM-REF-LL-MEAN                VALUE 'M'.
  3941             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3942         16  AM-EARN-METHOD-A              PIC X.
  3943             88 AM-REF-AH-R78                 VALUE 'R'.
  3944             88 AM-REF-AH-PR                  VALUE 'P'.
  3945             88 AM-REF-AH-MEAN                VALUE 'M'.
  3946             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3947             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3948             88 AM-REF-AH-NET                 VALUE 'N'.
  3949
  3950     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3951     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3952     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3953
  3954     12  AM-RET-Y-N                        PIC X.
  3955     12  AM-RET-P-E                        PIC X.
  3956     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3957     12  AM-AH-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  70
* EL677.cbl
  3958     12  AM-RET-GRP                        PIC X(6).
  3959     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3960         16  AM-POOL-PRIME                 PIC XXX.
  3961         16  AM-POOL-SUB                   PIC XXX.
  3962     12  AM-RETRO-EARNINGS.
  3963         16  AM-RET-EARN-R                 PIC X.
  3964         16  AM-RET-EARN-L                 PIC X.
  3965         16  AM-RET-EARN-A                 PIC X.
  3966     12  AM-RET-ST-TAX-USE                 PIC X.
  3967         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3968         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3969     12  AM-RETRO-BEG-EARNINGS.
  3970         16  AM-RET-BEG-EARN-R             PIC X.
  3971         16  AM-RET-BEG-EARN-L             PIC X.
  3972         16  AM-RET-BEG-EARN-A             PIC X.
  3973     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3974     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3975
  3976     12  AM-USER-SELECT-OPTIONS.
  3977         16  AM-USER-SELECT-1              PIC X(10).
  3978         16  AM-USER-SELECT-2              PIC X(10).
  3979         16  AM-USER-SELECT-3              PIC X(10).
  3980         16  AM-USER-SELECT-4              PIC X(10).
  3981         16  AM-USER-SELECT-5              PIC X(10).
  3982
  3983     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3984
  3985     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3986
  3987     12  AM-RPT045A-SWITCH                 PIC X.
  3988         88  RPT045A-OFF                   VALUE 'N'.
  3989
  3990     12  AM-INSURANCE-LIMITS.
  3991         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3992         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3993
  3994     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3995         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3996
  3997     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3998         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3999         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4000
  4001     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4002
  4003     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4004     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4005     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4006     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4007     12  AM-DCC-UEF-STATE                  PIC XX.
  4008     12  FILLER                            PIC XXX.
  4009     12  AM-REPORT-CODE-3                  PIC X(10).
  4010*    12  FILLER                            PIC X(22).
  4011
  4012     12  AM-RESERVE-DATE.
  4013         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4014         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4015         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  71
* EL677.cbl
  4016
  4017     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4018     12  AM-NOTIFICATION-TYPES.
  4019         16  AM-NOTIF-OF-LETTERS           PIC X.
  4020         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4021         16  AM-NOTIF-OF-REPORTS           PIC X.
  4022         16  AM-NOTIF-OF-STATUS            PIC X.
  4023
  4024     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4025         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4026         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4027         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4028         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4029
  4030     12  AM-BENEFIT-CONTROLS.
  4031         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4032             20  AM-BENEFIT-CODE           PIC XX.
  4033             20  AM-BENEFIT-TYPE           PIC X.
  4034             20  AM-BENEFIT-REVISION       PIC XXX.
  4035             20  AM-BENEFIT-REM-TERM       PIC X.
  4036             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4037             20  FILLER                    PIC XX.
  4038         16  FILLER                        PIC X(80).
  4039
  4040     12  AM-TRANSFER-DATA.
  4041         16  AM-TRANSFERRED-FROM.
  4042             20  AM-TRNFROM-CARRIER        PIC X.
  4043             20  AM-TRNFROM-GROUPING.
  4044                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4045                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4046             20  AM-TRNFROM-STATE          PIC XX.
  4047             20  AM-TRNFROM-ACCOUNT.
  4048                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4049                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4050             20  AM-TRNFROM-DTE            PIC XX.
  4051         16  AM-TRANSFERRED-TO.
  4052             20  AM-TRNTO-CARRIER          PIC X.
  4053             20  AM-TRNTO-GROUPING.
  4054                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4055                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4056             20  AM-TRNTO-STATE            PIC XX.
  4057             20  AM-TRNTO-ACCOUNT.
  4058                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4059                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4060             20  AM-TRNTO-DTE              PIC XX.
  4061         16  FILLER                        PIC X(10).
  4062
  4063     12  AM-SAVED-REMIT-TO                 PIC 99.
  4064
  4065     12  AM-COMM-STRUCTURE-SAVED.
  4066         16  AM-DEFN-1-SAVED.
  4067             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4068                 24  AM-AGT-SV             PIC X(10).
  4069                 24  AM-COM-TYP-SV         PIC X.
  4070                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4071                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4072                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4073                 24  AM-RECALC-LV-INDIC-SV PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  72
* EL677.cbl
  4074                 24  FILLER                PIC X.
  4075                 24  AM-GL-CODES-SV        PIC X.
  4076                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4077                 24  FILLER                PIC X.
  4078         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4079             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4080                 24  FILLER                PIC X(11).
  4081                 24  AM-L-COMA-SV          PIC XXX.
  4082                 24  AM-J-COMA-SV          PIC XXX.
  4083                 24  AM-A-COMA-SV          PIC XXX.
  4084                 24  FILLER                PIC X(6).
  4085
  4086     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4087         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4088            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4089            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4090            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4091
  4092     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4093     12  FILLER                            PIC X(120).
  4094
  4095     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4096         16  AM-CONTROL-NAME               PIC X(30).
  4097         16  AM-EXECUTIVE-ONE.
  4098             20  AM-EXEC1-NAME             PIC X(15).
  4099             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4100                                                          COMP-3.
  4101             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4102                                                          COMP-3.
  4103         16  AM-EXECUTIVE-TWO.
  4104             20  AM-EXEC2-NAME             PIC X(15).
  4105             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4106                                                          COMP-3.
  4107             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4108                                                          COMP-3.
  4109
  4110     12  AM-RETRO-ADDITIONAL-DATA.
  4111         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4112         16  AM-RETRO-PREM-P-E             PIC X.
  4113         16  AM-RETRO-CLMS-P-I             PIC X.
  4114         16  AM-RETRO-RET-BRACKET-LF.
  4115             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4116                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4117                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4118             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4119                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4120                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4121             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4122                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4123                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4124         16  AM-RETRO-RET-BRACKET-AH.
  4125             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4126                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4127                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4128                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4129             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4130                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4131                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  73
* EL677.cbl
  4132             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4133                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4134                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4135
  4136     12  AM-COMMENTS.
  4137         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4138
  4139     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4140         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4141         16  AM-FLI-BILLING-CODE           PIC X.
  4142         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4143         16  AM-FLI-UNITED-IDENT           PIC X.
  4144         16  AM-FLI-INTEREST-LOST-DATA.
  4145             20  AM-FLI-BANK-NO            PIC X(5).
  4146             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4147             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4148             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4149         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4150             20  AM-FLI-AGT                PIC X(9).
  4151             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4152             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4153         16  FILLER                        PIC X(102).
  4154
  4155     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4156         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4157             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4158             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4159             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4160             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4161             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4162         16  FILLER                          PIC X(10).
  4163******************************************************************
  4164*                                    COPY ERCCOMP.
  4165******************************************************************
  4166*                                                                *
  4167*                                                                *
  4168*                            ERCCOMP                             *
  4169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4170*                            VMOD=2.019                          *
  4171*                                                                *
  4172*   ONLINE CREDIT SYSTEM                                         *
  4173*                                                                *
  4174*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4175*                                                                *
  4176*   FILE TYPE = VSAM,KSDS                                        *
  4177*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4178*                                                                *
  4179*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4180*       ALTERNATE PATH = NONE                                    *
  4181*                                                                *
  4182*   LOG = NO                                                     *
  4183*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4184*                                                                *
  4185******************************************************************
  4186*                   C H A N G E   L O G
  4187*
  4188* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4189*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  74
* EL677.cbl
  4190*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4191* EFFECTIVE    NUMBER
  4192*-----------------------------------------------------------------
  4193* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4194* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4195* 092205    2005050300006  PEMA  ADD LEASE FEE
  4196* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4197* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4198* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4199* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4200* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4201* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4202******************************************************************
  4203
  4204 01  COMPENSATION-MASTER.
  4205     12  CO-RECORD-ID                          PIC XX.
  4206         88  VALID-CO-ID                          VALUE 'CO'.
  4207
  4208     12  CO-CONTROL-PRIMARY.
  4209         16  CO-COMPANY-CD                     PIC X.
  4210         16  CO-CONTROL.
  4211             20  CO-CTL-1.
  4212                 24  CO-CARR-GROUP.
  4213                     28  CO-CARRIER            PIC X.
  4214                     28  CO-GROUPING.
  4215                         32  CO-GROUP-PREFIX   PIC XXX.
  4216                         32  CO-GROUP-PRIME    PIC XXX.
  4217                 24  CO-RESP-NO.
  4218                     28  CO-RESP-PREFIX        PIC X(4).
  4219                     28  CO-RESP-PRIME         PIC X(6).
  4220             20  CO-CTL-2.
  4221                 24  CO-ACCOUNT.
  4222                     28  CO-ACCT-PREFIX        PIC X(4).
  4223                     28  CO-ACCT-PRIME         PIC X(6).
  4224         16  CO-TYPE                           PIC X.
  4225             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4226             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4227             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4228
  4229     12  CO-MAINT-INFORMATION.
  4230         16  CO-LAST-MAINT-DT                  PIC XX.
  4231         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4232         16  CO-LAST-MAINT-USER                PIC X(4).
  4233     12  FILLER                                PIC XX.
  4234     12  CO-STMT-TYPE                          PIC XXX.
  4235     12  CO-COMP-TYPE                          PIC X.
  4236         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4237     12  CO-STMT-OWNER                         PIC X(4).
  4238     12  CO-BALANCE-CONTROL                    PIC X.
  4239         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4240         88  CO-NO-BALANCE                        VALUE 'N'.
  4241
  4242     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4243         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4244         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4245         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4246
  4247     12  CO-INTERNAL-CONTROL-2                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  75
* EL677.cbl
  4248         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4249         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4250
  4251     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4252     12  CO-GA-DIRECT-DEP                      PIC X.
  4253     12  CO-FUTURE-SPACE                       PIC X.
  4254         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4255
  4256     12  CO-ACCT-NAME                          PIC X(30).
  4257     12  CO-MAIL-NAME                          PIC X(30).
  4258     12  CO-ADDR-1                             PIC X(30).
  4259     12  CO-ADDR-2                             PIC X(30).
  4260     12  CO-ADDR-3.
  4261         16  CO-ADDR-CITY                      PIC X(27).
  4262         16  CO-ADDR-STATE                     PIC XX.
  4263     12  CO-CSO-1099                           PIC X.
  4264     12  CO-ZIP.
  4265         16  CO-ZIP-PRIME.
  4266             20  CO-ZIP-PRI-1ST                PIC X.
  4267                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4268             20  FILLER                        PIC X(4).
  4269         16  CO-ZIP-PLUS4                      PIC X(4).
  4270     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4271         16  CO-CAN-POSTAL-1                   PIC XXX.
  4272         16  CO-CAN-POSTAL-2                   PIC XXX.
  4273         16  FILLER                            PIC XXX.
  4274     12  CO-SOC-SEC                            PIC X(13).
  4275     12  CO-TELEPHONE.
  4276         16  CO-AREA-CODE                      PIC XXX.
  4277         16  CO-PREFIX                         PIC XXX.
  4278         16  CO-PHONE                          PIC X(4).
  4279
  4280     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4281
  4282     12  CO-AR-BAL-LEVEL                       PIC X.
  4283         88  CO-AR-REF-LVL                        VALUE '1'.
  4284         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4285         88  CO-AR-BILL-LVL                       VALUE '2'.
  4286         88  CO-AR-AGT-LVL                        VALUE '3'.
  4287         88  CO-AR-FR-LVL                         VALUE '4'.
  4288
  4289     12  CO-AR-NORMAL-PRINT                    PIC X.
  4290         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4291         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4292
  4293     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4294
  4295     12  CO-AR-REPORTING                       PIC X.
  4296         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4297         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4298
  4299     12  CO-AR-PULL-CHECK                      PIC X.
  4300         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4301         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4302
  4303     12  CO-AR-BALANCE-PRINT                   PIC X.
  4304         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4305
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  76
* EL677.cbl
  4306     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4307         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4308         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4309         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4310
  4311     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4312
  4313     12  CO-USER-CODE                          PIC X.
  4314     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4315
  4316******************************************************************
  4317*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4318*    THE LAST MONTH END RUN.
  4319******************************************************************
  4320
  4321     12  CO-LAST-ACTIVITY-DATE.
  4322         16  CO-ACT-YEAR                       PIC 99.
  4323         16  CO-ACT-MONTH                      PIC 99.
  4324         16  CO-ACT-DAY                        PIC 99.
  4325
  4326     12  CO-LAST-STMT-DT.
  4327         16  CO-LAST-STMT-YEAR                 PIC 99.
  4328         16  CO-LAST-STMT-MONTH                PIC 99.
  4329         16  CO-LAST-STMT-DAY                  PIC 99.
  4330
  4331     12  CO-MO-END-TOTALS.
  4332         16  CO-MONTHLY-TOTALS.
  4333             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4334             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4335             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4336             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4337             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4338
  4339         16  CO-AGING-TOTALS.
  4340             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4341             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4342             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4343             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4344
  4345         16  CO-YTD-TOTALS.
  4346             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4347             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4348
  4349         16  CO-OVER-UNDER-TOTALS.
  4350             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4351             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4352
  4353     12  CO-MISCELLANEOUS-TOTALS.
  4354         16  CO-FICA-TOTALS.
  4355             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4356             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4357
  4358         16  CO-CLAIM-TOTALS.
  4359             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4360             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4361
  4362******************************************************************
  4363*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  77
* EL677.cbl
  4364*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4365******************************************************************
  4366
  4367     12  CO-CURRENT-TOTALS.
  4368         16  CO-CURRENT-LAST-STMT-DT.
  4369             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4370             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4371             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4372
  4373         16  CO-CURRENT-MONTHLY-TOTALS.
  4374             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4375             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4376             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4377             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4378             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4379
  4380         16  CO-CURRENT-AGING-TOTALS.
  4381             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4382             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4383             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4384             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4385
  4386         16  CO-CURRENT-YTD-TOTALS.
  4387             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4388             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4389
  4390     12  CO-PAID-COMM-TOTALS.
  4391         16  CO-YTD-PAID-COMMS.
  4392             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4393             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4394
  4395     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4396         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4397         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4398
  4399     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4400         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4401         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4402         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4403         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4404         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4405         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4406         88  CO-FINAL-LETTER                  VALUE 'F'.
  4407         88  CO-RECONCILING                   VALUE 'R'.
  4408         88  CO-PHONE-CALL                    VALUE 'P'.
  4409         88  CO-LEGAL                         VALUE 'L'.
  4410         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4411         88  CO-WRITE-OFF                     VALUE 'W'.
  4412         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4413
  4414     12  CO-CSR-CODE                       PIC X(4).
  4415
  4416     12  CO-GA-STATUS-INFO.
  4417         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4418         16  CO-GA-TERMINATION-DT          PIC XX.
  4419         16  CO-GA-STATUS-CODE             PIC X.
  4420             88  CO-GA-ACTIVE                 VALUE 'A'.
  4421             88  CO-GA-INACTIVE               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  78
* EL677.cbl
  4422             88  CO-GA-PENDING                VALUE 'P'.
  4423         16  CO-GA-COMMENTS.
  4424             20  CO-GA-COMMENT-1           PIC X(40).
  4425             20  CO-GA-COMMENT-2           PIC X(40).
  4426             20  CO-GA-COMMENT-3           PIC X(40).
  4427             20  CO-GA-COMMENT-4           PIC X(40).
  4428
  4429     12  CO-RPTCD2                         PIC X(10).
  4430     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4431         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4432         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4433
  4434     12  CO-TYPE-AGENT                     PIC X(01).
  4435         88  CO-CORPORATION                   VALUE 'C'.
  4436         88  CO-PARTNERSHIP                   VALUE 'P'.
  4437         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4438         88  CO-TRUST                         VALUE 'T'.
  4439         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4440
  4441     12  CO-FAXNO.
  4442         16  CO-FAX-AREA-CODE                  PIC XXX.
  4443         16  CO-FAX-PREFIX                     PIC XXX.
  4444         16  CO-FAX-PHONE                      PIC X(4).
  4445
  4446     12  CO-BANK-INFORMATION.
  4447         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4448         16  CO-BANK-TRANSIT-NON REDEFINES
  4449             CO-BANK-TRANSIT-NO                PIC 9(8).
  4450
  4451         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4452     12  CO-MISC-DEDUCT-INFO REDEFINES
  4453                  CO-BANK-INFORMATION.
  4454         16  CO-MD-GL-ACCT                     PIC X(10).
  4455         16  CO-MD-DIV                         PIC XX.
  4456         16  CO-MD-CENTER                      PIC X(4).
  4457         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4458         16  CO-CREATE-AP-CHECK                PIC X.
  4459         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4460         16  FILLER                            PIC XXX.
  4461     12  CO-ACH-STATUS                         PIC X.
  4462         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4463         88  CO-ACH-PENDING                        VALUE 'P'.
  4464
  4465     12  CO-BILL-SW                            PIC X.
  4466     12  CO-CONTROL-NAME                       PIC X(30).
  4467     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4468     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4469     12  CO-CLP-STATE                          PIC XX.
  4470     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4471     12  CO-SPP-REFUND-EDIT                    PIC X.
  4472
  4473******************************************************************
  4474*                                    COPY ELCCERT.
  4475******************************************************************
  4476*                                                                *
  4477*                            ELCCERT.                            *
  4478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4479*                            VMOD=2.013                          *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  79
* EL677.cbl
  4480*                                                                *
  4481*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4482*                                                                *
  4483*   FILE TYPE = VSAM,KSDS                                        *
  4484*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4485*                                                                *
  4486*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4487*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4488*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4489*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4490*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4491*                                                                *
  4492*   LOG = YES                                                    *
  4493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4494******************************************************************
  4495*                   C H A N G E   L O G
  4496*
  4497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4498*-----------------------------------------------------------------
  4499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4500* EFFECTIVE    NUMBER
  4501*-----------------------------------------------------------------
  4502* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4503* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4504* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4505* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4506* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4507* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4508* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4509* 032612  CR2011110200001  PEMA  AHL CHANGES
  4510* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4511* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4512******************************************************************
  4513
  4514 01  CERTIFICATE-MASTER.
  4515     12  CM-RECORD-ID                      PIC XX.
  4516         88  VALID-CM-ID                      VALUE 'CM'.
  4517
  4518     12  CM-CONTROL-PRIMARY.
  4519         16  CM-COMPANY-CD                 PIC X.
  4520         16  CM-CARRIER                    PIC X.
  4521         16  CM-GROUPING.
  4522             20  CM-GROUPING-PREFIX        PIC X(3).
  4523             20  CM-GROUPING-PRIME         PIC X(3).
  4524         16  CM-STATE                      PIC XX.
  4525         16  CM-ACCOUNT.
  4526             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4527             20  CM-ACCOUNT-PRIME          PIC X(6).
  4528         16  CM-CERT-EFF-DT                PIC XX.
  4529         16  CM-CERT-NO.
  4530             20  CM-CERT-PRIME             PIC X(10).
  4531             20  CM-CERT-SFX               PIC X.
  4532
  4533     12  CM-CONTROL-BY-NAME.
  4534         16  CM-COMPANY-CD-A1              PIC X.
  4535         16  CM-INSURED-LAST-NAME          PIC X(15).
  4536         16  CM-INSURED-INITIALS.
  4537             20  CM-INSURED-INITIAL1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  80
* EL677.cbl
  4538             20  CM-INSURED-INITIAL2       PIC X.
  4539
  4540     12  CM-CONTROL-BY-SSN.
  4541         16  CM-COMPANY-CD-A2              PIC X.
  4542         16  CM-SOC-SEC-NO.
  4543             20  CM-SSN-STATE              PIC XX.
  4544             20  CM-SSN-ACCOUNT            PIC X(6).
  4545             20  CM-SSN-LN3.
  4546                 25  CM-INSURED-INITIALS-A2.
  4547                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4548                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4549                 25 CM-PART-LAST-NAME-A2         PIC X.
  4550
  4551     12  CM-CONTROL-BY-CERT-NO.
  4552         16  CM-COMPANY-CD-A4              PIC X.
  4553         16  CM-CERT-NO-A4                 PIC X(11).
  4554
  4555     12  CM-CONTROL-BY-MEMB.
  4556         16  CM-COMPANY-CD-A5              PIC X.
  4557         16  CM-MEMBER-NO.
  4558             20  CM-MEMB-STATE             PIC XX.
  4559             20  CM-MEMB-ACCOUNT           PIC X(6).
  4560             20  CM-MEMB-LN4.
  4561                 25  CM-INSURED-INITIALS-A5.
  4562                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4563                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4564                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4565
  4566     12  CM-INSURED-PROFILE-DATA.
  4567         16  CM-INSURED-FIRST-NAME.
  4568             20  CM-INSURED-1ST-INIT       PIC X.
  4569             20  FILLER                    PIC X(9).
  4570         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4571         16  CM-INSURED-SEX                PIC X.
  4572             88  CM-SEX-MALE                  VALUE 'M'.
  4573             88  CM-SEX-FEMAL                 VALUE 'F'.
  4574         16  CM-INSURED-JOINT-AGE          PIC 99.
  4575         16  CM-JOINT-INSURED-NAME.
  4576             20  CM-JT-LAST-NAME           PIC X(15).
  4577             20  CM-JT-FIRST-NAME.
  4578                 24  CM-JT-1ST-INIT        PIC X.
  4579                 24  FILLER                PIC X(9).
  4580             20  CM-JT-INITIAL             PIC X.
  4581
  4582     12  CM-LIFE-DATA.
  4583         16  CM-LF-BENEFIT-CD              PIC XX.
  4584         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4585         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4586         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4587         16  CM-LF-DEV-CODE                PIC XXX.
  4588         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4589         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4590         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4591         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4592         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4593         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4594         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4595         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  81
* EL677.cbl
  4596         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4597         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4598         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4599         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4600         16  cm-temp-epiq                  pic xx.
  4601             88  EPIQ-CLASS                  value 'EQ'.
  4602*        16  FILLER                        PIC XX.
  4603
  4604     12  CM-AH-DATA.
  4605         16  CM-AH-BENEFIT-CD              PIC XX.
  4606         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4607         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4608         16  CM-AH-DEV-CODE                PIC XXX.
  4609         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4610         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4611         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4612         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4613         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4614         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4615         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4616         16  CM-AH-PAID-THRU-DT            PIC XX.
  4617             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4618         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4619         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4620         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4621         16  FILLER                        PIC X.
  4622
  4623     12  CM-LOAN-INFORMATION.
  4624         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4625         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4626                                           PIC S9(5)V99  COMP-3.
  4627         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4628         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4629         16  CM-PAY-FREQUENCY              PIC S99.
  4630         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4631         16  CM-RATE-CLASS                 PIC XX.
  4632         16  CM-BENEFICIARY                PIC X(25).
  4633         16  CM-POLICY-FORM-NO             PIC X(12).
  4634         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4635         16  CM-LAST-ADD-ON-DT             PIC XX.
  4636         16  CM-DEDUCTIBLE-AMOUNTS.
  4637             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4638             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4639         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4640             20  CM-RESIDENT-STATE         PIC XX.
  4641             20  CM-RATE-CODE              PIC X(4).
  4642             20  FILLER                    PIC XX.
  4643         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4644             20  CM-LOAN-OFFICER           PIC X(5).
  4645             20  FILLER                    PIC XXX.
  4646         16  CM-CSR-CODE                   PIC XXX.
  4647         16  CM-UNDERWRITING-CODE          PIC X.
  4648             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4649         16  CM-POST-CARD-IND              PIC X.
  4650         16  CM-NH-INTERFACE-SW            PIC X.
  4651         16  CM-PREMIUM-TYPE               PIC X.
  4652             88  CM-SING-PRM                  VALUE '1'.
  4653             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  82
* EL677.cbl
  4654             88  CM-OPEN-END                  VALUE '3'.
  4655         16  CM-IND-GRP-TYPE               PIC X.
  4656             88  CM-INDIVIDUAL                VALUE 'I'.
  4657             88  CM-GROUP                     VALUE 'G'.
  4658         16  CM-SKIP-CODE                  PIC X.
  4659             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4660             88  SKIP-JULY                    VALUE '1'.
  4661             88  SKIP-AUGUST                  VALUE '2'.
  4662             88  SKIP-SEPTEMBER               VALUE '3'.
  4663             88  SKIP-JULY-AUG                VALUE '4'.
  4664             88  SKIP-AUG-SEPT                VALUE '5'.
  4665             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4666             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4667             88  SKIP-JUNE                    VALUE '8'.
  4668             88  SKIP-JUNE-JULY               VALUE '9'.
  4669             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4670             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4671         16  CM-PAYMENT-MODE               PIC X.
  4672             88  PAY-MONTHLY                  VALUE SPACE.
  4673             88  PAY-WEEKLY                   VALUE '1'.
  4674             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4675             88  PAY-BI-WEEKLY                VALUE '3'.
  4676             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4677         16  CM-LOAN-NUMBER                PIC X(8).
  4678         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4679         16  CM-OLD-LOF                    PIC XXX.
  4680*        16  CM-LOAN-OFFICER               PIC XXX.
  4681         16  CM-REIN-TABLE                 PIC XXX.
  4682         16  CM-SPECIAL-REIN-CODE          PIC X.
  4683         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4684         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4685         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4686
  4687     12  CM-STATUS-DATA.
  4688         16  CM-ENTRY-STATUS               PIC X.
  4689         16  CM-ENTRY-DT                   PIC XX.
  4690
  4691         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4692         16  CM-LF-CANCEL-DT               PIC XX.
  4693         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4694
  4695         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4696         16  CM-LF-DEATH-DT                PIC XX.
  4697         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4698
  4699         16  CM-LF-CURRENT-STATUS          PIC X.
  4700             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4701                                                'M' '4' '5' '9'.
  4702             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4703             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4704             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4705             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4706             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4707             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4708             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4709             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4710             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4711             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  83
* EL677.cbl
  4712             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4713             88  CM-LF-DECLINED               VALUE 'D'.
  4714             88  CM-LF-VOIDED                 VALUE 'V'.
  4715
  4716         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4717         16  CM-AH-CANCEL-DT               PIC XX.
  4718         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4719
  4720         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4721         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4722         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4723
  4724         16  CM-AH-CURRENT-STATUS          PIC X.
  4725             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4726                                                'M' '4' '5' '9'.
  4727             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4728             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4729             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4730             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4731             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4732             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4733             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4734             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4735             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4736             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4737             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4738             88  CM-AH-DECLINED               VALUE 'D'.
  4739             88  CM-AH-VOIDED                 VALUE 'V'.
  4740
  4741         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4742             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4743             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4744             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4745         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4746
  4747         16  CM-ENTRY-BATCH                PIC X(6).
  4748         16  CM-LF-EXIT-BATCH              PIC X(6).
  4749         16  CM-AH-EXIT-BATCH              PIC X(6).
  4750         16  CM-LAST-MONTH-END             PIC XX.
  4751
  4752     12  CM-NOTE-SW                        PIC X.
  4753         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4754         88  CERT-NOTES-PRESENT               VALUE '1'.
  4755         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4756         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4757         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4758         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4759         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4760         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4761     12  CM-COMP-EXCP-SW                   PIC X.
  4762         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4763         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4764     12  CM-INSURED-ADDRESS-SW             PIC X.
  4765         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4766         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4767
  4768*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4769     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  84
* EL677.cbl
  4770     12  FILLER                            PIC X.
  4771
  4772*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4773     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4774     12  FILLER                            PIC X.
  4775*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4776     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4777
  4778     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4779         88  CERT-ADDED-BATCH                 VALUE ' '.
  4780         88  CERT-ADDED-ONLINE                VALUE '1'.
  4781         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4782         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4783         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4784     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4785         88  CERT-AS-LOADED                   VALUE ' '.
  4786         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4787         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4788         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4789         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4790         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4791         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4792         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4793
  4794     12  CM-ACCOUNT-COMM-PCTS.
  4795         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4796         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4797
  4798     12  CM-USER-FIELD                     PIC X.
  4799     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4800     12  CM-CLP-STATE                      PIC XX.
  4801     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4802     12  CM-USER-RESERVED                  PIC XXX.
  4803     12  FILLER REDEFINES CM-USER-RESERVED.
  4804         16  CM-AH-CLASS-CD                PIC XX.
  4805         16  F                             PIC X.
  4806******************************************************************
  4807*                                    COPY ERCPNDB.
  4808******************************************************************
  4809*                                                                *
  4810*                                                                *
  4811*                            ERCPNDB.                            *
  4812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4813*                            VMOD=2.025                          *
  4814*                                                                *
  4815*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4816*                                                                *
  4817******************************************************************
  4818*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4819*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4820******************************************************************
  4821*                                                                *
  4822*                                                                *
  4823*   FILE TYPE = VSAM,KSDS                                        *
  4824*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4825*                                                                *
  4826*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4827*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  85
* EL677.cbl
  4828*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4829*                                                 RKP=13,LEN=36  *
  4830*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4831*                                      AND CHG-SEQ.)             *
  4832*                                                RKP=49,LEN=11   *
  4833*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4834*                                      AND CHG-SEQ.)             *
  4835*                                                RKP=60,LEN=15   *
  4836*                                                                *
  4837*   LOG = NO                                                     *
  4838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4839******************************************************************
  4840******************************************************************
  4841*                   C H A N G E   L O G
  4842*
  4843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4844*-----------------------------------------------------------------
  4845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4846* EFFECTIVE    NUMBER
  4847*-----------------------------------------------------------------
  4848* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4849* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4850* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4851* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4852* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4853* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4854* 032306                   PEMA  ADD BOW LOAN NUMBER
  4855* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4856* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4857* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4858* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4859* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4860* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4861* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4862* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4863* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4864* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4865******************************************************************
  4866
  4867 01  PENDING-BUSINESS.
  4868     12  PB-RECORD-ID                     PIC XX.
  4869         88  VALID-PB-ID                        VALUE 'PB'.
  4870
  4871     12  PB-CONTROL-PRIMARY.
  4872         16  PB-COMPANY-CD                PIC X.
  4873         16  PB-ENTRY-BATCH               PIC X(6).
  4874         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4875         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4876
  4877     12  PB-CONTROL-BY-ACCOUNT.
  4878         16  PB-COMPANY-CD-A1             PIC X.
  4879         16  PB-CARRIER                   PIC X.
  4880         16  PB-GROUPING.
  4881             20  PB-GROUPING-PREFIX       PIC XXX.
  4882             20  PB-GROUPING-PRIME        PIC XXX.
  4883         16  PB-STATE                     PIC XX.
  4884         16  PB-ACCOUNT.
  4885             20  PB-ACCOUNT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  86
* EL677.cbl
  4886             20  PB-ACCOUNT-PRIME         PIC X(6).
  4887         16  PB-CERT-EFF-DT               PIC XX.
  4888         16  PB-CERT-NO.
  4889             20  PB-CERT-PRIME            PIC X(10).
  4890             20  PB-CERT-SFX              PIC X.
  4891         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4892
  4893         16  PB-RECORD-TYPE               PIC X.
  4894             88  PB-MAILING-DATA                VALUE '0'.
  4895             88  PB-ISSUE                       VALUE '1'.
  4896             88  PB-CANCELLATION                VALUE '2'.
  4897             88  PB-BATCH-TRAILER               VALUE '9'.
  4898
  4899     12  PB-CONTROL-BY-ORIG-BATCH.
  4900         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4901         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4902         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4903         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4904
  4905     12  PB-CONTROL-BY-CSR.
  4906         16  PB-CSR-COMPANY-CD            PIC X.
  4907         16  PB-CSR-ID                    PIC X(4).
  4908         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4909         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4910         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4911******************************************************************
  4912*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4913******************************************************************
  4914
  4915     12  PB-LAST-MAINT-DT                 PIC XX.
  4916     12  PB-LAST-MAINT-BY                 PIC X(4).
  4917     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4918
  4919     12  PB-RECORD-BODY                   PIC X(375).
  4920
  4921     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4922         16  PB-CERT-ORIGIN               PIC X.
  4923             88  CLASIC-CREATED-CERT         VALUE '1'.
  4924         16  PB-I-NAME.
  4925             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4926             20  PB-I-INSURED-FIRST-NAME.
  4927                 24  PB-I-INSURED-1ST-INIT PIC X.
  4928                 24  FILLER                PIC X(9).
  4929             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4930         16  PB-I-AGE                     PIC S99   COMP-3.
  4931         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4932         16  PB-I-BIRTHDAY                PIC XX.
  4933         16  PB-I-INSURED-SEX             PIC X.
  4934             88  PB-SEX-MALE     VALUE 'M'.
  4935             88  PB-SEX-FEMALE   VALUE 'F'.
  4936
  4937         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4938         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4939         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4940         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4941         16  PB-I-SKIP-CODE               PIC X.
  4942             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4943             88  PB-SKIP-JULY              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  87
* EL677.cbl
  4944             88  PB-SKIP-AUGUST            VALUE '2'.
  4945             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4946             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4947             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4948             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4949             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4950             88  PB-SKIP-JUNE              VALUE '8'.
  4951             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4952             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4953             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4954         16  PB-I-TERM-TYPE               PIC X.
  4955             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4956             88  PB-PAID-WEEKLY            VALUE 'W'.
  4957             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4958             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4959             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4960         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4961         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4962         16  PB-I-DATA-ENTRY-SW           PIC X.
  4963             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4964             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4965             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4966             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4967         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4968         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4969*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4970         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4971         16  FILLER                       PIC X.
  4972
  4973         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4974             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4975             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4976                                                   '90' THRU '99'.
  4977         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4978                                          PIC XX.
  4979         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4980         16  PB-I-AMOUNT-FINANCED REDEFINES
  4981                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4982         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4983         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4984                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4985         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4986         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4987         16  PB-I-CLP-AMOUNT REDEFINES
  4988                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4989         16  PB-I-LF-CALC-FLAG            PIC X.
  4990             88 PB-COMP-LF-PREM               VALUE '?'.
  4991         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4992         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4993         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4994         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4995         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4996         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4997         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4998         16  PB-I-LF-ABBR                 PIC XXX.
  4999         16  PB-I-LF-INPUT-CD             PIC XX.
  5000
  5001         16  PB-I-AH-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  88
* EL677.cbl
  5002             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5003             88  PB-INVALID-AH               VALUE '  ' '00'
  5004                                                   '90' THRU '99'.
  5005         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5006         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5007         16  PB-I-AH-CALC-FLAG            PIC X.
  5008             88 PB-COMP-AH-PREM                  VALUE '?'.
  5009         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5010         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5011         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5012         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5013         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5014         16  PB-I-AH-ABBR                 PIC XXX.
  5015         16  PB-I-AH-INPUT-CD             PIC XXX.
  5016
  5017         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5018         16  PB-I-REIN-TABLE              PIC XXX.
  5019         16  PB-I-BUSINESS-TYPE           PIC 99.
  5020         16  PB-I-INDV-GRP-CD             PIC X.
  5021         16  PB-I-MORT-CODE.
  5022             20  PB-I-TABLE               PIC X.
  5023             20  PB-I-INTEREST            PIC XX.
  5024             20  PB-I-MORT-TYP            PIC X.
  5025         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5026         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5027         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5028         16  PB-I-INDV-GRP-OVRD           PIC X.
  5029         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5030         16  PB-I-SIG-SW                  PIC X.
  5031             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5032         16  PB-I-RATE-CLASS              PIC XX.
  5033         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5034         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5035         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5036         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5037         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5038         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5039         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5040         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5041         16  PB-I-OB-FLAG                 PIC X.
  5042             88  PB-I-OB                      VALUE 'B'.
  5043             88  PB-I-SUMMARY                 VALUE 'Z'.
  5044         16  PB-I-ENTRY-STATUS            PIC X.
  5045             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5046                                              'M' '5' '9' '2'.
  5047             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5048             88  PB-I-POLICY-PENDING          VALUE '2'.
  5049             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5050             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5051             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5052             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5053             88  PB-I-REIN-ONLY               VALUE '9'.
  5054             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5055             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5056             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5057             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5058         16  PB-I-INT-CODE                PIC X.
  5059             88  PB-ADD-ON-INTEREST           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  89
* EL677.cbl
  5060             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5061         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5062         16  PB-I-SOC-SEC-NO              PIC X(11).
  5063         16  PB-I-MEMBER-NO               PIC X(12).
  5064         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5065*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5066         16  PB-I-OLD-LOF                 PIC XXX.
  5067         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5068         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5069         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5070         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5071         16  PB-I-LIFE-INDICATOR          PIC X.
  5072             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5073         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5074         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5075                                          PIC S9(5)V99    COMP-3.
  5076         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5077             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5078             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5079         16  PB-I-1ST-PMT-DT              PIC XX.
  5080         16  PB-I-JOINT-INSURED.
  5081             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5082             20 PB-I-JOINT-FIRST-NAME.
  5083                24  PB-I-JOINT-FIRST-INIT PIC X.
  5084                24  FILLER                PIC X(9).
  5085             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5086*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5087         16  PB-I-BENEFICIARY-NAME.
  5088             20  PB-I-BANK-NUMBER         PIC X(10).
  5089             20  FILLER                   PIC X(15).
  5090         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5091         16  PB-I-REFERENCE               PIC X(12).
  5092         16  FILLER REDEFINES PB-I-REFERENCE.
  5093             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5094             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5095             20  PB-I-CLP-STATE           PIC XX.
  5096         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5097             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5098             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5099             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5100         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5101         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5102         16  PB-I-RESIDENT-STATE          PIC XX.
  5103         16  PB-I-RATE-CODE               PIC X(4).
  5104         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5105         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5106         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5107         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5108         16  PB-I-BANK-NOCHRGB            PIC 99.
  5109         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5110         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5111
  5112     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5113         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5114             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5115         16  PB-C-CANCEL-ORIGIN           PIC X.
  5116             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5117         16  PB-C-LF-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  90
* EL677.cbl
  5118         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5119         16  PB-C-LF-CALC-REQ             PIC X.
  5120             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5121         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5122         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5123         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5124             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5125         16  PB-C-AH-CANCEL-DT            PIC XX.
  5126         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5127         16  PB-C-AH-CALC-REQ             PIC X.
  5128             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5129         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5130         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5131         16  PB-C-LAST-NAME               PIC X(15).
  5132         16  PB-C-REFUND-SW               PIC X.
  5133             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5134             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5135         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5136         16  PB-C-PAYEE-CODE              PIC X(6).
  5137         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5138         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5139         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5140         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5141         16  PB-C-REFERENCE               PIC X(12).
  5142         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5143         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5144         16  PB-C-POST-CARD-IND           PIC X.
  5145         16  PB-C-CANCEL-REASON           PIC X.
  5146         16  PB-C-REF-INTERFACE-SW        PIC X.
  5147         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5148         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5149         16  FILLER                       PIC X(01).
  5150*        16  FILLER                       PIC X(18).
  5151         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5152*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5153         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5154         16  PB-CANCELED-CERT-DATA.
  5155             20  PB-CI-INSURED-NAME.
  5156                 24  PB-CI-LAST-NAME      PIC X(15).
  5157                 24  PB-CI-INITIALS       PIC XX.
  5158             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5159             20  PB-CI-INSURED-SEX        PIC X.
  5160             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5161             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5162             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5163             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5164             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5165             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5166             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5167             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5168             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5169             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5170             20  PB-CI-RATE-CLASS         PIC XX.
  5171             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5172             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5173             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5174             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5175             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  91
* EL677.cbl
  5176             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5177             20  PB-CI-LF-ABBR            PIC X(3).
  5178             20  PB-CI-AH-ABBR            PIC X(3).
  5179             20  PB-CI-OB-FLAG            PIC X.
  5180                 88  PB-CI-OB                VALUE 'B'.
  5181             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5182                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5183                                           'M' '4' '5' '9' '2'.
  5184                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5185                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5186                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5187                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5188                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5189                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5190                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5191                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5192                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5193                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5194                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5195                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5196                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5197             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5198                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5199                                           'M' '4' '5' '9' '2'.
  5200                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5201                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5202                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5203                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5204                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5205                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5206                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5207                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5208                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5209                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5210                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5211                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5212                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5213             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5214             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5215             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5216             20  PB-CI-MEMBER-NO          PIC X(12).
  5217             20  PB-CI-INT-CODE           PIC X.
  5218                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5219                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5220             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5221             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5222             20  PB-CI-COMP-EXCP-SW       PIC X.
  5223                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5224                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5225             20  PB-CI-ENTRY-STATUS       PIC X.
  5226             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5227             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5228             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5229             20  PB-CI-DEATH-DT           PIC XX.
  5230             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5231             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5232             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5233             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  92
* EL677.cbl
  5234             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5235             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5236             20  PB-CI-ENTRY-DT              PIC XX.
  5237             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5238             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5239             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5240             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5241             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5242             20  PB-CI-OLD-LOF               PIC XXX.
  5243*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5244             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5245             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5246             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5247             20  PB-CI-INDV-GRP-CD           PIC X.
  5248             20  PB-CI-BENEFICIARY-NAME.
  5249                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5250                 24  FILLER                  PIC X(15).
  5251             20  PB-CI-NOTE-SW               PIC X.
  5252             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5253             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5254             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5255             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5256             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5257             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5258             20  PB-CI-FIRST-NAME            PIC X(10).
  5259             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5260
  5261         16  FILLER                       PIC X(13).
  5262*032306  16  FILLER                       PIC X(27).
  5263*        16  FILLER                       PIC X(46).
  5264
  5265     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5266         16  FILLER                       PIC X(10).
  5267         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5268         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5269         16  PB-M-INSURED-MID-INIT        PIC X.
  5270         16  PB-M-INSURED-AGE             PIC 99.
  5271         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5272         16  PB-M-INSURED-SEX             PIC X.
  5273         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5274         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5275         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5276         16  PB-M-INSURED-CITY-STATE.
  5277             20  PB-M-INSURED-CITY        PIC X(28).
  5278             20  PB-M-INSURED-STATE       PIC XX.
  5279         16  PB-M-INSURED-ZIP-CODE.
  5280             20  PB-M-INSURED-ZIP-PRIME.
  5281                 24  PB-M-INSURED-ZIP-1   PIC X.
  5282                     88  PB-M-CANADIAN-POST-CODE
  5283                                             VALUE 'A' THRU 'Z'.
  5284                 24  FILLER               PIC X(4).
  5285             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5286         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5287                                        PB-M-INSURED-ZIP-CODE.
  5288             20  PM-M-INS-CAN-POST1       PIC XXX.
  5289             20  PM-M-INS-CAN-POST2       PIC XXX.
  5290             20  FILLER                   PIC XXX.
  5291         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  93
* EL677.cbl
  5292         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5293         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5294         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5295         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5296         16  PB-M-CRED-BENE-CITYST.
  5297             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5298             20  PB-M-CRED-BENE-STATE     PIC XX.
  5299         16  FILLER                       PIC X(92).
  5300
  5301     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5302         16  FILLER                       PIC X(10).
  5303         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5304         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5305         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5306         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5307         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5308         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5309         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5310         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5311         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5312         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5313         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5314         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5315         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5316         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5317         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5318         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5319         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5320         16  PB-ACCOUNT-NAME              PIC X(30).
  5321         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5322         16  PB-REFERENCE                 PIC X(12).
  5323         16  PB-B-RECEIVED-DT             PIC XX.
  5324         16  FILLER                       PIC X(234).
  5325
  5326     12  PB-RECORD-STATUS.
  5327         16  PB-CREDIT-SELECT-DT          PIC XX.
  5328         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5329         16  PB-BILLED-DT                 PIC XX.
  5330         16  PB-BILLING-STATUS            PIC X.
  5331             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5332             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5333             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5334         16  PB-RECORD-BILL               PIC X.
  5335             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5336             88  PB-RECORD-RETURNED           VALUE 'R'.
  5337             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5338             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5339             88  PB-OVERRIDE-AH               VALUE 'A'.
  5340             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5341         16  PB-BATCH-ENTRY               PIC X.
  5342             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5343             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5344             88  PB-REISSUED-CERT             VALUE 'E'.
  5345             88  PB-CASH-CERT                 VALUE 'C'.
  5346             88  PB-MONTHLY-CERT              VALUE 'M'.
  5347             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5348             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5349             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  94
* EL677.cbl
  5350         16  PB-FORCE-CODE                PIC X.
  5351             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5352             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5353             88  PB-CANCEL-FORCE              VALUE '8'.
  5354             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5355             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5356             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5357             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5358             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5359             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5360             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5361         16  PB-FATAL-FLAG                PIC X.
  5362             88  PB-FATAL-ERRORS              VALUE 'X'.
  5363         16  PB-FORCE-ER-CD               PIC X.
  5364             88  PB-FORCE-ERRORS              VALUE 'F'.
  5365             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5366         16  PB-WARN-ER-CD                PIC X.
  5367             88  PB-WARNING-ERRORS            VALUE 'W'.
  5368         16  FILLER                       PIC X.
  5369         16  PB-OUT-BAL-CD                PIC X.
  5370             88  PB-OUT-OF-BAL                VALUE 'O'.
  5371         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5372         16  PB-AH-OVERRIDE-L1            PIC X.
  5373         16  PB-INPUT-DT                  PIC XX.
  5374         16  PB-INPUT-BY                  PIC X(4).
  5375         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5376         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5377         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5378         16  PB-LF-EARNING-METHOD         PIC X.
  5379         16  PB-AH-EARNING-METHOD         PIC X.
  5380         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5381         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5382         16  PB-REIN-CD                   PIC XXX.
  5383         16  PB-LF-REFUND-TYPE            PIC X.
  5384         16  PB-AH-REFUND-TYPE            PIC X.
  5385         16  PB-ACCT-EFF-DT               PIC XX.
  5386         16  PB-ACCT-EXP-DT               PIC XX.
  5387         16  PB-COMPANY-ID                PIC X(3).
  5388         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5389         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5390         16  PB-SV-CARRIER                PIC X.
  5391         16  PB-SV-GROUPING               PIC X(6).
  5392         16  PB-SV-STATE                  PIC XX.
  5393         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5394         16  PB-GA-BILLING-INFO.
  5395             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5396                                          PIC XX.
  5397         16  PB-SV-REMIT-TO  REDEFINES
  5398             PB-GA-BILLING-INFO           PIC X(10).
  5399         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5400         16  PB-I-LOAN-OFFICER            PIC X(5).
  5401         16  PB-I-VIN                     PIC X(17).
  5402
  5403         16  FILLER                       PIC X(04).
  5404         16  IMNET-BYPASS-SW              PIC X.
  5405
  5406******************************************************************
  5407*                COMMON EDIT ERRORS                              *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  95
* EL677.cbl
  5408******************************************************************
  5409
  5410     12  PB-COMMON-ERRORS.
  5411         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5412                                           PIC S9(4)     COMP.
  5413
  5414******************************************************************
  5415*                                    COPY ERCPNDM.
  5416******************************************************************
  5417*                                                                *
  5418*                                                                *
  5419*                            ERCPNDM                             *
  5420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5421*                            VMOD=2.003                          *
  5422*                                                                *
  5423*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5424*                                                                *
  5425*   FILE TYPE = VSAM,KSDS                                        *
  5426*   RECORD SIZE = 374   RECFORM = FIX                            *
  5427*                                                                *
  5428*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5429*   ALTERNATE PATH    = NOT USED                                 *
  5430*                                                                *
  5431*   LOG = YES                                                    *
  5432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5433******************************************************************
  5434*                   C H A N G E   L O G
  5435*
  5436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5437*-----------------------------------------------------------------
  5438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5439* EFFECTIVE    NUMBER
  5440*-----------------------------------------------------------------
  5441* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5442* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5443* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5444******************************************************************
  5445
  5446 01  PENDING-MAILING-DATA.
  5447     12  PM-RECORD-ID                      PIC XX.
  5448         88  VALID-MA-ID                       VALUE 'PM'.
  5449
  5450     12  PM-CONTROL-PRIMARY.
  5451         16  PM-COMPANY-CD                 PIC X.
  5452         16  PM-ENTRY-BATCH                PIC X(6).
  5453         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5454         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5455
  5456     12  FILLER                            PIC X(14).
  5457
  5458     12  PM-ACCESS-CONTROL.
  5459         16  PM-SOURCE-SYSTEM              PIC XX.
  5460             88  PM-FROM-CREDIT                VALUE 'CR'.
  5461             88  PM-FROM-VSI                   VALUE 'VS'.
  5462             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5463             88  PM-FROM-OTHER                 VALUE 'OT'.
  5464         16  PM-RECORD-ADD-DT              PIC XX.
  5465         16  PM-RECORD-ADDED-BY            PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  96
* EL677.cbl
  5466         16  PM-LAST-MAINT-DT              PIC XX.
  5467         16  PM-LAST-MAINT-BY              PIC XXXX.
  5468         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5469
  5470     12  PM-PROFILE-INFO.
  5471         16  PM-QUALIFY-CODE-1             PIC XX.
  5472         16  PM-QUALIFY-CODE-2             PIC XX.
  5473         16  PM-QUALIFY-CODE-3             PIC XX.
  5474         16  PM-QUALIFY-CODE-4             PIC XX.
  5475         16  PM-QUALIFY-CODE-5             PIC XX.
  5476
  5477         16  PM-INSURED-LAST-NAME          PIC X(15).
  5478         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5479         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5480         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5481         16  PM-INSURED-BIRTH-DT           PIC XX.
  5482         16  PM-INSURED-SEX                PIC X.
  5483             88  PM-SEX-MALE                   VALUE 'M'.
  5484             88  PM-SEX-FEMALE                 VALUE 'F'.
  5485         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5486
  5487         16  PM-ADDRESS-CORRECTED          PIC X.
  5488         16  PM-JOINT-BIRTH-DT             PIC XX.
  5489*        16  FILLER                        PIC X(12).
  5490
  5491         16  PM-ADDRESS-LINE-1             PIC X(30).
  5492         16  PM-ADDRESS-LINE-2             PIC X(30).
  5493         16  PM-CITY-STATE.
  5494             20  PM-CITY                   PIC X(28).
  5495             20  PM-STATE                  PIC XX.
  5496         16  PM-ZIP.
  5497             20  PM-ZIP-CODE.
  5498                 24  PM-ZIP-1              PIC X.
  5499                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5500                 24  FILLER                PIC X(4).
  5501             20  PM-ZIP-PLUS4              PIC X(4).
  5502         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5503             20  PM-CAN-POST1              PIC XXX.
  5504             20  PM-CAN-POST2              PIC XXX.
  5505             20  FILLER                    PIC XXX.
  5506
  5507         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5508
  5509         16  FILLER                        PIC X(03).
  5510
  5511     12  PM-CRED-BENE-INFO.
  5512         16  PM-CRED-BENE-NAME             PIC X(25).
  5513         16  PM-CRED-BENE-ADDR             PIC X(30).
  5514         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5515         16  PM-CRED-BENE-CTYST.
  5516             20  PM-CRED-BENE-CITY         PIC X(28).
  5517             20  PM-CRED-BENE-STATE        PIC XX.
  5518         16  PM-CRED-BENE-ZIP.
  5519             20  PM-CB-ZIP-CODE.
  5520                 24  PM-CB-ZIP-1           PIC X.
  5521                     88  PM-CB-CANADIAN-POST-CODE
  5522                                  VALUE 'A' THRU 'Z'.
  5523                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  97
* EL677.cbl
  5524             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5525         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5526             20  PM-CB-CAN-POST1           PIC XXX.
  5527             20  PM-CB-CAN-POST2           PIC XXX.
  5528             20  FILLER                    PIC XXX.
  5529     12  PM-POST-CARD-MAIL-DATA.
  5530         16  PM-MAIL-DATA OCCURS 7.
  5531             20  PM-MAIL-TYPE              PIC X.
  5532                 88  PM-12MO-MAILING           VALUE '1'.
  5533                 88  PM-EXP-MAILING            VALUE '2'.
  5534             20  PM-MAIL-STATUS            PIC X.
  5535                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5536                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5537                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5538             20  PM-MAIL-DATE              PIC XX.
  5539     12  FILLER                            PIC XX.
  5540     12  FILLER                            PIC X(12).
  5541*    12  FILLER                            PIC X(30).
  5542
  5543******************************************************************
  5544*                                    COPY ERCMAIL.
  5545******************************************************************
  5546*                                                                *
  5547*                                                                *
  5548*                            ERCMAIL                             *
  5549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5550*                            VMOD=2.003                          *
  5551*                                                                *
  5552*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5553*                                                                *
  5554*   FILE TYPE = VSAM,KSDS                                        *
  5555*   RECORD SIZE = 374   RECFORM = FIX                            *
  5556*                                                                *
  5557*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5558*   ALTERNATE PATH    = NOT USED                                 *
  5559*                                                                *
  5560*   LOG = YES                                                    *
  5561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5562******************************************************************
  5563*                   C H A N G E   L O G
  5564*
  5565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5566*-----------------------------------------------------------------
  5567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5568* EFFECTIVE    NUMBER
  5569*-----------------------------------------------------------------
  5570* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5571* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5572* 111108                   PEMA  ADD CRED BENE ADDR2
  5573******************************************************************
  5574
  5575 01  MAILING-DATA.
  5576     12  MA-RECORD-ID                      PIC XX.
  5577         88  VALID-MA-ID                       VALUE 'MA'.
  5578
  5579     12  MA-CONTROL-PRIMARY.
  5580         16  MA-COMPANY-CD                 PIC X.
  5581         16  MA-CARRIER                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  98
* EL677.cbl
  5582         16  MA-GROUPING.
  5583             20  MA-GROUPING-PREFIX        PIC XXX.
  5584             20  MA-GROUPING-PRIME         PIC XXX.
  5585         16  MA-STATE                      PIC XX.
  5586         16  MA-ACCOUNT.
  5587             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5588             20  MA-ACCOUNT-PRIME          PIC X(6).
  5589         16  MA-CERT-EFF-DT                PIC XX.
  5590         16  MA-CERT-NO.
  5591             20  MA-CERT-PRIME             PIC X(10).
  5592             20  MA-CERT-SFX               PIC X.
  5593
  5594     12  FILLER                            PIC XX.
  5595
  5596     12  MA-ACCESS-CONTROL.
  5597         16  MA-SOURCE-SYSTEM              PIC XX.
  5598             88  MA-FROM-CREDIT                VALUE 'CR'.
  5599             88  MA-FROM-VSI                   VALUE 'VS'.
  5600             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5601             88  MA-FROM-OTHER                 VALUE 'OT'.
  5602         16  MA-RECORD-ADD-DT              PIC XX.
  5603         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5604         16  MA-LAST-MAINT-DT              PIC XX.
  5605         16  MA-LAST-MAINT-BY              PIC XXXX.
  5606         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5607
  5608     12  MA-PROFILE-INFO.
  5609         16  MA-QUALIFY-CODE-1             PIC XX.
  5610         16  MA-QUALIFY-CODE-2             PIC XX.
  5611         16  MA-QUALIFY-CODE-3             PIC XX.
  5612         16  MA-QUALIFY-CODE-4             PIC XX.
  5613         16  MA-QUALIFY-CODE-5             PIC XX.
  5614
  5615         16  MA-INSURED-LAST-NAME          PIC X(15).
  5616         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5617         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5618         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5619         16  MA-INSURED-BIRTH-DT           PIC XX.
  5620         16  MA-INSURED-SEX                PIC X.
  5621             88  MA-SEX-MALE                   VALUE 'M'.
  5622             88  MA-SEX-FEMALE                 VALUE 'F'.
  5623         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5624
  5625         16  MA-ADDRESS-CORRECTED          PIC X.
  5626         16  MA-JOINT-BIRTH-DT             PIC XX.
  5627*        16  FILLER                        PIC X(12).
  5628
  5629         16  MA-ADDRESS-LINE-1             PIC X(30).
  5630         16  MA-ADDRESS-LINE-2             PIC X(30).
  5631         16  MA-CITY-STATE.
  5632             20  MA-CITY                   PIC X(28).
  5633             20  MA-ADDR-STATE             PIC XX.
  5634         16  MA-ZIP.
  5635             20  MA-ZIP-CODE.
  5636                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5637                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5638                 24  FILLER                PIC X(4).
  5639             20  MA-ZIP-PLUS4              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page  99
* EL677.cbl
  5640         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5641             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5642             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5643             20  FILLER                    PIC X(3).
  5644
  5645         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5646
  5647         16  FILLER                        PIC XXX.
  5648*        16  FILLER                        PIC X(10).
  5649
  5650     12  MA-CRED-BENE-INFO.
  5651         16  MA-CRED-BENE-NAME                 PIC X(25).
  5652         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5653         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5654         16  MA-CRED-BENE-CTYST.
  5655             20  MA-CRED-BENE-CITY             PIC X(28).
  5656             20  MA-CRED-BENE-STATE            PIC XX.
  5657         16  MA-CRED-BENE-ZIP.
  5658             20  MA-CB-ZIP-CODE.
  5659                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5660                     88  MA-CB-CANADIAN-POST-CODE
  5661                                           VALUE 'A' THRU 'Z'.
  5662                 24  FILLER                    PIC X(4).
  5663             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5664         16  MA-CB-CANADIAN-POSTAL-CODE
  5665                            REDEFINES MA-CRED-BENE-ZIP.
  5666             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5667             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5668             20  FILLER                        PIC X(3).
  5669     12  MA-POST-CARD-MAIL-DATA.
  5670         16  MA-MAIL-DATA OCCURS 7.
  5671             20  MA-MAIL-TYPE              PIC X.
  5672                 88  MA-12MO-MAILING           VALUE '1'.
  5673                 88  MA-EXP-MAILING            VALUE '2'.
  5674             20  MA-MAIL-STATUS            PIC X.
  5675                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5676                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5677                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5678             20  MA-MAIL-DATE              PIC XX.
  5679     12  FILLER                            PIC XX.
  5680     12  FILLER                            PIC XX.
  5681*    12  FILLER                            PIC X(30).
  5682******************************************************************
  5683*                                    COPY ERCPYAJ.
  5684******************************************************************
  5685*                                                                *
  5686*                            ERCPYAJ                             *
  5687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5688*                            VMOD=2.015                          *
  5689*                                                                *
  5690*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5691*                                                                *
  5692*                                                                *
  5693*   FILE TYPE = VSAM,KSDS                                        *
  5694*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5695*                                                                *
  5696*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5697*       ALTERNATE PATHS = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 100
* EL677.cbl
  5698*                                                                *
  5699*   LOG = YES                                                    *
  5700*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5701******************************************************************
  5702******************************************************************
  5703*                   C H A N G E   L O G
  5704*
  5705* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5706*-----------------------------------------------------------------
  5707*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5708* EFFECTIVE    NUMBER
  5709*-----------------------------------------------------------------
  5710* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5711* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5712******************************************************************
  5713
  5714 01  PENDING-PAY-ADJ.
  5715     12  PY-RECORD-ID                     PIC XX.
  5716         88  VALID-PY-ID                        VALUE 'PY'.
  5717
  5718     12  PY-CONTROL-PRIMARY.
  5719         16  PY-COMPANY-CD                PIC X.
  5720         16  PY-CARRIER                   PIC X.
  5721         16  PY-GROUPING                  PIC X(6).
  5722         16  PY-FIN-RESP                  PIC X(10).
  5723         16  PY-ACCOUNT                   PIC X(10).
  5724         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5725                                          PIC X(10).
  5726         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5727         16  PY-RECORD-TYPE               PIC X.
  5728             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5729             88  PY-DEPOSIT                   VALUE 'D'.
  5730             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5731             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5732             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5733             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5734             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5735             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5736             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5737             88  PY-FICA-ENTRY                VALUE 'F'.
  5738             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5739             88  PY-POLICY-FEE                VALUE 'W'.
  5740             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5741
  5742     12  PY-PYMT-TYPE                     PIC X.
  5743             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5744             88  PY-REINS-PYMT                VALUE 'R'.
  5745             88  PY-EXP-PYMT                  VALUE 'E'.
  5746
  5747     12  PY-BIL-INV                       PIC X(6).
  5748     12  PY-REF-NO                        PIC X(12).
  5749
  5750     12  PY-LAST-MAINT-DT                 PIC XX.
  5751     12  PY-LAST-MAINT-BY                 PIC X(4).
  5752     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5753
  5754     12  PY-PYADJ-RECORD.
  5755         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 101
* EL677.cbl
  5756         16  PY-ENTRY-COMMENT             PIC X(30).
  5757         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5758             20  PY-GL-ACCOUNT            PIC X(10).
  5759             20  PY-GL-STATE              PIC X(02).
  5760             20  PY-GL-CANC-SW            PIC X(01).
  5761                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5762                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5763             20  PY-GL-COMMENT            PIC X(10).
  5764             20  FILLER      REDEFINES PY-GL-COMMENT.
  5765                 24  PY-GL-CHECK-NO       PIC 9(06).
  5766                 24  FILLER               PIC X(04).
  5767             20  FILLER                   PIC X(07).
  5768         16  PY-SAVE-ACCOUNT              PIC X(10).
  5769         16  PY-SAVE-TYPE                 PIC X(01).
  5770
  5771         16  PY-LETTERS.
  5772             20  PY-LETTER OCCURS 3 TIMES
  5773                           INDEXED BY PY-LET-NDX
  5774                                          PIC X(04).
  5775
  5776         16  PY-ERCOMP-TYPE               PIC X.
  5777             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5778             88  PY-GA-TYPE                   VALUE 'G'.
  5779             88  PY-BANK-TYPE                 VALUE 'B'.
  5780         16  FILLER                       PIC X(05).
  5781
  5782     12  PY-RECORD-STATUS.
  5783         16  PY-CREDIT-SELECT-DT          PIC XX.
  5784         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5785         16  PY-BILLED-DATE               PIC XX.
  5786         16  PY-REPORTED-DT               PIC XX.
  5787         16  PY-PMT-APPLIED               PIC X.
  5788             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5789             88  PY-GA-PMT                    VALUE 'G'.
  5790             88  PY-OVWRITE-PMT               VALUE 'O'.
  5791             88  PY-NON-AR-PMT                VALUE 'N'.
  5792         16  FILLER                       PIC X(5).
  5793         16  PY-INPUT-DT                  PIC XX.
  5794         16  PY-CHECK-NUMBER              PIC X(6).
  5795         16  PY-VOID-SW                   PIC X.
  5796             88  PY-CHECK-VOIDED              VALUE 'V'.
  5797         16  PY-CHECK-ORIGIN-SW           PIC X.
  5798             88  PY-BILLING-CHECK             VALUE 'B'.
  5799             88  PY-REFUND-CHECK              VALUE 'R'.
  5800             88  PY-GA-CHECK                  VALUE 'G'.
  5801             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5802             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5803         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5804         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5805         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5806         16  PY-BILL-FLAG                 PIC X.
  5807             88  PY-BILLED                    VALUE 'B'.
  5808         16  PY-AR-FLAG                   PIC X.
  5809             88  PY-AR-CYCLE                  VALUE 'C'.
  5810             88  PY-AR-MONTH-END              VALUE 'M'.
  5811         16  PY-AR-DATE                   PIC XX.
  5812
  5813     12  PY-GL-CODES.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 102
* EL677.cbl
  5814         16  PY-GL-DB                     PIC X(14).
  5815         16  PY-GL-CR                     PIC X(14).
  5816         16  PY-GL-FLAG                   PIC X.
  5817         16  PY-GL-DATE                   PIC XX.
  5818
  5819     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5820     12  FILLER                           PIC X(3).
  5821******************************************************************
  5822 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5823                          CHECK-RECORDS ACCOUNT-MASTER
  5824                          COMPENSATION-MASTER
  5825                          CERTIFICATE-MASTER PENDING-BUSINESS
  5826                          PENDING-MAILING-DATA MAILING-DATA
  5827                          PENDING-PAY-ADJ.
  5828 0000-DFHEXIT SECTION.
  5829     MOVE '9#                    $   ' TO DFHEIV0.
  5830     MOVE 'EL677' TO DFHEIV1.
  5831     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5832
  5833     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5834     MOVE '5'                    TO  DC-OPTION-CODE.
  5835     PERFORM 8500-DATE-CONVERT.
  5836     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5837     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5838     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5839
  5840     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5841
  5842     IF PI-AMOUNT NOT NUMERIC
  5843         MOVE ZEROS              TO  PI-AMOUNT.
  5844
  5845     IF EIBCALEN = 0
  5846         GO TO 8800-UNAUTHORIZED-ACCESS.
  5847     set P to address of KIXSYS
  5848     CALL "getenv" using by value P returning var-ptr
  5849     if var-ptr = null then
  5850        display ' kixsys not set '
  5851     else
  5852        set address of var to var-ptr
  5853        move 0 to env-var-len
  5854        inspect var tallying env-var-len
  5855          for characters before X'00'
  5856        unstring var (1:env-var-len) delimited by '/'
  5857           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5858              WS-KIX-SYS
  5859        end-unstring
  5860     end-if
  5861     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5862     MOVE 2                      TO  EMI-SWITCH2.
  5863     MOVE EIBTRMID               TO  QID-TERM.
  5864
  5865     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5866         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5867
  5868     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5869         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5870             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5871             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 103
* EL677.cbl
  5872             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5873             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5874             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5875             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5876             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5877             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5878         ELSE
  5879             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5880             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5881             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5882             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5883             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5884             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5885             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5886             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5887
  5888     MOVE LOW-VALUES             TO  EL677AI.
  5889
  5890     if eibtrnid not = trans-id
  5891        evaluate true
  5892           when pi-return-to-program = 'EL6315'
  5893              move pi-company-cd to pi-chek-comp-cd
  5894              move pi-carrier    to pi-chek-carrier
  5895              move pi-grouping   to pi-chek-grouping
  5896              move pi-state      to pi-chek-state
  5897              move pi-account    to pi-chek-account
  5898              move pi-cert-eff-dt to pi-chek-eff-dt
  5899              move pi-cert-prime to pi-chek-cert-no
  5900              move pi-cert-sfx   to pi-chek-suf-no
  5901              move +1            to pi-chek-sequence
  5902              move 'C'           to pi-check-type *> Correction
  5903              move 'S'           to mainti
  5904              move +1            to maintl
  5905              move al-uanon      to mainta
  5906              move dfhenter      to eibaid
  5907              go to 5000-browse-file
  5908           when pi-return-to-program = 'EL6318'
  5909              move 'C'           to pi-check-type *> Correction
  5910           when other
  5911              move 'R'           to pi-check-type *> Refund
  5912        end-evaluate
  5913     end-if
  5914     IF EIBTRNID NOT = TRANS-ID
  5915         move pi-processor-id    to pi-return-to
  5916         move +1                 to dedcynl
  5917         move 'N'                to dedcyno
  5918         move al-uanon           to dedcyna
  5919         move dfhpf7             to eibaid
  5920         perform 6800-browse-previous-chek-recs *> totals up prev
  5921                                 thru 6800-exit
  5922         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5923                                                *> pending record
  5924         IF PI-TO-EL677-FROM-EL1273
  5925             MOVE 'S'            TO MAINTI
  5926             MOVE 1              TO MAINTL
  5927             MOVE AL-UABON       TO MAINTA
  5928             MOVE DFHENTER       TO EIBAID
  5929             GO TO 5000-BROWSE-FILE.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 104
* EL677.cbl
  5930
  5931     IF EIBTRNID NOT = TRANS-ID
  5932        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5933           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5934           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5935           IF PI-PROCESS-BENEFICIARY
  5936              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5937           ELSE
  5938              GO TO 6300-BUILD-CERT-SCREEN
  5939           end-if
  5940        ELSE
  5941           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5942              GO TO 8100-SEND-INITIAL-MAP
  5943           ELSE
  5944              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5945              IF PI-PROCESS-BENEFICIARY
  5946                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5947              ELSE
  5948                 GO TO 6300-BUILD-CERT-SCREEN
  5949              end-if
  5950           end-if
  5951        end-if
  5952      end-if
  5953
  5954     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5955                                     PI-CHEK-COMP-CD.
  5956
  5957
  5958* EXEC CICS HANDLE CONDITION
  5959*        PGMIDERR  (9600-PGMID-ERROR)
  5960*        ERROR     (9990-ABEND)
  5961*    END-EXEC.
  5962*    MOVE '"$L.                  ! " #00005860' TO DFHEIV0
  5963     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5965     MOVE X'2220233030303035383630' TO DFHEIV0(25:11)
  5966     CALL 'kxdfhei1' USING DFHEIV0
  5967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5968
  5969
  5970     IF EIBAID = DFHCLEAR
  5971         GO TO 9400-CLEAR.
  5972
  5973     IF PI-PROCESSOR-ID = 'LGXX'
  5974         GO TO 0200-RECEIVE.
  5975
  5976
  5977* EXEC CICS READQ TS
  5978*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5979*        INTO   (SECURITY-CONTROL)
  5980*        LENGTH (SC-COMM-LENGTH)
  5981*        ITEM   (SC-ITEM)
  5982*    END-EXEC.
  5983*    MOVE '*$II   L              ''   #00005871' TO DFHEIV0
  5984     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5985     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5986     MOVE X'2020233030303035383731' TO DFHEIV0(25:11)
  5987     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 105
* EL677.cbl
  5988           PI-SECURITY-TEMP-STORE-ID,
  5989           SECURITY-CONTROL,
  5990           SC-COMM-LENGTH,
  5991           SC-ITEM,
  5992           DFHEIV99,
  5993           DFHEIV99
  5994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5995
  5996
  5997     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5998     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5999
  6000     IF NOT DISPLAY-CAP
  6001         MOVE 'READ'          TO SM-READ
  6002         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6003         MOVE ER-0070         TO  EMI-ERROR
  6004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6005         GO TO 8100-SEND-INITIAL-MAP.
  6006
  6007 0200-RECEIVE.
  6008     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6009         MOVE ER-1159            TO  EMI-ERROR
  6010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6011         MOVE -1                 TO  PFENTERL
  6012         GO TO 8200-SEND-DATAONLY.
  6013
  6014
  6015* EXEC CICS HANDLE CONDITION
  6016*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6017*    END-EXEC.
  6018*    MOVE '"$?                   ! # #00005895' TO DFHEIV0
  6019     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6021     MOVE X'2320233030303035383935' TO DFHEIV0(25:11)
  6022     CALL 'kxdfhei1' USING DFHEIV0
  6023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6024
  6025
  6026
  6027* EXEC CICS RECEIVE
  6028*        MAP      (EL677A)
  6029*        MAPSET   (MAPSET-NAME)
  6030*        INTO     (EL677AI)
  6031*    END-EXEC.
  6032     MOVE LENGTH OF
  6033      EL677AI
  6034       TO DFHEIV11
  6035*    MOVE '8"T I  L              ''   #00005899' TO DFHEIV0
  6036     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6038     MOVE X'2020233030303035383939' TO DFHEIV0(25:11)
  6039     CALL 'kxdfhei1' USING DFHEIV0,
  6040           EL677A,
  6041           EL677AI,
  6042           DFHEIV11,
  6043           MAPSET-NAME,
  6044           DFHEIV99,
  6045           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 106
* EL677.cbl
  6046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6047
  6048
  6049     IF PFENTERL GREATER ZERO
  6050         IF EIBAID NOT = DFHENTER
  6051             MOVE ER-0004        TO  EMI-ERROR
  6052             MOVE AL-UNBOF       TO  PFENTERA
  6053             MOVE -1             TO  PFENTERL
  6054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6055             GO TO 8200-SEND-DATAONLY
  6056         ELSE
  6057             IF (PFENTERI NUMERIC) AND
  6058                (PFENTERI GREATER 0 AND LESS 25)
  6059                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6060             ELSE
  6061                 MOVE ER-0029    TO  EMI-ERROR
  6062                 MOVE AL-UNBOF   TO  PFENTERA
  6063                 MOVE -1         TO  PFENTERL
  6064                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6065                 GO TO 8200-SEND-DATAONLY.
  6066 0300-CHECK-PFKEYS.
  6067     IF EIBAID = DFHPF23
  6068         GO TO 8810-PF23.
  6069
  6070     IF EIBAID = DFHPF24
  6071         GO TO 9200-RETURN-MAIN-MENU.
  6072
  6073     IF EIBAID = DFHPF12
  6074         GO TO 9500-PF12.
  6075
  6076     IF EIBAID = DFHPF1 OR DFHPF2
  6077         GO TO 5000-BROWSE-FILE.
  6078
  6079     if PI-TO-EL677-FROM-EL1273
  6080        and (eibaid not = dfhenter)
  6081        go to 0320-input-error
  6082     end-if
  6083     IF EIBAID = DFHPF3
  6084         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6085         MOVE 'PF3'              TO  PI-PFKEY
  6086         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6087         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6088             GO TO 9400-CLEAR
  6089         ELSE
  6090             MOVE XCTL-1273      TO  PGM-NAME
  6091             GO TO 9300-XCTL.
  6092
  6093     IF EIBAID = DFHPF4
  6094         IF NOT FORCE-CAP
  6095             MOVE ER-0433        TO EMI-ERROR
  6096             MOVE -1             TO PFENTERL
  6097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6098             GO TO 8200-SEND-DATAONLY.
  6099
  6100     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6101                             DFHPF5 OR DFHPF6 or dfhpf7
  6102         GO TO 1000-EDIT-DATA.
  6103
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 107
* EL677.cbl
  6104*    IF EIBAID = DFHPF7
  6105*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6106*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6107*        MOVE XCTL-114           TO  PGM-NAME
  6108*        GO TO 9300-XCTL.
  6109
  6110 0320-INPUT-ERROR.
  6111     MOVE ER-0029                TO  EMI-ERROR.
  6112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6113     MOVE -1                     TO  PFENTERL.
  6114     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 108
* EL677.cbl
  6116
  6117 1000-EDIT-DATA.
  6118     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6119         MOVE AL-UANON           TO MAINTA
  6120         IF MAINTI = 'C' OR 'V'
  6121             IF PI-PREV-MAINT = 'S'  OR  'C'
  6122                 NEXT SENTENCE
  6123             ELSE
  6124                 MOVE ER-2056    TO  EMI-ERROR
  6125                 MOVE -1         TO  MAINTL
  6126                 MOVE AL-UABON   TO  MAINTA
  6127                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6128                 GO TO 1100-EDIT-COMPLETE
  6129         ELSE
  6130             NEXT SENTENCE
  6131     ELSE
  6132         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6133            NEXT SENTENCE
  6134         ELSE
  6135            MOVE ER-0023            TO  EMI-ERROR
  6136            MOVE -1                 TO  MAINTL
  6137            MOVE AL-UABON           TO  MAINTA
  6138            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6139
  6140     IF MODIFY-CAP
  6141         NEXT SENTENCE
  6142       ELSE
  6143         IF MAINTI NOT = 'S'
  6144            MOVE 'UPDATE'       TO SM-READ
  6145            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6146            MOVE ER-0070        TO EMI-ERROR
  6147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6148            GO TO 8100-SEND-INITIAL-MAP.
  6149
  6150     if (pi-return-to-program = 'EL1273')
  6151        and (MAINTI not = 'S' and 'V')
  6152        move 'S'                 to mainti
  6153        move +1                  to maintl
  6154        move al-uanon            to mainta
  6155     end-if
  6156     IF CARRIERI NOT = LOW-VALUES
  6157         MOVE AL-UANON           TO  CARRIERA
  6158         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6159         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6160                                     PI-CARRIER
  6161     ELSE
  6162         MOVE -1                 TO  CARRIERL
  6163         MOVE AL-UABON           TO  CARRIERA
  6164         MOVE ER-0194            TO  EMI-ERROR
  6165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6166
  6167     IF GROUPI NOT = LOW-VALUES
  6168         MOVE AL-UANON           TO  GROUPA
  6169         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6170                                     PI-GROUPING
  6171     ELSE
  6172         MOVE -1                 TO  GROUPL
  6173         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 109
* EL677.cbl
  6174         MOVE ER-0195            TO  EMI-ERROR
  6175         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6176
  6177     IF STATEI NOT = LOW-VALUES
  6178         MOVE AL-UANON           TO  STATEA
  6179         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6180         MOVE STATEI             TO  PI-CHEK-STATE
  6181                                     PI-STATE
  6182     ELSE
  6183         MOVE -1                 TO  STATEL
  6184         MOVE AL-UABON           TO  STATEA
  6185         MOVE ER-0196            TO  EMI-ERROR
  6186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6187
  6188     IF EFFDTL GREATER ZERO
  6189         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6190         PERFORM 8700-DEEDIT
  6191         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6192             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6193             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6194             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6195             MOVE '4'                TO  DC-OPTION-CODE
  6196             PERFORM 8500-DATE-CONVERT
  6197             IF DC-ERROR-CODE NOT = SPACES
  6198                 MOVE ER-0215        TO  EMI-ERROR
  6199                 PERFORM 9900-ERROR-FORMAT
  6200                 MOVE -1             TO  EFFDTL
  6201                 MOVE AL-UABON       TO  EFFDTA
  6202               ELSE
  6203                 MOVE AL-UANON       TO  EFFDTA
  6204                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6205                                         PI-CERT-EFF-DT
  6206           ELSE
  6207             MOVE ER-0215        TO  EMI-ERROR
  6208             PERFORM 9900-ERROR-FORMAT
  6209             MOVE -1             TO  EFFDTL
  6210             MOVE AL-UABON       TO  EFFDTA
  6211       ELSE
  6212         MOVE ER-0216            TO  EMI-ERROR
  6213         PERFORM 9900-ERROR-FORMAT
  6214         MOVE -1                 TO  EFFDTL
  6215         MOVE AL-UABOF           TO  EFFDTA.
  6216
  6217     IF ACCTI NOT = LOW-VALUES
  6218         MOVE AL-UANON           TO  ACCTA
  6219         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6220         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6221                                     PI-ACCOUNT
  6222     ELSE
  6223         MOVE -1                 TO  ACCTL
  6224         MOVE AL-UABON           TO  ACCTA
  6225         MOVE ER-0197            TO  EMI-ERROR
  6226         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6227
  6228     IF CERTNOI NOT = LOW-VALUES
  6229         MOVE AL-UANON           TO  CERTNOA
  6230         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6231                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 110
* EL677.cbl
  6232     ELSE
  6233         MOVE -1                 TO  CERTNOL
  6234         MOVE AL-UABON           TO  CERTNOA
  6235         MOVE ER-0203            TO  EMI-ERROR
  6236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6237
  6238     IF SFXI  = LOW-VALUES
  6239         MOVE SPACE              TO  SFXI.
  6240
  6241     MOVE AL-UANON               TO  SFXA.
  6242
  6243     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6244                                     PI-CERT-SFX.
  6245     IF SEQI = LOW-VALUES
  6246         MOVE +1                 TO  SEQI.
  6247
  6248     MOVE AL-UNNON               TO  SEQA.
  6249     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6250
  6251     IF PAYTO1L > 0
  6252         MOVE PAYTO1I            TO  PI-PAYTO1
  6253     ELSE
  6254         MOVE SPACES             TO  PI-PAYTO1.
  6255
  6256     IF AMOUNTL > 0
  6257
  6258* EXEC CICS BIF DEEDIT
  6259*            FIELD   (AMOUNTI)
  6260*            LENGTH  (11)
  6261*        END-EXEC
  6262     MOVE 11
  6263       TO DFHEIV11
  6264*    MOVE '@"L                   #   #00006113' TO DFHEIV0
  6265     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6266     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6267     MOVE X'2020233030303036313133' TO DFHEIV0(25:11)
  6268     CALL 'kxdfhei1' USING DFHEIV0,
  6269           AMOUNTI,
  6270           DFHEIV11
  6271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6272         MOVE AMOUNTI            TO  PI-AMOUNT
  6273     ELSE
  6274         MOVE ZEROS              TO  PI-AMOUNT.
  6275
  6276     IF TYPEL > 0
  6277         MOVE TYPEI              TO  PI-TYPE
  6278     ELSE
  6279         MOVE SPACE              TO  PI-TYPE.
  6280
  6281*    IF REFL > 0
  6282*        MOVE REFI               TO  PI-REFERENCE
  6283*    ELSE
  6284*        MOVE SPACES             TO  PI-REFERENCE.
  6285     if rettol not = zeros
  6286        move rettoi              to pi-return-to
  6287        MOVE AL-UANON            TO  RETTOA
  6288     end-if
  6289     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 111
* EL677.cbl
  6290        if dedcyni = 'Y' OR 'N'
  6291           continue
  6292        else
  6293           move er-3451          to emi-error
  6294           move -1               to dedcynl
  6295           move al-uabon         to dedcyna
  6296           perform 9900-error-format
  6297                                 thru 9900-exit
  6298        end-if
  6299     end-if
  6300
  6301     if mainti = 'V'
  6302        if (vreasonl > zeros)
  6303           and (vreasoni (1:2) not = spaces)
  6304           continue
  6305        else
  6306           move er-3454          to emi-error
  6307           move -1               to vreasonl
  6308           move al-uabon         to vreasona
  6309           perform 9900-error-format
  6310                                 thru 9900-exit
  6311        end-if
  6312     end-if
  6313     if (mainti = 'A')
  6314        and (pi-prev-paid > zeros)
  6315        and (pi-check-type = 'C')
  6316        move er-3459             to emi-error
  6317        move -1                  to maintl
  6318        move al-uabon            to mainta
  6319        perform 9900-error-format
  6320                                 thru 9900-exit
  6321     end-if
  6322     if mainti = 'A'
  6323        continue
  6324     else
  6325        IF MAINTI = 'S'
  6326           or pi-prev-maint = 'S'
  6327           GO TO 1100-EDIT-COMPLETE
  6328        end-if
  6329     end-if
  6330     IF EIBAID = DFHPF5
  6331        IF EMI-ERROR = ZEROS
  6332          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6333        ELSE
  6334          GO TO 1100-EDIT-COMPLETE.
  6335
  6336     IF EIBAID = DFHPF6
  6337        IF EMI-ERROR = ZEROS
  6338           GO TO 6300-BUILD-CERT-SCREEN
  6339         ELSE
  6340           GO TO 1100-EDIT-COMPLETE.
  6341
  6342     IF EIBAID = DFHPF7
  6343        IF EMI-ERROR = ZEROS
  6344           GO TO 6600-build-beneficiary-screen
  6345         ELSE
  6346           GO TO 1100-EDIT-COMPLETE.
  6347
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 112
* EL677.cbl
  6348*    if mainti = 'V'
  6349*       if (vreasonl > zeros)
  6350*          and (vreasoni (1:2) not = spaces)
  6351*          continue
  6352*       else
  6353*          move er-3454          to emi-error
  6354*          move -1               to vreasonl
  6355*          move al-uabon         to vreasona
  6356*          perform 9900-error-format
  6357*                                thru 9900-exit
  6358*       end-if
  6359*    end-if
  6360     IF MAINTI = 'A'
  6361        if (payto1i not = spaces and low-values)
  6362           and (payad1i not = spaces and low-values)
  6363           and (payctyi not = spaces and low-values)
  6364           and (paysti not = spaces and low-values)
  6365           and (ptozipi not = spaces and low-values)
  6366           continue
  6367        else
  6368           MOVE -1               TO PAYTO1L
  6369           MOVE ER-2907          TO EMI-ERROR
  6370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6371        end-if
  6372     end-if
  6373
  6374     IF MAINTI = 'A'
  6375         IF EIBAID NOT = DFHPF4
  6376             MOVE DFHENTER       TO  EIBAID
  6377             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6378
  6379     IF MAINTI = 'S' OR 'V'
  6380         GO TO 1100-EDIT-COMPLETE.
  6381
  6382     IF PRINTEDL GREATER THAN +0
  6383         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6384         PERFORM 8700-DEEDIT
  6385         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6386             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6387             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6388             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6389             MOVE '4'                TO  DC-OPTION-CODE
  6390             PERFORM 8500-DATE-CONVERT
  6391             IF DC-ERROR-CODE NOT = SPACES
  6392                 MOVE ER-3046        TO  EMI-ERROR
  6393                 PERFORM 9900-ERROR-FORMAT
  6394                 MOVE -1             TO  PRINTEDL
  6395                 MOVE AL-UABON       TO  PRINTEDA
  6396                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6397             ELSE
  6398                 MOVE AL-UANON       TO  PRINTEDA
  6399                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6400         ELSE
  6401             MOVE ER-3046        TO  EMI-ERROR
  6402             PERFORM 9900-ERROR-FORMAT
  6403             MOVE -1             TO  PRINTEDL
  6404             MOVE AL-UABON       TO  PRINTEDA
  6405             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 113
* EL677.cbl
  6406
  6407     IF AMOUNTL = ZEROS
  6408         GO TO 1050-CK-AMT.
  6409
  6410
  6411* EXEC CICS BIF DEEDIT
  6412*        FIELD   (AMOUNTI)
  6413*        LENGTH  (11)
  6414*    END-EXEC.
  6415     MOVE 11
  6416       TO DFHEIV11
  6417*    MOVE '@"L                   #   #00006255' TO DFHEIV0
  6418     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6419     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6420     MOVE X'2020233030303036323535' TO DFHEIV0(25:11)
  6421     CALL 'kxdfhei1' USING DFHEIV0,
  6422           AMOUNTI,
  6423           DFHEIV11
  6424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6425
  6426
  6427     IF AMOUNTI NOT NUMERIC     OR
  6428        AMOUNTI LESS THAN ZERO  OR
  6429       (AMOUNTI = ZEROS  AND
  6430               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6431          MOVE ER-1159            TO  EMI-ERROR
  6432          MOVE -1                 TO  AMOUNTL
  6433          MOVE AL-UNBON           TO  AMOUNTA
  6434          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6435          GO TO 1100-EDIT-COMPLETE.
  6436
  6437     MOVE AMOUNTI                TO  WS-AM-WORK.
  6438
  6439     IF WS-AM-SIGN = SPACES
  6440         MOVE WS-AM-NUM          TO  WS-AMT
  6441         ADD 0                   TO  WS-AMT
  6442       ELSE
  6443         MOVE AMOUNTI            TO  WS-AMT
  6444         ADD 0                   TO  WS-AMT.
  6445
  6446      MOVE WS-AMT                TO  AMOUNTO.
  6447      MOVE AL-UNNON              TO  AMOUNTA.
  6448
  6449 1050-CK-AMT.
  6450     IF AMOUNTL = ZEROS AND
  6451        MAINTI  = 'A'
  6452         MOVE ER-1159            TO  EMI-ERROR
  6453         MOVE -1                 TO  AMOUNTL
  6454         MOVE AL-UNBON           TO  AMOUNTA
  6455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6456
  6457*    MOVE AL-UANON              TO  TYPEA.
  6458
  6459     IF TYPEL GREATER THAN ZEROS
  6460         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6461             NEXT SENTENCE
  6462         ELSE
  6463             MOVE ER-3044    TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 114
* EL677.cbl
  6464             MOVE -1         TO  TYPEL
  6465             MOVE AL-PABON   TO  TYPEA
  6466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6467     ELSE
  6468         IF MAINTI  = 'A'
  6469             MOVE ER-3044    TO  EMI-ERROR
  6470             MOVE -1         TO  TYPEL
  6471             MOVE AL-PABON   TO  TYPEA
  6472             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6473
  6474
  6475 1100-EDIT-COMPLETE.
  6476
  6477     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6478       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6479        EIBAID NOT = DFHPF4)
  6480         GO TO 8200-SEND-DATAONLY.
  6481
  6482     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6483
  6484     IF MAINTI = 'A'
  6485         GO TO 2000-ADD-RECORD.
  6486
  6487*    IF MAINTI = 'C' OR 'V'
  6488     IF MAINTI = 'V'
  6489         GO TO 3000-CHANGE-RECORD.
  6490
  6491     IF MAINTI = 'S' or 'C'
  6492         GO TO 5000-BROWSE-FILE.
  6493
  6494     if mainti = 'D'
  6495        go to 3400-delete-record
  6496     end-if
  6497     .
  6498 1200-VERIFY-CARRIER-ID.
  6499     MOVE SPACES                 TO ELCNTL-KEY.
  6500     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6501     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6502     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6503     MOVE +0                     TO ELCNTL-SEQ.
  6504
  6505
  6506* EXEC CICS HANDLE CONDITION
  6507*        NOTFND   (1290-NO-CARRIER)
  6508*    END-EXEC.
  6509*    MOVE '"$I                   ! $ #00006338' TO DFHEIV0
  6510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6512     MOVE X'2420233030303036333338' TO DFHEIV0(25:11)
  6513     CALL 'kxdfhei1' USING DFHEIV0
  6514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6515
  6516
  6517
  6518* EXEC CICS READ
  6519*        DATASET   (ELCNTL-FILE-ID)
  6520*        SET       (ADDRESS OF CONTROL-FILE)
  6521*        RIDFLD    (ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 115
* EL677.cbl
  6522*    END-EXEC.
  6523*    MOVE '&"S        E          (   #00006342' TO DFHEIV0
  6524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6526     MOVE X'2020233030303036333432' TO DFHEIV0(25:11)
  6527     CALL 'kxdfhei1' USING DFHEIV0,
  6528           ELCNTL-FILE-ID,
  6529           DFHEIV20,
  6530           DFHEIV99,
  6531           ELCNTL-KEY,
  6532           DFHEIV99,
  6533           DFHEIV99,
  6534           DFHEIV99
  6535     SET ADDRESS OF CONTROL-FILE TO
  6536         DFHEIV20
  6537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6538
  6539
  6540     GO TO 1200-EXIT.
  6541
  6542 1290-NO-CARRIER.
  6543     MOVE ER-2208                TO EMI-ERROR.
  6544     MOVE -1                     TO CARRIERL.
  6545     MOVE AL-UABON               TO CARRIERA.
  6546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6547
  6548 1200-EXIT.
  6549      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 116
* EL677.cbl
  6551 1300-VERIFY-STATE-ID.
  6552     MOVE SPACES                 TO ELCNTL-KEY.
  6553     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6554     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6555     MOVE STATEI                 TO ELCNTL-STATE.
  6556     MOVE +0                     TO ELCNTL-SEQ.
  6557
  6558
  6559* EXEC CICS HANDLE CONDITION
  6560*        NOTFND   (1380-NO-STATE)
  6561*    END-EXEC.
  6562*    MOVE '"$I                   ! % #00006366' TO DFHEIV0
  6563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6565     MOVE X'2520233030303036333636' TO DFHEIV0(25:11)
  6566     CALL 'kxdfhei1' USING DFHEIV0
  6567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6568
  6569
  6570
  6571* EXEC CICS READ
  6572*        DATASET   (ELCNTL-FILE-ID)
  6573*        SET       (ADDRESS OF CONTROL-FILE)
  6574*        RIDFLD    (ELCNTL-KEY)
  6575*    END-EXEC.
  6576*    MOVE '&"S        E          (   #00006370' TO DFHEIV0
  6577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6579     MOVE X'2020233030303036333730' TO DFHEIV0(25:11)
  6580     CALL 'kxdfhei1' USING DFHEIV0,
  6581           ELCNTL-FILE-ID,
  6582           DFHEIV20,
  6583           DFHEIV99,
  6584           ELCNTL-KEY,
  6585           DFHEIV99,
  6586           DFHEIV99,
  6587           DFHEIV99
  6588     SET ADDRESS OF CONTROL-FILE TO
  6589         DFHEIV20
  6590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6591
  6592
  6593     GO TO 1390-EXIT.
  6594
  6595 1380-NO-STATE.
  6596     MOVE ER-2209                TO EMI-ERROR.
  6597     MOVE -1                     TO STATEL.
  6598     MOVE AL-UABON               TO STATEA.
  6599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6600
  6601 1390-EXIT.
  6602      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 117
* EL677.cbl
  6604
  6605 1400-VERIFY-ACCOUNT.
  6606     IF EIBAID = DFHPF5
  6607         GO TO 1410-BUILD-ACCOUNT-KEY.
  6608
  6609     IF MAINTL GREATER +0
  6610         NEXT SENTENCE
  6611       ELSE
  6612         GO TO 1490-EXIT.
  6613
  6614*    IF MAINTI = 'A' OR 'C' OR 'V'
  6615     IF MAINTI = 'A' OR 'V'
  6616         NEXT SENTENCE
  6617       ELSE
  6618         GO TO 1490-EXIT.
  6619
  6620 1410-BUILD-ACCOUNT-KEY.
  6621     MOVE CARRIERI               TO ERACCT-CARRIER.
  6622     MOVE GROUPI                 TO ERACCT-GROUPING
  6623     MOVE STATEI                 TO ERACCT-STATE.
  6624     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6625     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6626
  6627     MOVE '2'                    TO DC-OPTION-CODE.
  6628     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6629
  6630     PERFORM 8500-DATE-CONVERT.
  6631     IF DATE-CONVERSION-ERROR
  6632        GO TO 1480-ACCOUNT-INVALID.
  6633
  6634     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6635    .
  6636 1420-get-eracct.
  6637     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6638
  6639
  6640* EXEC CICS HANDLE CONDITION
  6641*        NOTFND   (1480-ACCOUNT-INVALID)
  6642*        ENDFILE  (1480-ACCOUNT-INVALID)
  6643*    END-EXEC.
  6644*    MOVE '"$I''                  ! & #00006422' TO DFHEIV0
  6645     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6647     MOVE X'2620233030303036343232' TO DFHEIV0(25:11)
  6648     CALL 'kxdfhei1' USING DFHEIV0
  6649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6650
  6651
  6652
  6653* EXEC CICS STARTBR
  6654*        DATASET   (ERACCT-FILE-ID)
  6655*        RIDFLD    (ERACCT-KEY)
  6656*    END-EXEC.
  6657     MOVE 0
  6658       TO DFHEIV11
  6659*    MOVE '&,         G          &   #00006427' TO DFHEIV0
  6660     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6661     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 118
* EL677.cbl
  6662     MOVE X'2020233030303036343237' TO DFHEIV0(25:11)
  6663     CALL 'kxdfhei1' USING DFHEIV0,
  6664           ERACCT-FILE-ID,
  6665           ERACCT-KEY,
  6666           DFHEIV99,
  6667           DFHEIV11,
  6668           DFHEIV99
  6669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6670
  6671
  6672     set eracct-start to true
  6673     .
  6674 1420-READNEXT-ACCOUNT-MASTER.
  6675
  6676* EXEC CICS READNEXT
  6677*        DATASET   (ERACCT-FILE-ID)
  6678*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6679*        RIDFLD    (ERACCT-KEY)
  6680*    END-EXEC.
  6681     MOVE 0
  6682       TO DFHEIV11
  6683*    MOVE '&.S                   )   #00006435' TO DFHEIV0
  6684     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6686     MOVE X'2020233030303036343335' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0,
  6688           ERACCT-FILE-ID,
  6689           DFHEIV20,
  6690           DFHEIV99,
  6691           ERACCT-KEY,
  6692           DFHEIV99,
  6693           DFHEIV11,
  6694           DFHEIV99,
  6695           DFHEIV99
  6696     SET ADDRESS OF ACCOUNT-MASTER TO
  6697         DFHEIV20
  6698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6699
  6700
  6701*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6702*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6703*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6704*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6705*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6706*         GO TO 1480-ACCOUNT-INVALID.
  6707*
  6708*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6709*        GO TO 1480-ACCOUNT-INVALID.
  6710*
  6711*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6712*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6713
  6714     evaluate true
  6715        when (save-eracct-key (1:20) not =
  6716           am-control-primary (1:20))
  6717           and (not eracct-found)
  6718           go to 1480-account-invalid
  6719        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 119
* EL677.cbl
  6720           am-control-primary (1:20))
  6721           and (eracct-found)
  6722           move ws-hold-eracct-record
  6723                                 to account-master
  6724        when (sv-acct-exp-date < am-effective-dt)
  6725           and (not eracct-found)
  6726           go to 1480-account-invalid
  6727        when sv-acct-exp-date >= am-expiration-dt
  6728           go to 1420-readnext-account-master
  6729        when am-expiration-dt = high-values
  6730           continue
  6731        when other
  6732           set eracct-found to true
  6733           move account-master   to ws-hold-eracct-record
  6734           go to 1420-readnext-account-master
  6735     end-evaluate
  6736     if eracct-start
  6737
  6738* exec cics endbr
  6739*          dataset  (eracct-file-id)
  6740*       end-exec
  6741     MOVE 0
  6742       TO DFHEIV11
  6743*    MOVE '&2                    $   #00006477' TO DFHEIV0
  6744     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6745     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6746     MOVE X'2020233030303036343737' TO DFHEIV0(25:11)
  6747     CALL 'kxdfhei1' USING DFHEIV0,
  6748           eracct-file-id,
  6749           DFHEIV11,
  6750           DFHEIV99
  6751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6752     end-if
  6753*    if am-expiration-dt = high-values
  6754*       continue
  6755*    else
  6756*       move account-master      to ws-hold-eracct-record
  6757*       go to 1420-readnext-account-master
  6758*    end-if
  6759     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6760     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6761     MOVE AM-STATE               TO PI-CR-STATE.
  6762     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6763
  6764     MOVE AM-NAME                TO PI-AM-NAME.
  6765     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6766     MOVE AM-CITY                TO PI-AM-CITY-st
  6767     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6768     move am-csr-code            to pi-am-csr
  6769
  6770     MOVE +0                     TO WS-SUB.
  6771
  6772 1430-FIND-ACC-AGT.
  6773     ADD +1                      TO WS-SUB.
  6774
  6775     IF  WS-SUB GREATER +10
  6776         GO TO 1480-ACCOUNT-INVALID.
  6777
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 120
* EL677.cbl
  6778     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6779         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6780       ELSE
  6781         GO TO 1430-FIND-ACC-AGT.
  6782
  6783     MOVE AL-UANON               TO CARRIERA
  6784                                    GROUPA
  6785                                    STATEA.
  6786
  6787     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6788
  6789     GO TO 1490-EXIT.
  6790
  6791 1480-ACCOUNT-INVALID.
  6792     MOVE -1                     TO CARRIERL
  6793     MOVE AL-UANON               TO CARRIERA
  6794                                    GROUPA
  6795                                    STATEA
  6796                                    ACCTA.
  6797     MOVE ER-2210                TO EMI-ERROR.
  6798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6799     GO TO 8200-SEND-DATAONLY.
  6800
  6801 1490-EXIT.
  6802      EXIT.
  6803
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 121
* EL677.cbl
  6805 1500-VERIFY-PENDING-BUS-REC.
  6806     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6807     if ws-corr-check
  6808        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6809        go to 1590-exit
  6810     end-if
  6811
  6812* EXEC CICS HANDLE CONDITION
  6813*        NOTFND   (1590-EXIT)
  6814*    END-EXEC.
  6815*    MOVE '"$I                   ! '' #00006539' TO DFHEIV0
  6816     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6818     MOVE X'2720233030303036353339' TO DFHEIV0(25:11)
  6819     CALL 'kxdfhei1' USING DFHEIV0
  6820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6821
  6822
  6823
  6824     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6825     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6826     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6827     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6828     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6829     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6830     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6831     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6832     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6833     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6834
  6835     IF ST-ACCNT-CNTL  OR
  6836        ACCNT-CNTL
  6837          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6838
  6839     IF ST-ACCNT-CNTL      OR
  6840        CARR-ST-ACCNT-CNTL OR
  6841        ACCNT-CNTL         OR
  6842        CARR-ACCNT-CNTL
  6843          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6844
  6845     IF ACCNT-CNTL OR
  6846        CARR-ACCNT-CNTL
  6847          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6848
  6849
  6850* EXEC CICS READ
  6851*         DATASET   (ERPNDB-ALT-FILE-ID)
  6852*         SET       (ADDRESS OF PENDING-BUSINESS)
  6853*         RIDFLD    (ERPNDB-ALT-KEY)
  6854*     END-EXEC.
  6855*    MOVE '&"S        E          (   #00006569' TO DFHEIV0
  6856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6858     MOVE X'2020233030303036353639' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0,
  6860           ERPNDB-ALT-FILE-ID,
  6861           DFHEIV20,
  6862           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 122
* EL677.cbl
  6863           ERPNDB-ALT-KEY,
  6864           DFHEIV99,
  6865           DFHEIV99,
  6866           DFHEIV99
  6867     SET ADDRESS OF PENDING-BUSINESS TO
  6868         DFHEIV20
  6869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6870
  6871
  6872     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6873
  6874     IF PB-C-PAYEE-CODE GREATER SPACES
  6875        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6876
  6877     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6878*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6879
  6880     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6881     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6882
  6883     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6884         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6885     ELSE
  6886         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6887
  6888*    IF MAINTI = 'A' OR 'C'
  6889*      IF PB-C-REFUND-CREATED
  6890*          MOVE -1               TO  MAINTL
  6891*          MOVE ER-3445          TO  EMI-ERROR
  6892*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6893
  6894 1590-EXIT.
  6895      EXIT.
  6896
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 123
* EL677.cbl
  6898 2000-ADD-RECORD.
  6899
  6900* EXEC CICS GETMAIN
  6901*        SET      (ADDRESS OF CHECK-RECORDS)
  6902*        LENGTH   (600)
  6903*        INITIMG  (GETMAIN-SPACE)
  6904*    END-EXEC.
  6905     MOVE 600
  6906       TO DFHEIV11
  6907*    MOVE ',"IL                  $   #00006602' TO DFHEIV0
  6908     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6909     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6910     MOVE X'2020233030303036363032' TO DFHEIV0(25:11)
  6911     CALL 'kxdfhei1' USING DFHEIV0,
  6912           DFHEIV20,
  6913           DFHEIV11,
  6914           GETMAIN-SPACE
  6915     SET ADDRESS OF CHECK-RECORDS TO
  6916         DFHEIV20
  6917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6918
  6919
  6920     MOVE 'CH'                   TO CH-RECORD-ID.
  6921     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6922     MOVE CARRIERI               TO CH-CARRIER.
  6923     MOVE GROUPI                 TO CH-GROUPING.
  6924     MOVE STATEI                 TO CH-STATE.
  6925     MOVE ACCTI                  TO CH-ACCOUNT.
  6926
  6927     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6928     MOVE '2'                    TO DC-OPTION-CODE.
  6929     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6930     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6931
  6932     MOVE CERTNOI                TO CH-CERT-PRIME.
  6933     MOVE SFXI                   TO CH-CERT-SFX.
  6934
  6935     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6936
  6937     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6938                                    ch-released-by
  6939     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6940
  6941     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6942     MOVE '5'                    TO DC-OPTION-CODE.
  6943     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6944     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6945                                    ch-released-dt
  6946
  6947     move 'P'                    to ch-approval-status
  6948
  6949     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6950                                    CH-VOID-DT
  6951                                    CH-CREDIT-ACCEPT-DT
  6952                                    CH-CANC-DT
  6953                                    ch-approval-dt
  6954                                    ch-check-cashed-dt
  6955     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 124
* EL677.cbl
  6956                                    CH-AH-REFUND
  6957*                                   CH-DEDUCT-WITHHELD
  6958*                                   CH-ADDITIONAL-CHARGE.
  6959
  6960     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6961
  6962     if pi-prev-paid not numeric
  6963        move zeros               to pi-prev-paid
  6964     end-if
  6965     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6966       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6967        EIBAID NOT = DFHPF4)
  6968         GO TO 8200-SEND-DATAONLY.
  6969
  6970     add ch-amount-paid to pi-prev-paid
  6971     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6972     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6973     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6974     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6975     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6976     move pi-am-csr              to ch-csr
  6977     .
  6978 2100-WRITE-RECORD.
  6979
  6980* exec cics read
  6981*       dataset    (erchek-file-id)
  6982*       into       (ws-dummy-erchek)
  6983*       ridfld     (ch-control-primary)
  6984*       resp       (ws-response)
  6985*    end-exec
  6986     MOVE LENGTH OF
  6987      ws-dummy-erchek
  6988       TO DFHEIV11
  6989*    MOVE '&"IL       E          (  N#00006667' TO DFHEIV0
  6990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6992     MOVE X'204E233030303036363637' TO DFHEIV0(25:11)
  6993     CALL 'kxdfhei1' USING DFHEIV0,
  6994           erchek-file-id,
  6995           ws-dummy-erchek,
  6996           DFHEIV11,
  6997           ch-control-primary,
  6998           DFHEIV99,
  6999           DFHEIV99,
  7000           DFHEIV99
  7001     MOVE EIBRESP  TO ws-response
  7002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7003     if RESP-NOTFND
  7004        continue
  7005     else
  7006        add +1 to ch-sequence-no
  7007        add 1 to seqi
  7008        go to 2100-write-record
  7009     end-if
  7010     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  7011
  7012* EXEC CICS HANDLE CONDITION
  7013*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 125
* EL677.cbl
  7014*    END-EXEC.
  7015*    MOVE '"$%                   ! ( #00006681' TO DFHEIV0
  7016     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7018     MOVE X'2820233030303036363831' TO DFHEIV0(25:11)
  7019     CALL 'kxdfhei1' USING DFHEIV0
  7020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7021
  7022
  7023     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7024     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7025                                    CH-CHECK-QUE-SEQUENCE
  7026
  7027
  7028* EXEC CICS WRITE
  7029*        DATASET  (ERCHEK-FILE-ID)
  7030*        FROM     (CHECK-RECORDS)
  7031*        RIDFLD   (CH-CONTROL-PRIMARY)
  7032*        resp     (ws-response)
  7033*    END-EXEC.
  7034     MOVE LENGTH OF
  7035      CHECK-RECORDS
  7036       TO DFHEIV11
  7037*    MOVE '&$ L                  ''  N#00006689' TO DFHEIV0
  7038     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7040     MOVE X'204E233030303036363839' TO DFHEIV0(25:11)
  7041     CALL 'kxdfhei1' USING DFHEIV0,
  7042           ERCHEK-FILE-ID,
  7043           CHECK-RECORDS,
  7044           DFHEIV11,
  7045           CH-CONTROL-PRIMARY,
  7046           DFHEIV99,
  7047           DFHEIV99
  7048     MOVE EIBRESP  TO ws-response
  7049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7050
  7051     if resp-normal and pi-check-type = 'C'
  7052        move 'Y'                 to pi-check-cut
  7053     end-if
  7054     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7055             ERCHEK-RECORD-LENGTH + 23.
  7056
  7057     if pi-check-type not = 'C'
  7058        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7059                                 THRU 6200-EXIT
  7060        if resp-normal
  7061           MOVE 'Y'              TO PB-C-REFUND-SW
  7062           add +1 to pi-chek-rec-cnt
  7063           perform 6210-rewrite-pndb
  7064                                 thru 6210-exit
  7065*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7066        end-if
  7067     end-if
  7068*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  7069
  7070     IF EMI-NO-ERRORS
  7071         MOVE ER-0000            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 126
* EL677.cbl
  7072     ELSE
  7073         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7074            EIBAID = DFHPF4
  7075             MOVE ER-2600        TO EMI-ERROR.
  7076
  7077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7078
  7079     MOVE LOW-VALUES             TO EL677AI.
  7080
  7081     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7082     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7083     MOVE PI-CHEK-STATE          TO STATEO.
  7084     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7085
  7086     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7087     MOVE SPACE                  TO DC-OPTION-CODE.
  7088     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7089     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7090
  7091     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7092     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7093     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7094
  7095     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7096                                    ACCTA     EFFDTA  CERTNOA
  7097                                    SFXA.
  7098     MOVE AL-UNNON               TO SEQA.
  7099     go to 5000-browse-file
  7100     GO TO 8100-SEND-INITIAL-MAP.
  7101
  7102 2200-DUPREC.
  7103     ADD +1 TO CH-SEQUENCE-NO.
  7104     MOVE CH-SEQUENCE-NO         TO SEQO
  7105                                    PI-CHEK-SEQUENCE
  7106                                    CHEK-RECORD-SEQ.
  7107     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 127
* EL677.cbl
  7109
  7110 2500-WRITE-PAY-ADJ.
  7111
  7112     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7113
  7114     IF CH-AMOUNT-PAID = ZEROS
  7115         GO TO 2510-CONTINUE.
  7116     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7117     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7118
  7119 2510-CONTINUE.
  7120
  7121     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7122         GO TO 2580-HANDLE-ELCNTL-FILE.
  7123
  7124 2550-BUILD-ERPYAJ-RECORD.
  7125
  7126
  7127* EXEC CICS GETMAIN
  7128*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7129*        LENGTH  (200)
  7130*        INITIMG (GETMAIN-SPACE)
  7131*    END-EXEC.
  7132     MOVE 200
  7133       TO DFHEIV11
  7134*    MOVE ',"IL                  $   #00006770' TO DFHEIV0
  7135     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7136     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7137     MOVE X'2020233030303036373730' TO DFHEIV0(25:11)
  7138     CALL 'kxdfhei1' USING DFHEIV0,
  7139           DFHEIV20,
  7140           DFHEIV11,
  7141           GETMAIN-SPACE
  7142     SET ADDRESS OF PENDING-PAY-ADJ TO
  7143         DFHEIV20
  7144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7145
  7146
  7147     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7148     MOVE 'PY'                   TO PY-RECORD-ID.
  7149     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7150
  7151     MOVE CARRIERI               TO PY-CARRIER.
  7152     IF PI-ZERO-CARRIER  OR
  7153        PI-ZERO-CAR-GROUP
  7154         MOVE ZERO               TO PY-CARRIER.
  7155
  7156     MOVE GROUPI                 TO PY-GROUPING.
  7157     IF PI-ZERO-GROUPING  OR
  7158        PI-ZERO-CAR-GROUP
  7159         MOVE ZERO               TO PY-GROUPING.
  7160
  7161     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7162     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7163     MOVE 'C'                    TO PY-RECORD-TYPE.
  7164     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7165
  7166     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 128
* EL677.cbl
  7167                                    WS-PY-REF-DATE
  7168                                    WS-PY-END-DATE
  7169                                    WS-PY-DED-DATE
  7170                                    WS-PY-ADDL-DATE.
  7171     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7172     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7173                                    WS-PY-REF-CERT
  7174                                    WS-PY-END-CERT
  7175                                    WS-PY-DED-CERT
  7176                                    WS-PY-ADDL-CERT
  7177                                    WS-TMS-PY-CERT.
  7178     IF SFXI NOT = LOW-VALUES
  7179         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7180                                    WS-PY-REF-SUFFIX
  7181                                    WS-PY-END-SUFFIX
  7182                                    WS-PY-DED-SUFFIX
  7183                                    WS-PY-ADDL-SUFFIX
  7184     ELSE
  7185         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7186                                    WS-PY-REF-SUFFIX
  7187                                    WS-PY-END-SUFFIX
  7188                                    WS-PY-DED-SUFFIX
  7189                                    WS-PY-ADDL-SUFFIX.
  7190
  7191     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7192         MOVE WS-TMS-ENTRY-COMMENT
  7193                                 TO PY-ENTRY-COMMENT
  7194     ELSE
  7195         IF TYPEI EQUAL 'R'
  7196             MOVE WS-PY-REF-COMMENT
  7197                                 TO PY-ENTRY-COMMENT
  7198         ELSE
  7199             IF TYPEI EQUAL 'E'
  7200                 MOVE WS-PY-END-COMMENT
  7201                                 TO PY-ENTRY-COMMENT
  7202             ELSE
  7203                 MOVE WS-PY-ENTRY-COMMENT
  7204                                 TO PY-ENTRY-COMMENT.
  7205
  7206     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7207
  7208     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7209     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7210     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7211                                    PY-INPUT-DT.
  7212*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7213*                                   PY-CHECK-QUE-SEQUENCE.
  7214     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7215                                    PY-REPORTED-DT
  7216                                    PY-CHECK-WRITTEN-DT
  7217                                    PY-BILLED-DATE
  7218                                    PY-AR-DATE
  7219                                    PY-GL-DATE.
  7220     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7221     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7222*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7223
  7224     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 129
* EL677.cbl
  7225         MOVE 'B'                TO PY-PYMT-TYPE
  7226         MOVE 'A'                TO PY-PMT-APPLIED.
  7227
  7228 2559-BUILD-EXIT.
  7229     EXIT.
  7230
  7231 2570-WRITE-ERPYAJ-RECORD.
  7232
  7233
  7234* EXEC CICS HANDLE CONDITION
  7235*        DUPREC (2577-DUPREC)
  7236*    END-EXEC.
  7237*    MOVE '"$%                   ! ) #00006862' TO DFHEIV0
  7238     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7240     MOVE X'2920233030303036383632' TO DFHEIV0(25:11)
  7241     CALL 'kxdfhei1' USING DFHEIV0
  7242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7243
  7244
  7245
  7246* EXEC CICS WRITE
  7247*        DATASET (ERPYAJ-FILE-ID)
  7248*        FROM    (PENDING-PAY-ADJ)
  7249*        RIDFLD  (PY-CONTROL-PRIMARY)
  7250*    END-EXEC.
  7251     MOVE LENGTH OF
  7252      PENDING-PAY-ADJ
  7253       TO DFHEIV11
  7254*    MOVE '&$ L                  ''   #00006866' TO DFHEIV0
  7255     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7257     MOVE X'2020233030303036383636' TO DFHEIV0(25:11)
  7258     CALL 'kxdfhei1' USING DFHEIV0,
  7259           ERPYAJ-FILE-ID,
  7260           PENDING-PAY-ADJ,
  7261           DFHEIV11,
  7262           PY-CONTROL-PRIMARY,
  7263           DFHEIV99,
  7264           DFHEIV99
  7265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7266
  7267
  7268     GO TO 2579-WRITE-EXIT.
  7269
  7270 2577-DUPREC.
  7271     ADD +1 TO PY-FILE-SEQ-NO.
  7272
  7273     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7274
  7275 2579-WRITE-EXIT.
  7276     EXIT.
  7277
  7278 2580-HANDLE-ELCNTL-FILE.
  7279
  7280     IF CR-CHECK-NO-AUTO-SEQ
  7281         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7282     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 130
* EL677.cbl
  7283
  7284* EXEC CICS UNLOCK
  7285*            DATASET (ELCNTL-FILE-ID)
  7286*        END-EXEC.
  7287*    MOVE '&*                    #   #00006887' TO DFHEIV0
  7288     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7290     MOVE X'2020233030303036383837' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0,
  7292           ELCNTL-FILE-ID,
  7293           DFHEIV99
  7294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7295
  7296
  7297 2590-EXIT.
  7298      EXIT.
  7299
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 131
* EL677.cbl
  7301
  7302 2600-READ-CONTROL-FILE.
  7303     MOVE SPACES                 TO ELCNTL-KEY.
  7304     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7305     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7306     MOVE +0                     TO ELCNTL-SEQ.
  7307
  7308
  7309* EXEC CICS HANDLE CONDITION
  7310*        NOTFND   (2600-NO-CO-MASTER)
  7311*    END-EXEC.
  7312*    MOVE '"$I                   ! * #00006902' TO DFHEIV0
  7313     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7315     MOVE X'2A20233030303036393032' TO DFHEIV0(25:11)
  7316     CALL 'kxdfhei1' USING DFHEIV0
  7317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7318
  7319
  7320
  7321* EXEC CICS READ
  7322*        DATASET   (ELCNTL-FILE-ID)
  7323*        SET       (ADDRESS OF CONTROL-FILE)
  7324*        RIDFLD    (ELCNTL-KEY)
  7325*    END-EXEC.
  7326*    MOVE '&"S        E          (   #00006906' TO DFHEIV0
  7327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7329     MOVE X'2020233030303036393036' TO DFHEIV0(25:11)
  7330     CALL 'kxdfhei1' USING DFHEIV0,
  7331           ELCNTL-FILE-ID,
  7332           DFHEIV20,
  7333           DFHEIV99,
  7334           ELCNTL-KEY,
  7335           DFHEIV99,
  7336           DFHEIV99,
  7337           DFHEIV99
  7338     SET ADDRESS OF CONTROL-FILE TO
  7339         DFHEIV20
  7340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7341
  7342
  7343     GO TO 2600-EXIT
  7344
  7345     .
  7346 2600-NO-CO-MASTER.
  7347     MOVE ER-0022                TO  EMI-ERROR.
  7348     MOVE -1                     TO  CARRIERL.
  7349     MOVE AL-UABON               TO  CARRIERA.
  7350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7351
  7352 2600-EXIT.
  7353      EXIT.
  7354
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 132
* EL677.cbl
  7356 2650-REWRITE-CONTROL-FILE.
  7357
  7358* EXEC CICS READ
  7359*        DATASET   (ELCNTL-FILE-ID)
  7360*        SET       (ADDRESS OF CONTROL-FILE)
  7361*        RIDFLD    (ELCNTL-KEY)
  7362*        UPDATE
  7363*    END-EXEC.
  7364*    MOVE '&"S        EU         (   #00006926' TO DFHEIV0
  7365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7367     MOVE X'2020233030303036393236' TO DFHEIV0(25:11)
  7368     CALL 'kxdfhei1' USING DFHEIV0,
  7369           ELCNTL-FILE-ID,
  7370           DFHEIV20,
  7371           DFHEIV99,
  7372           ELCNTL-KEY,
  7373           DFHEIV99,
  7374           DFHEIV99,
  7375           DFHEIV99
  7376     SET ADDRESS OF CONTROL-FILE TO
  7377         DFHEIV20
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7379
  7380
  7381
  7382* EXEC CICS REWRITE
  7383*         DATASET (ELCNTL-FILE-ID)
  7384*         FROM    (CONTROL-FILE)
  7385*     END-EXEC.
  7386     MOVE LENGTH OF
  7387      CONTROL-FILE
  7388       TO DFHEIV11
  7389*    MOVE '&& L                  %   #00006933' TO DFHEIV0
  7390     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7391     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7392     MOVE X'2020233030303036393333' TO DFHEIV0(25:11)
  7393     CALL 'kxdfhei1' USING DFHEIV0,
  7394           ELCNTL-FILE-ID,
  7395           CONTROL-FILE,
  7396           DFHEIV11,
  7397           DFHEIV99
  7398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7399
  7400
  7401 2650-EXIT.
  7402      EXIT.
  7403 2700-WRITE-SQL.
  7404     perform 2710-build-rec      thru 2710-exit
  7405     perform 2720-insert-row     thru 2720-exit
  7406     perform 4300-FINISH-UP-DB   thru 4300-exit
  7407     .
  7408 2700-EXIT.
  7409     EXIT.
  7410 2710-BUILD-REC.
  7411     move spaces                 to daily-check-request-rec
  7412     move pi-company-id          to db-compid
  7413     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 133
* EL677.cbl
  7414                                    db-fincar
  7415     move ch-grouping            to db-grouping
  7416                                    db-fingrp
  7417     move ch-state               to db-state
  7418     move ch-account             to db-account
  7419     move ch-cert-eff-dt         to dc-bin-date-1
  7420     move ' '                    to dc-option-code
  7421     perform 8500-date-convert   thru 8500-exit
  7422     if no-conversion-error
  7423        move dc-greg-date-a-edit to db-effdate
  7424     else
  7425        move spaces              to db-effdate
  7426     end-if
  7427     move ch-cert-prime          to db-certificate
  7428     move ch-cert-sfx            to db-cert-sfx
  7429     move ch-sequence-no         to db-seq-no
  7430     move '1'                    to db-type
  7431                                    db-check-sub-type
  7432     if pi-check-type = 'C'
  7433        move '2'                 to db-check-sub-type
  7434     end-if
  7435     move ch-amount-paid         to db-amount-n
  7436     move zeros                  to db-checkstatus
  7437     move ch-check-que-control   to db-releasebatch
  7438     move save-bin-date          to dc-bin-date-1
  7439     move ' '                    to dc-option-code
  7440     perform 8500-date-convert   thru 8500-exit
  7441     if no-conversion-error
  7442        move dc-greg-date-a-edit to db-releasedt
  7443     else
  7444        move spaces              to db-releasedt
  7445     end-if
  7446     move pi-processor-id        to db-releaseby
  7447     move ch-payee-name-1        to db-payeename1
  7448     move ch-payee-name-2        to db-payeename2
  7449     move ch-payee-address-1     to db-payeeaddr1
  7450     move ch-payee-address-2     to db-payeeaddr2
  7451     move ch-payee-city          to db-payeecity
  7452     move ch-payee-state         to db-payeest
  7453     move ch-payee-zip-code      to db-payeezip
  7454     move ch-comp-fin-resp       to db-finresp
  7455     move ch-comp-account        to db-finacct
  7456     move ch-recorded-by         to db-preparer
  7457     move ch-return-to           to db-return-to
  7458     move pi-table-name          to db-insured-name
  7459     .
  7460 2710-EXIT.
  7461     EXIT.
  7462 2720-INSERT-ROW.
  7463     if not connected-to-db
  7464        perform 4100-CONNECT-TO-DB
  7465                                 thru 4100-exit
  7466     end-if
  7467     EXEC SQL
  7468        INSERT into ChkApp_Check (
  7469           Company,
  7470           CertCarrier,
  7471           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 134
* EL677.cbl
  7472           CertState,
  7473           CertAccount,
  7474           CertEffDate,
  7475           CertNumber,
  7476           CertNumberSuf,
  7477           CheckSeqNbr,
  7478           CheckType,
  7479           CheckAmount,
  7480           ReleaseBatchNbr,
  7481           ReleaseDate,
  7482           ReleasedBy,
  7483           PayeeName1,
  7484           PayeeName2,
  7485           PayeeAddress1,
  7486           PayeeAddress2,
  7487           PayeeCity,
  7488           PayeeState,
  7489           PayeeZip,
  7490           CompCarrier,
  7491           CompGroup,
  7492           CompFinResp,
  7493           CompAccount,
  7494           Preparer,
  7495           ReturnTo,
  7496           InsuredName,
  7497           CheckSubType)
  7498         VALUES (
  7499           :DB-CompId,
  7500           :DB-Carrier,
  7501           :DB-Grouping,
  7502           :DB-State,
  7503           :DB-Account,
  7504           :DB-EffDate,
  7505           :DB-Certificate,
  7506           :db-cert-sfx,
  7507           :DB-Seq-No,
  7508           :DB-Type,
  7509           :db-amount,
  7510           :db-releasebatch,
  7511           :db-releasedt,
  7512           :db-releaseby,
  7513           :db-payeename1,
  7514           :db-payeename2,
  7515           :db-payeeaddr1,
  7516           :db-payeeaddr2,
  7517           :db-payeecity,
  7518           :db-payeest,
  7519           :db-payeezip,
  7520           :db-fincar,
  7521           :db-fingrp,
  7522           :db-finresp,
  7523           :db-finacct,
  7524           :db-preparer,
  7525           :db-return-to,
  7526           :db-insured-name,
  7527           :db-check-sub-type)
  7528     END-EXEC
  7529     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 135
* EL677.cbl
  7530        add +1                   to ch-sequence-no
  7531        move ch-sequence-no      to DB-Seq-No
  7532        go to 2720-insert-row
  7533     end-if
  7534     if sqlcode not = 0
  7535        display "Error: cannot insert row "
  7536        display ' sql return code ' sqlcode
  7537        move sqlcode to ws-sql-code
  7538        move ws-sql-code to ws-dis-sql-code
  7539        display ' dis sql code ' ws-dis-sql-code
  7540        display ' sql err mess    ' sqlerrmc
  7541        move sqlcode to ws-sql-code
  7542        move ws-sql-code to ws-dis-sql-code
  7543        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7544           into EMI-MESSAGE-AREA (1)
  7545        end-string
  7546        display ' msga1 ' emi-message-area (1)
  7547        perform 4300-FINISH-UP-DB thru 4300-exit
  7548        go to 8200-send-dataonly
  7549*       goback
  7550     end-if
  7551     .
  7552 2720-EXIT.
  7553     EXIT.
  7554 3000-CHANGE-RECORD.
  7555
  7556* EXEC CICS HANDLE CONDITION
  7557*        NOTFND (3900-RECORD-NOTFND)
  7558*    END-EXEC.
  7559*    MOVE '"$I                   ! + #00007092' TO DFHEIV0
  7560     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7562     MOVE X'2B20233030303037303932' TO DFHEIV0(25:11)
  7563     CALL 'kxdfhei1' USING DFHEIV0
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567
  7568* EXEC CICS READ
  7569*        DATASET  (ERCHEK-FILE-ID)
  7570*        SET      (ADDRESS OF CHECK-RECORDS)
  7571*        RIDFLD   (PI-ERCHEK-KEY)
  7572*        UPDATE
  7573*    END-EXEC.
  7574*    MOVE '&"S        EU         (   #00007096' TO DFHEIV0
  7575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7576     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7577     MOVE X'2020233030303037303936' TO DFHEIV0(25:11)
  7578     CALL 'kxdfhei1' USING DFHEIV0,
  7579           ERCHEK-FILE-ID,
  7580           DFHEIV20,
  7581           DFHEIV99,
  7582           PI-ERCHEK-KEY,
  7583           DFHEIV99,
  7584           DFHEIV99,
  7585           DFHEIV99
  7586     SET ADDRESS OF CHECK-RECORDS TO
  7587         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 136
* EL677.cbl
  7588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7589
  7590
  7591     IF CH-LF-REFUND NOT NUMERIC
  7592         MOVE ZEROS              TO CH-LF-REFUND.
  7593     IF CH-AH-REFUND NOT NUMERIC
  7594         MOVE ZEROS              TO CH-AH-REFUND.
  7595*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7596*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7597*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7598*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7599
  7600     IF VREASONL NOT = ZEROS
  7601         MOVE VREASONI           TO  CH-VOID-REASON.
  7602
  7603     IF MAINTI = 'V'
  7604        GO TO 3050-void-processing
  7605     end-if
  7606
  7607     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7608
  7609     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7610
  7611     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7612       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7613        EIBAID NOT = DFHPF4)
  7614         GO TO 8200-SEND-DATAONLY.
  7615     go to 3100-rewrite-record
  7616     .
  7617 3050-void-processing.
  7618     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7619     if sqlcode = 0
  7620        perform 4200-get-tbl-row thru 4200-exit
  7621        if sqlcode = 0
  7622           if nu-app-date = -1
  7623              move -1            to maintl
  7624              move er-3453       to emi-error
  7625              move al-uabon      to mainta
  7626              perform 9900-error-format
  7627                                 thru 9900-exit
  7628              perform 4300-FINISH-UP-DB thru 4300-exit
  7629              go to 8200-send-dataonly
  7630           end-if
  7631        end-if
  7632        if connected-to-db
  7633           perform 4300-FINISH-UP-DB thru 4300-exit
  7634        end-if
  7635     end-if
  7636     if (ch-check-written-dt = low-values)
  7637        or (ch-check-no = spaces)
  7638        move -1                  to maintl
  7639        move er-3455             to emi-error
  7640        move al-uabon            to mainta
  7641        perform 9900-error-format
  7642                                 thru 9900-exit
  7643        perform 4300-FINISH-UP-DB thru 4300-exit
  7644        go to 8200-send-dataonly
  7645     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 137
* EL677.cbl
  7646     .
  7647 3100-REWRITE-RECORD.
  7648     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7649
  7650     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7651     MOVE '5'                    TO DC-OPTION-CODE.
  7652     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7653
  7654     IF MAINTI = 'C'
  7655       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7656     end-if
  7657*      IF MANUAL-CHECK-WRITTEN
  7658*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7659
  7660     IF MAINTI = 'V'
  7661        IF (CH-VOID-DT = LOW-VALUES)
  7662           and (pi-check-cashed = spaces)
  7663           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7664           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7665*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7666           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7667           if pi-chek-rec-cnt = +1
  7668              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7669                                 THRU 6200-EXIT
  7670              if resp-normal
  7671                 MOVE ' '        TO PB-C-REFUND-SW
  7672                 perform 6210-rewrite-pndb
  7673                                 thru 6210-exit
  7674              end-if
  7675           end-if
  7676        ELSE
  7677           MOVE -1               TO MAINTL
  7678           MOVE ER-2583          TO EMI-ERROR
  7679           MOVE AL-UABON         TO MAINTA
  7680           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7681           GO TO 8200-SEND-DATAONLY
  7682        end-if
  7683     end-if
  7684
  7685     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7686
  7687
  7688* EXEC CICS REWRITE
  7689*        DATASET  (ERCHEK-FILE-ID)
  7690*        FROM     (CHECK-RECORDS)
  7691*    END-EXEC.
  7692     MOVE LENGTH OF
  7693      CHECK-RECORDS
  7694       TO DFHEIV11
  7695*    MOVE '&& L                  %   #00007199' TO DFHEIV0
  7696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7698     MOVE X'2020233030303037313939' TO DFHEIV0(25:11)
  7699     CALL 'kxdfhei1' USING DFHEIV0,
  7700           ERCHEK-FILE-ID,
  7701           CHECK-RECORDS,
  7702           DFHEIV11,
  7703           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 138
* EL677.cbl
  7704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7705
  7706
  7707     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7708        (MAINTI EQUAL 'C')          AND
  7709        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7710            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7711
  7712     IF EMI-NO-ERRORS
  7713         MOVE ER-0000            TO EMI-ERROR
  7714     ELSE
  7715         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7716            EIBAID = DFHPF4
  7717             MOVE ER-2600        TO EMI-ERROR.
  7718
  7719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7720
  7721     MOVE LOW-VALUES             TO EL677AI.
  7722
  7723     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7724     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7725     MOVE PI-CHEK-STATE          TO STATEO.
  7726     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7727
  7728     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7729     MOVE SPACE                  TO DC-OPTION-CODE.
  7730     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7731     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7732
  7733     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7734     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7735     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7736
  7737     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7738                                     ACCTA   EFFDTA
  7739                                    CERTNOA   SFXA.
  7740
  7741     MOVE AL-UNNON               TO SEQA.
  7742     go to 5000-browse-file
  7743*    GO TO 8100-SEND-INITIAL-MAP.
  7744
  7745     .
  7746 3200-PAY-ADJS-REVERSAL.
  7747
  7748     IF CH-AMOUNT-PAID NOT = ZEROS
  7749         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7750         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7751
  7752     GO TO 3290-EXIT
  7753     .
  7754 3250-BUILD-ERPYAJ-REVERSAL.
  7755
  7756
  7757* EXEC CICS GETMAIN
  7758*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7759*        LENGTH  (200)
  7760*        INITIMG (GETMAIN-SPACE)
  7761*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 139
* EL677.cbl
  7762     MOVE 200
  7763       TO DFHEIV11
  7764*    MOVE ',"IL                  $   #00007253' TO DFHEIV0
  7765     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7767     MOVE X'2020233030303037323533' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0,
  7769           DFHEIV20,
  7770           DFHEIV11,
  7771           GETMAIN-SPACE
  7772     SET ADDRESS OF PENDING-PAY-ADJ TO
  7773         DFHEIV20
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7775
  7776
  7777     MOVE 'PY'                   TO PY-RECORD-ID.
  7778     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7779
  7780     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7781     IF PI-ZERO-CARRIER  OR
  7782        PI-ZERO-CAR-GROUP
  7783         MOVE ZERO               TO PY-CARRIER.
  7784
  7785     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7786     IF PI-ZERO-GROUPING  OR
  7787        PI-ZERO-CAR-GROUP
  7788         MOVE ZERO               TO PY-GROUPING.
  7789
  7790     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7791     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7792     MOVE 'R'                    TO PY-RECORD-TYPE.
  7793     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7794     move '1825011300'           to py-gl-account
  7795     move 'VOID REFCK'           TO py-gl-comment
  7796     move ch-amount-paid         to py-entry-amt
  7797*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7798
  7799     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7800     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7801
  7802     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7803     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7804     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7805                                    PY-INPUT-DT.
  7806*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7807*                                   PY-CHECK-QUE-SEQUENCE.
  7808     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7809                                    PY-BILLED-DATE
  7810                                    PY-REPORTED-DT
  7811                                    PY-CHECK-WRITTEN-DT
  7812                                    PY-AR-DATE
  7813                                    PY-GL-DATE.
  7814     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7815     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7816*    MOVE 'V'                    TO PY-VOID-SW.
  7817*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7818
  7819     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 140
* EL677.cbl
  7820         MOVE 'B'                TO PY-PYMT-TYPE
  7821         MOVE 'A'                TO PY-PMT-APPLIED.
  7822
  7823 3259-BUILD-EXIT.
  7824     EXIT.
  7825
  7826 3280-WRITE-ERPYAJ-REVERSAL.
  7827
  7828
  7829* EXEC CICS HANDLE CONDITION
  7830*        DUPREC (3287-DUPREC)
  7831*    END-EXEC.
  7832*    MOVE '"$%                   ! , #00007310' TO DFHEIV0
  7833     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7835     MOVE X'2C20233030303037333130' TO DFHEIV0(25:11)
  7836     CALL 'kxdfhei1' USING DFHEIV0
  7837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7838
  7839
  7840
  7841* EXEC CICS WRITE
  7842*        DATASET (ERPYAJ-FILE-ID)
  7843*        FROM    (PENDING-PAY-ADJ)
  7844*        RIDFLD  (PY-CONTROL-PRIMARY)
  7845*    END-EXEC.
  7846     MOVE LENGTH OF
  7847      PENDING-PAY-ADJ
  7848       TO DFHEIV11
  7849*    MOVE '&$ L                  ''   #00007314' TO DFHEIV0
  7850     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7852     MOVE X'2020233030303037333134' TO DFHEIV0(25:11)
  7853     CALL 'kxdfhei1' USING DFHEIV0,
  7854           ERPYAJ-FILE-ID,
  7855           PENDING-PAY-ADJ,
  7856           DFHEIV11,
  7857           PY-CONTROL-PRIMARY,
  7858           DFHEIV99,
  7859           DFHEIV99
  7860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7861
  7862
  7863     GO TO 3289-WRITE-EXIT.
  7864
  7865 3287-DUPREC.
  7866     ADD +1 TO PY-FILE-SEQ-NO.
  7867
  7868     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7869
  7870 3289-WRITE-EXIT.
  7871     EXIT.
  7872
  7873 3290-EXIT.
  7874      EXIT.
  7875
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 141
* EL677.cbl
  7877 3300-UPDATE-ERPYAJ.
  7878
  7879
  7880* EXEC CICS GETMAIN
  7881*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7882*        LENGTH  (200)
  7883*        INITIMG (GETMAIN-SPACE)
  7884*    END-EXEC.
  7885     MOVE 200
  7886       TO DFHEIV11
  7887*    MOVE ',"IL                  $   #00007336' TO DFHEIV0
  7888     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7890     MOVE X'2020233030303037333336' TO DFHEIV0(25:11)
  7891     CALL 'kxdfhei1' USING DFHEIV0,
  7892           DFHEIV20,
  7893           DFHEIV11,
  7894           GETMAIN-SPACE
  7895     SET ADDRESS OF PENDING-PAY-ADJ TO
  7896         DFHEIV20
  7897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7898
  7899
  7900     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7901     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7902     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7903     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7904     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7905     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7906     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7907
  7908
  7909* EXEC CICS HANDLE CONDITION
  7910*        NOTFND   (3390-EXIT)
  7911*        ENDFILE  (3390-EXIT)
  7912*    END-EXEC.
  7913*    MOVE '"$I''                  ! - #00007350' TO DFHEIV0
  7914     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7916     MOVE X'2D20233030303037333530' TO DFHEIV0(25:11)
  7917     CALL 'kxdfhei1' USING DFHEIV0
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921 3320-READNEXT-ERPYAJ.
  7922
  7923
  7924* EXEC CICS READ
  7925*        DATASET  (ERPYAJ-FILE-ID)
  7926*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7927*        RIDFLD   (ERPYAJ-KEY)
  7928*        GTEQ
  7929*    END-EXEC.
  7930*    MOVE '&"S        G          (   #00007357' TO DFHEIV0
  7931     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7933     MOVE X'2020233030303037333537' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 142
* EL677.cbl
  7935           ERPYAJ-FILE-ID,
  7936           DFHEIV20,
  7937           DFHEIV99,
  7938           ERPYAJ-KEY,
  7939           DFHEIV99,
  7940           DFHEIV99,
  7941           DFHEIV99
  7942     SET ADDRESS OF PENDING-PAY-ADJ TO
  7943         DFHEIV20
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7945
  7946
  7947     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7948
  7949     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7950        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7951        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7952        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7953        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7954        (PY-RECORD-TYPE   NOT = 'C')
  7955          GO TO 3390-EXIT.
  7956
  7957     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7958         ADD +1 TO PYAJ-FILE-SEQ-NO
  7959         GO TO 3320-READNEXT-ERPYAJ.
  7960
  7961
  7962* EXEC CICS READ UPDATE
  7963*        DATASET   (ERPYAJ-FILE-ID)
  7964*        RIDFLD    (ERPYAJ-KEY)
  7965*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7966*    END-EXEC.
  7967*    MOVE '&"S        EU         (   #00007378' TO DFHEIV0
  7968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7969     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7970     MOVE X'2020233030303037333738' TO DFHEIV0(25:11)
  7971     CALL 'kxdfhei1' USING DFHEIV0,
  7972           ERPYAJ-FILE-ID,
  7973           DFHEIV20,
  7974           DFHEIV99,
  7975           ERPYAJ-KEY,
  7976           DFHEIV99,
  7977           DFHEIV99,
  7978           DFHEIV99
  7979     SET ADDRESS OF PENDING-PAY-ADJ TO
  7980         DFHEIV20
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7982
  7983
  7984     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7985     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7986
  7987     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7988
  7989     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7990     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7991     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7992
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 143
* EL677.cbl
  7993
  7994* EXEC CICS REWRITE
  7995*        DATASET  (ERPYAJ-FILE-ID)
  7996*        FROM     (PENDING-PAY-ADJ)
  7997*    END-EXEC.
  7998     MOVE LENGTH OF
  7999      PENDING-PAY-ADJ
  8000       TO DFHEIV11
  8001*    MOVE '&& L                  %   #00007393' TO DFHEIV0
  8002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8004     MOVE X'2020233030303037333933' TO DFHEIV0(25:11)
  8005     CALL 'kxdfhei1' USING DFHEIV0,
  8006           ERPYAJ-FILE-ID,
  8007           PENDING-PAY-ADJ,
  8008           DFHEIV11,
  8009           DFHEIV99
  8010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8011
  8012
  8013 3390-EXIT.
  8014      EXIT.
  8015
  8016 3400-delete-record.
  8017
  8018* EXEC CICS READ
  8019*        DATASET  (ERCHEK-FILE-ID)
  8020*        SET      (ADDRESS OF CHECK-RECORDS)
  8021*        RIDFLD   (PI-ERCHEK-KEY)
  8022*        UPDATE
  8023*        resp     (ws-response)
  8024*    END-EXEC
  8025*    MOVE '&"S        EU         (  N#00007402' TO DFHEIV0
  8026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8028     MOVE X'204E233030303037343032' TO DFHEIV0(25:11)
  8029     CALL 'kxdfhei1' USING DFHEIV0,
  8030           ERCHEK-FILE-ID,
  8031           DFHEIV20,
  8032           DFHEIV99,
  8033           PI-ERCHEK-KEY,
  8034           DFHEIV99,
  8035           DFHEIV99,
  8036           DFHEIV99
  8037     SET ADDRESS OF CHECK-RECORDS TO
  8038         DFHEIV20
  8039     MOVE EIBRESP  TO ws-response
  8040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8041     if (ch-in-limbo or ch-approv-pending)
  8042        and (ch-void-dt = low-values)
  8043        and (ch-check-written-dt = low-values)
  8044        and (ch-credit-accept-dt = low-values)
  8045        perform 3500-check-tbl   thru 3500-exit
  8046        if (row-deleted and tbl-commited)
  8047           or (emi-error = er-3450)
  8048
  8049* exec cics delete
  8050*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 144
* EL677.cbl
  8051*          end-exec
  8052*    MOVE '&(                    &   #00007416' TO DFHEIV0
  8053     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037343136' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           erchek-file-id,
  8058           DFHEIV99,
  8059           DFHEIV99,
  8060           DFHEIV99,
  8061           DFHEIV99
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8063        end-if
  8064     else
  8065        move -1               to maintl
  8066        move er-3452          to emi-error
  8067        move al-uabon         to mainta
  8068        perform 9900-error-format
  8069                                 thru 9900-exit
  8070        go to 8200-send-dataonly
  8071     end-if
  8072     if pi-chek-rec-cnt = +1
  8073        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8074                                 THRU 6200-EXIT
  8075        if resp-normal
  8076           MOVE ' '              TO PB-C-REFUND-SW
  8077           perform 6210-rewrite-pndb
  8078                                 thru 6210-exit
  8079        end-if
  8080     end-if
  8081     MOVE ER-0000            TO EMI-ERROR
  8082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083     MOVE LOW-VALUES             TO EL677AI.
  8084     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8085     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8086     MOVE PI-CHEK-STATE          TO STATEO.
  8087     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8088     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8089     MOVE SPACE                  TO DC-OPTION-CODE.
  8090     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8091     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8092     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8093     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8094     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8095     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8096                                    ACCTA   EFFDTA
  8097                                    CERTNOA   SFXA.
  8098     MOVE AL-UNNON               TO SEQA.
  8099     GO TO 8100-SEND-INITIAL-MAP
  8100     .
  8101 3400-exit.
  8102     exit.
  8103 3500-check-tbl.
  8104     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8105*    if sqlcode = 0
  8106*       perform 4150-open-cursor    thru 4150-exit
  8107*    end-if
  8108     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 145
* EL677.cbl
  8109        perform 4200-get-tbl-row thru 4200-exit
  8110     end-if
  8111      if sqlcode = 0
  8112         if (nu-app-date = -1)
  8113            or (db-app-status = '2')
  8114            perform 4250-delete-row thru 4250-exit
  8115         else
  8116           MOVE ER-3452            TO  EMI-ERROR
  8117           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8118           MOVE -1                 TO  PFENTERL
  8119           GO TO 8200-SEND-DATAONLY
  8120        end-if
  8121      else
  8122         MOVE ER-3450            TO  EMI-ERROR
  8123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8124         MOVE -1                 TO  PFENTERL
  8125*        GO TO 8200-SEND-DATAONLY
  8126      end-if
  8127     if connected-to-db
  8128        perform 4300-FINISH-UP-DB thru 4300-exit
  8129     end-if
  8130     .
  8131 3500-exit.
  8132     exit.
  8133 3700-UPDATE-ERCHKQ.
  8134*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8135*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8136*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8137*
  8138*    EXEC CICS HANDLE CONDITION
  8139*        NOTFND (3780-CHECK-NOTFND)
  8140*    END-EXEC.
  8141*
  8142*    EXEC CICS READ
  8143*        DATASET  (ERCHKQ-FILE-ID)
  8144*        SET      (ADDRESS OF CHECK-QUE)
  8145*        RIDFLD   (ERCHKQ-KEY)
  8146*        UPDATE
  8147*    END-EXEC.
  8148*
  8149*    IF MAINTI = 'C'
  8150*        IF MANUAL-CHECK-WRITTEN
  8151*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8152*            MOVE +1                  TO CQ-TIMES-PRINTED
  8153*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8154*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8155*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8156*
  8157*    IF MAINTI = 'V'
  8158*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8159*                                   CQ-VOID-INDICATOR
  8160*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8161*
  8162*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8163*
  8164*    EXEC CICS REWRITE
  8165*        DATASET  (ERCHKQ-FILE-ID)
  8166*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 146
* EL677.cbl
  8167*    END-EXEC.
  8168*
  8169*    GO TO 3790-EXIT.
  8170*
  8171*3780-CHECK-NOTFND.
  8172*    MOVE ER-2905                TO EMI-ERROR.
  8173*    MOVE -1                     TO CARRIERL
  8174*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8175*                                   ACCTA     EFFDTA  CERTNOA
  8176*                                   SFXA      SEQA.
  8177*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8178     .
  8179 3790-EXIT.
  8180      EXIT.
  8181
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 147
* EL677.cbl
  8183
  8184 3900-RECORD-NOTFND.
  8185     MOVE ER-2908                TO EMI-ERROR.
  8186     MOVE -1                     TO CARRIERL
  8187     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8188                                    ACCTA     EFFDTA  CERTNOA
  8189                                    SFXA      SEQA.
  8190     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8191     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 148
* EL677.cbl
  8193 4000-ADD-CHANGE.
  8194     IF PAYTO1L NOT = ZEROS
  8195        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8196     END-IF
  8197
  8198     IF PAYTO2L NOT = ZEROS
  8199         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8200
  8201     IF PAYAD1L NOT = ZEROS
  8202         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8203
  8204     IF PAYAD2L NOT = ZEROS
  8205         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8206
  8207     IF PAYctyL NOT = ZEROS
  8208         MOVE payctyi            TO CH-PAYEE-CITY.
  8209
  8210     IF PAYstL NOT = ZEROS
  8211         MOVE paysti            TO CH-PAYEE-state.
  8212
  8213     IF PAYEEI GREATER SPACES
  8214        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8215
  8216     IF PTOZIPL  =  ZEROS
  8217         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8218         GO TO 4000-CK-REST.
  8219
  8220     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8221
  8222     IF NOT WS-CANADIAN-POST-CODE
  8223         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8224         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8225         GO TO 4000-CK-REST.
  8226
  8227     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8228     IF WS-CAN-POST-4TH = SPACE OR '-'
  8229         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8230         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8231     ELSE
  8232         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8233         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8234
  8235 4000-CK-REST.
  8236
  8237     IF RETTOL NOT = ZEROS
  8238        MOVE RETTOI TO CH-RETURN-TO.
  8239     if dedcynl not = zeros
  8240        move dedcyni             to ch-deduct-commission
  8241     end-if
  8242     if dedcynl not = zeros
  8243        if (dedcyni = 'Y')
  8244           or (pi-prev-ded-comm = 'Y')
  8245           compute ws-amt =
  8246              pi-refund-on-pending-rec -
  8247                 pi-prev-paid - pi-ue-comm
  8248        else
  8249           if dedcyni = 'N'
  8250              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 149
* EL677.cbl
  8251                 pi-refund-on-pending-rec -
  8252                    pi-prev-paid
  8253           end-if
  8254        end-if
  8255     end-if
  8256     if pi-check-type = 'C'
  8257        compute ws-amt =
  8258           pi-endt-prm-diff - pi-prev-paid
  8259        if (dedcyni = 'Y')
  8260           or (pi-prev-ded-comm = 'Y')
  8261           compute ws-amt =
  8262              ws-amt - pi-ue-comm
  8263        end-if
  8264        if ws-amt <= zeros
  8265           move pi-endt-prm-diff to ws-amt
  8266        end-if
  8267     end-if
  8268     IF AMOUNTL NOT = ZEROS
  8269         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8270         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8271
  8272     IF CHECKL NOT = ZEROS
  8273         MOVE CHECKI             TO CH-CHECK-NO.
  8274
  8275     IF REASONL NOT = ZEROS
  8276         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8277
  8278*    IF DEDAMTL NOT = ZEROS
  8279*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8280*                                   DEDAMTO.
  8281
  8282*    IF ADDLCHGL NOT = ZEROS
  8283*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8284*                                   ADDLCHGO.
  8285
  8286     IF STUBL NOT = ZEROS
  8287         MOVE STUBI              TO CH-STUB-LINE-1.
  8288
  8289     IF TEXT1L NOT = ZEROS
  8290         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8291
  8292     IF TEXT2L NOT = ZEROS
  8293         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8294
  8295     IF TEXT3L NOT = ZEROS
  8296         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8297
  8298     IF TYPEL NOT = ZEROS
  8299         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8300
  8301*    MOVE LETTER1I               TO CH-LETTERS (1).
  8302*    MOVE LETTER2I               TO CH-LETTERS (2).
  8303*    MOVE LETTER3I               TO CH-LETTERS (3).
  8304
  8305*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8306     IF CH-CHECK-ORIGIN-SW = 'R'
  8307         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8308*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 150
* EL677.cbl
  8309         MOVE PI-CANC-DT             TO CH-CANC-DT
  8310         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8311         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8312     end-if
  8313     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8314*    IF PI-AR-PROCESSING AND
  8315*       REFL NOT = ZERO
  8316*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8317
  8318 4000-EXIT.
  8319      EXIT.
  8320 4100-CONNECT-TO-DB.
  8321     move 'NTSQLTST2_Logic'      to svr
  8322     move 'sa'                   to usr
  8323     move 'sql2008r2'            to pass
  8324
  8325     if ws-kix-myenv = 'cid1p'
  8326        move 'NTCSO2_ChkApprv'   to svr
  8327        move 'sa'                to usr
  8328        move 'ntcso2'            to pass
  8329     end-if
  8330     string
  8331         usr delimited space
  8332         "." delimited size
  8333         pass delimited space into usr-pass
  8334     end-string
  8335     EXEC SQL
  8336        CONNECT TO :svr USER :usr-pass
  8337     END-EXEC
  8338     if sqlcode not = 0
  8339        display "Error: cannot connect "
  8340        display sqlcode
  8341        display sqlerrmc
  8342     end-if
  8343     set connected-to-db to true
  8344     .
  8345 4100-EXIT.
  8346     EXIT.
  8347 4150-open-cursor.
  8348     move pi-company-id          to ws-compid
  8349     move ch-carrier             to ws-carrier
  8350     move ch-grouping            to ws-grouping
  8351     move ch-state               to ws-state
  8352     move ch-account             to ws-account
  8353     move ch-cert-eff-dt         to dc-bin-date-1
  8354     move ' '                    to dc-option-code
  8355     perform 8500-date-convert   thru 8500-exit
  8356     if no-conversion-error
  8357        move dc-greg-date-a-edit to ws-eff-date
  8358     end-if
  8359     move ch-cert-prime          to ws-certificate
  8360     move ch-cert-sfx            to ws-cert-sfx
  8361     move ch-sequence-no         to ws-seq-no
  8362     move '1'                    to ws-type
  8363                                    ws-check-sub-type
  8364     if pi-check-type = 'C'
  8365        move '2'                 to ws-check-sub-type
  8366     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 151
* EL677.cbl
  8367     EXEC SQL
  8368        DECLARE
  8369           checkapp cursor for
  8370        SELECT
  8371           ApprovalStatus,
  8372           MaintainedBy,
  8373           MaintainedDate,
  8374           ApprovalBatch
  8375        FROM
  8376           ChkApp_Check
  8377        WHERE
  8378           Company           = :ws-compid
  8379           and CertCarrier   = :ws-carrier
  8380           and CertGroup     = :ws-grouping
  8381           and CertState     = :ws-state
  8382           and CertAccount   = :ws-account
  8383           and CertEffDate   = :ws-eff-date
  8384           and CertNumber    = :ws-certificate
  8385           and CertNumberSuf = :ws-cert-sfx
  8386           and CheckSeqNbr   = :ws-seq-no
  8387           and CheckType     = :ws-type
  8388           and CheckSubType  = :ws-check-sub-type
  8389     END-EXEC
  8390     if sqlcode not = 0
  8391        display "Error: cannot declare cursor "
  8392        display ' sql retrun code ' sqlcode
  8393        display ' sql err mess    ' sqlerrmc
  8394        go to 4150-exit
  8395     end-if
  8396     EXEC SQL
  8397        open checkapp
  8398     END-EXEC
  8399     if sqlcode not = 0
  8400        display "Error: cannot open cursor "
  8401        display ' sql retrun code ' sqlcode
  8402        display ' sql err mess    ' sqlerrmc
  8403     end-if
  8404     .
  8405 4150-exit.
  8406     exit.
  8407 4200-get-tbl-row.
  8408***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8409***                                                            ***
  8410***  I'm only expecting one row so no cursor is declared       ***
  8411***                                                            ***
  8412***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8413     move pi-company-id          to ws-compid
  8414     move ch-carrier             to ws-carrier
  8415     move ch-grouping            to ws-grouping
  8416     move ch-state               to ws-state
  8417     move ch-account             to ws-account
  8418     move ch-cert-eff-dt         to dc-bin-date-1
  8419     move ' '                    to dc-option-code
  8420     perform 8500-date-convert   thru 8500-exit
  8421     if no-conversion-error
  8422        move dc-greg-date-a-edit to ws-eff-date
  8423     end-if
  8424     move ch-cert-prime          to ws-certificate
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 152
* EL677.cbl
  8425     move ch-cert-sfx            to ws-cert-sfx
  8426     move ch-sequence-no         to ws-seq-no
  8427     move '1'                    to ws-type
  8428                                    ws-check-sub-type
  8429     if pi-check-type = 'C'
  8430        move '2'                 to ws-check-sub-type
  8431     end-if
  8432     exec sql
  8433        SELECT
  8434           ApprovalStatus,
  8435           MaintainedBy,
  8436           MaintainedDate,
  8437           ApprovalBatch
  8438        INTO
  8439           :db-app-status :nu-app-status,
  8440           :db-app-by :nu-app-by,
  8441           :db-app-date :nu-app-date,
  8442           :db-app-batch :nu-app-batch
  8443        FROM
  8444           ChkApp_Check
  8445        WHERE
  8446           Company           = :ws-compid
  8447           and CertCarrier   = :ws-carrier
  8448           and CertGroup     = :ws-grouping
  8449           and CertState     = :ws-state
  8450           and CertAccount   = :ws-account
  8451           and CertEffDate   = :ws-eff-date
  8452           and CertNumber    = :ws-certificate
  8453           and CertNumberSuf = :ws-cert-sfx
  8454           and CheckSeqNbr   = :ws-seq-no
  8455           and CheckType     = :ws-type
  8456           and CheckSubType  = :ws-check-sub-type
  8457     end-exec
  8458     if sqlcode not = 0
  8459        display "Error: cannot read row "
  8460        display ' sql return code ' sqlcode
  8461        display ' sql err mess    ' sqlerrmc
  8462        go to 4200-exit
  8463     end-if
  8464*    display ' status ' db-app-status
  8465*    display ' by     ' db-app-by
  8466*    display ' date   ' db-app-date
  8467*    display ' batch  ' db-app-batch
  8468*    if nu-app-date = -1
  8469*       display ' approval date is low-values '
  8470*    else
  8471*       display ' approval date is NOT low values '
  8472*    end-if
  8473     .
  8474 4200-exit.
  8475     exit.
  8476 4250-delete-row.
  8477     EXEC SQL
  8478        DELETE
  8479           from ChkApp_Check
  8480        WHERE
  8481           Company           = :ws-compid
  8482           and CertCarrier   = :ws-carrier
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 153
* EL677.cbl
  8483           and CertGroup     = :ws-grouping
  8484           and CertState     = :ws-state
  8485           and CertAccount   = :ws-account
  8486           and CertEffDate   = :ws-eff-date
  8487           and CertNumber    = :ws-certificate
  8488           and CertNumberSuf = :ws-cert-sfx
  8489           and CheckSeqNbr   = :ws-seq-no
  8490           and CheckType     = :ws-type
  8491           and CheckSubType  = :ws-check-sub-type
  8492     END-EXEC
  8493     if sqlcode not = 0
  8494        display "Error: cannot delete row  "
  8495        display ' sql retrun code ' sqlcode
  8496        display ' sql err mess    ' sqlerrmc
  8497        go to 4250-exit
  8498     end-if
  8499     set row-deleted         to true
  8500     EXEC SQL
  8501         commit transaction
  8502     END-EXEC
  8503     if sqlcode not = 0
  8504        display "Error: commit "
  8505        display ' sql return code ' sqlcode
  8506        display ' sql err mess    ' sqlerrmc
  8507        go to 4250-exit
  8508     end-if
  8509     set tbl-commited to true
  8510     .
  8511 4250-exit.
  8512     exit.
  8513 4300-FINISH-UP-DB.
  8514     EXEC SQL
  8515         commit work release
  8516     END-EXEC
  8517     if sqlcode not = 0
  8518        display "Error: commit release "
  8519        display ' sql return code ' sqlcode
  8520        display ' sql err mess    ' sqlerrmc
  8521     end-if
  8522     .
  8523 4300-EXIT.
  8524     EXIT.
  8525 5000-BROWSE-FILE.
  8526
  8527* EXEC CICS HANDLE CONDITION
  8528*        NOTFND   (5560-END-OF-FILE)
  8529*        ENDFILE  (5560-END-OF-FILE)
  8530*    END-EXEC.
  8531*    MOVE '"$I''                  ! . #00007882' TO DFHEIV0
  8532     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8534     MOVE X'2E20233030303037383832' TO DFHEIV0(25:11)
  8535     CALL 'kxdfhei1' USING DFHEIV0
  8536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8537
  8538
  8539     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8540
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 154
* EL677.cbl
  8541     IF SEQI = LOW-VALUES
  8542         MOVE +1                 TO CHEK-RECORD-SEQ.
  8543
  8544     IF EIBAID = DFHPF2
  8545         GO TO 5100-BROWSE-BKWD.
  8546
  8547 5010-READ-LOOP.
  8548     IF EIBAID = DFHPF1
  8549         ADD +1                  TO CHEK-RECORD-SEQ.
  8550
  8551
  8552* EXEC CICS READ
  8553*        DATASET  (ERCHEK-FILE-ID)
  8554*        SET      (ADDRESS OF CHECK-RECORDS)
  8555*        RIDFLD   (ERCHEK-KEY)
  8556*        GTEQ
  8557*    END-EXEC.
  8558*    MOVE '&"S        G          (   #00007899' TO DFHEIV0
  8559     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8560     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8561     MOVE X'2020233030303037383939' TO DFHEIV0(25:11)
  8562     CALL 'kxdfhei1' USING DFHEIV0,
  8563           ERCHEK-FILE-ID,
  8564           DFHEIV20,
  8565           DFHEIV99,
  8566           ERCHEK-KEY,
  8567           DFHEIV99,
  8568           DFHEIV99,
  8569           DFHEIV99
  8570     SET ADDRESS OF CHECK-RECORDS TO
  8571         DFHEIV20
  8572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8573
  8574
  8575     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8576         IF EIBAID = DFHENTER
  8577             GO TO 5550-NO-RECORD
  8578         ELSE
  8579             GO TO 5560-END-OF-FILE.
  8580
  8581        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8582           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8583           PI-CHEK-STATE      = CH-STATE       AND
  8584           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8585           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8586           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8587           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8588              GO TO 5500-FORMAT-SCREEN
  8589            ELSE
  8590              IF EIBAID = DFHPF1
  8591                  GO TO 5560-END-OF-FILE
  8592                ELSE
  8593                  GO TO 5550-NO-RECORD.
  8594
  8595     IF EIBAID = DFHENTER
  8596        IF CHEK-CARRIER    = CH-CARRIER     AND
  8597           CHEK-GROUPING   = CH-GROUPING    AND
  8598           CHEK-STATE      = CH-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 155
* EL677.cbl
  8599           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8600           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8601           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8602           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8603           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8604              GO TO 5500-FORMAT-SCREEN
  8605        ELSE
  8606              GO TO 5550-NO-RECORD.
  8607
  8608     GO TO 5500-FORMAT-SCREEN.
  8609
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 156
* EL677.cbl
  8611
  8612 5100-BROWSE-BKWD.
  8613
  8614* EXEC CICS STARTBR
  8615*        DATASET  (ERCHEK-FILE-ID)
  8616*        RIDFLD   (ERCHEK-KEY)
  8617*    END-EXEC.
  8618     MOVE 0
  8619       TO DFHEIV11
  8620*    MOVE '&,         G          &   #00007944' TO DFHEIV0
  8621     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8623     MOVE X'2020233030303037393434' TO DFHEIV0(25:11)
  8624     CALL 'kxdfhei1' USING DFHEIV0,
  8625           ERCHEK-FILE-ID,
  8626           ERCHEK-KEY,
  8627           DFHEIV99,
  8628           DFHEIV11,
  8629           DFHEIV99
  8630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8631
  8632
  8633
  8634* EXEC CICS READPREV
  8635*        DATASET  (ERCHEK-FILE-ID)
  8636*        SET      (ADDRESS OF CHECK-RECORDS)
  8637*        RIDFLD   (ERCHEK-KEY)
  8638*    END-EXEC.
  8639     MOVE 0
  8640       TO DFHEIV11
  8641*    MOVE '&0S                   )   #00007949' TO DFHEIV0
  8642     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8643     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8644     MOVE X'2020233030303037393439' TO DFHEIV0(25:11)
  8645     CALL 'kxdfhei1' USING DFHEIV0,
  8646           ERCHEK-FILE-ID,
  8647           DFHEIV20,
  8648           DFHEIV99,
  8649           ERCHEK-KEY,
  8650           DFHEIV99,
  8651           DFHEIV11,
  8652           DFHEIV99,
  8653           DFHEIV99
  8654     SET ADDRESS OF CHECK-RECORDS TO
  8655         DFHEIV20
  8656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8657
  8658
  8659 5110-READ-LOOP.
  8660     IF PI-FILE-EOF
  8661         MOVE SPACE              TO PI-EOF-SW
  8662     ELSE
  8663
  8664* EXEC CICS READPREV
  8665*            DATASET  (ERCHEK-FILE-ID)
  8666*            SET      (ADDRESS OF CHECK-RECORDS)
  8667*            RIDFLD   (ERCHEK-KEY)
  8668*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 157
* EL677.cbl
  8669     MOVE 0
  8670       TO DFHEIV11
  8671*    MOVE '&0S                   )   #00007959' TO DFHEIV0
  8672     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8674     MOVE X'2020233030303037393539' TO DFHEIV0(25:11)
  8675     CALL 'kxdfhei1' USING DFHEIV0,
  8676           ERCHEK-FILE-ID,
  8677           DFHEIV20,
  8678           DFHEIV99,
  8679           ERCHEK-KEY,
  8680           DFHEIV99,
  8681           DFHEIV11,
  8682           DFHEIV99,
  8683           DFHEIV99
  8684     SET ADDRESS OF CHECK-RECORDS TO
  8685         DFHEIV20
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8687
  8688
  8689     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8690         GO TO 5560-END-OF-FILE.
  8691
  8692        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8693           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8694           PI-CHEK-STATE      = CH-STATE       AND
  8695           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8696           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8697           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8698           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8699              GO TO 5500-FORMAT-SCREEN
  8700            ELSE
  8701              GO TO 5560-END-OF-FILE.
  8702
  8703     GO TO 5500-FORMAT-SCREEN.
  8704
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 158
* EL677.cbl
  8706*                          COPY ELCNPD.
  8707*****************************************************************
  8708*                                                               *
  8709*                                                               *
  8710*                            ELCNPD                             *
  8711*                            VMOD=2.001                         *
  8712*****************************************************************
  8713
  8714 5200-MOVE-NAME.
  8715*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8716*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8717*            BLANKS.                                            *
  8718*                                                               *
  8719*                  FIELD               VALUE                    *
  8720*                                                               *
  8721*                LAST NAME (CL15)      SMITH                    *
  8722*                1ST NAME  (CL12)      JOHN                     *
  8723*                MID NAME  (CL1)       A                        *
  8724*                                                               *
  8725*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8726*         *                                                     *
  8727*         *              JOHN A. SMITH                          *
  8728*         *                                                     *
  8729*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8730*         *  STORAGE COPYBOOK:                                  *
  8731*         *                                                     *
  8732*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8733*         *******************************************************.
  8734
  8735     MOVE SPACES                 TO  WS-NAME-WORK
  8736                                     WS-NAME-WORK2.
  8737     MOVE ZERO                   TO  WS-NAME-SW.
  8738     SET NWA-INDEX TO +1.
  8739
  8740     IF WS-INSURED-1ST-NAME = SPACES  AND
  8741        WS-INSURED-MID-INIT = SPACES
  8742         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8743         GO TO 5200-EXIT.
  8744
  8745     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8746     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8747
  8748     SET NWA-INDEX UP BY +1
  8749     IF WS-INSURED-MID-INIT NOT = SPACES
  8750        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8751        SET NWA-INDEX UP BY +1
  8752        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8753        SET NWA-INDEX UP BY +2.
  8754
  8755     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8756     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8757
  8758
  8759 5200-EXIT.
  8760     EXIT.
  8761
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 159
* EL677.cbl
  8763 5300-MOVE-NAME SECTION.
  8764     IF WS-NAME-SW GREATER THAN +1
  8765         GO TO 5390-EXIT.
  8766
  8767     IF WS-NAME-WORK2 = SPACES
  8768         GO TO 5390-EXIT.
  8769
  8770     SET NWA-INDEX2 TO +1.
  8771     SET NWA-INDEX3 TO +2.
  8772
  8773 5310-MOVE-NAME.
  8774     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8775
  8776     IF NWA-INDEX LESS THAN +30
  8777        SET NWA-INDEX UP BY +1
  8778     ELSE
  8779        ADD +2  TO  WS-NAME-SW
  8780        GO TO 5390-EXIT.
  8781
  8782     IF NWA-INDEX2 LESS THAN +20
  8783         SET NWA-INDEX2 UP BY +1
  8784         SET NWA-INDEX3 UP BY +1.
  8785
  8786     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8787        WS-NW2 (NWA-INDEX3) = SPACES
  8788        GO TO 5390-EXIT.
  8789
  8790     GO TO 5310-MOVE-NAME.
  8791
  8792 5390-EXIT.
  8793     EXIT.
  8794
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 160
* EL677.cbl
  8797 5500-FORMAT-SCREEN.
  8798     MOVE LOW-VALUES             TO  EL677AI.
  8799     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8800     MOVE +1                     TO  MAINTL.
  8801     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8802     MOVE CH-CARRIER             TO  CARRIERO.
  8803     MOVE CH-GROUPING            TO  GROUPO.
  8804     MOVE CH-STATE               TO  STATEO.
  8805     MOVE CH-ACCOUNT             TO  ACCTO.
  8806
  8807     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8808     MOVE SPACE                  TO  DC-OPTION-CODE.
  8809     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8810     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8811
  8812     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8813     MOVE CH-CERT-SFX            TO  SFXO.
  8814     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8815
  8816     MOVE AL-UANON               TO  CARRIERA
  8817                                     GROUPA
  8818                                     STATEA
  8819                                     ACCTA
  8820                                     EFFDTA
  8821                                     CERTNOA
  8822                                     SFXA.
  8823     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8824
  8825     if ch-approval-dt not = low-values
  8826        move ch-approval-dt      to dc-bin-date-1
  8827        move ' '                 to dc-option-code
  8828        perform 8500-date-convert thru 8500-exit
  8829        move dc-greg-date-1-edit to apvdto
  8830     end-if
  8831     evaluate ch-approval-status
  8832        when '2'
  8833           move 'PENDING '       TO APVSTATO
  8834        when 'P'
  8835           move 'PENDING '       TO APVSTATO
  8836        when 'A'
  8837           move 'APPROVED'       to apvstato
  8838        when 'D'
  8839           move 'DENIED'         to apvstato
  8840     end-evaluate
  8841     move ch-approved-by         to apvbyo
  8842*    IF PI-COMPANY-ID = 'TMS'
  8843*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8844*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8845*    ELSE
  8846         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8847         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8848
  8849     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8850     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8851     move ch-payee-city          to payctyo
  8852     move ch-payee-state         to paysto
  8853     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8854
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 161
* EL677.cbl
  8855     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8856         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8857         MOVE AL-UANON           TO  PTOZIPA.
  8858
  8859     MOVE CH-RETURN-TO           TO  RETTOO
  8860*    if ch-check-cashed-dt not = spaces and low-values
  8861*       move ch-check-cashed-dt  to dc-bin-date-1
  8862*       MOVE SPACE               TO  DC-OPTION-CODE
  8863*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8864*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8865*    end-if
  8866     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8867     MOVE SPACE                  TO  DC-OPTION-CODE.
  8868     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8869     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8870
  8871     MOVE CH-RECORDED-BY         TO  CBYO.
  8872
  8873     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8874         NEXT SENTENCE
  8875     ELSE
  8876         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8877         MOVE SPACE                  TO  DC-OPTION-CODE
  8878         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8879         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8880         MOVE CH-VOID-BY             TO  VBYO.
  8881
  8882     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8883         NEXT SENTENCE
  8884     ELSE
  8885         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8886         MOVE SPACE                  TO  DC-OPTION-CODE
  8887         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8888         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8889
  8890     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8891     MOVE AL-SANOF               TO  AMOUNTA.
  8892     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8893     MOVE AL-SANOF               TO  TYPEA.
  8894     MOVE CH-CHECK-NO            TO  CHECKO.
  8895     move ch-deduct-commission   to dedcyno
  8896     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8897     MOVE CH-VOID-REASON         TO  VREASONO.
  8898
  8899     MOVE CH-STUB-LINE-1         TO  STUBO.
  8900     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8901     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8902     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8903     IF CH-LF-REFUND NOT NUMERIC
  8904         MOVE ZEROS              TO CH-LF-REFUND.
  8905     IF CH-AH-REFUND NOT NUMERIC
  8906         MOVE ZEROS              TO CH-AH-REFUND.
  8907     if (ch-check-no not = spaces and low-values)
  8908        and (ch-check-written-dt not = low-values)
  8909        perform 5800-fetch-check-cashed-dt
  8910                                 thru 5800-exit
  8911     end-if
  8912     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 162
* EL677.cbl
  8913        CH-VOID-DT          GREATER LOW-VALUES
  8914        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8915                                     STUBA     TEXT1A   TEXT2A
  8916                                     TEXT3A    PAYTO1A  SFXA
  8917                                     PAYTO2A   PAYAD1A  PAYctyA
  8918                                     paysta    RETTOA   PAYAD2A
  8919                                     PTOZIPA
  8920                                     PRINTEDA
  8921     ELSE
  8922        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8923                                     ACCTA     EFFDTA   CERTNOA
  8924                                     CHECKA    REASONA  VREASONA
  8925                                     STUBA     TEXT1A   TEXT2A
  8926                                     TEXT3A    PAYTO1A  SFXA
  8927                                     PAYTO2A   PAYAD1A  PAYctyA
  8928                                     paysta    RETTOA   PAYAD2A
  8929                                     PRINTEDA.
  8930
  8931     MOVE AL-UNNON               TO SEQA.
  8932     perform 5600-get-erpndb     thru 5600-exit
  8933     perform 5700-get-elcert     thru 5700-exit
  8934*    move pi-prev-paid           to prepdo
  8935     move al-sadof               to drefa
  8936*    if WS-PNDB-FOUND
  8937*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8938*    end-if
  8939     if WS-CERT-FOUND
  8940        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8941           cm-lf-alt-premium-amt
  8942        compute ws-tot-iss-prem  =
  8943           cm-ah-premium-amt + ws-tot-lf-prem
  8944        compute ws-tot-iss-comm =
  8945           (ws-tot-lf-prem * cm-life-comm-pct) +
  8946           (cm-ah-premium-amt * cm-ah-comm-pct)
  8947        compute ws-tot-ref-comm =
  8948           (pi-lf-refund * cm-life-comm-pct) +
  8949           (pi-ah-refund * cm-ah-comm-pct)
  8950        move ws-tot-iss-prem     to premo
  8951        move ws-tot-iss-comm     to isscommo
  8952*       move ws-tot-ref-comm     to uecommo
  8953     end-if
  8954     if PI-TO-EL677-FROM-EL1273
  8955        move zeros               to premo
  8956                                    isscommo
  8957                                    uecommo
  8958                                    prepdo
  8959                                    refo
  8960     end-if
  8961     GO TO 8100-SEND-INITIAL-MAP
  8962     .
  8963 5550-NO-RECORD.
  8964     MOVE ER-1162                TO  EMI-ERROR.
  8965     MOVE -1                     TO  CARRIERL.
  8966     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8967                                     ACCTA     EFFDTA  CERTNOA
  8968                                     SFXA      SEQA.
  8969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8970
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 163
* EL677.cbl
  8971     IF (NOT PI-TO-EL677-FROM-EL1273)
  8972        and (pi-return-to-program not = 'EL6315')
  8973         GO TO 8200-SEND-DATAONLY.
  8974
  8975     MOVE CHEK-CARRIER           TO  CARRIERO.
  8976     MOVE CHEK-GROUPING          TO  GROUPO.
  8977     MOVE CHEK-STATE             TO  STATEO.
  8978     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8979
  8980     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8981     MOVE SPACE                  TO  DC-OPTION-CODE.
  8982     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8983     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8984
  8985     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8986     MOVE CHEK-SUF-NO            TO  SFXO.
  8987     GO TO 8100-SEND-INITIAL-MAP.
  8988
  8989 5560-END-OF-FILE.
  8990     IF EIBAID = DFHPF1
  8991         MOVE 'Y'                TO  PI-EOF-SW
  8992         MOVE ER-2237            TO  EMI-ERROR
  8993     ELSE
  8994     IF EIBAID = DFHENTER
  8995        GO TO 5550-NO-RECORD
  8996     ELSE
  8997*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8998         MOVE ER-2238            TO  EMI-ERROR.
  8999
  9000     MOVE -1                     TO  MAINTL.
  9001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9002     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 164
* EL677.cbl
  9004 5600-get-erpndb.
  9005     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  9006     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  9007     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  9008     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9009     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9010     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9011     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9012     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9013     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9014     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9015     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9016     IF ST-ACCNT-CNTL  OR
  9017        ACCNT-CNTL
  9018          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9019     IF ST-ACCNT-CNTL      OR
  9020        CARR-ST-ACCNT-CNTL OR
  9021        ACCNT-CNTL         OR
  9022        CARR-ACCNT-CNTL
  9023          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9024     IF ACCNT-CNTL OR
  9025        CARR-ACCNT-CNTL
  9026          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9027
  9028* EXEC CICS READ
  9029*         DATASET   (ERPNDB-ALT-FILE-ID)
  9030*         SET       (ADDRESS OF PENDING-BUSINESS)
  9031*         RIDFLD    (ERPNDB-ALT-KEY)
  9032*         resp      (ws-response)
  9033*    END-EXEC
  9034*    MOVE '&"S        E          (  N#00008303' TO DFHEIV0
  9035     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9037     MOVE X'204E233030303038333033' TO DFHEIV0(25:11)
  9038     CALL 'kxdfhei1' USING DFHEIV0,
  9039           ERPNDB-ALT-FILE-ID,
  9040           DFHEIV20,
  9041           DFHEIV99,
  9042           ERPNDB-ALT-KEY,
  9043           DFHEIV99,
  9044           DFHEIV99,
  9045           DFHEIV99
  9046     SET ADDRESS OF PENDING-BUSINESS TO
  9047         DFHEIV20
  9048     MOVE EIBRESP  TO ws-response
  9049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9050     if resp-normal
  9051        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9052        compute pi-refund-on-pending-rec =
  9053           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9054     end-if
  9055     .
  9056 5600-exit.
  9057     exit.
  9058 5700-get-elcert.
  9059     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9060     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9061     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 165
* EL677.cbl
  9062     MOVE PI-STATE               TO  ELCERT-STATE.
  9063     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9064     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9065     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9066     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9067     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9068
  9069* EXEC CICS READ
  9070*         DATASET   (ELCERT-FILE-ID)
  9071*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9072*         RIDFLD    (ELCERT-KEY)
  9073*         resp      (ws-response)
  9074*    END-EXEC
  9075*    MOVE '&"S        E          (  N#00008327' TO DFHEIV0
  9076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9078     MOVE X'204E233030303038333237' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           ELCERT-FILE-ID,
  9081           DFHEIV20,
  9082           DFHEIV99,
  9083           ELCERT-KEY,
  9084           DFHEIV99,
  9085           DFHEIV99,
  9086           DFHEIV99
  9087     SET ADDRESS OF CERTIFICATE-MASTER TO
  9088         DFHEIV20
  9089     MOVE EIBRESP  TO ws-response
  9090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9091     if resp-normal
  9092        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9093     end-if
  9094     .
  9095 5700-exit.
  9096     exit.
  9097 5800-fetch-check-cashed-dt.
  9098     move ' '                    to ws-connect-sw
  9099                                    ws-match-sw
  9100                                    pi-check-cashed
  9101     move 'NTCSO2_PdBnkInfo'     to svr
  9102     move 'sa'                   to usr
  9103     move 'ntcso2'               to pass
  9104     string
  9105         usr delimited space
  9106         "." delimited size
  9107         pass delimited space into usr-pass
  9108     end-string
  9109     EXEC SQL
  9110        CONNECT TO :svr USER :usr-pass
  9111     END-EXEC
  9112     if sqlcode not = 0
  9113        display "Error: cannot connect to pdbnkinfo "
  9114        display sqlcode
  9115        display sqlerrmc
  9116        go to 5800-exit
  9117     end-if
  9118     set connected-to-db to true
  9119     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 166
* EL677.cbl
  9120        move 'CSO - AP%'         to ws-pb-compid
  9121     else
  9122        move 'AHL - AP%'         to ws-pb-compid
  9123     end-if
  9124     move '000'                  to ws-pb-check-no (1:3)
  9125     move ch-check-no            to ws-pb-check-no (4:7)
  9126     move spaces                 to ws-pb-bad-check-no
  9127     perform varying s1 from +1 by +1 until
  9128        (s1 > +10)
  9129        or (ws-pb-check-no (s1:1) not = '0')
  9130     end-perform
  9131     if s1 < +11
  9132        move ws-pb-check-no (s1:11 - s1)
  9133                            to ws-pb-bad-check-no (1: 11 - s1)
  9134     end-if
  9135*    display ' compid **' ws-pb-compid '**'
  9136*    display ' ckno  **' ws-pb-check-no '**'
  9137     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9138     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9139     MOVE SPACES              TO pb-paid-date
  9140
  9141     EXEC SQL
  9142        CALL pbi_GetCashDate_by_TransactionNbr
  9143           @compid          = :ws-pb-compid,
  9144           @checkno         = :ws-pb-check-no,
  9145           @badcheckno      = :ws-pb-bad-check-no,
  9146           @checkamount     = :ws-check-amount,
  9147           @checkcasheddate = :pb-paid-date OUT
  9148     END-EXEC
  9149     if sqlcode not = 0
  9150        display "Error: cannot run stor proc  "
  9151        move sqlcode            to ws-sql-code
  9152        move ws-sql-code to ws-dis-sql-code
  9153        display ' dis sql code ' ws-dis-sql-code
  9154        display ' sql return code ' sqlcode
  9155        display ' sql err mess    ' sqlerrmc
  9156        go to 5800-disconnect
  9157     end-if
  9158***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9159***                                                            ***
  9160***  The following code works just as well as the above        ***
  9161***  stored procedure and just as fast.                        ***
  9162***  Originally, I had declared a cursor and fetched through   ***
  9163***  the record set to find the correct check and that REALLY  ***
  9164***  slowed the response down to ~ 3/4 second.                 ***
  9165***                                                            ***
  9166***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9167*     EXEC SQL
  9168*        SELECT
  9169*           PaidDate
  9170*        INTO
  9171*           :pb-paid-date
  9172*        FROM
  9173*           dbo.cso_pbi_TransactionLookup
  9174*        WHERE
  9175*           (BankAcctDescr like :ws-pb-compid)
  9176*           and (Amount = :ws-check-amount)
  9177*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 167
* EL677.cbl
  9178*                  or
  9179*               (transactionnbr = :ws-pb-bad-check-no))
  9180**          and (CAST(TransactionNbr AS INT) =
  9181**             :ws-pb-check-no-num)
  9182**          and (right('00000' + rtrim(TransactionNbr),10)
  9183**             = :ws-pb-check-no)
  9184**          and (TransactionNbr  = :ws-pb-check-no)
  9185*     END-EXEC
  9186*    display ' chkno  ' pb-check-no
  9187*    display ' desc   ' pb-bank-acct-desc
  9188*    display ' trn typ' pb-tran-type
  9189*    display ' amt   *' pb-amount '**'
  9190*    display ' pd dte ' pb-paid-date
  9191     string pb-paid-date (7:4)
  9192            pb-paid-date (1:2)
  9193            pb-paid-date (4:2)
  9194        delimited by size into dc-greg-date-cymd-r
  9195     end-string
  9196     move 'L'                    to dc-option-code
  9197     perform 8500-date-convert   thru 8500-exit
  9198     if no-conversion-error
  9199*       move dc-bin-date-1       to ws-bin-cashed-dt
  9200        move dc-greg-date-1-edit to cashedo
  9201        move 'Y' to pi-check-cashed
  9202     else
  9203        display ' error cvtdte cash dt ' pb-paid-date ' '
  9204           dc-error-code
  9205     end-if
  9206     .
  9207 5800-disconnect.
  9208     EXEC SQL
  9209        DISCONNECT ALL
  9210     END-EXEC
  9211     if sqlcode not = 0
  9212        display "Error: cannot disconnect pdbnk "
  9213        display ' sql return code ' sqlcode
  9214        display ' sql err mess    ' sqlerrmc
  9215     end-if
  9216     .
  9217 5800-exit.
  9218     exit.
  9219 6000-VERIFY-COMP-MASTER.
  9220
  9221* EXEC CICS HANDLE CONDITION
  9222*        NOTFND   (6070-NO-COMP-MSTR)
  9223*    END-EXEC.
  9224*    MOVE '"$I                   ! / #00008462' TO DFHEIV0
  9225     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9227     MOVE X'2F20233030303038343632' TO DFHEIV0(25:11)
  9228     CALL 'kxdfhei1' USING DFHEIV0
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9230
  9231
  9232     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9233
  9234     IF NOT PI-ZERO-CARRIER AND
  9235        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 168
* EL677.cbl
  9236         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9237     ELSE
  9238         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9239
  9240     IF NOT PI-ZERO-GROUPING  AND
  9241        NOT PI-ZERO-CAR-GROUP
  9242         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9243     ELSE
  9244         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9245
  9246     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9247     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9248     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9249
  9250
  9251* EXEC CICS READ
  9252*         DATASET   (ERCOMP-FILE-ID)
  9253*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9254*         RIDFLD    (ERCOMP-KEY)
  9255*     END-EXEC.
  9256*    MOVE '&"S        E          (   #00008484' TO DFHEIV0
  9257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9259     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  9260     CALL 'kxdfhei1' USING DFHEIV0,
  9261           ERCOMP-FILE-ID,
  9262           DFHEIV20,
  9263           DFHEIV99,
  9264           ERCOMP-KEY,
  9265           DFHEIV99,
  9266           DFHEIV99,
  9267           DFHEIV99
  9268     SET ADDRESS OF COMPENSATION-MASTER TO
  9269         DFHEIV20
  9270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9271
  9272
  9273     GO TO 6090-EXIT.
  9274
  9275 6070-NO-COMP-MSTR.
  9276     MOVE -1                     TO  CARRIERL.
  9277     MOVE ER-2230                TO  EMI-ERROR.
  9278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9279     GO TO 8200-SEND-DATAONLY.
  9280
  9281 6090-EXIT.
  9282      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 169
* EL677.cbl
  9284 6100-VERIFY-CERTIFICATE.
  9285
  9286* EXEC CICS HANDLE CONDITION
  9287*        NOTFND   (6170-NO-CERTIFICATE)
  9288*    END-EXEC.
  9289*    MOVE '"$I                   ! 0 #00008502' TO DFHEIV0
  9290     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9292     MOVE X'3020233030303038353032' TO DFHEIV0(25:11)
  9293     CALL 'kxdfhei1' USING DFHEIV0
  9294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9295
  9296
  9297     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9298     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9299     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9300     MOVE PI-STATE               TO  ELCERT-STATE.
  9301     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9302     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9303     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9304     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9305
  9306     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9307
  9308     MOVE SPACES                 TO  PI-REFERENCE
  9309*                                    PI-INSURED-NAME.
  9310     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9311     MOVE ZEROS                  TO  PI-LF-REFUND
  9312                                     PI-AH-REFUND.
  9313
  9314
  9315* EXEC CICS READ
  9316*         DATASET   (ELCERT-FILE-ID)
  9317*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9318*         RIDFLD    (ELCERT-KEY)
  9319*     END-EXEC.
  9320*    MOVE '&"S        E          (   #00008523' TO DFHEIV0
  9321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9323     MOVE X'2020233030303038353233' TO DFHEIV0(25:11)
  9324     CALL 'kxdfhei1' USING DFHEIV0,
  9325           ELCERT-FILE-ID,
  9326           DFHEIV20,
  9327           DFHEIV99,
  9328           ELCERT-KEY,
  9329           DFHEIV99,
  9330           DFHEIV99,
  9331           DFHEIV99
  9332     SET ADDRESS OF CERTIFICATE-MASTER TO
  9333         DFHEIV20
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9335
  9336
  9337     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9338
  9339     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9340     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9341     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 170
* EL677.cbl
  9342         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9343     ELSE
  9344         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9345             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9346*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9347
  9348     GO TO 6190-EXIT.
  9349
  9350 6170-NO-CERTIFICATE.
  9351     MOVE -1                     TO  CARRIERL.
  9352     MOVE ER-2726                TO  EMI-ERROR.
  9353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9354
  9355 6190-EXIT.
  9356      EXIT.
  9357
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 171
* EL677.cbl
  9359 6200-UPDATE-PENDING-BUS-REC.
  9360     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9361     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9362     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9363     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9364     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9365     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9366     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9367     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9368     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9369     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9370
  9371     IF ST-ACCNT-CNTL  OR
  9372        ACCNT-CNTL
  9373          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9374
  9375     IF ST-ACCNT-CNTL      OR
  9376        CARR-ST-ACCNT-CNTL OR
  9377        ACCNT-CNTL         OR
  9378        CARR-ACCNT-CNTL
  9379          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9380
  9381     IF ACCNT-CNTL OR
  9382        CARR-ACCNT-CNTL
  9383          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9384
  9385
  9386* EXEC CICS READ
  9387*         DATASET   (ERPNDB-ALT-FILE-ID)
  9388*         SET       (ADDRESS OF PENDING-BUSINESS)
  9389*         RIDFLD    (ERPNDB-ALT-KEY)
  9390*         resp      (ws-response)
  9391*     END-EXEC.
  9392*    MOVE '&"S        E          (  N#00008577' TO DFHEIV0
  9393     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9395     MOVE X'204E233030303038353737' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0,
  9397           ERPNDB-ALT-FILE-ID,
  9398           DFHEIV20,
  9399           DFHEIV99,
  9400           ERPNDB-ALT-KEY,
  9401           DFHEIV99,
  9402           DFHEIV99,
  9403           DFHEIV99
  9404     SET ADDRESS OF PENDING-BUSINESS TO
  9405         DFHEIV20
  9406     MOVE EIBRESP  TO ws-response
  9407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9408
  9409
  9410     if not resp-normal
  9411        go to 6200-exit
  9412     end-if
  9413     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9414
  9415
  9416* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 172
* EL677.cbl
  9417*         DATASET   (ERPNDB-FILE-ID)
  9418*         SET       (ADDRESS OF PENDING-BUSINESS)
  9419*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9420*         UPDATE
  9421*         resp      (ws-response)
  9422*     END-EXEC.
  9423*    MOVE '&"S        EU         (  N#00008589' TO DFHEIV0
  9424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9425     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9426     MOVE X'204E233030303038353839' TO DFHEIV0(25:11)
  9427     CALL 'kxdfhei1' USING DFHEIV0,
  9428           ERPNDB-FILE-ID,
  9429           DFHEIV20,
  9430           DFHEIV99,
  9431           ERPNDB-PRIMARY-KEY,
  9432           DFHEIV99,
  9433           DFHEIV99,
  9434           DFHEIV99
  9435     SET ADDRESS OF PENDING-BUSINESS TO
  9436         DFHEIV20
  9437     MOVE EIBRESP  TO ws-response
  9438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9439
  9440
  9441 6200-EXIT.
  9442      EXIT.
  9443 6210-rewrite-pndb.
  9444
  9445* EXEC CICS REWRITE
  9446*        DATASET  (ERPNDB-FILE-ID)
  9447*        FROM     (PENDING-BUSINESS)
  9448*    END-EXEC
  9449     MOVE LENGTH OF
  9450      PENDING-BUSINESS
  9451       TO DFHEIV11
  9452*    MOVE '&& L                  %   #00008600' TO DFHEIV0
  9453     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9454     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9455     MOVE X'2020233030303038363030' TO DFHEIV0(25:11)
  9456     CALL 'kxdfhei1' USING DFHEIV0,
  9457           ERPNDB-FILE-ID,
  9458           PENDING-BUSINESS,
  9459           DFHEIV11,
  9460           DFHEIV99
  9461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9462     .
  9463 6210-exit.
  9464     exit.
  9465 6300-BUILD-CERT-SCREEN.
  9466     perform 6700-build-common   thru 6700-exit
  9467     if ws-refund-amount = zeros
  9468        move pi-company-cd       to pi-chek-comp-cd
  9469        move pi-carrier          to pi-chek-carrier
  9470        move pi-grouping         to pi-chek-grouping
  9471        move pi-state            to pi-chek-state
  9472        move pi-account          to pi-chek-account
  9473        move pi-cert-eff-dt      to pi-chek-eff-dt
  9474        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 173
* EL677.cbl
  9475        move pi-cert-sfx         to pi-chek-suf-no
  9476        move +1                  to pi-chek-sequence
  9477             MOVE 'S'            TO MAINTI
  9478             MOVE 1              TO MAINTL
  9479             MOVE AL-UABON       TO MAINTA
  9480             MOVE DFHENTER       TO EIBAID
  9481        go to 5000-browse-file
  9482     end-if
  9483     IF WS-CERT-NOT-FOUND
  9484         GO TO 8100-SEND-INITIAL-MAP.
  9485
  9486*    IF WS-PNDB-FOUND
  9487*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9488*                                   PB-C-AH-CANCEL-AMT
  9489*        MOVE 'R'                TO  TYPEO
  9490*        IF PI-AR-PROCESSING
  9491*            MOVE AL-UANON       TO  REFA
  9492*            MOVE PB-C-REFERENCE TO  REFO
  9493*        END-IF
  9494*    ELSE
  9495*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9496*                                   CM-AH-ITD-CANCEL-AMT.
  9497     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9498     MOVE pi-check-type           TO TYPEO
  9499
  9500     IF PI-COMPANY-ID = 'TMS'
  9501         MOVE WS-NAME-WORK         TO PAYTO1I
  9502                                      PI-PAYTO1
  9503         MOVE AL-UANON             TO PAYTO1A
  9504     ELSE
  9505         MOVE WS-NAME-WORK         TO PAYTO1I
  9506                                      PI-PAYTO1
  9507         MOVE AL-UANON             TO PAYTO1A.
  9508
  9509*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9510*    MOVE AL-UANON                 TO PAYTO1AA.
  9511     move 'N'                    to dedcyni
  9512     move al-uanon               to dedcyna
  9513     move 'INS'                  to payeeo
  9514     move al-panon               to payeea
  9515     IF PI-MAIL-YES
  9516         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9517
  9518     GO TO 8100-SEND-INITIAL-MAP.
  9519
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 174
* EL677.cbl
  9521
  9522 6400-MAILING-ADDRESS.
  9523
  9524* EXEC CICS HANDLE CONDITION
  9525*        NOTFND   (6470-NO-ADDRESS)
  9526*    END-EXEC.
  9527*    MOVE '"$I                   ! 1 #00008665' TO DFHEIV0
  9528     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9530     MOVE X'3120233030303038363635' TO DFHEIV0(25:11)
  9531     CALL 'kxdfhei1' USING DFHEIV0
  9532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9533
  9534
  9535
  9536* EXEC CICS READ
  9537*        DATASET   (ERMAIL-FILE-ID)
  9538*        SET       (ADDRESS OF MAILING-DATA)
  9539*        RIDFLD    (ELCERT-KEY)
  9540*    END-EXEC.
  9541*    MOVE '&"S        E          (   #00008669' TO DFHEIV0
  9542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9544     MOVE X'2020233030303038363639' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           ERMAIL-FILE-ID,
  9547           DFHEIV20,
  9548           DFHEIV99,
  9549           ELCERT-KEY,
  9550           DFHEIV99,
  9551           DFHEIV99,
  9552           DFHEIV99
  9553     SET ADDRESS OF MAILING-DATA TO
  9554         DFHEIV20
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9559     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9560     move ma-city                to payctyi
  9561     move ma-addr-state          to paysti
  9562     MOVE MA-ZIP                 TO PTOZIPI.
  9563     MOVE AL-UANON               TO PAYAD1A
  9564                                    PAYAD2A
  9565                                    PAYctyA
  9566                                    paysta
  9567                                    PTOZIPA.
  9568
  9569     GO TO 6490-EXIT.
  9570
  9571 6470-NO-ADDRESS.
  9572     MOVE -1                     TO  PAYAD1L.
  9573     MOVE ER-2394                TO  EMI-ERROR.
  9574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9575
  9576 6490-EXIT.
  9577      EXIT.
  9578
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 175
* EL677.cbl
  9580
  9581 6500-BUILD-ACCOUNT-SCREEN.
  9582     perform 6700-build-common   thru 6700-exit
  9583     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9584     MOVE PI-AM-NAME             TO PAYTO1I
  9585     MOVE SPACES                 TO PAYTO2I
  9586     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9587     MOVE PI-AM-CITY             TO PAYCTYI
  9588     move pi-am-st               to paysti
  9589     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9590     move 'ACCT'                 to payeeo
  9591     move al-panon               to payeea
  9592     MOVE AL-UANON               TO PAYTO1A
  9593                                    PAYTO2A
  9594                                    PAYAD1A
  9595                                    PAYCTYA
  9596                                    paysta
  9597                                    PTOZIPA.
  9598     GO TO 8100-SEND-INITIAL-MAP
  9599     .
  9600 6600-BUILD-BENEFICIARY-SCREEN.
  9601     perform 6700-build-common   thru 6700-exit
  9602     IF WS-CERT-NOT-FOUND
  9603         GO TO 8100-SEND-INITIAL-MAP.
  9604
  9605*    IF WS-PNDB-FOUND
  9606*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9607*                                   PB-C-AH-CANCEL-AMT
  9608*        MOVE 'R'                TO  TYPEO
  9609*        IF PI-AR-PROCESSING
  9610*            MOVE AL-UANON       TO  REFA
  9611*            MOVE PB-C-REFERENCE TO  REFO
  9612*        END-IF
  9613*    ELSE
  9614*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9615*                                   CM-AH-ITD-CANCEL-AMT.
  9616
  9617     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9618     MOVE pi-check-type           TO  TYPEO.
  9619
  9620     IF PI-COMPANY-ID = 'TMS'
  9621         MOVE WS-NAME-WORK         TO PAYTO1I
  9622                                      PI-PAYTO1
  9623         MOVE AL-UANON             TO PAYTO1A
  9624     ELSE
  9625         MOVE WS-NAME-WORK         TO PAYTO1I
  9626                                      PI-PAYTO1
  9627         MOVE AL-UANON             TO PAYTO1A.
  9628
  9629*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9630*    MOVE AL-UANON                 TO PAYTO1AA.
  9631
  9632     move 'N'                    to dedcyni
  9633     move al-uanon               to dedcyna
  9634     move 'BENE'                 to payeeo
  9635     move al-panon               to payeea
  9636     IF PI-MAIL-YES
  9637         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 176
* EL677.cbl
  9638
  9639     GO TO 8100-SEND-INITIAL-MAP.
  9640
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 177
* EL677.cbl
  9642
  9643 6620-MAILING-ADDRESS.
  9644
  9645* EXEC CICS HANDLE CONDITION
  9646*        NOTFND   (6670-NO-beneficiary)
  9647*    END-EXEC.
  9648*    MOVE '"$I                   ! 2 #00008761' TO DFHEIV0
  9649     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9651     MOVE X'3220233030303038373631' TO DFHEIV0(25:11)
  9652     CALL 'kxdfhei1' USING DFHEIV0
  9653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9654
  9655
  9656
  9657* EXEC CICS READ
  9658*        DATASET   (ERMAIL-FILE-ID)
  9659*        SET       (ADDRESS OF MAILING-DATA)
  9660*        RIDFLD    (ELCERT-KEY)
  9661*    END-EXEC.
  9662*    MOVE '&"S        E          (   #00008765' TO DFHEIV0
  9663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9665     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
  9666     CALL 'kxdfhei1' USING DFHEIV0,
  9667           ERMAIL-FILE-ID,
  9668           DFHEIV20,
  9669           DFHEIV99,
  9670           ELCERT-KEY,
  9671           DFHEIV99,
  9672           DFHEIV99,
  9673           DFHEIV99
  9674     SET ADDRESS OF MAILING-DATA TO
  9675         DFHEIV20
  9676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9677
  9678
  9679     move spaces                 to payto2i
  9680     move ma-cred-bene-name      to payto1i
  9681     MOVE MA-cred-bene-addr      TO PAYad1I.
  9682     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9683     move ma-cred-bene-city      to payctyi
  9684     move ma-cred-bene-state     to paysti
  9685     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9686     MOVE AL-UANON               TO payto1a
  9687                                    PAYTO2A
  9688                                    PAYad1A
  9689                                    payad2a
  9690                                    PAYctyA
  9691                                    paysta
  9692                                    PTOZIPA.
  9693
  9694     GO TO 6690-EXIT.
  9695
  9696 6670-NO-BENEFICIARY.
  9697     MOVE -1                     TO  PAYTO1L.
  9698     MOVE ER-2394                TO  EMI-ERROR.
  9699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 178
* EL677.cbl
  9700
  9701 6690-EXIT.
  9702      EXIT.
  9703 6700-build-common.
  9704     if not eracct-found
  9705        move pi-company-cd       to eracct-co
  9706        move pi-carrier          to eracct-carrier
  9707        move pi-grouping         to eracct-grouping
  9708        move pi-state            to eracct-state
  9709        move pi-account          to eracct-account
  9710        move pi-cert-eff-dt      to eracct-exp-date
  9711        perform 1420-get-eracct  thru 1490-exit
  9712     end-if
  9713*    if WS-PNDB-NOT-FOUND
  9714*       perform 5600-get-erpndb thru 5600-exit
  9715*    end-if
  9716     MOVE LOW-VALUES             TO  EL677AI.
  9717     MOVE 'A'                    TO  MAINTI.
  9718     MOVE AL-UANON               TO  MAINTA.
  9719     MOVE +1                     TO  MAINTL.
  9720     MOVE PI-CARRIER             TO  CARRIERO.
  9721     MOVE PI-GROUPING            TO  GROUPO.
  9722     MOVE PI-STATE               TO  STATEO.
  9723     MOVE PI-ACCOUNT             TO  ACCTO.
  9724     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9725     MOVE PI-CERT-SFX            TO  SFXO.
  9726     MOVE PI-AMOUNT              TO  AMOUNTO.
  9727*    MOVE PI-TYPE                TO  TYPEO.
  9728     move pi-check-type          to  typeo
  9729     move pi-return-to           to  rettoo
  9730*    MOVE PI-REFERENCE           TO  REFO.
  9731     MOVE PI-PAYTO1              TO  PAYTO1O.
  9732     MOVE AL-UANON               TO  CARRIERA
  9733                                     GROUPA
  9734                                     STATEA
  9735                                     ACCTA
  9736                                     CERTNOA
  9737                                     SFXA
  9738                                     PAYTO1A
  9739                                     PAYTO2A
  9740*                                    AMOUNTA
  9741*                                    TYPEA
  9742                                     rettoa.
  9743     move al-panon               to typea
  9744     move al-panon               to amounta
  9745     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9746     MOVE ' '                    TO  DC-OPTION-CODE.
  9747     PERFORM 8500-DATE-CONVERT.
  9748     IF NO-CONVERSION-ERROR
  9749         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9750         MOVE AL-UANON            TO  EFFDTA
  9751         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9752         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9753     ELSE
  9754         GO TO 8200-SEND-DATAONLY.
  9755     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9756         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9757         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 179
* EL677.cbl
  9758     ELSE
  9759         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9760         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9761     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9762     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9763     move spaces to pi-insured-name
  9764     string cm-insured-last-name ' '
  9765            cm-insured-first-name delimited by '  '
  9766        into pi-insured-name
  9767     end-string
  9768     move spaces                 to pi-table-name
  9769     string cm-insured-last-name ', '
  9770            cm-insured-first-name ' '
  9771            cm-insured-initial2
  9772        delimited by '  '
  9773        into
  9774           pi-table-name
  9775     end-string
  9776*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9777     if eibaid = dfhpf5
  9778        move 'Y'                 to dedcyni
  9779        move al-uanon            to dedcyna
  9780     end-if
  9781    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9782       cm-lf-alt-premium-amt
  9783    compute ws-tot-iss-prem  =
  9784       cm-ah-premium-amt + ws-tot-lf-prem
  9785    compute ws-tot-iss-comm =
  9786       (ws-tot-lf-prem * cm-life-comm-pct) +
  9787       (cm-ah-premium-amt * cm-ah-comm-pct)
  9788    compute ws-tot-ref-comm =
  9789       (pi-lf-refund * cm-life-comm-pct) +
  9790       (pi-ah-refund * cm-ah-comm-pct)
  9791     move ws-tot-iss-prem        to premo
  9792     move ws-tot-iss-comm        to isscommo
  9793     move al-sadof               to drefa
  9794                                    refa
  9795*    compute refo = pi-lf-refund + pi-ah-refund
  9796     move pi-prev-paid            to prepdo
  9797     move ws-tot-ref-comm         to uecommo
  9798                                     pi-ue-comm
  9799***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9800***     pi-prev-paid
  9801     compute ws-refund-amount = pi-refund-on-pending-rec
  9802     if (ws-refund-amount + pi-prev-paid) > ws-tot-iss-prem
  9803        compute ws-refund-amount = pi-refund-on-pending-rec -
  9804           pi-prev-paid
  9805     end-if
  9806
  9807     if ws-refund-amount < zeros
  9808        move zeros               to ws-refund-amount
  9809     end-if
  9810     if (dedcyni = 'Y')
  9811        or (pi-prev-ded-comm = 'Y')
  9812        compute ws-refund-amount = ws-refund-amount -
  9813           ws-tot-ref-comm
  9814     end-if
  9815     if pi-check-type = 'C'
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 180
* EL677.cbl
  9816*       move pi-endt-prm-diff    to refo
  9817        move pi-endt-com-diff    to uecommo
  9818                                    pi-ue-comm
  9819        compute ws-refund-amount =
  9820           pi-endt-prm-diff - pi-prev-paid
  9821        if (dedcyni = 'Y')
  9822           or (pi-prev-ded-comm = 'Y')
  9823           compute ws-refund-amount = ws-refund-amount -
  9824              pi-endt-com-diff
  9825        end-if
  9826        if ws-refund-amount <= zeros
  9827           move pi-endt-prm-diff to ws-refund-amount
  9828        end-if
  9829     end-if
  9830     if not WS-CERT-NOT-FOUND
  9831        string
  9832           pi-cert-prime         ' : '
  9833           cm-insured-last-name  ', '
  9834           cm-insured-first-name ' : '
  9835           pi-account            ' : '
  9836           pi-am-csr delimited by '  ' into text1o
  9837        end-string
  9838        move al-uanon            to text1a
  9839        MOVE 'REF'               TO WS-USER-REASON
  9840        if pi-check-type = 'C'
  9841           move 'COR'            to ws-user-reason
  9842        end-if
  9843        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9844        inspect ws-user-cert-no replacing leading zeros
  9845           by spaces
  9846        move pi-insured-name     to ws-user-name
  9847        perform varying s1 from +1 by +1 until
  9848           (s1 > +11)
  9849           or (ws-user-cert-no (s1:1)) <> ' '
  9850        end-perform
  9851        string ws-user-reason  ' ' delimited by size
  9852               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9853                  delimited by size
  9854               cm-insured-last-name ' '
  9855               cm-insured-first-name delimited by '  '
  9856           into stubo
  9857        end-string
  9858        move al-uanon            to stuba
  9859     end-if
  9860     .
  9861 6700-exit.
  9862     exit.
  9863 6800-browse-previous-chek-recs.
  9864***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9865***                                                            ***
  9866**** this should be the first time through, we need to gather  ***
  9867**** all the erchek records for this pending record, add the   ***
  9868**** amounts and make sure this check request will not exceed  ***
  9869**** the collected premium                                     ***
  9870***                                                            ***
  9871***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9872     move zeros                  to pi-prev-paid
  9873                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 181
* EL677.cbl
  9874                                    pi-chek-rec-cnt
  9875     move spaces                 to pi-prev-ded-comm
  9876     move pi-company-cd          to chek-company-cd
  9877     move pi-carrier             to chek-carrier
  9878     move pi-grouping            to chek-grouping
  9879     move pi-state               to chek-state
  9880     move pi-account             to chek-account
  9881     move pi-cert-prime          to chek-cert-no
  9882     move pi-cert-sfx            to chek-suf-no
  9883     move pi-cert-eff-dt         to chek-eff-dt
  9884     move +0                     to chek-record-seq
  9885     move erchek-key             to ws-compare-erchek-key
  9886
  9887* EXEC CICS STARTBR
  9888*       DATASET  (ERCHEK-FILE-ID)
  9889*       RIDFLD   (ERCHEK-KEY)
  9890*       resp     (ws-response)
  9891*    END-EXEC
  9892     MOVE 0
  9893       TO DFHEIV11
  9894*    MOVE '&,         G          &  N#00008978' TO DFHEIV0
  9895     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9896     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9897     MOVE X'204E233030303038393738' TO DFHEIV0(25:11)
  9898     CALL 'kxdfhei1' USING DFHEIV0,
  9899           ERCHEK-FILE-ID,
  9900           ERCHEK-KEY,
  9901           DFHEIV99,
  9902           DFHEIV11,
  9903           DFHEIV99
  9904     MOVE EIBRESP  TO ws-response
  9905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9906     if not resp-normal
  9907        go to 6800-exit
  9908     end-if
  9909     perform until i-say-when
  9910
  9911* EXEC CICS READNEXT
  9912*          DATASET   (ERCHEK-FILE-ID)
  9913*          SET       (ADDRESS OF CHECK-RECORDS)
  9914*          RIDFLD    (ERCHEK-KEY)
  9915*          resp      (ws-response)
  9916*       END-EXEC
  9917     MOVE 0
  9918       TO DFHEIV11
  9919*    MOVE '&.S                   )  N#00008987' TO DFHEIV0
  9920     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9921     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9922     MOVE X'204E233030303038393837' TO DFHEIV0(25:11)
  9923     CALL 'kxdfhei1' USING DFHEIV0,
  9924           ERCHEK-FILE-ID,
  9925           DFHEIV20,
  9926           DFHEIV99,
  9927           ERCHEK-KEY,
  9928           DFHEIV99,
  9929           DFHEIV11,
  9930           DFHEIV99,
  9931           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 182
* EL677.cbl
  9932     SET ADDRESS OF CHECK-RECORDS TO
  9933         DFHEIV20
  9934     MOVE EIBRESP  TO ws-response
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9936        if resp-normal
  9937           and erchek-key (1:33) = ws-compare-erchek-key
  9938           if (ch-void-dt = low-values)
  9939              and (not ch-denied)
  9940              if pi-check-type = 'R'
  9941                 and ch-check-origin-sw = 'C'
  9942                 continue
  9943              else
  9944                 compute pi-prev-paid = pi-prev-paid +
  9945                    ch-amount-paid
  9946                 add +1 to pi-chek-rec-cnt
  9947                 move ch-deduct-commission
  9948                                 to pi-prev-ded-comm
  9949              end-if
  9950           end-if
  9951        else
  9952           set i-say-when to true
  9953        end-if
  9954     end-perform
  9955     .
  9956 6800-exit.
  9957     exit.
  9958 7000-SET-PI-AREA.
  9959     MOVE CARRIERI               TO  PI-CARRIER
  9960                                     PI-CHEK-CARRIER.
  9961     MOVE GROUPI                 TO  PI-GROUPING
  9962                                     PI-CHEK-GROUPING.
  9963     MOVE STATEI                 TO  PI-STATE
  9964                                     PI-CHEK-STATE.
  9965     MOVE ACCTI                  TO  PI-ACCOUNT
  9966                                     PI-CHEK-ACCOUNT.
  9967     MOVE CERTNOI                TO  PI-CERT-PRIME
  9968                                     PI-CHEK-CERT-NO.
  9969     IF SFXI NOT = LOW-VALUES
  9970         MOVE SFXI               TO  PI-CERT-SFX
  9971                                     PI-CHEK-SUF-NO
  9972     ELSE
  9973         MOVE SPACE              TO  PI-CERT-SFX
  9974                                     PI-CHEK-SUF-NO.
  9975
  9976     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9977     MOVE '2'                    TO  DC-OPTION-CODE.
  9978     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9979     IF DATE-CONVERSION-ERROR
  9980         MOVE ER-0215            TO  EMI-ERROR
  9981         MOVE -1                 TO  EFFDTL
  9982         MOVE AL-UNBON           TO  EFFDTA
  9983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9984         GO TO 8200-SEND-DATAONLY
  9985     ELSE
  9986         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9987                                     PI-CHEK-EFF-DT.
  9988
  9989 7090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 183
* EL677.cbl
  9990      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 184
* EL677.cbl
  9992 7100-CREATE-TEMP-STORAGE.
  9993     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9994
  9995
  9996* EXEC CICS WRITEQ TS
  9997*        QUEUE   (QID)
  9998*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9999*        LENGTH  (PI-COMM-LENGTH)
 10000*    END-EXEC.
 10001*    MOVE '*"                    ''   #00009052' TO DFHEIV0
 10002     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 10003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10004     MOVE X'2020233030303039303532' TO DFHEIV0(25:11)
 10005     CALL 'kxdfhei1' USING DFHEIV0,
 10006           QID,
 10007           PROGRAM-INTERFACE-BLOCK,
 10008           PI-COMM-LENGTH,
 10009           DFHEIV99,
 10010           DFHEIV99,
 10011           DFHEIV99
 10012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10013
 10014
 10015 7100-EXIT.
 10016      EXIT.
 10017
 10018 7200-RECOVER-TEMP-STORAGE.
 10019
 10020* EXEC CICS READQ TS
 10021*        QUEUE   (QID)
 10022*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10023*        LENGTH  (PI-COMM-LENGTH)
 10024*    END-EXEC.
 10025*    MOVE '*$I    L              ''   #00009062' TO DFHEIV0
 10026     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10027     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10028     MOVE X'2020233030303039303632' TO DFHEIV0(25:11)
 10029     CALL 'kxdfhei1' USING DFHEIV0,
 10030           QID,
 10031           PROGRAM-INTERFACE-BLOCK,
 10032           PI-COMM-LENGTH,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10037
 10038
 10039     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10040
 10041 7200-EXIT.
 10042      EXIT.
 10043
 10044 7300-DELETE-TEMP-STORAGE.
 10045
 10046* EXEC CICS HANDLE CONDITION
 10047*        QIDERR  (7300-EXIT)
 10048*    END-EXEC.
 10049*    MOVE '"$N                   ! 3 #00009074' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 185
* EL677.cbl
 10050     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10052     MOVE X'3320233030303039303734' TO DFHEIV0(25:11)
 10053     CALL 'kxdfhei1' USING DFHEIV0
 10054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10055
 10056
 10057
 10058* EXEC CICS DELETEQ TS
 10059*        QUEUE  (QID)
 10060*    END-EXEC.
 10061*    MOVE '*&                    #   #00009078' TO DFHEIV0
 10062     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10063     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10064     MOVE X'2020233030303039303738' TO DFHEIV0(25:11)
 10065     CALL 'kxdfhei1' USING DFHEIV0,
 10066           QID,
 10067           DFHEIV99
 10068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10069
 10070
 10071 7300-EXIT.
 10072      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 186
* EL677.cbl
 10074 8035-LETR-NOT-OPEN.
 10075
 10076     MOVE ER-0013                TO EMI-ERROR.
 10077*    MOVE -1                     TO LETTER1L
 10078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10079     GO TO 8200-SEND-DATAONLY.
 10080
 10081 8035-EXIT.
 10082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 187
* EL677.cbl
 10084 8100-SEND-INITIAL-MAP.
 10085     MOVE SAVE-DATE              TO  DATEO.
 10086     MOVE EIBTIME                TO  TIME-IN.
 10087     MOVE TIME-OUT               TO  TIMEO.
 10088     MOVE -1                     TO  MAINTL
 10089     move al-uanon               to mainta
 10090     if PI-TO-EL677-FROM-EL1273
 10091        move al-sadof            to pf357a
 10092                                    pf46a
 10093                                    dprema
 10094                                    dcomma
 10095                                    drefa
 10096                                    duecomma
 10097                                    dprepda
 10098                                    prema
 10099                                    isscomma
 10100                                    refa
 10101                                    uecomma
 10102                                    prepda
 10103                                    dmaint2a
 10104        move ', VOID(V)'         to dmaint1o
 10105     end-if
 10106     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10107     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10108
 10109
 10110* EXEC CICS SEND
 10111*        MAP      (EL677A)
 10112*        MAPSET   (MAPSET-NAME)
 10113*        FROM     (EL677AO)
 10114*        ERASE
 10115*        CURSOR
 10116*    END-EXEC.
 10117     MOVE LENGTH OF
 10118      EL677AO
 10119       TO DFHEIV12
 10120     MOVE -1
 10121       TO DFHEIV11
 10122*    MOVE '8$     CT  E    H L F ,   #00009120' TO DFHEIV0
 10123     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10124     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10125     MOVE X'2020233030303039313230' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0,
 10127           EL677A,
 10128           EL677AO,
 10129           DFHEIV12,
 10130           MAPSET-NAME,
 10131           DFHEIV99,
 10132           DFHEIV99,
 10133           DFHEIV99,
 10134           DFHEIV11,
 10135           DFHEIV99,
 10136           DFHEIV99,
 10137           DFHEIV99
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10139
 10140
 10141     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 188
* EL677.cbl
 10143 8200-SEND-DATAONLY.
 10144     if connected-to-db
 10145        perform 4300-FINISH-UP-DB thru 4300-exit
 10146     end-if
 10147     MOVE SAVE-DATE              TO  DATEO.
 10148     MOVE EIBTIME                TO  TIME-IN.
 10149     MOVE TIME-OUT               TO  TIMEO.
 10150     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10151     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10152
 10153
 10154* EXEC CICS SEND
 10155*        MAP     (EL677A)
 10156*        MAPSET  (MAPSET-NAME)
 10157*        FROM    (EL677AO)
 10158*        DATAONLY
 10159*        CURSOR
 10160*    END-EXEC.
 10161     MOVE LENGTH OF
 10162      EL677AO
 10163       TO DFHEIV12
 10164     MOVE -1
 10165       TO DFHEIV11
 10166*    MOVE '8$D    CT       H L F ,   #00009140' TO DFHEIV0
 10167     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10168     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10169     MOVE X'2020233030303039313430' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0,
 10171           EL677A,
 10172           EL677AO,
 10173           DFHEIV12,
 10174           MAPSET-NAME,
 10175           DFHEIV99,
 10176           DFHEIV99,
 10177           DFHEIV99,
 10178           DFHEIV11,
 10179           DFHEIV99,
 10180           DFHEIV99,
 10181           DFHEIV99
 10182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10183
 10184
 10185     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 189
* EL677.cbl
 10187 8300-SEND-TEXT.
 10188
 10189* EXEC CICS SEND TEXT
 10190*        FROM     (LOGOFF-TEXT)
 10191*        LENGTH   (LOGOFF-LENGTH)
 10192*        ERASE
 10193*        FREEKB
 10194*    END-EXEC.
 10195*    MOVE '8&      T  E F  H   F -   #00009151' TO DFHEIV0
 10196     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10197     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10198     MOVE X'2020233030303039313531' TO DFHEIV0(25:11)
 10199     CALL 'kxdfhei1' USING DFHEIV0,
 10200           LOGOFF-TEXT,
 10201           LOGOFF-LENGTH,
 10202           DFHEIV99,
 10203           DFHEIV99,
 10204           DFHEIV99,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99,
 10208           DFHEIV99,
 10209           DFHEIV99,
 10210           DFHEIV99,
 10211           DFHEIV99
 10212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10213
 10214
 10215
 10216* EXEC CICS RETURN
 10217*    END-EXEC.
 10218*    MOVE '.(                    ''   #00009158' TO DFHEIV0
 10219     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10221     MOVE X'2020233030303039313538' TO DFHEIV0(25:11)
 10222     CALL 'kxdfhei1' USING DFHEIV0,
 10223           DFHEIV99,
 10224           DFHEIV99,
 10225           DFHEIV99,
 10226           DFHEIV99,
 10227           DFHEIV99,
 10228           DFHEIV99
 10229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10230
 10231
 10232 8500-DATE-CONVERT.
 10233     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10234
 10235
 10236* EXEC CICS LINK
 10237*        PROGRAM    (PGM-NAME)
 10238*        COMMAREA   (DATE-CONVERSION-DATA)
 10239*        LENGTH     (DC-COMM-LENGTH)
 10240*    END-EXEC.
 10241*    MOVE '."C                   (   #00009164' TO DFHEIV0
 10242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10244     MOVE X'2020233030303039313634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 190
* EL677.cbl
 10245     CALL 'kxdfhei1' USING DFHEIV0,
 10246           PGM-NAME,
 10247           DATE-CONVERSION-DATA,
 10248           DC-COMM-LENGTH,
 10249           DFHEIV99,
 10250           DFHEIV99,
 10251           DFHEIV99,
 10252           DFHEIV99
 10253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10254
 10255
 10256 8500-EXIT.
 10257      EXIT.
 10258
 10259 8600-DEEDIT.
 10260
 10261* EXEC CICS BIF DEEDIT
 10262*        FIELD   (WS-DEEDIT-FIELD)
 10263*        LENGTH  (10)
 10264*    END-EXEC.
 10265     MOVE 10
 10266       TO DFHEIV11
 10267*    MOVE '@"L                   #   #00009174' TO DFHEIV0
 10268     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10269     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10270     MOVE X'2020233030303039313734' TO DFHEIV0(25:11)
 10271     CALL 'kxdfhei1' USING DFHEIV0,
 10272           WS-DEEDIT-FIELD,
 10273           DFHEIV11
 10274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10275
 10276
 10277 8600-EXIT.
 10278      EXIT.
 10279
 10280 8700-DEEDIT.
 10281
 10282* EXEC CICS BIF DEEDIT
 10283*        FIELD   (WS-DT-DEEDIT-FIELD)
 10284*        LENGTH  (10)
 10285*    END-EXEC.
 10286     MOVE 10
 10287       TO DFHEIV11
 10288*    MOVE '@"L                   #   #00009183' TO DFHEIV0
 10289     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10291     MOVE X'2020233030303039313833' TO DFHEIV0(25:11)
 10292     CALL 'kxdfhei1' USING DFHEIV0,
 10293           WS-DT-DEEDIT-FIELD,
 10294           DFHEIV11
 10295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10296
 10297
 10298 8700-EXIT.
 10299      EXIT.
 10300
 10301 8800-UNAUTHORIZED-ACCESS.
 10302     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 191
* EL677.cbl
 10303     GO TO 8300-SEND-TEXT.
 10304
 10305 8810-PF23.
 10306     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10307     MOVE XCTL-005               TO  PGM-NAME.
 10308     GO TO 9300-XCTL.
 10309
 10310
 10311 9100-RETURN-TRAN.
 10312     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10313     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10314
 10315* EXEC CICS RETURN
 10316*        TRANSID  (TRANS-ID)
 10317*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10318*        LENGTH   (PI-COMM-LENGTH)
 10319*    END-EXEC.
 10320*    MOVE '.(CT                  ''   #00009204' TO DFHEIV0
 10321     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10323     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
 10324     CALL 'kxdfhei1' USING DFHEIV0,
 10325           TRANS-ID,
 10326           PROGRAM-INTERFACE-BLOCK,
 10327           PI-COMM-LENGTH,
 10328           DFHEIV99,
 10329           DFHEIV99,
 10330           DFHEIV99
 10331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10332
 10333
 10334
 10335* GOBACK.
 10336     MOVE '9%                    "   ' TO DFHEIV0
 10337     MOVE 'EL677' TO DFHEIV1
 10338     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10339     GOBACK.
 10340
 10341 9200-RETURN-MAIN-MENU.
 10342     MOVE XCTL-626               TO  PGM-NAME.
 10343     GO TO 9300-XCTL.
 10344
 10345 9300-XCTL.
 10346
 10347* EXEC CICS XCTL
 10348*        PROGRAM    (PGM-NAME)
 10349*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10350*        LENGTH     (PI-COMM-LENGTH)
 10351*    END-EXEC.
 10352*    MOVE '.$C                   %   #00009217' TO DFHEIV0
 10353     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10354     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10355     MOVE X'2020233030303039323137' TO DFHEIV0(25:11)
 10356     CALL 'kxdfhei1' USING DFHEIV0,
 10357           PGM-NAME,
 10358           PROGRAM-INTERFACE-BLOCK,
 10359           PI-COMM-LENGTH,
 10360           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 192
* EL677.cbl
 10361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10362
 10363
 10364 9400-CLEAR.
 10365     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10366     MOVE SPACES                 TO  PI-PFKEY.
 10367     GO TO 9300-XCTL.
 10368
 10369 9500-PF12.
 10370     MOVE XCTL-010               TO  PGM-NAME.
 10371     GO TO 9300-XCTL.
 10372
 10373 9600-PGMID-ERROR.
 10374
 10375* EXEC CICS HANDLE CONDITION
 10376*        PGMIDERR    (8300-SEND-TEXT)
 10377*    END-EXEC.
 10378*    MOVE '"$L                   ! 4 #00009233' TO DFHEIV0
 10379     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10381     MOVE X'3420233030303039323333' TO DFHEIV0(25:11)
 10382     CALL 'kxdfhei1' USING DFHEIV0
 10383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10384
 10385
 10386     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10387     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10388     MOVE XCTL-005               TO  PGM-NAME.
 10389     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10390     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10391
 10392     GO TO 9300-XCTL.
 10393
 10394 9900-ERROR-FORMAT.
 10395     IF NOT EMI-ERRORS-COMPLETE
 10396         MOVE LINK-001           TO  PGM-NAME
 10397
 10398* EXEC CICS LINK
 10399*            PROGRAM    (PGM-NAME)
 10400*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10401*            LENGTH     (EMI-COMM-LENGTH)
 10402*        END-EXEC.
 10403*    MOVE '."C                   (   #00009248' TO DFHEIV0
 10404     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10406     MOVE X'2020233030303039323438' TO DFHEIV0(25:11)
 10407     CALL 'kxdfhei1' USING DFHEIV0,
 10408           PGM-NAME,
 10409           ERROR-MESSAGE-INTERFACE-BLOCK,
 10410           EMI-COMM-LENGTH,
 10411           DFHEIV99,
 10412           DFHEIV99,
 10413           DFHEIV99,
 10414           DFHEIV99
 10415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10416
 10417
 10418 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 193
* EL677.cbl
 10419      EXIT.
 10420
 10421 9990-ABEND.
 10422     MOVE LINK-004               TO  PGM-NAME.
 10423     MOVE DFHEIBLK               TO  EMI-LINE1.
 10424
 10425* EXEC CICS LINK
 10426*        PROGRAM   (PGM-NAME)
 10427*        COMMAREA  (EMI-LINE1)
 10428*        LENGTH    (72)
 10429*    END-EXEC.
 10430     MOVE 72
 10431       TO DFHEIV11
 10432*    MOVE '."C                   (   #00009260' TO DFHEIV0
 10433     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10435     MOVE X'2020233030303039323630' TO DFHEIV0(25:11)
 10436     CALL 'kxdfhei1' USING DFHEIV0,
 10437           PGM-NAME,
 10438           EMI-LINE1,
 10439           DFHEIV11,
 10440           DFHEIV99,
 10441           DFHEIV99,
 10442           DFHEIV99,
 10443           DFHEIV99
 10444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10445
 10446
 10447     GO TO 8200-SEND-DATAONLY.
 10448
 10449 9995-SECURITY-VIOLATION.
 10450*                            COPY ELCSCTP.
 10451******************************************************************
 10452*                                                                *
 10453*                            ELCSCTP                             *
 10454*                            VMOD=2.001                          *
 10455*                                                                *
 10456*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10457******************************************************************
 10458
 10459
 10460     MOVE EIBDATE          TO SM-JUL-DATE.
 10461     MOVE EIBTRMID         TO SM-TERMID.
 10462     MOVE THIS-PGM         TO SM-PGM.
 10463     MOVE EIBTIME          TO TIME-IN.
 10464     MOVE TIME-OUT         TO SM-TIME.
 10465     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10466
 10467
 10468* EXEC CICS LINK
 10469*         PROGRAM  ('EL003')
 10470*         COMMAREA (SECURITY-MESSAGE)
 10471*         LENGTH   (80)
 10472*    END-EXEC.
 10473     MOVE 'EL003' TO DFHEIV1
 10474     MOVE 80
 10475       TO DFHEIV11
 10476*    MOVE '."C                   (   #00009286' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 194
* EL677.cbl
 10477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10479     MOVE X'2020233030303039323836' TO DFHEIV0(25:11)
 10480     CALL 'kxdfhei1' USING DFHEIV0,
 10481           DFHEIV1,
 10482           SECURITY-MESSAGE,
 10483           DFHEIV11,
 10484           DFHEIV99,
 10485           DFHEIV99,
 10486           DFHEIV99,
 10487           DFHEIV99
 10488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10489
 10490
 10491******************************************************************
 10492
 10493
 10494 9995-EXIT.
 10495     EXIT.
 10496
 10497
 10498 9999-DFHBACK SECTION.
 10499     MOVE '9%                    "   ' TO DFHEIV0
 10500     MOVE 'EL677' TO DFHEIV1
 10501     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10502     GOBACK.
 10503 9999-DFHEXIT.
 10504     IF DFHEIGDJ EQUAL 0001
 10505         NEXT SENTENCE
 10506     ELSE IF DFHEIGDJ EQUAL 2
 10507         GO TO 9600-PGMID-ERROR,
 10508               9990-ABEND
 10509         DEPENDING ON DFHEIGDI
 10510     ELSE IF DFHEIGDJ EQUAL 3
 10511         GO TO 8100-SEND-INITIAL-MAP
 10512         DEPENDING ON DFHEIGDI
 10513     ELSE IF DFHEIGDJ EQUAL 4
 10514         GO TO 1290-NO-CARRIER
 10515         DEPENDING ON DFHEIGDI
 10516     ELSE IF DFHEIGDJ EQUAL 5
 10517         GO TO 1380-NO-STATE
 10518         DEPENDING ON DFHEIGDI
 10519     ELSE IF DFHEIGDJ EQUAL 6
 10520         GO TO 1480-ACCOUNT-INVALID,
 10521               1480-ACCOUNT-INVALID
 10522         DEPENDING ON DFHEIGDI
 10523     ELSE IF DFHEIGDJ EQUAL 7
 10524         GO TO 1590-EXIT
 10525         DEPENDING ON DFHEIGDI
 10526     ELSE IF DFHEIGDJ EQUAL 8
 10527         GO TO 2200-DUPREC
 10528         DEPENDING ON DFHEIGDI
 10529     ELSE IF DFHEIGDJ EQUAL 9
 10530         GO TO 2577-DUPREC
 10531         DEPENDING ON DFHEIGDI
 10532     ELSE IF DFHEIGDJ EQUAL 10
 10533         GO TO 2600-NO-CO-MASTER
 10534         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 18-Oct-16 13:27 Page 195
* EL677.cbl
 10535     ELSE IF DFHEIGDJ EQUAL 11
 10536         GO TO 3900-RECORD-NOTFND
 10537         DEPENDING ON DFHEIGDI
 10538     ELSE IF DFHEIGDJ EQUAL 12
 10539         GO TO 3287-DUPREC
 10540         DEPENDING ON DFHEIGDI
 10541     ELSE IF DFHEIGDJ EQUAL 13
 10542         GO TO 3390-EXIT,
 10543               3390-EXIT
 10544         DEPENDING ON DFHEIGDI
 10545     ELSE IF DFHEIGDJ EQUAL 14
 10546         GO TO 5560-END-OF-FILE,
 10547               5560-END-OF-FILE
 10548         DEPENDING ON DFHEIGDI
 10549     ELSE IF DFHEIGDJ EQUAL 15
 10550         GO TO 6070-NO-COMP-MSTR
 10551         DEPENDING ON DFHEIGDI
 10552     ELSE IF DFHEIGDJ EQUAL 16
 10553         GO TO 6170-NO-CERTIFICATE
 10554         DEPENDING ON DFHEIGDI
 10555     ELSE IF DFHEIGDJ EQUAL 17
 10556         GO TO 6470-NO-ADDRESS
 10557         DEPENDING ON DFHEIGDI
 10558     ELSE IF DFHEIGDJ EQUAL 18
 10559         GO TO 6670-NO-beneficiary
 10560         DEPENDING ON DFHEIGDI
 10561     ELSE IF DFHEIGDJ EQUAL 19
 10562         GO TO 7300-EXIT
 10563         DEPENDING ON DFHEIGDI
 10564     ELSE IF DFHEIGDJ EQUAL 20
 10565         GO TO 8300-SEND-TEXT
 10566         DEPENDING ON DFHEIGDI.
 10567     MOVE '9%                    "   ' TO DFHEIV0
 10568     MOVE 'EL677' TO DFHEIV1
 10569     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10570     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142324     Code:       39537
