* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53******************************************************************
    54 ENVIRONMENT DIVISION.
    55
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   3
* EL050.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER   PIC X(32) VALUE '********************************'.
    62 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    63 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    64
    65 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    66 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    67                                   USAGE POINTER.
    68 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    69 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    71                                   USAGE IS POINTER.
    72 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    74                                   USAGE IS POINTER.
    75 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83*    COPY ELC50WS.
    84*****************************************************************
    85*                                                               *
    86*                            ELC50WS.                           *
    87*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    88*                            VMOD=2.061.                        *
    89*                                                               *
    90*   THIS IS THE WORKING STORAGE FOR EL050                       *
    91*                                   EL517                       *
    92*****************************************************************
    93******************************************************************
    94*                   C H A N G E   L O G
    95*
    96* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    97*-----------------------------------------------------------------
    98*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    99* EFFECTIVE    NUMBER
   100*-----------------------------------------------------------------
   101* 123102                   PEMA  ADD DCC PROCESSING
   102* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   103* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   104* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   105* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   106* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   107* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   108* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   109* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   110* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   111* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   112* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   113* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   114* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   115* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   4
* EL050.cbl
   116* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   117* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   118* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   119* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   120* 030309  CR2009021700001  PEMA  ADD ER-2883
   121* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   122* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   124* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   125* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   126* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   127* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   128* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   129* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   130* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   131* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   132* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   133* 061412  CR2011022800001  AJRA  NAPERSOFT
   134* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   135* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   136* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   137* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   138* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   139* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   140* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   141* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   142* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   143* 091114  IR2014091000001  TANA  ADD ERROR 2898
   144*-----------------------------------------------------------------
   145
   146 01  WORK-AREAS.
   147
   148*****************************************************************
   149*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   150*****************************************************************
   151
   152     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   153     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-NAME-EDIT-WORK-AREA.
   156         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   157         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   158             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   159         16  WS-WORK-NAME.
   160             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   161             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   162             20  FILLER           PIC X(10)     VALUE SPACES.
   163         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   164             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   165
   166*****************************************************************
   167*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   168*****************************************************************
   169
   170     12  WS-ERRESC-KEY.
   171         16 WS-ERRESC-SEARCH-KEY.
   172             20  WS-ERRESC-COMPANY-CD PIC  X.
   173             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   5
* EL050.cbl
   174             20  WS-ERRESC-GROUP      PIC X(6).
   175             20  WS-ERRESC-STATE      PIC XX.
   176             20  WS-ERRESC-ACCOUNT    PIC X(10).
   177         16 WS-ERRESC-RESIDUAL-KEY.
   178             20  WS-ERRESC-AGENT      PIC X(10).
   179             20  WS-ERRESC-RES-STATE  PIC XX.
   180             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   181*                                          YYYYMMDD
   182     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   183     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   184
   185*RESIDENT STATE TAX MASTER(ERRESS)
   186*
   187     12  WS-ERRESS-KEY.
   188         16  WS-ERRESS-COMPANY-CD      PIC  X.
   189         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   190         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   191         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   192*                                          YYYYMMDD
   193
   194     12  WS-CONTRACT-DATE              PIC 9(8).
   195*                                          YYYYMMDD
   196     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   197     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   198         16 WS-YEAR-YY                 PIC   9999.
   199         16 FILLER                     PIC 9(4).
   200*                                          YYYYMMDD
   201     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   202     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   203     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   204     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   205
   206     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   207         88  DPRB-1ST-TIME                      VALUE ' '.
   208
   209*****************************************************************
   210*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   211*****************************************************************
   212
   213     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   214     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   215     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   216     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   219     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   220     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   221     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   222     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   223     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   224         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   225         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   226     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   228         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   229     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   230
   231     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   6
* EL050.cbl
   232     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   233
   234     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   235     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   248     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   249     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   270     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   271     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   272     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   273     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   282     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   283     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   284     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   285     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   286     12  WS-2671-SW               PIC X         VALUE SPACE.
   287     12  WS-2672-SW               PIC X         VALUE SPACE.
   288     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   289         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   7
* EL050.cbl
   290     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   291         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   292     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   293
   294     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   295         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   296         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   297         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   298         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   299
   300     12  WS-CREDIT-EDIT-CONTROLS.
   301         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   302         16  WS-MIN-AGE           PIC 99                VALUE  0.
   303         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   304         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   305         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   306         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   307
   308     12  WS-AGE-FIELDS.
   309         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   310         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   311         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   313
   314     12  WS-SAVE-ALLOWABLE-BENEFIT.
   315         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   316         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   317         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   318         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   319         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   320         16  FILLER                      PIC XX.
   321
   322     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   323     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   324     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   325     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   326     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   327     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   328     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   329     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   330     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   331     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   332
   333     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   334     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   335     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   336     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   337     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   338     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   339     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   340     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   341         88  WS-REDUCING              VALUE 'R'.
   342         88  WS-LEVEL                 VALUE 'L' 'P'.
   343     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   344
   345     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   8
* EL050.cbl
   348     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   349     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   350     12  ws-ah-max-bens           pic 99        value zeros.
   351     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   352     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   353     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   354     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   355
   356     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   357     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   358     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   359     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   360     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   361     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   364     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   365     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   366     12  WS-ACCT-SIG-SW.
   367         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   368         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   369     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   371     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   373     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   376     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-INITIALS.
   379         16  WS-INIT-1            PIC X         VALUE SPACES.
   380         16  WS-INIT-2            PIC X         VALUE SPACES.
   381
   382     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   383     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   384     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   385     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   386     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   387*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   388     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   389     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   390     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   395     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   396     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   398     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   399     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   400     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   402     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   404     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   405     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page   9
* EL050.cbl
   406     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   407     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410******** FLA
   411     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   412     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   413     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   415     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   416********
   417     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   418     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   419     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   421     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   422     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   423     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   424     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   425     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   426     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   427
   428     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   429         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   430                                         '0' THRU '9'.
   431
   432     12  NUMBER-OF-MONTHS.
   433         16  SK-MO OCCURS 12 TIMES PIC X.
   434
   435     12  WS-WORK-DATE.
   436         16  WS-YEAR            PIC 99    VALUE 00.
   437         16  WS-MONTH           PIC 99    VALUE 00.
   438         16  WS-DAY             PIC 99    VALUE 00.
   439
   440     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   441     12  WS-WORK-CRIT-DEV       REDEFINES
   442         WS-WORK-LF-CRIT-PER    PIC X(03).
   443
   444     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   445     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   446
   447     12  WS-WORK-DATE-FROM.
   448         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   449         16  FILLER             PIC X  VALUE SPACE.
   450         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X         VALUE SPACE.
   452         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   453
   454     12  WS-WORK-DATE-THRU.
   455         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   456         16  FILLER             PIC X         VALUE SPACE.
   457         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   460
   461     12  WS-LF-INPUT-CD.
   462         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   463         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  10
* EL050.cbl
   464
   465     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   466     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   467         16  WS-AH-INPUT-CD-1   PIC X.
   468         16  WS-AH-INPUT-CD-2-3 PIC XX.
   469
   470     12  WS-SWITCHES.
   471         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   472         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   473             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   474         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   475             88  BANK-ACCT-FOUND          VALUE 'Y'.
   476         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   477             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   478         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   479             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   480         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   481             88  COMP-MASTER-FOUND        VALUE 'Y'.
   482         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   484         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   486         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   487             88  STAT-MASTER-FOUND        VALUE 'Y'.
   488         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   489             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   491             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   492         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   493             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   495             88  FORM-MASTER-FOUND        VALUE 'Y'.
   496         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   497             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   498         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   499             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   501             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   502         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   503             88  NO-BENEFIT-FOUND         VALUE 'N'.
   504         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   505             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   506         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   508         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   509             88  AH-BENEFIT-FOUND         VALUE ' '.
   510             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   511         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  LF-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   514         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   515             88  NO-STATE-RECORD          VALUE '1'.
   516         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   517             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   518         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   519             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   521             88  CERT-WAS-FOUND           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  11
* EL050.cbl
   522             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   523         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   524             88  BROWSE-STARTED           VALUE 'Y'.
   525         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   526             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   527         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   528             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   529         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   530             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   531         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   532             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   533         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   536             88  APP-CERT-USED            VALUE 'Y' 'A'.
   537         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   538             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   539             88  FIRST-TIME-THROUGH       VALUE '1'.
   540             88  CTBL-NOT-FOUND           VALUE '2'.
   541
   542         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   543             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   544
   545         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   546             88  DLO-ERROR-FOUND          VALUE 'Y'.
   547
   548********FLA
   549     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   550     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   551********
   552     12  RC-SW-1                  PIC X           VALUE '0'.
   553     12  RC-SW-2                  PIC X           VALUE '0'.
   554     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   555     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   556     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   557     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   558     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   564     12  LIT-SPACES               PIC X           VALUE SPACES.
   565     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   566     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   567     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   568     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   569     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   570     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   571     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   572         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   573         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   574     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   575         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   576
   577 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   578     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   579     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  12
* EL050.cbl
   580 01  WS-CRI-SSN-WORK-AREA.
   581     05  WS-CRI-SOC-SEC-NO.
   582         10  WS-SS-REPT-CD       PIC X(5).
   583         10  WS-SS-LAST-NAME     PIC X(5).
   584         10  WS-SS-INITIAL       PIC X.
   585
   586     05  WS-CRI-REPORT-CODE.
   587         10  FILLER              PIC X(5).
   588         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   589
   590     05  WS-CRI-LAST-NAME.
   591         10  WS-CRI-NAME-MOVE    PIC X(5).
   592         10  FILLER              PIC X(10).
   593
   594 01  WS-NUM-TABLE                PIC X(26)  VALUE
   595     '12345678012345070923456789'.
   596 01  FILLER REDEFINES WS-NUM-TABLE.
   597     05  WS-NUM OCCURS 26        PIC 9.
   598 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   599 01  V1                          PIC S999 COMP-3.
   600 01  V2                          PIC S999 COMP-3.
   601 01  V3                          PIC S999 COMP-3.
   602 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   603 01  FILLER REDEFINES WS-WORK-VIN.
   604     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   605 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   606 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   607 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   608 01  WS-HEX-WORK.
   609     05  FILLER                  PIC X  VALUE LOW-VALUES.
   610     05  WS-HEX-BYTE             PIC X.
   611 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   612 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   613 01  WS-WORK-HIN-ROW-B.
   614     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   615
   616 01  ws-benefit-cd-chg-sw      pic x value spaces.
   617     88  benefit-code-chg           value 'Y'.
   618 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   619 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   620     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   621 01  WS-ROW-D-TABLE.
   622     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   623
   624 01  WS-HIN-TABLE-B.
   625     05  F                       PIC XX VALUE 'A2'.
   626     05  F                       PIC XX VALUE 'B3'.
   627     05  F                       PIC XX VALUE 'C4'.
   628     05  F                       PIC XX VALUE 'D5'.
   629     05  F                       PIC XX VALUE 'E6'.
   630     05  F                       PIC XX VALUE 'F7'.
   631     05  F                       PIC XX VALUE 'G8'.
   632     05  F                       PIC XX VALUE 'H9'.
   633     05  F                       PIC XX VALUE 'I1'.
   634     05  F                       PIC XX VALUE 'J2'.
   635     05  F                       PIC XX VALUE 'K3'.
   636     05  F                       PIC XX VALUE 'L4'.
   637     05  F                       PIC XX VALUE 'M5'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  13
* EL050.cbl
   638     05  F                       PIC XX VALUE 'N6'.
   639     05  F                       PIC XX VALUE 'O0'.
   640     05  F                       PIC XX VALUE 'P7'.
   641     05  F                       PIC XX VALUE 'Q0'.
   642     05  F                       PIC XX VALUE 'R8'.
   643     05  F                       PIC XX VALUE 'S9'.
   644     05  F                       PIC XX VALUE 'T2'.
   645     05  F                       PIC XX VALUE 'U3'.
   646     05  F                       PIC XX VALUE 'V4'.
   647     05  F                       PIC XX VALUE 'W5'.
   648     05  F                       PIC XX VALUE 'X6'.
   649     05  F                       PIC XX VALUE 'Y7'.
   650     05  F                       PIC XX VALUE 'Z8'.
   651 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   652     05  WS-VAL-IN               PIC X.
   653     05  WS-VAL-OUT              PIC 9.
   654 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   655 01  WS-COMPARE-BINARY-DATES.
   656     05  WS-971231                PIC XX VALUE X'92FF'.
   657     05  WS-931231                PIC XX VALUE X'8CFF'.
   658     05  WS-791231                PIC XX VALUE X'77FF'.
   659     05  WS-771001                PIC XX VALUE X'74A1'.
   660     05  WS-820301                PIC XX VALUE X'7B41'.
   661     05  WS-831031                PIC XX VALUE X'7DBF'.
   662     05  WS-831231                PIC XX VALUE X'7DFF'.
   663     05  WS-810831                PIC XX VALUE X'7A7F'.
   664     05  WS-830901                PIC XX VALUE X'7D81'.
   665
   666 01  FILE-ACCESS-IDS.
   667     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   668     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   669     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   670     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   671     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   672     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   673     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   674     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   675     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   676     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   677     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   678     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   679     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   680     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   681     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   682     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   683     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   684 01  DD-IU-SW                    PIC X   VALUE ' '.
   685     88  DD-IU-PRESENT                 VALUE 'Y'.
   686
   687 01  ACCESS-KEYS.
   688     12  ELMSTR-KEY.
   689         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   690         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   691     12  W-CLAIM-KEY.
   692         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   694
   695     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  14
* EL050.cbl
   696         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   697         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   698         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   699         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   700
   701     12  ELCERT-KEY.
   702         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  CERT-CARRIER         PIC X       VALUE SPACE.
   704         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   705         16  CERT-STATE           PIC XX      VALUE SPACES.
   706         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   707         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   708         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   709
   710     12  ELCERT2-KEY.
   711         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   712         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   713
   714     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   715
   716     12  ELCERT-SAVE.
   717         16  FILLER                      PIC XX    VALUE SPACES.
   718
   719         16  WCS-CONTROL-PRIMARY.
   720             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   721             20  WCS-CARRIER             PIC X     VALUE SPACE.
   722             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   723             20  WCS-STATE               PIC XX    VALUE SPACES.
   724             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   725             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   726             20  WCS-CERT-NO.
   727                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   728                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   729
   730         16  CS-CONTROL-BY-NAME.
   731             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   732             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   733             20  CS-INSURED-INITIALS.
   734                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   735                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-SSN.
   738             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   739             20  CS-SOC-SEC-NO.
   740                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   741                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   742                 24  CS-SSN-LN3.
   743                     28 CS-INSURED-INITIALS-A2   PIC XX
   744                                     VALUE SPACES.
   745                     28 CS-PART-LAST-NAME-A2     PIC X
   746                                     VALUE SPACE.
   747
   748         16  CS-CONTROL-BY-CERT-NO.
   749             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   750             20  CS-CERT-NO-A4           PIC X(11)
   751                                     VALUE SPACES.
   752
   753         16  CS-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  15
* EL050.cbl
   754             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   755             20  CS-MEMBER-NO.
   756                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   757                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   758                 24  CS-MEMB-LN4.
   759                     28 CS-INSURED-INITIALS-A5   PIC XX
   760                                      VALUE SPACES.
   761                     28 CS-PART-LAST-NAME-A5     PIC XX
   762                                      VALUE SPACES.
   763
   764         16  FILLER              PIC X(360) VALUE SPACES.
   765
   766     12  ERACCT-KEY.
   767         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   768         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   769         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   770         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   771         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   772         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   773
   774     12  ERCOMP-KEY.
   775         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  COMP-CARRIER         PIC X     VALUE SPACES.
   777         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   778         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   779         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   780         16  COMP-TYPE            PIC X     VALUE SPACES.
   781
   782     12  ERLOFC-KEY.
   783         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   784         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   785         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   786         16  LOFC-STATE           PIC XX    VALUE SPACES.
   787         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   788         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   789
   790     12  WS-ELCRTT-KEY.
   791         16  WS-ELCRTT-PRIMARY       PIC X(33).
   792         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   793
   794     12  ERBXRF-KEY.
   795         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   797         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   798         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   799
   800     12  ERAGTC-KEY.
   801         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   803         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   804         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   805         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   806         16  AGTC-TYPE            PIC X     VALUE SPACES.
   807
   808     12  ERPLAN-KEY.
   809         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   811         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  16
* EL050.cbl
   812         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   813         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   814         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   815         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   816         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   817
   818     12  ERFORM-KEY.
   819         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   821         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   822         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   823
   824     12  ERREIN-KEY.
   825         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   826         16  REIN-TYPE            PIC X     VALUE SPACES.
   827         16  REIN-TABLE-CO.
   828             20  REIN-CODE-1      PIC X     VALUE SPACE.
   829             20  REIN-CODE-2      PIC X     VALUE SPACE.
   830             20  REIN-CODE-3      PIC X     VALUE SPACE.
   831         16  FILLER               PIC X(3)  VALUE SPACES.
   832
   833     12  ERCTBL-KEY.
   834         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   835         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   836         16  CTBL-CNTRL-2.
   837             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   838             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   839
   840     12  ELCRTO-KEY.
   841         16  ELCRTO-COMPANY-CD       PIC X.
   842         16  ELCRTO-CARRIER          PIC X.
   843         16  ELCRTO-GROUPING         PIC X(6).
   844         16  ELCRTO-STATE            PIC XX.
   845         16  ELCRTO-ACCOUNT          PIC X(10).
   846         16  ELCRTO-CERT-EFF-DT      PIC XX.
   847         16  ELCRTO-CERT-NO.
   848             20  ELCRTO-CERT-PRIME   PIC X(10).
   849             20  ELCRTO-CERT-SFX     PIC X.
   850         16  ELCRTO-RECORD-TYPE      PIC X.
   851         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   852
   853
   854     12  WS-ACCESS.
   855         16  FILLER               PIC XX    VALUE SPACES.
   856         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   857
   858     12  WS-CARR-ACCESS.
   859         16  FILLER               PIC X(3)  VALUE SPACES.
   860         16  WS-CARR              PIC X     VALUE SPACE.
   861*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   862*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   863     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   864         88  WS-DMD-LF-RATING   VALUE 'Y'.
   865         88  WS-DMD-AH-RATING   VALUE 'Y'.
   866         88  WS-DMD-NO-RATING   VALUE 'N'.
   867
   868     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   869         88  WS-LF-CASH            VALUE 'MJ' 'MS'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  17
* EL050.cbl
   870                                         'NJ' 'NL'
   871                                         'PJ' 'PL'
   872                                         'SJ' 'SL'.
   873     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   874         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   875                                         'NI' 'NJ' 'NL' 'NU'
   876                                         'PJ' 'PL' 'PI' 'PU'
   877                                         'SI' 'SJ' 'SL' 'SU'
   878                                         'MX' 'MY' 'MZ'.
   879 01  ERPDEF-KEY-SAVE             PIC X(18).
   880 01  ERPDEF-KEY.
   881     12  ERPDEF-COMPANY-CD       PIC X.
   882     12  ERPDEF-STATE            PIC XX.
   883     12  ERPDEF-PROD-CD          PIC XXX.
   884     12  F                       PIC X(7).
   885     12  ERPDEF-BEN-TYPE         PIC X.
   886     12  ERPDEF-BEN-CODE         PIC XX.
   887     12  ERPDEF-EXP-DT           PIC XX.
   888
   889 01  ELSTAT-KEY-SAVE             PIC X(20).
   890 01  ELSTAT-KEY.
   891     12  ELSTAT-COMPANY-ID       PIC XXX.
   892     12  ELSTAT-CARRIER          PIC X.
   893     12  ELSTAT-GROUP            PIC X(6).
   894     12  ELSTAT-STATE            PIC XX.
   895     12  ELSTAT-EXP-DT           PIC 9(8).
   896 01  WS-ERROR-VALUES.
   897     12  ER-1570                     PIC S9(4)   VALUE +1570.
   898     12  ER-1571                     PIC S9(4)   VALUE +1571.
   899     12  er-1572                     pic s9(4)   value +1572.
   900     12  er-1573                     pic s9(4)   value +1573.
   901     12  er-1574                     pic s9(4)   value +1574.
   902     12  ER-1575                     PIC S9(4)   VALUE +1575.
   903     12  er-1576                     pic s9(4)   value +1576.
   904     12  ER-1891                     PIC S9(4)   VALUE +1891.
   905     12  ER-1892                     PIC S9(4)   VALUE +1892.
   906     12  ER-1893                     PIC S9(4)   VALUE +1893.
   907     12  ER-1894                     PIC S9(4)   VALUE +1894.
   908     12  ER-1895                     PIC S9(4)   VALUE +1895.
   909     12  ER-1896                     PIC S9(4)   VALUE +1896.
   910     12  ER-1897                     PIC S9(4)   VALUE +1897.
   911     12  ER-1898                     PIC S9(4)   VALUE +1898.
   912     12  ER-1899                     PIC S9(4)   VALUE +1899.
   913     12  ER-1900                     PIC S9(4)   VALUE +1900.
   914     12  ER-1901                     PIC S9(4)   VALUE +1901.
   915     12  ER-1902                     PIC S9(4)   VALUE +1902.
   916     12  ER-1903                     PIC S9(4)   VALUE +1903.
   917     12  ER-1904                     PIC S9(4)   VALUE +1904.
   918     12  ER-1905                     PIC S9(4)   VALUE +1905.
   919     12  ER-1906                     PIC S9(4)   VALUE +1906.
   920     12  ER-1907                     PIC S9(4)   VALUE +1907.
   921     12  ER-1909                     PIC S9(4)   VALUE +1909.
   922     12  ER-1910                     PIC S9(4)   VALUE +1910.
   923     12  ER-1911                     PIC S9(4)   VALUE +1911.
   924     12  ER-1912                     PIC S9(4)   VALUE +1912.
   925     12  ER-1913                     PIC S9(4)   VALUE +1913.
   926     12  ER-1914                     PIC S9(4)   VALUE +1914.
   927     12  ER-1915                     PIC S9(4)   VALUE +1915.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  18
* EL050.cbl
   928     12  ER-1916                     PIC S9(4)   VALUE +1916.
   929     12  ER-1917                     PIC S9(4)   VALUE +1917.
   930     12  ER-1918                     PIC S9(4)   VALUE +1918.
   931     12  ER-1919                     PIC S9(4)   VALUE +1919.
   932     12  ER-1920                     PIC S9(4)   VALUE +1920.
   933     12  ER-1921                     PIC S9(4)   VALUE +1921.
   934     12  ER-1922                     PIC S9(4)   VALUE +1922.
   935     12  ER-1923                     PIC S9(4)   VALUE +1923.
   936     12  ER-1924                     PIC S9(4)   VALUE +1924.
   937     12  ER-1925                     PIC S9(4)   VALUE +1925.
   938     12  ER-1926                     PIC S9(4)   VALUE +1926.
   939     12  ER-1927                     PIC S9(4)   VALUE +1927.
   940     12  ER-2393                     PIC S9(4)   VALUE +2393.
   941     12  ER-2600                     PIC S9(4)   VALUE +2600.
   942     12  ER-2601                     PIC S9(4)   VALUE +2601.
   943     12  ER-2602                     PIC S9(4)   VALUE +2602.
   944     12  ER-2603                     PIC S9(4)   VALUE +2603.
   945     12  ER-2604                     PIC S9(4)   VALUE +2604.
   946     12  ER-2605                     PIC S9(4)   VALUE +2605.
   947     12  ER-2606                     PIC S9(4)   VALUE +2606.
   948     12  ER-2607                     PIC S9(4)   VALUE +2607.
   949     12  ER-2608                     PIC S9(4)   VALUE +2608.
   950     12  ER-2609                     PIC S9(4)   VALUE +2609.
   951     12  ER-2610                     PIC S9(4)   VALUE +2610.
   952     12  ER-2611                     PIC S9(4)   VALUE +2611.
   953     12  ER-2612                     PIC S9(4)   VALUE +2612.
   954     12  ER-2613                     PIC S9(4)   VALUE +2613.
   955     12  ER-2614                     PIC S9(4)   VALUE +2614.
   956     12  ER-2615                     PIC S9(4)   VALUE +2615.
   957     12  ER-2616                     PIC S9(4)   VALUE +2616.
   958     12  ER-2617                     PIC S9(4)   VALUE +2617.
   959     12  ER-2618                     PIC S9(4)   VALUE +2618.
   960     12  ER-2619                     PIC S9(4)   VALUE +2619.
   961     12  ER-2620                     PIC S9(4)   VALUE +2620.
   962     12  ER-2621                     PIC S9(4)   VALUE +2621.
   963     12  ER-2622                     PIC S9(4)   VALUE +2622.
   964     12  ER-2623                     PIC S9(4)   VALUE +2623.
   965     12  ER-2624                     PIC S9(4)   VALUE +2624.
   966     12  ER-2625                     PIC S9(4)   VALUE +2625.
   967     12  ER-2626                     PIC S9(4)   VALUE +2626.
   968     12  ER-2627                     PIC S9(4)   VALUE +2627.
   969     12  ER-2628                     PIC S9(4)   VALUE +2628.
   970     12  ER-2629                     PIC S9(4)   VALUE +2629.
   971     12  ER-2630                     PIC S9(4)   VALUE +2630.
   972     12  ER-2631                     PIC S9(4)   VALUE +2631.
   973     12  ER-2632                     PIC S9(4)   VALUE +2632.
   974     12  ER-2633                     PIC S9(4)   VALUE +2633.
   975     12  ER-2634                     PIC S9(4)   VALUE +2634.
   976     12  ER-2635                     PIC S9(4)   VALUE +2635.
   977     12  ER-2636                     PIC S9(4)   VALUE +2636.
   978     12  ER-2637                     PIC S9(4)   VALUE +2637.
   979     12  ER-2638                     PIC S9(4)   VALUE +2638.
   980     12  ER-2639                     PIC S9(4)   VALUE +2639.
   981     12  ER-2640                     PIC S9(4)   VALUE +2640.
   982     12  ER-2641                     PIC S9(4)   VALUE +2641.
   983     12  ER-2642                     PIC S9(4)   VALUE +2642.
   984     12  ER-2643                     PIC S9(4)   VALUE +2643.
   985     12  ER-2644                     PIC S9(4)   VALUE +2644.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  19
* EL050.cbl
   986     12  ER-2645                     PIC S9(4)   VALUE +2645.
   987     12  ER-2646                     PIC S9(4)   VALUE +2646.
   988     12  ER-2647                     PIC S9(4)   VALUE +2647.
   989     12  ER-2648                     PIC S9(4)   VALUE +2648.
   990     12  ER-2649                     PIC S9(4)   VALUE +2649.
   991     12  ER-2650                     PIC S9(4)   VALUE +2650.
   992     12  ER-2651                     PIC S9(4)   VALUE +2651.
   993     12  ER-2652                     PIC S9(4)   VALUE +2652.
   994     12  ER-2653                     PIC S9(4)   VALUE +2653.
   995     12  ER-2654                     PIC S9(4)   VALUE +2654.
   996     12  ER-2655                     PIC S9(4)   VALUE +2655.
   997     12  ER-2656                     PIC S9(4)   VALUE +2656.
   998     12  ER-2657                     PIC S9(4)   VALUE +2657.
   999     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1000     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1001     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1002     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1003     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1004     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1005     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1006     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1007     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1008     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1009     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1010     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1011     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1012     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1013     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1014     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1015     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1016     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1017     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1018     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1019     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1020     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1021     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1022     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1023     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1024     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1025     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1026     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1027     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1028     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1029     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1030     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1031     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1032     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1033     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1034     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1035     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1036     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1037     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1038     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1039     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1040     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1041     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1042     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1043     12  ER-2702                     PIC S9(4)   VALUE +2702.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  20
* EL050.cbl
  1044     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1045     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1046     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1047     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1048     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1049     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1050     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1051     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1052     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1053     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1054     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1055     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1056     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1057     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1058     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1059     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1060     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1061     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1062     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1063     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1064     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1065     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1066     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1067     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1068     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1069     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1070     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1071     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1072     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1073     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1074     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1075     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1076     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1077     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1078     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1079     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1080     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1081     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1082     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1083     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1084     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1085     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1086     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1087     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1088     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1089     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1090     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1091     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1092     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1093     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1094     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1095     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1096     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1097     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1098     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1099     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1100     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1101     12  ER-2770                     PIC S9(4)   VALUE +2770.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  21
* EL050.cbl
  1102     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1103     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1104     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1105     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1106     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1107     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1108     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1109     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1110     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1111     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1112     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1113     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1114     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1115     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1116     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1117     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1118     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1119     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1120     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1121     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1122     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1123     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1124     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1125     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1126     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1127     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1128     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1129     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1130     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1131     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1132     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1133     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1134     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1135     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1136     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1137     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1138     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1139     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1140     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1141     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1142     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1143     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1144     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1145     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1146     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1147     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1148     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1149     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1150     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1151     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1152     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1153     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1154     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1155     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1156     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1157     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1158     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1159     12  ER-3825                     PIC S9(4)   VALUE +3825.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  22
* EL050.cbl
  1160     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1161     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1162     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1163     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1164     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1165     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1166     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1167     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1168     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1169     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1170     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1171     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1172     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1173     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1174     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1175     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1176     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1177     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1178     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1179     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1180     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1181     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1182     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1183     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1184     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1185     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1186     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1187     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1188     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1189     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1190     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1191     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1192     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1193     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1194     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1195     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1196     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1197     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1198     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1199     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1200     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1201     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1202     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1203     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1204     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1205     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1206     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1207     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1208     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1209     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1210     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1211     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1212     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1213     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1214     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1215     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1216     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1217     12  ER-8098                     PIC S9(4)   VALUE +8098.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  23
* EL050.cbl
  1218     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1219     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1220     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1221     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1222     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1223     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1224     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1225     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1226     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1227     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1228     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1229     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1230     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1231     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1232     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1233     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1234     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1235     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1236     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1237     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1238     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1239     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1240     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1241     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1242     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1243     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1244     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1245     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1246******************************************************************
  1247***************   END OF ELC50WS     ****************************
  1248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  24
* EL050.cbl
  1251 01  WORKING-STORAGE-WORK-AREAS.
  1252     12  WS-RESPONSE             PIC S9(8)  COMP.
  1253         88  WS-RESP-NORMAL           VALUE +00.
  1254         88  WS-RESP-ERROR            VALUE +01.
  1255         88  WS-RESP-NOTFND           VALUE +13.
  1256         88  WS-RESP-DUPREC           VALUE +14.
  1257         88  WS-RESP-ENDFILE          VALUE +20.
  1258     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1259     12  WORK-AREAS.
  1260         16  WK-CONV-GREG.
  1261             24  WCG-CENT             PIC XX.
  1262             24  WCG-REST             PIC X(4).
  1263         16  WORK-GREGORIAN-DATE.
  1264             24  WK-GREG-CENT         PIC XX.
  1265             24  WK-GREG-DATE-YYMMDD.
  1266                 28  WK-GREG-YYMM     PIC X(4).
  1267                 28  WK-GREG-DD       PIC XX.
  1268
  1269         16  WORK-SELECT-DATE.
  1270             24  WK-SELECT-CENT            PIC XX.
  1271             24  WK-SELECT-DATE-YYMMDD.
  1272                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1273                 28  FILLER                PIC XX.
  1274
  1275         16  WK-FORM-NO.
  1276             24  WK-FORM-BANK-ID       PIC X(5).
  1277             24  WK-FORM-UNDRWRTR      PIC X(1).
  1278             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1279
  1280         16  WK-MEMBER-NO.
  1281             24  WK-MEMBER-1-6        PIC X(6).
  1282             24  WK-MEMBER-7-12       PIC X(6).
  1283
  1284         16  WK-FULL-CERT-NO.
  1285             24  WK-CERT-POS-1-2      PIC X(2).
  1286             24  WK-CERT-POS-3        PIC X(1).
  1287             24  WK-CERT-POS-4        PIC X(1).
  1288             24  WK-CERT-POS-5-6      PIC X(2).
  1289             24  WK-CERT-POS-7        PIC X(1).
  1290             24  WK-CERT-POS-8-11     PIC X(4).
  1291
  1292         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1293             88  VALID-RATE-CODE        VALUE 'Y'.
  1294             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1295
  1296         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1297         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1298         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1299         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1300         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1301         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1302         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1303         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1304         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1305         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1306
  1307* DLO001
  1308 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  25
* EL050.cbl
  1309     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1310     12  DMPF-RETURN-CODE          PIC XX.
  1311         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1312         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1313         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1314         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1315         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1316         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1317
  1318* DLO002
  1319 01  WS-DLO-INTERNAL-POLICY-FORM.
  1320     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1321     12  DIPF-RETURN-CODE          PIC XX.
  1322         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1324         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1325         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1326         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1327         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1328
  1329* DLO003
  1330 01  WS-DLO-VALID-BANK-ID.
  1331     12  DVBI-BANK-ID              PIC X(5).
  1332     12  DVBI-BANK-ID-TYPE         PIC X.
  1333         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1334         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1335         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1336         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1337         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1338     12  DVBI-RETURN-CODE          PIC XX.
  1339         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1340         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1341         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1342         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1343         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1344         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1345         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1346         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1347         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1348
  1349* DLO007
  1350 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1351     12  DCUA-RES-STATE            PIC XX.
  1352     12  DCUA-BEN-TYPE             PIC XX.
  1353     12  DCUA-SYS-IDENT            PIC X.
  1354         88  DCUA-CLAIM                        VALUE 'C'.
  1355         88  DCUA-PREMIUM                      VALUE 'P'.
  1356     12  DCUA-COVERAGE-RULE        PIC X.
  1357     12  DCUA-CLIENT-ID            PIC X(10).
  1358     12  DCUA-EFF-DATE             PIC X(8).
  1359     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1360     12  DCUA-RETURN-CODE          PIC XX.
  1361         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1362     12  DCUA-CERT-NUMBER          PIC X(11).
  1363     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1364     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1365
  1366* DLO011
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  26
* EL050.cbl
  1367 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1368     12  DPRB-RATE-CODE            PIC X(4).
  1369     12  DPRB-COVERAGE-CATEG       PIC X.
  1370     12  DPRB-RETURN-CODE          PIC XX.
  1371         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1372         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1373         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1374         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1375         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1376         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1377         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1378         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1379         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1380     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1381     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1382     12  DPRB-BEN-TYPE             PIC XX.
  1383
  1384* DLO017
  1385 01  WS-DLO-VALID-RATE-CODE.
  1386     12  DVRC-RATE-CODE            PIC X(4).
  1387     12  DVRC-RETURN-CODE          PIC XX.
  1388         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1389         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1390         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1391         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1392         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1393         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394
  1395* DLO019
  1396 01  WS-DLO-ORIG-COV-CAT.
  1397     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1398     12  DOCC-RETURN-CODE          PIC XX.
  1399     12  DOCC-ORIG-COV-CAT         PIC X.
  1400     12  DOCC-UNDERWITER           PIC XX.
  1401     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1402     12  DOCC-FILLER               PIC X(6).
  1403
  1404* DLO021
  1405 01  WS-DLO-VALID-LOAN-OFFICER.
  1406     12  DVLO-LOAN-OFFICER.
  1407         16  DVLO-BILL-TYPE        PIC X.
  1408         16  DVLO-BILL-SOURCE      PIC X.
  1409         16  DVLO-BATCH-TYPE       PIC X.
  1410     12  DVLO-RETURN-CODE          PIC XX.
  1411         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1412         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1413         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1414         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1415         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1416         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1417
  1418* DLO022
  1419 01  WS-DLO-VALID-STATE-CODE.
  1420     12  DVSC-STATE-CODE           PIC XX.
  1421     12  DVSC-RETURN-CODE          PIC XX.
  1422         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1423
  1424* DLO023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  27
* EL050.cbl
  1425 01  WS-DLO-VALID-CODE-VALUES.
  1426     12  DVCV-SYSTEM-ID            PIC XX.
  1427         88  DVCV-CLAIMS                       VALUE 'CL'.
  1428         88  DVCV-CREDIT                       VALUE 'CR'.
  1429     12  DVCV-RECORD-TYPE          PIC XX.
  1430         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1431         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1432         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1433         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1434         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1435         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1436         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1437         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1438     12  DVCV-RECORD-KEY           PIC X(6).
  1439     12  DVCV-RETURN-CODE          PIC XX.
  1440         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1441         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1442         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1443         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1444         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1445         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1446         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1447     12  DVCV-CODE-DESC            PIC X(60).
  1448     12  DVCV-GEN-DESC-1           PIC X(20).
  1449     12  DVCV-GEN-DESC-2           PIC X(20).
  1450     12  DVCV-GEN-DESC-3           PIC X(20).
  1451
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  28
* EL050.cbl
  1453*    COPY ERCBXRF.
  1454******************************************************************
  1455*                                                                *
  1456*                                                                *
  1457*                            ERCBXRF                             *
  1458*                                                                *
  1459*   ONLINE CREDIT SYSTEM                                         *
  1460*                                                                *
  1461*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1462*                                                                *
  1463*   FILE TYPE = VSAM,KSDS                                        *
  1464*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1465*                                                                *
  1466*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1467*       ALTERNATE PATH = NONE                                    *
  1468*                                                                *
  1469*   LOG = NO                                                     *
  1470*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1471*                                                                *
  1472******************************************************************
  1473
  1474 01  BANK-CROSS-REFERENCE.
  1475     12  BK-RECORD-ID                PIC XX.
  1476         88  VALID-BK-ID             VALUE 'BK'.
  1477
  1478     12  BK-CONTROL-PRIMARY.
  1479         16  BK-COMPANY-CD           PIC X.
  1480         16  BK-CARRIER              PIC X.
  1481         16  BK-GROUPING             PIC X(6).
  1482         16  BK-BANK-NO              PIC X(10).
  1483
  1484     12  BK-MAINT-INFORMATION.
  1485         16  BK-LAST-MAINT-DT        PIC XX.
  1486         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1487         16  BK-LAST-MAINT-USER      PIC X(4).
  1488         16  FILLER                  PIC X(9).
  1489
  1490     12  FILLER                      PIC X(37).
  1491
  1492     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1493
  1494     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1495                            DEPENDING ON BK-BANK-POINTER-CNT.
  1496         16  BK-AM-ACCOUNT           PIC X(10).
  1497         16  BK-AM-EXP-DT            PIC XX.
  1498         16  BK-AM-EFF-DT            PIC XX.
  1499         16  BK-AM-STATE             PIC XX.
  1500         16  FILLER                  PIC X(20).
  1501
  1502******************************************************************
  1503
  1504*    COPY ERCCOMP.
  1505******************************************************************
  1506*                                                                *
  1507*                                                                *
  1508*                            ERCCOMP                             *
  1509*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1510*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  29
* EL050.cbl
  1511*                                                                *
  1512*   ONLINE CREDIT SYSTEM                                         *
  1513*                                                                *
  1514*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1515*                                                                *
  1516*   FILE TYPE = VSAM,KSDS                                        *
  1517*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1518*                                                                *
  1519*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1520*       ALTERNATE PATH = NONE                                    *
  1521*                                                                *
  1522*   LOG = NO                                                     *
  1523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1524*                                                                *
  1525******************************************************************
  1526*                   C H A N G E   L O G
  1527*
  1528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1529*-----------------------------------------------------------------
  1530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1531* EFFECTIVE    NUMBER
  1532*-----------------------------------------------------------------
  1533* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1534* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1535* 092205    2005050300006  PEMA  ADD LEASE FEE
  1536* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1537* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1538* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1539* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1540* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1541* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1542******************************************************************
  1543
  1544 01  COMPENSATION-MASTER.
  1545     12  CO-RECORD-ID                          PIC XX.
  1546         88  VALID-CO-ID                          VALUE 'CO'.
  1547
  1548     12  CO-CONTROL-PRIMARY.
  1549         16  CO-COMPANY-CD                     PIC X.
  1550         16  CO-CONTROL.
  1551             20  CO-CTL-1.
  1552                 24  CO-CARR-GROUP.
  1553                     28  CO-CARRIER            PIC X.
  1554                     28  CO-GROUPING.
  1555                         32  CO-GROUP-PREFIX   PIC XXX.
  1556                         32  CO-GROUP-PRIME    PIC XXX.
  1557                 24  CO-RESP-NO.
  1558                     28  CO-RESP-PREFIX        PIC X(4).
  1559                     28  CO-RESP-PRIME         PIC X(6).
  1560             20  CO-CTL-2.
  1561                 24  CO-ACCOUNT.
  1562                     28  CO-ACCT-PREFIX        PIC X(4).
  1563                     28  CO-ACCT-PRIME         PIC X(6).
  1564         16  CO-TYPE                           PIC X.
  1565             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1566             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1567             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1568
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  30
* EL050.cbl
  1569     12  CO-MAINT-INFORMATION.
  1570         16  CO-LAST-MAINT-DT                  PIC XX.
  1571         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1572         16  CO-LAST-MAINT-USER                PIC X(4).
  1573     12  FILLER                                PIC XX.
  1574     12  CO-STMT-TYPE                          PIC XXX.
  1575     12  CO-COMP-TYPE                          PIC X.
  1576         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1577     12  CO-STMT-OWNER                         PIC X(4).
  1578     12  CO-BALANCE-CONTROL                    PIC X.
  1579         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1580         88  CO-NO-BALANCE                        VALUE 'N'.
  1581
  1582     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1583         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1584         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1585         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1586
  1587     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1588         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1589         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1590
  1591     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1592     12  CO-GA-DIRECT-DEP                      PIC X.
  1593     12  CO-FUTURE-SPACE                       PIC X.
  1594         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1595
  1596     12  CO-ACCT-NAME                          PIC X(30).
  1597     12  CO-MAIL-NAME                          PIC X(30).
  1598     12  CO-ADDR-1                             PIC X(30).
  1599     12  CO-ADDR-2                             PIC X(30).
  1600     12  CO-ADDR-3.
  1601         16  CO-ADDR-CITY                      PIC X(27).
  1602         16  CO-ADDR-STATE                     PIC XX.
  1603     12  CO-CSO-1099                           PIC X.
  1604     12  CO-ZIP.
  1605         16  CO-ZIP-PRIME.
  1606             20  CO-ZIP-PRI-1ST                PIC X.
  1607                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1608             20  FILLER                        PIC X(4).
  1609         16  CO-ZIP-PLUS4                      PIC X(4).
  1610     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1611         16  CO-CAN-POSTAL-1                   PIC XXX.
  1612         16  CO-CAN-POSTAL-2                   PIC XXX.
  1613         16  FILLER                            PIC XXX.
  1614     12  CO-SOC-SEC                            PIC X(13).
  1615     12  CO-TELEPHONE.
  1616         16  CO-AREA-CODE                      PIC XXX.
  1617         16  CO-PREFIX                         PIC XXX.
  1618         16  CO-PHONE                          PIC X(4).
  1619
  1620     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1621
  1622     12  CO-AR-BAL-LEVEL                       PIC X.
  1623         88  CO-AR-REF-LVL                        VALUE '1'.
  1624         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1625         88  CO-AR-BILL-LVL                       VALUE '2'.
  1626         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  31
* EL050.cbl
  1627         88  CO-AR-FR-LVL                         VALUE '4'.
  1628
  1629     12  CO-AR-NORMAL-PRINT                    PIC X.
  1630         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1631         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1632
  1633     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1634
  1635     12  CO-AR-REPORTING                       PIC X.
  1636         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1637         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1638
  1639     12  CO-AR-PULL-CHECK                      PIC X.
  1640         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1641         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1642
  1643     12  CO-AR-BALANCE-PRINT                   PIC X.
  1644         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1645
  1646     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1647         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1648         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1649         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1650
  1651     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1652
  1653     12  CO-USER-CODE                          PIC X.
  1654     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1655
  1656******************************************************************
  1657*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1658*    THE LAST MONTH END RUN.
  1659******************************************************************
  1660
  1661     12  CO-LAST-ACTIVITY-DATE.
  1662         16  CO-ACT-YEAR                       PIC 99.
  1663         16  CO-ACT-MONTH                      PIC 99.
  1664         16  CO-ACT-DAY                        PIC 99.
  1665
  1666     12  CO-LAST-STMT-DT.
  1667         16  CO-LAST-STMT-YEAR                 PIC 99.
  1668         16  CO-LAST-STMT-MONTH                PIC 99.
  1669         16  CO-LAST-STMT-DAY                  PIC 99.
  1670
  1671     12  CO-MO-END-TOTALS.
  1672         16  CO-MONTHLY-TOTALS.
  1673             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1674             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1675             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1676             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1677             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1678
  1679         16  CO-AGING-TOTALS.
  1680             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1681             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1682             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1683             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1684
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  32
* EL050.cbl
  1685         16  CO-YTD-TOTALS.
  1686             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1687             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1688
  1689         16  CO-OVER-UNDER-TOTALS.
  1690             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1691             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1692
  1693     12  CO-MISCELLANEOUS-TOTALS.
  1694         16  CO-FICA-TOTALS.
  1695             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1696             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1697
  1698         16  CO-CLAIM-TOTALS.
  1699             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1700             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1701
  1702******************************************************************
  1703*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1704*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1705******************************************************************
  1706
  1707     12  CO-CURRENT-TOTALS.
  1708         16  CO-CURRENT-LAST-STMT-DT.
  1709             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1710             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1711             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1712
  1713         16  CO-CURRENT-MONTHLY-TOTALS.
  1714             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1716             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1717             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1718             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CURRENT-AGING-TOTALS.
  1721             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1722             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1723             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1724             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1725
  1726         16  CO-CURRENT-YTD-TOTALS.
  1727             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1728             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1729
  1730     12  CO-PAID-COMM-TOTALS.
  1731         16  CO-YTD-PAID-COMMS.
  1732             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1733             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1734
  1735     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1736         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1737         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1738
  1739     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1740         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1741         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1742         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  33
* EL050.cbl
  1743         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1744         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1745         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1746         88  CO-FINAL-LETTER                  VALUE 'F'.
  1747         88  CO-RECONCILING                   VALUE 'R'.
  1748         88  CO-PHONE-CALL                    VALUE 'P'.
  1749         88  CO-LEGAL                         VALUE 'L'.
  1750         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1751         88  CO-WRITE-OFF                     VALUE 'W'.
  1752         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1753
  1754     12  CO-CSR-CODE                       PIC X(4).
  1755
  1756     12  CO-GA-STATUS-INFO.
  1757         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1758         16  CO-GA-TERMINATION-DT          PIC XX.
  1759         16  CO-GA-STATUS-CODE             PIC X.
  1760             88  CO-GA-ACTIVE                 VALUE 'A'.
  1761             88  CO-GA-INACTIVE               VALUE 'I'.
  1762             88  CO-GA-PENDING                VALUE 'P'.
  1763         16  CO-GA-COMMENTS.
  1764             20  CO-GA-COMMENT-1           PIC X(40).
  1765             20  CO-GA-COMMENT-2           PIC X(40).
  1766             20  CO-GA-COMMENT-3           PIC X(40).
  1767             20  CO-GA-COMMENT-4           PIC X(40).
  1768
  1769     12  CO-RPTCD2                         PIC X(10).
  1770     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1771         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1772         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1773
  1774     12  CO-TYPE-AGENT                     PIC X(01).
  1775         88  CO-CORPORATION                   VALUE 'C'.
  1776         88  CO-PARTNERSHIP                   VALUE 'P'.
  1777         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1778         88  CO-TRUST                         VALUE 'T'.
  1779         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1780
  1781     12  CO-FAXNO.
  1782         16  CO-FAX-AREA-CODE                  PIC XXX.
  1783         16  CO-FAX-PREFIX                     PIC XXX.
  1784         16  CO-FAX-PHONE                      PIC X(4).
  1785
  1786     12  CO-BANK-INFORMATION.
  1787         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1788         16  CO-BANK-TRANSIT-NON REDEFINES
  1789             CO-BANK-TRANSIT-NO                PIC 9(8).
  1790
  1791         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1792     12  CO-MISC-DEDUCT-INFO REDEFINES
  1793                  CO-BANK-INFORMATION.
  1794         16  CO-MD-GL-ACCT                     PIC X(10).
  1795         16  CO-MD-DIV                         PIC XX.
  1796         16  CO-MD-CENTER                      PIC X(4).
  1797         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1798         16  CO-CREATE-AP-CHECK                PIC X.
  1799         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1800         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  34
* EL050.cbl
  1801     12  CO-ACH-STATUS                         PIC X.
  1802         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1803         88  CO-ACH-PENDING                        VALUE 'P'.
  1804
  1805     12  CO-BILL-SW                            PIC X.
  1806     12  CO-CONTROL-NAME                       PIC X(30).
  1807     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1808     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1809     12  CO-CLP-STATE                          PIC XX.
  1810     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1811     12  CO-SPP-REFUND-EDIT                    PIC X.
  1812
  1813******************************************************************
  1814
  1815*    COPY ERCAGTC.
  1816******************************************************************
  1817*                                                                *
  1818*                                                                *
  1819*                            ERCAGTC                             *
  1820*                            VMOD=2.001                          *
  1821*                                                                *
  1822*   ONLINE CREDIT SYSTEM                                         *
  1823*                                                                *
  1824*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1825*                                                                *
  1826*   FILE TYPE = VSAM,KSDS                                        *
  1827*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1828*                                                                *
  1829*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1830*       ALTERNATE PATH = NONE                                    *
  1831*                                                                *
  1832*   LOG = NO                                                     *
  1833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1834*                                                                *
  1835******************************************************************
  1836*                   C H A N G E   L O G
  1837*
  1838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1839*-----------------------------------------------------------------
  1840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1841* EFFECTIVE    NUMBER
  1842*-----------------------------------------------------------------
  1843* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1844* 111004                         NEW FILE AND COPYBOOK
  1845* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1846******************************************************************
  1847 01  AGENT-COMMISSIONS.
  1848     12  AG-RECORD-ID                          PIC XX.
  1849         88  VALID-CO-ID                          VALUE 'AG'.
  1850     12  AG-CONTROL-PRIMARY.
  1851         16  AG-COMPANY-CD                     PIC X.
  1852         16  AG-CONTROL.
  1853             20  AG-CTL-1.
  1854                 24  AG-CARR-GROUP.
  1855                     28  AG-CARRIER            PIC X.
  1856                     28  AG-GROUPING           PIC X(6).
  1857                 24  AG-BANK                   PIC X(10).
  1858             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  35
* EL050.cbl
  1859                 24  AG-EXP-DT                 PIC XX.
  1860         16  AG-TYPE                           PIC X.
  1861             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1862             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1863     12  AG-MAINT-INFORMATION.
  1864         16  AG-LAST-MAINT-DT                  PIC XX.
  1865         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1866         16  AG-LAST-MAINT-USER                PIC X(4).
  1867         16  FILLER                            PIC X(10).
  1868     12  AG-EFF-DT                             PIC XX.
  1869     12  AG-COMM-STRUCTURE.
  1870         16  AG-AGT-COMMS OCCURS 10.
  1871             20  AG-AGT                PIC X(10).
  1872             20  AG-COM-TYP            PIC X.
  1873             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1874             20  AG-RECALC-LV-INDIC    PIC X.
  1875             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1876             20  AG-LRCALC-LV-INDIC    PIC X.
  1877             20  FILLER                PIC X(05).
  1878     12  FILLER                  PIC X(145).
  1879******************************************************************
  1880*    COPY ERCRESS.
  1881******************************************************************
  1882*                                                                *
  1883*                            ERCRESS                             *
  1884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1885*                            VMOD=2.002                          *
  1886*                                                                *
  1887*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1888*                                                                *
  1889*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1890*   VSAM RESIDENT STATE TAX MASTER                              *
  1891*                                                                *
  1892*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1893*                                                                *
  1894*   FILE TYPE = VSAM,KSDS                                        *
  1895*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1896*                                                                *
  1897*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1898*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1899*                                                                *
  1900*   LOG = NO                                                     *
  1901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1902*                                                                *
  1903*                                                                *
  1904******************************************************************
  1905
  1906 01  RESIDENT-STATE-TAX-MASTER.
  1907
  1908     10  ERRESS-PRIMARY-KEY.
  1909         15  RES-COMPANY-CD        PIC X.
  1910         15  RES-RESIDENT-STATE    PIC XX.
  1911         15  RES-COVERAGE-CATEGORY PIC X.
  1912         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1913*                                      YYYYMMDD
  1914*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1915
  1916     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  36
* EL050.cbl
  1917
  1918         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1919         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1920         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1921         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1922
  1923     10 RES-RECALC-SW              PIC   X.
  1924         88 RECALC                VALUE 'Y'.
  1925         88 NO-RECALC             VALUE 'N'.
  1926     10  RES-MAINT-BY              PIC X(4).
  1927     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1928     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1929*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  37
* EL050.cbl
  1931*    COPY ERCRESC.
  1932******************************************************************
  1933*                                                                *
  1934*                            ERCRESC                             *
  1935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1936*                            VMOD=2.003                          *
  1937*                                                                *
  1938*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1939*                                                                *
  1940*   FILE TYPE = VSAM,KSDS                                        *
  1941*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1942*                                                                *
  1943*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1944*       ALTERNATE PATH1 = NONE                                   *
  1945*                                                                *
  1946*   LOG = NO                                                     *
  1947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1948*                                                                *
  1949******************************************************************
  1950
  1951 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1952
  1953     10  ERRESC-RECORD-KEY.
  1954         15  RESC-COMPANY-CD           PIC   X.
  1955         15  RESC-CARRIER              PIC   X.
  1956         15  RESC-GROUP                PIC   X(6).
  1957         15  RESC-STATE                PIC   XX.
  1958         15  RESC-ACCOUNT              PIC   X(10).
  1959         15  RESC-AGENT                PIC   X(10).
  1960         15  RESC-RESIDENT-STATE       PIC   XX.
  1961         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1962*                                           YYYYMMDD
  1963     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1964
  1965     10  RESC-COMM-RECORD-DATA.
  1966         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1967             20 RESC-COVERAGE-CAT      PIC    X.
  1968             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1969             20 RESC-COMMISSION-TAB REDEFINES
  1970                RESC-COMMISSION-PER    PIC  XXX.
  1971
  1972     10  RESC-MAINT-BY                 PIC X(4).
  1973     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1974     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1975*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  38
* EL050.cbl
  1977*    COPY ERCPLAN.
  1978******************************************************************
  1979*                                                                *
  1980*                                                                *
  1981*                            ERCPLAN                             *
  1982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1983*                            VMOD=2.003                          *
  1984*                                                                *
  1985*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1986*                                                                *
  1987*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1988*   PLAN MASTER                                                  *
  1989*                                                                *
  1990*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1991*                                                                *
  1992*   FILE TYPE = VSAM,KSDS                                        *
  1993*   RECORD SIZE = 420   RECFORM = FIX                            *
  1994*                                                                *
  1995*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1996*       ALTERNATE PATH1 = N/A                                    *
  1997*                                                                *
  1998*   LOG = NO                                                     *
  1999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2000*                                                                *
  2001*                                                                *
  2002******************************************************************
  2003
  2004 01  PLAN-MASTER.
  2005     12  PL-RECORD-ID                      PIC XX.
  2006         88  VALID-PL-ID                      VALUE 'PL'.
  2007
  2008     12  PL-CONTROL-PRIMARY.
  2009         16  PL-COMPANY-CD                 PIC X.
  2010         16  PL-MSTR-CNTRL.
  2011             20  PL-CONTROL-A.
  2012                 24  PL-CARRIER            PIC X.
  2013                 24  PL-GROUPING           PIC X(6).
  2014                 24  PL-STATE              PIC XX.
  2015                 24  PL-ACCOUNT            PIC X(10).
  2016             20  PL-BENEFIT-TYPE           PIC X.
  2017             20  PL-BENEFIT-CODE           PIC XX.
  2018             20  PL-REVISION-NO            PIC X(3).
  2019
  2020     12  PL-CONTROL-BY-VAR-GRP.
  2021         16  PL-COMPANY-CD-A1              PIC X.
  2022         16  PL-VG-CARRIER                 PIC X.
  2023         16  PL-VG-GROUPING                PIC X(6).
  2024         16  PL-VG-STATE                   PIC XX.
  2025         16  PL-VG-ACCOUNT                 PIC X(10).
  2026         16  PL-BENEFIT-TYPE-A1            PIC X.
  2027         16  PL-BENEFIT-CODE-A1            PIC XX.
  2028         16  PL-REVISION-NO-A1             PIC 999.
  2029
  2030     12  PL-MAINT-INFORMATION.
  2031         16  PL-LAST-MAINT-DT              PIC XX.
  2032         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2033         16  PL-LAST-MAINT-USER            PIC X(4).
  2034         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  39
* EL050.cbl
  2035
  2036     12  PL-LIABILITY-LIMITS.
  2037         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2038         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2039             20  PL-LM-AGE                 PIC S99        COMP-3.
  2040             20  PL-LM-DUR                 PIC S999       COMP-3.
  2041             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2042             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2043
  2044     12  FILLER                            PIC X(30).
  2045
  2046     12  PL-GL-ACCOUNT-NOS.
  2047         16  PL-PREMIUM-GL                 PIC X(8).
  2048         16  PL-COMM-GL                    PIC X(8).
  2049         16  PL-CLAIM-GL                   PIC X(8).
  2050     12  FILLER                            PIC X(24).
  2051     12  PL-TOLERANCES.
  2052         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2053         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2054         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2055         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2056         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2057         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2058     12  PL-OVER-SHORT.
  2059         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2060         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2061     12  FILLER                            PIC X(24).
  2062     12  PLAN-MISC.
  2063         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2064         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2065         16  PL-IG                         PIC X.
  2066         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2067         16  PL-POLICY-FORM                PIC X(12).
  2068         16  PL-EDIT-FOR-FORM              PIC X(01).
  2069         16  PL-DEV-CODE                   PIC XXX.
  2070         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2071         16  PL-CALC-METHOD                PIC X.
  2072         16  PL-BENEFIT-GROUP              PIC X(05).
  2073         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2074
  2075         16  FILLER                        PIC X(99).
  2076******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  40
* EL050.cbl
  2078*    COPY ELCCERT.
  2079******************************************************************
  2080*                                                                *
  2081*                            ELCCERT.                            *
  2082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2083*                            VMOD=2.013                          *
  2084*                                                                *
  2085*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2086*                                                                *
  2087*   FILE TYPE = VSAM,KSDS                                        *
  2088*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2089*                                                                *
  2090*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2091*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2092*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2093*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2094*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2095*                                                                *
  2096*   LOG = YES                                                    *
  2097*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2098******************************************************************
  2099*                   C H A N G E   L O G
  2100*
  2101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2102*-----------------------------------------------------------------
  2103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2104* EFFECTIVE    NUMBER
  2105*-----------------------------------------------------------------
  2106* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2108* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2109* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2110* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2111* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2113* 032612  CR2011110200001  PEMA  AHL CHANGES
  2114* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2115******************************************************************
  2116
  2117 01  CERTIFICATE-MASTER.
  2118     12  CM-RECORD-ID                      PIC XX.
  2119         88  VALID-CM-ID                      VALUE 'CM'.
  2120
  2121     12  CM-CONTROL-PRIMARY.
  2122         16  CM-COMPANY-CD                 PIC X.
  2123         16  CM-CARRIER                    PIC X.
  2124         16  CM-GROUPING.
  2125             20  CM-GROUPING-PREFIX        PIC X(3).
  2126             20  CM-GROUPING-PRIME         PIC X(3).
  2127         16  CM-STATE                      PIC XX.
  2128         16  CM-ACCOUNT.
  2129             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2130             20  CM-ACCOUNT-PRIME          PIC X(6).
  2131         16  CM-CERT-EFF-DT                PIC XX.
  2132         16  CM-CERT-NO.
  2133             20  CM-CERT-PRIME             PIC X(10).
  2134             20  CM-CERT-SFX               PIC X.
  2135
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  41
* EL050.cbl
  2136     12  CM-CONTROL-BY-NAME.
  2137         16  CM-COMPANY-CD-A1              PIC X.
  2138         16  CM-INSURED-LAST-NAME          PIC X(15).
  2139         16  CM-INSURED-INITIALS.
  2140             20  CM-INSURED-INITIAL1       PIC X.
  2141             20  CM-INSURED-INITIAL2       PIC X.
  2142
  2143     12  CM-CONTROL-BY-SSN.
  2144         16  CM-COMPANY-CD-A2              PIC X.
  2145         16  CM-SOC-SEC-NO.
  2146             20  CM-SSN-STATE              PIC XX.
  2147             20  CM-SSN-ACCOUNT            PIC X(6).
  2148             20  CM-SSN-LN3.
  2149                 25  CM-INSURED-INITIALS-A2.
  2150                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2151                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2152                 25 CM-PART-LAST-NAME-A2         PIC X.
  2153
  2154     12  CM-CONTROL-BY-CERT-NO.
  2155         16  CM-COMPANY-CD-A4              PIC X.
  2156         16  CM-CERT-NO-A4                 PIC X(11).
  2157
  2158     12  CM-CONTROL-BY-MEMB.
  2159         16  CM-COMPANY-CD-A5              PIC X.
  2160         16  CM-MEMBER-NO.
  2161             20  CM-MEMB-STATE             PIC XX.
  2162             20  CM-MEMB-ACCOUNT           PIC X(6).
  2163             20  CM-MEMB-LN4.
  2164                 25  CM-INSURED-INITIALS-A5.
  2165                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2166                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2167                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2168
  2169     12  CM-INSURED-PROFILE-DATA.
  2170         16  CM-INSURED-FIRST-NAME.
  2171             20  CM-INSURED-1ST-INIT       PIC X.
  2172             20  FILLER                    PIC X(9).
  2173         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2174         16  CM-INSURED-SEX                PIC X.
  2175             88  CM-SEX-MALE                  VALUE 'M'.
  2176             88  CM-SEX-FEMAL                 VALUE 'F'.
  2177         16  CM-INSURED-JOINT-AGE          PIC 99.
  2178         16  CM-JOINT-INSURED-NAME.
  2179             20  CM-JT-LAST-NAME           PIC X(15).
  2180             20  CM-JT-FIRST-NAME.
  2181                 24  CM-JT-1ST-INIT        PIC X.
  2182                 24  FILLER                PIC X(9).
  2183             20  CM-JT-INITIAL             PIC X.
  2184
  2185     12  CM-LIFE-DATA.
  2186         16  CM-LF-BENEFIT-CD              PIC XX.
  2187         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2188         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2189         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2190         16  CM-LF-DEV-CODE                PIC XXX.
  2191         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2192         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2193         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  42
* EL050.cbl
  2194         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2195         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2197         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2198         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2199         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2200         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2201         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2202         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2203         16  cm-temp-epiq                  pic xx.
  2204             88  EPIQ-CLASS                  value 'EQ'.
  2205*        16  FILLER                        PIC XX.
  2206
  2207     12  CM-AH-DATA.
  2208         16  CM-AH-BENEFIT-CD              PIC XX.
  2209         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-AH-DEV-CODE                PIC XXX.
  2212         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2213         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2214         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2215         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2217         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2218         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2219         16  CM-AH-PAID-THRU-DT            PIC XX.
  2220             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2221         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2222         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2223         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2224         16  FILLER                        PIC X.
  2225
  2226     12  CM-LOAN-INFORMATION.
  2227         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2228         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2229                                           PIC S9(5)V99  COMP-3.
  2230         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2231         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2232         16  CM-PAY-FREQUENCY              PIC S99.
  2233         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2234         16  CM-RATE-CLASS                 PIC XX.
  2235         16  CM-BENEFICIARY                PIC X(25).
  2236         16  CM-POLICY-FORM-NO             PIC X(12).
  2237         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2238         16  CM-LAST-ADD-ON-DT             PIC XX.
  2239         16  CM-DEDUCTIBLE-AMOUNTS.
  2240             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2241             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2242         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2243             20  CM-RESIDENT-STATE         PIC XX.
  2244             20  CM-RATE-CODE              PIC X(4).
  2245             20  FILLER                    PIC XX.
  2246         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2247             20  CM-LOAN-OFFICER           PIC X(5).
  2248             20  FILLER                    PIC XXX.
  2249         16  CM-CSR-CODE                   PIC XXX.
  2250         16  CM-UNDERWRITING-CODE          PIC X.
  2251             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  43
* EL050.cbl
  2252         16  CM-POST-CARD-IND              PIC X.
  2253         16  CM-NH-INTERFACE-SW            PIC X.
  2254         16  CM-PREMIUM-TYPE               PIC X.
  2255             88  CM-SING-PRM                  VALUE '1'.
  2256             88  CM-O-B-COVERAGE              VALUE '2'.
  2257             88  CM-OPEN-END                  VALUE '3'.
  2258         16  CM-IND-GRP-TYPE               PIC X.
  2259             88  CM-INDIVIDUAL                VALUE 'I'.
  2260             88  CM-GROUP                     VALUE 'G'.
  2261         16  CM-SKIP-CODE                  PIC X.
  2262             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2263             88  SKIP-JULY                    VALUE '1'.
  2264             88  SKIP-AUGUST                  VALUE '2'.
  2265             88  SKIP-SEPTEMBER               VALUE '3'.
  2266             88  SKIP-JULY-AUG                VALUE '4'.
  2267             88  SKIP-AUG-SEPT                VALUE '5'.
  2268             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2269             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2270             88  SKIP-JUNE                    VALUE '8'.
  2271             88  SKIP-JUNE-JULY               VALUE '9'.
  2272             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2273             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2274         16  CM-PAYMENT-MODE               PIC X.
  2275             88  PAY-MONTHLY                  VALUE SPACE.
  2276             88  PAY-WEEKLY                   VALUE '1'.
  2277             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2278             88  PAY-BI-WEEKLY                VALUE '3'.
  2279             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2280         16  CM-LOAN-NUMBER                PIC X(8).
  2281         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2282         16  CM-OLD-LOF                    PIC XXX.
  2283*        16  CM-LOAN-OFFICER               PIC XXX.
  2284         16  CM-REIN-TABLE                 PIC XXX.
  2285         16  CM-SPECIAL-REIN-CODE          PIC X.
  2286         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2287         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2288         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2289
  2290     12  CM-STATUS-DATA.
  2291         16  CM-ENTRY-STATUS               PIC X.
  2292         16  CM-ENTRY-DT                   PIC XX.
  2293
  2294         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2295         16  CM-LF-CANCEL-DT               PIC XX.
  2296         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2297
  2298         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2299         16  CM-LF-DEATH-DT                PIC XX.
  2300         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2301
  2302         16  CM-LF-CURRENT-STATUS          PIC X.
  2303             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2304                                                'M' '4' '5' '9'.
  2305             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2306             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2307             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2308             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2309             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  44
* EL050.cbl
  2310             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2311             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2312             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2313             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2314             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2315             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2316             88  CM-LF-DECLINED               VALUE 'D'.
  2317             88  CM-LF-VOIDED                 VALUE 'V'.
  2318
  2319         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2320         16  CM-AH-CANCEL-DT               PIC XX.
  2321         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2322
  2323         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2324         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2325         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2326
  2327         16  CM-AH-CURRENT-STATUS          PIC X.
  2328             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2329                                                'M' '4' '5' '9'.
  2330             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2331             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2332             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2333             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2334             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2335             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2336             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2337             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2338             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2339             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2340             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2341             88  CM-AH-DECLINED               VALUE 'D'.
  2342             88  CM-AH-VOIDED                 VALUE 'V'.
  2343
  2344         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2345             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2346             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2347             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2348         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2349
  2350         16  CM-ENTRY-BATCH                PIC X(6).
  2351         16  CM-LF-EXIT-BATCH              PIC X(6).
  2352         16  CM-AH-EXIT-BATCH              PIC X(6).
  2353         16  CM-LAST-MONTH-END             PIC XX.
  2354
  2355     12  CM-NOTE-SW                        PIC X.
  2356         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2357         88  CERT-NOTES-PRESENT               VALUE '1'.
  2358         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2359         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2360         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2361         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2362         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2363         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2364     12  CM-COMP-EXCP-SW                   PIC X.
  2365         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2366         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2367     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  45
* EL050.cbl
  2368         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2369         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2370
  2371*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2372     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2373     12  FILLER                            PIC X.
  2374
  2375*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2376     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2377     12  FILLER                            PIC X.
  2378*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2379     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2380
  2381     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2382         88  CERT-ADDED-BATCH                 VALUE ' '.
  2383         88  CERT-ADDED-ONLINE                VALUE '1'.
  2384         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2385         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2386         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2387     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2388         88  CERT-AS-LOADED                   VALUE ' '.
  2389         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2390         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2391         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2392         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2393         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2394         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2395         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2396
  2397     12  CM-ACCOUNT-COMM-PCTS.
  2398         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2399         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2400
  2401     12  CM-USER-FIELD                     PIC X.
  2402     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2403     12  CM-CLP-STATE                      PIC XX.
  2404     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2405     12  CM-USER-RESERVED                  PIC XXX.
  2406     12  FILLER REDEFINES CM-USER-RESERVED.
  2407         16  CM-AH-CLASS-CD                PIC XX.
  2408         16  F                             PIC X.
  2409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  46
* EL050.cbl
  2411*    COPY ERCMAIL.
  2412******************************************************************
  2413*                                                                *
  2414*                                                                *
  2415*                            ERCMAIL                             *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.003                          *
  2418*                                                                *
  2419*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2420*                                                                *
  2421*   FILE TYPE = VSAM,KSDS                                        *
  2422*   RECORD SIZE = 374   RECFORM = FIX                            *
  2423*                                                                *
  2424*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2425*   ALTERNATE PATH    = NOT USED                                 *
  2426*                                                                *
  2427*   LOG = YES                                                    *
  2428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2429******************************************************************
  2430*                   C H A N G E   L O G
  2431*
  2432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2433*-----------------------------------------------------------------
  2434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2435* EFFECTIVE    NUMBER
  2436*-----------------------------------------------------------------
  2437* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2438* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2439* 111108                   PEMA  ADD CRED BENE ADDR2
  2440******************************************************************
  2441
  2442 01  MAILING-DATA.
  2443     12  MA-RECORD-ID                      PIC XX.
  2444         88  VALID-MA-ID                       VALUE 'MA'.
  2445
  2446     12  MA-CONTROL-PRIMARY.
  2447         16  MA-COMPANY-CD                 PIC X.
  2448         16  MA-CARRIER                    PIC X.
  2449         16  MA-GROUPING.
  2450             20  MA-GROUPING-PREFIX        PIC XXX.
  2451             20  MA-GROUPING-PRIME         PIC XXX.
  2452         16  MA-STATE                      PIC XX.
  2453         16  MA-ACCOUNT.
  2454             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2455             20  MA-ACCOUNT-PRIME          PIC X(6).
  2456         16  MA-CERT-EFF-DT                PIC XX.
  2457         16  MA-CERT-NO.
  2458             20  MA-CERT-PRIME             PIC X(10).
  2459             20  MA-CERT-SFX               PIC X.
  2460
  2461     12  FILLER                            PIC XX.
  2462
  2463     12  MA-ACCESS-CONTROL.
  2464         16  MA-SOURCE-SYSTEM              PIC XX.
  2465             88  MA-FROM-CREDIT                VALUE 'CR'.
  2466             88  MA-FROM-VSI                   VALUE 'VS'.
  2467             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2468             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  47
* EL050.cbl
  2469         16  MA-RECORD-ADD-DT              PIC XX.
  2470         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2471         16  MA-LAST-MAINT-DT              PIC XX.
  2472         16  MA-LAST-MAINT-BY              PIC XXXX.
  2473         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2474
  2475     12  MA-PROFILE-INFO.
  2476         16  MA-QUALIFY-CODE-1             PIC XX.
  2477         16  MA-QUALIFY-CODE-2             PIC XX.
  2478         16  MA-QUALIFY-CODE-3             PIC XX.
  2479         16  MA-QUALIFY-CODE-4             PIC XX.
  2480         16  MA-QUALIFY-CODE-5             PIC XX.
  2481
  2482         16  MA-INSURED-LAST-NAME          PIC X(15).
  2483         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2484         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2485         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2486         16  MA-INSURED-BIRTH-DT           PIC XX.
  2487         16  MA-INSURED-SEX                PIC X.
  2488             88  MA-SEX-MALE                   VALUE 'M'.
  2489             88  MA-SEX-FEMALE                 VALUE 'F'.
  2490         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2491
  2492         16  MA-ADDRESS-CORRECTED          PIC X.
  2493         16  MA-JOINT-BIRTH-DT             PIC XX.
  2494*        16  FILLER                        PIC X(12).
  2495
  2496         16  MA-ADDRESS-LINE-1             PIC X(30).
  2497         16  MA-ADDRESS-LINE-2             PIC X(30).
  2498         16  MA-CITY-STATE.
  2499             20  MA-CITY                   PIC X(28).
  2500             20  MA-ADDR-STATE             PIC XX.
  2501         16  MA-ZIP.
  2502             20  MA-ZIP-CODE.
  2503                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2504                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2505                 24  FILLER                PIC X(4).
  2506             20  MA-ZIP-PLUS4              PIC X(4).
  2507         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2508             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2509             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2510             20  FILLER                    PIC X(3).
  2511
  2512         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2513
  2514         16  FILLER                        PIC XXX.
  2515*        16  FILLER                        PIC X(10).
  2516
  2517     12  MA-CRED-BENE-INFO.
  2518         16  MA-CRED-BENE-NAME                 PIC X(25).
  2519         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2520         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2521         16  MA-CRED-BENE-CTYST.
  2522             20  MA-CRED-BENE-CITY             PIC X(28).
  2523             20  MA-CRED-BENE-STATE            PIC XX.
  2524         16  MA-CRED-BENE-ZIP.
  2525             20  MA-CB-ZIP-CODE.
  2526                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  48
* EL050.cbl
  2527                     88  MA-CB-CANADIAN-POST-CODE
  2528                                           VALUE 'A' THRU 'Z'.
  2529                 24  FILLER                    PIC X(4).
  2530             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2531         16  MA-CB-CANADIAN-POSTAL-CODE
  2532                            REDEFINES MA-CRED-BENE-ZIP.
  2533             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2534             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2535             20  FILLER                        PIC X(3).
  2536     12  MA-POST-CARD-MAIL-DATA.
  2537         16  MA-MAIL-DATA OCCURS 7.
  2538             20  MA-MAIL-TYPE              PIC X.
  2539                 88  MA-12MO-MAILING           VALUE '1'.
  2540                 88  MA-EXP-MAILING            VALUE '2'.
  2541             20  MA-MAIL-STATUS            PIC X.
  2542                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2543                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2544                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2545             20  MA-MAIL-DATE              PIC XX.
  2546     12  FILLER                            PIC XX.
  2547     12  FILLER                            PIC XX.
  2548*    12  FILLER                            PIC X(30).
  2549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  49
* EL050.cbl
  2551*    COPY ERCPNDM.
  2552******************************************************************
  2553*                                                                *
  2554*                                                                *
  2555*                            ERCPNDM                             *
  2556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2557*                            VMOD=2.003                          *
  2558*                                                                *
  2559*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2560*                                                                *
  2561*   FILE TYPE = VSAM,KSDS                                        *
  2562*   RECORD SIZE = 374   RECFORM = FIX                            *
  2563*                                                                *
  2564*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2565*   ALTERNATE PATH    = NOT USED                                 *
  2566*                                                                *
  2567*   LOG = YES                                                    *
  2568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2578* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2579* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2580******************************************************************
  2581
  2582 01  PENDING-MAILING-DATA.
  2583     12  PM-RECORD-ID                      PIC XX.
  2584         88  VALID-MA-ID                       VALUE 'PM'.
  2585
  2586     12  PM-CONTROL-PRIMARY.
  2587         16  PM-COMPANY-CD                 PIC X.
  2588         16  PM-ENTRY-BATCH                PIC X(6).
  2589         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2590         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2591
  2592     12  FILLER                            PIC X(14).
  2593
  2594     12  PM-ACCESS-CONTROL.
  2595         16  PM-SOURCE-SYSTEM              PIC XX.
  2596             88  PM-FROM-CREDIT                VALUE 'CR'.
  2597             88  PM-FROM-VSI                   VALUE 'VS'.
  2598             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2599             88  PM-FROM-OTHER                 VALUE 'OT'.
  2600         16  PM-RECORD-ADD-DT              PIC XX.
  2601         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2602         16  PM-LAST-MAINT-DT              PIC XX.
  2603         16  PM-LAST-MAINT-BY              PIC XXXX.
  2604         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2605
  2606     12  PM-PROFILE-INFO.
  2607         16  PM-QUALIFY-CODE-1             PIC XX.
  2608         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  50
* EL050.cbl
  2609         16  PM-QUALIFY-CODE-3             PIC XX.
  2610         16  PM-QUALIFY-CODE-4             PIC XX.
  2611         16  PM-QUALIFY-CODE-5             PIC XX.
  2612
  2613         16  PM-INSURED-LAST-NAME          PIC X(15).
  2614         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2615         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2616         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2617         16  PM-INSURED-BIRTH-DT           PIC XX.
  2618         16  PM-INSURED-SEX                PIC X.
  2619             88  PM-SEX-MALE                   VALUE 'M'.
  2620             88  PM-SEX-FEMALE                 VALUE 'F'.
  2621         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2622
  2623         16  PM-ADDRESS-CORRECTED          PIC X.
  2624         16  PM-JOINT-BIRTH-DT             PIC XX.
  2625*        16  FILLER                        PIC X(12).
  2626
  2627         16  PM-ADDRESS-LINE-1             PIC X(30).
  2628         16  PM-ADDRESS-LINE-2             PIC X(30).
  2629         16  PM-CITY-STATE.
  2630             20  PM-CITY                   PIC X(28).
  2631             20  PM-STATE                  PIC XX.
  2632         16  PM-ZIP.
  2633             20  PM-ZIP-CODE.
  2634                 24  PM-ZIP-1              PIC X.
  2635                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2636                 24  FILLER                PIC X(4).
  2637             20  PM-ZIP-PLUS4              PIC X(4).
  2638         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2639             20  PM-CAN-POST1              PIC XXX.
  2640             20  PM-CAN-POST2              PIC XXX.
  2641             20  FILLER                    PIC XXX.
  2642
  2643         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2644
  2645         16  FILLER                        PIC X(03).
  2646
  2647     12  PM-CRED-BENE-INFO.
  2648         16  PM-CRED-BENE-NAME             PIC X(25).
  2649         16  PM-CRED-BENE-ADDR             PIC X(30).
  2650         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2651         16  PM-CRED-BENE-CTYST.
  2652             20  PM-CRED-BENE-CITY         PIC X(28).
  2653             20  PM-CRED-BENE-STATE        PIC XX.
  2654         16  PM-CRED-BENE-ZIP.
  2655             20  PM-CB-ZIP-CODE.
  2656                 24  PM-CB-ZIP-1           PIC X.
  2657                     88  PM-CB-CANADIAN-POST-CODE
  2658                                  VALUE 'A' THRU 'Z'.
  2659                 24  FILLER                PIC X(4).
  2660             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2661         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2662             20  PM-CB-CAN-POST1           PIC XXX.
  2663             20  PM-CB-CAN-POST2           PIC XXX.
  2664             20  FILLER                    PIC XXX.
  2665     12  PM-POST-CARD-MAIL-DATA.
  2666         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  51
* EL050.cbl
  2667             20  PM-MAIL-TYPE              PIC X.
  2668                 88  PM-12MO-MAILING           VALUE '1'.
  2669                 88  PM-EXP-MAILING            VALUE '2'.
  2670             20  PM-MAIL-STATUS            PIC X.
  2671                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2672                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2673                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2674             20  PM-MAIL-DATE              PIC XX.
  2675     12  FILLER                            PIC XX.
  2676     12  FILLER                            PIC X(12).
  2677*    12  FILLER                            PIC X(30).
  2678
  2679******************************************************************
  2680*                                COPY ERCLOFC.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCLOFC                             *
  2685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2686*                            VMOD=2.003                          *
  2687*                                                                *
  2688*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2689*                                                                *
  2690*   FILE TYPE = VSAM,KSDS                                        *
  2691*   RECORD SIZE = 670   RECFORM = FIX                            *
  2692*                                                                *
  2693*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2694*                                                                *
  2695*   LOG = YES                                                    *
  2696*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2697*                                                                *
  2698******************************************************************
  2699
  2700 01  LOAN-OFFICER-MASTER.
  2701     12  LO-RECORD-ID                PIC XX.
  2702         88  VALID-LO-ID                VALUE 'LO'.
  2703
  2704     12  LO-CONTROL-PRIMARY.
  2705         16  LO-COMPANY-CD           PIC X.
  2706         16  LO-CARRIER              PIC X.
  2707         16  LO-GROUPING.
  2708             20  LO-GROUPING-PREFIX  PIC XXX.
  2709             20  LO-GROUPING-PRIME   PIC XXX.
  2710         16  LO-STATE                PIC XX.
  2711         16  LO-ACCOUNT.
  2712             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2713             20  LO-ACCOUNT-PRIME    PIC X(6).
  2714         16  LO-OFFICER-CODE         PIC X(5).
  2715
  2716     12  LO-OFFICER-NAME             PIC X(30).
  2717
  2718     12  LO-LAST-MAINT-DT            PIC XX.
  2719     12  LO-LAST-USER                PIC X(4).
  2720     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2721
  2722     12  LO-COMP-CONTROL             PIC X.
  2723             88  LO-SHOW-COMP           VALUE 'Y'.
  2724             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  52
* EL050.cbl
  2725     12  LO-DETAIL-CONTROL           PIC X.
  2726             88  LO-PRINT-DETAIL        VALUE 'D'.
  2727             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2728
  2729     12  LO-SV-CARRIER               PIC X.
  2730     12  LO-SV-GROUPING              PIC X(6).
  2731     12  LO-SV-STATE                 PIC XX.
  2732
  2733     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2734     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2735
  2736     12  LO-OFFICER-INFO.
  2737         16  FILLER OCCURS 12 TIMES.
  2738             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2739             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2740             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2741             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2742             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2743             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2744             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2745             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2746     12  FILLER                      PIC X(198).
  2747******************************************************************
  2748*                                COPY ERCPDEF.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ERCPDEF.                            *
  2753*                                                                *
  2754*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2755*                                                                *
  2756*    FILE TYPE = VSAM,KSDS                                       *
  2757*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2758*                                                                *
  2759*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2760*                                                                *
  2761*    LOG = YES                                                   *
  2762*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2763******************************************************************
  2764*                   C H A N G E   L O G
  2765*
  2766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2767*-----------------------------------------------------------------
  2768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2769* EFFECTIVE    NUMBER
  2770*-----------------------------------------------------------------
  2771* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2772* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2773******************************************************************
  2774 01  PRODUCT-MASTER.
  2775    12  PD-RECORD-ID                 PIC X(02).
  2776        88  VALID-PD-ID                  VALUE 'PD'.
  2777    12  PD-CONTROL-PRIMARY.
  2778        16  PD-COMPANY-CD            PIC X.
  2779        16  PD-STATE                 PIC XX.
  2780        16  PD-PRODUCT-CD            PIC XXX.
  2781        16  PD-FILLER                PIC X(7).
  2782        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  53
* EL050.cbl
  2783        16  PD-BEN-CODE              PIC XX.
  2784        16  PD-PROD-EXP-DT           PIC XX.
  2785    12  FILLER                       PIC X(50).
  2786    12  PD-PRODUCT-DATA OCCURS 8.
  2787        16  PD-PROD-CODE             PIC X.
  2788            88  PD-PROD-LIFE           VALUE 'L'.
  2789            88  PD-PROD-PROP           VALUE 'P'.
  2790            88  PD-PROD-AH             VALUE 'A'.
  2791            88  PD-PROD-IU             VALUE 'I'.
  2792            88  PD-PROD-GAP            VALUE 'G'.
  2793            88  PD-PROD-FAML           VALUE 'F'.
  2794        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2795        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2796        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2797        16  PD-MAX-TERM              PIC S999        COMP-3.
  2798        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2799        16  FILLER                   PIC X.
  2800        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2801        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2802        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2803        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2804        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2805        16  PD-REC-CRIT-PERIOD       PIC 99.
  2806        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2807            20  PD-RECURRING-YN      PIC X.
  2808            20  FILLER               PIC X.
  2809        16  PD-RTW-MOS               PIC 99.
  2810        16  PD-MAX-EXTENSION         PIC 99.
  2811        16  FILLER                   PIC XX.
  2812    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2813    12  PD-TERM-LIMITS OCCURS 15.
  2814        16  PD-LOW-TERM              PIC S999        COMP-3.
  2815        16  PD-HI-TERM               PIC S999        COMP-3.
  2816*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2817    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2818        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2819        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2820    12  PD-EARN-FACTORS.
  2821        16  FILLER OCCURS 15.
  2822            20  FILLER OCCURS 15.
  2823                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2824    12  PD-PRODUCT-DESC              PIC X(80).
  2825    12  PD-TRUNCATED                 PIC X.
  2826    12  FILLER                       PIC X(59).
  2827    12  PD-MAINT-INFORMATION.
  2828        16  PD-LAST-MAINT-DT         PIC X(02).
  2829        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2830        16  PD-LAST-MAINT-BY         PIC X(04).
  2831*                                COPY ELCSTATE.
  2832******************************************************************
  2833*                                                                *
  2834*                                                                *
  2835*                            ELCSTATE.                           *
  2836*                                                                *
  2837*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2838*                                                                *
  2839*   FILE TYPE = VSAM,KSDS                                        *
  2840*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  54
* EL050.cbl
  2841*                                                                *
  2842*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2843*       ALTERNATE INDEX = NONE                                   *
  2844*                                                                *
  2845*   LOG = YES                                                    *
  2846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2847******************************************************************
  2848*                   C H A N G E   L O G
  2849*
  2850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2851*-----------------------------------------------------------------
  2852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2853* EFFECTIVE    NUMBER
  2854*-----------------------------------------------------------------
  2855* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2856******************************************************************
  2857*
  2858 01  STATE-FILE.
  2859     12  SF-RECORD-ID                       PIC XX.
  2860         88  VALID-CF-ID                        VALUE 'SF'.
  2861     12  SF-CONTROL-PRIMARY.
  2862         16  SF-COMPANY-ID                  PIC XXX.
  2863         16  SF-CARRIER-CODE                PIC X.
  2864         16  SF-GROUPING                    PIC X(6).
  2865         16  SF-STATE-CODE                  PIC XX.
  2866         16  SF-EXPIRE-DATE                 PIC 9(8).
  2867****************************************************************
  2868*             STATE CONTROLS
  2869****************************************************************
  2870     12  SF-LAST-MAINT-DT                   PIC XX.
  2871     12  SF-LAST-MAINT-BY                   PIC X(4).
  2872     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2873     12  SF-STATE-RT-CONTROLS.
  2874         16  SF-ST-RT-CALC                  PIC X.
  2875     12  SF-ST-TAX-CONTROLS.
  2876         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2877         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2878         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2879     12  SF-ST-REFUND-OPTIONS.
  2880         16  SF-ST-RF-LR-CALC               PIC X.
  2881         16  SF-ST-RF-LL-CALC               PIC X.
  2882         16  SF-ST-RF-LN-CALC               PIC X.
  2883         16  SF-ST-RF-AH-CALC               PIC X.
  2884         16  SF-ST-RF-CP-CALC               PIC X.
  2885     12  SF-ST-UNEARN-PREM-OPTIONS.
  2886         16  SF-ST-LUEP-R78                 PIC X.
  2887         16  SF-ST-LUEP-PRO                 PIC X.
  2888         16  SF-ST-LUEP-ST                  PIC X.
  2889         16  SF-ST-LUEP-DOM                 PIC X.
  2890         16  SF-ST-AUEP-R78                 PIC X.
  2891         16  SF-ST-AUEP-PRO                 PIC X.
  2892         16  SF-ST-AUEP-ST                  PIC X.
  2893         16  SF-ST-AUEP-DOM                 PIC X.
  2894         16  SF-ST-CUEP-R78                 PIC X.
  2895         16  SF-ST-CUEP-PRO                 PIC X.
  2896         16  SF-ST-CUEP-ST                  PIC X.
  2897         16  SF-ST-CUEP-DOM                 PIC X.
  2898     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  55
* EL050.cbl
  2899         16  SF-ST-LEP-R78                  PIC X.
  2900         16  SF-ST-LEP-PRO                  PIC X.
  2901         16  SF-ST-LEP-ST                   PIC X.
  2902         16  SF-ST-LEP-DOM                  PIC X.
  2903         16  SF-ST-AEP-R78                  PIC X.
  2904         16  SF-ST-AEP-PRO                  PIC X.
  2905         16  SF-ST-AEP-ST                   PIC X.
  2906         16  SF-ST-AEP-DOM                  PIC X.
  2907         16  SF-ST-CEP-R78                  PIC X.
  2908         16  SF-ST-CEP-PRO                  PIC X.
  2909         16  SF-ST-CEP-ST                   PIC X.
  2910         16  SF-ST-CEP-DOM                  PIC X.
  2911     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  56
* EL050.cbl
  2913*    COPY ELCCRTT.
  2914******************************************************************
  2915*                                                                *
  2916*                            ELCCRTT.                            *
  2917*                                                                *
  2918*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2919*                                                                *
  2920*   FILE TYPE = VSAM,KSDS                                        *
  2921*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2922*                                                                *
  2923*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2924*                                                                *
  2925*   LOG = YES                                                    *
  2926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2927******************************************************************
  2928*                   C H A N G E   L O G
  2929*
  2930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2931*-----------------------------------------------------------------
  2932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2933* EFFECTIVE    NUMBER
  2934*-----------------------------------------------------------------
  2935* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2936* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2937* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2938* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2939* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2940* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2941* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2942******************************************************************
  2943
  2944 01  CERTIFICATE-TRAILERS.
  2945     12  CS-RECORD-ID                      PIC XX.
  2946         88  VALID-CS-ID                      VALUE 'CS'.
  2947
  2948     12  CS-CONTROL-PRIMARY.
  2949         16  CS-COMPANY-CD                 PIC X.
  2950         16  CS-CARRIER                    PIC X.
  2951         16  CS-GROUPING                   PIC X(6).
  2952         16  CS-STATE                      PIC XX.
  2953         16  CS-ACCOUNT                    PIC X(10).
  2954         16  CS-CERT-EFF-DT                PIC XX.
  2955         16  CS-CERT-NO.
  2956             20  CS-CERT-PRIME             PIC X(10).
  2957             20  CS-CERT-SFX               PIC X.
  2958         16  CS-TRAILER-TYPE               PIC X.
  2959             88  COMM-TRLR           VALUE 'A'.
  2960             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2961             88  CERT-DATA-TRLR      VALUE 'C'.
  2962
  2963     12  CS-DATA-AREA                      PIC X(516).
  2964
  2965     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2966         16  CS-BANK-COMMISSION-AREA.
  2967             20  CS-BANK-COMMS       OCCURS 10.
  2968                 24  CS-AGT                PIC X(10).
  2969                 24  CS-COM-TYP            PIC X.
  2970                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  57
* EL050.cbl
  2971                 24  CS-RECALC-LV-INDIC    PIC X.
  2972                 24  FILLER                PIC X(10).
  2973         16  FILLER                        PIC X(256).
  2974
  2975     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2976****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2977         16  CS-MB-CLAIM-DATA OCCURS 24.
  2978             20  CS-CLAIM-NO               PIC X(7).
  2979             20  CS-CLAIM-TYPE             PIC X.
  2980                 88  CS-AH-CLM               VALUE 'A'.
  2981                 88  CS-IU-CLM               VALUE 'I'.
  2982                 88  CS-GP-CLM               VALUE 'G'.
  2983                 88  CS-LF-CLM               VALUE 'L'.
  2984                 88  CS-PR-CLM               VALUE 'P'.
  2985                 88  CS-FL-CLM               VALUE 'F'.
  2986             20  CS-INSURED-TYPE           PIC X.
  2987                 88  CS-PRIM-INSURED          VALUE 'P'.
  2988                 88  CS-CO-BORROWER           VALUE 'C'.
  2989             20  CS-BENEFIT-PERIOD         PIC 99.
  2990             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2991             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2992             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2993         16  FILLER                        PIC X(12).
  2994     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2995         16  CS-VIN-NUMBER                 PIC X(17).
  2996         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2997         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2998         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2999         16  FILLER                        PIC X(496).
  3000*    COPY ELCCRTO.
  3001******************************************************************
  3002*                                                                *
  3003*                            ELCCRTO.                            *
  3004*                                                                *
  3005*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3006*                                                                *
  3007*   FILE TYPE = VSAM,KSDS                                        *
  3008*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3009*                                                                *
  3010*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3011*                                                                *
  3012*   LOG = YES                                                    *
  3013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3014******************************************************************
  3015*                   C H A N G E   L O G
  3016*
  3017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3018*-----------------------------------------------------------------
  3019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3020* EFFECTIVE    NUMBER
  3021*-----------------------------------------------------------------
  3022* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3023* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3024* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3025* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3026* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3027******************************************************************
  3028 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  58
* EL050.cbl
  3029     12  OC-RECORD-ID                      PIC XX.
  3030         88  VALID-OC-ID                      VALUE 'OC'.
  3031     12  OC-CONTROL-PRIMARY.
  3032         16  OC-COMPANY-CD                 PIC X.
  3033         16  OC-CARRIER                    PIC X.
  3034         16  OC-GROUPING                   PIC X(6).
  3035         16  OC-STATE                      PIC XX.
  3036         16  OC-ACCOUNT                    PIC X(10).
  3037         16  OC-CERT-EFF-DT                PIC XX.
  3038         16  OC-CERT-NO.
  3039             20  OC-CERT-PRIME             PIC X(10).
  3040             20  OC-CERT-SFX               PIC X.
  3041         16  OC-RECORD-TYPE                PIC X.
  3042         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3043     12  OC-LAST-MAINT-DT                  PIC XX.
  3044     12  OC-LAST-MAINT-BY                  PIC X(4).
  3045     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3046     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3047     12  FILLER                            PIC X(49).
  3048     12  OC-ORIG-REC.
  3049         16  OC-INS-LAST-NAME              PIC X(15).
  3050         16  OC-INS-FIRST-NAME             PIC X(10).
  3051         16  OC-INS-MIDDLE-INIT            PIC X.
  3052         16  OC-INS-AGE                    PIC S999     COMP-3.
  3053         16  OC-JNT-LAST-NAME              PIC X(15).
  3054         16  OC-JNT-FIRST-NAME             PIC X(10).
  3055         16  OC-JNT-MIDDLE-INIT            PIC X.
  3056         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3057         16  OC-LF-BENCD                   PIC XX.
  3058         16  OC-LF-TERM                    PIC S999      COMP-3.
  3059         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3060         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3061         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3062         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3063         16  OC-LF-EXP-DT                  PIC XX.
  3064         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3065         16  OC-LF-CANCEL-DT               PIC XX.
  3066         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3067         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3068         16  OC-AH-BENCD                   PIC XX.
  3069         16  OC-AH-TERM                    PIC S999      COMP-3.
  3070         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3071         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3072         16  OC-AH-EXP-DT                  PIC XX.
  3073         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3074         16  OC-AH-CP                      PIC 99.
  3075         16  OC-AH-CANCEL-DT               PIC XX.
  3076         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3077         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3078         16  OC-CRED-BENE-NAME             PIC X(25).
  3079         16  OC-1ST-PMT-DT                 PIC XX.
  3080         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3081         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3082         16  OC-ISSUE-TRAN-IND             PIC X.
  3083         16  OC-CANCEL-TRAN-IND            PIC X.
  3084         16  FILLER                        PIC X(211).
  3085
  3086     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  59
* EL050.cbl
  3087******************************************************************
  3088
  3089*    COPY ELCDATE.
  3090******************************************************************
  3091*                                                                *
  3092*                                                                *
  3093*                            ELCDATE.                            *
  3094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3095*                            VMOD=2.003
  3096*                                                                *
  3097*                                                                *
  3098*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3099*                 LENGTH = 200                                   *
  3100******************************************************************
  3101
  3102 01  DATE-CONVERSION-DATA.
  3103     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3104     12  DC-OPTION-CODE                PIC X.
  3105         88  BIN-TO-GREG                VALUE ' '.
  3106         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3107         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3108         88  YMD-GREG-TO-BIN            VALUE '3'.
  3109         88  MDY-GREG-TO-BIN            VALUE '4'.
  3110         88  JULIAN-TO-BIN              VALUE '5'.
  3111         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3112         88  FIND-CENTURY               VALUE '7'.
  3113         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3114         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3115         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3116         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3117         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3118         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3119         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3120         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3121         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3122         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3123         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3124         88  BIN-3-TO-GREG              VALUE 'I'.
  3125         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3126         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3127         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3128         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3129         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3130         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3131         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3132         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3133         88  THREE-CHARACTER-BIN
  3134                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3135         88  GREGORIAN-TO-BIN
  3136                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3137         88  BIN-TO-GREGORIAN
  3138                  VALUES ' ' '1' 'I' '8' 'G'.
  3139         88  JULIAN-TO-BINARY
  3140                  VALUES '5' 'C' 'E' 'F'.
  3141     12  DC-ERROR-CODE                 PIC X.
  3142         88  NO-CONVERSION-ERROR        VALUE ' '.
  3143         88  DATE-CONVERSION-ERROR
  3144                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  60
* EL050.cbl
  3145         88  DATE-IS-ZERO               VALUE '1'.
  3146         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3147         88  DATE-IS-INVALID            VALUE '3'.
  3148         88  DATE1-GREATER-DATE2        VALUE '4'.
  3149         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3150         88  DATE-INVALID-OPTION        VALUE '9'.
  3151         88  INVALID-CENTURY            VALUE 'A'.
  3152         88  ONLY-CENTURY               VALUE 'B'.
  3153         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3154         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3155     12  DC-END-OF-MONTH               PIC X.
  3156         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3157     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3158         88  USE-NORMAL-PROCESS         VALUE ' '.
  3159         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3160         88  ADJUST-UP-100-YRS          VALUE '2'.
  3161     12  FILLER                        PIC X.
  3162     12  DC-CONVERSION-DATES.
  3163         16  DC-BIN-DATE-1             PIC XX.
  3164         16  DC-BIN-DATE-2             PIC XX.
  3165         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3166         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3167                       DC-GREG-DATE-1-EDIT.
  3168             20  DC-EDIT1-MONTH        PIC 99.
  3169             20  SLASH1-1              PIC X.
  3170             20  DC-EDIT1-DAY          PIC 99.
  3171             20  SLASH1-2              PIC X.
  3172             20  DC-EDIT1-YEAR         PIC 99.
  3173         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3174         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3175                     DC-GREG-DATE-2-EDIT.
  3176             20  DC-EDIT2-MONTH        PIC 99.
  3177             20  SLASH2-1              PIC X.
  3178             20  DC-EDIT2-DAY          PIC 99.
  3179             20  SLASH2-2              PIC X.
  3180             20  DC-EDIT2-YEAR         PIC 99.
  3181         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3182         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3183                     DC-GREG-DATE-1-YMD.
  3184             20  DC-YMD-YEAR           PIC 99.
  3185             20  DC-YMD-MONTH          PIC 99.
  3186             20  DC-YMD-DAY            PIC 99.
  3187         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3188         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3189                      DC-GREG-DATE-1-MDY.
  3190             20  DC-MDY-MONTH          PIC 99.
  3191             20  DC-MDY-DAY            PIC 99.
  3192             20  DC-MDY-YEAR           PIC 99.
  3193         16  DC-GREG-DATE-1-ALPHA.
  3194             20  DC-ALPHA-MONTH        PIC X(10).
  3195             20  DC-ALPHA-DAY          PIC 99.
  3196             20  FILLER                PIC XX.
  3197             20  DC-ALPHA-CENTURY.
  3198                 24 DC-ALPHA-CEN-N     PIC 99.
  3199             20  DC-ALPHA-YEAR         PIC 99.
  3200         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3201         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3202         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  61
* EL050.cbl
  3203         16  DC-JULIAN-DATE            PIC 9(05).
  3204         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3205                                       PIC 9(05).
  3206         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3207             20  DC-JULIAN-YEAR        PIC 99.
  3208             20  DC-JULIAN-DAYS        PIC 999.
  3209         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3210         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3211         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3212     12  DATE-CONVERSION-VARIBLES.
  3213         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3214         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3215             20  FILLER                PIC 9(3).
  3216             20  HOLD-CEN-1-CCYY.
  3217                 24  HOLD-CEN-1-CC     PIC 99.
  3218                 24  HOLD-CEN-1-YY     PIC 99.
  3219             20  HOLD-CEN-1-MO         PIC 99.
  3220             20  HOLD-CEN-1-DA         PIC 99.
  3221         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3222             20  HOLD-CEN-1-R-MO       PIC 99.
  3223             20  HOLD-CEN-1-R-DA       PIC 99.
  3224             20  HOLD-CEN-1-R-CCYY.
  3225                 24  HOLD-CEN-1-R-CC   PIC 99.
  3226                 24  HOLD-CEN-1-R-YY   PIC 99.
  3227             20  FILLER                PIC 9(3).
  3228         16  HOLD-CENTURY-1-X.
  3229             20  FILLER                PIC X(3)  VALUE SPACES.
  3230             20  HOLD-CEN-1-X-CCYY.
  3231                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3232                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3233             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3234             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3235         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3236             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3237             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3238             20  HOLD-CEN-1-R-X-CCYY.
  3239                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3240                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3241             20  FILLER                PIC XXX.
  3242         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3243         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3244         16  DC-JULIAN-DATE-1          PIC 9(07).
  3245         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3246             20  DC-JULIAN-1-CCYY.
  3247                 24  DC-JULIAN-1-CC    PIC 99.
  3248                 24  DC-JULIAN-1-YR    PIC 99.
  3249             20  DC-JULIAN-DA-1        PIC 999.
  3250         16  DC-JULIAN-DATE-2          PIC 9(07).
  3251         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3252             20  DC-JULIAN-2-CCYY.
  3253                 24  DC-JULIAN-2-CC    PIC 99.
  3254                 24  DC-JULIAN-2-YR    PIC 99.
  3255             20  DC-JULIAN-DA-2        PIC 999.
  3256         16  DC-GREG-DATE-A-EDIT.
  3257             20  DC-EDITA-MONTH        PIC 99.
  3258             20  SLASHA-1              PIC X VALUE '/'.
  3259             20  DC-EDITA-DAY          PIC 99.
  3260             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  62
* EL050.cbl
  3261             20  DC-EDITA-CCYY.
  3262                 24  DC-EDITA-CENT     PIC 99.
  3263                 24  DC-EDITA-YEAR     PIC 99.
  3264         16  DC-GREG-DATE-B-EDIT.
  3265             20  DC-EDITB-MONTH        PIC 99.
  3266             20  SLASHB-1              PIC X VALUE '/'.
  3267             20  DC-EDITB-DAY          PIC 99.
  3268             20  SLASHB-2              PIC X VALUE '/'.
  3269             20  DC-EDITB-CCYY.
  3270                 24  DC-EDITB-CENT     PIC 99.
  3271                 24  DC-EDITB-YEAR     PIC 99.
  3272         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3273         16  DC-GREG-DATE-CYMD-R REDEFINES
  3274                              DC-GREG-DATE-CYMD.
  3275             20  DC-CYMD-CEN           PIC 99.
  3276             20  DC-CYMD-YEAR          PIC 99.
  3277             20  DC-CYMD-MONTH         PIC 99.
  3278             20  DC-CYMD-DAY           PIC 99.
  3279         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3280         16  DC-GREG-DATE-MDCY-R REDEFINES
  3281                              DC-GREG-DATE-MDCY.
  3282             20  DC-MDCY-MONTH         PIC 99.
  3283             20  DC-MDCY-DAY           PIC 99.
  3284             20  DC-MDCY-CEN           PIC 99.
  3285             20  DC-MDCY-YEAR          PIC 99.
  3286    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3287        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3288    12  DC-EL310-DATE                  PIC X(21).
  3289    12  FILLER                         PIC X(28).
  3290
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  63
* EL050.cbl
  3292*    COPY ELCCALC.
  3293******************************************************************
  3294*                                                                *
  3295*                           ELCCALC.                            *
  3296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3297*                            VMOD=2.025                          *
  3298*                                                                *
  3299*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3300*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3301*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3302*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3303*                                                                *
  3304*  PASSED TO ELRTRM                                              *
  3305*  -----------------                                             *
  3306*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3307*  ORIGINAL TERM                                                 *
  3308*  BEGINNING DATE                                                *
  3309*  ENDING DATE                                                   *
  3310*  COMPANY I.D.                                                  *
  3311*  ACCOUNT MASTER USER FIELD                                     *
  3312*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3313*  FREE LOOK DAYS                                                *
  3314*                                                                *
  3315*  RETURNED FROM ELRTRM                                          *
  3316*  ---------------------                                         *
  3317*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3318*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3319*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3320*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3321*----------------------------------------------------------------*
  3322*  PASSED TO ELRAMT                                              *
  3323*  ----------------                                              *
  3324*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3325*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3326*  ORIGINAL AMOUNT                                               *
  3327*  ALTERNATE BENEFIT (BALLON)                                    *
  3328*  A.P.R. - NET PAY ONLY                                         *
  3329*  METHOD
  3330*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3331*  COMPANY I.D.                                                  *
  3332*  BENEFIT TYPE                                                  *
  3333*                                                                *
  3334*  RETURNED FROM ELRAMT                                          *
  3335*  --------------------                                          *
  3336*  REMAINING AMOUNT 1 - CURRENT                                  *
  3337*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3338*  REMAINING AMOUNT FACTOR
  3339*----------------------------------------------------------------*
  3340*  PASSED TO ELRESV                                              *
  3341*  -----------------                                             *
  3342*  CERTIFICATE EFFECTIVE DATE                                    *
  3343*  VALUATION DATE                                                *
  3344*  PAID THRU DATE                                                *
  3345*  BENEFIT                                                       *
  3346*  INCURRED DATE                                                 *
  3347*  REPORTED DATE                                                 *
  3348*  ISSUE AGE                                                     *
  3349*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  64
* EL050.cbl
  3350*  CDT PERCENT                                                   *
  3351*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3352* *CLAIM TYPE (LIFE, A/H)                                        *
  3353* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3354* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3355*                                                                *
  3356*  RETURNED FROM ELRESV                                          *
  3357*  --------------------                                          *
  3358*  CDT TABLE USED                                                *
  3359*  CDT FACTOR USED                                               *
  3360*  PAY TO CURRENT RESERVE                                        *
  3361*  I.B.N.R. - A/H ONLY                                           *
  3362*  FUTURE (ACCRUED) AH ONLY                                      *
  3363*----------------------------------------------------------------*
  3364*  PASSED TO ELRATE                                              *
  3365*  ----------------                                              *
  3366*  CERT ISSUE DATE                                               *
  3367*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3368*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3369*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3370*  STATE CODE (CLIENT DEFINED)                                   *
  3371*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3372*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3373*  DEVIATION CODE                                                *
  3374*  ISSUE AGE                                                     *
  3375*  ORIGINAL BENEFIT AMOUNT                                       *
  3376*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3377*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3378*  BENEFIT KIND (LIFE OR A/H)                                    *
  3379*  A.P.R.                                                        *
  3380*  METHOD
  3381*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3382*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3383*  COMPANY I.D. (3 CHARACTER)                                    *
  3384*  BENEFIT CODE                                                  *
  3385*  BENEFIT OVERRIDE CODE                                         *
  3386*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3387*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3388*  JOINT INDICATOR (CSL ONLY)                                    *
  3389*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3390*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3391*                                                                *
  3392*  RETURNED FROM ELRATE                                          *
  3393*  --------------------                                          *
  3394*  CALCULATED PREMIUM                                            *
  3395*  PREMIUM RATE                                                  *
  3396*  MORTALITY CODE                                                *
  3397*  MAX ATTAINED AGE                                              *
  3398*  MAX AGE                                                       *
  3399*  MAX TERM                                                      *
  3400*  MAX MONTHLY BENEFIT                                           *
  3401*  MAX TOTAL BENIFIT                                             *
  3402*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRFND                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  65
* EL050.cbl
  3408*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3409*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3410*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3411*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3412*  STATE CODE (CLIENT DEFINED)                                   *
  3413*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3414*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3415*  DEVIATION CODE                                                *
  3416*  ISSUE AGE                                                     *
  3417*  ORIGINAL BENEFIT AMOUNT                                       *
  3418*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3419*  PROCESS TYPE (CANCEL)                                         *
  3420*  BENEFIT KIND (LIFE OR A/H)                                    *
  3421*  A.P.R.                                                        *
  3422*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3423*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3424*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3425*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3426*  COMPANY I.D. (3 CHARACTER)                                    *
  3427*  BENEFIT CODE                                                  *
  3428*  BENEFIT OVERRIDE CODE                                         *
  3429*                                                                *
  3430*  RETURNED FROM ELRFND                                          *
  3431*  --------------------                                          *
  3432*  CALCULATED REFUND                                             *
  3433*----------------------------------------------------------------*
  3434*  PASSED TO ELEARN                                              *
  3435*  ----------------                                              *
  3436*  CERT ISSUE DATE                                               *
  3437*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3438*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3439*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3440*  STATE CODE (CLIENT DEFINED)                                   *
  3441*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3442*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3443*  DEVIATION CODE                                                *
  3444*  ISSUE AGE                                                     *
  3445*  ORIGINAL BENEFIT AMOUNT                                       *
  3446*  BENEFIT KIND (LIFE OR A/H)                                    *
  3447*  A.P.R.                                                        *
  3448*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3449*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3450*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3451*  COMPANY I.D. (3 CHARACTER)                                    *
  3452*  BENEFIT CODE                                                  *
  3453*  BENEFIT OVERRIDE CODE                                         *
  3454*                                                                *
  3455*  RETURNED FROM ELEARN                                          *
  3456*  --------------------                                          *
  3457*  INDICATED  EARNINGS                                           *
  3458*----------------------------------------------------------------*
  3459*                 LENGTH = 450                                   *
  3460*                                                                *
  3461******************************************************************
  3462******************************************************************
  3463*                   C H A N G E   L O G
  3464*
  3465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  66
* EL050.cbl
  3466*-----------------------------------------------------------------
  3467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3468* EFFECTIVE    NUMBER
  3469*-----------------------------------------------------------------
  3470* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3471* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3472* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3473* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3474* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3475* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3476* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3477* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3478* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3479******************************************************************
  3480
  3481 01  CALCULATION-PASS-AREA.
  3482     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3483                                     COMP.
  3484
  3485     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3486       88  NO-CP-ERROR                             VALUE ZERO.
  3487       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3488                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3489       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3490       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3491       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3492       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3493       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3494       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3495       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3496       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3497       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3498       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3499       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3500       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3501       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3502       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3503       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3504       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3505       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3506
  3507     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3508       88  NO-CP-ERROR-2                           VALUE ZERO.
  3509***********************  INPUT AREAS ****************************
  3510
  3511     12  CP-CALCULATION-AREA.
  3512         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3513         16  CP-CERT-EFF-DT        PIC XX.
  3514         16  CP-VALUATION-DT       PIC XX.
  3515         16  CP-PAID-THRU-DT       PIC XX.
  3516         16  CP-BENEFIT-TYPE       PIC X.
  3517           88  CP-AH                               VALUE 'A' 'D'
  3518                                                   'I' 'U'.
  3519           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3520           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3521         16  CP-INCURRED-DT        PIC XX.
  3522         16  CP-REPORTED-DT        PIC XX.
  3523         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  67
* EL050.cbl
  3524         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3525         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-CDT-METHOD         PIC X.
  3530           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3531           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3532           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3533         16  CP-CLAIM-TYPE         PIC X.
  3534           88  CP-AH-CLAIM                         VALUE 'A'.
  3535           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3536         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3537                                     COMP-3.
  3538         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3539                                     COMP-3.
  3540         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3543                                     COMP-3.
  3544         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3547                                     COMP-3.
  3548         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-REM-TERM-METHOD    PIC X.
  3551           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3552           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3553           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3554           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3555           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3556           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3557           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3558         16  CP-EARNING-METHOD     PIC X.
  3559           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3560           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3561           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3562           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3563           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3564           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3565           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3566           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3567           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3568           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3569           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3570           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3571           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3572           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3573         16  CP-PROCESS-TYPE       PIC X.
  3574           88  CP-CLAIM                            VALUE '1'.
  3575           88  CP-CANCEL                           VALUE '2'.
  3576           88  CP-ISSUE                            VALUE '3'.
  3577         16  CP-SPECIAL-CALC-CD    PIC X.
  3578           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3579           88  CP-1-MTH-INTEREST               VALUE ' '.
  3580           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3581           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  68
* EL050.cbl
  3582           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3583           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3584           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3585           88  CP-FARM-PLAN                    VALUE 'F'.
  3586           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3587           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3588           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3589           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3590           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3591           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3592           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3593           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3594           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3595           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3596                                                     'W' 'X'.
  3597           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3598           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3599           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3600           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3601           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3602           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3603           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3604           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3605           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3606           88  CP-CSL-METH-1                   VALUE '5'.
  3607           88  CP-CSL-METH-2                   VALUE '6'.
  3608           88  CP-CSL-METH-3                   VALUE '7'.
  3609           88  CP-CSL-METH-4                   VALUE '8'.
  3610
  3611         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3614         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3615         16  CP-STATE              PIC XX          VALUE SPACE.
  3616         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3617         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3618           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3619               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3620         16  CP-R78-OPTION         PIC X.
  3621           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3622           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3623
  3624         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3625         16  CP-IBNR-RESERVE-SW    PIC X.
  3626         16  CP-CLAIM-STATUS       PIC X.
  3627         16  CP-RATE-FILE          PIC X.
  3628         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3629                                     COMP-3.
  3630
  3631         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3632         16  CP-AH-OVERRIDE-CODE   PIC X.
  3633
  3634         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3635                                     COMP-3.
  3636         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3637                                   PIC S9(5)V99 COMP-3.
  3638         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3639                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  69
* EL050.cbl
  3640         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3645                                  PIC S9(7)V99 COMP-3.
  3646
  3647         16  CP-PAID-FROM-DATE     PIC X(02).
  3648         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3649         16  CP-EXT-DAYS-CALC      PIC X.
  3650           88  CP-EXT-NO-CHG                   VALUE ' '.
  3651           88  CP-EXT-CHG-LF                   VALUE '1'.
  3652           88  CP-EXT-CHG-AH                   VALUE '2'.
  3653           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3654         16  CP-DOMICILE-STATE     PIC XX.
  3655         16  CP-CARRIER            PIC X.
  3656         16  CP-REIN-FLAG          PIC X.
  3657         16  CP-REM-TRM-CALC-OPTION PIC X.
  3658           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3659                      '2' '3' '4' '5'.
  3660           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3661           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3662           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3663           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3664           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3665           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3666           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3667           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3668         16  CP-SIG-SWITCH         PIC X.
  3669         16  CP-RATING-METHOD      PIC X.
  3670           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3671           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3672           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3673           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3674           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3675           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3676           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3677           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3678           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3679         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3680                                     COMP-3.
  3681         16  CP-BEN-CATEGORY       PIC X.
  3682         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3683         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3684                                   PIC S99V9(5) COMP-3.
  3685         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3686         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3687                                   PIC S99V9(5) COMP-3.
  3688         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3689         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3690         16  CP-EXPIRE-DT          PIC XX.
  3691         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3692         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3693         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3694         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3695         16  CP-DDF-SPEC-CALC      PIC X.
  3696             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3697             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  70
* EL050.cbl
  3698         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3699         16  CP-CANCEL-REASON      PIC X.
  3700         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3701         16  CP-PMT-MODE           PIC X.
  3702         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3703         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3704         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3705         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3706         16  FILLER                PIC X.
  3707
  3708***************    OUTPUT FROM ELRESV   ************************
  3709
  3710         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3711
  3712         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  FILLER                PIC X(09).
  3721***************    OUTPUT FROM ELRTRM   *************************
  3722
  3723         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3726                                     COMP-3.
  3727         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3730                                     COMP-3.
  3731         16  FILLER                PIC X(12).
  3732
  3733***************    OUTPUT FROM ELRAMT   *************************
  3734
  3735         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  FILLER                PIC X(12).
  3740
  3741***************    OUTPUT FROM ELRATE   *************************
  3742
  3743         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-MORTALITY-CODE     PIC X(4).
  3748         16  CP-RATE-EDIT-FLAG     PIC X.
  3749             88  CP-RATES-NEED-APR                  VALUE '1'.
  3750         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3753         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3754         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3755                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  71
* EL050.cbl
  3756         16  FILLER                PIC X(07).
  3757
  3758***************    OUTPUT FROM ELRFND   *************************
  3759
  3760         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-REFUND-TYPE-USED   PIC X.
  3763           88  CP-R-AS-R78                         VALUE '1'.
  3764           88  CP-R-AS-PRORATA                     VALUE '2'.
  3765           88  CP-R-AS-CALIF                       VALUE '3'.
  3766           88  CP-R-AS-TEXAS                       VALUE '4'.
  3767           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3768           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3769           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3770           88  CP-R-AS-MEAN                        VALUE '8'.
  3771           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3772           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3773           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3774           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3775           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3776           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3777         16  FILLER                PIC X(12).
  3778
  3779***************    OUTPUT FROM ELEARN   *************************
  3780
  3781         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3786                                     COMP-3.
  3787         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3788                                     COMP-3.
  3789         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-EARNING-TYPE-USED  PIC X.
  3794           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3795           88  CP-E-AS-R78                         VALUE '1'.
  3796           88  CP-E-AS-PRORATA                     VALUE '2'.
  3797           88  CP-E-AS-TEXAS                       VALUE '4'.
  3798           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3799           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3800           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3801           88  CP-E-AS-MEAN                        VALUE '8'.
  3802           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3803         16  FILLER                PIC X(12).
  3804
  3805***************    OUTPUT FROM ELPMNT   *************************
  3806
  3807         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  FILLER                PIC X(12).
  3812
  3813***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  72
* EL050.cbl
  3814         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3827             88  OPEN-RATE-FILE                   VALUE 'O'.
  3828             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3829             88  IO-ERROR                         VALUE 'E'.
  3830
  3831         16  CP-FIRST-PAY-DATE     PIC XX.
  3832
  3833         16  CP-JOINT-INDICATOR    PIC X.
  3834
  3835         16  CP-RESERVE-REMAINING-TERM
  3836                                   PIC S9(4)V9    VALUE ZERO
  3837                                     COMP-3.
  3838
  3839         16  CP-INSURED-BIRTH-DT   PIC XX.
  3840
  3841         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3842                                     COMP-3.
  3843
  3844         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3845                                     COMP-3.
  3846
  3847         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3848                                     COMP-3.
  3849
  3850         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3851                                     COMP-3.
  3852
  3853         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3854                                     COMP-3.
  3855
  3856         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3857                                     COMP-3.
  3858
  3859         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861
  3862         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3863             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3864
  3865         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3870         16  FILLER                PIC X(15).
  3871******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  73
* EL050.cbl
  3873******************************************************************
  3874*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3875*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3876*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3877*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3878*** MODIFICATION.                                              ***
  3879*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3880*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3881******************************************************************
  3882*    COPY ERCPNDB.
  3883******************************************************************
  3884*                                                                *
  3885*                                                                *
  3886*                            ERCPNDB.                            *
  3887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3888*                            VMOD=2.025                          *
  3889*                                                                *
  3890*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3891*                                                                *
  3892******************************************************************
  3893*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3894*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3895******************************************************************
  3896*                                                                *
  3897*                                                                *
  3898*   FILE TYPE = VSAM,KSDS                                        *
  3899*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3900*                                                                *
  3901*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3902*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3903*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3904*                                                 RKP=13,LEN=36  *
  3905*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3906*                                      AND CHG-SEQ.)             *
  3907*                                                RKP=49,LEN=11   *
  3908*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3909*                                      AND CHG-SEQ.)             *
  3910*                                                RKP=60,LEN=15   *
  3911*                                                                *
  3912*   LOG = NO                                                     *
  3913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3914******************************************************************
  3915******************************************************************
  3916*                   C H A N G E   L O G
  3917*
  3918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3919*-----------------------------------------------------------------
  3920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3921* EFFECTIVE    NUMBER
  3922*-----------------------------------------------------------------
  3923* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3924* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3925* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3926* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3927* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3928* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3929* 032306                   PEMA  ADD BOW LOAN NUMBER
  3930* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  74
* EL050.cbl
  3931* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3932* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3933* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3934* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3935* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3936* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3937* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3938* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3939******************************************************************
  3940
  3941 01  PENDING-BUSINESS.
  3942     12  PB-RECORD-ID                     PIC XX.
  3943         88  VALID-PB-ID                        VALUE 'PB'.
  3944
  3945     12  PB-CONTROL-PRIMARY.
  3946         16  PB-COMPANY-CD                PIC X.
  3947         16  PB-ENTRY-BATCH               PIC X(6).
  3948         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3949         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3950
  3951     12  PB-CONTROL-BY-ACCOUNT.
  3952         16  PB-COMPANY-CD-A1             PIC X.
  3953         16  PB-CARRIER                   PIC X.
  3954         16  PB-GROUPING.
  3955             20  PB-GROUPING-PREFIX       PIC XXX.
  3956             20  PB-GROUPING-PRIME        PIC XXX.
  3957         16  PB-STATE                     PIC XX.
  3958         16  PB-ACCOUNT.
  3959             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3960             20  PB-ACCOUNT-PRIME         PIC X(6).
  3961         16  PB-CERT-EFF-DT               PIC XX.
  3962         16  PB-CERT-NO.
  3963             20  PB-CERT-PRIME            PIC X(10).
  3964             20  PB-CERT-SFX              PIC X.
  3965         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3966
  3967         16  PB-RECORD-TYPE               PIC X.
  3968             88  PB-MAILING-DATA                VALUE '0'.
  3969             88  PB-ISSUE                       VALUE '1'.
  3970             88  PB-CANCELLATION                VALUE '2'.
  3971             88  PB-BATCH-TRAILER               VALUE '9'.
  3972
  3973     12  PB-CONTROL-BY-ORIG-BATCH.
  3974         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3975         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3976         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3977         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3978
  3979     12  PB-CONTROL-BY-CSR.
  3980         16  PB-CSR-COMPANY-CD            PIC X.
  3981         16  PB-CSR-ID                    PIC X(4).
  3982         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3983         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3984         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3985******************************************************************
  3986*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3987******************************************************************
  3988
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  75
* EL050.cbl
  3989     12  PB-LAST-MAINT-DT                 PIC XX.
  3990     12  PB-LAST-MAINT-BY                 PIC X(4).
  3991     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3992
  3993     12  PB-RECORD-BODY                   PIC X(375).
  3994
  3995     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3996         16  PB-CERT-ORIGIN               PIC X.
  3997             88  CLASIC-CREATED-CERT         VALUE '1'.
  3998         16  PB-I-NAME.
  3999             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4000             20  PB-I-INSURED-FIRST-NAME.
  4001                 24  PB-I-INSURED-1ST-INIT PIC X.
  4002                 24  FILLER                PIC X(9).
  4003             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4004         16  PB-I-AGE                     PIC S99   COMP-3.
  4005         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4006         16  PB-I-BIRTHDAY                PIC XX.
  4007         16  PB-I-INSURED-SEX             PIC X.
  4008             88  PB-SEX-MALE     VALUE 'M'.
  4009             88  PB-SEX-FEMALE   VALUE 'F'.
  4010
  4011         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4012         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4013         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4014         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4015         16  PB-I-SKIP-CODE               PIC X.
  4016             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4017             88  PB-SKIP-JULY              VALUE '1'.
  4018             88  PB-SKIP-AUGUST            VALUE '2'.
  4019             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4020             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4021             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4022             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4023             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4024             88  PB-SKIP-JUNE              VALUE '8'.
  4025             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4026             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4027             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4028         16  PB-I-TERM-TYPE               PIC X.
  4029             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4030             88  PB-PAID-WEEKLY            VALUE 'W'.
  4031             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4032             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4033             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4034         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4035         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4036         16  PB-I-DATA-ENTRY-SW           PIC X.
  4037             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4038             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4039             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4040             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4041         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4042         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4043*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4044         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4045         16  FILLER                       PIC X.
  4046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  76
* EL050.cbl
  4047         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4048             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4049             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4050                                                   '90' THRU '99'.
  4051         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4052                                          PIC XX.
  4053         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4054         16  PB-I-AMOUNT-FINANCED REDEFINES
  4055                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4056         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4057         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4058                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4059         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4060         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4061         16  PB-I-CLP-AMOUNT REDEFINES
  4062                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4063         16  PB-I-LF-CALC-FLAG            PIC X.
  4064             88 PB-COMP-LF-PREM               VALUE '?'.
  4065         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4066         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4067         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4068         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4069         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4070         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4071         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4072         16  PB-I-LF-ABBR                 PIC XXX.
  4073         16  PB-I-LF-INPUT-CD             PIC XX.
  4074
  4075         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4076             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4077             88  PB-INVALID-AH               VALUE '  ' '00'
  4078                                                   '90' THRU '99'.
  4079         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4080         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4081         16  PB-I-AH-CALC-FLAG            PIC X.
  4082             88 PB-COMP-AH-PREM                  VALUE '?'.
  4083         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4084         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4085         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4086         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4087         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4088         16  PB-I-AH-ABBR                 PIC XXX.
  4089         16  PB-I-AH-INPUT-CD             PIC XXX.
  4090
  4091         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4092         16  PB-I-REIN-TABLE              PIC XXX.
  4093         16  PB-I-BUSINESS-TYPE           PIC 99.
  4094         16  PB-I-INDV-GRP-CD             PIC X.
  4095         16  PB-I-MORT-CODE.
  4096             20  PB-I-TABLE               PIC X.
  4097             20  PB-I-INTEREST            PIC XX.
  4098             20  PB-I-MORT-TYP            PIC X.
  4099         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4100         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4101         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4102         16  PB-I-INDV-GRP-OVRD           PIC X.
  4103         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4104         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  77
* EL050.cbl
  4105             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4106         16  PB-I-RATE-CLASS              PIC XX.
  4107         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4108         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4109         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4110         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4111         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4112         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4113         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4114         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4115         16  PB-I-OB-FLAG                 PIC X.
  4116             88  PB-I-OB                      VALUE 'B'.
  4117             88  PB-I-SUMMARY                 VALUE 'Z'.
  4118         16  PB-I-ENTRY-STATUS            PIC X.
  4119             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4120                                              'M' '5' '9' '2'.
  4121             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4122             88  PB-I-POLICY-PENDING          VALUE '2'.
  4123             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4124             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4125             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4126             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4127             88  PB-I-REIN-ONLY               VALUE '9'.
  4128             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4129             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4130             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4131             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4132         16  PB-I-INT-CODE                PIC X.
  4133             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4134             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4135         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4136         16  PB-I-SOC-SEC-NO              PIC X(11).
  4137         16  PB-I-MEMBER-NO               PIC X(12).
  4138         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4139*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4140         16  PB-I-OLD-LOF                 PIC XXX.
  4141         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4142         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4143         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4144         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4145         16  PB-I-LIFE-INDICATOR          PIC X.
  4146             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4147         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4148         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4149                                          PIC S9(5)V99    COMP-3.
  4150         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4151             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4152             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4153         16  PB-I-1ST-PMT-DT              PIC XX.
  4154         16  PB-I-JOINT-INSURED.
  4155             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4156             20 PB-I-JOINT-FIRST-NAME.
  4157                24  PB-I-JOINT-FIRST-INIT PIC X.
  4158                24  FILLER                PIC X(9).
  4159             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4160*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4161         16  PB-I-BENEFICIARY-NAME.
  4162             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  78
* EL050.cbl
  4163             20  FILLER                   PIC X(15).
  4164         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4165         16  PB-I-REFERENCE               PIC X(12).
  4166         16  FILLER REDEFINES PB-I-REFERENCE.
  4167             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4168             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4169             20  PB-I-CLP-STATE           PIC XX.
  4170         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4171             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4172             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4173             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4174         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4175         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4176         16  PB-I-RESIDENT-STATE          PIC XX.
  4177         16  PB-I-RATE-CODE               PIC X(4).
  4178         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4179         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4180         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4181         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4182         16  PB-I-BANK-NOCHRGB            PIC 99.
  4183         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4184         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4185
  4186     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4187         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4188             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4189         16  PB-C-CANCEL-ORIGIN           PIC X.
  4190             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4191         16  PB-C-LF-CANCEL-DT            PIC XX.
  4192         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4193         16  PB-C-LF-CALC-REQ             PIC X.
  4194             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4195         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4196         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4197         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4198             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4199         16  PB-C-AH-CANCEL-DT            PIC XX.
  4200         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4201         16  PB-C-AH-CALC-REQ             PIC X.
  4202             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4203         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4204         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4205         16  PB-C-LAST-NAME               PIC X(15).
  4206         16  PB-C-REFUND-SW               PIC X.
  4207             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4208             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4209         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4210         16  PB-C-PAYEE-CODE              PIC X(6).
  4211         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4212         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4213         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4214         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4215         16  PB-C-REFERENCE               PIC X(12).
  4216         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4217         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4218         16  PB-C-POST-CARD-IND           PIC X.
  4219         16  PB-C-CANCEL-REASON           PIC X.
  4220         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  79
* EL050.cbl
  4221         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4222         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4223         16  FILLER                       PIC X(01).
  4224*        16  FILLER                       PIC X(18).
  4225         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4226*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4227         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4228         16  PB-CANCELED-CERT-DATA.
  4229             20  PB-CI-INSURED-NAME.
  4230                 24  PB-CI-LAST-NAME      PIC X(15).
  4231                 24  PB-CI-INITIALS       PIC XX.
  4232             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4233             20  PB-CI-INSURED-SEX        PIC X.
  4234             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4235             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4236             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4237             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4238             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4241             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4242             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4243             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4244             20  PB-CI-RATE-CLASS         PIC XX.
  4245             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4246             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4247             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4248             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4249             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4250             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4251             20  PB-CI-LF-ABBR            PIC X(3).
  4252             20  PB-CI-AH-ABBR            PIC X(3).
  4253             20  PB-CI-OB-FLAG            PIC X.
  4254                 88  PB-CI-OB                VALUE 'B'.
  4255             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4256                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4257                                           'M' '4' '5' '9' '2'.
  4258                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4259                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4260                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4261                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4262                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4263                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4264                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4265                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4266                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4267                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4268                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4269                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4270                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4271             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4272                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4273                                           'M' '4' '5' '9' '2'.
  4274                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4275                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4276                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4277                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4278                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  80
* EL050.cbl
  4279                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4280                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4281                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4282                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4283                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4284                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4285                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4286                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4287             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4288             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4289             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4290             20  PB-CI-MEMBER-NO          PIC X(12).
  4291             20  PB-CI-INT-CODE           PIC X.
  4292                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4293                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4294             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4295             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4296             20  PB-CI-COMP-EXCP-SW       PIC X.
  4297                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4298                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4299             20  PB-CI-ENTRY-STATUS       PIC X.
  4300             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4301             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4302             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4303             20  PB-CI-DEATH-DT           PIC XX.
  4304             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4305             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4306             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4307             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4308             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4309             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4310             20  PB-CI-ENTRY-DT              PIC XX.
  4311             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4312             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4313             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4314             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4315             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4316             20  PB-CI-OLD-LOF               PIC XXX.
  4317*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4318             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4319             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4320             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4321             20  PB-CI-INDV-GRP-CD           PIC X.
  4322             20  PB-CI-BENEFICIARY-NAME.
  4323                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4324                 24  FILLER                  PIC X(15).
  4325             20  PB-CI-NOTE-SW               PIC X.
  4326             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4327             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4328             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4329             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4330             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4331             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4332             20  PB-CI-FIRST-NAME            PIC X(10).
  4333             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4334
  4335         16  FILLER                       PIC X(13).
  4336*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  81
* EL050.cbl
  4337*        16  FILLER                       PIC X(46).
  4338
  4339     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4340         16  FILLER                       PIC X(10).
  4341         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4342         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4343         16  PB-M-INSURED-MID-INIT        PIC X.
  4344         16  PB-M-INSURED-AGE             PIC 99.
  4345         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4346         16  PB-M-INSURED-SEX             PIC X.
  4347         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4348         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4349         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4350         16  PB-M-INSURED-CITY-STATE.
  4351             20  PB-M-INSURED-CITY        PIC X(28).
  4352             20  PB-M-INSURED-STATE       PIC XX.
  4353         16  PB-M-INSURED-ZIP-CODE.
  4354             20  PB-M-INSURED-ZIP-PRIME.
  4355                 24  PB-M-INSURED-ZIP-1   PIC X.
  4356                     88  PB-M-CANADIAN-POST-CODE
  4357                                             VALUE 'A' THRU 'Z'.
  4358                 24  FILLER               PIC X(4).
  4359             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4360         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4361                                        PB-M-INSURED-ZIP-CODE.
  4362             20  PM-M-INS-CAN-POST1       PIC XXX.
  4363             20  PM-M-INS-CAN-POST2       PIC XXX.
  4364             20  FILLER                   PIC XXX.
  4365         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4366         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4367         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4368         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4369         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4370         16  PB-M-CRED-BENE-CITYST.
  4371             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4372             20  PB-M-CRED-BENE-STATE     PIC XX.
  4373         16  FILLER                       PIC X(92).
  4374
  4375     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4376         16  FILLER                       PIC X(10).
  4377         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4379         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4382         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4384         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4388         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4389         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4390         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4391         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4392         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4393         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4394         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  82
* EL050.cbl
  4395         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4396         16  PB-REFERENCE                 PIC X(12).
  4397         16  PB-B-RECEIVED-DT             PIC XX.
  4398         16  FILLER                       PIC X(234).
  4399
  4400     12  PB-RECORD-STATUS.
  4401         16  PB-CREDIT-SELECT-DT          PIC XX.
  4402         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4403         16  PB-BILLED-DT                 PIC XX.
  4404         16  PB-BILLING-STATUS            PIC X.
  4405             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4406             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4407             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4408         16  PB-RECORD-BILL               PIC X.
  4409             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4410             88  PB-RECORD-RETURNED           VALUE 'R'.
  4411             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4412             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4413             88  PB-OVERRIDE-AH               VALUE 'A'.
  4414             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4415         16  PB-BATCH-ENTRY               PIC X.
  4416             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4417             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4418             88  PB-REISSUED-CERT             VALUE 'E'.
  4419             88  PB-CASH-CERT                 VALUE 'C'.
  4420             88  PB-MONTHLY-CERT              VALUE 'M'.
  4421             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4422             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4423             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4424         16  PB-FORCE-CODE                PIC X.
  4425             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4426             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4427             88  PB-CANCEL-FORCE              VALUE '8'.
  4428             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4429             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4430             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4431             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4432             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4433             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4434             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4435         16  PB-FATAL-FLAG                PIC X.
  4436             88  PB-FATAL-ERRORS              VALUE 'X'.
  4437         16  PB-FORCE-ER-CD               PIC X.
  4438             88  PB-FORCE-ERRORS              VALUE 'F'.
  4439             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4440         16  PB-WARN-ER-CD                PIC X.
  4441             88  PB-WARNING-ERRORS            VALUE 'W'.
  4442         16  FILLER                       PIC X.
  4443         16  PB-OUT-BAL-CD                PIC X.
  4444             88  PB-OUT-OF-BAL                VALUE 'O'.
  4445         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4446         16  PB-AH-OVERRIDE-L1            PIC X.
  4447         16  PB-INPUT-DT                  PIC XX.
  4448         16  PB-INPUT-BY                  PIC X(4).
  4449         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4450         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4451         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4452         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  83
* EL050.cbl
  4453         16  PB-AH-EARNING-METHOD         PIC X.
  4454         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4455         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4456         16  PB-REIN-CD                   PIC XXX.
  4457         16  PB-LF-REFUND-TYPE            PIC X.
  4458         16  PB-AH-REFUND-TYPE            PIC X.
  4459         16  PB-ACCT-EFF-DT               PIC XX.
  4460         16  PB-ACCT-EXP-DT               PIC XX.
  4461         16  PB-COMPANY-ID                PIC X(3).
  4462         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4463         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4464         16  PB-SV-CARRIER                PIC X.
  4465         16  PB-SV-GROUPING               PIC X(6).
  4466         16  PB-SV-STATE                  PIC XX.
  4467         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4468         16  PB-GA-BILLING-INFO.
  4469             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4470                                          PIC XX.
  4471         16  PB-SV-REMIT-TO  REDEFINES
  4472             PB-GA-BILLING-INFO           PIC X(10).
  4473         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4474         16  PB-I-LOAN-OFFICER            PIC X(5).
  4475         16  PB-I-VIN                     PIC X(17).
  4476
  4477         16  FILLER                       PIC X(04).
  4478         16  IMNET-BYPASS-SW              PIC X.
  4479
  4480******************************************************************
  4481*                COMMON EDIT ERRORS                              *
  4482******************************************************************
  4483
  4484     12  PB-COMMON-ERRORS.
  4485         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4486                                           PIC S9(4)     COMP.
  4487
  4488******************************************************************
  4489
  4490* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4491*    COPY ELC50W1.
  4492******************************************************************
  4493*                                                                *
  4494*                                                                *
  4495*                             ELC50W1                            *
  4496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4497*                            VMOD=2.004                          *
  4498*                                                                *
  4499*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4500*                                                                *
  4501*                                                                *
  4502******************************************************************
  4503
  4504     12  WK-WORK-AREA.
  4505         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4506         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4507         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4508         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4509         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4510         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  84
* EL050.cbl
  4511         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4512         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4513         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4514         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4515         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4516         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4517         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4518         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4519         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4520         16  WK-CREDIT-EDIT-CONTROLS.
  4521             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4522             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4523             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4524             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4525             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4526             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4527         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4528         16  WK-SAVE-REIN-DATA.
  4529             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4530             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4531             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4532         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4533             88  ENTRY-FROM-EL6311       VALUE '6'.
  4534         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4535         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4536     12  WK-RECORD-ADDRESSES.
  4537         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4538         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4539         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4540         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4541         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4542         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4543         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4544         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4545     12  WK-OVER-SHORT-AREA.
  4546         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4547         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4548         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4549             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4550         16  FILLER                   PIC X(5) VALUE SPACES.
  4551
  4552*    COPY ELCEDITC.
  4553******************************************************************
  4554*                                                                *
  4555*                                                                *
  4556*                            ELCEDITC                            *
  4557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4558*                            VMOD=2.012                          *
  4559*                                                                *
  4560*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4561*                     EL6313, EL050 AND EL517.                   *
  4562*                                                                *
  4563******************************************************************
  4564******************************************************************
  4565*                   C H A N G E   L O G
  4566*
  4567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4568*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  85
* EL050.cbl
  4569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4570* EFFECTIVE    NUMBER
  4571*-----------------------------------------------------------------
  4572* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4573******************************************************************
  4574
  4575     12  EDIT-CRITERIA-DATA.
  4576         16  EC-CO-MONTH-END-DT       PIC XX.
  4577         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4578         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4579         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4580         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4581         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4582         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4583         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4584         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4585         16  EC-CO-REM-TERM-CALC      PIC X.
  4586               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4587               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4588               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4589               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4590
  4591         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4592               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4593               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4594               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4595               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4596               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4597               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4598               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4599               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4600               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4601               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4602
  4603         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4604               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4605               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4606               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4607               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4608               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4609               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4610               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4611               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4612
  4613         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4614                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4615                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4616
  4617         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4618                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4619                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4620                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4621                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4622                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4623                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4624                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4625                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4626
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  86
* EL050.cbl
  4627         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4628               88  EC-BR-REDUCING                   VALUE 'R'.
  4629               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4630
  4631         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4632         16  EC-BR-LF-DESC             PIC X(10).
  4633         16  EC-BR-AH-DESC             PIC X(10).
  4634         16  EC-BR-LF-COMMENT          PIC X(10).
  4635         16  EC-BR-AH-COMMENT          PIC X(10).
  4636
  4637         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4638               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4639               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4640               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4641               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4642
  4643         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4644               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4645               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4646               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4647               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4648
  4649         16  EC-BR-LF-REFUND-CALC      PIC X.
  4650                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4651                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4652                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-BR-AH-REFUND-CALC      PIC X.
  4659                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4669                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4670                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4671                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4672
  4673         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4674                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4675                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4676                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4677
  4678         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4679         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4680         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4681         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4682
  4683         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4684         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  87
* EL050.cbl
  4685                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4686                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4687                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4688                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4689
  4690         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4691               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4692               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4693               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4694               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4695               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4696
  4697         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4698               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4699               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4700               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4701               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4702               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4703
  4704         16  EC-ST-LF-REFUND-CALC      PIC X.
  4705                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4706                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4707                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4708                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-ST-AH-REFUND-CALC      PIC X.
  4715                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4725         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4726         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4727         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4728         16  EC-AM-EXPIRATION-DT       PIC XX.
  4729         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4730         16  EC-AM-CLASS-CD            PIC XX.
  4731         16  EC-AM-LF-DEVIATION        PIC XXX.
  4732         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4733         16  EC-AM-AH-DEVIATION        PIC XXX.
  4734         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4735         16  EC-AM-PHONE-NO            PIC X(10).
  4736
  4737         16  EC-AM-LF-REFUND-CALC      PIC X.
  4738                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4739                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4740                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4741                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4742                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  88
* EL050.cbl
  4743                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4744                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4745
  4746         16  EC-AM-AH-REFUND-CALC      PIC X.
  4747                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4748                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4749                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4750                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4751                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4752                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4753                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4754
  4755         16  EC-AM-BEN-I-G-CD          PIC X.
  4756                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4757                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4758                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4759
  4760         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4761         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4762         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4763         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4764         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4765         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4766         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4767         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4768         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4769
  4770         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4771         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4772         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4773         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4774         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4775         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4776         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4777         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4778         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4779         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4780         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4781         16  EC-RT-LF-NSP-ST           PIC XX.
  4782         16  EC-RT-AH-NSP-ST           PIC XX.
  4783         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4784         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4785
  4786         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4787             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4788                                             'M' '5' '9' '2'.
  4789             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4790             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4791             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4792             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4793             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4794             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4795             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4796             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4797             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4798             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4799
  4800         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  89
* EL050.cbl
  4801             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4802                                             'M' '5' '9' '2'.
  4803             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4804             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4805             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4806             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4807             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4808             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4809             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4810             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4811             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4812             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4813
  4814         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4815         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4816         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4817         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4818         16  EC-CM-DEATH-DT            PIC XX.
  4819
  4820*DMD CUSTOM CODING FIELDS BELOW
  4821*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4822         16  EC-BR-DMD-RATING-SW       PIC X.
  4823                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4824                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4825                 88  NO-DMD-RATING               VALUE 'N'.
  4826
  4827         16  EC-NEW-CERT               PIC X(11).
  4828         16  EC-NEW-STATE              PIC XX.
  4829         16  FILLER                    PIC X.
  4830*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4831         16  OVER-SHORT-EDIT-FIELDS.
  4832             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4833             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4834             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4835             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4836             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4837             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4838             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4839             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4840             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4841         16  FILLER                    PIC X(71).
  4842******************************************************************
  4843
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  90
* EL050.cbl
  4845*    COPY ELCDIFRD.
  4846******************************************************************
  4847*                                                                *
  4848*                                                                *
  4849*                            ELCDIFRD.                           *
  4850*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4851*                            VMOD=2.004                          *
  4852*                                                                *
  4853*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4854*                                                                *
  4855******************************************************************
  4856*
  4857  01  WS-DIFFERENCE-CALCULATION.
  4858        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4859        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4860        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4861        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4862        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4863        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4864        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4865        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4866        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4867        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4868        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  91
* EL050.cbl
  4871****************************************************************
  4872*
  4873* Copyright (c) 2007 by Clerity Solutions, Inc.
  4874* All rights reserved.
  4875*
  4876****************************************************************
  4877 01  DFHEIV.
  4878   02  DFHEIV0               PIC X(35).
  4879   02  DFHEIV1               PIC X(08).
  4880   02  DFHEIV2               PIC X(08).
  4881   02  DFHEIV3               PIC X(08).
  4882   02  DFHEIV4               PIC X(06).
  4883   02  DFHEIV5               PIC X(04).
  4884   02  DFHEIV6               PIC X(04).
  4885   02  DFHEIV7               PIC X(02).
  4886   02  DFHEIV8               PIC X(02).
  4887   02  DFHEIV9               PIC X(01).
  4888   02  DFHEIV10              PIC S9(7) COMP-3.
  4889   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4890   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4891   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4892   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4893   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4894   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4895   02  DFHEIV17              PIC X(04).
  4896   02  DFHEIV18              PIC X(04).
  4897   02  DFHEIV19              PIC X(04).
  4898   02  DFHEIV20              USAGE IS POINTER.
  4899   02  DFHEIV21              USAGE IS POINTER.
  4900   02  DFHEIV22              USAGE IS POINTER.
  4901   02  DFHEIV23              USAGE IS POINTER.
  4902   02  DFHEIV24              USAGE IS POINTER.
  4903   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4904   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4905   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4906   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4907   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4908   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4909   02  FILLER                PIC X(02).
  4910   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4911   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4912   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4913   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4914   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4915 LINKAGE  SECTION.
  4916*****************************************************************
  4917*                                                               *
  4918* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4919* All rights reserved.                                          *
  4920*                                                               *
  4921*****************************************************************
  4922 01  dfheiblk.
  4923     02  eibtime          pic s9(7) comp-3.
  4924     02  eibdate          pic s9(7) comp-3.
  4925     02  eibtrnid         pic x(4).
  4926     02  eibtaskn         pic s9(7) comp-3.
  4927     02  eibtrmid         pic x(4).
  4928     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  92
* EL050.cbl
  4929     02  eibcposn         pic s9(4) comp.
  4930     02  eibcalen         pic s9(4) comp.
  4931     02  eibaid           pic x(1).
  4932     02  eibfiller1       pic x(1).
  4933     02  eibfn            pic x(2).
  4934     02  eibfiller2       pic x(2).
  4935     02  eibrcode         pic x(6).
  4936     02  eibfiller3       pic x(2).
  4937     02  eibds            pic x(8).
  4938     02  eibreqid         pic x(8).
  4939     02  eibrsrce         pic x(8).
  4940     02  eibsync          pic x(1).
  4941     02  eibfree          pic x(1).
  4942     02  eibrecv          pic x(1).
  4943     02  eibsend          pic x(1).
  4944     02  eibatt           pic x(1).
  4945     02  eibeoc           pic x(1).
  4946     02  eibfmh           pic x(1).
  4947     02  eibcompl         pic x(1).
  4948     02  eibsig           pic x(1).
  4949     02  eibconf          pic x(1).
  4950     02  eiberr           pic x(1).
  4951     02  eibrldbk         pic x(1).
  4952     02  eiberrcd         pic x(4).
  4953     02  eibsynrb         pic x(1).
  4954     02  eibnodat         pic x(1).
  4955     02  eibfiller5       pic x(2).
  4956     02  eibresp          pic 9(09) comp.
  4957     02  eibresp2         pic 9(09) comp.
  4958     02  dfheigdj         pic s9(4) comp.
  4959     02  dfheigdk         pic s9(4) comp.
  4960
  4961 01  DFHCOMMAREA                   PIC X(1036).
  4962
  4963*01 PARMLIST .
  4964*    02  FILLER                    PIC S9(8)   COMP.
  4965*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4966*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4967*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4968*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4969*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4970*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4971*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4972
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  93
* EL050.cbl
  4974*    COPY ELCCNTL.
  4975******************************************************************
  4976*                                                                *
  4977*                                                                *
  4978*                            ELCCNTL.                            *
  4979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4980*                            VMOD=2.059                          *
  4981*                                                                *
  4982*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4983*                                                                *
  4984*   FILE TYPE = VSAM,KSDS                                        *
  4985*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4986*                                                                *
  4987*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4988*       ALTERNATE INDEX = NONE                                   *
  4989*                                                                *
  4990*   LOG = YES                                                    *
  4991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4992******************************************************************
  4993*                   C H A N G E   L O G
  4994*
  4995* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4996*-----------------------------------------------------------------
  4997*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4998* EFFECTIVE    NUMBER
  4999*-----------------------------------------------------------------
  5000* 082503                   PEMA  ADD BENEFIT GROUP
  5001* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5002* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5003* 092705    2005050300006  PEMA  ADD SPP LEASES
  5004* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5005* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5006* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5007* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5008* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5009* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5010* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5011* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5012* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5013* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5014******************************************************************
  5015*
  5016 01  CONTROL-FILE.
  5017     12  CF-RECORD-ID                       PIC XX.
  5018         88  VALID-CF-ID                        VALUE 'CF'.
  5019
  5020     12  CF-CONTROL-PRIMARY.
  5021         16  CF-COMPANY-ID                  PIC XXX.
  5022         16  CF-RECORD-TYPE                 PIC X.
  5023             88  CF-COMPANY-MASTER              VALUE '1'.
  5024             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5025             88  CF-STATE-MASTER                VALUE '3'.
  5026             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5027             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5028             88  CF-CARRIER-MASTER              VALUE '6'.
  5029             88  CF-MORTALITY-MASTER            VALUE '7'.
  5030             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5031             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  94
* EL050.cbl
  5032             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5033             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5034             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5035             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5036             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5037             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5038             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5039             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5040             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5041         16  CF-ACCESS-CD-GENL              PIC X(4).
  5042         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5043             20  CF-PROCESSOR               PIC X(4).
  5044         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5045             20  CF-STATE-CODE              PIC XX.
  5046             20  FILLER                     PIC XX.
  5047         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5048             20  FILLER                     PIC XX.
  5049             20  CF-HI-BEN-IN-REC           PIC XX.
  5050         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5051             20  FILLER                     PIC XXX.
  5052             20  CF-CARRIER-CNTL            PIC X.
  5053         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5054             20  FILLER                     PIC XX.
  5055             20  CF-HI-TYPE-IN-REC          PIC 99.
  5056         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5057             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5058                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5059             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5060             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5061         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5062             20  FILLER                     PIC X.
  5063             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5064         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5065             20  FILLER                     PIC XX.
  5066             20  CF-MORTGAGE-PLAN           PIC XX.
  5067         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5068
  5069     12  CF-LAST-MAINT-DT                   PIC XX.
  5070     12  CF-LAST-MAINT-BY                   PIC X(4).
  5071     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5072
  5073     12  CF-RECORD-BODY                     PIC X(728).
  5074
  5075
  5076****************************************************************
  5077*             COMPANY MASTER RECORD                            *
  5078****************************************************************
  5079
  5080     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5081         16  CF-COMPANY-ADDRESS.
  5082             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5083             20  CF-CL-IN-CARE-OF           PIC X(30).
  5084             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5085             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5086             20  CF-CL-CITY-STATE           PIC X(30).
  5087             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5088             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5089         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  95
* EL050.cbl
  5090         16  CF-COMPANY-PASSWORD            PIC X(8).
  5091         16  CF-SECURITY-OPTION             PIC X.
  5092             88  ALL-SECURITY                   VALUE '1'.
  5093             88  COMPANY-VERIFY                 VALUE '2'.
  5094             88  PROCESSOR-VERIFY               VALUE '3'.
  5095             88  NO-SECURITY                    VALUE '4'.
  5096             88  ALL-BUT-TERM                   VALUE '5'.
  5097         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5098             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5099         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5100             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5101         16  CF-INFORCE-LOCATION            PIC X.
  5102             88  CERTS-ARE-ONLINE               VALUE '1'.
  5103             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5104             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5105         16  CF-LOWER-CASE-LETTERS          PIC X.
  5106         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5107             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5108             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5109             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5110             88  CF-ACCNT-CNTL                  VALUE '3'.
  5111             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5112
  5113         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5114         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5115
  5116         16  CF-LGX-CREDIT-USER             PIC X.
  5117             88  CO-IS-NOT-USER                 VALUE 'N'.
  5118             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5119
  5120         16 CF-CREDIT-CALC-CODES.
  5121             20  CF-CR-REM-TERM-CALC PIC X.
  5122               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5123               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5124               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5125               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5126               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5127               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5128               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5129             20  CF-CR-R78-METHOD           PIC X.
  5130               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5131               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5132
  5133         16  CF-CLAIM-CONTROL-COUNTS.
  5134             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5135                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5136
  5137             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5138                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5139
  5140             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5141                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5142
  5143             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5144                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5145
  5146         16  CF-CURRENT-MONTH-END           PIC XX.
  5147
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  96
* EL050.cbl
  5148         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5149             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5150             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5151             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5152             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5153                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5154                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5155             20  CF-CO-PREM-REJECT-SW       PIC X.
  5156                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5157                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5158             20  CF-CO-REF-REJECT-SW        PIC X.
  5159                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5160                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5161
  5162         16  CF-CO-REPORTING-DT             PIC XX.
  5163         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5164         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5165           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5166           88  CF-CO-MONTH-END                  VALUE '1'.
  5167
  5168         16  CF-LGX-CLAIM-USER              PIC X.
  5169             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5170             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5171
  5172         16  CF-CREDIT-EDIT-CONTROLS.
  5173             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5174             20  CF-MIN-AGE                 PIC 99.
  5175             20  CF-DEFAULT-AGE             PIC 99.
  5176             20  CF-MIN-TERM                PIC S999      COMP-3.
  5177             20  CF-MAX-TERM                PIC S999      COMP-3.
  5178             20  CF-DEFAULT-SEX             PIC X.
  5179             20  CF-JOINT-AGE-INPUT         PIC X.
  5180                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5181             20  CF-BIRTH-DATE-INPUT        PIC X.
  5182                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5183             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5184                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5185                 88  CF-ZERO-CARRIER            VALUE '1'.
  5186                 88  CF-ZERO-GROUPING           VALUE '2'.
  5187                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5188             20  CF-EDIT-SW                 PIC X.
  5189                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5190             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5191             20  CF-CR-PR-METHOD            PIC X.
  5192               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5193               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5194             20  FILLER                     PIC X.
  5195
  5196         16  CF-CREDIT-MISC-CONTROLS.
  5197             20  CF-REIN-TABLE-SW           PIC X.
  5198                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5199             20  CF-COMP-TABLE-SW           PIC X.
  5200                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5201             20  CF-EXPERIENCE-RETENTION-AGE
  5202                                            PIC S9        COMP-3.
  5203             20  CF-CONVERSION-DT           PIC XX.
  5204             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5205             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  97
* EL050.cbl
  5206                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5207                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5208
  5209             20  CF-CR-CHECK-NO-CONTROL.
  5210                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5211                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5212                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5213                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5214                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5215                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5216
  5217                 24  CF-CR-CHECK-COUNT       REDEFINES
  5218                     CF-CR-CHECK-COUNTER      PIC X(4).
  5219
  5220                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5221                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5222
  5223                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5224                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5225                 24  CF-MAIL-PROCESSING       PIC X.
  5226                     88  MAIL-PROCESSING          VALUE 'Y'.
  5227
  5228         16  CF-MISC-SYSTEM-CONTROL.
  5229             20  CF-SYSTEM-C                 PIC X.
  5230                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5231             20  CF-SYSTEM-D                 PIC X.
  5232                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5233             20  CF-SOC-SEC-NO-SW            PIC X.
  5234                 88  SOC-SEC-NO-USED             VALUE '1'.
  5235             20  CF-MEMBER-NO-SW             PIC X.
  5236                 88  MEMBER-NO-USED              VALUE '1'.
  5237             20  CF-TAX-ID-NUMBER            PIC X(11).
  5238             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5239             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5240                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5241                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5242                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5243                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5244             20  CF-SYSTEM-E                 PIC X.
  5245                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5246
  5247         16  CF-LGX-LIFE-USER               PIC X.
  5248             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5249             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5250
  5251         16  CF-CR-MONTH-END-DT             PIC XX.
  5252
  5253         16  CF-FILE-MAINT-DATES.
  5254             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5255                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5256             20  CF-LAST-BATCH       REDEFINES
  5257                 CF-LAST-BATCH-NO               PIC X(4).
  5258             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5259             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5260             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5261             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5262             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5263             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  98
* EL050.cbl
  5264             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5265             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5266             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5267             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5268
  5269         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5270         16  FILLER                         PIC X.
  5271
  5272         16  CF-ALT-MORT-CODE               PIC X(4).
  5273         16  CF-MEMBER-CAPTION              PIC X(10).
  5274
  5275         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5276             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5277             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5278             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5279             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5280             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5281
  5282         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5283
  5284         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5285         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5286         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5287         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5288
  5289         16  CF-AH-OVERRIDE-L1              PIC X.
  5290         16  CF-AH-OVERRIDE-L2              PIC XX.
  5291         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5292         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5293
  5294         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5295         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5296
  5297         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5298         16  CF-AR-LAST-EL860-DT            PIC XX.
  5299         16  CF-MP-MONTH-END-DT             PIC XX.
  5300
  5301         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5302         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5303             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5304
  5305         16  CF-AR-MONTH-END-DT             PIC XX.
  5306
  5307         16  CF-CRDTCRD-USER                PIC X.
  5308             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5309             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5310
  5311         16  CF-CC-MONTH-END-DT             PIC XX.
  5312
  5313         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5314
  5315         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5316             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5317             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5318             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5319         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5320         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5321         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page  99
* EL050.cbl
  5322         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5323             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5324             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5325         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5326         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5327         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5328             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5329         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5330
  5331         16  CF-CL-ZIP-CODE.
  5332             20  CF-CL-ZIP-PRIME.
  5333                 24  CF-CL-ZIP-1ST          PIC X.
  5334                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5335                 24  FILLER                 PIC X(4).
  5336             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5337         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5338             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5339             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5340             20  FILLER                     PIC XXX.
  5341
  5342         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5343         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5344         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5345         16  CF-CO-OPTION-START-DATE        PIC XX.
  5346         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5347           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5348                                                      '3' '4'.
  5349           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5350           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5351           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5352           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5353           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5354           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5355
  5356         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5357
  5358         16  CF-PAYMENT-APPROVAL-LEVELS.
  5359             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5360             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5361             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5362             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5363             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5364             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5365
  5366         16  CF-END-USER-REPORTING-USER     PIC X.
  5367             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5368             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5369
  5370         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5371             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5372             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5373
  5374         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5375
  5376         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5377         16  FILLER                         PIC X.
  5378
  5379         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 100
* EL050.cbl
  5380             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5381             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5382             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5383
  5384         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5385
  5386         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5387             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5388             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5389
  5390         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5391             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5392             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5393
  5394         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5395
  5396         16  CF-CO-ACH-ID-CODE              PIC  X.
  5397             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5398             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5399             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5400         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5401         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5402         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5403         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5404         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5405         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5406         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5407         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5408         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5409                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5410         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5411                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5412
  5413         16  CF-CO-OVER-SHORT.
  5414             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5415             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5416
  5417*         16  FILLER                         PIC X(102).
  5418         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5419             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-AH-APPROVAL-DAYS.
  5423             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5424             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5425             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5426             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5427
  5428         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5429
  5430         16  CF-APPROV-LEV-5.
  5431             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5432             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5433             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5434
  5435         16  FILLER                         PIC X(68).
  5436****************************************************************
  5437*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 101
* EL050.cbl
  5438****************************************************************
  5439
  5440     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5441         16  CF-PROCESSOR-NAME              PIC X(30).
  5442         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5443         16  CF-PROCESSOR-TITLE             PIC X(26).
  5444         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5445                 88  MESSAGE-YES                VALUE 'Y'.
  5446                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5447
  5448*****************************************************
  5449****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5450****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5451****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5452****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5453*****************************************************
  5454
  5455         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5456             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5457             20  CF-APPLICATION-FORCE       PIC X.
  5458             20  CF-INDIVIDUAL-APP.
  5459                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5460                     28  CF-BROWSE-APP      PIC X.
  5461                     28  CF-UPDATE-APP      PIC X.
  5462
  5463         16  CF-CURRENT-TERM-ON             PIC X(4).
  5464         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5465             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5466             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5467             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5468             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5469             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5470             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5471             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5472         16  CF-PROCESSOR-CARRIER           PIC X.
  5473             88  NO-CARRIER-SECURITY            VALUE ' '.
  5474         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5475             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5476         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5477             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5478         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5479             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5480
  5481         16  CF-PROC-SYS-ACCESS-SW.
  5482             20  CF-PROC-CREDIT-CLAIMS-SW.
  5483                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5484                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5485                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5486                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5487             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5488                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5489                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5490             20  CF-PROC-LIFE-GNRLDGR-SW.
  5491                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5492                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5493                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5494                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5495             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 102
* EL050.cbl
  5496                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5497                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5498         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5499             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5500             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5501         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5502
  5503         16  CF-APPROVAL-LEVEL                  PIC X.
  5504             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5505             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5506             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5507             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5508             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5509
  5510         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5511
  5512         16  CF-LANGUAGE-TYPE                   PIC X.
  5513             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5514             88  CF-LANG-IS-FR                      VALUE 'F'.
  5515
  5516         16  CF-CSR-IND                         PIC X.
  5517         16  FILLER                             PIC X(239).
  5518
  5519****************************************************************
  5520*             PROCESSOR/REMINDERS RECORD                       *
  5521****************************************************************
  5522
  5523     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5524         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5525             20  CF-START-REMIND-DT         PIC XX.
  5526             20  CF-END-REMIND-DT           PIC XX.
  5527             20  CF-REMINDER-TEXT           PIC X(50).
  5528         16  FILLER                         PIC X(296).
  5529
  5530
  5531****************************************************************
  5532*             STATE MASTER RECORD                              *
  5533****************************************************************
  5534
  5535     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5536         16  CF-STATE-ABBREVIATION          PIC XX.
  5537         16  CF-STATE-NAME                  PIC X(25).
  5538         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5539         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5540             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5541             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5542             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5543             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5544                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5545                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5546             20  CF-ST-PREM-REJECT-SW       PIC X.
  5547                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5548                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5549             20  CF-ST-REF-REJECT-SW        PIC X.
  5550                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5551                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5552         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5553         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 103
* EL050.cbl
  5554         16  CF-ST-REFUND-RULES.
  5555             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5556             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5557             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5558         16  CF-ST-FST-PMT-EXTENSION.
  5559             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5560             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5561                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5562                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5563                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5564                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5565         16  CF-ST-STATE-CALL.
  5566             20  CF-ST-CALL-UNEARNED        PIC X.
  5567             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5568             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5569         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5570             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5571             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5572         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5573         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5574         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5575         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5576         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5577         16  FILLER                         PIC X.
  5578         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5579             20  CF-ST-BENEFIT-CD           PIC XX.
  5580             20  CF-ST-BENEFIT-KIND         PIC X.
  5581                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5582                 88  CF-ST-AH-KIND              VALUE 'A'.
  5583             20  CF-ST-REM-TERM-CALC        PIC X.
  5584                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5585                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5586                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5587                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5588                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5589                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5590                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5591                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5592
  5593             20  CF-ST-REFUND-CALC          PIC X.
  5594                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5595                 88  ST-REFD-BY-R78             VALUE '1'.
  5596                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5597                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5598                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5599                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5600                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5601                 88  ST-REFD-UTAH               VALUE '7'.
  5602                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5603                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5604                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5605
  5606             20  CF-ST-EARNING-CALC         PIC X.
  5607                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5608                 88  ST-EARN-BY-R78             VALUE '1'.
  5609                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5610                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5611                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 104
* EL050.cbl
  5612                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5613                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5614                 88  ST-EARN-MEAN               VALUE '8'.
  5615                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5616
  5617             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5618                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5619                 88  ST-OVRD-BY-R78             VALUE '1'.
  5620                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5621                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5622                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5623                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5624                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5625                 88  ST-OVRD-MEAN               VALUE '8'.
  5626                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5627             20  FILLER                     PIC X.
  5628
  5629         16  CF-ST-COMMISSION-CAPS.
  5630             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5631             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5632             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5633             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5634         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5635                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5636
  5637         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5638
  5639         16  CF-ST-STATUTORY-INTEREST.
  5640             20  CF-ST-STAT-DATE-FROM       PIC X.
  5641                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5642                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5643             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5644             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5645             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5646             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5647             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5648
  5649         16  CF-ST-OVER-SHORT.
  5650             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5651             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5652
  5653         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5654
  5655         16  CF-ST-RT-CALC                  PIC X.
  5656
  5657         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5658         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5659         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5660         16  CF-ST-RF-LR-CALC               PIC X.
  5661         16  CF-ST-RF-LL-CALC               PIC X.
  5662         16  CF-ST-RF-LN-CALC               PIC X.
  5663         16  CF-ST-RF-AH-CALC               PIC X.
  5664         16  CF-ST-RF-CP-CALC               PIC X.
  5665*        16  FILLER                         PIC X(206).
  5666*CIDMOD         16  FILLER                         PIC X(192).
  5667         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5668             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5669         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 105
* EL050.cbl
  5670         16  CF-ST-VFY-2ND-BENE             PIC X.
  5671         16  CF-ST-CAUSAL-STATE             PIC X.
  5672         16  FILLER                         PIC X(185).
  5673
  5674****************************************************************
  5675*             BENEFIT MASTER RECORD                            *
  5676****************************************************************
  5677
  5678     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5679         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5680             20  CF-BENEFIT-CODE            PIC XX.
  5681             20  CF-BENEFIT-NUMERIC  REDEFINES
  5682                 CF-BENEFIT-CODE            PIC XX.
  5683             20  CF-BENEFIT-ALPHA           PIC XXX.
  5684             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5685             20  CF-BENEFIT-COMMENT         PIC X(10).
  5686
  5687             20  CF-LF-COVERAGE-TYPE        PIC X.
  5688                 88  CF-REDUCING                VALUE 'R'.
  5689                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5690
  5691             20  CF-SPECIAL-CALC-CD         PIC X.
  5692                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5693                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5694                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5695                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5696                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5697                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5698                 88  CF-FARM-PLAN               VALUE 'F'.
  5699                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5700                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5701                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5702                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5703                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5704                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5705                 88  CF-PRUDENTIAL              VALUE 'P'.
  5706                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5707                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5708                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5709                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5710                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5711                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5712
  5713             20  CF-JOINT-INDICATOR         PIC X.
  5714                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5715
  5716*            20  FILLER                     PIC X(12).
  5717             20  cf-maximum-benefits        pic s999 comp-3.
  5718             20  FILLER                     PIC X(09).
  5719             20  CF-BENEFIT-CATEGORY        PIC X.
  5720             20  CF-LOAN-TYPE               PIC X(8).
  5721
  5722             20  CF-CO-REM-TERM-CALC        PIC X.
  5723                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5724                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5725                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5726                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5727                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 106
* EL050.cbl
  5728
  5729             20  CF-CO-EARNINGS-CALC        PIC X.
  5730                 88  CO-EARN-BY-R78             VALUE '1'.
  5731                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5732                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5733                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5734                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5735                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5736                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5737                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5738
  5739             20  CF-CO-REFUND-CALC          PIC X.
  5740                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5741                 88  CO-REFD-BY-R78             VALUE '1'.
  5742                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5743                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5744                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5745                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5746                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5747                 88  CO-REFD-MEAN               VALUE '8'.
  5748                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5749                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5750                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5751
  5752             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5753                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5754                 88  CO-OVRD-BY-R78             VALUE '1'.
  5755                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5756                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5757                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5758                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5759                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5760                 88  CO-OVRD-MEAN               VALUE '8'.
  5761                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5762
  5763             20  CF-CO-BEN-I-G-CD           PIC X.
  5764                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5765                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5766                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5767
  5768         16  FILLER                         PIC X(304).
  5769
  5770
  5771****************************************************************
  5772*             CARRIER MASTER RECORD                            *
  5773****************************************************************
  5774
  5775     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5776         16  CF-ADDRESS-DATA.
  5777             20  CF-MAIL-TO-NAME            PIC X(30).
  5778             20  CF-IN-CARE-OF              PIC X(30).
  5779             20  CF-ADDRESS-LINE-1          PIC X(30).
  5780             20  CF-ADDRESS-LINE-2          PIC X(30).
  5781             20  CF-CITY-STATE              PIC X(30).
  5782             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5783             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5784
  5785         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 107
* EL050.cbl
  5786             20  CF-CLAIM-NO-METHOD         PIC X.
  5787                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5788                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5789                 88  CLAIM-NO-SEQ               VALUE '3'.
  5790                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5791             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5792                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5793                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5794                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5795
  5796         16  CF-CHECK-NO-CONTROL.
  5797             20  CF-CHECK-NO-METHOD         PIC X.
  5798                 88  CHECK-NO-MANUAL            VALUE '1'.
  5799                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5800                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5801                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5802             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5803                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5804
  5805         16  CF-DOMICILE-STATE              PIC XX.
  5806
  5807         16  CF-EXPENSE-CONTROLS.
  5808             20  CF-EXPENSE-METHOD          PIC X.
  5809                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5810                 88  DOLLARS-PER-PMT            VALUE '2'.
  5811                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5812                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5813             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5814             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5815
  5816         16  CF-CORRESPONDENCE-CONTROL.
  5817             20  CF-LETTER-RESEND-OPT       PIC X.
  5818                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5819                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5820             20  FILLER                     PIC X(4).
  5821
  5822         16  CF-RESERVE-CONTROLS.
  5823             20  CF-MANUAL-SW               PIC X.
  5824                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5825             20  CF-FUTURE-SW               PIC X.
  5826                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5827             20  CF-PTC-SW                  PIC X.
  5828                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5829             20  CF-IBNR-SW                 PIC X.
  5830                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5831             20  CF-PTC-LF-SW               PIC X.
  5832                 88  CF-LF-PTC-USED             VALUE '1'.
  5833             20  CF-CDT-ACCESS-METHOD       PIC X.
  5834                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5835                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5836                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5837             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5838
  5839         16  CF-CLAIM-CALC-METHOD           PIC X.
  5840             88  360-PLUS-MONTHS                VALUE '1'.
  5841             88  365-PLUS-MONTHS                VALUE '2'.
  5842             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5843             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 108
* EL050.cbl
  5844             88  365-DAILY                      VALUE '5'.
  5845
  5846         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5847         16  FILLER                         PIC X(11).
  5848
  5849         16  CF-LIMIT-AMOUNTS.
  5850             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5851             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5852             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5853             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5854             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5855             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5856             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5857             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5858             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5859             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5860
  5861         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5862         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5863         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5864
  5865         16  CF-ZIP-CODE.
  5866             20  CF-ZIP-PRIME.
  5867                 24  CF-ZIP-1ST             PIC X.
  5868                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5869                 24  FILLER                 PIC X(4).
  5870             20  CF-ZIP-PLUS4               PIC X(4).
  5871         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5872             20  CF-CAN-POSTAL-1            PIC XXX.
  5873             20  CF-CAN-POSTAL-2            PIC XXX.
  5874             20  FILLER                     PIC XXX.
  5875
  5876         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5877         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5878         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5879
  5880         16  CF-RATING-SWITCH               PIC X.
  5881             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5882             88  CF-NO-RATING                   VALUE 'N'.
  5883
  5884         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5885
  5886         16  CF-CARRIER-OVER-SHORT.
  5887             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5888             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5889
  5890         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5891         16  CF-SECPAY-SWITCH               PIC X.
  5892             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5893             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5894         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5895         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5896         16  FILLER                         PIC X(444).
  5897*        16  FILLER                         PIC X(452).
  5898
  5899
  5900****************************************************************
  5901*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 109
* EL050.cbl
  5902****************************************************************
  5903
  5904     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5905         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5906                                INDEXED BY CF-MORT-NDX.
  5907             20  CF-MORT-TABLE              PIC X(5).
  5908             20  CF-MORT-TABLE-TYPE         PIC X.
  5909                 88  CF-MORT-JOINT              VALUE 'J'.
  5910                 88  CF-MORT-SINGLE             VALUE 'S'.
  5911                 88  CF-MORT-COMBINED           VALUE 'C'.
  5912                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5913                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5914             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5915             20  CF-MORT-AGE-METHOD         PIC XX.
  5916                 88  CF-AGE-LAST                VALUE 'AL'.
  5917                 88  CF-AGE-NEAR                VALUE 'AN'.
  5918             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5919             20  CF-MORT-ADJUSTMENT-DIRECTION
  5920                                            PIC X.
  5921                 88  CF-MINUS                   VALUE '-'.
  5922                 88  CF-PLUS                    VALUE '+'.
  5923             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5924             20  CF-MORT-JOINT-CODE         PIC X.
  5925                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5926             20  CF-MORT-PC-Q               PIC X.
  5927                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5928             20  CF-MORT-TABLE-CODE         PIC X(4).
  5929             20  CF-MORT-COMMENTS           PIC X(15).
  5930             20  FILLER                     PIC X(14).
  5931
  5932         16  FILLER                         PIC X(251).
  5933
  5934
  5935****************************************************************
  5936*             BUSSINESS TYPE MASTER RECORD                     *
  5937****************************************************************
  5938
  5939     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5940* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5941* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5942* AND RECORD 05 IS TYPES 81-99
  5943         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5944             20  CF-BUSINESS-TITLE          PIC  X(19).
  5945             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5946                                            PIC S9V9(4) COMP-3.
  5947             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5948             20  FILLER                     PIC  X.
  5949         16  FILLER                         PIC  X(248).
  5950
  5951
  5952****************************************************************
  5953*             TERMINAL MASTER RECORD                           *
  5954****************************************************************
  5955
  5956     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5957
  5958         16  CF-COMPANY-TERMINALS.
  5959             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 110
* EL050.cbl
  5960                                  PIC X(4).
  5961         16  FILLER               PIC X(248).
  5962
  5963
  5964****************************************************************
  5965*             LIFE EDIT MASTER RECORD                          *
  5966****************************************************************
  5967
  5968     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5969         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5970             20  CF-LIFE-CODE-IN            PIC XX.
  5971             20  CF-LIFE-CODE-OUT           PIC XX.
  5972         16  FILLER                         PIC X(248).
  5973
  5974
  5975****************************************************************
  5976*             AH EDIT MASTER RECORD                            *
  5977****************************************************************
  5978
  5979     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5980         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5981             20  CF-AH-CODE-IN              PIC XXX.
  5982             20  CF-AH-CODE-OUT             PIC XX.
  5983         16  FILLER                         PIC X(248).
  5984
  5985
  5986****************************************************************
  5987*             CREDIBILITY TABLES                               *
  5988****************************************************************
  5989
  5990     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5991         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5992                             INDEXED BY CF-CRDB-NDX.
  5993             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5994             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5995             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5996         16  FILLER                         PIC  X(332).
  5997
  5998
  5999****************************************************************
  6000*             REPORT CUSTOMIZATION RECORD                      *
  6001****************************************************************
  6002
  6003     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6004         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6005             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6006             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6007             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6008**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6009****       A T-TRANSFER.                                   ****
  6010             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6011
  6012         16  FILLER                         PIC XX.
  6013
  6014         16  CF-CARRIER-CNTL-OPT.
  6015             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6016                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 111
* EL050.cbl
  6018             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6019                                            PIC X.
  6020         16  CF-GROUP-CNTL-OPT.
  6021             20  CF-GROUP-OPT-SEQ           PIC 9.
  6022                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6024             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6025                                            PIC X(6).
  6026         16  CF-STATE-CNTL-OPT.
  6027             20  CF-STATE-OPT-SEQ           PIC 9.
  6028                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6029                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6030             20  CF-STATE-SELECT OCCURS 3 TIMES
  6031                                            PIC XX.
  6032         16  CF-ACCOUNT-CNTL-OPT.
  6033             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6034                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6035                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6036             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6037                                            PIC X(10).
  6038         16  CF-BUS-TYP-CNTL-OPT.
  6039             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6040                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6041                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6042             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6043                                            PIC XX.
  6044         16  CF-LF-TYP-CNTL-OPT.
  6045             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6046                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6047                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6048             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6049                                            PIC XX.
  6050         16  CF-AH-TYP-CNTL-OPT.
  6051             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6052                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6053                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6054             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6055                                            PIC XX.
  6056         16  CF-REPTCD1-CNTL-OPT.
  6057             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6058                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6059                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6060             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6061                                            PIC X(10).
  6062         16  CF-REPTCD2-CNTL-OPT.
  6063             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6064                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6065                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6066             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6067                                            PIC X(10).
  6068         16  CF-USER1-CNTL-OPT.
  6069             20  CF-USER1-OPT-SEQ           PIC 9.
  6070                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6072             20  CF-USER1-SELECT OCCURS 3 TIMES
  6073                                            PIC X(10).
  6074         16  CF-USER2-CNTL-OPT.
  6075             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 112
* EL050.cbl
  6076                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6078             20  CF-USER2-SELECT OCCURS 3 TIMES
  6079                                            PIC X(10).
  6080         16  CF-USER3-CNTL-OPT.
  6081             20  CF-USER3-OPT-SEQ           PIC 9.
  6082                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6083                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6084             20  CF-USER3-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086         16  CF-USER4-CNTL-OPT.
  6087             20  CF-USER4-OPT-SEQ           PIC 9.
  6088                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6089                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6090             20  CF-USER4-SELECT OCCURS 3 TIMES
  6091                                            PIC X(10).
  6092         16  CF-USER5-CNTL-OPT.
  6093             20  CF-USER5-OPT-SEQ           PIC 9.
  6094                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6095                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6096             20  CF-USER5-SELECT OCCURS 3 TIMES
  6097                                            PIC X(10).
  6098         16  CF-REINS-CNTL-OPT.
  6099             20  CF-REINS-OPT-SEQ           PIC 9.
  6100                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6101                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6102             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6103                 24  CF-REINS-PRIME         PIC XXX.
  6104                 24  CF-REINS-SUB           PIC XXX.
  6105
  6106         16  CF-AGENT-CNTL-OPT.
  6107             20  CF-AGENT-OPT-SEQ           PIC 9.
  6108                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6109                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6110             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112
  6113         16  FILLER                         PIC X(43).
  6114
  6115         16  CF-LOSS-RATIO-SELECT.
  6116             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6117             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6118         16  CF-ENTRY-DATE-SELECT.
  6119             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6120             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6121         16  CF-EFFECTIVE-DATE-SELECT.
  6122             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6123             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6124
  6125         16  CF-EXCEPTION-LIST-IND          PIC X.
  6126             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6127
  6128         16  FILLER                         PIC X(318).
  6129
  6130****************************************************************
  6131*                  EXCEPTION REPORTING RECORD                  *
  6132****************************************************************
  6133
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 113
* EL050.cbl
  6134     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6135         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6136             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6137
  6138         16  CF-COMBINED-LIFE-AH-OPT.
  6139             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6140             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6141             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6142             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6143
  6144         16  CF-LIFE-OPT.
  6145             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6146             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6147             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6148             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6149             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6150             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6151             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6152             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6153             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6154             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6155
  6156         16  CF-AH-OPT.
  6157             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6158             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6159             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6160             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6161             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6162             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6163             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6164             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6165             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6166             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6167
  6168         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6169             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6170             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6171             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6172
  6173         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6174
  6175         16  FILLER                         PIC X(673).
  6176
  6177
  6178****************************************************************
  6179*             MORTGAGE SYSTEM PLAN RECORD                      *
  6180****************************************************************
  6181
  6182     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6183         16  CF-PLAN-TYPE                   PIC X.
  6184             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6185             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6186             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6187         16  CF-PLAN-ABBREV                 PIC XXX.
  6188         16  CF-PLAN-DESCRIPT               PIC X(10).
  6189         16  CF-PLAN-NOTES                  PIC X(20).
  6190         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6191         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 114
* EL050.cbl
  6192             20  CF-PLAN-TERM-DATA.
  6193                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6194                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6195             20  CF-PLAN-AGE-DATA.
  6196                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6197                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6198                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6199             20  CF-PLAN-BENEFIT-DATA.
  6200                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6201                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6202                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6203                                            PIC S9(7)V99  COMP-3.
  6204         16  CF-PLAN-POLICY-FORMS.
  6205             20  CF-POLICY-FORM             PIC X(12).
  6206             20  CF-MASTER-APPLICATION      PIC X(12).
  6207             20  CF-MASTER-POLICY           PIC X(12).
  6208         16  CF-PLAN-RATING.
  6209             20  CF-RATE-CODE               PIC X(5).
  6210             20  CF-SEX-RATING              PIC X.
  6211                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6212                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6213             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6214             20  CF-SUB-STD-TYPE            PIC X.
  6215                 88  CF-PCT-OF-PREM            VALUE '1'.
  6216                 88  CF-PCT-OF-BENE            VALUE '2'.
  6217         16  CF-PLAN-PREM-TOLERANCES.
  6218             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6219             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6220         16  CF-PLAN-PYMT-TOLERANCES.
  6221             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6222             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6223         16  CF-PLAN-MISC-DATA.
  6224             20  FILLER                     PIC X.
  6225             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6226             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6227         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6228         16  CF-PLAN-IND-GRP                PIC X.
  6229             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6230                                                     '1'.
  6231             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6232                                                     '2'.
  6233         16  CF-MIB-SEARCH-SW               PIC X.
  6234             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6235             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6236             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6237             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6238         16  CF-ALPHA-SEARCH-SW             PIC X.
  6239             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6240             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6241             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6242             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6243             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6244             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6245             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6246             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6247             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6248             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6249                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 115
* EL050.cbl
  6250                                                     'X' 'Y' 'Z'.
  6251         16  CF-EFF-DT-RULE-SW              PIC X.
  6252             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6253             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6254             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6255             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6256             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6257         16  FILLER                         PIC X(4).
  6258         16  CF-HEALTH-QUESTIONS            PIC X.
  6259             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6260         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6261         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6262         16  CF-PLAN-SNGL-JNT               PIC X.
  6263             88  CF-COMBINED-PLAN              VALUE 'C'.
  6264             88  CF-JNT-PLAN                   VALUE 'J'.
  6265             88  CF-SNGL-PLAN                  VALUE 'S'.
  6266         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6267         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6268         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6269         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6270         16  CF-RERATE-CNTL                 PIC  X.
  6271             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6272             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6273             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6274             88  CF-AUTO-RECALC                 VALUE '4'.
  6275         16  CF-BENEFIT-TYPE                PIC  X.
  6276             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6277             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6278         16  CF-POLICY-FEE                  PIC S999V99
  6279                                                    COMP-3.
  6280         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6281         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6282         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6283         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6284         16  FILLER                         PIC  X(32).
  6285         16  CF-TERMINATION-FORM            PIC  X(04).
  6286         16  FILLER                         PIC  X(08).
  6287         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6288                                                       COMP-3.
  6289         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6290         16  CF-ISSUE-LETTER                PIC  X(4).
  6291         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6292         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6293             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6294             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6295         16  CF-MP-REFUND-CALC              PIC X.
  6296             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6297             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6298             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6299             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6300             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6301             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6302             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6303             88  CF-MP-REFD-MEAN                VALUE '8'.
  6304         16  CF-ALT-RATE-CODE               PIC  X(5).
  6305
  6306
  6307         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 116
* EL050.cbl
  6308****************************************************************
  6309*             MORTGAGE COMPANY MASTER RECORD                   *
  6310****************************************************************
  6311
  6312     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6313         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6314         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6315             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6316             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6317             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6318             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6319             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6320
  6321         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6322         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6323         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6324         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6325         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6326
  6327         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6328             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6329         16  CF-MP-RECON-USE-IND            PIC X(1).
  6330             88  CF-MP-USE-RECON             VALUE 'Y'.
  6331         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6332             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6333         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6334             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6335             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6336         16  FILLER                         PIC X(1).
  6337         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6338             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6339         16  CF-MORTG-MIB-VERSION           PIC X.
  6340             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6341             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6342             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6343         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6344             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6345                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6346             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6347                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6348             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6349                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6350             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6351                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6352             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6353                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6354             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6355                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6356         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6357         16  FILLER                         PIC X(7).
  6358         16  CF-MORTG-DESTINATION-SYMBOL.
  6359             20  CF-MORTG-MIB-COMM          PIC X(5).
  6360             20  CF-MORTG-MIB-TERM          PIC X(5).
  6361         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6362             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6363         16  FILLER                         PIC X(03).
  6364         16  CF-MP-CHECK-NO-CONTROL.
  6365             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 117
* EL050.cbl
  6366                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6367                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6368                                                ' ' LOW-VALUES.
  6369                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6370                                               VALUE '3'.
  6371         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6372         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6373         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6374             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6375                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6376             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6377                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6378             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6379                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6380             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6381                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6382             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6383                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6384             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6385                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6386         16  CF-MORTG-BILLING-AREA.
  6387             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6388                                            PIC X.
  6389         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6390         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6391         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6392         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6393             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6394             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6395         16  FILLER                         PIC X.
  6396         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6397             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6398             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6399         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6400         16  FILLER                         PIC X(8).
  6401         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6402         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6403         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6404         16  CF-ACH-COMPANY-ID.
  6405             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6406                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6407                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6408                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6409             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6410         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6411             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6412         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6413             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6414             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6415         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6416         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6417         16  FILLER                         PIC X(536).
  6418
  6419****************************************************************
  6420*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6421****************************************************************
  6422
  6423     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 118
* EL050.cbl
  6424         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6425             20  CF-FEMALE-HEIGHT.
  6426                 24  CF-FEMALE-FT           PIC 99.
  6427                 24  CF-FEMALE-IN           PIC 99.
  6428             20  CF-FEMALE-MIN-WT           PIC 999.
  6429             20  CF-FEMALE-MAX-WT           PIC 999.
  6430         16  FILLER                         PIC X(428).
  6431
  6432     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6433         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6434             20  CF-MALE-HEIGHT.
  6435                 24  CF-MALE-FT             PIC 99.
  6436                 24  CF-MALE-IN             PIC 99.
  6437             20  CF-MALE-MIN-WT             PIC 999.
  6438             20  CF-MALE-MAX-WT             PIC 999.
  6439         16  FILLER                         PIC X(428).
  6440******************************************************************
  6441*             AUTOMATIC ACTIVITY RECORD                          *
  6442******************************************************************
  6443     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6444         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6445             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6446             20  CF-SYS-LETTER-ID           PIC X(04).
  6447             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6448             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6449             20  CF-SYS-RESET-SW            PIC X(01).
  6450             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6451             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6452
  6453         16  FILLER                         PIC X(50).
  6454
  6455         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6456             20  CF-USER-ACTIVE-SW          PIC X(01).
  6457             20  CF-USER-LETTER-ID          PIC X(04).
  6458             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6459             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6460             20  CF-USER-RESET-SW           PIC X(01).
  6461             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6462             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6463             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6464
  6465         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 119
* EL050.cbl
  6467*    COPY ERCACCT.
  6468******************************************************************
  6469*                                                                *
  6470*                                                                *
  6471*                            ERCACCT                             *
  6472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.031                          *
  6474*                                                                *
  6475*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6476*                                                                *
  6477*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6478*   VSAM ACCOUNT MASTER FILES.                                   *
  6479*                                                                *
  6480*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6481*                                                                *
  6482*   FILE TYPE = VSAM,KSDS                                        *
  6483*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6484*                                                                *
  6485*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6486*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6487*                                                                *
  6488*   LOG = NO                                                     *
  6489*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6490*                                                                *
  6491*                                                                *
  6492******************************************************************
  6493*                   C H A N G E   L O G
  6494*
  6495* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6496*-----------------------------------------------------------------
  6497*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6498* EFFECTIVE    NUMBER
  6499*-----------------------------------------------------------------
  6500* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6501* 092705    2005050300006  PEMA  ADD SPP LEASES
  6502* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6503* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6504* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6505* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6506* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6507******************************************************************
  6508
  6509 01  ACCOUNT-MASTER.
  6510     12  AM-RECORD-ID                      PIC XX.
  6511         88  VALID-AM-ID                      VALUE 'AM'.
  6512
  6513     12  AM-CONTROL-PRIMARY.
  6514         16  AM-COMPANY-CD                 PIC X.
  6515         16  AM-MSTR-CNTRL.
  6516             20  AM-CONTROL-A.
  6517                 24  AM-CARRIER            PIC X.
  6518                 24  AM-GROUPING.
  6519                     28 AM-GROUPING-PREFIX PIC XXX.
  6520                     28 AM-GROUPING-PRIME  PIC XXX.
  6521                 24  AM-STATE              PIC XX.
  6522                 24  AM-ACCOUNT.
  6523                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6524                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 120
* EL050.cbl
  6525             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6526                                           PIC X(19).
  6527             20  AM-CNTRL-B.
  6528                 24  AM-EXPIRATION-DT      PIC XX.
  6529                 24  FILLER                PIC X(4).
  6530             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6531                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6532
  6533     12  AM-CONTROL-BY-VAR-GRP.
  6534         16  AM-COMPANY-CD-A1              PIC X.
  6535         16  AM-VG-CARRIER                 PIC X.
  6536         16  AM-VG-GROUPING                PIC X(6).
  6537         16  AM-VG-STATE                   PIC XX.
  6538         16  AM-VG-ACCOUNT                 PIC X(10).
  6539         16  AM-VG-DATE.
  6540             20  AM-VG-EXPIRATION-DT       PIC XX.
  6541             20  FILLER                    PIC X(4).
  6542         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6543                                           PIC 9(11)      COMP-3.
  6544     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6545         16  FILLER                        PIC X(10).
  6546         16  AM-VG-KEY3.
  6547             20  AM-VG3-ACCOUNT            PIC X(10).
  6548             20  AM-VG3-EXP-DT             PIC XX.
  6549         16  FILLER                        PIC X(4).
  6550     12  AM-MAINT-INFORMATION.
  6551         16  AM-LAST-MAINT-DT              PIC XX.
  6552         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6553         16  AM-LAST-MAINT-USER            PIC X(4).
  6554         16  FILLER                        PIC XX.
  6555
  6556     12  AM-EFFECTIVE-DT                   PIC XX.
  6557     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6558
  6559     12  AM-PREV-DATES  COMP-3.
  6560         16  AM-PREV-EXP-DT                PIC 9(11).
  6561         16  AM-PREV-EFF-DT                PIC 9(11).
  6562
  6563     12  AM-REPORT-CODE-1                  PIC X(10).
  6564     12  AM-REPORT-CODE-2                  PIC X(10).
  6565
  6566     12  AM-CITY-CODE                      PIC X(4).
  6567     12  AM-COUNTY-PARISH                  PIC X(6).
  6568
  6569     12  AM-NAME                           PIC X(30).
  6570     12  AM-PERSON                         PIC X(30).
  6571     12  AM-ADDRS                          PIC X(30).
  6572     12  AM-CITY.
  6573         16  AM-ADDR-CITY                  PIC X(28).
  6574         16  AM-ADDR-STATE                 PIC XX.
  6575     12  AM-ZIP.
  6576         16  AM-ZIP-PRIME.
  6577             20  AM-ZIP-PRI-1ST            PIC X.
  6578                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6579             20  FILLER                    PIC X(4).
  6580         16  AM-ZIP-PLUS4                  PIC X(4).
  6581     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6582         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 121
* EL050.cbl
  6583         16  AM-CAN-POSTAL-2               PIC XXX.
  6584         16  FILLER                        PIC XXX.
  6585     12  AM-TEL-NO.
  6586         16  AM-AREA-CODE                  PIC 999.
  6587         16  AM-TEL-PRE                    PIC 999.
  6588         16  AM-TEL-NBR                    PIC 9(4).
  6589     12  AM-TEL-LOC                        PIC X.
  6590         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6591         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6592
  6593     12  AM-COMM-STRUCTURE.
  6594         16  AM-DEFN-1.
  6595             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6596                 24  AM-AGT.
  6597                     28  AM-AGT-PREFIX     PIC X(4).
  6598                     28  AM-AGT-PRIME      PIC X(6).
  6599                 24  AM-COM-TYP            PIC X.
  6600                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6601                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6602                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6603                 24  AM-RECALC-LV-INDIC    PIC X.
  6604                 24  AM-RETRO-LV-INDIC     PIC X.
  6605                 24  AM-GL-CODES           PIC X.
  6606                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6607                 24  FILLER                PIC X(01).
  6608         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6609             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6610                 24  FILLER                PIC X(11).
  6611                 24  AM-L-COMA             PIC XXX.
  6612                 24  AM-J-COMA             PIC XXX.
  6613                 24  AM-A-COMA             PIC XXX.
  6614                 24  FILLER                PIC X(6).
  6615
  6616     12  AM-COMM-CHANGE-STATUS             PIC X.
  6617         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6618
  6619     12  AM-CSR-CODE                       PIC X(4).
  6620
  6621     12  AM-BILLING-STATUS                 PIC X.
  6622         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6623         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6624     12  AM-AUTO-REFUND-SW                 PIC X.
  6625         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6626         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6627     12  AM-GPCD                           PIC 99.
  6628     12  AM-IG                             PIC X.
  6629         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6630         88  AM-HAS-GROUP                     VALUE '2'.
  6631     12  AM-STATUS                         PIC X.
  6632         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6633         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6634         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6635         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6636         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6637         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6638     12  AM-REMIT-TO                       PIC 99.
  6639     12  AM-ID-NO                          PIC X(11).
  6640
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 122
* EL050.cbl
  6641     12  AM-CAL-TABLE                      PIC XX.
  6642     12  AM-LF-DEVIATION                   PIC XXX.
  6643     12  AM-AH-DEVIATION                   PIC XXX.
  6644     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6645     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6646     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6647     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6648     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6649     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6650
  6651     12  AM-USER-FIELDS.
  6652         16  AM-FLD-1                      PIC XX.
  6653         16  AM-FLD-2                      PIC XX.
  6654         16  AM-FLD-3                      PIC XX.
  6655         16  AM-FLD-4                      PIC XX.
  6656         16  AM-FLD-5                      PIC XX.
  6657
  6658     12  AM-1ST-PROD-DATE.
  6659         16  AM-1ST-PROD-YR                PIC XX.
  6660         16  AM-1ST-PROD-MO                PIC XX.
  6661         16  AM-1ST-PROD-DA                PIC XX.
  6662     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6663     12  AM-CERTS-PURGED-DATE.
  6664         16  AM-PUR-YR                     PIC XX.
  6665         16  AM-PUR-MO                     PIC XX.
  6666         16  AM-PUR-DA                     PIC XX.
  6667     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6668     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6669     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6670     12  AM-INACTIVE-DATE.
  6671         16  AM-INA-MO                     PIC 99.
  6672         16  AM-INA-DA                     PIC 99.
  6673         16  AM-INA-YR                     PIC 99.
  6674     12  AM-AR-HI-CERT-DATE                PIC XX.
  6675
  6676     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6677     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6678
  6679     12  AM-OB-PAYMENT-MODE                PIC X.
  6680         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6681         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6682         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6683         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6684
  6685     12  AM-AH-ONLY-INDICATOR              PIC X.
  6686         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6687         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6688
  6689     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6690
  6691     12  AM-OVER-SHORT.
  6692         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6693         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6694
  6695     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6696     12  AM-DCC-CLP-STATE                  PIC XX.
  6697
  6698     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 123
* EL050.cbl
  6699     12  AM-RECALC-REIN                    PIC X.
  6700
  6701     12  AM-REI-TABLE                      PIC XXX.
  6702     12  AM-REI-ET-LF                      PIC X.
  6703     12  AM-REI-ET-AH                      PIC X.
  6704     12  AM-REI-PE-LF                      PIC X.
  6705     12  AM-REI-PE-AH                      PIC X.
  6706     12  AM-REI-PRT-ST                     PIC X.
  6707     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6708     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-GROUP-A                    PIC X(6).
  6711     12  AM-REI-MORT                       PIC X(4).
  6712     12  AM-REI-PRT-OW                     PIC X.
  6713     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6714     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6715     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6716     12  AM-REI-GROUP-B                    PIC X(6).
  6717
  6718     12  AM-TRUST-TYPE                     PIC X(2).
  6719
  6720     12  AM-EMPLOYER-STMT-USED             PIC X.
  6721     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6722
  6723     12  AM-STD-AH-TYPE                    PIC XX.
  6724     12  AM-EARN-METHODS.
  6725         16  AM-EARN-METHOD-R              PIC X.
  6726             88 AM-REF-RL-R78                 VALUE 'R'.
  6727             88 AM-REF-RL-PR                  VALUE 'P'.
  6728             88 AM-REF-RL-MEAN                VALUE 'M'.
  6729             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6730         16  AM-EARN-METHOD-L              PIC X.
  6731             88 AM-REF-LL-R78                 VALUE 'R'.
  6732             88 AM-REF-LL-PR                  VALUE 'P'.
  6733             88 AM-REF-LL-MEAN                VALUE 'M'.
  6734             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6735         16  AM-EARN-METHOD-A              PIC X.
  6736             88 AM-REF-AH-R78                 VALUE 'R'.
  6737             88 AM-REF-AH-PR                  VALUE 'P'.
  6738             88 AM-REF-AH-MEAN                VALUE 'M'.
  6739             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6740             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6741             88 AM-REF-AH-NET                 VALUE 'N'.
  6742
  6743     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6744     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6745     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6746
  6747     12  AM-RET-Y-N                        PIC X.
  6748     12  AM-RET-P-E                        PIC X.
  6749     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6750     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6751     12  AM-RET-GRP                        PIC X(6).
  6752     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6753         16  AM-POOL-PRIME                 PIC XXX.
  6754         16  AM-POOL-SUB                   PIC XXX.
  6755     12  AM-RETRO-EARNINGS.
  6756         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 124
* EL050.cbl
  6757         16  AM-RET-EARN-L                 PIC X.
  6758         16  AM-RET-EARN-A                 PIC X.
  6759     12  AM-RET-ST-TAX-USE                 PIC X.
  6760         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6761         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6762     12  AM-RETRO-BEG-EARNINGS.
  6763         16  AM-RET-BEG-EARN-R             PIC X.
  6764         16  AM-RET-BEG-EARN-L             PIC X.
  6765         16  AM-RET-BEG-EARN-A             PIC X.
  6766     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6767     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6768
  6769     12  AM-USER-SELECT-OPTIONS.
  6770         16  AM-USER-SELECT-1              PIC X(10).
  6771         16  AM-USER-SELECT-2              PIC X(10).
  6772         16  AM-USER-SELECT-3              PIC X(10).
  6773         16  AM-USER-SELECT-4              PIC X(10).
  6774         16  AM-USER-SELECT-5              PIC X(10).
  6775
  6776     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6777
  6778     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6779
  6780     12  AM-RPT045A-SWITCH                 PIC X.
  6781         88  RPT045A-OFF                   VALUE 'N'.
  6782
  6783     12  AM-INSURANCE-LIMITS.
  6784         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6785         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6786
  6787     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6788         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6789
  6790     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6791         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6792         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6793
  6794     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6795
  6796     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6797     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6798     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6799     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6800     12  AM-DCC-UEF-STATE                  PIC XX.
  6801     12  FILLER                            PIC XXX.
  6802     12  AM-REPORT-CODE-3                  PIC X(10).
  6803*    12  FILLER                            PIC X(22).
  6804
  6805     12  AM-RESERVE-DATE.
  6806         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6807         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6808         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6809
  6810     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6811     12  AM-NOTIFICATION-TYPES.
  6812         16  AM-NOTIF-OF-LETTERS           PIC X.
  6813         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6814         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 125
* EL050.cbl
  6815         16  AM-NOTIF-OF-STATUS            PIC X.
  6816
  6817     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6818         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6819         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6820         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6821         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6822
  6823     12  AM-BENEFIT-CONTROLS.
  6824         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6825             20  AM-BENEFIT-CODE           PIC XX.
  6826             20  AM-BENEFIT-TYPE           PIC X.
  6827             20  AM-BENEFIT-REVISION       PIC XXX.
  6828             20  AM-BENEFIT-REM-TERM       PIC X.
  6829             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6830             20  FILLER                    PIC XX.
  6831         16  FILLER                        PIC X(80).
  6832
  6833     12  AM-TRANSFER-DATA.
  6834         16  AM-TRANSFERRED-FROM.
  6835             20  AM-TRNFROM-CARRIER        PIC X.
  6836             20  AM-TRNFROM-GROUPING.
  6837                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6838                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6839             20  AM-TRNFROM-STATE          PIC XX.
  6840             20  AM-TRNFROM-ACCOUNT.
  6841                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6842                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6843             20  AM-TRNFROM-DTE            PIC XX.
  6844         16  AM-TRANSFERRED-TO.
  6845             20  AM-TRNTO-CARRIER          PIC X.
  6846             20  AM-TRNTO-GROUPING.
  6847                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6848                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6849             20  AM-TRNTO-STATE            PIC XX.
  6850             20  AM-TRNTO-ACCOUNT.
  6851                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6852                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6853             20  AM-TRNTO-DTE              PIC XX.
  6854         16  FILLER                        PIC X(10).
  6855
  6856     12  AM-SAVED-REMIT-TO                 PIC 99.
  6857
  6858     12  AM-COMM-STRUCTURE-SAVED.
  6859         16  AM-DEFN-1-SAVED.
  6860             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6861                 24  AM-AGT-SV             PIC X(10).
  6862                 24  AM-COM-TYP-SV         PIC X.
  6863                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6864                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6865                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6866                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6867                 24  FILLER                PIC X.
  6868                 24  AM-GL-CODES-SV        PIC X.
  6869                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6870                 24  FILLER                PIC X.
  6871         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6872             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 126
* EL050.cbl
  6873                 24  FILLER                PIC X(11).
  6874                 24  AM-L-COMA-SV          PIC XXX.
  6875                 24  AM-J-COMA-SV          PIC XXX.
  6876                 24  AM-A-COMA-SV          PIC XXX.
  6877                 24  FILLER                PIC X(6).
  6878
  6879     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6880         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6881            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6882            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6883            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6884
  6885     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6886     12  FILLER                            PIC X(120).
  6887
  6888     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6889         16  AM-CONTROL-NAME               PIC X(30).
  6890         16  AM-EXECUTIVE-ONE.
  6891             20  AM-EXEC1-NAME             PIC X(15).
  6892             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6893                                                          COMP-3.
  6894             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6895                                                          COMP-3.
  6896         16  AM-EXECUTIVE-TWO.
  6897             20  AM-EXEC2-NAME             PIC X(15).
  6898             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6899                                                          COMP-3.
  6900             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6901                                                          COMP-3.
  6902
  6903     12  AM-RETRO-ADDITIONAL-DATA.
  6904         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6905         16  AM-RETRO-PREM-P-E             PIC X.
  6906         16  AM-RETRO-CLMS-P-I             PIC X.
  6907         16  AM-RETRO-RET-BRACKET-LF.
  6908             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6909                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6910                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6911             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6912                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6913                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6914             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6915                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6916                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6917         16  AM-RETRO-RET-BRACKET-AH.
  6918             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6919                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6920                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6921                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6922             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6923                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6924                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6925             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6926                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6927                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6928
  6929     12  AM-COMMENTS.
  6930         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 127
* EL050.cbl
  6931
  6932     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6933         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6934         16  AM-FLI-BILLING-CODE           PIC X.
  6935         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6936         16  AM-FLI-UNITED-IDENT           PIC X.
  6937         16  AM-FLI-INTEREST-LOST-DATA.
  6938             20  AM-FLI-BANK-NO            PIC X(5).
  6939             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6940             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6941             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6942         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6943             20  AM-FLI-AGT                PIC X(9).
  6944             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6945             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6946         16  FILLER                        PIC X(102).
  6947
  6948     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6949         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6950             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6951             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6952             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6953             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6954             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6955         16  FILLER                          PIC X(10).
  6956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 128
* EL050.cbl
  6958*    COPY ERCREIN.
  6959******************************************************************
  6960*                                                                *
  6961*                            ERCREIN                             *
  6962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6963*                            VMOD=2.010                          *
  6964*                                                                *
  6965*   ONLINE CREDIT SYSTEM                                         *
  6966*                                                                *
  6967*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6968*                                                                *
  6969*   FILE TYPE = VSAM,KSDS                                        *
  6970*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6971*                                                                *
  6972*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6973*       ALTERNATE PATH = NONE                                    *
  6974*                                                                *
  6975*   LOG = NO                                                     *
  6976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6977*                                                                *
  6978******************************************************************
  6979*                   C H A N G E   L O G
  6980*
  6981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6982*-----------------------------------------------------------------
  6983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6984* EFFECTIVE    NUMBER
  6985*-----------------------------------------------------------------
  6986* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6987* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6988******************************************************************
  6989 01  REINSURANCE-RECORD.
  6990     12  RE-RECORD-ID                      PIC XX.
  6991         88  VALID-RE-ID                      VALUE 'RE'.
  6992
  6993     12  RE-CONTROL-PRIMARY.
  6994         16  RE-COMPANY-CD                 PIC X.
  6995         16  RE-KEY.
  6996             20  RE-CODE                   PIC X.
  6997                 88  RE-TABLE-RECORD          VALUE 'A'.
  6998                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6999             20  RE-TABLE                  PIC XXX.
  7000             20  FILLER                    PIC XXX.
  7001         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7002             20  FILLER                    PIC X.
  7003             20  RE-COMPANY.
  7004                 24  RE-COMP-PRIME         PIC XXX.
  7005                 24  RE-COMP-SUB           PIC XXX.
  7006
  7007     12  RE-MAINT-INFORMATION.
  7008         16  RE-LAST-MAINT-DT              PIC XX.
  7009         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7010         16  RE-LAST-MAINT-USER            PIC X(4).
  7011         16  FILLER                        PIC X(10).
  7012
  7013     12  RE-TABLE-DATA.
  7014         16  RE-100-COMP                   PIC 99.
  7015
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 129
* EL050.cbl
  7016         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7017             20  RE-REI-COMP-NO.
  7018                 24  RE-REI-COMP           PIC XXX.
  7019                 24  RE-REI-COMP-SUB       PIC XXX.
  7020             20  RE-LF-QC                  PIC X.
  7021             20  RE-AH-QC                  PIC X.
  7022             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7023             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7024             20  RE-LFAGE-LO               PIC 99.
  7025             20  RE-LFAGE-HI               PIC 99.
  7026             20  RE-AHAGE-LO               PIC 99.
  7027             20  RE-AHAGE-HI               PIC 99.
  7028             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7029             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7030             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7031             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7032             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7033             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7034             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7035             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7036             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7037             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7038             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7039             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7040             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7041             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7042             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7043             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7044             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7045             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7046             20  RE-LF-BEN-CODE            PIC X.
  7047             20  RE-AH-BEN-CODE            PIC X.
  7048             20  RE-INTERACTIVE            PIC X.
  7049             20  RE-REMAINING              PIC X.
  7050             20  RE-LF-RUNOFF-SW           PIC X.
  7051             20  RE-AH-RUNOFF-SW           PIC X.
  7052             20  FILLER                    PIC X(19).
  7053
  7054         16  RE-COMP-INFO-END              PIC X(6).
  7055         16  RE-NSP-ST-CD-LF               PIC XX.
  7056         16  RE-NSP-ST-CD-AH               PIC XX.
  7057         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7058             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7059
  7060         16  FILLER                        PIC X(27).
  7061
  7062     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7063         16  RE-NAME                       PIC X(30).
  7064         16  RE-LF-PE                      PIC X.
  7065         16  RE-AH-PE                      PIC X.
  7066         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7067         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7068         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7069         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7070         16  RE-PRT-ST                     PIC X.
  7071         16  RE-PRT-OW                     PIC X.
  7072         16  RE-MORT-CODE                  PIC X(4).
  7073         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 130
* EL050.cbl
  7074         16  RE-ZERO-LF-FEE                PIC X.
  7075         16  RE-ZERO-AH-FEE                PIC X.
  7076         16  RE-CEDE-NAME                  PIC X(30).
  7077         16  RE-LF-COMM                    PIC X.
  7078         16  RE-AH-COMM                    PIC X.
  7079         16  RE-LF-TAX                     PIC X.
  7080         16  RE-AH-TAX                     PIC X.
  7081         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7082         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7083         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7084
  7085         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7086             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7087
  7088         16  RE-LF-CEDING-FEE-BRACKETS.
  7089             20  RE-LF-FEE-METHOD          PIC X.
  7090                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7091                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7092                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7093                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7094             20  RE-LF-FEE-BASIS           PIC X.
  7095                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7096                 88  RE-LF-NET-CEDED               VALUE '2'.
  7097                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7098                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7099                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7100                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7101                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7102                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7103             20  FILLER                    PIC XXX.
  7104             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7105                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7106                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7107
  7108         16  RE-AH-CEDING-FEE-BRACKETS.
  7109             20  RE-AH-FEE-METHOD          PIC X.
  7110                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7111                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7112                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7113                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7114             20  RE-AH-FEE-BASIS           PIC X.
  7115                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7116                 88  RE-AH-NET-CEDED               VALUE '2'.
  7117                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7118                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7119                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7120                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7121                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7122                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7123             20  FILLER                    PIC XXX.
  7124             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7125                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7126                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7127
  7128         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7129
  7130         16  RE-OLD-CEDING-STMT            PIC X.
  7131
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 131
* EL050.cbl
  7132         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7133         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7134         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7135         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7136         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7139         16  RE-MORT-SW                    PIC X.
  7140         16  RE-CEDING-TYPE-FLAG           PIC X.
  7141             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7142             88  RE-CEDED                          VALUE 'C'.
  7143             88  RE-ASSUMED                        VALUE 'A'.
  7144             88  RE-PHANTOM                        VALUE 'P'.
  7145
  7146         16  RE-CEDING-STMT-OPT-A          PIC X.
  7147             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7148         16  RE-CEDING-STMT-OPT-B          PIC X.
  7149             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7150         16  RE-CEDING-STMT-OPT-C          PIC X.
  7151             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7152         16  RE-CEDING-STMT-OPT-D          PIC X.
  7153             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7154         16  RE-CEDING-STMT-OPT-E          PIC X.
  7155             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7156
  7157         16  RE-PRT-CRSV                   PIC X.
  7158
  7159         16  RE-GL-CENTER                  PIC X(4).
  7160
  7161         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7162
  7163         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7164
  7165         16  RE-EARN-STOP-CODE             PIC X.
  7166             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7167             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7168
  7169         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7170             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7171
  7172         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7173         16  FILLER                        PIC X(2281).
  7174
  7175         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7176
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 132
* EL050.cbl
  7179*    COPY ERCCTBL.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCCTBL                             *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.003
  7186*                                                                *
  7187*   ONLINE CREDIT SYSTEM                                         *
  7188*                                                                *
  7189*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7190*                                                                *
  7191*   FILE TYPE = VSAM,KSDS                                        *
  7192*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7193*                                                                *
  7194*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7195*       ALTERNATE PATH = NONE                                    *
  7196*                                                                *
  7197*   LOG = NO                                                     *
  7198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7199*                                                                *
  7200*                                                                *
  7201******************************************************************
  7202
  7203 01  COMM-TABLE-RECORD.
  7204     12  CT-RECORD-ID                      PIC XX.
  7205         88  VALID-CT-ID                      VALUE 'CT'.
  7206
  7207     12  CT-CONTROL-PRIMARY.
  7208         16  CT-COMPANY-CD                 PIC X.
  7209         16  CT-TABLE                      PIC XXX.
  7210         16  CT-CNTRL-2.
  7211             20  CT-BEN-TYPE               PIC X.
  7212             20  CT-BEN-CODE               PIC XX.
  7213
  7214     12  CT-MAINT-INFORMATION.
  7215         16  CT-LAST-MAINT-DT              PIC XX.
  7216         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7217         16  CT-LAST-MAINT-USER            PIC X(4).
  7218         16  FILLER                        PIC X(31).
  7219
  7220     12  CT-LIMITS.
  7221         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7222
  7223         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7224
  7225         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7226
  7227     12  CT-RATES.
  7228         16  CT-RTX          OCCURS 27 TIMES.
  7229             20  CT-RT                     PIC SV9(5)     COMP-3.
  7230             20  CT-RT-R   REDEFINES
  7231                 CT-RT                     PIC XXX.
  7232
  7233     12  FILLER                            PIC  X(42).
  7234
  7235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 133
* EL050.cbl
  7237*    COPY ERCFORM.
  7238******************************************************************
  7239*                                                                *
  7240*                                                                *
  7241*                            ERCFORM.                            *
  7242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7243*                            VMOD=2.003                          *
  7244*                                                                *
  7245*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7246*                                                                *
  7247*    FILE TYPE = VSAM,KSDS                                       *
  7248*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7249*                                                                *
  7250*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7251*                                                                *
  7252*    LOG = YES                                                   *
  7253*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7254******************************************************************
  7255 01  FORM-MASTER.
  7256    12  FO-RECORD-ID                 PIC X(02).
  7257        88  VALID-FO-ID                  VALUE 'FO'.
  7258
  7259    12  FO-CONTROL-PRIMARY.
  7260        16  FO-COMPANY-CD            PIC X(01).
  7261        16  FO-STATE                 PIC X(02).
  7262        16  FO-FORM-ID               PIC X(12).
  7263        16  FO-FORM-EXP-DT           PIC X(02).
  7264
  7265    12  FO-POLICY-FORM-DATA.
  7266        16  FO-IND-GRP-CD            PIC X(01).
  7267        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7268        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7269        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7270        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7271        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7272        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7273        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7274        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7275        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7276        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7277        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7278        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7279        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7280        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7281        16  FO-APP-CERT-USE-CD       PIC X(01).
  7282
  7283    12  FILLER                       PIC X(29).
  7284
  7285    12  FO-FORM-PLAN-TABLE.
  7286        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7287            20  FO-PLAN-TYPE         PIC X(01).
  7288            20  FO-PLAN-ID           PIC X(02).
  7289            20  FO-PLAN-TERM         PIC 9(03).
  7290            20  FO-PLAN-REFUND-METHOD
  7291                                     PIC X.
  7292
  7293    12  FILLER                       PIC X(30).
  7294
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 134
* EL050.cbl
  7295    12  FO-COMMENTS-AREA.
  7296        16  FO-COMMENT-LINE-1        PIC X(78).
  7297
  7298    12  FILLER                       PIC X(20).
  7299
  7300    12  FO-MAINT-INFORMATION.
  7301        16  FO-LAST-MAINT-DT         PIC X(02).
  7302        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7303        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 135
* EL050.cbl
  7305*    COPY ELCMSTR.
  7306******************************************************************
  7307*                                                                *
  7308*                            ELCMSTR.                            *
  7309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7310*                            VMOD=2.012                          *
  7311*                                                                *
  7312*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7313*                                                                *
  7314*   FILE TYPE = VSAM,KSDS                                        *
  7315*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7316*                                                                *
  7317*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7318*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7319*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7320*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7321*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7322*                                                 RKP=75,LEN=21  *
  7323*                                                                *
  7324*   **** NOTE ****                                               *
  7325*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7326*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7327*                                                                *
  7328*   LOG = YES                                                    *
  7329*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7330******************************************************************
  7331*                   C H A N G E   L O G
  7332*
  7333* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7334*-----------------------------------------------------------------
  7335*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7336* EFFECTIVE    NUMBER
  7337*-----------------------------------------------------------------
  7338* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7339* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7340* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7341* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7342* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7343******************************************************************
  7344 01  CLAIM-MASTER.
  7345     12  CL-RECORD-ID                PIC XX.
  7346         88  VALID-CL-ID         VALUE 'CL'.
  7347
  7348     12  CL-CONTROL-PRIMARY.
  7349         16  CL-COMPANY-CD           PIC X.
  7350         16  CL-CARRIER              PIC X.
  7351         16  CL-CLAIM-NO             PIC X(7).
  7352         16  CL-CERT-NO.
  7353             20  CL-CERT-PRIME       PIC X(10).
  7354             20  CL-CERT-SFX         PIC X.
  7355
  7356     12  CL-CONTROL-BY-NAME.
  7357         16  CL-COMPANY-CD-A1        PIC X.
  7358         16  CL-INSURED-LAST-NAME    PIC X(15).
  7359         16  CL-INSURED-NAME.
  7360             20  CL-INSURED-1ST-NAME PIC X(12).
  7361             20  CL-INSURED-MID-INIT PIC X.
  7362
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 136
* EL050.cbl
  7363     12  CL-CONTROL-BY-SSN.
  7364         16  CL-COMPANY-CD-A2        PIC X.
  7365         16  CL-SOC-SEC-NO.
  7366             20  CL-SSN-STATE        PIC XX.
  7367             20  CL-SSN-ACCOUNT      PIC X(6).
  7368             20  CL-SSN-LN3          PIC X(3).
  7369
  7370     12  CL-CONTROL-BY-CERT-NO.
  7371         16  CL-COMPANY-CD-A4        PIC X.
  7372         16  CL-CERT-NO-A4.
  7373             20  CL-CERT-A4-PRIME    PIC X(10).
  7374             20  CL-CERT-A4-SFX      PIC X.
  7375
  7376     12  CL-CONTROL-BY-CCN.
  7377         16  CL-COMPANY-CD-A5        PIC X.
  7378         16  CL-CCN-A5.
  7379             20  CL-CCN.
  7380                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7381                 24  CL-CCN-PRIME-A5 PIC X(12).
  7382             20  CL-CCN-FILLER-A5    PIC X(4).
  7383
  7384     12  CL-INSURED-PROFILE-DATA.
  7385         16  CL-INSURED-BIRTH-DT     PIC XX.
  7386         16  CL-INSURED-SEX-CD       PIC X.
  7387             88  INSURED-IS-MALE        VALUE 'M'.
  7388             88  INSURED-IS-FEMALE      VALUE 'F'.
  7389             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7390         16  CL-INSURED-OCC-CD       PIC X(6).
  7391         16  FILLER                  PIC X(5).
  7392
  7393     12  CL-PROCESSING-INFO.
  7394         16  CL-PROCESSOR-ID         PIC X(4).
  7395         16  CL-CLAIM-STATUS         PIC X.
  7396             88  CLAIM-IS-OPEN          VALUE 'O'.
  7397             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7398         16  CL-CLAIM-TYPE           PIC X.
  7399*            88  AH-CLAIM               VALUE 'A'.
  7400*            88  LIFE-CLAIM             VALUE 'L'.
  7401*            88  PROPERTY-CLAIM         VALUE 'P'.
  7402*            88  IUI-CLAIM              VALUE 'I'.
  7403*            88  GAP-CLAIM              VALUE 'G'.
  7404*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7405         16  CL-CLAIM-PREM-TYPE      PIC X.
  7406             88  SINGLE-PREMIUM         VALUE '1'.
  7407             88  O-B-COVERAGE           VALUE '2'.
  7408             88  OPEN-END-COVERAGE      VALUE '3'.
  7409         16  CL-INCURRED-DT          PIC XX.
  7410         16  CL-REPORTED-DT          PIC XX.
  7411         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7412         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7413         16  CL-LAST-PMT-DT          PIC XX.
  7414         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7415         16  CL-PAID-THRU-DT         PIC XX.
  7416         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7417         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7418         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7419         16  CL-PMT-CALC-METHOD      PIC X.
  7420             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 137
* EL050.cbl
  7421             88  CL-365-DAY-YR          VALUE '2'.
  7422             88  CL-FULL-MONTHS         VALUE '3'.
  7423         16  CL-CAUSE-CD             PIC X(6).
  7424
  7425         16  CL-PRIME-CERT-NO.
  7426             20  CL-PRIME-CERT-PRIME PIC X(10).
  7427             20  CL-PRIME-CERT-SFX   PIC X.
  7428
  7429         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7430             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7431             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7432
  7433         16  CL-MICROFILM-NO         PIC X(10).
  7434         16  FILLER REDEFINES CL-MICROFILM-NO.
  7435             20  CL-BENEFIT-PERIOD   PIC 99.
  7436             20  FILLER              PIC X(8).
  7437         16  CL-PROG-FORM-TYPE       PIC X.
  7438         16  CL-LAST-ADD-ON-DT       PIC XX.
  7439
  7440         16  CL-LAST-REOPEN-DT       PIC XX.
  7441         16  CL-LAST-CLOSE-DT        PIC XX.
  7442         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7443             88  FINAL-PAID             VALUE '1'.
  7444             88  CLAIM-DENIED           VALUE '2'.
  7445             88  AUTO-CLOSE             VALUE '3'.
  7446             88  MANUAL-CLOSE           VALUE '4'.
  7447             88  BENEFITS-CHANGED       VALUE 'C'.
  7448             88  SETUP-ERRORS           VALUE 'E'.
  7449         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7450         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7451         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7452             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7453         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7454         16  FILLER                  PIC X.
  7455
  7456     12  CL-CERTIFICATE-DATA.
  7457         16  CL-CERT-ORIGIN          PIC X.
  7458             88  CERT-WAS-ONLINE        VALUE '1'.
  7459             88  CERT-WAS-CREATED       VALUE '2'.
  7460             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7461         16  CL-CERT-KEY-DATA.
  7462             20  CL-CERT-CARRIER     PIC X.
  7463             20  CL-CERT-GROUPING    PIC X(6).
  7464             20  CL-CERT-STATE       PIC XX.
  7465             20  CL-CERT-ACCOUNT.
  7466                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7467                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7468             20  CL-CERT-EFF-DT      PIC XX.
  7469
  7470     12  CL-STATUS-CONTROLS.
  7471         16  CL-PRIORITY-CD          PIC X.
  7472             88  CONFIDENTIAL-DATA      VALUE '8'.
  7473             88  HIGHEST-PRIORITY       VALUE '9'.
  7474         16  CL-SUPV-ATTN-CD         PIC X.
  7475             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7476             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7477         16  CL-PURGED-DT            PIC XX.
  7478         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 138
* EL050.cbl
  7479         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7480         16  CL-NEXT-RESEND-DT       PIC XX.
  7481         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7482         16  CL-CRITICAL-PERIOD      PIC 99.
  7483*        16  FILLER                  PIC XX.
  7484         16  CL-LAST-MAINT-DT        PIC XX.
  7485         16  CL-LAST-MAINT-USER      PIC X(4).
  7486         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7487         16  CL-LAST-MAINT-TYPE      PIC X.
  7488             88  CLAIM-SET-UP           VALUE ' '.
  7489             88  PAYMENT-MADE           VALUE '1'.
  7490             88  LETTER-SENT            VALUE '2'.
  7491             88  MASTER-WAS-ALTERED     VALUE '3'.
  7492             88  MASTER-WAS-RESTORED    VALUE '4'.
  7493             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7494             88  FILE-CONVERTED         VALUE '6'.
  7495             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7496             88  ERROR-CORRECTION       VALUE 'E'.
  7497         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7498         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7499         16  CL-BENEFICIARY          PIC X(10).
  7500         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7501         16  CL-DENIAL-TYPE          PIC X.
  7502             88  CL-TYPE-DENIAL          VALUE '1'.
  7503             88  CL-TYPE-RESCISSION      VALUE '2'.
  7504             88  CL-TYPE-REFORMATION     VALUE '3'.
  7505             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7506             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7507         16  filler                  pic x(5).
  7508*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7509*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7510*        16  CL-RTW-DT               PIC XX.
  7511
  7512     12  CL-TRAILER-CONTROLS.
  7513         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7514             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7515             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7516             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7517         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7518         16  FILLER                  PIC XX.
  7519         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7520         16  CL-ADDRESS-TRAILER-CNT.
  7521             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7522                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7523             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7524                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7525             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7526                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7527             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7528                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7529             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7530                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7531             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7532                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7533             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7534                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7535
  7536     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 139
* EL050.cbl
  7537         16  CL-CV-REFNO-PRIME       PIC X(18).
  7538         16  CL-CV-REFNO-SFX         PIC XX.
  7539
  7540     12  CL-FILE-LOCATION            PIC X(4).
  7541
  7542     12  CL-PROCESS-ERRORS.
  7543         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7544             88  NO-FATAL-ERRORS        VALUE ZERO.
  7545         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7546             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7547
  7548     12  CL-PRODUCT-CD               PIC X.
  7549
  7550     12  CL-CURRENT-KEY-DATA.
  7551         16  CL-CURRENT-CARRIER      PIC X.
  7552         16  CL-CURRENT-GROUPING     PIC X(6).
  7553         16  CL-CURRENT-STATE        PIC XX.
  7554         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7555
  7556     12  CL-ASSOCIATES               PIC X.
  7557         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7558         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7559         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7560         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7561
  7562     12  CL-ACTIVITY-CODE            PIC 99.
  7563     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7564     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7565
  7566     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7567     12  CL-LAG-REPORT-CODE          PIC 9.
  7568     12  CL-LOAN-TYPE                PIC XX.
  7569     12  CL-LEGAL-STATE              PIC XX.
  7570
  7571     12  CL-YESNOSW                  PIC X.
  7572     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7573         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7574         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7575         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7576     12  cl-insured-type             pic x.
  7577         88  cl-claim-on-primary         value 'P'.
  7578         88  cl-claim-on-co-borrower     value 'C'.
  7579     12  cl-benefit-expiration-dt    PIC XX.
  7580
  7581 01  PLAN-RECORDS.
  7582     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7583     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7584
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 140
* EL050.cbl
  7586 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7587                          ACCOUNT-MASTER REINSURANCE-RECORD
  7588                          COMM-TABLE-RECORD FORM-MASTER
  7589                          CLAIM-MASTER PLAN-RECORDS.
  7590 0000-DFHEXIT SECTION.
  7591     MOVE '9#                    $   ' TO DFHEIV0.
  7592     MOVE 'EL050' TO DFHEIV1.
  7593     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7594
  7595     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7596
  7597
  7598* EXEC CICS  HANDLE CONDITION
  7599*           ERROR    (9300-ABEND)
  7600*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7601*    END-EXEC.
  7602*    MOVE '"$.J                  ! " #00007593' TO DFHEIV0
  7603     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7605     MOVE X'2220233030303037353933' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7608
  7609
  7610 0000-COPY-PROCEDURE-DIV.
  7611*                          COPY ELC50PD.
  7612******************************************************************
  7613*                                                                *
  7614*                            ELC50PD                             *
  7615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7616*                            VMOD=2.188                          *
  7617*                                                                *
  7618******************************************************************
  7619*                   C H A N G E   L O G
  7620*
  7621* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7622*-----------------------------------------------------------------
  7623*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7624* EFFECTIVE    NUMBER
  7625*-----------------------------------------------------------------
  7626* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7627* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7628* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7629*                             2709 AND 2718
  7630* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7631* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7632* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7633* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7634* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7635*                                IS OPEN OR CNC DT < PD THRU
  7636* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7637* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7638* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7639* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7640* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7641* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7642* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7643* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 141
* EL050.cbl
  7644* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7645* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7646* 020906                   PEMA  EXPAND LOAN OFFICER
  7647* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7648* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7649* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7650* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7651* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7652* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7653* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7654* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7655* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7656* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7657* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7658* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7659* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7660* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7661* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7662* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7663* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7664* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7665* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7666* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7667* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7668* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7669* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7670* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7671* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7672*                                UPDATE VIN ON CERT TRAILER
  7673* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7674* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7675* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7676* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7677* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7678* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7679* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7680* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7681* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7682* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7683* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7684* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7685* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7686* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7687* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7688* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7689* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7690* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7691* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7692* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7693* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7694* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7695* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7696* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7697* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7698* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7699* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7700* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7701* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 142
* EL050.cbl
  7702* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7703* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7704* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7705* 032912  CR2011110200001  PEMA  AHL CHANGES
  7706* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7707* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7708* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7709* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7710* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7711* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7712* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7713* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7714* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7715* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7716* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7717* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7718* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7719* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7720* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7721* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7722* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7723* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7724* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7725* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7726* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7727* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7728* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7729* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7730* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7731* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7732* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7733*                                CERT #, ADD 2898 FORCIBLE ERROR
  7734* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7735******************************************************************
  7736************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7737******************************************************************
  7738
  7739     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7740
  7741     MOVE SPACES                 TO PB-FATAL-FLAG
  7742                                    PB-FORCE-ER-CD
  7743                                    PB-WARN-ER-CD
  7744                                    PB-OUT-BAL-CD.
  7745
  7746     MOVE SPACE                  TO WS-IG-OVRD-AH
  7747                                    WS-IG-OVRD-LF
  7748                                    WS-IG-OVRD-AM
  7749                                    WS-IG-OVRD
  7750                                    WS-IG-OVRD-AH-PL
  7751                                    WS-IG-OVRD-LF-PL
  7752                                    WS-IG-OVRD-AH-BEN
  7753                                    WS-IG-OVRD-LF-BEN.
  7754
  7755******************************************************************
  7756*************       INITIALIZE COMMON ERRORS       ***************
  7757******************************************************************
  7758
  7759     MOVE +0                     TO PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 143
* EL050.cbl
  7760     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7761
  7762******************************************************************
  7763
  7764     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7765     SET JULIAN-TO-BIN           TO TRUE.
  7766*    MOVE 5                      TO DC-OPTION-CODE.
  7767     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7768     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7769
  7770     MOVE ZERO                   TO  SUB4.
  7771
  7772 0040-INITIALIZE-GA-BILL-DT.
  7773
  7774     ADD +1                      TO  SUB4.
  7775
  7776     IF  SUB4 GREATER THAN +5
  7777         GO TO 0050-CHECK-CNTL-FOUND.
  7778
  7779     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7780         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7781
  7782     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7783
  7784 0050-CHECK-CNTL-FOUND.
  7785
  7786     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7787        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7788                                         WS-AH-REM-TERM-CALC
  7789                                         EC-CO-REM-TERM-CALC
  7790        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7791        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7792        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7793                                         WS-TOL-AH-CLAIM
  7794        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7795                                         WS-TOL-AH-PREM
  7796                                         EC-CO-TOL-PREM
  7797        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7798                                         WS-TOL-AH-REFUND
  7799                                         EC-CO-TOL-REFUND
  7800        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7801                                         WS-AH-REFUND-OVS-AMT
  7802                                         EC-CO-OVR-SHT-AMT
  7803        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7804                                         WS-TOL-AH-PREM-PCT
  7805                                         EC-CO-TOL-PREM-PCT
  7806        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7807                                         WS-TOL-AH-REFUND-PCT
  7808                                         EC-CO-TOL-REFUND-PCT
  7809        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7810                                         WS-AH-REFUND-OVS-PCT
  7811                                         EC-CO-OVR-SHT-PCT
  7812        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7813        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7814        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7815        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7816        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7817        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 144
* EL050.cbl
  7818        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7819        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7820        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7821        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7822        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7823        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7824                                         EC-CO-MONTH-END-DT
  7825        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7826          GO TO 0100-READ-ACCT.
  7827
  7828     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7829     MOVE SPACES                 TO CNTL-ACCESS.
  7830     MOVE '1'                    TO CNTL-REC-TYPE.
  7831     MOVE +0                     TO CNTL-SEQ-NO.
  7832
  7833     MOVE '1' TO RC-SW-1.
  7834     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7835     IF NOT CF-COMPANY-MASTER
  7836         MOVE ZEROS             TO WK-CO-TOL-PREM
  7837                                   WK-CO-TOL-CLAIM
  7838                                   WK-CO-TOL-REFUND
  7839                                   WK-REFUND-OVS-AMT
  7840                                   WK-REFUND-OVS-PCT
  7841                                   WK-CO-TOL-PREM-PCT
  7842                                   WK-CO-TOL-REFUND-PCT
  7843                                   WK-DEFAULT-APR
  7844                                   WK-CO-MAX-CAP
  7845        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7846                                   WK-CR-R78-METHOD
  7847                                   WK-CO-REF-REJECT-SW
  7848                                   WK-CO-PREM-REJECT-SW
  7849                                   WK-REM-TRM-CALC-OPTION
  7850                                   WK-BIRTH-DATE-INPUT
  7851                                   WK-JOINT-AGE-INPUT
  7852        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7853        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7854        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7855        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7856          GO TO 0099-COMPANY-NOT-FOUND.
  7857
  7858     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7859        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7860     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7861        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7862     IF CF-CO-TOL-CAP NOT NUMERIC
  7863        MOVE +0                    TO CF-CO-TOL-CAP.
  7864     IF CF-DEFAULT-APR NOT NUMERIC
  7865        MOVE +0                    TO CF-DEFAULT-APR.
  7866
  7867     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7868     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7869     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7870     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7871     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7872     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7873     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7874     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7875     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 145
* EL050.cbl
  7876     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7877     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7878     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7879
  7880     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7881          CF-CO-OVR-SHT-AMT > +0
  7882        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7883
  7884     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7885          CF-CO-OVR-SHT-PCT > +0
  7886        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7887
  7888     IF CF-VALID-REM-TRM-OPTION
  7889         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7890     ELSE
  7891         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7892
  7893     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7894     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7895     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7896     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7897
  7898     GO TO 0050-CHECK-CNTL-FOUND.
  7899
  7900 0099-COMPANY-NOT-FOUND.
  7901
  7902     MOVE ER-2616                TO WS-ERROR.
  7903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7904
  7905 0100-READ-ACCT.
  7906
  7907     MOVE SPACES                 TO DATE-RANGE-SW.
  7908
  7909     IF WK-ACCT-ADDR = ZEROS
  7910        GO TO 0102-ACCT-GETMAIN.
  7911
  7912     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7913     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7914     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7915
  7916     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7917        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7918        GO TO 0105-READ-ACCT
  7919     END-IF
  7920
  7921     IF PB-CARRIER NOT = SPACES
  7922        IF PB-CARRIER NOT = AM-VG-CARRIER
  7923           GO TO 0105-READ-ACCT.
  7924
  7925     IF PB-STATE NOT = SPACES
  7926        IF PB-STATE NOT = AM-VG-STATE
  7927           GO TO 0105-READ-ACCT.
  7928
  7929     IF PB-GROUPING NOT = SPACES
  7930        IF PB-GROUPING NOT = AM-VG-GROUPING
  7931           GO TO 0105-READ-ACCT.
  7932
  7933     MOVE 'X'                 TO DATE-RANGE-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 146
* EL050.cbl
  7934
  7935     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7936        MOVE 'X'                 TO DATE-RANGE-SW
  7937        GO TO 0105-READ-ACCT.
  7938
  7939     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7940        GO TO 0105-READ-ACCT.
  7941
  7942     GO TO 0180-ACCOUNT-FOUND.
  7943
  7944 0102-ACCT-GETMAIN.
  7945     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7946     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7947
  7948 0105-READ-ACCT.
  7949     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7950     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7951     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7952     MOVE PB-STATE               TO ACCT-STATE.
  7953     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7954     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7955
  7956     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7957
  7958     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7959
  7960 0110-FIND-ACCT-TOLERANCES-LOOP.
  7961     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7962
  7963     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7964        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7965        GO TO 0199-ACCT-NOT-FOUND
  7966     END-IF
  7967     IF PB-CARRIER NOT = SPACES
  7968        IF PB-CARRIER NOT = AM-VG-CARRIER
  7969           GO TO 0199-ACCT-NOT-FOUND.
  7970
  7971     IF PB-STATE NOT = SPACES
  7972        IF PB-STATE NOT = AM-VG-STATE
  7973           GO TO 0199-ACCT-NOT-FOUND.
  7974
  7975     IF PB-GROUPING NOT = SPACES
  7976        IF PB-GROUPING NOT = AM-VG-GROUPING
  7977           GO TO 0199-ACCT-NOT-FOUND.
  7978
  7979     MOVE 'X'                    TO DATE-RANGE-SW.
  7980
  7981     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7982        MOVE 'X'                 TO DATE-RANGE-SW
  7983        GO TO 0199-ACCT-NOT-FOUND.
  7984
  7985     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7986        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7987
  7988 0180-ACCOUNT-FOUND.
  7989     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7990     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7991     MOVE AM-STATE               TO PB-SV-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 147
* EL050.cbl
  7992     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7993
  7994     IF AM-CANCEL-FEE  NOT NUMERIC
  7995        MOVE ZEROS TO AM-CANCEL-FEE.
  7996
  7997     IF AM-MAX-MON-BEN NOT NUMERIC
  7998        MOVE ZEROS TO AM-MAX-MON-BEN.
  7999
  8000     IF AM-MAX-TOT-BEN NOT NUMERIC
  8001        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8002
  8003     IF AM-CLP-TOL-PCT NOT NUMERIC
  8004        MOVE +0                  TO AM-CLP-TOL-PCT
  8005     END-IF
  8006     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8007        MOVE +0                  TO AM-SPP-LEASE-COMM
  8008     END-IF
  8009     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8010        MOVE ER-2611             TO   WS-ERROR
  8011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8012
  8013     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8014        MOVE ER-2621             TO   WS-ERROR
  8015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8016
  8017     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8018        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8019        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8020        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8021         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8022
  8023     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8024     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8025     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8026     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8027     IF AM-CLP-TOL-PCT NOT = ZEROS
  8028        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8029     END-IF
  8030     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8031        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8032     END-IF
  8033*    IF PB-COMPANY-ID = 'DCC'
  8034*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8035*                                   WS-ADMIN-FEES
  8036*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8037*          (SUB5 > +10)
  8038*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8039*             AND (AM-A-COM (SUB5) NUMERIC)
  8040*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8041*                + (AM-A-COM (SUB5) * 1000)
  8042*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8043*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8044*                + (AM-A-COM (SUB5) * 1000)
  8045*             END-IF
  8046*             IF AM-COM-TYP (SUB5) = 'N'
  8047*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8048*                + (AM-A-COM (SUB5) * 1000)
  8049*             END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 148
* EL050.cbl
  8050*          END-IF
  8051*       END-PERFORM
  8052*    END-IF
  8053     IF (PB-COMPANY-ID = 'DCC')
  8054        AND (PB-ISSUE)
  8055        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8056                                    ws-cred-union-fees
  8057        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8058           (SUB5 > +10)
  8059           MOVE +0 TO WS-WK-RATE
  8060           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8061                                   'O' OR 'S')
  8062              IF (AM-A-COM (SUB5) NUMERIC)
  8063                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8064                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8065              ELSE
  8066                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8067                 IF PB-ISSUE
  8068                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8069                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8070                 ELSE
  8071                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8072                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8073                 END-IF
  8074                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8075                 MOVE ZEROS             TO WS-SUB1
  8076                                           WS-COMMISSION
  8077                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8078                 MOVE '0530'               TO CTBL-SW
  8079                 MOVE ' '                  TO WS-CTBL-READ-SW
  8080                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8081                 IF FIRST-TIME-THROUGH
  8082                    MOVE 'AA'              TO CTBL-BEN-CODE
  8083                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8084                 END-IF
  8085                 IF CTBL-TABLE-FOUND
  8086                    IF PB-ISSUE
  8087                       COMPUTE WS-COMM-CK-AMT =
  8088                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8089                    ELSE
  8090                       COMPUTE WS-COMM-CK-AMT =
  8091                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8092                    END-IF
  8093                    PERFORM 8800-GET-COMP-RATE
  8094                              THRU 8800-EXIT
  8095                 END-IF
  8096              END-IF
  8097              if am-com-typ (sub5) = 'O' or 'S'
  8098                 compute ws-cred-union-fees rounded =
  8099                    ws-cred-union-fees +
  8100                    (pb-i-ah-premium-amt * ws-wk-rate)
  8101              else
  8102                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8103                + (WS-WK-RATE * 1000)
  8104              end-if
  8105           END-IF
  8106        END-PERFORM
  8107     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 149
* EL050.cbl
  8108     IF PB-COMPANY-ID EQUAL 'CRI'
  8109         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8110
  8111     IF PB-COMPANY-ID EQUAL 'NCL'
  8112         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8113     END-IF
  8114
  8115     GO TO 0200-READ-CERT.
  8116
  8117 0199-ACCT-NOT-FOUND.
  8118
  8119     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8120
  8121     IF DATE-RANGE-SW NOT = SPACES
  8122        MOVE ER-2601             TO WS-ERROR
  8123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8124     ELSE
  8125        MOVE ER-2619             TO WS-ERROR
  8126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8127
  8128     GO TO 9990-RETURN.
  8129
  8130 0200-READ-CERT.
  8131
  8132     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8133     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8134     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8135     MOVE PB-SV-STATE            TO CERT-STATE.
  8136     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8137     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8138     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8139
  8140     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8141
  8142     IF CERT-WAS-NOT-FOUND
  8143        GO TO 0299-CERT-NOT-FOUND.
  8144
  8145     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8146        MOVE ER-2759             TO WS-ERROR
  8147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8148        GO TO 0298-UNLOCK-RETURN.
  8149
  8150     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8151         MOVE ER-2758            TO WS-ERROR
  8152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8153         GO TO 0298-UNLOCK-RETURN.
  8154
  8155     IF PB-ISSUE
  8156        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8157           IF CERT-WAS-CREATED-FOR-CLAIM
  8158              NEXT SENTENCE
  8159            ELSE
  8160              MOVE ER-2626       TO WS-ERROR
  8161              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8162              GO TO 0298-UNLOCK-RETURN.
  8163
  8164     IF NOT PB-CANCELLATION
  8165        GO TO 0300-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 150
* EL050.cbl
  8166
  8167     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8168     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8169     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8170     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8171     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8172     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8173
  8174     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8175     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8176     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8177     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8178     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8179     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8180     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8181     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8182     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8183
  8184     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8185     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8186     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8187     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8188     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8189     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8190     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8191
  8192     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8193     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8194
  8195     MOVE CM-CREDIT-INTERFACE-SW-1
  8196                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8197     MOVE CM-CREDIT-INTERFACE-SW-2
  8198                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8199
  8200     IF CM-O-B-COVERAGE
  8201         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8202
  8203     IF CM-LIVES NOT NUMERIC
  8204         MOVE ZERO                TO CM-LIVES.
  8205
  8206     IF CM-BILLED NOT NUMERIC
  8207         MOVE ZERO                TO CM-BILLED.
  8208
  8209     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8210         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8211         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8212         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8213         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8214         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8215         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8216         MOVE CM-LIVES             TO PB-CI-LIVES
  8217*The next line causes a problem with my change  I dont think it is
  8218*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8219
  8220     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8221     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8222     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8223     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 151
* EL050.cbl
  8224     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8225     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8226
  8227     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8228     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8229     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8230     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8231
  8232     IF CM-LIFE-COMM-PCT NUMERIC
  8233         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8234     ELSE
  8235         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8236
  8237     IF CM-AH-COMM-PCT NUMERIC
  8238         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8239     ELSE
  8240         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8241
  8242     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8243
  8244     IF CM-LOAN-APR       NOT NUMERIC
  8245           MOVE ZERO               TO CM-LOAN-APR.
  8246
  8247     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8248           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8249
  8250     IF CM-LOAN-TERM      NOT NUMERIC
  8251           MOVE ZERO               TO CM-LOAN-TERM.
  8252
  8253     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8254           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8255
  8256     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8257           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8258
  8259     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8260     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8261     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8262     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8263     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8264     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8265     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8266     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8267     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8268     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8269     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8270     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8271
  8272     IF CM-STATE = CM-SSN-STATE
  8273         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8274
  8275     IF CM-STATE NOT = CM-MEMB-STATE
  8276         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8277
  8278     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8279
  8280     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8281        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 152
* EL050.cbl
  8282        IF CM-ADDL-CLP NOT NUMERIC
  8283           MOVE +0               TO CM-ADDL-CLP
  8284        END-IF
  8285        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8286        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8287           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8288        END-IF
  8289     END-IF
  8290     IF PB-COMPANY-ID = 'DCC'
  8291        MOVE +0                  TO WS-ADMIN-FEES
  8292                                    WS-CSO-ADMIN-FEE
  8293                                    WS-COMM-AND-MFEE
  8294                                    WS-1ST-YR-ALLOW
  8295        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8296           (SUB5 > +10)
  8297           MOVE +0 TO WS-WK-RATE
  8298           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8299              IF (AM-A-COM (SUB5) NUMERIC)
  8300                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8301                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8302              ELSE
  8303                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8304                 IF PB-ISSUE
  8305                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8306                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8307                 ELSE
  8308                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8309                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8310                 END-IF
  8311                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8312                 MOVE ZEROS             TO WS-SUB1
  8313                                           WS-COMMISSION
  8314                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8315                 MOVE '0530'               TO CTBL-SW
  8316                 MOVE ' '                  TO WS-CTBL-READ-SW
  8317                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8318                 IF FIRST-TIME-THROUGH
  8319                    MOVE 'AA'              TO CTBL-BEN-CODE
  8320                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8321                 END-IF
  8322                 IF CTBL-TABLE-FOUND
  8323                    IF PB-ISSUE
  8324                       COMPUTE WS-COMM-CK-AMT =
  8325                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8326                    ELSE
  8327                       COMPUTE WS-COMM-CK-AMT =
  8328                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8329                    END-IF
  8330                    PERFORM 8800-GET-COMP-RATE
  8331                              THRU 8800-EXIT
  8332                 END-IF
  8333              END-IF
  8334              IF AM-COM-TYP (SUB5) = 'I'
  8335                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8336                   + (WS-WK-RATE * 1000)
  8337              END-IF
  8338              IF AM-COM-TYP (SUB5) = 'N'
  8339                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 153
* EL050.cbl
  8340                   + (WS-WK-RATE * 1000)
  8341              END-IF
  8342              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8343                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8344                   + (WS-WK-RATE * 1000)
  8345              END-IF
  8346              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8347                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8348                   + (WS-WK-RATE * 1000)
  8349              END-IF
  8350           END-IF
  8351        END-PERFORM
  8352     END-IF
  8353     GO TO 0300-CONTINUE-EDIT.
  8354
  8355 0298-UNLOCK-RETURN.
  8356      PERFORM 9250-UNLOCK-RETURN
  8357      GO TO 9990-RETURN.
  8358
  8359 0299-CERT-NOT-FOUND.
  8360
  8361     MOVE '1'                     TO CERT-STATUS-SW.
  8362
  8363     IF PB-COMPANY-ID = 'UCL'
  8364         IF WS-ERROR = ER-2799
  8365             GO TO 3000-CONTINUE-EDIT.
  8366
  8367     IF NOT PB-CANCELLATION
  8368         GO TO 0300-CONTINUE-EDIT.
  8369
  8370     MOVE ER-2726                  TO  WS-ERROR.
  8371     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8372     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8373     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8374                                    PB-CI-LF-TERM
  8375                                    PB-C-LF-REM-TERM
  8376                                    PB-CI-AH-TERM
  8377                                    PB-C-AH-REM-TERM
  8378                                    PB-CI-LF-BENEFIT-CD
  8379                                    PB-CI-LF-BENEFIT-AMT
  8380                                    PB-CI-LF-ALT-BENEFIT-AMT
  8381                                    PB-CI-LF-PREMIUM-AMT
  8382                                    PB-CI-LF-ALT-PREMIUM-AMT
  8383                                    PB-CI-AH-BENEFIT-CD
  8384                                    PB-CI-AH-BENEFIT-AMT
  8385                                    PB-CI-AH-PREMIUM-AMT
  8386                                    PB-CI-PAY-FREQUENCY
  8387                                    PB-CI-LOAN-APR
  8388                                    PB-CI-LOAN-TERM
  8389                                    PB-CI-LIFE-COMMISSION
  8390                                    PB-CI-AH-COMMISSION
  8391                                    PB-CI-CURR-SEQ
  8392                                    PB-CI-AH-CANCEL-AMT
  8393                                    PB-CI-LF-CANCEL-AMT
  8394                                    PB-CI-RATE-DEV-PCT-LF
  8395                                    PB-CI-RATE-DEV-PCT-AH
  8396                                    PB-CI-EXTENTION-DAYS
  8397                                    PB-CI-TERM-IN-DAYS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 154
* EL050.cbl
  8398                                    PB-CI-LIVES
  8399                                    PB-CI-LF-CRIT-PER
  8400                                    PB-CI-AH-CRIT-PER
  8401                                    PB-CI-ADDL-CLP
  8402                                    PB-CI-DDF-IU-RATE-UP.
  8403
  8404     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8405                                    PB-CI-AH-SETTLEMENT-DT
  8406                                    PB-CI-DEATH-DT
  8407                                    PB-CI-LF-PRIOR-CANCEL-DT
  8408                                    PB-CI-AH-PRIOR-CANCEL-DT
  8409                                    PB-CI-ENTRY-DT
  8410                                    PB-CI-LF-EXPIRE-DT
  8411                                    PB-CI-AH-EXPIRE-DT
  8412                                    PB-CI-LOAN-1ST-PMT-DT.
  8413
  8414     IF ACCOUNT-MAST-FOUND
  8415        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8416        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8417
  8418
  8419 0300-CONTINUE-EDIT.
  8420
  8421     IF PB-ISSUE
  8422        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8423            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8424
  8425     IF PB-ISSUE
  8426        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8427            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8428
  8429     IF PB-ISSUE
  8430       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8431          (AM-NO-AH-ONLY)
  8432           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8433               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8434                   MOVE ER-2679 TO WS-ERROR
  8435                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8436
  8437     IF PB-ISSUE
  8438        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8439        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8440        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8441     ELSE
  8442        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8443        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8444        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8445
  8446     MOVE 'N'                    TO PLAN-MASTER-SW
  8447                                    PLAN-MASTER-LIFE-SW
  8448                                    FORM-MASTER-SW
  8449                                    WS-APP-CERT-SW.
  8450
  8451     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8452                                    WS-PL-TOL-LF-REFUND
  8453                                    WS-PL-REF-OVS-AMT
  8454                                    WS-PL-TOL-LF-PREM-PCT
  8455                                    WS-PL-TOL-LF-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 155
* EL050.cbl
  8456                                    WS-PL-REF-OVS-PCT
  8457                                    WS-PL-TOL-LF-CLAIM.
  8458
  8459     IF PB-COMPANY-ID = 'NCL'
  8460       IF PB-ISSUE
  8461         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8462             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8463             IF FORM-MASTER-FOUND
  8464                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8465
  8466     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8467        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8468
  8469********************** MON CODE **********************
  8470     IF PB-COMPANY-ID = 'MON'
  8471     IF PB-ISSUE
  8472     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8473        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8474             PB-I-LOAN-APR = ZERO)
  8475               MOVE 14.0         TO PB-I-LOAN-APR.
  8476******************************************************
  8477
  8478     IF PB-COMPANY-ID = 'NCL'
  8479       IF PB-ISSUE
  8480           IF FORM-MASTER-FOUND
  8481             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8482                AM-DISMBR-COVERAGE
  8483                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8484                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8485                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8486                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8487                                           PB-I-LIFE-BENEFIT-CD.
  8488
  8489     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8490
  8491     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8492         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8493         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8494         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8495         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8496         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8497           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8498             GO TO 0301-LIFE-BENEFIT-SEARCH
  8499         ELSE
  8500             NEXT SENTENCE
  8501     ELSE
  8502         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8503
  8504     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8505     MOVE '4'                    TO CNTL-REC-TYPE.
  8506     MOVE +0                     TO CNTL-SEQ-NO.
  8507     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8508
  8509     MOVE '1' TO RC-SW-2.
  8510     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8511
  8512     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8513        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 156
* EL050.cbl
  8514         GO TO 0305-BENEFIT-NOT-FOUND.
  8515
  8516     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8517
  8518 0301-LIFE-BENEFIT-SEARCH.
  8519
  8520     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8521
  8522     IF NO-BENEFIT-FOUND
  8523        GO TO 0305-BENEFIT-NOT-FOUND.
  8524
  8525     IF WS-BEN-CD = '99'
  8526        GO TO 0305-BENEFIT-NOT-FOUND.
  8527
  8528     IF PB-COMPANY-ID = 'NCL'
  8529         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8530             GO TO 0304-LIFE-BENEFIT-FOUND.
  8531
  8532     MOVE +1                     TO SUB5.
  8533     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8534
  8535* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8536* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8537     IF PB-COMPANY-ID = 'DMD'
  8538         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8539
  8540 0302-EDIT-ACCT-LF-BENEFITS.
  8541
  8542     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8543        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8544           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8545                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8546           GO TO 03XX-GET-LIFE-ERPLAN.
  8547
  8548     IF SUB5 LESS THAN +20
  8549        ADD +1                   TO SUB5
  8550        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8551
  8552     MOVE +1                     TO SUB5.
  8553
  8554     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8555        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8556
  8557 0303-EDIT-DMD-EXTRA-BENEFITS.
  8558
  8559     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8560        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8561           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8562                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8563           GO TO 03XX-GET-LIFE-ERPLAN.
  8564
  8565     IF SUB5 LESS THAN +30
  8566        ADD +1                   TO SUB5
  8567        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8568
  8569     MOVE +1                     TO SUB5.
  8570
  8571 03XX-EDIT-FOR-NINETY-LF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 157
* EL050.cbl
  8572
  8573***************************************************************
  8574*                                                             *
  8575*    NINETY BENEFIT PLAN TYPES:                               *
  8576*                                                             *
  8577*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8578*      92 = ALL GROUP REDUCING BENEFITS                       *
  8579*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8580*      94 = ALL GROUP LEVEL BENEFITS                          *
  8581*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8582*           BENEFIT CONTROLS.                                 *
  8583*      99 = ALL BENEFITS                                      *
  8584*                                                             *
  8585***************************************************************
  8586
  8587     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8588                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8589
  8590     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8591       AND
  8592        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8593        GO TO 03XX-GET-LIFE-ERPLAN.
  8594
  8595     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8596       AND
  8597        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8598        IF CF-REDUCING (SUB3)
  8599           IF (PB-I-INDV-GRP-OVRD = 'I')
  8600              OR
  8601           ((AM-IG = '1') AND
  8602           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8603              OR
  8604           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8605           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8606           (AM-IG NOT = '2'))
  8607              GO TO 03XX-GET-LIFE-ERPLAN.
  8608
  8609     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8610       AND
  8611        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8612        IF CF-REDUCING (SUB3)
  8613           IF (PB-I-INDV-GRP-OVRD = 'G')
  8614              OR
  8615           ((AM-IG = '2') AND
  8616           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8617              OR
  8618           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8619           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8620           (AM-IG NOT = '1'))
  8621              GO TO 03XX-GET-LIFE-ERPLAN.
  8622
  8623     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8624       AND
  8625        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8626        IF CF-LEVEL    (SUB3)
  8627           IF (PB-I-INDV-GRP-OVRD = 'I')
  8628              OR
  8629           ((AM-IG = '1') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 158
* EL050.cbl
  8630           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8631              OR
  8632           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8633           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8634            (AM-IG NOT = '2'))
  8635              GO TO 03XX-GET-LIFE-ERPLAN.
  8636
  8637     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8638       AND
  8639        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8640        IF CF-LEVEL    (SUB3)
  8641           IF (PB-I-INDV-GRP-OVRD = 'G')
  8642              OR
  8643           ((AM-IG = '2') AND
  8644           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8645              OR
  8646           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8647           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8648           (AM-IG NOT = '1'))
  8649              GO TO 03XX-GET-LIFE-ERPLAN.
  8650
  8651     IF SUB5 LESS THAN +20
  8652        ADD +1                   TO SUB5
  8653        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8654
  8655     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8656
  8657     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8658        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8659
  8660     MOVE +1                     TO SUB5.
  8661
  8662 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8663
  8664     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8665                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8666
  8667     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8668       AND
  8669        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8670        GO TO 03XX-GET-LIFE-ERPLAN.
  8671
  8672     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8673       AND
  8674        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8675        IF CF-REDUCING (SUB3)
  8676           IF (PB-I-INDV-GRP-OVRD = 'I')
  8677              OR
  8678           ((AM-IG = '1') AND
  8679           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8680              OR
  8681           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8682           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8683           (AM-IG NOT = '2'))
  8684              GO TO 03XX-GET-LIFE-ERPLAN.
  8685
  8686     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8687       AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 159
* EL050.cbl
  8688        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8689        IF CF-REDUCING (SUB3)
  8690           IF (PB-I-INDV-GRP-OVRD = 'G')
  8691              OR
  8692           ((AM-IG = '2') AND
  8693           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8694              OR
  8695           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8696           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8697           (AM-IG NOT = '1'))
  8698              GO TO 03XX-GET-LIFE-ERPLAN.
  8699
  8700     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8701       AND
  8702        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8703        IF CF-LEVEL    (SUB3)
  8704           IF (PB-I-INDV-GRP-OVRD = 'I')
  8705              OR
  8706           ((AM-IG = '1') AND
  8707           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8708              OR
  8709           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8710           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8711            (AM-IG NOT = '2'))
  8712              GO TO 03XX-GET-LIFE-ERPLAN.
  8713
  8714     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8715       AND
  8716        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8717        IF CF-LEVEL    (SUB3)
  8718           IF (PB-I-INDV-GRP-OVRD = 'G')
  8719              OR
  8720           ((AM-IG = '2') AND
  8721           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8722              OR
  8723           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8724           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8725           (AM-IG NOT = '1'))
  8726              GO TO 03XX-GET-LIFE-ERPLAN.
  8727
  8728     IF SUB5 LESS THAN +30
  8729        ADD +1                   TO SUB5
  8730        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8731
  8732     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8733
  8734 03XX-EDIT-FOR-NINETY-LF-CONT.
  8735
  8736     MOVE +99                    TO SUB5.
  8737
  8738     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8739        IF PB-ISSUE
  8740           MOVE ER-1924          TO  WS-ERROR
  8741           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8742
  8743     GO TO 0304-LIFE-BENEFIT-FOUND.
  8744
  8745 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 160
* EL050.cbl
  8746
  8747     IF WK-PLAN-ADDR EQUAL +0
  8748        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8749
  8750     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8751     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8752     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8753     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8754     MOVE 'Y'                    TO PLAN-MASTER-SW
  8755                                    PLAN-MASTER-LIFE-SW.
  8756     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8757
  8758 03XX-ERPLAN-LIFE-GETMAIN.
  8759
  8760     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8761     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8762
  8763 03XX-ERPLAN-LIFE-READ.
  8764
  8765     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8766     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8767     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8768     MOVE PB-SV-STATE            TO PLAN-STATE.
  8769     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8770     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8771     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8772     MOVE WS-SAVE-BENEFIT-REVISION
  8773                                 TO PLAN-REVISION-NO.
  8774
  8775     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8776     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8777
  8778     IF PB-COMPANY-ID = 'NCL'
  8779       IF NOT LF-PLAN-MASTER-FOUND
  8780         IF NOT PB-POLICY-IS-DECLINED  AND
  8781            NOT PB-POLICY-IS-VOIDED
  8782             MOVE  ER-1921         TO  WS-ERROR
  8783             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8784             GO TO 0304-LIFE-BENEFIT-FOUND.
  8785
  8786     IF NOT LF-PLAN-MASTER-FOUND
  8787        GO TO 0304-LIFE-BENEFIT-FOUND.
  8788
  8789 XXXX-CHECK-LF-PLAN-KEY.
  8790
  8791     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8792        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8793        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8794        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8795        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8796        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8797        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8798        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8799        MOVE 'N'                 TO PLAN-MASTER-SW
  8800          GO TO 03XX-ERPLAN-LIFE-READ.
  8801
  8802     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8803
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 161
* EL050.cbl
  8804     IF  PB-CANCELLATION
  8805         GO TO  0303-LF-ACCT-BEN-FOUND.
  8806
  8807     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8808        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8809           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8810           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8811              MOVE ER-2644             TO WS-ERROR
  8812              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8813           ELSE
  8814              NEXT SENTENCE
  8815        ELSE
  8816           IF PB-COMPANY-ID NOT = 'NCL'
  8817              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8818                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8819
  8820 0303-LF-ACCT-BEN-FOUND.
  8821
  8822     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8823
  8824     IF PL-DEV-CODE NOT = SPACES
  8825        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8826
  8827     IF PL-DEV-PCT NUMERIC AND
  8828        PL-DEV-PCT NOT = ZEROS
  8829        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8830
  8831     IF PL-TOL-PREM-AMT GREATER THAN +0
  8832        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8833
  8834     IF PL-TOL-REF-AMT GREATER THAN +0
  8835        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8836
  8837     IF PL-TOL-PREM-PCT GREATER THAN +0
  8838        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8839
  8840     IF PL-TOL-REF-PCT GREATER THAN +0
  8841        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8842
  8843     IF PL-TOL-CLM-AMT GREATER THAN +0
  8844        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8845
  8846     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8847                          PL-OVER-SHORT-AMT > +0
  8848        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8849
  8850     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8851                          PL-OVER-SHORT-PCT > +0
  8852        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8853
  8854     IF PL-SALES-TAX NUMERIC AND
  8855                          PL-SALES-TAX > +0
  8856         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8857
  8858     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8859        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8860                                    WS-IG-OVRD-AM.
  8861
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 162
* EL050.cbl
  8862 0304-LIFE-BENEFIT-FOUND.
  8863
  8864     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8865
  8866     IF PB-ISSUE
  8867        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8868     ELSE
  8869        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8870
  8871     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8872     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8873     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8874     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8875     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8876                                         WS-LF-REFUND-CALC.
  8877     if (ws-lf-earnings-calc = '5')
  8878        and (pb-i-loan-apr = zeros)
  8879        and (benefit-code-chg)
  8880        move +99.9999 to pb-i-loan-apr
  8881     end-if
  8882
  8883     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8884        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8885
  8886     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8887        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8888     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8889
  8890     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8891     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8892     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8893     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8894     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8895     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8896
  8897     IF PB-COMPANY-ID = 'NCL'  AND
  8898        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8899         NEXT SENTENCE
  8900     ELSE
  8901         IF SUB5 NOT GREATER THAN +20
  8902            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8903               MOVE WS-SAVE-BENEFIT-REM-TERM
  8904                                      TO WS-AM-LF-BENE-REM-TERM
  8905                                         EC-BR-LF-REM-TERM-CALC.
  8906
  8907     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8908     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8909
  8910     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8911
  8912 0305-BENEFIT-NOT-FOUND.
  8913
  8914     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8915     MOVE ER-2604                TO WS-ERROR.
  8916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8917
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 163
* EL050.cbl
  8919
  8920 0310-FIND-AH-BENEFIT-RECORD.
  8921
  8922     MOVE 'N'                    TO PLAN-MASTER-SW
  8923                                    PLAN-MASTER-AH-SW.
  8924
  8925     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8926                                    WS-PL-TOL-AH-REFUND
  8927                                    WS-AH-PL-REF-OVS-AMT
  8928                                    WS-PL-TOL-AH-PREM-PCT
  8929                                    WS-PL-TOL-AH-REFUND-PCT
  8930                                    WS-AH-PL-REF-OVS-PCT
  8931                                    WS-PL-TOL-AH-CLAIM.
  8932     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8933
  8934
  8935     if pb-issue
  8936        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8937           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8938        end-if
  8939        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8940           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8941           GO TO 0399-BENEFIT-NOT-FOUND
  8942        end-if
  8943     end-if
  8944
  8945     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8946        GO TO 0400-FIND-CARRIER.
  8947
  8948     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8949
  8950     IF WK-AH-BEN-ADDR NOT = ZEROS
  8951         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8952         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8953         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8954         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8955           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8956             GO TO 0311-AH-BENEFIT-SEARCH
  8957         ELSE
  8958             NEXT SENTENCE
  8959     ELSE
  8960         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8961
  8962     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8963     MOVE '5'                    TO CNTL-REC-TYPE.
  8964     MOVE +0                     TO CNTL-SEQ-NO.
  8965     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8966
  8967     MOVE '2' TO RC-SW-2.
  8968     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8969
  8970     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8971        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8972          GO TO 0399-BENEFIT-NOT-FOUND.
  8973
  8974     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8975
  8976 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 164
* EL050.cbl
  8977
  8978     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8979
  8980     IF NO-BENEFIT-FOUND
  8981         GO TO 0399-BENEFIT-NOT-FOUND.
  8982
  8983     IF WS-BEN-CD = '99'
  8984        GO TO 0399-BENEFIT-NOT-FOUND.
  8985
  8986     IF PB-COMPANY-ID  =  'NCL'
  8987         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8988             GO TO 0314-A-H-BENEFIT-FOUND.
  8989
  8990     MOVE +1                     TO SUB5.
  8991     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8992
  8993* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8994* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8995     IF PB-COMPANY-ID = 'DMD'
  8996         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8997
  8998 0312-EDIT-ACCT-AH-BENEFITS.
  8999
  9000     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9001        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9002           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9003                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9004           GO TO 03XX-GET-AH-ERPLAN.
  9005
  9006     IF SUB5 LESS THAN +20
  9007        ADD +1                   TO SUB5
  9008        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9009
  9010     MOVE +1                     TO SUB5.
  9011
  9012     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9013        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9014
  9015 0313-EDIT-DMD-EXTRA-BENEFITS.
  9016
  9017     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9018        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9019           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9020                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9021           GO TO 03XX-GET-AH-ERPLAN.
  9022
  9023     IF SUB5 LESS THAN +30
  9024        ADD +1                   TO SUB5
  9025        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9026
  9027     MOVE +1                     TO SUB5.
  9028
  9029 03XX-EDIT-FOR-NINETY-AH.
  9030
  9031***************************************************************
  9032*                                                             *
  9033*    NINETY BENEFIT PLAN TYPES:                               *
  9034*                                                             *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 165
* EL050.cbl
  9035*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9036*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9037*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9038*           BENEFIT CONTROLS.                                 *
  9039*      99 = ALL BENEFITS.                                     *
  9040*                                                             *
  9041***************************************************************
  9042
  9043     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9044                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9045
  9046     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9047       AND
  9048        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9049        GO TO 03XX-GET-AH-ERPLAN.
  9050
  9051     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9052       AND
  9053        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9054           IF (PB-I-INDV-GRP-OVRD = 'I')
  9055              OR
  9056           ((AM-IG = '1') AND
  9057           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9058              OR
  9059           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9060           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9061           (AM-IG NOT = '2'))
  9062              GO TO 03XX-GET-AH-ERPLAN.
  9063
  9064     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9065       AND
  9066        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9067           IF (PB-I-INDV-GRP-OVRD = 'G')
  9068              OR
  9069           ((AM-IG = '2') AND
  9070           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9071              OR
  9072           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9073           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9074           (AM-IG NOT = '1'))
  9075              GO TO 03XX-GET-AH-ERPLAN.
  9076
  9077     IF SUB5 LESS THAN +20
  9078        ADD +1                   TO SUB5
  9079        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9080
  9081     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9082        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9083
  9084     MOVE +1                    TO SUB5.
  9085
  9086 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9087
  9088     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9089                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9090
  9091     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9092       AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 166
* EL050.cbl
  9093        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9094        GO TO 03XX-GET-AH-ERPLAN.
  9095
  9096     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9097       AND
  9098        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9099           IF (PB-I-INDV-GRP-OVRD = 'I')
  9100              OR
  9101           ((AM-IG = '1') AND
  9102           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9103              OR
  9104           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9105           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9106           (AM-IG NOT = '2'))
  9107              GO TO 03XX-GET-AH-ERPLAN.
  9108
  9109     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9110       AND
  9111        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9112           IF (PB-I-INDV-GRP-OVRD = 'G')
  9113              OR
  9114           ((AM-IG = '2') AND
  9115           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9116              OR
  9117           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9118           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9119           (AM-IG NOT = '1'))
  9120              GO TO 03XX-GET-AH-ERPLAN.
  9121
  9122     IF SUB5 LESS THAN +30
  9123        ADD +1                   TO SUB5
  9124        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9125
  9126 03XX-EDIT-FOR-NINETY-AH-CONT.
  9127
  9128     MOVE +99                    TO SUB5.
  9129
  9130     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9131
  9132     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9133        IF PB-ISSUE
  9134           MOVE ER-1925          TO  WS-ERROR
  9135           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9136
  9137     GO TO 0314-A-H-BENEFIT-FOUND.
  9138
  9139 03XX-GET-AH-ERPLAN.
  9140
  9141     IF WK-PLAN-ADDR EQUAL +0
  9142         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9143
  9144     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9145     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9146     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9147     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9148     MOVE 'Y'                    TO PLAN-MASTER-SW
  9149                                    PLAN-MASTER-AH-SW.
  9150*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 167
* EL050.cbl
  9151     GO TO 03XX-ERPLAN-AH-READ.
  9152
  9153 03XX-ERPLAN-AH-GETMAIN.
  9154
  9155     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9156     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9157
  9158 03XX-ERPLAN-AH-READ.
  9159
  9160     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9161     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9162     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9163     MOVE PB-SV-STATE            TO PLAN-STATE.
  9164     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9165     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9166     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9167     MOVE WS-SAVE-BENEFIT-REVISION
  9168                                 TO PLAN-REVISION-NO.
  9169
  9170     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9171     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9172
  9173     IF PB-COMPANY-ID = 'NCL'
  9174       IF NOT AH-PLAN-MASTER-FOUND
  9175         IF NOT PB-POLICY-IS-DECLINED  AND
  9176            NOT PB-POLICY-IS-VOIDED
  9177             MOVE  ER-1922         TO  WS-ERROR
  9178             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9179             GO TO 0314-A-H-BENEFIT-FOUND.
  9180
  9181     IF NOT AH-PLAN-MASTER-FOUND
  9182        GO TO 0314-A-H-BENEFIT-FOUND.
  9183
  9184 XXXX-CHECK-AH-PLAN-KEY.
  9185
  9186     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9187        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9188        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9189        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9190        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9191        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9192        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9193        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9194        MOVE 'N'                 TO PLAN-MASTER-SW
  9195          GO TO 03XX-ERPLAN-AH-READ.
  9196
  9197     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9198
  9199     IF  PB-CANCELLATION
  9200         GO TO  0313-AH-ACCT-BEN-FOUND.
  9201
  9202     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9203       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9204          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9205          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9206             MOVE ER-2644             TO WS-ERROR
  9207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9208          ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 168
* EL050.cbl
  9209             NEXT SENTENCE
  9210       ELSE
  9211          IF PB-COMPANY-ID NOT = 'NCL'
  9212             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9213                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9214
  9215 0313-AH-ACCT-BEN-FOUND.
  9216
  9217     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9218
  9219     IF PL-DEV-CODE NOT = SPACES
  9220        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9221
  9222     IF PL-DEV-PCT NUMERIC AND
  9223        PL-DEV-PCT NOT = ZEROS
  9224        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9225
  9226     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9227        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9228
  9229     IF PL-TOL-REF-AMT NOT EQUAL +0
  9230        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9231
  9232     IF PL-TOL-PREM-PCT GREATER THAN +0
  9233        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9234
  9235     IF PL-TOL-REF-PCT GREATER THAN +0
  9236        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9237
  9238     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9239        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9240
  9241     IF PL-OVER-SHORT-AMT NUMERIC AND
  9242                          PL-OVER-SHORT-AMT > +0
  9243        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9244
  9245     IF PL-OVER-SHORT-PCT NUMERIC AND
  9246                          PL-OVER-SHORT-PCT > +0
  9247        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9248
  9249     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9250        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9251        IF WS-IG-OVRD-AM EQUAL SPACES
  9252            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9253
  9254 0314-A-H-BENEFIT-FOUND.
  9255
  9256     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9257
  9258     IF PB-ISSUE
  9259        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9260       ELSE
  9261        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9262
  9263     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9264     if cf-maximum-benefits (sub3) numeric
  9265        move cf-maximum-benefits (sub3)
  9266                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 169
* EL050.cbl
  9267     else
  9268        move zeros               to ws-ah-max-bens
  9269     end-if
  9270     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9271     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9272     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9273                                         WS-AH-REFUND-CALC.
  9274
  9275     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9276        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9277
  9278     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9279        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9280     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9281
  9282     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9283     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9284     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9285     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9286     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9287     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9288
  9289     IF PB-COMPANY-ID = 'NCL'  AND
  9290        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9291         NEXT SENTENCE
  9292     ELSE
  9293         IF SUB5 NOT GREATER THAN +20
  9294            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9295                MOVE WS-SAVE-BENEFIT-REM-TERM
  9296                                      TO WS-AM-AH-BENE-REM-TERM
  9297                                         EC-BR-AH-REM-TERM-CALC.
  9298
  9299     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9300     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9301
  9302     GO TO 0400-FIND-CARRIER.
  9303
  9304 0399-BENEFIT-NOT-FOUND.
  9305
  9306     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9307     MOVE ER-2605                TO WS-ERROR.
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 170
* EL050.cbl
  9311
  9312 0400-FIND-CARRIER.
  9313
  9314     MOVE PB-SV-CARRIER          TO WS-CARR.
  9315
  9316     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9317     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9318     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9319     MOVE '6'                    TO CNTL-REC-TYPE.
  9320
  9321*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9322     MOVE SPACE                  TO WS-DMD-RATING-SW
  9323                                    EC-BR-DMD-RATING-SW.
  9324
  9325     MOVE '2'                    TO RC-SW-1.
  9326     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9327
  9328     IF NOT CF-CARRIER-MASTER
  9329        GO TO 0400-CARRIER-NOT-FOUND.
  9330
  9331 0400-BUILD-CARR-TOL.
  9332
  9333     IF CF-CR-TOL-PREM NUMERIC AND
  9334        CF-CR-TOL-PREM GREATER THAN +0
  9335        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9336                                    WS-TOL-AH-PREM.
  9337
  9338     IF CF-CR-TOL-REFUND NUMERIC AND
  9339        CF-CR-TOL-REFUND GREATER THAN +0
  9340        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9341                                    WS-TOL-AH-REFUND.
  9342
  9343     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9344        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9345        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9346                                    WS-AH-REFUND-OVS-AMT.
  9347
  9348     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9349        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9350        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9351                                    WS-AH-REFUND-OVS-PCT.
  9352
  9353     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9354        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9355        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9356                                    WS-TOL-AH-PREM-PCT.
  9357
  9358     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9359        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9360        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9361                                     WS-TOL-AH-REFUND-PCT.
  9362
  9363     IF CF-COMPANY-ID EQUAL 'DMD'
  9364         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9365                                    EC-BR-DMD-RATING-SW.
  9366
  9367     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9368     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 171
* EL050.cbl
  9369        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9370     END-IF
  9371     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9372        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9373     END-IF
  9374     IF WS-TOL-CLP-PCT = ZEROS
  9375        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9376     END-IF
  9377
  9378     IF WS-SPP-LEASE-COMM = ZEROS
  9379        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9380     END-IF
  9381     GO TO 0400-FIND-ERPDEF.
  9382
  9383 0400-CARRIER-NOT-FOUND.
  9384
  9385     MOVE ER-2602                TO WS-ERROR.
  9386     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9387
  9388 0400-FIND-ERPDEF.
  9389     IF PB-COMPANY-ID = 'DCC'
  9390        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9391        CONTINUE
  9392     ELSE
  9393        GO TO 0400-FIND-ERCOMP
  9394     END-IF
  9395     MOVE ' '                    TO PDEF-MASTER-SW
  9396     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9397     MOVE PB-STATE               TO ERPDEF-STATE
  9398     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9399     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9400     IF PB-ISSUE
  9401        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9402     ELSE
  9403        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9404     END-IF
  9405     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9406     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9407     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9408     IF PDEF-MASTER-FOUND
  9409        MOVE 'N'                 TO PDEF-MASTER-SW
  9410        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9411        IF PDEF-MASTER-FOUND
  9412           IF (ERPDEF-KEY-SAVE (1:16) =
  9413                        PD-CONTROL-PRIMARY (1:16))
  9414              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9415              CONTINUE
  9416           ELSE
  9417              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9418              IF (ERPDEF-KEY-SAVE (1:16) =
  9419                        PD-CONTROL-PRIMARY (1:16))
  9420                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9421                 CONTINUE
  9422              ELSE
  9423                 MOVE 'N'        TO PDEF-MASTER-SW
  9424              END-IF
  9425           END-IF
  9426        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 172
* EL050.cbl
  9427        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9428     END-IF
  9429     IF PDEF-MASTER-FOUND
  9430        IF PD-TRUNCATED = 'Y'
  9431           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9432        END-IF
  9433     END-IF
  9434     .
  9435 0400-FIND-ERCOMP.
  9436     IF PB-COMPANY-ID = 'DCC'
  9437        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9438           (WS-SUB1 > +10)
  9439           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9440                 OR 'A' OR 'N'
  9441              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9442              MOVE PB-CARRIER    TO COMP-CARRIER
  9443              MOVE PB-GROUPING   TO COMP-GROUPING
  9444              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9445              MOVE AM-AGT (WS-SUB1)
  9446                                 TO COMP-FIN-RESP
  9447              MOVE 'G'           TO COMP-TYPE
  9448              PERFORM 8582-READ-COMPENSATION-MASTER
  9449                                 THRU 8582-EXIT
  9450              IF COMP-MASTER-FOUND
  9451                 IF CO-GA-INACTIVE
  9452                    MOVE ER-2763 TO WS-ERROR
  9453                    PERFORM 9900-ERROR-FORMAT
  9454                                 THRU 9900-EXIT
  9455                    MOVE +11     TO WS-SUB1
  9456                 END-IF
  9457                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9458                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9459                    MOVE ER-2788 TO WS-ERROR
  9460                    PERFORM 9900-ERROR-FORMAT
  9461                                 THRU 9900-EXIT
  9462                    MOVE +11     TO WS-SUB1
  9463                 END-IF
  9464              END-IF
  9465           END-IF
  9466        END-PERFORM
  9467     END-IF
  9468     IF PB-COMPANY-ID = 'DCC'
  9469        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9470           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9471                                    WS-CLP-STATE
  9472        ELSE
  9473           MOVE SPACES           TO PB-I-CLP-STATE
  9474                                    WS-CLP-STATE
  9475        END-IF
  9476     END-IF
  9477
  9478     IF (PB-COMPANY-ID = 'DCC')
  9479        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9480        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9481        CONTINUE
  9482     ELSE
  9483        GO TO 0400-FIND-STATE-RECORD
  9484     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 173
* EL050.cbl
  9485     MOVE SPACES                 TO WS-CLP-STATE
  9486     MOVE +0                     TO WS-BANK-FEE
  9487                                    WS-BANK-LFEE
  9488                                    WS-BANK-NOCHRGB
  9489
  9490     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9491     IF (PB-ISSUE)
  9492        AND (PB-I-BANK-NUMBER NOT =
  9493            SPACES AND ZEROS AND LOW-VALUES)
  9494        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9495     ELSE
  9496        IF (PB-CANCELLATION)
  9497           AND (PB-CI-BANK-NUMBER NOT =
  9498                SPACES AND ZEROS AND LOW-VALUES)
  9499           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9500        END-IF
  9501     END-IF
  9502     IF COMP-FIN-RESP NOT = LOW-VALUES
  9503        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9504        MOVE PB-CARRIER          TO COMP-CARRIER
  9505        MOVE PB-GROUPING         TO COMP-GROUPING
  9506        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9507        MOVE 'B'                 TO COMP-TYPE
  9508        PERFORM 8582-READ-COMPENSATION-MASTER
  9509                                 THRU 8582-EXIT
  9510        IF COMP-MASTER-FOUND
  9511           IF CO-MAX-BANK-FEE NOT NUMERIC
  9512              MOVE +0            TO CO-MAX-BANK-FEE
  9513           END-IF
  9514           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9515              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9516           END-IF
  9517           IF CO-GA-INACTIVE
  9518              MOVE ER-2763       TO WS-ERROR
  9519              PERFORM 9900-ERROR-FORMAT
  9520                                 THRU 9900-EXIT
  9521           END-IF
  9522           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9523              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9524              MOVE ER-2788 TO WS-ERROR
  9525              PERFORM 9900-ERROR-FORMAT
  9526                                 THRU 9900-EXIT
  9527              MOVE +11     TO WS-SUB1
  9528           END-IF
  9529           IF WS-AH-BEN-CATEGORY = 'G'
  9530              MOVE CO-MAX-BANK-FEE
  9531                                 TO WS-BANK-FEE
  9532                                    PB-I-BANK-FEE
  9533           ELSE
  9534              MOVE CO-MAX-BANK-FEE-LEASE
  9535                                 TO WS-BANK-LFEE
  9536                                    PB-I-BANK-FEE
  9537           END-IF
  9538           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9539              AND (WS-AH-REFUND-CALC = 'G'))
  9540                        OR
  9541              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9542              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 174
* EL050.cbl
  9543              CONTINUE
  9544           ELSE
  9545              MOVE ER-2789 TO WS-ERROR
  9546              PERFORM 9900-ERROR-FORMAT
  9547                                 THRU 9900-EXIT
  9548           END-IF
  9549           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9550                                    PB-I-CLP-STATE
  9551           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9552           MOVE CO-CARRIER       TO BXRF-CARRIER
  9553           MOVE CO-GROUPING      TO BXRF-GROUPING
  9554           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9555           MOVE BXRF-MAX-REC-LENGTH
  9556                                 TO BXRF-REC-LENGTH
  9557           PERFORM 8584-READ-BANK-CROSS-REF
  9558                                 THRU 8584-EXIT
  9559           IF BXRF-MASTER-FOUND
  9560              MOVE ' '           TO BANK-ACCT-SW
  9561              MOVE BK-BANK-POINTER-CNT
  9562                                 TO BK-BANK-POINTER-CNT
  9563              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9564                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9565                 OR (BANK-ACCT-FOUND)
  9566                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9567                    AND (BK-AM-EXP-DT (WS-SUB1)
  9568                                 > PB-CERT-EFF-DT)
  9569                    AND (BK-AM-EFF-DT (WS-SUB1)
  9570                                 NOT > PB-CERT-EFF-DT)
  9571                    SET BANK-ACCT-FOUND TO TRUE
  9572                 END-IF
  9573              END-PERFORM
  9574              IF NOT BANK-ACCT-FOUND
  9575                 MOVE ZEROS      TO WS-BANK-FEE
  9576                                    WS-BANK-LFEE
  9577                 MOVE ER-2869    TO WS-ERROR
  9578                 PERFORM 9900-ERROR-FORMAT
  9579                                 THRU 9900-EXIT
  9580              ELSE
  9581                 PERFORM 5000-PROCESS-REPS
  9582                                 THRU 5000-EXIT
  9583                 IF AGENT-MASTER-FOUND
  9584                    MOVE +0      TO WS-BANK-FEE
  9585                                    WS-BANK-LFEE
  9586*                   MOVE AG-SPP-FEES (1)
  9587*                                TO PB-I-BANK-FEE
  9588*                                   WS-BANK-FEE
  9589                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9590                       (WS-SUB1 > +10)
  9591                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9592                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9593                       END-IF
  9594                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9595                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9596                       END-IF
  9597                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9598                          AG-SPP-FEES (WS-SUB1)
  9599                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9600                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 175
* EL050.cbl
  9601                    END-PERFORM
  9602                    IF WS-AH-BEN-CATEGORY = 'G'
  9603                       MOVE WS-BANK-FEE
  9604                                 TO PB-I-BANK-FEE
  9605                    ELSE
  9606                       MOVE WS-BANK-LFEE
  9607                                 TO PB-I-BANK-FEE
  9608                    END-IF
  9609                 END-IF
  9610              END-IF
  9611           END-IF
  9612        ELSE
  9613           MOVE ER-2879          TO WS-ERROR
  9614           PERFORM 9900-ERROR-FORMAT
  9615                                 THRU 9900-EXIT
  9616        END-IF
  9617     ELSE
  9618        MOVE ER-2879             TO WS-ERROR
  9619        PERFORM 9900-ERROR-FORMAT
  9620                                 THRU 9900-EXIT
  9621     END-IF
  9622     IF WS-AH-BEN-CATEGORY = 'G'
  9623        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9624        + WS-BANK-FEE
  9625     ELSE
  9626        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9627        + WS-BANK-LFEE
  9628     END-IF
  9629     .
  9630 0400-FIND-STATE-RECORD.
  9631
  9632     IF WK-STATE-ADDR NOT = ZEROS
  9633         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9634         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9635         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9636         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9637         IF PB-SV-STATE = CF-STATE-CODE
  9638             GO TO 0405-CONTINUE-EDIT
  9639         ELSE
  9640             NEXT SENTENCE
  9641     ELSE
  9642         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9643
  9644     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9645     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9646     MOVE '3'                    TO CNTL-REC-TYPE.
  9647     MOVE +0                     TO CNTL-SEQ-NO.
  9648
  9649     MOVE '3'                    TO RC-SW-2.
  9650     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9651
  9652     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9653        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9654        PB-SV-STATE   NOT = CF-STATE-CODE)
  9655        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9656                                    WS-TOL-AH-CLAIM
  9657                                    WS-MINIMUM-REFUND
  9658                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 176
* EL050.cbl
  9659                                    WS-TOL-AH-PREM
  9660                                    WS-TOL-LF-REFUND
  9661                                    WS-TOL-AH-REFUND
  9662                                    EC-ST-TOL-PREM-PCT
  9663                                    WS-TOL-LF-PREM-PCT
  9664                                    WS-TOL-AH-PREM-PCT
  9665                                    EC-ST-TOL-REFUND-PCT
  9666                                    WS-TOL-LF-REFUND-PCT
  9667                                    WS-TOL-AH-REFUND-PCT
  9668                                    EC-ST-TOL-PREM
  9669                                    EC-ST-TOL-REFUND
  9670                                    EC-ST-FST-PMT-DAYS-MAX
  9671                                    WS-FREE-LOOK-PERIOD
  9672                                    WS-ST-LF-PREM-TAX
  9673                                    WS-ST-AH-PREM-TAX-I
  9674                                    WS-ST-AH-PREM-TAX-G
  9675                                    WS-BANK-FEE
  9676                                    WS-BANK-LFEE
  9677                                    WS-TOL-CLP-PCT
  9678                                    WS-SPP-LEASE-COMM
  9679        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9680                                    EC-ST-FST-PMT-DAYS-CHG
  9681                                    WS-LF-REM-TERM-CALC
  9682                                    WS-LF-REFUND-CALC
  9683                                    EC-ST-LF-REM-TERM-CALC
  9684                                    EC-ST-LF-REFUND-CALC
  9685                                    WS-AH-REM-TERM-CALC
  9686                                    WS-AH-REFUND-CALC
  9687                                    WS-LF-BEN-CATEGORY
  9688                                    WS-AH-BEN-CATEGORY
  9689                                    WS-CLP-STATE
  9690                                    WS-ST-REFUND-CLAIM-FLAG
  9691                                    WS-ST-CAUSAL-STATE
  9692                                    EC-ST-AH-REM-TERM-CALC
  9693                                    EC-ST-AH-REFUND-CALC
  9694          GO TO 0499-STATE-NOT-FOUND.
  9695
  9696     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9697
  9698 0405-CONTINUE-EDIT.
  9699
  9700     if pb-company-id = 'AHL'
  9701        continue
  9702     else
  9703        IF PB-CERT-PRIME NOT NUMERIC
  9704           MOVE ER-2722          TO WS-ERROR
  9705           PERFORM 9900-ERROR-FORMAT
  9706                                 THRU 9900-EXIT
  9707        end-if
  9708     END-IF
  9709*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9710*       MOVE +0                  TO SUB3
  9711*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9712*       IF SUB3 > +0
  9713*          MOVE ER-2722          TO WS-ERROR
  9714*          PERFORM 9900-ERROR-FORMAT
  9715*                                THRU 9900-EXIT
  9716*       END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 177
* EL050.cbl
  9717*    END-IF
  9718*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9719*       IF PB-CERT-PRIME NOT NUMERIC
  9720*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9721*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9722*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9723*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9724*
  9725*          MOVE ER-2722          TO WS-ERROR
  9726*          PERFORM 9900-ERROR-FORMAT
  9727*                                THRU 9900-EXIT
  9728*       END-IF
  9729*    END-IF
  9730
  9731     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9732
  9733     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9734        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9735                                    WS-TOL-AH-CLAIM.
  9736
  9737     IF CF-ST-REFUND-MIN NOT NUMERIC
  9738        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9739
  9740     IF CF-ST-REFUND-MIN NOT = ZEROS
  9741        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9742
  9743     IF CF-ST-TOL-PREM  NOT = ZEROS
  9744        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9745                                    WS-TOL-AH-PREM
  9746        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9747
  9748     IF CF-ST-TOL-REFUND NOT = ZEROS
  9749        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9750                                    WS-TOL-AH-REFUND
  9751        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9752
  9753     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9754        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9755        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9756                                    WS-AH-REFUND-OVS-AMT
  9757                                    EC-ST-OVR-SHT-AMT.
  9758
  9759     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9760        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9761        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9762                                    WS-TOL-LF-PREM-PCT
  9763                                    WS-TOL-AH-PREM-PCT.
  9764
  9765     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9766        CF-ST-TOL-REF-PCT GREATER THAN +0
  9767        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9768                                    WS-TOL-LF-REFUND-PCT
  9769                                    WS-TOL-AH-REFUND-PCT.
  9770
  9771     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9772        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9773        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9774                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 178
* EL050.cbl
  9775                                    EC-ST-OVR-SHT-PCT.
  9776
  9777     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9778     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9779
  9780     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9781          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9782
  9783     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9784     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9785     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9786
  9787     IF CF-ST-LF-PREM-TAX NUMERIC
  9788        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9789     END-IF
  9790     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9791        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9792     END-IF
  9793     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9794        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9795     END-IF
  9796
  9797     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9798         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9799     END-IF.
  9800
  9801     IF CF-ST-CAUSAL-STATE > SPACES
  9802         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9803     END-IF.
  9804
  9805     IF WS-LF-BENEFIT-CD = ZEROS
  9806        GO TO 0410-CHECK-AH.
  9807
  9808     IF CF-ST-RT-CALC NOT = SPACES
  9809        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9810                                    EC-ST-LF-REM-TERM-CALC
  9811     END-IF
  9812
  9813     IF WS-LF-COVERAGE-TYPE = 'R'
  9814        IF WS-LF-EARNINGS-CALC = '5'
  9815           IF CF-ST-RF-LN-CALC > '0'
  9816              MOVE CF-ST-RF-LN-CALC
  9817                                 TO WS-LF-REFUND-CALC
  9818                                    EC-ST-LF-REFUND-CALC
  9819           END-IF
  9820        ELSE
  9821           IF CF-ST-RF-LR-CALC > '0'
  9822              MOVE CF-ST-RF-LR-CALC
  9823                                 TO WS-LF-REFUND-CALC
  9824                                    EC-ST-LF-REFUND-CALC
  9825           END-IF
  9826        END-IF
  9827     ELSE
  9828        IF CF-ST-RF-LL-CALC > '0'
  9829           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9830                                    EC-ST-LF-REFUND-CALC
  9831        END-IF
  9832     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 179
* EL050.cbl
  9833
  9834     IF CF-ST-RT-CALC NOT = SPACES
  9835        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9836                                    EC-ST-LF-REM-TERM-CALC
  9837     END-IF
  9838
  9839     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9840     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9841
  9842     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9843
  9844     IF NO-BENEFIT-FOUND
  9845        GO TO 0410-CHECK-AH.
  9846
  9847     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9848        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9849                                 TO EC-ST-LF-REM-TERM-CALC
  9850                                    WS-LF-REM-TERM-CALC
  9851     END-IF
  9852
  9853     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9854        MOVE CF-ST-REFUND-CALC (SUB3)
  9855                                 TO WS-LF-REFUND-CALC
  9856                                    EC-ST-LF-REFUND-CALC
  9857     END-IF
  9858*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9859
  9860     .
  9861 0410-CHECK-AH.
  9862
  9863     IF WS-AH-BENEFIT-CD = ZEROS
  9864        GO TO 0500-SET-ACCOUNT.
  9865
  9866     IF CF-ST-RT-CALC NOT = SPACES
  9867        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9868                                    EC-ST-AH-REM-TERM-CALC
  9869     END-IF
  9870
  9871     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9872        IF CF-ST-RF-CP-CALC > '0'
  9873           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9874                                    EC-ST-AH-REFUND-CALC
  9875        END-IF
  9876     ELSE
  9877        IF CF-ST-RF-AH-CALC > '0'
  9878           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9879                                    EC-ST-AH-REFUND-CALC
  9880        END-IF
  9881     END-IF
  9882     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9883     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9884
  9885     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9886
  9887     IF NO-BENEFIT-FOUND
  9888        GO TO 0500-SET-ACCOUNT.
  9889
  9890     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 180
* EL050.cbl
  9891        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9892                                 TO WS-AH-REM-TERM-CALC
  9893                                    EC-ST-AH-REM-TERM-CALC
  9894     END-IF
  9895
  9896     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9897        MOVE CF-ST-REFUND-CALC (SUB3)
  9898                                 TO WS-AH-REFUND-CALC
  9899                                    EC-ST-AH-REFUND-CALC
  9900     END-IF
  9901
  9902*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9903
  9904     GO TO 0500-SET-ACCOUNT.
  9905
  9906 0499-STATE-NOT-FOUND.
  9907
  9908     MOVE ER-2603                TO WS-ERROR.
  9909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9910
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 181
* EL050.cbl
  9912
  9913 0500-SET-ACCOUNT.
  9914*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9915     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9916        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9917        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9918        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9919        MOVE '3'                 TO CNTL-REC-TYPE
  9920        MOVE +0                  TO CNTL-SEQ-NO
  9921
  9922        MOVE '3'                 TO RC-SW-2
  9923        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9924
  9925        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9926           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9927           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9928           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9929                                    WS-ST-AH-PREM-TAX-I
  9930                                    WS-ST-AH-PREM-TAX-G
  9931        ELSE
  9932           IF CF-ST-LF-PREM-TAX NUMERIC
  9933              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9934           END-IF
  9935           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9936              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9937           END-IF
  9938           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9939              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9940           END-IF
  9941        END-IF
  9942        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9943     END-IF
  9944*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9945*  FOR DCC ONLY
  9946     IF PB-COMPANY-ID = 'DCC'
  9947
  9948     MOVE ' '                    TO STAT-MASTER-SW
  9949     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9950     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9951     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9952     MOVE PB-STATE               TO ELSTAT-STATE
  9953     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9954        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9955     END-IF
  9956
  9957     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9958     SET BIN-TO-GREG             TO TRUE
  9959     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9960     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9961     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9962
  9963     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9964     IF STAT-MASTER-FOUND
  9965        MOVE 'N'                 TO STAT-MASTER-SW
  9966        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9967        IF STAT-MASTER-FOUND
  9968           IF (ELSTAT-KEY-SAVE (1:12) =
  9969                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 182
* EL050.cbl
  9970              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9971                 MOVE 'F'        TO STAT-MASTER-SW
  9972              ELSE
  9973                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9974                 IF (STAT-MASTER-FOUND)
  9975                    AND (ELSTAT-KEY-SAVE (1:12) =
  9976                        SF-CONTROL-PRIMARY (1:12))
  9977                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9978                    MOVE 'F'     TO STAT-MASTER-SW
  9979                 END-IF
  9980              END-IF
  9981           END-IF
  9982        END-IF
  9983     END-IF
  9984
  9985     IF STAT-MASTER-SW = 'F'
  9986        IF SF-ST-LF-PREM-TAX NUMERIC
  9987           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9988        END-IF
  9989        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9990           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9991        END-IF
  9992        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9993           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9994        END-IF
  9995     END-IF
  9996
  9997     END-IF
  9998     IF (PB-COMPANY-ID = 'DCC')
  9999        AND (PB-ISSUE)
 10000        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10001        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10002        AND (AM-GPCD = 06)
 10003        MOVE 'Y'                 TO WS-GOOD-HIN
 10004        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10005           MOVE PB-I-VIN         TO WS-WORK-VIN
 10006           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10007              (V1 > 16)
 10008              IF WS-WORK-VIN (V1:1) NUMERIC
 10009                 MOVE WS-WORK-VIN-N (V1)
 10010                                 TO WS-ROW-B-VAL (V1)
 10011              ELSE
 10012                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10013                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10014                    OR (V2 > 26)
 10015                 END-PERFORM
 10016                 IF V2 < 27
 10017                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10018                 ELSE
 10019                    MOVE 'N'     TO WS-GOOD-HIN
 10020                 END-IF
 10021              END-IF
 10022              COMPUTE WS-ROW-D-VAL (V1) =
 10023                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10024              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10025                 WS-ROW-D-VAL (V1)
 10026           END-PERFORM
 10027           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 183
* EL050.cbl
 10028           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10029             REMAINDER WS-VIN-REMAINDER
 10030           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10031              CONTINUE
 10032           ELSE
 10033              MOVE 'N'           TO WS-GOOD-HIN
 10034           END-IF
 10035        ELSE
 10036           MOVE 'N'              TO WS-GOOD-HIN
 10037        END-IF
 10038        IF WS-GOOD-HIN NOT = 'Y'
 10039           MOVE ER-3826           TO WS-ERROR
 10040           PERFORM 9900-ERROR-FORMAT
 10041                                 THRU 9900-EXIT
 10042        END-IF
 10043     END-IF
 10044     IF (PB-COMPANY-ID = 'DCC')
 10045        AND (PB-ISSUE)
 10046        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10047        AND (AM-GPCD NOT = 06)
 10048        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10049          MOVE PB-I-VIN          TO WS-WORK-VIN
 10050          MOVE +8                TO V2
 10051          MOVE ZEROS             TO WS-VIN-TOTAL
 10052          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10053           (V1 > 17)
 10054             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10055                MOVE ER-3825     TO WS-ERROR
 10056                PERFORM 9900-ERROR-FORMAT
 10057                                 THRU 9900-EXIT
 10058             ELSE
 10059                IF V1 = 8
 10060                   MOVE 10       TO V2
 10061                END-IF
 10062                IF V1 = 9
 10063                   MOVE 0        TO V2
 10064                END-IF
 10065                IF V1 = 10
 10066                   MOVE 9        TO V2
 10067                END-IF
 10068                IF WS-WORK-VIN (V1:1) NUMERIC
 10069                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10070                    + (WS-WORK-VIN-N (V1) * V2)
 10071                ELSE
 10072                   MOVE WS-WORK-VIN (V1:1)
 10073                                 TO WS-HEX-BYTE
 10074                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10075                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10076                    + (WS-NUM (V3) * V2)
 10077                END-IF
 10078                COMPUTE V2 = V2 - 1
 10079             END-IF
 10080          END-PERFORM
 10081          MOVE ZEROS TO WS-VIN-REMAINDER
 10082          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10083             REMAINDER WS-VIN-REMAINDER
 10084          IF ((WS-WORK-VIN (9:1) = 'X')
 10085             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 184
* EL050.cbl
 10086                     OR
 10087             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10088             CONTINUE
 10089          ELSE
 10090             MOVE ER-3826        TO WS-ERROR
 10091             PERFORM 9900-ERROR-FORMAT
 10092                                 THRU 9900-EXIT
 10093          END-IF
 10094        ELSE
 10095          MOVE ER-3826           TO WS-ERROR
 10096          PERFORM 9900-ERROR-FORMAT
 10097                                 THRU 9900-EXIT
 10098        END-IF
 10099     END-IF
 10100******************************************************************
 10101******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10102******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10103******* METHODS.
 10104******************************************************************
 10105     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10106        IF PB-CANCELLATION
 10107           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10108              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10109                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10110                IF FORM-MASTER-FOUND
 10111                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10112******************************************************************
 10113
 10114     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10115     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10116
 10117     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10118     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10119     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10120     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10121
 10122
 10123     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10124     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10125     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10126
 10127     IF AM-LF-OB-RATE NOT NUMERIC
 10128         MOVE ZERO               TO AM-LF-OB-RATE.
 10129
 10130     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10131         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10132
 10133     IF AM-AH-OB-RATE NOT NUMERIC
 10134         MOVE ZERO               TO AM-AH-OB-RATE.
 10135
 10136     IF WS-LF-JOINT-INDICATOR = 'J'
 10137         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10138     ELSE
 10139         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10140
 10141     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10142
 10143     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 185
* EL050.cbl
 10144         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10145
 10146     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10147         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10148                                       WS-IG-OVRD
 10149     ELSE
 10150         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10151             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10152                                       WS-IG-OVRD
 10153         ELSE
 10154             MOVE AM-IG             TO WS-IG-OVRD-AH
 10155                                       WS-IG-OVRD.
 10156
 10157     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10158         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10159                                       WS-IG-OVRD
 10160     ELSE
 10161         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10162             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10163                                       WS-IG-OVRD
 10164         ELSE
 10165             MOVE AM-IG             TO WS-IG-OVRD-LF
 10166                                       WS-IG-OVRD.
 10167
 10168     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10169     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10170     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10171     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10172     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10173
 10174     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10175     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10176     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10177     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10178
 10179     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10180     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10181     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10182     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10183     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10184     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10185     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10186
 10187     IF WS-ACCT-AH-DEV-PCT > +0
 10188        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10189     ELSE
 10190        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10191
 10192     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10193        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10194     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10195        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10196
 10197        IF AM-EARN-METHOD-L = 'S'
 10198            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10199                                        WS-LF-REFUND-CALC.
 10200
 10201        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 186
* EL050.cbl
 10202            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10203                                        WS-LF-REFUND-CALC.
 10204
 10205     IF WS-LF-COVERAGE-TYPE = 'R'
 10206         IF AM-EARN-METHOD-R = 'R'
 10207            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10208                                    WS-LF-REFUND-CALC.
 10209     IF WS-LF-COVERAGE-TYPE = 'R'
 10210         IF AM-EARN-METHOD-R = 'P'
 10211            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10212                                    WS-LF-REFUND-CALC.
 10213     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10214         IF AM-EARN-METHOD-L = 'R'
 10215            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10216                                    WS-LF-REFUND-CALC.
 10217     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10218         IF AM-EARN-METHOD-L = 'P'
 10219            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10220                                    WS-LF-REFUND-CALC.
 10221     IF WS-LF-COVERAGE-TYPE = 'R'
 10222         IF AM-EARN-METHOD-R = 'A'
 10223            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10224                                    WS-LF-REFUND-CALC.
 10225     IF WS-LF-COVERAGE-TYPE = 'R'
 10226         IF AM-EARN-METHOD-R = 'M'
 10227            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10228                                    WS-LF-REFUND-CALC.
 10229     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10230         IF AM-EARN-METHOD-L = 'A'
 10231            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10232                                    WS-LF-REFUND-CALC.
 10233     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10234         IF AM-EARN-METHOD-L = 'M'
 10235            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10236                                    WS-LF-REFUND-CALC.
 10237
 10238     IF AM-EARN-METHOD-A = 'R'
 10239        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10240                                    WS-AH-REFUND-CALC.
 10241     IF AM-EARN-METHOD-A = 'P'
 10242        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10243                                    WS-AH-REFUND-CALC.
 10244     IF AM-EARN-METHOD-A = 'C'
 10245        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10246                                    WS-AH-REFUND-CALC.
 10247     IF AM-EARN-METHOD-A = 'A'
 10248        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10249                                    WS-AH-REFUND-CALC.
 10250     IF AM-EARN-METHOD-A = 'M'
 10251        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10252                                    WS-AH-REFUND-CALC.
 10253     IF AM-EARN-METHOD-A = 'N'
 10254        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10255                                    WS-AH-REFUND-CALC.
 10256     IF AM-EARN-METHOD-A = 'S'
 10257        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10258                                    WS-AH-REFUND-CALC.
 10259
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 187
* EL050.cbl
 10260     IF AM-TOL-PREM NOT = ZEROS
 10261        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10262                                    WS-TOL-AH-PREM.
 10263
 10264     IF AM-OVR-SHT-AMT NUMERIC AND
 10265                  AM-OVR-SHT-AMT > 0
 10266        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10267                                    EC-AM-LF-OVR-SHT-AMT
 10268                                    WS-AH-REFUND-OVS-AMT
 10269                                    EC-AM-AH-OVR-SHT-AMT.
 10270
 10271     IF AM-OVR-SHT-PCT NUMERIC AND
 10272                    AM-OVR-SHT-PCT > 0
 10273        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10274                                    EC-AM-LF-OVR-SHT-PCT
 10275                                    WS-AH-REFUND-OVS-PCT
 10276                                    EC-AM-AH-OVR-SHT-PCT.
 10277
 10278     IF AM-TOL-REF-PCT NUMERIC AND
 10279                  AM-TOL-REF-PCT > 0
 10280        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10281                                    WS-TOL-AH-REFUND-PCT.
 10282
 10283     IF AM-TOL-REF  NOT = ZEROS  AND
 10284                  AM-TOL-REF NUMERIC
 10285        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10286                                    EC-AM-LF-TOL-REFUND
 10287                                    WS-TOL-AH-REFUND
 10288                                    EC-AM-AH-TOL-REFUND.
 10289
 10290     IF AM-TOL-CLM  NOT = ZEROS
 10291        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10292                                    WS-TOL-AH-CLAIM.
 10293
 10294     IF AM-CLP-TOL-PCT NOT NUMERIC
 10295        MOVE +0                  TO AM-CLP-TOL-PCT
 10296     END-IF
 10297
 10298     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10299        MOVE +0                  TO AM-SPP-LEASE-COMM
 10300     END-IF
 10301     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10302        MOVE WS-PL-TOL-LF-PREM-PCT
 10303                                 TO WS-TOL-LF-PREM-PCT.
 10304
 10305     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10306        MOVE WS-PL-TOL-AH-PREM-PCT
 10307                                 TO WS-TOL-AH-PREM-PCT.
 10308
 10309     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10310        MOVE WS-PL-TOL-LF-REFUND-PCT
 10311                                 TO WS-TOL-LF-REFUND-PCT.
 10312
 10313     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10314        MOVE WS-PL-TOL-AH-REFUND-PCT
 10315                                 TO WS-TOL-AH-REFUND-PCT.
 10316
 10317     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 188
* EL050.cbl
 10318        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10319
 10320     IF WS-PL-REF-OVS-PCT > +0
 10321        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10322
 10323     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10324        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10325     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10326        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10327     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10328        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10329     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10330        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10331     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10332        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10333     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10334        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10335
 10336     IF WS-AH-PL-REF-OVS-AMT > +0
 10337        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10338
 10339     IF WS-AH-PL-REF-OVS-PCT > +0
 10340        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10341
 10342     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10343     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10344
 10345     IF PB-CANCELLATION
 10346        GO TO 3000-CONTINUE-EDIT.
 10347
 10348     MOVE +1 TO SUB1.
 10349     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10350     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10351
 10352     IF CF-COMPANY-ID = 'DMD'
 10353       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10354         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10355        ELSE
 10356         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10357
 10358  0525-FIND-ACCT-COMM.
 10359     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10360        NEXT SENTENCE
 10361      ELSE
 10362         ADD +1 TO SUB1
 10363         IF SUB1 LESS +11
 10364            GO TO 0525-FIND-ACCT-COMM
 10365          ELSE
 10366             GO TO 0560-EDIT-CONTINUE.
 10367
 10368     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10369     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10370                                    PB-I-LIFE-COMMISSION.
 10371***  IF PB-COMPANY-ID = 'CRI'
 10372     IF PB-PREM-ACCTNG-ONLY
 10373         GO TO 0560-EDIT-CONTINUE.
 10374
 10375     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 189
* EL050.cbl
 10376     MOVE ' '    TO WS-CTBL-READ-SW.
 10377
 10378
 10379 0530-GET-AH-COMP.
 10380     IF NO-AH-COVERAGE  OR
 10381        NO-AH-BENEFIT-MATCH
 10382           GO TO 0540-NEXT-READ-STEP.
 10383
 10384     IF AM-A-COM (SUB1) NUMERIC
 10385        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10386         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10387         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10388         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10389         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10390     ELSE
 10391          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10392          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10393          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10394          MOVE ZEROS             TO WS-SUB1
 10395                                    WS-COMMISSION
 10396          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10397          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10398          IF WS-COMMISSION > ZEROS
 10399             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10400             GO TO 0540-NEXT-READ-STEP
 10401          END-IF
 10402          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10403          IF CTBL-TABLE-FOUND
 10404             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10405                                        PB-I-AH-TERM
 10406             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10407             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10408             GO TO 0540-NEXT-READ-STEP
 10409          ELSE
 10410             IF FIRST-TIME-THROUGH
 10411                 GO TO 0530-GET-AH-COMP
 10412             ELSE
 10413                 MOVE ER-2609                TO WS-ERROR
 10414                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10415
 10416 0540-NEXT-READ-STEP.
 10417     MOVE '0540' TO CTBL-SW.
 10418     MOVE ' '    TO WS-CTBL-READ-SW.
 10419
 10420 0540-GET-LF-COMP.
 10421     IF NO-LIFE-COVERAGE  OR
 10422        NO-LF-BENEFIT-MATCH
 10423           GO TO 0560-EDIT-CONTINUE.
 10424
 10425     IF WS-LF-JOINT-INDICATOR = 'J'
 10426        IF AM-J-COM (SUB1) NUMERIC
 10427           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10428           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10429           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10430           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10431           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10432        ELSE
 10433           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 190
* EL050.cbl
 10434           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10435           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10436           MOVE ZEROS                TO WS-SUB1
 10437                                        WS-COMMISSION
 10438           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10439           IF WS-COMMISSION > ZEROS
 10440              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10441              GO TO 0560-EDIT-CONTINUE
 10442           END-IF
 10443           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10444           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10445           IF CTBL-TABLE-FOUND
 10446              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10447              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10448              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10449              GO TO 0560-EDIT-CONTINUE
 10450           ELSE
 10451              IF FIRST-TIME-THROUGH
 10452                  GO TO 0540-GET-LF-COMP
 10453              ELSE
 10454                  MOVE ER-2609                TO WS-ERROR
 10455                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10456                  GO TO 0560-EDIT-CONTINUE.
 10457
 10458     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10459        IF AM-L-COM (SUB1) NUMERIC
 10460           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10461           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10462           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10463           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10464           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10465        ELSE
 10466           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10467           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10468           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10469           MOVE ZEROS                TO WS-SUB1
 10470                                        WS-COMMISSION
 10471           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10472           IF WS-COMMISSION IS GREATER THAN ZEROS
 10473              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10474              GO TO 0560-EDIT-CONTINUE
 10475           END-IF
 10476           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10477           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10478           IF CTBL-TABLE-FOUND
 10479              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10480              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10481              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10482              GO TO 0560-EDIT-CONTINUE
 10483           ELSE
 10484              IF FIRST-TIME-THROUGH
 10485                  GO TO 0540-GET-LF-COMP
 10486              ELSE
 10487                  MOVE ER-2609                TO WS-ERROR
 10488                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10489
 10490*    GO TO 0560-EDIT-CONTINUE.
 10491
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 191
* EL050.cbl
 10492 0560-EDIT-CONTINUE.
 10493     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10494                                    WS-AH-PMF-COMM
 10495*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10496*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10497     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10498        (SUB1 > +10)
 10499        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10500           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10501           MOVE '0530'           TO CTBL-SW
 10502           MOVE ' '              TO WS-CTBL-READ-SW
 10503           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10504           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10505           MOVE '0540'           TO CTBL-SW
 10506           MOVE ' '              TO WS-CTBL-READ-SW
 10507           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10508        END-IF
 10509     END-PERFORM
 10510     GO TO 0564-EDIT-CONTINUE
 10511     .
 10512 0561-CHECK-AH.
 10513     IF (NO-AH-COVERAGE)
 10514        OR (NO-AH-BENEFIT-MATCH)
 10515        CONTINUE
 10516     ELSE
 10517        IF (AM-A-COM (SUB1) NUMERIC)
 10518           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10519           IF (AM-COM-TYP (SUB1) = 'A')
 10520              AND (WS-AH-PMF-COMM = ZEROS)
 10521              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10522           END-IF
 10523           CONTINUE
 10524        ELSE
 10525           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10526           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10527           MOVE PB-AH-OVERRIDE-L1
 10528                                 TO CTBL-BEN-TYPE
 10529           MOVE ZEROS            TO WS-SUB1
 10530                                    WS-COMMISSION
 10531           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10532           PERFORM 8300-READ-CTBL-TABLE
 10533                                 THRU 8300-EXIT
 10534           IF CTBL-TABLE-FOUND
 10535              IF (AM-COM-TYP (SUB1) = 'A')
 10536                 AND (WS-AH-PMF-COMM = ZEROS)
 10537                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10538                                        PB-I-AH-TERM
 10539                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10540                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10541              END-IF
 10542              CONTINUE
 10543           ELSE
 10544              IF FIRST-TIME-THROUGH
 10545                 GO TO 0561-CHECK-AH
 10546              ELSE
 10547                 MOVE ER-2609    TO WS-ERROR
 10548                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10549              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 192
* EL050.cbl
 10550           END-IF
 10551        END-IF
 10552     END-IF
 10553     .
 10554 0561-EXIT.
 10555     EXIT.
 10556 0563-CHECK-LF.
 10557     IF (NO-LIFE-COVERAGE)
 10558        OR (NO-LF-BENEFIT-MATCH)
 10559        CONTINUE
 10560     ELSE
 10561        IF WS-LF-JOINT-INDICATOR = 'J'
 10562           IF AM-J-COM (SUB1) NUMERIC
 10563              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10564              IF (AM-COM-TYP (SUB1) = 'A')
 10565                 AND (WS-LF-PMF-COMM = ZEROS)
 10566                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10567              END-IF
 10568              CONTINUE
 10569           ELSE
 10570              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10571              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10572              MOVE PB-LIFE-OVERRIDE-L1
 10573                                 TO CTBL-BEN-TYPE
 10574              MOVE ZEROS         TO WS-SUB1
 10575                                    WS-COMMISSION
 10576              MOVE AM-J-COMA (SUB1)
 10577                                 TO CTBL-TABLE
 10578              PERFORM 8300-READ-CTBL-TABLE
 10579                                 THRU 8300-EXIT
 10580              IF CTBL-TABLE-FOUND
 10581                 IF (AM-COM-TYP (SUB1) = 'A')
 10582                    AND (WS-LF-PMF-COMM = ZEROS)
 10583                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10584                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10585                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10586                 END-IF
 10587                 CONTINUE
 10588              ELSE
 10589                 IF FIRST-TIME-THROUGH
 10590                    GO TO 0563-CHECK-LF
 10591                 ELSE
 10592                    MOVE ER-2609 TO WS-ERROR
 10593                    PERFORM 9900-ERROR-FORMAT
 10594                                 THRU 9900-EXIT
 10595*                   GO TO 0560-EDIT-CONTINUE
 10596                 END-IF
 10597              END-IF
 10598           END-IF
 10599        ELSE
 10600           IF AM-L-COM (SUB1) NUMERIC
 10601              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10602              IF (AM-COM-TYP (SUB1) = 'A')
 10603                 AND (WS-LF-PMF-COMM = ZEROS)
 10604                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10605              END-IF
 10606              CONTINUE
 10607           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 193
* EL050.cbl
 10608              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10609              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10610              MOVE PB-LIFE-OVERRIDE-L1
 10611                                 TO CTBL-BEN-TYPE
 10612              MOVE ZEROS         TO WS-SUB1
 10613                                    WS-COMMISSION
 10614              MOVE AM-L-COMA (SUB1)
 10615                                 TO CTBL-TABLE
 10616              PERFORM 8300-READ-CTBL-TABLE
 10617                                 THRU 8300-EXIT
 10618              IF CTBL-TABLE-FOUND
 10619                 CONTINUE
 10620              ELSE
 10621                 IF FIRST-TIME-THROUGH
 10622                    GO TO 0563-CHECK-LF
 10623                 ELSE
 10624                    MOVE ER-2609 TO WS-ERROR
 10625                    PERFORM 9900-ERROR-FORMAT
 10626                                 THRU 9900-EXIT
 10627                 END-IF
 10628              END-IF
 10629           END-IF
 10630        END-IF
 10631     END-IF
 10632     .
 10633 0563-EXIT.
 10634     EXIT.
 10635 0564-EDIT-CONTINUE.
 10636
 10637     IF  PB-COMPANY-ID EQUAL 'DMD'
 10638         IF PB-I-NUM-BILLED EQUAL ZEROS
 10639            MOVE ER-8148       TO WS-ERROR
 10640            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10641
 10642*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10643*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10644*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10645*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10646*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10647*         IF NO-CONVERSION-ERROR
 10648*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10649*         ELSE
 10650*             IF PB-COMPANY-ID EQUAL 'HAN'
 10651*                 MOVE ZEROS     TO PB-I-AGE.
 10652     IF PB-I-BIRTHDAY > LOW-VALUES
 10653        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10654        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10655        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10656        PERFORM 8500-DATE-CONVERT
 10657                                 THRU 8500-EXIT
 10658        IF NO-CONVERSION-ERROR
 10659           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10660           IF PB-I-AGE > ZEROS
 10661              IF WS-WORK-AGE NOT = PB-I-AGE
 10662                 MOVE ER-9501    TO WS-ERROR
 10663                 PERFORM 9900-ERROR-FORMAT
 10664                                 THRU 9900-EXIT
 10665              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 194
* EL050.cbl
 10666           ELSE
 10667              MOVE WS-WORK-AGE   TO PB-I-AGE
 10668           END-IF
 10669        END-IF
 10670     END-IF
 10671     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10672                                   WS-INS-AGE-SET
 10673     IF PB-I-AGE = ZEROS
 10674        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10675           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10676                                   WS-INS-AGE-SET
 10677           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10678
 10679     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10680                                   WS-AH-EDIT-AGE.
 10681
 10682     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10683        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10684        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10685        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10686        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10687        IF NO-CONVERSION-ERROR
 10688           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10689           IF PB-I-JOINT-AGE > 0
 10690              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10691                 MOVE ER-9503    TO WS-ERROR
 10692                 PERFORM 9900-ERROR-FORMAT
 10693                                 THRU 9900-EXIT
 10694              END-IF
 10695           ELSE
 10696              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10697           END-IF
 10698        ELSE
 10699           MOVE ZEROS            TO PB-I-JOINT-AGE
 10700        END-IF
 10701     END-IF
 10702     IF PB-I-JOINT-AGE NOT NUMERIC
 10703        MOVE ZERO               TO PB-I-JOINT-AGE.
 10704
 10705     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10706                                   WS-JNT-AGE-SET
 10707     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10708        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10709           (WS-AH-JOINT-INDICATOR = 'J')
 10710           IF PB-I-JOINT-AGE = ZEROS
 10711               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10712                                          WS-JNT-AGE-SET
 10713               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10714           END-IF
 10715        END-IF
 10716     END-IF
 10717
 10718     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10719     IF WS-LF-JOINT-INDICATOR = 'J'
 10720        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10721        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10722            IF  PB-I-JOINT-AGE = ZERO
 10723                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 195
* EL050.cbl
 10724                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10725            ELSE
 10726                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10727                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10728                    IF PB-COMPANY-ID NOT = 'LBL'
 10729                        MOVE ER-2685    TO WS-ERROR
 10730                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10731
 10732     IF WS-AH-JOINT-INDICATOR = 'J'
 10733        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10734            IF  PB-I-JOINT-AGE = ZERO
 10735                MOVE ER-2686       TO WS-ERROR
 10736                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10737            ELSE
 10738                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10739                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10740                                           WS-EDIT-AGE
 10741                    IF PB-COMPANY-ID NOT = 'LBL'
 10742                        MOVE ER-2685    TO WS-ERROR
 10743                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10744
 10745******************************************************************
 10746*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10747******************************************************************
 10748
 10749     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10750        (WS-AH-SPECIAL-CALC-CD = 'O')
 10751        NEXT SENTENCE
 10752     ELSE
 10753        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10754          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10755           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10756            WS-AH-JOINT-INDICATOR = 'J')  AND
 10757           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10758            MOVE ER-2627             TO WS-ERROR
 10759            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10760
 10761     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10762        (WS-AH-SPECIAL-CALC-CD = 'O')
 10763         NEXT SENTENCE
 10764     ELSE
 10765         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10766            WS-AH-JOINT-INDICATOR = 'J'
 10767             IF PB-I-JOINT-INSURED = SPACES
 10768                 IF PB-COMPANY-ID NOT = 'JAL'
 10769                     MOVE ER-2696    TO WS-ERROR
 10770                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771
 10772     IF PB-COMPANY-ID NOT = 'BOA'
 10773        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10774           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10775           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10776               PB-I-JOINT-INSURED NOT = SPACES)
 10777                MOVE ER-2691         TO WS-ERROR
 10778                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10779
 10780     IF PB-COMPANY-ID = 'BOA'
 10781        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 196
* EL050.cbl
 10782           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10783            IF PB-I-JOINT-AGE NOT = ZEROS
 10784                MOVE ER-2691         TO WS-ERROR
 10785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10786
 10787     IF PB-COMPANY-ID = 'CRI'
 10788        IF PB-I-SIG-SW = 'J'
 10789           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10790              WS-AH-JOINT-INDICATOR NOT = 'J'
 10791              MOVE ER-2675       TO WS-ERROR
 10792              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10793
 10794     IF PB-COMPANY-ID = 'CRI'
 10795        IF PB-I-SIG-SW = 'S'
 10796           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10797              WS-AH-JOINT-INDICATOR = 'J'
 10798              MOVE ER-2676       TO WS-ERROR
 10799              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10800
 10801     IF PB-COMPANY-ID = 'CVL'
 10802         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10803            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10804              MOVE ER-2783           TO WS-ERROR
 10805              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10806     IF (WS-LF-JOINT-INDICATOR = 'J')
 10807        AND (WS-AH-JOINT-INDICATOR = 'J')
 10808        AND (PB-I-LF-TERM > 120)
 10809        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10810        MOVE ER-2783             TO WS-ERROR
 10811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10812     END-IF
 10813     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10814
 10815     IF PB-I-INDV-GRP-OVRD = 'I'
 10816        MOVE ER-2666             TO WS-ERROR
 10817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10818        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10819
 10820     IF PB-I-INDV-GRP-OVRD = 'G'
 10821        MOVE ER-2666             TO WS-ERROR
 10822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10823        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10824
 10825     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10826        NEXT SENTENCE
 10827     ELSE
 10828        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10829
 10830     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10831        IF WS-ERROR = ER-2666
 10832           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10833           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10834
 10835     IF PB-COMPANY-ID = 'CID'
 10836        IF PB-STATE = 'UT' OR 'MO'
 10837           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10838                 OR '76' OR '77')
 10839                      OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 197
* EL050.cbl
 10840               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10841                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10842                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10843                   OR '2K' OR '2L'))
 10844              AND PB-I-INDV-GRP-CD = 'I'
 10845              MOVE ER-2721             TO WS-ERROR
 10846              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10847           END-IF
 10848        END-IF
 10849     END-IF
 10850
 10851     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10852     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10853        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10854     ELSE
 10855        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10856     END-IF
 10857
 10858*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10859*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10860     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10861                                    ACCOUNT-AH-CK-SW.
 10862
 10863     IF PB-REISSUED-CERT       OR
 10864        PB-REIN-ONLY-CERT      OR
 10865        PB-POLICY-IS-DECLINED  OR
 10866        PB-POLICY-IS-VOIDED
 10867*       OR PB-MONTHLY-CERT
 10868         GO TO 3000-CONTINUE-EDIT.
 10869
 10870     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10871        IF WS-EDIT-AGE           > +65
 10872           MOVE ER-2709          TO WS-ERROR
 10873           PERFORM 9900-ERROR-FORMAT
 10874                                 THRU 9900-EXIT
 10875        ELSE
 10876           IF WS-EDIT-AGE        > +55
 10877              MOVE ER-2718       TO WS-ERROR
 10878              PERFORM 9900-ERROR-FORMAT
 10879                                 THRU 9900-EXIT
 10880           END-IF
 10881        END-IF
 10882     IF PB-COMPANY-ID = 'DCC'
 10883        IF WS-EDIT-AGE           > +65
 10884           MOVE ER-2709          TO WS-ERROR
 10885           PERFORM 9900-ERROR-FORMAT
 10886                                 THRU 9900-EXIT
 10887        END-IF
 10888     END-IF
 10889     .
 10890
 10891 0565-LIFE-PLAN-LIMIT-EDITS.
 10892
 10893     IF NOT LF-PLAN-MASTER-FOUND
 10894        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10895                                    EC-AM-LF-MAX-TOT-BEN
 10896        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10897
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 198
* EL050.cbl
 10898     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10899
 10900     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10901         IF PL-LM-AGE (1) = ZEROS
 10902             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10903
 10904     IF NO-LF-BENEFIT-MATCH          OR
 10905        WS-LF-BENEFIT-CD = ZEROS     OR
 10906        WS-LF-SPECIAL-CALC-CD = 'M'
 10907        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10908
 10909     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10910     MOVE +1                     TO SUB2.
 10911
 10912     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10913        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10914           MOVE +5   TO SUB2
 10915           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10916              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10917              (PL-LM-AGE (SUB2) EQUAL +0)
 10918              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10919              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10920
 10921     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10922
 10923     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10924                               + PB-I-LF-ALT-BENEFIT-AMT.
 10925
 10926 0568-CHECK-LIFE-ATT-AGE.
 10927
 10928     IF PL-ATT-AGE NUMERIC AND
 10929        PL-ATT-AGE > +0
 10930        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10931     END-IF
 10932*    IF PL-ATT-AGE NUMERIC AND
 10933*       PL-ATT-AGE > +0
 10934*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10935*       IF PB-I-BIRTHDAY > LOW-VALUES
 10936*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10937*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10938*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10939*          SET BIN-PLUS-ELAPSED  TO TRUE
 10940*          PERFORM 8500-DATE-CONVERT
 10941*                                THRU 8500-EXIT
 10942*          IF NO-CONVERSION-ERROR
 10943*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10944*             MOVE ER-2669       TO WS-ERROR
 10945*             PERFORM 9900-ERROR-FORMAT
 10946*                                THRU 9900-EXIT
 10947*          END-IF
 10948*       ELSE
 10949*          IF WS-ATT-AGE >= PL-ATT-AGE
 10950*             MOVE ER-2669       TO WS-ERROR
 10951*             PERFORM 9900-ERROR-FORMAT
 10952*                                THRU 9900-EXIT
 10953*          END-IF
 10954*       END-IF
 10955*    END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 199
* EL050.cbl
 10956     .
 10957 0570-CHECK-LIFE-LIMITS.
 10958
 10959     IF PB-COMPANY-ID EQUAL 'CRI'
 10960        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10961           IF SUB2 GREATER THAN +4
 10962              MOVE ER-2637 TO WS-ERROR
 10963              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10964              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10965
 10966     IF PB-COMPANY-ID  =  'NCL'
 10967        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10968            SUB2 GREATER THAN +8
 10969             MOVE 'U'         TO PB-BATCH-ENTRY
 10970             MOVE ER-2637     TO WS-ERROR
 10971             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10972             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10973
 10974     IF SUB2 > +8
 10975        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10976           AND (PB-I-SIG-SW = 'Y')
 10977           CONTINUE
 10978        ELSE
 10979           MOVE ER-2637          TO WS-ERROR
 10980           PERFORM 9900-ERROR-FORMAT
 10981                                 THRU 9900-EXIT
 10982        END-IF
 10983        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10984     END-IF
 10985     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10986     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10987     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10988
 10989     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10990        ADD +1  TO SUB2
 10991        GO TO 0570-CHECK-LIFE-LIMITS.
 10992
 10993     IF PB-COMPANY-ID = 'NCL'
 10994         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10995
 10996     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10997        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10998        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10999           AND (PB-I-SIG-SW = 'Y')
 11000           CONTINUE
 11001        ELSE
 11002           MOVE ER-2637          TO WS-ERROR
 11003           PERFORM 9900-ERROR-FORMAT
 11004                                 THRU 9900-EXIT
 11005        END-IF
 11006     END-IF
 11007     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11008
 11009
 11010 0570-CHECK-NCL-LIFE-LIMITS.
 11011
 11012     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11013        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 200
* EL050.cbl
 11014         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11015
 11016     IF APP-CERT-USED
 11017         IF SUB2  LESS THAN  +5
 11018             MOVE +5          TO SUB2
 11019             GO TO 0570-CHECK-LIFE-LIMITS.
 11020
 11021     MOVE ER-2637             TO WS-ERROR.
 11022     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11023
 11024     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11025
 11026 0575-CHECK-NCL-SIG-SWITCH.
 11027
 11028     IF NOT APP-CERT-USED
 11029         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11030
 11031     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11032        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11033        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11034        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11035         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11036
 11037     IF SUB2 GREATER THAN +4
 11038         IF PL-LM-AGE (5) = ZEROS  AND
 11039            PL-LM-AGE (6) = ZEROS  AND
 11040            PL-LM-AGE (7) = ZEROS  AND
 11041            PL-LM-AGE (8) = ZEROS
 11042             MOVE  ER-1927        TO WS-ERROR
 11043             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11044             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11045         ELSE
 11046             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11047                 MOVE  ER-1920    TO WS-ERROR
 11048                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11049
 11050     IF PB-I-SIG-SW  = 'Y'
 11051       IF NOT PB-I-POLICY-ACCEPTED  AND
 11052          NOT PB-I-POLICY-DECLINED
 11053           MOVE 'U'               TO PB-BATCH-ENTRY
 11054           MOVE  ER-1926          TO WS-ERROR
 11055           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11056
 11057
 11058 0580-AH-PLAN-LIMIT-EDITS.
 11059
 11060     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11061        IF PB-I-AH-BENEFIT-AMT > +1250
 11062           MOVE ER-2702          TO WS-ERROR
 11063           PERFORM 9900-ERROR-FORMAT
 11064                                 THRU 9900-EXIT
 11065        END-IF
 11066     END-IF
 11067
 11068     IF (PB-COMPANY-ID = 'DCC')
 11069        AND (PB-MONTHLY-CERT)
 11070        IF PB-I-AH-BENEFIT-AMT > +3000
 11071           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 201
* EL050.cbl
 11072           PERFORM 9900-ERROR-FORMAT
 11073                                 THRU 9900-EXIT
 11074        END-IF
 11075     END-IF
 11076     IF NOT AH-PLAN-MASTER-FOUND
 11077        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11078        GO TO 3000-CONTINUE-EDIT.
 11079
 11080     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11081
 11082     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11083         IF PL-LM-AGE (1) = ZEROS
 11084             GO TO 3000-CONTINUE-EDIT.
 11085
 11086     IF NO-AH-BENEFIT-MATCH          OR
 11087        WS-AH-BENEFIT-CD = ZEROS     OR
 11088        WS-AH-SPECIAL-CALC-CD = 'M'
 11089        GO TO 3000-CONTINUE-EDIT.
 11090
 11091     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11092     MOVE +1                     TO SUB2.
 11093
 11094     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11095        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11096           MOVE +5 TO SUB2
 11097           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11098              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11099              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11100              (PL-LM-AGE (SUB2) EQUAL +0)
 11101              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11102              GO TO 3000-CONTINUE-EDIT.
 11103
 11104     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11105
 11106 0590-CHECK-AH-ATT-AGE.
 11107
 11108     IF PL-ATT-AGE NUMERIC AND
 11109        PL-ATT-AGE GREATER THAN +0
 11110        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11111     END-IF
 11112*       IF WS-ATT-AGE >= PL-ATT-AGE
 11113*          MOVE ER-3054          TO WS-ERROR
 11114*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11115     .
 11116 0597-CHECK-AH-LIMITS.
 11117
 11118     IF PB-COMPANY-ID EQUAL 'CRI'
 11119        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11120           IF SUB2 GREATER THAN +4
 11121              MOVE ER-2638       TO WS-ERROR
 11122              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11123              GO TO 3000-CONTINUE-EDIT.
 11124
 11125     IF PB-COMPANY-ID  =  'NCL'
 11126        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11127            SUB2 GREATER THAN +8
 11128             MOVE 'U'            TO PB-BATCH-ENTRY
 11129             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 202
* EL050.cbl
 11130             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11131             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11132
 11133     IF SUB2 > +8
 11134        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11135           AND (PB-I-SIG-SW = 'Y')
 11136           CONTINUE
 11137        ELSE
 11138           MOVE ER-2638          TO WS-ERROR
 11139           PERFORM 9900-ERROR-FORMAT
 11140                                 THRU 9900-EXIT
 11141        END-IF
 11142        GO TO 3000-CONTINUE-EDIT
 11143     END-IF
 11144
 11145     IF PB-COMPANY-ID = 'CRI'
 11146        IF WS-ERROR = ER-2638
 11147           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11148
 11149     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11150     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11151     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11152     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11153
 11154     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11155        ADD +1                   TO SUB2
 11156        GO TO 0597-CHECK-AH-LIMITS.
 11157
 11158     IF PB-COMPANY-ID = 'NCL'
 11159         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11160
 11161     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11162        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11163        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11164                                 > PL-LM-AMT (SUB2))
 11165        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11166           AND (PB-I-SIG-SW = 'Y')
 11167           CONTINUE
 11168        ELSE
 11169           MOVE ER-2638          TO WS-ERROR
 11170           PERFORM 9900-ERROR-FORMAT
 11171                                 THRU 9900-EXIT
 11172        END-IF
 11173     END-IF
 11174
 11175     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11176         IF  WS-ERROR    EQUAL    ER-2638
 11177             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11178                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11179                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11180                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11181                MOVE  ER-1910    TO  WS-ERROR
 11182                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11183
 11184     IF PB-COMPANY-ID = 'CRI'
 11185        IF WS-ERROR = ER-2638
 11186            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11187            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 203
* EL050.cbl
 11188            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11189
 11190     GO TO 3000-CONTINUE-EDIT.
 11191
 11192 0597-CHECK-NCL-AH-LIMITS.
 11193
 11194     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11195        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11196        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11197                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11198         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11199
 11200     IF APP-CERT-USED
 11201         IF SUB2  LESS THAN  +5
 11202             MOVE +5             TO SUB2
 11203             GO TO 0597-CHECK-AH-LIMITS.
 11204
 11205     MOVE ER-2638                TO WS-ERROR.
 11206     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11207
 11208     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11209
 11210 0599-CHECK-NCL-SIG-SWITCH.
 11211
 11212     IF NOT APP-CERT-USED
 11213         GO TO 3000-CONTINUE-EDIT.
 11214
 11215     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11216        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11217        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11218        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11219         GO TO 3000-CONTINUE-EDIT.
 11220
 11221     IF SUB2 GREATER THAN +4
 11222         IF PL-LM-AGE (5) = ZEROS  AND
 11223            PL-LM-AGE (6) = ZEROS  AND
 11224            PL-LM-AGE (7) = ZEROS  AND
 11225            PL-LM-AGE (8) = ZEROS
 11226             MOVE  ER-1927        TO WS-ERROR
 11227             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11228             GO TO 3000-CONTINUE-EDIT
 11229         ELSE
 11230             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11231                 MOVE  ER-1920    TO WS-ERROR
 11232                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11233
 11234     IF PB-I-SIG-SW  = 'Y'
 11235       IF NOT PB-I-POLICY-ACCEPTED  AND
 11236          NOT PB-I-POLICY-DECLINED
 11237           MOVE 'U'               TO PB-BATCH-ENTRY
 11238           MOVE  ER-1926          TO WS-ERROR
 11239           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11240
 11241******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 204
* EL050.cbl
 11243
 11244 3000-CONTINUE-EDIT.
 11245
 11246     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11247     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11248     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11249     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11250     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11251
 11252     IF BROWSE-STARTED
 11253        PERFORM 9990-RETURN THRU 9990-EXIT
 11254        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11255
 11256     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11257        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11258        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11259        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11260*       MOVE 1                   TO DC-OPTION-CODE
 11261        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11262        IF DATE-CONVERSION-ERROR
 11263           MOVE ER-2622          TO WS-ERROR
 11264           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11265        ELSE
 11266           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11267              MOVE ER-2623       TO WS-ERROR
 11268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11269           ELSE
 11270              MOVE ER-2622       TO WS-ERROR
 11271              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11272
 11273     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11274     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11275     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11276*    MOVE 1                      TO DC-OPTION-CODE.
 11277     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11278     IF DATE-CONVERSION-ERROR
 11279        GO TO 3005-EDIT-CONTINUE
 11280     ELSE
 11281        IF DC-ELAPSED-DAYS GREATER +180
 11282           MOVE ER-2613          TO WS-ERROR
 11283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11284        ELSE
 11285           IF DC-ELAPSED-DAYS GREATER +90
 11286              MOVE ER-2612       TO WS-ERROR
 11287              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11288           ELSE
 11289             IF DC-ELAPSED-DAYS GREATER +60
 11290                MOVE ER-2614     TO WS-ERROR
 11291                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11292
 11293 3005-EDIT-CONTINUE.
 11294
 11295     IF PB-CANCELLATION
 11296         GO TO 3700-EDIT-CANCEL.
 11297
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 205
* EL050.cbl
 11299******************************************************************
 11300*                  E D I T   I S S U E                           *
 11301******************************************************************
 11302
 11303 3020-EDIT-ISSUE.
 11304
 11305      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11306      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11307      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11308      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11309      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11310
 11311     IF PB-ISSUE-FORCE
 11312        OR PB-ISSUE-DATE-FORCED
 11313        OR PB-FORCE-OFF
 11314        OR PB-OVERCHARGE-FORCE
 11315        CONTINUE
 11316     ELSE
 11317        MOVE ER-2670             TO WS-ERROR
 11318        PERFORM 9900-ERROR-FORMAT
 11319                                 THRU 9900-EXIT
 11320     END-IF
 11321     .
 11322 3022-SET-POLICY-STATUS.
 11323
 11324     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11325
 11326     IF (PB-REISSUED-CERT)
 11327             OR
 11328        ((PB-COMPANY-ID NOT = 'DCC')
 11329         AND (PB-MONTHLY-CERT))
 11330         MOVE '5'                TO PB-I-ENTRY-STATUS
 11331         MOVE 'E'                TO PB-BATCH-ENTRY
 11332     END-IF
 11333
 11334     IF PB-COMPANY-ID = 'DCC'
 11335        IF PB-MONTHLY-CERT
 11336           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11337        END-IF
 11338        IF PB-CASH-CERT
 11339           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11340        END-IF
 11341     END-IF
 11342     IF PB-POLICY-IS-DECLINED
 11343         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11344     IF PB-POLICY-IS-VOIDED
 11345         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11346     IF PB-NEEDS-UNDERWRITING
 11347         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11348     IF PB-REIN-ONLY-CERT
 11349         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11350     IF PB-PREM-ACCTNG-ONLY
 11351         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11352
 11353     MOVE SPACE                  TO PB-I-OB-FLAG.
 11354
 11355     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11356         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 206
* EL050.cbl
 11357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11359
 11360     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11361        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11362           MOVE 'Z'             TO PB-I-OB-FLAG.
 11363
 11364     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11365        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11366           MOVE 'Z'             TO PB-I-OB-FLAG.
 11367
 11368     IF ACCOUNT-MAST-FOUND
 11369         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11370         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11371         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11372         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11373         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11374         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11375         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11376     END-IF
 11377
 11378     IF ACCOUNT-MAST-FOUND
 11379        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11380         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11381
 11382     IF (ACCOUNT-MAST-FOUND)
 11383        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11384        IF PB-REISSUED-CERT
 11385           CONTINUE
 11386        ELSE
 11387           MOVE ER-2608          TO WS-ERROR
 11388           PERFORM 9900-ERROR-FORMAT
 11389                                 THRU 9900-EXIT
 11390         END-IF
 11391     END-IF
 11392
 11393     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11394        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11395        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11396
 11397**********   DMD CUSTOM CODE FOLLOWS  **********
 11398 3024-EDIT-DMD-FIELDS.
 11399     IF PB-COMPANY-ID NOT = 'DMD'
 11400        GO TO 3025-EDIT-REINSURANCE.
 11401
 11402*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11403*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11404*** ERROR IF THEY ARE NOT EQUAL.
 11405
 11406     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11407     SET BIN-TO-GREG               TO TRUE.
 11408     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11409     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11410**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11411
 11412     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11413     SET BIN-TO-GREG               TO TRUE.
 11414     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 207
* EL050.cbl
 11415     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11416**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11417
 11418     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11419        MOVE ER-8116               TO WS-ERROR
 11420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11421
 11422     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11423
 11424     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11425                                      WK-FULL-CERT-NO.
 11426     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11427
 11428     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11429
 11430     IF PB-VALID-LIFE
 11431        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11432     ELSE
 11433        IF PB-VALID-AH
 11434          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11435
 11436
 11437     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11438     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11439     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11440                                      DCUA-UNDRWRTR-CODE
 11441                                      DCUA-UNDRWRTR-GROUP-CODE
 11442                                      DCUA-RETURN-CODE.
 11443
 11444****************************************************************
 11445*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11446***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11447***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11448***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11449***   TO THIS RECORD.                                        ***
 11450****************************************************************
 11451     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11452     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11453     IF DCUA-SUCCESSFUL-PROCESS
 11454        GO TO 3024-EDIT-DL7-CONT.
 11455
 11456     IF DCUA-RETURN-CODE EQUAL '01'
 11457        MOVE ER-8110               TO WS-ERROR
 11458        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11460        GO TO 3024-EDIT-DL7-CONT.
 11461
 11462     IF DCUA-RETURN-CODE EQUAL '02'
 11463        MOVE ER-8111               TO WS-ERROR
 11464        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11465        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11466        GO TO 3024-EDIT-DL7-CONT.
 11467
 11468     IF DCUA-RETURN-CODE EQUAL '03'
 11469        MOVE ER-8074               TO WS-ERROR
 11470        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11472        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 208
* EL050.cbl
 11473
 11474     IF DCUA-RETURN-CODE EQUAL '04'
 11475        MOVE ER-8075               TO WS-ERROR
 11476        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11478        GO TO 3024-EDIT-DL7-CONT.
 11479
 11480     IF DCUA-RETURN-CODE EQUAL '05'
 11481        MOVE ER-8076               TO WS-ERROR
 11482        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484        GO TO 3024-EDIT-DL7-CONT.
 11485
 11486     IF DCUA-RETURN-CODE EQUAL '06'
 11487        MOVE ER-8077               TO WS-ERROR
 11488        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490        GO TO 3024-EDIT-DL7-CONT.
 11491
 11492     IF DCUA-RETURN-CODE EQUAL '07'
 11493        MOVE ER-8078               TO WS-ERROR
 11494        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11496        GO TO 3024-EDIT-DL7-CONT.
 11497
 11498     IF DCUA-RETURN-CODE EQUAL 'E1'
 11499        MOVE ER-8079               TO WS-ERROR
 11500        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502        GO TO 3024-EDIT-DL7-CONT.
 11503
 11504     IF DCUA-RETURN-CODE EQUAL 'E2'
 11505        MOVE ER-8080               TO WS-ERROR
 11506        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11508        GO TO 3024-EDIT-DL7-CONT.
 11509
 11510     IF DCUA-RETURN-CODE EQUAL 'E3'
 11511        MOVE ER-8098               TO WS-ERROR
 11512        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11514        GO TO 3024-EDIT-DL7-CONT.
 11515
 11516     IF DCUA-RETURN-CODE EQUAL 'C1'
 11517        MOVE ER-8099               TO WS-ERROR
 11518        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        GO TO 3024-EDIT-DL7-CONT.
 11521
 11522     IF DCUA-RETURN-CODE EQUAL 'U1'
 11523        MOVE ER-8109               TO WS-ERROR
 11524        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11526        GO TO 3024-EDIT-DL7-CONT.
 11527
 11528     IF DCUA-RETURN-CODE EQUAL 'N1'
 11529        MOVE ER-8112               TO WS-ERROR
 11530        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 209
* EL050.cbl
 11531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11532        GO TO 3024-EDIT-DL7-CONT.
 11533
 11534     IF DCUA-RETURN-CODE EQUAL 'N2'
 11535        MOVE ER-8113               TO WS-ERROR
 11536        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538        GO TO 3024-EDIT-DL7-CONT.
 11539
 11540     IF DCUA-RETURN-CODE EQUAL 'N3'
 11541        MOVE ER-8114               TO WS-ERROR
 11542        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544        GO TO 3024-EDIT-DL7-CONT.
 11545
 11546     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11547     MOVE ER-8097                  TO WS-ERROR.
 11548     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11549     GO TO 3024-EDIT-DL7-CONT.
 11550
 11551 3024-EDIT-DL7-CONT.
 11552
 11553     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11554     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11555     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11556        NEXT SENTENCE
 11557     ELSE
 11558        MOVE ER-9263               TO WS-ERROR
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11560
 11561******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11562******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11563     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11564        NEXT SENTENCE
 11565     ELSE
 11566        MOVE ER-8039               TO WS-ERROR
 11567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11568
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 210
* EL050.cbl
 11570****************************************************************
 11571*** VALIDATE STATE  : DLO022                                 ***
 11572****************************************************************
 11573     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11574     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11575
 11576     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11577     IF DVSC-SUCCESSFUL-EDIT
 11578        GO TO 3024-EDIT-DL22-CONT.
 11579
 11580     IF DVSC-RETURN-CODE EQUAL '01'
 11581        MOVE ER-8300               TO WS-ERROR
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583        GO TO 3024-EDIT-DL22-CONT.
 11584
 11585     IF DVSC-RETURN-CODE EQUAL '02'
 11586        MOVE ER-8301               TO WS-ERROR
 11587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11588        GO TO 3024-EDIT-DL22-CONT.
 11589
 11590     IF DVSC-RETURN-CODE EQUAL '03'
 11591        MOVE ER-8302               TO WS-ERROR
 11592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11593        GO TO 3024-EDIT-DL22-CONT.
 11594
 11595     IF DVSC-RETURN-CODE EQUAL 'N1'
 11596        MOVE ER-8304               TO WS-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598        GO TO 3024-EDIT-DL22-CONT.
 11599
 11600     MOVE ER-8303                  TO WS-ERROR
 11601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11602
 11603 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 211
* EL050.cbl
 11605****************************************************************
 11606*** VALIDATE LOAN OFFICER : DLO021                           ***
 11607****************************************************************
 11608
 11609     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11610     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11611     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11612     IF DVLO-SUCCESSFUL-EDIT
 11613        GO TO 3024-EDIT-DL21-CONT.
 11614
 11615     IF DVLO-RETURN-CODE EQUAL '01'
 11616        MOVE ER-8081               TO WS-ERROR
 11617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618        GO TO 3024-EDIT-DL21-CONT.
 11619
 11620     IF DVLO-RETURN-CODE EQUAL '02'
 11621        MOVE ER-8082               TO WS-ERROR
 11622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11623        GO TO 3024-EDIT-DL21-CONT.
 11624
 11625     IF DVLO-RETURN-CODE EQUAL '03'
 11626        MOVE ER-8083               TO WS-ERROR
 11627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11628        GO TO 3024-EDIT-DL21-CONT.
 11629
 11630     IF DVLO-RETURN-CODE EQUAL '04'
 11631        MOVE ER-8084               TO WS-ERROR
 11632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11633        GO TO 3024-EDIT-DL21-CONT.
 11634
 11635     IF DVLO-RETURN-CODE EQUAL '05'
 11636        MOVE ER-8085               TO WS-ERROR
 11637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11638        GO TO 3024-EDIT-DL21-CONT.
 11639
 11640     MOVE ER-7825                  TO WS-ERROR
 11641     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11642     GO TO 3024-EDIT-DL21-CONT.
 11643
 11644 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 212
* EL050.cbl
 11646
 11647****************************************************************
 11648*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11649****************************************************************
 11650
 11651     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11652     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11653     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11654     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11655     IF DIPF-SUCCESSFUL-EDIT
 11656        GO TO 3024-EDIT-DL02-CONT.
 11657
 11658     IF DIPF-RETURN-CODE EQUAL '01'
 11659        MOVE ER-8086               TO WS-ERROR
 11660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11661        GO TO 3024-EDIT-DL02-CONT.
 11662
 11663     IF DIPF-RETURN-CODE EQUAL '02'
 11664        MOVE ER-8087               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666        GO TO 3024-EDIT-DL02-CONT.
 11667
 11668     IF DIPF-RETURN-CODE EQUAL '03'
 11669        MOVE ER-8088               TO WS-ERROR
 11670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11671        GO TO 3024-EDIT-DL02-CONT.
 11672
 11673     MOVE ER-8095                  TO WS-ERROR
 11674     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11675     GO TO 3024-EDIT-DL02-CONT.
 11676
 11677 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 213
* EL050.cbl
 11679
 11680****************************************************************
 11681*** VALIDATE BANK ID : DLO003                                ***
 11682****************************************************************
 11683
 11684     MOVE WK-GREG-CENT           TO WCG-CENT.
 11685     MOVE WK-GREG-YYMM           TO WCG-REST.
 11686     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11687        MOVE ER-8040               TO WS-ERROR
 11688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11689
 11690     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11691     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11692     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11693     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11694     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11695     IF DVBI-SUCCESSFUL-EDIT
 11696        GO TO 3024-EDIT-DL03-CONT.
 11697
 11698     IF DVBI-RETURN-CODE EQUAL '01'
 11699        MOVE ER-8089               TO WS-ERROR
 11700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701        GO TO 3024-EDIT-DL03-CONT.
 11702
 11703     IF DVBI-RETURN-CODE EQUAL '02'
 11704        MOVE ER-8090               TO WS-ERROR
 11705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706        GO TO 3024-EDIT-DL03-CONT.
 11707
 11708     IF DVBI-RETURN-CODE EQUAL '03'
 11709        MOVE ER-8091               TO WS-ERROR
 11710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711        GO TO 3024-EDIT-DL03-CONT.
 11712
 11713     IF DVBI-RETURN-CODE EQUAL '04'
 11714        MOVE ER-8092               TO WS-ERROR
 11715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11716        GO TO 3024-EDIT-DL03-CONT.
 11717
 11718     IF DVBI-RETURN-CODE EQUAL '05'
 11719        MOVE ER-8093               TO WS-ERROR
 11720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11721        GO TO 3024-EDIT-DL03-CONT.
 11722
 11723     IF DVBI-RETURN-CODE EQUAL '06'
 11724        MOVE ER-8094               TO WS-ERROR
 11725        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11726        GO TO 3024-EDIT-DL03-CONT.
 11727
 11728     MOVE ER-8096                  TO WS-ERROR
 11729     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11730     GO TO 3024-EDIT-DL03-CONT.
 11731
 11732 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 214
* EL050.cbl
 11734
 11735     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11736        NEXT SENTENCE
 11737     ELSE
 11738        MOVE ER-8042               TO WS-ERROR
 11739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11740
 11741     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11742     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11743     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11744
 11745     IF DMPF-RETURN-CODE = '01'
 11746        MOVE ER-8067               TO WS-ERROR
 11747        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11748        GO TO 3024-EDIT-DL01-CONT.
 11749
 11750     IF DMPF-RETURN-CODE = '02'
 11751        MOVE ER-8068               TO WS-ERROR
 11752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11753        GO TO 3024-EDIT-DL01-CONT.
 11754
 11755     IF DMPF-RETURN-CODE = '03'
 11756        MOVE ER-8069               TO WS-ERROR
 11757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11758        GO TO 3024-EDIT-DL01-CONT.
 11759
 11760     IF DMPF-RETURN-CODE = 'E1'
 11761        MOVE ER-8070               TO WS-ERROR
 11762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11763        GO TO 3024-EDIT-DL01-CONT.
 11764
 11765     IF DMPF-RETURN-CODE = 'N1'
 11766        MOVE ER-8071               TO WS-ERROR
 11767        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11768        GO TO 3024-EDIT-DL01-CONT.
 11769
 11770     IF DMPF-RETURN-CODE NOT = 'OK'
 11771        MOVE ER-8072               TO WS-ERROR
 11772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11773
 11774 3024-EDIT-DL01-CONT.
 11775******************************************************************
 11776***  VALIDATES RATE CODES : DLO017                             ***
 11777******************************************************************
 11778
 11779      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11780      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11781      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11782      IF DVRC-SUCCESSFUL-EDIT
 11783        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11784        GO TO 3024-CHECK-VALID-RATE.
 11785
 11786      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11787
 11788      IF DVRC-RETURN-CODE EQUAL '01'
 11789         MOVE ER-7817                   TO WS-ERROR
 11790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 215
* EL050.cbl
 11792
 11793      IF DVRC-RETURN-CODE EQUAL '02'
 11794         MOVE ER-7818                   TO WS-ERROR
 11795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796         GO TO 3025-EDIT-REINSURANCE.
 11797
 11798      IF DVRC-RETURN-CODE EQUAL '03'
 11799         MOVE ER-7819                   TO WS-ERROR
 11800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11801         GO TO 3025-EDIT-REINSURANCE.
 11802
 11803       MOVE ER-7820                     TO WS-ERROR.
 11804       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11805       GO TO 3025-EDIT-REINSURANCE.
 11806
 11807******************************************************************
 11808***  GET PREMIUM RATES : DLO011                                ***
 11809******************************************************************
 11810
 11811 3024-CHECK-VALID-RATE.
 11812
 11813     IF VALID-RATE-CODE
 11814        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11815        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11816        MOVE SPACES                TO DPRB-RETURN-CODE
 11817        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11818     ELSE
 11819         GO TO 3025-EDIT-REINSURANCE.
 11820
 11821      IF DPRB-SUCCESSFUL-PROCESS
 11822         IF PB-VALID-LIFE
 11823             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11824             GO TO 3025-EDIT-REINSURANCE
 11825         ELSE
 11826             IF PB-VALID-AH
 11827                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11828                 GO TO 3025-EDIT-REINSURANCE.
 11829
 11830      IF DPRB-RETURN-CODE EQUAL '01'
 11831         MOVE ER-7812                   TO WS-ERROR
 11832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11833         GO TO 3025-EDIT-REINSURANCE.
 11834
 11835      IF DPRB-RETURN-CODE EQUAL '02'
 11836         MOVE ER-7813                   TO WS-ERROR
 11837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11838         GO TO 3025-EDIT-REINSURANCE.
 11839
 11840      IF DPRB-RETURN-CODE EQUAL '03'
 11841         MOVE ER-7814                   TO WS-ERROR
 11842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11843         GO TO 3025-EDIT-REINSURANCE.
 11844
 11845      IF DPRB-RETURN-CODE EQUAL '04'
 11846         IF NOT DPRB-1ST-TIME
 11847            MOVE ER-7815                   TO WS-ERROR
 11848            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11849            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 216
* EL050.cbl
 11850          ELSE
 11851         IF PB-VALID-LIFE
 11852            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11853          ELSE
 11854            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11855         END-IF
 11856         MOVE SPACES                TO DOCC-RETURN-CODE
 11857         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11858         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11859         IF DOCC-RETURN-CODE = 'OK'
 11860             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11861             GO TO 3024-CHECK-VALID-RATE
 11862           ELSE
 11863             MOVE ER-7823               TO WS-ERROR
 11864             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11865             GO TO 3025-EDIT-REINSURANCE.
 11866
 11867       MOVE ER-7816                     TO WS-ERROR.
 11868       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11869       GO TO 3025-EDIT-REINSURANCE.
 11870
 11871**********   DMD CUSTOM CODE ABOVE    **********
 11872
 11873 3025-EDIT-REINSURANCE.
 11874     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11875         GO TO 3027-EDIT-CONTINUE.
 11876
 11877     MOVE LOW-VALUES               TO ERREIN-KEY.
 11878     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11879     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11880                                      REIN-CODE-2
 11881                                      REIN-CODE-3.
 11882     MOVE 'A'                      TO REIN-TYPE.
 11883
 11884     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11885
 11886     MOVE '3026' TO REIN-SW.
 11887     MOVE ' '                   TO WS-REIN-READ-SW.
 11888
 11889     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11890     IF REIN-TABLE-NOT-FOUND
 11891         GO TO 3026-NO-SPEC-TABLE.
 11892
 11893     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11894     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11895                                   WS-NSP-ST-CD-LF.
 11896     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11897                                   WS-NSP-ST-CD-AH.
 11898
 11899     GO TO 3040-EDIT-CONTINUE.
 11900
 11901 3026-NO-SPEC-TABLE.
 11902
 11903     MOVE ER-2664                TO WS-ERROR.
 11904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11905     GO TO 3040-EDIT-CONTINUE.
 11906
 11907 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 217
* EL050.cbl
 11908
 11909     IF PB-I-REIN-TABLE = SPACES
 11910       GO TO 3040-EDIT-CONTINUE.
 11911
 11912     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11913          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11914          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11915           GO TO 3040-EDIT-CONTINUE.
 11916
 11917     MOVE LOW-VALUES            TO ERREIN-KEY.
 11918     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11919     MOVE 'A'                   TO REIN-TYPE.
 11920     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11921
 11922     MOVE '3028'                TO REIN-SW.
 11923     MOVE ' '                   TO WS-REIN-READ-SW.
 11924
 11925     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11926     IF REIN-TABLE-NOT-FOUND
 11927         GO TO 3028-NO-REIN-TABLE.
 11928
 11929     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11930     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11931                                   WS-NSP-ST-CD-LF.
 11932     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11933                                   WS-NSP-ST-CD-AH.
 11934
 11935     GO TO 3040-EDIT-CONTINUE.
 11936
 11937 3028-NO-REIN-TABLE.
 11938
 11939     MOVE ER-2615                TO WS-ERROR.
 11940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11941     GO TO 3040-EDIT-CONTINUE.
 11942
 11943 3040-EDIT-CONTINUE.
 11944
 11945     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11946         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11947
 11948     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11949         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11950
 11951     IF (NOT PB-REISSUED-CERT)
 11952        AND (NOT PB-MONTHLY-CERT)
 11953        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11954            MOVE '001'           TO PB-I-LF-TERM
 11955            MOVE 'M'             TO PB-I-INSURED-SEX.
 11956
 11957     IF (NOT PB-REISSUED-CERT)
 11958        AND (NOT PB-MONTHLY-CERT)
 11959        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11960            MOVE '001'           TO PB-I-AH-TERM
 11961            MOVE 'M'             TO PB-I-INSURED-SEX.
 11962
 11963 3040-EDIT-1ST-PMT-DT.
 11964     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11965     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 218
* EL050.cbl
 11966         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11967
 11968******************************************************************
 11969*                                                                *
 11970*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11971*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11972*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11973*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11974*                                                                *
 11975******************************************************************
 11976
 11977     IF PB-EFF-DT-PROCESSING
 11978        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11979                                    PB-I-LF-EXPIRE-DT
 11980                                    PB-I-AH-EXPIRE-DT
 11981        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11982        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11983        MOVE ZERO                TO DC-ELAPSED-DAYS
 11984        MOVE +1                  TO DC-ELAPSED-MONTHS
 11985        SET BIN-PLUS-ELAPSED     TO TRUE
 11986*       MOVE 6                   TO DC-OPTION-CODE
 11987        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11988        IF NO-CONVERSION-ERROR
 11989           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11990
 11991******************************************************************
 11992*                                                                *
 11993*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11994*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11995*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11996*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11997*                                                                *
 11998******************************************************************
 11999
 12000     IF PB-EXT-DAYS-PROCESSING
 12001          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12002                                         PB-I-LF-EXPIRE-DT
 12003                                         PB-I-AH-EXPIRE-DT
 12004          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12005          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12006          MOVE +1                     TO DC-ELAPSED-MONTHS
 12007          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12008          SET BIN-PLUS-ELAPSED        TO TRUE
 12009*         MOVE 6                      TO DC-OPTION-CODE
 12010          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12011          IF NO-CONVERSION-ERROR
 12012             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12013
 12014******************************************************************
 12015*                                                                *
 12016*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12017*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12018*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12019*        (EXPIRE DATE - (TERM -1))  *  -1.
 12020*                                                                *
 12021******************************************************************
 12022
 12023     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 219
* EL050.cbl
 12024        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12025           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12026              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12027              MOVE PB-I-AH-TERM      TO WS-TERM
 12028           ELSE
 12029              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12030              MOVE PB-I-LF-TERM      TO WS-TERM
 12031        ELSE
 12032           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12033              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12034              MOVE PB-I-LF-TERM      TO WS-TERM
 12035           ELSE
 12036              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12037              MOVE PB-I-AH-TERM      TO WS-TERM.
 12038
 12039     IF PB-EXPIRE-DT-PROCESSING
 12040        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12041        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12042        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12043        MOVE ZERO                TO DC-ELAPSED-DAYS
 12044                                    DC-ODD-DAYS-OVER
 12045          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12046          SET BIN-PLUS-ELAPSED    TO TRUE
 12047*         MOVE 6                  TO DC-OPTION-CODE
 12048          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12049          IF NO-CONVERSION-ERROR
 12050             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12051
 12052******************************************************************
 12053*                                                                *
 12054*            1ST PAYMENT DATE PROCESSING                         *
 12055*                                                                *
 12056******************************************************************
 12057
 12058     IF PB-1ST-PMT-DT-PROCESSING
 12059        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12060                                    PB-I-AH-EXPIRE-DT
 12061        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12062
 12063     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12064         NEXT SENTENCE
 12065     ELSE
 12066         MOVE ER-2680                 TO WS-ERROR
 12067         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12068         GO TO 3060-ORIG-TERM-CHECK.
 12069
 12070     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12071     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12072     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12073*    MOVE 1                      TO DC-OPTION-CODE.
 12074     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12075                                    DC-ELAPSED-DAYS
 12076                                    DC-ODD-DAYS-OVER.
 12077
 12078     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12079
 12080     IF DATE-CONVERSION-ERROR
 12081        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 220
* EL050.cbl
 12082
 12083     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12084     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12085        AND (WS-LF-COVERAGE-TYPE = 'L')
 12086        IF (DC-ELAPSED-MONTHS > 1)
 12087                      OR
 12088           ((DC-ELAPSED-MONTHS = 1)
 12089           AND (DC-ODD-DAYS-OVER > 0))
 12090           MOVE ER-2882          TO WS-ERROR
 12091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12092        END-IF
 12093     END-IF
 12094     if dc-elapsed-months > 0
 12095        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12096        + dc-odd-days-over
 12097     end-if
 12098     IF PB-EXT-DAYS-PROCESSING
 12099        CONTINUE
 12100     ELSE
 12101        IF DC-ELAPSED-MONTHS = +0
 12102           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12103        ELSE
 12104           IF (WS-LF-EARNINGS-CALC = '4')
 12105              AND (DC-ELAPSED-MONTHS > ZERO)
 12106              AND (DC-ELAPSED-DAYS > ZERO)
 12107              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12108           ELSE
 12109              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12110                                 THRU 6499-EXIT
 12111              MOVE WS-ODD-DAYS-OVER
 12112                                 TO PB-I-EXTENTION-DAYS
 12113           END-IF
 12114        END-IF
 12115     END-IF
 12116******************************************************************
 12117*                                                                *
 12118*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12119*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12120*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12121*            AND ANY ODD DAYS.                                   *
 12122*                                                                *
 12123******************************************************************
 12124
 12125     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12126                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12127     IF WS-LF-EARNINGS-CALC NOT = '4'
 12128        IF DC-ELAPSED-DAYS > ZEROS
 12129           MOVE ER-2681          TO WS-ERROR
 12130           PERFORM 9900-ERROR-FORMAT
 12131                                 THRU 9900-EXIT
 12132        END-IF
 12133     END-IF
 12134
 12135     IF WS-LF-EARNINGS-CALC NOT = '4'
 12136        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12137           MOVE ER-2681          TO WS-ERROR
 12138           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12139
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 221
* EL050.cbl
 12140     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12141        (PB-I-LF-TERM NOT = ZERO) AND
 12142         NOT NO-LIFE-COVERAGE
 12143          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12144          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12145          IF WS-LF-EARNINGS-CALC = '4'
 12146             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12147             PB-I-PAY-FREQUENCY
 12148          END-IF
 12149          MOVE ZERO              TO DC-ELAPSED-DAYS
 12150                                    DC-ODD-DAYS-OVER
 12151          MOVE 1                 TO DC-END-OF-MONTH
 12152          SET BIN-PLUS-ELAPSED        TO TRUE
 12153*         MOVE 6                 TO DC-OPTION-CODE
 12154          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12155          IF NO-CONVERSION-ERROR
 12156             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12157             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12158                (WS-LF-SPECIAL-CALC-CD = 'L')
 12159                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12160                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12161                  MOVE +1             TO DC-ELAPSED-MONTHS
 12162                  SET BIN-PLUS-ELAPSED  TO TRUE
 12163*                 MOVE 6              TO DC-OPTION-CODE
 12164                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12165                  IF NO-CONVERSION-ERROR
 12166                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12167
 12168* okay, i had to move the new att age edit down here because the
 12169* expiration date could get recalculated and i need the exp date
 12170     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12171        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12172        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12173        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12174           AND ZEROS
 12175           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12176           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12177           SET ELAPSED-BETWEEN-BIN TO TRUE
 12178           PERFORM 8500-DATE-CONVERT
 12179                                 THRU 8500-EXIT
 12180           IF NO-CONVERSION-ERROR
 12181              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12182                 MOVE ER-2669       TO WS-ERROR
 12183*                PERFORM 9900-ERROR-FORMAT
 12184*                                THRU 9900-EXIT
 12185              END-IF
 12186           END-IF
 12187        ELSE
 12188           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12189           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12190              MOVE ER-2669       TO WS-ERROR
 12191*             PERFORM 9900-ERROR-FORMAT
 12192*                                THRU 9900-EXIT
 12193           ELSE
 12194              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12195                 MOVE ER-1570    TO WS-ERROR
 12196                 PERFORM 9900-ERROR-FORMAT
 12197                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 222
* EL050.cbl
 12198              END-IF
 12199           END-IF
 12200        END-IF
 12201        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12202           AND ZEROS
 12203           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12204           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12205           SET ELAPSED-BETWEEN-BIN TO TRUE
 12206           PERFORM 8500-DATE-CONVERT
 12207                                 THRU 8500-EXIT
 12208           IF NO-CONVERSION-ERROR
 12209              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12210                 MOVE ER-2669       TO WS-ERROR
 12211*                PERFORM 9900-ERROR-FORMAT
 12212*                                THRU 9900-EXIT
 12213              END-IF
 12214           END-IF
 12215        ELSE
 12216           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12217             (PB-I-LF-TERM / 12)
 12218           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12219              MOVE ER-2669       TO WS-ERROR
 12220*             PERFORM 9900-ERROR-FORMAT
 12221*                                THRU 9900-EXIT
 12222           ELSE
 12223              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12224                 MOVE ER-1571    TO WS-ERROR
 12225                 PERFORM 9900-ERROR-FORMAT
 12226                                 THRU 9900-EXIT
 12227              END-IF
 12228           END-IF
 12229        END-IF
 12230        IF WS-ERROR = ER-2669
 12231           PERFORM 9900-ERROR-FORMAT
 12232                                 THRU 9900-EXIT
 12233        END-IF
 12234     END-IF
 12235     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12236        (PB-I-AH-TERM NOT = ZERO) AND
 12237         NOT NO-AH-COVERAGE
 12238          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12239             AND (PB-COMPANY-ID = 'DCC')
 12240             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12241             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12242          ELSE
 12243             IF WS-LF-EARNINGS-CALC = '4'
 12244                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12245                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12246                PB-I-PAY-FREQUENCY
 12247             ELSE
 12248                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12249                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12250             END-IF
 12251          END-IF
 12252          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12253                                         DC-ODD-DAYS-OVER
 12254          MOVE 1                      TO DC-END-OF-MONTH
 12255          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 223
* EL050.cbl
 12256*         MOVE 6                      TO DC-OPTION-CODE
 12257          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12258          IF NO-CONVERSION-ERROR
 12259             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12260     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12261        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12262        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12263        IF PB-I-BIRTHDAY > LOW-VALUES
 12264           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12265           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12266           SET ELAPSED-BETWEEN-BIN TO TRUE
 12267           PERFORM 8500-DATE-CONVERT
 12268                                 THRU 8500-EXIT
 12269           IF NO-CONVERSION-ERROR
 12270              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12271                 MOVE ER-3054       TO WS-ERROR
 12272*                PERFORM 9900-ERROR-FORMAT
 12273*                                THRU 9900-EXIT
 12274              END-IF
 12275           END-IF
 12276        ELSE
 12277           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12278           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12279              MOVE ER-3054       TO WS-ERROR
 12280*             PERFORM 9900-ERROR-FORMAT
 12281*                                THRU 9900-EXIT
 12282           END-IF
 12283        END-IF
 12284        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12285           AND ZEROS
 12286           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12287           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12288           SET ELAPSED-BETWEEN-BIN TO TRUE
 12289           PERFORM 8500-DATE-CONVERT
 12290                                 THRU 8500-EXIT
 12291           IF NO-CONVERSION-ERROR
 12292              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12293                 MOVE ER-3054       TO WS-ERROR
 12294*                PERFORM 9900-ERROR-FORMAT
 12295*                                THRU 9900-EXIT
 12296              END-IF
 12297           END-IF
 12298        ELSE
 12299           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12300             (PB-I-AH-TERM / 12)
 12301           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12302              MOVE ER-3054       TO WS-ERROR
 12303*             PERFORM 9900-ERROR-FORMAT
 12304*                                THRU 9900-EXIT
 12305           END-IF
 12306        END-IF
 12307        IF WS-ERROR = ER-3054
 12308           PERFORM 9900-ERROR-FORMAT
 12309                                 THRU 9900-EXIT
 12310        END-IF
 12311     END-IF
 12312     MOVE SPACE                       TO DC-END-OF-MONTH.
 12313
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 224
* EL050.cbl
 12314     IF PB-COMPANY-ID = 'NCB'
 12315        GO TO 3040-EDIT-EXTENSION-DAYS.
 12316
 12317     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12318       AND
 12319        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12320        NEXT SENTENCE
 12321     ELSE
 12322        GO TO 3040-EDIT-EXTENSION-DAYS.
 12323
 12324     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12325        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12326        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12327     ELSE
 12328        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12329        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12330
 12331     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12332*    MOVE '1'      TO DC-OPTION-CODE
 12333     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12334     IF (NO-CONVERSION-ERROR)
 12335        AND (DC-ELAPSED-MONTHS > +1)
 12336        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12337        MOVE ER-2668   TO WS-ERROR
 12338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12339
 12340 3040-EDIT-EXTENSION-DAYS.
 12341
 12342     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12343        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12344         GO TO 3050-EDIT-TERM-IN-DAYS
 12345     ELSE
 12346         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12347
 12348     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12349         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12350     ELSE
 12351        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12352           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12353           MOVE ER-2681         TO WS-ERROR
 12354           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12355
 12356     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12357        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12358        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12359         GO TO 3060-ORIG-TERM-CHECK.
 12360
 12361     GO TO 3060-ORIG-TERM-CHECK.
 12362
 12363 3050-EDIT-TERM-IN-DAYS.
 12364
 12365     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12366
 12367     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12368         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12369     ELSE
 12370         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12371            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 225
* EL050.cbl
 12372            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12373
 12374     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12375                                       REMAINDER WS-WORK-TERM.
 12376     IF WS-WORK-TERM GREATER THAN ZERO
 12377         ADD +1 TO PB-I-LF-TERM.
 12378
 12379     IF NOT NO-AH-COVERAGE
 12380         MOVE ER-2684            TO WS-ERROR
 12381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12382
 12383
 12384 3060-ORIG-TERM-CHECK.
 12385
 12386******************************************************************
 12387*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12388******************************************************************
 12389
 12390     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12391        NEXT SENTENCE
 12392     ELSE
 12393        IF NOT NO-LIFE-COVERAGE
 12394           IF PB-I-LF-TERM NUMERIC
 12395              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12396              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12397              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12398                  NEXT SENTENCE
 12399           ELSE
 12400              MOVE ER-2647       TO WS-ERROR
 12401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12402
 12403     IF NOT NO-AH-COVERAGE
 12404         IF PB-I-AH-TERM NUMERIC
 12405            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12406            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12407            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12408             NEXT SENTENCE
 12409          ELSE
 12410              MOVE ER-2658       TO WS-ERROR
 12411              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12412
 12413     IF PB-COMPANY-ID = 'NCB'
 12414        GO TO 3070-LOAN-TERM-CHECK.
 12415
 12416     IF POLICY-HAS-AH
 12417       AND
 12418        POLICY-HAS-LIFE
 12419       AND
 12420        PB-I-LF-TERM NUMERIC
 12421       AND
 12422        PB-I-AH-TERM NUMERIC
 12423        NEXT SENTENCE
 12424     ELSE
 12425        GO TO 3070-LOAN-TERM-CHECK.
 12426
 12427     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12428     IF WS-TEX-FACT-2 LESS THAN +0
 12429        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 226
* EL050.cbl
 12430
 12431     IF WS-TEX-FACT-2 GREATER THAN +1
 12432        MOVE ER-2668             TO WS-ERROR
 12433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12434
 12435 3070-LOAN-TERM-CHECK.
 12436
 12437     IF (WS-LF-BENEFIT-CD = ZERO)
 12438         OR (NO-LF-BENEFIT-MATCH)
 12439            GO TO 3125-EDIT-PMT-FREQ.
 12440*    IF PB-COMPANY-ID NOT = 'DCC'
 12441*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12442*          AND 'V' AND 'W' AND 'X'
 12443*          GO TO 3125-EDIT-PMT-FREQ
 12444*       END-IF
 12445*    ELSE
 12446*       IF WS-AH-DCC-TRUNC = 'T'
 12447*          CONTINUE
 12448*       ELSE
 12449*          GO TO 3125-EDIT-PMT-FREQ
 12450*       END-IF
 12451*    END-IF
 12452     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12453                    OR
 12454        ((PB-COMPANY-ID = 'DCC')
 12455        AND (WS-AH-DCC-TRUNC = 'T'))
 12456        CONTINUE
 12457     ELSE
 12458        GO TO 3125-EDIT-PMT-FREQ
 12459     END-IF
 12460     IF PB-I-LOAN-TERM NOT NUMERIC
 12461         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12462
 12463     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12464        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12465*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12466        PB-I-LOAN-TERM NOT GREATER THAN +360
 12467         NEXT SENTENCE
 12468     ELSE
 12469         MOVE ER-2648            TO WS-ERROR
 12470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12471
 12472     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12473        MOVE ER-3058             TO WS-ERROR
 12474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12475     end-if
 12476
 12477     IF WS-STATE-ABBREVIATION = 'NC'
 12478        IF PB-I-LOAN-TERM > +59
 12479           CONTINUE
 12480        ELSE
 12481           MOVE ER-2792          TO WS-ERROR
 12482           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12483        END-IF
 12484     END-IF
 12485
 12486     .
 12487 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 227
* EL050.cbl
 12488     IF (WS-LF-BENEFIT-CD = ZERO)
 12489         OR (NO-LF-BENEFIT-MATCH)
 12490            GO TO 3127-EDIT-LOAN-OFFICER.
 12491     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12492                    OR
 12493        ((PB-COMPANY-ID = 'DCC')
 12494        AND (WS-AH-DCC-TRUNC = 'T'))
 12495                    OR
 12496         (PB-COMPANY-ID = 'AHL')
 12497        CONTINUE
 12498     ELSE
 12499        IF (PB-I-LOAN-TERM > ZEROS)
 12500           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12501           MOVE ER-1575          TO WS-ERROR
 12502           PERFORM 9900-ERROR-FORMAT
 12503                                 THRU 9900-EXIT
 12504        END-IF
 12505     END-IF
 12506     IF WS-LF-EARNINGS-CALC NOT = '4'
 12507         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12508            MOVE ER-2653         TO WS-ERROR
 12509            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12510            GO TO 3127-EDIT-LOAN-OFFICER
 12511         ELSE
 12512            GO TO 3127-EDIT-LOAN-OFFICER.
 12513
 12514     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12515         MOVE ER-2655            TO WS-ERROR
 12516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12517         GO TO 3127-EDIT-LOAN-OFFICER.
 12518
 12519     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12520         MOVE ER-2654            TO WS-ERROR
 12521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12522         GO TO 3127-EDIT-LOAN-OFFICER.
 12523
 12524     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12525         GIVING WS-TEX-FACT-2
 12526             REMAINDER WS-TEX-FACT-3.
 12527
 12528*    IF WS-TEX-FACT-3 NOT = ZERO
 12529*       MOVE ER-2654             TO WS-ERROR
 12530*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12531
 12532
 12533 3127-EDIT-LOAN-OFFICER.
 12534
 12535     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12536        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12537           MOVE ER-2690          TO WS-ERROR
 12538           PERFORM 9900-ERROR-FORMAT
 12539                                 THRU 9900-EXIT
 12540        ELSE
 12541           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12542           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12543           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12544           MOVE PB-SV-STATE      TO LOFC-STATE
 12545           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 228
* EL050.cbl
 12546           MOVE PB-I-LOAN-OFFICER
 12547                                 TO LOFC-CODE
 12548           PERFORM 8586-READ-LOAN-OFFICER
 12549                                 THRU 8586-EXIT
 12550           IF (NOT LOFC-MASTER-FOUND)
 12551              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12552              MOVE ER-3006       TO WS-ERROR
 12553              PERFORM 9900-ERROR-FORMAT
 12554                                 THRU 9900-EXIT
 12555           END-IF
 12556        END-IF
 12557     END-IF
 12558     .
 12559 3129-EDIT-APR.
 12560
 12561     IF (WS-LF-BENEFIT-CD = ZERO)
 12562        OR (NO-LF-BENEFIT-MATCH)
 12563        IF PB-COMPANY-ID NOT = 'DCC'
 12564           GO TO 3130-EDIT-AGE
 12565*       ELSE
 12566*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12567*             GO TO 3130-EDIT-AGE
 12568*          END-IF
 12569        END-IF
 12570     END-IF
 12571
 12572     IF (WS-STATE-ABBREVIATION = 'OH')
 12573         AND (PB-I-RATE-CLASS NOT = 'L ')
 12574         AND (PB-I-LF-TERM GREATER THAN 60)
 12575         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12576         GO TO 3129-APR-CONT.
 12577
 12578     IF (WS-STATE-ABBREVIATION = 'RI')
 12579         AND (PB-I-LF-TERM GREATER THAN 60)
 12580         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12581         GO TO 3129-APR-CONT.
 12582
 12583     IF (WS-STATE-ABBREVIATION = 'UT')
 12584         AND (PB-I-LF-TERM GREATER THAN 62)
 12585         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12586         AND (PB-CERT-EFF-DT LESS WS-830901)
 12587         GO TO 3129-APR-CONT.
 12588
 12589     IF PB-COMPANY-ID = 'LAP'
 12590        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12591           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12592              MOVE ER-2656         TO WS-ERROR
 12593              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12594              GO TO 3130-EDIT-AGE.
 12595
 12596     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12597        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12598        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12599        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12600        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12601        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12602         GO TO 3130-EDIT-AGE.
 12603
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 229
* EL050.cbl
 12604 3129-APR-CONT.
 12605     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12606         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12607         GO TO 3130-EDIT-AGE.
 12608
 12609     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12610         WS-AH-BENEFIT-CD (1:1) = 'S')
 12611        AND (PB-COMPANY-ID = 'DCC')
 12612        AND (PB-I-LOAN-APR = ZERO)
 12613        MOVE ER-2657             TO WS-ERROR
 12614        PERFORM 9900-ERROR-FORMAT
 12615                                 THRU 9900-EXIT
 12616        GO TO 3130-EDIT-AGE
 12617     END-IF
 12618*    IF PB-I-LOAN-APR = ZERO
 12619*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12620*    END-IF
 12621
 12622     if pb-i-loan-apr = +99.9999
 12623        move er-2656             to ws-error
 12624        PERFORM 9900-ERROR-FORMAT
 12625                                 THRU 9900-EXIT
 12626        GO TO 3130-EDIT-AGE
 12627     end-if
 12628*    IF PB-I-LOAN-APR = ZERO
 12629*       MOVE ER-2656             TO WS-ERROR
 12630*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12631*       GO TO 3130-EDIT-AGE.
 12632
 12633*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12634     if pb-i-loan-apr not = +99.9999
 12635        IF PB-I-LOAN-APR > +30.000
 12636           MOVE ER-2657          TO WS-ERROR
 12637           PERFORM 9900-ERROR-FORMAT
 12638                                 THRU 9900-EXIT
 12639        end-if
 12640     end-if
 12641     .
 12642 3130-EDIT-AGE.
 12643
 12644******************************************************************
 12645*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12646******************************************************************
 12647
 12648     IF NOT NO-LIFE-COVERAGE
 12649        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12650           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12651               MOVE ER-2628             TO WS-ERROR
 12652               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12653
 12654     IF NOT NO-AH-COVERAGE
 12655        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12656           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12657               MOVE ER-2628         TO WS-ERROR
 12658               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12659
 12660 3133-SEX-CODE.
 12661     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 230
* EL050.cbl
 12662         IF WS-DEFAULT-SEX = 'M'
 12663             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12664          ELSE
 12665             IF WS-DEFAULT-SEX = 'F'
 12666             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12667
 12668     IF PB-I-INSURED-SEX = '1'
 12669         MOVE 'M' TO PB-I-INSURED-SEX.
 12670
 12671     IF PB-I-INSURED-SEX = '2'
 12672         MOVE 'F' TO PB-I-INSURED-SEX.
 12673
 12674 3134-SIG-SW-EDIT.
 12675     IF PB-I-SIG-SW = SPACE
 12676         MOVE 'N'                TO  PB-I-SIG-SW.
 12677
 12678     IF PB-COMPANY-ID = 'NCL'
 12679         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12680             NEXT SENTENCE
 12681         ELSE
 12682             MOVE ER-1923        TO  WS-ERROR
 12683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12684     ELSE
 12685     IF PB-COMPANY-ID = 'CRI'
 12686         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12687             NEXT SENTENCE
 12688         ELSE
 12689             MOVE ER-2606        TO  WS-ERROR
 12690             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12691     ELSE
 12692     IF PB-COMPANY-ID = 'TMS'
 12693         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12694             NEXT SENTENCE
 12695         ELSE
 12696             MOVE ER-2689        TO  WS-ERROR
 12697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12698     ELSE
 12699         IF PB-I-SIG-SW = 'Y' OR 'N'
 12700             NEXT SENTENCE
 12701         ELSE
 12702             MOVE ER-2651        TO  WS-ERROR
 12703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12704
 12705     IF PB-COMPANY-ID = 'FLA'
 12706         IF (WS-EDIT-AGE GREATER 54  OR
 12707             WS-AH-EDIT-AGE GREATER 54)  AND
 12708            PB-I-SIG-SW = 'N'
 12709            MOVE ER-2651         TO  WS-ERROR
 12710            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12711
 12712 3135-NAME-EDIT.
 12713
 12714     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12715        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12716        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12717           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12718                                 TO PB-I-JOINT-FIRST-NAME
 12719        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 231
* EL050.cbl
 12720     END-IF
 12721     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12722        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12723        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12724           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12725                                 TO PB-I-JOINT-LAST-NAME
 12726        END-PERFORM
 12727     END-IF
 12728     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12729        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12730        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12731           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12732                                 TO PB-I-INSURED-FIRST-NAME
 12733        END-PERFORM
 12734     END-IF
 12735     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12736        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12737        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12738           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12739                                 TO PB-I-INSURED-LAST-NAME
 12740        END-PERFORM
 12741     END-IF
 12742     IF PB-I-INSURED-LAST-NAME = SPACES
 12743       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12744       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12745           MOVE ER-2660    TO WS-ERROR
 12746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12747
 12748 3136-EDIT-SEX.
 12749
 12750******************************************************************
 12751*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12752******************************************************************
 12753
 12754     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12755        (WS-AH-SPECIAL-CALC-CD = 'O')
 12756        NEXT SENTENCE
 12757     ELSE
 12758        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12759           NEXT SENTENCE
 12760        ELSE
 12761           MOVE ER-2629            TO WS-ERROR
 12762           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12763
 12764 3137-EDIT-EFF-DATE.
 12765
 12766     IF PB-REISSUED-CERT       OR
 12767        PB-POLICY-IS-DECLINED  OR
 12768        PB-POLICY-IS-VOIDED
 12769         GO TO 3139-EDIT-COVERAGE-CODES.
 12770
 12771     MOVE SPACE                  TO WS-2671-SW
 12772                                    WS-2672-SW.
 12773
 12774     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12775         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12776             MOVE ER-2703        TO WS-ERROR
 12777             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 232
* EL050.cbl
 12778             GO TO 3139-EDIT-COVERAGE-CODES.
 12779
 12780     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12781         GO TO 3139-EDIT-COVERAGE-CODES.
 12782
 12783     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12784     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12785*    MOVE '1'                    TO DC-OPTION-CODE.
 12786     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12787     MOVE +0                     TO DC-ELAPSED-MONTHS
 12788                                    DC-ELAPSED-DAYS.
 12789     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12790
 12791     IF DATE-CONVERSION-ERROR
 12792         GO TO 3139-EDIT-COVERAGE-CODES.
 12793
 12794     IF DC-ELAPSED-DAYS GREATER +180
 12795         MOVE ER-2672            TO WS-ERROR
 12796         MOVE 'Y'                TO WS-2672-SW
 12797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12798     END-IF
 12799
 12800     IF WS-ERROR = ER-2671  AND
 12801        PB-COMPANY-ID  = 'LBL'
 12802        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12803        MOVE SPACE               TO WS-2671-SW
 12804        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12805
 12806     IF PB-ISSUE-DATE-FORCED  AND
 12807      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12808         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12809         MOVE ER-2673            TO WS-ERROR
 12810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12811         MOVE SPACE              TO WS-2671-SW
 12812                                    WS-2672-SW.
 12813
 12814     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12815         IF PB-ISSUE-DATE-FORCED
 12816             MOVE ER-2600          TO  WS-ERROR
 12817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12818         ELSE
 12819             MOVE ER-2692          TO  WS-ERROR
 12820             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12821
 12822
 12823 3139-EDIT-COVERAGE-CODES.
 12824
 12825     if pb-company-id not = 'AHL'
 12826        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12827           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12828           MOVE ER-2787          TO WS-ERROR
 12829           PERFORM 9900-ERROR-FORMAT
 12830                                 THRU 9900-EXIT
 12831        END-IF
 12832     end-if
 12833     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12834        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12835                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 233
* EL050.cbl
 12836           MOVE ER-2719          TO WS-ERROR
 12837           PERFORM 9900-ERROR-FORMAT
 12838                                 THRU 9900-EXIT
 12839        END-IF
 12840     END-IF
 12841
 12842     IF PB-POLICY-IS-DECLINED  OR
 12843        PB-POLICY-IS-VOIDED
 12844         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12845
 12846     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12847        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12848         MOVE ER-2630                TO WS-ERROR
 12849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12850
 12851     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12852        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12853        PB-I-LF-PREMIUM-AMT = ZERO
 12854         GO TO 3140-CHECK-AH-FOR-ZERO.
 12855
 12856     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12857        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12858        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12859         GO TO 3140-CHECK-AH-FOR-ZERO.
 12860
 12861     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12862        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12863        MOVE ER-2631             TO WS-ERROR
 12864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12865     END-IF
 12866
 12867
 12868******************************************************************
 12869*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12870******************************************************************
 12871
 12872     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12873        NEXT SENTENCE
 12874     ELSE
 12875        IF PB-I-LF-BENEFIT-AMT = ZERO
 12876           MOVE ER-2632             TO WS-ERROR
 12877           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12878
 12879
 12880******************************************************************
 12881*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12882******************************************************************
 12883
 12884     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12885        CONTINUE
 12886     ELSE
 12887        IF PB-I-LF-PREMIUM-AMT = ZERO
 12888           IF (NOT PB-COMP-LF-PREM)
 12889              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12890              and (ws-lf-ben-category not = 'C')
 12891              MOVE ER-2633       TO WS-ERROR
 12892              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12893           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 234
* EL050.cbl
 12894        END-IF
 12895     END-IF
 12896     .
 12897 3140-CHECK-AH-FOR-ZERO.
 12898
 12899     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12900        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12901        PB-I-AH-PREMIUM-AMT = ZERO
 12902         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12903
 12904     IF PB-COMPANY-ID = 'CSL'  AND
 12905        PB-I-AH-BENEFIT-CD = ZERO  AND
 12906        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12907        PB-I-AH-PREMIUM-AMT = ZERO
 12908         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12909
 12910     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12911        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12912        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12913         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12914
 12915     IF PB-I-AH-BENEFIT-CD = ZERO
 12916         MOVE ER-2634            TO WS-ERROR
 12917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919******************************************************************
 12920*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12921******************************************************************
 12922
 12923     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12924        NEXT SENTENCE
 12925     ELSE
 12926        IF PB-I-AH-BENEFIT-AMT = ZERO
 12927           MOVE ER-2635             TO WS-ERROR
 12928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12929
 12930******************************************************************
 12931*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12932******************************************************************
 12933
 12934     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12935        NEXT SENTENCE
 12936     ELSE
 12937        IF PB-I-AH-PREMIUM-AMT = ZERO
 12938            IF NOT PB-COMP-AH-PREM
 12939                MOVE ER-2636    TO WS-ERROR
 12940                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12941
 12942
 12943 3140-EDIT-MAX-AMT-SIZES.
 12944* CUSTOM CODE FOR CLIENT    'DMD'
 12945     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12946                                     WS-RES-MUNI-TAX
 12947                                     PB-I-STATE-TAX
 12948                                     PB-I-MUNI-TAX.
 12949
 12950     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12951
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 235
* EL050.cbl
 12952     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12953        GO TO 3150-RATE-OUTSTAND-BAL.
 12954
 12955     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12956        GO TO 3150-RATE-OUTSTAND-BAL.
 12957
 12958     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12959        GO TO 3150-RATE-OUTSTAND-BAL.
 12960
 12961     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12962                             OR 'RIC')
 12963        GO TO 3150-RATE-OUTSTAND-BAL.
 12964
 12965     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12966        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12967            GO TO 3150-RATE-OUTSTAND-BAL
 12968        ELSE
 12969           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12970               GO TO 3150-RATE-OUTSTAND-BAL.
 12971
 12972     IF NOT PB-NO-MONTHS-SKIPPED
 12973        GO TO 3150-RATE-OUTSTAND-BAL.
 12974
 12975     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12976        GO TO 3150-RATE-OUTSTAND-BAL.
 12977
 12978     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12979        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12980           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12981             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12982           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12983           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12984              MOVE ER-2693     TO WS-ERROR
 12985              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12986              GO TO 3150-RATE-OUTSTAND-BAL
 12987           ELSE
 12988              GO TO 3150-RATE-OUTSTAND-BAL.
 12989
 12990 3150-RATE-OUTSTAND-BAL.
 12991
 12992* DMD RATING TEST
 12993     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12994         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12995         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12996         MOVE ER-2687                 TO WS-ERROR
 12997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12998         MOVE 'B'                     TO PB-I-OB-FLAG
 12999         GO TO 3260-EDIT-CONTINUE.
 13000
 13001     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13002         IF  WS-ERROR    EQUAL    ER-2693
 13003             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13004                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13005                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13006                 MOVE  +0            TO  WS-ERROR.
 13007
 13008     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13009         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 236
* EL050.cbl
 13010             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13011                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13012                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13013                 MOVE  +0            TO  WS-ERROR.
 13014
 13015     IF PLAN-MASTER-AH-SW = 'Y'
 13016        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13017            IF  WS-ERROR    EQUAL    ER-2693
 13018              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13019                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13020                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13021                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13022                 MOVE  ER-1910           TO  WS-ERROR
 13023                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13024
 13025     IF PLAN-MASTER-AH-SW = 'Y'
 13026        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13027            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13028               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13029               MOVE  ER-1910           TO  WS-ERROR
 13030               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13031
 13032     IF PLAN-MASTER-AH-SW = 'Y'
 13033        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13034            IF  WS-ERROR    EQUAL    ER-2693
 13035                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13036                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13037                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13038                 MOVE  +0       TO  WS-ERROR.
 13039
 13040     IF WS-ERROR = ER-2693
 13041        IF PB-COMPANY-ID = 'JAL' AND
 13042           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13043           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13044           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13045
 13046     IF WS-ERROR = ER-2693
 13047        IF PB-COMPANY-ID = 'NCL'  AND
 13048           PB-I-AH-BENEFIT-CD = 'OA'
 13049           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13050           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13051
 13052     IF WS-ERROR = ER-2693
 13053        IF PB-COMPANY-ID = 'CNL' AND
 13054           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13055           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13056           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13057
 13058     IF WS-ERROR = ER-2693
 13059        IF PB-COMPANY-ID = 'HER'
 13060           IF WS-LEVEL
 13061              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13062              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13063
 13064     IF ((LF-BENEFIT-FOUND) AND
 13065         (NOT NO-LIFE-COVERAGE)  AND
 13066         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13067       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 237
* EL050.cbl
 13068             (NOT NO-AH-COVERAGE)    AND
 13069             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13070         NEXT SENTENCE
 13071     ELSE
 13072         GO TO 3215-EDIT-RATES.
 13073
 13074     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13075        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13076           MOVE ER-2674          TO WS-ERROR
 13077           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13078           GO TO 3215-EDIT-RATES.
 13079
 13080     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13081        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13082           MOVE ER-2674          TO WS-ERROR
 13083           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13084           GO TO 3215-EDIT-RATES.
 13085
 13086     MOVE 'B'                    TO PB-I-OB-FLAG.
 13087
 13088     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13089         NEXT SENTENCE
 13090     ELSE
 13091         IF NOT NO-LIFE-COVERAGE
 13092             IF WS-ACCT-LF-OB-RT = ZERO
 13093                MOVE ER-2641    TO WS-ERROR
 13094                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13095
 13096     IF PB-COMPANY-ID = 'CRI'
 13097       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13098         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13099         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13100         IF WS-ERROR = ER-2675
 13101            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13102            MOVE ER-2687              TO WS-ERROR
 13103            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13104         ELSE
 13105            MOVE ER-2687              TO WS-ERROR
 13106            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13107
 13108
 13109     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13110         NEXT SENTENCE
 13111     ELSE
 13112       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13113            NEXT SENTENCE
 13114       ELSE
 13115         IF NOT NO-AH-COVERAGE
 13116             IF WS-ACCT-AH-OB-RT = ZERO
 13117                MOVE ER-2642    TO WS-ERROR
 13118                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13119
 13120     IF PB-COMPANY-ID = 'CRI'
 13121       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13122         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13123         IF WS-ERROR = ER-2676
 13124            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13125            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 238
* EL050.cbl
 13126            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13127         ELSE
 13128            MOVE ER-2687              TO WS-ERROR
 13129            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13130
 13131     IF PB-COMPANY-ID NOT = 'GIC'
 13132         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13133            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13134     ELSE
 13135         IF PB-I-LF-PREM-CALC = ZEROS
 13136             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13137                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13138
 13139     IF PB-COMPANY-ID NOT = 'GIC'
 13140         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13141            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13142     ELSE
 13143         IF PB-I-AH-PREM-CALC = ZEROS
 13144             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13145                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13146
 13147     MOVE ZEROS TO PB-I-MORT-CODE.
 13148
 13149     GO TO 3260-EDIT-CONTINUE.
 13150
 13151
 13152 3215-EDIT-RATES.
 13153     IF ACCOUNT-MAST-FOUND
 13154         NEXT SENTENCE
 13155     ELSE
 13156         GO TO 3999-END-EDIT.
 13157
 13158 3220-CHECK-LF-RATES.
 13159
 13160     IF PB-COMPANY-ID = 'DCC'
 13161        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13162        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13163        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13164           AND (NOT WS-LF-CASH))
 13165                           OR
 13166           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13167           AND (NOT WS-AH-CASH)))
 13168                       AND
 13169           (PB-I-ENTRY-STATUS NOT = '5')
 13170           MOVE 'M'              TO PB-BATCH-ENTRY
 13171                                    PB-I-ENTRY-STATUS
 13172        END-IF
 13173     END-IF
 13174     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13175                                    PB-I-AH-PREM-CALC
 13176                                    PB-I-LF-ALT-PREM-CALC
 13177                                    PB-I-LF-ALT-RATE
 13178                                    PB-I-LF-REI-RATE
 13179                                    PB-I-LF-ALT-REI-RATE
 13180                                    PB-I-AH-REI-RATE
 13181                                    PB-I-TOT-FEES-CALC.
 13182
 13183     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 239
* EL050.cbl
 13184        NEXT SENTENCE
 13185     ELSE
 13186        MOVE ZEROS               TO PB-I-LF-RATE
 13187                                    PB-I-AH-RATE.
 13188
 13189     IF PB-I-TOT-FEES NOT NUMERIC
 13190        MOVE ZEROS               TO PB-I-TOT-FEES
 13191     END-IF
 13192     IF PB-I-LIVES NOT NUMERIC
 13193         MOVE ZERO               TO PB-I-LIVES.
 13194
 13195     IF PB-I-NUM-BILLED NOT NUMERIC
 13196         MOVE ZERO               TO PB-I-NUM-BILLED.
 13197
 13198     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13199        MOVE +0                  TO PB-I-LF-PREM-TAX
 13200     END-IF
 13201
 13202     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13203        MOVE +0                  TO PB-I-AH-PREM-TAX
 13204     END-IF
 13205
 13206     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13207        PB-I-PAY-FREQUENCY = ZEROS
 13208            MOVE 12 TO CP-PAY-FREQUENCY
 13209     ELSE
 13210            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13211
 13212     IF PB-I-STATE-TAX NOT NUMERIC
 13213         MOVE ZEROS               TO PB-I-STATE-TAX.
 13214
 13215     IF PB-I-MUNI-TAX NOT NUMERIC
 13216         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13217
 13218     MOVE SPACES                 TO CP-BEN-CATEGORY
 13219     IF PB-COMPANY-ID  = 'CSL'  AND
 13220        PB-I-LF-TERM NOT = ZERO
 13221        COMPUTE WS-PAYMENT-AMT =
 13222             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13223        COMPUTE WS-CSL-AMT1 =
 13224             PB-I-LF-TERM * AM-MAX-MON-BEN
 13225        COMPUTE WS-CSL-AMT2 =
 13226             WS-PAYMENT-AMT * PB-I-LF-TERM
 13227        IF CP-PAY-FREQUENCY NOT = 12
 13228           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13229           MOVE '8' TO WS-CSL-CALC-CD
 13230        ELSE
 13231           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13232              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13233               AM-MAX-TOT-BEN
 13234               MOVE '6' TO WS-CSL-CALC-CD
 13235           ELSE
 13236              IF (WS-CSL-AMT1  GREATER THAN
 13237                 AM-MAX-TOT-BEN) AND
 13238                 (WS-CSL-AMT2  GREATER THAN
 13239                 AM-MAX-TOT-BEN)
 13240                 MOVE '7' TO WS-CSL-CALC-CD
 13241              ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 240
* EL050.cbl
 13242                 MOVE '5' TO WS-CSL-CALC-CD.
 13243
 13244     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13245         NEXT SENTENCE
 13246     ELSE
 13247         GO TO 3300-CHECK-AH-RATES.
 13248
 13249*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13250
 13251     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13252        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13253              OR
 13254           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13255           MOVE ER-2618          TO WS-ERROR
 13256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13257           GO TO 3300-CHECK-AH-RATES.
 13258
 13259     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13260           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13261                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13262
 13263     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13264         MOVE ER-2687             TO WS-ERROR
 13265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13266         MOVE 'Z000'              TO PB-I-MORT-CODE
 13267         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13268         GO TO 3300-CHECK-AH-RATES.
 13269
 13270     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13271        IF PB-I-LIVES = ZERO
 13272           MOVE ER-2688          TO WS-ERROR
 13273           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13274
 13275     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13276
 13277     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13278     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13279     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13280     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13281     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13282     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13283     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13284     MOVE '3'                    TO CP-PROCESS-TYPE.
 13285     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13286     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13287
 13288******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13289     IF PB-COMPANY-ID EQUAL 'CDL'
 13290         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13291            CP-EARN-AS-NET-PAY)
 13292             IF PB-CERT-EFF-DT GREATER  WS-931231
 13293                 MOVE '1'        TO CP-EARNING-METHOD.
 13294*******
 13295
 13296     MOVE PB-SV-STATE            TO CP-STATE.
 13297     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13298     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13299     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 241
* EL050.cbl
 13300     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13301     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13302                                    CP-RATING-BENEFIT-AMT.
 13303     IF CP-STATE-STD-ABBRV = 'OR'
 13304         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13305                                         PB-I-LF-ALT-BENEFIT-AMT.
 13306     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13307     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13308     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13309     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13310     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13311     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13312     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13313     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13314     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13315                                    CP-REMAINING-TERM
 13316                                    CP-LOAN-TERM.
 13317
 13318     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13319         NEXT SENTENCE
 13320     ELSE
 13321         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13322             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13323                                           PB-I-LF-PREMIUM-AMT.
 13324
 13325     IF PB-COMPANY-ID EQUAL 'CSL'
 13326        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13327           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13328                                         PB-I-LF-PREMIUM-AMT.
 13329
 13330     IF PB-COMPANY-ID EQUAL 'NCB'
 13331         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13332            CP-EARN-AS-NET-PAY
 13333             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13334                 PB-I-LF-PREMIUM-AMT.
 13335
 13336     IF (CP-TRUNCATED-LIFE)
 13337        or ((pb-company-id = 'AHL')
 13338           and (pb-i-loan-term > pb-i-lf-term))
 13339        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13340
 13341     IF PB-COMPANY-ID EQUAL 'CRI'
 13342        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13343
 13344     IF CP-TERM-IS-DAYS
 13345         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13346     ELSE
 13347         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13348     IF PB-COMPANY-ID = 'DCC'
 13349        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13350        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13351        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13352        IF WS-LF-BEN-CATEGORY = 'D'
 13353           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13354           MOVE PB-I-LIFE-COMMISSION
 13355                                 TO CP-DCC-ACT-COMM
 13356           MOVE WS-LF-BEN-CATEGORY
 13357                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 242
* EL050.cbl
 13358        END-IF
 13359        IF (CP-BENEFIT-CD (1:1) = 'P')
 13360           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13361           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13362           add pb-i-ah-premium-amt to cp-original-premium
 13363        END-IF
 13364     END-IF
 13365     IF PB-COMPANY-ID = 'CSL'
 13366         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13367         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13368         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13369
 13370     IF PB-COMPANY-ID = 'CSL'
 13371        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13372
 13373     IF (CP-SPECIAL-CALC-CD = 'H')
 13374        OR (PB-COMPANY-ID = 'DCC')
 13375         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13376                                    TO CP-ALTERNATE-BENEFIT
 13377         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13378
 13379     IF (PB-COMPANY-ID = 'CID')
 13380        AND (WS-LF-EARNINGS-CALC = 'B')
 13381        AND (CP-STATE-STD-ABBRV = 'MN')
 13382        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13383                                 TO CP-ALTERNATE-BENEFIT
 13384        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13385     END-IF
 13386     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13387     MOVE 'R'                   TO CP-RATE-FILE.
 13388     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13389
 13390     IF CP-ERROR-RATE-NOT-FOUND
 13391        MOVE ER-2641            TO WS-ERROR
 13392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13393        GO TO 3300-CHECK-AH-RATES.
 13394
 13395     IF PB-COMPANY-ID EQUAL 'CRI'
 13396        IF CP-ERROR-NO-LIMITS-CRI
 13397           IF NOT ACCOUNT-LIFE-CHECKED
 13398              MOVE ER-2607      TO WS-ERROR
 13399              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13400
 13401******************************************************************
 13402*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13403*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13404******************************************************************
 13405
 13406* CALC LIFE AGE AT EXPIRATION.
 13407
 13408     COMPUTE WS-AGE-AT-EXPIRE =
 13409          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13410
 13411*    IF PB-STATE = 'CO' OR 'UT'
 13412*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13413*        MOVE 'F'            TO PB-FATAL-FLAG
 13414*        MOVE ER-2709        TO WS-ERROR
 13415*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 243
* EL050.cbl
 13416*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13417
 13418*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13419*        MOVE 'X'            TO PB-FATAL-FLAG
 13420*        MOVE ER-2718        TO WS-ERROR
 13421*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13422*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13423
 13424* CALC A & H AGE AT EXPIRATION.
 13425
 13426     COMPUTE WS-AGE-AT-EXPIRE =
 13427          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13428
 13429*    IF PB-STATE = 'CO' OR 'UT'
 13430*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13431*        MOVE 'F'            TO PB-FATAL-FLAG
 13432*        MOVE ER-2709        TO WS-ERROR
 13433*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13434*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13435
 13436*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13437*        MOVE 'X'            TO PB-FATAL-FLAG
 13438*        MOVE ER-2718        TO WS-ERROR
 13439*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13440*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13441
 13442     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13443        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13444
 13445     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13446        and (not pb-monthly-cert)
 13447        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13448     end-if
 13449
 13450     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13451        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13452
 13453     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13454         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13455         MOVE ER-2639        TO WS-ERROR
 13456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13457
 13458
 13459******************************************************************
 13460*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13461******************************************************************
 13462
 13463 PREMIUM-EDITING-IS-BYPASSED.
 13464     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13465        AND (CP-R-MAX-ATT-AGE > +0)
 13466        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13467        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13468           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13469           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13470           MOVE '1'              TO DC-OPTION-CODE
 13471           PERFORM 8500-DATE-CONVERT
 13472                                 THRU 8500-EXIT
 13473           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 244
* EL050.cbl
 13474              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13475                 MOVE ER-2661       TO WS-ERROR
 13476*                PERFORM 9900-ERROR-FORMAT
 13477*                                THRU 9900-EXIT
 13478              END-IF
 13479           END-IF
 13480        ELSE
 13481           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13482           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13483              MOVE ER-2661       TO WS-ERROR
 13484*             PERFORM 9900-ERROR-FORMAT
 13485*                                THRU 9900-EXIT
 13486           ELSE
 13487              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13488                 MOVE ER-1570    TO WS-ERROR
 13489                 PERFORM 9900-ERROR-FORMAT
 13490                                 THRU 9900-EXIT
 13491              END-IF
 13492           END-IF
 13493        END-IF
 13494        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13495           MOVE PB-I-JOINT-BIRTHDAY
 13496                                 TO DC-BIN-DATE-1
 13497           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13498           MOVE '1'              TO DC-OPTION-CODE
 13499           PERFORM 8500-DATE-CONVERT
 13500                                 THRU 8500-EXIT
 13501           IF NO-CONVERSION-ERROR
 13502              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13503                 MOVE ER-2661       TO WS-ERROR
 13504*                PERFORM 9900-ERROR-FORMAT
 13505*                                THRU 9900-EXIT
 13506              END-IF
 13507           ELSE
 13508              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13509           END-IF
 13510        ELSE
 13511           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13512             (PB-I-LF-TERM / 12)
 13513           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13514              MOVE ER-2661       TO WS-ERROR
 13515*             PERFORM 9900-ERROR-FORMAT
 13516*                                THRU 9900-EXIT
 13517           ELSE
 13518              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13519                 MOVE ER-1571    TO WS-ERROR
 13520                 PERFORM 9900-ERROR-FORMAT
 13521                                 THRU 9900-EXIT
 13522              END-IF
 13523           END-IF
 13524        END-IF
 13525        IF WS-ERROR = ER-2661
 13526           PERFORM 9900-ERROR-FORMAT
 13527                                 THRU 9900-EXIT
 13528        END-IF
 13529     END-IF
 13530*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13531*       MOVE ER-2661             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 245
* EL050.cbl
 13532*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13533
 13534     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13535        MOVE ER-2662             TO WS-ERROR
 13536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13537
 13538     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13539        MOVE ER-2677             TO WS-ERROR
 13540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13541
 13542     IF CP-ERROR-LOAN-TERM
 13543        MOVE ER-2648             TO WS-ERROR
 13544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13545
 13546 3221-CHECK-ERROR-RATE-OPEN.
 13547
 13548     IF CP-ERROR-RATE-FILE-NOTOPEN
 13549         GO TO 3990-FILES-NOT-OPEN.
 13550
 13551     IF PB-COMPANY-ID NOT = 'DMD'
 13552        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13553     END-IF
 13554     .
 13555 3221-CONTINUE.
 13556     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13557                                    WS-DCC-AH-RATE
 13558     IF PB-COMPANY-ID = 'DCC'
 13559        IF WS-LF-BEN-CATEGORY = 'D'
 13560           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13561              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13562        END-IF
 13563     END-IF
 13564     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13565*   X'A4FF' = 12/31/2009
 13566     IF (PB-COMPANY-ID = 'CID')
 13567        AND (WS-LF-EARNINGS-CALC = 'B')
 13568        AND (CP-STATE-STD-ABBRV = 'MN')
 13569        AND (PB-CERT-EFF-DT > X'A4FF')
 13570        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13571     END-IF
 13572     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13573
 13574     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13575     IF (PB-COMPANY-ID = 'DCC')
 13576        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13577        AND (PB-I-POLICY-IS-MONTHLY)
 13578        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13579        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13580     END-IF
 13581     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13582     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13583     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13584     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13585     IF (PB-COMPANY-ID = 'DCC')
 13586        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13587        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13588        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13589        MOVE ER-2786             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 246
* EL050.cbl
 13590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13591     END-IF
 13592
 13593     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13594
 13595******************************************************************
 13596*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13597******************************************************************
 13598     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13599        and ((not pb-monthly-cert)
 13600        or (ws-lf-ben-category = 'C'))
 13601        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13602
 13603     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13604        GO TO 3225-CHECK-ALT-LIFE-RATE
 13605     ELSE
 13606       IF PB-I-LF-RATE = ZERO
 13607          MOVE ER-2641          TO WS-ERROR
 13608          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13609
 13610 3225-CHECK-ALT-LIFE-RATE.
 13611
 13612     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13613        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13614        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13615         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13616
 13617     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13618         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13619             AND PB-COMPANY-ID NOT = 'DCC')
 13620                   OR
 13621              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13622              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13623              AND PB-COMPANY-ID NOT = 'DCC')
 13624             MOVE ER-2720        TO  WS-ERROR
 13625             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13626             GO TO 3225-RATING-CONT
 13627         ELSE
 13628             GO TO 3225-RATING-CONT.
 13629     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13630        AND (AM-GPCD = 01 OR 06 OR 15)
 13631        MOVE ER-2798             TO WS-ERROR
 13632        PERFORM 9900-ERROR-FORMAT
 13633                                 THRU 9900-EXIT
 13634*       GO TO 3225-RATING-CONT
 13635     END-IF
 13636     IF (PB-COMPANY-ID = 'CID')
 13637        AND (WS-LF-EARNINGS-CALC = 'B')
 13638        AND (CP-STATE-STD-ABBRV = 'MN')
 13639        AND (PB-CERT-EFF-DT > X'A4FF')
 13640        GO TO 3225-RATING-CONT
 13641     END-IF
 13642     IF PB-COMPANY-ID = 'DCC'
 13643        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13644           AND (PB-I-POLICY-IS-MONTHLY)
 13645           GO TO 3225-RATING-CONT
 13646        END-IF
 13647     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 247
* EL050.cbl
 13648
 13649     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13650        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13651        CP-EARN-AS-REG-BALLOON
 13652        NEXT SENTENCE
 13653     ELSE
 13654        MOVE '2'                 TO CP-EARNING-METHOD.
 13655
 13656 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13657
 13658     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13659
 13660     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13661        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13662        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13663         NEXT SENTENCE
 13664     ELSE
 13665         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13666
 13667     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13668     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13669     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13670                                     CP-RATING-BENEFIT-AMT.
 13671     IF CP-STATE-STD-ABBRV = 'OR'
 13672         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13673                                         PB-I-LF-ALT-BENEFIT-AMT.
 13674     IF PB-COMPANY-ID = 'DCC'
 13675        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13676     END-IF
 13677     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13678     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13679     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13680                                    CP-REMAINING-TERM
 13681                                    CP-LOAN-TERM.
 13682     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13683        ADD +1                   TO CP-ORIGINAL-TERM
 13684                                    CP-REMAINING-TERM
 13685                                    CP-LOAN-TERM.
 13686
 13687     MOVE 'R'                   TO CP-RATE-FILE.
 13688     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13689
 13690     IF CP-ERROR-RATE-NOT-FOUND
 13691         MOVE ER-2641            TO WS-ERROR
 13692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13693         GO TO 3300-CHECK-AH-RATES.
 13694
 13695     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13696     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13697
 13698     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13699         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13700
 13701     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13702                               + PB-I-LF-ALT-BENEFIT-AMT.
 13703
 13704     IF ACCOUNT-LIFE-CHECKED  OR
 13705        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 248
* EL050.cbl
 13706        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13707        and (not pb-monthly-cert))
 13708        GO TO 3225-CONTINUE.
 13709
 13710     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13711        GO TO 3225-CONTINUE.
 13712
 13713     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13714                             EC-RT-LF-MAX-TOT-BEN
 13715        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13716        MOVE ER-2639       TO WS-ERROR
 13717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13718
 13719 3225-CONTINUE.
 13720     IF PB-I-LF-ALT-RATE = ZERO
 13721         MOVE ER-2659            TO WS-ERROR
 13722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13723
 13724     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13725        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13726        MOVE ER-2698             TO WS-ERROR
 13727        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13728
 13729 3225-RATING-CONT.
 13730
 13731     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13732        and (not pb-monthly-cert)
 13733         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13734         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13735         IF (PB-COMPANY-ID = 'DCC')
 13736            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13737            CONTINUE
 13738         ELSE
 13739            MOVE ER-2687         TO WS-ERROR
 13740            PERFORM 9900-ERROR-FORMAT
 13741                                 THRU 9900-EXIT
 13742         END-IF
 13743         GO TO 3290-EDIT-LF-REIN-RATE
 13744     END-IF
 13745
 13746* DMD RATING TEST
 13747     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13748         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13749         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13750         MOVE ER-2687                 TO WS-ERROR
 13751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13752         GO TO 3290-EDIT-LF-REIN-RATE.
 13753
 13754 3230-CLIENT-MORT-CD-SPECIALS.
 13755
 13756     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13757     SET BIN-TO-GREG          TO TRUE.
 13758*    MOVE ' '                 TO DC-OPTION-CODE.
 13759     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13760     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13761
 13762 C-POS-3230-MORT-CD.
 13763     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 249
* EL050.cbl
 13764        PB-SV-CARRIER = '2'
 13765         NEXT SENTENCE
 13766     ELSE
 13767         GO TO C-POS-3240-MORT-CD.
 13768
 13769     IF PB-SV-GROUPING = '030'
 13770        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13771         MOVE '2350' TO PB-I-MORT-CODE
 13772      ELSE
 13773         MOVE '3300' TO PB-I-MORT-CODE.
 13774
 13775
 13776 C-POS-3240-MORT-CD.
 13777     IF PB-COMPANY-ID = 'POS' AND
 13778        PB-SV-CARRIER = '1'
 13779         NEXT SENTENCE
 13780     ELSE
 13781         GO TO 3230-CONTINUE.
 13782
 13783     IF PB-SV-STATE = '45' OR '47'
 13784        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13785         MOVE '5200' TO PB-I-MORT-CODE
 13786     ELSE
 13787         MOVE '8300' TO PB-I-MORT-CODE.
 13788
 13789 3230-CONTINUE.
 13790
 13791     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13792        GO TO 3240-CONTINUE
 13793     END-IF
 13794
 13795     IF PB-CERT-EFF-DT > WS-971231
 13796        GO TO 3240-CONTINUE
 13797     END-IF
 13798
 13799     IF LF-BENEFIT-FOUND AND
 13800        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13801         MOVE 'F250'       TO PB-I-MORT-CODE
 13802     ELSE
 13803         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13804             MOVE '7250'   TO PB-I-MORT-CODE
 13805         ELSE
 13806             MOVE '4251'   TO PB-I-MORT-CODE
 13807         END-IF
 13808     END-IF
 13809
 13810     .
 13811 3240-CONTINUE.
 13812
 13813     IF PB-COMPANY-ID NOT = 'GNL'
 13814         GO TO 3256-CONTINUE.
 13815
 13816     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13817         MOVE 'A300' TO PB-I-MORT-CODE
 13818     ELSE
 13819         MOVE '8350' TO PB-I-MORT-CODE.
 13820
 13821 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 250
* EL050.cbl
 13822     IF PB-COMPANY-ID NOT = 'ABL'
 13823         GO TO 3260-EDIT-CONTINUE.
 13824
 13825     IF PB-I-LF-TERM GREATER THAN 59
 13826         MOVE 'F550' TO PB-I-MORT-CODE
 13827     ELSE
 13828         MOVE 'E550' TO PB-I-MORT-CODE.
 13829
 13830 3260-EDIT-CONTINUE.
 13831     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13832
 13833 3290-EDIT-LF-REIN-RATE.
 13834     IF LF-REIN-NSP-NOT-USED
 13835         GO TO 3290-RATING-CONT.
 13836
 13837     IF PB-COMPANY-ID = 'DCC'
 13838        GO TO 3290-RATING-CONT.
 13839     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13840     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13841     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13842     MOVE '3'                   TO CP-PROCESS-TYPE.
 13843     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13844
 13845******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13846     IF PB-COMPANY-ID EQUAL 'CDL'
 13847         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13848            CP-EARN-AS-NET-PAY)
 13849             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13850*            MOVE SPACE          TO DC-OPTION-CODE
 13851             SET BIN-TO-GREG     TO TRUE
 13852             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13853***  Y2K PROJ 7744
 13854             IF DC-GREG-DATE-CYMD GREATER 19931231
 13855                 MOVE '1'        TO CP-EARNING-METHOD.
 13856***  Y2K PROJ 7744
 13857*******
 13858
 13859     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13860     MOVE PB-SV-STATE           TO CP-STATE.
 13861     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13862     MOVE ZERO                  TO CP-DEVIATION-CODE
 13863                                   CP-RATE-DEV-PCT.
 13864     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13865     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13866                                   CP-RATING-BENEFIT-AMT.
 13867
 13868************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13869     IF PB-COMPANY-ID EQUAL 'NCB'
 13870         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13871            CP-EARN-AS-NET-PAY
 13872             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13873                 PB-I-LF-PREMIUM-AMT.
 13874************
 13875
 13876     IF CP-STATE-STD-ABBRV = 'OR'
 13877         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13878                                         PB-I-LF-ALT-BENEFIT-AMT.
 13879     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 251
* EL050.cbl
 13880     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13881     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13882     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13883     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13884     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13885     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13886     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13887                                   CP-REMAINING-TERM
 13888                                   CP-LOAN-TERM.
 13889     IF CP-TRUNCATED-LIFE
 13890        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13891
 13892     IF CP-TERM-IS-DAYS
 13893         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13894     ELSE
 13895         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13896
 13897     IF PB-COMPANY-ID = 'DCC'
 13898        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13899     END-IF
 13900     IF PB-COMPANY-ID NOT = 'TIC'
 13901          MOVE ZERO          TO CP-CLASS-CODE.
 13902
 13903     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13904
 13905     MOVE 'R'                   TO CP-RATE-FILE.
 13906     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13907
 13908     IF CP-ERROR-RATE-NOT-FOUND
 13909        IF PB-I-OB
 13910           MOVE ER-2625      TO WS-ERROR
 13911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13912           GO TO 3299-EDIT-CONTINUE
 13913        ELSE
 13914           MOVE ER-2643      TO WS-ERROR
 13915           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13916           GO TO 3299-EDIT-CONTINUE.
 13917
 13918     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13919
 13920     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13921     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13922
 13923     IF PB-I-LF-REI-RATE = ZERO
 13924         MOVE ER-2643        TO WS-ERROR
 13925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13926
 13927 3290-CHECK-ALT-REIN-RATE.
 13928
 13929     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13930        GO TO 3290-RATING-CONT.
 13931
 13932     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13933     MOVE '2'                    TO CP-EARNING-METHOD.
 13934     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13935     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13936     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13937     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 252
* EL050.cbl
 13938                                     CP-RATING-BENEFIT-AMT.
 13939     IF CP-STATE-STD-ABBRV = 'OR'
 13940         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13941                                         PB-I-LF-ALT-BENEFIT-AMT.
 13942     IF PB-COMPANY-ID = 'DCC'
 13943        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13944     END-IF
 13945     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13946     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13947     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13948                                    CP-REMAINING-TERM
 13949                                    CP-LOAN-TERM.
 13950     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13951        ADD +1                   TO CP-ORIGINAL-TERM
 13952                                    CP-REMAINING-TERM
 13953                                    CP-LOAN-TERM.
 13954
 13955     MOVE 'R'                   TO CP-RATE-FILE.
 13956     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13957
 13958     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13959
 13960     IF PB-I-LF-ALT-REI-RATE = ZERO
 13961         MOVE ER-2643            TO WS-ERROR
 13962         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13963
 13964 3290-RATING-CONT.
 13965
 13966     IF PB-I-OB
 13967*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13968        GO TO 3300-CHECK-AH-RATES.
 13969
 13970 3299-EDIT-CONTINUE.
 13971
 13972     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13973         NEXT SENTENCE
 13974     ELSE
 13975         MOVE ER-2620           TO WS-ERROR
 13976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13977
 13978 3300-CHECK-AH-RATES.
 13979     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13980         NEXT SENTENCE
 13981     ELSE
 13982         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13983
 13984     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 13985        and (not pb-monthly-cert))
 13986                  or
 13987        ((CF-COMPANY-ID = 'DMD') AND
 13988                (NO-DMD-RATING))
 13989         IF (PB-COMPANY-ID = 'DCC')
 13990            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13991            CONTINUE
 13992         ELSE
 13993            MOVE ER-2687         TO WS-ERROR
 13994            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13995         END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 253
* EL050.cbl
 13996         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13997         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13998     END-IF
 13999
 14000     IF PB-I-OB
 14001        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14002
 14003     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14004         MOVE ER-2687             TO WS-ERROR
 14005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14006         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14007         GO TO 3999-END-EDIT.
 14008
 14009*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14010     if pb-company-id = 'AHL'
 14011        go to 3300-skip-crit-per
 14012     end-if
 14013     if (pb-i-ah-crit-per not = zeros)
 14014        and (ws-ah-special-calc-cd not = 'C')
 14015        MOVE ER-1572             TO WS-ERROR
 14016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14017        go to 3300-skip-crit-per
 14018     END-IF
 14019     if (pb-company-id = 'DCC')
 14020        and (am-dcc-product-code not = spaces)
 14021        go to 3300-skip-crit-per
 14022     end-if
 14023     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14024        IF PB-I-AH-CRIT-PER = ZERO
 14025           move ws-ah-max-bens   to pb-i-ah-crit-per
 14026*          MOVE ER-2618       TO WS-ERROR
 14027*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14028*          GO TO 3999-END-EDIT
 14029        END-IF
 14030     END-IF
 14031     if (ws-ah-special-calc-cd = 'C')
 14032        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14033        MOVE ER-1576             TO WS-ERROR
 14034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035     end-if
 14036
 14037     .
 14038 3300-skip-crit-per.
 14039     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14040     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14041     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14042     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14043     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14044     MOVE PB-SV-STATE            TO CP-STATE.
 14045     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14046     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14047     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14048*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14049     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14050     MOVE '3'                    TO CP-PROCESS-TYPE.
 14051     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14052     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14053                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 254
* EL050.cbl
 14054     IF PB-COMPANY-ID = 'CID'
 14055               OR
 14056        CP-STATE-STD-ABBRV = 'OR'
 14057         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14058                                         PB-I-AH-TERM.
 14059     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14060        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14061           AND (PB-I-POLICY-IS-MONTHLY)
 14062           MOVE PB-I-LF-BENEFIT-AMT
 14063                                 TO CP-NET-BENEFIT-AMT
 14064           move pb-i-ah-premium-amt to cp-original-premium
 14065           add pb-i-lf-premium-amt to cp-original-premium
 14066        END-IF
 14067     END-IF
 14068     MOVE SPACES                 TO CP-BEN-CATEGORY
 14069     IF PB-COMPANY-ID = 'DCC'
 14070        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14071        EVALUATE TRUE
 14072           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14073              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14074              MOVE PB-I-LF-BENEFIT-AMT
 14075                                 TO CP-RATING-BENEFIT-AMT
 14076              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14077           WHEN WS-AH-BEN-CATEGORY = 'G'
 14078              MOVE PB-I-UNPAID-CASH-PRICE
 14079                                 TO CP-RATING-BENEFIT-AMT
 14080           WHEN WS-AH-BEN-CATEGORY = 'D'
 14081              MOVE WS-AH-PMF-COMM
 14082                                 TO CP-DCC-PMF-COMM
 14083              MOVE PB-I-AH-COMMISSION
 14084                                 TO CP-DCC-ACT-COMM
 14085        END-EVALUATE
 14086     END-IF
 14087     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14088     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14089     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14090     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14091     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14092     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14093     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14094                                    CP-REMAINING-TERM
 14095                                    WS-WORK-TERM.
 14096     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14097
 14098     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14099     SET BIN-TO-GREG             TO TRUE.
 14100*    MOVE ' '                    TO DC-OPTION-CODE.
 14101     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14102     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14103
 14104     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14105     IF NOT VALID-SKIP-CODE
 14106         MOVE ER-2683            TO WS-ERROR
 14107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14108         GO TO 3320-RATE-CONTINUE.
 14109
 14110     IF PB-NO-MONTHS-SKIPPED
 14111         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 255
* EL050.cbl
 14112
 14113     MOVE SPACE TO NUMBER-OF-MONTHS.
 14114
 14115     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14116         MOVE 'S'                TO SK-MO (6).
 14117     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14118         MOVE 'S'                TO SK-MO (7).
 14119     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14120         MOVE 'S'                TO SK-MO (8).
 14121     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14122         MOVE 'S'                TO SK-MO (9).
 14123     IF PB-I-SKIP-CODE = 'A'
 14124         MOVE 'S'                TO SK-MO (10).
 14125
 14126     MOVE 1                      TO SUB2.
 14127     MOVE PB-I-AH-TERM           TO SUB3.
 14128     MOVE WS-MONTH               TO SUB1.
 14129     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14130     GO TO 3320-RATE-CONTINUE.
 14131
 14132 3310-GET-SKIP-MO.
 14133     IF SUB1 = 13
 14134         MOVE 1                  TO SUB1.
 14135
 14136     IF SK-MO (SUB1) = 'S'
 14137         SUBTRACT 1 FROM WS-WORK-TERM.
 14138
 14139     ADD 1 TO SUB2
 14140              SUB1.
 14141
 14142 3320-RATE-CONTINUE.
 14143
 14144     IF WS-WORK-TERM = ZERO
 14145         MOVE 1                  TO WS-WORK-TERM.
 14146
 14147     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14148                                    CP-LOAN-TERM.
 14149
 14150     IF PB-COMPANY-ID EQUAL 'DMD'
 14151         NEXT SENTENCE
 14152     ELSE
 14153         MOVE ZERO               TO PB-I-AH-RATE
 14154                                    PB-I-AH-REI-RATE.
 14155
 14156
 14157     IF PB-COMPANY-ID EQUAL 'CRI'
 14158        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14159
 14160     IF PB-COMPANY-ID = 'CSL'
 14161         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14162         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14163         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14164         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14165
 14166     IF PB-COMPANY-ID = 'DCC'
 14167        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14168           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14169              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 256
* EL050.cbl
 14170        END-IF
 14171        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14172                                 TO CP-ALTERNATE-BENEFIT
 14173        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14174        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14175        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14176     END-IF
 14177     IF (PB-COMPANY-ID = 'CID')
 14178        AND (WS-LF-EARNINGS-CALC = 'B')
 14179        AND (CP-STATE-STD-ABBRV = 'MN')
 14180        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14181     ELSE
 14182        MOVE ' '                 TO CP-AH-BALLOON-SW
 14183     END-IF
 14184     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14185     MOVE 'R'                   TO CP-RATE-FILE.
 14186     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14187
 14188     IF (CP-ERROR-RATE-NOT-FOUND)
 14189        and (not pb-monthly-cert)
 14190        IF PB-I-OB
 14191           MOVE ER-2624          TO WS-ERROR
 14192           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14193           GO TO 3340-CALCULATE-PREMIUM-AMT
 14194        ELSE
 14195          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14196              NEXT SENTENCE
 14197          ELSE
 14198           MOVE ER-2642          TO WS-ERROR
 14199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14200           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14201
 14202     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14203        CP-ERROR-DIV-BY-ZERO
 14204           MOVE ER-3782          TO WS-ERROR
 14205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14206
 14207     IF PB-COMPANY-ID EQUAL 'CRI'
 14208        IF CP-ERROR-NO-LIMITS-CRI
 14209           IF NOT ACCOUNT-AH-CHECKED
 14210              MOVE ER-2607          TO WS-ERROR
 14211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14212
 14213     IF ACCOUNT-AH-CHECKED
 14214        NEXT SENTENCE
 14215     ELSE
 14216       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14217          MOVE ER-2640           TO WS-ERROR
 14218          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14219
 14220     IF PB-COMPANY-ID = 'CRI'
 14221         IF WS-ERROR = ER-2640
 14222             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14223     IF ACCOUNT-AH-CHECKED
 14224        CONTINUE
 14225     ELSE
 14226        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14227           AND (CP-R-MAX-ATT-AGE > +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 257
* EL050.cbl
 14228           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14229           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14230              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14231              MOVE PB-I-AH-EXPIRE-DT
 14232                                 TO DC-BIN-DATE-2
 14233              MOVE '1'           TO DC-OPTION-CODE
 14234              PERFORM 8500-DATE-CONVERT
 14235                                 THRU 8500-EXIT
 14236              IF NO-CONVERSION-ERROR
 14237                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14238                    MOVE ER-2661       TO WS-ERROR
 14239*                   PERFORM 9900-ERROR-FORMAT
 14240*                                THRU 9900-EXIT
 14241                 END-IF
 14242              END-IF
 14243           ELSE
 14244              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14245              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14246                 MOVE ER-2661    TO WS-ERROR
 14247*                PERFORM 9900-ERROR-FORMAT
 14248*                                THRU 9900-EXIT
 14249              ELSE
 14250                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14251                    MOVE ER-1570 TO WS-ERROR
 14252                    PERFORM 9900-ERROR-FORMAT
 14253                                 THRU 9900-EXIT
 14254                 END-IF
 14255              END-IF
 14256           END-IF
 14257           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14258              MOVE PB-I-JOINT-BIRTHDAY
 14259                                    TO DC-BIN-DATE-1
 14260              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14261              MOVE '1'              TO DC-OPTION-CODE
 14262              PERFORM 8500-DATE-CONVERT
 14263                                    THRU 8500-EXIT
 14264              IF NO-CONVERSION-ERROR
 14265                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14266                    MOVE ER-2661       TO WS-ERROR
 14267*                   PERFORM 9900-ERROR-FORMAT
 14268*                                   THRU 9900-EXIT
 14269                 END-IF
 14270              END-IF
 14271           ELSE
 14272              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14273                (PB-I-AH-TERM / 12)
 14274              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14275                 MOVE ER-2661       TO WS-ERROR
 14276*                PERFORM 9900-ERROR-FORMAT
 14277*                                   THRU 9900-EXIT
 14278              ELSE
 14279                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14280                    MOVE ER-1571 TO WS-ERROR
 14281                    PERFORM 9900-ERROR-FORMAT
 14282                                 THRU 9900-EXIT
 14283                 END-IF
 14284              END-IF
 14285           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 258
* EL050.cbl
 14286           IF WS-ERROR = ER-2661
 14287              PERFORM 9900-ERROR-FORMAT
 14288                                    THRU 9900-EXIT
 14289           END-IF
 14290        END-IF
 14291     END-IF
 14292*    IF ACCOUNT-AH-CHECKED
 14293*       NEXT SENTENCE
 14294*    ELSE
 14295*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14296*          MOVE ER-2661          TO WS-ERROR
 14297*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14298
 14299     IF ACCOUNT-AH-CHECKED
 14300        NEXT SENTENCE
 14301     ELSE
 14302        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14303           MOVE ER-2663          TO WS-ERROR
 14304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14305
 14306     IF ACCOUNT-AH-CHECKED OR
 14307        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14308         PB-POLICY-IS-VOIDED
 14309        NEXT SENTENCE
 14310     ELSE
 14311        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14312           MOVE ER-2667            TO WS-ERROR
 14313           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     IF PB-COMPANY-ID = 'CRI'
 14316         IF WS-ERROR = ER-2667
 14317             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14318
 14319     IF ACCOUNT-AH-CHECKED
 14320        NEXT SENTENCE
 14321     ELSE
 14322        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14323           MOVE ER-2678            TO WS-ERROR
 14324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14325
 14326     IF CP-ERROR-RATE-FILE-NOTOPEN
 14327         GO TO 3990-FILES-NOT-OPEN.
 14328
 14329 3321-CONTINUE.
 14330     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14331     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14332     IF (PB-COMPANY-ID = 'DCC')
 14333        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14334        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14335                                    PB-I-LF-ALT-PREM-CALC
 14336        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14337        IF WS-AH-BEN-CATEGORY = 'G'
 14338           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14339           + PB-I-ADDL-CLP)
 14340           * (1 + WS-TOL-CLP-PCT)
 14341*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14342        ELSE
 14343           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 259
* EL050.cbl
 14344           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14345*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14346        END-IF
 14347        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14348                                 TO PB-I-AH-PREM-CALC
 14349        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14350           MOVE ER-8152          TO WS-ERROR
 14351           PERFORM 9900-ERROR-FORMAT
 14352                                 THRU 9900-EXIT
 14353        ELSE
 14354           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14355                 PB-I-ADDL-CLP)
 14356              MOVE ER-8148       TO WS-ERROR
 14357              PERFORM 9900-ERROR-FORMAT
 14358                                 THRU 9900-EXIT
 14359           END-IF
 14360        END-IF
 14361     END-IF
 14362     IF (PB-COMPANY-ID = 'DCC')
 14363        AND (PB-I-POLICY-IS-MONTHLY)
 14364        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14365        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14366        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14367           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14368        END-IF
 14369     END-IF
 14370     IF (PB-COMPANY-ID = 'DCC')
 14371        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14372        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14373        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14374        MOVE ER-2786             TO WS-ERROR
 14375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14376     END-IF
 14377     MOVE +0                     TO PB-I-AH-CLP
 14378     IF PB-COMPANY-ID = 'DCC'
 14379        evaluate true
 14380           when WS-AH-BEN-CATEGORY = 'D'
 14381              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14382                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14383           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14384              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14385           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14386              compute ws-cred-union-fees rounded =
 14387                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14388                    pb-i-ah-commission)
 14389              COMPUTE PB-I-AH-CLP =
 14390                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14391        end-evaluate
 14392     END-IF
 14393     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14394
 14395     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14396         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14397
 14398     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14399         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14400
 14401     if (ws-ah-special-calc-cd = 'E')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 260
* EL050.cbl
 14402        and (pb-monthly-cert)
 14403        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14404     end-if
 14405     IF PB-COMPANY-ID = 'CRI'
 14406         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14407            PB-I-PAYMENT-AMOUNT = ZERO
 14408             NEXT SENTENCE
 14409         ELSE
 14410             COMPUTE PB-I-AH-PREM-CALC =
 14411                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14412                 (CP-PREMIUM-RATE / 100)
 14413             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14414                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14415                                             PB-I-RATE-DEV-PCT-AH.
 14416
 14417     IF (PB-I-AH-RATE  = ZERO)
 14418        and (not pb-monthly-cert)
 14419       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14420           NEXT SENTENCE
 14421       ELSE
 14422         MOVE ER-2642            TO WS-ERROR
 14423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14424
 14425     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14426     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14427     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14428     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14429     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14430     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14431
 14432     IF (PB-COMPANY-ID = 'DCC')
 14433        AND (WS-AH-BEN-CATEGORY = 'G')
 14434        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14435        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14436        IF CP-DEVIATION-CODE NOT = '000'
 14437           MOVE '000'            TO CP-DEVIATION-CODE
 14438           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14439           IF NO-CP-ERROR
 14440              COMPUTE PB-I-DDF-IU-RATE-UP =
 14441              PB-I-AH-CLP - CP-CALC-PREMIUM
 14442           ELSE
 14443              MOVE ER-3057        TO WS-ERROR
 14444              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14445           END-IF
 14446        END-IF
 14447     END-IF
 14448     .
 14449 3335-EDIT-AH-REIN-NSP-RATE.
 14450     IF PB-COMPANY-ID = 'DCC'
 14451        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14452              compute ws-cred-union-fees rounded =
 14453                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14454                    pb-i-ah-commission)
 14455              COMPUTE PB-I-AH-CLP =
 14456                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14457        end-if
 14458     END-IF
 14459     IF AH-REIN-NSP-NOT-USED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 261
* EL050.cbl
 14460         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14461
 14462     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14463     IF PB-COMPANY-ID = 'DCC'
 14464         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14465     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14466     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14467     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14468     MOVE PB-SV-STATE            TO CP-STATE.
 14469     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14470     MOVE ZERO                   TO CP-DEVIATION-CODE
 14471                                    CP-RATE-DEV-PCT.
 14472*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14473     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14474     MOVE '3'                    TO CP-PROCESS-TYPE.
 14475     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14476     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14477                                    CP-RATING-BENEFIT-AMT.
 14478     IF CP-STATE-STD-ABBRV = 'OR'
 14479         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14480                                         PB-I-AH-TERM.
 14481     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14482     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14483     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14484     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14485     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14486     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14487                                    CP-REMAINING-TERM
 14488                                    WS-WORK-TERM.
 14489     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14490     IF PB-COMPANY-ID = 'DCC'
 14491        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14492     END-IF
 14493     IF  PB-COMPANY-ID = 'TIC'
 14494         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14495            MOVE ZERO TO CP-CLASS-CODE.
 14496
 14497     IF PB-COMPANY-ID NOT = 'TIC'
 14498          MOVE ZERO          TO CP-CLASS-CODE.
 14499
 14500     MOVE ZERO               TO CP-DEVIATION-CODE.
 14501
 14502     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14503
 14504     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14505
 14506     MOVE 'R'                   TO CP-RATE-FILE.
 14507     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14508
 14509     IF CP-ERROR-RATE-NOT-FOUND
 14510         MOVE ER-2645        TO WS-ERROR
 14511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14512         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14513
 14514     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14515
 14516     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14517     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 262
* EL050.cbl
 14518
 14519     IF PB-I-AH-REI-RATE = ZERO
 14520         MOVE ER-2645        TO WS-ERROR
 14521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14522
 14523
 14524 3340-CALCULATE-PREMIUM-AMT.
 14525
 14526     IF PB-COMPANY-ID = 'NCL'
 14527         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14528             WS-AH-SPECIAL-CALC-CD = 'O')
 14529             GO TO 3999-END-EDIT.
 14530
 14531     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14532                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14533                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14534                         OR 'AHL'
 14535         NEXT SENTENCE
 14536     ELSE
 14537         IF WS-STATE-ABBREVIATION = 'CT'
 14538             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14539                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14540                 COMPUTE PB-I-LF-PREM-CALC =
 14541                                     PB-I-LF-PREM-CALC * .90
 14542                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14543                                     PB-I-LF-ALT-PREM-CALC * .90
 14544                 COMPUTE PB-I-AH-PREM-CALC =
 14545                                     PB-I-AH-PREM-CALC * .90.
 14546
 14547     IF PB-COMP-LF-PREM
 14548        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14549        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14550
 14551     IF PB-COMP-AH-PREM
 14552        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14553
 14554 3340-CHECK-DCC-TOT-FEES.
 14555     IF (PB-COMPANY-ID = 'DCC')
 14556        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14557        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14558        AND (PB-I-POLICY-IS-MONTHLY)
 14559        CONTINUE
 14560     ELSE
 14561        GO TO 3340-EDIT-LF-AH-TOL
 14562     END-IF
 14563     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14564     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14565     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14566        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14567           PB-I-RATE-DEV-PCT-LF
 14568     END-IF
 14569     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14570        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14571           PB-I-RATE-DEV-PCT-AH
 14572     END-IF
 14573     MOVE 'N'                    TO CP-BEN-CATEGORY
 14574     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14575
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 263
* EL050.cbl
 14576     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14577     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14578     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14579     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14580     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14581     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14582     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14583     MOVE '3'                    TO CP-PROCESS-TYPE.
 14584     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14585     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14586
 14587     MOVE PB-SV-STATE            TO CP-STATE.
 14588     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14589     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14590     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14591     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14592     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14593                                    CP-RATING-BENEFIT-AMT.
 14594     IF CP-STATE-STD-ABBRV = 'OR'
 14595         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14596                                         PB-I-LF-ALT-BENEFIT-AMT.
 14597     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14598     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14599     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14600     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14601     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14602     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14603     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14604     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14605     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14606                                    CP-REMAINING-TERM
 14607                                    CP-LOAN-TERM.
 14608     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14609        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14610           PB-I-LF-PREMIUM-AMT
 14611     end-if
 14612
 14613     IF CP-TRUNCATED-LIFE
 14614        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14615
 14616     IF CP-TERM-IS-DAYS
 14617         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14618     ELSE
 14619         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14620
 14621     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14622     IF CP-SPECIAL-CALC-CD = 'H'
 14623         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14624                                    TO CP-ALTERNATE-BENEFIT
 14625         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14626     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14627     MOVE 'R'                    TO CP-RATE-FILE
 14628     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14629     IF NOT CP-ERROR-RATE-NOT-FOUND
 14630        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14631        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14632           AND (CP-BENEFIT-CD (1:1) = 'S')
 14633           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 264
* EL050.cbl
 14634                                    PB-I-LF-PREMIUM-AMT
 14635        END-IF
 14636     ELSE
 14637        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14638     END-IF
 14639     .
 14640 3340-EDIT-LF-AH-TOL.
 14641
 14642***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14643***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14644***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14645***
 14646     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14647         PB-I-AH-PREMIUM-AMT
 14648          GIVING WS-CALC-WORK.
 14649
 14650     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14651        AND WS-CALC-WORK NOT = ZERO
 14652         MOVE ER-2649            TO WS-ERROR
 14653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14654
 14655     SUBTRACT PB-I-LF-PREM-CALC
 14656             FROM PB-I-LF-PREMIUM-AMT
 14657                 GIVING WS-UNSIGN-WRK1.
 14658
 14659     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14660             FROM PB-I-LF-ALT-PREMIUM-AMT
 14661                 GIVING WS-UNSIGN-WRK4.
 14662
 14663     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14664                                + WS-UNSIGN-WRK4.
 14665
 14666     SUBTRACT PB-I-AH-PREM-CALC
 14667             FROM PB-I-AH-PREMIUM-AMT
 14668                 GIVING WS-UNSIGN-WRK2.
 14669
 14670******************************************************************
 14671*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14672******************************************************************
 14673
 14674     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14675         MOVE ZERO TO WS-UNSIGN-WRK1.
 14676
 14677     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14678         MOVE ZERO TO WS-UNSIGN-WRK2.
 14679
 14680     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14681             GIVING WS-UNSIGN-WRK3.
 14682
 14683 3342-CONTINUE.
 14684
 14685     IF (PB-I-LF-RATE = ZERO  AND
 14686         PB-I-AH-RATE = ZERO)
 14687         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14688            WS-AH-SPECIAL-CALC-CD = 'O'
 14689              NEXT SENTENCE
 14690         ELSE
 14691             GO TO 3345-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 265
* EL050.cbl
 14692
 14693     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14694         NEXT SENTENCE
 14695     ELSE
 14696     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14697        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14698           IF (PB-REISSUED-CERT         OR
 14699               PB-POLICY-IS-DECLINED    OR
 14700               PB-POLICY-IS-VOIDED)
 14701              NEXT SENTENCE
 14702           ELSE
 14703              IF WS-PREM-REJECT-SW = SPACE
 14704                 MOVE ER-2652    TO WS-ERROR
 14705                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14706                 GO TO 3344-CHECK-AH
 14707              ELSE
 14708                 MOVE ER-2650    TO WS-ERROR
 14709                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14710                 GO TO 3344-CHECK-AH.
 14711
 14712***
 14713***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14714***
 14715
 14716     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14717         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14718            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14719             (1 + WS-TOL-LF-PREM-PCT)
 14720         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14721            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14722             (1 - WS-TOL-LF-PREM-PCT)
 14723     ELSE
 14724         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14725         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14726
 14727***
 14728***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14729***
 14730
 14731     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14732         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14733          WS-TOL-LF-PREM.
 14734
 14735     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14736         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14737          WS-TOL-LF-PREM.
 14738
 14739     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14740        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14741
 14742     IF PB-REISSUED-CERT
 14743        or PB-POLICY-IS-DECLINED
 14744        or PB-POLICY-IS-VOIDED
 14745        continue
 14746     ELSE
 14747        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14748              > WS-TOL-LF-HIGH-PREM-AMT)
 14749           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 266
* EL050.cbl
 14750              < WS-TOL-LF-LOW-PREM-AMT))
 14751                      or
 14752           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14753              > WS-TOL-LF-HIGH-PREM-PCT)
 14754           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14755              < WS-TOL-LF-LOW-PREM-PCT))
 14756           IF WS-PREM-REJECT-SW = SPACE
 14757              MOVE ER-2652       TO WS-ERROR
 14758              PERFORM 9900-ERROR-FORMAT
 14759                                 THRU 9900-EXIT
 14760           ELSE
 14761              MOVE ER-2650       TO WS-ERROR
 14762              PERFORM 9900-ERROR-FORMAT
 14763                                 THRU 9900-EXIT
 14764           end-if
 14765        end-if
 14766     end-if
 14767
 14768*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14769*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14770*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14771*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14772
 14773     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14774        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14775                      OR
 14776           ((PB-COMPANY-ID = 'DCC')
 14777           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14778           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14779           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14780        END-IF
 14781     END-IF
 14782
 14783     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14784        IF WS-COMP-MAX-CAP GREATER THAN +0
 14785           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14786              IF (PB-REISSUED-CERT         OR
 14787                  PB-POLICY-IS-DECLINED    OR
 14788                  PB-POLICY-IS-VOIDED)
 14789                 NEXT SENTENCE
 14790              ELSE
 14791                  MOVE ER-2646   TO  WS-ERROR
 14792                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14793
 14794 3344-CVL-TOLERANCE-CHECK.
 14795
 14796      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14797          GO TO 3344-CHECK-AH.
 14798
 14799      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14800          GO TO 3344-CHECK-AH.
 14801
 14802      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14803                                     WS-UNSIGN-WRK6.
 14804
 14805      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14806          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14807                                 + PB-I-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 267
* EL050.cbl
 14808                                 - PB-I-LF-PREM-CALC.
 14809
 14810      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14811          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14812                                 + PB-I-LF-ALT-PREMIUM-AMT
 14813                                 - PB-I-LF-ALT-PREM-CALC.
 14814
 14815      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14816          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14817              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14818                 MOVE ER-2652    TO  WS-ERROR
 14819                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14820              ELSE
 14821                 MOVE ER-2650    TO  WS-ERROR
 14822                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14823
 14824      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14825          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14826              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14827                 MOVE ER-2652    TO  WS-ERROR
 14828                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14829              ELSE
 14830                 MOVE ER-2650    TO  WS-ERROR
 14831                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14832
 14833 3344-CHECK-AH.
 14834
 14835****************************************************************
 14836***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14837***
 14838
 14839     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14840         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14841             (1 + WS-TOL-AH-PREM-PCT)
 14842         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14843             (1 - WS-TOL-AH-PREM-PCT)
 14844     ELSE
 14845         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14846         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14847
 14848***
 14849***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14850***
 14851
 14852     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14853         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14854
 14855     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14856         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14857
 14858     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14859        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14860
 14861     IF (PB-REISSUED-CERT)
 14862        OR (PB-POLICY-IS-DECLINED)
 14863        OR (PB-POLICY-IS-VOIDED)
 14864        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14865        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 268
* EL050.cbl
 14866     ELSE
 14867        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14868              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14869                          or
 14870           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14871              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14872           IF WS-PREM-REJECT-SW = SPACE
 14873              MOVE ER-3052       TO WS-ERROR
 14874              PERFORM 9900-ERROR-FORMAT
 14875                                 THRU 9900-EXIT
 14876           ELSE
 14877              MOVE ER-3050       TO WS-ERROR
 14878              PERFORM 9900-ERROR-FORMAT
 14879                                 THRU 9900-EXIT
 14880           END-IF
 14881        END-IF
 14882     END-IF
 14883     if (pb-company-id = 'DCC')
 14884        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14885        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14886        and (pb-i-policy-is-monthly)
 14887        compute ws-tol-ah-high-prem-amt =
 14888           pb-i-tot-fees-calc + ws-tol-ah-prem
 14889        compute ws-tol-ah-low-prem-amt =
 14890           pb-i-tot-fees-calc - ws-tol-ah-prem
 14891        if ws-tol-ah-prem-pct > zeros
 14892           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14893              (1 + ws-tol-ah-prem-pct)
 14894           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14895              (1 - ws-tol-ah-prem-pct)
 14896        else
 14897           move +9999999.99      to ws-tol-ah-high-prem-pct
 14898           move +0               to ws-tol-ah-low-prem-pct
 14899        end-if
 14900        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14901            or
 14902           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14903                          or
 14904           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14905           or
 14906           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14907            move er-3049         to ws-error
 14908           perform 9900-error-format
 14909                                 thru 9900-exit
 14910
 14911        end-if
 14912     end-if
 14913     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14914         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14915             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14916             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14917
 14918     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14919        IF WS-COMP-MAX-CAP GREATER THAN +0
 14920           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14921              IF (PB-REISSUED-CERT         OR
 14922                  PB-POLICY-IS-DECLINED    OR
 14923                  PB-POLICY-IS-VOIDED)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 269
* EL050.cbl
 14924                 NEXT SENTENCE
 14925              ELSE
 14926                  MOVE ER-2646   TO  WS-ERROR
 14927                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14928
 14929     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14930        (WS-COMP-MAX-CAP EQUAL +0)
 14931           GO TO 3345-EDIT-CONTINUE.
 14932
 14933     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14934        GREATER THAN WS-COMP-MAX-CAP
 14935           MOVE ER-2646          TO  WS-ERROR
 14936           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14937
 14938 3345-EDIT-CONTINUE.
 14939
 14940*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14941*       IF PB-ENTRY-BATCH   NUMERIC
 14942*          IF PB-ISSUE
 14943*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14944*          ELSE
 14945*              IF PB-CANCELLATION
 14946*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14947
 14948*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14949*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14950*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14951*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14952*        ELSE
 14953*            MOVE  ER-1909            TO  WS-ERROR
 14954*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14955
 14956     IF PB-I-POLICY-ACCEPTED
 14957        IF PB-POLICY-IS-DECLINED  OR
 14958           PB-REISSUED-CERT  OR
 14959           PB-REIN-ONLY-CERT  OR
 14960           PB-POLICY-IS-VOIDED
 14961            MOVE  ER-1891         TO  WS-ERROR
 14962            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14963        ELSE
 14964            MOVE SPACE            TO  PB-BATCH-ENTRY
 14965            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14966
 14967     IF PB-I-POLICY-DECLINED
 14968        IF PB-REISSUED-CERT  OR
 14969           PB-REIN-ONLY-CERT  OR
 14970           PB-POLICY-IS-VOIDED
 14971            MOVE  ER-1906         TO  WS-ERROR
 14972            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14973        ELSE
 14974            MOVE  'D'             TO  PB-BATCH-ENTRY
 14975                                      PB-I-ENTRY-STATUS.
 14976
 14977     IF PB-I-NEEDS-UNDERWRITING
 14978        IF PB-POLICY-IS-DECLINED OR
 14979           PB-REISSUED-CERT  OR
 14980           PB-REIN-ONLY-CERT  OR
 14981           PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 270
* EL050.cbl
 14982            MOVE  ER-1907         TO  WS-ERROR
 14983            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14984        ELSE
 14985            MOVE 'U'              TO  PB-BATCH-ENTRY
 14986                                      PB-I-ENTRY-STATUS.
 14987
 14988     IF PB-NEEDS-UNDERWRITING
 14989        MOVE  ER-1901             TO  WS-ERROR
 14990        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14991     IF PB-COMPANY-ID = 'DCC'
 14992        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14993        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14994        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14995           AND (NOT WS-LF-CASH))
 14996                           OR
 14997           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14998           AND (NOT WS-AH-CASH)))
 14999                       AND
 15000           (PB-I-ENTRY-STATUS NOT = '5')
 15001           MOVE 'M'              TO PB-BATCH-ENTRY
 15002                                    PB-I-ENTRY-STATUS
 15003        END-IF
 15004     END-IF
 15005     IF  PB-COMPANY-ID NOT = 'NCL'
 15006         GO TO 3999-END-EDIT.
 15007
 15008     IF PB-REISSUED-CERT  OR
 15009        PB-POLICY-IS-DECLINED  OR
 15010        PB-POLICY-IS-VOIDED  OR
 15011        PB-I-OB
 15012         GO TO 3999-END-EDIT.
 15013
 15014     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15015         MOVE  ER-2644            TO  WS-ERROR
 15016         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15017         GO TO 3999-END-EDIT.
 15018
 15019     MOVE 'N'                     TO  FORM-MASTER-SW.
 15020     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15021
 15022     IF NOT FORM-MASTER-FOUND
 15023         GO TO 3999-END-EDIT.
 15024
 15025     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15026                                      FORM-MASTER-AH-SW.
 15027
 15028     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15029         MOVE  +1                 TO SUB6
 15030         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15031
 15032     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15033         MOVE  +1                 TO SUB6
 15034         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15035
 15036     IF LF-FORM-MASTER-FOUND  OR
 15037        AH-FORM-MASTER-FOUND
 15038         GO TO 3360-CHECK-FORM-LIMITS
 15039     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 271
* EL050.cbl
 15040         GO TO 3999-END-EDIT.
 15041
 15042******************************************************************
 15043*                  3350-GET-ERFORM                               *
 15044*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15045*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15046******************************************************************
 15047
 15048 3350-GET-ERFORM.
 15049
 15050     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15051         GO TO  3350-ERFORM-GETMAIN.
 15052
 15053     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15054     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15055     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15056     MOVE 'Y'                     TO FORM-MASTER-SW.
 15057
 15058     IF PB-CANCELLATION
 15059         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15060            PB-SV-STATE          EQUAL   FO-STATE       AND
 15061            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15062              GO TO 3350-EXIT
 15063         ELSE
 15064             NEXT SENTENCE
 15065     ELSE
 15066         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15067            PB-SV-STATE          EQUAL   FO-STATE       AND
 15068            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15069              GO TO 3350-EXIT.
 15070
 15071 3350-ERFORM-GETMAIN.
 15072
 15073     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15074     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15075
 15076 3350-ERFORM-READ.
 15077
 15078     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15079     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15080     IF PB-CANCELLATION
 15081         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15082     ELSE
 15083         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15084     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15085
 15086     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15087
 15088     IF FORM-MASTER-FOUND
 15089       IF PB-CANCELLATION
 15090          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15091             PB-SV-STATE          EQUAL   FO-STATE       AND
 15092             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15093              GO  TO 3350-EXIT
 15094          ELSE
 15095              NEXT SENTENCE
 15096       ELSE
 15097          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 272
* EL050.cbl
 15098             PB-SV-STATE          EQUAL   FO-STATE       AND
 15099             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15100              GO  TO 3350-EXIT.
 15101
 15102     MOVE  'N'                    TO  FORM-MASTER-SW.
 15103     MOVE  ER-1895                TO  WS-ERROR.
 15104     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15105
 15106 3350-EXIT.
 15107      EXIT.
 15108
 15109******************************************************************
 15110*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15111*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15112*   VALID FOR THE POLICY FORM USED.                              *
 15113******************************************************************
 15114
 15115 3355-EDIT-FORM-LF-BENEFITS.
 15116
 15117     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15118        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15119         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15120         GO TO   3355-EXIT.
 15121
 15122     IF  SUB6    LESS THAN   +40
 15123         ADD  +1      TO  SUB6
 15124         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15125
 15126     MOVE  ER-1896         TO  WS-ERROR.
 15127     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15128
 15129 3355-EXIT.
 15130      EXIT.
 15131
 15132******************************************************************
 15133*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15134*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15135*   VALID FOR THE POLICY FORM USED.                              *
 15136******************************************************************
 15137
 15138 3356-EDIT-FORM-AH-BENEFITS.
 15139
 15140     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15141        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15142         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15143         GO TO  3356-EXIT.
 15144
 15145      IF  SUB6    LESS THAN     +40
 15146          ADD  +1      TO  SUB6
 15147          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15148
 15149     MOVE  ER-1897         TO  WS-ERROR.
 15150     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15151
 15152 3356-EXIT.
 15153      EXIT.
 15154
 15155******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 273
* EL050.cbl
 15156*                  3357-BENEFIT-SEARCH                           *
 15157*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15158*   CANCELLATIONS ONLY.                                          *
 15159******************************************************************
 15160 3357-BENEFIT-SEARCH.
 15161     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15162         MOVE +1                          TO SUB6
 15163         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15164
 15165     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15166         MOVE +1                          TO SUB6
 15167         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15168
 15169 3357-EXIT.
 15170     EXIT.
 15171
 15172******************************************************************
 15173*                  3358-BENEFIT-LIFE-SEARCH                      *
 15174*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15175*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15176*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15177******************************************************************
 15178 3358-BENEFIT-LIFE-SEARCH.
 15179     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15180       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15181         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15182           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15183              IF FO-PLAN-REFUND-METHOD (SUB6)
 15184                     IS GREATER THAN SPACES
 15185                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15186                                          WS-LF-REFUND-CALC
 15187                 GO TO 3358-EXIT.
 15188
 15189     IF SUB6 LESS THAN +40
 15190         ADD +1                 TO SUB6
 15191         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15192
 15193 3358-EXIT.
 15194     EXIT.
 15195******************************************************************
 15196*                  3359-BENEFIT-AH-SEARCH                        *
 15197*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15198*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15199*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15200******************************************************************
 15201 3359-BENEFIT-AH-SEARCH.
 15202     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15203       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15204         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15205           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15206              IF FO-PLAN-REFUND-METHOD (SUB6)
 15207                      IS GREATER THAN SPACES
 15208                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15209                                          WS-AH-REFUND-CALC
 15210                 GO TO 3359-EXIT.
 15211
 15212     IF SUB6 LESS THAN +40
 15213         ADD +1                 TO SUB6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 274
* EL050.cbl
 15214         GO TO 3359-BENEFIT-AH-SEARCH.
 15215
 15216 3359-EXIT.
 15217     EXIT.
 15218
 15219******************************************************************
 15220*                  3360-CHECK-FORM-LIMITS                        *
 15221*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15222*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15223******************************************************************
 15224
 15225 3360-CHECK-FORM-LIMITS.
 15226
 15227     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15228         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15229
 15230     IF NOT LF-FORM-MASTER-FOUND
 15231         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15232
 15233 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15234
 15235     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15236       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15237        WS-LF-JOINT-INDICATOR = 'J'  AND
 15238        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15239         IF PB-COMPANY-ID = 'NCL'
 15240            MOVE  ER-1911          TO  WS-ERROR
 15241            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15242         ELSE
 15243            MOVE  ER-1892          TO  WS-ERROR
 15244            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15245
 15246 3360-CHECK-FORM-LF-ATT-AGE.
 15247
 15248     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15249
 15250     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15251         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15252         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15253            IF PB-COMPANY-ID = 'NCL'
 15254                MOVE  ER-1913      TO  WS-ERROR
 15255                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15256            ELSE
 15257                MOVE  ER-1894      TO  WS-ERROR
 15258                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15259
 15260 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15261
 15262     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15263         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15264         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15265            IF PB-COMPANY-ID = 'NCL'
 15266                MOVE  ER-1914      TO  WS-ERROR
 15267                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15268            ELSE
 15269                MOVE  ER-1899      TO  WS-ERROR
 15270                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15271
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 275
* EL050.cbl
 15272 3360-CHECK-FORM-LF-TERM-BAMT.
 15273
 15274     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15275         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15276         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15277           IF  PB-COMPANY-ID = 'NCL'
 15278               MOVE  ER-1916       TO  WS-ERROR
 15279               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15280           ELSE
 15281               MOVE  ER-1902       TO  WS-ERROR
 15282               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15283
 15284     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15285                                    PB-I-LF-ALT-BENEFIT-AMT.
 15286
 15287     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15288         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15289         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15290             IF  PB-COMPANY-ID = 'NCL'
 15291                 MOVE  ER-1918     TO  WS-ERROR
 15292                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15293             ELSE
 15294                 MOVE  ER-1904     TO  WS-ERROR
 15295                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15296
 15297******************************************************************
 15298*                  3360-CHECK-FORM-AH-LIMITS                     *
 15299*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15300*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15301******************************************************************
 15302
 15303 3360-CHECK-FORM-AH-LIMITS.
 15304
 15305     IF NOT AH-FORM-MASTER-FOUND
 15306         GO TO 3999-END-EDIT.
 15307
 15308 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15309
 15310     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15311       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15312        WS-AH-JOINT-INDICATOR = 'J'  AND
 15313        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15314         IF PB-COMPANY-ID = 'NCL'
 15315            MOVE  ER-1912          TO  WS-ERROR
 15316            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15317         ELSE
 15318            MOVE  ER-1893          TO  WS-ERROR
 15319            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15320
 15321 3360-CHECK-FORM-AH-ATT-AGE.
 15322
 15323     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15324
 15325     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15326         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15327         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15328            IF PB-COMPANY-ID = 'NCL'
 15329                MOVE  ER-1913      TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 276
* EL050.cbl
 15330                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15331            ELSE
 15332                MOVE  ER-1894      TO  WS-ERROR
 15333                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15334
 15335 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15336
 15337     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15338         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15339         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15340            IF PB-COMPANY-ID = 'NCL'
 15341                MOVE  ER-1915      TO  WS-ERROR
 15342                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15343            ELSE
 15344                MOVE  ER-1900      TO  WS-ERROR
 15345                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15346
 15347 3360-CHECK-FORM-AH-TERM-BAMT.
 15348
 15349     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15350         FO-AH-MAX-TERM    GREATER THAN  +0
 15351         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15352             IF  PB-COMPANY-ID = 'NCL'
 15353                 MOVE  ER-1917     TO  WS-ERROR
 15354                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15355             ELSE
 15356                  MOVE  ER-1903    TO  WS-ERROR
 15357                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15358
 15359     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15360         FO-MAX-AH-AMT    GREATER THAN  +0
 15361         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15362             IF  PB-COMPANY-ID = 'NCL'
 15363                 MOVE  ER-1919     TO  WS-ERROR
 15364                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15365             ELSE
 15366                 MOVE  ER-1905     TO  WS-ERROR
 15367                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15368
 15369     GO TO 3999-END-EDIT.
 15370
 15371******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 277
* EL050.cbl
 15373******************************************************************
 15374*                  E D I T   C A N C E L                         *
 15375******************************************************************
 15376
 15377 3700-EDIT-CANCEL.
 15378     IF PB-COMPANY-ID = 'DMD'
 15379         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15380                                         WS-RES-MUNI-TAX
 15381                                         PB-CI-STATE-TAX
 15382                                         PB-CI-MUNI-TAX
 15383         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15384
 15385*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15386*       IF PB-ENTRY-BATCH  NUMERIC
 15387*          IF PB-CANCELLATION
 15388*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15389*          ELSE
 15390*             IF PB-ISSUE
 15391*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15392
 15393     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15394        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15395     END-IF
 15396*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15397*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15398
 15399     IF CM-ENTRY-STATUS = 'V'
 15400        MOVE ER-2780             TO WS-ERROR
 15401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15402        GO TO 3999-END-EDIT.
 15403
 15404     IF CM-ENTRY-STATUS = 'D'
 15405        MOVE ER-2781             TO WS-ERROR
 15406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15407        GO TO 3999-END-EDIT.
 15408
 15409     IF CM-ENTRY-STATUS = 'U'
 15410        MOVE ER-2782             TO WS-ERROR
 15411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15412
 15413***************************************************************
 15414*                                                             *
 15415*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15416*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15417*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15418*   OF ANOTHER COVERAGE.                                      *
 15419*                                                             *
 15420***************************************************************
 15421
 15422     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15423                                    PB-C-AH-CANCEL-VOID-SW.
 15424
 15425     IF PB-C-LF-CANCEL-AMT = ZERO
 15426        NEXT SENTENCE
 15427     ELSE
 15428        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15429           AND
 15430           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 278
* EL050.cbl
 15431               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15432               MOVE ER-2745           TO WS-ERROR
 15433               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15434
 15435     IF PB-C-AH-CANCEL-AMT = ZERO
 15436        NEXT SENTENCE
 15437     ELSE
 15438        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15439           AND
 15440           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15441               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15442               MOVE ER-2745           TO WS-ERROR
 15443               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15444
 15445     IF WS-LF-EARNINGS-CALC = '4'
 15446        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15447
 15448     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15449     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15450     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15451     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15452     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15453     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15454
 15455     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15456                                      PB-C-AH-REF-CALC.
 15457     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15458
 15459******************************************************************
 15460*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15461*             TO VALIDATE COVERAGE.                              *
 15462******************************************************************
 15463
 15464     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15465        PB-C-LF-CANCEL-AMT = ZEROS
 15466          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15467      ELSE
 15468          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15469
 15470     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15471        PB-C-AH-CANCEL-AMT = ZEROS
 15472          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15473      ELSE
 15474          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15475
 15476     EVALUATE TRUE
 15477         WHEN PB-CANCEL-FORCE             OR
 15478              PB-CANCEL-DATE-FORCED       OR
 15479              PB-FORCE-OFF
 15480                  IF PB-COMPANY-ID = 'ACE'
 15481                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15482                  END-IF
 15483         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15484               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15485              (PB-COMPANY-ID = 'ACE' )
 15486                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15487         WHEN OTHER
 15488              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 279
* EL050.cbl
 15489                 MOVE ER-2794              TO WS-ERROR
 15490              ELSE
 15491                 MOVE ER-2749              TO WS-ERROR
 15492              END-IF
 15493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15494     END-EVALUATE.
 15495
 15496
 15497*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15498*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15499*            MOVE  ER-1909            TO  WS-ERROR
 15500*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15501*        ELSE
 15502*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15503
 15504     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15505     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15506        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15507     ELSE
 15508        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15509     END-IF
 15510     .
 15511 3705-EDIT-CANCEL-DT.
 15512
 15513     IF LF-COVERAGE-CANCELLED
 15514        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15515         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15516         MOVE WS-CURRENT-MONTH-END
 15517                                 TO DC-BIN-DATE-2
 15518         SET ELAPSED-BETWEEN-BIN TO TRUE
 15519*        MOVE 1                  TO DC-OPTION-CODE
 15520         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15521         IF DATE-CONVERSION-ERROR
 15522            NEXT SENTENCE
 15523          ELSE
 15524             IF DC-ELAPSED-DAYS GREATER +180
 15525                IF PB-CANCEL-DATE-FORCED  OR
 15526                   PB-CANCEL-DATE-FORCED-NO-FEE
 15527                      MOVE ER-2751  TO WS-ERROR
 15528                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15529                 ELSE
 15530                   MOVE ER-2752  TO WS-ERROR
 15531                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15532
 15533     IF AH-COVERAGE-CANCELLED
 15534        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15535         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15536         MOVE WS-CURRENT-MONTH-END
 15537                                 TO DC-BIN-DATE-2
 15538         SET ELAPSED-BETWEEN-BIN TO TRUE
 15539*        MOVE 1                  TO DC-OPTION-CODE
 15540         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15541         IF DATE-CONVERSION-ERROR
 15542            NEXT SENTENCE
 15543          ELSE
 15544             IF DC-ELAPSED-DAYS GREATER +180
 15545                IF PB-CANCEL-DATE-FORCED OR
 15546                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 280
* EL050.cbl
 15547                      MOVE ER-2751  TO WS-ERROR
 15548                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15549                 ELSE
 15550                   MOVE ER-2752  TO WS-ERROR
 15551                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15552
 15553     IF WS-ERROR = ER-2752
 15554        AND (PB-COMPANY-ID = 'ABL'
 15555         OR  PB-COMPANY-ID = 'FGL'
 15556         OR  PB-COMPANY-ID = 'IST'
 15557         OR  PB-COMPANY-ID = 'JHL'
 15558         OR  PB-COMPANY-ID = 'LAP'
 15559         OR  PB-COMPANY-ID = 'LBL'
 15560         OR  PB-COMPANY-ID = 'NCB'
 15561         OR  PB-COMPANY-ID = 'NLI'
 15562         OR  PB-COMPANY-ID = 'OFI'
 15563         OR  PB-COMPANY-ID = 'PLI'
 15564         OR  PB-COMPANY-ID = 'TAO'
 15565         OR  PB-COMPANY-ID = 'TIC'
 15566         OR  PB-COMPANY-ID = 'HER'
 15567         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15568         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15569            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15570            MOVE ER-2762     TO WS-ERROR
 15571            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15572
 15573     IF LF-COVERAGE-CANCELLED
 15574        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15575        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15576             MOVE ER-2733         TO WS-ERROR
 15577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15578
 15579     IF AH-COVERAGE-CANCELLED
 15580        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15581        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15582              MOVE ER-2733        TO WS-ERROR
 15583              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15584
 15585     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15586        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15587        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15588           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15589            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15590              IF PB-COMPANY-ID NOT = 'LAP'
 15591               MOVE ER-2704            TO WS-ERROR
 15592               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15593
 15594     IF CERT-WAS-NOT-FOUND
 15595         GO TO 3999-END-EDIT.
 15596
 15597     IF PB-COMPANY-ID EQUAL 'CDC'
 15598        IF LF-COVERAGE-CANCELLED
 15599           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15600            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15601            MOVE PB-C-LF-CANCEL-DT
 15602                                 TO DC-BIN-DATE-2
 15603            SET ELAPSED-BETWEEN-BIN TO TRUE
 15604*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 281
* EL050.cbl
 15605            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15606            IF DATE-CONVERSION-ERROR
 15607               NEXT SENTENCE
 15608             ELSE
 15609                IF DC-ELAPSED-DAYS GREATER +60
 15610                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15611
 15612     IF PB-COMPANY-ID EQUAL 'CDC'
 15613        IF AH-COVERAGE-CANCELLED
 15614           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15615            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15616            MOVE PB-C-AH-CANCEL-DT
 15617                                 TO DC-BIN-DATE-2
 15618            MOVE +0              TO DC-ELAPSED-DAYS
 15619                                    DC-ELAPSED-MONTHS
 15620            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15621*           MOVE 1               TO DC-OPTION-CODE
 15622            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15623            IF DATE-CONVERSION-ERROR
 15624               NEXT SENTENCE
 15625             ELSE
 15626                IF DC-ELAPSED-DAYS GREATER +60
 15627                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15628
 15629     MOVE +0                     TO DC-ELAPSED-DAYS
 15630                                    DC-ELAPSED-MONTHS.
 15631
 15632     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15633        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15634          MOVE 'Z'                TO PB-CI-OB-FLAG
 15635          MOVE ER-2767            TO WS-ERROR
 15636          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15637          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15638          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15639          GO TO 3775-OVER-REF-CHK
 15640        ELSE
 15641          MOVE ZEROS              TO PB-CI-LIVES
 15642                                     PB-C-LIVES
 15643          IF PB-CI-OB-FLAG NOT = 'B'
 15644             MOVE SPACE           TO PB-CI-OB-FLAG.
 15645
 15646     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15647         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15648     ELSE
 15649         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15650
 15651     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15652        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15653            MOVE ER-2760         TO WS-ERROR
 15654            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15655
 15656     IF LF-COVERAGE-CANCELLED
 15657        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15658         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15659            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15660               MOVE ER-2774       TO WS-ERROR
 15661               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15662
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 282
* EL050.cbl
 15663     IF AH-COVERAGE-CANCELLED
 15664        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15665         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15666            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15667               MOVE ER-2775       TO WS-ERROR
 15668               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15669
 15670     IF LF-COVERAGE-CANCELLED
 15671        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15672         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15673            MOVE ER-2776         TO WS-ERROR
 15674            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15675
 15676     IF AH-COVERAGE-CANCELLED
 15677        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15678         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15679            MOVE ER-2777         TO WS-ERROR
 15680            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15681
 15682     IF LF-COVERAGE-CANCELLED
 15683        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15684        if pb-ci-lf-expire-dt = low-values or spaces
 15685           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15686           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15687           MOVE PB-CI-EXTENTION-DAYS
 15688                                 TO DC-ELAPSED-DAYS
 15689           SET BIN-PLUS-ELAPSED  TO TRUE
 15690           PERFORM 8500-DATE-CONVERT
 15691                                 THRU 8500-EXIT
 15692           IF DATE-CONVERSION-ERROR
 15693              move low-values    to dc-bin-date-2
 15694           end-if
 15695        else
 15696           move pb-ci-lf-expire-dt
 15697                                 to dc-bin-date-2
 15698        end-if
 15699        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15700           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15701                             OR  'FIA'
 15702              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15703           ELSE
 15704              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15705              MOVE ER-2731       TO WS-ERROR
 15706              PERFORM 9900-ERROR-FORMAT
 15707                                 THRU 9900-EXIT
 15708           end-if
 15709        end-if
 15710     end-if
 15711*    IF LF-COVERAGE-CANCELLED
 15712*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15713*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15714*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15715*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15716*        SET BIN-PLUS-ELAPSED      TO TRUE
 15717*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15718*        IF DATE-CONVERSION-ERROR
 15719*           NEXT SENTENCE
 15720*         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 283
* EL050.cbl
 15721*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15722*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15723*                            OR  'FIA'
 15724*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15725*              ELSE
 15726*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15727*               MOVE ER-2731       TO WS-ERROR
 15728*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15729     .
 15730 3705-EDIT-AH-CANCEL-DT.
 15731     IF AH-COVERAGE-CANCELLED
 15732        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15733        if pb-ci-AH-expire-dt = low-values or spaces
 15734           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15735           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15736           MOVE PB-CI-EXTENTION-DAYS
 15737                                 TO DC-ELAPSED-DAYS
 15738           SET BIN-PLUS-ELAPSED  TO TRUE
 15739           PERFORM 8500-DATE-CONVERT
 15740                                 THRU 8500-EXIT
 15741           IF DATE-CONVERSION-ERROR
 15742              move low-values    to dc-bin-date-2
 15743           end-if
 15744        else
 15745           move pb-ci-ah-expire-dt
 15746                                 to dc-bin-date-2
 15747        end-if
 15748        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15749           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15750                             OR  'FIA'
 15751              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15752           ELSE
 15753              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15754              MOVE ER-2771       TO WS-ERROR
 15755              PERFORM 9900-ERROR-FORMAT
 15756                                 THRU 9900-EXIT
 15757           end-if
 15758        end-if
 15759     end-if
 15760*    IF AH-COVERAGE-CANCELLED
 15761*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15762*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15763*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15764*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15765**       MOVE 6                    TO DC-OPTION-CODE
 15766*        SET BIN-PLUS-ELAPSED      TO TRUE
 15767*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15768*        IF DATE-CONVERSION-ERROR
 15769*           NEXT SENTENCE
 15770*         ELSE
 15771*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15772*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15773*                             OR 'FIA'
 15774*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15775*             ELSE
 15776*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15777*              MOVE ER-2771       TO WS-ERROR
 15778*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 284
* EL050.cbl
 15779     .
 15780 3705-EDIT-CONTINUED.
 15781
 15782*    IF LF-COVERAGE-CANCELLED
 15783*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15784*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15785*            MOVE ER-2727         TO WS-ERROR
 15786*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15787*
 15788*    IF AH-COVERAGE-CANCELLED
 15789*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15790*        IF PB-COMPANY-ID = 'ACE'
 15791*           MOVE ER-2727        TO WS-ERROR
 15792*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15793*        ELSE
 15794*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15795*              MOVE ER-2727     TO WS-ERROR
 15796*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15797
 15798     IF PB-COMPANY-ID = 'ACE'
 15799       IF AH-COVERAGE-CANCELLED
 15800         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15801           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15802              MOVE ER-2732      TO WS-ERROR
 15803              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15804
 15805     IF PB-COMPANY-ID      EQUAL   'HER'
 15806        IF WS-ERROR        EQUAL   ER-2727
 15807            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15808            MOVE  ER-2725          TO  WS-ERROR
 15809            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15810
 15811     IF PB-C-CLAIM-CREATED-CANCEL
 15812            MOVE ER-2748         TO WS-ERROR
 15813            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15814
 15815     IF PB-C-LAST-NAME NOT = SPACES
 15816         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15817            MOVE ER-2747         TO WS-ERROR
 15818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15819
 15820 3710-EDIT-LUMP-SUM-PRIOR.
 15821
 15822     IF AH-COVERAGE-CANCELLED
 15823         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15824             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15825                MOVE ER-2735    TO WS-ERROR
 15826                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15827
 15828     IF LF-COVERAGE-CANCELLED
 15829         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15830             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15831                MOVE ER-2735    TO WS-ERROR
 15832                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15833
 15834 3710-EDIT-PRIOR-DEATH.
 15835
 15836*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 285
* EL050.cbl
 15837*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15838*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15839*           (NOT PB-CI-OB)
 15840*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15841*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15842*                   MOVE ER-2732  TO WS-ERROR
 15843*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15844*
 15845*    IF AH-COVERAGE-CANCELLED
 15846*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15847*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15848*           (NOT PB-CI-OB)
 15849*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15850*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15851*                   MOVE ER-2732  TO WS-ERROR
 15852*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15853
 15854     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15855         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15856            (NOT PB-COMP-LF-CANCEL)
 15857             NEXT SENTENCE
 15858         ELSE
 15859           IF PB-C-LF-CANCEL-VOIDED
 15860              NEXT SENTENCE
 15861           ELSE
 15862              MOVE ER-2753      TO WS-ERROR
 15863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15864
 15865     IF CANCEL-FUTURE-DT
 15866         GO TO 3999-END-EDIT.
 15867
 15868 3715-GET-REMAIN-TERM-LF.
 15869
 15870     IF NO-LF-BENEFIT-MATCH  OR
 15871        WS-LF-BENEFIT-CD = ZEROS
 15872        GO TO 3730-GET-AH-REMAIN-TERM.
 15873
 15874     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15875     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15876     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15877     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15878     MOVE PB-SV-STATE            TO CP-STATE.
 15879     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15880     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15881     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15882     MOVE '2'                    TO CP-PROCESS-TYPE.
 15883     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15884     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15885     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15886     IF (PB-COMPANY-ID = 'CID')
 15887        AND (CP-STATE-STD-ABBRV = 'WI')
 15888        MOVE '7'                 TO CP-REM-TERM-METHOD
 15889        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15890     ELSE
 15891        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15892        MOVE WS-REM-TRM-CALC-OPTION
 15893                                 TO CP-REM-TRM-CALC-OPTION
 15894     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 286
* EL050.cbl
 15895**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15896     IF (PB-COMPANY-ID = 'CID')
 15897        AND (CP-STATE-STD-ABBRV = 'MO')
 15898        AND (PB-CERT-EFF-DT >= X'9B41')
 15899        AND (PB-CERT-EFF-DT <= X'A2FB')
 15900        MOVE '7'                 TO CP-REM-TERM-METHOD
 15901        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15902     END-IF
 15903     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15904                                    CP-LOAN-TERM.
 15905     IF CP-TRUNCATED-LIFE
 15906        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15907
 15908     IF CP-TERM-IS-DAYS
 15909         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15910     ELSE
 15911         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15912
 15913     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15914
 15915     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15916
 15917     IF LF-COVERAGE-CANCELLED
 15918        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15919        NEXT SENTENCE
 15920      ELSE
 15921          GO TO 3730-GET-AH-REMAIN-TERM.
 15922
 15923 3720-GET-LF-REFUND.
 15924
 15925     IF PB-C-LF-CANCEL-VOIDED
 15926        GO TO 3730-GET-AH-REMAIN-TERM
 15927     end-if
 15928
 15929     IF PB-COMPANY-ID EQUAL 'BOA'
 15930         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15931         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15932         GO TO 3730-GET-AH-REMAIN-TERM.
 15933
 15934     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15935        (WS-AH-SPECIAL-CALC-CD = 'M')
 15936         MOVE ER-2767            TO WS-ERROR
 15937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15938         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15939         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15940         GO TO 3780-UPDATE-CANCEL-CERT.
 15941
 15942*    if (ws-lf-earnings-calc = '6')
 15943*       or (pb-c-lf-refund-override = '6')
 15944*       move cp-remaining-term-1 to cp-remaining-term-2
 15945*    end-if
 15946     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15947
 15948     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15949     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15950     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15951     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15952     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 287
* EL050.cbl
 15953     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15954     IF (PB-COMPANY-ID = 'DCC')
 15955        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15956        IF PDEF-MASTER-FOUND
 15957           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15958              (V1 > +8)
 15959              OR (PD-PROD-CODE (V1) = 'L')
 15960           END-PERFORM
 15961           IF V1 < +9
 15962              MOVE PD-MAX-AMT (V1)
 15963                           TO CP-R-MAX-TOT-BEN
 15964                              EC-AM-LF-MAX-TOT-BEN
 15965           END-IF
 15966        ELSE
 15967        MOVE ' '                 TO PDEF-MASTER-SW
 15968        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15969        MOVE PB-STATE            TO ERPDEF-STATE
 15970        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15971        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15972        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15973        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15974        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15975        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15976        IF PDEF-MASTER-FOUND
 15977           MOVE 'N'              TO PDEF-MASTER-SW
 15978           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15979           IF PDEF-MASTER-FOUND
 15980              IF (ERPDEF-KEY-SAVE (1:16) =
 15981                           PD-CONTROL-PRIMARY (1:16))
 15982                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15983                 CONTINUE
 15984              ELSE
 15985                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15986                 IF (ERPDEF-KEY-SAVE (1:16) =
 15987                           PD-CONTROL-PRIMARY (1:16))
 15988                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15989                    CONTINUE
 15990                 ELSE
 15991                    MOVE 'N'     TO PDEF-MASTER-SW
 15992                 END-IF
 15993              END-IF
 15994
 15995              IF PDEF-MASTER-FOUND
 15996                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15997                    (V1 > +8)
 15998                    OR (PD-PROD-CODE (V1) = 'L')
 15999                 END-PERFORM
 16000                 IF V1 < +9
 16001                    MOVE PD-MAX-AMT (V1)
 16002                                 TO CP-R-MAX-TOT-BEN
 16003                                    EC-AM-LF-MAX-TOT-BEN
 16004                 END-IF
 16005              END-IF
 16006           END-IF
 16007           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16008        END-IF
 16009        END-IF
 16010     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 288
* EL050.cbl
 16011     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16012
 16013     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16014
 16015     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16016                                    PB-C-LF-REM-TERM.
 16017
 16018     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16019     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16020
 16021     IF PB-COMPANY-ID EQUAL 'FLC'
 16022        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16023           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16024           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16025                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16026                    - CM-LF-ITD-DEATH-AMT
 16027           IF PB-C-LF-REF-CALC LESS THAN +0
 16028              MOVE +0            TO PB-C-LF-REF-CALC
 16029              GO TO 3730-GET-AH-REMAIN-TERM
 16030           ELSE
 16031              GO TO 3730-GET-AH-REMAIN-TERM.
 16032
 16033     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16034                            OR '4' OR '5' OR '6' OR '8'
 16035                            OR '9' OR 'G'
 16036        MOVE PB-C-LF-REFUND-OVERRIDE
 16037                                 TO CP-EARNING-METHOD.
 16038
 16039     if pb-company-id = 'AHL'
 16040        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16041        if cp-class-code = spaces
 16042           move zeros            to cp-class-code
 16043        end-if
 16044     ELSE
 16045        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16046     END-IF
 16047*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16048     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16049     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16050                                    CP-RATING-BENEFIT-AMT.
 16051     IF CP-STATE-STD-ABBRV = 'OR'
 16052         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16053                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16054     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16055     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16056     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16057     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16058     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16059     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16060     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16061     IF WS-DEFAULT-APR NOT NUMERIC
 16062         MOVE ZEROS TO WS-DEFAULT-APR.
 16063****   N O T E   ****
 16064*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16065*      THE OH HARD CODING IN ELCRFNDP
 16066
 16067     IF PB-COMPANY-ID = 'CID'
 16068        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 289
* EL050.cbl
 16069           MOVE WS-LF-EARNINGS-CALC
 16070                                 TO CP-EARNING-METHOD
 16071        END-IF
 16072     END-IF
 16073
 16074****   N O T E   ****
 16075
 16076     IF CP-EARN-AS-NET-PAY
 16077         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16078            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16079                MOVE WS-DEFAULT-APR
 16080                                 TO  CP-LOAN-APR
 16081                MOVE ER-3780     TO  WS-ERROR
 16082                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16083            ELSE
 16084                MOVE ER-3781     TO  WS-ERROR
 16085                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16086*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16087     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16088
 16089     IF CP-REFUND-TYPE-USED NOT = SPACE
 16090         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16091
 16092     IF CP-ERROR-RATE-IS-ZERO OR
 16093        CP-ERROR-RATE-NOT-FOUND
 16094        MOVE ER-2740             TO WS-ERROR
 16095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16096
 16097     IF CP-ERROR-RATE-FILE-NOTOPEN
 16098        MOVE ER-2617             TO WS-ERROR
 16099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16100
 16101     IF PB-COMPANY-ID = 'DCC'
 16102        AND PB-CI-ENTRY-STATUS = 'M'
 16103        MOVE +0                  TO PB-C-LF-REF-CALC
 16104     ELSE
 16105        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16106     END-IF
 16107
 16108     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16109         GO TO 3730-GET-AH-REMAIN-TERM.
 16110
 16111*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16112*       ADD +1                   TO PB-C-LF-REM-TERM
 16113*                                   CP-REMAINING-TERM
 16114*                                   CP-ORIGINAL-TERM.
 16115
 16116     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16117     MOVE '2'                    TO CP-EARNING-METHOD
 16118                                    CP-RATING-METHOD.
 16119     IF PB-COMPANY-ID = 'CID'
 16120        IF (CP-STATE-STD-ABBRV = 'MN')
 16121           AND (PB-CERT-EFF-DT > X'A4FF')
 16122           AND (WS-LF-EARNINGS-CALC = 'B')
 16123           MOVE '5'              TO CP-EARNING-METHOD
 16124           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16125        END-IF
 16126     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 290
* EL050.cbl
 16127     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16128                                        CP-REMAINING-BENEFIT
 16129                                        CP-RATING-BENEFIT-AMT.
 16130     IF CP-STATE-STD-ABBRV = 'OR'
 16131         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16132                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16133     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16134     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16135
 16136     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16137
 16138     IF CP-ERROR-RATE-IS-ZERO OR
 16139        CP-ERROR-RATE-NOT-FOUND
 16140        MOVE ER-2740             TO WS-ERROR
 16141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16142
 16143     IF CP-ERROR-RATE-FILE-NOTOPEN
 16144        MOVE ER-2617             TO WS-ERROR
 16145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16146
 16147     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16148
 16149******************************************************************
 16150
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 291
* EL050.cbl
 16152 3730-GET-AH-REMAIN-TERM.
 16153     IF NO-AH-BENEFIT-MATCH  OR
 16154        WS-AH-BENEFIT-CD = ZEROS
 16155         GO TO 3770-CHECK-REFUNDS.
 16156
 16157     IF PB-CI-AH-LUMP-SUM-DISAB
 16158         IF  PB-C-AH-CANCEL-AMT = ZERO
 16159            IF NOT PB-COMP-AH-CANCEL
 16160             GO TO 3770-CHECK-REFUNDS.
 16161
 16162     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16163     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16164     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16165     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16166     MOVE PB-SV-STATE            TO CP-STATE.
 16167     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16168     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16169     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16170     MOVE '2'                    TO CP-PROCESS-TYPE.
 16171     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16172     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16173     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16174     IF (PB-COMPANY-ID = 'CID')
 16175        AND (CP-STATE-STD-ABBRV = 'WI')
 16176        MOVE '7'                 TO CP-REM-TERM-METHOD
 16177        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16178     ELSE
 16179        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16180        MOVE WS-REM-TRM-CALC-OPTION
 16181                                 TO CP-REM-TRM-CALC-OPTION
 16182     END-IF
 16183     IF (PB-COMPANY-ID = 'CID')
 16184        AND (CP-STATE-STD-ABBRV = 'MO')
 16185        AND (PB-CERT-EFF-DT >= X'9B41')
 16186        AND (PB-CERT-EFF-DT <= X'A2FB')
 16187        MOVE '7'                 TO CP-REM-TERM-METHOD
 16188        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16189     END-IF
 16190     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16191                                    CP-LOAN-TERM.
 16192     IF NOT CP-TERM-IS-DAYS
 16193         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16194
 16195     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16196
 16197     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16198
 16199     IF AH-COVERAGE-CANCELLED
 16200        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16201        NEXT SENTENCE
 16202      ELSE
 16203         GO TO 3770-CHECK-REFUNDS.
 16204
 16205 3740-GET-AH-REFUND.
 16206
 16207     IF PB-C-AH-CANCEL-VOIDED
 16208        GO TO 3780-UPDATE-CANCEL-CERT
 16209     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 292
* EL050.cbl
 16210
 16211     IF PB-COMPANY-ID = 'BOA'
 16212         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16213         GO TO 3770-CHECK-REFUNDS.
 16214
 16215     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16216*    MOVE ' '                    TO DC-OPTION-CODE
 16217     SET BIN-TO-GREG             TO TRUE
 16218     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16219     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16220                                    PB-C-AH-REM-TERM.
 16221     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16222     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16223
 16224     IF PB-COMPANY-ID EQUAL 'FLC'
 16225        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16226           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16227           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16228                    - CM-AH-ITD-AH-PMT)
 16229           IF PB-C-AH-REF-CALC LESS THAN +0
 16230              MOVE +0            TO PB-C-AH-REF-CALC
 16231              GO TO 3770-CHECK-REFUNDS
 16232           ELSE
 16233              GO TO 3770-CHECK-REFUNDS.
 16234
 16235     IF PB-COMPANY-ID = 'DCC'
 16236        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16237            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16238           MOVE 'S'              TO CP-EARNING-METHOD
 16239        END-IF
 16240     END-IF
 16241     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16242                            OR '4' OR '5' OR '6' OR '8'
 16243                            OR '9' OR 'G' OR 'S'
 16244        MOVE PB-C-AH-REFUND-OVERRIDE
 16245                                 TO CP-EARNING-METHOD.
 16246
 16247     if pb-company-id = 'AHL'
 16248        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16249        if cp-class-code = spaces
 16250           move zeros            to cp-class-code
 16251        end-if
 16252     ELSE
 16253        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16254     END-IF
 16255*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16256     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16257     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16258                                    CP-RATING-BENEFIT-AMT.
 16259     IF CP-STATE-STD-ABBRV = 'OR'
 16260         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16261                                         PB-CI-AH-TERM.
 16262     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16263     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16264     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16265     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16266     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16267     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 293
* EL050.cbl
 16268
 16269     IF CP-STATE-STD-ABBRV = 'OH'
 16270        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16271                                AND 'CID' AND 'DCC' AND 'AHL')
 16272           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16273              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16274              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16275              MOVE '6' TO CP-EARNING-METHOD
 16276           END-IF
 16277        END-IF
 16278        IF PB-COMPANY-ID = 'CID'
 16279           IF NO-LIFE-COVERAGE
 16280              IF CP-CRITICAL-PERIOD
 16281                 MOVE '2'       TO CP-EARNING-METHOD
 16282              ELSE
 16283                 MOVE '6'       TO CP-EARNING-METHOD
 16284              END-IF
 16285           ELSE
 16286              IF WS-LF-COVERAGE-TYPE = 'L'
 16287                 MOVE '2'       TO CP-EARNING-METHOD
 16288              ELSE
 16289                 IF (PB-CI-LF-TERM > +60) OR
 16290                    (WS-LF-EARNINGS-CALC = '5')
 16291                    IF CP-CRITICAL-PERIOD
 16292                       MOVE '2'  TO CP-EARNING-METHOD
 16293                    ELSE
 16294                       MOVE '6'  TO CP-EARNING-METHOD
 16295                    END-IF
 16296                 ELSE
 16297                    MOVE '1'     TO CP-EARNING-METHOD
 16298                 END-IF
 16299              END-IF
 16300           END-IF
 16301        END-IF
 16302     END-IF
 16303
 16304*    IF CP-STATE-STD-ABBRV = 'VA'
 16305*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16306*          IF CP-ORIGINAL-TERM GREATER 61
 16307*             MOVE '6' TO CP-EARNING-METHOD
 16308*          ELSE
 16309*             MOVE '1' TO CP-EARNING-METHOD.
 16310
 16311     IF WS-DEFAULT-APR NOT NUMERIC
 16312         MOVE ZEROS TO WS-DEFAULT-APR.
 16313     IF CP-EARN-AS-NET-PAY
 16314         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16315            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16316                MOVE WS-DEFAULT-APR
 16317                                 TO  CP-LOAN-APR
 16318                MOVE ER-3780     TO  WS-ERROR
 16319                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16320            ELSE
 16321                MOVE ER-3781     TO  WS-ERROR
 16322                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16323     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16324     IF PB-COMPANY-ID = 'DCC'
 16325        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 294
* EL050.cbl
 16326        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16327        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16328     END-IF
 16329     IF PB-COMPANY-ID = 'DCC'
 16330        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16331        AND (CP-EARNING-METHOD = 'D')
 16332        AND (CP-CANCEL-REASON NOT = 'R')
 16333        CONTINUE
 16334     ELSE
 16335        GO TO 3750-CONTINUE
 16336     END-IF
 16337     MOVE ' '                    TO DD-IU-SW
 16338     IF NOT PDEF-MASTER-FOUND
 16339        MOVE ' '                 TO PDEF-MASTER-SW
 16340        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16341        MOVE PB-STATE            TO ERPDEF-STATE
 16342        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16343        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16344        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16345        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16346        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16347        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16348        IF PDEF-MASTER-FOUND
 16349           MOVE 'N'              TO PDEF-MASTER-SW
 16350           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16351           IF PDEF-MASTER-FOUND
 16352              IF (ERPDEF-KEY-SAVE (1:16) =
 16353                           PD-CONTROL-PRIMARY (1:16))
 16354                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16355                 CONTINUE
 16356              ELSE
 16357                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16358                 IF (ERPDEF-KEY-SAVE (1:16) =
 16359                           PD-CONTROL-PRIMARY (1:16))
 16360                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16361                    CONTINUE
 16362                 ELSE
 16363                    MOVE ER-2740 TO WS-ERROR
 16364                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16365                    GO TO 3770-CHECK-REFUNDS
 16366                 END-IF
 16367              END-IF
 16368           END-IF
 16369           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16370        END-IF
 16371     END-IF
 16372     IF PDEF-MASTER-FOUND
 16373        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16374           (V1 > +8)
 16375           OR (PD-PROD-CODE (V1) = 'I')
 16376        END-PERFORM
 16377        IF V1 < +9
 16378           SET DD-IU-PRESENT        TO TRUE
 16379        END-IF
 16380        IF WS-AH-DCC-TRUNC = 'T'
 16381           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16382        ELSE
 16383           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 295
* EL050.cbl
 16384        END-IF
 16385        EVALUATE TRUE
 16386           WHEN WS-TERM > +168
 16387              MOVE 15               TO V1
 16388           WHEN WS-TERM > +156
 16389              MOVE 14               TO V1
 16390           WHEN WS-TERM > +144
 16391              MOVE 13               TO V1
 16392           WHEN WS-TERM > +132
 16393              MOVE 12               TO V1
 16394           WHEN WS-TERM > +120
 16395              MOVE 11               TO V1
 16396           WHEN WS-TERM > +108
 16397              MOVE 10               TO V1
 16398           WHEN WS-TERM > +96
 16399              MOVE 9                TO V1
 16400           WHEN WS-TERM > +84
 16401              MOVE 8                TO V1
 16402           WHEN WS-TERM > +72
 16403              MOVE 7                TO V1
 16404           WHEN WS-TERM > +60
 16405              MOVE 6                TO V1
 16406           WHEN WS-TERM > +48
 16407              MOVE 5                TO V1
 16408           WHEN WS-TERM > +36
 16409              MOVE 4                TO V1
 16410           WHEN WS-TERM > +24
 16411              MOVE 3                TO V1
 16412           WHEN WS-TERM > +12
 16413              MOVE 2                TO V1
 16414           WHEN OTHER
 16415              MOVE 1                TO V1
 16416        END-EVALUATE
 16417
 16418        EVALUATE TRUE
 16419*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16420*             < +13)
 16421*             AND (DD-IU-PRESENT)
 16422*             MOVE 2                TO V2
 16423*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16424*             MOVE 1                TO V2
 16425           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16426              MOVE 2                TO V2
 16427           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16428              MOVE 3                TO V2
 16429           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16430              MOVE 4                TO V2
 16431           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16432              MOVE 5                TO V2
 16433           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16434              MOVE 6                TO V2
 16435           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16436              MOVE 7                TO V2
 16437           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16438              MOVE 8                TO V2
 16439           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16440              MOVE 9                TO V2
 16441           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 296
* EL050.cbl
 16442              MOVE 10               TO V2
 16443           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16444              MOVE 11               TO V2
 16445           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16446              MOVE 12               TO V2
 16447           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16448              MOVE 13               TO V2
 16449           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16450              MOVE 14               TO V2
 16451           WHEN OTHER
 16452              MOVE 15               TO V2
 16453        END-EVALUATE
 16454
 16455        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16456                                 TO CP-DDF-LO-FACT
 16457        MOVE PD-UEP-FACTOR (V1 V2)
 16458                                 TO CP-DDF-HI-FACT
 16459
 16460        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16461        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16462        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16463           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16464        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16465        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16466        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16467           + PD-1ST-YR-ADMIN-ALLOW
 16468
 16469        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16470*       IF PI-CLP-YN = 'Y'
 16471*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16472*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16473*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16474*       END-IF
 16475
 16476        IF DD-IU-PRESENT
 16477           MOVE 'I'              TO CP-EARNING-METHOD
 16478        END-IF
 16479        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16480                                     CP-CLP-RATE-UP
 16481        IF CP-IU-RATE-UP NOT = ZEROS
 16482           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16483              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16484           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16485              / (1 - WS-WORK-FACT)
 16486        END-IF
 16487     END-IF
 16488     .
 16489 3750-CONTINUE.
 16490     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16491
 16492     IF CP-REFUND-TYPE-USED NOT = SPACE
 16493         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16494
 16495     IF CP-ERROR-RATE-IS-ZERO OR
 16496        CP-ERROR-RATE-NOT-FOUND
 16497        MOVE ER-2740             TO WS-ERROR
 16498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16499
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 297
* EL050.cbl
 16500     IF CP-ERROR-RATE-FILE-NOTOPEN
 16501        MOVE ER-2617             TO WS-ERROR
 16502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16503     IF PB-COMPANY-ID = 'DCC'
 16504        AND PB-CI-ENTRY-STATUS = 'M'
 16505        MOVE +0                  TO PB-C-AH-REF-CALC
 16506     ELSE
 16507        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16508     END-IF
 16509     IF PB-COMPANY-ID = 'DCC'
 16510        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16511        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16512        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16513        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16514        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16515        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16516        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16517        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16518*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16519     END-IF
 16520     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 298
* EL050.cbl
 16522
 16523 3770-CHECK-REFUNDS.
 16524
 16525     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16526        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16527           MOVE ER-2766          TO WS-ERROR
 16528           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16529           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16530           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16531              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16532
 16533     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16534        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16535           MOVE ER-2766          TO WS-ERROR
 16536           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16537           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16538           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16539              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16540
 16541     IF PB-COMP-LF-CANCEL
 16542        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16543        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16544           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16545              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16546
 16547     IF PB-COMP-AH-CANCEL
 16548        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16549        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16550           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16551              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16552
 16553     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16554             GIVING WS-UNSIGN-WRK1
 16555     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16556             GIVING WS-UNSIGN-WRK2.
 16557
 16558     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16559         MOVE ZERO TO WS-UNSIGN-WRK1.
 16560
 16561     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16562         MOVE ZERO TO WS-UNSIGN-WRK2.
 16563
 16564     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16565
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 299
* EL050.cbl
 16567
 16568 3772-CONTINUE.
 16569
 16570**********************************
 16571*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16572*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16573*** DOUBLES THE TOLERANCE AMOUNT.
 16574***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16575**********************************
 16576     IF PB-COMPANY-ID = 'MON'
 16577     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16578         IF WS-REF-REJECT-SW = SPACE
 16579             MOVE ER-2754        TO WS-ERROR
 16580             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16581           ELSE
 16582             MOVE ER-2736        TO WS-ERROR
 16583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16584**********************************
 16585
 16586 3773-CONTINUE.
 16587
 16588     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16589        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16590           MOVE ER-2723          TO WS-ERROR
 16591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16592
 16593     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16594        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16595           MOVE ER-2724          TO WS-ERROR
 16596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16597
 16598     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16599         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16600             (1 + WS-LF-REFUND-OVS-PCT)
 16601     ELSE
 16602         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16603
 16604     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16605         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16606             (1 - WS-TOL-LF-REFUND-PCT)
 16607     ELSE
 16608         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16609
 16610     IF (PB-COMPANY-ID = 'DCC')
 16611        AND (PB-CI-ENTRY-STATUS = 'M')
 16612        AND (PB-C-LF-CANCEL-AMT > +0)
 16613        MOVE ER-3843             TO WS-ERROR
 16614        PERFORM 9900-ERROR-FORMAT
 16615                                 THRU 9900-EXIT
 16616     END-IF
 16617     EVALUATE TRUE
 16618        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16619           CONTINUE
 16620        WHEN PB-C-LF-CANCEL-AMT = +0
 16621                 AND PB-C-LF-REF-CALC > +0
 16622           CONTINUE
 16623        WHEN WS-LF-REFUND-OVS-AMT = 0
 16624                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 300
* EL050.cbl
 16625           CONTINUE
 16626        WHEN OTHER
 16627           IF WS-TOL-LF-REFUND  = +0
 16628              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16629           END-IF
 16630           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16631                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16632                          (PB-C-LF-CANCEL-AMT))
 16633              CONTINUE
 16634           ELSE
 16635              IF WS-LF-REFUND-OVS-AMT = +0
 16636                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16637              END-IF
 16638              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16639                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16640                                       PB-C-LF-CANCEL-AMT)
 16641                 CONTINUE
 16642              ELSE
 16643                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16644                   MOVE ER-2754   TO  WS-ERROR
 16645                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16646                 ELSE
 16647                    MOVE ER-2736   TO  WS-ERROR
 16648                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16649                 END-IF
 16650              END-IF
 16651           END-IF
 16652     END-EVALUATE.
 16653
 16654     EVALUATE TRUE
 16655        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16656           CONTINUE
 16657        WHEN PB-C-LF-CANCEL-AMT = +0
 16658                 AND PB-C-LF-REF-CALC > +0
 16659           CONTINUE
 16660        WHEN OTHER
 16661           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16662               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16663              CONTINUE
 16664           ELSE
 16665              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16666               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16667                CONTINUE
 16668              ELSE
 16669                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16670                     MOVE ER-2754   TO  WS-ERROR
 16671                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16672                 ELSE
 16673                     MOVE ER-2736   TO  WS-ERROR
 16674                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16675                 END-IF
 16676              END-IF
 16677           END-IF
 16678     END-EVALUATE.
 16679
 16680     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16681         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16682             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 301
* EL050.cbl
 16683     ELSE
 16684         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16685
 16686     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16687         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16688             (1 - WS-TOL-AH-REFUND-PCT)
 16689     ELSE
 16690         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16691
 16692     IF (PB-COMPANY-ID = 'DCC')
 16693        AND (PB-CI-ENTRY-STATUS = 'M')
 16694        AND (PB-C-AH-CANCEL-AMT > +0)
 16695        MOVE ER-3843             TO WS-ERROR
 16696        PERFORM 9900-ERROR-FORMAT
 16697                                 THRU 9900-EXIT
 16698     END-IF
 16699     EVALUATE TRUE
 16700        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16701           CONTINUE
 16702*       WHEN PB-C-AH-REF-CALC = +0 AND
 16703*                  PB-C-AH-CANCEL-AMT > +0
 16704        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16705                   PB-C-AH-REF-CALC > +0
 16706           CONTINUE
 16707        WHEN WS-AH-REFUND-OVS-AMT = +0
 16708                AND WS-TOL-AH-REFUND = +0
 16709           CONTINUE
 16710        WHEN OTHER
 16711           IF WS-TOL-AH-REFUND = +0
 16712              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16713           END-IF
 16714           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16715               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16716                                         PB-C-AH-CANCEL-AMT)
 16717              CONTINUE
 16718           ELSE
 16719              IF WS-AH-REFUND-OVS-AMT = +0
 16720                 MOVE +9999999.99 TO
 16721                         WS-AH-REFUND-OVS-AMT
 16722              END-IF
 16723              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16724                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16725                                         PB-C-AH-CANCEL-AMT)
 16726                 CONTINUE
 16727              ELSE
 16728                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16729                    MOVE ER-2754   TO  WS-ERROR
 16730                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16731                 ELSE
 16732                    MOVE ER-2736   TO  WS-ERROR
 16733                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16734                 END-IF
 16735              END-IF
 16736           END-IF
 16737     END-EVALUATE.
 16738
 16739     EVALUATE TRUE
 16740        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 302
* EL050.cbl
 16741           CONTINUE
 16742*       WHEN PB-C-AH-REF-CALC > +0 AND
 16743*                  PB-C-AH-CANCEL-AMT = +0
 16744        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16745                   PB-C-AH-REF-CALC = +0
 16746           CONTINUE
 16747        WHEN OTHER
 16748           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16749               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16750              CONTINUE
 16751           ELSE
 16752              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16753                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16754                 CONTINUE
 16755              ELSE
 16756                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16757                     MOVE ER-2754   TO  WS-ERROR
 16758                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16759                 ELSE
 16760                     MOVE ER-2736   TO  WS-ERROR
 16761                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16762                 END-IF
 16763              END-IF
 16764           END-IF
 16765     END-EVALUATE.
 16766
 16767     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16768        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16769        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16770           AND  PB-C-LF-REF-CALC < +1.00
 16771           AND  PB-C-AH-REF-CALC < +1.00
 16772           CONTINUE
 16773        ELSE
 16774           IF (PB-COMPANY-ID = 'DCC')
 16775              AND (PB-CI-ENTRY-STATUS = 'M')
 16776              CONTINUE
 16777           ELSE
 16778              MOVE ER-2741       TO WS-ERROR
 16779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16780           END-IF
 16781        END-IF
 16782     END-IF
 16783
 16784     IF (PB-C-LF-CANCEL-AMT = ZERO
 16785        AND WS-LF-BENEFIT-CD NOT = ZERO
 16786        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16787        AND PB-C-LF-REF-CALC NOT = ZERO)
 16788        OR
 16789        (PB-C-LF-CANCEL-AMT = ZERO
 16790        AND WS-LF-BENEFIT-CD NOT = ZERO
 16791        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16792             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16793                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16794                NEXT SENTENCE
 16795             ELSE
 16796                MOVE ER-2739        TO WS-ERROR
 16797                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16798
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 303
* EL050.cbl
 16799     IF (PB-C-AH-CANCEL-AMT = ZERO
 16800        AND WS-AH-BENEFIT-CD NOT = ZERO
 16801        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16802        AND PB-C-AH-REF-CALC NOT = ZERO)
 16803        OR
 16804        (PB-C-AH-CANCEL-AMT = ZERO
 16805        AND WS-AH-BENEFIT-CD NOT = ZERO
 16806        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16807             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16808                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16809                NEXT SENTENCE
 16810             ELSE
 16811                MOVE ER-2738        TO WS-ERROR
 16812                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16813
 16814 3775-OVER-REF-CHK.
 16815
 16816     IF PB-CI-ENTRY-STATUS = '5'
 16817        GO TO 3780-UPDATE-CANCEL-CERT.
 16818
 16819     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16820                              PB-CI-LF-ALT-PREMIUM-AMT.
 16821
 16822     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16823        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16824                                 PB-C-LF-REF-CALC
 16825      ELSE
 16826        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16827                                 PB-C-LF-CANCEL-AMT.
 16828
 16829     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16830        MOVE ER-2755             TO WS-ERROR
 16831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16834
 16835     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16836        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16837                                 PB-C-AH-REF-CALC
 16838      ELSE
 16839        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16840                                 PB-C-AH-CANCEL-AMT.
 16841
 16842     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16843        MOVE ER-2778             TO WS-ERROR
 16844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845
 16846     IF PB-CI-OB-FLAG NOT = 'Z'
 16847        NEXT SENTENCE
 16848       ELSE
 16849         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16850            MOVE ER-2757           TO WS-ERROR
 16851            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16852
 16853 3780-UPDATE-CANCEL-CERT.
 16854
 16855     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16856        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 304
* EL050.cbl
 16857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16858
 16859     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16860         MOVE ER-2729              TO WS-ERROR
 16861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16862
 16863     IF PB-CI-LF-BENEFIT-CD = ZERO
 16864         GO TO 3780-UPDATE-CONT-1.
 16865
 16866     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16867         GO TO 3780-UPDATE-CONT-1.
 16868
 16869     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16870       AND
 16871        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16872       AND
 16873        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16874       AND
 16875        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16876            NEXT SENTENCE
 16877       ELSE
 16878        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16879          AND
 16880***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16881***       AND
 16882           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16883            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16884               MOVE ER-2730      TO WS-ERROR
 16885               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16886               GO TO 3999-END-EDIT
 16887            ELSE
 16888               GO TO 3999-END-EDIT
 16889        ELSE
 16890            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16891               MOVE ER-2765           TO WS-ERROR
 16892               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16893               GO TO 3785-CHECK-NH.
 16894*              GO TO 3999-END-EDIT.
 16895
 16896 3780-UPDATE-CONT-1.
 16897     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16898
 16899     IF PB-CI-AH-BENEFIT-CD = ZERO
 16900         GO TO 3780-UPDATE-CONT-2.
 16901
 16902     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16903         GO TO 3780-UPDATE-CONT-2.
 16904
 16905     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16906
 16907     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16908       AND
 16909        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16910       AND
 16911        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16912       AND
 16913        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16914            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 305
* EL050.cbl
 16915       ELSE
 16916        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16917          AND
 16918***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16919***       AND
 16920           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16921           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16922            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16923               MOVE ER-2773      TO WS-ERROR
 16924               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16925               GO TO 3999-END-EDIT
 16926            ELSE
 16927               GO TO 3999-END-EDIT
 16928            END-IF
 16929           ELSE
 16930             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16931                IF MSTR-CERT-NO = W-CL-CERT-NO
 16932                   MOVE ER-2890 TO WS-ERROR
 16933                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16934                   GO TO 3999-END-EDIT
 16935                ELSE
 16936                   MOVE ER-2898 TO WS-ERROR
 16937                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16938                   GO TO 3999-END-EDIT
 16939                END-IF
 16940             ELSE
 16941                GO TO 3785-CHECK-NH
 16942             END-IF
 16943           END-IF
 16944          ELSE
 16945            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16946              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16947                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16948                   IF MSTR-CERT-NO = W-CL-CERT-NO
 16949                      MOVE ER-2890 TO WS-ERROR
 16950                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16951                      GO TO 3999-END-EDIT
 16952                   ELSE
 16953                      MOVE ER-2898 TO WS-ERROR
 16954                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16955                      GO TO 3999-END-EDIT
 16956                   END-IF
 16957                ELSE
 16958                   MOVE ER-2765 TO WS-ERROR
 16959                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16960                   GO TO 3785-CHECK-NH
 16961                END-IF
 16962              ELSE
 16963               MOVE ER-2765      TO WS-ERROR
 16964               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16965               GO TO 3785-CHECK-NH.
 16966*              GO TO 3999-END-EDIT.
 16967
 16968 3780-UPDATE-CONT-2.
 16969
 16970     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16971        AND WS-LF-BENEFIT-CD = ZERO
 16972           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 306
* EL050.cbl
 16973           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16974
 16975     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16976        AND WS-AH-BENEFIT-CD = ZERO
 16977           MOVE ER-2744           TO WS-ERROR
 16978           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16979
 16980     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16981        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16982        AND
 16983        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16984         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 16985           MOVE ER-2746           TO WS-ERROR
 16986           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16987
 16988     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16989       AND
 16990        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16991             MOVE ER-2737        TO WS-ERROR
 16992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16993
 16994     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16995       AND
 16996        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16997             MOVE ER-2737        TO WS-ERROR
 16998             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16999
 17000     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17001         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17002             OR 'CID' OR 'DCC' OR 'AHL'
 17003             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17004         ELSE
 17005             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17006                 MOVE ER-2768    TO WS-ERROR
 17007                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17008             ELSE
 17009                 MOVE ER-2756    TO WS-ERROR
 17010                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17011
 17012     IF CERT-PEND-ISSUE-RETURNED
 17013        MOVE ER-2772             TO WS-ERROR
 17014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17015 3785-CHECK-NH.
 17016     IF PB-STATE NOT = 'NH'
 17017        GO TO 3999-END-EDIT
 17018     END-IF
 17019
 17020     MOVE ER-2796                TO WS-ERROR
 17021     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17022     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17023        OR (CM-NH-INTERFACE-SW = 'Y')
 17024        MOVE ER-2793             TO WS-ERROR
 17025        PERFORM 9900-ERROR-FORMAT
 17026                                 THRU 9900-EXIT
 17027     END-IF
 17028     MOVE +0                     TO WS-PAYMENT-AMT
 17029     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17030        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 307
* EL050.cbl
 17031     END-IF
 17032     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17033        GO TO 3999-END-EDIT
 17034     END-IF
 17035     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17036     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17037     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17038        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17039     END-IF
 17040     MOVE '1'                    TO DC-OPTION-CODE
 17041     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17042     IF NO-CONVERSION-ERROR
 17043        IF DC-ELAPSED-DAYS < +16
 17044           GO TO 3999-END-EDIT
 17045        END-IF
 17046     END-IF
 17047     MOVE +0                     TO DC-ELAPSED-DAYS
 17048     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17049     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17050     MOVE '1'                    TO DC-OPTION-CODE
 17051     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17052     IF NO-CONVERSION-ERROR
 17053        IF DC-ELAPSED-DAYS > +30
 17054           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17055        ELSE
 17056           GO TO 3999-END-EDIT
 17057        END-IF
 17058     ELSE
 17059        GO TO 3999-END-EDIT
 17060     END-IF
 17061     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17062        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17063           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17064     IF WS-PAYMENT-AMT < 600.00
 17065        GO TO 3999-END-EDIT
 17066     END-IF
 17067     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17068
 17069     IF (ERMAIL-FOUND = ' ')
 17070         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17071         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17072        GO TO 3999-END-EDIT
 17073     END-IF
 17074     MOVE ER-2795                TO WS-ERROR
 17075     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17076
 17077     GO TO 3999-END-EDIT.
 17078******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 308
* EL050.cbl
 17080 3990-FILES-NOT-OPEN.
 17081
 17082     MOVE ER-2617                TO WS-ERROR.
 17083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17084     GO TO 9990-RETURN.
 17085
 17086 3999-END-EDIT.
 17087
 17088     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17089
 17090     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17091         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17092         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17093             PERFORM 9250-UNLOCK-RETURN
 17094             GO TO 9990-RETURN
 17095          ELSE
 17096             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17097             GO TO 9990-RETURN.
 17098
 17099     IF PB-CANCELLATION
 17100          GO TO 9990-RETURN.
 17101
 17102     IF CERT-WAS-NOT-FOUND
 17103        MOVE SPACES              TO CERTIFICATE-MASTER.
 17104
 17105     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17106
 17107     IF CERT-WAS-FOUND
 17108         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17109             PERFORM 9250-UNLOCK-RETURN
 17110          ELSE
 17111            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17112      ELSE
 17113         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17114
 17115     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17116        IF PB-COMPANY-ID = 'DCC' AND
 17117           (PB-CARRIER = '2' OR '4' OR '6')
 17118              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17119        END-IF
 17120     END-IF.
 17121
 17122     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17123         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17124     END-IF.
 17125     move ' '                    to ws-ins-age-defaulted
 17126     perform 8150-read-elcrtt    thru 8150-exit
 17127     if ws-ins-age-defaulted = 'Y'
 17128        move er-1573             to ws-error
 17129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17130     end-if
 17131
 17132     if ws-jnt-age-defaulted = 'Y'
 17133        move er-1574             to ws-error
 17134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17135     end-if
 17136
 17137     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 309
* EL050.cbl
 17138     IF ((PB-COMPANY-ID = 'DCC')
 17139        AND (WS-NO-SECURE-PAY))
 17140                  OR
 17141        (WS-LF-SPECIAL-CALC-CD = 'O'
 17142        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17143        SET SKIP-ADDR-EDIT       TO TRUE
 17144     END-IF
 17145     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17146        AND (NOT SKIP-ADDR-EDIT)
 17147        MOVE ER-2963             TO WS-ERROR
 17148        PERFORM 9900-ERROR-FORMAT
 17149                                 THRU 9900-EXIT
 17150        GO TO 9990-RETURN
 17151     END-IF
 17152     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17153     IF ERPNDM-FOUND NOT = 'X'
 17154        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17155           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17156           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17157           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17158           AND (NOT SKIP-ADDR-EDIT)
 17159           MOVE ER-2694          TO WS-ERROR
 17160           PERFORM 9900-ERROR-FORMAT
 17161                                 THRU 9900-EXIT
 17162        END-IF
 17163        MOVE ' '                 TO STATE-RECORD-ERROR
 17164        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17165        MOVE PM-STATE            TO CNTL-ACCESS
 17166        MOVE '3'                 TO CNTL-REC-TYPE
 17167        MOVE +0                  TO CNTL-SEQ-NO
 17168        MOVE '0'                 TO RC-SW-2
 17169        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17170        IF (NO-STATE-RECORD)
 17171           OR (CF-RECORD-TYPE NOT = '3')
 17172           OR (PM-STATE NOT = CF-STATE-CODE)
 17173           IF (PM-STATE = SPACES)
 17174              AND (SKIP-ADDR-EDIT)
 17175              CONTINUE
 17176           ELSE
 17177              MOVE ER-2963       TO WS-ERROR
 17178              PERFORM 9900-ERROR-FORMAT
 17179                                 THRU 9900-EXIT
 17180           END-IF
 17181        END-IF
 17182        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17183           MOVE ER-2883          TO WS-ERROR
 17184           PERFORM 9900-ERROR-FORMAT
 17185                                 THRU 9900-EXIT
 17186        END-IF
 17187        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17188           MOVE ' '                 TO STATE-RECORD-ERROR
 17189           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17190           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17191           MOVE '3'                 TO CNTL-REC-TYPE
 17192           MOVE +0                  TO CNTL-SEQ-NO
 17193           MOVE '0'                 TO RC-SW-2
 17194           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17195           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 310
* EL050.cbl
 17196              OR (CF-RECORD-TYPE NOT = '3')
 17197              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17198              MOVE ER-2964          TO WS-ERROR
 17199              PERFORM 9900-ERROR-FORMAT
 17200                                    THRU 9900-EXIT
 17201           END-IF
 17202        END-IF
 17203     ELSE
 17204        IF NOT SKIP-ADDR-EDIT
 17205           MOVE ER-2393          TO WS-ERROR
 17206           PERFORM 9900-ERROR-FORMAT
 17207                                 THRU 9900-EXIT
 17208        END-IF
 17209     END-IF
 17210
 17211     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17212
 17213     IF (ERMAIL-FOUND = ' ' AND
 17214        ERPNDM-FOUND = ' ')
 17215        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17216           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17217           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17218          OR
 17219           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17220          OR
 17221           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17222           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17223           GO TO 3999-UNLOCK-ERMAIL.
 17224
 17225     IF ERPNDM-FOUND = 'X'
 17226        GO TO 3999-UNLOCK-ERMAIL.
 17227
 17228     IF PM-INSURED-LAST-NAME      = SPACES
 17229        AND PM-INSURED-FIRST-NAME = SPACES
 17230        AND PM-ADDRESS-LINE-1     = SPACES
 17231        AND PM-ADDRESS-LINE-2     = SPACES
 17232        AND PM-CITY-STATE         = SPACES
 17233        AND PM-CRED-BENE-NAME     = SPACES
 17234        AND PM-CRED-BENE-ADDR     = SPACES
 17235        AND PM-CRED-BENE-CTYST    = SPACES
 17236        GO TO 3999-UNLOCK-ERMAIL
 17237     END-IF
 17238
 17239     MOVE SPACES                 TO MAILING-DATA.
 17240
 17241     MOVE 'MA'                   TO MA-RECORD-ID.
 17242     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17243     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17244     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17245     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17246     MOVE PB-SV-STATE            TO MA-STATE.
 17247     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17248     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17249
 17250     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17251     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17252
 17253     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 311
* EL050.cbl
 17254        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17255     ELSE
 17256        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17257        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17258        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17259
 17260     GO TO 9990-RETURN.
 17261
 17262 3999-UNLOCK-ERMAIL.
 17263     IF ERMAIL-FOUND = ' '
 17264        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17265
 17266     GO TO 9990-RETURN.
 17267******************************************************************
 17268
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 312
* EL050.cbl
 17270 4000-UPDATE-CANCELLED-CERT.
 17271     IF CERT-WAS-NOT-FOUND
 17272        GO TO 4299-EXIT.
 17273
 17274*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17275     IF PB-C-NH-INT-ON-REFS > ZEROS
 17276        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17277     END-IF
 17278     IF PB-C-REF-INTERFACE-SW = 'Y'
 17279        MOVE PB-C-REF-INTERFACE-SW
 17280                                 TO CM-NH-INTERFACE-SW
 17281     END-IF
 17282     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17283     IF ERMAIL-FOUND = 'X'
 17284        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17285        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17286        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17287        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17288           MOVE ER-2694          TO WS-ERROR
 17289           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17290     END-IF
 17291
 17292     IF PB-C-POST-CARD-IND = 'Y'
 17293        MOVE +8                  TO SUB
 17294*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17295        IF ERMAIL-FOUND = ' '
 17296           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17297              (SUB > +7)
 17298              OR (MA-MAIL-STATUS (SUB) = '1')
 17299           END-PERFORM
 17300        END-IF
 17301        IF (SUB > +7)
 17302           OR (ERMAIL-FOUND = 'X')
 17303           MOVE ER-3789          TO WS-ERROR
 17304           PERFORM 9900-ERROR-FORMAT
 17305                                 THRU 9900-EXIT
 17306        END-IF
 17307     ELSE
 17308        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17309     END-IF
 17310
 17311     IF ERMAIL-FOUND = ' '
 17312        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17313     END-IF.
 17314
 17315     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17316
 17317     IF PB-CI-OB-FLAG = 'Z'
 17318        GO TO 4150-SUMMARY-CERT-CANCEL.
 17319
 17320     IF PB-C-LF-CANCEL-VOIDED
 17321         PERFORM 4200-REVERSE-LF-CANCEL.
 17322     IF PB-C-AH-CANCEL-VOIDED
 17323         PERFORM 4200-REVERSE-AH-CANCEL.
 17324
 17325 4100-APPLY-LF-CANCEL.
 17326
 17327     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 313
* EL050.cbl
 17328
 17329 4100-CHECK-LF-ERRORS.
 17330
 17331     ADD +1                       TO WS-SUB.
 17332
 17333     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17334        IF LF-COVERAGE-CANCELLED
 17335           GO TO 4100-LF-CANCEL-CONT
 17336        ELSE
 17337           GO TO 4100-UPDATE-LF-COVERAGE.
 17338
 17339     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17340                                   ER-2729 OR
 17341                                   ER-2730 OR
 17342                                   ER-2731 OR
 17343                                   ER-2732 OR
 17344                                   ER-2737 OR
 17345                                   ER-2740 OR
 17346                                   ER-2743 OR
 17347                                   ER-2749 OR
 17348                                   ER-2750 OR
 17349                                   ER-2755 OR
 17350                                   ER-2757 OR
 17351                                   ER-2760 OR
 17352                                   ER-2772 OR
 17353                                   ER-2774 OR
 17354                                   ER-2776 OR
 17355                                   ER-2794
 17356        GO TO 4100-UPDATE-LF-COVERAGE.
 17357
 17358     GO TO 4100-CHECK-LF-ERRORS.
 17359
 17360 4100-UPDATE-LF-COVERAGE.
 17361
 17362     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17363     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17364     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17365        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17366     END-IF
 17367     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17368                                      TO CM-CREDIT-INTERFACE-SW-2.
 17369     IF CM-LF-CANCEL-DT = LOW-VALUE
 17370         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17371
 17372     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17373         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17374                                         CM-LF-STATUS-AT-CANCEL.
 17375
 17376     GO TO 4100-APPLY-AH-CANCEL.
 17377
 17378 4100-LF-CANCEL-CONT.
 17379     IF PB-C-LF-CANCEL-VOIDED
 17380         GO TO 4100-APPLY-AH-CANCEL.
 17381
 17382     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17383         GO TO 4100-APPLY-AH-CANCEL.
 17384
 17385     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 314
* EL050.cbl
 17386        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17387           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17388        ELSE
 17389           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17390
 17391     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17392     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17393
 17394     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17395         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17396
 17397     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17398        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17399         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17400         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17401
 17402     IF PB-RECORD-RETURNED
 17403        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17404      ELSE
 17405        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17406
 17407 4100-APPLY-AH-CANCEL.
 17408
 17409     MOVE +0                      TO WS-SUB.
 17410
 17411 4100-CHECK-AH-ERRORS.
 17412
 17413     ADD +1                       TO WS-SUB.
 17414
 17415     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17416        IF AH-COVERAGE-CANCELLED
 17417           GO TO 4100-AH-CANCEL-CONT
 17418        ELSE
 17419           GO TO 4100-UPDATE-AH-COVERAGE.
 17420
 17421     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17422                                   ER-2729 OR
 17423                                   ER-2732 OR
 17424                                   ER-2737 OR
 17425                                   ER-2740 OR
 17426                                   ER-2744 OR
 17427                                   ER-2749 OR
 17428                                   ER-2750 OR
 17429                                   ER-2755 OR
 17430                                   ER-2757 OR
 17431                                   ER-2760 OR
 17432                                   ER-2771 OR
 17433                                   ER-2772 OR
 17434                                   ER-2773 OR
 17435                                   ER-2775 OR
 17436                                   ER-2777 OR
 17437                                   ER-2778 OR
 17438                                   ER-2794
 17439        GO TO 4100-UPDATE-AH-COVERAGE.
 17440
 17441     GO TO 4100-CHECK-AH-ERRORS.
 17442
 17443 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 315
* EL050.cbl
 17444
 17445     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17446     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17447     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17448     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17449                                      TO CM-CREDIT-INTERFACE-SW-2.
 17450     IF CM-AH-CANCEL-DT = LOW-VALUE
 17451         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17452
 17453     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17454         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17455                                         CM-AH-STATUS-AT-CANCEL.
 17456
 17457     IF LF-COVERAGE-CANCELLED
 17458         IF PB-RECORD-RETURNED
 17459              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17460          ELSE
 17461              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17462
 17463     GO TO 4299-EXIT.
 17464
 17465 4100-AH-CANCEL-CONT.
 17466     IF PB-C-AH-CANCEL-VOIDED
 17467         GO TO 4299-EXIT.
 17468
 17469     if cm-credit-interface-sw-2 = ' '
 17470        if pb-fatal-errors or pb-unforced-errors
 17471           move '4'              to cm-credit-interface-sw-2
 17472        else
 17473           move '1'              to cm-credit-interface-sw-2
 17474        end-if
 17475     end-if
 17476     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17477         GO TO 4299-EXIT.
 17478
 17479     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17480        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17481           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17482        ELSE
 17483           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17484
 17485     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17486     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17487
 17488     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17489         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17490
 17491     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17492         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17493         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17494
 17495     IF PB-RECORD-RETURNED
 17496        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17497      ELSE
 17498        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17499
 17500     GO TO 4299-EXIT.
 17501
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 316
* EL050.cbl
 17502 4150-SUMMARY-CERT-CANCEL.
 17503     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17504
 17505     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17506        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17507                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17508     ELSE
 17509        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17510                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17511
 17512     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17513        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17514                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17515     ELSE
 17516        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17517                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17518
 17519     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17520        NEXT SENTENCE
 17521     ELSE
 17522        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17523
 17524     GO TO 4299-EXIT.
 17525
 17526 4200-REVERSE-LF-CANCEL.
 17527     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17528
 17529     IF CM-LF-CANCEL-APPLIED
 17530        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17531        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17532        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17533
 17534     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17535
 17536     IF PB-RECORD-RETURNED
 17537        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17538       ELSE
 17539        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17540
 17541 4200-REVERSE-LF-EXIT.
 17542       EXIT.
 17543
 17544 4200-REVERSE-AH-CANCEL.
 17545     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17546
 17547     IF CM-AH-CANCEL-APPLIED
 17548        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17549        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17550        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17551
 17552     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17553
 17554     IF PB-RECORD-RETURNED
 17555        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17556       ELSE
 17557        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17558
 17559 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 317
* EL050.cbl
 17560       EXIT.
 17561
 17562 4299-EXIT.
 17563       EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 318
* EL050.cbl
 17565
 17566 4500-UPDATE-NEW-CERT.
 17567     IF CERT-WAS-FOUND
 17568         NEXT SENTENCE
 17569       ELSE
 17570         GO TO 4520-BUILD-NEW-KEY.
 17571
 17572     IF  CLASIC-CREATED-CERT
 17573         GO TO 4999-EXIT.
 17574
 17575     IF  CERT-WAS-CREATED-FOR-CLAIM
 17576         GO TO 4520-BUILD-NEW-KEY.
 17577
 17578     IF CERT-ADDED-BATCH
 17579        IF CM-RECORD-ID = 'CM'
 17580            GO TO 4999-EXIT.
 17581
 17582 4520-BUILD-NEW-KEY.
 17583* BUILD CONTROL PRIMARY
 17584
 17585     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17586                                       CM-COMPANY-CD-A1
 17587                                       CM-COMPANY-CD-A2
 17588                                       CM-COMPANY-CD-A4
 17589                                       CM-COMPANY-CD-A5.
 17590
 17591     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17592     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17593     MOVE PB-SV-STATE               TO CM-STATE.
 17594     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17595     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17596     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17597     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17598
 17599     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17600
 17601     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17602     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17603     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17604     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17605
 17606     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17607        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17608
 17609     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17610         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17611         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17612         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17613         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17614     ELSE
 17615         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17616
 17617     IF PB-COMPANY-ID   EQUAL  'CRI'
 17618         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17619         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17620         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17621         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17622         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 319
* EL050.cbl
 17623
 17624     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17625        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17626         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17627
 17628     IF PB-COMPANY-ID  = 'LBL'
 17629        IF PB-I-JOINT-COVERAGE
 17630            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17631                                           PB-I-MEMBER-NO
 17632            GO TO 4550-CONT-CERT-PROCESS.
 17633
 17634     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17635        NEXT SENTENCE
 17636     ELSE
 17637        GO TO 4540-BUILD-MEMBER-NO.
 17638
 17639******************************************************************
 17640*                                                                *
 17641*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17642*    FOR 'MON'.                                                  *
 17643*                                                                *
 17644******************************************************************
 17645
 17646     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17647     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17648     MOVE +1                     TO WS-SUB1
 17649                                    WS-SUB2.
 17650
 17651 4530-EDIT-MEMB-NAME.
 17652
 17653     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17654        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17655        ADD +1                       TO WS-SUB2.
 17656
 17657     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17658        ADD +1                       TO WS-SUB1
 17659        GO TO 4530-EDIT-MEMB-NAME.
 17660
 17661     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17662     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17663     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17664*    MOVE SPACE                      TO DC-OPTION-CODE.
 17665     SET  BIN-TO-GREG                TO TRUE.
 17666     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17667     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17668
 17669     GO TO 4550-CONT-CERT-PROCESS.
 17670
 17671******************************************************************
 17672*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17673******************************************************************
 17674
 17675 4540-BUILD-MEMBER-NO.
 17676
 17677     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17678         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17679         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17680         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 320
* EL050.cbl
 17681         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17682     ELSE
 17683         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17684
 17685     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17686        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17687         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17688
 17689 4550-CONT-CERT-PROCESS.
 17690
 17691*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17692*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17693*    ELSE
 17694*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17695
 17696     IF CERT-WAS-CREATED-FOR-CLAIM
 17697        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17698        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17699
 17700     IF CERT-AND-CLAIM-ONLINE
 17701        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17702        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17703
 17704     MOVE 'CM'                     TO CM-RECORD-ID.
 17705     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17706
 17707     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17708        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17709        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17710     ELSE
 17711        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17712        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17713
 17714     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17715     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17716     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17717     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17718     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17719     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17720     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17721                                      CM-LF-ITD-CANCEL-AMT
 17722                                      CM-LF-ITD-DEATH-AMT
 17723                                      CM-AH-ITD-AH-PMT
 17724                                      CM-AH-ITD-LUMP-PMT
 17725                                      CM-AH-ITD-CANCEL-AMT
 17726                                      CM-LF-NSP-PREMIUM-AMT
 17727                                      CM-AH-NSP-PREMIUM-AMT.
 17728*                                     CM-CLAIM-DEDUCT-WITHHELD
 17729*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17730     if pb-i-loan-apr = +99.9999
 17731        move zeros                 to cm-loan-apr
 17732     else
 17733        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17734     end-if
 17735     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17736     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17737     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17738     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 321
* EL050.cbl
 17739     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17740     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17741     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17742     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17743     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17744     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17745     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17746
 17747     IF PB-I-LIVES NOT NUMERIC
 17748         MOVE ZERO                 TO PB-I-LIVES.
 17749
 17750     IF PB-I-NUM-BILLED NOT NUMERIC
 17751         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17752
 17753     MOVE PB-I-LIVES               TO CM-LIVES.
 17754     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17755
 17756     IF PB-COMPANY-ID EQUAL  'DMD'
 17757         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17758         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17759
 17760     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17761     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17762     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17763     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17764     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17765     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17766
 17767     IF PB-I-LF-POLICY-FEE NUMERIC
 17768        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17769     ELSE
 17770        MOVE +0                    TO CM-LF-POLICY-FEE.
 17771
 17772     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17773        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17774        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17775     ELSE
 17776        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17777
 17778     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17779     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17780     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17781     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17782     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17783     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17784     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17785     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17786     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17787
 17788     IF PB-I-AH-POLICY-FEE NUMERIC
 17789        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17790     ELSE
 17791        MOVE +0                    TO CM-AH-POLICY-FEE.
 17792
 17793     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17794        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17795     ELSE
 17796        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 322
* EL050.cbl
 17797
 17798     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17799     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17800
 17801     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17802                                      CM-LF-DEATH-EXIT-DT
 17803                                      CM-AH-SETTLEMENT-EXIT-DT.
 17804
 17805*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17806*                       'TIH' OR 'OFL' OR 'FLA' OR
 17807*                       'TII' OR 'TMS' OR 'CRI' OR
 17808*                       'NCL'
 17809     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17810
 17811     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17812         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17813            MOVE '2'                TO CM-PREMIUM-TYPE.
 17814
 17815     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17816         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17817            MOVE '2'                TO CM-PREMIUM-TYPE.
 17818
 17819     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17820         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17821     ELSE
 17822         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17823         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17824
 17825     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17826     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17827     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17828     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17829     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17830     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17831     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17832     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17833
 17834     IF PB-NO-MONTHS-SKIPPED
 17835         MOVE SPACE                 TO CM-SKIP-CODE
 17836     ELSE
 17837         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17838
 17839     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17840     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17841                                       CM-LF-STATUS-AT-CANCEL.
 17842
 17843     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17844     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17845                                       CM-AH-STATUS-AT-CANCEL.
 17846
 17847     MOVE '1'                       TO CM-ENTRY-STATUS.
 17848
 17849     IF PB-REISSUED-CERT
 17850        MOVE '5'                    TO CM-ENTRY-STATUS.
 17851
 17852     IF PB-MONTHLY-CERT
 17853        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17854
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 323
* EL050.cbl
 17855     IF PB-CASH-CERT
 17856        MOVE 'C'                    TO CM-ENTRY-STATUS.
 17857
 17858     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17859     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17860     IF PB-POLICY-IS-DECLINED
 17861        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17862
 17863     IF PB-POLICY-IS-VOIDED
 17864        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17865
 17866     IF PB-NEEDS-UNDERWRITING
 17867        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17868
 17869     IF PB-REIN-ONLY-CERT
 17870        MOVE '9'                    TO CM-ENTRY-STATUS.
 17871
 17872     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17873         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17874     ELSE
 17875         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17876
 17877     IF PB-RECORD-RETURNED
 17878        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17879      ELSE
 17880        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17881
 17882     IF PB-I-MAIL-ADDRS-PRESENT
 17883        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17884
 17885     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17886                                       CM-ENTRY-DT.
 17887
 17888 4999-EXIT.
 17889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 324
* EL050.cbl
 17891
 17892 5000-PROCESS-REPS.
 17893     MOVE ' '                    TO AGTC-MASTER-SW
 17894     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17895     MOVE CO-TYPE                TO AGTC-TYPE
 17896     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17897     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17898     IF (AGTC-MASTER-SW NOT = 'N')
 17899        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17900        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17901        PERFORM 8583-READ-ERAGTC-NEXT
 17902                                 THRU 8583-EXIT
 17903     END-IF
 17904     IF AGTC-MASTER-SW = 'N'
 17905        CONTINUE
 17906     ELSE
 17907        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17908           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17909              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17910              MOVE 'Y'           TO AGTC-MASTER-SW
 17911           END-IF
 17912        END-IF
 17913     END-IF
 17914     .
 17915 5000-EXIT.
 17916     EXIT.
 17917 6370-EDIT-INPUT-LF-CODE.
 17918     move ' ' to ws-benefit-cd-chg-sw
 17919     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17920        MOVE +1                  TO SUB
 17921        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17922        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17923        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17924        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17925        GO TO 6370-SEARCH-LOOP.
 17926
 17927     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17928
 17929     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17930     MOVE SPACES                 TO CNTL-ACCESS.
 17931*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17932     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17933     MOVE +0                     TO CNTL-SEQ-NO.
 17934     MOVE '4' TO RC-SW-2.
 17935     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17936
 17937     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17938        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17939        GO TO 6370-NO-LF-FOUND.
 17940
 17941     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17942     MOVE +1                     TO SUB.
 17943
 17944 6370-SEARCH-LOOP.
 17945     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17946         GO TO 6370-NO-LF-FOUND.
 17947
 17948     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 325
* EL050.cbl
 17949        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17950           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17951           set benefit-code-chg to true
 17952        end-if
 17953        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17954        GO TO 6370-HER-NET-PAY-CHECK.
 17955
 17956     ADD 1   TO SUB.
 17957*    IF SUB GREATER 120
 17958     IF SUB GREATER 200
 17959         GO TO 6370-NO-LF-FOUND.
 17960
 17961     GO TO 6370-SEARCH-LOOP.
 17962
 17963 6370-NO-LF-FOUND.
 17964
 17965     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17966        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17967        set benefit-code-chg to true
 17968     end-if
 17969     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17970
 17971 6370-HER-NET-PAY-CHECK.
 17972
 17973     IF PB-COMPANY-ID = 'CID'
 17974        IF PB-SV-STATE = 'CA' OR 'MN'
 17975           IF PB-I-LF-BENEFIT-CD = '02'
 17976              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17977           ELSE
 17978              IF PB-I-LF-BENEFIT-CD = '04'
 17979                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17980              END-IF
 17981           END-IF
 17982        END-IF
 17983     END-IF
 17984
 17985     IF PB-COMPANY-ID NOT = 'HER'
 17986         GO TO 6370-EXIT.
 17987
 17988     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17989         GO TO 6370-EXIT.
 17990
 17991     IF PB-I-LF-TERM NOT NUMERIC
 17992         MOVE ZEROS              TO PB-I-LF-TERM.
 17993
 17994     IF PB-I-LOAN-TERM NOT NUMERIC
 17995         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17996
 17997     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17998         GO TO 6370-EXIT.
 17999
 18000     IF PB-I-LF-BENEFIT-CD = '33'
 18001         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18002
 18003     IF PB-I-LF-BENEFIT-CD = '34'
 18004         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18005
 18006 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 326
* EL050.cbl
 18007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 327
* EL050.cbl
 18009
 18010 6380-EDIT-INPUT-AH-CODE.
 18011     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18012        MOVE +1                  TO SUB
 18013        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18014        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18015        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18016        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18017        GO TO 6380-SEARCH-LOOP.
 18018
 18019     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18020
 18021     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18022     MOVE SPACES                 TO CNTL-ACCESS.
 18023     MOVE 'A'                    TO CNTL-REC-TYPE.
 18024*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18025     MOVE +0                     TO CNTL-SEQ-NO.
 18026     MOVE '5' TO RC-SW-2.
 18027     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18028
 18029     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18030        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18031        GO TO 6380-NO-AH-FOUND.
 18032
 18033     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18034     MOVE +1 TO SUB.
 18035
 18036 6380-SEARCH-LOOP.
 18037     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18038         GO TO 6380-NO-AH-FOUND.
 18039
 18040     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18041         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18042         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18043
 18044     ADD 1   TO SUB.
 18045     IF SUB GREATER THAN 96
 18046*    IF SUB GREATER THAN 300
 18047         GO TO 6380-NO-AH-FOUND.
 18048
 18049     GO TO 6380-SEARCH-LOOP.
 18050
 18051 6380-NO-AH-FOUND.
 18052
 18053     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18054
 18055     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18056         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18057     ELSE
 18058         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18059
 18060 6380-CSO-AH-ONLY-CHECKS.
 18061
 18062     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18063        NEXT SENTENCE
 18064      ELSE
 18065        GO TO 6380-EXIT.
 18066
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 328
* EL050.cbl
 18067     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18068         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18069
 18070
 18071     GO TO 6380-EXIT
 18072     .
 18073 6380-CSO-LIFE-WITH-AH-CHECKS.
 18074
 18075
 18076     .
 18077 6380-EXIT.
 18078     EXIT.
 18079
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 329
* EL050.cbl
 18081
 18082 6400-COMPUTE-EXTENSION-DAYS.
 18083
 18084******************************************************************
 18085*                                                                *
 18086*                   COMPUTE EXTENSION DAYS                       *
 18087*                                                                *
 18088*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18089*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18090*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18091*    THE EXTENSION DAYS.                                         *
 18092*                                                                *
 18093******************************************************************
 18094
 18095     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18096     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18097
 18098******************************************************************
 18099*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18100*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18101******************************************************************
 18102
 18103     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18104        COMPUTE WS-ODD-DAYS-OVER =
 18105               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18106     ELSE
 18107        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18108
 18109     IF WS-ODD-DAYS-OVER = ZEROS
 18110           GO TO 6499-EXIT
 18111     ELSE
 18112        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18113           IF WS-WDF-MONTH = 02
 18114              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18115              ADD 2       TO  WS-ODD-DAYS-OVER
 18116              GO TO 6499-EXIT
 18117           ELSE
 18118              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18119                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18120                 GO TO 6499-EXIT
 18121               ELSE
 18122                 GO TO 6499-EXIT
 18123        ELSE
 18124           GO TO 6499-EXIT.
 18125
 18126 6412-CHECK-TO-DAY.
 18127
 18128        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18129           IF WS-WDT-DAY = 28
 18130              ADD 2              TO WS-ODD-DAYS-OVER
 18131           ELSE
 18132              IF WS-WDT-DAY = 29
 18133                 ADD 1           TO WS-ODD-DAYS-OVER
 18134              ELSE
 18135                 NEXT SENTENCE
 18136        ELSE
 18137           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18138              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 330
* EL050.cbl
 18139
 18140     GO TO 6499-EXIT.
 18141
 18142
 18143 6415-CHECK-LEAP-YEAR.
 18144
 18145     IF DC-DAYS-IN-MONTH = 29
 18146        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18147
 18148 6415-EXIT.
 18149     EXIT.
 18150
 18151 6499-EXIT.
 18152      EXIT.
 18153
 18154 6500-END.
 18155     EXIT.
 18156
 18157
 18158******************************************************************
 18159************* PROCEDURE DIVISION FOR EL050 ***********************
 18160********************** ELC50PD END *******************************
 18161
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 331
* EL050.cbl
 18163
 18164**START***********************************************************
 18165*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18166*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18167******************************************************************
 18168*
 18169 6600-GET-STATE-MUNICIPAL-TAX.
 18170
 18171     IF PB-COMPANY-ID NOT = 'DMD'
 18172         GO TO 6640-EXIT.
 18173
 18174     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18175     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18176     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18177*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18178*
 18179***  Y2K PROJ 7744
 18180     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18181     SET BIN-TO-GREG          TO TRUE.
 18182     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18183
 18184     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18185
 18186     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18187     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18188
 18189
 18190* EXEC CICS HANDLE CONDITION
 18191*        INVREQ    (6610-START-BROWSE)
 18192*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18193*        NOTFND    (6630-END-OF-FILE)
 18194*    END-EXEC.
 18195*    MOVE '"$8JI                 ! # #00018177' TO DFHEIV0
 18196     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18198     MOVE X'2320233030303138313737' TO DFHEIV0(25:11)
 18199     CALL 'kxdfhei1' USING DFHEIV0
 18200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18201
 18202
 18203 6610-START-BROWSE.
 18204
 18205
 18206* EXEC CICS HANDLE CONDITION
 18207*        NOTFND    (6630-END-OF-FILE)
 18208*        DISABLED  (6630-ERRESS-PROBLEM)
 18209*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18210*        ENDFILE   (6630-END-OF-FILE)
 18211*    END-EXEC.
 18212*    MOVE '"$IcJ''                ! $ #00018185' TO DFHEIV0
 18213     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18215     MOVE X'2420233030303138313835' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0
 18217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18218
 18219
 18220
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 332
* EL050.cbl
 18221* EXEC CICS STARTBR
 18222*        DATASET (FILE-ID-ERRESS)
 18223*        RIDFLD  (WS-ERRESS-KEY)
 18224*        GTEQ
 18225*    END-EXEC.
 18226     MOVE 0
 18227       TO DFHEIV11
 18228*    MOVE '&,         G          &   #00018192' TO DFHEIV0
 18229     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18231     MOVE X'2020233030303138313932' TO DFHEIV0(25:11)
 18232     CALL 'kxdfhei1' USING DFHEIV0,
 18233           FILE-ID-ERRESS,
 18234           WS-ERRESS-KEY,
 18235           DFHEIV99,
 18236           DFHEIV11,
 18237           DFHEIV99
 18238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18239
 18240
 18241 6620-READ-NEXT-ERRESS-MASTER.
 18242
 18243
 18244* EXEC CICS HANDLE CONDITION
 18245*        NOTFND    (6630-END-OF-FILE)
 18246*        ENDFILE   (6630-END-OF-FILE)
 18247*        DISABLED  (6630-ERRESS-PROBLEM)
 18248*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18249*    END-EXEC.
 18250*    MOVE '"$I''cJ                ! % #00018200' TO DFHEIV0
 18251     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18253     MOVE X'2520233030303138323030' TO DFHEIV0(25:11)
 18254     CALL 'kxdfhei1' USING DFHEIV0
 18255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18256
 18257
 18258
 18259* EXEC CICS READNEXT
 18260*        DATASET (FILE-ID-ERRESS)
 18261*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18262*        RIDFLD  (WS-ERRESS-KEY)
 18263*    END-EXEC.
 18264     MOVE LENGTH OF
 18265      RESIDENT-STATE-TAX-MASTER
 18266       TO DFHEIV12
 18267     MOVE 0
 18268       TO DFHEIV11
 18269*    MOVE '&.IL                  )   #00018207' TO DFHEIV0
 18270     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18271     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18272     MOVE X'2020233030303138323037' TO DFHEIV0(25:11)
 18273     CALL 'kxdfhei1' USING DFHEIV0,
 18274           FILE-ID-ERRESS,
 18275           RESIDENT-STATE-TAX-MASTER,
 18276           DFHEIV12,
 18277           WS-ERRESS-KEY,
 18278           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 333
* EL050.cbl
 18279           DFHEIV11,
 18280           DFHEIV99,
 18281           DFHEIV99
 18282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18283
 18284
 18285     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18286
 18287* EXEC CICS ENDBR
 18288*            DATASET (FILE-ID-ERRESS)
 18289*       END-EXEC
 18290     MOVE 0
 18291       TO DFHEIV11
 18292*    MOVE '&2                    $   #00018214' TO DFHEIV0
 18293     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18294     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18295     MOVE X'2020233030303138323134' TO DFHEIV0(25:11)
 18296     CALL 'kxdfhei1' USING DFHEIV0,
 18297           FILE-ID-ERRESS,
 18298           DFHEIV11,
 18299           DFHEIV99
 18300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18301        GO TO 6630-END-OF-FILE.
 18302
 18303     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18304        NEXT SENTENCE
 18305      ELSE
 18306        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18307
 18308*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18309*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18310*
 18311     MOVE +2                     TO WS-SUB1.
 18312
 18313     IF PB-ISSUE
 18314     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18315        MOVE +1                  TO WS-SUB1.
 18316
 18317     IF PB-CANCELLATION
 18318     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18319        MOVE +1                  TO WS-SUB1.
 18320*
 18321*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18322*
 18323***  Y2K PROJ 7744
 18324     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18325***  Y2K PROJ 7744
 18326
 18327*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18328* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18329* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18330
 18331     ADD 1                    TO WS-YEAR-YY.
 18332
 18333     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18334         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18335                              TO WS-RES-STATE-TAX
 18336         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 334
* EL050.cbl
 18337                              TO WS-RES-MUNI-TAX
 18338     ELSE
 18339         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18340                              TO WS-RES-STATE-TAX
 18341         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18342                              TO WS-RES-MUNI-TAX.
 18343
 18344*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18345
 18346     IF PB-CANCELLATION
 18347         GO TO 6640-CANCEL-TAX.
 18348
 18349     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18350         COMPUTE PB-I-STATE-TAX ROUNDED =
 18351                                   PB-I-LF-PREMIUM-AMT
 18352                                 * WS-RES-STATE-TAX
 18353         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18354                                   PB-I-LF-PREMIUM-AMT
 18355                                 * WS-RES-MUNI-TAX
 18356     ELSE
 18357     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18358         COMPUTE PB-I-STATE-TAX ROUNDED =
 18359                                   PB-I-AH-PREMIUM-AMT
 18360                                 * WS-RES-STATE-TAX
 18361         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18362                                   PB-I-AH-PREMIUM-AMT
 18363                                 * WS-RES-MUNI-TAX.
 18364
 18365
 18366* EXEC CICS ENDBR
 18367*         DATASET (FILE-ID-ERRESS)
 18368*    END-EXEC.
 18369     MOVE 0
 18370       TO DFHEIV11
 18371*    MOVE '&2                    $   #00018281' TO DFHEIV0
 18372     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18373     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18374     MOVE X'2020233030303138323831' TO DFHEIV0(25:11)
 18375     CALL 'kxdfhei1' USING DFHEIV0,
 18376           FILE-ID-ERRESS,
 18377           DFHEIV11,
 18378           DFHEIV99
 18379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18380
 18381
 18382     GO TO 6640-EXIT.
 18383
 18384 6640-CANCEL-TAX.
 18385     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18386
 18387     IF PB-C-LF-CANCEL-AMT > ZEROS
 18388         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18389                                   PB-C-LF-CANCEL-AMT
 18390                                 * WS-RES-STATE-TAX
 18391         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18392                                   PB-C-LF-CANCEL-AMT
 18393                                *  WS-RES-MUNI-TAX
 18394     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 335
* EL050.cbl
 18395     IF PB-C-AH-CANCEL-AMT > ZEROS
 18396         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18397                                   PB-C-AH-CANCEL-AMT
 18398                                 * WS-RES-STATE-TAX
 18399         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18400                                   PB-C-AH-CANCEL-AMT
 18401                                *  WS-RES-MUNI-TAX.
 18402
 18403
 18404* EXEC CICS ENDBR
 18405*         DATASET (FILE-ID-ERRESS)
 18406*    END-EXEC.
 18407     MOVE 0
 18408       TO DFHEIV11
 18409*    MOVE '&2                    $   #00018306' TO DFHEIV0
 18410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303138333036' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0,
 18414           FILE-ID-ERRESS,
 18415           DFHEIV11,
 18416           DFHEIV99
 18417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18418
 18419
 18420     GO TO 6640-EXIT.
 18421
 18422 6630-END-OF-FILE.
 18423     MOVE ER-8002              TO WS-ERROR.
 18424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18425
 18426     GO TO 6640-EXIT.
 18427
 18428 6630-ERRESS-PROBLEM.
 18429     MOVE ER-8044              TO WS-ERROR.
 18430     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18431
 18432 6640-EXIT.
 18433     EXIT.
 18434
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 336
* EL050.cbl
 18436 6650-GET-RES-STATE-COMM.
 18437
 18438     IF PB-COMPANY-ID NOT = 'DMD'
 18439         GO TO 6700-COMM-EXIT.
 18440
 18441     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18442     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18443     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18444     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18445     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18446     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18447     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18448
 18449*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18450*
 18451***  Y2K PROJ 7744
 18452     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18453     SET BIN-TO-GREG          TO TRUE.
 18454     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18455
 18456     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18457***  Y2K PROJ 7744
 18458
 18459     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18460
 18461
 18462* EXEC CICS HANDLE CONDITION
 18463*        INVREQ    (6660-START-BROWSE)
 18464*        DISABLED  (6690-ERRESC-PROBLEM)
 18465*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18466*        NOTFND    (6690-END-OF-FILE)
 18467*    END-EXEC.
 18468*    MOVE '"$8cJI                ! & #00018351' TO DFHEIV0
 18469     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18471     MOVE X'2620233030303138333531' TO DFHEIV0(25:11)
 18472     CALL 'kxdfhei1' USING DFHEIV0
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18474
 18475
 18476
 18477* EXEC CICS RESETBR
 18478*        DATASET (FILE-ID-ERRESC)
 18479*        RIDFLD  (WS-ERRESC-KEY)
 18480*    END-EXEC.
 18481     MOVE 0
 18482       TO DFHEIV11
 18483*    MOVE '&4         G          &   #00018358' TO DFHEIV0
 18484     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18485     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18486     MOVE X'2020233030303138333538' TO DFHEIV0(25:11)
 18487     CALL 'kxdfhei1' USING DFHEIV0,
 18488           FILE-ID-ERRESC,
 18489           WS-ERRESC-KEY,
 18490           DFHEIV99,
 18491           DFHEIV11,
 18492           DFHEIV99
 18493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 337
* EL050.cbl
 18494
 18495
 18496 6660-START-BROWSE.
 18497
 18498
 18499* EXEC CICS HANDLE CONDITION
 18500*        NOTFND    (6690-END-OF-FILE)
 18501*        DISABLED  (6690-ERRESC-PROBLEM)
 18502*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18503*        ENDFILE   (6690-END-OF-FILE)
 18504*    END-EXEC.
 18505*    MOVE '"$IcJ''                ! '' #00018365' TO DFHEIV0
 18506     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18508     MOVE X'2720233030303138333635' TO DFHEIV0(25:11)
 18509     CALL 'kxdfhei1' USING DFHEIV0
 18510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18511
 18512
 18513
 18514* EXEC CICS STARTBR
 18515*        DATASET (FILE-ID-ERRESC)
 18516*        RIDFLD  (WS-ERRESC-KEY)
 18517*        GTEQ
 18518*    END-EXEC.
 18519     MOVE 0
 18520       TO DFHEIV11
 18521*    MOVE '&,         G          &   #00018372' TO DFHEIV0
 18522     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18523     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18524     MOVE X'2020233030303138333732' TO DFHEIV0(25:11)
 18525     CALL 'kxdfhei1' USING DFHEIV0,
 18526           FILE-ID-ERRESC,
 18527           WS-ERRESC-KEY,
 18528           DFHEIV99,
 18529           DFHEIV11,
 18530           DFHEIV99
 18531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18532
 18533
 18534     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18535
 18536 6670-READ-NEXT-ERRESC-MASTER.
 18537
 18538
 18539* EXEC CICS HANDLE CONDITION
 18540*        NOTFND    (6690-END-OF-FILE)
 18541*        DISABLED  (6690-ERRESC-PROBLEM)
 18542*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18543*        ENDFILE   (6690-END-OF-FILE)
 18544*    END-EXEC.
 18545*    MOVE '"$IcJ''                ! ( #00018382' TO DFHEIV0
 18546     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18548     MOVE X'2820233030303138333832' TO DFHEIV0(25:11)
 18549     CALL 'kxdfhei1' USING DFHEIV0
 18550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18551
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 338
* EL050.cbl
 18552
 18553
 18554* EXEC CICS READNEXT
 18555*        DATASET (FILE-ID-ERRESC)
 18556*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18557*        RIDFLD  (ERRESC-RECORD-KEY)
 18558*    END-EXEC.
 18559     MOVE LENGTH OF
 18560      ACCOUNT-RESIDENT-ST-COMMISSION
 18561       TO DFHEIV12
 18562     MOVE 0
 18563       TO DFHEIV11
 18564*    MOVE '&.IL                  )   #00018389' TO DFHEIV0
 18565     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303138333839' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           FILE-ID-ERRESC,
 18570           ACCOUNT-RESIDENT-ST-COMMISSION,
 18571           DFHEIV12,
 18572           ERRESC-RECORD-KEY,
 18573           DFHEIV99,
 18574           DFHEIV11,
 18575           DFHEIV99,
 18576           DFHEIV99
 18577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18578
 18579
 18580     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18581        NEXT SENTENCE
 18582     ELSE
 18583
 18584* EXEC CICS ENDBR
 18585*            DATASET (FILE-ID-ERRESC)
 18586*       END-EXEC
 18587     MOVE 0
 18588       TO DFHEIV11
 18589*    MOVE '&2                    $   #00018398' TO DFHEIV0
 18590     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18591     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18592     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 18593     CALL 'kxdfhei1' USING DFHEIV0,
 18594           FILE-ID-ERRESC,
 18595           DFHEIV11,
 18596           DFHEIV99
 18597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18598        GO TO 6690-END-OF-FILE.
 18599
 18600     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18601
 18602* EXEC CICS ENDBR
 18603*            DATASET (FILE-ID-ERRESC)
 18604*       END-EXEC
 18605     MOVE 0
 18606       TO DFHEIV11
 18607*    MOVE '&2                    $   #00018404' TO DFHEIV0
 18608     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 339
* EL050.cbl
 18610     MOVE X'2020233030303138343034' TO DFHEIV0(25:11)
 18611     CALL 'kxdfhei1' USING DFHEIV0,
 18612           FILE-ID-ERRESC,
 18613           DFHEIV11,
 18614           DFHEIV99
 18615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18616        GO TO 6690-END-OF-FILE.
 18617
 18618     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18619        NEXT SENTENCE
 18620      ELSE
 18621        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18622
 18623* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18624*
 18625     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18626
 18627     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18628
 18629     IF WS-SUB1 > ZERO
 18630         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18631             PERFORM 6680-SET-COMMISSION
 18632         ELSE
 18633             PERFORM 6680-SET-TABLE-CODE.
 18634
 18635
 18636* EXEC CICS ENDBR
 18637*         DATASET (FILE-ID-ERRESC)
 18638*    END-EXEC.
 18639     MOVE 0
 18640       TO DFHEIV11
 18641*    MOVE '&2                    $   #00018426' TO DFHEIV0
 18642     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18643     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18644     MOVE X'2020233030303138343236' TO DFHEIV0(25:11)
 18645     CALL 'kxdfhei1' USING DFHEIV0,
 18646           FILE-ID-ERRESC,
 18647           DFHEIV11,
 18648           DFHEIV99
 18649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18650
 18651
 18652     GO TO 6700-COMM-EXIT.
 18653
 18654 6680-SET-TABLE-CODE.
 18655     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18656        MOVE ZEROS             TO WS-SUB1
 18657     ELSE
 18658* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18659* TO COMPUTE AH COMMISSION.
 18660        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18661        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18662        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18663        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18664        PERFORM 6680-READ-CTBL-TABLE
 18665        IF WS-CTBL-READ-SW NOT = 'Y'
 18666           MOVE ZEROS          TO WS-SUB1.
 18667
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 340
* EL050.cbl
 18668 6680-READ-CTBL-TABLE.
 18669*
 18670* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18671* TO COMPUTE LIFE COMMISSION
 18672
 18673     IF CTBL-SW = '0540'
 18674        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18675        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18676        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18677
 18678     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18679
 18680     IF CTBL-TABLE-FOUND
 18681        IF CTBL-SW = '0530'
 18682             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18683                                    * PB-I-AH-TERM
 18684             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18685             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18686        ELSE
 18687             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18688             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18689             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18690     ELSE
 18691        IF FIRST-TIME-THROUGH
 18692            GO TO 6680-READ-CTBL-TABLE
 18693        ELSE
 18694            MOVE ZEROS         TO WS-SUB1.
 18695
 18696 6680-SET-COMMISSION.
 18697     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18698           MOVE ZEROS          TO WS-SUB1
 18699       ELSE
 18700           MOVE RESC-COMMISSION-PER (WS-SUB)
 18701                               TO WS-COMMISSION
 18702           IF CTBL-SW = '0530'
 18703               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18704           ELSE
 18705               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18706
 18707 6680-SEARCH-CATEGORY.
 18708     ADD +1                   TO WS-SUB.
 18709     IF WS-SUB > +12
 18710         GO TO 6680-EXIT.
 18711
 18712     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18713          MOVE WS-SUB         TO WS-SUB1
 18714          GO TO 6680-EXIT.
 18715
 18716     GO TO 6680-SEARCH-CATEGORY.
 18717
 18718 6680-EXIT.
 18719     EXIT.
 18720
 18721 6690-END-OF-FILE.
 18722     GO TO 6700-COMM-EXIT.
 18723
 18724 6690-ERRESC-PROBLEM.
 18725      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 341
* EL050.cbl
 18726      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18727
 18728      GO TO 6700-COMM-EXIT.
 18729
 18730 6700-COMM-EXIT.
 18731     EXIT.
 18732
 18733 7000-GET-RATE.
 18734
 18735* EXEC CICS LINK
 18736*        PROGRAM    ('ELRATE')
 18737*        COMMAREA   (CALCULATION-PASS-AREA)
 18738*        LENGTH     (CP-COMM-LENGTH)
 18739*    END-EXEC.
 18740     MOVE 'ELRATE' TO DFHEIV1
 18741*    MOVE '."C                   (   #00018512' TO DFHEIV0
 18742     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18744     MOVE X'2020233030303138353132' TO DFHEIV0(25:11)
 18745     CALL 'kxdfhei1' USING DFHEIV0,
 18746           DFHEIV1,
 18747           CALCULATION-PASS-AREA,
 18748           CP-COMM-LENGTH,
 18749           DFHEIV99,
 18750           DFHEIV99,
 18751           DFHEIV99,
 18752           DFHEIV99
 18753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18754
 18755
 18756 7000-EXIT.
 18757     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 342
* EL050.cbl
 18759 7100-FIND-BENEFIT-IN-STATE.
 18760     MOVE 'N'                    TO BEN-SEARCH-SW.
 18761
 18762     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18763         VARYING SUB3 FROM 1 BY 1 UNTIL
 18764            ((SUB3 GREATER 50) OR
 18765              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18766               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18767
 18768     IF SUB3 NOT = 51
 18769         MOVE 'Y'                TO BEN-SEARCH-SW.
 18770
 18771     GO TO 7199-EXIT.
 18772
 18773 7100-BENEFIT-DUMMY.
 18774
 18775 7100-DUMMY-EXIT.
 18776     EXIT.
 18777
 18778 7199-EXIT.
 18779     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 343
* EL050.cbl
 18781 7200-FIND-BENEFIT.
 18782     MOVE 'N'                    TO BEN-SEARCH-SW.
 18783
 18784     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18785         VARYING SUB3 FROM 1 BY 1 UNTIL
 18786            ((SUB3 GREATER 8) OR
 18787            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18788
 18789     IF SUB3 NOT = 9
 18790         MOVE 'Y'                TO BEN-SEARCH-SW.
 18791
 18792     GO TO 7200-EXIT.
 18793
 18794 7200-BENEFIT-DUMMY.
 18795
 18796 7200-DUMMY-EXIT.
 18797     EXIT.
 18798
 18799 7200-EXIT.
 18800     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 344
* EL050.cbl
 18802 7250-LOOK-FOR-RESCINDED-CLAIM.
 18803     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18804                                    W-CL-COMP-CD.
 18805     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18806                                    W-CL-CERT-NO.
 18807
 18808
 18809* EXEC CICS HANDLE CONDITION
 18810*        NOTFND  (7250-CONTINUE)
 18811*        ENDFILE (7250-CONTINUE)
 18812*    END-EXEC.
 18813*    MOVE '"$I''                  ! ) #00018570' TO DFHEIV0
 18814     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18816     MOVE X'2920233030303138353730' TO DFHEIV0(25:11)
 18817     CALL 'kxdfhei1' USING DFHEIV0
 18818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18819
 18820
 18821
 18822* EXEC CICS IGNORE CONDITION
 18823*        DUPKEY
 18824*    END-EXEC.
 18825*    MOVE '"*$                   !   #00018575' TO DFHEIV0
 18826     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18828     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 18829     CALL 'kxdfhei1' USING DFHEIV0
 18830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18831
 18832
 18833
 18834* EXEC CICS STARTBR
 18835*        DATASET   (CLMS-ID)
 18836*        RIDFLD    (ELMSTR-KEY)
 18837*        GENERIC   EQUAL
 18838*        KEYLENGTH (ELMSTR-LENGTH)
 18839*    END-EXEC.
 18840     MOVE 0
 18841       TO DFHEIV11
 18842*    MOVE '&,   KG    E          &   #00018579' TO DFHEIV0
 18843     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18845     MOVE X'2020233030303138353739' TO DFHEIV0(25:11)
 18846     CALL 'kxdfhei1' USING DFHEIV0,
 18847           CLMS-ID,
 18848           ELMSTR-KEY,
 18849           ELMSTR-LENGTH,
 18850           DFHEIV11,
 18851           DFHEIV99
 18852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18853
 18854
 18855     MOVE 'Y'                    TO W-BROWSE-SW.
 18856
 18857 7250-NEXT-CLAIM.
 18858
 18859
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 345
* EL050.cbl
 18860* EXEC CICS READNEXT
 18861*        DATASET   (CLMS-ID)
 18862*        RIDFLD    (ELMSTR-KEY)
 18863*        SET       (ADDRESS OF CLAIM-MASTER)
 18864*    END-EXEC.
 18865     MOVE 0
 18866       TO DFHEIV11
 18867*    MOVE '&.S                   )   #00018590' TO DFHEIV0
 18868     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18870     MOVE X'2020233030303138353930' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0,
 18872           CLMS-ID,
 18873           DFHEIV20,
 18874           DFHEIV99,
 18875           ELMSTR-KEY,
 18876           DFHEIV99,
 18877           DFHEIV11,
 18878           DFHEIV99,
 18879           DFHEIV99
 18880     SET ADDRESS OF CLAIM-MASTER TO
 18881         DFHEIV20
 18882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18883
 18884
 18885     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18886        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18887         GO TO 7250-CONTINUE
 18888     END-IF.
 18889
 18890     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18891        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18892        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18893        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18894        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18895         GO TO 7250-NEXT-CLAIM
 18896     END-IF.
 18897
 18898     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18899        OR (CL-CLAIM-TYPE = 'I')
 18900        OR (CL-CLAIM-TYPE = 'G')
 18901        OR (CL-CLAIM-TYPE = 'F')
 18902          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18903              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18904              GO TO 7250-CONTINUE
 18905          END-IF
 18906     END-IF.
 18907
 18908     GO TO 7250-NEXT-CLAIM.
 18909
 18910 7250-CONTINUE.
 18911
 18912     IF W-BROWSE-SW = 'Y'
 18913
 18914* EXEC CICS ENDBR
 18915*            DATASET   (CLMS-ID)
 18916*        END-EXEC
 18917     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 346
* EL050.cbl
 18918       TO DFHEIV11
 18919*    MOVE '&2                    $   #00018624' TO DFHEIV0
 18920     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18922     MOVE X'2020233030303138363234' TO DFHEIV0(25:11)
 18923     CALL 'kxdfhei1' USING DFHEIV0,
 18924           CLMS-ID,
 18925           DFHEIV11,
 18926           DFHEIV99
 18927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18928         MOVE 'N' TO W-BROWSE-SW
 18929     END-IF.
 18930
 18931 7250-EXIT.
 18932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 347
* EL050.cbl
 18934 7300-CHECK-FOR-OPEN-CLMS.
 18935
 18936*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18937*    MOVE SPACES                 TO CNTL-ACCESS.
 18938*    MOVE '1'                    TO CNTL-REC-TYPE.
 18939*    MOVE +0                     TO CNTL-SEQ-NO.
 18940
 18941*    MOVE '3'                    TO RC-SW-1.
 18942*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18943
 18944*    IF NOT CF-COMPANY-MASTER
 18945*         PERFORM 0099-COMPANY-NOT-FOUND
 18946*         GO TO 7300-EXIT.
 18947
 18948     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18949                                    W-CL-COMP-CD.
 18950     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18951                                    W-CL-CERT-NO.
 18952
 18953
 18954* EXEC CICS HANDLE CONDITION
 18955*        NOTFND  (7300-CONTINUE)
 18956*        ENDFILE (7300-CONTINUE)
 18957*    END-EXEC.
 18958*    MOVE '"$I''                  ! * #00018652' TO DFHEIV0
 18959     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18961     MOVE X'2A20233030303138363532' TO DFHEIV0(25:11)
 18962     CALL 'kxdfhei1' USING DFHEIV0
 18963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18964
 18965
 18966
 18967* EXEC CICS IGNORE CONDITION
 18968*        DUPKEY
 18969*    END-EXEC.
 18970*    MOVE '"*$                   !   #00018657' TO DFHEIV0
 18971     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18973     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 18974     CALL 'kxdfhei1' USING DFHEIV0
 18975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18976
 18977
 18978
 18979* EXEC CICS STARTBR
 18980*        DATASET   (CLMS-ID)
 18981*        RIDFLD    (ELMSTR-KEY)
 18982*        GENERIC   EQUAL
 18983*        KEYLENGTH (ELMSTR-LENGTH)
 18984*    END-EXEC.
 18985     MOVE 0
 18986       TO DFHEIV11
 18987*    MOVE '&,   KG    E          &   #00018661' TO DFHEIV0
 18988     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18990     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 348
* EL050.cbl
 18992           CLMS-ID,
 18993           ELMSTR-KEY,
 18994           ELMSTR-LENGTH,
 18995           DFHEIV11,
 18996           DFHEIV99
 18997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18998
 18999
 19000     MOVE 'Y'                    TO W-BROWSE-SW.
 19001
 19002 7300-NEXT-CLAIM.
 19003
 19004
 19005* EXEC CICS READNEXT
 19006*        DATASET   (CLMS-ID)
 19007*        RIDFLD    (ELMSTR-KEY)
 19008*        SET       (ADDRESS OF CLAIM-MASTER)
 19009*    END-EXEC.
 19010     MOVE 0
 19011       TO DFHEIV11
 19012*    MOVE '&.S                   )   #00018672' TO DFHEIV0
 19013     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19015     MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0,
 19017           CLMS-ID,
 19018           DFHEIV20,
 19019           DFHEIV99,
 19020           ELMSTR-KEY,
 19021           DFHEIV99,
 19022           DFHEIV11,
 19023           DFHEIV99,
 19024           DFHEIV99
 19025     SET ADDRESS OF CLAIM-MASTER TO
 19026         DFHEIV20
 19027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19028
 19029
 19030     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19031        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19032         GO TO 7300-CONTINUE.
 19033
 19034     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19035        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19036        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19037        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19038        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19039         GO TO 7300-NEXT-CLAIM.
 19040
 19041*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19042     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19043        OR (CL-CLAIM-TYPE = 'I')
 19044        OR (CL-CLAIM-TYPE = 'G')
 19045        OR (CL-CLAIM-TYPE = 'F')
 19046        IF CLAIM-IS-OPEN
 19047           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19048             AND PB-C-AH-CANCEL-DT > SPACES
 19049              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 349
* EL050.cbl
 19050              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19051           END-IF
 19052           EVALUATE TRUE
 19053             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19054                 MOVE ER-2884      TO WS-ERROR
 19055             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19056                 MOVE ER-2887      TO WS-ERROR
 19057             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19058                 MOVE ER-2886      TO WS-ERROR
 19059             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19060                 MOVE ER-2888      TO WS-ERROR
 19061             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19062                 MOVE ER-2885      TO WS-ERROR
 19063             WHEN OTHER
 19064                 MOVE ER-2768      TO WS-ERROR
 19065           END-EVALUATE
 19066           IF PB-C-AH-CANCEL-VOIDED OR
 19067              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19068                NOT AH-COVERAGE-CANCELLED)
 19069               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19070               MOVE ER-2768      TO WS-ERROR
 19071           END-IF
 19072           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19073           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19074              PB-FORCE-CODE NOT EQUAL '8'
 19075               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19076           END-IF
 19077           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19078           GO TO 7300-NEXT-CLAIM
 19079        ELSE
 19080           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19081*****THIS IS A RESCISSION OR REFORMATION
 19082              IF AH-COVERAGE-CANCELLED
 19083                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19084                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19085                    MOVE 1                   TO DC-ELAPSED-DAYS
 19086                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19087                    SET BIN-PLUS-ELAPSED     TO TRUE
 19088                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19089                    IF NO-CONVERSION-ERROR
 19090                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19091                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19092                          MOVE ER-2897 TO WS-ERROR
 19093                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19094                          GO TO 7300-NEXT-CLAIM
 19095                       END-IF
 19096                    END-IF
 19097                 ELSE
 19098                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19099                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19100                         MOVE ER-2890 TO WS-ERROR
 19101                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19102                         GO TO 7300-NEXT-CLAIM
 19103                      ELSE
 19104                         MOVE ER-2898 TO WS-ERROR
 19105                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19106                         GO TO 7300-NEXT-CLAIM
 19107                      END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 350
* EL050.cbl
 19108                   END-IF
 19109                 END-IF
 19110              END-IF
 19111           ELSE
 19112              IF CL-DENIAL-TYPE = '1'  AND
 19113                 CL-TOTAL-PAID-AMT = 0
 19114                    GO TO 7300-NEXT-CLAIM
 19115              END-IF
 19116              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19117               AND PB-C-AH-CANCEL-DT > SPACES
 19118                 MOVE ER-2756        TO WS-ERROR
 19119                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19120                 GO TO 7300-NEXT-CLAIM
 19121              END-IF
 19122           END-IF
 19123        END-IF
 19124     ELSE
 19125*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19126        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19127           IF CLAIM-IS-OPEN
 19128              MOVE ER-2889      TO WS-ERROR
 19129              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19130              GO TO 7300-NEXT-CLAIM
 19131           ELSE
 19132              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19133*****THIS IS A RESCISSION OR REFORMATION
 19134                 IF (LF-COVERAGE-CANCELLED AND
 19135                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19136                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19137                         MOVE ER-2890 TO WS-ERROR
 19138                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19139                         GO TO 7300-NEXT-CLAIM
 19140                      ELSE
 19141                         MOVE ER-2898 TO WS-ERROR
 19142                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19143                         GO TO 7300-NEXT-CLAIM
 19144                      END-IF
 19145                 END-IF
 19146              ELSE
 19147                 IF CL-DENIAL-TYPE = '1'  AND
 19148                    CL-TOTAL-PAID-AMT = 0
 19149                       GO TO 7300-NEXT-CLAIM
 19150                 END-IF
 19151                 IF (AH-COVERAGE-CANCELLED AND
 19152                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19153                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19154                    (LF-COVERAGE-CANCELLED AND
 19155                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19156                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19157                       MOVE ER-2965 TO WS-ERROR
 19158                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19159                       GO TO 7300-NEXT-CLAIM
 19160                 END-IF
 19161                 IF LF-COVERAGE-CANCELLED
 19162                  IF CL-TOTAL-PAID-AMT > 0
 19163                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19164                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19165                        MOVE ER-2891 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 351
* EL050.cbl
 19166                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19167                        GO TO 7300-NEXT-CLAIM
 19168                      END-IF
 19169                    ELSE
 19170****only show this error if cert num matches exactly
 19171                      IF PB-CERT-NO = CL-CERT-NO
 19172                         MOVE ER-2892 TO WS-ERROR
 19173                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19174                         GO TO 7300-NEXT-CLAIM
 19175                      END-IF
 19176                    END-IF
 19177                  END-IF
 19178                 END-IF
 19179              END-IF
 19180           END-IF
 19181        END-IF
 19182     END-IF
 19183
 19184     GO TO 7300-NEXT-CLAIM.
 19185
 19186 7300-CONTINUE.
 19187
 19188     IF W-BROWSE-SW = 'Y'
 19189
 19190* EXEC CICS ENDBR
 19191*            DATASET   (CLMS-ID)
 19192*        END-EXEC.
 19193     MOVE 0
 19194       TO DFHEIV11
 19195*    MOVE '&2                    $   #00018837' TO DFHEIV0
 19196     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19197     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19198     MOVE X'2020233030303138383337' TO DFHEIV0(25:11)
 19199     CALL 'kxdfhei1' USING DFHEIV0,
 19200           CLMS-ID,
 19201           DFHEIV11,
 19202           DFHEIV99
 19203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19204
 19205
 19206 7300-EXIT.
 19207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 352
* EL050.cbl
 19209
 19210 7400-GET-REMAIN-TERM.
 19211
 19212* EXEC CICS LINK
 19213*        PROGRAM    ('ELRTRM')
 19214*        COMMAREA   (CALCULATION-PASS-AREA)
 19215*        LENGTH     (CP-COMM-LENGTH)
 19216*    END-EXEC.
 19217     MOVE 'ELRTRM' TO DFHEIV1
 19218*    MOVE '."C                   (   #00018846' TO DFHEIV0
 19219     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19221     MOVE X'2020233030303138383436' TO DFHEIV0(25:11)
 19222     CALL 'kxdfhei1' USING DFHEIV0,
 19223           DFHEIV1,
 19224           CALCULATION-PASS-AREA,
 19225           CP-COMM-LENGTH,
 19226           DFHEIV99,
 19227           DFHEIV99,
 19228           DFHEIV99,
 19229           DFHEIV99
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19231
 19232
 19233 7400-EXIT.
 19234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 353
* EL050.cbl
 19236
 19237 7500-GET-REMAIN-AMOUNT.
 19238
 19239* EXEC CICS LINK
 19240*        PROGRAM    ('ELRAMT')
 19241*        COMMAREA   (CALCULATION-PASS-AREA)
 19242*        LENGTH     (CP-COMM-LENGTH)
 19243*    END-EXEC.
 19244     MOVE 'ELRAMT' TO DFHEIV1
 19245*    MOVE '."C                   (   #00018857' TO DFHEIV0
 19246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19248     MOVE X'2020233030303138383537' TO DFHEIV0(25:11)
 19249     CALL 'kxdfhei1' USING DFHEIV0,
 19250           DFHEIV1,
 19251           CALCULATION-PASS-AREA,
 19252           CP-COMM-LENGTH,
 19253           DFHEIV99,
 19254           DFHEIV99,
 19255           DFHEIV99,
 19256           DFHEIV99
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19258
 19259
 19260 7500-EXIT.
 19261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 354
* EL050.cbl
 19263
 19264 7600-GET-REFUND.
 19265
 19266* EXEC CICS LINK
 19267*        PROGRAM    ('ELRFND')
 19268*        COMMAREA   (CALCULATION-PASS-AREA)
 19269*        LENGTH     (CP-COMM-LENGTH)
 19270*    END-EXEC.
 19271     MOVE 'ELRFND' TO DFHEIV1
 19272*    MOVE '."C                   (   #00018868' TO DFHEIV0
 19273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19275     MOVE X'2020233030303138383638' TO DFHEIV0(25:11)
 19276     CALL 'kxdfhei1' USING DFHEIV0,
 19277           DFHEIV1,
 19278           CALCULATION-PASS-AREA,
 19279           CP-COMM-LENGTH,
 19280           DFHEIV99,
 19281           DFHEIV99,
 19282           DFHEIV99,
 19283           DFHEIV99
 19284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19285
 19286
 19287 7600-EXIT.
 19288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 355
* EL050.cbl
 19290 7700-CALL-DL1.
 19291
 19292* EXEC CICS LINK
 19293*        PROGRAM    ('DLO001')
 19294*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19295*        LENGTH     (DLO001-COMM-LENGTH)
 19296*    END-EXEC.
 19297     MOVE 'DLO001' TO DFHEIV1
 19298*    MOVE '."C                   (   #00018878' TO DFHEIV0
 19299     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19301     MOVE X'2020233030303138383738' TO DFHEIV0(25:11)
 19302     CALL 'kxdfhei1' USING DFHEIV0,
 19303           DFHEIV1,
 19304           WS-DLO-MASTER-POLICY-FORM,
 19305           DLO001-COMM-LENGTH,
 19306           DFHEIV99,
 19307           DFHEIV99,
 19308           DFHEIV99,
 19309           DFHEIV99
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19311
 19312
 19313 7700-EXIT.
 19314     EXIT.
 19315
 19316 7710-CALL-DL2.
 19317
 19318* EXEC CICS LINK
 19319*        PROGRAM    ('DLO002')
 19320*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19321*        LENGTH     (DLO002-COMM-LENGTH)
 19322*    END-EXEC.
 19323     MOVE 'DLO002' TO DFHEIV1
 19324*    MOVE '."C                   (   #00018888' TO DFHEIV0
 19325     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19327     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19328     CALL 'kxdfhei1' USING DFHEIV0,
 19329           DFHEIV1,
 19330           WS-DLO-INTERNAL-POLICY-FORM,
 19331           DLO002-COMM-LENGTH,
 19332           DFHEIV99,
 19333           DFHEIV99,
 19334           DFHEIV99,
 19335           DFHEIV99
 19336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19337
 19338
 19339 7710-EXIT.
 19340     EXIT.
 19341
 19342 7720-CALL-DL3.
 19343
 19344* EXEC CICS LINK
 19345*        PROGRAM    ('DLO003')
 19346*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19347*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 356
* EL050.cbl
 19348*    END-EXEC.
 19349     MOVE 'DLO003' TO DFHEIV1
 19350*    MOVE '."C                   (   #00018898' TO DFHEIV0
 19351     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303138383938' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0,
 19355           DFHEIV1,
 19356           WS-DLO-VALID-BANK-ID,
 19357           DLO003-COMM-LENGTH,
 19358           DFHEIV99,
 19359           DFHEIV99,
 19360           DFHEIV99,
 19361           DFHEIV99
 19362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19363
 19364
 19365 7720-EXIT.
 19366     EXIT.
 19367
 19368 7730-CALL-DL7.
 19369
 19370* EXEC CICS LINK
 19371*        PROGRAM    ('DLO007')
 19372*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19373*        LENGTH     (DLO007-COMM-LENGTH)
 19374*    END-EXEC.
 19375     MOVE 'DLO007' TO DFHEIV1
 19376*    MOVE '."C                   (   #00018908' TO DFHEIV0
 19377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303138393038' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           DFHEIV1,
 19382           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19383           DLO007-COMM-LENGTH,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV99,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391 7730-EXIT.
 19392     EXIT.
 19393
 19394 7740-CALL-DL11.
 19395
 19396* EXEC CICS LINK
 19397*        PROGRAM    ('DLO011')
 19398*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19399*        LENGTH     (DLO011-COMM-LENGTH)
 19400*    END-EXEC.
 19401     MOVE 'DLO011' TO DFHEIV1
 19402*    MOVE '."C                   (   #00018918' TO DFHEIV0
 19403     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19405     MOVE X'2020233030303138393138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 357
* EL050.cbl
 19406     CALL 'kxdfhei1' USING DFHEIV0,
 19407           DFHEIV1,
 19408           WS-DLO-PREM-RATES-BEN-TYPE,
 19409           DLO011-COMM-LENGTH,
 19410           DFHEIV99,
 19411           DFHEIV99,
 19412           DFHEIV99,
 19413           DFHEIV99
 19414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19415
 19416
 19417 7740-EXIT.
 19418     EXIT.
 19419
 19420 7750-CALL-DL17.
 19421
 19422* EXEC CICS LINK
 19423*        PROGRAM    ('DLO017')
 19424*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19425*        LENGTH     (DLO017-COMM-LENGTH)
 19426*    END-EXEC.
 19427     MOVE 'DLO017' TO DFHEIV1
 19428*    MOVE '."C                   (   #00018928' TO DFHEIV0
 19429     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303138393238' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           DFHEIV1,
 19434           WS-DLO-VALID-RATE-CODE,
 19435           DLO017-COMM-LENGTH,
 19436           DFHEIV99,
 19437           DFHEIV99,
 19438           DFHEIV99,
 19439           DFHEIV99
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19441
 19442
 19443 7750-EXIT.
 19444     EXIT.
 19445
 19446 7755-CALL-DL19.
 19447
 19448* EXEC CICS LINK
 19449*        PROGRAM    ('DLO019')
 19450*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19451*        LENGTH     (DLO019-COMM-LENGTH)
 19452*    END-EXEC.
 19453     MOVE 'DLO019' TO DFHEIV1
 19454*    MOVE '."C                   (   #00018938' TO DFHEIV0
 19455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19457     MOVE X'2020233030303138393338' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0,
 19459           DFHEIV1,
 19460           WS-DLO-ORIG-COV-CAT,
 19461           DLO019-COMM-LENGTH,
 19462           DFHEIV99,
 19463           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 358
* EL050.cbl
 19464           DFHEIV99,
 19465           DFHEIV99
 19466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19467
 19468
 19469 7755-EXIT.
 19470     EXIT.
 19471
 19472 7760-CALL-DL21.
 19473
 19474* EXEC CICS LINK
 19475*        PROGRAM    ('DLO021')
 19476*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19477*        LENGTH     (DLO021-COMM-LENGTH)
 19478*    END-EXEC.
 19479     MOVE 'DLO021' TO DFHEIV1
 19480*    MOVE '."C                   (   #00018948' TO DFHEIV0
 19481     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19483     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 19484     CALL 'kxdfhei1' USING DFHEIV0,
 19485           DFHEIV1,
 19486           WS-DLO-VALID-LOAN-OFFICER,
 19487           DLO021-COMM-LENGTH,
 19488           DFHEIV99,
 19489           DFHEIV99,
 19490           DFHEIV99,
 19491           DFHEIV99
 19492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19493
 19494
 19495 7760-EXIT.
 19496     EXIT.
 19497
 19498 7770-CALL-DL22.
 19499
 19500* EXEC CICS LINK
 19501*        PROGRAM    ('DLO022')
 19502*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19503*        LENGTH     (DLO022-COMM-LENGTH)
 19504*    END-EXEC.
 19505     MOVE 'DLO022' TO DFHEIV1
 19506*    MOVE '."C                   (   #00018958' TO DFHEIV0
 19507     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19509     MOVE X'2020233030303138393538' TO DFHEIV0(25:11)
 19510     CALL 'kxdfhei1' USING DFHEIV0,
 19511           DFHEIV1,
 19512           WS-DLO-VALID-STATE-CODE,
 19513           DLO022-COMM-LENGTH,
 19514           DFHEIV99,
 19515           DFHEIV99,
 19516           DFHEIV99,
 19517           DFHEIV99
 19518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19519
 19520
 19521 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 359
* EL050.cbl
 19522     EXIT.
 19523
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 360
* EL050.cbl
 19525
 19526 7800-REWRITE-CERT.
 19527******************************************************************
 19528*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19529*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19530******************************************************************
 19531
 19532     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19533        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19534        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19535        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19536
 19537* EXEC CICS REWRITE
 19538*                  DATASET (CERT-ID)
 19539*                  FROM    (CERTIFICATE-MASTER)
 19540*              END-EXEC
 19541     MOVE LENGTH OF
 19542      CERTIFICATE-MASTER
 19543       TO DFHEIV11
 19544*    MOVE '&& L                  %   #00018979' TO DFHEIV0
 19545     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303138393739' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           CERT-ID,
 19550           CERTIFICATE-MASTER,
 19551           DFHEIV11,
 19552           DFHEIV99
 19553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19554        GO TO 7800-EXIT.
 19555
 19556       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19557       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19558
 19559 7800-EXIT.
 19560      EXIT.
 19561
 19562 7900-DELETE-CERT.
 19563
 19564* EXEC CICS DELETE
 19565*        DATASET (CERT-ID)
 19566*    END-EXEC.
 19567*    MOVE '&(                    &   #00018992' TO DFHEIV0
 19568     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19569     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19570     MOVE X'2020233030303138393932' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0,
 19572           CERT-ID,
 19573           DFHEIV99,
 19574           DFHEIV99,
 19575           DFHEIV99,
 19576           DFHEIV99
 19577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19578
 19579
 19580 7900-EXIT.
 19581     EXIT.
 19582
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 361
* EL050.cbl
 19583 8000-WRITE-CERT.
 19584
 19585* EXEC CICS HANDLE CONDITION
 19586*        DUPKEY    (8000-FREE-MAIN)
 19587*    END-EXEC.
 19588*    MOVE '"$$                   ! + #00019000' TO DFHEIV0
 19589     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19591     MOVE X'2B20233030303139303030' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0
 19593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19594
 19595
 19596
 19597* EXEC CICS WRITE
 19598*        DATASET     (CERT-ID)
 19599*        FROM        (CERTIFICATE-MASTER)
 19600*        RIDFLD      (ELCERT-KEY)
 19601*    END-EXEC.
 19602     MOVE LENGTH OF
 19603      CERTIFICATE-MASTER
 19604       TO DFHEIV11
 19605*    MOVE '&$ L                  ''   #00019004' TO DFHEIV0
 19606     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19607     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19608     MOVE X'2020233030303139303034' TO DFHEIV0(25:11)
 19609     CALL 'kxdfhei1' USING DFHEIV0,
 19610           CERT-ID,
 19611           CERTIFICATE-MASTER,
 19612           DFHEIV11,
 19613           ELCERT-KEY,
 19614           DFHEIV99,
 19615           DFHEIV99
 19616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19617
 19618
 19619 8000-FREE-MAIN.
 19620
 19621 8000-EXIT.
 19622      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 362
* EL050.cbl
 19624
 19625 8100-READ-ERPNDM.
 19626
 19627* EXEC CICS HANDLE CONDITION
 19628*         NOTFND     (8100-NOTFND)
 19629*         ENDFILE    (8100-NOTFND)
 19630*    END-EXEC.
 19631*    MOVE '"$I''                  ! , #00019017' TO DFHEIV0
 19632     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19634     MOVE X'2C20233030303139303137' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0
 19636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19637
 19638
 19639     MOVE SPACES                 TO ERPNDM-FOUND.
 19640     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19641
 19642
 19643* EXEC CICS READ
 19644*         DATASET   (FILE-ERPNDM)
 19645*         RIDFLD    (PM-CONTROL-PRIMARY)
 19646*         INTO      (PENDING-MAILING-DATA)
 19647*    END-EXEC.
 19648     MOVE LENGTH OF
 19649      PENDING-MAILING-DATA
 19650       TO DFHEIV11
 19651*    MOVE '&"IL       E          (   #00019025' TO DFHEIV0
 19652     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19654     MOVE X'2020233030303139303235' TO DFHEIV0(25:11)
 19655     CALL 'kxdfhei1' USING DFHEIV0,
 19656           FILE-ERPNDM,
 19657           PENDING-MAILING-DATA,
 19658           DFHEIV11,
 19659           PM-CONTROL-PRIMARY,
 19660           DFHEIV99,
 19661           DFHEIV99,
 19662           DFHEIV99
 19663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19664
 19665
 19666     GO TO 8100-EXIT.
 19667
 19668 8100-NOTFND.
 19669
 19670     MOVE 'X'                    TO ERPNDM-FOUND.
 19671     MOVE ER-2694                TO WS-ERROR.
 19672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19673     MOVE ER-2883                TO WS-ERROR
 19674     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19675     .
 19676 8100-EXIT.
 19677     EXIT.
 19678
 19679 8110-READ-ERMAIL.
 19680
 19681* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 363
* EL050.cbl
 19682*         NOTFND     (8110-NOTFND)
 19683*         ENDFILE    (8110-NOTFND)
 19684*    END-EXEC.
 19685*    MOVE '"$I''                  ! - #00019045' TO DFHEIV0
 19686     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19688     MOVE X'2D20233030303139303435' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     MOVE SPACES                 TO ERMAIL-FOUND.
 19694     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19695     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19696     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19697     MOVE PB-SV-STATE            TO MA-STATE.
 19698
 19699
 19700* EXEC CICS READ
 19701*         UPDATE
 19702*         DATASET   (FILE-ERMAIL)
 19703*         RIDFLD    (MA-CONTROL-PRIMARY)
 19704*         INTO      (MAILING-DATA)
 19705*    END-EXEC.
 19706     MOVE LENGTH OF
 19707      MAILING-DATA
 19708       TO DFHEIV11
 19709*    MOVE '&"IL       EU         (   #00019056' TO DFHEIV0
 19710     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19711     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19712     MOVE X'2020233030303139303536' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0,
 19714           FILE-ERMAIL,
 19715           MAILING-DATA,
 19716           DFHEIV11,
 19717           MA-CONTROL-PRIMARY,
 19718           DFHEIV99,
 19719           DFHEIV99,
 19720           DFHEIV99
 19721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19722
 19723
 19724     GO TO 8110-EXIT.
 19725
 19726 8110-NOTFND.
 19727     MOVE 'X'                    TO ERMAIL-FOUND.
 19728
 19729 8110-EXIT.
 19730     EXIT.
 19731
 19732 8120-REWRITE-ERMAIL.
 19733
 19734* EXEC CICS REWRITE
 19735*         DATASET    (FILE-ERMAIL)
 19736*         FROM       (MAILING-DATA)
 19737*    END-EXEC.
 19738     MOVE LENGTH OF
 19739      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 364
* EL050.cbl
 19740       TO DFHEIV11
 19741*    MOVE '&& L                  %   #00019072' TO DFHEIV0
 19742     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19744     MOVE X'2020233030303139303732' TO DFHEIV0(25:11)
 19745     CALL 'kxdfhei1' USING DFHEIV0,
 19746           FILE-ERMAIL,
 19747           MAILING-DATA,
 19748           DFHEIV11,
 19749           DFHEIV99
 19750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19751
 19752
 19753 8120-EXIT.
 19754     EXIT.
 19755
 19756 8130-WRITE-ERMAIL.
 19757
 19758* EXEC CICS HANDLE CONDITION
 19759*         DUPKEY   (8130-EXIT)
 19760*    END-EXEC.
 19761*    MOVE '"$$                   ! . #00019081' TO DFHEIV0
 19762     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19764     MOVE X'2E20233030303139303831' TO DFHEIV0(25:11)
 19765     CALL 'kxdfhei1' USING DFHEIV0
 19766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19767
 19768
 19769
 19770* EXEC CICS WRITE
 19771*         DATASET     (FILE-ERMAIL)
 19772*         RIDFLD      (MA-CONTROL-PRIMARY)
 19773*         FROM        (MAILING-DATA)
 19774*    END-EXEC.
 19775     MOVE LENGTH OF
 19776      MAILING-DATA
 19777       TO DFHEIV11
 19778*    MOVE '&$ L                  ''   #00019085' TO DFHEIV0
 19779     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19781     MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
 19782     CALL 'kxdfhei1' USING DFHEIV0,
 19783           FILE-ERMAIL,
 19784           MAILING-DATA,
 19785           DFHEIV11,
 19786           MA-CONTROL-PRIMARY,
 19787           DFHEIV99,
 19788           DFHEIV99
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
 19792 8130-EXIT.
 19793     EXIT.
 19794
 19795 8140-UNLOCK-ERMAIL.
 19796
 19797* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 365
* EL050.cbl
 19798*         DATASET   (FILE-ERMAIL)
 19799*    END-EXEC.
 19800*    MOVE '&*                    #   #00019095' TO DFHEIV0
 19801     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19802     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19803     MOVE X'2020233030303139303935' TO DFHEIV0(25:11)
 19804     CALL 'kxdfhei1' USING DFHEIV0,
 19805           FILE-ERMAIL,
 19806           DFHEIV99
 19807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19808
 19809
 19810 8140-EXIT.
 19811     EXIT.
 19812
 19813 8150-read-elcrtt.
 19814
 19815
 19816* EXEC CICS HANDLE CONDITION
 19817*        NOTFND   (8150-exit)
 19818*    END-EXEC
 19819*    MOVE '"$I                   ! / #00019104' TO DFHEIV0
 19820     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19822     MOVE X'2F20233030303139313034' TO DFHEIV0(25:11)
 19823     CALL 'kxdfhei1' USING DFHEIV0
 19824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19825
 19826     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19827     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19828
 19829
 19830* EXEC CICS READ
 19831*        DATASET  (CRTT-ID)
 19832*        RIDFLD   (WS-ELCRTT-KEY)
 19833*        INTO     (CERTIFICATE-TRAILERS)
 19834*    END-EXEC
 19835     MOVE LENGTH OF
 19836      CERTIFICATE-TRAILERS
 19837       TO DFHEIV11
 19838*    MOVE '&"IL       E          (   #00019111' TO DFHEIV0
 19839     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303139313131' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           CRTT-ID,
 19844           CERTIFICATE-TRAILERS,
 19845           DFHEIV11,
 19846           WS-ELCRTT-KEY,
 19847           DFHEIV99,
 19848           DFHEIV99,
 19849           DFHEIV99
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19851
 19852     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19853     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19854
 19855     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 366
* EL050.cbl
 19856 8150-exit.
 19857     exit.
 19858 8180-UPDATE-VIN-NUMBER.
 19859
 19860* EXEC CICS HANDLE CONDITION
 19861*        NOTFND   (8180-NOTFND)
 19862*    END-EXEC.
 19863*    MOVE '"$I                   ! 0 #00019124' TO DFHEIV0
 19864     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19866     MOVE X'3020233030303139313234' TO DFHEIV0(25:11)
 19867     CALL 'kxdfhei1' USING DFHEIV0
 19868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19869
 19870
 19871     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19872     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19873
 19874
 19875* EXEC CICS READ
 19876*        UPDATE
 19877*        DATASET  (CRTT-ID)
 19878*        RIDFLD   (WS-ELCRTT-KEY)
 19879*        INTO     (CERTIFICATE-TRAILERS)
 19880*    END-EXEC.
 19881     MOVE LENGTH OF
 19882      CERTIFICATE-TRAILERS
 19883       TO DFHEIV11
 19884*    MOVE '&"IL       EU         (   #00019131' TO DFHEIV0
 19885     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19887     MOVE X'2020233030303139313331' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0,
 19889           CRTT-ID,
 19890           CERTIFICATE-TRAILERS,
 19891           DFHEIV11,
 19892           WS-ELCRTT-KEY,
 19893           DFHEIV99,
 19894           DFHEIV99,
 19895           DFHEIV99
 19896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19897
 19898
 19899     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19900         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19901
 19902* EXEC CICS REWRITE
 19903*           DATASET  (CRTT-ID)
 19904*           FROM     (CERTIFICATE-TRAILERS)
 19905*        END-EXEC
 19906     MOVE LENGTH OF
 19907      CERTIFICATE-TRAILERS
 19908       TO DFHEIV11
 19909*    MOVE '&& L                  %   #00019140' TO DFHEIV0
 19910     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19912     MOVE X'2020233030303139313430' TO DFHEIV0(25:11)
 19913     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 367
* EL050.cbl
 19914           CRTT-ID,
 19915           CERTIFICATE-TRAILERS,
 19916           DFHEIV11,
 19917           DFHEIV99
 19918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19919     ELSE
 19920
 19921* EXEC CICS UNLOCK
 19922*          DATASET  (CRTT-ID)
 19923*       END-EXEC
 19924*    MOVE '&*                    #   #00019145' TO DFHEIV0
 19925     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19927     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0,
 19929           CRTT-ID,
 19930           DFHEIV99
 19931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19932     END-IF.
 19933
 19934     GO TO 8180-EXIT.
 19935
 19936 8180-NOTFND.
 19937
 19938     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19939     MOVE 'CS'         TO CS-RECORD-ID.
 19940     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19941     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19942     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19943     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19944
 19945* EXEC CICS WRITE
 19946*       DATASET  (CRTT-ID)
 19947*       RIDFLD   (WS-ELCRTT-KEY)
 19948*       FROM     (CERTIFICATE-TRAILERS)
 19949*    END-EXEC.
 19950     MOVE LENGTH OF
 19951      CERTIFICATE-TRAILERS
 19952       TO DFHEIV11
 19953*    MOVE '&$ L                  ''   #00019160' TO DFHEIV0
 19954     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19956     MOVE X'2020233030303139313630' TO DFHEIV0(25:11)
 19957     CALL 'kxdfhei1' USING DFHEIV0,
 19958           CRTT-ID,
 19959           CERTIFICATE-TRAILERS,
 19960           DFHEIV11,
 19961           WS-ELCRTT-KEY,
 19962           DFHEIV99,
 19963           DFHEIV99
 19964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19965
 19966
 19967 8180-EXIT.
 19968     EXIT.
 19969
 19970 8190-UPDATE-REFUND-CLAIM-FLAG.
 19971
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 368
* EL050.cbl
 19972* EXEC CICS HANDLE CONDITION
 19973*        NOTFND   (8190-NOTFND)
 19974*    END-EXEC.
 19975*    MOVE '"$I                   ! 1 #00019170' TO DFHEIV0
 19976     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19978     MOVE X'3120233030303139313730' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19984     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19985
 19986
 19987* EXEC CICS READ
 19988*        UPDATE
 19989*        DATASET  (CRTT-ID)
 19990*        RIDFLD   (WS-ELCRTT-KEY)
 19991*        INTO     (CERTIFICATE-TRAILERS)
 19992*    END-EXEC.
 19993     MOVE LENGTH OF
 19994      CERTIFICATE-TRAILERS
 19995       TO DFHEIV11
 19996*    MOVE '&"IL       EU         (   #00019177' TO DFHEIV0
 19997     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19998     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19999     MOVE X'2020233030303139313737' TO DFHEIV0(25:11)
 20000     CALL 'kxdfhei1' USING DFHEIV0,
 20001           CRTT-ID,
 20002           CERTIFICATE-TRAILERS,
 20003           DFHEIV11,
 20004           WS-ELCRTT-KEY,
 20005           DFHEIV99,
 20006           DFHEIV99,
 20007           DFHEIV99
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20012
 20013* EXEC CICS REWRITE
 20014*       DATASET  (CRTT-ID)
 20015*       FROM     (CERTIFICATE-TRAILERS)
 20016*    END-EXEC.
 20017     MOVE LENGTH OF
 20018      CERTIFICATE-TRAILERS
 20019       TO DFHEIV11
 20020*    MOVE '&& L                  %   #00019185' TO DFHEIV0
 20021     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20023     MOVE X'2020233030303139313835' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0,
 20025           CRTT-ID,
 20026           CERTIFICATE-TRAILERS,
 20027           DFHEIV11,
 20028           DFHEIV99
 20029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 369
* EL050.cbl
 20030
 20031
 20032     GO TO 8190-EXIT.
 20033
 20034 8190-NOTFND.
 20035
 20036     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20037     MOVE 'CS'         TO CS-RECORD-ID.
 20038     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20039     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20040     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20041     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20042
 20043* EXEC CICS WRITE
 20044*       DATASET  (CRTT-ID)
 20045*       RIDFLD   (WS-ELCRTT-KEY)
 20046*       FROM     (CERTIFICATE-TRAILERS)
 20047*    END-EXEC.
 20048     MOVE LENGTH OF
 20049      CERTIFICATE-TRAILERS
 20050       TO DFHEIV11
 20051*    MOVE '&$ L                  ''   #00019200' TO DFHEIV0
 20052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20054     MOVE X'2020233030303139323030' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0,
 20056           CRTT-ID,
 20057           CERTIFICATE-TRAILERS,
 20058           DFHEIV11,
 20059           WS-ELCRTT-KEY,
 20060           DFHEIV99,
 20061           DFHEIV99
 20062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20063
 20064
 20065 8190-EXIT.
 20066     EXIT.
 20067
 20068 8195-UPDATE-AGE-FLAGS.
 20069
 20070* EXEC CICS HANDLE CONDITION
 20071*        NOTFND   (8195-NOTFND)
 20072*    END-EXEC.
 20073*    MOVE '"$I                   ! 2 #00019210' TO DFHEIV0
 20074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20076     MOVE X'3220233030303139323130' TO DFHEIV0(25:11)
 20077     CALL 'kxdfhei1' USING DFHEIV0
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20082     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20083
 20084
 20085* EXEC CICS READ
 20086*        UPDATE
 20087*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 370
* EL050.cbl
 20088*        RIDFLD   (WS-ELCRTT-KEY)
 20089*        INTO     (CERTIFICATE-TRAILERS)
 20090*    END-EXEC.
 20091     MOVE LENGTH OF
 20092      CERTIFICATE-TRAILERS
 20093       TO DFHEIV11
 20094*    MOVE '&"IL       EU         (   #00019217' TO DFHEIV0
 20095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20097     MOVE X'2020233030303139323137' TO DFHEIV0(25:11)
 20098     CALL 'kxdfhei1' USING DFHEIV0,
 20099           CRTT-ID,
 20100           CERTIFICATE-TRAILERS,
 20101           DFHEIV11,
 20102           WS-ELCRTT-KEY,
 20103           DFHEIV99,
 20104           DFHEIV99,
 20105           DFHEIV99
 20106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20107
 20108
 20109     IF WS-INS-AGE-SET = 'Y'
 20110        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20111     END-IF
 20112     IF WS-JNT-AGE-SET = 'Y'
 20113        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20114     END-IF
 20115
 20116
 20117* EXEC CICS REWRITE
 20118*       DATASET  (CRTT-ID)
 20119*       FROM     (CERTIFICATE-TRAILERS)
 20120*    END-EXEC.
 20121     MOVE LENGTH OF
 20122      CERTIFICATE-TRAILERS
 20123       TO DFHEIV11
 20124*    MOVE '&& L                  %   #00019231' TO DFHEIV0
 20125     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20126     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20127     MOVE X'2020233030303139323331' TO DFHEIV0(25:11)
 20128     CALL 'kxdfhei1' USING DFHEIV0,
 20129           CRTT-ID,
 20130           CERTIFICATE-TRAILERS,
 20131           DFHEIV11,
 20132           DFHEIV99
 20133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20134
 20135
 20136     GO TO 8195-EXIT.
 20137
 20138 8195-NOTFND.
 20139
 20140     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20141     MOVE 'CS'         TO CS-RECORD-ID.
 20142     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20143     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20144     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20145     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 371
* EL050.cbl
 20146     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20147
 20148* EXEC CICS WRITE
 20149*       DATASET  (CRTT-ID)
 20150*       RIDFLD   (WS-ELCRTT-KEY)
 20151*       FROM     (CERTIFICATE-TRAILERS)
 20152*    END-EXEC.
 20153     MOVE LENGTH OF
 20154      CERTIFICATE-TRAILERS
 20155       TO DFHEIV11
 20156*    MOVE '&$ L                  ''   #00019247' TO DFHEIV0
 20157     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20158     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20159     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 20160     CALL 'kxdfhei1' USING DFHEIV0,
 20161           CRTT-ID,
 20162           CERTIFICATE-TRAILERS,
 20163           DFHEIV11,
 20164           WS-ELCRTT-KEY,
 20165           DFHEIV99,
 20166           DFHEIV99
 20167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20168
 20169
 20170 8195-EXIT.
 20171     EXIT.
 20172
 20173 8200-READ-REIN-TABLE.
 20174
 20175* EXEC CICS HANDLE CONDITION
 20176*         NOTFND   (8200-NOTFND)
 20177*    END-EXEC.
 20178*    MOVE '"$I                   ! 3 #00019257' TO DFHEIV0
 20179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20181     MOVE X'3320233030303139323537' TO DFHEIV0(25:11)
 20182     CALL 'kxdfhei1' USING DFHEIV0
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186
 20187* EXEC CICS READ
 20188*        DATASET     (REIN-ID)
 20189*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20190*        RIDFLD      (ERREIN-KEY)
 20191*    END-EXEC.
 20192*    MOVE '&"S        E          (   #00019261' TO DFHEIV0
 20193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20194     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20195     MOVE X'2020233030303139323631' TO DFHEIV0(25:11)
 20196     CALL 'kxdfhei1' USING DFHEIV0,
 20197           REIN-ID,
 20198           DFHEIV20,
 20199           DFHEIV99,
 20200           ERREIN-KEY,
 20201           DFHEIV99,
 20202           DFHEIV99,
 20203           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 372
* EL050.cbl
 20204     SET ADDRESS OF REINSURANCE-RECORD TO
 20205         DFHEIV20
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209     GO TO 8200-EXIT.
 20210
 20211 8200-NOTFND.
 20212     MOVE 'N'             TO WS-REIN-READ-SW.
 20213
 20214 8200-EXIT.
 20215      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 373
* EL050.cbl
 20217
 20218 8300-READ-CTBL-TABLE.
 20219
 20220* EXEC CICS HANDLE CONDITION
 20221*        NOTFND    (8300-NOTFND)
 20222*        DISABLED  (8300-ERRESS-PROBLEM)
 20223*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20224*        ENDFILE   (8300-NOTFND)
 20225*    END-EXEC.
 20226*    MOVE '"$IcJ''                ! 4 #00019277' TO DFHEIV0
 20227     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20229     MOVE X'3420233030303139323737' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0
 20231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20232
 20233
 20234
 20235* EXEC CICS READ
 20236*        DATASET     (CTBL-ID)
 20237*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20238*        RIDFLD      (ERCTBL-KEY)
 20239*    END-EXEC.
 20240*    MOVE '&"S        E          (   #00019284' TO DFHEIV0
 20241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303139323834' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           CTBL-ID,
 20246           DFHEIV20,
 20247           DFHEIV99,
 20248           ERCTBL-KEY,
 20249           DFHEIV99,
 20250           DFHEIV99,
 20251           DFHEIV99
 20252     SET ADDRESS OF COMM-TABLE-RECORD TO
 20253         DFHEIV20
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20255
 20256
 20257     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20258
 20259     GO TO 8300-EXIT.
 20260
 20261 8300-NOTFND.
 20262
 20263     IF CTBL-SW = '0530'
 20264         MOVE 'AA'                     TO WS-AH-COMP-CD
 20265         MOVE '0550'                   TO CTBL-SW
 20266         MOVE '1'                      TO WS-CTBL-READ-SW
 20267         GO TO 8300-EXIT.
 20268
 20269     IF CTBL-SW = '0540'
 20270         MOVE 'AA'                     TO WS-LF-COMP-CD
 20271         MOVE '0550'                   TO CTBL-SW
 20272         MOVE '1'                      TO WS-CTBL-READ-SW
 20273         GO TO 8300-EXIT.
 20274
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 374
* EL050.cbl
 20275     IF CTBL-SW = '0550'
 20276         MOVE '2'                      TO WS-CTBL-READ-SW
 20277         GO TO 8300-EXIT.
 20278
 20279     GO TO 8300-EXIT.
 20280
 20281 8300-ERRESS-PROBLEM.
 20282
 20283      MOVE ER-8050              TO WS-ERROR.
 20284      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20285
 20286     GO TO 8300-EXIT.
 20287
 20288 8300-EXIT.
 20289      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 375
* EL050.cbl
 20291
 20292
 20293 8400-GETMAIN-ERFORM.
 20294
 20295
 20296* EXEC CICS   GETMAIN
 20297*        LENGTH  (500)
 20298*        SET     (ADDRESS OF FORM-MASTER)
 20299*    END-EXEC.
 20300     MOVE 500
 20301       TO DFHEIV11
 20302*    MOVE '," L                  $   #00019328' TO DFHEIV0
 20303     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20305     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 20306     CALL 'kxdfhei1' USING DFHEIV0,
 20307           DFHEIV20,
 20308           DFHEIV11,
 20309           DFHEIV99
 20310     SET ADDRESS OF FORM-MASTER TO
 20311         DFHEIV20
 20312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20313
 20314
 20315     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20316
 20317 8400-EXIT.
 20318      EXIT.
 20319
 20320 8450-READ-FORM-MASTER.
 20321
 20322
 20323* EXEC CICS  HANDLE CONDITION
 20324*        NOTFND   (8450-FORM-NOT-FOUND)
 20325*        ENDFILE  (8450-FORM-NOT-FOUND)
 20326*    END-EXEC.
 20327*    MOVE '"$I''                  ! 5 #00019340' TO DFHEIV0
 20328     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20330     MOVE X'3520233030303139333430' TO DFHEIV0(25:11)
 20331     CALL 'kxdfhei1' USING DFHEIV0
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335
 20336* EXEC CICS   READ
 20337*        DATASET   (FORM-ID)
 20338*        RIDFLD    (ERFORM-KEY)
 20339*        INTO      (FORM-MASTER)
 20340*        GTEQ
 20341*    END-EXEC.
 20342     MOVE LENGTH OF
 20343      FORM-MASTER
 20344       TO DFHEIV11
 20345*    MOVE '&"IL       G          (   #00019345' TO DFHEIV0
 20346     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20347     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20348     MOVE X'2020233030303139333435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 376
* EL050.cbl
 20349     CALL 'kxdfhei1' USING DFHEIV0,
 20350           FORM-ID,
 20351           FORM-MASTER,
 20352           DFHEIV11,
 20353           ERFORM-KEY,
 20354           DFHEIV99,
 20355           DFHEIV99,
 20356           DFHEIV99
 20357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20358
 20359
 20360     MOVE  'Y'           TO  FORM-MASTER-SW.
 20361
 20362     GO TO  8450-EXIT.
 20363
 20364 8450-FORM-NOT-FOUND.
 20365
 20366     MOVE  'N'           TO  FORM-MASTER-SW.
 20367
 20368 8450-EXIT.
 20369      EXIT.
 20370
 20371 8500-DATE-CONVERT.
 20372
 20373* EXEC CICS LINK
 20374*        PROGRAM    ('ELDATCV')
 20375*        COMMAREA   (DATE-CONVERSION-DATA)
 20376*        LENGTH     (DC-COMM-LENGTH)
 20377*    END-EXEC.
 20378     MOVE 'ELDATCV' TO DFHEIV1
 20379*    MOVE '."C                   (   #00019364' TO DFHEIV0
 20380     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20382     MOVE X'2020233030303139333634' TO DFHEIV0(25:11)
 20383     CALL 'kxdfhei1' USING DFHEIV0,
 20384           DFHEIV1,
 20385           DATE-CONVERSION-DATA,
 20386           DC-COMM-LENGTH,
 20387           DFHEIV99,
 20388           DFHEIV99,
 20389           DFHEIV99,
 20390           DFHEIV99
 20391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20392
 20393
 20394 8500-EXIT.
 20395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 377
* EL050.cbl
 20397
 20398 8555-RELOAD-CONTROL-FILE.
 20399     CONTINUE.
 20400
 20401 8555-EXIT.
 20402     EXIT.
 20403
 20404 8557-GETMAIN-ERPLAN.
 20405
 20406
 20407* EXEC CICS GETMAIN
 20408*        LENGTH    (840)
 20409*        SET       (ADDRESS OF PLAN-RECORDS)
 20410*    END-EXEC.
 20411     MOVE 840
 20412       TO DFHEIV11
 20413*    MOVE '," L                  $   #00019382' TO DFHEIV0
 20414     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303139333832' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           DFHEIV20,
 20419           DFHEIV11,
 20420           DFHEIV99
 20421     SET ADDRESS OF PLAN-RECORDS TO
 20422         DFHEIV20
 20423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20424
 20425
 20426     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20427
 20428 8557-EXIT.
 20429     EXIT.
 20430
 20431 8560-GETMAIN.
 20432
 20433* EXEC CICS GETMAIN
 20434*        LENGTH    (2000)
 20435*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20436*    END-EXEC.
 20437     MOVE 2000
 20438       TO DFHEIV11
 20439*    MOVE '," L                  $   #00019393' TO DFHEIV0
 20440     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303139333933' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
 20444           DFHEIV20,
 20445           DFHEIV11,
 20446           DFHEIV99
 20447     SET ADDRESS OF ACCOUNT-MASTER TO
 20448         DFHEIV20
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20450
 20451
 20452     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20453
 20454 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 378
* EL050.cbl
 20455     EXIT.
 20456
 20457 8570-START-ACCOUNT-MASTER.
 20458
 20459* EXEC CICS HANDLE CONDITION
 20460*        NOTFND    (0199-ACCT-NOT-FOUND)
 20461*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20462*    END-EXEC.
 20463*    MOVE '"$I''                  ! 6 #00019404' TO DFHEIV0
 20464     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20466     MOVE X'3620233030303139343034' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0
 20468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20469
 20470
 20471
 20472* EXEC CICS STARTBR
 20473*        DATASET    (ACCT-ID)
 20474*        RIDFLD     (ERACCT-KEY)
 20475*        GTEQ
 20476*    END-EXEC.
 20477     MOVE 0
 20478       TO DFHEIV11
 20479*    MOVE '&,         G          &   #00019409' TO DFHEIV0
 20480     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20481     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20482     MOVE X'2020233030303139343039' TO DFHEIV0(25:11)
 20483     CALL 'kxdfhei1' USING DFHEIV0,
 20484           ACCT-ID,
 20485           ERACCT-KEY,
 20486           DFHEIV99,
 20487           DFHEIV11,
 20488           DFHEIV99
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492 8570-EXIT.
 20493     EXIT.
 20494
 20495 8580-READ-ACCOUNT-MASTER.
 20496
 20497* EXEC CICS HANDLE CONDITION
 20498*        NOTFND    (0199-ACCT-NOT-FOUND)
 20499*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20500*    END-EXEC.
 20501*    MOVE '"$I''                  ! 7 #00019419' TO DFHEIV0
 20502     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20504     MOVE X'3720233030303139343139' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20507
 20508
 20509
 20510* EXEC CICS READNEXT
 20511*        DATASET     (ACCT-ID)
 20512*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 379
* EL050.cbl
 20513*        RIDFLD      (ERACCT-KEY)
 20514*    END-EXEC.
 20515     MOVE LENGTH OF
 20516      ACCOUNT-MASTER
 20517       TO DFHEIV12
 20518     MOVE 0
 20519       TO DFHEIV11
 20520*    MOVE '&.IL                  )   #00019424' TO DFHEIV0
 20521     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20522     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20523     MOVE X'2020233030303139343234' TO DFHEIV0(25:11)
 20524     CALL 'kxdfhei1' USING DFHEIV0,
 20525           ACCT-ID,
 20526           ACCOUNT-MASTER,
 20527           DFHEIV12,
 20528           ERACCT-KEY,
 20529           DFHEIV99,
 20530           DFHEIV11,
 20531           DFHEIV99,
 20532           DFHEIV99
 20533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20534
 20535
 20536 8580-EXIT.
 20537     EXIT.
 20538
 20539 8582-READ-COMPENSATION-MASTER.
 20540
 20541* EXEC CICS HANDLE CONDITION
 20542*        NOTFND    (8582-COMP-NOT-FOUND)
 20543*        ENDFILE   (8582-COMP-NOT-FOUND)
 20544*    END-EXEC.
 20545*    MOVE '"$I''                  ! 8 #00019434' TO DFHEIV0
 20546     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20548     MOVE X'3820233030303139343334' TO DFHEIV0(25:11)
 20549     CALL 'kxdfhei1' USING DFHEIV0
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20551
 20552
 20553
 20554* EXEC CICS READ
 20555*        DATASET     (COMP-ID)
 20556*        INTO        (COMPENSATION-MASTER)
 20557*        RIDFLD      (ERCOMP-KEY)
 20558*    END-EXEC.
 20559     MOVE LENGTH OF
 20560      COMPENSATION-MASTER
 20561       TO DFHEIV11
 20562*    MOVE '&"IL       E          (   #00019439' TO DFHEIV0
 20563     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20565     MOVE X'2020233030303139343339' TO DFHEIV0(25:11)
 20566     CALL 'kxdfhei1' USING DFHEIV0,
 20567           COMP-ID,
 20568           COMPENSATION-MASTER,
 20569           DFHEIV11,
 20570           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 380
* EL050.cbl
 20571           DFHEIV99,
 20572           DFHEIV99,
 20573           DFHEIV99
 20574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20575
 20576
 20577     MOVE 'Y'                    TO COMP-MASTER-SW
 20578
 20579     GO TO 8582-EXIT
 20580     .
 20581 8582-COMP-NOT-FOUND.
 20582
 20583     MOVE 'N'                    TO COMP-MASTER-SW.
 20584
 20585 8582-EXIT.
 20586     EXIT.
 20587
 20588 8583-READ-ERAGTC.
 20589
 20590* EXEC CICS HANDLE CONDITION
 20591*        NOTFND    (8583-AGTC-NOT-FOUND)
 20592*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20593*    END-EXEC.
 20594*    MOVE '"$I''                  ! 9 #00019457' TO DFHEIV0
 20595     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20597     MOVE X'3920233030303139343537' TO DFHEIV0(25:11)
 20598     CALL 'kxdfhei1' USING DFHEIV0
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20600
 20601
 20602
 20603* EXEC CICS STARTBR
 20604*        DATASET    (AGTC-ID)
 20605*        RIDFLD     (ERAGTC-KEY)
 20606*        GTEQ
 20607*    END-EXEC.
 20608     MOVE 0
 20609       TO DFHEIV11
 20610*    MOVE '&,         G          &   #00019462' TO DFHEIV0
 20611     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20613     MOVE X'2020233030303139343632' TO DFHEIV0(25:11)
 20614     CALL 'kxdfhei1' USING DFHEIV0,
 20615           AGTC-ID,
 20616           ERAGTC-KEY,
 20617           DFHEIV99,
 20618           DFHEIV11,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
 20623 8583-READ-ERAGTC-NEXT.
 20624
 20625* EXEC CICS READNEXT
 20626*        DATASET     (AGTC-ID)
 20627*        INTO        (AGENT-COMMISSIONS)
 20628*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 381
* EL050.cbl
 20629*    END-EXEC.
 20630     MOVE LENGTH OF
 20631      AGENT-COMMISSIONS
 20632       TO DFHEIV12
 20633     MOVE 0
 20634       TO DFHEIV11
 20635*    MOVE '&.IL                  )   #00019469' TO DFHEIV0
 20636     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20637     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20638     MOVE X'2020233030303139343639' TO DFHEIV0(25:11)
 20639     CALL 'kxdfhei1' USING DFHEIV0,
 20640           AGTC-ID,
 20641           AGENT-COMMISSIONS,
 20642           DFHEIV12,
 20643           ERAGTC-KEY,
 20644           DFHEIV99,
 20645           DFHEIV11,
 20646           DFHEIV99,
 20647           DFHEIV99
 20648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20649
 20650
 20651*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20652
 20653     GO TO 8583-EXIT
 20654     .
 20655 8583-AGTC-NOT-FOUND.
 20656
 20657     MOVE 'N'                    TO AGTC-MASTER-SW.
 20658
 20659 8583-EXIT.
 20660     EXIT.
 20661
 20662 8584-READ-BANK-CROSS-REF.
 20663
 20664* EXEC CICS HANDLE CONDITION
 20665*        NOTFND    (8584-BXRF-NOT-FOUND)
 20666*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20667*    END-EXEC.
 20668*    MOVE '"$I''                  ! : #00019487' TO DFHEIV0
 20669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20671     MOVE X'3A20233030303139343837' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20674
 20675
 20676
 20677* EXEC CICS READ
 20678*        DATASET     (BXRF-ID)
 20679*        INTO        (BANK-CROSS-REFERENCE)
 20680*        RIDFLD      (ERBXRF-KEY)
 20681*        LENGTH      (BXRF-REC-LENGTH)
 20682*    END-EXEC.
 20683*    MOVE '&"IL       E          (   #00019492' TO DFHEIV0
 20684     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20686     MOVE X'2020233030303139343932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 382
* EL050.cbl
 20687     CALL 'kxdfhei1' USING DFHEIV0,
 20688           BXRF-ID,
 20689           BANK-CROSS-REFERENCE,
 20690           BXRF-REC-LENGTH,
 20691           ERBXRF-KEY,
 20692           DFHEIV99,
 20693           DFHEIV99,
 20694           DFHEIV99
 20695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20696
 20697
 20698     MOVE 'Y'                    TO BXRF-MASTER-SW
 20699
 20700     GO TO 8584-EXIT
 20701     .
 20702 8584-BXRF-NOT-FOUND.
 20703
 20704     MOVE 'N'                    TO BXRF-MASTER-SW.
 20705
 20706 8584-EXIT.
 20707     EXIT.
 20708
 20709 8585-READ-PLAN-MASTER.
 20710
 20711
 20712* EXEC CICS HANDLE CONDITION
 20713*        NOTFND    (8585-PLAN-NOT-FOUND)
 20714*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20715*    END-EXEC.
 20716*    MOVE '"$I''                  ! ; #00019512' TO DFHEIV0
 20717     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20719     MOVE X'3B20233030303139353132' TO DFHEIV0(25:11)
 20720     CALL 'kxdfhei1' USING DFHEIV0
 20721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20722
 20723
 20724
 20725* EXEC CICS READ
 20726*        DATASET     (PLAN-ID)
 20727*        INTO        (PLAN-MASTER)
 20728*        RIDFLD      (ERPLAN-KEY)
 20729*    END-EXEC.
 20730     MOVE LENGTH OF
 20731      PLAN-MASTER
 20732       TO DFHEIV11
 20733*    MOVE '&"IL       E          (   #00019517' TO DFHEIV0
 20734     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20736     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           PLAN-ID,
 20739           PLAN-MASTER,
 20740           DFHEIV11,
 20741           ERPLAN-KEY,
 20742           DFHEIV99,
 20743           DFHEIV99,
 20744           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 383
* EL050.cbl
 20745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20746
 20747
 20748     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20749
 20750     GO TO 8585-EXIT.
 20751
 20752 8585-PLAN-NOT-FOUND.
 20753
 20754     MOVE 'N'                    TO PLAN-MASTER-SW.
 20755
 20756 8585-EXIT.
 20757     EXIT.
 20758
 20759 8586-READ-LOAN-OFFICER.
 20760
 20761* EXEC CICS READ
 20762*        DATASET     (LOFC-ID)
 20763*        INTO        (LOAN-OFFICER-MASTER)
 20764*        RIDFLD      (ERLOFC-KEY)
 20765*        RESP        (WS-RESPONSE)
 20766*    END-EXEC
 20767     MOVE LENGTH OF
 20768      LOAN-OFFICER-MASTER
 20769       TO DFHEIV11
 20770*    MOVE '&"IL       E          (  N#00019535' TO DFHEIV0
 20771     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20773     MOVE X'204E233030303139353335' TO DFHEIV0(25:11)
 20774     CALL 'kxdfhei1' USING DFHEIV0,
 20775           LOFC-ID,
 20776           LOAN-OFFICER-MASTER,
 20777           DFHEIV11,
 20778           ERLOFC-KEY,
 20779           DFHEIV99,
 20780           DFHEIV99,
 20781           DFHEIV99
 20782     MOVE EIBRESP  TO WS-RESPONSE
 20783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20784
 20785     IF WS-RESP-NORMAL
 20786        MOVE 'Y'                 TO LOFC-MASTER-SW
 20787     ELSE
 20788        MOVE 'N'                 TO LOFC-MASTER-SW
 20789     END-IF
 20790     .
 20791 8586-EXIT.
 20792     EXIT.
 20793 8587-START-ERPDEF.
 20794
 20795* EXEC CICS STARTBR
 20796*       DATASET   (PDEF-ID)
 20797*       RIDFLD    (ERPDEF-KEY)
 20798*       GTEQ
 20799*       RESP      (WS-RESPONSE)
 20800*    END-EXEC
 20801     MOVE 0
 20802       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 384
* EL050.cbl
 20803*    MOVE '&,         G          &  N#00019551' TO DFHEIV0
 20804     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20806     MOVE X'204E233030303139353531' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0,
 20808           PDEF-ID,
 20809           ERPDEF-KEY,
 20810           DFHEIV99,
 20811           DFHEIV11,
 20812           DFHEIV99
 20813     MOVE EIBRESP  TO WS-RESPONSE
 20814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20815     IF WS-RESP-NORMAL
 20816        MOVE 'Y'                 TO PDEF-MASTER-SW
 20817     ELSE
 20818        MOVE 'N'                 TO PDEF-MASTER-SW
 20819     END-IF
 20820     .
 20821 8587-EXIT.
 20822     EXIT.
 20823 8588-READ-ERPDEF.
 20824
 20825* EXEC CICS READNEXT
 20826*       DATASET   (PDEF-ID)
 20827*       RIDFLD    (ERPDEF-KEY)
 20828*       INTO      (PRODUCT-MASTER)
 20829*       RESP      (WS-RESPONSE)
 20830*    END-EXEC
 20831     MOVE LENGTH OF
 20832      PRODUCT-MASTER
 20833       TO DFHEIV12
 20834     MOVE 0
 20835       TO DFHEIV11
 20836*    MOVE '&.IL                  )  N#00019566' TO DFHEIV0
 20837     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20839     MOVE X'204E233030303139353636' TO DFHEIV0(25:11)
 20840     CALL 'kxdfhei1' USING DFHEIV0,
 20841           PDEF-ID,
 20842           PRODUCT-MASTER,
 20843           DFHEIV12,
 20844           ERPDEF-KEY,
 20845           DFHEIV99,
 20846           DFHEIV11,
 20847           DFHEIV99,
 20848           DFHEIV99
 20849     MOVE EIBRESP  TO WS-RESPONSE
 20850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20851     IF WS-RESP-NORMAL
 20852        MOVE 'Y'                 TO PDEF-MASTER-SW
 20853     ELSE
 20854        MOVE 'N'                 TO PDEF-MASTER-SW
 20855     END-IF
 20856     .
 20857 8588-EXIT.
 20858     EXIT.
 20859 8589-ENDBR-ERPDEF.
 20860
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 385
* EL050.cbl
 20861* EXEC CICS ENDBR
 20862*       DATASET   (PDEF-ID)
 20863*    END-EXEC
 20864     MOVE 0
 20865       TO DFHEIV11
 20866*    MOVE '&2                    $   #00019581' TO DFHEIV0
 20867     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20869     MOVE X'2020233030303139353831' TO DFHEIV0(25:11)
 20870     CALL 'kxdfhei1' USING DFHEIV0,
 20871           PDEF-ID,
 20872           DFHEIV11,
 20873           DFHEIV99
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20875     .
 20876 8589-EXIT.
 20877     EXIT.
 20878 8590-READ-CERT-MASTER.
 20879     IF PB-COMPANY-ID = 'UCL'
 20880         GO TO 8690-READ-CERT-MASTER-UCL.
 20881
 20882
 20883* EXEC CICS HANDLE CONDITION
 20884*         NOTFND    (0299-CERT-NOT-FOUND)
 20885*    END-EXEC.
 20886*    MOVE '"$I                   ! < #00019591' TO DFHEIV0
 20887     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20889     MOVE X'3C20233030303139353931' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894
 20895* EXEC CICS READ
 20896*        DATASET     (CERT-ID)
 20897*        INTO        (CERTIFICATE-MASTER)
 20898*        RIDFLD      (ELCERT-KEY)
 20899*        UPDATE
 20900*    END-EXEC.
 20901     MOVE LENGTH OF
 20902      CERTIFICATE-MASTER
 20903       TO DFHEIV11
 20904*    MOVE '&"IL       EU         (   #00019595' TO DFHEIV0
 20905     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20906     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20907     MOVE X'2020233030303139353935' TO DFHEIV0(25:11)
 20908     CALL 'kxdfhei1' USING DFHEIV0,
 20909           CERT-ID,
 20910           CERTIFICATE-MASTER,
 20911           DFHEIV11,
 20912           ELCERT-KEY,
 20913           DFHEIV99,
 20914           DFHEIV99,
 20915           DFHEIV99
 20916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20917
 20918
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 386
* EL050.cbl
 20919 8590-EXIT.
 20920     EXIT.
 20921
 20922 8690-READ-CERT-MASTER-UCL.
 20923
 20924* EXEC CICS HANDLE CONDITION
 20925*         NOTFND    (8700-READ-CERT-MASTER)
 20926*    END-EXEC.
 20927*    MOVE '"$I                   ! = #00019606' TO DFHEIV0
 20928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20930     MOVE X'3D20233030303139363036' TO DFHEIV0(25:11)
 20931     CALL 'kxdfhei1' USING DFHEIV0
 20932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20933
 20934
 20935 8690-READ-CERT-CONT.
 20936
 20937* EXEC CICS READ
 20938*        DATASET     (CERT-ID)
 20939*        INTO        (CERTIFICATE-MASTER)
 20940*        RIDFLD      (ELCERT-KEY)
 20941*        UPDATE
 20942*    END-EXEC.
 20943     MOVE LENGTH OF
 20944      CERTIFICATE-MASTER
 20945       TO DFHEIV11
 20946*    MOVE '&"IL       EU         (   #00019611' TO DFHEIV0
 20947     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20949     MOVE X'2020233030303139363131' TO DFHEIV0(25:11)
 20950     CALL 'kxdfhei1' USING DFHEIV0,
 20951           CERT-ID,
 20952           CERTIFICATE-MASTER,
 20953           DFHEIV11,
 20954           ELCERT-KEY,
 20955           DFHEIV99,
 20956           DFHEIV99,
 20957           DFHEIV99
 20958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20959
 20960
 20961     GO TO 8590-EXIT.
 20962
 20963 8700-READ-CERT-MASTER.
 20964     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20965     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20966
 20967* EXEC CICS HANDLE CONDITION
 20968*         DUPKEY    (8720-COMP-ACCOUNTS)
 20969*         ENDFILE   (8730-END-BROWSE)
 20970*         NOTFND    (8740-NOT-FOUND)
 20971*    END-EXEC.
 20972*    MOVE '"$$''I                 ! > #00019623' TO DFHEIV0
 20973     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20975     MOVE X'3E20233030303139363233' TO DFHEIV0(25:11)
 20976     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 387
* EL050.cbl
 20977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20978
 20979
 20980
 20981* EXEC CICS STARTBR
 20982*        DATASET     ('ELCERT5')
 20983*        RIDFLD      (ELCERT2-KEY)
 20984*        EQUAL
 20985*    END-EXEC.
 20986     MOVE 'ELCERT5' TO DFHEIV1
 20987     MOVE 0
 20988       TO DFHEIV11
 20989*    MOVE '&,         E          &   #00019629' TO DFHEIV0
 20990     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20991     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20992     MOVE X'2020233030303139363239' TO DFHEIV0(25:11)
 20993     CALL 'kxdfhei1' USING DFHEIV0,
 20994           DFHEIV1,
 20995           ELCERT2-KEY,
 20996           DFHEIV99,
 20997           DFHEIV11,
 20998           DFHEIV99
 20999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21000
 21001
 21002 8710-READ-NEXT.
 21003
 21004* EXEC CICS READNEXT
 21005*        DATASET     ('ELCERT5')
 21006*        INTO        (CERTIFICATE-MASTER)
 21007*        RIDFLD      (ELCERT2-KEY)
 21008*    END-EXEC.
 21009     MOVE LENGTH OF
 21010      CERTIFICATE-MASTER
 21011       TO DFHEIV12
 21012     MOVE 'ELCERT5' TO DFHEIV1
 21013     MOVE 0
 21014       TO DFHEIV11
 21015*    MOVE '&.IL                  )   #00019636' TO DFHEIV0
 21016     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21017     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21018     MOVE X'2020233030303139363336' TO DFHEIV0(25:11)
 21019     CALL 'kxdfhei1' USING DFHEIV0,
 21020           DFHEIV1,
 21021           CERTIFICATE-MASTER,
 21022           DFHEIV12,
 21023           ELCERT2-KEY,
 21024           DFHEIV99,
 21025           DFHEIV11,
 21026           DFHEIV99,
 21027           DFHEIV99
 21028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21029
 21030
 21031 8720-COMP-ACCOUNTS.
 21032
 21033* EXEC CICS ENTER
 21034*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 388
* EL050.cbl
 21035*         FROM (PB-C-LAST-NAME)
 21036*    END-EXEC.
 21037     MOVE 001
 21038       TO DFHEIV11
 21039*    MOVE ':$F                   %   #00019643' TO DFHEIV0
 21040     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21042     MOVE X'2020233030303139363433' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0,
 21044           DFHEIV11,
 21045           PB-C-LAST-NAME,
 21046           DFHEIV99,
 21047           DFHEIV99
 21048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21049
 21050
 21051
 21052* EXEC CICS ENTER
 21053*         TRACEID (002)
 21054*         FROM (CM-INSURED-LAST-NAME)
 21055*    END-EXEC.
 21056     MOVE 002
 21057       TO DFHEIV11
 21058*    MOVE ':$F                   %   #00019648' TO DFHEIV0
 21059     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21060     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21061     MOVE X'2020233030303139363438' TO DFHEIV0(25:11)
 21062     CALL 'kxdfhei1' USING DFHEIV0,
 21063           DFHEIV11,
 21064           CM-INSURED-LAST-NAME,
 21065           DFHEIV99,
 21066           DFHEIV99
 21067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21068
 21069
 21070     IF PB-CERT-NO NOT = CM-CERT-NO
 21071         GO TO 8730-END-BROWSE.
 21072
 21073     IF PB-ACCOUNT = CM-ACCOUNT
 21074         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21075             MOVE ER-2799        TO WS-ERROR
 21076             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21077             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21078             GO TO 8730-END-BROWSE.
 21079
 21080     GO TO 8710-READ-NEXT.
 21081
 21082 8730-END-BROWSE.
 21083
 21084* EXEC CICS ENDBR
 21085*         DATASET    ('ELCERT5')
 21086*    END-EXEC.
 21087     MOVE 'ELCERT5' TO DFHEIV1
 21088     MOVE 0
 21089       TO DFHEIV11
 21090*    MOVE '&2                    $   #00019666' TO DFHEIV0
 21091     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21092     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 389
* EL050.cbl
 21093     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 21094     CALL 'kxdfhei1' USING DFHEIV0,
 21095           DFHEIV1,
 21096           DFHEIV11,
 21097           DFHEIV99
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101 8740-NOT-FOUND.
 21102     GO TO 0299-CERT-NOT-FOUND.
 21103
 21104 8750-START-ELSTAT.
 21105
 21106* EXEC CICS STARTBR
 21107*       DATASET   (STAT-ID)
 21108*       RIDFLD    (ELSTAT-KEY)
 21109*       GTEQ
 21110*       RESP      (WS-RESPONSE)
 21111*    END-EXEC
 21112     MOVE 0
 21113       TO DFHEIV11
 21114*    MOVE '&,         G          &  N#00019674' TO DFHEIV0
 21115     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21117     MOVE X'204E233030303139363734' TO DFHEIV0(25:11)
 21118     CALL 'kxdfhei1' USING DFHEIV0,
 21119           STAT-ID,
 21120           ELSTAT-KEY,
 21121           DFHEIV99,
 21122           DFHEIV11,
 21123           DFHEIV99
 21124     MOVE EIBRESP  TO WS-RESPONSE
 21125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21126     IF WS-RESP-NORMAL
 21127        MOVE 'Y'                 TO STAT-MASTER-SW
 21128     ELSE
 21129        MOVE 'N'                 TO STAT-MASTER-SW
 21130     END-IF
 21131     .
 21132 8750-EXIT.
 21133     EXIT.
 21134 8752-READ-ELSTAT.
 21135
 21136* EXEC CICS READNEXT
 21137*       DATASET   (STAT-ID)
 21138*       RIDFLD    (ELSTAT-KEY)
 21139*       INTO      (STATE-FILE)
 21140*       RESP      (WS-RESPONSE)
 21141*    END-EXEC
 21142     MOVE LENGTH OF
 21143      STATE-FILE
 21144       TO DFHEIV12
 21145     MOVE 0
 21146       TO DFHEIV11
 21147*    MOVE '&.IL                  )  N#00019689' TO DFHEIV0
 21148     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21149     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21150     MOVE X'204E233030303139363839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 390
* EL050.cbl
 21151     CALL 'kxdfhei1' USING DFHEIV0,
 21152           STAT-ID,
 21153           STATE-FILE,
 21154           DFHEIV12,
 21155           ELSTAT-KEY,
 21156           DFHEIV99,
 21157           DFHEIV11,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     MOVE EIBRESP  TO WS-RESPONSE
 21161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21162     IF WS-RESP-NORMAL
 21163        MOVE 'Y'                 TO STAT-MASTER-SW
 21164     ELSE
 21165        MOVE 'N'                 TO STAT-MASTER-SW
 21166     END-IF
 21167     .
 21168 8752-EXIT.
 21169     EXIT.
 21170 8800-GET-COMP-RATE.
 21171     MOVE +1 TO IB.
 21172     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21173         ADD +9 TO IB
 21174         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21175             ADD +9 TO IB
 21176             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21177                MOVE ZEROS       TO WS-WK-RATE
 21178                GO TO 8800-EXIT.
 21179
 21180     IF PB-I-AGE GREATER CT-AGE (1)
 21181         ADD +3 TO IB
 21182         IF PB-I-AGE GREATER CT-AGE (2)
 21183             ADD +3 TO IB
 21184             IF PB-I-AGE GREATER CT-AGE (3)
 21185                MOVE ZEROS       TO WS-WK-RATE
 21186                GO TO 8800-EXIT.
 21187
 21188     IF WS-WORK-TERM GREATER CT-TRM (1)
 21189         ADD +1 TO IB
 21190         IF WS-WORK-TERM GREATER CT-TRM (2)
 21191             ADD +1 TO IB
 21192             IF WS-WORK-TERM GREATER CT-TRM (3)
 21193                MOVE ZEROS       TO WS-WK-RATE
 21194                GO TO 8800-EXIT.
 21195
 21196     IF CT-RT (IB) NOT NUMERIC
 21197         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21198         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21199         GO TO 8800-GET-COMP-RATE.
 21200
 21201     MOVE CT-RT (IB) TO WS-WK-RATE.
 21202
 21203 8800-EXIT.
 21204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 391
* EL050.cbl
 21206 8900-ADDRESS-FILE.
 21207     IF ERACCT-FILE-ADDRESSED
 21208         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21209         GO TO 8900-ADDRESS-EXIT.
 21210
 21211     IF ELCNTL-FILE-ADDRESSED
 21212         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21213         GO TO 8900-ADDRESS-EXIT.
 21214
 21215     IF ERPLAN-FILE-ADDRESSED
 21216         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21217         GO TO 8900-ADDRESS-EXIT.
 21218
 21219     IF ERFORM-FILE-ADDRESSED
 21220         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21221         GO TO 8900-ADDRESS-EXIT.
 21222
 21223 8900-ADDRESS-EXIT.
 21224     EXIT.
 21225
 21226 9000-READ-CONTROL.
 21227
 21228* EXEC CICS HANDLE CONDITION
 21229*        NOTFND    (9000-NOTFND)
 21230*    END-EXEC.
 21231*    MOVE '"$I                   ! ? #00019760' TO DFHEIV0
 21232     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21234     MOVE X'3F20233030303139373630' TO DFHEIV0(25:11)
 21235     CALL 'kxdfhei1' USING DFHEIV0
 21236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21237
 21238
 21239
 21240* EXEC CICS READ
 21241*        DATASET     (CNTL-ID)
 21242*        SET         (ADDRESS OF CONTROL-FILE)
 21243*        RIDFLD      (ELCNTL-KEY)
 21244*        GTEQ
 21245*    END-EXEC.
 21246*    MOVE '&"S        G          (   #00019764' TO DFHEIV0
 21247     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21249     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
 21250     CALL 'kxdfhei1' USING DFHEIV0,
 21251           CNTL-ID,
 21252           DFHEIV20,
 21253           DFHEIV99,
 21254           ELCNTL-KEY,
 21255           DFHEIV99,
 21256           DFHEIV99,
 21257           DFHEIV99
 21258     SET ADDRESS OF CONTROL-FILE TO
 21259         DFHEIV20
 21260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21261
 21262
 21263     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 392
* EL050.cbl
 21264
 21265 9000-NOTFND.
 21266     IF RC-SW-1 = '1'
 21267        MOVE ER-2616              TO WS-ERROR
 21268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21269        GO TO 9000-EXIT.
 21270
 21271     IF RC-SW-1 = '2'
 21272        MOVE ER-2602              TO WS-ERROR
 21273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21274
 21275 9000-EXIT.
 21276      EXIT.
 21277
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 393
* EL050.cbl
 21279 9100-READ-CONTROL.
 21280
 21281* EXEC CICS HANDLE CONDITION
 21282*        NOTFND  (9100-NOTFND)
 21283*        ENDFILE (9100-NOTFND)
 21284*    END-EXEC.
 21285*    MOVE '"$I''                  ! @ #00019788' TO DFHEIV0
 21286     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21288     MOVE X'4020233030303139373838' TO DFHEIV0(25:11)
 21289     CALL 'kxdfhei1' USING DFHEIV0
 21290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21291
 21292
 21293
 21294* EXEC CICS READ
 21295*        DATASET     (CNTL-ID)
 21296*        INTO        (CONTROL-FILE)
 21297*        RIDFLD      (ELCNTL-KEY)
 21298*        GTEQ
 21299*    END-EXEC.
 21300     MOVE LENGTH OF
 21301      CONTROL-FILE
 21302       TO DFHEIV11
 21303*    MOVE '&"IL       G          (   #00019793' TO DFHEIV0
 21304     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21306     MOVE X'2020233030303139373933' TO DFHEIV0(25:11)
 21307     CALL 'kxdfhei1' USING DFHEIV0,
 21308           CNTL-ID,
 21309           CONTROL-FILE,
 21310           DFHEIV11,
 21311           ELCNTL-KEY,
 21312           DFHEIV99,
 21313           DFHEIV99,
 21314           DFHEIV99
 21315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21316
 21317
 21318     GO TO 9100-EXIT.
 21319
 21320 9100-NOTFND.
 21321     IF RC-SW-2 = '0'
 21322        MOVE '1'                  TO STATE-RECORD-ERROR
 21323        GO TO 9100-EXIT
 21324     END-IF
 21325     IF RC-SW-2 = '1'
 21326        MOVE '1'                  TO LF-BENEFIT-ERROR
 21327        MOVE ER-2604              TO WS-ERROR
 21328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21329        GO TO 9100-EXIT.
 21330
 21331     IF RC-SW-2 = '2'
 21332        MOVE '1'                  TO AH-BENEFIT-ERROR
 21333        MOVE ER-2605              TO WS-ERROR
 21334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21335        GO TO 9100-EXIT.
 21336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 394
* EL050.cbl
 21337     IF RC-SW-2 = '3'
 21338         MOVE ER-2603           TO WS-ERROR
 21339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21340         GO TO 9100-EXIT.
 21341
 21342     IF RC-SW-2 = '4'
 21343         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21344         GO TO 9100-EXIT.
 21345
 21346     IF RC-SW-2 = '5'
 21347         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21348         IF WS-AH-INPUT-CD-1 = SPACE
 21349             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21350         ELSE
 21351             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21352
 21353 9100-EXIT.
 21354      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 395
* EL050.cbl
 21356 9200-CONTROL-GETMAIN.
 21357
 21358* EXEC CICS GETMAIN
 21359*         LENGTH   (750)
 21360*         SET      (ADDRESS OF CONTROL-FILE)
 21361*    END-EXEC.
 21362     MOVE 750
 21363       TO DFHEIV11
 21364*    MOVE '," L                  $   #00019839' TO DFHEIV0
 21365     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21367     MOVE X'2020233030303139383339' TO DFHEIV0(25:11)
 21368     CALL 'kxdfhei1' USING DFHEIV0,
 21369           DFHEIV20,
 21370           DFHEIV11,
 21371           DFHEIV99
 21372     SET ADDRESS OF CONTROL-FILE TO
 21373         DFHEIV20
 21374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21375
 21376
 21377     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21378
 21379 9200-EXIT.
 21380     EXIT.
 21381
 21382 9250-UNLOCK-RETURN.
 21383
 21384* EXEC CICS UNLOCK
 21385*        DATASET   (CERT-ID)
 21386*    END-EXEC.
 21387*    MOVE '&*                    #   #00019850' TO DFHEIV0
 21388     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21389     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21390     MOVE X'2020233030303139383530' TO DFHEIV0(25:11)
 21391     CALL 'kxdfhei1' USING DFHEIV0,
 21392           CERT-ID,
 21393           DFHEIV99
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21395
 21396
 21397 9300-ABEND.
 21398     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21399
 21400
 21401* EXEC CICS LINK
 21402*        PROGRAM   ('EL004')
 21403*        COMMAREA  (WS-ERROR-LINE)
 21404*        LENGTH    (72)
 21405*    END-EXEC.
 21406     MOVE 'EL004' TO DFHEIV1
 21407     MOVE 72
 21408       TO DFHEIV11
 21409*    MOVE '."C                   (   #00019857' TO DFHEIV0
 21410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21412     MOVE X'2020233030303139383537' TO DFHEIV0(25:11)
 21413     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 396
* EL050.cbl
 21414           DFHEIV1,
 21415           WS-ERROR-LINE,
 21416           DFHEIV11,
 21417           DFHEIV99,
 21418           DFHEIV99,
 21419           DFHEIV99,
 21420           DFHEIV99
 21421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21422
 21423
 21424     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21425
 21426
 21427* EXEC CICS ABEND
 21428*        ABCODE ('EL50')
 21429*    END-EXEC.
 21430     MOVE 'EL50' TO DFHEIV5
 21431*    MOVE '.,A                   "   #00019865' TO DFHEIV0
 21432     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21433     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21434     MOVE X'2020233030303139383635' TO DFHEIV0(25:11)
 21435     CALL 'kxdfhei1' USING DFHEIV0,
 21436           DFHEIV5
 21437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21438
 21439
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 397
* EL050.cbl
 21441
 21442******************************************************************
 21443*                                                                *
 21444*            E R R O R   F O R M A T   R O U T I N E             *
 21445*                                                                *
 21446******************************************************************
 21447
 21448 9900-ERROR-FORMAT.
 21449
 21450     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21451                    PB-COMMON-ERROR (2) OR
 21452                    PB-COMMON-ERROR (3) OR
 21453                    PB-COMMON-ERROR (4) OR
 21454                    PB-COMMON-ERROR (5) OR
 21455                    PB-COMMON-ERROR (6) OR
 21456                    PB-COMMON-ERROR (7) OR
 21457                    PB-COMMON-ERROR (8) OR
 21458                    PB-COMMON-ERROR (9) OR
 21459                    PB-COMMON-ERROR (10)
 21460        GO TO 9900-EXIT.
 21461
 21462     IF PB-NO-OF-ERRORS = +10
 21463        GO TO 9900-EXIT.
 21464
 21465     ADD +1  TO PB-NO-OF-ERRORS.
 21466     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21467                                       (PB-NO-OF-ERRORS).
 21468 9900-EXIT.
 21469     EXIT.
 21470
 21471 9990-RETURN.
 21472     IF BROWSE-STARTED
 21473
 21474* EXEC CICS ENDBR
 21475*            DATASET  (ACCT-ID)
 21476*       END-EXEC.
 21477     MOVE 0
 21478       TO DFHEIV11
 21479*    MOVE '&2                    $   #00019902' TO DFHEIV0
 21480     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21482     MOVE X'2020233030303139393032' TO DFHEIV0(25:11)
 21483     CALL 'kxdfhei1' USING DFHEIV0,
 21484           ACCT-ID,
 21485           DFHEIV11,
 21486           DFHEIV99
 21487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21488
 21489
 21490 9990-EXIT.
 21491     EXIT.
 21492
 21493
 21494****Check for CRTO record, add one if not found.
 21495 9991-CHECK-FOR-ELCRTO.
 21496
 21497* EXEC CICS HANDLE CONDITION
 21498*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 398
* EL050.cbl
 21499*         ENDFILE (9991-CRTO-NOT-FOUND)
 21500*     END-EXEC.
 21501*    MOVE '"$I''                  ! A #00019912' TO DFHEIV0
 21502     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21504     MOVE X'4120233030303139393132' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0
 21506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21507
 21508     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21509     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21510     MOVE +0                     TO ELCRTO-SEQ-NO
 21511
 21512
 21513* EXEC CICS READ
 21514*       DATASET   ('ELCRTO')
 21515*       INTO      (ORIGINAL-CERTIFICATE)
 21516*       RIDFLD    (ELCRTO-KEY)
 21517*       GTEQ
 21518*       RESP      (WS-RESPONSE)
 21519*    END-EXEC
 21520     MOVE LENGTH OF
 21521      ORIGINAL-CERTIFICATE
 21522       TO DFHEIV11
 21523     MOVE 'ELCRTO' TO DFHEIV1
 21524*    MOVE '&"IL       G          (  N#00019920' TO DFHEIV0
 21525     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21527     MOVE X'204E233030303139393230' TO DFHEIV0(25:11)
 21528     CALL 'kxdfhei1' USING DFHEIV0,
 21529           DFHEIV1,
 21530           ORIGINAL-CERTIFICATE,
 21531           DFHEIV11,
 21532           ELCRTO-KEY,
 21533           DFHEIV99,
 21534           DFHEIV99,
 21535           DFHEIV99
 21536     MOVE EIBRESP  TO WS-RESPONSE
 21537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21538
 21539     IF WS-RESP-NORMAL
 21540        AND (OC-CONTROL-PRIMARY (1:33) =
 21541                 PB-CONTROL-BY-ACCOUNT (1:33))
 21542        AND (OC-RECORD-TYPE =  'I')
 21543           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21544               GO TO 9991-CHECK-INDICATORS
 21545           ELSE
 21546               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21547               GO TO 9991-CRTO-ADD-REC
 21548           END-IF
 21549     END-IF.
 21550
 21551 9991-CRTO-NOT-FOUND.
 21552
 21553     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21554     MOVE 'OC'                TO OC-RECORD-ID
 21555     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21556                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 399
* EL050.cbl
 21557     MOVE +4096               TO OC-KEY-SEQ-NO.
 21558
 21559 9991-CRTO-ADD-REC.
 21560
 21561     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21562     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21563     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21564     MOVE 'I'                 TO OC-RECORD-TYPE
 21565     IF PB-ISSUE
 21566         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21567         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21568         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21569         MOVE PB-I-AGE               TO OC-INS-AGE
 21570         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21571         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21572         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21573         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21574         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21575         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21576         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21577         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21578         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21579         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21580         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21581         IF PB-I-JOINT-COMMISSION > +0
 21582             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21583         ELSE
 21584             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21585         END-IF
 21586         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21587         MOVE +0                     TO OC-LF-CANCEL-AMT
 21588                                        OC-LF-ITD-CANCEL-AMT
 21589         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21590         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21591         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21592         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21593         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21594         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21595         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21596         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21597         MOVE +0                     TO OC-AH-CANCEL-AMT
 21598                                        OC-AH-ITD-CANCEL-AMT
 21599         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21600         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21601         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21602     ELSE
 21603         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21604         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21605         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21606         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21607         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21608         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21609         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21610         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21611         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21612          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21613             MOVE SPACES             TO OC-LF-BENCD
 21614             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 400
* EL050.cbl
 21615                                        OC-LF-BEN-AMT
 21616                                        OC-LF-PRM-AMT
 21617                                        OC-LF-ALT-BEN-AMT
 21618                                        OC-LF-ALT-PRM-AMT
 21619                                        OC-LF-COMM-PCT
 21620                                        OC-LF-CANCEL-AMT
 21621             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21622             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21623         ELSE
 21624             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21625             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21626             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21627             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21628             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21629             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21630             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21631             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21632             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21633             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21634         END-IF
 21635         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21636         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21637          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21638             MOVE SPACES             TO OC-AH-BENCD
 21639             MOVE ZEROS              TO OC-AH-TERM
 21640                                        OC-AH-BEN-AMT
 21641                                        OC-AH-PRM-AMT
 21642                                        OC-AH-COMM-PCT
 21643                                        OC-AH-CANCEL-AMT
 21644                                        OC-AH-CP
 21645             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21646             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21647         ELSE
 21648             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21649             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21650             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21651             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21652             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21653             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21654             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21655             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21656             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21657         END-IF
 21658         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21659         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21660         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21661         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21662     END-IF
 21663     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21664
 21665     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21666
 21667
 21668* EXEC CICS READ
 21669*         DATASET   (FILE-ERMAIL)
 21670*         RIDFLD    (MA-CONTROL-PRIMARY)
 21671*         INTO      (MAILING-DATA)
 21672*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 401
* EL050.cbl
 21673*    END-EXEC
 21674     MOVE LENGTH OF
 21675      MAILING-DATA
 21676       TO DFHEIV11
 21677*    MOVE '&"IL       E          (  N#00020056' TO DFHEIV0
 21678     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21680     MOVE X'204E233030303230303536' TO DFHEIV0(25:11)
 21681     CALL 'kxdfhei1' USING DFHEIV0,
 21682           FILE-ERMAIL,
 21683           MAILING-DATA,
 21684           DFHEIV11,
 21685           MA-CONTROL-PRIMARY,
 21686           DFHEIV99,
 21687           DFHEIV99,
 21688           DFHEIV99
 21689     MOVE EIBRESP  TO WS-RESPONSE
 21690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21691
 21692     IF WS-RESP-NORMAL
 21693         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21694     END-IF.
 21695
 21696     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21697     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21698
 21699
 21700* EXEC CICS READ
 21701*         DATASET  (CRTT-ID)
 21702*         RIDFLD   (WS-ELCRTT-KEY)
 21703*         INTO     (CERTIFICATE-TRAILERS)
 21704*         RESP     (WS-RESPONSE)
 21705*    END-EXEC
 21706     MOVE LENGTH OF
 21707      CERTIFICATE-TRAILERS
 21708       TO DFHEIV11
 21709*    MOVE '&"IL       E          (  N#00020070' TO DFHEIV0
 21710     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21712     MOVE X'204E233030303230303730' TO DFHEIV0(25:11)
 21713     CALL 'kxdfhei1' USING DFHEIV0,
 21714           CRTT-ID,
 21715           CERTIFICATE-TRAILERS,
 21716           DFHEIV11,
 21717           WS-ELCRTT-KEY,
 21718           DFHEIV99,
 21719           DFHEIV99,
 21720           DFHEIV99
 21721     MOVE EIBRESP  TO WS-RESPONSE
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21723
 21724     IF WS-RESP-NORMAL
 21725         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21726         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21727     END-IF.
 21728
 21729
 21730* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 402
* EL050.cbl
 21731*       DATASET   ('ELCRTO')
 21732*       FROM      (ORIGINAL-CERTIFICATE)
 21733*       RIDFLD    (OC-CONTROL-PRIMARY)
 21734*       RESP      (WS-RESPONSE)
 21735*    END-EXEC.
 21736     MOVE LENGTH OF
 21737      ORIGINAL-CERTIFICATE
 21738       TO DFHEIV11
 21739     MOVE 'ELCRTO' TO DFHEIV1
 21740*    MOVE '&$ L                  ''  N#00020082' TO DFHEIV0
 21741     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21743     MOVE X'204E233030303230303832' TO DFHEIV0(25:11)
 21744     CALL 'kxdfhei1' USING DFHEIV0,
 21745           DFHEIV1,
 21746           ORIGINAL-CERTIFICATE,
 21747           DFHEIV11,
 21748           OC-CONTROL-PRIMARY,
 21749           DFHEIV99,
 21750           DFHEIV99
 21751     MOVE EIBRESP  TO WS-RESPONSE
 21752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21753
 21754
 21755     GO TO 9991-EXIT.
 21756
 21757 9991-CHECK-INDICATORS.
 21758
 21759     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21760         GO TO 9991-EXIT
 21761     END-IF.
 21762
 21763     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21764         GO TO 9991-EXIT
 21765     END-IF.
 21766
 21767
 21768* EXEC CICS READ
 21769*       DATASET   ('ELCRTO')
 21770*       INTO      (ORIGINAL-CERTIFICATE)
 21771*       RIDFLD    (OC-CONTROL-PRIMARY)
 21772*       UPDATE
 21773*       RESP      (WS-RESPONSE)
 21774*    END-EXEC
 21775     MOVE LENGTH OF
 21776      ORIGINAL-CERTIFICATE
 21777       TO DFHEIV11
 21778     MOVE 'ELCRTO' TO DFHEIV1
 21779*    MOVE '&"IL       EU         (  N#00020101' TO DFHEIV0
 21780     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21781     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21782     MOVE X'204E233030303230313031' TO DFHEIV0(25:11)
 21783     CALL 'kxdfhei1' USING DFHEIV0,
 21784           DFHEIV1,
 21785           ORIGINAL-CERTIFICATE,
 21786           DFHEIV11,
 21787           OC-CONTROL-PRIMARY,
 21788           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 403
* EL050.cbl
 21789           DFHEIV99,
 21790           DFHEIV99
 21791     MOVE EIBRESP  TO WS-RESPONSE
 21792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21793     IF WS-RESP-NORMAL
 21794        IF PB-ISSUE
 21795          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21796          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21797          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21798          MOVE PB-I-AGE               TO OC-INS-AGE
 21799          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21800          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21801          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21802          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21803          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21804          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21805          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21806          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21807          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21808          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21809          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21810          IF PB-I-JOINT-COMMISSION > +0
 21811              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21812          ELSE
 21813              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21814          END-IF
 21815          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21816          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21817          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21818          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21819          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21820          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21821          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21822          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21823          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21824
 21825          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21826
 21827* EXEC CICS READ
 21828*             DATASET   (FILE-ERMAIL)
 21829*             RIDFLD    (MA-CONTROL-PRIMARY)
 21830*             INTO      (MAILING-DATA)
 21831*             RESP      (WS-RESPONSE)
 21832*         END-EXEC
 21833     MOVE LENGTH OF
 21834      MAILING-DATA
 21835       TO DFHEIV11
 21836*    MOVE '&"IL       E          (  N#00020141' TO DFHEIV0
 21837     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21839     MOVE X'204E233030303230313431' TO DFHEIV0(25:11)
 21840     CALL 'kxdfhei1' USING DFHEIV0,
 21841           FILE-ERMAIL,
 21842           MAILING-DATA,
 21843           DFHEIV11,
 21844           MA-CONTROL-PRIMARY,
 21845           DFHEIV99,
 21846           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 404
* EL050.cbl
 21847           DFHEIV99
 21848     MOVE EIBRESP  TO WS-RESPONSE
 21849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21850          IF WS-RESP-NORMAL
 21851             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21852          END-IF
 21853
 21854          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21855          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21856
 21857* EXEC CICS READ
 21858*             DATASET  (CRTT-ID)
 21859*             RIDFLD   (WS-ELCRTT-KEY)
 21860*             INTO     (CERTIFICATE-TRAILERS)
 21861*             RESP     (WS-RESPONSE)
 21862*         END-EXEC
 21863     MOVE LENGTH OF
 21864      CERTIFICATE-TRAILERS
 21865       TO DFHEIV11
 21866*    MOVE '&"IL       E          (  N#00020153' TO DFHEIV0
 21867     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21869     MOVE X'204E233030303230313533' TO DFHEIV0(25:11)
 21870     CALL 'kxdfhei1' USING DFHEIV0,
 21871           CRTT-ID,
 21872           CERTIFICATE-TRAILERS,
 21873           DFHEIV11,
 21874           WS-ELCRTT-KEY,
 21875           DFHEIV99,
 21876           DFHEIV99,
 21877           DFHEIV99
 21878     MOVE EIBRESP  TO WS-RESPONSE
 21879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21880          IF WS-RESP-NORMAL
 21881             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21882                               OC-INS-AGE-DEFAULT-FLAG
 21883             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21884                               OC-JNT-AGE-DEFAULT-FLAG
 21885          END-IF
 21886
 21887        ELSE
 21888          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21889             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21890             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21891             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21892          END-IF
 21893          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21894             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21895             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21896             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21897          END-IF
 21898          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21899        END-IF
 21900
 21901* EXEC CICS REWRITE
 21902*          DATASET   ('ELCRTO')
 21903*          FROM      (ORIGINAL-CERTIFICATE)
 21904*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 405
* EL050.cbl
 21905*       END-EXEC
 21906     MOVE LENGTH OF
 21907      ORIGINAL-CERTIFICATE
 21908       TO DFHEIV11
 21909     MOVE 'ELCRTO' TO DFHEIV1
 21910*    MOVE '&& L                  %  N#00020179' TO DFHEIV0
 21911     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21912     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21913     MOVE X'204E233030303230313739' TO DFHEIV0(25:11)
 21914     CALL 'kxdfhei1' USING DFHEIV0,
 21915           DFHEIV1,
 21916           ORIGINAL-CERTIFICATE,
 21917           DFHEIV11,
 21918           DFHEIV99
 21919     MOVE EIBRESP  TO WS-RESPONSE
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21921     END-IF.
 21922
 21923 9991-EXIT.
 21924     EXIT.
 21925
 21926
 21927 9999-RETURN.
 21928     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21929
 21930
 21931* EXEC CICS RETURN
 21932*    END-EXEC.
 21933*    MOVE '.(                    ''   #00020193' TO DFHEIV0
 21934     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21935     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21936     MOVE X'2020233030303230313933' TO DFHEIV0(25:11)
 21937     CALL 'kxdfhei1' USING DFHEIV0,
 21938           DFHEIV99,
 21939           DFHEIV99,
 21940           DFHEIV99,
 21941           DFHEIV99,
 21942           DFHEIV99,
 21943           DFHEIV99
 21944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21945
 21946
 21947
 21948* GOBACK.
 21949     MOVE '9%                    "   ' TO DFHEIV0
 21950     MOVE 'EL050' TO DFHEIV1
 21951     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21952     GOBACK.
 21953
 21954 9999-DFHBACK SECTION.
 21955     MOVE '9%                    "   ' TO DFHEIV0
 21956     MOVE 'EL050' TO DFHEIV1
 21957     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21958     GOBACK.
 21959 9999-DFHEXIT.
 21960     IF DFHEIGDJ EQUAL 0001
 21961         NEXT SENTENCE
 21962     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 406
* EL050.cbl
 21963         GO TO 9300-ABEND,
 21964               3990-FILES-NOT-OPEN
 21965         DEPENDING ON DFHEIGDI
 21966     ELSE IF DFHEIGDJ EQUAL 3
 21967         GO TO 6610-START-BROWSE,
 21968               6630-ERRESS-PROBLEM,
 21969               6630-END-OF-FILE
 21970         DEPENDING ON DFHEIGDI
 21971     ELSE IF DFHEIGDJ EQUAL 4
 21972         GO TO 6630-END-OF-FILE,
 21973               6630-ERRESS-PROBLEM,
 21974               6630-ERRESS-PROBLEM,
 21975               6630-END-OF-FILE
 21976         DEPENDING ON DFHEIGDI
 21977     ELSE IF DFHEIGDJ EQUAL 5
 21978         GO TO 6630-END-OF-FILE,
 21979               6630-END-OF-FILE,
 21980               6630-ERRESS-PROBLEM,
 21981               6630-ERRESS-PROBLEM
 21982         DEPENDING ON DFHEIGDI
 21983     ELSE IF DFHEIGDJ EQUAL 6
 21984         GO TO 6660-START-BROWSE,
 21985               6690-ERRESC-PROBLEM,
 21986               6690-ERRESC-PROBLEM,
 21987               6690-END-OF-FILE
 21988         DEPENDING ON DFHEIGDI
 21989     ELSE IF DFHEIGDJ EQUAL 7
 21990         GO TO 6690-END-OF-FILE,
 21991               6690-ERRESC-PROBLEM,
 21992               6690-ERRESC-PROBLEM,
 21993               6690-END-OF-FILE
 21994         DEPENDING ON DFHEIGDI
 21995     ELSE IF DFHEIGDJ EQUAL 8
 21996         GO TO 6690-END-OF-FILE,
 21997               6690-ERRESC-PROBLEM,
 21998               6690-ERRESC-PROBLEM,
 21999               6690-END-OF-FILE
 22000         DEPENDING ON DFHEIGDI
 22001     ELSE IF DFHEIGDJ EQUAL 9
 22002         GO TO 7250-CONTINUE,
 22003               7250-CONTINUE
 22004         DEPENDING ON DFHEIGDI
 22005     ELSE IF DFHEIGDJ EQUAL 10
 22006         GO TO 7300-CONTINUE,
 22007               7300-CONTINUE
 22008         DEPENDING ON DFHEIGDI
 22009     ELSE IF DFHEIGDJ EQUAL 11
 22010         GO TO 8000-FREE-MAIN
 22011         DEPENDING ON DFHEIGDI
 22012     ELSE IF DFHEIGDJ EQUAL 12
 22013         GO TO 8100-NOTFND,
 22014               8100-NOTFND
 22015         DEPENDING ON DFHEIGDI
 22016     ELSE IF DFHEIGDJ EQUAL 13
 22017         GO TO 8110-NOTFND,
 22018               8110-NOTFND
 22019         DEPENDING ON DFHEIGDI
 22020     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 407
* EL050.cbl
 22021         GO TO 8130-EXIT
 22022         DEPENDING ON DFHEIGDI
 22023     ELSE IF DFHEIGDJ EQUAL 15
 22024         GO TO 8150-exit
 22025         DEPENDING ON DFHEIGDI
 22026     ELSE IF DFHEIGDJ EQUAL 16
 22027         GO TO 8180-NOTFND
 22028         DEPENDING ON DFHEIGDI
 22029     ELSE IF DFHEIGDJ EQUAL 17
 22030         GO TO 8190-NOTFND
 22031         DEPENDING ON DFHEIGDI
 22032     ELSE IF DFHEIGDJ EQUAL 18
 22033         GO TO 8195-NOTFND
 22034         DEPENDING ON DFHEIGDI
 22035     ELSE IF DFHEIGDJ EQUAL 19
 22036         GO TO 8200-NOTFND
 22037         DEPENDING ON DFHEIGDI
 22038     ELSE IF DFHEIGDJ EQUAL 20
 22039         GO TO 8300-NOTFND,
 22040               8300-ERRESS-PROBLEM,
 22041               8300-ERRESS-PROBLEM,
 22042               8300-NOTFND
 22043         DEPENDING ON DFHEIGDI
 22044     ELSE IF DFHEIGDJ EQUAL 21
 22045         GO TO 8450-FORM-NOT-FOUND,
 22046               8450-FORM-NOT-FOUND
 22047         DEPENDING ON DFHEIGDI
 22048     ELSE IF DFHEIGDJ EQUAL 22
 22049         GO TO 0199-ACCT-NOT-FOUND,
 22050               0199-ACCT-NOT-FOUND
 22051         DEPENDING ON DFHEIGDI
 22052     ELSE IF DFHEIGDJ EQUAL 23
 22053         GO TO 0199-ACCT-NOT-FOUND,
 22054               0199-ACCT-NOT-FOUND
 22055         DEPENDING ON DFHEIGDI
 22056     ELSE IF DFHEIGDJ EQUAL 24
 22057         GO TO 8582-COMP-NOT-FOUND,
 22058               8582-COMP-NOT-FOUND
 22059         DEPENDING ON DFHEIGDI
 22060     ELSE IF DFHEIGDJ EQUAL 25
 22061         GO TO 8583-AGTC-NOT-FOUND,
 22062               8583-AGTC-NOT-FOUND
 22063         DEPENDING ON DFHEIGDI
 22064     ELSE IF DFHEIGDJ EQUAL 26
 22065         GO TO 8584-BXRF-NOT-FOUND,
 22066               8584-BXRF-NOT-FOUND
 22067         DEPENDING ON DFHEIGDI
 22068     ELSE IF DFHEIGDJ EQUAL 27
 22069         GO TO 8585-PLAN-NOT-FOUND,
 22070               8585-PLAN-NOT-FOUND
 22071         DEPENDING ON DFHEIGDI
 22072     ELSE IF DFHEIGDJ EQUAL 28
 22073         GO TO 0299-CERT-NOT-FOUND
 22074         DEPENDING ON DFHEIGDI
 22075     ELSE IF DFHEIGDJ EQUAL 29
 22076         GO TO 8700-READ-CERT-MASTER
 22077         DEPENDING ON DFHEIGDI
 22078     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 06-Oct-14 13:28 Page 408
* EL050.cbl
 22079         GO TO 8720-COMP-ACCOUNTS,
 22080               8730-END-BROWSE,
 22081               8740-NOT-FOUND
 22082         DEPENDING ON DFHEIGDI
 22083     ELSE IF DFHEIGDJ EQUAL 31
 22084         GO TO 9000-NOTFND
 22085         DEPENDING ON DFHEIGDI
 22086     ELSE IF DFHEIGDJ EQUAL 32
 22087         GO TO 9100-NOTFND,
 22088               9100-NOTFND
 22089         DEPENDING ON DFHEIGDI
 22090     ELSE IF DFHEIGDJ EQUAL 33
 22091         GO TO 9991-CRTO-NOT-FOUND,
 22092               9991-CRTO-NOT-FOUND
 22093         DEPENDING ON DFHEIGDI.
 22094     MOVE '9%                    "   ' TO DFHEIV0
 22095     MOVE 'EL050' TO DFHEIV1
 22096     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22097     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40040     Code:       89099
