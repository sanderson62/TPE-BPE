* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47******************************************************************
    48 ENVIRONMENT DIVISION.
    49
    50 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   3
* EL050.cbl
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54
    55 77  FILLER   PIC X(32) VALUE '********************************'.
    56 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    57 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    58
    59 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    60 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    61                                   USAGE POINTER.
    62 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    63 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    64 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    65                                   USAGE IS POINTER.
    66 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    67 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    68                                   USAGE IS POINTER.
    69 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    75                                   USAGE IS POINTER.
    76
    77*    COPY ELC50WS.
    78*****************************************************************
    79*                                                               *
    80*                            ELC50WS.                           *
    81*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    82*                            VMOD=2.061.                        *
    83*                                                               *
    84*   THIS IS THE WORKING STORAGE FOR EL050                       *
    85*                                   EL517                       *
    86*****************************************************************
    87******************************************************************
    88*                   C H A N G E   L O G
    89*
    90* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    91*-----------------------------------------------------------------
    92*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    93* EFFECTIVE    NUMBER
    94*-----------------------------------------------------------------
    95* 123102                   PEMA  ADD DCC PROCESSING
    96* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    97* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    98* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    99* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   100* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   101* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   102* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   103* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   104* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   105* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   106* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   107* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   108* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   109* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   4
* EL050.cbl
   110* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   111* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   112* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   113* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   114* 030309  CR2009021700001  PEMA  ADD ER-2883
   115* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   116* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   117* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   118* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   119* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   120* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   121* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   122* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   123* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   125* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   126* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   127* 061412  CR2011022800001  AJRA  NAPERSOFT
   128* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   129* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   130* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   131* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   132* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   133* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   134*-----------------------------------------------------------------
   135
   136 01  WORK-AREAS.
   137
   138*****************************************************************
   139*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   140*****************************************************************
   141
   142     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   143     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   144     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   145     12  WS-NAME-EDIT-WORK-AREA.
   146         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   147         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   148             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   149         16  WS-WORK-NAME.
   150             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   151             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   152             20  FILLER           PIC X(10)     VALUE SPACES.
   153         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   154             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   155
   156*****************************************************************
   157*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   158*****************************************************************
   159
   160     12  WS-ERRESC-KEY.
   161         16 WS-ERRESC-SEARCH-KEY.
   162             20  WS-ERRESC-COMPANY-CD PIC  X.
   163             20  WS-ERRESC-CARRIER    PIC  X.
   164             20  WS-ERRESC-GROUP      PIC X(6).
   165             20  WS-ERRESC-STATE      PIC XX.
   166             20  WS-ERRESC-ACCOUNT    PIC X(10).
   167         16 WS-ERRESC-RESIDUAL-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   5
* EL050.cbl
   168             20  WS-ERRESC-AGENT      PIC X(10).
   169             20  WS-ERRESC-RES-STATE  PIC XX.
   170             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   171*                                          YYYYMMDD
   172     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   173     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   174
   175*RESIDENT STATE TAX MASTER(ERRESS)
   176*
   177     12  WS-ERRESS-KEY.
   178         16  WS-ERRESS-COMPANY-CD      PIC  X.
   179         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   180         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   181         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   182*                                          YYYYMMDD
   183
   184     12  WS-CONTRACT-DATE              PIC 9(8).
   185*                                          YYYYMMDD
   186     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   187     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   188         16 WS-YEAR-YY                 PIC   9999.
   189         16 FILLER                     PIC 9(4).
   190*                                          YYYYMMDD
   191     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   192     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   193     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   194     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   195
   196     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   197         88  DPRB-1ST-TIME                      VALUE ' '.
   198
   199*****************************************************************
   200*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   201*****************************************************************
   202
   203     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   204     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   205     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   206     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   207     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   208     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   209     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   210     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   211     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   212     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   213         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   214         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   215     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   216         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   217         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   218     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   219
   220     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   221     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   222
   223     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   224     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   6
* EL050.cbl
   226     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   234     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   235     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   237     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   238     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   254     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   259     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   260     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   261     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   262     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   271     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   272     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   273     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   274     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   275     12  WS-2671-SW               PIC X         VALUE SPACE.
   276     12  WS-2672-SW               PIC X         VALUE SPACE.
   277     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   278         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   279     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   280         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   281     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   282
   283     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   7
* EL050.cbl
   284         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   285         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   286         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   287         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   288
   289     12  WS-CREDIT-EDIT-CONTROLS.
   290         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   291         16  WS-MIN-AGE           PIC 99                VALUE  0.
   292         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   293         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   294         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   295         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   296
   297     12  WS-AGE-FIELDS.
   298         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   299         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   300         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   301         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   302
   303     12  WS-SAVE-ALLOWABLE-BENEFIT.
   304         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   305         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   306         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   307         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   308         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   309         16  FILLER                      PIC XX.
   310
   311     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   312     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   313     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   314     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   315     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   316     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   317     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   318     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   319     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   320     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   321
   322     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   323     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   324     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   325     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   326     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   327     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   328     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   329     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   330         88  WS-REDUCING              VALUE 'R'.
   331         88  WS-LEVEL                 VALUE 'L' 'P'.
   332     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   333
   334     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   335     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   336     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   337     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   338     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   339     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   340     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   341     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   8
* EL050.cbl
   342     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   343
   344     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   345     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   346     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   348     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   349     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   350     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   351     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   352     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   353     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   354     12  WS-ACCT-SIG-SW.
   355         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   356         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   357     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   358     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   359     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   361     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   362     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   364     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   365     12  WS-INITIALS.
   366         16  WS-INIT-1            PIC X         VALUE SPACES.
   367         16  WS-INIT-2            PIC X         VALUE SPACES.
   368
   369     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   370     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   371     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   372     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   373     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   374*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   375     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   377     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   378     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   380     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   381     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   382     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   383     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   385     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   386     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   387     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   388     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   389     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   390     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   393     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   396     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   397******** FLA
   398     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page   9
* EL050.cbl
   400     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   401     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   402     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   403********
   404     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   405     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   406     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   407     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   408     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   409     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   410     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   411     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   412     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   413     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   414
   415     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   416         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   417                                         '0' THRU '9'.
   418
   419     12  NUMBER-OF-MONTHS.
   420         16  SK-MO OCCURS 12 TIMES PIC X.
   421
   422     12  WS-WORK-DATE.
   423         16  WS-YEAR            PIC 99    VALUE 00.
   424         16  WS-MONTH           PIC 99    VALUE 00.
   425         16  WS-DAY             PIC 99    VALUE 00.
   426
   427     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   428     12  WS-WORK-CRIT-DEV       REDEFINES
   429         WS-WORK-LF-CRIT-PER    PIC X(03).
   430
   431     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   432     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   433
   434     12  WS-WORK-DATE-FROM.
   435         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   436         16  FILLER             PIC X  VALUE SPACE.
   437         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   440
   441     12  WS-WORK-DATE-THRU.
   442         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   443         16  FILLER             PIC X         VALUE SPACE.
   444         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   445         16  FILLER             PIC X         VALUE SPACE.
   446         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   447
   448     12  WS-LF-INPUT-CD.
   449         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   450         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   451
   452     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   453     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   454         16  WS-AH-INPUT-CD-1   PIC X.
   455         16  WS-AH-INPUT-CD-2-3 PIC XX.
   456
   457     12  WS-SWITCHES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  10
* EL050.cbl
   458         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   459         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   460             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   461         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   462             88  BANK-ACCT-FOUND          VALUE 'Y'.
   463         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   464             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   465         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   466             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   467         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   468             88  COMP-MASTER-FOUND        VALUE 'Y'.
   469         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   470             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   471         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   472             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   473         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   474             88  STAT-MASTER-FOUND        VALUE 'Y'.
   475         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   476             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   477         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   478             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   479         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   480             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   481         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   482             88  FORM-MASTER-FOUND        VALUE 'Y'.
   483         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   484             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   485         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   486             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   487         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   488             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   489         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   490             88  NO-BENEFIT-FOUND         VALUE 'N'.
   491         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   492             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   493         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   494             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   495         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   496             88  AH-BENEFIT-FOUND         VALUE ' '.
   497             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   498         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   499             88  LF-BENEFIT-FOUND         VALUE ' '.
   500             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   501         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   502             88  NO-STATE-RECORD          VALUE '1'.
   503         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   504             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   505         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   506             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   507         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   508             88  CERT-WAS-FOUND           VALUE ' '.
   509             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   510         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   511             88  BROWSE-STARTED           VALUE 'Y'.
   512         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   513             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   514         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   515             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  11
* EL050.cbl
   516         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   517             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   518         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   519             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   520         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   521             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   522         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   523             88  APP-CERT-USED            VALUE 'Y' 'A'.
   524         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   525             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   526             88  FIRST-TIME-THROUGH       VALUE '1'.
   527             88  CTBL-NOT-FOUND           VALUE '2'.
   528
   529         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   530             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   531
   532         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   533             88  DLO-ERROR-FOUND          VALUE 'Y'.
   534
   535********FLA
   536     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   537     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   538********
   539     12  RC-SW-1                  PIC X           VALUE '0'.
   540     12  RC-SW-2                  PIC X           VALUE '0'.
   541     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   542     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   543     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   546     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   549     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   550     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   551     12  LIT-SPACES               PIC X           VALUE SPACES.
   552     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   553     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   554     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   555     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   556     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   557     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   558     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   559         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   560         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   561     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   562         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   563
   564 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   565     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   566     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   567 01  WS-CRI-SSN-WORK-AREA.
   568     05  WS-CRI-SOC-SEC-NO.
   569         10  WS-SS-REPT-CD       PIC X(5).
   570         10  WS-SS-LAST-NAME     PIC X(5).
   571         10  WS-SS-INITIAL       PIC X.
   572
   573     05  WS-CRI-REPORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  12
* EL050.cbl
   574         10  FILLER              PIC X(5).
   575         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   576
   577     05  WS-CRI-LAST-NAME.
   578         10  WS-CRI-NAME-MOVE    PIC X(5).
   579         10  FILLER              PIC X(10).
   580
   581 01  WS-NUM-TABLE                PIC X(26)  VALUE
   582     '12345678012345070923456789'.
   583 01  FILLER REDEFINES WS-NUM-TABLE.
   584     05  WS-NUM OCCURS 26        PIC 9.
   585 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   586 01  V1                          PIC S999 COMP-3.
   587 01  V2                          PIC S999 COMP-3.
   588 01  V3                          PIC S999 COMP-3.
   589 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   590 01  FILLER REDEFINES WS-WORK-VIN.
   591     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   592 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   593 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   594 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   595 01  WS-HEX-WORK.
   596     05  FILLER                  PIC X  VALUE LOW-VALUES.
   597     05  WS-HEX-BYTE             PIC X.
   598 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   599 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   600 01  WS-WORK-HIN-ROW-B.
   601     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   602
   603 01  ws-benefit-cd-chg-sw      pic x value spaces.
   604     88  benefit-code-chg           value 'Y'.
   605 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   606 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   607     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   608 01  WS-ROW-D-TABLE.
   609     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   610
   611 01  WS-HIN-TABLE-B.
   612     05  F                       PIC XX VALUE 'A2'.
   613     05  F                       PIC XX VALUE 'B3'.
   614     05  F                       PIC XX VALUE 'C4'.
   615     05  F                       PIC XX VALUE 'D5'.
   616     05  F                       PIC XX VALUE 'E6'.
   617     05  F                       PIC XX VALUE 'F7'.
   618     05  F                       PIC XX VALUE 'G8'.
   619     05  F                       PIC XX VALUE 'H9'.
   620     05  F                       PIC XX VALUE 'I1'.
   621     05  F                       PIC XX VALUE 'J2'.
   622     05  F                       PIC XX VALUE 'K3'.
   623     05  F                       PIC XX VALUE 'L4'.
   624     05  F                       PIC XX VALUE 'M5'.
   625     05  F                       PIC XX VALUE 'N6'.
   626     05  F                       PIC XX VALUE 'O0'.
   627     05  F                       PIC XX VALUE 'P7'.
   628     05  F                       PIC XX VALUE 'Q0'.
   629     05  F                       PIC XX VALUE 'R8'.
   630     05  F                       PIC XX VALUE 'S9'.
   631     05  F                       PIC XX VALUE 'T2'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  13
* EL050.cbl
   632     05  F                       PIC XX VALUE 'U3'.
   633     05  F                       PIC XX VALUE 'V4'.
   634     05  F                       PIC XX VALUE 'W5'.
   635     05  F                       PIC XX VALUE 'X6'.
   636     05  F                       PIC XX VALUE 'Y7'.
   637     05  F                       PIC XX VALUE 'Z8'.
   638 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   639     05  WS-VAL-IN               PIC X.
   640     05  WS-VAL-OUT              PIC 9.
   641 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   642 01  WS-COMPARE-BINARY-DATES.
   643     05  WS-971231                PIC XX VALUE X'92FF'.
   644     05  WS-931231                PIC XX VALUE X'8CFF'.
   645     05  WS-791231                PIC XX VALUE X'77FF'.
   646     05  WS-771001                PIC XX VALUE X'74A1'.
   647     05  WS-820301                PIC XX VALUE X'7B41'.
   648     05  WS-831031                PIC XX VALUE X'7DBF'.
   649     05  WS-831231                PIC XX VALUE X'7DFF'.
   650     05  WS-810831                PIC XX VALUE X'7A7F'.
   651     05  WS-830901                PIC XX VALUE X'7D81'.
   652
   653 01  FILE-ACCESS-IDS.
   654     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   655     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   656     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   657     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   658     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   659     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   660     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   661     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   662     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   663     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   664     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   665     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   666     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   667     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   668     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   669     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   670     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   671 01  DD-IU-SW                    PIC X   VALUE ' '.
   672     88  DD-IU-PRESENT                 VALUE 'Y'.
   673
   674 01  ACCESS-KEYS.
   675     12  ELMSTR-KEY.
   676         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   677         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   678     12  W-CLAIM-KEY.
   679         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   680         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   681
   682     12  ELCNTL-KEY.
   683         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   684         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   685         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   686         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   687
   688     12  ELCERT-KEY.
   689         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  14
* EL050.cbl
   690         16  CERT-CARRIER         PIC X       VALUE SPACE.
   691         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   692         16  CERT-STATE           PIC XX      VALUE SPACES.
   693         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   694         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   695         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   696
   697     12  ELCERT2-KEY.
   698         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   699         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   700
   701     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   702
   703     12  ELCERT-SAVE.
   704         16  FILLER                      PIC XX    VALUE SPACES.
   705
   706         16  WCS-CONTROL-PRIMARY.
   707             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   708             20  WCS-CARRIER             PIC X     VALUE SPACE.
   709             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   710             20  WCS-STATE               PIC XX    VALUE SPACES.
   711             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   712             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   713             20  WCS-CERT-NO.
   714                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   715                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-NAME.
   718             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   719             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   720             20  CS-INSURED-INITIALS.
   721                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   722                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   723
   724         16  CS-CONTROL-BY-SSN.
   725             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   726             20  CS-SOC-SEC-NO.
   727                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   728                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   729                 24  CS-SSN-LN3.
   730                     28 CS-INSURED-INITIALS-A2   PIC XX
   731                                     VALUE SPACES.
   732                     28 CS-PART-LAST-NAME-A2     PIC X
   733                                     VALUE SPACE.
   734
   735         16  CS-CONTROL-BY-CERT-NO.
   736             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   737             20  CS-CERT-NO-A4           PIC X(11)
   738                                     VALUE SPACES.
   739
   740         16  CS-CONTROL-BY-MEMB.
   741             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   742             20  CS-MEMBER-NO.
   743                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   744                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   745                 24  CS-MEMB-LN4.
   746                     28 CS-INSURED-INITIALS-A5   PIC XX
   747                                      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  15
* EL050.cbl
   748                     28 CS-PART-LAST-NAME-A5     PIC XX
   749                                      VALUE SPACES.
   750
   751         16  FILLER              PIC X(360) VALUE SPACES.
   752
   753     12  ERACCT-KEY.
   754         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   755         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   756         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   757         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   758         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   759         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   760
   761     12  ERCOMP-KEY.
   762         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   763         16  COMP-CARRIER         PIC X     VALUE SPACES.
   764         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   765         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   766         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   767         16  COMP-TYPE            PIC X     VALUE SPACES.
   768
   769     12  ERLOFC-KEY.
   770         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   772         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  LOFC-STATE           PIC XX    VALUE SPACES.
   774         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   775         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   776
   777     12  WS-ELCRTT-KEY.
   778         16  WS-ELCRTT-PRIMARY       PIC X(33).
   779         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   780
   781     12  ERBXRF-KEY.
   782         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   784         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   785         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   786
   787     12  ERAGTC-KEY.
   788         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   789         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   790         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   791         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   792         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   793         16  AGTC-TYPE            PIC X     VALUE SPACES.
   794
   795     12  ERPLAN-KEY.
   796         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   797         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   798         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   799         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   800         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   801         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   802         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   803         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   804
   805     12  ERFORM-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  16
* EL050.cbl
   806         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   807         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   808         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   809         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   810
   811     12  ERREIN-KEY.
   812         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   813         16  REIN-TYPE            PIC X     VALUE SPACES.
   814         16  REIN-TABLE-CO.
   815             20  REIN-CODE-1      PIC X     VALUE SPACE.
   816             20  REIN-CODE-2      PIC X     VALUE SPACE.
   817             20  REIN-CODE-3      PIC X     VALUE SPACE.
   818         16  FILLER               PIC X(3)  VALUE SPACES.
   819
   820     12  ERCTBL-KEY.
   821         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   822         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   823         16  CTBL-CNTRL-2.
   824             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   825             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   826
   827     12  ELCRTO-KEY.
   828         16  ELCRTO-COMPANY-CD       PIC X.
   829         16  ELCRTO-CARRIER          PIC X.
   830         16  ELCRTO-GROUPING         PIC X(6).
   831         16  ELCRTO-STATE            PIC XX.
   832         16  ELCRTO-ACCOUNT          PIC X(10).
   833         16  ELCRTO-CERT-EFF-DT      PIC XX.
   834         16  ELCRTO-CERT-NO.
   835             20  ELCRTO-CERT-PRIME   PIC X(10).
   836             20  ELCRTO-CERT-SFX     PIC X.
   837         16  ELCRTO-RECORD-TYPE      PIC X.
   838         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   839
   840
   841     12  WS-ACCESS.
   842         16  FILLER               PIC XX    VALUE SPACES.
   843         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   844
   845     12  WS-CARR-ACCESS.
   846         16  FILLER               PIC X(3)  VALUE SPACES.
   847         16  WS-CARR              PIC X     VALUE SPACE.
   848*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   849*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   850     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   851         88  WS-DMD-LF-RATING   VALUE 'Y'.
   852         88  WS-DMD-AH-RATING   VALUE 'Y'.
   853         88  WS-DMD-NO-RATING   VALUE 'N'.
   854
   855     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   856         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   857                                         'NJ' 'NL'
   858                                         'PJ' 'PL'
   859                                         'SJ' 'SL'.
   860     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   861         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   862                                         'NI' 'NJ' 'NL' 'NU'
   863                                         'PJ' 'PL' 'PI' 'PU'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  17
* EL050.cbl
   864                                         'SI' 'SJ' 'SL' 'SU'
   865                                         'MX' 'MY' 'MZ'.
   866 01  ERPDEF-KEY-SAVE             PIC X(18).
   867 01  ERPDEF-KEY.
   868     12  ERPDEF-COMPANY-CD       PIC X.
   869     12  ERPDEF-STATE            PIC XX.
   870     12  ERPDEF-PROD-CD          PIC XXX.
   871     12  F                       PIC X(7).
   872     12  ERPDEF-BEN-TYPE         PIC X.
   873     12  ERPDEF-BEN-CODE         PIC XX.
   874     12  ERPDEF-EXP-DT           PIC XX.
   875
   876 01  ELSTAT-KEY-SAVE             PIC X(20).
   877 01  ELSTAT-KEY.
   878     12  ELSTAT-COMPANY-ID       PIC XXX.
   879     12  ELSTAT-CARRIER          PIC X.
   880     12  ELSTAT-GROUP            PIC X(6).
   881     12  ELSTAT-STATE            PIC XX.
   882     12  ELSTAT-EXP-DT           PIC 9(8).
   883 01  WS-ERROR-VALUES.
   884     12  ER-1570                     PIC S9(4)   VALUE +1570.
   885     12  ER-1571                     PIC S9(4)   VALUE +1571.
   886     12  er-1572                     pic s9(4)   value +1572.
   887     12  er-1573                     pic s9(4)   value +1573.
   888     12  er-1574                     pic s9(4)   value +1574.
   889     12  ER-1575                     PIC S9(4)   VALUE +1575.
   890     12  ER-1891                     PIC S9(4)   VALUE +1891.
   891     12  ER-1892                     PIC S9(4)   VALUE +1892.
   892     12  ER-1893                     PIC S9(4)   VALUE +1893.
   893     12  ER-1894                     PIC S9(4)   VALUE +1894.
   894     12  ER-1895                     PIC S9(4)   VALUE +1895.
   895     12  ER-1896                     PIC S9(4)   VALUE +1896.
   896     12  ER-1897                     PIC S9(4)   VALUE +1897.
   897     12  ER-1898                     PIC S9(4)   VALUE +1898.
   898     12  ER-1899                     PIC S9(4)   VALUE +1899.
   899     12  ER-1900                     PIC S9(4)   VALUE +1900.
   900     12  ER-1901                     PIC S9(4)   VALUE +1901.
   901     12  ER-1902                     PIC S9(4)   VALUE +1902.
   902     12  ER-1903                     PIC S9(4)   VALUE +1903.
   903     12  ER-1904                     PIC S9(4)   VALUE +1904.
   904     12  ER-1905                     PIC S9(4)   VALUE +1905.
   905     12  ER-1906                     PIC S9(4)   VALUE +1906.
   906     12  ER-1907                     PIC S9(4)   VALUE +1907.
   907     12  ER-1909                     PIC S9(4)   VALUE +1909.
   908     12  ER-1910                     PIC S9(4)   VALUE +1910.
   909     12  ER-1911                     PIC S9(4)   VALUE +1911.
   910     12  ER-1912                     PIC S9(4)   VALUE +1912.
   911     12  ER-1913                     PIC S9(4)   VALUE +1913.
   912     12  ER-1914                     PIC S9(4)   VALUE +1914.
   913     12  ER-1915                     PIC S9(4)   VALUE +1915.
   914     12  ER-1916                     PIC S9(4)   VALUE +1916.
   915     12  ER-1917                     PIC S9(4)   VALUE +1917.
   916     12  ER-1918                     PIC S9(4)   VALUE +1918.
   917     12  ER-1919                     PIC S9(4)   VALUE +1919.
   918     12  ER-1920                     PIC S9(4)   VALUE +1920.
   919     12  ER-1921                     PIC S9(4)   VALUE +1921.
   920     12  ER-1922                     PIC S9(4)   VALUE +1922.
   921     12  ER-1923                     PIC S9(4)   VALUE +1923.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  18
* EL050.cbl
   922     12  ER-1924                     PIC S9(4)   VALUE +1924.
   923     12  ER-1925                     PIC S9(4)   VALUE +1925.
   924     12  ER-1926                     PIC S9(4)   VALUE +1926.
   925     12  ER-1927                     PIC S9(4)   VALUE +1927.
   926     12  ER-2393                     PIC S9(4)   VALUE +2393.
   927     12  ER-2600                     PIC S9(4)   VALUE +2600.
   928     12  ER-2601                     PIC S9(4)   VALUE +2601.
   929     12  ER-2602                     PIC S9(4)   VALUE +2602.
   930     12  ER-2603                     PIC S9(4)   VALUE +2603.
   931     12  ER-2604                     PIC S9(4)   VALUE +2604.
   932     12  ER-2605                     PIC S9(4)   VALUE +2605.
   933     12  ER-2606                     PIC S9(4)   VALUE +2606.
   934     12  ER-2607                     PIC S9(4)   VALUE +2607.
   935     12  ER-2608                     PIC S9(4)   VALUE +2608.
   936     12  ER-2609                     PIC S9(4)   VALUE +2609.
   937     12  ER-2610                     PIC S9(4)   VALUE +2610.
   938     12  ER-2611                     PIC S9(4)   VALUE +2611.
   939     12  ER-2612                     PIC S9(4)   VALUE +2612.
   940     12  ER-2613                     PIC S9(4)   VALUE +2613.
   941     12  ER-2614                     PIC S9(4)   VALUE +2614.
   942     12  ER-2615                     PIC S9(4)   VALUE +2615.
   943     12  ER-2616                     PIC S9(4)   VALUE +2616.
   944     12  ER-2617                     PIC S9(4)   VALUE +2617.
   945     12  ER-2618                     PIC S9(4)   VALUE +2618.
   946     12  ER-2619                     PIC S9(4)   VALUE +2619.
   947     12  ER-2620                     PIC S9(4)   VALUE +2620.
   948     12  ER-2621                     PIC S9(4)   VALUE +2621.
   949     12  ER-2622                     PIC S9(4)   VALUE +2622.
   950     12  ER-2623                     PIC S9(4)   VALUE +2623.
   951     12  ER-2624                     PIC S9(4)   VALUE +2624.
   952     12  ER-2625                     PIC S9(4)   VALUE +2625.
   953     12  ER-2626                     PIC S9(4)   VALUE +2626.
   954     12  ER-2627                     PIC S9(4)   VALUE +2627.
   955     12  ER-2628                     PIC S9(4)   VALUE +2628.
   956     12  ER-2629                     PIC S9(4)   VALUE +2629.
   957     12  ER-2630                     PIC S9(4)   VALUE +2630.
   958     12  ER-2631                     PIC S9(4)   VALUE +2631.
   959     12  ER-2632                     PIC S9(4)   VALUE +2632.
   960     12  ER-2633                     PIC S9(4)   VALUE +2633.
   961     12  ER-2634                     PIC S9(4)   VALUE +2634.
   962     12  ER-2635                     PIC S9(4)   VALUE +2635.
   963     12  ER-2636                     PIC S9(4)   VALUE +2636.
   964     12  ER-2637                     PIC S9(4)   VALUE +2637.
   965     12  ER-2638                     PIC S9(4)   VALUE +2638.
   966     12  ER-2639                     PIC S9(4)   VALUE +2639.
   967     12  ER-2640                     PIC S9(4)   VALUE +2640.
   968     12  ER-2641                     PIC S9(4)   VALUE +2641.
   969     12  ER-2642                     PIC S9(4)   VALUE +2642.
   970     12  ER-2643                     PIC S9(4)   VALUE +2643.
   971     12  ER-2644                     PIC S9(4)   VALUE +2644.
   972     12  ER-2645                     PIC S9(4)   VALUE +2645.
   973     12  ER-2646                     PIC S9(4)   VALUE +2646.
   974     12  ER-2647                     PIC S9(4)   VALUE +2647.
   975     12  ER-2648                     PIC S9(4)   VALUE +2648.
   976     12  ER-2649                     PIC S9(4)   VALUE +2649.
   977     12  ER-2650                     PIC S9(4)   VALUE +2650.
   978     12  ER-2651                     PIC S9(4)   VALUE +2651.
   979     12  ER-2652                     PIC S9(4)   VALUE +2652.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  19
* EL050.cbl
   980     12  ER-2653                     PIC S9(4)   VALUE +2653.
   981     12  ER-2654                     PIC S9(4)   VALUE +2654.
   982     12  ER-2655                     PIC S9(4)   VALUE +2655.
   983     12  ER-2656                     PIC S9(4)   VALUE +2656.
   984     12  ER-2657                     PIC S9(4)   VALUE +2657.
   985     12  ER-2658                     PIC S9(4)   VALUE +2658.
   986     12  ER-2659                     PIC S9(4)   VALUE +2659.
   987     12  ER-2660                     PIC S9(4)   VALUE +2660.
   988     12  ER-2661                     PIC S9(4)   VALUE +2661.
   989     12  ER-2662                     PIC S9(4)   VALUE +2662.
   990     12  ER-2663                     PIC S9(4)   VALUE +2663.
   991     12  ER-2664                     PIC S9(4)   VALUE +2664.
   992     12  ER-2665                     PIC S9(4)   VALUE +2665.
   993     12  ER-2666                     PIC S9(4)   VALUE +2666.
   994     12  ER-2667                     PIC S9(4)   VALUE +2667.
   995     12  ER-2668                     PIC S9(4)   VALUE +2668.
   996     12  ER-2669                     PIC S9(4)   VALUE +2669.
   997     12  ER-2670                     PIC S9(4)   VALUE +2670.
   998     12  ER-2671                     PIC S9(4)   VALUE +2671.
   999     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1000     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1001     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1002     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1003     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1004     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1005     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1006     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1007     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1008     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1009     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1010     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1011     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1012     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1013     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1014     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1015     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1016     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1017     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1018     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1019     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1020     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1021     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1022     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1023     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1024     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1025     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1026     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1027     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1028     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1029     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1030     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1031     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1032     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1033     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1034     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1035     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1036     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1037     12  ER-2719                     PIC S9(4)   VALUE +2719.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  20
* EL050.cbl
  1038     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1039     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1040     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1041     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1042     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1043     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1044     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1045     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1046     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1047     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1048     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1049     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1050     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1051     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1052     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1053     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1054     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1055     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1056     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1057     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1058     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1059     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1060     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1061     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1062     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1063     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1064     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1065     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1066     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1067     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1068     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1069     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1070     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1071     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1072     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1073     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1074     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1075     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1076     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1077     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1078     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1079     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1080     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1081     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1082     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1083     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1084     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1085     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1086     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1087     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1088     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1089     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1090     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1091     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1092     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1093     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1094     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1095     12  ER-2778                     PIC S9(4)   VALUE +2778.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  21
* EL050.cbl
  1096     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1097     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1098     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1099     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1100     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1101     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1102     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1103     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1104     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1105     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1106     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1107     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1108     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1109     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1110     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1111     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1112     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1113     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1114     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1115     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1116     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1117     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1118     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1119     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1120     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1121     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1122     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1123     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1124     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1125     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1126     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1127     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1128     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1129     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1130     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1131     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1132     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1133     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1134     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1135     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1136     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1137     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1138     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1139     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1140     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1141     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1142     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1143     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1144     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1145     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1146     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1147     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1148     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1149     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1150     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1151     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1152     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1153     12  ER-7820                     PIC S9(4)   VALUE +7820.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  22
* EL050.cbl
  1154     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1155     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1156     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1157     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1158     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1159     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1160     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1161     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1162     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1163     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1164     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1165     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1166     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1167     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1168     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1169     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1170     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1171     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1172     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1173     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1174     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1175     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1176     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1177     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1178     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1179     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1180     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1181     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1182     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1183     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1184     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1185     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1186     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1187     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1188     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1189     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1190     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1191     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1192     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1193     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1194     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1195     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1196     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1197     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1198     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1199     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1200     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1201     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1202     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1203     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1204     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1205     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1206     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1207     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1208     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1209     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1210     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1211     12  ER-8300                     PIC S9(4)   VALUE +8300.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  23
* EL050.cbl
  1212     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1213     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1214     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1215     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1216     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1217     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1218     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1219     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1220     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1221     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1222     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1223     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1224     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1225     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1226     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1227     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1228     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1229******************************************************************
  1230***************   END OF ELC50WS     ****************************
  1231******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  24
* EL050.cbl
  1234 01  WORKING-STORAGE-WORK-AREAS.
  1235     12  WS-RESPONSE             PIC S9(8)  COMP.
  1236         88  WS-RESP-NORMAL           VALUE +00.
  1237         88  WS-RESP-ERROR            VALUE +01.
  1238         88  WS-RESP-NOTFND           VALUE +13.
  1239         88  WS-RESP-DUPREC           VALUE +14.
  1240         88  WS-RESP-ENDFILE          VALUE +20.
  1241     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1242     12  WORK-AREAS.
  1243         16  WK-CONV-GREG.
  1244             24  WCG-CENT             PIC XX.
  1245             24  WCG-REST             PIC X(4).
  1246         16  WORK-GREGORIAN-DATE.
  1247             24  WK-GREG-CENT         PIC XX.
  1248             24  WK-GREG-DATE-YYMMDD.
  1249                 28  WK-GREG-YYMM     PIC X(4).
  1250                 28  WK-GREG-DD       PIC XX.
  1251
  1252         16  WORK-SELECT-DATE.
  1253             24  WK-SELECT-CENT            PIC XX.
  1254             24  WK-SELECT-DATE-YYMMDD.
  1255                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1256                 28  FILLER                PIC XX.
  1257
  1258         16  WK-FORM-NO.
  1259             24  WK-FORM-BANK-ID       PIC X(5).
  1260             24  WK-FORM-UNDRWRTR      PIC X(1).
  1261             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1262
  1263         16  WK-MEMBER-NO.
  1264             24  WK-MEMBER-1-6        PIC X(6).
  1265             24  WK-MEMBER-7-12       PIC X(6).
  1266
  1267         16  WK-FULL-CERT-NO.
  1268             24  WK-CERT-POS-1-2      PIC X(2).
  1269             24  WK-CERT-POS-3        PIC X(1).
  1270             24  WK-CERT-POS-4        PIC X(1).
  1271             24  WK-CERT-POS-5-6      PIC X(2).
  1272             24  WK-CERT-POS-7        PIC X(1).
  1273             24  WK-CERT-POS-8-11     PIC X(4).
  1274
  1275         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1276             88  VALID-RATE-CODE        VALUE 'Y'.
  1277             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1278
  1279         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1280         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1281         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1282         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1283         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1284         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1285         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1286         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1287         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1288         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1289
  1290* DLO001
  1291 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  25
* EL050.cbl
  1292     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1293     12  DMPF-RETURN-CODE          PIC XX.
  1294         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1295         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1296         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1297         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1298         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1299         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1300
  1301* DLO002
  1302 01  WS-DLO-INTERNAL-POLICY-FORM.
  1303     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1304     12  DIPF-RETURN-CODE          PIC XX.
  1305         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1306         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1307         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1308         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1309         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1310         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1311
  1312* DLO003
  1313 01  WS-DLO-VALID-BANK-ID.
  1314     12  DVBI-BANK-ID              PIC X(5).
  1315     12  DVBI-BANK-ID-TYPE         PIC X.
  1316         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1317         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1318         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1319         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1320         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1321     12  DVBI-RETURN-CODE          PIC XX.
  1322         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1323         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1324         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1325         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1326         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1327         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1328         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1329         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1330         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1331
  1332* DLO007
  1333 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1334     12  DCUA-RES-STATE            PIC XX.
  1335     12  DCUA-BEN-TYPE             PIC XX.
  1336     12  DCUA-SYS-IDENT            PIC X.
  1337         88  DCUA-CLAIM                        VALUE 'C'.
  1338         88  DCUA-PREMIUM                      VALUE 'P'.
  1339     12  DCUA-COVERAGE-RULE        PIC X.
  1340     12  DCUA-CLIENT-ID            PIC X(10).
  1341     12  DCUA-EFF-DATE             PIC X(8).
  1342     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1343     12  DCUA-RETURN-CODE          PIC XX.
  1344         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345     12  DCUA-CERT-NUMBER          PIC X(11).
  1346     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1347     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1348
  1349* DLO011
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  26
* EL050.cbl
  1350 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1351     12  DPRB-RATE-CODE            PIC X(4).
  1352     12  DPRB-COVERAGE-CATEG       PIC X.
  1353     12  DPRB-RETURN-CODE          PIC XX.
  1354         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1355         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1356         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1357         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1358         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1359         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1360         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1361         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1362         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1363     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1364     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1365     12  DPRB-BEN-TYPE             PIC XX.
  1366
  1367* DLO017
  1368 01  WS-DLO-VALID-RATE-CODE.
  1369     12  DVRC-RATE-CODE            PIC X(4).
  1370     12  DVRC-RETURN-CODE          PIC XX.
  1371         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1373         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1374         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1375         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1376         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1377
  1378* DLO019
  1379 01  WS-DLO-ORIG-COV-CAT.
  1380     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1381     12  DOCC-RETURN-CODE          PIC XX.
  1382     12  DOCC-ORIG-COV-CAT         PIC X.
  1383     12  DOCC-UNDERWITER           PIC XX.
  1384     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1385     12  DOCC-FILLER               PIC X(6).
  1386
  1387* DLO021
  1388 01  WS-DLO-VALID-LOAN-OFFICER.
  1389     12  DVLO-LOAN-OFFICER.
  1390         16  DVLO-BILL-TYPE        PIC X.
  1391         16  DVLO-BILL-SOURCE      PIC X.
  1392         16  DVLO-BATCH-TYPE       PIC X.
  1393     12  DVLO-RETURN-CODE          PIC XX.
  1394         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1395         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1396         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1397         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1398         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1399         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1400
  1401* DLO022
  1402 01  WS-DLO-VALID-STATE-CODE.
  1403     12  DVSC-STATE-CODE           PIC XX.
  1404     12  DVSC-RETURN-CODE          PIC XX.
  1405         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1406
  1407* DLO023
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  27
* EL050.cbl
  1408 01  WS-DLO-VALID-CODE-VALUES.
  1409     12  DVCV-SYSTEM-ID            PIC XX.
  1410         88  DVCV-CLAIMS                       VALUE 'CL'.
  1411         88  DVCV-CREDIT                       VALUE 'CR'.
  1412     12  DVCV-RECORD-TYPE          PIC XX.
  1413         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1414         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1415         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1416         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1417         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1418         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1419         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1420         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1421     12  DVCV-RECORD-KEY           PIC X(6).
  1422     12  DVCV-RETURN-CODE          PIC XX.
  1423         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1424         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1425         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1426         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1427         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1428         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1429         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1430     12  DVCV-CODE-DESC            PIC X(60).
  1431     12  DVCV-GEN-DESC-1           PIC X(20).
  1432     12  DVCV-GEN-DESC-2           PIC X(20).
  1433     12  DVCV-GEN-DESC-3           PIC X(20).
  1434
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  28
* EL050.cbl
  1436*    COPY ERCBXRF.
  1437******************************************************************
  1438*                                                                *
  1439*                                                                *
  1440*                            ERCBXRF                             *
  1441*                                                                *
  1442*   ONLINE CREDIT SYSTEM                                         *
  1443*                                                                *
  1444*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1445*                                                                *
  1446*   FILE TYPE = VSAM,KSDS                                        *
  1447*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1448*                                                                *
  1449*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1450*       ALTERNATE PATH = NONE                                    *
  1451*                                                                *
  1452*   LOG = NO                                                     *
  1453*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1454*                                                                *
  1455******************************************************************
  1456
  1457 01  BANK-CROSS-REFERENCE.
  1458     12  BK-RECORD-ID                PIC XX.
  1459         88  VALID-BK-ID             VALUE 'BK'.
  1460
  1461     12  BK-CONTROL-PRIMARY.
  1462         16  BK-COMPANY-CD           PIC X.
  1463         16  BK-CARRIER              PIC X.
  1464         16  BK-GROUPING             PIC X(6).
  1465         16  BK-BANK-NO              PIC X(10).
  1466
  1467     12  BK-MAINT-INFORMATION.
  1468         16  BK-LAST-MAINT-DT        PIC XX.
  1469         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1470         16  BK-LAST-MAINT-USER      PIC X(4).
  1471         16  FILLER                  PIC X(9).
  1472
  1473     12  FILLER                      PIC X(37).
  1474
  1475     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1476
  1477     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1478                            DEPENDING ON BK-BANK-POINTER-CNT.
  1479         16  BK-AM-ACCOUNT           PIC X(10).
  1480         16  BK-AM-EXP-DT            PIC XX.
  1481         16  BK-AM-EFF-DT            PIC XX.
  1482         16  BK-AM-STATE             PIC XX.
  1483         16  FILLER                  PIC X(20).
  1484
  1485******************************************************************
  1486
  1487*    COPY ERCCOMP.
  1488******************************************************************
  1489*                                                                *
  1490*                                                                *
  1491*                            ERCCOMP                             *
  1492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1493*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  29
* EL050.cbl
  1494*                                                                *
  1495*   ONLINE CREDIT SYSTEM                                         *
  1496*                                                                *
  1497*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1498*                                                                *
  1499*   FILE TYPE = VSAM,KSDS                                        *
  1500*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1501*                                                                *
  1502*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1503*       ALTERNATE PATH = NONE                                    *
  1504*                                                                *
  1505*   LOG = NO                                                     *
  1506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1507*                                                                *
  1508******************************************************************
  1509*                   C H A N G E   L O G
  1510*
  1511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1512*-----------------------------------------------------------------
  1513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1514* EFFECTIVE    NUMBER
  1515*-----------------------------------------------------------------
  1516* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1517* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1518* 092205    2005050300006  PEMA  ADD LEASE FEE
  1519* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1520* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1521* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1522* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1523* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1524* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1525******************************************************************
  1526
  1527 01  COMPENSATION-MASTER.
  1528     12  CO-RECORD-ID                          PIC XX.
  1529         88  VALID-CO-ID                          VALUE 'CO'.
  1530
  1531     12  CO-CONTROL-PRIMARY.
  1532         16  CO-COMPANY-CD                     PIC X.
  1533         16  CO-CONTROL.
  1534             20  CO-CTL-1.
  1535                 24  CO-CARR-GROUP.
  1536                     28  CO-CARRIER            PIC X.
  1537                     28  CO-GROUPING.
  1538                         32  CO-GROUP-PREFIX   PIC XXX.
  1539                         32  CO-GROUP-PRIME    PIC XXX.
  1540                 24  CO-RESP-NO.
  1541                     28  CO-RESP-PREFIX        PIC X(4).
  1542                     28  CO-RESP-PRIME         PIC X(6).
  1543             20  CO-CTL-2.
  1544                 24  CO-ACCOUNT.
  1545                     28  CO-ACCT-PREFIX        PIC X(4).
  1546                     28  CO-ACCT-PRIME         PIC X(6).
  1547         16  CO-TYPE                           PIC X.
  1548             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1549             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1550             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1551
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  30
* EL050.cbl
  1552     12  CO-MAINT-INFORMATION.
  1553         16  CO-LAST-MAINT-DT                  PIC XX.
  1554         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1555         16  CO-LAST-MAINT-USER                PIC X(4).
  1556     12  FILLER                                PIC XX.
  1557     12  CO-STMT-TYPE                          PIC XXX.
  1558     12  CO-COMP-TYPE                          PIC X.
  1559         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1560     12  CO-STMT-OWNER                         PIC X(4).
  1561     12  CO-BALANCE-CONTROL                    PIC X.
  1562         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1563         88  CO-NO-BALANCE                        VALUE 'N'.
  1564
  1565     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1566         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1567         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1568         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1569
  1570     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1571         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1572         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1573
  1574     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1575     12  CO-GA-DIRECT-DEP                      PIC X.
  1576     12  CO-FUTURE-SPACE                       PIC X.
  1577         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1578
  1579     12  CO-ACCT-NAME                          PIC X(30).
  1580     12  CO-MAIL-NAME                          PIC X(30).
  1581     12  CO-ADDR-1                             PIC X(30).
  1582     12  CO-ADDR-2                             PIC X(30).
  1583     12  CO-ADDR-3.
  1584         16  CO-ADDR-CITY                      PIC X(27).
  1585         16  CO-ADDR-STATE                     PIC XX.
  1586     12  CO-CSO-1099                           PIC X.
  1587     12  CO-ZIP.
  1588         16  CO-ZIP-PRIME.
  1589             20  CO-ZIP-PRI-1ST                PIC X.
  1590                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1591             20  FILLER                        PIC X(4).
  1592         16  CO-ZIP-PLUS4                      PIC X(4).
  1593     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1594         16  CO-CAN-POSTAL-1                   PIC XXX.
  1595         16  CO-CAN-POSTAL-2                   PIC XXX.
  1596         16  FILLER                            PIC XXX.
  1597     12  CO-SOC-SEC                            PIC X(13).
  1598     12  CO-TELEPHONE.
  1599         16  CO-AREA-CODE                      PIC XXX.
  1600         16  CO-PREFIX                         PIC XXX.
  1601         16  CO-PHONE                          PIC X(4).
  1602
  1603     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1604
  1605     12  CO-AR-BAL-LEVEL                       PIC X.
  1606         88  CO-AR-REF-LVL                        VALUE '1'.
  1607         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1608         88  CO-AR-BILL-LVL                       VALUE '2'.
  1609         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  31
* EL050.cbl
  1610         88  CO-AR-FR-LVL                         VALUE '4'.
  1611
  1612     12  CO-AR-NORMAL-PRINT                    PIC X.
  1613         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1614         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1615
  1616     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1617
  1618     12  CO-AR-REPORTING                       PIC X.
  1619         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1620         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1621
  1622     12  CO-AR-PULL-CHECK                      PIC X.
  1623         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1624         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1625
  1626     12  CO-AR-BALANCE-PRINT                   PIC X.
  1627         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1628
  1629     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1630         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1631         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1632         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1633
  1634     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1635
  1636     12  CO-USER-CODE                          PIC X.
  1637     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1638
  1639******************************************************************
  1640*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1641*    THE LAST MONTH END RUN.
  1642******************************************************************
  1643
  1644     12  CO-LAST-ACTIVITY-DATE.
  1645         16  CO-ACT-YEAR                       PIC 99.
  1646         16  CO-ACT-MONTH                      PIC 99.
  1647         16  CO-ACT-DAY                        PIC 99.
  1648
  1649     12  CO-LAST-STMT-DT.
  1650         16  CO-LAST-STMT-YEAR                 PIC 99.
  1651         16  CO-LAST-STMT-MONTH                PIC 99.
  1652         16  CO-LAST-STMT-DAY                  PIC 99.
  1653
  1654     12  CO-MO-END-TOTALS.
  1655         16  CO-MONTHLY-TOTALS.
  1656             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1657             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1658             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1659             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1660             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-AGING-TOTALS.
  1663             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1664             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1665             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1666             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1667
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  32
* EL050.cbl
  1668         16  CO-YTD-TOTALS.
  1669             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1670             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1671
  1672         16  CO-OVER-UNDER-TOTALS.
  1673             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1674             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1675
  1676     12  CO-MISCELLANEOUS-TOTALS.
  1677         16  CO-FICA-TOTALS.
  1678             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1679             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1680
  1681         16  CO-CLAIM-TOTALS.
  1682             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1683             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1684
  1685******************************************************************
  1686*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1687*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1688******************************************************************
  1689
  1690     12  CO-CURRENT-TOTALS.
  1691         16  CO-CURRENT-LAST-STMT-DT.
  1692             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1693             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1694             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1695
  1696         16  CO-CURRENT-MONTHLY-TOTALS.
  1697             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1698             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1699             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1700             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1702
  1703         16  CO-CURRENT-AGING-TOTALS.
  1704             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1705             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1706             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1708
  1709         16  CO-CURRENT-YTD-TOTALS.
  1710             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1712
  1713     12  CO-PAID-COMM-TOTALS.
  1714         16  CO-YTD-PAID-COMMS.
  1715             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1716             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1717
  1718     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1719         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1720         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1721
  1722     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1723         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1724         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1725         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  33
* EL050.cbl
  1726         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1727         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1728         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1729         88  CO-FINAL-LETTER                  VALUE 'F'.
  1730         88  CO-RECONCILING                   VALUE 'R'.
  1731         88  CO-PHONE-CALL                    VALUE 'P'.
  1732         88  CO-LEGAL                         VALUE 'L'.
  1733         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1734         88  CO-WRITE-OFF                     VALUE 'W'.
  1735         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1736
  1737     12  CO-CSR-CODE                       PIC X(4).
  1738
  1739     12  CO-GA-STATUS-INFO.
  1740         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1741         16  CO-GA-TERMINATION-DT          PIC XX.
  1742         16  CO-GA-STATUS-CODE             PIC X.
  1743             88  CO-GA-ACTIVE                 VALUE 'A'.
  1744             88  CO-GA-INACTIVE               VALUE 'I'.
  1745             88  CO-GA-PENDING                VALUE 'P'.
  1746         16  CO-GA-COMMENTS.
  1747             20  CO-GA-COMMENT-1           PIC X(40).
  1748             20  CO-GA-COMMENT-2           PIC X(40).
  1749             20  CO-GA-COMMENT-3           PIC X(40).
  1750             20  CO-GA-COMMENT-4           PIC X(40).
  1751
  1752     12  CO-RPTCD2                         PIC X(10).
  1753     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1754         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1755         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1756
  1757     12  CO-TYPE-AGENT                     PIC X(01).
  1758         88  CO-CORPORATION                   VALUE 'C'.
  1759         88  CO-PARTNERSHIP                   VALUE 'P'.
  1760         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1761         88  CO-TRUST                         VALUE 'T'.
  1762         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1763
  1764     12  CO-FAXNO.
  1765         16  CO-FAX-AREA-CODE                  PIC XXX.
  1766         16  CO-FAX-PREFIX                     PIC XXX.
  1767         16  CO-FAX-PHONE                      PIC X(4).
  1768
  1769     12  CO-BANK-INFORMATION.
  1770         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1771         16  CO-BANK-TRANSIT-NON REDEFINES
  1772             CO-BANK-TRANSIT-NO                PIC 9(8).
  1773
  1774         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1775     12  CO-MISC-DEDUCT-INFO REDEFINES
  1776                  CO-BANK-INFORMATION.
  1777         16  CO-MD-GL-ACCT                     PIC X(10).
  1778         16  CO-MD-DIV                         PIC XX.
  1779         16  CO-MD-CENTER                      PIC X(4).
  1780         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1781         16  CO-CREATE-AP-CHECK                PIC X.
  1782         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1783         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  34
* EL050.cbl
  1784     12  CO-ACH-STATUS                         PIC X.
  1785         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1786         88  CO-ACH-PENDING                        VALUE 'P'.
  1787
  1788     12  CO-BILL-SW                            PIC X.
  1789     12  CO-CONTROL-NAME                       PIC X(30).
  1790     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1791     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1792     12  CO-CLP-STATE                          PIC XX.
  1793     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1794     12  CO-SPP-REFUND-EDIT                    PIC X.
  1795
  1796******************************************************************
  1797
  1798*    COPY ERCAGTC.
  1799******************************************************************
  1800*                                                                *
  1801*                                                                *
  1802*                            ERCAGTC                             *
  1803*                            VMOD=2.001                          *
  1804*                                                                *
  1805*   ONLINE CREDIT SYSTEM                                         *
  1806*                                                                *
  1807*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1808*                                                                *
  1809*   FILE TYPE = VSAM,KSDS                                        *
  1810*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1811*                                                                *
  1812*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1813*       ALTERNATE PATH = NONE                                    *
  1814*                                                                *
  1815*   LOG = NO                                                     *
  1816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1817*                                                                *
  1818******************************************************************
  1819*                   C H A N G E   L O G
  1820*
  1821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1822*-----------------------------------------------------------------
  1823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1824* EFFECTIVE    NUMBER
  1825*-----------------------------------------------------------------
  1826* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1827* 111004                         NEW FILE AND COPYBOOK
  1828* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1829******************************************************************
  1830 01  AGENT-COMMISSIONS.
  1831     12  AG-RECORD-ID                          PIC XX.
  1832         88  VALID-CO-ID                          VALUE 'AG'.
  1833     12  AG-CONTROL-PRIMARY.
  1834         16  AG-COMPANY-CD                     PIC X.
  1835         16  AG-CONTROL.
  1836             20  AG-CTL-1.
  1837                 24  AG-CARR-GROUP.
  1838                     28  AG-CARRIER            PIC X.
  1839                     28  AG-GROUPING           PIC X(6).
  1840                 24  AG-BANK                   PIC X(10).
  1841             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  35
* EL050.cbl
  1842                 24  AG-EXP-DT                 PIC XX.
  1843         16  AG-TYPE                           PIC X.
  1844             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1845             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1846     12  AG-MAINT-INFORMATION.
  1847         16  AG-LAST-MAINT-DT                  PIC XX.
  1848         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1849         16  AG-LAST-MAINT-USER                PIC X(4).
  1850         16  FILLER                            PIC X(10).
  1851     12  AG-EFF-DT                             PIC XX.
  1852     12  AG-COMM-STRUCTURE.
  1853         16  AG-AGT-COMMS OCCURS 10.
  1854             20  AG-AGT                PIC X(10).
  1855             20  AG-COM-TYP            PIC X.
  1856             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1857             20  AG-RECALC-LV-INDIC    PIC X.
  1858             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1859             20  AG-LRCALC-LV-INDIC    PIC X.
  1860             20  FILLER                PIC X(05).
  1861     12  FILLER                  PIC X(145).
  1862******************************************************************
  1863*    COPY ERCRESS.
  1864******************************************************************
  1865*                                                                *
  1866*                            ERCRESS                             *
  1867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1868*                            VMOD=2.002                          *
  1869*                                                                *
  1870*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1871*                                                                *
  1872*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1873*   VSAM RESIDENT STATE TAX MASTER                              *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1879*                                                                *
  1880*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1881*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886*                                                                *
  1887******************************************************************
  1888
  1889 01  RESIDENT-STATE-TAX-MASTER.
  1890
  1891     10  ERRESS-PRIMARY-KEY.
  1892         15  RES-COMPANY-CD        PIC X.
  1893         15  RES-RESIDENT-STATE    PIC XX.
  1894         15  RES-COVERAGE-CATEGORY PIC X.
  1895         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1896*                                      YYYYMMDD
  1897*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1898
  1899     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  36
* EL050.cbl
  1900
  1901         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1902         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1903         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1904         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1905
  1906     10 RES-RECALC-SW              PIC   X.
  1907         88 RECALC                VALUE 'Y'.
  1908         88 NO-RECALC             VALUE 'N'.
  1909     10  RES-MAINT-BY              PIC X(4).
  1910     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1911     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1912*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  37
* EL050.cbl
  1914*    COPY ERCRESC.
  1915******************************************************************
  1916*                                                                *
  1917*                            ERCRESC                             *
  1918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1919*                            VMOD=2.003                          *
  1920*                                                                *
  1921*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1922*                                                                *
  1923*   FILE TYPE = VSAM,KSDS                                        *
  1924*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1925*                                                                *
  1926*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1927*       ALTERNATE PATH1 = NONE                                   *
  1928*                                                                *
  1929*   LOG = NO                                                     *
  1930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1931*                                                                *
  1932******************************************************************
  1933
  1934 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1935
  1936     10  ERRESC-RECORD-KEY.
  1937         15  RESC-COMPANY-CD           PIC   X.
  1938         15  RESC-CARRIER              PIC   X.
  1939         15  RESC-GROUP                PIC   X(6).
  1940         15  RESC-STATE                PIC   XX.
  1941         15  RESC-ACCOUNT              PIC   X(10).
  1942         15  RESC-AGENT                PIC   X(10).
  1943         15  RESC-RESIDENT-STATE       PIC   XX.
  1944         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1945*                                           YYYYMMDD
  1946     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1947
  1948     10  RESC-COMM-RECORD-DATA.
  1949         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1950             20 RESC-COVERAGE-CAT      PIC    X.
  1951             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1952             20 RESC-COMMISSION-TAB REDEFINES
  1953                RESC-COMMISSION-PER    PIC  XXX.
  1954
  1955     10  RESC-MAINT-BY                 PIC X(4).
  1956     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1957     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1958*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  38
* EL050.cbl
  1960*    COPY ERCPLAN.
  1961******************************************************************
  1962*                                                                *
  1963*                                                                *
  1964*                            ERCPLAN                             *
  1965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1966*                            VMOD=2.003                          *
  1967*                                                                *
  1968*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1969*                                                                *
  1970*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1971*   PLAN MASTER                                                  *
  1972*                                                                *
  1973*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1974*                                                                *
  1975*   FILE TYPE = VSAM,KSDS                                        *
  1976*   RECORD SIZE = 420   RECFORM = FIX                            *
  1977*                                                                *
  1978*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1979*       ALTERNATE PATH1 = N/A                                    *
  1980*                                                                *
  1981*   LOG = NO                                                     *
  1982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1983*                                                                *
  1984*                                                                *
  1985******************************************************************
  1986
  1987 01  PLAN-MASTER.
  1988     12  PL-RECORD-ID                      PIC XX.
  1989         88  VALID-PL-ID                      VALUE 'PL'.
  1990
  1991     12  PL-CONTROL-PRIMARY.
  1992         16  PL-COMPANY-CD                 PIC X.
  1993         16  PL-MSTR-CNTRL.
  1994             20  PL-CONTROL-A.
  1995                 24  PL-CARRIER            PIC X.
  1996                 24  PL-GROUPING           PIC X(6).
  1997                 24  PL-STATE              PIC XX.
  1998                 24  PL-ACCOUNT            PIC X(10).
  1999             20  PL-BENEFIT-TYPE           PIC X.
  2000             20  PL-BENEFIT-CODE           PIC XX.
  2001             20  PL-REVISION-NO            PIC X(3).
  2002
  2003     12  PL-CONTROL-BY-VAR-GRP.
  2004         16  PL-COMPANY-CD-A1              PIC X.
  2005         16  PL-VG-CARRIER                 PIC X.
  2006         16  PL-VG-GROUPING                PIC X(6).
  2007         16  PL-VG-STATE                   PIC XX.
  2008         16  PL-VG-ACCOUNT                 PIC X(10).
  2009         16  PL-BENEFIT-TYPE-A1            PIC X.
  2010         16  PL-BENEFIT-CODE-A1            PIC XX.
  2011         16  PL-REVISION-NO-A1             PIC 999.
  2012
  2013     12  PL-MAINT-INFORMATION.
  2014         16  PL-LAST-MAINT-DT              PIC XX.
  2015         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2016         16  PL-LAST-MAINT-USER            PIC X(4).
  2017         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  39
* EL050.cbl
  2018
  2019     12  PL-LIABILITY-LIMITS.
  2020         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2021         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2022             20  PL-LM-AGE                 PIC S99        COMP-3.
  2023             20  PL-LM-DUR                 PIC S999       COMP-3.
  2024             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2025             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2026
  2027     12  FILLER                            PIC X(30).
  2028
  2029     12  PL-GL-ACCOUNT-NOS.
  2030         16  PL-PREMIUM-GL                 PIC X(8).
  2031         16  PL-COMM-GL                    PIC X(8).
  2032         16  PL-CLAIM-GL                   PIC X(8).
  2033     12  FILLER                            PIC X(24).
  2034     12  PL-TOLERANCES.
  2035         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2036         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2037         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2038         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2039         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2040         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2041     12  PL-OVER-SHORT.
  2042         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2043         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2044     12  FILLER                            PIC X(24).
  2045     12  PLAN-MISC.
  2046         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2047         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2048         16  PL-IG                         PIC X.
  2049         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2050         16  PL-POLICY-FORM                PIC X(12).
  2051         16  PL-EDIT-FOR-FORM              PIC X(01).
  2052         16  PL-DEV-CODE                   PIC XXX.
  2053         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2054         16  PL-CALC-METHOD                PIC X.
  2055         16  PL-BENEFIT-GROUP              PIC X(05).
  2056         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2057
  2058         16  FILLER                        PIC X(99).
  2059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  40
* EL050.cbl
  2061*    COPY ELCCERT.
  2062******************************************************************
  2063*                                                                *
  2064*                            ELCCERT.                            *
  2065*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2066*                            VMOD=2.013                          *
  2067*                                                                *
  2068*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2069*                                                                *
  2070*   FILE TYPE = VSAM,KSDS                                        *
  2071*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2072*                                                                *
  2073*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2074*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2075*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2076*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2077*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2078*                                                                *
  2079*   LOG = YES                                                    *
  2080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2081******************************************************************
  2082*                   C H A N G E   L O G
  2083*
  2084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2085*-----------------------------------------------------------------
  2086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2087* EFFECTIVE    NUMBER
  2088*-----------------------------------------------------------------
  2089* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2090* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2091* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2092* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2093* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2094* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2095* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2096* 032612  CR2011110200001  PEMA  AHL CHANGES
  2097******************************************************************
  2098
  2099 01  CERTIFICATE-MASTER.
  2100     12  CM-RECORD-ID                      PIC XX.
  2101         88  VALID-CM-ID                      VALUE 'CM'.
  2102
  2103     12  CM-CONTROL-PRIMARY.
  2104         16  CM-COMPANY-CD                 PIC X.
  2105         16  CM-CARRIER                    PIC X.
  2106         16  CM-GROUPING.
  2107             20  CM-GROUPING-PREFIX        PIC X(3).
  2108             20  CM-GROUPING-PRIME         PIC X(3).
  2109         16  CM-STATE                      PIC XX.
  2110         16  CM-ACCOUNT.
  2111             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2112             20  CM-ACCOUNT-PRIME          PIC X(6).
  2113         16  CM-CERT-EFF-DT                PIC XX.
  2114         16  CM-CERT-NO.
  2115             20  CM-CERT-PRIME             PIC X(10).
  2116             20  CM-CERT-SFX               PIC X.
  2117
  2118     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  41
* EL050.cbl
  2119         16  CM-COMPANY-CD-A1              PIC X.
  2120         16  CM-INSURED-LAST-NAME          PIC X(15).
  2121         16  CM-INSURED-INITIALS.
  2122             20  CM-INSURED-INITIAL1       PIC X.
  2123             20  CM-INSURED-INITIAL2       PIC X.
  2124
  2125     12  CM-CONTROL-BY-SSN.
  2126         16  CM-COMPANY-CD-A2              PIC X.
  2127         16  CM-SOC-SEC-NO.
  2128             20  CM-SSN-STATE              PIC XX.
  2129             20  CM-SSN-ACCOUNT            PIC X(6).
  2130             20  CM-SSN-LN3.
  2131                 25  CM-INSURED-INITIALS-A2.
  2132                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2133                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2134                 25 CM-PART-LAST-NAME-A2         PIC X.
  2135
  2136     12  CM-CONTROL-BY-CERT-NO.
  2137         16  CM-COMPANY-CD-A4              PIC X.
  2138         16  CM-CERT-NO-A4                 PIC X(11).
  2139
  2140     12  CM-CONTROL-BY-MEMB.
  2141         16  CM-COMPANY-CD-A5              PIC X.
  2142         16  CM-MEMBER-NO.
  2143             20  CM-MEMB-STATE             PIC XX.
  2144             20  CM-MEMB-ACCOUNT           PIC X(6).
  2145             20  CM-MEMB-LN4.
  2146                 25  CM-INSURED-INITIALS-A5.
  2147                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2148                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2149                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2150
  2151     12  CM-INSURED-PROFILE-DATA.
  2152         16  CM-INSURED-FIRST-NAME.
  2153             20  CM-INSURED-1ST-INIT       PIC X.
  2154             20  FILLER                    PIC X(9).
  2155         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2156         16  CM-INSURED-SEX                PIC X.
  2157             88  CM-SEX-MALE                  VALUE 'M'.
  2158             88  CM-SEX-FEMAL                 VALUE 'F'.
  2159         16  CM-INSURED-JOINT-AGE          PIC 99.
  2160         16  CM-JOINT-INSURED-NAME.
  2161             20  CM-JT-LAST-NAME           PIC X(15).
  2162             20  CM-JT-FIRST-NAME.
  2163                 24  CM-JT-1ST-INIT        PIC X.
  2164                 24  FILLER                PIC X(9).
  2165             20  CM-JT-INITIAL             PIC X.
  2166
  2167     12  CM-LIFE-DATA.
  2168         16  CM-LF-BENEFIT-CD              PIC XX.
  2169         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2170         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2171         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2172         16  CM-LF-DEV-CODE                PIC XXX.
  2173         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2174         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2175         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2176         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  42
* EL050.cbl
  2177         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2178         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2179         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2180         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2181         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2182         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2183         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2184         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2185         16  FILLER                        PIC XX.
  2186
  2187     12  CM-AH-DATA.
  2188         16  CM-AH-BENEFIT-CD              PIC XX.
  2189         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2190         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2191         16  CM-AH-DEV-CODE                PIC XXX.
  2192         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2193         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2194         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2195         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2196         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2197         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2198         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2199         16  CM-AH-PAID-THRU-DT            PIC XX.
  2200             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2201         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2202         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2203         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2204         16  FILLER                        PIC X.
  2205
  2206     12  CM-LOAN-INFORMATION.
  2207         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2208         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2209                                           PIC S9(5)V99  COMP-3.
  2210         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2211         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2212         16  CM-PAY-FREQUENCY              PIC S99.
  2213         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2214         16  CM-RATE-CLASS                 PIC XX.
  2215         16  CM-BENEFICIARY                PIC X(25).
  2216         16  CM-POLICY-FORM-NO             PIC X(12).
  2217         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2218         16  CM-LAST-ADD-ON-DT             PIC XX.
  2219         16  CM-DEDUCTIBLE-AMOUNTS.
  2220             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2221             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2222         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2223             20  CM-RESIDENT-STATE         PIC XX.
  2224             20  CM-RATE-CODE              PIC X(4).
  2225             20  FILLER                    PIC XX.
  2226         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2227             20  CM-LOAN-OFFICER           PIC X(5).
  2228             20  FILLER                    PIC XXX.
  2229         16  CM-CSR-CODE                   PIC XXX.
  2230         16  CM-UNDERWRITING-CODE          PIC X.
  2231             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2232         16  CM-POST-CARD-IND              PIC X.
  2233         16  CM-NH-INTERFACE-SW            PIC X.
  2234         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  43
* EL050.cbl
  2235             88  CM-SING-PRM                  VALUE '1'.
  2236             88  CM-O-B-COVERAGE              VALUE '2'.
  2237             88  CM-OPEN-END                  VALUE '3'.
  2238         16  CM-IND-GRP-TYPE               PIC X.
  2239             88  CM-INDIVIDUAL                VALUE 'I'.
  2240             88  CM-GROUP                     VALUE 'G'.
  2241         16  CM-SKIP-CODE                  PIC X.
  2242             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2243             88  SKIP-JULY                    VALUE '1'.
  2244             88  SKIP-AUGUST                  VALUE '2'.
  2245             88  SKIP-SEPTEMBER               VALUE '3'.
  2246             88  SKIP-JULY-AUG                VALUE '4'.
  2247             88  SKIP-AUG-SEPT                VALUE '5'.
  2248             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2249             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2250             88  SKIP-JUNE                    VALUE '8'.
  2251             88  SKIP-JUNE-JULY               VALUE '9'.
  2252             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2253             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2254         16  CM-PAYMENT-MODE               PIC X.
  2255             88  PAY-MONTHLY                  VALUE SPACE.
  2256             88  PAY-WEEKLY                   VALUE '1'.
  2257             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2258             88  PAY-BI-WEEKLY                VALUE '3'.
  2259             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2260         16  CM-LOAN-NUMBER                PIC X(8).
  2261         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2262         16  CM-OLD-LOF                    PIC XXX.
  2263*        16  CM-LOAN-OFFICER               PIC XXX.
  2264         16  CM-REIN-TABLE                 PIC XXX.
  2265         16  CM-SPECIAL-REIN-CODE          PIC X.
  2266         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2267         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2268         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2269
  2270     12  CM-STATUS-DATA.
  2271         16  CM-ENTRY-STATUS               PIC X.
  2272         16  CM-ENTRY-DT                   PIC XX.
  2273
  2274         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2275         16  CM-LF-CANCEL-DT               PIC XX.
  2276         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2277
  2278         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2279         16  CM-LF-DEATH-DT                PIC XX.
  2280         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2281
  2282         16  CM-LF-CURRENT-STATUS          PIC X.
  2283             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2284                                                'M' '4' '5' '9'.
  2285             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2286             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2287             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2288             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2289             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2290             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2291             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2292             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  44
* EL050.cbl
  2293             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2294             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2295             88  CM-LF-DECLINED               VALUE 'D'.
  2296             88  CM-LF-VOIDED                 VALUE 'V'.
  2297
  2298         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2299         16  CM-AH-CANCEL-DT               PIC XX.
  2300         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2301
  2302         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2303         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2304         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2305
  2306         16  CM-AH-CURRENT-STATUS          PIC X.
  2307             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2308                                                'M' '4' '5' '9'.
  2309             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2310             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2311             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2312             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2313             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2314             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2315             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2316             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2317             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2318             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2319             88  CM-AH-DECLINED               VALUE 'D'.
  2320             88  CM-AH-VOIDED                 VALUE 'V'.
  2321
  2322         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2323             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2324             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2325             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2326         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2327
  2328         16  CM-ENTRY-BATCH                PIC X(6).
  2329         16  CM-LF-EXIT-BATCH              PIC X(6).
  2330         16  CM-AH-EXIT-BATCH              PIC X(6).
  2331         16  CM-LAST-MONTH-END             PIC XX.
  2332
  2333     12  CM-NOTE-SW                        PIC X.
  2334         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2335         88  CERT-NOTES-PRESENT               VALUE '1'.
  2336         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2337         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2338         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2339         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2340         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2341         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2342     12  CM-COMP-EXCP-SW                   PIC X.
  2343         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2344         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2345     12  CM-INSURED-ADDRESS-SW             PIC X.
  2346         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2347         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2348
  2349*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2350     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  45
* EL050.cbl
  2351     12  FILLER                            PIC X.
  2352
  2353*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2354     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2355     12  FILLER                            PIC X.
  2356*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2357     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2358
  2359     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2360         88  CERT-ADDED-BATCH                 VALUE ' '.
  2361         88  CERT-ADDED-ONLINE                VALUE '1'.
  2362         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2363         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2364         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2365     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2366         88  CERT-AS-LOADED                   VALUE ' '.
  2367         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2368         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2369         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2370         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2371         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2372         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2373         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2374
  2375     12  CM-ACCOUNT-COMM-PCTS.
  2376         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2377         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2378
  2379     12  CM-USER-FIELD                     PIC X.
  2380     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2381     12  CM-CLP-STATE                      PIC XX.
  2382     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2383     12  CM-USER-RESERVED                  PIC XXX.
  2384     12  FILLER REDEFINES CM-USER-RESERVED.
  2385         16  CM-AH-CLASS-CD                PIC XX.
  2386         16  F                             PIC X.
  2387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  46
* EL050.cbl
  2389*    COPY ERCMAIL.
  2390******************************************************************
  2391*                                                                *
  2392*                                                                *
  2393*                            ERCMAIL                             *
  2394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2395*                            VMOD=2.003                          *
  2396*                                                                *
  2397*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2398*                                                                *
  2399*   FILE TYPE = VSAM,KSDS                                        *
  2400*   RECORD SIZE = 374   RECFORM = FIX                            *
  2401*                                                                *
  2402*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2403*   ALTERNATE PATH    = NOT USED                                 *
  2404*                                                                *
  2405*   LOG = YES                                                    *
  2406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2407******************************************************************
  2408*                   C H A N G E   L O G
  2409*
  2410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2411*-----------------------------------------------------------------
  2412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2413* EFFECTIVE    NUMBER
  2414*-----------------------------------------------------------------
  2415* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2416* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2417* 111108                   PEMA  ADD CRED BENE ADDR2
  2418******************************************************************
  2419
  2420 01  MAILING-DATA.
  2421     12  MA-RECORD-ID                      PIC XX.
  2422         88  VALID-MA-ID                       VALUE 'MA'.
  2423
  2424     12  MA-CONTROL-PRIMARY.
  2425         16  MA-COMPANY-CD                 PIC X.
  2426         16  MA-CARRIER                    PIC X.
  2427         16  MA-GROUPING.
  2428             20  MA-GROUPING-PREFIX        PIC XXX.
  2429             20  MA-GROUPING-PRIME         PIC XXX.
  2430         16  MA-STATE                      PIC XX.
  2431         16  MA-ACCOUNT.
  2432             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2433             20  MA-ACCOUNT-PRIME          PIC X(6).
  2434         16  MA-CERT-EFF-DT                PIC XX.
  2435         16  MA-CERT-NO.
  2436             20  MA-CERT-PRIME             PIC X(10).
  2437             20  MA-CERT-SFX               PIC X.
  2438
  2439     12  FILLER                            PIC XX.
  2440
  2441     12  MA-ACCESS-CONTROL.
  2442         16  MA-SOURCE-SYSTEM              PIC XX.
  2443             88  MA-FROM-CREDIT                VALUE 'CR'.
  2444             88  MA-FROM-VSI                   VALUE 'VS'.
  2445             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2446             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  47
* EL050.cbl
  2447         16  MA-RECORD-ADD-DT              PIC XX.
  2448         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2449         16  MA-LAST-MAINT-DT              PIC XX.
  2450         16  MA-LAST-MAINT-BY              PIC XXXX.
  2451         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2452
  2453     12  MA-PROFILE-INFO.
  2454         16  MA-QUALIFY-CODE-1             PIC XX.
  2455         16  MA-QUALIFY-CODE-2             PIC XX.
  2456         16  MA-QUALIFY-CODE-3             PIC XX.
  2457         16  MA-QUALIFY-CODE-4             PIC XX.
  2458         16  MA-QUALIFY-CODE-5             PIC XX.
  2459
  2460         16  MA-INSURED-LAST-NAME          PIC X(15).
  2461         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2462         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2463         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2464         16  MA-INSURED-BIRTH-DT           PIC XX.
  2465         16  MA-INSURED-SEX                PIC X.
  2466             88  MA-SEX-MALE                   VALUE 'M'.
  2467             88  MA-SEX-FEMALE                 VALUE 'F'.
  2468         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2469
  2470         16  MA-ADDRESS-CORRECTED          PIC X.
  2471         16  MA-JOINT-BIRTH-DT             PIC XX.
  2472*        16  FILLER                        PIC X(12).
  2473
  2474         16  MA-ADDRESS-LINE-1             PIC X(30).
  2475         16  MA-ADDRESS-LINE-2             PIC X(30).
  2476         16  MA-CITY-STATE.
  2477             20  MA-CITY                   PIC X(28).
  2478             20  MA-ADDR-STATE             PIC XX.
  2479         16  MA-ZIP.
  2480             20  MA-ZIP-CODE.
  2481                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2482                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2483                 24  FILLER                PIC X(4).
  2484             20  MA-ZIP-PLUS4              PIC X(4).
  2485         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2486             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2487             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2488             20  FILLER                    PIC X(3).
  2489
  2490         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2491
  2492         16  FILLER                        PIC XXX.
  2493*        16  FILLER                        PIC X(10).
  2494
  2495     12  MA-CRED-BENE-INFO.
  2496         16  MA-CRED-BENE-NAME                 PIC X(25).
  2497         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2498         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2499         16  MA-CRED-BENE-CTYST.
  2500             20  MA-CRED-BENE-CITY             PIC X(28).
  2501             20  MA-CRED-BENE-STATE            PIC XX.
  2502         16  MA-CRED-BENE-ZIP.
  2503             20  MA-CB-ZIP-CODE.
  2504                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  48
* EL050.cbl
  2505                     88  MA-CB-CANADIAN-POST-CODE
  2506                                           VALUE 'A' THRU 'Z'.
  2507                 24  FILLER                    PIC X(4).
  2508             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2509         16  MA-CB-CANADIAN-POSTAL-CODE
  2510                            REDEFINES MA-CRED-BENE-ZIP.
  2511             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2512             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2513             20  FILLER                        PIC X(3).
  2514     12  MA-POST-CARD-MAIL-DATA.
  2515         16  MA-MAIL-DATA OCCURS 7.
  2516             20  MA-MAIL-TYPE              PIC X.
  2517                 88  MA-12MO-MAILING           VALUE '1'.
  2518                 88  MA-EXP-MAILING            VALUE '2'.
  2519             20  MA-MAIL-STATUS            PIC X.
  2520                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2521                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2522                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2523             20  MA-MAIL-DATE              PIC XX.
  2524     12  FILLER                            PIC XX.
  2525     12  FILLER                            PIC XX.
  2526*    12  FILLER                            PIC X(30).
  2527******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  49
* EL050.cbl
  2529*    COPY ERCPNDM.
  2530******************************************************************
  2531*                                                                *
  2532*                                                                *
  2533*                            ERCPNDM                             *
  2534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2535*                            VMOD=2.003                          *
  2536*                                                                *
  2537*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2538*                                                                *
  2539*   FILE TYPE = VSAM,KSDS                                        *
  2540*   RECORD SIZE = 374   RECFORM = FIX                            *
  2541*                                                                *
  2542*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2543*   ALTERNATE PATH    = NOT USED                                 *
  2544*                                                                *
  2545*   LOG = YES                                                    *
  2546*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2547******************************************************************
  2548*                   C H A N G E   L O G
  2549*
  2550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2551*-----------------------------------------------------------------
  2552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2553* EFFECTIVE    NUMBER
  2554*-----------------------------------------------------------------
  2555* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2556* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2557* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2558******************************************************************
  2559
  2560 01  PENDING-MAILING-DATA.
  2561     12  PM-RECORD-ID                      PIC XX.
  2562         88  VALID-MA-ID                       VALUE 'PM'.
  2563
  2564     12  PM-CONTROL-PRIMARY.
  2565         16  PM-COMPANY-CD                 PIC X.
  2566         16  PM-ENTRY-BATCH                PIC X(6).
  2567         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2568         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2569
  2570     12  FILLER                            PIC X(14).
  2571
  2572     12  PM-ACCESS-CONTROL.
  2573         16  PM-SOURCE-SYSTEM              PIC XX.
  2574             88  PM-FROM-CREDIT                VALUE 'CR'.
  2575             88  PM-FROM-VSI                   VALUE 'VS'.
  2576             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2577             88  PM-FROM-OTHER                 VALUE 'OT'.
  2578         16  PM-RECORD-ADD-DT              PIC XX.
  2579         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2580         16  PM-LAST-MAINT-DT              PIC XX.
  2581         16  PM-LAST-MAINT-BY              PIC XXXX.
  2582         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2583
  2584     12  PM-PROFILE-INFO.
  2585         16  PM-QUALIFY-CODE-1             PIC XX.
  2586         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  50
* EL050.cbl
  2587         16  PM-QUALIFY-CODE-3             PIC XX.
  2588         16  PM-QUALIFY-CODE-4             PIC XX.
  2589         16  PM-QUALIFY-CODE-5             PIC XX.
  2590
  2591         16  PM-INSURED-LAST-NAME          PIC X(15).
  2592         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2593         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2594         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2595         16  PM-INSURED-BIRTH-DT           PIC XX.
  2596         16  PM-INSURED-SEX                PIC X.
  2597             88  PM-SEX-MALE                   VALUE 'M'.
  2598             88  PM-SEX-FEMALE                 VALUE 'F'.
  2599         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2600
  2601         16  PM-ADDRESS-CORRECTED          PIC X.
  2602         16  PM-JOINT-BIRTH-DT             PIC XX.
  2603*        16  FILLER                        PIC X(12).
  2604
  2605         16  PM-ADDRESS-LINE-1             PIC X(30).
  2606         16  PM-ADDRESS-LINE-2             PIC X(30).
  2607         16  PM-CITY-STATE.
  2608             20  PM-CITY                   PIC X(28).
  2609             20  PM-STATE                  PIC XX.
  2610         16  PM-ZIP.
  2611             20  PM-ZIP-CODE.
  2612                 24  PM-ZIP-1              PIC X.
  2613                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-ZIP-PLUS4              PIC X(4).
  2616         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2617             20  PM-CAN-POST1              PIC XXX.
  2618             20  PM-CAN-POST2              PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620
  2621         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2622
  2623         16  FILLER                        PIC X(03).
  2624
  2625     12  PM-CRED-BENE-INFO.
  2626         16  PM-CRED-BENE-NAME             PIC X(25).
  2627         16  PM-CRED-BENE-ADDR             PIC X(30).
  2628         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2629         16  PM-CRED-BENE-CTYST.
  2630             20  PM-CRED-BENE-CITY         PIC X(28).
  2631             20  PM-CRED-BENE-STATE        PIC XX.
  2632         16  PM-CRED-BENE-ZIP.
  2633             20  PM-CB-ZIP-CODE.
  2634                 24  PM-CB-ZIP-1           PIC X.
  2635                     88  PM-CB-CANADIAN-POST-CODE
  2636                                  VALUE 'A' THRU 'Z'.
  2637                 24  FILLER                PIC X(4).
  2638             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2639         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2640             20  PM-CB-CAN-POST1           PIC XXX.
  2641             20  PM-CB-CAN-POST2           PIC XXX.
  2642             20  FILLER                    PIC XXX.
  2643     12  PM-POST-CARD-MAIL-DATA.
  2644         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  51
* EL050.cbl
  2645             20  PM-MAIL-TYPE              PIC X.
  2646                 88  PM-12MO-MAILING           VALUE '1'.
  2647                 88  PM-EXP-MAILING            VALUE '2'.
  2648             20  PM-MAIL-STATUS            PIC X.
  2649                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2650                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2651                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2652             20  PM-MAIL-DATE              PIC XX.
  2653     12  FILLER                            PIC XX.
  2654     12  FILLER                            PIC X(12).
  2655*    12  FILLER                            PIC X(30).
  2656
  2657******************************************************************
  2658*                                COPY ERCLOFC.
  2659******************************************************************
  2660*                                                                *
  2661*                                                                *
  2662*                            ERCLOFC                             *
  2663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2664*                            VMOD=2.003                          *
  2665*                                                                *
  2666*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2667*                                                                *
  2668*   FILE TYPE = VSAM,KSDS                                        *
  2669*   RECORD SIZE = 670   RECFORM = FIX                            *
  2670*                                                                *
  2671*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2672*                                                                *
  2673*   LOG = YES                                                    *
  2674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2675*                                                                *
  2676******************************************************************
  2677
  2678 01  LOAN-OFFICER-MASTER.
  2679     12  LO-RECORD-ID                PIC XX.
  2680         88  VALID-LO-ID                VALUE 'LO'.
  2681
  2682     12  LO-CONTROL-PRIMARY.
  2683         16  LO-COMPANY-CD           PIC X.
  2684         16  LO-CARRIER              PIC X.
  2685         16  LO-GROUPING.
  2686             20  LO-GROUPING-PREFIX  PIC XXX.
  2687             20  LO-GROUPING-PRIME   PIC XXX.
  2688         16  LO-STATE                PIC XX.
  2689         16  LO-ACCOUNT.
  2690             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2691             20  LO-ACCOUNT-PRIME    PIC X(6).
  2692         16  LO-OFFICER-CODE         PIC X(5).
  2693
  2694     12  LO-OFFICER-NAME             PIC X(30).
  2695
  2696     12  LO-LAST-MAINT-DT            PIC XX.
  2697     12  LO-LAST-USER                PIC X(4).
  2698     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2699
  2700     12  LO-COMP-CONTROL             PIC X.
  2701             88  LO-SHOW-COMP           VALUE 'Y'.
  2702             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  52
* EL050.cbl
  2703     12  LO-DETAIL-CONTROL           PIC X.
  2704             88  LO-PRINT-DETAIL        VALUE 'D'.
  2705             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2706
  2707     12  LO-SV-CARRIER               PIC X.
  2708     12  LO-SV-GROUPING              PIC X(6).
  2709     12  LO-SV-STATE                 PIC XX.
  2710
  2711     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2712     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2713
  2714     12  LO-OFFICER-INFO.
  2715         16  FILLER OCCURS 12 TIMES.
  2716             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2717             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2718             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2719             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2720             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2721             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2722             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2723             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2724     12  FILLER                      PIC X(198).
  2725******************************************************************
  2726*                                COPY ERCPDEF.
  2727******************************************************************
  2728*                                                                *
  2729*                                                                *
  2730*                            ERCPDEF.                            *
  2731*                                                                *
  2732*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2733*                                                                *
  2734*    FILE TYPE = VSAM,KSDS                                       *
  2735*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2736*                                                                *
  2737*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2738*                                                                *
  2739*    LOG = YES                                                   *
  2740*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2741******************************************************************
  2742 01  PRODUCT-MASTER.
  2743    12  PD-RECORD-ID                 PIC X(02).
  2744        88  VALID-PD-ID                  VALUE 'PD'.
  2745    12  PD-CONTROL-PRIMARY.
  2746        16  PD-COMPANY-CD            PIC X.
  2747        16  PD-STATE                 PIC XX.
  2748        16  PD-PRODUCT-CD            PIC XXX.
  2749        16  PD-FILLER                PIC X(7).
  2750        16  PD-BEN-TYPE              PIC X.
  2751        16  PD-BEN-CODE              PIC XX.
  2752        16  PD-PROD-EXP-DT           PIC XX.
  2753    12  FILLER                       PIC X(50).
  2754    12  PD-PRODUCT-DATA OCCURS 8.
  2755        16  PD-PROD-CODE             PIC X.
  2756            88  PD-PROD-LIFE           VALUE 'L'.
  2757            88  PD-PROD-PROP           VALUE 'P'.
  2758            88  PD-PROD-AH             VALUE 'A'.
  2759            88  PD-PROD-IU             VALUE 'I'.
  2760            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  53
* EL050.cbl
  2761        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2762        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2763        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2764        16  PD-MAX-TERM              PIC S999        COMP-3.
  2765        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2766        16  FILLER                   PIC X.
  2767        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2768        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2769        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2770        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2771        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2772        16  PD-REC-CRIT-PERIOD       PIC X.
  2773        16  PD-RTW-MOS               PIC 99.
  2774        16  FILLER                   PIC X(5).
  2775    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2776    12  PD-TERM-LIMITS OCCURS 15.
  2777        16  PD-LOW-TERM              PIC S999        COMP-3.
  2778        16  PD-HI-TERM               PIC S999        COMP-3.
  2779*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2780    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2781        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2782        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2783    12  PD-EARN-FACTORS.
  2784        16  FILLER OCCURS 15.
  2785            20  FILLER OCCURS 15.
  2786                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2787    12  PD-PRODUCT-DESC              PIC X(80).
  2788    12  PD-TRUNCATED                 PIC X.
  2789    12  FILLER                       PIC X(59).
  2790    12  PD-MAINT-INFORMATION.
  2791        16  PD-LAST-MAINT-DT         PIC X(02).
  2792        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2793        16  PD-LAST-MAINT-BY         PIC X(04).
  2794*                                COPY ELCSTATE.
  2795******************************************************************
  2796*                                                                *
  2797*                                                                *
  2798*                            ELCSTATE.                           *
  2799*                                                                *
  2800*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2801*                                                                *
  2802*   FILE TYPE = VSAM,KSDS                                        *
  2803*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2804*                                                                *
  2805*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2806*       ALTERNATE INDEX = NONE                                   *
  2807*                                                                *
  2808*   LOG = YES                                                    *
  2809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2810******************************************************************
  2811*                   C H A N G E   L O G
  2812*
  2813* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2814*-----------------------------------------------------------------
  2815*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2816* EFFECTIVE    NUMBER
  2817*-----------------------------------------------------------------
  2818* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  54
* EL050.cbl
  2819******************************************************************
  2820*
  2821 01  STATE-FILE.
  2822     12  SF-RECORD-ID                       PIC XX.
  2823         88  VALID-CF-ID                        VALUE 'SF'.
  2824     12  SF-CONTROL-PRIMARY.
  2825         16  SF-COMPANY-ID                  PIC XXX.
  2826         16  SF-CARRIER-CODE                PIC X.
  2827         16  SF-GROUPING                    PIC X(6).
  2828         16  SF-STATE-CODE                  PIC XX.
  2829         16  SF-EXPIRE-DATE                 PIC 9(8).
  2830****************************************************************
  2831*             STATE CONTROLS
  2832****************************************************************
  2833     12  SF-LAST-MAINT-DT                   PIC XX.
  2834     12  SF-LAST-MAINT-BY                   PIC X(4).
  2835     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2836     12  SF-STATE-RT-CONTROLS.
  2837         16  SF-ST-RT-CALC                  PIC X.
  2838     12  SF-ST-TAX-CONTROLS.
  2839         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2840         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2841         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2842     12  SF-ST-REFUND-OPTIONS.
  2843         16  SF-ST-RF-LR-CALC               PIC X.
  2844         16  SF-ST-RF-LL-CALC               PIC X.
  2845         16  SF-ST-RF-LN-CALC               PIC X.
  2846         16  SF-ST-RF-AH-CALC               PIC X.
  2847         16  SF-ST-RF-CP-CALC               PIC X.
  2848     12  SF-ST-UNEARN-PREM-OPTIONS.
  2849         16  SF-ST-LUEP-R78                 PIC X.
  2850         16  SF-ST-LUEP-PRO                 PIC X.
  2851         16  SF-ST-LUEP-ST                  PIC X.
  2852         16  SF-ST-LUEP-DOM                 PIC X.
  2853         16  SF-ST-AUEP-R78                 PIC X.
  2854         16  SF-ST-AUEP-PRO                 PIC X.
  2855         16  SF-ST-AUEP-ST                  PIC X.
  2856         16  SF-ST-AUEP-DOM                 PIC X.
  2857         16  SF-ST-CUEP-R78                 PIC X.
  2858         16  SF-ST-CUEP-PRO                 PIC X.
  2859         16  SF-ST-CUEP-ST                  PIC X.
  2860         16  SF-ST-CUEP-DOM                 PIC X.
  2861     12  SF-ST-EARN-PREM-OPTIONS.
  2862         16  SF-ST-LEP-R78                  PIC X.
  2863         16  SF-ST-LEP-PRO                  PIC X.
  2864         16  SF-ST-LEP-ST                   PIC X.
  2865         16  SF-ST-LEP-DOM                  PIC X.
  2866         16  SF-ST-AEP-R78                  PIC X.
  2867         16  SF-ST-AEP-PRO                  PIC X.
  2868         16  SF-ST-AEP-ST                   PIC X.
  2869         16  SF-ST-AEP-DOM                  PIC X.
  2870         16  SF-ST-CEP-R78                  PIC X.
  2871         16  SF-ST-CEP-PRO                  PIC X.
  2872         16  SF-ST-CEP-ST                   PIC X.
  2873         16  SF-ST-CEP-DOM                  PIC X.
  2874     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  55
* EL050.cbl
  2876*    COPY ELCCRTT.
  2877******************************************************************
  2878*                                                                *
  2879*                            ELCCRTT.                            *
  2880*                                                                *
  2881*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2882*                                                                *
  2883*   FILE TYPE = VSAM,KSDS                                        *
  2884*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2885*                                                                *
  2886*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2887*                                                                *
  2888*   LOG = YES                                                    *
  2889*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2890******************************************************************
  2891*                   C H A N G E   L O G
  2892*
  2893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2894*-----------------------------------------------------------------
  2895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2896* EFFECTIVE    NUMBER
  2897*-----------------------------------------------------------------
  2898* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2899* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2900* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2901* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2902* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2903******************************************************************
  2904
  2905 01  CERTIFICATE-TRAILERS.
  2906     12  CS-RECORD-ID                      PIC XX.
  2907         88  VALID-CS-ID                      VALUE 'CS'.
  2908
  2909     12  CS-CONTROL-PRIMARY.
  2910         16  CS-COMPANY-CD                 PIC X.
  2911         16  CS-CARRIER                    PIC X.
  2912         16  CS-GROUPING                   PIC X(6).
  2913         16  CS-STATE                      PIC XX.
  2914         16  CS-ACCOUNT                    PIC X(10).
  2915         16  CS-CERT-EFF-DT                PIC XX.
  2916         16  CS-CERT-NO.
  2917             20  CS-CERT-PRIME             PIC X(10).
  2918             20  CS-CERT-SFX               PIC X.
  2919         16  CS-TRAILER-TYPE               PIC X.
  2920             88  COMM-TRLR           VALUE 'A'.
  2921             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2922             88  CERT-DATA-TRLR      VALUE 'C'.
  2923
  2924     12  CS-DATA-AREA                      PIC X(516).
  2925
  2926     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2927         16  CS-BANK-COMMISSION-AREA.
  2928             20  CS-BANK-COMMS       OCCURS 10.
  2929                 24  CS-AGT                PIC X(10).
  2930                 24  CS-COM-TYP            PIC X.
  2931                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2932                 24  CS-RECALC-LV-INDIC    PIC X.
  2933                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  56
* EL050.cbl
  2934         16  FILLER                        PIC X(256).
  2935
  2936     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2937****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2938****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2939         16  CS-MB-CLAIM-DATA OCCURS 2.
  2940             20  FILLER OCCURS 10.
  2941                 24  CS-CLAIM-TYPE         PIC X.
  2942                     88  CS-AH-CLM           VALUE 'A'.
  2943                     88  CS-IU-CLM           VALUE 'I'.
  2944                     88  CS-GP-CLM           VALUE 'G'.
  2945                     88  CS-LF-CLM           VALUE 'L'.
  2946                     88  CS-PR-CLM           VALUE 'P'.
  2947                 24  CS-BANK               PIC S999 COMP-3.
  2948                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2949                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2950                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2951         16  FILLER                        PIC X(216).
  2952     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2953         16  CS-VIN-NUMBER                 PIC X(17).
  2954         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2955         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2956         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2957         16  FILLER                        PIC X(496).
  2958******************************************************************
  2959*    COPY ELCCRTO.
  2960******************************************************************
  2961*                                                                *
  2962*                            ELCCRTO.                            *
  2963*                                                                *
  2964*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2965*                                                                *
  2966*   FILE TYPE = VSAM,KSDS                                        *
  2967*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2968*                                                                *
  2969*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2970*                                                                *
  2971*   LOG = YES                                                    *
  2972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2973******************************************************************
  2974*                   C H A N G E   L O G
  2975*
  2976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2977*-----------------------------------------------------------------
  2978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2979* EFFECTIVE    NUMBER
  2980*-----------------------------------------------------------------
  2981* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2982* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2983* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2984* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2985* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2986******************************************************************
  2987 01  ORIGINAL-CERTIFICATE.
  2988     12  OC-RECORD-ID                      PIC XX.
  2989         88  VALID-OC-ID                      VALUE 'OC'.
  2990     12  OC-CONTROL-PRIMARY.
  2991         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  57
* EL050.cbl
  2992         16  OC-CARRIER                    PIC X.
  2993         16  OC-GROUPING                   PIC X(6).
  2994         16  OC-STATE                      PIC XX.
  2995         16  OC-ACCOUNT                    PIC X(10).
  2996         16  OC-CERT-EFF-DT                PIC XX.
  2997         16  OC-CERT-NO.
  2998             20  OC-CERT-PRIME             PIC X(10).
  2999             20  OC-CERT-SFX               PIC X.
  3000         16  OC-RECORD-TYPE                PIC X.
  3001         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3002     12  OC-LAST-MAINT-DT                  PIC XX.
  3003     12  OC-LAST-MAINT-BY                  PIC X(4).
  3004     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3005     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3006     12  FILLER                            PIC X(49).
  3007     12  OC-ORIG-REC.
  3008         16  OC-INS-LAST-NAME              PIC X(15).
  3009         16  OC-INS-FIRST-NAME             PIC X(10).
  3010         16  OC-INS-MIDDLE-INIT            PIC X.
  3011         16  OC-INS-AGE                    PIC S999     COMP-3.
  3012         16  OC-JNT-LAST-NAME              PIC X(15).
  3013         16  OC-JNT-FIRST-NAME             PIC X(10).
  3014         16  OC-JNT-MIDDLE-INIT            PIC X.
  3015         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3016         16  OC-LF-BENCD                   PIC XX.
  3017         16  OC-LF-TERM                    PIC S999      COMP-3.
  3018         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3019         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3020         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3021         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3022         16  OC-LF-EXP-DT                  PIC XX.
  3023         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3024         16  OC-LF-CANCEL-DT               PIC XX.
  3025         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3026         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3027         16  OC-AH-BENCD                   PIC XX.
  3028         16  OC-AH-TERM                    PIC S999      COMP-3.
  3029         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3030         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3031         16  OC-AH-EXP-DT                  PIC XX.
  3032         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3033         16  OC-AH-CP                      PIC 99.
  3034         16  OC-AH-CANCEL-DT               PIC XX.
  3035         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3036         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3037         16  OC-CRED-BENE-NAME             PIC X(25).
  3038         16  OC-1ST-PMT-DT                 PIC XX.
  3039         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3040         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3041         16  OC-ISSUE-TRAN-IND             PIC X.
  3042         16  OC-CANCEL-TRAN-IND            PIC X.
  3043         16  FILLER                        PIC X(211).
  3044
  3045     12  FILLER                            PIC X(50).
  3046******************************************************************
  3047
  3048*    COPY ELCDATE.
  3049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  58
* EL050.cbl
  3050*                                                                *
  3051*                                                                *
  3052*                            ELCDATE.                            *
  3053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3054*                            VMOD=2.003
  3055*                                                                *
  3056*                                                                *
  3057*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3058*                 LENGTH = 200                                   *
  3059******************************************************************
  3060
  3061 01  DATE-CONVERSION-DATA.
  3062     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3063     12  DC-OPTION-CODE                PIC X.
  3064         88  BIN-TO-GREG                VALUE ' '.
  3065         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3066         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3067         88  YMD-GREG-TO-BIN            VALUE '3'.
  3068         88  MDY-GREG-TO-BIN            VALUE '4'.
  3069         88  JULIAN-TO-BIN              VALUE '5'.
  3070         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3071         88  FIND-CENTURY               VALUE '7'.
  3072         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3073         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3074         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3075         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3076         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3077         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3078         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3079         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3080         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3081         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3082         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3083         88  BIN-3-TO-GREG              VALUE 'I'.
  3084         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3085         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3086         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3087         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3088         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3089         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3090         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3091         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3092         88  THREE-CHARACTER-BIN
  3093                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3094         88  GREGORIAN-TO-BIN
  3095                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3096         88  BIN-TO-GREGORIAN
  3097                  VALUES ' ' '1' 'I' '8' 'G'.
  3098         88  JULIAN-TO-BINARY
  3099                  VALUES '5' 'C' 'E' 'F'.
  3100     12  DC-ERROR-CODE                 PIC X.
  3101         88  NO-CONVERSION-ERROR        VALUE ' '.
  3102         88  DATE-CONVERSION-ERROR
  3103                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3104         88  DATE-IS-ZERO               VALUE '1'.
  3105         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3106         88  DATE-IS-INVALID            VALUE '3'.
  3107         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  59
* EL050.cbl
  3108         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3109         88  DATE-INVALID-OPTION        VALUE '9'.
  3110         88  INVALID-CENTURY            VALUE 'A'.
  3111         88  ONLY-CENTURY               VALUE 'B'.
  3112         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3113         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3114     12  DC-END-OF-MONTH               PIC X.
  3115         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3116     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3117         88  USE-NORMAL-PROCESS         VALUE ' '.
  3118         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3119         88  ADJUST-UP-100-YRS          VALUE '2'.
  3120     12  FILLER                        PIC X.
  3121     12  DC-CONVERSION-DATES.
  3122         16  DC-BIN-DATE-1             PIC XX.
  3123         16  DC-BIN-DATE-2             PIC XX.
  3124         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3125         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3126                       DC-GREG-DATE-1-EDIT.
  3127             20  DC-EDIT1-MONTH        PIC 99.
  3128             20  SLASH1-1              PIC X.
  3129             20  DC-EDIT1-DAY          PIC 99.
  3130             20  SLASH1-2              PIC X.
  3131             20  DC-EDIT1-YEAR         PIC 99.
  3132         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3133         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3134                     DC-GREG-DATE-2-EDIT.
  3135             20  DC-EDIT2-MONTH        PIC 99.
  3136             20  SLASH2-1              PIC X.
  3137             20  DC-EDIT2-DAY          PIC 99.
  3138             20  SLASH2-2              PIC X.
  3139             20  DC-EDIT2-YEAR         PIC 99.
  3140         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3141         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3142                     DC-GREG-DATE-1-YMD.
  3143             20  DC-YMD-YEAR           PIC 99.
  3144             20  DC-YMD-MONTH          PIC 99.
  3145             20  DC-YMD-DAY            PIC 99.
  3146         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3147         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3148                      DC-GREG-DATE-1-MDY.
  3149             20  DC-MDY-MONTH          PIC 99.
  3150             20  DC-MDY-DAY            PIC 99.
  3151             20  DC-MDY-YEAR           PIC 99.
  3152         16  DC-GREG-DATE-1-ALPHA.
  3153             20  DC-ALPHA-MONTH        PIC X(10).
  3154             20  DC-ALPHA-DAY          PIC 99.
  3155             20  FILLER                PIC XX.
  3156             20  DC-ALPHA-CENTURY.
  3157                 24 DC-ALPHA-CEN-N     PIC 99.
  3158             20  DC-ALPHA-YEAR         PIC 99.
  3159         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3160         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3161         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3162         16  DC-JULIAN-DATE            PIC 9(05).
  3163         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3164                                       PIC 9(05).
  3165         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  60
* EL050.cbl
  3166             20  DC-JULIAN-YEAR        PIC 99.
  3167             20  DC-JULIAN-DAYS        PIC 999.
  3168         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3169         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3170         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3171     12  DATE-CONVERSION-VARIBLES.
  3172         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3173         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3174             20  FILLER                PIC 9(3).
  3175             20  HOLD-CEN-1-CCYY.
  3176                 24  HOLD-CEN-1-CC     PIC 99.
  3177                 24  HOLD-CEN-1-YY     PIC 99.
  3178             20  HOLD-CEN-1-MO         PIC 99.
  3179             20  HOLD-CEN-1-DA         PIC 99.
  3180         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3181             20  HOLD-CEN-1-R-MO       PIC 99.
  3182             20  HOLD-CEN-1-R-DA       PIC 99.
  3183             20  HOLD-CEN-1-R-CCYY.
  3184                 24  HOLD-CEN-1-R-CC   PIC 99.
  3185                 24  HOLD-CEN-1-R-YY   PIC 99.
  3186             20  FILLER                PIC 9(3).
  3187         16  HOLD-CENTURY-1-X.
  3188             20  FILLER                PIC X(3)  VALUE SPACES.
  3189             20  HOLD-CEN-1-X-CCYY.
  3190                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3191                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3192             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3193             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3194         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3195             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3196             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3197             20  HOLD-CEN-1-R-X-CCYY.
  3198                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3199                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3200             20  FILLER                PIC XXX.
  3201         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3202         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3203         16  DC-JULIAN-DATE-1          PIC 9(07).
  3204         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3205             20  DC-JULIAN-1-CCYY.
  3206                 24  DC-JULIAN-1-CC    PIC 99.
  3207                 24  DC-JULIAN-1-YR    PIC 99.
  3208             20  DC-JULIAN-DA-1        PIC 999.
  3209         16  DC-JULIAN-DATE-2          PIC 9(07).
  3210         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3211             20  DC-JULIAN-2-CCYY.
  3212                 24  DC-JULIAN-2-CC    PIC 99.
  3213                 24  DC-JULIAN-2-YR    PIC 99.
  3214             20  DC-JULIAN-DA-2        PIC 999.
  3215         16  DC-GREG-DATE-A-EDIT.
  3216             20  DC-EDITA-MONTH        PIC 99.
  3217             20  SLASHA-1              PIC X VALUE '/'.
  3218             20  DC-EDITA-DAY          PIC 99.
  3219             20  SLASHA-2              PIC X VALUE '/'.
  3220             20  DC-EDITA-CCYY.
  3221                 24  DC-EDITA-CENT     PIC 99.
  3222                 24  DC-EDITA-YEAR     PIC 99.
  3223         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  61
* EL050.cbl
  3224             20  DC-EDITB-MONTH        PIC 99.
  3225             20  SLASHB-1              PIC X VALUE '/'.
  3226             20  DC-EDITB-DAY          PIC 99.
  3227             20  SLASHB-2              PIC X VALUE '/'.
  3228             20  DC-EDITB-CCYY.
  3229                 24  DC-EDITB-CENT     PIC 99.
  3230                 24  DC-EDITB-YEAR     PIC 99.
  3231         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3232         16  DC-GREG-DATE-CYMD-R REDEFINES
  3233                              DC-GREG-DATE-CYMD.
  3234             20  DC-CYMD-CEN           PIC 99.
  3235             20  DC-CYMD-YEAR          PIC 99.
  3236             20  DC-CYMD-MONTH         PIC 99.
  3237             20  DC-CYMD-DAY           PIC 99.
  3238         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3239         16  DC-GREG-DATE-MDCY-R REDEFINES
  3240                              DC-GREG-DATE-MDCY.
  3241             20  DC-MDCY-MONTH         PIC 99.
  3242             20  DC-MDCY-DAY           PIC 99.
  3243             20  DC-MDCY-CEN           PIC 99.
  3244             20  DC-MDCY-YEAR          PIC 99.
  3245    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3246        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3247    12  DC-EL310-DATE                  PIC X(21).
  3248    12  FILLER                         PIC X(28).
  3249
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  62
* EL050.cbl
  3251*    COPY ELCCALC.
  3252******************************************************************
  3253*                                                                *
  3254*                           ELCCALC.                            *
  3255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3256*                            VMOD=2.025                          *
  3257*                                                                *
  3258*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3259*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3260*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3261*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3262*                                                                *
  3263*  PASSED TO ELRTRM                                              *
  3264*  -----------------                                             *
  3265*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3266*  ORIGINAL TERM                                                 *
  3267*  BEGINNING DATE                                                *
  3268*  ENDING DATE                                                   *
  3269*  COMPANY I.D.                                                  *
  3270*  ACCOUNT MASTER USER FIELD                                     *
  3271*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3272*  FREE LOOK DAYS                                                *
  3273*                                                                *
  3274*  RETURNED FROM ELRTRM                                          *
  3275*  ---------------------                                         *
  3276*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3277*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3278*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3279*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3280*----------------------------------------------------------------*
  3281*  PASSED TO ELRAMT                                              *
  3282*  ----------------                                              *
  3283*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3284*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3285*  ORIGINAL AMOUNT                                               *
  3286*  ALTERNATE BENEFIT (BALLON)                                    *
  3287*  A.P.R. - NET PAY ONLY                                         *
  3288*  METHOD
  3289*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3290*  COMPANY I.D.                                                  *
  3291*  BENEFIT TYPE                                                  *
  3292*                                                                *
  3293*  RETURNED FROM ELRAMT                                          *
  3294*  --------------------                                          *
  3295*  REMAINING AMOUNT 1 - CURRENT                                  *
  3296*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3297*  REMAINING AMOUNT FACTOR
  3298*----------------------------------------------------------------*
  3299*  PASSED TO ELRESV                                              *
  3300*  -----------------                                             *
  3301*  CERTIFICATE EFFECTIVE DATE                                    *
  3302*  VALUATION DATE                                                *
  3303*  PAID THRU DATE                                                *
  3304*  BENEFIT                                                       *
  3305*  INCURRED DATE                                                 *
  3306*  REPORTED DATE                                                 *
  3307*  ISSUE AGE                                                     *
  3308*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  63
* EL050.cbl
  3309*  CDT PERCENT                                                   *
  3310*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3311* *CLAIM TYPE (LIFE, A/H)                                        *
  3312* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3313* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3314*                                                                *
  3315*  RETURNED FROM ELRESV                                          *
  3316*  --------------------                                          *
  3317*  CDT TABLE USED                                                *
  3318*  CDT FACTOR USED                                               *
  3319*  PAY TO CURRENT RESERVE                                        *
  3320*  I.B.N.R. - A/H ONLY                                           *
  3321*  FUTURE (ACCRUED) AH ONLY                                      *
  3322*----------------------------------------------------------------*
  3323*  PASSED TO ELRATE                                              *
  3324*  ----------------                                              *
  3325*  CERT ISSUE DATE                                               *
  3326*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3327*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3328*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3329*  STATE CODE (CLIENT DEFINED)                                   *
  3330*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3331*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3332*  DEVIATION CODE                                                *
  3333*  ISSUE AGE                                                     *
  3334*  ORIGINAL BENEFIT AMOUNT                                       *
  3335*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3336*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3337*  BENEFIT KIND (LIFE OR A/H)                                    *
  3338*  A.P.R.                                                        *
  3339*  METHOD
  3340*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3341*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3342*  COMPANY I.D. (3 CHARACTER)                                    *
  3343*  BENEFIT CODE                                                  *
  3344*  BENEFIT OVERRIDE CODE                                         *
  3345*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3346*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3347*  JOINT INDICATOR (CSL ONLY)                                    *
  3348*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3349*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3350*                                                                *
  3351*  RETURNED FROM ELRATE                                          *
  3352*  --------------------                                          *
  3353*  CALCULATED PREMIUM                                            *
  3354*  PREMIUM RATE                                                  *
  3355*  MORTALITY CODE                                                *
  3356*  MAX ATTAINED AGE                                              *
  3357*  MAX AGE                                                       *
  3358*  MAX TERM                                                      *
  3359*  MAX MONTHLY BENEFIT                                           *
  3360*  MAX TOTAL BENIFIT                                             *
  3361*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3362*----------------------------------------------------------------*
  3363*  PASSED TO ELRFND                                              *
  3364*  ----------------                                              *
  3365*  CERT ISSUE DATE                                               *
  3366*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  64
* EL050.cbl
  3367*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3368*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3369*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3370*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3371*  STATE CODE (CLIENT DEFINED)                                   *
  3372*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3373*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3374*  DEVIATION CODE                                                *
  3375*  ISSUE AGE                                                     *
  3376*  ORIGINAL BENEFIT AMOUNT                                       *
  3377*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3378*  PROCESS TYPE (CANCEL)                                         *
  3379*  BENEFIT KIND (LIFE OR A/H)                                    *
  3380*  A.P.R.                                                        *
  3381*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3382*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3383*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3384*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3385*  COMPANY I.D. (3 CHARACTER)                                    *
  3386*  BENEFIT CODE                                                  *
  3387*  BENEFIT OVERRIDE CODE                                         *
  3388*                                                                *
  3389*  RETURNED FROM ELRFND                                          *
  3390*  --------------------                                          *
  3391*  CALCULATED REFUND                                             *
  3392*----------------------------------------------------------------*
  3393*  PASSED TO ELEARN                                              *
  3394*  ----------------                                              *
  3395*  CERT ISSUE DATE                                               *
  3396*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3397*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3398*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3399*  STATE CODE (CLIENT DEFINED)                                   *
  3400*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3401*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3402*  DEVIATION CODE                                                *
  3403*  ISSUE AGE                                                     *
  3404*  ORIGINAL BENEFIT AMOUNT                                       *
  3405*  BENEFIT KIND (LIFE OR A/H)                                    *
  3406*  A.P.R.                                                        *
  3407*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3408*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3409*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3410*  COMPANY I.D. (3 CHARACTER)                                    *
  3411*  BENEFIT CODE                                                  *
  3412*  BENEFIT OVERRIDE CODE                                         *
  3413*                                                                *
  3414*  RETURNED FROM ELEARN                                          *
  3415*  --------------------                                          *
  3416*  INDICATED  EARNINGS                                           *
  3417*----------------------------------------------------------------*
  3418*                 LENGTH = 450                                   *
  3419*                                                                *
  3420******************************************************************
  3421******************************************************************
  3422*                   C H A N G E   L O G
  3423*
  3424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  65
* EL050.cbl
  3425*-----------------------------------------------------------------
  3426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3427* EFFECTIVE    NUMBER
  3428*-----------------------------------------------------------------
  3429* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3430* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3431* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3432* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3433* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3434* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3435* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3436* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3437* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3438******************************************************************
  3439
  3440 01  CALCULATION-PASS-AREA.
  3441     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3442                                     COMP.
  3443
  3444     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3445       88  NO-CP-ERROR                             VALUE ZERO.
  3446       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3447                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3448       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3449       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3450       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3451       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3452       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3453       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3454       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3455       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3456       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3457       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3458       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3459       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3460       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3461       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3462       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3463       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3464       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3465
  3466     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3467       88  NO-CP-ERROR-2                           VALUE ZERO.
  3468***********************  INPUT AREAS ****************************
  3469
  3470     12  CP-CALCULATION-AREA.
  3471         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3472         16  CP-CERT-EFF-DT        PIC XX.
  3473         16  CP-VALUATION-DT       PIC XX.
  3474         16  CP-PAID-THRU-DT       PIC XX.
  3475         16  CP-BENEFIT-TYPE       PIC X.
  3476           88  CP-AH                               VALUE 'A' 'D'
  3477                                                   'I' 'U'.
  3478           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3479           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3480         16  CP-INCURRED-DT        PIC XX.
  3481         16  CP-REPORTED-DT        PIC XX.
  3482         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  66
* EL050.cbl
  3483         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3484         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3485                                     COMP-3.
  3486         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3487                                     COMP-3.
  3488         16  CP-CDT-METHOD         PIC X.
  3489           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3490           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3491           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3492         16  CP-CLAIM-TYPE         PIC X.
  3493           88  CP-AH-CLAIM                         VALUE 'A'.
  3494           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3495         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3504                                     COMP-3.
  3505         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3506                                     COMP-3.
  3507         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-REM-TERM-METHOD    PIC X.
  3510           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3511           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3512           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3513           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3514           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3515           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3516           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3517         16  CP-EARNING-METHOD     PIC X.
  3518           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3519           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3520           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3521           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3522           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3523           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3524           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3525           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3526           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3527           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3528           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3529           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3530           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3531           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3532         16  CP-PROCESS-TYPE       PIC X.
  3533           88  CP-CLAIM                            VALUE '1'.
  3534           88  CP-CANCEL                           VALUE '2'.
  3535           88  CP-ISSUE                            VALUE '3'.
  3536         16  CP-SPECIAL-CALC-CD    PIC X.
  3537           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3538           88  CP-1-MTH-INTEREST               VALUE ' '.
  3539           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3540           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  67
* EL050.cbl
  3541           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3542           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3543           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3544           88  CP-FARM-PLAN                    VALUE 'F'.
  3545           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3546           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3547           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3548           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3549           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3550           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3551           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3552           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3553           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3554           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3555                                                     'W' 'X'.
  3556           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3557           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3558           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3559           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3560           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3561           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3562           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3563           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3564           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3565           88  CP-CSL-METH-1                   VALUE '5'.
  3566           88  CP-CSL-METH-2                   VALUE '6'.
  3567           88  CP-CSL-METH-3                   VALUE '7'.
  3568           88  CP-CSL-METH-4                   VALUE '8'.
  3569
  3570         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3571                                     COMP-3.
  3572         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3573         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3574         16  CP-STATE              PIC XX          VALUE SPACE.
  3575         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3576         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3577           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3578               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3579         16  CP-R78-OPTION         PIC X.
  3580           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3581           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3582
  3583         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3584         16  CP-IBNR-RESERVE-SW    PIC X.
  3585         16  CP-CLAIM-STATUS       PIC X.
  3586         16  CP-RATE-FILE          PIC X.
  3587         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3588                                     COMP-3.
  3589
  3590         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3591         16  CP-AH-OVERRIDE-CODE   PIC X.
  3592
  3593         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3596                                   PIC S9(5)V99 COMP-3.
  3597         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3598                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  68
* EL050.cbl
  3599         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3604                                  PIC S9(7)V99 COMP-3.
  3605
  3606         16  CP-PAID-FROM-DATE     PIC X(02).
  3607         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3608         16  CP-EXT-DAYS-CALC      PIC X.
  3609           88  CP-EXT-NO-CHG                   VALUE ' '.
  3610           88  CP-EXT-CHG-LF                   VALUE '1'.
  3611           88  CP-EXT-CHG-AH                   VALUE '2'.
  3612           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3613         16  CP-DOMICILE-STATE     PIC XX.
  3614         16  CP-CARRIER            PIC X.
  3615         16  CP-REIN-FLAG          PIC X.
  3616         16  CP-REM-TRM-CALC-OPTION PIC X.
  3617           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3618                      '2' '3' '4' '5'.
  3619           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3620           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3621           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3622           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3623           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3624           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3625           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3626           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3627         16  CP-SIG-SWITCH         PIC X.
  3628         16  CP-RATING-METHOD      PIC X.
  3629           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3630           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3631           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3632           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3633           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3634           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3635           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3636           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3637           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3638         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3639                                     COMP-3.
  3640         16  CP-BEN-CATEGORY       PIC X.
  3641         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3642         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3643                                   PIC S99V9(5) COMP-3.
  3644         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3645         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3646                                   PIC S99V9(5) COMP-3.
  3647         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3648         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3649         16  CP-EXPIRE-DT          PIC XX.
  3650         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3651         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3652         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3653         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-SPEC-CALC      PIC X.
  3655             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3656             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  69
* EL050.cbl
  3657         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3658         16  CP-CANCEL-REASON      PIC X.
  3659         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3660         16  CP-PMT-MODE           PIC X.
  3661         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3662         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3663         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3664         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3665         16  FILLER                PIC X.
  3666
  3667***************    OUTPUT FROM ELRESV   ************************
  3668
  3669         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3670
  3671         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  FILLER                PIC X(09).
  3680***************    OUTPUT FROM ELRTRM   *************************
  3681
  3682         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3683                                     COMP-3.
  3684         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3687                                     COMP-3.
  3688         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3689                                     COMP-3.
  3690         16  FILLER                PIC X(12).
  3691
  3692***************    OUTPUT FROM ELRAMT   *************************
  3693
  3694         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3697                                     COMP-3.
  3698         16  FILLER                PIC X(12).
  3699
  3700***************    OUTPUT FROM ELRATE   *************************
  3701
  3702         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3703                                     COMP-3.
  3704         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-MORTALITY-CODE     PIC X(4).
  3707         16  CP-RATE-EDIT-FLAG     PIC X.
  3708             88  CP-RATES-NEED-APR                  VALUE '1'.
  3709         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3712         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3713         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3714                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  70
* EL050.cbl
  3715         16  FILLER                PIC X(07).
  3716
  3717***************    OUTPUT FROM ELRFND   *************************
  3718
  3719         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-REFUND-TYPE-USED   PIC X.
  3722           88  CP-R-AS-R78                         VALUE '1'.
  3723           88  CP-R-AS-PRORATA                     VALUE '2'.
  3724           88  CP-R-AS-CALIF                       VALUE '3'.
  3725           88  CP-R-AS-TEXAS                       VALUE '4'.
  3726           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3727           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3728           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3729           88  CP-R-AS-MEAN                        VALUE '8'.
  3730           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3731           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3732           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3733           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3734           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3735           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3736         16  FILLER                PIC X(12).
  3737
  3738***************    OUTPUT FROM ELEARN   *************************
  3739
  3740         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3745                                     COMP-3.
  3746         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3747                                     COMP-3.
  3748         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3749                                     COMP-3.
  3750         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3751                                     COMP-3.
  3752         16  CP-EARNING-TYPE-USED  PIC X.
  3753           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3754           88  CP-E-AS-R78                         VALUE '1'.
  3755           88  CP-E-AS-PRORATA                     VALUE '2'.
  3756           88  CP-E-AS-TEXAS                       VALUE '4'.
  3757           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3758           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3759           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3760           88  CP-E-AS-MEAN                        VALUE '8'.
  3761           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3762         16  FILLER                PIC X(12).
  3763
  3764***************    OUTPUT FROM ELPMNT   *************************
  3765
  3766         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3769                                     COMP-3.
  3770         16  FILLER                PIC X(12).
  3771
  3772***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  71
* EL050.cbl
  3773         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3786             88  OPEN-RATE-FILE                   VALUE 'O'.
  3787             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3788             88  IO-ERROR                         VALUE 'E'.
  3789
  3790         16  CP-FIRST-PAY-DATE     PIC XX.
  3791
  3792         16  CP-JOINT-INDICATOR    PIC X.
  3793
  3794         16  CP-RESERVE-REMAINING-TERM
  3795                                   PIC S9(4)V9    VALUE ZERO
  3796                                     COMP-3.
  3797
  3798         16  CP-INSURED-BIRTH-DT   PIC XX.
  3799
  3800         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3801                                     COMP-3.
  3802
  3803         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3804                                     COMP-3.
  3805
  3806         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3807                                     COMP-3.
  3808
  3809         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3810                                     COMP-3.
  3811
  3812         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3813                                     COMP-3.
  3814
  3815         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3816                                     COMP-3.
  3817
  3818         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3819                                     COMP-3.
  3820
  3821         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3822             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3823
  3824         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3829         16  FILLER                PIC X(15).
  3830******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  72
* EL050.cbl
  3832******************************************************************
  3833*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3834*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3835*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3836*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3837*** MODIFICATION.                                              ***
  3838*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3839*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3840******************************************************************
  3841*    COPY ERCPNDB.
  3842******************************************************************
  3843*                                                                *
  3844*                                                                *
  3845*                            ERCPNDB.                            *
  3846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3847*                            VMOD=2.025                          *
  3848*                                                                *
  3849*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3850*                                                                *
  3851******************************************************************
  3852*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3853*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3854******************************************************************
  3855*                                                                *
  3856*                                                                *
  3857*   FILE TYPE = VSAM,KSDS                                        *
  3858*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3859*                                                                *
  3860*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3861*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3862*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3863*                                                 RKP=13,LEN=36  *
  3864*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3865*                                      AND CHG-SEQ.)             *
  3866*                                                RKP=49,LEN=11   *
  3867*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3868*                                      AND CHG-SEQ.)             *
  3869*                                                RKP=60,LEN=15   *
  3870*                                                                *
  3871*   LOG = NO                                                     *
  3872*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3873******************************************************************
  3874******************************************************************
  3875*                   C H A N G E   L O G
  3876*
  3877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3878*-----------------------------------------------------------------
  3879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3880* EFFECTIVE    NUMBER
  3881*-----------------------------------------------------------------
  3882* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3883* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3884* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3885* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3886* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3887* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3888* 032306                   PEMA  ADD BOW LOAN NUMBER
  3889* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  73
* EL050.cbl
  3890* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3891* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3892* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3893* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3894* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3895* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3896* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3897******************************************************************
  3898
  3899 01  PENDING-BUSINESS.
  3900     12  PB-RECORD-ID                     PIC XX.
  3901         88  VALID-PB-ID                        VALUE 'PB'.
  3902
  3903     12  PB-CONTROL-PRIMARY.
  3904         16  PB-COMPANY-CD                PIC X.
  3905         16  PB-ENTRY-BATCH               PIC X(6).
  3906         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3907         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3908
  3909     12  PB-CONTROL-BY-ACCOUNT.
  3910         16  PB-COMPANY-CD-A1             PIC X.
  3911         16  PB-CARRIER                   PIC X.
  3912         16  PB-GROUPING.
  3913             20  PB-GROUPING-PREFIX       PIC XXX.
  3914             20  PB-GROUPING-PRIME        PIC XXX.
  3915         16  PB-STATE                     PIC XX.
  3916         16  PB-ACCOUNT.
  3917             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3918             20  PB-ACCOUNT-PRIME         PIC X(6).
  3919         16  PB-CERT-EFF-DT               PIC XX.
  3920         16  PB-CERT-NO.
  3921             20  PB-CERT-PRIME            PIC X(10).
  3922             20  PB-CERT-SFX              PIC X.
  3923         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3924
  3925         16  PB-RECORD-TYPE               PIC X.
  3926             88  PB-MAILING-DATA                VALUE '0'.
  3927             88  PB-ISSUE                       VALUE '1'.
  3928             88  PB-CANCELLATION                VALUE '2'.
  3929             88  PB-BATCH-TRAILER               VALUE '9'.
  3930
  3931     12  PB-CONTROL-BY-ORIG-BATCH.
  3932         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3933         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3934         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3935         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3936
  3937     12  PB-CONTROL-BY-CSR.
  3938         16  PB-CSR-COMPANY-CD            PIC X.
  3939         16  PB-CSR-ID                    PIC X(4).
  3940         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3941         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3942         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3943******************************************************************
  3944*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3945******************************************************************
  3946
  3947     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  74
* EL050.cbl
  3948     12  PB-LAST-MAINT-BY                 PIC X(4).
  3949     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3950
  3951     12  PB-RECORD-BODY                   PIC X(375).
  3952
  3953     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3954         16  PB-CERT-ORIGIN               PIC X.
  3955             88  CLASIC-CREATED-CERT         VALUE '1'.
  3956         16  PB-I-NAME.
  3957             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3958             20  PB-I-INSURED-FIRST-NAME.
  3959                 24  PB-I-INSURED-1ST-INIT PIC X.
  3960                 24  FILLER                PIC X(9).
  3961             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3962         16  PB-I-AGE                     PIC S99   COMP-3.
  3963         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3964         16  PB-I-BIRTHDAY                PIC XX.
  3965         16  PB-I-INSURED-SEX             PIC X.
  3966             88  PB-SEX-MALE     VALUE 'M'.
  3967             88  PB-SEX-FEMALE   VALUE 'F'.
  3968
  3969         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3970         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3971         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3972         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3973         16  PB-I-SKIP-CODE               PIC X.
  3974             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3975             88  PB-SKIP-JULY              VALUE '1'.
  3976             88  PB-SKIP-AUGUST            VALUE '2'.
  3977             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3978             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3979             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3980             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3981             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3982             88  PB-SKIP-JUNE              VALUE '8'.
  3983             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3984             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3985             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3986         16  PB-I-TERM-TYPE               PIC X.
  3987             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3988             88  PB-PAID-WEEKLY            VALUE 'W'.
  3989             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3990             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3991             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3992         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3993         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3994         16  PB-I-DATA-ENTRY-SW           PIC X.
  3995             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3996             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3997             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3998             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3999         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4000         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4001*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4002         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4003         16  FILLER                       PIC X.
  4004
  4005         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  75
* EL050.cbl
  4006             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4007             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4008                                                   '90' THRU '99'.
  4009         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4010                                          PIC XX.
  4011         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4012         16  PB-I-AMOUNT-FINANCED REDEFINES
  4013                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4014         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4015         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4016                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4017         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4018         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4019         16  PB-I-CLP-AMOUNT REDEFINES
  4020                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4021         16  PB-I-LF-CALC-FLAG            PIC X.
  4022             88 PB-COMP-LF-PREM               VALUE '?'.
  4023         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4024         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4025         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4026         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4027         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4028         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4029         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4030         16  PB-I-LF-ABBR                 PIC XXX.
  4031         16  PB-I-LF-INPUT-CD             PIC XX.
  4032
  4033         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4034             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4035             88  PB-INVALID-AH               VALUE '  ' '00'
  4036                                                   '90' THRU '99'.
  4037         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4038         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4039         16  PB-I-AH-CALC-FLAG            PIC X.
  4040             88 PB-COMP-AH-PREM                  VALUE '?'.
  4041         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4042         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4043         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4044         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4045         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4046         16  PB-I-AH-ABBR                 PIC XXX.
  4047         16  PB-I-AH-INPUT-CD             PIC XXX.
  4048
  4049         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4050         16  PB-I-REIN-TABLE              PIC XXX.
  4051         16  PB-I-BUSINESS-TYPE           PIC 99.
  4052         16  PB-I-INDV-GRP-CD             PIC X.
  4053         16  PB-I-MORT-CODE.
  4054             20  PB-I-TABLE               PIC X.
  4055             20  PB-I-INTEREST            PIC XX.
  4056             20  PB-I-MORT-TYP            PIC X.
  4057         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4058         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4059         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4060         16  PB-I-INDV-GRP-OVRD           PIC X.
  4061         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4062         16  PB-I-SIG-SW                  PIC X.
  4063             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  76
* EL050.cbl
  4064         16  PB-I-RATE-CLASS              PIC XX.
  4065         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4066         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4067         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4068         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4069         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4070         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4071         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4072         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4073         16  PB-I-OB-FLAG                 PIC X.
  4074             88  PB-I-OB                      VALUE 'B'.
  4075             88  PB-I-SUMMARY                 VALUE 'Z'.
  4076         16  PB-I-ENTRY-STATUS            PIC X.
  4077             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4078                                              'M' '5' '9' '2'.
  4079             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4080             88  PB-I-POLICY-PENDING          VALUE '2'.
  4081             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4082             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4083             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4084             88  PB-I-REIN-ONLY               VALUE '9'.
  4085             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4086             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4087             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4088             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4089         16  PB-I-INT-CODE                PIC X.
  4090             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4091             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4092         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4093         16  PB-I-SOC-SEC-NO              PIC X(11).
  4094         16  PB-I-MEMBER-NO               PIC X(12).
  4095         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4096*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4097         16  PB-I-OLD-LOF                 PIC XXX.
  4098         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4099         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4100         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4101         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4102         16  PB-I-LIFE-INDICATOR          PIC X.
  4103             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4104         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4105         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4106                                          PIC S9(5)V99    COMP-3.
  4107         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4108             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4109             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4110         16  PB-I-1ST-PMT-DT              PIC XX.
  4111         16  PB-I-JOINT-INSURED.
  4112             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4113             20 PB-I-JOINT-FIRST-NAME.
  4114                24  PB-I-JOINT-FIRST-INIT PIC X.
  4115                24  FILLER                PIC X(9).
  4116             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4117*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4118         16  PB-I-BENEFICIARY-NAME.
  4119             20  PB-I-BANK-NUMBER         PIC X(10).
  4120             20  FILLER                   PIC X(15).
  4121         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  77
* EL050.cbl
  4122         16  PB-I-REFERENCE               PIC X(12).
  4123         16  FILLER REDEFINES PB-I-REFERENCE.
  4124             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4125             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4126             20  PB-I-CLP-STATE           PIC XX.
  4127         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4128             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4129             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4130             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4131         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4132         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4133         16  PB-I-RESIDENT-STATE          PIC XX.
  4134         16  PB-I-RATE-CODE               PIC X(4).
  4135         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4136         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4137         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4138         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4139         16  PB-I-BANK-NOCHRGB            PIC 99.
  4140         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4141         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4142
  4143     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4144         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4145             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4146         16  PB-C-CANCEL-ORIGIN           PIC X.
  4147             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4148         16  PB-C-LF-CANCEL-DT            PIC XX.
  4149         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4150         16  PB-C-LF-CALC-REQ             PIC X.
  4151             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4152         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4153         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4154         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4155             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4156         16  PB-C-AH-CANCEL-DT            PIC XX.
  4157         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4158         16  PB-C-AH-CALC-REQ             PIC X.
  4159             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4160         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4161         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4162         16  PB-C-LAST-NAME               PIC X(15).
  4163         16  PB-C-REFUND-SW               PIC X.
  4164             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4165             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4166         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4167         16  PB-C-PAYEE-CODE              PIC X(6).
  4168         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4169         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4170         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4171         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4172         16  PB-C-REFERENCE               PIC X(12).
  4173         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4174         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4175         16  PB-C-POST-CARD-IND           PIC X.
  4176         16  PB-C-CANCEL-REASON           PIC X.
  4177         16  PB-C-REF-INTERFACE-SW        PIC X.
  4178         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4179         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  78
* EL050.cbl
  4180         16  FILLER                       PIC X(01).
  4181*        16  FILLER                       PIC X(18).
  4182         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4183*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4184         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4185         16  PB-CANCELED-CERT-DATA.
  4186             20  PB-CI-INSURED-NAME.
  4187                 24  PB-CI-LAST-NAME      PIC X(15).
  4188                 24  PB-CI-INITIALS       PIC XX.
  4189             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4190             20  PB-CI-INSURED-SEX        PIC X.
  4191             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4192             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4193             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4194             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4195             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4196             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4197             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4198             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4199             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4200             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4201             20  PB-CI-RATE-CLASS         PIC XX.
  4202             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4203             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4204             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4205             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4206             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4207             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4208             20  PB-CI-LF-ABBR            PIC X(3).
  4209             20  PB-CI-AH-ABBR            PIC X(3).
  4210             20  PB-CI-OB-FLAG            PIC X.
  4211                 88  PB-CI-OB                VALUE 'B'.
  4212             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4213                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4214                                           'M' '4' '5' '9' '2'.
  4215                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4216                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4217                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4218                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4219                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4220                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4221                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4222                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4223                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4224                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4225                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4226                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4227             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4228                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4229                                           'M' '4' '5' '9' '2'.
  4230                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4231                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4232                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4233                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4234                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4235                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4236                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4237                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  79
* EL050.cbl
  4238                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4239                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4240                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4241                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4242             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4243             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4244             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4245             20  PB-CI-MEMBER-NO          PIC X(12).
  4246             20  PB-CI-INT-CODE           PIC X.
  4247                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4248                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4249             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4250             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4251             20  PB-CI-COMP-EXCP-SW       PIC X.
  4252                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4253                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4254             20  PB-CI-ENTRY-STATUS       PIC X.
  4255             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4256             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4257             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4258             20  PB-CI-DEATH-DT           PIC XX.
  4259             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4260             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4261             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4262             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4263             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4264             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4265             20  PB-CI-ENTRY-DT              PIC XX.
  4266             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4267             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4268             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4269             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4270             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4271             20  PB-CI-OLD-LOF               PIC XXX.
  4272*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4273             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4274             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4275             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4276             20  PB-CI-INDV-GRP-CD           PIC X.
  4277             20  PB-CI-BENEFICIARY-NAME.
  4278                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4279                 24  FILLER                  PIC X(15).
  4280             20  PB-CI-NOTE-SW               PIC X.
  4281             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4282             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4283             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4284             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4285             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4286             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4287             20  PB-CI-FIRST-NAME            PIC X(10).
  4288             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4289
  4290         16  FILLER                       PIC X(13).
  4291*032306  16  FILLER                       PIC X(27).
  4292*        16  FILLER                       PIC X(46).
  4293
  4294     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4295         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  80
* EL050.cbl
  4296         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4297         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4298         16  PB-M-INSURED-MID-INIT        PIC X.
  4299         16  PB-M-INSURED-AGE             PIC 99.
  4300         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4301         16  PB-M-INSURED-SEX             PIC X.
  4302         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4303         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4304         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4305         16  PB-M-INSURED-CITY-STATE.
  4306             20  PB-M-INSURED-CITY        PIC X(28).
  4307             20  PB-M-INSURED-STATE       PIC XX.
  4308         16  PB-M-INSURED-ZIP-CODE.
  4309             20  PB-M-INSURED-ZIP-PRIME.
  4310                 24  PB-M-INSURED-ZIP-1   PIC X.
  4311                     88  PB-M-CANADIAN-POST-CODE
  4312                                             VALUE 'A' THRU 'Z'.
  4313                 24  FILLER               PIC X(4).
  4314             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4315         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4316                                        PB-M-INSURED-ZIP-CODE.
  4317             20  PM-M-INS-CAN-POST1       PIC XXX.
  4318             20  PM-M-INS-CAN-POST2       PIC XXX.
  4319             20  FILLER                   PIC XXX.
  4320         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4321         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4322         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4323         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4324         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4325         16  PB-M-CRED-BENE-CITYST.
  4326             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4327             20  PB-M-CRED-BENE-STATE     PIC XX.
  4328         16  FILLER                       PIC X(92).
  4329
  4330     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4331         16  FILLER                       PIC X(10).
  4332         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4333         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4334         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4335         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4336         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4337         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4338         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4339         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4340         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4341         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4342         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4343         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4344         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4345         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4346         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4347         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4348         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4349         16  PB-ACCOUNT-NAME              PIC X(30).
  4350         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4351         16  PB-REFERENCE                 PIC X(12).
  4352         16  PB-B-RECEIVED-DT             PIC XX.
  4353         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  81
* EL050.cbl
  4354
  4355     12  PB-RECORD-STATUS.
  4356         16  PB-CREDIT-SELECT-DT          PIC XX.
  4357         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4358         16  PB-BILLED-DT                 PIC XX.
  4359         16  PB-BILLING-STATUS            PIC X.
  4360             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4361             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4362             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4363         16  PB-RECORD-BILL               PIC X.
  4364             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4365             88  PB-RECORD-RETURNED           VALUE 'R'.
  4366             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4367             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4368             88  PB-OVERRIDE-AH               VALUE 'A'.
  4369             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4370         16  PB-BATCH-ENTRY               PIC X.
  4371             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4372             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4373             88  PB-REISSUED-CERT             VALUE 'E'.
  4374             88  PB-MONTHLY-CERT              VALUE 'M'.
  4375             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4376             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4377             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4378         16  PB-FORCE-CODE                PIC X.
  4379             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4380             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4381             88  PB-CANCEL-FORCE              VALUE '8'.
  4382             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4383             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4384             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4385             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4386             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4387             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4388             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4389         16  PB-FATAL-FLAG                PIC X.
  4390             88  PB-FATAL-ERRORS              VALUE 'X'.
  4391         16  PB-FORCE-ER-CD               PIC X.
  4392             88  PB-FORCE-ERRORS              VALUE 'F'.
  4393             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4394         16  PB-WARN-ER-CD                PIC X.
  4395             88  PB-WARNING-ERRORS            VALUE 'W'.
  4396         16  FILLER                       PIC X.
  4397         16  PB-OUT-BAL-CD                PIC X.
  4398             88  PB-OUT-OF-BAL                VALUE 'O'.
  4399         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4400         16  PB-AH-OVERRIDE-L1            PIC X.
  4401         16  PB-INPUT-DT                  PIC XX.
  4402         16  PB-INPUT-BY                  PIC X(4).
  4403         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4404         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4405         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4406         16  PB-LF-EARNING-METHOD         PIC X.
  4407         16  PB-AH-EARNING-METHOD         PIC X.
  4408         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4409         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4410         16  PB-REIN-CD                   PIC XXX.
  4411         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  82
* EL050.cbl
  4412         16  PB-AH-REFUND-TYPE            PIC X.
  4413         16  PB-ACCT-EFF-DT               PIC XX.
  4414         16  PB-ACCT-EXP-DT               PIC XX.
  4415         16  PB-COMPANY-ID                PIC X(3).
  4416         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4417         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4418         16  PB-SV-CARRIER                PIC X.
  4419         16  PB-SV-GROUPING               PIC X(6).
  4420         16  PB-SV-STATE                  PIC XX.
  4421         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4422         16  PB-GA-BILLING-INFO.
  4423             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4424                                          PIC XX.
  4425         16  PB-SV-REMIT-TO  REDEFINES
  4426             PB-GA-BILLING-INFO           PIC X(10).
  4427         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4428         16  PB-I-LOAN-OFFICER            PIC X(5).
  4429         16  PB-I-VIN                     PIC X(17).
  4430
  4431         16  FILLER                       PIC X(04).
  4432         16  IMNET-BYPASS-SW              PIC X.
  4433
  4434******************************************************************
  4435*                COMMON EDIT ERRORS                              *
  4436******************************************************************
  4437
  4438     12  PB-COMMON-ERRORS.
  4439         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4440                                           PIC S9(4)     COMP.
  4441
  4442******************************************************************
  4443
  4444* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4445*    COPY ELC50W1.
  4446******************************************************************
  4447*                                                                *
  4448*                                                                *
  4449*                             ELC50W1                            *
  4450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4451*                            VMOD=2.004                          *
  4452*                                                                *
  4453*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4454*                                                                *
  4455*                                                                *
  4456******************************************************************
  4457
  4458     12  WK-WORK-AREA.
  4459         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4460         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4461         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4462         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4463         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4464         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4465         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4466         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4467         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4468         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4469         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  83
* EL050.cbl
  4470         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4471         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4472         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4473         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4474         16  WK-CREDIT-EDIT-CONTROLS.
  4475             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4476             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4477             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4478             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4479             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4480             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4481         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4482         16  WK-SAVE-REIN-DATA.
  4483             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4484             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4485             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4486         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4487             88  ENTRY-FROM-EL6311       VALUE '6'.
  4488         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4489         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4490     12  WK-RECORD-ADDRESSES.
  4491         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4492         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4493         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4494         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4495         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4496         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4497         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4498         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4499     12  WK-OVER-SHORT-AREA.
  4500         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4501         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4502         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4503             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4504         16  FILLER                   PIC X(5) VALUE SPACES.
  4505
  4506*    COPY ELCEDITC.
  4507******************************************************************
  4508*                                                                *
  4509*                                                                *
  4510*                            ELCEDITC                            *
  4511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4512*                            VMOD=2.012                          *
  4513*                                                                *
  4514*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4515*                     EL6313, EL050 AND EL517.                   *
  4516*                                                                *
  4517******************************************************************
  4518******************************************************************
  4519*                   C H A N G E   L O G
  4520*
  4521* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4522*-----------------------------------------------------------------
  4523*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4524* EFFECTIVE    NUMBER
  4525*-----------------------------------------------------------------
  4526* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4527******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  84
* EL050.cbl
  4528
  4529     12  EDIT-CRITERIA-DATA.
  4530         16  EC-CO-MONTH-END-DT       PIC XX.
  4531         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4532         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4533         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4534         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4535         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4536         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4537         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4538         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4539         16  EC-CO-REM-TERM-CALC      PIC X.
  4540               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4541               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4542               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4543               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4544
  4545         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4546               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4547               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4548               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4549               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4550               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4551               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4552               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4553               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4554               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4555               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4556
  4557         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4558               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4559               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4560               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4561               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4562               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4563               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4564               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4565               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4566
  4567         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4568                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4569                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4570
  4571         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4572                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4573                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4574                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4575                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4576                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4577                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4578                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4579                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4580
  4581         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4582               88  EC-BR-REDUCING                   VALUE 'R'.
  4583               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4584
  4585         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  85
* EL050.cbl
  4586         16  EC-BR-LF-DESC             PIC X(10).
  4587         16  EC-BR-AH-DESC             PIC X(10).
  4588         16  EC-BR-LF-COMMENT          PIC X(10).
  4589         16  EC-BR-AH-COMMENT          PIC X(10).
  4590
  4591         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4592               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4593               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4594               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4595               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4596
  4597         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4598               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4599               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4600               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4601               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4602
  4603         16  EC-BR-LF-REFUND-CALC      PIC X.
  4604                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4605                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4606                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4607                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4608                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4609                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4610                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4611
  4612         16  EC-BR-AH-REFUND-CALC      PIC X.
  4613                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4614                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4615                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4616                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4617                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4618                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4619                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4620                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4621
  4622         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4623                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4624                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4625                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4626
  4627         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4628                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4629                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4630                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4631
  4632         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4633         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4634         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4636
  4637         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4638         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4639                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4640                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4641                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4642                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4643
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  86
* EL050.cbl
  4644         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4645               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4646               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4647               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4648               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4649               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4650
  4651         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4652               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4653               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4654               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4655               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4656               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4657
  4658         16  EC-ST-LF-REFUND-CALC      PIC X.
  4659                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4667
  4668         16  EC-ST-AH-REFUND-CALC      PIC X.
  4669                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4670                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4671                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4672                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4673                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4674                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4675                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4676                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4677
  4678         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4679         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4680         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4681         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4682         16  EC-AM-EXPIRATION-DT       PIC XX.
  4683         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4684         16  EC-AM-CLASS-CD            PIC XX.
  4685         16  EC-AM-LF-DEVIATION        PIC XXX.
  4686         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4687         16  EC-AM-AH-DEVIATION        PIC XXX.
  4688         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4689         16  EC-AM-PHONE-NO            PIC X(10).
  4690
  4691         16  EC-AM-LF-REFUND-CALC      PIC X.
  4692                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4693                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4694                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4695                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4696                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4697                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4698                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4699
  4700         16  EC-AM-AH-REFUND-CALC      PIC X.
  4701                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  87
* EL050.cbl
  4702                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4703                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4704                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4705                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4706                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4707                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4708
  4709         16  EC-AM-BEN-I-G-CD          PIC X.
  4710                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4711                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4712                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4713
  4714         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4723
  4724         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4725         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4726         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4727         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4728         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4729         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4730         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4731         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4732         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4733         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4734         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4735         16  EC-RT-LF-NSP-ST           PIC XX.
  4736         16  EC-RT-AH-NSP-ST           PIC XX.
  4737         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4738         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4739
  4740         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4741             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4742                                             'M' '5' '9' '2'.
  4743             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4744             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4745             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4746             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4747             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4748             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4749             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4750             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4751             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4752             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4753
  4754         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4755             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4756                                             'M' '5' '9' '2'.
  4757             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4758             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4759             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  88
* EL050.cbl
  4760             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4761             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4762             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4763             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4764             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4765             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4766             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4767
  4768         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4769         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4770         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4771         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4772         16  EC-CM-DEATH-DT            PIC XX.
  4773
  4774*DMD CUSTOM CODING FIELDS BELOW
  4775*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4776         16  EC-BR-DMD-RATING-SW       PIC X.
  4777                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4778                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4779                 88  NO-DMD-RATING               VALUE 'N'.
  4780
  4781         16  EC-NEW-CERT               PIC X(11).
  4782         16  EC-NEW-STATE              PIC XX.
  4783         16  FILLER                    PIC X.
  4784*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4785         16  OVER-SHORT-EDIT-FIELDS.
  4786             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4787             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4788             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4789             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4790             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4791             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4792             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4793             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4794             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4795         16  FILLER                    PIC X(71).
  4796******************************************************************
  4797
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  89
* EL050.cbl
  4799*    COPY ELCDIFRD.
  4800******************************************************************
  4801*                                                                *
  4802*                                                                *
  4803*                            ELCDIFRD.                           *
  4804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4805*                            VMOD=2.004                          *
  4806*                                                                *
  4807*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4808*                                                                *
  4809******************************************************************
  4810*
  4811  01  WS-DIFFERENCE-CALCULATION.
  4812        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4813        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4814        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4815        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4816        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4817        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4818        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4819        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4820        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4821        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4822        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4823
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  90
* EL050.cbl
  4825****************************************************************
  4826*
  4827* Copyright (c) 2007 by Clerity Solutions, Inc.
  4828* All rights reserved.
  4829*
  4830****************************************************************
  4831 01  DFHEIV.
  4832   02  DFHEIV0               PIC X(35).
  4833   02  DFHEIV1               PIC X(08).
  4834   02  DFHEIV2               PIC X(08).
  4835   02  DFHEIV3               PIC X(08).
  4836   02  DFHEIV4               PIC X(06).
  4837   02  DFHEIV5               PIC X(04).
  4838   02  DFHEIV6               PIC X(04).
  4839   02  DFHEIV7               PIC X(02).
  4840   02  DFHEIV8               PIC X(02).
  4841   02  DFHEIV9               PIC X(01).
  4842   02  DFHEIV10              PIC S9(7) COMP-3.
  4843   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4844   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4845   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4846   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4847   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4848   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV17              PIC X(04).
  4850   02  DFHEIV18              PIC X(04).
  4851   02  DFHEIV19              PIC X(04).
  4852   02  DFHEIV20              USAGE IS POINTER.
  4853   02  DFHEIV21              USAGE IS POINTER.
  4854   02  DFHEIV22              USAGE IS POINTER.
  4855   02  DFHEIV23              USAGE IS POINTER.
  4856   02  DFHEIV24              USAGE IS POINTER.
  4857   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4858   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4859   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4860   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4861   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4862   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4863   02  FILLER                PIC X(02).
  4864   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4865   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4866   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4867   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4868   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4869 LINKAGE  SECTION.
  4870*****************************************************************
  4871*                                                               *
  4872* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4873* All rights reserved.                                          *
  4874*                                                               *
  4875*****************************************************************
  4876 01  dfheiblk.
  4877     02  eibtime          pic s9(7) comp-3.
  4878     02  eibdate          pic s9(7) comp-3.
  4879     02  eibtrnid         pic x(4).
  4880     02  eibtaskn         pic s9(7) comp-3.
  4881     02  eibtrmid         pic x(4).
  4882     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  91
* EL050.cbl
  4883     02  eibcposn         pic s9(4) comp.
  4884     02  eibcalen         pic s9(4) comp.
  4885     02  eibaid           pic x(1).
  4886     02  eibfiller1       pic x(1).
  4887     02  eibfn            pic x(2).
  4888     02  eibfiller2       pic x(2).
  4889     02  eibrcode         pic x(6).
  4890     02  eibfiller3       pic x(2).
  4891     02  eibds            pic x(8).
  4892     02  eibreqid         pic x(8).
  4893     02  eibrsrce         pic x(8).
  4894     02  eibsync          pic x(1).
  4895     02  eibfree          pic x(1).
  4896     02  eibrecv          pic x(1).
  4897     02  eibsend          pic x(1).
  4898     02  eibatt           pic x(1).
  4899     02  eibeoc           pic x(1).
  4900     02  eibfmh           pic x(1).
  4901     02  eibcompl         pic x(1).
  4902     02  eibsig           pic x(1).
  4903     02  eibconf          pic x(1).
  4904     02  eiberr           pic x(1).
  4905     02  eibrldbk         pic x(1).
  4906     02  eiberrcd         pic x(4).
  4907     02  eibsynrb         pic x(1).
  4908     02  eibnodat         pic x(1).
  4909     02  eibfiller5       pic x(2).
  4910     02  eibresp          pic 9(09) comp.
  4911     02  eibresp2         pic 9(09) comp.
  4912     02  dfheigdj         pic s9(4) comp.
  4913     02  dfheigdk         pic s9(4) comp.
  4914
  4915 01  DFHCOMMAREA                   PIC X(1036).
  4916
  4917*01 PARMLIST .
  4918*    02  FILLER                    PIC S9(8)   COMP.
  4919*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4920*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4921*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4922*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4923*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4924*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4925*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4926
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  92
* EL050.cbl
  4928*    COPY ELCCNTL.
  4929******************************************************************
  4930*                                                                *
  4931*                                                                *
  4932*                            ELCCNTL.                            *
  4933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4934*                            VMOD=2.059                          *
  4935*                                                                *
  4936*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4937*                                                                *
  4938*   FILE TYPE = VSAM,KSDS                                        *
  4939*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4940*                                                                *
  4941*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4942*       ALTERNATE INDEX = NONE                                   *
  4943*                                                                *
  4944*   LOG = YES                                                    *
  4945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4946******************************************************************
  4947*                   C H A N G E   L O G
  4948*
  4949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4950*-----------------------------------------------------------------
  4951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4952* EFFECTIVE    NUMBER
  4953*-----------------------------------------------------------------
  4954* 082503                   PEMA  ADD BENEFIT GROUP
  4955* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4956* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4957* 092705    2005050300006  PEMA  ADD SPP LEASES
  4958* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4959* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4960* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4961* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4962* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4963* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4964* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4965* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4966* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4967******************************************************************
  4968*
  4969 01  CONTROL-FILE.
  4970     12  CF-RECORD-ID                       PIC XX.
  4971         88  VALID-CF-ID                        VALUE 'CF'.
  4972
  4973     12  CF-CONTROL-PRIMARY.
  4974         16  CF-COMPANY-ID                  PIC XXX.
  4975         16  CF-RECORD-TYPE                 PIC X.
  4976             88  CF-COMPANY-MASTER              VALUE '1'.
  4977             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4978             88  CF-STATE-MASTER                VALUE '3'.
  4979             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4980             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4981             88  CF-CARRIER-MASTER              VALUE '6'.
  4982             88  CF-MORTALITY-MASTER            VALUE '7'.
  4983             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4984             88  CF-TERMINAL-MASTER             VALUE '9'.
  4985             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  93
* EL050.cbl
  4986             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4987             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4988             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4989             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4990             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4991             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4992             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4993             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4994         16  CF-ACCESS-CD-GENL              PIC X(4).
  4995         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4996             20  CF-PROCESSOR               PIC X(4).
  4997         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4998             20  CF-STATE-CODE              PIC XX.
  4999             20  FILLER                     PIC XX.
  5000         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5001             20  FILLER                     PIC XX.
  5002             20  CF-HI-BEN-IN-REC           PIC XX.
  5003         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5004             20  FILLER                     PIC XXX.
  5005             20  CF-CARRIER-CNTL            PIC X.
  5006         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5007             20  FILLER                     PIC XX.
  5008             20  CF-HI-TYPE-IN-REC          PIC 99.
  5009         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5010             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5011                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5012             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5013             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5014         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5015             20  FILLER                     PIC X.
  5016             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5017         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5018             20  FILLER                     PIC XX.
  5019             20  CF-MORTGAGE-PLAN           PIC XX.
  5020         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5021
  5022     12  CF-LAST-MAINT-DT                   PIC XX.
  5023     12  CF-LAST-MAINT-BY                   PIC X(4).
  5024     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5025
  5026     12  CF-RECORD-BODY                     PIC X(728).
  5027
  5028
  5029****************************************************************
  5030*             COMPANY MASTER RECORD                            *
  5031****************************************************************
  5032
  5033     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5034         16  CF-COMPANY-ADDRESS.
  5035             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5036             20  CF-CL-IN-CARE-OF           PIC X(30).
  5037             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5038             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5039             20  CF-CL-CITY-STATE           PIC X(30).
  5040             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5041             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5042         16  CF-COMPANY-CD                  PIC X.
  5043         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  94
* EL050.cbl
  5044         16  CF-SECURITY-OPTION             PIC X.
  5045             88  ALL-SECURITY                   VALUE '1'.
  5046             88  COMPANY-VERIFY                 VALUE '2'.
  5047             88  PROCESSOR-VERIFY               VALUE '3'.
  5048             88  NO-SECURITY                    VALUE '4'.
  5049             88  ALL-BUT-TERM                   VALUE '5'.
  5050         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5051             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5052         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5053             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5054         16  CF-INFORCE-LOCATION            PIC X.
  5055             88  CERTS-ARE-ONLINE               VALUE '1'.
  5056             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5057             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5058         16  CF-LOWER-CASE-LETTERS          PIC X.
  5059         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5060             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5061             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5062             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5063             88  CF-ACCNT-CNTL                  VALUE '3'.
  5064             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5065
  5066         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5067         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5068
  5069         16  CF-LGX-CREDIT-USER             PIC X.
  5070             88  CO-IS-NOT-USER                 VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5072
  5073         16 CF-CREDIT-CALC-CODES.
  5074             20  CF-CR-REM-TERM-CALC PIC X.
  5075               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5076               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5077               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5078               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5079               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5080               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5081               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5082             20  CF-CR-R78-METHOD           PIC X.
  5083               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5084               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5085
  5086         16  CF-CLAIM-CONTROL-COUNTS.
  5087             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5088                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5089
  5090             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5091                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5092
  5093             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5094                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5095
  5096             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5097                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5098
  5099         16  CF-CURRENT-MONTH-END           PIC XX.
  5100
  5101         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  95
* EL050.cbl
  5102             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5103             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5104             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5105             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5106                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5107                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5108             20  CF-CO-PREM-REJECT-SW       PIC X.
  5109                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5110                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5111             20  CF-CO-REF-REJECT-SW        PIC X.
  5112                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5113                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5114
  5115         16  CF-CO-REPORTING-DT             PIC XX.
  5116         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5117         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5118           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5119           88  CF-CO-MONTH-END                  VALUE '1'.
  5120
  5121         16  CF-LGX-CLAIM-USER              PIC X.
  5122             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5123             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5124
  5125         16  CF-CREDIT-EDIT-CONTROLS.
  5126             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5127             20  CF-MIN-AGE                 PIC 99.
  5128             20  CF-DEFAULT-AGE             PIC 99.
  5129             20  CF-MIN-TERM                PIC S999      COMP-3.
  5130             20  CF-MAX-TERM                PIC S999      COMP-3.
  5131             20  CF-DEFAULT-SEX             PIC X.
  5132             20  CF-JOINT-AGE-INPUT         PIC X.
  5133                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5134             20  CF-BIRTH-DATE-INPUT        PIC X.
  5135                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5136             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5137                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5138                 88  CF-ZERO-CARRIER            VALUE '1'.
  5139                 88  CF-ZERO-GROUPING           VALUE '2'.
  5140                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5141             20  CF-EDIT-SW                 PIC X.
  5142                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5143             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5144             20  CF-CR-PR-METHOD            PIC X.
  5145               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5146               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5147             20  FILLER                     PIC X.
  5148
  5149         16  CF-CREDIT-MISC-CONTROLS.
  5150             20  CF-REIN-TABLE-SW           PIC X.
  5151                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5152             20  CF-COMP-TABLE-SW           PIC X.
  5153                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5154             20  CF-EXPERIENCE-RETENTION-AGE
  5155                                            PIC S9        COMP-3.
  5156             20  CF-CONVERSION-DT           PIC XX.
  5157             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5158             20  CF-RUN-FREQUENCY-SW        PIC X.
  5159                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  96
* EL050.cbl
  5160                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5161
  5162             20  CF-CR-CHECK-NO-CONTROL.
  5163                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5164                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5165                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5166                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5167                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5168                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5169
  5170                 24  CF-CR-CHECK-COUNT       REDEFINES
  5171                     CF-CR-CHECK-COUNTER      PIC X(4).
  5172
  5173                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5174                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5175
  5176                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5177                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5178                 24  CF-MAIL-PROCESSING       PIC X.
  5179                     88  MAIL-PROCESSING          VALUE 'Y'.
  5180
  5181         16  CF-MISC-SYSTEM-CONTROL.
  5182             20  CF-SYSTEM-C                 PIC X.
  5183                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5184             20  CF-SYSTEM-D                 PIC X.
  5185                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5186             20  CF-SOC-SEC-NO-SW            PIC X.
  5187                 88  SOC-SEC-NO-USED             VALUE '1'.
  5188             20  CF-MEMBER-NO-SW             PIC X.
  5189                 88  MEMBER-NO-USED              VALUE '1'.
  5190             20  CF-TAX-ID-NUMBER            PIC X(11).
  5191             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5192             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5193                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5194                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5195                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5196                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5197             20  CF-SYSTEM-E                 PIC X.
  5198                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5199
  5200         16  CF-LGX-LIFE-USER               PIC X.
  5201             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5202             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5203
  5204         16  CF-CR-MONTH-END-DT             PIC XX.
  5205
  5206         16  CF-FILE-MAINT-DATES.
  5207             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5208                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5209             20  CF-LAST-BATCH       REDEFINES
  5210                 CF-LAST-BATCH-NO               PIC X(4).
  5211             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5212             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5213             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5214             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5215             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5216             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5217             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  97
* EL050.cbl
  5218             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5219             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5220             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5221
  5222         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5223         16  FILLER                         PIC X.
  5224
  5225         16  CF-ALT-MORT-CODE               PIC X(4).
  5226         16  CF-MEMBER-CAPTION              PIC X(10).
  5227
  5228         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5229             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5230             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5231             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5232             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5233             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5234
  5235         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5236
  5237         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5238         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5239         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5240         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5241
  5242         16  CF-AH-OVERRIDE-L1              PIC X.
  5243         16  CF-AH-OVERRIDE-L2              PIC XX.
  5244         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5245         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5246
  5247         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5248         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5249
  5250         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5251         16  CF-AR-LAST-EL860-DT            PIC XX.
  5252         16  CF-MP-MONTH-END-DT             PIC XX.
  5253
  5254         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5255         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5256             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5257
  5258         16  CF-AR-MONTH-END-DT             PIC XX.
  5259
  5260         16  CF-CRDTCRD-USER                PIC X.
  5261             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5262             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5263
  5264         16  CF-CC-MONTH-END-DT             PIC XX.
  5265
  5266         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5267
  5268         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5269             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5270             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5271             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5272         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5273         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5274         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5275         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  98
* EL050.cbl
  5276             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5277             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5278         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5279         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5280         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5281             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5282         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5283
  5284         16  CF-CL-ZIP-CODE.
  5285             20  CF-CL-ZIP-PRIME.
  5286                 24  CF-CL-ZIP-1ST          PIC X.
  5287                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5288                 24  FILLER                 PIC X(4).
  5289             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5290         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5291             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5292             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5293             20  FILLER                     PIC XXX.
  5294
  5295         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5296         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5297         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5298         16  CF-CO-OPTION-START-DATE        PIC XX.
  5299         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5300           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5301                                                      '3' '4'.
  5302           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5303           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5304           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5305           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5306           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5307           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5308
  5309         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5310
  5311         16  CF-PAYMENT-APPROVAL-LEVELS.
  5312             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5313             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5314             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5315             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5316             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5317             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5318
  5319         16  CF-END-USER-REPORTING-USER     PIC X.
  5320             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5321             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5322
  5323         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5324             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5325             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5326
  5327         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5328
  5329         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5330         16  FILLER                         PIC X.
  5331
  5332         16  CF-CREDIT-ARCHIVE-CNTL.
  5333             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page  99
* EL050.cbl
  5334             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5335             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5336
  5337         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5338
  5339         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5340             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5341             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5342
  5343         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5344             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5345             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5346
  5347         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5348
  5349         16  CF-CO-ACH-ID-CODE              PIC  X.
  5350             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5351             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5352             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5353         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5354         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5355         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5356         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5357         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5358         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5359         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5360         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5361         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5362                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5363         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5364                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5365
  5366         16  CF-CO-OVER-SHORT.
  5367             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5368             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5369
  5370*         16  FILLER                         PIC X(102).
  5371         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5372             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5373             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5374
  5375         16  CF-AH-APPROVAL-DAYS.
  5376             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5377             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5378             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5379             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5380
  5381         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5382
  5383         16  CF-APPROV-LEV-5.
  5384             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5385             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5386             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5387
  5388         16  FILLER                         PIC X(68).
  5389****************************************************************
  5390*             PROCESSOR/USER RECORD                            *
  5391****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 100
* EL050.cbl
  5392
  5393     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5394         16  CF-PROCESSOR-NAME              PIC X(30).
  5395         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5396         16  CF-PROCESSOR-TITLE             PIC X(26).
  5397         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5398                 88  MESSAGE-YES                VALUE 'Y'.
  5399                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5400
  5401*****************************************************
  5402****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5403****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5404****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5405****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5406*****************************************************
  5407
  5408         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5409             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5410             20  CF-APPLICATION-FORCE       PIC X.
  5411             20  CF-INDIVIDUAL-APP.
  5412                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5413                     28  CF-BROWSE-APP      PIC X.
  5414                     28  CF-UPDATE-APP      PIC X.
  5415
  5416         16  CF-CURRENT-TERM-ON             PIC X(4).
  5417         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5418             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5419             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5420             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5421             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5422             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5423             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5424             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5425         16  CF-PROCESSOR-CARRIER           PIC X.
  5426             88  NO-CARRIER-SECURITY            VALUE ' '.
  5427         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5428             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5429         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5430             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5431         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5432             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5433
  5434         16  CF-PROC-SYS-ACCESS-SW.
  5435             20  CF-PROC-CREDIT-CLAIMS-SW.
  5436                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5437                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5438                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5439                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5440             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5441                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5442                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5443             20  CF-PROC-LIFE-GNRLDGR-SW.
  5444                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5445                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5446                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5447                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5448             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5449                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 101
* EL050.cbl
  5450                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5451         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5452             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5453             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5454         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5455
  5456         16  CF-APPROVAL-LEVEL                  PIC X.
  5457             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5458             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5459             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5460             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5461             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5462
  5463         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5464
  5465         16  CF-LANGUAGE-TYPE                   PIC X.
  5466             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5467             88  CF-LANG-IS-FR                      VALUE 'F'.
  5468
  5469         16  CF-CSR-IND                         PIC X.
  5470         16  FILLER                             PIC X(239).
  5471
  5472****************************************************************
  5473*             PROCESSOR/REMINDERS RECORD                       *
  5474****************************************************************
  5475
  5476     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5477         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5478             20  CF-START-REMIND-DT         PIC XX.
  5479             20  CF-END-REMIND-DT           PIC XX.
  5480             20  CF-REMINDER-TEXT           PIC X(50).
  5481         16  FILLER                         PIC X(296).
  5482
  5483
  5484****************************************************************
  5485*             STATE MASTER RECORD                              *
  5486****************************************************************
  5487
  5488     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5489         16  CF-STATE-ABBREVIATION          PIC XX.
  5490         16  CF-STATE-NAME                  PIC X(25).
  5491         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5492         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5493             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5494             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5495             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5496             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5497                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5498                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5499             20  CF-ST-PREM-REJECT-SW       PIC X.
  5500                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5501                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5502             20  CF-ST-REF-REJECT-SW        PIC X.
  5503                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5504                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5505         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5506         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5507         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 102
* EL050.cbl
  5508             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5509             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5510             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5511         16  CF-ST-FST-PMT-EXTENSION.
  5512             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5513             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5514                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5515                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5516                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5517                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5518         16  CF-ST-STATE-CALL.
  5519             20  CF-ST-CALL-UNEARNED        PIC X.
  5520             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5521             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5522         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5523             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5524             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5525         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5526         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5527         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5528         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5529         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5530         16  FILLER                         PIC X.
  5531         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5532             20  CF-ST-BENEFIT-CD           PIC XX.
  5533             20  CF-ST-BENEFIT-KIND         PIC X.
  5534                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5535                 88  CF-ST-AH-KIND              VALUE 'A'.
  5536             20  CF-ST-REM-TERM-CALC        PIC X.
  5537                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5538                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5539                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5540                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5541                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5542                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5543                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5544                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5545
  5546             20  CF-ST-REFUND-CALC          PIC X.
  5547                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5548                 88  ST-REFD-BY-R78             VALUE '1'.
  5549                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5550                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5551                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5552                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5553                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5554                 88  ST-REFD-UTAH               VALUE '7'.
  5555                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5556                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5557                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5558
  5559             20  CF-ST-EARNING-CALC         PIC X.
  5560                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5561                 88  ST-EARN-BY-R78             VALUE '1'.
  5562                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5563                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5564                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5565                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 103
* EL050.cbl
  5566                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5567                 88  ST-EARN-MEAN               VALUE '8'.
  5568                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5569
  5570             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5571                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5572                 88  ST-OVRD-BY-R78             VALUE '1'.
  5573                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5574                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5575                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5576                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5577                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5578                 88  ST-OVRD-MEAN               VALUE '8'.
  5579                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5580             20  FILLER                     PIC X.
  5581
  5582         16  CF-ST-COMMISSION-CAPS.
  5583             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5584             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5585             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5586             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5587         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5588                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5589
  5590         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5591
  5592         16  CF-ST-STATUTORY-INTEREST.
  5593             20  CF-ST-STAT-DATE-FROM       PIC X.
  5594                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5595                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5596             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5597             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5598             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5599             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5600             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5601
  5602         16  CF-ST-OVER-SHORT.
  5603             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5604             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5605
  5606         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5607
  5608         16  CF-ST-RT-CALC                  PIC X.
  5609
  5610         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5611         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5612         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5613         16  CF-ST-RF-LR-CALC               PIC X.
  5614         16  CF-ST-RF-LL-CALC               PIC X.
  5615         16  CF-ST-RF-LN-CALC               PIC X.
  5616         16  CF-ST-RF-AH-CALC               PIC X.
  5617         16  CF-ST-RF-CP-CALC               PIC X.
  5618*        16  FILLER                         PIC X(206).
  5619*CIDMOD         16  FILLER                         PIC X(192).
  5620         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5621             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5622         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5623         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 104
* EL050.cbl
  5624         16  CF-ST-CAUSAL-STATE             PIC X.
  5625         16  FILLER                         PIC X(185).
  5626
  5627****************************************************************
  5628*             BENEFIT MASTER RECORD                            *
  5629****************************************************************
  5630
  5631     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5632         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5633             20  CF-BENEFIT-CODE            PIC XX.
  5634             20  CF-BENEFIT-NUMERIC  REDEFINES
  5635                 CF-BENEFIT-CODE            PIC XX.
  5636             20  CF-BENEFIT-ALPHA           PIC XXX.
  5637             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5638             20  CF-BENEFIT-COMMENT         PIC X(10).
  5639
  5640             20  CF-LF-COVERAGE-TYPE        PIC X.
  5641                 88  CF-REDUCING                VALUE 'R'.
  5642                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5643
  5644             20  CF-SPECIAL-CALC-CD         PIC X.
  5645                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5646                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5647                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5648                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5649                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5650                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5651                 88  CF-FARM-PLAN               VALUE 'F'.
  5652                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5653                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5654                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5655                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5656                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5657                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5658                 88  CF-PRUDENTIAL              VALUE 'P'.
  5659                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5660                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5661                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5662                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5663                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5664                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5665
  5666             20  CF-JOINT-INDICATOR         PIC X.
  5667                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5668
  5669*            20  FILLER                     PIC X(12).
  5670             20  FILLER                     PIC X(11).
  5671             20  CF-BENEFIT-CATEGORY        PIC X.
  5672             20  CF-LOAN-TYPE               PIC X(8).
  5673
  5674             20  CF-CO-REM-TERM-CALC        PIC X.
  5675                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5676                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5677                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5678                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5679                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5680
  5681             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 105
* EL050.cbl
  5682                 88  CO-EARN-BY-R78             VALUE '1'.
  5683                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5684                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5685                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5686                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5687                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5688                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5689                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5690
  5691             20  CF-CO-REFUND-CALC          PIC X.
  5692                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5693                 88  CO-REFD-BY-R78             VALUE '1'.
  5694                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5695                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5696                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5697                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5698                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5699                 88  CO-REFD-MEAN               VALUE '8'.
  5700                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5701                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5702                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5703
  5704             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5705                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5706                 88  CO-OVRD-BY-R78             VALUE '1'.
  5707                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5708                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5709                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5710                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5711                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5712                 88  CO-OVRD-MEAN               VALUE '8'.
  5713                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5714
  5715             20  CF-CO-BEN-I-G-CD           PIC X.
  5716                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5717                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5718                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5719
  5720         16  FILLER                         PIC X(304).
  5721
  5722
  5723****************************************************************
  5724*             CARRIER MASTER RECORD                            *
  5725****************************************************************
  5726
  5727     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5728         16  CF-ADDRESS-DATA.
  5729             20  CF-MAIL-TO-NAME            PIC X(30).
  5730             20  CF-IN-CARE-OF              PIC X(30).
  5731             20  CF-ADDRESS-LINE-1          PIC X(30).
  5732             20  CF-ADDRESS-LINE-2          PIC X(30).
  5733             20  CF-CITY-STATE              PIC X(30).
  5734             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5735             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5736
  5737         16  CF-CLAIM-NO-CONTROL.
  5738             20  CF-CLAIM-NO-METHOD         PIC X.
  5739                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 106
* EL050.cbl
  5740                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5741                 88  CLAIM-NO-SEQ               VALUE '3'.
  5742                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5743             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5744                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5745                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5746                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5747
  5748         16  CF-CHECK-NO-CONTROL.
  5749             20  CF-CHECK-NO-METHOD         PIC X.
  5750                 88  CHECK-NO-MANUAL            VALUE '1'.
  5751                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5752                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5753                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5754             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5755                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5756
  5757         16  CF-DOMICILE-STATE              PIC XX.
  5758
  5759         16  CF-EXPENSE-CONTROLS.
  5760             20  CF-EXPENSE-METHOD          PIC X.
  5761                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5762                 88  DOLLARS-PER-PMT            VALUE '2'.
  5763                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5764                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5765             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5766             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5767
  5768         16  CF-CORRESPONDENCE-CONTROL.
  5769             20  CF-LETTER-RESEND-OPT       PIC X.
  5770                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5771                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5772             20  FILLER                     PIC X(4).
  5773
  5774         16  CF-RESERVE-CONTROLS.
  5775             20  CF-MANUAL-SW               PIC X.
  5776                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5777             20  CF-FUTURE-SW               PIC X.
  5778                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5779             20  CF-PTC-SW                  PIC X.
  5780                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5781             20  CF-IBNR-SW                 PIC X.
  5782                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5783             20  CF-PTC-LF-SW               PIC X.
  5784                 88  CF-LF-PTC-USED             VALUE '1'.
  5785             20  CF-CDT-ACCESS-METHOD       PIC X.
  5786                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5787                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5788                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5789             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5790
  5791         16  CF-CLAIM-CALC-METHOD           PIC X.
  5792             88  360-PLUS-MONTHS                VALUE '1'.
  5793             88  365-PLUS-MONTHS                VALUE '2'.
  5794             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5795             88  360-DAILY                      VALUE '4'.
  5796             88  365-DAILY                      VALUE '5'.
  5797
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 107
* EL050.cbl
  5798         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5799         16  FILLER                         PIC X(11).
  5800
  5801         16  CF-LIMIT-AMOUNTS.
  5802             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5803             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5804             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5805             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5806             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5807             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5808             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5809             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5810             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5811             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5812
  5813         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5814         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5815         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5816
  5817         16  CF-ZIP-CODE.
  5818             20  CF-ZIP-PRIME.
  5819                 24  CF-ZIP-1ST             PIC X.
  5820                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5821                 24  FILLER                 PIC X(4).
  5822             20  CF-ZIP-PLUS4               PIC X(4).
  5823         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5824             20  CF-CAN-POSTAL-1            PIC XXX.
  5825             20  CF-CAN-POSTAL-2            PIC XXX.
  5826             20  FILLER                     PIC XXX.
  5827
  5828         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5829         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5830         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5831
  5832         16  CF-RATING-SWITCH               PIC X.
  5833             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5834             88  CF-NO-RATING                   VALUE 'N'.
  5835
  5836         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5837
  5838         16  CF-CARRIER-OVER-SHORT.
  5839             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5840             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5841
  5842         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5843         16  CF-SECPAY-SWITCH               PIC X.
  5844             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5845             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5846         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5847         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5848         16  FILLER                         PIC X(444).
  5849*        16  FILLER                         PIC X(452).
  5850
  5851
  5852****************************************************************
  5853*             MORTALITY MASTER RECORD                          *
  5854****************************************************************
  5855
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 108
* EL050.cbl
  5856     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5857         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5858                                INDEXED BY CF-MORT-NDX.
  5859             20  CF-MORT-TABLE              PIC X(5).
  5860             20  CF-MORT-TABLE-TYPE         PIC X.
  5861                 88  CF-MORT-JOINT              VALUE 'J'.
  5862                 88  CF-MORT-SINGLE             VALUE 'S'.
  5863                 88  CF-MORT-COMBINED           VALUE 'C'.
  5864                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5865                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5866             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5867             20  CF-MORT-AGE-METHOD         PIC XX.
  5868                 88  CF-AGE-LAST                VALUE 'AL'.
  5869                 88  CF-AGE-NEAR                VALUE 'AN'.
  5870             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5871             20  CF-MORT-ADJUSTMENT-DIRECTION
  5872                                            PIC X.
  5873                 88  CF-MINUS                   VALUE '-'.
  5874                 88  CF-PLUS                    VALUE '+'.
  5875             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5876             20  CF-MORT-JOINT-CODE         PIC X.
  5877                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5878             20  CF-MORT-PC-Q               PIC X.
  5879                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5880             20  CF-MORT-TABLE-CODE         PIC X(4).
  5881             20  CF-MORT-COMMENTS           PIC X(15).
  5882             20  FILLER                     PIC X(14).
  5883
  5884         16  FILLER                         PIC X(251).
  5885
  5886
  5887****************************************************************
  5888*             BUSSINESS TYPE MASTER RECORD                     *
  5889****************************************************************
  5890
  5891     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5892* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5893* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5894* AND RECORD 05 IS TYPES 81-99
  5895         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5896             20  CF-BUSINESS-TITLE          PIC  X(19).
  5897             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5898                                            PIC S9V9(4) COMP-3.
  5899             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5900             20  FILLER                     PIC  X.
  5901         16  FILLER                         PIC  X(248).
  5902
  5903
  5904****************************************************************
  5905*             TERMINAL MASTER RECORD                           *
  5906****************************************************************
  5907
  5908     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5909
  5910         16  CF-COMPANY-TERMINALS.
  5911             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5912                                  PIC X(4).
  5913         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 109
* EL050.cbl
  5914
  5915
  5916****************************************************************
  5917*             LIFE EDIT MASTER RECORD                          *
  5918****************************************************************
  5919
  5920     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5921         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5922             20  CF-LIFE-CODE-IN            PIC XX.
  5923             20  CF-LIFE-CODE-OUT           PIC XX.
  5924         16  FILLER                         PIC X(248).
  5925
  5926
  5927****************************************************************
  5928*             AH EDIT MASTER RECORD                            *
  5929****************************************************************
  5930
  5931     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5932         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5933             20  CF-AH-CODE-IN              PIC XXX.
  5934             20  CF-AH-CODE-OUT             PIC XX.
  5935         16  FILLER                         PIC X(248).
  5936
  5937
  5938****************************************************************
  5939*             CREDIBILITY TABLES                               *
  5940****************************************************************
  5941
  5942     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5943         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5944                             INDEXED BY CF-CRDB-NDX.
  5945             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5946             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5947             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5948         16  FILLER                         PIC  X(332).
  5949
  5950
  5951****************************************************************
  5952*             REPORT CUSTOMIZATION RECORD                      *
  5953****************************************************************
  5954
  5955     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5956         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5957             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5958             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5959             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5960**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5961****       A T-TRANSFER.                                   ****
  5962             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5963
  5964         16  FILLER                         PIC XX.
  5965
  5966         16  CF-CARRIER-CNTL-OPT.
  5967             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5968                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5969                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5970             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5971                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 110
* EL050.cbl
  5972         16  CF-GROUP-CNTL-OPT.
  5973             20  CF-GROUP-OPT-SEQ           PIC 9.
  5974                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5975                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5976             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5977                                            PIC X(6).
  5978         16  CF-STATE-CNTL-OPT.
  5979             20  CF-STATE-OPT-SEQ           PIC 9.
  5980                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5981                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5982             20  CF-STATE-SELECT OCCURS 3 TIMES
  5983                                            PIC XX.
  5984         16  CF-ACCOUNT-CNTL-OPT.
  5985             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5986                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5987                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5988             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5989                                            PIC X(10).
  5990         16  CF-BUS-TYP-CNTL-OPT.
  5991             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5992                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5993                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5994             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5995                                            PIC XX.
  5996         16  CF-LF-TYP-CNTL-OPT.
  5997             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5998                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5999                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6000             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6001                                            PIC XX.
  6002         16  CF-AH-TYP-CNTL-OPT.
  6003             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6004                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6005                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6006             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6007                                            PIC XX.
  6008         16  CF-REPTCD1-CNTL-OPT.
  6009             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6010                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6011                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6012             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6013                                            PIC X(10).
  6014         16  CF-REPTCD2-CNTL-OPT.
  6015             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6016                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6018             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6019                                            PIC X(10).
  6020         16  CF-USER1-CNTL-OPT.
  6021             20  CF-USER1-OPT-SEQ           PIC 9.
  6022                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6023                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6024             20  CF-USER1-SELECT OCCURS 3 TIMES
  6025                                            PIC X(10).
  6026         16  CF-USER2-CNTL-OPT.
  6027             20  CF-USER2-OPT-SEQ           PIC 9.
  6028                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6029                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 111
* EL050.cbl
  6030             20  CF-USER2-SELECT OCCURS 3 TIMES
  6031                                            PIC X(10).
  6032         16  CF-USER3-CNTL-OPT.
  6033             20  CF-USER3-OPT-SEQ           PIC 9.
  6034                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6035                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6036             20  CF-USER3-SELECT OCCURS 3 TIMES
  6037                                            PIC X(10).
  6038         16  CF-USER4-CNTL-OPT.
  6039             20  CF-USER4-OPT-SEQ           PIC 9.
  6040                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6041                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6042             20  CF-USER4-SELECT OCCURS 3 TIMES
  6043                                            PIC X(10).
  6044         16  CF-USER5-CNTL-OPT.
  6045             20  CF-USER5-OPT-SEQ           PIC 9.
  6046                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6047                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6048             20  CF-USER5-SELECT OCCURS 3 TIMES
  6049                                            PIC X(10).
  6050         16  CF-REINS-CNTL-OPT.
  6051             20  CF-REINS-OPT-SEQ           PIC 9.
  6052                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6053                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6054             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6055                 24  CF-REINS-PRIME         PIC XXX.
  6056                 24  CF-REINS-SUB           PIC XXX.
  6057
  6058         16  CF-AGENT-CNTL-OPT.
  6059             20  CF-AGENT-OPT-SEQ           PIC 9.
  6060                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6061                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6062             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6063                                            PIC X(10).
  6064
  6065         16  FILLER                         PIC X(43).
  6066
  6067         16  CF-LOSS-RATIO-SELECT.
  6068             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6069             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6070         16  CF-ENTRY-DATE-SELECT.
  6071             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6072             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6073         16  CF-EFFECTIVE-DATE-SELECT.
  6074             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6075             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6076
  6077         16  CF-EXCEPTION-LIST-IND          PIC X.
  6078             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6079
  6080         16  FILLER                         PIC X(318).
  6081
  6082****************************************************************
  6083*                  EXCEPTION REPORTING RECORD                  *
  6084****************************************************************
  6085
  6086     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6087         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 112
* EL050.cbl
  6088             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6089
  6090         16  CF-COMBINED-LIFE-AH-OPT.
  6091             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6092             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6093             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6094             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6095
  6096         16  CF-LIFE-OPT.
  6097             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6098             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6099             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6100             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6101             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6102             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6103             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6104             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6105             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6106             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6107
  6108         16  CF-AH-OPT.
  6109             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6110             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6111             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6112             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6113             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6114             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6115             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6116             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6117             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6118             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6119
  6120         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6121             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6122             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6123             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6124
  6125         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6126
  6127         16  FILLER                         PIC X(673).
  6128
  6129
  6130****************************************************************
  6131*             MORTGAGE SYSTEM PLAN RECORD                      *
  6132****************************************************************
  6133
  6134     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6135         16  CF-PLAN-TYPE                   PIC X.
  6136             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6137             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6138             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6139         16  CF-PLAN-ABBREV                 PIC XXX.
  6140         16  CF-PLAN-DESCRIPT               PIC X(10).
  6141         16  CF-PLAN-NOTES                  PIC X(20).
  6142         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6143         16  CF-PLAN-UNDERWRITING.
  6144             20  CF-PLAN-TERM-DATA.
  6145                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 113
* EL050.cbl
  6146                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6147             20  CF-PLAN-AGE-DATA.
  6148                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6149                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6150                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6151             20  CF-PLAN-BENEFIT-DATA.
  6152                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6153                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6154                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6155                                            PIC S9(7)V99  COMP-3.
  6156         16  CF-PLAN-POLICY-FORMS.
  6157             20  CF-POLICY-FORM             PIC X(12).
  6158             20  CF-MASTER-APPLICATION      PIC X(12).
  6159             20  CF-MASTER-POLICY           PIC X(12).
  6160         16  CF-PLAN-RATING.
  6161             20  CF-RATE-CODE               PIC X(5).
  6162             20  CF-SEX-RATING              PIC X.
  6163                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6164                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6165             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6166             20  CF-SUB-STD-TYPE            PIC X.
  6167                 88  CF-PCT-OF-PREM            VALUE '1'.
  6168                 88  CF-PCT-OF-BENE            VALUE '2'.
  6169         16  CF-PLAN-PREM-TOLERANCES.
  6170             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6171             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6172         16  CF-PLAN-PYMT-TOLERANCES.
  6173             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6174             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6175         16  CF-PLAN-MISC-DATA.
  6176             20  FILLER                     PIC X.
  6177             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6178             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6179         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6180         16  CF-PLAN-IND-GRP                PIC X.
  6181             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6182                                                     '1'.
  6183             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6184                                                     '2'.
  6185         16  CF-MIB-SEARCH-SW               PIC X.
  6186             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6187             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6188             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6189             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6190         16  CF-ALPHA-SEARCH-SW             PIC X.
  6191             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6192             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6193             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6194             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6195             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6196             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6197             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6198             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6199             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6200             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6201                                                     'A' 'B' 'C'
  6202                                                     'X' 'Y' 'Z'.
  6203         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 114
* EL050.cbl
  6204             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6205             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6206             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6207             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6208             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6209         16  FILLER                         PIC X(4).
  6210         16  CF-HEALTH-QUESTIONS            PIC X.
  6211             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6212         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6213         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6214         16  CF-PLAN-SNGL-JNT               PIC X.
  6215             88  CF-COMBINED-PLAN              VALUE 'C'.
  6216             88  CF-JNT-PLAN                   VALUE 'J'.
  6217             88  CF-SNGL-PLAN                  VALUE 'S'.
  6218         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6219         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6220         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6221         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6222         16  CF-RERATE-CNTL                 PIC  X.
  6223             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6224             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6225             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6226             88  CF-AUTO-RECALC                 VALUE '4'.
  6227         16  CF-BENEFIT-TYPE                PIC  X.
  6228             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6229             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6230         16  CF-POLICY-FEE                  PIC S999V99
  6231                                                    COMP-3.
  6232         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6233         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6234         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6235         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6236         16  FILLER                         PIC  X(32).
  6237         16  CF-TERMINATION-FORM            PIC  X(04).
  6238         16  FILLER                         PIC  X(08).
  6239         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6240                                                       COMP-3.
  6241         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6242         16  CF-ISSUE-LETTER                PIC  X(4).
  6243         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6244         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6245             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6246             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6247         16  CF-MP-REFUND-CALC              PIC X.
  6248             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6249             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6250             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6251             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6252             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6253             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6254             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6255             88  CF-MP-REFD-MEAN                VALUE '8'.
  6256         16  CF-ALT-RATE-CODE               PIC  X(5).
  6257
  6258
  6259         16  FILLER                         PIC X(498).
  6260****************************************************************
  6261*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 115
* EL050.cbl
  6262****************************************************************
  6263
  6264     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6265         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6266         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6267             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6268             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6269             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6270             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6271             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6272
  6273         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6274         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6275         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6276         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6277         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6278
  6279         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6280             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6281         16  CF-MP-RECON-USE-IND            PIC X(1).
  6282             88  CF-MP-USE-RECON             VALUE 'Y'.
  6283         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6284             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6285         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6286             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6287             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6288         16  FILLER                         PIC X(1).
  6289         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6290             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6291         16  CF-MORTG-MIB-VERSION           PIC X.
  6292             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6293             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6294             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6295         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6296             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6297                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6298             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6299                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6300             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6301                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6302             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6303                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6304             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6305                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6306             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6307                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6308         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6309         16  FILLER                         PIC X(7).
  6310         16  CF-MORTG-DESTINATION-SYMBOL.
  6311             20  CF-MORTG-MIB-COMM          PIC X(5).
  6312             20  CF-MORTG-MIB-TERM          PIC X(5).
  6313         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6314             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6315         16  FILLER                         PIC X(03).
  6316         16  CF-MP-CHECK-NO-CONTROL.
  6317             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6318                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6319                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 116
* EL050.cbl
  6320                                                ' ' LOW-VALUES.
  6321                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6322                                               VALUE '3'.
  6323         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6324         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6325         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6326             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6327                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6328             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6329                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6330             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6331                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6332             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6333                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6334             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6335                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6336             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6337                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6338         16  CF-MORTG-BILLING-AREA.
  6339             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6340                                            PIC X.
  6341         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6342         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6343         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6344         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6345             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6346             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6347         16  FILLER                         PIC X.
  6348         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6349             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6350             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6351         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6352         16  FILLER                         PIC X(8).
  6353         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6354         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6355         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6356         16  CF-ACH-COMPANY-ID.
  6357             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6358                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6359                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6360                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6361             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6362         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6363             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6364         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6365             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6366             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6367         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6368         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6369         16  FILLER                         PIC X(536).
  6370
  6371****************************************************************
  6372*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6373****************************************************************
  6374
  6375     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6376         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6377             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 117
* EL050.cbl
  6378                 24  CF-FEMALE-FT           PIC 99.
  6379                 24  CF-FEMALE-IN           PIC 99.
  6380             20  CF-FEMALE-MIN-WT           PIC 999.
  6381             20  CF-FEMALE-MAX-WT           PIC 999.
  6382         16  FILLER                         PIC X(428).
  6383
  6384     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6385         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6386             20  CF-MALE-HEIGHT.
  6387                 24  CF-MALE-FT             PIC 99.
  6388                 24  CF-MALE-IN             PIC 99.
  6389             20  CF-MALE-MIN-WT             PIC 999.
  6390             20  CF-MALE-MAX-WT             PIC 999.
  6391         16  FILLER                         PIC X(428).
  6392******************************************************************
  6393*             AUTOMATIC ACTIVITY RECORD                          *
  6394******************************************************************
  6395     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6396         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6397             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6398             20  CF-SYS-LETTER-ID           PIC X(04).
  6399             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6400             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6401             20  CF-SYS-RESET-SW            PIC X(01).
  6402             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6403             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6404
  6405         16  FILLER                         PIC X(50).
  6406
  6407         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6408             20  CF-USER-ACTIVE-SW          PIC X(01).
  6409             20  CF-USER-LETTER-ID          PIC X(04).
  6410             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6411             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6412             20  CF-USER-RESET-SW           PIC X(01).
  6413             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6414             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6415             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6416
  6417         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 118
* EL050.cbl
  6419*    COPY ERCACCT.
  6420******************************************************************
  6421*                                                                *
  6422*                                                                *
  6423*                            ERCACCT                             *
  6424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6425*                            VMOD=2.031                          *
  6426*                                                                *
  6427*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6428*                                                                *
  6429*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6430*   VSAM ACCOUNT MASTER FILES.                                   *
  6431*                                                                *
  6432*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6433*                                                                *
  6434*   FILE TYPE = VSAM,KSDS                                        *
  6435*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6436*                                                                *
  6437*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6438*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6439*                                                                *
  6440*   LOG = NO                                                     *
  6441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6442*                                                                *
  6443*                                                                *
  6444******************************************************************
  6445*                   C H A N G E   L O G
  6446*
  6447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6448*-----------------------------------------------------------------
  6449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6450* EFFECTIVE    NUMBER
  6451*-----------------------------------------------------------------
  6452* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6453* 092705    2005050300006  PEMA  ADD SPP LEASES
  6454* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6455* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6456* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6457* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6458* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6459******************************************************************
  6460
  6461 01  ACCOUNT-MASTER.
  6462     12  AM-RECORD-ID                      PIC XX.
  6463         88  VALID-AM-ID                      VALUE 'AM'.
  6464
  6465     12  AM-CONTROL-PRIMARY.
  6466         16  AM-COMPANY-CD                 PIC X.
  6467         16  AM-MSTR-CNTRL.
  6468             20  AM-CONTROL-A.
  6469                 24  AM-CARRIER            PIC X.
  6470                 24  AM-GROUPING.
  6471                     28 AM-GROUPING-PREFIX PIC XXX.
  6472                     28 AM-GROUPING-PRIME  PIC XXX.
  6473                 24  AM-STATE              PIC XX.
  6474                 24  AM-ACCOUNT.
  6475                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6476                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 119
* EL050.cbl
  6477             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6478                                           PIC X(19).
  6479             20  AM-CNTRL-B.
  6480                 24  AM-EXPIRATION-DT      PIC XX.
  6481                 24  FILLER                PIC X(4).
  6482             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6483                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6484
  6485     12  AM-CONTROL-BY-VAR-GRP.
  6486         16  AM-COMPANY-CD-A1              PIC X.
  6487         16  AM-VG-CARRIER                 PIC X.
  6488         16  AM-VG-GROUPING                PIC X(6).
  6489         16  AM-VG-STATE                   PIC XX.
  6490         16  AM-VG-ACCOUNT                 PIC X(10).
  6491         16  AM-VG-DATE.
  6492             20  AM-VG-EXPIRATION-DT       PIC XX.
  6493             20  FILLER                    PIC X(4).
  6494         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6495                                           PIC 9(11)      COMP-3.
  6496     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6497         16  FILLER                        PIC X(10).
  6498         16  AM-VG-KEY3.
  6499             20  AM-VG3-ACCOUNT            PIC X(10).
  6500             20  AM-VG3-EXP-DT             PIC XX.
  6501         16  FILLER                        PIC X(4).
  6502     12  AM-MAINT-INFORMATION.
  6503         16  AM-LAST-MAINT-DT              PIC XX.
  6504         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6505         16  AM-LAST-MAINT-USER            PIC X(4).
  6506         16  FILLER                        PIC XX.
  6507
  6508     12  AM-EFFECTIVE-DT                   PIC XX.
  6509     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6510
  6511     12  AM-PREV-DATES  COMP-3.
  6512         16  AM-PREV-EXP-DT                PIC 9(11).
  6513         16  AM-PREV-EFF-DT                PIC 9(11).
  6514
  6515     12  AM-REPORT-CODE-1                  PIC X(10).
  6516     12  AM-REPORT-CODE-2                  PIC X(10).
  6517
  6518     12  AM-CITY-CODE                      PIC X(4).
  6519     12  AM-COUNTY-PARISH                  PIC X(6).
  6520
  6521     12  AM-NAME                           PIC X(30).
  6522     12  AM-PERSON                         PIC X(30).
  6523     12  AM-ADDRS                          PIC X(30).
  6524     12  AM-CITY.
  6525         16  AM-ADDR-CITY                  PIC X(28).
  6526         16  AM-ADDR-STATE                 PIC XX.
  6527     12  AM-ZIP.
  6528         16  AM-ZIP-PRIME.
  6529             20  AM-ZIP-PRI-1ST            PIC X.
  6530                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6531             20  FILLER                    PIC X(4).
  6532         16  AM-ZIP-PLUS4                  PIC X(4).
  6533     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6534         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 120
* EL050.cbl
  6535         16  AM-CAN-POSTAL-2               PIC XXX.
  6536         16  FILLER                        PIC XXX.
  6537     12  AM-TEL-NO.
  6538         16  AM-AREA-CODE                  PIC 999.
  6539         16  AM-TEL-PRE                    PIC 999.
  6540         16  AM-TEL-NBR                    PIC 9(4).
  6541     12  AM-TEL-LOC                        PIC X.
  6542         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6543         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6544
  6545     12  AM-COMM-STRUCTURE.
  6546         16  AM-DEFN-1.
  6547             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6548                 24  AM-AGT.
  6549                     28  AM-AGT-PREFIX     PIC X(4).
  6550                     28  AM-AGT-PRIME      PIC X(6).
  6551                 24  AM-COM-TYP            PIC X.
  6552                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6553                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6554                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6555                 24  AM-RECALC-LV-INDIC    PIC X.
  6556                 24  AM-RETRO-LV-INDIC     PIC X.
  6557                 24  AM-GL-CODES           PIC X.
  6558                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6559                 24  FILLER                PIC X(01).
  6560         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6561             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6562                 24  FILLER                PIC X(11).
  6563                 24  AM-L-COMA             PIC XXX.
  6564                 24  AM-J-COMA             PIC XXX.
  6565                 24  AM-A-COMA             PIC XXX.
  6566                 24  FILLER                PIC X(6).
  6567
  6568     12  AM-COMM-CHANGE-STATUS             PIC X.
  6569         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6570
  6571     12  AM-CSR-CODE                       PIC X(4).
  6572
  6573     12  AM-BILLING-STATUS                 PIC X.
  6574         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6575         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6576     12  AM-AUTO-REFUND-SW                 PIC X.
  6577         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6578         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6579     12  AM-GPCD                           PIC 99.
  6580     12  AM-IG                             PIC X.
  6581         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6582         88  AM-HAS-GROUP                     VALUE '2'.
  6583     12  AM-STATUS                         PIC X.
  6584         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6585         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6586         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6587         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6588         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6589         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6590     12  AM-REMIT-TO                       PIC 99.
  6591     12  AM-ID-NO                          PIC X(11).
  6592
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 121
* EL050.cbl
  6593     12  AM-CAL-TABLE                      PIC XX.
  6594     12  AM-LF-DEVIATION                   PIC XXX.
  6595     12  AM-AH-DEVIATION                   PIC XXX.
  6596     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6597     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6598     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6599     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6600     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6601     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6602
  6603     12  AM-USER-FIELDS.
  6604         16  AM-FLD-1                      PIC XX.
  6605         16  AM-FLD-2                      PIC XX.
  6606         16  AM-FLD-3                      PIC XX.
  6607         16  AM-FLD-4                      PIC XX.
  6608         16  AM-FLD-5                      PIC XX.
  6609
  6610     12  AM-1ST-PROD-DATE.
  6611         16  AM-1ST-PROD-YR                PIC XX.
  6612         16  AM-1ST-PROD-MO                PIC XX.
  6613         16  AM-1ST-PROD-DA                PIC XX.
  6614     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6615     12  AM-CERTS-PURGED-DATE.
  6616         16  AM-PUR-YR                     PIC XX.
  6617         16  AM-PUR-MO                     PIC XX.
  6618         16  AM-PUR-DA                     PIC XX.
  6619     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6620     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6621     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6622     12  AM-INACTIVE-DATE.
  6623         16  AM-INA-MO                     PIC 99.
  6624         16  AM-INA-DA                     PIC 99.
  6625         16  AM-INA-YR                     PIC 99.
  6626     12  AM-AR-HI-CERT-DATE                PIC XX.
  6627
  6628     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6629     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6630
  6631     12  AM-OB-PAYMENT-MODE                PIC X.
  6632         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6633         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6634         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6635         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6636
  6637     12  AM-AH-ONLY-INDICATOR              PIC X.
  6638         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6639         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6640
  6641     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6642
  6643     12  AM-OVER-SHORT.
  6644         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6645         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6646
  6647     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6648     12  AM-DCC-CLP-STATE                  PIC XX.
  6649
  6650     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 122
* EL050.cbl
  6651     12  AM-RECALC-REIN                    PIC X.
  6652
  6653     12  AM-REI-TABLE                      PIC XXX.
  6654     12  AM-REI-ET-LF                      PIC X.
  6655     12  AM-REI-ET-AH                      PIC X.
  6656     12  AM-REI-PE-LF                      PIC X.
  6657     12  AM-REI-PE-AH                      PIC X.
  6658     12  AM-REI-PRT-ST                     PIC X.
  6659     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6660     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6661     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6662     12  AM-REI-GROUP-A                    PIC X(6).
  6663     12  AM-REI-MORT                       PIC X(4).
  6664     12  AM-REI-PRT-OW                     PIC X.
  6665     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6666     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6667     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6668     12  AM-REI-GROUP-B                    PIC X(6).
  6669
  6670     12  AM-TRUST-TYPE                     PIC X(2).
  6671
  6672     12  AM-EMPLOYER-STMT-USED             PIC X.
  6673     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6674
  6675     12  AM-STD-AH-TYPE                    PIC XX.
  6676     12  AM-EARN-METHODS.
  6677         16  AM-EARN-METHOD-R              PIC X.
  6678             88 AM-REF-RL-R78                 VALUE 'R'.
  6679             88 AM-REF-RL-PR                  VALUE 'P'.
  6680             88 AM-REF-RL-MEAN                VALUE 'M'.
  6681             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6682         16  AM-EARN-METHOD-L              PIC X.
  6683             88 AM-REF-LL-R78                 VALUE 'R'.
  6684             88 AM-REF-LL-PR                  VALUE 'P'.
  6685             88 AM-REF-LL-MEAN                VALUE 'M'.
  6686             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6687         16  AM-EARN-METHOD-A              PIC X.
  6688             88 AM-REF-AH-R78                 VALUE 'R'.
  6689             88 AM-REF-AH-PR                  VALUE 'P'.
  6690             88 AM-REF-AH-MEAN                VALUE 'M'.
  6691             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6692             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6693             88 AM-REF-AH-NET                 VALUE 'N'.
  6694
  6695     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6696     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6697     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6698
  6699     12  AM-RET-Y-N                        PIC X.
  6700     12  AM-RET-P-E                        PIC X.
  6701     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6702     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6703     12  AM-RET-GRP                        PIC X(6).
  6704     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6705         16  AM-POOL-PRIME                 PIC XXX.
  6706         16  AM-POOL-SUB                   PIC XXX.
  6707     12  AM-RETRO-EARNINGS.
  6708         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 123
* EL050.cbl
  6709         16  AM-RET-EARN-L                 PIC X.
  6710         16  AM-RET-EARN-A                 PIC X.
  6711     12  AM-RET-ST-TAX-USE                 PIC X.
  6712         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6713         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6714     12  AM-RETRO-BEG-EARNINGS.
  6715         16  AM-RET-BEG-EARN-R             PIC X.
  6716         16  AM-RET-BEG-EARN-L             PIC X.
  6717         16  AM-RET-BEG-EARN-A             PIC X.
  6718     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6719     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6720
  6721     12  AM-USER-SELECT-OPTIONS.
  6722         16  AM-USER-SELECT-1              PIC X(10).
  6723         16  AM-USER-SELECT-2              PIC X(10).
  6724         16  AM-USER-SELECT-3              PIC X(10).
  6725         16  AM-USER-SELECT-4              PIC X(10).
  6726         16  AM-USER-SELECT-5              PIC X(10).
  6727
  6728     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6729
  6730     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6731
  6732     12  AM-RPT045A-SWITCH                 PIC X.
  6733         88  RPT045A-OFF                   VALUE 'N'.
  6734
  6735     12  AM-INSURANCE-LIMITS.
  6736         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6737         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6738
  6739     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6740         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6741
  6742     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6743         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6744         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6745
  6746     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6747
  6748     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6749     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6750     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6751     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6752     12  AM-DCC-UEF-STATE                  PIC XX.
  6753     12  FILLER                            PIC XXX.
  6754     12  AM-REPORT-CODE-3                  PIC X(10).
  6755*    12  FILLER                            PIC X(22).
  6756
  6757     12  AM-RESERVE-DATE.
  6758         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6759         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6760         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6761
  6762     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6763     12  AM-NOTIFICATION-TYPES.
  6764         16  AM-NOTIF-OF-LETTERS           PIC X.
  6765         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6766         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 124
* EL050.cbl
  6767         16  AM-NOTIF-OF-STATUS            PIC X.
  6768
  6769     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6770         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6771         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6772         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6773         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6774
  6775     12  AM-BENEFIT-CONTROLS.
  6776         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6777             20  AM-BENEFIT-CODE           PIC XX.
  6778             20  AM-BENEFIT-TYPE           PIC X.
  6779             20  AM-BENEFIT-REVISION       PIC XXX.
  6780             20  AM-BENEFIT-REM-TERM       PIC X.
  6781             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6782             20  FILLER                    PIC XX.
  6783         16  FILLER                        PIC X(80).
  6784
  6785     12  AM-TRANSFER-DATA.
  6786         16  AM-TRANSFERRED-FROM.
  6787             20  AM-TRNFROM-CARRIER        PIC X.
  6788             20  AM-TRNFROM-GROUPING.
  6789                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6790                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6791             20  AM-TRNFROM-STATE          PIC XX.
  6792             20  AM-TRNFROM-ACCOUNT.
  6793                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6794                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6795             20  AM-TRNFROM-DTE            PIC XX.
  6796         16  AM-TRANSFERRED-TO.
  6797             20  AM-TRNTO-CARRIER          PIC X.
  6798             20  AM-TRNTO-GROUPING.
  6799                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6800                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6801             20  AM-TRNTO-STATE            PIC XX.
  6802             20  AM-TRNTO-ACCOUNT.
  6803                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6804                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6805             20  AM-TRNTO-DTE              PIC XX.
  6806         16  FILLER                        PIC X(10).
  6807
  6808     12  AM-SAVED-REMIT-TO                 PIC 99.
  6809
  6810     12  AM-COMM-STRUCTURE-SAVED.
  6811         16  AM-DEFN-1-SAVED.
  6812             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6813                 24  AM-AGT-SV             PIC X(10).
  6814                 24  AM-COM-TYP-SV         PIC X.
  6815                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6816                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6817                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6818                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6819                 24  FILLER                PIC X.
  6820                 24  AM-GL-CODES-SV        PIC X.
  6821                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6822                 24  FILLER                PIC X.
  6823         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6824             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 125
* EL050.cbl
  6825                 24  FILLER                PIC X(11).
  6826                 24  AM-L-COMA-SV          PIC XXX.
  6827                 24  AM-J-COMA-SV          PIC XXX.
  6828                 24  AM-A-COMA-SV          PIC XXX.
  6829                 24  FILLER                PIC X(6).
  6830
  6831     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6832         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6833            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6834            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6835            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6836
  6837     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6838     12  FILLER                            PIC X(120).
  6839
  6840     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6841         16  AM-CONTROL-NAME               PIC X(30).
  6842         16  AM-EXECUTIVE-ONE.
  6843             20  AM-EXEC1-NAME             PIC X(15).
  6844             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6845                                                          COMP-3.
  6846             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6847                                                          COMP-3.
  6848         16  AM-EXECUTIVE-TWO.
  6849             20  AM-EXEC2-NAME             PIC X(15).
  6850             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6851                                                          COMP-3.
  6852             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6853                                                          COMP-3.
  6854
  6855     12  AM-RETRO-ADDITIONAL-DATA.
  6856         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6857         16  AM-RETRO-PREM-P-E             PIC X.
  6858         16  AM-RETRO-CLMS-P-I             PIC X.
  6859         16  AM-RETRO-RET-BRACKET-LF.
  6860             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6861                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6862                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6863             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6864                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6865                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6866             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6867                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6868                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6869         16  AM-RETRO-RET-BRACKET-AH.
  6870             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6871                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6872                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6873                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6874             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6875                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6876                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6877             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6878                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6879                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6880
  6881     12  AM-COMMENTS.
  6882         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 126
* EL050.cbl
  6883
  6884     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6885         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6886         16  AM-FLI-BILLING-CODE           PIC X.
  6887         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6888         16  AM-FLI-UNITED-IDENT           PIC X.
  6889         16  AM-FLI-INTEREST-LOST-DATA.
  6890             20  AM-FLI-BANK-NO            PIC X(5).
  6891             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6892             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6893             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6894         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6895             20  AM-FLI-AGT                PIC X(9).
  6896             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6897             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6898         16  FILLER                        PIC X(102).
  6899
  6900     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6901         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6902             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6903             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6904             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6905             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6906             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6907         16  FILLER                          PIC X(10).
  6908******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 127
* EL050.cbl
  6910*    COPY ERCREIN.
  6911******************************************************************
  6912*                                                                *
  6913*                            ERCREIN                             *
  6914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6915*                            VMOD=2.010                          *
  6916*                                                                *
  6917*   ONLINE CREDIT SYSTEM                                         *
  6918*                                                                *
  6919*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6920*                                                                *
  6921*   FILE TYPE = VSAM,KSDS                                        *
  6922*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6923*                                                                *
  6924*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6925*       ALTERNATE PATH = NONE                                    *
  6926*                                                                *
  6927*   LOG = NO                                                     *
  6928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6929*                                                                *
  6930******************************************************************
  6931*                   C H A N G E   L O G
  6932*
  6933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6934*-----------------------------------------------------------------
  6935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6936* EFFECTIVE    NUMBER
  6937*-----------------------------------------------------------------
  6938* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6939* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6940******************************************************************
  6941 01  REINSURANCE-RECORD.
  6942     12  RE-RECORD-ID                      PIC XX.
  6943         88  VALID-RE-ID                      VALUE 'RE'.
  6944
  6945     12  RE-CONTROL-PRIMARY.
  6946         16  RE-COMPANY-CD                 PIC X.
  6947         16  RE-KEY.
  6948             20  RE-CODE                   PIC X.
  6949                 88  RE-TABLE-RECORD          VALUE 'A'.
  6950                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6951             20  RE-TABLE                  PIC XXX.
  6952             20  FILLER                    PIC XXX.
  6953         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6954             20  FILLER                    PIC X.
  6955             20  RE-COMPANY.
  6956                 24  RE-COMP-PRIME         PIC XXX.
  6957                 24  RE-COMP-SUB           PIC XXX.
  6958
  6959     12  RE-MAINT-INFORMATION.
  6960         16  RE-LAST-MAINT-DT              PIC XX.
  6961         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6962         16  RE-LAST-MAINT-USER            PIC X(4).
  6963         16  FILLER                        PIC X(10).
  6964
  6965     12  RE-TABLE-DATA.
  6966         16  RE-100-COMP                   PIC 99.
  6967
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 128
* EL050.cbl
  6968         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6969             20  RE-REI-COMP-NO.
  6970                 24  RE-REI-COMP           PIC XXX.
  6971                 24  RE-REI-COMP-SUB       PIC XXX.
  6972             20  RE-LF-QC                  PIC X.
  6973             20  RE-AH-QC                  PIC X.
  6974             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6975             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6976             20  RE-LFAGE-LO               PIC 99.
  6977             20  RE-LFAGE-HI               PIC 99.
  6978             20  RE-AHAGE-LO               PIC 99.
  6979             20  RE-AHAGE-HI               PIC 99.
  6980             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6981             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6982             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6983             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6984             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6985             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6986             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6987             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6988             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6989             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6990             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6991             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6992             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6993             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6994             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6995             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6996             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6997             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6998             20  RE-LF-BEN-CODE            PIC X.
  6999             20  RE-AH-BEN-CODE            PIC X.
  7000             20  RE-INTERACTIVE            PIC X.
  7001             20  RE-REMAINING              PIC X.
  7002             20  RE-LF-RUNOFF-SW           PIC X.
  7003             20  RE-AH-RUNOFF-SW           PIC X.
  7004             20  FILLER                    PIC X(19).
  7005
  7006         16  RE-COMP-INFO-END              PIC X(6).
  7007         16  RE-NSP-ST-CD-LF               PIC XX.
  7008         16  RE-NSP-ST-CD-AH               PIC XX.
  7009         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7010             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7011
  7012         16  FILLER                        PIC X(27).
  7013
  7014     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7015         16  RE-NAME                       PIC X(30).
  7016         16  RE-LF-PE                      PIC X.
  7017         16  RE-AH-PE                      PIC X.
  7018         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7019         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7020         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7021         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7022         16  RE-PRT-ST                     PIC X.
  7023         16  RE-PRT-OW                     PIC X.
  7024         16  RE-MORT-CODE                  PIC X(4).
  7025         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 129
* EL050.cbl
  7026         16  RE-ZERO-LF-FEE                PIC X.
  7027         16  RE-ZERO-AH-FEE                PIC X.
  7028         16  RE-CEDE-NAME                  PIC X(30).
  7029         16  RE-LF-COMM                    PIC X.
  7030         16  RE-AH-COMM                    PIC X.
  7031         16  RE-LF-TAX                     PIC X.
  7032         16  RE-AH-TAX                     PIC X.
  7033         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7034         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7035         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7036
  7037         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7038             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7039
  7040         16  RE-LF-CEDING-FEE-BRACKETS.
  7041             20  RE-LF-FEE-METHOD          PIC X.
  7042                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7043                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7044                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7045                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7046             20  RE-LF-FEE-BASIS           PIC X.
  7047                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7048                 88  RE-LF-NET-CEDED               VALUE '2'.
  7049                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7050                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7051                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7052                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7053                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7054                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7055             20  FILLER                    PIC XXX.
  7056             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7057                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7058                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7059
  7060         16  RE-AH-CEDING-FEE-BRACKETS.
  7061             20  RE-AH-FEE-METHOD          PIC X.
  7062                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7063                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7064                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7065                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7066             20  RE-AH-FEE-BASIS           PIC X.
  7067                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7068                 88  RE-AH-NET-CEDED               VALUE '2'.
  7069                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7070                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7071                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7072                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7073                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7074                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7075             20  FILLER                    PIC XXX.
  7076             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7077                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7078                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7079
  7080         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7081
  7082         16  RE-OLD-CEDING-STMT            PIC X.
  7083
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 130
* EL050.cbl
  7084         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7085         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7086         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7087         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7088         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7089         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7090         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7091         16  RE-MORT-SW                    PIC X.
  7092         16  RE-CEDING-TYPE-FLAG           PIC X.
  7093             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7094             88  RE-CEDED                          VALUE 'C'.
  7095             88  RE-ASSUMED                        VALUE 'A'.
  7096             88  RE-PHANTOM                        VALUE 'P'.
  7097
  7098         16  RE-CEDING-STMT-OPT-A          PIC X.
  7099             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7100         16  RE-CEDING-STMT-OPT-B          PIC X.
  7101             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7102         16  RE-CEDING-STMT-OPT-C          PIC X.
  7103             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7104         16  RE-CEDING-STMT-OPT-D          PIC X.
  7105             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7106         16  RE-CEDING-STMT-OPT-E          PIC X.
  7107             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7108
  7109         16  RE-PRT-CRSV                   PIC X.
  7110
  7111         16  RE-GL-CENTER                  PIC X(4).
  7112
  7113         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7114
  7115         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7116
  7117         16  RE-EARN-STOP-CODE             PIC X.
  7118             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7119             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7120
  7121         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7122             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7123
  7124         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7125         16  FILLER                        PIC X(2281).
  7126
  7127         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7128
  7129******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 131
* EL050.cbl
  7131*    COPY ERCCTBL.
  7132******************************************************************
  7133*                                                                *
  7134*                                                                *
  7135*                            ERCCTBL                             *
  7136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7137*                            VMOD=2.003
  7138*                                                                *
  7139*   ONLINE CREDIT SYSTEM                                         *
  7140*                                                                *
  7141*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7142*                                                                *
  7143*   FILE TYPE = VSAM,KSDS                                        *
  7144*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7145*                                                                *
  7146*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7147*       ALTERNATE PATH = NONE                                    *
  7148*                                                                *
  7149*   LOG = NO                                                     *
  7150*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7151*                                                                *
  7152*                                                                *
  7153******************************************************************
  7154
  7155 01  COMM-TABLE-RECORD.
  7156     12  CT-RECORD-ID                      PIC XX.
  7157         88  VALID-CT-ID                      VALUE 'CT'.
  7158
  7159     12  CT-CONTROL-PRIMARY.
  7160         16  CT-COMPANY-CD                 PIC X.
  7161         16  CT-TABLE                      PIC XXX.
  7162         16  CT-CNTRL-2.
  7163             20  CT-BEN-TYPE               PIC X.
  7164             20  CT-BEN-CODE               PIC XX.
  7165
  7166     12  CT-MAINT-INFORMATION.
  7167         16  CT-LAST-MAINT-DT              PIC XX.
  7168         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7169         16  CT-LAST-MAINT-USER            PIC X(4).
  7170         16  FILLER                        PIC X(31).
  7171
  7172     12  CT-LIMITS.
  7173         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7174
  7175         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7176
  7177         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7178
  7179     12  CT-RATES.
  7180         16  CT-RTX          OCCURS 27 TIMES.
  7181             20  CT-RT                     PIC SV9(5)     COMP-3.
  7182             20  CT-RT-R   REDEFINES
  7183                 CT-RT                     PIC XXX.
  7184
  7185     12  FILLER                            PIC  X(42).
  7186
  7187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 132
* EL050.cbl
  7189*    COPY ERCFORM.
  7190******************************************************************
  7191*                                                                *
  7192*                                                                *
  7193*                            ERCFORM.                            *
  7194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7195*                            VMOD=2.003                          *
  7196*                                                                *
  7197*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7198*                                                                *
  7199*    FILE TYPE = VSAM,KSDS                                       *
  7200*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7201*                                                                *
  7202*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7203*                                                                *
  7204*    LOG = YES                                                   *
  7205*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7206******************************************************************
  7207 01  FORM-MASTER.
  7208    12  FO-RECORD-ID                 PIC X(02).
  7209        88  VALID-FO-ID                  VALUE 'FO'.
  7210
  7211    12  FO-CONTROL-PRIMARY.
  7212        16  FO-COMPANY-CD            PIC X(01).
  7213        16  FO-STATE                 PIC X(02).
  7214        16  FO-FORM-ID               PIC X(12).
  7215        16  FO-FORM-EXP-DT           PIC X(02).
  7216
  7217    12  FO-POLICY-FORM-DATA.
  7218        16  FO-IND-GRP-CD            PIC X(01).
  7219        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7220        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7221        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7222        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7223        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7224        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7225        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7226        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7227        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7228        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7229        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7230        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7231        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7232        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7233        16  FO-APP-CERT-USE-CD       PIC X(01).
  7234
  7235    12  FILLER                       PIC X(29).
  7236
  7237    12  FO-FORM-PLAN-TABLE.
  7238        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7239            20  FO-PLAN-TYPE         PIC X(01).
  7240            20  FO-PLAN-ID           PIC X(02).
  7241            20  FO-PLAN-TERM         PIC 9(03).
  7242            20  FO-PLAN-REFUND-METHOD
  7243                                     PIC X.
  7244
  7245    12  FILLER                       PIC X(30).
  7246
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 133
* EL050.cbl
  7247    12  FO-COMMENTS-AREA.
  7248        16  FO-COMMENT-LINE-1        PIC X(78).
  7249
  7250    12  FILLER                       PIC X(20).
  7251
  7252    12  FO-MAINT-INFORMATION.
  7253        16  FO-LAST-MAINT-DT         PIC X(02).
  7254        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7255        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 134
* EL050.cbl
  7257*    COPY ELCMSTR.
  7258******************************************************************
  7259*                                                                *
  7260*                            ELCMSTR.                            *
  7261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7262*                            VMOD=2.012                          *
  7263*                                                                *
  7264*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7265*                                                                *
  7266*   FILE TYPE = VSAM,KSDS                                        *
  7267*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7268*                                                                *
  7269*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7270*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7271*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7272*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7273*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7274*                                                 RKP=75,LEN=21  *
  7275*                                                                *
  7276*   **** NOTE ****                                               *
  7277*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7278*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7279*                                                                *
  7280*   LOG = YES                                                    *
  7281*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7282******************************************************************
  7283*                   C H A N G E   L O G
  7284*
  7285* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7286*-----------------------------------------------------------------
  7287*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7288* EFFECTIVE    NUMBER
  7289*-----------------------------------------------------------------
  7290* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7291* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7292* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7293******************************************************************
  7294 01  CLAIM-MASTER.
  7295     12  CL-RECORD-ID                PIC XX.
  7296         88  VALID-CL-ID         VALUE 'CL'.
  7297
  7298     12  CL-CONTROL-PRIMARY.
  7299         16  CL-COMPANY-CD           PIC X.
  7300         16  CL-CARRIER              PIC X.
  7301         16  CL-CLAIM-NO             PIC X(7).
  7302         16  CL-CERT-NO.
  7303             20  CL-CERT-PRIME       PIC X(10).
  7304             20  CL-CERT-SFX         PIC X.
  7305
  7306     12  CL-CONTROL-BY-NAME.
  7307         16  CL-COMPANY-CD-A1        PIC X.
  7308         16  CL-INSURED-LAST-NAME    PIC X(15).
  7309         16  CL-INSURED-NAME.
  7310             20  CL-INSURED-1ST-NAME PIC X(12).
  7311             20  CL-INSURED-MID-INIT PIC X.
  7312
  7313     12  CL-CONTROL-BY-SSN.
  7314         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 135
* EL050.cbl
  7315         16  CL-SOC-SEC-NO.
  7316             20  CL-SSN-STATE        PIC XX.
  7317             20  CL-SSN-ACCOUNT      PIC X(6).
  7318             20  CL-SSN-LN3          PIC X(3).
  7319
  7320     12  CL-CONTROL-BY-CERT-NO.
  7321         16  CL-COMPANY-CD-A4        PIC X.
  7322         16  CL-CERT-NO-A4.
  7323             20  CL-CERT-A4-PRIME    PIC X(10).
  7324             20  CL-CERT-A4-SFX      PIC X.
  7325
  7326     12  CL-CONTROL-BY-CCN.
  7327         16  CL-COMPANY-CD-A5        PIC X.
  7328         16  CL-CCN-A5.
  7329             20  CL-CCN.
  7330                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7331                 24  CL-CCN-PRIME-A5 PIC X(12).
  7332             20  CL-CCN-FILLER-A5    PIC X(4).
  7333
  7334     12  CL-INSURED-PROFILE-DATA.
  7335         16  CL-INSURED-BIRTH-DT     PIC XX.
  7336         16  CL-INSURED-SEX-CD       PIC X.
  7337             88  INSURED-IS-MALE        VALUE 'M'.
  7338             88  INSURED-IS-FEMALE      VALUE 'F'.
  7339             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7340         16  CL-INSURED-OCC-CD       PIC X(6).
  7341         16  FILLER                  PIC X(5).
  7342
  7343     12  CL-PROCESSING-INFO.
  7344         16  CL-PROCESSOR-ID         PIC X(4).
  7345         16  CL-CLAIM-STATUS         PIC X.
  7346             88  CLAIM-IS-OPEN          VALUE 'O'.
  7347             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7348         16  CL-CLAIM-TYPE           PIC X.
  7349*            88  AH-CLAIM               VALUE 'A'.
  7350*            88  LIFE-CLAIM             VALUE 'L'.
  7351*            88  PROPERTY-CLAIM         VALUE 'P'.
  7352*            88  IUI-CLAIM              VALUE 'I'.
  7353*            88  GAP-CLAIM              VALUE 'G'.
  7354         16  CL-CLAIM-PREM-TYPE      PIC X.
  7355             88  SINGLE-PREMIUM         VALUE '1'.
  7356             88  O-B-COVERAGE           VALUE '2'.
  7357             88  OPEN-END-COVERAGE      VALUE '3'.
  7358         16  CL-INCURRED-DT          PIC XX.
  7359         16  CL-REPORTED-DT          PIC XX.
  7360         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7361         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7362         16  CL-LAST-PMT-DT          PIC XX.
  7363         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7364         16  CL-PAID-THRU-DT         PIC XX.
  7365         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7366         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7367         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7368         16  CL-PMT-CALC-METHOD      PIC X.
  7369             88  CL-360-DAY-YR          VALUE '1'.
  7370             88  CL-365-DAY-YR          VALUE '2'.
  7371             88  CL-FULL-MONTHS         VALUE '3'.
  7372         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 136
* EL050.cbl
  7373
  7374         16  CL-PRIME-CERT-NO.
  7375             20  CL-PRIME-CERT-PRIME PIC X(10).
  7376             20  CL-PRIME-CERT-SFX   PIC X.
  7377
  7378         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7379             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7380             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7381
  7382         16  CL-MICROFILM-NO         PIC X(10).
  7383         16  CL-PROG-FORM-TYPE       PIC X.
  7384         16  CL-LAST-ADD-ON-DT       PIC XX.
  7385
  7386         16  CL-LAST-REOPEN-DT       PIC XX.
  7387         16  CL-LAST-CLOSE-DT        PIC XX.
  7388         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7389             88  FINAL-PAID             VALUE '1'.
  7390             88  CLAIM-DENIED           VALUE '2'.
  7391             88  AUTO-CLOSE             VALUE '3'.
  7392             88  MANUAL-CLOSE           VALUE '4'.
  7393             88  BENEFITS-CHANGED       VALUE 'C'.
  7394             88  SETUP-ERRORS           VALUE 'E'.
  7395         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7396         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7397         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7398             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7399         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7400         16  FILLER                  PIC X.
  7401
  7402     12  CL-CERTIFICATE-DATA.
  7403         16  CL-CERT-ORIGIN          PIC X.
  7404             88  CERT-WAS-ONLINE        VALUE '1'.
  7405             88  CERT-WAS-CREATED       VALUE '2'.
  7406             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7407         16  CL-CERT-KEY-DATA.
  7408             20  CL-CERT-CARRIER     PIC X.
  7409             20  CL-CERT-GROUPING    PIC X(6).
  7410             20  CL-CERT-STATE       PIC XX.
  7411             20  CL-CERT-ACCOUNT.
  7412                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7413                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7414             20  CL-CERT-EFF-DT      PIC XX.
  7415
  7416     12  CL-STATUS-CONTROLS.
  7417         16  CL-PRIORITY-CD          PIC X.
  7418             88  CONFIDENTIAL-DATA      VALUE '8'.
  7419             88  HIGHEST-PRIORITY       VALUE '9'.
  7420         16  CL-SUPV-ATTN-CD         PIC X.
  7421             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7422             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7423         16  CL-PURGED-DT            PIC XX.
  7424         16  CL-RESTORED-DT          PIC XX.
  7425         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7426         16  CL-NEXT-RESEND-DT       PIC XX.
  7427         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7428         16  CL-CRITICAL-PERIOD      PIC 99.
  7429*        16  FILLER                  PIC XX.
  7430         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 137
* EL050.cbl
  7431         16  CL-LAST-MAINT-USER      PIC X(4).
  7432         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7433         16  CL-LAST-MAINT-TYPE      PIC X.
  7434             88  CLAIM-SET-UP           VALUE ' '.
  7435             88  PAYMENT-MADE           VALUE '1'.
  7436             88  LETTER-SENT            VALUE '2'.
  7437             88  MASTER-WAS-ALTERED     VALUE '3'.
  7438             88  MASTER-WAS-RESTORED    VALUE '4'.
  7439             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7440             88  FILE-CONVERTED         VALUE '6'.
  7441             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7442             88  ERROR-CORRECTION       VALUE 'E'.
  7443         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7444         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7445         16  CL-BENEFICIARY          PIC X(10).
  7446         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7447         16  CL-DENIAL-TYPE          PIC X.
  7448             88  CL-TYPE-DENIAL          VALUE '1'.
  7449             88  CL-TYPE-RESCISSION      VALUE '2'.
  7450             88  CL-TYPE-REFORMATION     VALUE '3'.
  7451             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7452             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7453         16  CL-CRIT-PER-RECURRENT   PIC X.
  7454         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7455         16  CL-RTW-DT               PIC XX.
  7456
  7457     12  CL-TRAILER-CONTROLS.
  7458         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7459             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7460             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7461             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7462         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7463         16  FILLER                  PIC XX.
  7464         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7465         16  CL-ADDRESS-TRAILER-CNT.
  7466             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7467                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7468             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7469                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7470             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7471                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7472             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7473                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7474             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7475                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7476             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7477                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7478             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7479                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7480
  7481     12  CL-CV-REFERENCE-NO.
  7482         16  CL-CV-REFNO-PRIME       PIC X(18).
  7483         16  CL-CV-REFNO-SFX         PIC XX.
  7484
  7485     12  CL-FILE-LOCATION            PIC X(4).
  7486
  7487     12  CL-PROCESS-ERRORS.
  7488         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 138
* EL050.cbl
  7489             88  NO-FATAL-ERRORS        VALUE ZERO.
  7490         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7491             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7492
  7493     12  CL-PRODUCT-CD               PIC X.
  7494
  7495     12  CL-CURRENT-KEY-DATA.
  7496         16  CL-CURRENT-CARRIER      PIC X.
  7497         16  CL-CURRENT-GROUPING     PIC X(6).
  7498         16  CL-CURRENT-STATE        PIC XX.
  7499         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7500
  7501     12  CL-ASSOCIATES               PIC X.
  7502         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7503         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7504         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7505         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7506
  7507     12  CL-ACTIVITY-CODE            PIC 99.
  7508     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7509     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7510
  7511     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7512     12  CL-LAG-REPORT-CODE          PIC 9.
  7513     12  CL-LOAN-TYPE                PIC XX.
  7514     12  CL-LEGAL-STATE              PIC XX.
  7515
  7516     12  CL-YESNOSW                  PIC X.
  7517     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7518         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7519         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7520         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7521     12  cl-insured-claim            pic x.
  7522         88  cl-claim-on-primary         value 'P'.
  7523         88  cl-claim-on-secondary       value 'S'.
  7524     12  cl-benefit-expiration-dt    PIC XX.
  7525
  7526 01  PLAN-RECORDS.
  7527     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7528     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7529
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 139
* EL050.cbl
  7531 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7532                          ACCOUNT-MASTER REINSURANCE-RECORD
  7533                          COMM-TABLE-RECORD FORM-MASTER
  7534                          CLAIM-MASTER PLAN-RECORDS.
  7535 0000-DFHEXIT SECTION.
  7536     MOVE '9#                    $   ' TO DFHEIV0.
  7537     MOVE 'EL050' TO DFHEIV1.
  7538     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7539
  7540     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7541
  7542
  7543* EXEC CICS  HANDLE CONDITION
  7544*           ERROR    (9300-ABEND)
  7545*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7546*    END-EXEC.
  7547*    MOVE '"$.J                  ! " #00007538' TO DFHEIV0
  7548     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7550     MOVE X'2220233030303037353338' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0
  7552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7553
  7554
  7555 0000-COPY-PROCEDURE-DIV.
  7556*                          COPY ELC50PD.
  7557******************************************************************
  7558*                                                                *
  7559*                            ELC50PD                             *
  7560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7561*                            VMOD=2.188                          *
  7562*                                                                *
  7563******************************************************************
  7564*                   C H A N G E   L O G
  7565*
  7566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7567*-----------------------------------------------------------------
  7568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7569* EFFECTIVE    NUMBER
  7570*-----------------------------------------------------------------
  7571* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7572* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7573* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7574*                             2709 AND 2718
  7575* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7576* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7577* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7578* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7579* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7580*                                IS OPEN OR CNC DT < PD THRU
  7581* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7582* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7583* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7584* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7585* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7586* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7587* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7588* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 140
* EL050.cbl
  7589* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7590* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7591* 020906                   PEMA  EXPAND LOAN OFFICER
  7592* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7593* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7594* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7595* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7596* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7597* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7598* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7599* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7600* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7601* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7602* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7603* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7604* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7605* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7606* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7607* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7608* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7609* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7610* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7611* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7612* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7613* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7614* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7615* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7616* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7617*                                UPDATE VIN ON CERT TRAILER
  7618* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7619* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7620* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7621* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7622* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7623* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7624* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7625* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7626* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7627* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7628* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7629* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7630* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7631* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7632* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7633* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7634* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7635* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7636* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7637* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7638* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7639* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7640* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7641* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7642* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7643* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7644* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7645* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7646* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 141
* EL050.cbl
  7647* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7648* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7649* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7650* 032912  CR2011110200001  PEMA  AHL CHANGES
  7651* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7652* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7653* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7654* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7655* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7656* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7657* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7658* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7659* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7660* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7661* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7662* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7663* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7664* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7665* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7666* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7667* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7668* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7669* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7670* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7671* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7672******************************************************************
  7673************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7674******************************************************************
  7675
  7676     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7677
  7678     MOVE SPACES                 TO PB-FATAL-FLAG
  7679                                    PB-FORCE-ER-CD
  7680                                    PB-WARN-ER-CD
  7681                                    PB-OUT-BAL-CD.
  7682
  7683     MOVE SPACE                  TO WS-IG-OVRD-AH
  7684                                    WS-IG-OVRD-LF
  7685                                    WS-IG-OVRD-AM
  7686                                    WS-IG-OVRD
  7687                                    WS-IG-OVRD-AH-PL
  7688                                    WS-IG-OVRD-LF-PL
  7689                                    WS-IG-OVRD-AH-BEN
  7690                                    WS-IG-OVRD-LF-BEN.
  7691
  7692******************************************************************
  7693*************       INITIALIZE COMMON ERRORS       ***************
  7694******************************************************************
  7695
  7696     MOVE +0                     TO PB-NO-OF-ERRORS.
  7697     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7698
  7699******************************************************************
  7700
  7701     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7702     SET JULIAN-TO-BIN           TO TRUE.
  7703*    MOVE 5                      TO DC-OPTION-CODE.
  7704     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 142
* EL050.cbl
  7705     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7706
  7707     MOVE ZERO                   TO  SUB4.
  7708
  7709 0040-INITIALIZE-GA-BILL-DT.
  7710
  7711     ADD +1                      TO  SUB4.
  7712
  7713     IF  SUB4 GREATER THAN +5
  7714         GO TO 0050-CHECK-CNTL-FOUND.
  7715
  7716     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7717         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7718
  7719     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7720
  7721 0050-CHECK-CNTL-FOUND.
  7722
  7723     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7724        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7725                                         WS-AH-REM-TERM-CALC
  7726                                         EC-CO-REM-TERM-CALC
  7727        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7728        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7729        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7730                                         WS-TOL-AH-CLAIM
  7731        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7732                                         WS-TOL-AH-PREM
  7733                                         EC-CO-TOL-PREM
  7734        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7735                                         WS-TOL-AH-REFUND
  7736                                         EC-CO-TOL-REFUND
  7737        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7738                                         WS-AH-REFUND-OVS-AMT
  7739                                         EC-CO-OVR-SHT-AMT
  7740        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7741                                         WS-TOL-AH-PREM-PCT
  7742                                         EC-CO-TOL-PREM-PCT
  7743        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7744                                         WS-TOL-AH-REFUND-PCT
  7745                                         EC-CO-TOL-REFUND-PCT
  7746        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7747                                         WS-AH-REFUND-OVS-PCT
  7748                                         EC-CO-OVR-SHT-PCT
  7749        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7750        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7751        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7752        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7753        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7754        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7755        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7756        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7757        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7758        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7759        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7760        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7761                                         EC-CO-MONTH-END-DT
  7762        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 143
* EL050.cbl
  7763          GO TO 0100-READ-ACCT.
  7764
  7765     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7766     MOVE SPACES                 TO CNTL-ACCESS.
  7767     MOVE '1'                    TO CNTL-REC-TYPE.
  7768     MOVE +0                     TO CNTL-SEQ-NO.
  7769
  7770     MOVE '1' TO RC-SW-1.
  7771     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7772     IF NOT CF-COMPANY-MASTER
  7773         MOVE ZEROS             TO WK-CO-TOL-PREM
  7774                                   WK-CO-TOL-CLAIM
  7775                                   WK-CO-TOL-REFUND
  7776                                   WK-REFUND-OVS-AMT
  7777                                   WK-REFUND-OVS-PCT
  7778                                   WK-CO-TOL-PREM-PCT
  7779                                   WK-CO-TOL-REFUND-PCT
  7780                                   WK-DEFAULT-APR
  7781                                   WK-CO-MAX-CAP
  7782        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7783                                   WK-CR-R78-METHOD
  7784                                   WK-CO-REF-REJECT-SW
  7785                                   WK-CO-PREM-REJECT-SW
  7786                                   WK-REM-TRM-CALC-OPTION
  7787                                   WK-BIRTH-DATE-INPUT
  7788                                   WK-JOINT-AGE-INPUT
  7789        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7790        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7791        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7792        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7793          GO TO 0099-COMPANY-NOT-FOUND.
  7794
  7795     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7796        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7797     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7798        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7799     IF CF-CO-TOL-CAP NOT NUMERIC
  7800        MOVE +0                    TO CF-CO-TOL-CAP.
  7801     IF CF-DEFAULT-APR NOT NUMERIC
  7802        MOVE +0                    TO CF-DEFAULT-APR.
  7803
  7804     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7805     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7806     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7807     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7808     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7809     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7810     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7811     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7812     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7813     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7814     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7815     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7816
  7817     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7818          CF-CO-OVR-SHT-AMT > +0
  7819        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7820
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 144
* EL050.cbl
  7821     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7822          CF-CO-OVR-SHT-PCT > +0
  7823        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7824
  7825     IF CF-VALID-REM-TRM-OPTION
  7826         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7827     ELSE
  7828         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7829
  7830     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7831     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7832     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7833     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7834
  7835     GO TO 0050-CHECK-CNTL-FOUND.
  7836
  7837 0099-COMPANY-NOT-FOUND.
  7838
  7839     MOVE ER-2616                TO WS-ERROR.
  7840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7841
  7842 0100-READ-ACCT.
  7843
  7844     MOVE SPACES                 TO DATE-RANGE-SW.
  7845
  7846     IF WK-ACCT-ADDR = ZEROS
  7847        GO TO 0102-ACCT-GETMAIN.
  7848
  7849     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7850     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7851     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7852
  7853     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7854        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7855        GO TO 0105-READ-ACCT
  7856     END-IF
  7857
  7858     IF PB-CARRIER NOT = SPACES
  7859        IF PB-CARRIER NOT = AM-VG-CARRIER
  7860           GO TO 0105-READ-ACCT.
  7861
  7862     IF PB-STATE NOT = SPACES
  7863        IF PB-STATE NOT = AM-VG-STATE
  7864           GO TO 0105-READ-ACCT.
  7865
  7866     IF PB-GROUPING NOT = SPACES
  7867        IF PB-GROUPING NOT = AM-VG-GROUPING
  7868           GO TO 0105-READ-ACCT.
  7869
  7870     MOVE 'X'                 TO DATE-RANGE-SW.
  7871
  7872     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7873        MOVE 'X'                 TO DATE-RANGE-SW
  7874        GO TO 0105-READ-ACCT.
  7875
  7876     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7877        GO TO 0105-READ-ACCT.
  7878
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 145
* EL050.cbl
  7879     GO TO 0180-ACCOUNT-FOUND.
  7880
  7881 0102-ACCT-GETMAIN.
  7882     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7883     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7884
  7885 0105-READ-ACCT.
  7886     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7887     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7888     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7889     MOVE PB-STATE               TO ACCT-STATE.
  7890     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7891     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7892
  7893     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7894
  7895     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7896
  7897 0110-FIND-ACCT-TOLERANCES-LOOP.
  7898     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7899
  7900     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7901        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7902        GO TO 0199-ACCT-NOT-FOUND
  7903     END-IF
  7904     IF PB-CARRIER NOT = SPACES
  7905        IF PB-CARRIER NOT = AM-VG-CARRIER
  7906           GO TO 0199-ACCT-NOT-FOUND.
  7907
  7908     IF PB-STATE NOT = SPACES
  7909        IF PB-STATE NOT = AM-VG-STATE
  7910           GO TO 0199-ACCT-NOT-FOUND.
  7911
  7912     IF PB-GROUPING NOT = SPACES
  7913        IF PB-GROUPING NOT = AM-VG-GROUPING
  7914           GO TO 0199-ACCT-NOT-FOUND.
  7915
  7916     MOVE 'X'                    TO DATE-RANGE-SW.
  7917
  7918     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7919        MOVE 'X'                 TO DATE-RANGE-SW
  7920        GO TO 0199-ACCT-NOT-FOUND.
  7921
  7922     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7923        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7924
  7925 0180-ACCOUNT-FOUND.
  7926     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7927     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7928     MOVE AM-STATE               TO PB-SV-STATE.
  7929     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7930
  7931     IF AM-CANCEL-FEE  NOT NUMERIC
  7932        MOVE ZEROS TO AM-CANCEL-FEE.
  7933
  7934     IF AM-MAX-MON-BEN NOT NUMERIC
  7935        MOVE ZEROS TO AM-MAX-MON-BEN.
  7936
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 146
* EL050.cbl
  7937     IF AM-MAX-TOT-BEN NOT NUMERIC
  7938        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7939
  7940     IF AM-CLP-TOL-PCT NOT NUMERIC
  7941        MOVE +0                  TO AM-CLP-TOL-PCT
  7942     END-IF
  7943     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7944        MOVE +0                  TO AM-SPP-LEASE-COMM
  7945     END-IF
  7946     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7947        MOVE ER-2611             TO   WS-ERROR
  7948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7949
  7950     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7951        MOVE ER-2621             TO   WS-ERROR
  7952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7953
  7954     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7955        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7956        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7957        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7958         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7959
  7960     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7961     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7962     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7963     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7964     IF AM-CLP-TOL-PCT NOT = ZEROS
  7965        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7966     END-IF
  7967     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7968        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7969     END-IF
  7970*    IF PB-COMPANY-ID = 'DCC'
  7971*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7972*                                   WS-ADMIN-FEES
  7973*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7974*          (SUB5 > +10)
  7975*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7976*             AND (AM-A-COM (SUB5) NUMERIC)
  7977*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7978*                + (AM-A-COM (SUB5) * 1000)
  7979*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7980*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7981*                + (AM-A-COM (SUB5) * 1000)
  7982*             END-IF
  7983*             IF AM-COM-TYP (SUB5) = 'N'
  7984*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7985*                + (AM-A-COM (SUB5) * 1000)
  7986*             END-IF
  7987*          END-IF
  7988*       END-PERFORM
  7989*    END-IF
  7990     IF (PB-COMPANY-ID = 'DCC')
  7991        AND (PB-ISSUE)
  7992        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7993        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7994           (SUB5 > +10)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 147
* EL050.cbl
  7995           MOVE +0 TO WS-WK-RATE
  7996           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7997              IF (AM-A-COM (SUB5) NUMERIC)
  7998                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7999                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8000              ELSE
  8001                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8002                 IF PB-ISSUE
  8003                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8004                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8005                 ELSE
  8006                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8007                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8008                 END-IF
  8009                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8010                 MOVE ZEROS             TO WS-SUB1
  8011                                           WS-COMMISSION
  8012                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8013                 MOVE '0530'               TO CTBL-SW
  8014                 MOVE ' '                  TO WS-CTBL-READ-SW
  8015                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8016                 IF FIRST-TIME-THROUGH
  8017                    MOVE 'AA'              TO CTBL-BEN-CODE
  8018                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8019                 END-IF
  8020                 IF CTBL-TABLE-FOUND
  8021                    IF PB-ISSUE
  8022                       COMPUTE WS-COMM-CK-AMT =
  8023                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8024                    ELSE
  8025                       COMPUTE WS-COMM-CK-AMT =
  8026                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8027                    END-IF
  8028                    PERFORM 8800-GET-COMP-RATE
  8029                              THRU 8800-EXIT
  8030                 END-IF
  8031              END-IF
  8032              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8033                + (WS-WK-RATE * 1000)
  8034           END-IF
  8035        END-PERFORM
  8036     END-IF
  8037     IF PB-COMPANY-ID EQUAL 'CRI'
  8038         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8039
  8040     IF PB-COMPANY-ID EQUAL 'NCL'
  8041         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8042     END-IF
  8043
  8044     GO TO 0200-READ-CERT.
  8045
  8046 0199-ACCT-NOT-FOUND.
  8047
  8048     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8049
  8050     IF DATE-RANGE-SW NOT = SPACES
  8051        MOVE ER-2601             TO WS-ERROR
  8052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 148
* EL050.cbl
  8053     ELSE
  8054        MOVE ER-2619             TO WS-ERROR
  8055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8056
  8057     GO TO 9990-RETURN.
  8058
  8059 0200-READ-CERT.
  8060
  8061     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8062     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8063     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8064     MOVE PB-SV-STATE            TO CERT-STATE.
  8065     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8066     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8067     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8068
  8069     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8070
  8071     IF CERT-WAS-NOT-FOUND
  8072        GO TO 0299-CERT-NOT-FOUND.
  8073
  8074     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8075        MOVE ER-2759             TO WS-ERROR
  8076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8077        GO TO 0298-UNLOCK-RETURN.
  8078
  8079     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8080         MOVE ER-2758            TO WS-ERROR
  8081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8082         GO TO 0298-UNLOCK-RETURN.
  8083
  8084     IF PB-ISSUE
  8085        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8086           IF CERT-WAS-CREATED-FOR-CLAIM
  8087              NEXT SENTENCE
  8088            ELSE
  8089              MOVE ER-2626       TO WS-ERROR
  8090              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8091              GO TO 0298-UNLOCK-RETURN.
  8092
  8093     IF NOT PB-CANCELLATION
  8094        GO TO 0300-CONTINUE-EDIT.
  8095
  8096     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8097     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8098     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8099     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8100     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8101     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8102
  8103     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8104     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8105     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8106     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8107     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8108     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8109     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8110     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 149
* EL050.cbl
  8111     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8112
  8113     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8114     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8115     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8116     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8117     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8118     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8119     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8120
  8121     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8122     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8123
  8124     MOVE CM-CREDIT-INTERFACE-SW-1
  8125                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8126     MOVE CM-CREDIT-INTERFACE-SW-2
  8127                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8128
  8129     IF CM-O-B-COVERAGE
  8130         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8131
  8132     IF CM-LIVES NOT NUMERIC
  8133         MOVE ZERO                TO CM-LIVES.
  8134
  8135     IF CM-BILLED NOT NUMERIC
  8136         MOVE ZERO                TO CM-BILLED.
  8137
  8138     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8139         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8140         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8141         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8142         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8143         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8144         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8145         MOVE CM-LIVES             TO PB-CI-LIVES
  8146*The next line causes a problem with my change  I dont think it is
  8147*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8148
  8149     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8150     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8151     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8152     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8153     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8154     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8155
  8156     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8157     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8158     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8159     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8160
  8161     IF CM-LIFE-COMM-PCT NUMERIC
  8162         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8163     ELSE
  8164         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8165
  8166     IF CM-AH-COMM-PCT NUMERIC
  8167         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8168     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 150
* EL050.cbl
  8169         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8170
  8171     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8172
  8173     IF CM-LOAN-APR       NOT NUMERIC
  8174           MOVE ZERO               TO CM-LOAN-APR.
  8175
  8176     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8177           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8178
  8179     IF CM-LOAN-TERM      NOT NUMERIC
  8180           MOVE ZERO               TO CM-LOAN-TERM.
  8181
  8182     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8183           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8184
  8185     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8186           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8187
  8188     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8189     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8190     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8191     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8192     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8193     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8194     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8195     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8196     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8197     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8198     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8199     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8200
  8201     IF CM-STATE = CM-SSN-STATE
  8202         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8203
  8204     IF CM-STATE NOT = CM-MEMB-STATE
  8205         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8206
  8207     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8208
  8209     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8210        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8211        IF CM-ADDL-CLP NOT NUMERIC
  8212           MOVE +0               TO CM-ADDL-CLP
  8213        END-IF
  8214        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8215        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8216           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8217        END-IF
  8218     END-IF
  8219     IF PB-COMPANY-ID = 'DCC'
  8220        MOVE +0                  TO WS-ADMIN-FEES
  8221                                    WS-CSO-ADMIN-FEE
  8222                                    WS-COMM-AND-MFEE
  8223                                    WS-1ST-YR-ALLOW
  8224        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8225           (SUB5 > +10)
  8226           MOVE +0 TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 151
* EL050.cbl
  8227           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8228              IF (AM-A-COM (SUB5) NUMERIC)
  8229                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8230                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8231              ELSE
  8232                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8233                 IF PB-ISSUE
  8234                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8235                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8236                 ELSE
  8237                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8238                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8239                 END-IF
  8240                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8241                 MOVE ZEROS             TO WS-SUB1
  8242                                           WS-COMMISSION
  8243                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8244                 MOVE '0530'               TO CTBL-SW
  8245                 MOVE ' '                  TO WS-CTBL-READ-SW
  8246                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8247                 IF FIRST-TIME-THROUGH
  8248                    MOVE 'AA'              TO CTBL-BEN-CODE
  8249                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8250                 END-IF
  8251                 IF CTBL-TABLE-FOUND
  8252                    IF PB-ISSUE
  8253                       COMPUTE WS-COMM-CK-AMT =
  8254                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8255                    ELSE
  8256                       COMPUTE WS-COMM-CK-AMT =
  8257                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8258                    END-IF
  8259                    PERFORM 8800-GET-COMP-RATE
  8260                              THRU 8800-EXIT
  8261                 END-IF
  8262              END-IF
  8263              IF AM-COM-TYP (SUB5) = 'I'
  8264                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8265                   + (WS-WK-RATE * 1000)
  8266              END-IF
  8267              IF AM-COM-TYP (SUB5) = 'N'
  8268                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8269                   + (WS-WK-RATE * 1000)
  8270              END-IF
  8271              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8272                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8273                   + (WS-WK-RATE * 1000)
  8274              END-IF
  8275              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8276                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8277                   + (WS-WK-RATE * 1000)
  8278              END-IF
  8279           END-IF
  8280        END-PERFORM
  8281     END-IF
  8282     GO TO 0300-CONTINUE-EDIT.
  8283
  8284 0298-UNLOCK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 152
* EL050.cbl
  8285      PERFORM 9250-UNLOCK-RETURN
  8286      GO TO 9990-RETURN.
  8287
  8288 0299-CERT-NOT-FOUND.
  8289
  8290     MOVE '1'                     TO CERT-STATUS-SW.
  8291
  8292     IF PB-COMPANY-ID = 'UCL'
  8293         IF WS-ERROR = ER-2799
  8294             GO TO 3000-CONTINUE-EDIT.
  8295
  8296     IF NOT PB-CANCELLATION
  8297         GO TO 0300-CONTINUE-EDIT.
  8298
  8299     MOVE ER-2726                  TO  WS-ERROR.
  8300     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8301     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8302     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8303                                    PB-CI-LF-TERM
  8304                                    PB-C-LF-REM-TERM
  8305                                    PB-CI-AH-TERM
  8306                                    PB-C-AH-REM-TERM
  8307                                    PB-CI-LF-BENEFIT-CD
  8308                                    PB-CI-LF-BENEFIT-AMT
  8309                                    PB-CI-LF-ALT-BENEFIT-AMT
  8310                                    PB-CI-LF-PREMIUM-AMT
  8311                                    PB-CI-LF-ALT-PREMIUM-AMT
  8312                                    PB-CI-AH-BENEFIT-CD
  8313                                    PB-CI-AH-BENEFIT-AMT
  8314                                    PB-CI-AH-PREMIUM-AMT
  8315                                    PB-CI-PAY-FREQUENCY
  8316                                    PB-CI-LOAN-APR
  8317                                    PB-CI-LOAN-TERM
  8318                                    PB-CI-LIFE-COMMISSION
  8319                                    PB-CI-AH-COMMISSION
  8320                                    PB-CI-CURR-SEQ
  8321                                    PB-CI-AH-CANCEL-AMT
  8322                                    PB-CI-LF-CANCEL-AMT
  8323                                    PB-CI-RATE-DEV-PCT-LF
  8324                                    PB-CI-RATE-DEV-PCT-AH
  8325                                    PB-CI-EXTENTION-DAYS
  8326                                    PB-CI-TERM-IN-DAYS
  8327                                    PB-CI-LIVES
  8328                                    PB-CI-LF-CRIT-PER
  8329                                    PB-CI-AH-CRIT-PER
  8330                                    PB-CI-ADDL-CLP
  8331                                    PB-CI-DDF-IU-RATE-UP.
  8332
  8333     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8334                                    PB-CI-AH-SETTLEMENT-DT
  8335                                    PB-CI-DEATH-DT
  8336                                    PB-CI-LF-PRIOR-CANCEL-DT
  8337                                    PB-CI-AH-PRIOR-CANCEL-DT
  8338                                    PB-CI-ENTRY-DT
  8339                                    PB-CI-LF-EXPIRE-DT
  8340                                    PB-CI-AH-EXPIRE-DT
  8341                                    PB-CI-LOAN-1ST-PMT-DT.
  8342
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 153
* EL050.cbl
  8343     IF ACCOUNT-MAST-FOUND
  8344        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8345        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8346
  8347
  8348 0300-CONTINUE-EDIT.
  8349
  8350     IF PB-ISSUE
  8351        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8352            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8353
  8354     IF PB-ISSUE
  8355        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8356            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8357
  8358     IF PB-ISSUE
  8359       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8360          (AM-NO-AH-ONLY)
  8361           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8362               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8363                   MOVE ER-2679 TO WS-ERROR
  8364                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8365
  8366     IF PB-ISSUE
  8367        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8368        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8369        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8370     ELSE
  8371        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8372        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8373        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8374
  8375     MOVE 'N'                    TO PLAN-MASTER-SW
  8376                                    PLAN-MASTER-LIFE-SW
  8377                                    FORM-MASTER-SW
  8378                                    WS-APP-CERT-SW.
  8379
  8380     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8381                                    WS-PL-TOL-LF-REFUND
  8382                                    WS-PL-REF-OVS-AMT
  8383                                    WS-PL-TOL-LF-PREM-PCT
  8384                                    WS-PL-TOL-LF-REFUND-PCT
  8385                                    WS-PL-REF-OVS-PCT
  8386                                    WS-PL-TOL-LF-CLAIM.
  8387
  8388     IF PB-COMPANY-ID = 'NCL'
  8389       IF PB-ISSUE
  8390         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8391             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8392             IF FORM-MASTER-FOUND
  8393                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8394
  8395     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8396        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8397
  8398********************** MON CODE **********************
  8399     IF PB-COMPANY-ID = 'MON'
  8400     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 154
* EL050.cbl
  8401     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8402        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8403             PB-I-LOAN-APR = ZERO)
  8404               MOVE 14.0         TO PB-I-LOAN-APR.
  8405******************************************************
  8406
  8407     IF PB-COMPANY-ID = 'NCL'
  8408       IF PB-ISSUE
  8409           IF FORM-MASTER-FOUND
  8410             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8411                AM-DISMBR-COVERAGE
  8412                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8413                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8414                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8415                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8416                                           PB-I-LIFE-BENEFIT-CD.
  8417
  8418     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8419
  8420     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8421         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8422         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8423         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8424         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8425         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8426           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8427             GO TO 0301-LIFE-BENEFIT-SEARCH
  8428         ELSE
  8429             NEXT SENTENCE
  8430     ELSE
  8431         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8432
  8433     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8434     MOVE '4'                    TO CNTL-REC-TYPE.
  8435     MOVE +0                     TO CNTL-SEQ-NO.
  8436     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8437
  8438     MOVE '1' TO RC-SW-2.
  8439     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8440
  8441     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8442        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8443         GO TO 0305-BENEFIT-NOT-FOUND.
  8444
  8445     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8446
  8447 0301-LIFE-BENEFIT-SEARCH.
  8448
  8449     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8450
  8451     IF NO-BENEFIT-FOUND
  8452        GO TO 0305-BENEFIT-NOT-FOUND.
  8453
  8454     IF WS-BEN-CD = '99'
  8455        GO TO 0305-BENEFIT-NOT-FOUND.
  8456
  8457     IF PB-COMPANY-ID = 'NCL'
  8458         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 155
* EL050.cbl
  8459             GO TO 0304-LIFE-BENEFIT-FOUND.
  8460
  8461     MOVE +1                     TO SUB5.
  8462     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8463
  8464* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8465* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8466     IF PB-COMPANY-ID = 'DMD'
  8467         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8468
  8469 0302-EDIT-ACCT-LF-BENEFITS.
  8470
  8471     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8472        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8473           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8474                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8475           GO TO 03XX-GET-LIFE-ERPLAN.
  8476
  8477     IF SUB5 LESS THAN +20
  8478        ADD +1                   TO SUB5
  8479        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8480
  8481     MOVE +1                     TO SUB5.
  8482
  8483     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8484        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8485
  8486 0303-EDIT-DMD-EXTRA-BENEFITS.
  8487
  8488     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8489        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8490           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8491                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8492           GO TO 03XX-GET-LIFE-ERPLAN.
  8493
  8494     IF SUB5 LESS THAN +30
  8495        ADD +1                   TO SUB5
  8496        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8497
  8498     MOVE +1                     TO SUB5.
  8499
  8500 03XX-EDIT-FOR-NINETY-LF.
  8501
  8502***************************************************************
  8503*                                                             *
  8504*    NINETY BENEFIT PLAN TYPES:                               *
  8505*                                                             *
  8506*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8507*      92 = ALL GROUP REDUCING BENEFITS                       *
  8508*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8509*      94 = ALL GROUP LEVEL BENEFITS                          *
  8510*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8511*           BENEFIT CONTROLS.                                 *
  8512*      99 = ALL BENEFITS                                      *
  8513*                                                             *
  8514***************************************************************
  8515
  8516     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 156
* EL050.cbl
  8517                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8518
  8519     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8520       AND
  8521        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8522        GO TO 03XX-GET-LIFE-ERPLAN.
  8523
  8524     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8525       AND
  8526        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8527        IF CF-REDUCING (SUB3)
  8528           IF (PB-I-INDV-GRP-OVRD = 'I')
  8529              OR
  8530           ((AM-IG = '1') AND
  8531           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8532              OR
  8533           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8534           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8535           (AM-IG NOT = '2'))
  8536              GO TO 03XX-GET-LIFE-ERPLAN.
  8537
  8538     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8539       AND
  8540        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8541        IF CF-REDUCING (SUB3)
  8542           IF (PB-I-INDV-GRP-OVRD = 'G')
  8543              OR
  8544           ((AM-IG = '2') AND
  8545           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8546              OR
  8547           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8548           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8549           (AM-IG NOT = '1'))
  8550              GO TO 03XX-GET-LIFE-ERPLAN.
  8551
  8552     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8553       AND
  8554        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8555        IF CF-LEVEL    (SUB3)
  8556           IF (PB-I-INDV-GRP-OVRD = 'I')
  8557              OR
  8558           ((AM-IG = '1') AND
  8559           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8560              OR
  8561           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8562           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8563            (AM-IG NOT = '2'))
  8564              GO TO 03XX-GET-LIFE-ERPLAN.
  8565
  8566     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8567       AND
  8568        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8569        IF CF-LEVEL    (SUB3)
  8570           IF (PB-I-INDV-GRP-OVRD = 'G')
  8571              OR
  8572           ((AM-IG = '2') AND
  8573           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8574              OR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 157
* EL050.cbl
  8575           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8576           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8577           (AM-IG NOT = '1'))
  8578              GO TO 03XX-GET-LIFE-ERPLAN.
  8579
  8580     IF SUB5 LESS THAN +20
  8581        ADD +1                   TO SUB5
  8582        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8583
  8584     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8585
  8586     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8587        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8588
  8589     MOVE +1                     TO SUB5.
  8590
  8591 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8592
  8593     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8594                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8595
  8596     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8597       AND
  8598        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8599        GO TO 03XX-GET-LIFE-ERPLAN.
  8600
  8601     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8602       AND
  8603        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8604        IF CF-REDUCING (SUB3)
  8605           IF (PB-I-INDV-GRP-OVRD = 'I')
  8606              OR
  8607           ((AM-IG = '1') AND
  8608           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8609              OR
  8610           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8611           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8612           (AM-IG NOT = '2'))
  8613              GO TO 03XX-GET-LIFE-ERPLAN.
  8614
  8615     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8616       AND
  8617        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8618        IF CF-REDUCING (SUB3)
  8619           IF (PB-I-INDV-GRP-OVRD = 'G')
  8620              OR
  8621           ((AM-IG = '2') AND
  8622           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8623              OR
  8624           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8625           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8626           (AM-IG NOT = '1'))
  8627              GO TO 03XX-GET-LIFE-ERPLAN.
  8628
  8629     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8630       AND
  8631        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8632        IF CF-LEVEL    (SUB3)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 158
* EL050.cbl
  8633           IF (PB-I-INDV-GRP-OVRD = 'I')
  8634              OR
  8635           ((AM-IG = '1') AND
  8636           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8637              OR
  8638           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8639           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8640            (AM-IG NOT = '2'))
  8641              GO TO 03XX-GET-LIFE-ERPLAN.
  8642
  8643     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8644       AND
  8645        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8646        IF CF-LEVEL    (SUB3)
  8647           IF (PB-I-INDV-GRP-OVRD = 'G')
  8648              OR
  8649           ((AM-IG = '2') AND
  8650           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8651              OR
  8652           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8653           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8654           (AM-IG NOT = '1'))
  8655              GO TO 03XX-GET-LIFE-ERPLAN.
  8656
  8657     IF SUB5 LESS THAN +30
  8658        ADD +1                   TO SUB5
  8659        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8660
  8661     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8662
  8663 03XX-EDIT-FOR-NINETY-LF-CONT.
  8664
  8665     MOVE +99                    TO SUB5.
  8666
  8667     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8668        IF PB-ISSUE
  8669           MOVE ER-1924          TO  WS-ERROR
  8670           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8671
  8672     GO TO 0304-LIFE-BENEFIT-FOUND.
  8673
  8674 03XX-GET-LIFE-ERPLAN.
  8675
  8676     IF WK-PLAN-ADDR EQUAL +0
  8677        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8678
  8679     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8680     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8681     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8682     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8683     MOVE 'Y'                    TO PLAN-MASTER-SW
  8684                                    PLAN-MASTER-LIFE-SW.
  8685     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8686
  8687 03XX-ERPLAN-LIFE-GETMAIN.
  8688
  8689     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8690     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 159
* EL050.cbl
  8691
  8692 03XX-ERPLAN-LIFE-READ.
  8693
  8694     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8695     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8696     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8697     MOVE PB-SV-STATE            TO PLAN-STATE.
  8698     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8699     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8700     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8701     MOVE WS-SAVE-BENEFIT-REVISION
  8702                                 TO PLAN-REVISION-NO.
  8703
  8704     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8705     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8706
  8707     IF PB-COMPANY-ID = 'NCL'
  8708       IF NOT LF-PLAN-MASTER-FOUND
  8709         IF NOT PB-POLICY-IS-DECLINED  AND
  8710            NOT PB-POLICY-IS-VOIDED
  8711             MOVE  ER-1921         TO  WS-ERROR
  8712             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8713             GO TO 0304-LIFE-BENEFIT-FOUND.
  8714
  8715     IF NOT LF-PLAN-MASTER-FOUND
  8716        GO TO 0304-LIFE-BENEFIT-FOUND.
  8717
  8718 XXXX-CHECK-LF-PLAN-KEY.
  8719
  8720     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8721        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8722        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8723        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8724        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8725        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8726        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8727        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8728        MOVE 'N'                 TO PLAN-MASTER-SW
  8729          GO TO 03XX-ERPLAN-LIFE-READ.
  8730
  8731     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8732
  8733     IF  PB-CANCELLATION
  8734         GO TO  0303-LF-ACCT-BEN-FOUND.
  8735
  8736     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8737        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8738           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8739           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8740              MOVE ER-2644             TO WS-ERROR
  8741              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8742           ELSE
  8743              NEXT SENTENCE
  8744        ELSE
  8745           IF PB-COMPANY-ID NOT = 'NCL'
  8746              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8747                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8748
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 160
* EL050.cbl
  8749 0303-LF-ACCT-BEN-FOUND.
  8750
  8751     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8752
  8753     IF PL-DEV-CODE NOT = SPACES
  8754        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8755
  8756     IF PL-DEV-PCT NUMERIC AND
  8757        PL-DEV-PCT NOT = ZEROS
  8758        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8759
  8760     IF PL-TOL-PREM-AMT GREATER THAN +0
  8761        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8762
  8763     IF PL-TOL-REF-AMT GREATER THAN +0
  8764        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8765
  8766     IF PL-TOL-PREM-PCT GREATER THAN +0
  8767        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8768
  8769     IF PL-TOL-REF-PCT GREATER THAN +0
  8770        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8771
  8772     IF PL-TOL-CLM-AMT GREATER THAN +0
  8773        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8774
  8775     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8776                          PL-OVER-SHORT-AMT > +0
  8777        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8778
  8779     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8780                          PL-OVER-SHORT-PCT > +0
  8781        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8782
  8783     IF PL-SALES-TAX NUMERIC AND
  8784                          PL-SALES-TAX > +0
  8785         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8786
  8787     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8788        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8789                                    WS-IG-OVRD-AM.
  8790
  8791 0304-LIFE-BENEFIT-FOUND.
  8792
  8793     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8794
  8795     IF PB-ISSUE
  8796        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8797     ELSE
  8798        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8799
  8800     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8801     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8802     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8803     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8804     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8805                                         WS-LF-REFUND-CALC.
  8806     if (ws-lf-earnings-calc = '5')
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 161
* EL050.cbl
  8807        and (pb-i-loan-apr = zeros)
  8808        and (benefit-code-chg)
  8809        move +99.9999 to pb-i-loan-apr
  8810     end-if
  8811
  8812     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8813        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8814
  8815     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8816        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8817     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8818
  8819     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8820     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8821     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8822     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8823     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8824     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8825
  8826     IF PB-COMPANY-ID = 'NCL'  AND
  8827        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8828         NEXT SENTENCE
  8829     ELSE
  8830         IF SUB5 NOT GREATER THAN +20
  8831            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8832               MOVE WS-SAVE-BENEFIT-REM-TERM
  8833                                      TO WS-AM-LF-BENE-REM-TERM
  8834                                         EC-BR-LF-REM-TERM-CALC.
  8835
  8836     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8837     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8838
  8839     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8840
  8841 0305-BENEFIT-NOT-FOUND.
  8842
  8843     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8844     MOVE ER-2604                TO WS-ERROR.
  8845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8846
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 162
* EL050.cbl
  8848
  8849 0310-FIND-AH-BENEFIT-RECORD.
  8850
  8851     MOVE 'N'                    TO PLAN-MASTER-SW
  8852                                    PLAN-MASTER-AH-SW.
  8853
  8854     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8855                                    WS-PL-TOL-AH-REFUND
  8856                                    WS-AH-PL-REF-OVS-AMT
  8857                                    WS-PL-TOL-AH-PREM-PCT
  8858                                    WS-PL-TOL-AH-REFUND-PCT
  8859                                    WS-AH-PL-REF-OVS-PCT
  8860                                    WS-PL-TOL-AH-CLAIM.
  8861     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8862
  8863
  8864     if pb-issue
  8865        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8866           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8867        end-if
  8868        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8869           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8870           GO TO 0399-BENEFIT-NOT-FOUND
  8871        end-if
  8872     end-if
  8873
  8874     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8875        GO TO 0400-FIND-CARRIER.
  8876
  8877     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8878
  8879     IF WK-AH-BEN-ADDR NOT = ZEROS
  8880         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8881         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8882         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8883         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8884           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8885             GO TO 0311-AH-BENEFIT-SEARCH
  8886         ELSE
  8887             NEXT SENTENCE
  8888     ELSE
  8889         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8890
  8891     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8892     MOVE '5'                    TO CNTL-REC-TYPE.
  8893     MOVE +0                     TO CNTL-SEQ-NO.
  8894     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8895
  8896     MOVE '2' TO RC-SW-2.
  8897     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8898
  8899     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8900        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8901          GO TO 0399-BENEFIT-NOT-FOUND.
  8902
  8903     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8904
  8905 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 163
* EL050.cbl
  8906
  8907     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8908
  8909     IF NO-BENEFIT-FOUND
  8910         GO TO 0399-BENEFIT-NOT-FOUND.
  8911
  8912     IF WS-BEN-CD = '99'
  8913        GO TO 0399-BENEFIT-NOT-FOUND.
  8914
  8915     IF PB-COMPANY-ID  =  'NCL'
  8916         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8917             GO TO 0314-A-H-BENEFIT-FOUND.
  8918
  8919     MOVE +1                     TO SUB5.
  8920     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8921
  8922* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8923* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8924     IF PB-COMPANY-ID = 'DMD'
  8925         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8926
  8927 0312-EDIT-ACCT-AH-BENEFITS.
  8928
  8929     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8930        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8931           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8932                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8933           GO TO 03XX-GET-AH-ERPLAN.
  8934
  8935     IF SUB5 LESS THAN +20
  8936        ADD +1                   TO SUB5
  8937        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8938
  8939     MOVE +1                     TO SUB5.
  8940
  8941     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8942        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8943
  8944 0313-EDIT-DMD-EXTRA-BENEFITS.
  8945
  8946     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8947        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8948           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8949                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8950           GO TO 03XX-GET-AH-ERPLAN.
  8951
  8952     IF SUB5 LESS THAN +30
  8953        ADD +1                   TO SUB5
  8954        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8955
  8956     MOVE +1                     TO SUB5.
  8957
  8958 03XX-EDIT-FOR-NINETY-AH.
  8959
  8960***************************************************************
  8961*                                                             *
  8962*    NINETY BENEFIT PLAN TYPES:                               *
  8963*                                                             *
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 164
* EL050.cbl
  8964*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8965*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8966*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8967*           BENEFIT CONTROLS.                                 *
  8968*      99 = ALL BENEFITS.                                     *
  8969*                                                             *
  8970***************************************************************
  8971
  8972     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8973                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8974
  8975     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8976       AND
  8977        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8978        GO TO 03XX-GET-AH-ERPLAN.
  8979
  8980     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8981       AND
  8982        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8983           IF (PB-I-INDV-GRP-OVRD = 'I')
  8984              OR
  8985           ((AM-IG = '1') AND
  8986           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8987              OR
  8988           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8989           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8990           (AM-IG NOT = '2'))
  8991              GO TO 03XX-GET-AH-ERPLAN.
  8992
  8993     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8994       AND
  8995        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8996           IF (PB-I-INDV-GRP-OVRD = 'G')
  8997              OR
  8998           ((AM-IG = '2') AND
  8999           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9000              OR
  9001           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9002           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9003           (AM-IG NOT = '1'))
  9004              GO TO 03XX-GET-AH-ERPLAN.
  9005
  9006     IF SUB5 LESS THAN +20
  9007        ADD +1                   TO SUB5
  9008        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9009
  9010     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9011        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9012
  9013     MOVE +1                    TO SUB5.
  9014
  9015 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9016
  9017     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9018                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9019
  9020     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9021       AND
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 165
* EL050.cbl
  9022        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9023        GO TO 03XX-GET-AH-ERPLAN.
  9024
  9025     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9026       AND
  9027        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9028           IF (PB-I-INDV-GRP-OVRD = 'I')
  9029              OR
  9030           ((AM-IG = '1') AND
  9031           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9032              OR
  9033           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9034           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9035           (AM-IG NOT = '2'))
  9036              GO TO 03XX-GET-AH-ERPLAN.
  9037
  9038     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9039       AND
  9040        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9041           IF (PB-I-INDV-GRP-OVRD = 'G')
  9042              OR
  9043           ((AM-IG = '2') AND
  9044           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9045              OR
  9046           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9047           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9048           (AM-IG NOT = '1'))
  9049              GO TO 03XX-GET-AH-ERPLAN.
  9050
  9051     IF SUB5 LESS THAN +30
  9052        ADD +1                   TO SUB5
  9053        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9054
  9055 03XX-EDIT-FOR-NINETY-AH-CONT.
  9056
  9057     MOVE +99                    TO SUB5.
  9058
  9059     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9060
  9061     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9062        IF PB-ISSUE
  9063           MOVE ER-1925          TO  WS-ERROR
  9064           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9065
  9066     GO TO 0314-A-H-BENEFIT-FOUND.
  9067
  9068 03XX-GET-AH-ERPLAN.
  9069
  9070     IF WK-PLAN-ADDR EQUAL +0
  9071         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9072
  9073     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9074     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9075     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9076     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9077     MOVE 'Y'                    TO PLAN-MASTER-SW
  9078                                    PLAN-MASTER-AH-SW.
  9079*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 166
* EL050.cbl
  9080     GO TO 03XX-ERPLAN-AH-READ.
  9081
  9082 03XX-ERPLAN-AH-GETMAIN.
  9083
  9084     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9085     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9086
  9087 03XX-ERPLAN-AH-READ.
  9088
  9089     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9090     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9091     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9092     MOVE PB-SV-STATE            TO PLAN-STATE.
  9093     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9094     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9095     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9096     MOVE WS-SAVE-BENEFIT-REVISION
  9097                                 TO PLAN-REVISION-NO.
  9098
  9099     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9100     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9101
  9102     IF PB-COMPANY-ID = 'NCL'
  9103       IF NOT AH-PLAN-MASTER-FOUND
  9104         IF NOT PB-POLICY-IS-DECLINED  AND
  9105            NOT PB-POLICY-IS-VOIDED
  9106             MOVE  ER-1922         TO  WS-ERROR
  9107             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9108             GO TO 0314-A-H-BENEFIT-FOUND.
  9109
  9110     IF NOT AH-PLAN-MASTER-FOUND
  9111        GO TO 0314-A-H-BENEFIT-FOUND.
  9112
  9113 XXXX-CHECK-AH-PLAN-KEY.
  9114
  9115     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9116        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9117        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9118        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9119        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9120        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9121        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9122        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9123        MOVE 'N'                 TO PLAN-MASTER-SW
  9124          GO TO 03XX-ERPLAN-AH-READ.
  9125
  9126     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9127
  9128     IF  PB-CANCELLATION
  9129         GO TO  0313-AH-ACCT-BEN-FOUND.
  9130
  9131     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9132       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9133          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9134          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9135             MOVE ER-2644             TO WS-ERROR
  9136             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9137          ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 167
* EL050.cbl
  9138             NEXT SENTENCE
  9139       ELSE
  9140          IF PB-COMPANY-ID NOT = 'NCL'
  9141             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9142                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9143
  9144 0313-AH-ACCT-BEN-FOUND.
  9145
  9146     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9147
  9148     IF PL-DEV-CODE NOT = SPACES
  9149        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9150
  9151     IF PL-DEV-PCT NUMERIC AND
  9152        PL-DEV-PCT NOT = ZEROS
  9153        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9154
  9155     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9156        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9157
  9158     IF PL-TOL-REF-AMT NOT EQUAL +0
  9159        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9160
  9161     IF PL-TOL-PREM-PCT GREATER THAN +0
  9162        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9163
  9164     IF PL-TOL-REF-PCT GREATER THAN +0
  9165        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9166
  9167     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9168        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9169
  9170     IF PL-OVER-SHORT-AMT NUMERIC AND
  9171                          PL-OVER-SHORT-AMT > +0
  9172        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9173
  9174     IF PL-OVER-SHORT-PCT NUMERIC AND
  9175                          PL-OVER-SHORT-PCT > +0
  9176        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9177
  9178     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9179        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9180        IF WS-IG-OVRD-AM EQUAL SPACES
  9181            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9182
  9183 0314-A-H-BENEFIT-FOUND.
  9184
  9185     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9186
  9187     IF PB-ISSUE
  9188        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9189       ELSE
  9190        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9191
  9192     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9193     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9194     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9195     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 168
* EL050.cbl
  9196                                         WS-AH-REFUND-CALC.
  9197
  9198     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9199        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9200
  9201     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9202        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9203     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9204
  9205     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9206     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9207     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9208     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9209     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9210     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9211
  9212     IF PB-COMPANY-ID = 'NCL'  AND
  9213        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9214         NEXT SENTENCE
  9215     ELSE
  9216         IF SUB5 NOT GREATER THAN +20
  9217            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9218                MOVE WS-SAVE-BENEFIT-REM-TERM
  9219                                      TO WS-AM-AH-BENE-REM-TERM
  9220                                         EC-BR-AH-REM-TERM-CALC.
  9221
  9222     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9223     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9224
  9225     GO TO 0400-FIND-CARRIER.
  9226
  9227 0399-BENEFIT-NOT-FOUND.
  9228
  9229     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9230     MOVE ER-2605                TO WS-ERROR.
  9231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9232
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 169
* EL050.cbl
  9234
  9235 0400-FIND-CARRIER.
  9236
  9237     MOVE PB-SV-CARRIER          TO WS-CARR.
  9238
  9239     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9240     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9241     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9242     MOVE '6'                    TO CNTL-REC-TYPE.
  9243
  9244*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9245     MOVE SPACE                  TO WS-DMD-RATING-SW
  9246                                    EC-BR-DMD-RATING-SW.
  9247
  9248     MOVE '2'                    TO RC-SW-1.
  9249     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9250
  9251     IF NOT CF-CARRIER-MASTER
  9252        GO TO 0400-CARRIER-NOT-FOUND.
  9253
  9254 0400-BUILD-CARR-TOL.
  9255
  9256     IF CF-CR-TOL-PREM NUMERIC AND
  9257        CF-CR-TOL-PREM GREATER THAN +0
  9258        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9259                                    WS-TOL-AH-PREM.
  9260
  9261     IF CF-CR-TOL-REFUND NUMERIC AND
  9262        CF-CR-TOL-REFUND GREATER THAN +0
  9263        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9264                                    WS-TOL-AH-REFUND.
  9265
  9266     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9267        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9268        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9269                                    WS-AH-REFUND-OVS-AMT.
  9270
  9271     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9272        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9273        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9274                                    WS-AH-REFUND-OVS-PCT.
  9275
  9276     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9277        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9278        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9279                                    WS-TOL-AH-PREM-PCT.
  9280
  9281     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9282        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9283        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9284                                     WS-TOL-AH-REFUND-PCT.
  9285
  9286     IF CF-COMPANY-ID EQUAL 'DMD'
  9287         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9288                                    EC-BR-DMD-RATING-SW.
  9289
  9290     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9291     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 170
* EL050.cbl
  9292        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9293     END-IF
  9294     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9295        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9296     END-IF
  9297     IF WS-TOL-CLP-PCT = ZEROS
  9298        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9299     END-IF
  9300
  9301     IF WS-SPP-LEASE-COMM = ZEROS
  9302        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9303     END-IF
  9304     GO TO 0400-FIND-ERPDEF.
  9305
  9306 0400-CARRIER-NOT-FOUND.
  9307
  9308     MOVE ER-2602                TO WS-ERROR.
  9309     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9310
  9311 0400-FIND-ERPDEF.
  9312     IF PB-COMPANY-ID = 'DCC'
  9313        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9314        CONTINUE
  9315     ELSE
  9316        GO TO 0400-FIND-ERCOMP
  9317     END-IF
  9318     MOVE ' '                    TO PDEF-MASTER-SW
  9319     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9320     MOVE PB-STATE               TO ERPDEF-STATE
  9321     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9322     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9323     IF PB-ISSUE
  9324        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9325     ELSE
  9326        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9327     END-IF
  9328     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9329     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9330     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9331     IF PDEF-MASTER-FOUND
  9332        MOVE 'N'                 TO PDEF-MASTER-SW
  9333        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9334        IF PDEF-MASTER-FOUND
  9335           IF (ERPDEF-KEY-SAVE (1:16) =
  9336                        PD-CONTROL-PRIMARY (1:16))
  9337              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9338              CONTINUE
  9339           ELSE
  9340              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9341              IF (ERPDEF-KEY-SAVE (1:16) =
  9342                        PD-CONTROL-PRIMARY (1:16))
  9343                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9344                 CONTINUE
  9345              ELSE
  9346                 MOVE 'N'        TO PDEF-MASTER-SW
  9347              END-IF
  9348           END-IF
  9349        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 171
* EL050.cbl
  9350        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9351     END-IF
  9352     IF PDEF-MASTER-FOUND
  9353        IF PD-TRUNCATED = 'Y'
  9354           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9355        END-IF
  9356     END-IF
  9357     .
  9358 0400-FIND-ERCOMP.
  9359     IF PB-COMPANY-ID = 'DCC'
  9360        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9361           (WS-SUB1 > +10)
  9362           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9363                 OR 'A' OR 'N'
  9364              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9365              MOVE PB-CARRIER    TO COMP-CARRIER
  9366              MOVE PB-GROUPING   TO COMP-GROUPING
  9367              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9368              MOVE AM-AGT (WS-SUB1)
  9369                                 TO COMP-FIN-RESP
  9370              MOVE 'G'           TO COMP-TYPE
  9371              PERFORM 8582-READ-COMPENSATION-MASTER
  9372                                 THRU 8582-EXIT
  9373              IF COMP-MASTER-FOUND
  9374                 IF CO-GA-INACTIVE
  9375                    MOVE ER-2763 TO WS-ERROR
  9376                    PERFORM 9900-ERROR-FORMAT
  9377                                 THRU 9900-EXIT
  9378                    MOVE +11     TO WS-SUB1
  9379                 END-IF
  9380                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9381                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9382                    MOVE ER-2788 TO WS-ERROR
  9383                    PERFORM 9900-ERROR-FORMAT
  9384                                 THRU 9900-EXIT
  9385                    MOVE +11     TO WS-SUB1
  9386                 END-IF
  9387              END-IF
  9388           END-IF
  9389        END-PERFORM
  9390     END-IF
  9391     IF PB-COMPANY-ID = 'DCC'
  9392        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9393           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9394                                    WS-CLP-STATE
  9395        ELSE
  9396           MOVE SPACES           TO PB-I-CLP-STATE
  9397                                    WS-CLP-STATE
  9398        END-IF
  9399     END-IF
  9400
  9401     IF (PB-COMPANY-ID = 'DCC')
  9402        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9403        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9404        CONTINUE
  9405     ELSE
  9406        GO TO 0400-FIND-STATE-RECORD
  9407     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 172
* EL050.cbl
  9408     MOVE SPACES                 TO WS-CLP-STATE
  9409     MOVE +0                     TO WS-BANK-FEE
  9410                                    WS-BANK-LFEE
  9411                                    WS-BANK-NOCHRGB
  9412
  9413     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9414     IF (PB-ISSUE)
  9415        AND (PB-I-BANK-NUMBER NOT =
  9416            SPACES AND ZEROS AND LOW-VALUES)
  9417        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9418     ELSE
  9419        IF (PB-CANCELLATION)
  9420           AND (PB-CI-BANK-NUMBER NOT =
  9421                SPACES AND ZEROS AND LOW-VALUES)
  9422           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9423        END-IF
  9424     END-IF
  9425     IF COMP-FIN-RESP NOT = LOW-VALUES
  9426        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9427        MOVE PB-CARRIER          TO COMP-CARRIER
  9428        MOVE PB-GROUPING         TO COMP-GROUPING
  9429        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9430        MOVE 'B'                 TO COMP-TYPE
  9431        PERFORM 8582-READ-COMPENSATION-MASTER
  9432                                 THRU 8582-EXIT
  9433        IF COMP-MASTER-FOUND
  9434           IF CO-MAX-BANK-FEE NOT NUMERIC
  9435              MOVE +0            TO CO-MAX-BANK-FEE
  9436           END-IF
  9437           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9438              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9439           END-IF
  9440           IF CO-GA-INACTIVE
  9441              MOVE ER-2763       TO WS-ERROR
  9442              PERFORM 9900-ERROR-FORMAT
  9443                                 THRU 9900-EXIT
  9444           END-IF
  9445           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9446              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9447              MOVE ER-2788 TO WS-ERROR
  9448              PERFORM 9900-ERROR-FORMAT
  9449                                 THRU 9900-EXIT
  9450              MOVE +11     TO WS-SUB1
  9451           END-IF
  9452           IF WS-AH-BEN-CATEGORY = 'G'
  9453              MOVE CO-MAX-BANK-FEE
  9454                                 TO WS-BANK-FEE
  9455                                    PB-I-BANK-FEE
  9456           ELSE
  9457              MOVE CO-MAX-BANK-FEE-LEASE
  9458                                 TO WS-BANK-LFEE
  9459                                    PB-I-BANK-FEE
  9460           END-IF
  9461           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9462              AND (WS-AH-REFUND-CALC = 'G'))
  9463                        OR
  9464              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9465              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 173
* EL050.cbl
  9466              CONTINUE
  9467           ELSE
  9468              MOVE ER-2789 TO WS-ERROR
  9469              PERFORM 9900-ERROR-FORMAT
  9470                                 THRU 9900-EXIT
  9471           END-IF
  9472           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9473                                    PB-I-CLP-STATE
  9474           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9475           MOVE CO-CARRIER       TO BXRF-CARRIER
  9476           MOVE CO-GROUPING      TO BXRF-GROUPING
  9477           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9478           MOVE BXRF-MAX-REC-LENGTH
  9479                                 TO BXRF-REC-LENGTH
  9480           PERFORM 8584-READ-BANK-CROSS-REF
  9481                                 THRU 8584-EXIT
  9482           IF BXRF-MASTER-FOUND
  9483              MOVE ' '           TO BANK-ACCT-SW
  9484              MOVE BK-BANK-POINTER-CNT
  9485                                 TO BK-BANK-POINTER-CNT
  9486              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9487                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9488                 OR (BANK-ACCT-FOUND)
  9489                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9490                    AND (BK-AM-EXP-DT (WS-SUB1)
  9491                                 > PB-CERT-EFF-DT)
  9492                    AND (BK-AM-EFF-DT (WS-SUB1)
  9493                                 NOT > PB-CERT-EFF-DT)
  9494                    SET BANK-ACCT-FOUND TO TRUE
  9495                 END-IF
  9496              END-PERFORM
  9497              IF NOT BANK-ACCT-FOUND
  9498                 MOVE ZEROS      TO WS-BANK-FEE
  9499                                    WS-BANK-LFEE
  9500                 MOVE ER-2869    TO WS-ERROR
  9501                 PERFORM 9900-ERROR-FORMAT
  9502                                 THRU 9900-EXIT
  9503              ELSE
  9504                 PERFORM 5000-PROCESS-REPS
  9505                                 THRU 5000-EXIT
  9506                 IF AGENT-MASTER-FOUND
  9507                    MOVE +0      TO WS-BANK-FEE
  9508                                    WS-BANK-LFEE
  9509*                   MOVE AG-SPP-FEES (1)
  9510*                                TO PB-I-BANK-FEE
  9511*                                   WS-BANK-FEE
  9512                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9513                       (WS-SUB1 > +10)
  9514                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9515                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9516                       END-IF
  9517                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9518                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9519                       END-IF
  9520                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9521                          AG-SPP-FEES (WS-SUB1)
  9522                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9523                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 174
* EL050.cbl
  9524                    END-PERFORM
  9525                    IF WS-AH-BEN-CATEGORY = 'G'
  9526                       MOVE WS-BANK-FEE
  9527                                 TO PB-I-BANK-FEE
  9528                    ELSE
  9529                       MOVE WS-BANK-LFEE
  9530                                 TO PB-I-BANK-FEE
  9531                    END-IF
  9532                 END-IF
  9533              END-IF
  9534           END-IF
  9535        ELSE
  9536           MOVE ER-2879          TO WS-ERROR
  9537           PERFORM 9900-ERROR-FORMAT
  9538                                 THRU 9900-EXIT
  9539        END-IF
  9540     ELSE
  9541        MOVE ER-2879             TO WS-ERROR
  9542        PERFORM 9900-ERROR-FORMAT
  9543                                 THRU 9900-EXIT
  9544     END-IF
  9545     IF WS-AH-BEN-CATEGORY = 'G'
  9546        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9547        + WS-BANK-FEE
  9548     ELSE
  9549        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9550        + WS-BANK-LFEE
  9551     END-IF
  9552     .
  9553 0400-FIND-STATE-RECORD.
  9554
  9555     IF WK-STATE-ADDR NOT = ZEROS
  9556         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9557         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9558         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9559         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9560         IF PB-SV-STATE = CF-STATE-CODE
  9561             GO TO 0405-CONTINUE-EDIT
  9562         ELSE
  9563             NEXT SENTENCE
  9564     ELSE
  9565         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9566
  9567     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9568     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9569     MOVE '3'                    TO CNTL-REC-TYPE.
  9570     MOVE +0                     TO CNTL-SEQ-NO.
  9571
  9572     MOVE '3'                    TO RC-SW-2.
  9573     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9574
  9575     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9576        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9577        PB-SV-STATE   NOT = CF-STATE-CODE)
  9578        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9579                                    WS-TOL-AH-CLAIM
  9580                                    WS-MINIMUM-REFUND
  9581                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 175
* EL050.cbl
  9582                                    WS-TOL-AH-PREM
  9583                                    WS-TOL-LF-REFUND
  9584                                    WS-TOL-AH-REFUND
  9585                                    EC-ST-TOL-PREM-PCT
  9586                                    WS-TOL-LF-PREM-PCT
  9587                                    WS-TOL-AH-PREM-PCT
  9588                                    EC-ST-TOL-REFUND-PCT
  9589                                    WS-TOL-LF-REFUND-PCT
  9590                                    WS-TOL-AH-REFUND-PCT
  9591                                    EC-ST-TOL-PREM
  9592                                    EC-ST-TOL-REFUND
  9593                                    EC-ST-FST-PMT-DAYS-MAX
  9594                                    WS-FREE-LOOK-PERIOD
  9595                                    WS-ST-LF-PREM-TAX
  9596                                    WS-ST-AH-PREM-TAX-I
  9597                                    WS-ST-AH-PREM-TAX-G
  9598                                    WS-BANK-FEE
  9599                                    WS-BANK-LFEE
  9600                                    WS-TOL-CLP-PCT
  9601                                    WS-SPP-LEASE-COMM
  9602        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9603                                    EC-ST-FST-PMT-DAYS-CHG
  9604                                    WS-LF-REM-TERM-CALC
  9605                                    WS-LF-REFUND-CALC
  9606                                    EC-ST-LF-REM-TERM-CALC
  9607                                    EC-ST-LF-REFUND-CALC
  9608                                    WS-AH-REM-TERM-CALC
  9609                                    WS-AH-REFUND-CALC
  9610                                    WS-LF-BEN-CATEGORY
  9611                                    WS-AH-BEN-CATEGORY
  9612                                    WS-CLP-STATE
  9613                                    WS-ST-REFUND-CLAIM-FLAG
  9614                                    EC-ST-AH-REM-TERM-CALC
  9615                                    EC-ST-AH-REFUND-CALC
  9616          GO TO 0499-STATE-NOT-FOUND.
  9617
  9618     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9619
  9620 0405-CONTINUE-EDIT.
  9621
  9622     if pb-company-id = 'AHL'
  9623        continue
  9624     else
  9625        IF PB-CERT-PRIME NOT NUMERIC
  9626           MOVE ER-2722          TO WS-ERROR
  9627           PERFORM 9900-ERROR-FORMAT
  9628                                 THRU 9900-EXIT
  9629        end-if
  9630     END-IF
  9631*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9632*       MOVE +0                  TO SUB3
  9633*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9634*       IF SUB3 > +0
  9635*          MOVE ER-2722          TO WS-ERROR
  9636*          PERFORM 9900-ERROR-FORMAT
  9637*                                THRU 9900-EXIT
  9638*       END-IF
  9639*    END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 176
* EL050.cbl
  9640*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9641*       IF PB-CERT-PRIME NOT NUMERIC
  9642*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9643*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9644*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9645*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9646*
  9647*          MOVE ER-2722          TO WS-ERROR
  9648*          PERFORM 9900-ERROR-FORMAT
  9649*                                THRU 9900-EXIT
  9650*       END-IF
  9651*    END-IF
  9652
  9653     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9654
  9655     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9656        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9657                                    WS-TOL-AH-CLAIM.
  9658
  9659     IF CF-ST-REFUND-MIN NOT NUMERIC
  9660        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9661
  9662     IF CF-ST-REFUND-MIN NOT = ZEROS
  9663        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9664
  9665     IF CF-ST-TOL-PREM  NOT = ZEROS
  9666        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9667                                    WS-TOL-AH-PREM
  9668        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9669
  9670     IF CF-ST-TOL-REFUND NOT = ZEROS
  9671        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9672                                    WS-TOL-AH-REFUND
  9673        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9674
  9675     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9676        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9677        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9678                                    WS-AH-REFUND-OVS-AMT
  9679                                    EC-ST-OVR-SHT-AMT.
  9680
  9681     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9682        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9683        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9684                                    WS-TOL-LF-PREM-PCT
  9685                                    WS-TOL-AH-PREM-PCT.
  9686
  9687     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9688        CF-ST-TOL-REF-PCT GREATER THAN +0
  9689        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9690                                    WS-TOL-LF-REFUND-PCT
  9691                                    WS-TOL-AH-REFUND-PCT.
  9692
  9693     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9694        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9695        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9696                                    WS-AH-REFUND-OVS-PCT
  9697                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 177
* EL050.cbl
  9698
  9699     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9700     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9701
  9702     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9703          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9704
  9705     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9706     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9707     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9708
  9709     IF CF-ST-LF-PREM-TAX NUMERIC
  9710        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9711     END-IF
  9712     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9713        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9714     END-IF
  9715     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9716        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9717     END-IF
  9718
  9719     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9720         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9721     END-IF.
  9722
  9723     IF WS-LF-BENEFIT-CD = ZEROS
  9724        GO TO 0410-CHECK-AH.
  9725
  9726     IF CF-ST-RT-CALC NOT = SPACES
  9727        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9728                                    EC-ST-LF-REM-TERM-CALC
  9729     END-IF
  9730
  9731     IF WS-LF-COVERAGE-TYPE = 'R'
  9732        IF WS-LF-EARNINGS-CALC = '5'
  9733           IF CF-ST-RF-LN-CALC > '0'
  9734              MOVE CF-ST-RF-LN-CALC
  9735                                 TO WS-LF-REFUND-CALC
  9736                                    EC-ST-LF-REFUND-CALC
  9737           END-IF
  9738        ELSE
  9739           IF CF-ST-RF-LR-CALC > '0'
  9740              MOVE CF-ST-RF-LR-CALC
  9741                                 TO WS-LF-REFUND-CALC
  9742                                    EC-ST-LF-REFUND-CALC
  9743           END-IF
  9744        END-IF
  9745     ELSE
  9746        IF CF-ST-RF-LL-CALC > '0'
  9747           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9748                                    EC-ST-LF-REFUND-CALC
  9749        END-IF
  9750     END-IF
  9751
  9752     IF CF-ST-RT-CALC NOT = SPACES
  9753        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9754                                    EC-ST-LF-REM-TERM-CALC
  9755     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 178
* EL050.cbl
  9756
  9757     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9758     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9759
  9760     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9761
  9762     IF NO-BENEFIT-FOUND
  9763        GO TO 0410-CHECK-AH.
  9764
  9765     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9766        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9767                                 TO EC-ST-LF-REM-TERM-CALC
  9768                                    WS-LF-REM-TERM-CALC
  9769     END-IF
  9770
  9771     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9772        MOVE CF-ST-REFUND-CALC (SUB3)
  9773                                 TO WS-LF-REFUND-CALC
  9774                                    EC-ST-LF-REFUND-CALC
  9775     END-IF
  9776*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9777
  9778     .
  9779 0410-CHECK-AH.
  9780
  9781     IF WS-AH-BENEFIT-CD = ZEROS
  9782        GO TO 0500-SET-ACCOUNT.
  9783
  9784     IF CF-ST-RT-CALC NOT = SPACES
  9785        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9786                                    EC-ST-AH-REM-TERM-CALC
  9787     END-IF
  9788
  9789     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9790        IF CF-ST-RF-CP-CALC > '0'
  9791           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9792                                    EC-ST-AH-REFUND-CALC
  9793        END-IF
  9794     ELSE
  9795        IF CF-ST-RF-AH-CALC > '0'
  9796           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9797                                    EC-ST-AH-REFUND-CALC
  9798        END-IF
  9799     END-IF
  9800     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9801     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9802
  9803     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9804
  9805     IF NO-BENEFIT-FOUND
  9806        GO TO 0500-SET-ACCOUNT.
  9807
  9808     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9809        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9810                                 TO WS-AH-REM-TERM-CALC
  9811                                    EC-ST-AH-REM-TERM-CALC
  9812     END-IF
  9813
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 179
* EL050.cbl
  9814     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9815        MOVE CF-ST-REFUND-CALC (SUB3)
  9816                                 TO WS-AH-REFUND-CALC
  9817                                    EC-ST-AH-REFUND-CALC
  9818     END-IF
  9819
  9820*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9821
  9822     GO TO 0500-SET-ACCOUNT.
  9823
  9824 0499-STATE-NOT-FOUND.
  9825
  9826     MOVE ER-2603                TO WS-ERROR.
  9827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9828
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 180
* EL050.cbl
  9830
  9831 0500-SET-ACCOUNT.
  9832*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9833     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9834        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9835        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9836        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9837        MOVE '3'                 TO CNTL-REC-TYPE
  9838        MOVE +0                  TO CNTL-SEQ-NO
  9839
  9840        MOVE '3'                 TO RC-SW-2
  9841        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9842
  9843        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9844           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9845           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9846           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9847                                    WS-ST-AH-PREM-TAX-I
  9848                                    WS-ST-AH-PREM-TAX-G
  9849        ELSE
  9850           IF CF-ST-LF-PREM-TAX NUMERIC
  9851              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9852           END-IF
  9853           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9854              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9855           END-IF
  9856           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9857              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9858           END-IF
  9859        END-IF
  9860        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9861     END-IF
  9862*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9863*  FOR DCC ONLY
  9864     IF PB-COMPANY-ID = 'DCC'
  9865
  9866     MOVE ' '                    TO STAT-MASTER-SW
  9867     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9868     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9869     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9870     MOVE PB-STATE               TO ELSTAT-STATE
  9871     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9872        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9873     END-IF
  9874
  9875     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9876     SET BIN-TO-GREG             TO TRUE
  9877     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9878     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9879     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9880
  9881     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9882     IF STAT-MASTER-FOUND
  9883        MOVE 'N'                 TO STAT-MASTER-SW
  9884        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9885        IF STAT-MASTER-FOUND
  9886           IF (ELSTAT-KEY-SAVE (1:12) =
  9887                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 181
* EL050.cbl
  9888              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9889                 MOVE 'F'        TO STAT-MASTER-SW
  9890              ELSE
  9891                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9892                 IF (STAT-MASTER-FOUND)
  9893                    AND (ELSTAT-KEY-SAVE (1:12) =
  9894                        SF-CONTROL-PRIMARY (1:12))
  9895                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9896                    MOVE 'F'     TO STAT-MASTER-SW
  9897                 END-IF
  9898              END-IF
  9899           END-IF
  9900        END-IF
  9901     END-IF
  9902
  9903     IF STAT-MASTER-SW = 'F'
  9904        IF SF-ST-LF-PREM-TAX NUMERIC
  9905           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9906        END-IF
  9907        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9908           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9909        END-IF
  9910        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9911           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9912        END-IF
  9913     END-IF
  9914
  9915     END-IF
  9916     IF (PB-COMPANY-ID = 'DCC')
  9917        AND (PB-ISSUE)
  9918        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9919        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9920        AND (AM-GPCD = 06)
  9921        MOVE 'Y'                 TO WS-GOOD-HIN
  9922        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9923           MOVE PB-I-VIN         TO WS-WORK-VIN
  9924           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9925              (V1 > 16)
  9926              IF WS-WORK-VIN (V1:1) NUMERIC
  9927                 MOVE WS-WORK-VIN-N (V1)
  9928                                 TO WS-ROW-B-VAL (V1)
  9929              ELSE
  9930                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9931                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9932                    OR (V2 > 26)
  9933                 END-PERFORM
  9934                 IF V2 < 27
  9935                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9936                 ELSE
  9937                    MOVE 'N'     TO WS-GOOD-HIN
  9938                 END-IF
  9939              END-IF
  9940              COMPUTE WS-ROW-D-VAL (V1) =
  9941                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9942              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9943                 WS-ROW-D-VAL (V1)
  9944           END-PERFORM
  9945           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 182
* EL050.cbl
  9946           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9947             REMAINDER WS-VIN-REMAINDER
  9948           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9949              CONTINUE
  9950           ELSE
  9951              MOVE 'N'           TO WS-GOOD-HIN
  9952           END-IF
  9953        ELSE
  9954           MOVE 'N'              TO WS-GOOD-HIN
  9955        END-IF
  9956        IF WS-GOOD-HIN NOT = 'Y'
  9957           MOVE ER-3826           TO WS-ERROR
  9958           PERFORM 9900-ERROR-FORMAT
  9959                                 THRU 9900-EXIT
  9960        END-IF
  9961     END-IF
  9962     IF (PB-COMPANY-ID = 'DCC')
  9963        AND (PB-ISSUE)
  9964        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9965        AND (AM-GPCD NOT = 06)
  9966        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9967          MOVE PB-I-VIN          TO WS-WORK-VIN
  9968          MOVE +8                TO V2
  9969          MOVE ZEROS             TO WS-VIN-TOTAL
  9970          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9971           (V1 > 17)
  9972             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9973                MOVE ER-3825     TO WS-ERROR
  9974                PERFORM 9900-ERROR-FORMAT
  9975                                 THRU 9900-EXIT
  9976             ELSE
  9977                IF V1 = 8
  9978                   MOVE 10       TO V2
  9979                END-IF
  9980                IF V1 = 9
  9981                   MOVE 0        TO V2
  9982                END-IF
  9983                IF V1 = 10
  9984                   MOVE 9        TO V2
  9985                END-IF
  9986                IF WS-WORK-VIN (V1:1) NUMERIC
  9987                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9988                    + (WS-WORK-VIN-N (V1) * V2)
  9989                ELSE
  9990                   MOVE WS-WORK-VIN (V1:1)
  9991                                 TO WS-HEX-BYTE
  9992                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9993                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9994                    + (WS-NUM (V3) * V2)
  9995                END-IF
  9996                COMPUTE V2 = V2 - 1
  9997             END-IF
  9998          END-PERFORM
  9999          MOVE ZEROS TO WS-VIN-REMAINDER
 10000          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10001             REMAINDER WS-VIN-REMAINDER
 10002          IF ((WS-WORK-VIN (9:1) = 'X')
 10003             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 183
* EL050.cbl
 10004                     OR
 10005             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10006             CONTINUE
 10007          ELSE
 10008             MOVE ER-3826        TO WS-ERROR
 10009             PERFORM 9900-ERROR-FORMAT
 10010                                 THRU 9900-EXIT
 10011          END-IF
 10012        ELSE
 10013          MOVE ER-3826           TO WS-ERROR
 10014          PERFORM 9900-ERROR-FORMAT
 10015                                 THRU 9900-EXIT
 10016        END-IF
 10017     END-IF
 10018******************************************************************
 10019******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10020******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10021******* METHODS.
 10022******************************************************************
 10023     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10024        IF PB-CANCELLATION
 10025           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10026              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10027                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10028                IF FORM-MASTER-FOUND
 10029                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10030******************************************************************
 10031
 10032     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10033     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10034
 10035     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10036     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10037     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10038     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10039
 10040
 10041     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10042     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10043     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10044
 10045     IF AM-LF-OB-RATE NOT NUMERIC
 10046         MOVE ZERO               TO AM-LF-OB-RATE.
 10047
 10048     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10049         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10050
 10051     IF AM-AH-OB-RATE NOT NUMERIC
 10052         MOVE ZERO               TO AM-AH-OB-RATE.
 10053
 10054     IF WS-LF-JOINT-INDICATOR = 'J'
 10055         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10056     ELSE
 10057         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10058
 10059     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10060
 10061     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 184
* EL050.cbl
 10062         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10063
 10064     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10065         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10066                                       WS-IG-OVRD
 10067     ELSE
 10068         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10069             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10070                                       WS-IG-OVRD
 10071         ELSE
 10072             MOVE AM-IG             TO WS-IG-OVRD-AH
 10073                                       WS-IG-OVRD.
 10074
 10075     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10076         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10077                                       WS-IG-OVRD
 10078     ELSE
 10079         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10080             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10081                                       WS-IG-OVRD
 10082         ELSE
 10083             MOVE AM-IG             TO WS-IG-OVRD-LF
 10084                                       WS-IG-OVRD.
 10085
 10086     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10087     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10088     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10089     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10090     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10091
 10092     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10093     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10094     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10095     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10096
 10097     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10098     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10099     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10100     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10101     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10102     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10103     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10104
 10105     IF WS-ACCT-AH-DEV-PCT > +0
 10106        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10107     ELSE
 10108        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10109
 10110     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10111        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10112     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10113        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10114
 10115        IF AM-EARN-METHOD-L = 'S'
 10116            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10117                                        WS-LF-REFUND-CALC.
 10118
 10119        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 185
* EL050.cbl
 10120            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10121                                        WS-LF-REFUND-CALC.
 10122
 10123     IF WS-LF-COVERAGE-TYPE = 'R'
 10124         IF AM-EARN-METHOD-R = 'R'
 10125            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10126                                    WS-LF-REFUND-CALC.
 10127     IF WS-LF-COVERAGE-TYPE = 'R'
 10128         IF AM-EARN-METHOD-R = 'P'
 10129            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10130                                    WS-LF-REFUND-CALC.
 10131     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10132         IF AM-EARN-METHOD-L = 'R'
 10133            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10134                                    WS-LF-REFUND-CALC.
 10135     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10136         IF AM-EARN-METHOD-L = 'P'
 10137            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10138                                    WS-LF-REFUND-CALC.
 10139     IF WS-LF-COVERAGE-TYPE = 'R'
 10140         IF AM-EARN-METHOD-R = 'A'
 10141            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10142                                    WS-LF-REFUND-CALC.
 10143     IF WS-LF-COVERAGE-TYPE = 'R'
 10144         IF AM-EARN-METHOD-R = 'M'
 10145            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10146                                    WS-LF-REFUND-CALC.
 10147     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10148         IF AM-EARN-METHOD-L = 'A'
 10149            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10150                                    WS-LF-REFUND-CALC.
 10151     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10152         IF AM-EARN-METHOD-L = 'M'
 10153            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10154                                    WS-LF-REFUND-CALC.
 10155
 10156     IF AM-EARN-METHOD-A = 'R'
 10157        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10158                                    WS-AH-REFUND-CALC.
 10159     IF AM-EARN-METHOD-A = 'P'
 10160        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10161                                    WS-AH-REFUND-CALC.
 10162     IF AM-EARN-METHOD-A = 'C'
 10163        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10164                                    WS-AH-REFUND-CALC.
 10165     IF AM-EARN-METHOD-A = 'A'
 10166        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10167                                    WS-AH-REFUND-CALC.
 10168     IF AM-EARN-METHOD-A = 'M'
 10169        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10170                                    WS-AH-REFUND-CALC.
 10171     IF AM-EARN-METHOD-A = 'N'
 10172        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10173                                    WS-AH-REFUND-CALC.
 10174     IF AM-EARN-METHOD-A = 'S'
 10175        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10176                                    WS-AH-REFUND-CALC.
 10177
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 186
* EL050.cbl
 10178     IF AM-TOL-PREM NOT = ZEROS
 10179        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10180                                    WS-TOL-AH-PREM.
 10181
 10182     IF AM-OVR-SHT-AMT NUMERIC AND
 10183                  AM-OVR-SHT-AMT > 0
 10184        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10185                                    EC-AM-LF-OVR-SHT-AMT
 10186                                    WS-AH-REFUND-OVS-AMT
 10187                                    EC-AM-AH-OVR-SHT-AMT.
 10188
 10189     IF AM-OVR-SHT-PCT NUMERIC AND
 10190                    AM-OVR-SHT-PCT > 0
 10191        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10192                                    EC-AM-LF-OVR-SHT-PCT
 10193                                    WS-AH-REFUND-OVS-PCT
 10194                                    EC-AM-AH-OVR-SHT-PCT.
 10195
 10196     IF AM-TOL-REF-PCT NUMERIC AND
 10197                  AM-TOL-REF-PCT > 0
 10198        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10199                                    WS-TOL-AH-REFUND-PCT.
 10200
 10201     IF AM-TOL-REF  NOT = ZEROS  AND
 10202                  AM-TOL-REF NUMERIC
 10203        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10204                                    EC-AM-LF-TOL-REFUND
 10205                                    WS-TOL-AH-REFUND
 10206                                    EC-AM-AH-TOL-REFUND.
 10207
 10208     IF AM-TOL-CLM  NOT = ZEROS
 10209        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10210                                    WS-TOL-AH-CLAIM.
 10211
 10212     IF AM-CLP-TOL-PCT NOT NUMERIC
 10213        MOVE +0                  TO AM-CLP-TOL-PCT
 10214     END-IF
 10215
 10216     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10217        MOVE +0                  TO AM-SPP-LEASE-COMM
 10218     END-IF
 10219     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10220        MOVE WS-PL-TOL-LF-PREM-PCT
 10221                                 TO WS-TOL-LF-PREM-PCT.
 10222
 10223     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10224        MOVE WS-PL-TOL-AH-PREM-PCT
 10225                                 TO WS-TOL-AH-PREM-PCT.
 10226
 10227     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10228        MOVE WS-PL-TOL-LF-REFUND-PCT
 10229                                 TO WS-TOL-LF-REFUND-PCT.
 10230
 10231     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10232        MOVE WS-PL-TOL-AH-REFUND-PCT
 10233                                 TO WS-TOL-AH-REFUND-PCT.
 10234
 10235     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 187
* EL050.cbl
 10236        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10237
 10238     IF WS-PL-REF-OVS-PCT > +0
 10239        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10240
 10241     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10242        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10243     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10244        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10245     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10246        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10247     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10248        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10249     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10250        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10251     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10252        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10253
 10254     IF WS-AH-PL-REF-OVS-AMT > +0
 10255        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10256
 10257     IF WS-AH-PL-REF-OVS-PCT > +0
 10258        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10259
 10260     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10261     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10262
 10263     IF PB-CANCELLATION
 10264        GO TO 3000-CONTINUE-EDIT.
 10265
 10266     MOVE +1 TO SUB1.
 10267     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10268     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10269
 10270     IF CF-COMPANY-ID = 'DMD'
 10271       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10272         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10273        ELSE
 10274         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10275
 10276  0525-FIND-ACCT-COMM.
 10277     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10278        NEXT SENTENCE
 10279      ELSE
 10280         ADD +1 TO SUB1
 10281         IF SUB1 LESS +11
 10282            GO TO 0525-FIND-ACCT-COMM
 10283          ELSE
 10284             GO TO 0560-EDIT-CONTINUE.
 10285
 10286     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10287     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10288                                    PB-I-LIFE-COMMISSION.
 10289***  IF PB-COMPANY-ID = 'CRI'
 10290     IF PB-PREM-ACCTNG-ONLY
 10291         GO TO 0560-EDIT-CONTINUE.
 10292
 10293     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 188
* EL050.cbl
 10294     MOVE ' '    TO WS-CTBL-READ-SW.
 10295
 10296
 10297 0530-GET-AH-COMP.
 10298     IF NO-AH-COVERAGE  OR
 10299        NO-AH-BENEFIT-MATCH
 10300           GO TO 0540-NEXT-READ-STEP.
 10301
 10302     IF AM-A-COM (SUB1) NUMERIC
 10303        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10304         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10305         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10306         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10307         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10308     ELSE
 10309          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10310          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10311          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10312          MOVE ZEROS             TO WS-SUB1
 10313                                    WS-COMMISSION
 10314          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10315          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10316          IF WS-COMMISSION > ZEROS
 10317             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10318             GO TO 0540-NEXT-READ-STEP
 10319          END-IF
 10320          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10321          IF CTBL-TABLE-FOUND
 10322             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10323                                        PB-I-AH-TERM
 10324             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10325             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10326             GO TO 0540-NEXT-READ-STEP
 10327          ELSE
 10328             IF FIRST-TIME-THROUGH
 10329                 GO TO 0530-GET-AH-COMP
 10330             ELSE
 10331                 MOVE ER-2609                TO WS-ERROR
 10332                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10333
 10334 0540-NEXT-READ-STEP.
 10335     MOVE '0540' TO CTBL-SW.
 10336     MOVE ' '    TO WS-CTBL-READ-SW.
 10337
 10338 0540-GET-LF-COMP.
 10339     IF NO-LIFE-COVERAGE  OR
 10340        NO-LF-BENEFIT-MATCH
 10341           GO TO 0560-EDIT-CONTINUE.
 10342
 10343     IF WS-LF-JOINT-INDICATOR = 'J'
 10344        IF AM-J-COM (SUB1) NUMERIC
 10345           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10346           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10347           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10348           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10349           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10350        ELSE
 10351           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 189
* EL050.cbl
 10352           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10353           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10354           MOVE ZEROS                TO WS-SUB1
 10355                                        WS-COMMISSION
 10356           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10357           IF WS-COMMISSION > ZEROS
 10358              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10359              GO TO 0560-EDIT-CONTINUE
 10360           END-IF
 10361           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10362           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10363           IF CTBL-TABLE-FOUND
 10364              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10365              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10366              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10367              GO TO 0560-EDIT-CONTINUE
 10368           ELSE
 10369              IF FIRST-TIME-THROUGH
 10370                  GO TO 0540-GET-LF-COMP
 10371              ELSE
 10372                  MOVE ER-2609                TO WS-ERROR
 10373                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10374                  GO TO 0560-EDIT-CONTINUE.
 10375
 10376     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10377        IF AM-L-COM (SUB1) NUMERIC
 10378           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10379           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10380           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10381           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10382           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10383        ELSE
 10384           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10385           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10386           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10387           MOVE ZEROS                TO WS-SUB1
 10388                                        WS-COMMISSION
 10389           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10390           IF WS-COMMISSION IS GREATER THAN ZEROS
 10391              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10392              GO TO 0560-EDIT-CONTINUE
 10393           END-IF
 10394           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10395           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10396           IF CTBL-TABLE-FOUND
 10397              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10398              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10399              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10400              GO TO 0560-EDIT-CONTINUE
 10401           ELSE
 10402              IF FIRST-TIME-THROUGH
 10403                  GO TO 0540-GET-LF-COMP
 10404              ELSE
 10405                  MOVE ER-2609                TO WS-ERROR
 10406                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10407
 10408*    GO TO 0560-EDIT-CONTINUE.
 10409
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 190
* EL050.cbl
 10410 0560-EDIT-CONTINUE.
 10411     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10412                                    WS-AH-PMF-COMM
 10413*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10414*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10415     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10416        (SUB1 > +10)
 10417        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10418           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10419           MOVE '0530'           TO CTBL-SW
 10420           MOVE ' '              TO WS-CTBL-READ-SW
 10421           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10422           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10423           MOVE '0540'           TO CTBL-SW
 10424           MOVE ' '              TO WS-CTBL-READ-SW
 10425           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10426        END-IF
 10427     END-PERFORM
 10428     GO TO 0564-EDIT-CONTINUE
 10429     .
 10430 0561-CHECK-AH.
 10431     IF (NO-AH-COVERAGE)
 10432        OR (NO-AH-BENEFIT-MATCH)
 10433        CONTINUE
 10434     ELSE
 10435        IF (AM-A-COM (SUB1) NUMERIC)
 10436           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10437           IF (AM-COM-TYP (SUB1) = 'A')
 10438              AND (WS-AH-PMF-COMM = ZEROS)
 10439              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10440           END-IF
 10441           CONTINUE
 10442        ELSE
 10443           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10444           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10445           MOVE PB-AH-OVERRIDE-L1
 10446                                 TO CTBL-BEN-TYPE
 10447           MOVE ZEROS            TO WS-SUB1
 10448                                    WS-COMMISSION
 10449           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10450           PERFORM 8300-READ-CTBL-TABLE
 10451                                 THRU 8300-EXIT
 10452           IF CTBL-TABLE-FOUND
 10453              IF (AM-COM-TYP (SUB1) = 'A')
 10454                 AND (WS-AH-PMF-COMM = ZEROS)
 10455                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10456                                        PB-I-AH-TERM
 10457                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10458                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10459              END-IF
 10460              CONTINUE
 10461           ELSE
 10462              IF FIRST-TIME-THROUGH
 10463                 GO TO 0561-CHECK-AH
 10464              ELSE
 10465                 MOVE ER-2609    TO WS-ERROR
 10466                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10467              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 191
* EL050.cbl
 10468           END-IF
 10469        END-IF
 10470     END-IF
 10471     .
 10472 0561-EXIT.
 10473     EXIT.
 10474 0563-CHECK-LF.
 10475     IF (NO-LIFE-COVERAGE)
 10476        OR (NO-LF-BENEFIT-MATCH)
 10477        CONTINUE
 10478     ELSE
 10479        IF WS-LF-JOINT-INDICATOR = 'J'
 10480           IF AM-J-COM (SUB1) NUMERIC
 10481              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10482              IF (AM-COM-TYP (SUB1) = 'A')
 10483                 AND (WS-LF-PMF-COMM = ZEROS)
 10484                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10485              END-IF
 10486              CONTINUE
 10487           ELSE
 10488              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10489              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10490              MOVE PB-LIFE-OVERRIDE-L1
 10491                                 TO CTBL-BEN-TYPE
 10492              MOVE ZEROS         TO WS-SUB1
 10493                                    WS-COMMISSION
 10494              MOVE AM-J-COMA (SUB1)
 10495                                 TO CTBL-TABLE
 10496              PERFORM 8300-READ-CTBL-TABLE
 10497                                 THRU 8300-EXIT
 10498              IF CTBL-TABLE-FOUND
 10499                 IF (AM-COM-TYP (SUB1) = 'A')
 10500                    AND (WS-LF-PMF-COMM = ZEROS)
 10501                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10502                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10503                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10504                 END-IF
 10505                 CONTINUE
 10506              ELSE
 10507                 IF FIRST-TIME-THROUGH
 10508                    GO TO 0563-CHECK-LF
 10509                 ELSE
 10510                    MOVE ER-2609 TO WS-ERROR
 10511                    PERFORM 9900-ERROR-FORMAT
 10512                                 THRU 9900-EXIT
 10513*                   GO TO 0560-EDIT-CONTINUE
 10514                 END-IF
 10515              END-IF
 10516           END-IF
 10517        ELSE
 10518           IF AM-L-COM (SUB1) NUMERIC
 10519              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10520              IF (AM-COM-TYP (SUB1) = 'A')
 10521                 AND (WS-LF-PMF-COMM = ZEROS)
 10522                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10523              END-IF
 10524              CONTINUE
 10525           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 192
* EL050.cbl
 10526              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10527              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10528              MOVE PB-LIFE-OVERRIDE-L1
 10529                                 TO CTBL-BEN-TYPE
 10530              MOVE ZEROS         TO WS-SUB1
 10531                                    WS-COMMISSION
 10532              MOVE AM-L-COMA (SUB1)
 10533                                 TO CTBL-TABLE
 10534              PERFORM 8300-READ-CTBL-TABLE
 10535                                 THRU 8300-EXIT
 10536              IF CTBL-TABLE-FOUND
 10537                 CONTINUE
 10538              ELSE
 10539                 IF FIRST-TIME-THROUGH
 10540                    GO TO 0563-CHECK-LF
 10541                 ELSE
 10542                    MOVE ER-2609 TO WS-ERROR
 10543                    PERFORM 9900-ERROR-FORMAT
 10544                                 THRU 9900-EXIT
 10545                 END-IF
 10546              END-IF
 10547           END-IF
 10548        END-IF
 10549     END-IF
 10550     .
 10551 0563-EXIT.
 10552     EXIT.
 10553 0564-EDIT-CONTINUE.
 10554
 10555     IF  PB-COMPANY-ID EQUAL 'DMD'
 10556         IF PB-I-NUM-BILLED EQUAL ZEROS
 10557            MOVE ER-8148       TO WS-ERROR
 10558            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10559
 10560*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10561*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10562*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10563*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10564*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10565*         IF NO-CONVERSION-ERROR
 10566*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10567*         ELSE
 10568*             IF PB-COMPANY-ID EQUAL 'HAN'
 10569*                 MOVE ZEROS     TO PB-I-AGE.
 10570     IF PB-I-BIRTHDAY > LOW-VALUES
 10571        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10572        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10573        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10574        PERFORM 8500-DATE-CONVERT
 10575                                 THRU 8500-EXIT
 10576        IF NO-CONVERSION-ERROR
 10577           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10578           IF PB-I-AGE > ZEROS
 10579              IF WS-WORK-AGE NOT = PB-I-AGE
 10580                 MOVE ER-9501    TO WS-ERROR
 10581                 PERFORM 9900-ERROR-FORMAT
 10582                                 THRU 9900-EXIT
 10583              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 193
* EL050.cbl
 10584           ELSE
 10585              MOVE WS-WORK-AGE   TO PB-I-AGE
 10586           END-IF
 10587        END-IF
 10588     END-IF
 10589     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10590                                   WS-INS-AGE-SET
 10591     IF PB-I-AGE = ZEROS
 10592        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10593           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10594                                   WS-INS-AGE-SET
 10595           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10596
 10597     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10598                                   WS-AH-EDIT-AGE.
 10599
 10600     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10601        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10602        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10603        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10604        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10605        IF NO-CONVERSION-ERROR
 10606           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10607           IF PB-I-JOINT-AGE > 0
 10608              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10609                 MOVE ER-9503    TO WS-ERROR
 10610                 PERFORM 9900-ERROR-FORMAT
 10611                                 THRU 9900-EXIT
 10612              END-IF
 10613           ELSE
 10614              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10615           END-IF
 10616        ELSE
 10617           MOVE ZEROS            TO PB-I-JOINT-AGE
 10618        END-IF
 10619     END-IF
 10620     IF PB-I-JOINT-AGE NOT NUMERIC
 10621        MOVE ZERO               TO PB-I-JOINT-AGE.
 10622
 10623     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10624                                   WS-JNT-AGE-SET
 10625     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10626        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10627           (WS-AH-JOINT-INDICATOR = 'J')
 10628           IF PB-I-JOINT-AGE = ZEROS
 10629               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10630                                          WS-JNT-AGE-SET
 10631               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10632           END-IF
 10633        END-IF
 10634     END-IF
 10635
 10636     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10637     IF WS-LF-JOINT-INDICATOR = 'J'
 10638        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10639        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10640            IF  PB-I-JOINT-AGE = ZERO
 10641                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 194
* EL050.cbl
 10642                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10643            ELSE
 10644                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10645                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10646                    IF PB-COMPANY-ID NOT = 'LBL'
 10647                        MOVE ER-2685    TO WS-ERROR
 10648                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10649
 10650     IF WS-AH-JOINT-INDICATOR = 'J'
 10651        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10652            IF  PB-I-JOINT-AGE = ZERO
 10653                MOVE ER-2686       TO WS-ERROR
 10654                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10655            ELSE
 10656                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10657                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10658                                           WS-EDIT-AGE
 10659                    IF PB-COMPANY-ID NOT = 'LBL'
 10660                        MOVE ER-2685    TO WS-ERROR
 10661                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10662
 10663******************************************************************
 10664*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10665******************************************************************
 10666
 10667     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10668        (WS-AH-SPECIAL-CALC-CD = 'O')
 10669        NEXT SENTENCE
 10670     ELSE
 10671        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10672          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10673           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10674            WS-AH-JOINT-INDICATOR = 'J')  AND
 10675           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10676            MOVE ER-2627             TO WS-ERROR
 10677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10678
 10679     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10680        (WS-AH-SPECIAL-CALC-CD = 'O')
 10681         NEXT SENTENCE
 10682     ELSE
 10683         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10684            WS-AH-JOINT-INDICATOR = 'J'
 10685             IF PB-I-JOINT-INSURED = SPACES
 10686                 IF PB-COMPANY-ID NOT = 'JAL'
 10687                     MOVE ER-2696    TO WS-ERROR
 10688                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10689
 10690     IF PB-COMPANY-ID NOT = 'BOA'
 10691        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10692           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10693           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10694               PB-I-JOINT-INSURED NOT = SPACES)
 10695                MOVE ER-2691         TO WS-ERROR
 10696                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10697
 10698     IF PB-COMPANY-ID = 'BOA'
 10699        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 195
* EL050.cbl
 10700           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10701            IF PB-I-JOINT-AGE NOT = ZEROS
 10702                MOVE ER-2691         TO WS-ERROR
 10703                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10704
 10705     IF PB-COMPANY-ID = 'CRI'
 10706        IF PB-I-SIG-SW = 'J'
 10707           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10708              WS-AH-JOINT-INDICATOR NOT = 'J'
 10709              MOVE ER-2675       TO WS-ERROR
 10710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711
 10712     IF PB-COMPANY-ID = 'CRI'
 10713        IF PB-I-SIG-SW = 'S'
 10714           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10715              WS-AH-JOINT-INDICATOR = 'J'
 10716              MOVE ER-2676       TO WS-ERROR
 10717              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10718
 10719     IF PB-COMPANY-ID = 'CVL'
 10720         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10721            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10722              MOVE ER-2783           TO WS-ERROR
 10723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10724     IF (WS-LF-JOINT-INDICATOR = 'J')
 10725        AND (WS-AH-JOINT-INDICATOR = 'J')
 10726        AND (PB-I-LF-TERM > 120)
 10727        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10728        MOVE ER-2783             TO WS-ERROR
 10729        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10730     END-IF
 10731     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10732
 10733     IF PB-I-INDV-GRP-OVRD = 'I'
 10734        MOVE ER-2666             TO WS-ERROR
 10735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10736        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10737
 10738     IF PB-I-INDV-GRP-OVRD = 'G'
 10739        MOVE ER-2666             TO WS-ERROR
 10740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10741        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10742
 10743     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10744        NEXT SENTENCE
 10745     ELSE
 10746        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10747
 10748     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10749        IF WS-ERROR = ER-2666
 10750           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10751           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10752
 10753     IF PB-COMPANY-ID = 'CID'
 10754        IF PB-STATE = 'UT' OR 'MO'
 10755           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10756                 OR '76' OR '77')
 10757                      OR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 196
* EL050.cbl
 10758               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10759                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10760                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10761                   OR '2K' OR '2L'))
 10762              AND PB-I-INDV-GRP-CD = 'I'
 10763              MOVE ER-2721             TO WS-ERROR
 10764              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10765           END-IF
 10766        END-IF
 10767     END-IF
 10768
 10769     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10770     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10771        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10772     ELSE
 10773        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10774     END-IF
 10775
 10776*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10777*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10778     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10779                                    ACCOUNT-AH-CK-SW.
 10780
 10781     IF PB-REISSUED-CERT       OR
 10782        PB-REIN-ONLY-CERT      OR
 10783        PB-POLICY-IS-DECLINED  OR
 10784        PB-POLICY-IS-VOIDED
 10785*       OR PB-MONTHLY-CERT
 10786         GO TO 3000-CONTINUE-EDIT.
 10787
 10788     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10789        IF WS-EDIT-AGE           > +65
 10790           MOVE ER-2709          TO WS-ERROR
 10791           PERFORM 9900-ERROR-FORMAT
 10792                                 THRU 9900-EXIT
 10793        ELSE
 10794           IF WS-EDIT-AGE        > +55
 10795              MOVE ER-2718       TO WS-ERROR
 10796              PERFORM 9900-ERROR-FORMAT
 10797                                 THRU 9900-EXIT
 10798           END-IF
 10799        END-IF
 10800     IF PB-COMPANY-ID = 'DCC'
 10801        IF WS-EDIT-AGE           > +65
 10802           MOVE ER-2709          TO WS-ERROR
 10803           PERFORM 9900-ERROR-FORMAT
 10804                                 THRU 9900-EXIT
 10805        END-IF
 10806     END-IF
 10807     .
 10808
 10809 0565-LIFE-PLAN-LIMIT-EDITS.
 10810
 10811     IF NOT LF-PLAN-MASTER-FOUND
 10812        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10813                                    EC-AM-LF-MAX-TOT-BEN
 10814        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10815
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 197
* EL050.cbl
 10816     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10817
 10818     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10819         IF PL-LM-AGE (1) = ZEROS
 10820             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10821
 10822     IF NO-LF-BENEFIT-MATCH          OR
 10823        WS-LF-BENEFIT-CD = ZEROS     OR
 10824        WS-LF-SPECIAL-CALC-CD = 'M'
 10825        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10826
 10827     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10828     MOVE +1                     TO SUB2.
 10829
 10830     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10831        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10832           MOVE +5   TO SUB2
 10833           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10834              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10835              (PL-LM-AGE (SUB2) EQUAL +0)
 10836              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10837              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10838
 10839     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10840
 10841     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10842                               + PB-I-LF-ALT-BENEFIT-AMT.
 10843
 10844 0568-CHECK-LIFE-ATT-AGE.
 10845
 10846     IF PL-ATT-AGE NUMERIC AND
 10847        PL-ATT-AGE > +0
 10848        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10849     END-IF
 10850*    IF PL-ATT-AGE NUMERIC AND
 10851*       PL-ATT-AGE > +0
 10852*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10853*       IF PB-I-BIRTHDAY > LOW-VALUES
 10854*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10855*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10856*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10857*          SET BIN-PLUS-ELAPSED  TO TRUE
 10858*          PERFORM 8500-DATE-CONVERT
 10859*                                THRU 8500-EXIT
 10860*          IF NO-CONVERSION-ERROR
 10861*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10862*             MOVE ER-2669       TO WS-ERROR
 10863*             PERFORM 9900-ERROR-FORMAT
 10864*                                THRU 9900-EXIT
 10865*          END-IF
 10866*       ELSE
 10867*          IF WS-ATT-AGE >= PL-ATT-AGE
 10868*             MOVE ER-2669       TO WS-ERROR
 10869*             PERFORM 9900-ERROR-FORMAT
 10870*                                THRU 9900-EXIT
 10871*          END-IF
 10872*       END-IF
 10873*    END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 198
* EL050.cbl
 10874     .
 10875 0570-CHECK-LIFE-LIMITS.
 10876
 10877     IF PB-COMPANY-ID EQUAL 'CRI'
 10878        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10879           IF SUB2 GREATER THAN +4
 10880              MOVE ER-2637 TO WS-ERROR
 10881              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10882              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10883
 10884     IF PB-COMPANY-ID  =  'NCL'
 10885        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10886            SUB2 GREATER THAN +8
 10887             MOVE 'U'         TO PB-BATCH-ENTRY
 10888             MOVE ER-2637     TO WS-ERROR
 10889             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10890             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10891
 10892     IF SUB2 > +8
 10893        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10894           AND (PB-I-SIG-SW = 'Y')
 10895           CONTINUE
 10896        ELSE
 10897           MOVE ER-2637          TO WS-ERROR
 10898           PERFORM 9900-ERROR-FORMAT
 10899                                 THRU 9900-EXIT
 10900        END-IF
 10901        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10902     END-IF
 10903     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10904     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10905     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10906
 10907     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10908        ADD +1  TO SUB2
 10909        GO TO 0570-CHECK-LIFE-LIMITS.
 10910
 10911     IF PB-COMPANY-ID = 'NCL'
 10912         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10913
 10914     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10915        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10916        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10917           AND (PB-I-SIG-SW = 'Y')
 10918           CONTINUE
 10919        ELSE
 10920           MOVE ER-2637          TO WS-ERROR
 10921           PERFORM 9900-ERROR-FORMAT
 10922                                 THRU 9900-EXIT
 10923        END-IF
 10924     END-IF
 10925     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10926
 10927
 10928 0570-CHECK-NCL-LIFE-LIMITS.
 10929
 10930     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10931        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 199
* EL050.cbl
 10932         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10933
 10934     IF APP-CERT-USED
 10935         IF SUB2  LESS THAN  +5
 10936             MOVE +5          TO SUB2
 10937             GO TO 0570-CHECK-LIFE-LIMITS.
 10938
 10939     MOVE ER-2637             TO WS-ERROR.
 10940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10941
 10942     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10943
 10944 0575-CHECK-NCL-SIG-SWITCH.
 10945
 10946     IF NOT APP-CERT-USED
 10947         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10948
 10949     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10950        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10951        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10952        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10953         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10954
 10955     IF SUB2 GREATER THAN +4
 10956         IF PL-LM-AGE (5) = ZEROS  AND
 10957            PL-LM-AGE (6) = ZEROS  AND
 10958            PL-LM-AGE (7) = ZEROS  AND
 10959            PL-LM-AGE (8) = ZEROS
 10960             MOVE  ER-1927        TO WS-ERROR
 10961             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10962             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10963         ELSE
 10964             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10965                 MOVE  ER-1920    TO WS-ERROR
 10966                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10967
 10968     IF PB-I-SIG-SW  = 'Y'
 10969       IF NOT PB-I-POLICY-ACCEPTED  AND
 10970          NOT PB-I-POLICY-DECLINED
 10971           MOVE 'U'               TO PB-BATCH-ENTRY
 10972           MOVE  ER-1926          TO WS-ERROR
 10973           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10974
 10975
 10976 0580-AH-PLAN-LIMIT-EDITS.
 10977
 10978     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10979        IF PB-I-AH-BENEFIT-AMT > +1250
 10980           MOVE ER-2702          TO WS-ERROR
 10981           PERFORM 9900-ERROR-FORMAT
 10982                                 THRU 9900-EXIT
 10983        END-IF
 10984     END-IF
 10985
 10986     IF (PB-COMPANY-ID = 'DCC')
 10987        AND (PB-MONTHLY-CERT)
 10988        IF PB-I-AH-BENEFIT-AMT > +3000
 10989           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 200
* EL050.cbl
 10990           PERFORM 9900-ERROR-FORMAT
 10991                                 THRU 9900-EXIT
 10992        END-IF
 10993     END-IF
 10994     IF NOT AH-PLAN-MASTER-FOUND
 10995        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10996        GO TO 3000-CONTINUE-EDIT.
 10997
 10998     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10999
 11000     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11001         IF PL-LM-AGE (1) = ZEROS
 11002             GO TO 3000-CONTINUE-EDIT.
 11003
 11004     IF NO-AH-BENEFIT-MATCH          OR
 11005        WS-AH-BENEFIT-CD = ZEROS     OR
 11006        WS-AH-SPECIAL-CALC-CD = 'M'
 11007        GO TO 3000-CONTINUE-EDIT.
 11008
 11009     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11010     MOVE +1                     TO SUB2.
 11011
 11012     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11013        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11014           MOVE +5 TO SUB2
 11015           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11016              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11017              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11018              (PL-LM-AGE (SUB2) EQUAL +0)
 11019              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11020              GO TO 3000-CONTINUE-EDIT.
 11021
 11022     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11023
 11024 0590-CHECK-AH-ATT-AGE.
 11025
 11026     IF PL-ATT-AGE NUMERIC AND
 11027        PL-ATT-AGE GREATER THAN +0
 11028        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11029     END-IF
 11030*       IF WS-ATT-AGE >= PL-ATT-AGE
 11031*          MOVE ER-3054          TO WS-ERROR
 11032*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11033     .
 11034 0597-CHECK-AH-LIMITS.
 11035
 11036     IF PB-COMPANY-ID EQUAL 'CRI'
 11037        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11038           IF SUB2 GREATER THAN +4
 11039              MOVE ER-2638       TO WS-ERROR
 11040              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11041              GO TO 3000-CONTINUE-EDIT.
 11042
 11043     IF PB-COMPANY-ID  =  'NCL'
 11044        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11045            SUB2 GREATER THAN +8
 11046             MOVE 'U'            TO PB-BATCH-ENTRY
 11047             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 201
* EL050.cbl
 11048             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11049             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11050
 11051     IF SUB2 > +8
 11052        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11053           AND (PB-I-SIG-SW = 'Y')
 11054           CONTINUE
 11055        ELSE
 11056           MOVE ER-2638          TO WS-ERROR
 11057           PERFORM 9900-ERROR-FORMAT
 11058                                 THRU 9900-EXIT
 11059        END-IF
 11060        GO TO 3000-CONTINUE-EDIT
 11061     END-IF
 11062
 11063     IF PB-COMPANY-ID = 'CRI'
 11064        IF WS-ERROR = ER-2638
 11065           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11066
 11067     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11068     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11069     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11070     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11071
 11072     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11073        ADD +1                   TO SUB2
 11074        GO TO 0597-CHECK-AH-LIMITS.
 11075
 11076     IF PB-COMPANY-ID = 'NCL'
 11077         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11078
 11079     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11080        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11081        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11082                                 > PL-LM-AMT (SUB2))
 11083        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11084           AND (PB-I-SIG-SW = 'Y')
 11085           CONTINUE
 11086        ELSE
 11087           MOVE ER-2638          TO WS-ERROR
 11088           PERFORM 9900-ERROR-FORMAT
 11089                                 THRU 9900-EXIT
 11090        END-IF
 11091     END-IF
 11092
 11093     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11094         IF  WS-ERROR    EQUAL    ER-2638
 11095             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11096                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11097                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11098                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11099                MOVE  ER-1910    TO  WS-ERROR
 11100                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11101
 11102     IF PB-COMPANY-ID = 'CRI'
 11103        IF WS-ERROR = ER-2638
 11104            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11105            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 202
* EL050.cbl
 11106            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11107
 11108     GO TO 3000-CONTINUE-EDIT.
 11109
 11110 0597-CHECK-NCL-AH-LIMITS.
 11111
 11112     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11113        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11114        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11115                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11116         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11117
 11118     IF APP-CERT-USED
 11119         IF SUB2  LESS THAN  +5
 11120             MOVE +5             TO SUB2
 11121             GO TO 0597-CHECK-AH-LIMITS.
 11122
 11123     MOVE ER-2638                TO WS-ERROR.
 11124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11125
 11126     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11127
 11128 0599-CHECK-NCL-SIG-SWITCH.
 11129
 11130     IF NOT APP-CERT-USED
 11131         GO TO 3000-CONTINUE-EDIT.
 11132
 11133     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11134        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11135        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11136        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11137         GO TO 3000-CONTINUE-EDIT.
 11138
 11139     IF SUB2 GREATER THAN +4
 11140         IF PL-LM-AGE (5) = ZEROS  AND
 11141            PL-LM-AGE (6) = ZEROS  AND
 11142            PL-LM-AGE (7) = ZEROS  AND
 11143            PL-LM-AGE (8) = ZEROS
 11144             MOVE  ER-1927        TO WS-ERROR
 11145             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11146             GO TO 3000-CONTINUE-EDIT
 11147         ELSE
 11148             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11149                 MOVE  ER-1920    TO WS-ERROR
 11150                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11151
 11152     IF PB-I-SIG-SW  = 'Y'
 11153       IF NOT PB-I-POLICY-ACCEPTED  AND
 11154          NOT PB-I-POLICY-DECLINED
 11155           MOVE 'U'               TO PB-BATCH-ENTRY
 11156           MOVE  ER-1926          TO WS-ERROR
 11157           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11158
 11159******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 203
* EL050.cbl
 11161
 11162 3000-CONTINUE-EDIT.
 11163
 11164     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11165     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11166     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11167     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11168     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11169
 11170     IF BROWSE-STARTED
 11171        PERFORM 9990-RETURN THRU 9990-EXIT
 11172        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11173
 11174     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11175        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11176        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11177        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11178*       MOVE 1                   TO DC-OPTION-CODE
 11179        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11180        IF DATE-CONVERSION-ERROR
 11181           MOVE ER-2622          TO WS-ERROR
 11182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11183        ELSE
 11184           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11185              MOVE ER-2623       TO WS-ERROR
 11186              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11187           ELSE
 11188              MOVE ER-2622       TO WS-ERROR
 11189              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11190
 11191     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11192     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11193     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11194*    MOVE 1                      TO DC-OPTION-CODE.
 11195     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11196     IF DATE-CONVERSION-ERROR
 11197        GO TO 3005-EDIT-CONTINUE
 11198     ELSE
 11199        IF DC-ELAPSED-DAYS GREATER +180
 11200           MOVE ER-2613          TO WS-ERROR
 11201           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11202        ELSE
 11203           IF DC-ELAPSED-DAYS GREATER +90
 11204              MOVE ER-2612       TO WS-ERROR
 11205              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11206           ELSE
 11207             IF DC-ELAPSED-DAYS GREATER +60
 11208                MOVE ER-2614     TO WS-ERROR
 11209                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11210
 11211 3005-EDIT-CONTINUE.
 11212
 11213     IF PB-CANCELLATION
 11214         GO TO 3700-EDIT-CANCEL.
 11215
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 204
* EL050.cbl
 11217******************************************************************
 11218*                  E D I T   I S S U E                           *
 11219******************************************************************
 11220
 11221 3020-EDIT-ISSUE.
 11222
 11223      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11224      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11225      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11226      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11227      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11228
 11229     IF PB-ISSUE-FORCE
 11230        OR PB-ISSUE-DATE-FORCED
 11231        OR PB-FORCE-OFF
 11232        OR PB-OVERCHARGE-FORCE
 11233        CONTINUE
 11234     ELSE
 11235        MOVE ER-2670             TO WS-ERROR
 11236        PERFORM 9900-ERROR-FORMAT
 11237                                 THRU 9900-EXIT
 11238     END-IF
 11239     .
 11240 3022-SET-POLICY-STATUS.
 11241
 11242     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11243
 11244     IF (PB-REISSUED-CERT)
 11245             OR
 11246        ((PB-COMPANY-ID NOT = 'DCC')
 11247         AND (PB-MONTHLY-CERT))
 11248         MOVE '5'                TO PB-I-ENTRY-STATUS
 11249         MOVE 'E'                TO PB-BATCH-ENTRY
 11250     END-IF
 11251
 11252     IF PB-COMPANY-ID = 'DCC'
 11253        IF PB-MONTHLY-CERT
 11254           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11255        END-IF
 11256     END-IF
 11257     IF PB-POLICY-IS-DECLINED
 11258         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11259     IF PB-POLICY-IS-VOIDED
 11260         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11261     IF PB-NEEDS-UNDERWRITING
 11262         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11263     IF PB-REIN-ONLY-CERT
 11264         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11265     IF PB-PREM-ACCTNG-ONLY
 11266         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11267
 11268     MOVE SPACE                  TO PB-I-OB-FLAG.
 11269
 11270     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11271         MOVE ER-2665            TO WS-ERROR
 11272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11273         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11274
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 205
* EL050.cbl
 11275     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11276        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11277           MOVE 'Z'             TO PB-I-OB-FLAG.
 11278
 11279     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11280        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11281           MOVE 'Z'             TO PB-I-OB-FLAG.
 11282
 11283     IF ACCOUNT-MAST-FOUND
 11284         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11285         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11286         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11287         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11288         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11289         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11290         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11291     END-IF
 11292
 11293     IF ACCOUNT-MAST-FOUND
 11294        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11295         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11296
 11297     IF (ACCOUNT-MAST-FOUND)
 11298        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11299        IF PB-REISSUED-CERT
 11300           CONTINUE
 11301        ELSE
 11302           MOVE ER-2608          TO WS-ERROR
 11303           PERFORM 9900-ERROR-FORMAT
 11304                                 THRU 9900-EXIT
 11305         END-IF
 11306     END-IF
 11307
 11308     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11309        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11310        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11311
 11312**********   DMD CUSTOM CODE FOLLOWS  **********
 11313 3024-EDIT-DMD-FIELDS.
 11314     IF PB-COMPANY-ID NOT = 'DMD'
 11315        GO TO 3025-EDIT-REINSURANCE.
 11316
 11317*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11318*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11319*** ERROR IF THEY ARE NOT EQUAL.
 11320
 11321     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11322     SET BIN-TO-GREG               TO TRUE.
 11323     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11324     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11325**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11326
 11327     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11328     SET BIN-TO-GREG               TO TRUE.
 11329     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11330     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11331**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11332
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 206
* EL050.cbl
 11333     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11334        MOVE ER-8116               TO WS-ERROR
 11335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11336
 11337     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11338
 11339     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11340                                      WK-FULL-CERT-NO.
 11341     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11342
 11343     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11344
 11345     IF PB-VALID-LIFE
 11346        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11347     ELSE
 11348        IF PB-VALID-AH
 11349          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11350
 11351
 11352     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11353     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11354     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11355                                      DCUA-UNDRWRTR-CODE
 11356                                      DCUA-UNDRWRTR-GROUP-CODE
 11357                                      DCUA-RETURN-CODE.
 11358
 11359****************************************************************
 11360*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11361***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11362***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11363***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11364***   TO THIS RECORD.                                        ***
 11365****************************************************************
 11366     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11367     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11368     IF DCUA-SUCCESSFUL-PROCESS
 11369        GO TO 3024-EDIT-DL7-CONT.
 11370
 11371     IF DCUA-RETURN-CODE EQUAL '01'
 11372        MOVE ER-8110               TO WS-ERROR
 11373        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL7-CONT.
 11376
 11377     IF DCUA-RETURN-CODE EQUAL '02'
 11378        MOVE ER-8111               TO WS-ERROR
 11379        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11381        GO TO 3024-EDIT-DL7-CONT.
 11382
 11383     IF DCUA-RETURN-CODE EQUAL '03'
 11384        MOVE ER-8074               TO WS-ERROR
 11385        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387        GO TO 3024-EDIT-DL7-CONT.
 11388
 11389     IF DCUA-RETURN-CODE EQUAL '04'
 11390        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 207
* EL050.cbl
 11391        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11393        GO TO 3024-EDIT-DL7-CONT.
 11394
 11395     IF DCUA-RETURN-CODE EQUAL '05'
 11396        MOVE ER-8076               TO WS-ERROR
 11397        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399        GO TO 3024-EDIT-DL7-CONT.
 11400
 11401     IF DCUA-RETURN-CODE EQUAL '06'
 11402        MOVE ER-8077               TO WS-ERROR
 11403        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 3024-EDIT-DL7-CONT.
 11406
 11407     IF DCUA-RETURN-CODE EQUAL '07'
 11408        MOVE ER-8078               TO WS-ERROR
 11409        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11411        GO TO 3024-EDIT-DL7-CONT.
 11412
 11413     IF DCUA-RETURN-CODE EQUAL 'E1'
 11414        MOVE ER-8079               TO WS-ERROR
 11415        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL7-CONT.
 11418
 11419     IF DCUA-RETURN-CODE EQUAL 'E2'
 11420        MOVE ER-8080               TO WS-ERROR
 11421        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11423        GO TO 3024-EDIT-DL7-CONT.
 11424
 11425     IF DCUA-RETURN-CODE EQUAL 'E3'
 11426        MOVE ER-8098               TO WS-ERROR
 11427        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11429        GO TO 3024-EDIT-DL7-CONT.
 11430
 11431     IF DCUA-RETURN-CODE EQUAL 'C1'
 11432        MOVE ER-8099               TO WS-ERROR
 11433        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL7-CONT.
 11436
 11437     IF DCUA-RETURN-CODE EQUAL 'U1'
 11438        MOVE ER-8109               TO WS-ERROR
 11439        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL7-CONT.
 11442
 11443     IF DCUA-RETURN-CODE EQUAL 'N1'
 11444        MOVE ER-8112               TO WS-ERROR
 11445        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11447        GO TO 3024-EDIT-DL7-CONT.
 11448
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 208
* EL050.cbl
 11449     IF DCUA-RETURN-CODE EQUAL 'N2'
 11450        MOVE ER-8113               TO WS-ERROR
 11451        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11453        GO TO 3024-EDIT-DL7-CONT.
 11454
 11455     IF DCUA-RETURN-CODE EQUAL 'N3'
 11456        MOVE ER-8114               TO WS-ERROR
 11457        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11459        GO TO 3024-EDIT-DL7-CONT.
 11460
 11461     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11462     MOVE ER-8097                  TO WS-ERROR.
 11463     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11464     GO TO 3024-EDIT-DL7-CONT.
 11465
 11466 3024-EDIT-DL7-CONT.
 11467
 11468     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11469     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11470     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11471        NEXT SENTENCE
 11472     ELSE
 11473        MOVE ER-9263               TO WS-ERROR
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11475
 11476******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11477******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11478     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11479        NEXT SENTENCE
 11480     ELSE
 11481        MOVE ER-8039               TO WS-ERROR
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11483
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 209
* EL050.cbl
 11485****************************************************************
 11486*** VALIDATE STATE  : DLO022                                 ***
 11487****************************************************************
 11488     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11489     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11490
 11491     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11492     IF DVSC-SUCCESSFUL-EDIT
 11493        GO TO 3024-EDIT-DL22-CONT.
 11494
 11495     IF DVSC-RETURN-CODE EQUAL '01'
 11496        MOVE ER-8300               TO WS-ERROR
 11497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11498        GO TO 3024-EDIT-DL22-CONT.
 11499
 11500     IF DVSC-RETURN-CODE EQUAL '02'
 11501        MOVE ER-8301               TO WS-ERROR
 11502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11503        GO TO 3024-EDIT-DL22-CONT.
 11504
 11505     IF DVSC-RETURN-CODE EQUAL '03'
 11506        MOVE ER-8302               TO WS-ERROR
 11507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11508        GO TO 3024-EDIT-DL22-CONT.
 11509
 11510     IF DVSC-RETURN-CODE EQUAL 'N1'
 11511        MOVE ER-8304               TO WS-ERROR
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11513        GO TO 3024-EDIT-DL22-CONT.
 11514
 11515     MOVE ER-8303                  TO WS-ERROR
 11516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11517
 11518 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 210
* EL050.cbl
 11520****************************************************************
 11521*** VALIDATE LOAN OFFICER : DLO021                           ***
 11522****************************************************************
 11523
 11524     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11525     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11526     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11527     IF DVLO-SUCCESSFUL-EDIT
 11528        GO TO 3024-EDIT-DL21-CONT.
 11529
 11530     IF DVLO-RETURN-CODE EQUAL '01'
 11531        MOVE ER-8081               TO WS-ERROR
 11532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11533        GO TO 3024-EDIT-DL21-CONT.
 11534
 11535     IF DVLO-RETURN-CODE EQUAL '02'
 11536        MOVE ER-8082               TO WS-ERROR
 11537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538        GO TO 3024-EDIT-DL21-CONT.
 11539
 11540     IF DVLO-RETURN-CODE EQUAL '03'
 11541        MOVE ER-8083               TO WS-ERROR
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11543        GO TO 3024-EDIT-DL21-CONT.
 11544
 11545     IF DVLO-RETURN-CODE EQUAL '04'
 11546        MOVE ER-8084               TO WS-ERROR
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11548        GO TO 3024-EDIT-DL21-CONT.
 11549
 11550     IF DVLO-RETURN-CODE EQUAL '05'
 11551        MOVE ER-8085               TO WS-ERROR
 11552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11553        GO TO 3024-EDIT-DL21-CONT.
 11554
 11555     MOVE ER-7825                  TO WS-ERROR
 11556     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11557     GO TO 3024-EDIT-DL21-CONT.
 11558
 11559 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 211
* EL050.cbl
 11561
 11562****************************************************************
 11563*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11564****************************************************************
 11565
 11566     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11567     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11568     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11569     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11570     IF DIPF-SUCCESSFUL-EDIT
 11571        GO TO 3024-EDIT-DL02-CONT.
 11572
 11573     IF DIPF-RETURN-CODE EQUAL '01'
 11574        MOVE ER-8086               TO WS-ERROR
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL02-CONT.
 11577
 11578     IF DIPF-RETURN-CODE EQUAL '02'
 11579        MOVE ER-8087               TO WS-ERROR
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11581        GO TO 3024-EDIT-DL02-CONT.
 11582
 11583     IF DIPF-RETURN-CODE EQUAL '03'
 11584        MOVE ER-8088               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 3024-EDIT-DL02-CONT.
 11587
 11588     MOVE ER-8095                  TO WS-ERROR
 11589     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11590     GO TO 3024-EDIT-DL02-CONT.
 11591
 11592 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 212
* EL050.cbl
 11594
 11595****************************************************************
 11596*** VALIDATE BANK ID : DLO003                                ***
 11597****************************************************************
 11598
 11599     MOVE WK-GREG-CENT           TO WCG-CENT.
 11600     MOVE WK-GREG-YYMM           TO WCG-REST.
 11601     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11602        MOVE ER-8040               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11604
 11605     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11606     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11607     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11608     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11609     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11610     IF DVBI-SUCCESSFUL-EDIT
 11611        GO TO 3024-EDIT-DL03-CONT.
 11612
 11613     IF DVBI-RETURN-CODE EQUAL '01'
 11614        MOVE ER-8089               TO WS-ERROR
 11615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11616        GO TO 3024-EDIT-DL03-CONT.
 11617
 11618     IF DVBI-RETURN-CODE EQUAL '02'
 11619        MOVE ER-8090               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL03-CONT.
 11622
 11623     IF DVBI-RETURN-CODE EQUAL '03'
 11624        MOVE ER-8091               TO WS-ERROR
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626        GO TO 3024-EDIT-DL03-CONT.
 11627
 11628     IF DVBI-RETURN-CODE EQUAL '04'
 11629        MOVE ER-8092               TO WS-ERROR
 11630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11631        GO TO 3024-EDIT-DL03-CONT.
 11632
 11633     IF DVBI-RETURN-CODE EQUAL '05'
 11634        MOVE ER-8093               TO WS-ERROR
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11636        GO TO 3024-EDIT-DL03-CONT.
 11637
 11638     IF DVBI-RETURN-CODE EQUAL '06'
 11639        MOVE ER-8094               TO WS-ERROR
 11640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11641        GO TO 3024-EDIT-DL03-CONT.
 11642
 11643     MOVE ER-8096                  TO WS-ERROR
 11644     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11645     GO TO 3024-EDIT-DL03-CONT.
 11646
 11647 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 213
* EL050.cbl
 11649
 11650     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11651        NEXT SENTENCE
 11652     ELSE
 11653        MOVE ER-8042               TO WS-ERROR
 11654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11655
 11656     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11657     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11658     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11659
 11660     IF DMPF-RETURN-CODE = '01'
 11661        MOVE ER-8067               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL01-CONT.
 11664
 11665     IF DMPF-RETURN-CODE = '02'
 11666        MOVE ER-8068               TO WS-ERROR
 11667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668        GO TO 3024-EDIT-DL01-CONT.
 11669
 11670     IF DMPF-RETURN-CODE = '03'
 11671        MOVE ER-8069               TO WS-ERROR
 11672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11673        GO TO 3024-EDIT-DL01-CONT.
 11674
 11675     IF DMPF-RETURN-CODE = 'E1'
 11676        MOVE ER-8070               TO WS-ERROR
 11677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11678        GO TO 3024-EDIT-DL01-CONT.
 11679
 11680     IF DMPF-RETURN-CODE = 'N1'
 11681        MOVE ER-8071               TO WS-ERROR
 11682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11683        GO TO 3024-EDIT-DL01-CONT.
 11684
 11685     IF DMPF-RETURN-CODE NOT = 'OK'
 11686        MOVE ER-8072               TO WS-ERROR
 11687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11688
 11689 3024-EDIT-DL01-CONT.
 11690******************************************************************
 11691***  VALIDATES RATE CODES : DLO017                             ***
 11692******************************************************************
 11693
 11694      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11695      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11696      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11697      IF DVRC-SUCCESSFUL-EDIT
 11698        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11699        GO TO 3024-CHECK-VALID-RATE.
 11700
 11701      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11702
 11703      IF DVRC-RETURN-CODE EQUAL '01'
 11704         MOVE ER-7817                   TO WS-ERROR
 11705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 214
* EL050.cbl
 11707
 11708      IF DVRC-RETURN-CODE EQUAL '02'
 11709         MOVE ER-7818                   TO WS-ERROR
 11710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711         GO TO 3025-EDIT-REINSURANCE.
 11712
 11713      IF DVRC-RETURN-CODE EQUAL '03'
 11714         MOVE ER-7819                   TO WS-ERROR
 11715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11716         GO TO 3025-EDIT-REINSURANCE.
 11717
 11718       MOVE ER-7820                     TO WS-ERROR.
 11719       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11720       GO TO 3025-EDIT-REINSURANCE.
 11721
 11722******************************************************************
 11723***  GET PREMIUM RATES : DLO011                                ***
 11724******************************************************************
 11725
 11726 3024-CHECK-VALID-RATE.
 11727
 11728     IF VALID-RATE-CODE
 11729        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11730        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11731        MOVE SPACES                TO DPRB-RETURN-CODE
 11732        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11733     ELSE
 11734         GO TO 3025-EDIT-REINSURANCE.
 11735
 11736      IF DPRB-SUCCESSFUL-PROCESS
 11737         IF PB-VALID-LIFE
 11738             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11739             GO TO 3025-EDIT-REINSURANCE
 11740         ELSE
 11741             IF PB-VALID-AH
 11742                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11743                 GO TO 3025-EDIT-REINSURANCE.
 11744
 11745      IF DPRB-RETURN-CODE EQUAL '01'
 11746         MOVE ER-7812                   TO WS-ERROR
 11747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11748         GO TO 3025-EDIT-REINSURANCE.
 11749
 11750      IF DPRB-RETURN-CODE EQUAL '02'
 11751         MOVE ER-7813                   TO WS-ERROR
 11752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11753         GO TO 3025-EDIT-REINSURANCE.
 11754
 11755      IF DPRB-RETURN-CODE EQUAL '03'
 11756         MOVE ER-7814                   TO WS-ERROR
 11757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11758         GO TO 3025-EDIT-REINSURANCE.
 11759
 11760      IF DPRB-RETURN-CODE EQUAL '04'
 11761         IF NOT DPRB-1ST-TIME
 11762            MOVE ER-7815                   TO WS-ERROR
 11763            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11764            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 215
* EL050.cbl
 11765          ELSE
 11766         IF PB-VALID-LIFE
 11767            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11768          ELSE
 11769            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11770         END-IF
 11771         MOVE SPACES                TO DOCC-RETURN-CODE
 11772         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11773         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11774         IF DOCC-RETURN-CODE = 'OK'
 11775             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11776             GO TO 3024-CHECK-VALID-RATE
 11777           ELSE
 11778             MOVE ER-7823               TO WS-ERROR
 11779             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11780             GO TO 3025-EDIT-REINSURANCE.
 11781
 11782       MOVE ER-7816                     TO WS-ERROR.
 11783       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11784       GO TO 3025-EDIT-REINSURANCE.
 11785
 11786**********   DMD CUSTOM CODE ABOVE    **********
 11787
 11788 3025-EDIT-REINSURANCE.
 11789     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11790         GO TO 3027-EDIT-CONTINUE.
 11791
 11792     MOVE LOW-VALUES               TO ERREIN-KEY.
 11793     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11794     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11795                                      REIN-CODE-2
 11796                                      REIN-CODE-3.
 11797     MOVE 'A'                      TO REIN-TYPE.
 11798
 11799     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11800
 11801     MOVE '3026' TO REIN-SW.
 11802     MOVE ' '                   TO WS-REIN-READ-SW.
 11803
 11804     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11805     IF REIN-TABLE-NOT-FOUND
 11806         GO TO 3026-NO-SPEC-TABLE.
 11807
 11808     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11809     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11810                                   WS-NSP-ST-CD-LF.
 11811     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11812                                   WS-NSP-ST-CD-AH.
 11813
 11814     GO TO 3040-EDIT-CONTINUE.
 11815
 11816 3026-NO-SPEC-TABLE.
 11817
 11818     MOVE ER-2664                TO WS-ERROR.
 11819     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11820     GO TO 3040-EDIT-CONTINUE.
 11821
 11822 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 216
* EL050.cbl
 11823
 11824     IF PB-I-REIN-TABLE = SPACES
 11825       GO TO 3040-EDIT-CONTINUE.
 11826
 11827     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11828          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11829          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11830           GO TO 3040-EDIT-CONTINUE.
 11831
 11832     MOVE LOW-VALUES            TO ERREIN-KEY.
 11833     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11834     MOVE 'A'                   TO REIN-TYPE.
 11835     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11836
 11837     MOVE '3028'                TO REIN-SW.
 11838     MOVE ' '                   TO WS-REIN-READ-SW.
 11839
 11840     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11841     IF REIN-TABLE-NOT-FOUND
 11842         GO TO 3028-NO-REIN-TABLE.
 11843
 11844     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11845     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11846                                   WS-NSP-ST-CD-LF.
 11847     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11848                                   WS-NSP-ST-CD-AH.
 11849
 11850     GO TO 3040-EDIT-CONTINUE.
 11851
 11852 3028-NO-REIN-TABLE.
 11853
 11854     MOVE ER-2615                TO WS-ERROR.
 11855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11856     GO TO 3040-EDIT-CONTINUE.
 11857
 11858 3040-EDIT-CONTINUE.
 11859
 11860     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11861         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11862
 11863     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11864         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11865
 11866     IF (NOT PB-REISSUED-CERT)
 11867        AND (NOT PB-MONTHLY-CERT)
 11868        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11869            MOVE '001'           TO PB-I-LF-TERM
 11870            MOVE 'M'             TO PB-I-INSURED-SEX.
 11871
 11872     IF (NOT PB-REISSUED-CERT)
 11873        AND (NOT PB-MONTHLY-CERT)
 11874        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11875            MOVE '001'           TO PB-I-AH-TERM
 11876            MOVE 'M'             TO PB-I-INSURED-SEX.
 11877
 11878 3040-EDIT-1ST-PMT-DT.
 11879     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11880     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 217
* EL050.cbl
 11881         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11882
 11883******************************************************************
 11884*                                                                *
 11885*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11886*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11887*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11888*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11889*                                                                *
 11890******************************************************************
 11891
 11892     IF PB-EFF-DT-PROCESSING
 11893        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11894                                    PB-I-LF-EXPIRE-DT
 11895                                    PB-I-AH-EXPIRE-DT
 11896        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11897        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11898        MOVE ZERO                TO DC-ELAPSED-DAYS
 11899        MOVE +1                  TO DC-ELAPSED-MONTHS
 11900        SET BIN-PLUS-ELAPSED     TO TRUE
 11901*       MOVE 6                   TO DC-OPTION-CODE
 11902        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11903        IF NO-CONVERSION-ERROR
 11904           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11905
 11906******************************************************************
 11907*                                                                *
 11908*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11909*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11910*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11911*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11912*                                                                *
 11913******************************************************************
 11914
 11915     IF PB-EXT-DAYS-PROCESSING
 11916          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11917                                         PB-I-LF-EXPIRE-DT
 11918                                         PB-I-AH-EXPIRE-DT
 11919          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11920          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11921          MOVE +1                     TO DC-ELAPSED-MONTHS
 11922          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11923          SET BIN-PLUS-ELAPSED        TO TRUE
 11924*         MOVE 6                      TO DC-OPTION-CODE
 11925          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11926          IF NO-CONVERSION-ERROR
 11927             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11928
 11929******************************************************************
 11930*                                                                *
 11931*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11932*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11933*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11934*        (EXPIRE DATE - (TERM -1))  *  -1.
 11935*                                                                *
 11936******************************************************************
 11937
 11938     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 218
* EL050.cbl
 11939        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11940           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11941              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11942              MOVE PB-I-AH-TERM      TO WS-TERM
 11943           ELSE
 11944              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11945              MOVE PB-I-LF-TERM      TO WS-TERM
 11946        ELSE
 11947           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11948              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11949              MOVE PB-I-LF-TERM      TO WS-TERM
 11950           ELSE
 11951              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11952              MOVE PB-I-AH-TERM      TO WS-TERM.
 11953
 11954     IF PB-EXPIRE-DT-PROCESSING
 11955        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11956        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11957        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11958        MOVE ZERO                TO DC-ELAPSED-DAYS
 11959                                    DC-ODD-DAYS-OVER
 11960          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11961          SET BIN-PLUS-ELAPSED    TO TRUE
 11962*         MOVE 6                  TO DC-OPTION-CODE
 11963          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11964          IF NO-CONVERSION-ERROR
 11965             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11966
 11967******************************************************************
 11968*                                                                *
 11969*            1ST PAYMENT DATE PROCESSING                         *
 11970*                                                                *
 11971******************************************************************
 11972
 11973     IF PB-1ST-PMT-DT-PROCESSING
 11974        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11975                                    PB-I-AH-EXPIRE-DT
 11976        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11977
 11978     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11979         NEXT SENTENCE
 11980     ELSE
 11981         MOVE ER-2680                 TO WS-ERROR
 11982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11983         GO TO 3060-ORIG-TERM-CHECK.
 11984
 11985     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11986     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11987     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11988*    MOVE 1                      TO DC-OPTION-CODE.
 11989     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11990                                    DC-ELAPSED-DAYS
 11991                                    DC-ODD-DAYS-OVER.
 11992
 11993     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11994
 11995     IF DATE-CONVERSION-ERROR
 11996        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 219
* EL050.cbl
 11997
 11998     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11999     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12000        AND (WS-LF-COVERAGE-TYPE = 'L')
 12001        IF (DC-ELAPSED-MONTHS > 1)
 12002                      OR
 12003           ((DC-ELAPSED-MONTHS = 1)
 12004           AND (DC-ODD-DAYS-OVER > 0))
 12005           MOVE ER-2882          TO WS-ERROR
 12006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12007        END-IF
 12008     END-IF
 12009     if dc-elapsed-months > 0
 12010        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12011        + dc-odd-days-over
 12012     end-if
 12013     IF PB-EXT-DAYS-PROCESSING
 12014        CONTINUE
 12015     ELSE
 12016        IF DC-ELAPSED-MONTHS = +0
 12017           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12018        ELSE
 12019           IF (WS-LF-EARNINGS-CALC = '4')
 12020              AND (DC-ELAPSED-MONTHS > ZERO)
 12021              AND (DC-ELAPSED-DAYS > ZERO)
 12022              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12023           ELSE
 12024              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12025                                 THRU 6499-EXIT
 12026              MOVE WS-ODD-DAYS-OVER
 12027                                 TO PB-I-EXTENTION-DAYS
 12028           END-IF
 12029        END-IF
 12030     END-IF
 12031******************************************************************
 12032*                                                                *
 12033*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12034*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12035*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12036*            AND ANY ODD DAYS.                                   *
 12037*                                                                *
 12038******************************************************************
 12039
 12040     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12041                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12042     IF WS-LF-EARNINGS-CALC NOT = '4'
 12043        IF DC-ELAPSED-DAYS > ZEROS
 12044           MOVE ER-2681          TO WS-ERROR
 12045           PERFORM 9900-ERROR-FORMAT
 12046                                 THRU 9900-EXIT
 12047        END-IF
 12048     END-IF
 12049
 12050     IF WS-LF-EARNINGS-CALC NOT = '4'
 12051        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12052           MOVE ER-2681          TO WS-ERROR
 12053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12054
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 220
* EL050.cbl
 12055     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12056        (PB-I-LF-TERM NOT = ZERO) AND
 12057         NOT NO-LIFE-COVERAGE
 12058          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12059          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12060          IF WS-LF-EARNINGS-CALC = '4'
 12061             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12062             PB-I-PAY-FREQUENCY
 12063          END-IF
 12064          MOVE ZERO              TO DC-ELAPSED-DAYS
 12065                                    DC-ODD-DAYS-OVER
 12066          MOVE 1                 TO DC-END-OF-MONTH
 12067          SET BIN-PLUS-ELAPSED        TO TRUE
 12068*         MOVE 6                 TO DC-OPTION-CODE
 12069          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12070          IF NO-CONVERSION-ERROR
 12071             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12072             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12073                (WS-LF-SPECIAL-CALC-CD = 'L')
 12074                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12075                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12076                  MOVE +1             TO DC-ELAPSED-MONTHS
 12077                  SET BIN-PLUS-ELAPSED  TO TRUE
 12078*                 MOVE 6              TO DC-OPTION-CODE
 12079                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12080                  IF NO-CONVERSION-ERROR
 12081                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12082
 12083* okay, i had to move the new att age edit down here because the
 12084* expiration date could get recalculated and i need the exp date
 12085     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12086        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12087        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12088        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12089           AND ZEROS
 12090           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12091           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12092           SET ELAPSED-BETWEEN-BIN TO TRUE
 12093           PERFORM 8500-DATE-CONVERT
 12094                                 THRU 8500-EXIT
 12095           IF NO-CONVERSION-ERROR
 12096              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12097                 MOVE ER-2669       TO WS-ERROR
 12098*                PERFORM 9900-ERROR-FORMAT
 12099*                                THRU 9900-EXIT
 12100              END-IF
 12101           END-IF
 12102        ELSE
 12103           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12104           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12105              MOVE ER-2669       TO WS-ERROR
 12106*             PERFORM 9900-ERROR-FORMAT
 12107*                                THRU 9900-EXIT
 12108           ELSE
 12109              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12110                 MOVE ER-1570    TO WS-ERROR
 12111                 PERFORM 9900-ERROR-FORMAT
 12112                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 221
* EL050.cbl
 12113              END-IF
 12114           END-IF
 12115        END-IF
 12116        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12117           AND ZEROS
 12118           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12119           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12120           SET ELAPSED-BETWEEN-BIN TO TRUE
 12121           PERFORM 8500-DATE-CONVERT
 12122                                 THRU 8500-EXIT
 12123           IF NO-CONVERSION-ERROR
 12124              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12125                 MOVE ER-2669       TO WS-ERROR
 12126*                PERFORM 9900-ERROR-FORMAT
 12127*                                THRU 9900-EXIT
 12128              END-IF
 12129           END-IF
 12130        ELSE
 12131           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12132             (PB-I-LF-TERM / 12)
 12133           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12134              MOVE ER-2669       TO WS-ERROR
 12135*             PERFORM 9900-ERROR-FORMAT
 12136*                                THRU 9900-EXIT
 12137           ELSE
 12138              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12139                 MOVE ER-1571    TO WS-ERROR
 12140                 PERFORM 9900-ERROR-FORMAT
 12141                                 THRU 9900-EXIT
 12142              END-IF
 12143           END-IF
 12144        END-IF
 12145        IF WS-ERROR = ER-2669
 12146           PERFORM 9900-ERROR-FORMAT
 12147                                 THRU 9900-EXIT
 12148        END-IF
 12149     END-IF
 12150     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12151        (PB-I-AH-TERM NOT = ZERO) AND
 12152         NOT NO-AH-COVERAGE
 12153          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12154             AND (PB-COMPANY-ID = 'DCC')
 12155             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12156             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12157          ELSE
 12158             IF WS-LF-EARNINGS-CALC = '4'
 12159                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12160                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12161                PB-I-PAY-FREQUENCY
 12162             ELSE
 12163                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12164                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12165             END-IF
 12166          END-IF
 12167          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12168                                         DC-ODD-DAYS-OVER
 12169          MOVE 1                      TO DC-END-OF-MONTH
 12170          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 222
* EL050.cbl
 12171*         MOVE 6                      TO DC-OPTION-CODE
 12172          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12173          IF NO-CONVERSION-ERROR
 12174             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12175     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12176        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12177        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12178        IF PB-I-BIRTHDAY > LOW-VALUES
 12179           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12180           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12181           SET ELAPSED-BETWEEN-BIN TO TRUE
 12182           PERFORM 8500-DATE-CONVERT
 12183                                 THRU 8500-EXIT
 12184           IF NO-CONVERSION-ERROR
 12185              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12186                 MOVE ER-3054       TO WS-ERROR
 12187*                PERFORM 9900-ERROR-FORMAT
 12188*                                THRU 9900-EXIT
 12189              END-IF
 12190           END-IF
 12191        ELSE
 12192           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12193           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12194              MOVE ER-3054       TO WS-ERROR
 12195*             PERFORM 9900-ERROR-FORMAT
 12196*                                THRU 9900-EXIT
 12197           END-IF
 12198        END-IF
 12199        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12200           AND ZEROS
 12201           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12202           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12203           SET ELAPSED-BETWEEN-BIN TO TRUE
 12204           PERFORM 8500-DATE-CONVERT
 12205                                 THRU 8500-EXIT
 12206           IF NO-CONVERSION-ERROR
 12207              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12208                 MOVE ER-3054       TO WS-ERROR
 12209*                PERFORM 9900-ERROR-FORMAT
 12210*                                THRU 9900-EXIT
 12211              END-IF
 12212           END-IF
 12213        ELSE
 12214           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12215             (PB-I-AH-TERM / 12)
 12216           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12217              MOVE ER-3054       TO WS-ERROR
 12218*             PERFORM 9900-ERROR-FORMAT
 12219*                                THRU 9900-EXIT
 12220           END-IF
 12221        END-IF
 12222        IF WS-ERROR = ER-3054
 12223           PERFORM 9900-ERROR-FORMAT
 12224                                 THRU 9900-EXIT
 12225        END-IF
 12226     END-IF
 12227     MOVE SPACE                       TO DC-END-OF-MONTH.
 12228
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 223
* EL050.cbl
 12229     IF PB-COMPANY-ID = 'NCB'
 12230        GO TO 3040-EDIT-EXTENSION-DAYS.
 12231
 12232     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12233       AND
 12234        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12235        NEXT SENTENCE
 12236     ELSE
 12237        GO TO 3040-EDIT-EXTENSION-DAYS.
 12238
 12239     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12240        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12241        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12242     ELSE
 12243        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12244        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12245
 12246     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12247*    MOVE '1'      TO DC-OPTION-CODE
 12248     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12249     IF (NO-CONVERSION-ERROR)
 12250        AND (DC-ELAPSED-MONTHS > +1)
 12251        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12252        MOVE ER-2668   TO WS-ERROR
 12253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12254
 12255 3040-EDIT-EXTENSION-DAYS.
 12256
 12257     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12258        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12259         GO TO 3050-EDIT-TERM-IN-DAYS
 12260     ELSE
 12261         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12262
 12263     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12264         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12265     ELSE
 12266        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12267           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12268           MOVE ER-2681         TO WS-ERROR
 12269           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12270
 12271     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12272        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12273        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12274         GO TO 3060-ORIG-TERM-CHECK.
 12275
 12276     GO TO 3060-ORIG-TERM-CHECK.
 12277
 12278 3050-EDIT-TERM-IN-DAYS.
 12279
 12280     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12281
 12282     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12283         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12284     ELSE
 12285         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12286            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 224
* EL050.cbl
 12287            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12288
 12289     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12290                                       REMAINDER WS-WORK-TERM.
 12291     IF WS-WORK-TERM GREATER THAN ZERO
 12292         ADD +1 TO PB-I-LF-TERM.
 12293
 12294     IF NOT NO-AH-COVERAGE
 12295         MOVE ER-2684            TO WS-ERROR
 12296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12297
 12298
 12299 3060-ORIG-TERM-CHECK.
 12300
 12301******************************************************************
 12302*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12303******************************************************************
 12304
 12305     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12306        NEXT SENTENCE
 12307     ELSE
 12308        IF NOT NO-LIFE-COVERAGE
 12309           IF PB-I-LF-TERM NUMERIC
 12310              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12311              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12312              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12313                  NEXT SENTENCE
 12314           ELSE
 12315              MOVE ER-2647       TO WS-ERROR
 12316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12317
 12318     IF NOT NO-AH-COVERAGE
 12319         IF PB-I-AH-TERM NUMERIC
 12320            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12321            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12322            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12323             NEXT SENTENCE
 12324          ELSE
 12325              MOVE ER-2658       TO WS-ERROR
 12326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12327
 12328     IF PB-COMPANY-ID = 'NCB'
 12329        GO TO 3070-LOAN-TERM-CHECK.
 12330
 12331     IF POLICY-HAS-AH
 12332       AND
 12333        POLICY-HAS-LIFE
 12334       AND
 12335        PB-I-LF-TERM NUMERIC
 12336       AND
 12337        PB-I-AH-TERM NUMERIC
 12338        NEXT SENTENCE
 12339     ELSE
 12340        GO TO 3070-LOAN-TERM-CHECK.
 12341
 12342     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12343     IF WS-TEX-FACT-2 LESS THAN +0
 12344        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 225
* EL050.cbl
 12345
 12346     IF WS-TEX-FACT-2 GREATER THAN +1
 12347        MOVE ER-2668             TO WS-ERROR
 12348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12349
 12350 3070-LOAN-TERM-CHECK.
 12351
 12352     IF (WS-LF-BENEFIT-CD = ZERO)
 12353         OR (NO-LF-BENEFIT-MATCH)
 12354            GO TO 3125-EDIT-PMT-FREQ.
 12355*    IF PB-COMPANY-ID NOT = 'DCC'
 12356*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12357*          AND 'V' AND 'W' AND 'X'
 12358*          GO TO 3125-EDIT-PMT-FREQ
 12359*       END-IF
 12360*    ELSE
 12361*       IF WS-AH-DCC-TRUNC = 'T'
 12362*          CONTINUE
 12363*       ELSE
 12364*          GO TO 3125-EDIT-PMT-FREQ
 12365*       END-IF
 12366*    END-IF
 12367     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12368                    OR
 12369        ((PB-COMPANY-ID = 'DCC')
 12370        AND (WS-AH-DCC-TRUNC = 'T'))
 12371        CONTINUE
 12372     ELSE
 12373        GO TO 3125-EDIT-PMT-FREQ
 12374     END-IF
 12375     IF PB-I-LOAN-TERM NOT NUMERIC
 12376         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12377
 12378     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12379        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12380*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12381        PB-I-LOAN-TERM NOT GREATER THAN +360
 12382         NEXT SENTENCE
 12383     ELSE
 12384         MOVE ER-2648            TO WS-ERROR
 12385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12386
 12387     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12388        MOVE ER-3058             TO WS-ERROR
 12389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12390     end-if
 12391
 12392     IF WS-STATE-ABBREVIATION = 'NC'
 12393        IF PB-I-LOAN-TERM > +59
 12394           CONTINUE
 12395        ELSE
 12396           MOVE ER-2792          TO WS-ERROR
 12397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12398        END-IF
 12399     END-IF
 12400
 12401     .
 12402 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 226
* EL050.cbl
 12403     IF (WS-LF-BENEFIT-CD = ZERO)
 12404         OR (NO-LF-BENEFIT-MATCH)
 12405            GO TO 3127-EDIT-LOAN-OFFICER.
 12406     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12407                    OR
 12408        ((PB-COMPANY-ID = 'DCC')
 12409        AND (WS-AH-DCC-TRUNC = 'T'))
 12410                    OR
 12411         (PB-COMPANY-ID = 'AHL')
 12412        CONTINUE
 12413     ELSE
 12414        IF (PB-I-LOAN-TERM > ZEROS)
 12415           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12416           MOVE ER-1575          TO WS-ERROR
 12417           PERFORM 9900-ERROR-FORMAT
 12418                                 THRU 9900-EXIT
 12419        END-IF
 12420     END-IF
 12421     IF WS-LF-EARNINGS-CALC NOT = '4'
 12422         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12423            MOVE ER-2653         TO WS-ERROR
 12424            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12425            GO TO 3127-EDIT-LOAN-OFFICER
 12426         ELSE
 12427            GO TO 3127-EDIT-LOAN-OFFICER.
 12428
 12429     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12430         MOVE ER-2655            TO WS-ERROR
 12431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12432         GO TO 3127-EDIT-LOAN-OFFICER.
 12433
 12434     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12435         MOVE ER-2654            TO WS-ERROR
 12436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12437         GO TO 3127-EDIT-LOAN-OFFICER.
 12438
 12439     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12440         GIVING WS-TEX-FACT-2
 12441             REMAINDER WS-TEX-FACT-3.
 12442
 12443*    IF WS-TEX-FACT-3 NOT = ZERO
 12444*       MOVE ER-2654             TO WS-ERROR
 12445*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12446
 12447
 12448 3127-EDIT-LOAN-OFFICER.
 12449
 12450     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12451        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12452           MOVE ER-2690          TO WS-ERROR
 12453           PERFORM 9900-ERROR-FORMAT
 12454                                 THRU 9900-EXIT
 12455        ELSE
 12456           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12457           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12458           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12459           MOVE PB-SV-STATE      TO LOFC-STATE
 12460           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 227
* EL050.cbl
 12461           MOVE PB-I-LOAN-OFFICER
 12462                                 TO LOFC-CODE
 12463           PERFORM 8586-READ-LOAN-OFFICER
 12464                                 THRU 8586-EXIT
 12465           IF (NOT LOFC-MASTER-FOUND)
 12466              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12467              MOVE ER-3006       TO WS-ERROR
 12468              PERFORM 9900-ERROR-FORMAT
 12469                                 THRU 9900-EXIT
 12470           END-IF
 12471        END-IF
 12472     END-IF
 12473     .
 12474 3129-EDIT-APR.
 12475
 12476     IF (WS-LF-BENEFIT-CD = ZERO)
 12477        OR (NO-LF-BENEFIT-MATCH)
 12478        IF PB-COMPANY-ID NOT = 'DCC'
 12479           GO TO 3130-EDIT-AGE
 12480*       ELSE
 12481*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12482*             GO TO 3130-EDIT-AGE
 12483*          END-IF
 12484        END-IF
 12485     END-IF
 12486
 12487     IF (WS-STATE-ABBREVIATION = 'OH')
 12488         AND (PB-I-RATE-CLASS NOT = 'L ')
 12489         AND (PB-I-LF-TERM GREATER THAN 60)
 12490         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12491         GO TO 3129-APR-CONT.
 12492
 12493     IF (WS-STATE-ABBREVIATION = 'RI')
 12494         AND (PB-I-LF-TERM GREATER THAN 60)
 12495         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12496         GO TO 3129-APR-CONT.
 12497
 12498     IF (WS-STATE-ABBREVIATION = 'UT')
 12499         AND (PB-I-LF-TERM GREATER THAN 62)
 12500         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12501         AND (PB-CERT-EFF-DT LESS WS-830901)
 12502         GO TO 3129-APR-CONT.
 12503
 12504     IF PB-COMPANY-ID = 'LAP'
 12505        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12506           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12507              MOVE ER-2656         TO WS-ERROR
 12508              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12509              GO TO 3130-EDIT-AGE.
 12510
 12511     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12512        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12513        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12514        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12515        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12516        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12517         GO TO 3130-EDIT-AGE.
 12518
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 228
* EL050.cbl
 12519 3129-APR-CONT.
 12520     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12521         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12522         GO TO 3130-EDIT-AGE.
 12523
 12524     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12525         WS-AH-BENEFIT-CD (1:1) = 'S')
 12526        AND (PB-COMPANY-ID = 'DCC')
 12527        AND (PB-I-LOAN-APR = ZERO)
 12528        MOVE ER-2657             TO WS-ERROR
 12529        PERFORM 9900-ERROR-FORMAT
 12530                                 THRU 9900-EXIT
 12531        GO TO 3130-EDIT-AGE
 12532     END-IF
 12533*    IF PB-I-LOAN-APR = ZERO
 12534*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12535*    END-IF
 12536
 12537     if pb-i-loan-apr = +99.9999
 12538        move er-2656             to ws-error
 12539        PERFORM 9900-ERROR-FORMAT
 12540                                 THRU 9900-EXIT
 12541        GO TO 3130-EDIT-AGE
 12542     end-if
 12543*    IF PB-I-LOAN-APR = ZERO
 12544*       MOVE ER-2656             TO WS-ERROR
 12545*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12546*       GO TO 3130-EDIT-AGE.
 12547
 12548*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12549     if pb-i-loan-apr not = +99.9999
 12550        IF PB-I-LOAN-APR > +30.000
 12551           MOVE ER-2657          TO WS-ERROR
 12552           PERFORM 9900-ERROR-FORMAT
 12553                                 THRU 9900-EXIT
 12554        end-if
 12555     end-if
 12556     .
 12557 3130-EDIT-AGE.
 12558
 12559******************************************************************
 12560*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12561******************************************************************
 12562
 12563     IF NOT NO-LIFE-COVERAGE
 12564        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12565           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12566               MOVE ER-2628             TO WS-ERROR
 12567               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12568
 12569     IF NOT NO-AH-COVERAGE
 12570        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12571           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12572               MOVE ER-2628         TO WS-ERROR
 12573               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12574
 12575 3133-SEX-CODE.
 12576     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 229
* EL050.cbl
 12577         IF WS-DEFAULT-SEX = 'M'
 12578             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12579          ELSE
 12580             IF WS-DEFAULT-SEX = 'F'
 12581             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12582
 12583     IF PB-I-INSURED-SEX = '1'
 12584         MOVE 'M' TO PB-I-INSURED-SEX.
 12585
 12586     IF PB-I-INSURED-SEX = '2'
 12587         MOVE 'F' TO PB-I-INSURED-SEX.
 12588
 12589 3134-SIG-SW-EDIT.
 12590     IF PB-I-SIG-SW = SPACE
 12591         MOVE 'N'                TO  PB-I-SIG-SW.
 12592
 12593     IF PB-COMPANY-ID = 'NCL'
 12594         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12595             NEXT SENTENCE
 12596         ELSE
 12597             MOVE ER-1923        TO  WS-ERROR
 12598             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12599     ELSE
 12600     IF PB-COMPANY-ID = 'CRI'
 12601         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12602             NEXT SENTENCE
 12603         ELSE
 12604             MOVE ER-2606        TO  WS-ERROR
 12605             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12606     ELSE
 12607     IF PB-COMPANY-ID = 'TMS'
 12608         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12609             NEXT SENTENCE
 12610         ELSE
 12611             MOVE ER-2689        TO  WS-ERROR
 12612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12613     ELSE
 12614         IF PB-I-SIG-SW = 'Y' OR 'N'
 12615             NEXT SENTENCE
 12616         ELSE
 12617             MOVE ER-2651        TO  WS-ERROR
 12618             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12619
 12620     IF PB-COMPANY-ID = 'FLA'
 12621         IF (WS-EDIT-AGE GREATER 54  OR
 12622             WS-AH-EDIT-AGE GREATER 54)  AND
 12623            PB-I-SIG-SW = 'N'
 12624            MOVE ER-2651         TO  WS-ERROR
 12625            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12626
 12627 3135-NAME-EDIT.
 12628
 12629     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12630        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12631        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12632           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12633                                 TO PB-I-JOINT-FIRST-NAME
 12634        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 230
* EL050.cbl
 12635     END-IF
 12636     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12637        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12638        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12639           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12640                                 TO PB-I-JOINT-LAST-NAME
 12641        END-PERFORM
 12642     END-IF
 12643     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12644        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12645        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12646           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12647                                 TO PB-I-INSURED-FIRST-NAME
 12648        END-PERFORM
 12649     END-IF
 12650     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12651        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12652        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12653           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12654                                 TO PB-I-INSURED-LAST-NAME
 12655        END-PERFORM
 12656     END-IF
 12657     IF PB-I-INSURED-LAST-NAME = SPACES
 12658       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12659       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12660           MOVE ER-2660    TO WS-ERROR
 12661           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12662
 12663 3136-EDIT-SEX.
 12664
 12665******************************************************************
 12666*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12667******************************************************************
 12668
 12669     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12670        (WS-AH-SPECIAL-CALC-CD = 'O')
 12671        NEXT SENTENCE
 12672     ELSE
 12673        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12674           NEXT SENTENCE
 12675        ELSE
 12676           MOVE ER-2629            TO WS-ERROR
 12677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12678
 12679 3137-EDIT-EFF-DATE.
 12680
 12681     IF PB-REISSUED-CERT       OR
 12682        PB-POLICY-IS-DECLINED  OR
 12683        PB-POLICY-IS-VOIDED
 12684         GO TO 3139-EDIT-COVERAGE-CODES.
 12685
 12686     MOVE SPACE                  TO WS-2671-SW
 12687                                    WS-2672-SW.
 12688
 12689     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12690         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12691             MOVE ER-2703        TO WS-ERROR
 12692             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 231
* EL050.cbl
 12693             GO TO 3139-EDIT-COVERAGE-CODES.
 12694
 12695     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12696         GO TO 3139-EDIT-COVERAGE-CODES.
 12697
 12698     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12699     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12700*    MOVE '1'                    TO DC-OPTION-CODE.
 12701     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12702     MOVE +0                     TO DC-ELAPSED-MONTHS
 12703                                    DC-ELAPSED-DAYS.
 12704     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12705
 12706     IF DATE-CONVERSION-ERROR
 12707         GO TO 3139-EDIT-COVERAGE-CODES.
 12708
 12709     IF DC-ELAPSED-DAYS GREATER +180
 12710         MOVE ER-2672            TO WS-ERROR
 12711         MOVE 'Y'                TO WS-2672-SW
 12712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12713     END-IF
 12714
 12715     IF WS-ERROR = ER-2671  AND
 12716        PB-COMPANY-ID  = 'LBL'
 12717        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12718        MOVE SPACE               TO WS-2671-SW
 12719        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12720
 12721     IF PB-ISSUE-DATE-FORCED  AND
 12722      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12723         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12724         MOVE ER-2673            TO WS-ERROR
 12725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12726         MOVE SPACE              TO WS-2671-SW
 12727                                    WS-2672-SW.
 12728
 12729     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12730         IF PB-ISSUE-DATE-FORCED
 12731             MOVE ER-2600          TO  WS-ERROR
 12732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12733         ELSE
 12734             MOVE ER-2692          TO  WS-ERROR
 12735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12736
 12737
 12738 3139-EDIT-COVERAGE-CODES.
 12739
 12740     if pb-company-id not = 'AHL'
 12741        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12742           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12743           MOVE ER-2787          TO WS-ERROR
 12744           PERFORM 9900-ERROR-FORMAT
 12745                                 THRU 9900-EXIT
 12746        END-IF
 12747     end-if
 12748     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12749        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12750                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 232
* EL050.cbl
 12751           MOVE ER-2719          TO WS-ERROR
 12752           PERFORM 9900-ERROR-FORMAT
 12753                                 THRU 9900-EXIT
 12754        END-IF
 12755     END-IF
 12756
 12757     IF PB-POLICY-IS-DECLINED  OR
 12758        PB-POLICY-IS-VOIDED
 12759         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12760
 12761     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12762        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12763         MOVE ER-2630                TO WS-ERROR
 12764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12765
 12766     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12767        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12768        PB-I-LF-PREMIUM-AMT = ZERO
 12769         GO TO 3140-CHECK-AH-FOR-ZERO.
 12770
 12771     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12772        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12773        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12774         GO TO 3140-CHECK-AH-FOR-ZERO.
 12775
 12776     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12777        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12778        MOVE ER-2631             TO WS-ERROR
 12779        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12780     END-IF
 12781
 12782
 12783******************************************************************
 12784*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12785******************************************************************
 12786
 12787     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12788        NEXT SENTENCE
 12789     ELSE
 12790        IF PB-I-LF-BENEFIT-AMT = ZERO
 12791           MOVE ER-2632             TO WS-ERROR
 12792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12793
 12794
 12795******************************************************************
 12796*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12797******************************************************************
 12798
 12799     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12800        CONTINUE
 12801     ELSE
 12802        IF PB-I-LF-PREMIUM-AMT = ZERO
 12803           IF (NOT PB-COMP-LF-PREM)
 12804              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12805              MOVE ER-2633       TO WS-ERROR
 12806              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12807           END-IF
 12808        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 233
* EL050.cbl
 12809     END-IF
 12810     .
 12811 3140-CHECK-AH-FOR-ZERO.
 12812
 12813     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12814        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12815        PB-I-AH-PREMIUM-AMT = ZERO
 12816         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12817
 12818     IF PB-COMPANY-ID = 'CSL'  AND
 12819        PB-I-AH-BENEFIT-CD = ZERO  AND
 12820        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12821        PB-I-AH-PREMIUM-AMT = ZERO
 12822         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12823
 12824     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12825        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12826        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12827         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12828
 12829     IF PB-I-AH-BENEFIT-CD = ZERO
 12830         MOVE ER-2634            TO WS-ERROR
 12831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12832
 12833******************************************************************
 12834*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12835******************************************************************
 12836
 12837     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12838        NEXT SENTENCE
 12839     ELSE
 12840        IF PB-I-AH-BENEFIT-AMT = ZERO
 12841           MOVE ER-2635             TO WS-ERROR
 12842           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12843
 12844******************************************************************
 12845*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12846******************************************************************
 12847
 12848     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12849        NEXT SENTENCE
 12850     ELSE
 12851        IF PB-I-AH-PREMIUM-AMT = ZERO
 12852            IF NOT PB-COMP-AH-PREM
 12853                MOVE ER-2636    TO WS-ERROR
 12854                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12855
 12856
 12857 3140-EDIT-MAX-AMT-SIZES.
 12858* CUSTOM CODE FOR CLIENT    'DMD'
 12859     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12860                                     WS-RES-MUNI-TAX
 12861                                     PB-I-STATE-TAX
 12862                                     PB-I-MUNI-TAX.
 12863
 12864     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12865
 12866     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 234
* EL050.cbl
 12867        GO TO 3150-RATE-OUTSTAND-BAL.
 12868
 12869     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12870        GO TO 3150-RATE-OUTSTAND-BAL.
 12871
 12872     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12873        GO TO 3150-RATE-OUTSTAND-BAL.
 12874
 12875     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12876                             OR 'RIC')
 12877        GO TO 3150-RATE-OUTSTAND-BAL.
 12878
 12879     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12880        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12881            GO TO 3150-RATE-OUTSTAND-BAL
 12882        ELSE
 12883           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12884               GO TO 3150-RATE-OUTSTAND-BAL.
 12885
 12886     IF NOT PB-NO-MONTHS-SKIPPED
 12887        GO TO 3150-RATE-OUTSTAND-BAL.
 12888
 12889     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12890        GO TO 3150-RATE-OUTSTAND-BAL.
 12891
 12892     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12893        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12894           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12895             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12896           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12897           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12898              MOVE ER-2693     TO WS-ERROR
 12899              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12900              GO TO 3150-RATE-OUTSTAND-BAL
 12901           ELSE
 12902              GO TO 3150-RATE-OUTSTAND-BAL.
 12903
 12904 3150-RATE-OUTSTAND-BAL.
 12905
 12906* DMD RATING TEST
 12907     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12908         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12909         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12910         MOVE ER-2687                 TO WS-ERROR
 12911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12912         MOVE 'B'                     TO PB-I-OB-FLAG
 12913         GO TO 3260-EDIT-CONTINUE.
 12914
 12915     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12916         IF  WS-ERROR    EQUAL    ER-2693
 12917             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12918                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12919                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12920                 MOVE  +0            TO  WS-ERROR.
 12921
 12922     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12923         IF  WS-ERROR    EQUAL    ER-2693
 12924             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 235
* EL050.cbl
 12925                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12926                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12927                 MOVE  +0            TO  WS-ERROR.
 12928
 12929     IF PLAN-MASTER-AH-SW = 'Y'
 12930        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12931            IF  WS-ERROR    EQUAL    ER-2693
 12932              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12933                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12934                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12935                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12936                 MOVE  ER-1910           TO  WS-ERROR
 12937                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12938
 12939     IF PLAN-MASTER-AH-SW = 'Y'
 12940        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12941            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12942               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12943               MOVE  ER-1910           TO  WS-ERROR
 12944               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12945
 12946     IF PLAN-MASTER-AH-SW = 'Y'
 12947        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12948            IF  WS-ERROR    EQUAL    ER-2693
 12949                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12950                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12951                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12952                 MOVE  +0       TO  WS-ERROR.
 12953
 12954     IF WS-ERROR = ER-2693
 12955        IF PB-COMPANY-ID = 'JAL' AND
 12956           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12957           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12958           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12959
 12960     IF WS-ERROR = ER-2693
 12961        IF PB-COMPANY-ID = 'NCL'  AND
 12962           PB-I-AH-BENEFIT-CD = 'OA'
 12963           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12964           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12965
 12966     IF WS-ERROR = ER-2693
 12967        IF PB-COMPANY-ID = 'CNL' AND
 12968           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12969           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12970           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12971
 12972     IF WS-ERROR = ER-2693
 12973        IF PB-COMPANY-ID = 'HER'
 12974           IF WS-LEVEL
 12975              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12976              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12977
 12978     IF ((LF-BENEFIT-FOUND) AND
 12979         (NOT NO-LIFE-COVERAGE)  AND
 12980         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12981       OR   ((AH-BENEFIT-FOUND) AND
 12982             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 236
* EL050.cbl
 12983             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12984         NEXT SENTENCE
 12985     ELSE
 12986         GO TO 3215-EDIT-RATES.
 12987
 12988     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12989        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12990           MOVE ER-2674          TO WS-ERROR
 12991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12992           GO TO 3215-EDIT-RATES.
 12993
 12994     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12995        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12996           MOVE ER-2674          TO WS-ERROR
 12997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12998           GO TO 3215-EDIT-RATES.
 12999
 13000     MOVE 'B'                    TO PB-I-OB-FLAG.
 13001
 13002     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13003         NEXT SENTENCE
 13004     ELSE
 13005         IF NOT NO-LIFE-COVERAGE
 13006             IF WS-ACCT-LF-OB-RT = ZERO
 13007                MOVE ER-2641    TO WS-ERROR
 13008                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13009
 13010     IF PB-COMPANY-ID = 'CRI'
 13011       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13012         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13013         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13014         IF WS-ERROR = ER-2675
 13015            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13016            MOVE ER-2687              TO WS-ERROR
 13017            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13018         ELSE
 13019            MOVE ER-2687              TO WS-ERROR
 13020            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13021
 13022
 13023     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13024         NEXT SENTENCE
 13025     ELSE
 13026       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13027            NEXT SENTENCE
 13028       ELSE
 13029         IF NOT NO-AH-COVERAGE
 13030             IF WS-ACCT-AH-OB-RT = ZERO
 13031                MOVE ER-2642    TO WS-ERROR
 13032                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13033
 13034     IF PB-COMPANY-ID = 'CRI'
 13035       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13036         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13037         IF WS-ERROR = ER-2676
 13038            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13039            MOVE ER-2687              TO WS-ERROR
 13040            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 237
* EL050.cbl
 13041         ELSE
 13042            MOVE ER-2687              TO WS-ERROR
 13043            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13044
 13045     IF PB-COMPANY-ID NOT = 'GIC'
 13046         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13047            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13048     ELSE
 13049         IF PB-I-LF-PREM-CALC = ZEROS
 13050             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13051                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13052
 13053     IF PB-COMPANY-ID NOT = 'GIC'
 13054         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13055            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13056     ELSE
 13057         IF PB-I-AH-PREM-CALC = ZEROS
 13058             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13059                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13060
 13061     MOVE ZEROS TO PB-I-MORT-CODE.
 13062
 13063     GO TO 3260-EDIT-CONTINUE.
 13064
 13065
 13066 3215-EDIT-RATES.
 13067     IF ACCOUNT-MAST-FOUND
 13068         NEXT SENTENCE
 13069     ELSE
 13070         GO TO 3999-END-EDIT.
 13071
 13072 3220-CHECK-LF-RATES.
 13073
 13074     IF PB-COMPANY-ID = 'DCC'
 13075        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13076        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13077        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13078           AND (NOT WS-LF-CASH))
 13079                           OR
 13080           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13081           AND (NOT WS-AH-CASH)))
 13082                       AND
 13083           (PB-I-ENTRY-STATUS NOT = '5')
 13084           MOVE 'M'              TO PB-BATCH-ENTRY
 13085                                    PB-I-ENTRY-STATUS
 13086        END-IF
 13087     END-IF
 13088     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13089                                    PB-I-AH-PREM-CALC
 13090                                    PB-I-LF-ALT-PREM-CALC
 13091                                    PB-I-LF-ALT-RATE
 13092                                    PB-I-LF-REI-RATE
 13093                                    PB-I-LF-ALT-REI-RATE
 13094                                    PB-I-AH-REI-RATE
 13095                                    PB-I-TOT-FEES-CALC.
 13096
 13097     IF PB-COMPANY-ID EQUAL 'DMD'
 13098        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 238
* EL050.cbl
 13099     ELSE
 13100        MOVE ZEROS               TO PB-I-LF-RATE
 13101                                    PB-I-AH-RATE.
 13102
 13103     IF PB-I-TOT-FEES NOT NUMERIC
 13104        MOVE ZEROS               TO PB-I-TOT-FEES
 13105     END-IF
 13106     IF PB-I-LIVES NOT NUMERIC
 13107         MOVE ZERO               TO PB-I-LIVES.
 13108
 13109     IF PB-I-NUM-BILLED NOT NUMERIC
 13110         MOVE ZERO               TO PB-I-NUM-BILLED.
 13111
 13112     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13113        MOVE +0                  TO PB-I-LF-PREM-TAX
 13114     END-IF
 13115
 13116     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13117        MOVE +0                  TO PB-I-AH-PREM-TAX
 13118     END-IF
 13119
 13120     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13121        PB-I-PAY-FREQUENCY = ZEROS
 13122            MOVE 12 TO CP-PAY-FREQUENCY
 13123     ELSE
 13124            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13125
 13126     IF PB-I-STATE-TAX NOT NUMERIC
 13127         MOVE ZEROS               TO PB-I-STATE-TAX.
 13128
 13129     IF PB-I-MUNI-TAX NOT NUMERIC
 13130         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13131
 13132     MOVE SPACES                 TO CP-BEN-CATEGORY
 13133     IF PB-COMPANY-ID  = 'CSL'  AND
 13134        PB-I-LF-TERM NOT = ZERO
 13135        COMPUTE WS-PAYMENT-AMT =
 13136             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13137        COMPUTE WS-CSL-AMT1 =
 13138             PB-I-LF-TERM * AM-MAX-MON-BEN
 13139        COMPUTE WS-CSL-AMT2 =
 13140             WS-PAYMENT-AMT * PB-I-LF-TERM
 13141        IF CP-PAY-FREQUENCY NOT = 12
 13142           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13143           MOVE '8' TO WS-CSL-CALC-CD
 13144        ELSE
 13145           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13146              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13147               AM-MAX-TOT-BEN
 13148               MOVE '6' TO WS-CSL-CALC-CD
 13149           ELSE
 13150              IF (WS-CSL-AMT1  GREATER THAN
 13151                 AM-MAX-TOT-BEN) AND
 13152                 (WS-CSL-AMT2  GREATER THAN
 13153                 AM-MAX-TOT-BEN)
 13154                 MOVE '7' TO WS-CSL-CALC-CD
 13155              ELSE
 13156                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 239
* EL050.cbl
 13157
 13158     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13159         NEXT SENTENCE
 13160     ELSE
 13161         GO TO 3300-CHECK-AH-RATES.
 13162
 13163*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13164
 13165     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13166        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13167              OR
 13168           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13169           MOVE ER-2618          TO WS-ERROR
 13170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13171           GO TO 3300-CHECK-AH-RATES.
 13172
 13173     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13174           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13175                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13176
 13177     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13178         MOVE ER-2687             TO WS-ERROR
 13179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180         MOVE 'Z000'              TO PB-I-MORT-CODE
 13181         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13182         GO TO 3300-CHECK-AH-RATES.
 13183
 13184     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13185        IF PB-I-LIVES = ZERO
 13186           MOVE ER-2688          TO WS-ERROR
 13187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13188
 13189     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13190
 13191     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13192     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13193     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13194     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13195     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13196     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13197     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13198     MOVE '3'                    TO CP-PROCESS-TYPE.
 13199     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13200     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13201
 13202******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13203     IF PB-COMPANY-ID EQUAL 'CDL'
 13204         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13205            CP-EARN-AS-NET-PAY)
 13206             IF PB-CERT-EFF-DT GREATER  WS-931231
 13207                 MOVE '1'        TO CP-EARNING-METHOD.
 13208*******
 13209
 13210     MOVE PB-SV-STATE            TO CP-STATE.
 13211     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13212     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13213     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13214     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 240
* EL050.cbl
 13215     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13216                                    CP-RATING-BENEFIT-AMT.
 13217     IF CP-STATE-STD-ABBRV = 'OR'
 13218         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13219                                         PB-I-LF-ALT-BENEFIT-AMT.
 13220     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13221     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13222     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13223     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13224     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13225     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13226     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13227     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13228     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13229                                    CP-REMAINING-TERM
 13230                                    CP-LOAN-TERM.
 13231
 13232     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13233         NEXT SENTENCE
 13234     ELSE
 13235         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13236             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13237                                           PB-I-LF-PREMIUM-AMT.
 13238
 13239     IF PB-COMPANY-ID EQUAL 'CSL'
 13240        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13241           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13242                                         PB-I-LF-PREMIUM-AMT.
 13243
 13244     IF PB-COMPANY-ID EQUAL 'NCB'
 13245         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13246            CP-EARN-AS-NET-PAY
 13247             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13248                 PB-I-LF-PREMIUM-AMT.
 13249
 13250     IF (CP-TRUNCATED-LIFE)
 13251        or ((pb-company-id = 'AHL')
 13252           and (pb-i-loan-term > pb-i-lf-term))
 13253        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13254
 13255     IF PB-COMPANY-ID EQUAL 'CRI'
 13256        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13257
 13258     IF CP-TERM-IS-DAYS
 13259         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13260     ELSE
 13261         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13262     IF PB-COMPANY-ID = 'DCC'
 13263        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13264        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13265        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13266        IF WS-LF-BEN-CATEGORY = 'D'
 13267           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13268           MOVE PB-I-LIFE-COMMISSION
 13269                                 TO CP-DCC-ACT-COMM
 13270           MOVE WS-LF-BEN-CATEGORY
 13271                                 TO CP-BEN-CATEGORY
 13272        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 241
* EL050.cbl
 13273        IF (CP-BENEFIT-CD (1:1) = 'P')
 13274           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13275           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13276           add pb-i-ah-premium-amt to cp-original-premium
 13277        END-IF
 13278     END-IF
 13279     IF PB-COMPANY-ID = 'CSL'
 13280         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13281         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13282         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13283
 13284     IF PB-COMPANY-ID = 'CSL'
 13285        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13286
 13287     IF (CP-SPECIAL-CALC-CD = 'H')
 13288        OR (PB-COMPANY-ID = 'DCC')
 13289         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13290                                    TO CP-ALTERNATE-BENEFIT
 13291         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13292
 13293     IF (PB-COMPANY-ID = 'CID')
 13294        AND (WS-LF-EARNINGS-CALC = 'B')
 13295        AND (CP-STATE-STD-ABBRV = 'MN')
 13296        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13297                                 TO CP-ALTERNATE-BENEFIT
 13298        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13299     END-IF
 13300     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13301     MOVE 'R'                   TO CP-RATE-FILE.
 13302     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13303
 13304     IF CP-ERROR-RATE-NOT-FOUND
 13305        MOVE ER-2641            TO WS-ERROR
 13306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13307        GO TO 3300-CHECK-AH-RATES.
 13308
 13309     IF PB-COMPANY-ID EQUAL 'CRI'
 13310        IF CP-ERROR-NO-LIMITS-CRI
 13311           IF NOT ACCOUNT-LIFE-CHECKED
 13312              MOVE ER-2607      TO WS-ERROR
 13313              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13314
 13315******************************************************************
 13316*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13317*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13318******************************************************************
 13319
 13320* CALC LIFE AGE AT EXPIRATION.
 13321
 13322     COMPUTE WS-AGE-AT-EXPIRE =
 13323          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13324
 13325*    IF PB-STATE = 'CO' OR 'UT'
 13326*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13327*        MOVE 'F'            TO PB-FATAL-FLAG
 13328*        MOVE ER-2709        TO WS-ERROR
 13329*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13330*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 242
* EL050.cbl
 13331
 13332*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13333*        MOVE 'X'            TO PB-FATAL-FLAG
 13334*        MOVE ER-2718        TO WS-ERROR
 13335*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13336*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13337
 13338* CALC A & H AGE AT EXPIRATION.
 13339
 13340     COMPUTE WS-AGE-AT-EXPIRE =
 13341          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13342
 13343*    IF PB-STATE = 'CO' OR 'UT'
 13344*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13345*        MOVE 'F'            TO PB-FATAL-FLAG
 13346*        MOVE ER-2709        TO WS-ERROR
 13347*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13348*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13349
 13350*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13351*        MOVE 'X'            TO PB-FATAL-FLAG
 13352*        MOVE ER-2718        TO WS-ERROR
 13353*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13355
 13356     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13357        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13358
 13359     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13360        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13361     end-if
 13362
 13363     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13364        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13365
 13366     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13367         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13368         MOVE ER-2639        TO WS-ERROR
 13369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13370
 13371
 13372******************************************************************
 13373*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13374******************************************************************
 13375
 13376 PREMIUM-EDITING-IS-BYPASSED.
 13377     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13378        AND (CP-R-MAX-ATT-AGE > +0)
 13379        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13380        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13381           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13382           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13383           MOVE '1'              TO DC-OPTION-CODE
 13384           PERFORM 8500-DATE-CONVERT
 13385                                 THRU 8500-EXIT
 13386           IF NO-CONVERSION-ERROR
 13387              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13388                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 243
* EL050.cbl
 13389*                PERFORM 9900-ERROR-FORMAT
 13390*                                THRU 9900-EXIT
 13391              END-IF
 13392           END-IF
 13393        ELSE
 13394           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13395           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13396              MOVE ER-2661       TO WS-ERROR
 13397*             PERFORM 9900-ERROR-FORMAT
 13398*                                THRU 9900-EXIT
 13399           ELSE
 13400              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13401                 MOVE ER-1570    TO WS-ERROR
 13402                 PERFORM 9900-ERROR-FORMAT
 13403                                 THRU 9900-EXIT
 13404              END-IF
 13405           END-IF
 13406        END-IF
 13407        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13408           MOVE PB-I-JOINT-BIRTHDAY
 13409                                 TO DC-BIN-DATE-1
 13410           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13411           MOVE '1'              TO DC-OPTION-CODE
 13412           PERFORM 8500-DATE-CONVERT
 13413                                 THRU 8500-EXIT
 13414           IF NO-CONVERSION-ERROR
 13415              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13416                 MOVE ER-2661       TO WS-ERROR
 13417*                PERFORM 9900-ERROR-FORMAT
 13418*                                THRU 9900-EXIT
 13419              END-IF
 13420           ELSE
 13421              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13422           END-IF
 13423        ELSE
 13424           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13425             (PB-I-LF-TERM / 12)
 13426           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13427              MOVE ER-2661       TO WS-ERROR
 13428*             PERFORM 9900-ERROR-FORMAT
 13429*                                THRU 9900-EXIT
 13430           ELSE
 13431              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13432                 MOVE ER-1571    TO WS-ERROR
 13433                 PERFORM 9900-ERROR-FORMAT
 13434                                 THRU 9900-EXIT
 13435              END-IF
 13436           END-IF
 13437        END-IF
 13438        IF WS-ERROR = ER-2661
 13439           PERFORM 9900-ERROR-FORMAT
 13440                                 THRU 9900-EXIT
 13441        END-IF
 13442     END-IF
 13443*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13444*       MOVE ER-2661             TO WS-ERROR
 13445*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13446
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 244
* EL050.cbl
 13447     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13448        MOVE ER-2662             TO WS-ERROR
 13449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13450
 13451     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13452        MOVE ER-2677             TO WS-ERROR
 13453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13454
 13455     IF CP-ERROR-LOAN-TERM
 13456        MOVE ER-2648             TO WS-ERROR
 13457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13458
 13459 3221-CHECK-ERROR-RATE-OPEN.
 13460
 13461     IF CP-ERROR-RATE-FILE-NOTOPEN
 13462         GO TO 3990-FILES-NOT-OPEN.
 13463
 13464     IF PB-COMPANY-ID NOT = 'DMD'
 13465        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13466     END-IF
 13467     .
 13468 3221-CONTINUE.
 13469     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13470                                    WS-DCC-AH-RATE
 13471     IF PB-COMPANY-ID = 'DCC'
 13472        IF WS-LF-BEN-CATEGORY = 'D'
 13473           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13474              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13475        END-IF
 13476     END-IF
 13477     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13478*   X'A4FF' = 12/31/2009
 13479     IF (PB-COMPANY-ID = 'CID')
 13480        AND (WS-LF-EARNINGS-CALC = 'B')
 13481        AND (CP-STATE-STD-ABBRV = 'MN')
 13482        AND (PB-CERT-EFF-DT > X'A4FF')
 13483        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13484     END-IF
 13485     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13486
 13487     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13488     IF (PB-COMPANY-ID = 'DCC')
 13489        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13490        AND (PB-I-POLICY-IS-MONTHLY)
 13491        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13492        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13493     END-IF
 13494     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13495     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13496     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13497     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13498     IF (PB-COMPANY-ID = 'DCC')
 13499        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13500        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13501        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13502        MOVE ER-2786             TO WS-ERROR
 13503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13504     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 245
* EL050.cbl
 13505
 13506     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13507
 13508******************************************************************
 13509*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13510******************************************************************
 13511     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13512        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13513
 13514     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13515        GO TO 3225-CHECK-ALT-LIFE-RATE
 13516     ELSE
 13517       IF PB-I-LF-RATE = ZERO
 13518          MOVE ER-2641          TO WS-ERROR
 13519          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13520
 13521 3225-CHECK-ALT-LIFE-RATE.
 13522
 13523     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13524        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13525        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13526         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13527
 13528     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13529         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13530             AND PB-COMPANY-ID NOT = 'DCC')
 13531                   OR
 13532              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13533              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13534              AND PB-COMPANY-ID NOT = 'DCC')
 13535             MOVE ER-2720        TO  WS-ERROR
 13536             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13537             GO TO 3225-RATING-CONT
 13538         ELSE
 13539             GO TO 3225-RATING-CONT.
 13540     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13541        AND (AM-GPCD = 01 OR 06 OR 15)
 13542        MOVE ER-2798             TO WS-ERROR
 13543        PERFORM 9900-ERROR-FORMAT
 13544                                 THRU 9900-EXIT
 13545*       GO TO 3225-RATING-CONT
 13546     END-IF
 13547     IF (PB-COMPANY-ID = 'CID')
 13548        AND (WS-LF-EARNINGS-CALC = 'B')
 13549        AND (CP-STATE-STD-ABBRV = 'MN')
 13550        AND (PB-CERT-EFF-DT > X'A4FF')
 13551        GO TO 3225-RATING-CONT
 13552     END-IF
 13553     IF PB-COMPANY-ID = 'DCC'
 13554        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13555           AND (PB-I-POLICY-IS-MONTHLY)
 13556           GO TO 3225-RATING-CONT
 13557        END-IF
 13558     END-IF
 13559
 13560     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13561        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13562        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 246
* EL050.cbl
 13563        NEXT SENTENCE
 13564     ELSE
 13565        MOVE '2'                 TO CP-EARNING-METHOD.
 13566
 13567 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13568
 13569     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13570
 13571     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13572        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13573        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13574         NEXT SENTENCE
 13575     ELSE
 13576         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13577
 13578     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13579     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13580     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13581                                     CP-RATING-BENEFIT-AMT.
 13582     IF CP-STATE-STD-ABBRV = 'OR'
 13583         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13584                                         PB-I-LF-ALT-BENEFIT-AMT.
 13585     IF PB-COMPANY-ID = 'DCC'
 13586        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13587     END-IF
 13588     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13589     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13590     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13591                                    CP-REMAINING-TERM
 13592                                    CP-LOAN-TERM.
 13593     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13594        ADD +1                   TO CP-ORIGINAL-TERM
 13595                                    CP-REMAINING-TERM
 13596                                    CP-LOAN-TERM.
 13597
 13598     MOVE 'R'                   TO CP-RATE-FILE.
 13599     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13600
 13601     IF CP-ERROR-RATE-NOT-FOUND
 13602         MOVE ER-2641            TO WS-ERROR
 13603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13604         GO TO 3300-CHECK-AH-RATES.
 13605
 13606     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13607     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13608
 13609     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13610         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13611
 13612     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13613                               + PB-I-LF-ALT-BENEFIT-AMT.
 13614
 13615     IF ACCOUNT-LIFE-CHECKED  OR
 13616        PB-POLICY-IS-VOIDED   OR
 13617        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13618        GO TO 3225-CONTINUE.
 13619
 13620     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 247
* EL050.cbl
 13621        GO TO 3225-CONTINUE.
 13622
 13623     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13624                             EC-RT-LF-MAX-TOT-BEN
 13625        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13626        MOVE ER-2639       TO WS-ERROR
 13627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628
 13629 3225-CONTINUE.
 13630     IF PB-I-LF-ALT-RATE = ZERO
 13631         MOVE ER-2659            TO WS-ERROR
 13632         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13633
 13634     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13635        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13636        MOVE ER-2698             TO WS-ERROR
 13637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13638
 13639 3225-RATING-CONT.
 13640
 13641     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13642         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13643         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13644         IF (PB-COMPANY-ID = 'DCC')
 13645            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13646            CONTINUE
 13647         ELSE
 13648            MOVE ER-2687         TO WS-ERROR
 13649            PERFORM 9900-ERROR-FORMAT
 13650                                 THRU 9900-EXIT
 13651         END-IF
 13652         GO TO 3290-EDIT-LF-REIN-RATE
 13653     END-IF
 13654
 13655* DMD RATING TEST
 13656     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13657         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13658         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13659         MOVE ER-2687                 TO WS-ERROR
 13660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13661         GO TO 3290-EDIT-LF-REIN-RATE.
 13662
 13663 3230-CLIENT-MORT-CD-SPECIALS.
 13664
 13665     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13666     SET BIN-TO-GREG          TO TRUE.
 13667*    MOVE ' '                 TO DC-OPTION-CODE.
 13668     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13669     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13670
 13671 C-POS-3230-MORT-CD.
 13672     IF PB-COMPANY-ID = 'POS' AND
 13673        PB-SV-CARRIER = '2'
 13674         NEXT SENTENCE
 13675     ELSE
 13676         GO TO C-POS-3240-MORT-CD.
 13677
 13678     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 248
* EL050.cbl
 13679        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13680         MOVE '2350' TO PB-I-MORT-CODE
 13681      ELSE
 13682         MOVE '3300' TO PB-I-MORT-CODE.
 13683
 13684
 13685 C-POS-3240-MORT-CD.
 13686     IF PB-COMPANY-ID = 'POS' AND
 13687        PB-SV-CARRIER = '1'
 13688         NEXT SENTENCE
 13689     ELSE
 13690         GO TO 3230-CONTINUE.
 13691
 13692     IF PB-SV-STATE = '45' OR '47'
 13693        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13694         MOVE '5200' TO PB-I-MORT-CODE
 13695     ELSE
 13696         MOVE '8300' TO PB-I-MORT-CODE.
 13697
 13698 3230-CONTINUE.
 13699
 13700     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13701        GO TO 3240-CONTINUE
 13702     END-IF
 13703
 13704     IF PB-CERT-EFF-DT > WS-971231
 13705        GO TO 3240-CONTINUE
 13706     END-IF
 13707
 13708     IF LF-BENEFIT-FOUND AND
 13709        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13710         MOVE 'F250'       TO PB-I-MORT-CODE
 13711     ELSE
 13712         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13713             MOVE '7250'   TO PB-I-MORT-CODE
 13714         ELSE
 13715             MOVE '4251'   TO PB-I-MORT-CODE
 13716         END-IF
 13717     END-IF
 13718
 13719     .
 13720 3240-CONTINUE.
 13721
 13722     IF PB-COMPANY-ID NOT = 'GNL'
 13723         GO TO 3256-CONTINUE.
 13724
 13725     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13726         MOVE 'A300' TO PB-I-MORT-CODE
 13727     ELSE
 13728         MOVE '8350' TO PB-I-MORT-CODE.
 13729
 13730 3256-CONTINUE.
 13731     IF PB-COMPANY-ID NOT = 'ABL'
 13732         GO TO 3260-EDIT-CONTINUE.
 13733
 13734     IF PB-I-LF-TERM GREATER THAN 59
 13735         MOVE 'F550' TO PB-I-MORT-CODE
 13736     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 249
* EL050.cbl
 13737         MOVE 'E550' TO PB-I-MORT-CODE.
 13738
 13739 3260-EDIT-CONTINUE.
 13740     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13741
 13742 3290-EDIT-LF-REIN-RATE.
 13743     IF LF-REIN-NSP-NOT-USED
 13744         GO TO 3290-RATING-CONT.
 13745
 13746     IF PB-COMPANY-ID = 'DCC'
 13747        GO TO 3290-RATING-CONT.
 13748     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13749     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13750     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13751     MOVE '3'                   TO CP-PROCESS-TYPE.
 13752     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13753
 13754******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13755     IF PB-COMPANY-ID EQUAL 'CDL'
 13756         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13757            CP-EARN-AS-NET-PAY)
 13758             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13759*            MOVE SPACE          TO DC-OPTION-CODE
 13760             SET BIN-TO-GREG     TO TRUE
 13761             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13762***  Y2K PROJ 7744
 13763             IF DC-GREG-DATE-CYMD GREATER 19931231
 13764                 MOVE '1'        TO CP-EARNING-METHOD.
 13765***  Y2K PROJ 7744
 13766*******
 13767
 13768     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13769     MOVE PB-SV-STATE           TO CP-STATE.
 13770     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13771     MOVE ZERO                  TO CP-DEVIATION-CODE
 13772                                   CP-RATE-DEV-PCT.
 13773     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13774     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13775                                   CP-RATING-BENEFIT-AMT.
 13776
 13777************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13778     IF PB-COMPANY-ID EQUAL 'NCB'
 13779         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13780            CP-EARN-AS-NET-PAY
 13781             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13782                 PB-I-LF-PREMIUM-AMT.
 13783************
 13784
 13785     IF CP-STATE-STD-ABBRV = 'OR'
 13786         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13787                                         PB-I-LF-ALT-BENEFIT-AMT.
 13788     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13789     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13790     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13791     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13792     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13793     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13794     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 250
* EL050.cbl
 13795     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13796                                   CP-REMAINING-TERM
 13797                                   CP-LOAN-TERM.
 13798     IF CP-TRUNCATED-LIFE
 13799        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13800
 13801     IF CP-TERM-IS-DAYS
 13802         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13803     ELSE
 13804         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13805
 13806     IF PB-COMPANY-ID = 'DCC'
 13807        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13808     END-IF
 13809     IF PB-COMPANY-ID NOT = 'TIC'
 13810          MOVE ZERO          TO CP-CLASS-CODE.
 13811
 13812     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13813
 13814     MOVE 'R'                   TO CP-RATE-FILE.
 13815     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13816
 13817     IF CP-ERROR-RATE-NOT-FOUND
 13818        IF PB-I-OB
 13819           MOVE ER-2625      TO WS-ERROR
 13820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13821           GO TO 3299-EDIT-CONTINUE
 13822        ELSE
 13823           MOVE ER-2643      TO WS-ERROR
 13824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13825           GO TO 3299-EDIT-CONTINUE.
 13826
 13827     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13828
 13829     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13830     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13831
 13832     IF PB-I-LF-REI-RATE = ZERO
 13833         MOVE ER-2643        TO WS-ERROR
 13834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13835
 13836 3290-CHECK-ALT-REIN-RATE.
 13837
 13838     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13839        GO TO 3290-RATING-CONT.
 13840
 13841     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13842     MOVE '2'                    TO CP-EARNING-METHOD.
 13843     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13844     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13845     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13846     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13847                                     CP-RATING-BENEFIT-AMT.
 13848     IF CP-STATE-STD-ABBRV = 'OR'
 13849         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13850                                         PB-I-LF-ALT-BENEFIT-AMT.
 13851     IF PB-COMPANY-ID = 'DCC'
 13852        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 251
* EL050.cbl
 13853     END-IF
 13854     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13855     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13856     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13857                                    CP-REMAINING-TERM
 13858                                    CP-LOAN-TERM.
 13859     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13860        ADD +1                   TO CP-ORIGINAL-TERM
 13861                                    CP-REMAINING-TERM
 13862                                    CP-LOAN-TERM.
 13863
 13864     MOVE 'R'                   TO CP-RATE-FILE.
 13865     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13866
 13867     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13868
 13869     IF PB-I-LF-ALT-REI-RATE = ZERO
 13870         MOVE ER-2643            TO WS-ERROR
 13871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13872
 13873 3290-RATING-CONT.
 13874
 13875     IF PB-I-OB
 13876*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13877        GO TO 3300-CHECK-AH-RATES.
 13878
 13879 3299-EDIT-CONTINUE.
 13880
 13881     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13882         NEXT SENTENCE
 13883     ELSE
 13884         MOVE ER-2620           TO WS-ERROR
 13885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13886
 13887 3300-CHECK-AH-RATES.
 13888     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13889         NEXT SENTENCE
 13890     ELSE
 13891         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13892
 13893     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13894        ((CF-COMPANY-ID = 'DMD') AND
 13895                (NO-DMD-RATING))
 13896         IF (PB-COMPANY-ID = 'DCC')
 13897            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13898            CONTINUE
 13899         ELSE
 13900            MOVE ER-2687         TO WS-ERROR
 13901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13902         END-IF
 13903         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13904         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13905     END-IF
 13906
 13907     IF PB-I-OB
 13908        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13909
 13910     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 252
* EL050.cbl
 13911         MOVE ER-2687             TO WS-ERROR
 13912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13913         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13914         GO TO 3999-END-EDIT.
 13915
 13916*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13917     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13918        IF PB-I-AH-CRIT-PER = ZERO
 13919           IF PB-COMPANY-ID = 'DCC'
 13920              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13921              CONTINUE
 13922           ELSE
 13923              MOVE ER-2618       TO WS-ERROR
 13924              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13925              GO TO 3999-END-EDIT
 13926           END-IF
 13927        END-IF
 13928     END-IF
 13929     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13930     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13931     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13932     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13933     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13934     MOVE PB-SV-STATE            TO CP-STATE.
 13935     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13936     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13937     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13938*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13939     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13940     MOVE '3'                    TO CP-PROCESS-TYPE.
 13941     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13942     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13943                                    CP-RATING-BENEFIT-AMT.
 13944     IF PB-COMPANY-ID = 'CID'
 13945               OR
 13946        CP-STATE-STD-ABBRV = 'OR'
 13947         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13948                                         PB-I-AH-TERM.
 13949     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13950        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13951           AND (PB-I-POLICY-IS-MONTHLY)
 13952           MOVE PB-I-LF-BENEFIT-AMT
 13953                                 TO CP-NET-BENEFIT-AMT
 13954           move pb-i-ah-premium-amt to cp-original-premium
 13955           add pb-i-lf-premium-amt to cp-original-premium
 13956        END-IF
 13957     END-IF
 13958     MOVE SPACES                 TO CP-BEN-CATEGORY
 13959     IF PB-COMPANY-ID = 'DCC'
 13960        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13961        EVALUATE TRUE
 13962           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13963              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13964              MOVE PB-I-LF-BENEFIT-AMT
 13965                                 TO CP-RATING-BENEFIT-AMT
 13966              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13967           WHEN WS-AH-BEN-CATEGORY = 'G'
 13968              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 253
* EL050.cbl
 13969                                 TO CP-RATING-BENEFIT-AMT
 13970           WHEN WS-AH-BEN-CATEGORY = 'D'
 13971              MOVE WS-AH-PMF-COMM
 13972                                 TO CP-DCC-PMF-COMM
 13973              MOVE PB-I-AH-COMMISSION
 13974                                 TO CP-DCC-ACT-COMM
 13975        END-EVALUATE
 13976     END-IF
 13977     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13978     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13979     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13980     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13981     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13982     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13983     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13984                                    CP-REMAINING-TERM
 13985                                    WS-WORK-TERM.
 13986     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13987
 13988     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13989     SET BIN-TO-GREG             TO TRUE.
 13990*    MOVE ' '                    TO DC-OPTION-CODE.
 13991     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13992     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13993
 13994     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13995     IF NOT VALID-SKIP-CODE
 13996         MOVE ER-2683            TO WS-ERROR
 13997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998         GO TO 3320-RATE-CONTINUE.
 13999
 14000     IF PB-NO-MONTHS-SKIPPED
 14001         GO TO 3320-RATE-CONTINUE.
 14002
 14003     MOVE SPACE TO NUMBER-OF-MONTHS.
 14004
 14005     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14006         MOVE 'S'                TO SK-MO (6).
 14007     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14008         MOVE 'S'                TO SK-MO (7).
 14009     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14010         MOVE 'S'                TO SK-MO (8).
 14011     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14012         MOVE 'S'                TO SK-MO (9).
 14013     IF PB-I-SKIP-CODE = 'A'
 14014         MOVE 'S'                TO SK-MO (10).
 14015
 14016     MOVE 1                      TO SUB2.
 14017     MOVE PB-I-AH-TERM           TO SUB3.
 14018     MOVE WS-MONTH               TO SUB1.
 14019     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14020     GO TO 3320-RATE-CONTINUE.
 14021
 14022 3310-GET-SKIP-MO.
 14023     IF SUB1 = 13
 14024         MOVE 1                  TO SUB1.
 14025
 14026     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 254
* EL050.cbl
 14027         SUBTRACT 1 FROM WS-WORK-TERM.
 14028
 14029     ADD 1 TO SUB2
 14030              SUB1.
 14031
 14032 3320-RATE-CONTINUE.
 14033
 14034     IF WS-WORK-TERM = ZERO
 14035         MOVE 1                  TO WS-WORK-TERM.
 14036
 14037     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14038                                    CP-LOAN-TERM.
 14039
 14040     IF PB-COMPANY-ID EQUAL 'DMD'
 14041         NEXT SENTENCE
 14042     ELSE
 14043         MOVE ZERO               TO PB-I-AH-RATE
 14044                                    PB-I-AH-REI-RATE.
 14045
 14046
 14047     IF PB-COMPANY-ID EQUAL 'CRI'
 14048        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14049
 14050     IF PB-COMPANY-ID = 'CSL'
 14051         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14052         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14053         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14054         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14055
 14056     IF PB-COMPANY-ID = 'DCC'
 14057        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14058           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14059              PB-I-RATE-DEV-PCT-LF
 14060        END-IF
 14061        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14062                                 TO CP-ALTERNATE-BENEFIT
 14063        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14064        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14065        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14066     END-IF
 14067     IF (PB-COMPANY-ID = 'CID')
 14068        AND (WS-LF-EARNINGS-CALC = 'B')
 14069        AND (CP-STATE-STD-ABBRV = 'MN')
 14070        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14071     ELSE
 14072        MOVE ' '                 TO CP-AH-BALLOON-SW
 14073     END-IF
 14074     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14075     MOVE 'R'                   TO CP-RATE-FILE.
 14076     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14077
 14078     IF CP-ERROR-RATE-NOT-FOUND
 14079        IF PB-I-OB
 14080           MOVE ER-2624          TO WS-ERROR
 14081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14082           GO TO 3340-CALCULATE-PREMIUM-AMT
 14083        ELSE
 14084          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 255
* EL050.cbl
 14085              NEXT SENTENCE
 14086          ELSE
 14087           MOVE ER-2642          TO WS-ERROR
 14088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14089           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14090
 14091     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14092        CP-ERROR-DIV-BY-ZERO
 14093           MOVE ER-3782          TO WS-ERROR
 14094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14095
 14096     IF PB-COMPANY-ID EQUAL 'CRI'
 14097        IF CP-ERROR-NO-LIMITS-CRI
 14098           IF NOT ACCOUNT-AH-CHECKED
 14099              MOVE ER-2607          TO WS-ERROR
 14100              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14101
 14102     IF ACCOUNT-AH-CHECKED
 14103        NEXT SENTENCE
 14104     ELSE
 14105       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14106          MOVE ER-2640           TO WS-ERROR
 14107          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14108
 14109     IF PB-COMPANY-ID = 'CRI'
 14110         IF WS-ERROR = ER-2640
 14111             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14112     IF ACCOUNT-AH-CHECKED
 14113        CONTINUE
 14114     ELSE
 14115        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14116           AND (CP-R-MAX-ATT-AGE > +0)
 14117           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14118           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14119              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14120              MOVE PB-I-AH-EXPIRE-DT
 14121                                 TO DC-BIN-DATE-2
 14122              MOVE '1'           TO DC-OPTION-CODE
 14123              PERFORM 8500-DATE-CONVERT
 14124                                 THRU 8500-EXIT
 14125              IF NO-CONVERSION-ERROR
 14126                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14127                    MOVE ER-2661       TO WS-ERROR
 14128*                   PERFORM 9900-ERROR-FORMAT
 14129*                                THRU 9900-EXIT
 14130                 END-IF
 14131              END-IF
 14132           ELSE
 14133              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14134              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14135                 MOVE ER-2661    TO WS-ERROR
 14136*                PERFORM 9900-ERROR-FORMAT
 14137*                                THRU 9900-EXIT
 14138              ELSE
 14139                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14140                    MOVE ER-1570 TO WS-ERROR
 14141                    PERFORM 9900-ERROR-FORMAT
 14142                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 256
* EL050.cbl
 14143                 END-IF
 14144              END-IF
 14145           END-IF
 14146           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14147              MOVE PB-I-JOINT-BIRTHDAY
 14148                                    TO DC-BIN-DATE-1
 14149              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14150              MOVE '1'              TO DC-OPTION-CODE
 14151              PERFORM 8500-DATE-CONVERT
 14152                                    THRU 8500-EXIT
 14153              IF NO-CONVERSION-ERROR
 14154                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14155                    MOVE ER-2661       TO WS-ERROR
 14156*                   PERFORM 9900-ERROR-FORMAT
 14157*                                   THRU 9900-EXIT
 14158                 END-IF
 14159              END-IF
 14160           ELSE
 14161              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14162                (PB-I-AH-TERM / 12)
 14163              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14164                 MOVE ER-2661       TO WS-ERROR
 14165*                PERFORM 9900-ERROR-FORMAT
 14166*                                   THRU 9900-EXIT
 14167              ELSE
 14168                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14169                    MOVE ER-1571 TO WS-ERROR
 14170                    PERFORM 9900-ERROR-FORMAT
 14171                                 THRU 9900-EXIT
 14172                 END-IF
 14173              END-IF
 14174           END-IF
 14175           IF WS-ERROR = ER-2661
 14176              PERFORM 9900-ERROR-FORMAT
 14177                                    THRU 9900-EXIT
 14178           END-IF
 14179        END-IF
 14180     END-IF
 14181*    IF ACCOUNT-AH-CHECKED
 14182*       NEXT SENTENCE
 14183*    ELSE
 14184*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14185*          MOVE ER-2661          TO WS-ERROR
 14186*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14187
 14188     IF ACCOUNT-AH-CHECKED
 14189        NEXT SENTENCE
 14190     ELSE
 14191        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14192           MOVE ER-2663          TO WS-ERROR
 14193           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14194
 14195     IF ACCOUNT-AH-CHECKED OR
 14196        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14197         PB-POLICY-IS-VOIDED
 14198        NEXT SENTENCE
 14199     ELSE
 14200        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 257
* EL050.cbl
 14201           MOVE ER-2667            TO WS-ERROR
 14202           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14203
 14204     IF PB-COMPANY-ID = 'CRI'
 14205         IF WS-ERROR = ER-2667
 14206             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14207
 14208     IF ACCOUNT-AH-CHECKED
 14209        NEXT SENTENCE
 14210     ELSE
 14211        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14212           MOVE ER-2678            TO WS-ERROR
 14213           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14214
 14215     IF CP-ERROR-RATE-FILE-NOTOPEN
 14216         GO TO 3990-FILES-NOT-OPEN.
 14217
 14218 3321-CONTINUE.
 14219     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14220     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14221     IF (PB-COMPANY-ID = 'DCC')
 14222        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14223        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14224                                    PB-I-LF-ALT-PREM-CALC
 14225        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14226        IF WS-AH-BEN-CATEGORY = 'G'
 14227           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14228           + PB-I-ADDL-CLP)
 14229           * (1 + WS-TOL-CLP-PCT)
 14230*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14231        ELSE
 14232           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14233           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14234*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14235        END-IF
 14236        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14237                                 TO PB-I-AH-PREM-CALC
 14238        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14239           MOVE ER-8152          TO WS-ERROR
 14240           PERFORM 9900-ERROR-FORMAT
 14241                                 THRU 9900-EXIT
 14242        ELSE
 14243           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14244                 PB-I-ADDL-CLP)
 14245              MOVE ER-8148       TO WS-ERROR
 14246              PERFORM 9900-ERROR-FORMAT
 14247                                 THRU 9900-EXIT
 14248           END-IF
 14249        END-IF
 14250     END-IF
 14251     IF (PB-COMPANY-ID = 'DCC')
 14252        AND (PB-I-POLICY-IS-MONTHLY)
 14253        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14254        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14255        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14256           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14257        END-IF
 14258     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 258
* EL050.cbl
 14259     IF (PB-COMPANY-ID = 'DCC')
 14260        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14261        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14262        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14263        MOVE ER-2786             TO WS-ERROR
 14264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14265     END-IF
 14266     MOVE +0                     TO PB-I-AH-CLP
 14267     IF PB-COMPANY-ID = 'DCC'
 14268        IF WS-AH-BEN-CATEGORY = 'D'
 14269           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14270              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14271        ELSE
 14272           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14273              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14274           END-IF
 14275        END-IF
 14276     END-IF
 14277     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14278
 14279     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14280         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14281
 14282     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14283         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14284
 14285     IF PB-COMPANY-ID = 'CRI'
 14286         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14287            PB-I-PAYMENT-AMOUNT = ZERO
 14288             NEXT SENTENCE
 14289         ELSE
 14290             COMPUTE PB-I-AH-PREM-CALC =
 14291                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14292                 (CP-PREMIUM-RATE / 100)
 14293             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14294                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14295                                             PB-I-RATE-DEV-PCT-AH.
 14296
 14297     IF PB-I-AH-RATE  = ZERO
 14298       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14299           NEXT SENTENCE
 14300       ELSE
 14301         MOVE ER-2642            TO WS-ERROR
 14302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14303
 14304     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14305     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14306     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14307     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14308     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14309     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14310
 14311     IF (PB-COMPANY-ID = 'DCC')
 14312        AND (WS-AH-BEN-CATEGORY = 'G')
 14313        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14314        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14315        IF CP-DEVIATION-CODE NOT = '000'
 14316           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 259
* EL050.cbl
 14317           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14318           IF NO-CP-ERROR
 14319              COMPUTE PB-I-DDF-IU-RATE-UP =
 14320              PB-I-AH-CLP - CP-CALC-PREMIUM
 14321           ELSE
 14322              MOVE ER-3057        TO WS-ERROR
 14323              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14324           END-IF
 14325        END-IF
 14326     END-IF
 14327     .
 14328 3335-EDIT-AH-REIN-NSP-RATE.
 14329     IF AH-REIN-NSP-NOT-USED
 14330         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14331
 14332     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14333     IF PB-COMPANY-ID = 'DCC'
 14334         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14335     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14336     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14337     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14338     MOVE PB-SV-STATE            TO CP-STATE.
 14339     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14340     MOVE ZERO                   TO CP-DEVIATION-CODE
 14341                                    CP-RATE-DEV-PCT.
 14342*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14343     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14344     MOVE '3'                    TO CP-PROCESS-TYPE.
 14345     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14346     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14347                                    CP-RATING-BENEFIT-AMT.
 14348     IF CP-STATE-STD-ABBRV = 'OR'
 14349         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14350                                         PB-I-AH-TERM.
 14351     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14352     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14353     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14354     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14355     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14356     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14357                                    CP-REMAINING-TERM
 14358                                    WS-WORK-TERM.
 14359     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14360     IF PB-COMPANY-ID = 'DCC'
 14361        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14362     END-IF
 14363     IF  PB-COMPANY-ID = 'TIC'
 14364         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14365            MOVE ZERO TO CP-CLASS-CODE.
 14366
 14367     IF PB-COMPANY-ID NOT = 'TIC'
 14368          MOVE ZERO          TO CP-CLASS-CODE.
 14369
 14370     MOVE ZERO               TO CP-DEVIATION-CODE.
 14371
 14372     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14373
 14374     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 260
* EL050.cbl
 14375
 14376     MOVE 'R'                   TO CP-RATE-FILE.
 14377     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14378
 14379     IF CP-ERROR-RATE-NOT-FOUND
 14380         MOVE ER-2645        TO WS-ERROR
 14381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14382         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14383
 14384     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14385
 14386     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14387     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14388
 14389     IF PB-I-AH-REI-RATE = ZERO
 14390         MOVE ER-2645        TO WS-ERROR
 14391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14392
 14393
 14394 3340-CALCULATE-PREMIUM-AMT.
 14395
 14396     IF PB-COMPANY-ID = 'NCL'
 14397         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14398             WS-AH-SPECIAL-CALC-CD = 'O')
 14399             GO TO 3999-END-EDIT.
 14400
 14401     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14402                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14403                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14404                         OR 'AHL'
 14405         NEXT SENTENCE
 14406     ELSE
 14407         IF WS-STATE-ABBREVIATION = 'CT'
 14408             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14409                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14410                 COMPUTE PB-I-LF-PREM-CALC =
 14411                                     PB-I-LF-PREM-CALC * .90
 14412                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14413                                     PB-I-LF-ALT-PREM-CALC * .90
 14414                 COMPUTE PB-I-AH-PREM-CALC =
 14415                                     PB-I-AH-PREM-CALC * .90.
 14416
 14417     IF PB-COMP-LF-PREM
 14418        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14419        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14420
 14421     IF PB-COMP-AH-PREM
 14422        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14423
 14424 3340-CHECK-DCC-TOT-FEES.
 14425     IF (PB-COMPANY-ID = 'DCC')
 14426        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14427        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14428        AND (PB-I-POLICY-IS-MONTHLY)
 14429        CONTINUE
 14430     ELSE
 14431        GO TO 3340-EDIT-LF-AH-TOL
 14432     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 261
* EL050.cbl
 14433     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14434     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14435     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14436        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14437           PB-I-RATE-DEV-PCT-LF
 14438     END-IF
 14439     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14440        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14441           PB-I-RATE-DEV-PCT-AH
 14442     END-IF
 14443     MOVE 'N'                    TO CP-BEN-CATEGORY
 14444     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14445
 14446     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14447     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14448     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14449     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14450     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14451     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14452     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14453     MOVE '3'                    TO CP-PROCESS-TYPE.
 14454     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14455     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14456
 14457     MOVE PB-SV-STATE            TO CP-STATE.
 14458     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14459     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14460     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14461     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14462     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14463                                    CP-RATING-BENEFIT-AMT.
 14464     IF CP-STATE-STD-ABBRV = 'OR'
 14465         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14466                                         PB-I-LF-ALT-BENEFIT-AMT.
 14467     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14468     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14469     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14470     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14471     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14472     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14473     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14474     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14475     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14476                                    CP-REMAINING-TERM
 14477                                    CP-LOAN-TERM.
 14478     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14479        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14480           PB-I-LF-PREMIUM-AMT
 14481     end-if
 14482
 14483     IF CP-TRUNCATED-LIFE
 14484        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14485
 14486     IF CP-TERM-IS-DAYS
 14487         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14488     ELSE
 14489         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14490
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 262
* EL050.cbl
 14491     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14492     IF CP-SPECIAL-CALC-CD = 'H'
 14493         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14494                                    TO CP-ALTERNATE-BENEFIT
 14495         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14496     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14497     MOVE 'R'                    TO CP-RATE-FILE
 14498     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14499     IF NOT CP-ERROR-RATE-NOT-FOUND
 14500        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14501        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14502           AND (CP-BENEFIT-CD (1:1) = 'S')
 14503           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14504                                    PB-I-LF-PREMIUM-AMT
 14505        END-IF
 14506     ELSE
 14507        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14508     END-IF
 14509     .
 14510 3340-EDIT-LF-AH-TOL.
 14511
 14512***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14513***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14514***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14515***
 14516     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14517         PB-I-AH-PREMIUM-AMT
 14518          GIVING WS-CALC-WORK.
 14519
 14520     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14521        AND WS-CALC-WORK NOT = ZERO
 14522         MOVE ER-2649            TO WS-ERROR
 14523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14524
 14525     SUBTRACT PB-I-LF-PREM-CALC
 14526             FROM PB-I-LF-PREMIUM-AMT
 14527                 GIVING WS-UNSIGN-WRK1.
 14528
 14529     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14530             FROM PB-I-LF-ALT-PREMIUM-AMT
 14531                 GIVING WS-UNSIGN-WRK4.
 14532
 14533     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14534                                + WS-UNSIGN-WRK4.
 14535
 14536     SUBTRACT PB-I-AH-PREM-CALC
 14537             FROM PB-I-AH-PREMIUM-AMT
 14538                 GIVING WS-UNSIGN-WRK2.
 14539
 14540******************************************************************
 14541*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14542******************************************************************
 14543
 14544     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14545         MOVE ZERO TO WS-UNSIGN-WRK1.
 14546
 14547     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14548         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 263
* EL050.cbl
 14549
 14550     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14551             GIVING WS-UNSIGN-WRK3.
 14552
 14553 3342-CONTINUE.
 14554
 14555     IF (PB-I-LF-RATE = ZERO  AND
 14556         PB-I-AH-RATE = ZERO)
 14557         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14558            WS-AH-SPECIAL-CALC-CD = 'O'
 14559              NEXT SENTENCE
 14560         ELSE
 14561             GO TO 3345-EDIT-CONTINUE.
 14562
 14563     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14564         NEXT SENTENCE
 14565     ELSE
 14566     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14567        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14568           IF (PB-REISSUED-CERT         OR
 14569               PB-POLICY-IS-DECLINED    OR
 14570               PB-POLICY-IS-VOIDED)
 14571              NEXT SENTENCE
 14572           ELSE
 14573              IF WS-PREM-REJECT-SW = SPACE
 14574                 MOVE ER-2652    TO WS-ERROR
 14575                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14576                 GO TO 3344-CHECK-AH
 14577              ELSE
 14578                 MOVE ER-2650    TO WS-ERROR
 14579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580                 GO TO 3344-CHECK-AH.
 14581
 14582***
 14583***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14584***
 14585
 14586     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14587         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14588            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14589             (1 + WS-TOL-LF-PREM-PCT)
 14590         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14591            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14592             (1 - WS-TOL-LF-PREM-PCT)
 14593     ELSE
 14594         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14595         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14596
 14597***
 14598***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14599***
 14600
 14601     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14602         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14603          WS-TOL-LF-PREM.
 14604
 14605     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14606         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 264
* EL050.cbl
 14607          WS-TOL-LF-PREM.
 14608
 14609     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14610        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14611
 14612     IF PB-REISSUED-CERT
 14613        or PB-POLICY-IS-DECLINED
 14614        or PB-POLICY-IS-VOIDED
 14615        continue
 14616     ELSE
 14617        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14618              > WS-TOL-LF-HIGH-PREM-AMT)
 14619           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14620              < WS-TOL-LF-LOW-PREM-AMT))
 14621                      or
 14622           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14623              > WS-TOL-LF-HIGH-PREM-PCT)
 14624           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14625              < WS-TOL-LF-LOW-PREM-PCT))
 14626           IF WS-PREM-REJECT-SW = SPACE
 14627              MOVE ER-2652       TO WS-ERROR
 14628              PERFORM 9900-ERROR-FORMAT
 14629                                 THRU 9900-EXIT
 14630           ELSE
 14631              MOVE ER-2650       TO WS-ERROR
 14632              PERFORM 9900-ERROR-FORMAT
 14633                                 THRU 9900-EXIT
 14634           end-if
 14635        end-if
 14636     end-if
 14637
 14638*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14639*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14640*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14641*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14642
 14643     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14644        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14645                      OR
 14646           ((PB-COMPANY-ID = 'DCC')
 14647           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14648           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14649           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14650        END-IF
 14651     END-IF
 14652
 14653     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14654        IF WS-COMP-MAX-CAP GREATER THAN +0
 14655           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14656              IF (PB-REISSUED-CERT         OR
 14657                  PB-POLICY-IS-DECLINED    OR
 14658                  PB-POLICY-IS-VOIDED)
 14659                 NEXT SENTENCE
 14660              ELSE
 14661                  MOVE ER-2646   TO  WS-ERROR
 14662                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14663
 14664 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 265
* EL050.cbl
 14665
 14666      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14667          GO TO 3344-CHECK-AH.
 14668
 14669      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14670          GO TO 3344-CHECK-AH.
 14671
 14672      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14673                                     WS-UNSIGN-WRK6.
 14674
 14675      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14676          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14677                                 + PB-I-LF-PREMIUM-AMT
 14678                                 - PB-I-LF-PREM-CALC.
 14679
 14680      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14681          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14682                                 + PB-I-LF-ALT-PREMIUM-AMT
 14683                                 - PB-I-LF-ALT-PREM-CALC.
 14684
 14685      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14686          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14687              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14688                 MOVE ER-2652    TO  WS-ERROR
 14689                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14690              ELSE
 14691                 MOVE ER-2650    TO  WS-ERROR
 14692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14693
 14694      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14695          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14696              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14697                 MOVE ER-2652    TO  WS-ERROR
 14698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14699              ELSE
 14700                 MOVE ER-2650    TO  WS-ERROR
 14701                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14702
 14703 3344-CHECK-AH.
 14704
 14705****************************************************************
 14706***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14707***
 14708
 14709     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14710         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14711             (1 + WS-TOL-AH-PREM-PCT)
 14712         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14713             (1 - WS-TOL-AH-PREM-PCT)
 14714     ELSE
 14715         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14716         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14717
 14718***
 14719***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14720***
 14721
 14722     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 266
* EL050.cbl
 14723         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14724
 14725     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14726         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14727
 14728     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14729        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14730
 14731     IF (PB-REISSUED-CERT)
 14732        OR (PB-POLICY-IS-DECLINED)
 14733        OR (PB-POLICY-IS-VOIDED)
 14734        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14735        CONTINUE
 14736     ELSE
 14737        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14738              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14739                          or
 14740           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14741              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14742           IF WS-PREM-REJECT-SW = SPACE
 14743              MOVE ER-3052       TO WS-ERROR
 14744              PERFORM 9900-ERROR-FORMAT
 14745                                 THRU 9900-EXIT
 14746           ELSE
 14747              MOVE ER-3050       TO WS-ERROR
 14748              PERFORM 9900-ERROR-FORMAT
 14749                                 THRU 9900-EXIT
 14750           END-IF
 14751        END-IF
 14752     END-IF
 14753     if (pb-company-id = 'DCC')
 14754        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14755        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14756        and (pb-i-policy-is-monthly)
 14757        compute ws-tol-ah-high-prem-amt =
 14758           pb-i-tot-fees-calc + ws-tol-ah-prem
 14759        compute ws-tol-ah-low-prem-amt =
 14760           pb-i-tot-fees-calc - ws-tol-ah-prem
 14761        if ws-tol-ah-prem-pct > zeros
 14762           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14763              (1 + ws-tol-ah-prem-pct)
 14764           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14765              (1 - ws-tol-ah-prem-pct)
 14766        else
 14767           move +9999999.99      to ws-tol-ah-high-prem-pct
 14768           move +0               to ws-tol-ah-low-prem-pct
 14769        end-if
 14770        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14771            or
 14772           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14773                          or
 14774           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14775           or
 14776           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14777            move er-3049         to ws-error
 14778           perform 9900-error-format
 14779                                 thru 9900-exit
 14780
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 267
* EL050.cbl
 14781        end-if
 14782     end-if
 14783     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14784         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14785             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14786             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14787
 14788     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14789        IF WS-COMP-MAX-CAP GREATER THAN +0
 14790           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14791              IF (PB-REISSUED-CERT         OR
 14792                  PB-POLICY-IS-DECLINED    OR
 14793                  PB-POLICY-IS-VOIDED)
 14794                 NEXT SENTENCE
 14795              ELSE
 14796                  MOVE ER-2646   TO  WS-ERROR
 14797                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14798
 14799     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14800        (WS-COMP-MAX-CAP EQUAL +0)
 14801           GO TO 3345-EDIT-CONTINUE.
 14802
 14803     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14804        GREATER THAN WS-COMP-MAX-CAP
 14805           MOVE ER-2646          TO  WS-ERROR
 14806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14807
 14808 3345-EDIT-CONTINUE.
 14809
 14810*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14811*       IF PB-ENTRY-BATCH   NUMERIC
 14812*          IF PB-ISSUE
 14813*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14814*          ELSE
 14815*              IF PB-CANCELLATION
 14816*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14817
 14818*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14819*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14820*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14821*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14822*        ELSE
 14823*            MOVE  ER-1909            TO  WS-ERROR
 14824*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14825
 14826     IF PB-I-POLICY-ACCEPTED
 14827        IF PB-POLICY-IS-DECLINED  OR
 14828           PB-REISSUED-CERT  OR
 14829           PB-REIN-ONLY-CERT  OR
 14830           PB-POLICY-IS-VOIDED
 14831            MOVE  ER-1891         TO  WS-ERROR
 14832            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14833        ELSE
 14834            MOVE SPACE            TO  PB-BATCH-ENTRY
 14835            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14836
 14837     IF PB-I-POLICY-DECLINED
 14838        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 268
* EL050.cbl
 14839           PB-REIN-ONLY-CERT  OR
 14840           PB-POLICY-IS-VOIDED
 14841            MOVE  ER-1906         TO  WS-ERROR
 14842            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14843        ELSE
 14844            MOVE  'D'             TO  PB-BATCH-ENTRY
 14845                                      PB-I-ENTRY-STATUS.
 14846
 14847     IF PB-I-NEEDS-UNDERWRITING
 14848        IF PB-POLICY-IS-DECLINED OR
 14849           PB-REISSUED-CERT  OR
 14850           PB-REIN-ONLY-CERT  OR
 14851           PB-POLICY-IS-VOIDED
 14852            MOVE  ER-1907         TO  WS-ERROR
 14853            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14854        ELSE
 14855            MOVE 'U'              TO  PB-BATCH-ENTRY
 14856                                      PB-I-ENTRY-STATUS.
 14857
 14858     IF PB-NEEDS-UNDERWRITING
 14859        MOVE  ER-1901             TO  WS-ERROR
 14860        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14861     IF PB-COMPANY-ID = 'DCC'
 14862        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14863        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14864        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14865           AND (NOT WS-LF-CASH))
 14866                           OR
 14867           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14868           AND (NOT WS-AH-CASH)))
 14869                       AND
 14870           (PB-I-ENTRY-STATUS NOT = '5')
 14871           MOVE 'M'              TO PB-BATCH-ENTRY
 14872                                    PB-I-ENTRY-STATUS
 14873        END-IF
 14874     END-IF
 14875     IF  PB-COMPANY-ID NOT = 'NCL'
 14876         GO TO 3999-END-EDIT.
 14877
 14878     IF PB-REISSUED-CERT  OR
 14879        PB-POLICY-IS-DECLINED  OR
 14880        PB-POLICY-IS-VOIDED  OR
 14881        PB-I-OB
 14882         GO TO 3999-END-EDIT.
 14883
 14884     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14885         MOVE  ER-2644            TO  WS-ERROR
 14886         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14887         GO TO 3999-END-EDIT.
 14888
 14889     MOVE 'N'                     TO  FORM-MASTER-SW.
 14890     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14891
 14892     IF NOT FORM-MASTER-FOUND
 14893         GO TO 3999-END-EDIT.
 14894
 14895     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14896                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 269
* EL050.cbl
 14897
 14898     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14899         MOVE  +1                 TO SUB6
 14900         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14901
 14902     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14903         MOVE  +1                 TO SUB6
 14904         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14905
 14906     IF LF-FORM-MASTER-FOUND  OR
 14907        AH-FORM-MASTER-FOUND
 14908         GO TO 3360-CHECK-FORM-LIMITS
 14909     ELSE
 14910         GO TO 3999-END-EDIT.
 14911
 14912******************************************************************
 14913*                  3350-GET-ERFORM                               *
 14914*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14915*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14916******************************************************************
 14917
 14918 3350-GET-ERFORM.
 14919
 14920     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14921         GO TO  3350-ERFORM-GETMAIN.
 14922
 14923     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14924     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14925     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14926     MOVE 'Y'                     TO FORM-MASTER-SW.
 14927
 14928     IF PB-CANCELLATION
 14929         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14930            PB-SV-STATE          EQUAL   FO-STATE       AND
 14931            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14932              GO TO 3350-EXIT
 14933         ELSE
 14934             NEXT SENTENCE
 14935     ELSE
 14936         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14937            PB-SV-STATE          EQUAL   FO-STATE       AND
 14938            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14939              GO TO 3350-EXIT.
 14940
 14941 3350-ERFORM-GETMAIN.
 14942
 14943     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14944     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14945
 14946 3350-ERFORM-READ.
 14947
 14948     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14949     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14950     IF PB-CANCELLATION
 14951         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14952     ELSE
 14953         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14954     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 270
* EL050.cbl
 14955
 14956     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14957
 14958     IF FORM-MASTER-FOUND
 14959       IF PB-CANCELLATION
 14960          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14961             PB-SV-STATE          EQUAL   FO-STATE       AND
 14962             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14963              GO  TO 3350-EXIT
 14964          ELSE
 14965              NEXT SENTENCE
 14966       ELSE
 14967          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14968             PB-SV-STATE          EQUAL   FO-STATE       AND
 14969             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14970              GO  TO 3350-EXIT.
 14971
 14972     MOVE  'N'                    TO  FORM-MASTER-SW.
 14973     MOVE  ER-1895                TO  WS-ERROR.
 14974     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14975
 14976 3350-EXIT.
 14977      EXIT.
 14978
 14979******************************************************************
 14980*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14981*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14982*   VALID FOR THE POLICY FORM USED.                              *
 14983******************************************************************
 14984
 14985 3355-EDIT-FORM-LF-BENEFITS.
 14986
 14987     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14988        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14989         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14990         GO TO   3355-EXIT.
 14991
 14992     IF  SUB6    LESS THAN   +40
 14993         ADD  +1      TO  SUB6
 14994         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14995
 14996     MOVE  ER-1896         TO  WS-ERROR.
 14997     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14998
 14999 3355-EXIT.
 15000      EXIT.
 15001
 15002******************************************************************
 15003*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15004*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15005*   VALID FOR THE POLICY FORM USED.                              *
 15006******************************************************************
 15007
 15008 3356-EDIT-FORM-AH-BENEFITS.
 15009
 15010     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15011        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15012         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 271
* EL050.cbl
 15013         GO TO  3356-EXIT.
 15014
 15015      IF  SUB6    LESS THAN     +40
 15016          ADD  +1      TO  SUB6
 15017          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15018
 15019     MOVE  ER-1897         TO  WS-ERROR.
 15020     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15021
 15022 3356-EXIT.
 15023      EXIT.
 15024
 15025******************************************************************
 15026*                  3357-BENEFIT-SEARCH                           *
 15027*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15028*   CANCELLATIONS ONLY.                                          *
 15029******************************************************************
 15030 3357-BENEFIT-SEARCH.
 15031     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15032         MOVE +1                          TO SUB6
 15033         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15034
 15035     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15036         MOVE +1                          TO SUB6
 15037         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15038
 15039 3357-EXIT.
 15040     EXIT.
 15041
 15042******************************************************************
 15043*                  3358-BENEFIT-LIFE-SEARCH                      *
 15044*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15045*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15046*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15047******************************************************************
 15048 3358-BENEFIT-LIFE-SEARCH.
 15049     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15050       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15051         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15052           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15053              IF FO-PLAN-REFUND-METHOD (SUB6)
 15054                     IS GREATER THAN SPACES
 15055                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15056                                          WS-LF-REFUND-CALC
 15057                 GO TO 3358-EXIT.
 15058
 15059     IF SUB6 LESS THAN +40
 15060         ADD +1                 TO SUB6
 15061         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15062
 15063 3358-EXIT.
 15064     EXIT.
 15065******************************************************************
 15066*                  3359-BENEFIT-AH-SEARCH                        *
 15067*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15068*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15069*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15070******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 272
* EL050.cbl
 15071 3359-BENEFIT-AH-SEARCH.
 15072     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15073       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15074         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15075           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15076              IF FO-PLAN-REFUND-METHOD (SUB6)
 15077                      IS GREATER THAN SPACES
 15078                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15079                                          WS-AH-REFUND-CALC
 15080                 GO TO 3359-EXIT.
 15081
 15082     IF SUB6 LESS THAN +40
 15083         ADD +1                 TO SUB6
 15084         GO TO 3359-BENEFIT-AH-SEARCH.
 15085
 15086 3359-EXIT.
 15087     EXIT.
 15088
 15089******************************************************************
 15090*                  3360-CHECK-FORM-LIMITS                        *
 15091*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15092*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15093******************************************************************
 15094
 15095 3360-CHECK-FORM-LIMITS.
 15096
 15097     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15098         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15099
 15100     IF NOT LF-FORM-MASTER-FOUND
 15101         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15102
 15103 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15104
 15105     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15106       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15107        WS-LF-JOINT-INDICATOR = 'J'  AND
 15108        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15109         IF PB-COMPANY-ID = 'NCL'
 15110            MOVE  ER-1911          TO  WS-ERROR
 15111            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15112         ELSE
 15113            MOVE  ER-1892          TO  WS-ERROR
 15114            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15115
 15116 3360-CHECK-FORM-LF-ATT-AGE.
 15117
 15118     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15119
 15120     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15121         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15122         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15123            IF PB-COMPANY-ID = 'NCL'
 15124                MOVE  ER-1913      TO  WS-ERROR
 15125                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15126            ELSE
 15127                MOVE  ER-1894      TO  WS-ERROR
 15128                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 273
* EL050.cbl
 15129
 15130 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15131
 15132     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15133         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15134         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15135            IF PB-COMPANY-ID = 'NCL'
 15136                MOVE  ER-1914      TO  WS-ERROR
 15137                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15138            ELSE
 15139                MOVE  ER-1899      TO  WS-ERROR
 15140                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15141
 15142 3360-CHECK-FORM-LF-TERM-BAMT.
 15143
 15144     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15145         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15146         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15147           IF  PB-COMPANY-ID = 'NCL'
 15148               MOVE  ER-1916       TO  WS-ERROR
 15149               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15150           ELSE
 15151               MOVE  ER-1902       TO  WS-ERROR
 15152               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15153
 15154     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15155                                    PB-I-LF-ALT-BENEFIT-AMT.
 15156
 15157     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15158         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15159         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15160             IF  PB-COMPANY-ID = 'NCL'
 15161                 MOVE  ER-1918     TO  WS-ERROR
 15162                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15163             ELSE
 15164                 MOVE  ER-1904     TO  WS-ERROR
 15165                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15166
 15167******************************************************************
 15168*                  3360-CHECK-FORM-AH-LIMITS                     *
 15169*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15170*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15171******************************************************************
 15172
 15173 3360-CHECK-FORM-AH-LIMITS.
 15174
 15175     IF NOT AH-FORM-MASTER-FOUND
 15176         GO TO 3999-END-EDIT.
 15177
 15178 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15179
 15180     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15181       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15182        WS-AH-JOINT-INDICATOR = 'J'  AND
 15183        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15184         IF PB-COMPANY-ID = 'NCL'
 15185            MOVE  ER-1912          TO  WS-ERROR
 15186            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 274
* EL050.cbl
 15187         ELSE
 15188            MOVE  ER-1893          TO  WS-ERROR
 15189            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15190
 15191 3360-CHECK-FORM-AH-ATT-AGE.
 15192
 15193     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15194
 15195     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15196         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15197         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15198            IF PB-COMPANY-ID = 'NCL'
 15199                MOVE  ER-1913      TO  WS-ERROR
 15200                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15201            ELSE
 15202                MOVE  ER-1894      TO  WS-ERROR
 15203                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15204
 15205 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15206
 15207     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15208         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15209         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15210            IF PB-COMPANY-ID = 'NCL'
 15211                MOVE  ER-1915      TO  WS-ERROR
 15212                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15213            ELSE
 15214                MOVE  ER-1900      TO  WS-ERROR
 15215                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15216
 15217 3360-CHECK-FORM-AH-TERM-BAMT.
 15218
 15219     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15220         FO-AH-MAX-TERM    GREATER THAN  +0
 15221         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15222             IF  PB-COMPANY-ID = 'NCL'
 15223                 MOVE  ER-1917     TO  WS-ERROR
 15224                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15225             ELSE
 15226                  MOVE  ER-1903    TO  WS-ERROR
 15227                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15228
 15229     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15230         FO-MAX-AH-AMT    GREATER THAN  +0
 15231         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15232             IF  PB-COMPANY-ID = 'NCL'
 15233                 MOVE  ER-1919     TO  WS-ERROR
 15234                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15235             ELSE
 15236                 MOVE  ER-1905     TO  WS-ERROR
 15237                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15238
 15239     GO TO 3999-END-EDIT.
 15240
 15241******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 275
* EL050.cbl
 15243******************************************************************
 15244*                  E D I T   C A N C E L                         *
 15245******************************************************************
 15246
 15247 3700-EDIT-CANCEL.
 15248     IF PB-COMPANY-ID = 'DMD'
 15249         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15250                                         WS-RES-MUNI-TAX
 15251                                         PB-CI-STATE-TAX
 15252                                         PB-CI-MUNI-TAX
 15253         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15254
 15255*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15256*       IF PB-ENTRY-BATCH  NUMERIC
 15257*          IF PB-CANCELLATION
 15258*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15259*          ELSE
 15260*             IF PB-ISSUE
 15261*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15262
 15263     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15264        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15265     END-IF
 15266*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15267*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15268
 15269     IF CM-ENTRY-STATUS = 'V'
 15270        MOVE ER-2780             TO WS-ERROR
 15271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15272        GO TO 3999-END-EDIT.
 15273
 15274     IF CM-ENTRY-STATUS = 'D'
 15275        MOVE ER-2781             TO WS-ERROR
 15276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15277        GO TO 3999-END-EDIT.
 15278
 15279     IF CM-ENTRY-STATUS = 'U'
 15280        MOVE ER-2782             TO WS-ERROR
 15281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15282
 15283***************************************************************
 15284*                                                             *
 15285*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15286*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15287*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15288*   OF ANOTHER COVERAGE.                                      *
 15289*                                                             *
 15290***************************************************************
 15291
 15292     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15293                                    PB-C-AH-CANCEL-VOID-SW.
 15294
 15295     IF PB-C-LF-CANCEL-AMT = ZERO
 15296        NEXT SENTENCE
 15297     ELSE
 15298        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15299           AND
 15300           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 276
* EL050.cbl
 15301               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15302               MOVE ER-2745           TO WS-ERROR
 15303               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15304
 15305     IF PB-C-AH-CANCEL-AMT = ZERO
 15306        NEXT SENTENCE
 15307     ELSE
 15308        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15309           AND
 15310           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15311               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15312               MOVE ER-2745           TO WS-ERROR
 15313               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15314
 15315     IF WS-LF-EARNINGS-CALC = '4'
 15316        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15317
 15318     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15319     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15320     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15321     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15322     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15323     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15324
 15325     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15326                                      PB-C-AH-REF-CALC.
 15327     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15328
 15329******************************************************************
 15330*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15331*             TO VALIDATE COVERAGE.                              *
 15332******************************************************************
 15333
 15334     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15335        PB-C-LF-CANCEL-AMT = ZEROS
 15336          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15337      ELSE
 15338          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15339
 15340     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15341        PB-C-AH-CANCEL-AMT = ZEROS
 15342          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15343      ELSE
 15344          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15345
 15346     EVALUATE TRUE
 15347         WHEN PB-CANCEL-FORCE             OR
 15348              PB-CANCEL-DATE-FORCED       OR
 15349              PB-FORCE-OFF
 15350                  IF PB-COMPANY-ID = 'ACE'
 15351                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15352                  END-IF
 15353         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15354               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15355              (PB-COMPANY-ID = 'ACE' )
 15356                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15357         WHEN OTHER
 15358              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 277
* EL050.cbl
 15359                 MOVE ER-2794              TO WS-ERROR
 15360              ELSE
 15361                 MOVE ER-2749              TO WS-ERROR
 15362              END-IF
 15363              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15364     END-EVALUATE.
 15365
 15366
 15367*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15368*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15369*            MOVE  ER-1909            TO  WS-ERROR
 15370*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15371*        ELSE
 15372*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15373
 15374     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15375     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15376        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15377     ELSE
 15378        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15379     END-IF
 15380     .
 15381 3705-EDIT-CANCEL-DT.
 15382
 15383     IF LF-COVERAGE-CANCELLED
 15384        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15385         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15386         MOVE WS-CURRENT-MONTH-END
 15387                                 TO DC-BIN-DATE-2
 15388         SET ELAPSED-BETWEEN-BIN TO TRUE
 15389*        MOVE 1                  TO DC-OPTION-CODE
 15390         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15391         IF DATE-CONVERSION-ERROR
 15392            NEXT SENTENCE
 15393          ELSE
 15394             IF DC-ELAPSED-DAYS GREATER +180
 15395                IF PB-CANCEL-DATE-FORCED  OR
 15396                   PB-CANCEL-DATE-FORCED-NO-FEE
 15397                      MOVE ER-2751  TO WS-ERROR
 15398                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15399                 ELSE
 15400                   MOVE ER-2752  TO WS-ERROR
 15401                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15402
 15403     IF AH-COVERAGE-CANCELLED
 15404        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15405         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15406         MOVE WS-CURRENT-MONTH-END
 15407                                 TO DC-BIN-DATE-2
 15408         SET ELAPSED-BETWEEN-BIN TO TRUE
 15409*        MOVE 1                  TO DC-OPTION-CODE
 15410         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15411         IF DATE-CONVERSION-ERROR
 15412            NEXT SENTENCE
 15413          ELSE
 15414             IF DC-ELAPSED-DAYS GREATER +180
 15415                IF PB-CANCEL-DATE-FORCED OR
 15416                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 278
* EL050.cbl
 15417                      MOVE ER-2751  TO WS-ERROR
 15418                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15419                 ELSE
 15420                   MOVE ER-2752  TO WS-ERROR
 15421                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422
 15423     IF WS-ERROR = ER-2752
 15424        AND (PB-COMPANY-ID = 'ABL'
 15425         OR  PB-COMPANY-ID = 'FGL'
 15426         OR  PB-COMPANY-ID = 'IST'
 15427         OR  PB-COMPANY-ID = 'JHL'
 15428         OR  PB-COMPANY-ID = 'LAP'
 15429         OR  PB-COMPANY-ID = 'LBL'
 15430         OR  PB-COMPANY-ID = 'NCB'
 15431         OR  PB-COMPANY-ID = 'NLI'
 15432         OR  PB-COMPANY-ID = 'OFI'
 15433         OR  PB-COMPANY-ID = 'PLI'
 15434         OR  PB-COMPANY-ID = 'TAO'
 15435         OR  PB-COMPANY-ID = 'TIC'
 15436         OR  PB-COMPANY-ID = 'HER'
 15437         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15438         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15439            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15440            MOVE ER-2762     TO WS-ERROR
 15441            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15442
 15443     IF LF-COVERAGE-CANCELLED
 15444        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15445        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15446             MOVE ER-2733         TO WS-ERROR
 15447             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15448
 15449     IF AH-COVERAGE-CANCELLED
 15450        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15451        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15452              MOVE ER-2733        TO WS-ERROR
 15453              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15454
 15455     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15456        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15457        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15458           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15459            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15460              IF PB-COMPANY-ID NOT = 'LAP'
 15461               MOVE ER-2704            TO WS-ERROR
 15462               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15463
 15464     IF CERT-WAS-NOT-FOUND
 15465         GO TO 3999-END-EDIT.
 15466
 15467     IF PB-COMPANY-ID EQUAL 'CDC'
 15468        IF LF-COVERAGE-CANCELLED
 15469           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15470            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15471            MOVE PB-C-LF-CANCEL-DT
 15472                                 TO DC-BIN-DATE-2
 15473            SET ELAPSED-BETWEEN-BIN TO TRUE
 15474*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 279
* EL050.cbl
 15475            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15476            IF DATE-CONVERSION-ERROR
 15477               NEXT SENTENCE
 15478             ELSE
 15479                IF DC-ELAPSED-DAYS GREATER +60
 15480                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15481
 15482     IF PB-COMPANY-ID EQUAL 'CDC'
 15483        IF AH-COVERAGE-CANCELLED
 15484           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15485            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15486            MOVE PB-C-AH-CANCEL-DT
 15487                                 TO DC-BIN-DATE-2
 15488            MOVE +0              TO DC-ELAPSED-DAYS
 15489                                    DC-ELAPSED-MONTHS
 15490            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15491*           MOVE 1               TO DC-OPTION-CODE
 15492            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15493            IF DATE-CONVERSION-ERROR
 15494               NEXT SENTENCE
 15495             ELSE
 15496                IF DC-ELAPSED-DAYS GREATER +60
 15497                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15498
 15499     MOVE +0                     TO DC-ELAPSED-DAYS
 15500                                    DC-ELAPSED-MONTHS.
 15501
 15502     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15503        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15504          MOVE 'Z'                TO PB-CI-OB-FLAG
 15505          MOVE ER-2767            TO WS-ERROR
 15506          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15507          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15508          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15509          GO TO 3775-OVER-REF-CHK
 15510        ELSE
 15511          MOVE ZEROS              TO PB-CI-LIVES
 15512                                     PB-C-LIVES
 15513          IF PB-CI-OB-FLAG NOT = 'B'
 15514             MOVE SPACE           TO PB-CI-OB-FLAG.
 15515
 15516     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15517         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15518     ELSE
 15519         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15520
 15521     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15522        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15523            MOVE ER-2760         TO WS-ERROR
 15524            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15525
 15526     IF LF-COVERAGE-CANCELLED
 15527        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15528         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15529            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15530               MOVE ER-2774       TO WS-ERROR
 15531               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15532
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 280
* EL050.cbl
 15533     IF AH-COVERAGE-CANCELLED
 15534        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15535         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15536            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15537               MOVE ER-2775       TO WS-ERROR
 15538               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15539
 15540     IF LF-COVERAGE-CANCELLED
 15541        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15542         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15543            MOVE ER-2776         TO WS-ERROR
 15544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15545
 15546     IF AH-COVERAGE-CANCELLED
 15547        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15548         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15549            MOVE ER-2777         TO WS-ERROR
 15550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15551
 15552     IF LF-COVERAGE-CANCELLED
 15553        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15554        if pb-ci-lf-expire-dt = low-values or spaces
 15555           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15556           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15557           MOVE PB-CI-EXTENTION-DAYS
 15558                                 TO DC-ELAPSED-DAYS
 15559           SET BIN-PLUS-ELAPSED  TO TRUE
 15560           PERFORM 8500-DATE-CONVERT
 15561                                 THRU 8500-EXIT
 15562           IF DATE-CONVERSION-ERROR
 15563              move low-values    to dc-bin-date-2
 15564           end-if
 15565        else
 15566           move pb-ci-lf-expire-dt
 15567                                 to dc-bin-date-2
 15568        end-if
 15569        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15570           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15571                             OR  'FIA'
 15572              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15573           ELSE
 15574              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15575              MOVE ER-2731       TO WS-ERROR
 15576              PERFORM 9900-ERROR-FORMAT
 15577                                 THRU 9900-EXIT
 15578           end-if
 15579        end-if
 15580     end-if
 15581*    IF LF-COVERAGE-CANCELLED
 15582*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15583*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15584*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15585*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15586*        SET BIN-PLUS-ELAPSED      TO TRUE
 15587*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15588*        IF DATE-CONVERSION-ERROR
 15589*           NEXT SENTENCE
 15590*         ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 281
* EL050.cbl
 15591*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15592*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15593*                            OR  'FIA'
 15594*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15595*              ELSE
 15596*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15597*               MOVE ER-2731       TO WS-ERROR
 15598*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15599     .
 15600 3705-EDIT-AH-CANCEL-DT.
 15601     IF AH-COVERAGE-CANCELLED
 15602        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15603        if pb-ci-AH-expire-dt = low-values or spaces
 15604           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15605           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15606           MOVE PB-CI-EXTENTION-DAYS
 15607                                 TO DC-ELAPSED-DAYS
 15608           SET BIN-PLUS-ELAPSED  TO TRUE
 15609           PERFORM 8500-DATE-CONVERT
 15610                                 THRU 8500-EXIT
 15611           IF DATE-CONVERSION-ERROR
 15612              move low-values    to dc-bin-date-2
 15613           end-if
 15614        else
 15615           move pb-ci-ah-expire-dt
 15616                                 to dc-bin-date-2
 15617        end-if
 15618        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15619           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15620                             OR  'FIA'
 15621              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15622           ELSE
 15623              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15624              MOVE ER-2771       TO WS-ERROR
 15625              PERFORM 9900-ERROR-FORMAT
 15626                                 THRU 9900-EXIT
 15627           end-if
 15628        end-if
 15629     end-if
 15630*    IF AH-COVERAGE-CANCELLED
 15631*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15632*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15633*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15634*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15635**       MOVE 6                    TO DC-OPTION-CODE
 15636*        SET BIN-PLUS-ELAPSED      TO TRUE
 15637*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15638*        IF DATE-CONVERSION-ERROR
 15639*           NEXT SENTENCE
 15640*         ELSE
 15641*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15642*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15643*                             OR 'FIA'
 15644*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15645*             ELSE
 15646*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15647*              MOVE ER-2771       TO WS-ERROR
 15648*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 282
* EL050.cbl
 15649     .
 15650 3705-EDIT-CONTINUED.
 15651
 15652*    IF LF-COVERAGE-CANCELLED
 15653*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15654*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15655*            MOVE ER-2727         TO WS-ERROR
 15656*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15657*
 15658*    IF AH-COVERAGE-CANCELLED
 15659*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15660*        IF PB-COMPANY-ID = 'ACE'
 15661*           MOVE ER-2727        TO WS-ERROR
 15662*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15663*        ELSE
 15664*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15665*              MOVE ER-2727     TO WS-ERROR
 15666*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15667
 15668     IF PB-COMPANY-ID = 'ACE'
 15669       IF AH-COVERAGE-CANCELLED
 15670         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15671           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15672              MOVE ER-2732      TO WS-ERROR
 15673              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15674
 15675     IF PB-COMPANY-ID      EQUAL   'HER'
 15676        IF WS-ERROR        EQUAL   ER-2727
 15677            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15678            MOVE  ER-2725          TO  WS-ERROR
 15679            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15680
 15681     IF PB-C-CLAIM-CREATED-CANCEL
 15682            MOVE ER-2748         TO WS-ERROR
 15683            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15684
 15685     IF PB-C-LAST-NAME NOT = SPACES
 15686         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15687            MOVE ER-2747         TO WS-ERROR
 15688            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15689
 15690 3710-EDIT-LUMP-SUM-PRIOR.
 15691
 15692     IF AH-COVERAGE-CANCELLED
 15693         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15694             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15695                MOVE ER-2735    TO WS-ERROR
 15696                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15697
 15698     IF LF-COVERAGE-CANCELLED
 15699         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15700             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15701                MOVE ER-2735    TO WS-ERROR
 15702                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15703
 15704 3710-EDIT-PRIOR-DEATH.
 15705
 15706*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 283
* EL050.cbl
 15707*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15708*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15709*           (NOT PB-CI-OB)
 15710*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15711*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15712*                   MOVE ER-2732  TO WS-ERROR
 15713*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15714*
 15715*    IF AH-COVERAGE-CANCELLED
 15716*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15717*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15718*           (NOT PB-CI-OB)
 15719*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15720*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15721*                   MOVE ER-2732  TO WS-ERROR
 15722*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15723
 15724     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15725         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15726            (NOT PB-COMP-LF-CANCEL)
 15727             NEXT SENTENCE
 15728         ELSE
 15729           IF PB-C-LF-CANCEL-VOIDED
 15730              NEXT SENTENCE
 15731           ELSE
 15732              MOVE ER-2753      TO WS-ERROR
 15733              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15734
 15735     IF CANCEL-FUTURE-DT
 15736         GO TO 3999-END-EDIT.
 15737
 15738 3715-GET-REMAIN-TERM-LF.
 15739
 15740     IF NO-LF-BENEFIT-MATCH  OR
 15741        WS-LF-BENEFIT-CD = ZEROS
 15742        GO TO 3730-GET-AH-REMAIN-TERM.
 15743
 15744     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15745     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15746     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15747     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15748     MOVE PB-SV-STATE            TO CP-STATE.
 15749     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15750     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15751     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15752     MOVE '2'                    TO CP-PROCESS-TYPE.
 15753     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15754     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15755     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15756     IF (PB-COMPANY-ID = 'CID')
 15757        AND (CP-STATE-STD-ABBRV = 'WI')
 15758        MOVE '7'                 TO CP-REM-TERM-METHOD
 15759        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15760     ELSE
 15761        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15762        MOVE WS-REM-TRM-CALC-OPTION
 15763                                 TO CP-REM-TRM-CALC-OPTION
 15764     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 284
* EL050.cbl
 15765**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15766     IF (PB-COMPANY-ID = 'CID')
 15767        AND (CP-STATE-STD-ABBRV = 'MO')
 15768        AND (PB-CERT-EFF-DT >= X'9B41')
 15769        AND (PB-CERT-EFF-DT <= X'A2FB')
 15770        MOVE '7'                 TO CP-REM-TERM-METHOD
 15771        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15772     END-IF
 15773     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15774                                    CP-LOAN-TERM.
 15775     IF CP-TRUNCATED-LIFE
 15776        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15777
 15778     IF CP-TERM-IS-DAYS
 15779         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15780     ELSE
 15781         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15782
 15783     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15784
 15785     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15786
 15787     IF LF-COVERAGE-CANCELLED
 15788        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15789        NEXT SENTENCE
 15790      ELSE
 15791          GO TO 3730-GET-AH-REMAIN-TERM.
 15792
 15793 3720-GET-LF-REFUND.
 15794
 15795     IF PB-C-LF-CANCEL-VOIDED OR
 15796        PB-C-AH-CANCEL-VOIDED
 15797        GO TO 3780-UPDATE-CANCEL-CERT.
 15798
 15799     IF PB-COMPANY-ID EQUAL 'BOA'
 15800         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15801         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15802         GO TO 3730-GET-AH-REMAIN-TERM.
 15803
 15804     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15805        (WS-AH-SPECIAL-CALC-CD = 'M')
 15806         MOVE ER-2767            TO WS-ERROR
 15807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15808         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15809         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15810         GO TO 3780-UPDATE-CANCEL-CERT.
 15811
 15812*    if (ws-lf-earnings-calc = '6')
 15813*       or (pb-c-lf-refund-override = '6')
 15814*       move cp-remaining-term-1 to cp-remaining-term-2
 15815*    end-if
 15816     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15817
 15818     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15819     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15820     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15821     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15822     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 285
* EL050.cbl
 15823     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15824     IF (PB-COMPANY-ID = 'DCC')
 15825        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15826        IF PDEF-MASTER-FOUND
 15827           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15828              (V1 > +8)
 15829              OR (PD-PROD-CODE (V1) = 'L')
 15830           END-PERFORM
 15831           IF V1 < +9
 15832              MOVE PD-MAX-AMT (V1)
 15833                           TO CP-R-MAX-TOT-BEN
 15834                              EC-AM-LF-MAX-TOT-BEN
 15835           END-IF
 15836        ELSE
 15837        MOVE ' '                 TO PDEF-MASTER-SW
 15838        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15839        MOVE PB-STATE            TO ERPDEF-STATE
 15840        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15841        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15842        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15843        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15844        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15845        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15846        IF PDEF-MASTER-FOUND
 15847           MOVE 'N'              TO PDEF-MASTER-SW
 15848           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15849           IF PDEF-MASTER-FOUND
 15850              IF (ERPDEF-KEY-SAVE (1:16) =
 15851                           PD-CONTROL-PRIMARY (1:16))
 15852                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15853                 CONTINUE
 15854              ELSE
 15855                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15856                 IF (ERPDEF-KEY-SAVE (1:16) =
 15857                           PD-CONTROL-PRIMARY (1:16))
 15858                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15859                    CONTINUE
 15860                 ELSE
 15861                    MOVE 'N'     TO PDEF-MASTER-SW
 15862                 END-IF
 15863              END-IF
 15864              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15865
 15866              IF PDEF-MASTER-FOUND
 15867                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15868                    (V1 > +8)
 15869                    OR (PD-PROD-CODE (V1) = 'L')
 15870                 END-PERFORM
 15871                 IF V1 < +9
 15872                    MOVE PD-MAX-AMT (V1)
 15873                                 TO CP-R-MAX-TOT-BEN
 15874                                    EC-AM-LF-MAX-TOT-BEN
 15875                 END-IF
 15876              END-IF
 15877           END-IF
 15878           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15879        END-IF
 15880        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 286
* EL050.cbl
 15881     END-IF
 15882     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15883
 15884     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15885
 15886     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15887                                    PB-C-LF-REM-TERM.
 15888
 15889     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15890     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15891
 15892     IF PB-COMPANY-ID EQUAL 'FLC'
 15893        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15894           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15895           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15896                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15897                    - CM-LF-ITD-DEATH-AMT
 15898           IF PB-C-LF-REF-CALC LESS THAN +0
 15899              MOVE +0            TO PB-C-LF-REF-CALC
 15900              GO TO 3730-GET-AH-REMAIN-TERM
 15901           ELSE
 15902              GO TO 3730-GET-AH-REMAIN-TERM.
 15903
 15904     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15905                            OR '4' OR '5' OR '6' OR '8'
 15906                            OR '9' OR 'G'
 15907        MOVE PB-C-LF-REFUND-OVERRIDE
 15908                                 TO CP-EARNING-METHOD.
 15909
 15910     if pb-company-id = 'AHL'
 15911        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15912        if cp-class-code = spaces
 15913           move zeros            to cp-class-code
 15914        end-if
 15915     ELSE
 15916        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15917     END-IF
 15918*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15919     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15920     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15921                                    CP-RATING-BENEFIT-AMT.
 15922     IF CP-STATE-STD-ABBRV = 'OR'
 15923         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15924                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15925     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15926     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15927     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15928     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15929     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15930     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15931     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15932     IF WS-DEFAULT-APR NOT NUMERIC
 15933         MOVE ZEROS TO WS-DEFAULT-APR.
 15934****   N O T E   ****
 15935*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15936*      THE OH HARD CODING IN ELCRFNDP
 15937
 15938     IF PB-COMPANY-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 287
* EL050.cbl
 15939        IF CP-STATE-STD-ABBRV = 'OH'
 15940           MOVE WS-LF-EARNINGS-CALC
 15941                                 TO CP-EARNING-METHOD
 15942        END-IF
 15943     END-IF
 15944
 15945****   N O T E   ****
 15946
 15947     IF CP-EARN-AS-NET-PAY
 15948         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15949            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15950                MOVE WS-DEFAULT-APR
 15951                                 TO  CP-LOAN-APR
 15952                MOVE ER-3780     TO  WS-ERROR
 15953                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15954            ELSE
 15955                MOVE ER-3781     TO  WS-ERROR
 15956                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15957*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15958     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15959
 15960     IF CP-REFUND-TYPE-USED NOT = SPACE
 15961         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15962
 15963     IF CP-ERROR-RATE-IS-ZERO OR
 15964        CP-ERROR-RATE-NOT-FOUND
 15965        MOVE ER-2740             TO WS-ERROR
 15966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15967
 15968     IF CP-ERROR-RATE-FILE-NOTOPEN
 15969        MOVE ER-2617             TO WS-ERROR
 15970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15971
 15972     IF PB-COMPANY-ID = 'DCC'
 15973        AND PB-CI-ENTRY-STATUS = 'M'
 15974        MOVE +0                  TO PB-C-LF-REF-CALC
 15975     ELSE
 15976        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15977     END-IF
 15978
 15979     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15980         GO TO 3730-GET-AH-REMAIN-TERM.
 15981
 15982*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15983*       ADD +1                   TO PB-C-LF-REM-TERM
 15984*                                   CP-REMAINING-TERM
 15985*                                   CP-ORIGINAL-TERM.
 15986
 15987     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15988     MOVE '2'                    TO CP-EARNING-METHOD
 15989                                    CP-RATING-METHOD.
 15990     IF PB-COMPANY-ID = 'CID'
 15991        IF (CP-STATE-STD-ABBRV = 'MN')
 15992           AND (PB-CERT-EFF-DT > X'A4FF')
 15993           AND (WS-LF-EARNINGS-CALC = 'B')
 15994           MOVE '5'              TO CP-EARNING-METHOD
 15995           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15996        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 288
* EL050.cbl
 15997     END-IF
 15998     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15999                                        CP-REMAINING-BENEFIT
 16000                                        CP-RATING-BENEFIT-AMT.
 16001     IF CP-STATE-STD-ABBRV = 'OR'
 16002         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16003                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16004     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16005     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16006
 16007     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16008
 16009     IF CP-ERROR-RATE-IS-ZERO OR
 16010        CP-ERROR-RATE-NOT-FOUND
 16011        MOVE ER-2740             TO WS-ERROR
 16012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16013
 16014     IF CP-ERROR-RATE-FILE-NOTOPEN
 16015        MOVE ER-2617             TO WS-ERROR
 16016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16017
 16018     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16019
 16020******************************************************************
 16021
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 289
* EL050.cbl
 16023 3730-GET-AH-REMAIN-TERM.
 16024     IF NO-AH-BENEFIT-MATCH  OR
 16025        WS-AH-BENEFIT-CD = ZEROS
 16026         GO TO 3770-CHECK-REFUNDS.
 16027
 16028     IF PB-CI-AH-LUMP-SUM-DISAB
 16029         IF  PB-C-AH-CANCEL-AMT = ZERO
 16030            IF NOT PB-COMP-AH-CANCEL
 16031             GO TO 3770-CHECK-REFUNDS.
 16032
 16033     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16034     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16035     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16036     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16037     MOVE PB-SV-STATE            TO CP-STATE.
 16038     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16039     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16040     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16041     MOVE '2'                    TO CP-PROCESS-TYPE.
 16042     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16043     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16044     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16045     IF (PB-COMPANY-ID = 'CID')
 16046        AND (CP-STATE-STD-ABBRV = 'WI')
 16047        MOVE '7'                 TO CP-REM-TERM-METHOD
 16048        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16049     ELSE
 16050        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16051        MOVE WS-REM-TRM-CALC-OPTION
 16052                                 TO CP-REM-TRM-CALC-OPTION
 16053     END-IF
 16054     IF (PB-COMPANY-ID = 'CID')
 16055        AND (CP-STATE-STD-ABBRV = 'MO')
 16056        AND (PB-CERT-EFF-DT >= X'9B41')
 16057        AND (PB-CERT-EFF-DT <= X'A2FB')
 16058        MOVE '7'                 TO CP-REM-TERM-METHOD
 16059        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16060     END-IF
 16061     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16062                                    CP-LOAN-TERM.
 16063     IF NOT CP-TERM-IS-DAYS
 16064         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16065
 16066     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16067
 16068     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16069
 16070     IF AH-COVERAGE-CANCELLED
 16071        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16072        NEXT SENTENCE
 16073      ELSE
 16074         GO TO 3770-CHECK-REFUNDS.
 16075
 16076 3740-GET-AH-REFUND.
 16077
 16078     IF PB-C-LF-CANCEL-VOIDED OR
 16079        PB-C-AH-CANCEL-VOIDED
 16080        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 290
* EL050.cbl
 16081
 16082     IF PB-COMPANY-ID = 'BOA'
 16083         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16084         GO TO 3770-CHECK-REFUNDS.
 16085
 16086     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16087*    MOVE ' '                    TO DC-OPTION-CODE
 16088     SET BIN-TO-GREG             TO TRUE
 16089     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16090     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16091                                    PB-C-AH-REM-TERM.
 16092     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16093     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16094
 16095     IF PB-COMPANY-ID EQUAL 'FLC'
 16096        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16097           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16098           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16099                    - CM-AH-ITD-AH-PMT)
 16100           IF PB-C-AH-REF-CALC LESS THAN +0
 16101              MOVE +0            TO PB-C-AH-REF-CALC
 16102              GO TO 3770-CHECK-REFUNDS
 16103           ELSE
 16104              GO TO 3770-CHECK-REFUNDS.
 16105
 16106     IF PB-COMPANY-ID = 'DCC'
 16107        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16108            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16109           MOVE 'S'              TO CP-EARNING-METHOD
 16110        END-IF
 16111     END-IF
 16112     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16113                            OR '4' OR '5' OR '6' OR '8'
 16114                            OR '9' OR 'G' OR 'S'
 16115        MOVE PB-C-AH-REFUND-OVERRIDE
 16116                                 TO CP-EARNING-METHOD.
 16117
 16118     if pb-company-id = 'AHL'
 16119        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16120        if cp-class-code = spaces
 16121           move zeros            to cp-class-code
 16122        end-if
 16123     ELSE
 16124        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16125     END-IF
 16126*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16127     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16128     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16129                                    CP-RATING-BENEFIT-AMT.
 16130     IF CP-STATE-STD-ABBRV = 'OR'
 16131         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16132                                         PB-CI-AH-TERM.
 16133     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16134     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16135     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16136     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16137     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16138     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 291
* EL050.cbl
 16139
 16140     IF CP-STATE-STD-ABBRV = 'OH'
 16141        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16142                                AND 'CID' AND 'DCC' AND 'AHL')
 16143           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16144              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16145              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16146              MOVE '6' TO CP-EARNING-METHOD
 16147           END-IF
 16148        END-IF
 16149        IF PB-COMPANY-ID = 'CID'
 16150           IF NO-LIFE-COVERAGE
 16151              IF CP-CRITICAL-PERIOD
 16152                 MOVE '2'       TO CP-EARNING-METHOD
 16153              ELSE
 16154                 MOVE '6'       TO CP-EARNING-METHOD
 16155              END-IF
 16156           ELSE
 16157              IF WS-LF-COVERAGE-TYPE = 'L'
 16158                 MOVE '2'       TO CP-EARNING-METHOD
 16159              ELSE
 16160                 IF (PB-CI-LF-TERM > +60) OR
 16161                    (WS-LF-EARNINGS-CALC = '5')
 16162                    IF CP-CRITICAL-PERIOD
 16163                       MOVE '2'  TO CP-EARNING-METHOD
 16164                    ELSE
 16165                       MOVE '6'  TO CP-EARNING-METHOD
 16166                    END-IF
 16167                 ELSE
 16168                    MOVE '1'     TO CP-EARNING-METHOD
 16169                 END-IF
 16170              END-IF
 16171           END-IF
 16172        END-IF
 16173     END-IF
 16174
 16175*    IF CP-STATE-STD-ABBRV = 'VA'
 16176*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16177*          IF CP-ORIGINAL-TERM GREATER 61
 16178*             MOVE '6' TO CP-EARNING-METHOD
 16179*          ELSE
 16180*             MOVE '1' TO CP-EARNING-METHOD.
 16181
 16182     IF WS-DEFAULT-APR NOT NUMERIC
 16183         MOVE ZEROS TO WS-DEFAULT-APR.
 16184     IF CP-EARN-AS-NET-PAY
 16185         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16186            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16187                MOVE WS-DEFAULT-APR
 16188                                 TO  CP-LOAN-APR
 16189                MOVE ER-3780     TO  WS-ERROR
 16190                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16191            ELSE
 16192                MOVE ER-3781     TO  WS-ERROR
 16193                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16194     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16195     IF PB-COMPANY-ID = 'DCC'
 16196        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 292
* EL050.cbl
 16197        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16198        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16199     END-IF
 16200     IF PB-COMPANY-ID = 'DCC'
 16201        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16202        AND (CP-EARNING-METHOD = 'D')
 16203        AND (CP-CANCEL-REASON NOT = 'R')
 16204        CONTINUE
 16205     ELSE
 16206        GO TO 3750-CONTINUE
 16207     END-IF
 16208     MOVE ' '                    TO DD-IU-SW
 16209     IF NOT PDEF-MASTER-FOUND
 16210        MOVE ' '                 TO PDEF-MASTER-SW
 16211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16212        MOVE PB-STATE            TO ERPDEF-STATE
 16213        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16214        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16215        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16216        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16217        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16218        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16219        IF PDEF-MASTER-FOUND
 16220           MOVE 'N'              TO PDEF-MASTER-SW
 16221           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16222           IF PDEF-MASTER-FOUND
 16223              IF (ERPDEF-KEY-SAVE (1:16) =
 16224                           PD-CONTROL-PRIMARY (1:16))
 16225                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16226                 CONTINUE
 16227              ELSE
 16228                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16229                 IF (ERPDEF-KEY-SAVE (1:16) =
 16230                           PD-CONTROL-PRIMARY (1:16))
 16231                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16232                    CONTINUE
 16233                 ELSE
 16234                    MOVE ER-2740 TO WS-ERROR
 16235                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16236                    GO TO 3770-CHECK-REFUNDS
 16237                 END-IF
 16238              END-IF
 16239           END-IF
 16240           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16241        END-IF
 16242     END-IF
 16243     IF PDEF-MASTER-FOUND
 16244        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16245           (V1 > +8)
 16246           OR (PD-PROD-CODE (V1) = 'I')
 16247        END-PERFORM
 16248        IF V1 < +9
 16249           SET DD-IU-PRESENT        TO TRUE
 16250        END-IF
 16251        IF WS-AH-DCC-TRUNC = 'T'
 16252           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16253        ELSE
 16254           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 293
* EL050.cbl
 16255        END-IF
 16256        EVALUATE TRUE
 16257           WHEN WS-TERM > +168
 16258              MOVE 15               TO V1
 16259           WHEN WS-TERM > +156
 16260              MOVE 14               TO V1
 16261           WHEN WS-TERM > +144
 16262              MOVE 13               TO V1
 16263           WHEN WS-TERM > +132
 16264              MOVE 12               TO V1
 16265           WHEN WS-TERM > +120
 16266              MOVE 11               TO V1
 16267           WHEN WS-TERM > +108
 16268              MOVE 10               TO V1
 16269           WHEN WS-TERM > +96
 16270              MOVE 9                TO V1
 16271           WHEN WS-TERM > +84
 16272              MOVE 8                TO V1
 16273           WHEN WS-TERM > +72
 16274              MOVE 7                TO V1
 16275           WHEN WS-TERM > +60
 16276              MOVE 6                TO V1
 16277           WHEN WS-TERM > +48
 16278              MOVE 5                TO V1
 16279           WHEN WS-TERM > +36
 16280              MOVE 4                TO V1
 16281           WHEN WS-TERM > +24
 16282              MOVE 3                TO V1
 16283           WHEN WS-TERM > +12
 16284              MOVE 2                TO V1
 16285           WHEN OTHER
 16286              MOVE 1                TO V1
 16287        END-EVALUATE
 16288
 16289        EVALUATE TRUE
 16290*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16291*             < +13)
 16292*             AND (DD-IU-PRESENT)
 16293*             MOVE 2                TO V2
 16294*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16295*             MOVE 1                TO V2
 16296           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16297              MOVE 2                TO V2
 16298           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16299              MOVE 3                TO V2
 16300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16301              MOVE 4                TO V2
 16302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16303              MOVE 5                TO V2
 16304           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16305              MOVE 6                TO V2
 16306           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16307              MOVE 7                TO V2
 16308           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16309              MOVE 8                TO V2
 16310           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16311              MOVE 9                TO V2
 16312           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 294
* EL050.cbl
 16313              MOVE 10               TO V2
 16314           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16315              MOVE 11               TO V2
 16316           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16317              MOVE 12               TO V2
 16318           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16319              MOVE 13               TO V2
 16320           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16321              MOVE 14               TO V2
 16322           WHEN OTHER
 16323              MOVE 15               TO V2
 16324        END-EVALUATE
 16325
 16326        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16327                                 TO CP-DDF-LO-FACT
 16328        MOVE PD-UEP-FACTOR (V1 V2)
 16329                                 TO CP-DDF-HI-FACT
 16330
 16331        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16332        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16333        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16334           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16335        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16336        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16337        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16338           + PD-1ST-YR-ADMIN-ALLOW
 16339
 16340        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16341*       IF PI-CLP-YN = 'Y'
 16342*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16343*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16344*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16345*       END-IF
 16346
 16347        IF DD-IU-PRESENT
 16348           MOVE 'I'              TO CP-EARNING-METHOD
 16349        END-IF
 16350        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16351                                     CP-CLP-RATE-UP
 16352        IF CP-IU-RATE-UP NOT = ZEROS
 16353           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16354              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16355           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16356              / (1 - WS-WORK-FACT)
 16357        END-IF
 16358     END-IF
 16359     .
 16360 3750-CONTINUE.
 16361     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16362
 16363     IF CP-REFUND-TYPE-USED NOT = SPACE
 16364         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16365
 16366     IF CP-ERROR-RATE-IS-ZERO OR
 16367        CP-ERROR-RATE-NOT-FOUND
 16368        MOVE ER-2740             TO WS-ERROR
 16369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16370
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 295
* EL050.cbl
 16371     IF CP-ERROR-RATE-FILE-NOTOPEN
 16372        MOVE ER-2617             TO WS-ERROR
 16373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16374     IF PB-COMPANY-ID = 'DCC'
 16375        AND PB-CI-ENTRY-STATUS = 'M'
 16376        MOVE +0                  TO PB-C-AH-REF-CALC
 16377     ELSE
 16378        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16379     END-IF
 16380     IF PB-COMPANY-ID = 'DCC'
 16381        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16382        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16383        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16384        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16385        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16386        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16387        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16388        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16389        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16390     END-IF
 16391     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 296
* EL050.cbl
 16393
 16394 3770-CHECK-REFUNDS.
 16395
 16396     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16397        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16398           MOVE ER-2766          TO WS-ERROR
 16399           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16400           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16401           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16402              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16403
 16404     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16405        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16406           MOVE ER-2766          TO WS-ERROR
 16407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16408           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16409           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16410              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16411
 16412     IF PB-COMP-LF-CANCEL
 16413        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16414        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16415           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16416              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16417
 16418     IF PB-COMP-AH-CANCEL
 16419        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16420        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16421           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16422              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16423
 16424     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16425             GIVING WS-UNSIGN-WRK1
 16426     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16427             GIVING WS-UNSIGN-WRK2.
 16428
 16429     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16430         MOVE ZERO TO WS-UNSIGN-WRK1.
 16431
 16432     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16433         MOVE ZERO TO WS-UNSIGN-WRK2.
 16434
 16435     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16436
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 297
* EL050.cbl
 16438
 16439 3772-CONTINUE.
 16440
 16441**********************************
 16442*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16443*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16444*** DOUBLES THE TOLERANCE AMOUNT.
 16445***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16446**********************************
 16447     IF PB-COMPANY-ID = 'MON'
 16448     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16449         IF WS-REF-REJECT-SW = SPACE
 16450             MOVE ER-2754        TO WS-ERROR
 16451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16452           ELSE
 16453             MOVE ER-2736        TO WS-ERROR
 16454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16455**********************************
 16456
 16457 3773-CONTINUE.
 16458
 16459     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16460        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16461           MOVE ER-2723          TO WS-ERROR
 16462           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16463
 16464     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16465        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16466           MOVE ER-2724          TO WS-ERROR
 16467           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16468
 16469     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16470         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16471             (1 + WS-LF-REFUND-OVS-PCT)
 16472     ELSE
 16473         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16474
 16475     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16476         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16477             (1 - WS-TOL-LF-REFUND-PCT)
 16478     ELSE
 16479         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16480
 16481     IF (PB-COMPANY-ID = 'DCC')
 16482        AND (PB-CI-ENTRY-STATUS = 'M')
 16483        AND (PB-C-LF-CANCEL-AMT > +0)
 16484        MOVE ER-3843             TO WS-ERROR
 16485        PERFORM 9900-ERROR-FORMAT
 16486                                 THRU 9900-EXIT
 16487     END-IF
 16488     EVALUATE TRUE
 16489        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16490           CONTINUE
 16491        WHEN PB-C-LF-CANCEL-AMT = +0
 16492                 AND PB-C-LF-REF-CALC > +0
 16493           CONTINUE
 16494        WHEN WS-LF-REFUND-OVS-AMT = 0
 16495                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 298
* EL050.cbl
 16496           CONTINUE
 16497        WHEN OTHER
 16498           IF WS-TOL-LF-REFUND  = +0
 16499              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16500           END-IF
 16501           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16502                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16503                          (PB-C-LF-CANCEL-AMT))
 16504              CONTINUE
 16505           ELSE
 16506              IF WS-LF-REFUND-OVS-AMT = +0
 16507                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16508              END-IF
 16509              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16510                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16511                                       PB-C-LF-CANCEL-AMT)
 16512                 CONTINUE
 16513              ELSE
 16514                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16515                   MOVE ER-2754   TO  WS-ERROR
 16516                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16517                 ELSE
 16518                    MOVE ER-2736   TO  WS-ERROR
 16519                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16520                 END-IF
 16521              END-IF
 16522           END-IF
 16523     END-EVALUATE.
 16524
 16525     EVALUATE TRUE
 16526        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16527           CONTINUE
 16528        WHEN PB-C-LF-CANCEL-AMT = +0
 16529                 AND PB-C-LF-REF-CALC > +0
 16530           CONTINUE
 16531        WHEN OTHER
 16532           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16533               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16534              CONTINUE
 16535           ELSE
 16536              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16537               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16538                CONTINUE
 16539              ELSE
 16540                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16541                     MOVE ER-2754   TO  WS-ERROR
 16542                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16543                 ELSE
 16544                     MOVE ER-2736   TO  WS-ERROR
 16545                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16546                 END-IF
 16547              END-IF
 16548           END-IF
 16549     END-EVALUATE.
 16550
 16551     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16552         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16553             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 299
* EL050.cbl
 16554     ELSE
 16555         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16556
 16557     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16558         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16559             (1 - WS-TOL-AH-REFUND-PCT)
 16560     ELSE
 16561         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16562
 16563     IF (PB-COMPANY-ID = 'DCC')
 16564        AND (PB-CI-ENTRY-STATUS = 'M')
 16565        AND (PB-C-AH-CANCEL-AMT > +0)
 16566        MOVE ER-3843             TO WS-ERROR
 16567        PERFORM 9900-ERROR-FORMAT
 16568                                 THRU 9900-EXIT
 16569     END-IF
 16570     EVALUATE TRUE
 16571        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16572           CONTINUE
 16573*       WHEN PB-C-AH-REF-CALC = +0 AND
 16574*                  PB-C-AH-CANCEL-AMT > +0
 16575        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16576                   PB-C-AH-REF-CALC > +0
 16577           CONTINUE
 16578        WHEN WS-AH-REFUND-OVS-AMT = +0
 16579                AND WS-TOL-AH-REFUND = +0
 16580           CONTINUE
 16581        WHEN OTHER
 16582           IF WS-TOL-AH-REFUND = +0
 16583              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16584           END-IF
 16585           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16586               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16587                                         PB-C-AH-CANCEL-AMT)
 16588              CONTINUE
 16589           ELSE
 16590              IF WS-AH-REFUND-OVS-AMT = +0
 16591                 MOVE +9999999.99 TO
 16592                         WS-AH-REFUND-OVS-AMT
 16593              END-IF
 16594              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16595                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16596                                         PB-C-AH-CANCEL-AMT)
 16597                 CONTINUE
 16598              ELSE
 16599                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16600                    MOVE ER-2754   TO  WS-ERROR
 16601                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16602                 ELSE
 16603                    MOVE ER-2736   TO  WS-ERROR
 16604                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16605                 END-IF
 16606              END-IF
 16607           END-IF
 16608     END-EVALUATE.
 16609
 16610     EVALUATE TRUE
 16611        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 300
* EL050.cbl
 16612           CONTINUE
 16613*       WHEN PB-C-AH-REF-CALC > +0 AND
 16614*                  PB-C-AH-CANCEL-AMT = +0
 16615        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16616                   PB-C-AH-REF-CALC = +0
 16617           CONTINUE
 16618        WHEN OTHER
 16619           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16620               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16621              CONTINUE
 16622           ELSE
 16623              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16624                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16625                 CONTINUE
 16626              ELSE
 16627                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16628                     MOVE ER-2754   TO  WS-ERROR
 16629                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16630                 ELSE
 16631                     MOVE ER-2736   TO  WS-ERROR
 16632                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633                 END-IF
 16634              END-IF
 16635           END-IF
 16636     END-EVALUATE.
 16637
 16638     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16639        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16640        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16641           AND  PB-C-LF-REF-CALC < +1.00
 16642           AND  PB-C-AH-REF-CALC < +1.00
 16643           CONTINUE
 16644        ELSE
 16645           IF (PB-COMPANY-ID = 'DCC')
 16646              AND (PB-CI-ENTRY-STATUS = 'M')
 16647              CONTINUE
 16648           ELSE
 16649              MOVE ER-2741       TO WS-ERROR
 16650              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16651           END-IF
 16652        END-IF
 16653     END-IF
 16654
 16655     IF (PB-C-LF-CANCEL-AMT = ZERO
 16656        AND WS-LF-BENEFIT-CD NOT = ZERO
 16657        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16658        AND PB-C-LF-REF-CALC NOT = ZERO)
 16659        OR
 16660        (PB-C-LF-CANCEL-AMT = ZERO
 16661        AND WS-LF-BENEFIT-CD NOT = ZERO
 16662        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16663             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16664                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16665                NEXT SENTENCE
 16666             ELSE
 16667                MOVE ER-2739        TO WS-ERROR
 16668                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16669
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 301
* EL050.cbl
 16670     IF (PB-C-AH-CANCEL-AMT = ZERO
 16671        AND WS-AH-BENEFIT-CD NOT = ZERO
 16672        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16673        AND PB-C-AH-REF-CALC NOT = ZERO)
 16674        OR
 16675        (PB-C-AH-CANCEL-AMT = ZERO
 16676        AND WS-AH-BENEFIT-CD NOT = ZERO
 16677        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16678             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16679                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16680                NEXT SENTENCE
 16681             ELSE
 16682                MOVE ER-2738        TO WS-ERROR
 16683                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16684
 16685 3775-OVER-REF-CHK.
 16686
 16687     IF PB-CI-ENTRY-STATUS = '5'
 16688        GO TO 3780-UPDATE-CANCEL-CERT.
 16689
 16690     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16691                              PB-CI-LF-ALT-PREMIUM-AMT.
 16692
 16693     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16694        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16695                                 PB-C-LF-REF-CALC
 16696      ELSE
 16697        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16698                                 PB-C-LF-CANCEL-AMT.
 16699
 16700     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16701        MOVE ER-2755             TO WS-ERROR
 16702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16703
 16704     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16705
 16706     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16707        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16708                                 PB-C-AH-REF-CALC
 16709      ELSE
 16710        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16711                                 PB-C-AH-CANCEL-AMT.
 16712
 16713     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16714        MOVE ER-2778             TO WS-ERROR
 16715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16716
 16717     IF PB-CI-OB-FLAG NOT = 'Z'
 16718        NEXT SENTENCE
 16719       ELSE
 16720         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16721            MOVE ER-2757           TO WS-ERROR
 16722            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16723
 16724 3780-UPDATE-CANCEL-CERT.
 16725
 16726     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16727        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 302
* EL050.cbl
 16728        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16729
 16730     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16731         MOVE ER-2729              TO WS-ERROR
 16732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16733
 16734     IF PB-CI-LF-BENEFIT-CD = ZERO
 16735         GO TO 3780-UPDATE-CONT-1.
 16736
 16737     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16738         GO TO 3780-UPDATE-CONT-1.
 16739
 16740     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16741       AND
 16742        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16743       AND
 16744        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16745       AND
 16746        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16747            NEXT SENTENCE
 16748       ELSE
 16749        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16750          AND
 16751***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16752***       AND
 16753           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16754            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16755               MOVE ER-2730      TO WS-ERROR
 16756               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16757               GO TO 3999-END-EDIT
 16758            ELSE
 16759               GO TO 3999-END-EDIT
 16760        ELSE
 16761            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16762               MOVE ER-2765           TO WS-ERROR
 16763               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16764               GO TO 3785-CHECK-NH.
 16765*              GO TO 3999-END-EDIT.
 16766
 16767 3780-UPDATE-CONT-1.
 16768     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16769
 16770     IF PB-CI-AH-BENEFIT-CD = ZERO
 16771         GO TO 3780-UPDATE-CONT-2.
 16772
 16773     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16774         GO TO 3780-UPDATE-CONT-2.
 16775
 16776     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16777
 16778     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16779       AND
 16780        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16781       AND
 16782        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16783       AND
 16784        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16785            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 303
* EL050.cbl
 16786       ELSE
 16787        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16788          AND
 16789***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16790***       AND
 16791           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16792           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16793            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16794               MOVE ER-2773      TO WS-ERROR
 16795               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16796               GO TO 3999-END-EDIT
 16797            ELSE
 16798               GO TO 3999-END-EDIT
 16799            END-IF
 16800           ELSE
 16801             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16802                MOVE ER-2890 TO WS-ERROR
 16803                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16804                GO TO 3999-END-EDIT
 16805             ELSE
 16806                GO TO 3785-CHECK-NH
 16807             END-IF
 16808           END-IF
 16809          ELSE
 16810            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16811              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16812                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16813                   MOVE ER-2890 TO WS-ERROR
 16814                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16815                   GO TO 3999-END-EDIT
 16816                ELSE
 16817                   MOVE ER-2765 TO WS-ERROR
 16818                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16819                   GO TO 3785-CHECK-NH
 16820                END-IF
 16821              ELSE
 16822               MOVE ER-2765      TO WS-ERROR
 16823               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16824               GO TO 3785-CHECK-NH.
 16825*              GO TO 3999-END-EDIT.
 16826
 16827 3780-UPDATE-CONT-2.
 16828
 16829     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16830        AND WS-LF-BENEFIT-CD = ZERO
 16831           MOVE ER-2743           TO WS-ERROR
 16832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16833
 16834     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16835        AND WS-AH-BENEFIT-CD = ZERO
 16836           MOVE ER-2744           TO WS-ERROR
 16837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16838
 16839     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16840        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16841        AND
 16842        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16843         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 304
* EL050.cbl
 16844           MOVE ER-2746           TO WS-ERROR
 16845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16846
 16847     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16848       AND
 16849        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16850             MOVE ER-2737        TO WS-ERROR
 16851             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16852
 16853     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16854       AND
 16855        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16856             MOVE ER-2737        TO WS-ERROR
 16857             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16858
 16859     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16860         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16861             OR 'CID' OR 'DCC' OR 'AHL'
 16862             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16863         ELSE
 16864             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16865                 MOVE ER-2768    TO WS-ERROR
 16866                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16867             ELSE
 16868                 MOVE ER-2756    TO WS-ERROR
 16869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16870
 16871     IF CERT-PEND-ISSUE-RETURNED
 16872        MOVE ER-2772             TO WS-ERROR
 16873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16874 3785-CHECK-NH.
 16875     IF PB-STATE NOT = 'NH'
 16876        GO TO 3999-END-EDIT
 16877     END-IF
 16878
 16879     MOVE ER-2796                TO WS-ERROR
 16880     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16881     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16882        OR (CM-NH-INTERFACE-SW = 'Y')
 16883        MOVE ER-2793             TO WS-ERROR
 16884        PERFORM 9900-ERROR-FORMAT
 16885                                 THRU 9900-EXIT
 16886     END-IF
 16887     MOVE +0                     TO WS-PAYMENT-AMT
 16888     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16889        GO TO 3999-END-EDIT
 16890     END-IF
 16891     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16892        GO TO 3999-END-EDIT
 16893     END-IF
 16894     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16895     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16896     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16897        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16898     END-IF
 16899     MOVE '1'                    TO DC-OPTION-CODE
 16900     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16901     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 305
* EL050.cbl
 16902        IF DC-ELAPSED-DAYS < +16
 16903           GO TO 3999-END-EDIT
 16904        END-IF
 16905     END-IF
 16906     MOVE +0                     TO DC-ELAPSED-DAYS
 16907     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16908     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16909     MOVE '1'                    TO DC-OPTION-CODE
 16910     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16911     IF NO-CONVERSION-ERROR
 16912        IF DC-ELAPSED-DAYS > +30
 16913           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16914        ELSE
 16915           GO TO 3999-END-EDIT
 16916        END-IF
 16917     ELSE
 16918        GO TO 3999-END-EDIT
 16919     END-IF
 16920     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16921        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16922           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16923     IF WS-PAYMENT-AMT < 600.00
 16924        GO TO 3999-END-EDIT
 16925     END-IF
 16926     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16927
 16928     IF (ERMAIL-FOUND = ' ')
 16929         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16930         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16931        GO TO 3999-END-EDIT
 16932     END-IF
 16933     MOVE ER-2795                TO WS-ERROR
 16934     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16935
 16936     GO TO 3999-END-EDIT.
 16937******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 306
* EL050.cbl
 16939 3990-FILES-NOT-OPEN.
 16940
 16941     MOVE ER-2617                TO WS-ERROR.
 16942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16943     GO TO 9990-RETURN.
 16944
 16945 3999-END-EDIT.
 16946
 16947     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16948
 16949     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16950         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16951         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16952             PERFORM 9250-UNLOCK-RETURN
 16953             GO TO 9990-RETURN
 16954          ELSE
 16955             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16956             GO TO 9990-RETURN.
 16957
 16958     IF PB-CANCELLATION
 16959          GO TO 9990-RETURN.
 16960
 16961     IF CERT-WAS-NOT-FOUND
 16962        MOVE SPACES              TO CERTIFICATE-MASTER.
 16963
 16964     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16965
 16966     IF CERT-WAS-FOUND
 16967         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16968             PERFORM 9250-UNLOCK-RETURN
 16969          ELSE
 16970            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16971      ELSE
 16972         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16973
 16974     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16975        IF PB-COMPANY-ID = 'DCC' AND
 16976           (PB-CARRIER = '2' OR '4' OR '6')
 16977              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16978        END-IF
 16979     END-IF.
 16980
 16981     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16982         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16983     END-IF.
 16984     move ' '                    to ws-ins-age-defaulted
 16985     perform 8150-read-elcrtt    thru 8150-exit
 16986     if ws-ins-age-defaulted = 'Y'
 16987        move er-1573             to ws-error
 16988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16989     end-if
 16990
 16991     if ws-jnt-age-defaulted = 'Y'
 16992        move er-1574             to ws-error
 16993        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16994     end-if
 16995
 16996     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 307
* EL050.cbl
 16997     IF ((PB-COMPANY-ID = 'DCC')
 16998        AND (WS-NO-SECURE-PAY))
 16999                  OR
 17000        (WS-LF-SPECIAL-CALC-CD = 'O'
 17001        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17002        SET SKIP-ADDR-EDIT       TO TRUE
 17003     END-IF
 17004     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17005        AND (NOT SKIP-ADDR-EDIT)
 17006        MOVE ER-2963             TO WS-ERROR
 17007        PERFORM 9900-ERROR-FORMAT
 17008                                 THRU 9900-EXIT
 17009        GO TO 9990-RETURN
 17010     END-IF
 17011     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17012     IF ERPNDM-FOUND NOT = 'X'
 17013        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17014           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17015           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17016           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17017           AND (NOT SKIP-ADDR-EDIT)
 17018           MOVE ER-2694          TO WS-ERROR
 17019           PERFORM 9900-ERROR-FORMAT
 17020                                 THRU 9900-EXIT
 17021        END-IF
 17022        MOVE ' '                 TO STATE-RECORD-ERROR
 17023        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17024        MOVE PM-STATE            TO CNTL-ACCESS
 17025        MOVE '3'                 TO CNTL-REC-TYPE
 17026        MOVE +0                  TO CNTL-SEQ-NO
 17027        MOVE '0'                 TO RC-SW-2
 17028        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17029        IF (NO-STATE-RECORD)
 17030           OR (CF-RECORD-TYPE NOT = '3')
 17031           OR (PM-STATE NOT = CF-STATE-CODE)
 17032           IF (PM-STATE = SPACES)
 17033              AND (SKIP-ADDR-EDIT)
 17034              CONTINUE
 17035           ELSE
 17036              MOVE ER-2963       TO WS-ERROR
 17037              PERFORM 9900-ERROR-FORMAT
 17038                                 THRU 9900-EXIT
 17039           END-IF
 17040        END-IF
 17041        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17042           MOVE ER-2883          TO WS-ERROR
 17043           PERFORM 9900-ERROR-FORMAT
 17044                                 THRU 9900-EXIT
 17045        END-IF
 17046        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17047           MOVE ' '                 TO STATE-RECORD-ERROR
 17048           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17049           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17050           MOVE '3'                 TO CNTL-REC-TYPE
 17051           MOVE +0                  TO CNTL-SEQ-NO
 17052           MOVE '0'                 TO RC-SW-2
 17053           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17054           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 308
* EL050.cbl
 17055              OR (CF-RECORD-TYPE NOT = '3')
 17056              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17057              MOVE ER-2964          TO WS-ERROR
 17058              PERFORM 9900-ERROR-FORMAT
 17059                                    THRU 9900-EXIT
 17060           END-IF
 17061        END-IF
 17062     ELSE
 17063        IF NOT SKIP-ADDR-EDIT
 17064           MOVE ER-2393          TO WS-ERROR
 17065           PERFORM 9900-ERROR-FORMAT
 17066                                 THRU 9900-EXIT
 17067        END-IF
 17068     END-IF
 17069
 17070     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17071
 17072     IF (ERMAIL-FOUND = ' ' AND
 17073        ERPNDM-FOUND = ' ')
 17074        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17075           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17076           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17077          OR
 17078           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17079          OR
 17080           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17081           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17082           GO TO 3999-UNLOCK-ERMAIL.
 17083
 17084     IF ERPNDM-FOUND = 'X'
 17085        GO TO 3999-UNLOCK-ERMAIL.
 17086
 17087     IF PM-INSURED-LAST-NAME      = SPACES
 17088        AND PM-INSURED-FIRST-NAME = SPACES
 17089        AND PM-ADDRESS-LINE-1     = SPACES
 17090        AND PM-ADDRESS-LINE-2     = SPACES
 17091        AND PM-CITY-STATE         = SPACES
 17092        AND PM-CRED-BENE-NAME     = SPACES
 17093        AND PM-CRED-BENE-ADDR     = SPACES
 17094        AND PM-CRED-BENE-CTYST    = SPACES
 17095        GO TO 3999-UNLOCK-ERMAIL
 17096     END-IF
 17097
 17098     MOVE SPACES                 TO MAILING-DATA.
 17099
 17100     MOVE 'MA'                   TO MA-RECORD-ID.
 17101     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17102     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17103     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17104     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17105     MOVE PB-SV-STATE            TO MA-STATE.
 17106     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17107     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17108
 17109     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17110     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17111
 17112     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 309
* EL050.cbl
 17113        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17114     ELSE
 17115        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17116        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17117        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17118
 17119     GO TO 9990-RETURN.
 17120
 17121 3999-UNLOCK-ERMAIL.
 17122     IF ERMAIL-FOUND = ' '
 17123        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17124
 17125     GO TO 9990-RETURN.
 17126******************************************************************
 17127
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 310
* EL050.cbl
 17129 4000-UPDATE-CANCELLED-CERT.
 17130     IF CERT-WAS-NOT-FOUND
 17131        GO TO 4299-EXIT.
 17132
 17133*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17134     IF PB-C-NH-INT-ON-REFS > ZEROS
 17135        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17136     END-IF
 17137     IF PB-C-REF-INTERFACE-SW = 'Y'
 17138        MOVE PB-C-REF-INTERFACE-SW
 17139                                 TO CM-NH-INTERFACE-SW
 17140     END-IF
 17141     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17142     IF ERMAIL-FOUND = 'X'
 17143        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17144        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17145        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17146        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17147           MOVE ER-2694          TO WS-ERROR
 17148           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17149     END-IF
 17150
 17151     IF PB-C-POST-CARD-IND = 'Y'
 17152        MOVE +8                  TO SUB
 17153*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17154        IF ERMAIL-FOUND = ' '
 17155           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17156              (SUB > +7)
 17157              OR (MA-MAIL-STATUS (SUB) = '1')
 17158           END-PERFORM
 17159        END-IF
 17160        IF (SUB > +7)
 17161           OR (ERMAIL-FOUND = 'X')
 17162           MOVE ER-3789          TO WS-ERROR
 17163           PERFORM 9900-ERROR-FORMAT
 17164                                 THRU 9900-EXIT
 17165        END-IF
 17166     ELSE
 17167        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17168     END-IF
 17169
 17170     IF ERMAIL-FOUND = ' '
 17171        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17172     END-IF.
 17173
 17174     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17175
 17176     IF PB-CI-OB-FLAG = 'Z'
 17177        GO TO 4150-SUMMARY-CERT-CANCEL.
 17178
 17179     IF PB-C-LF-CANCEL-VOIDED
 17180         PERFORM 4200-REVERSE-LF-CANCEL.
 17181     IF PB-C-AH-CANCEL-VOIDED
 17182         PERFORM 4200-REVERSE-AH-CANCEL.
 17183
 17184 4100-APPLY-LF-CANCEL.
 17185
 17186     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 311
* EL050.cbl
 17187
 17188 4100-CHECK-LF-ERRORS.
 17189
 17190     ADD +1                       TO WS-SUB.
 17191
 17192     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17193        IF LF-COVERAGE-CANCELLED
 17194           GO TO 4100-LF-CANCEL-CONT
 17195        ELSE
 17196           GO TO 4100-UPDATE-LF-COVERAGE.
 17197
 17198     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17199                                   ER-2729 OR
 17200                                   ER-2730 OR
 17201                                   ER-2731 OR
 17202                                   ER-2732 OR
 17203                                   ER-2737 OR
 17204                                   ER-2740 OR
 17205                                   ER-2743 OR
 17206                                   ER-2749 OR
 17207                                   ER-2750 OR
 17208                                   ER-2755 OR
 17209                                   ER-2757 OR
 17210                                   ER-2760 OR
 17211                                   ER-2772 OR
 17212                                   ER-2774 OR
 17213                                   ER-2776 OR
 17214                                   ER-2794
 17215        GO TO 4100-UPDATE-LF-COVERAGE.
 17216
 17217     GO TO 4100-CHECK-LF-ERRORS.
 17218
 17219 4100-UPDATE-LF-COVERAGE.
 17220
 17221     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17222     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17223     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17224        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17225     END-IF
 17226     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17227                                      TO CM-CREDIT-INTERFACE-SW-2.
 17228     IF CM-LF-CANCEL-DT = LOW-VALUE
 17229         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17230
 17231     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17232         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17233                                         CM-LF-STATUS-AT-CANCEL.
 17234
 17235     GO TO 4100-APPLY-AH-CANCEL.
 17236
 17237 4100-LF-CANCEL-CONT.
 17238     IF PB-C-LF-CANCEL-VOIDED
 17239         GO TO 4100-APPLY-AH-CANCEL.
 17240
 17241     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17242         GO TO 4100-APPLY-AH-CANCEL.
 17243
 17244     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 312
* EL050.cbl
 17245        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17246           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17247        ELSE
 17248           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17249
 17250     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17251     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17252
 17253     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17254         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17255
 17256     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17257        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17258         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17259         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17260
 17261     IF PB-RECORD-RETURNED
 17262        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17263      ELSE
 17264        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17265
 17266 4100-APPLY-AH-CANCEL.
 17267
 17268     MOVE +0                      TO WS-SUB.
 17269
 17270 4100-CHECK-AH-ERRORS.
 17271
 17272     ADD +1                       TO WS-SUB.
 17273
 17274     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17275        IF AH-COVERAGE-CANCELLED
 17276           GO TO 4100-AH-CANCEL-CONT
 17277        ELSE
 17278           GO TO 4100-UPDATE-AH-COVERAGE.
 17279
 17280     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17281                                   ER-2729 OR
 17282                                   ER-2732 OR
 17283                                   ER-2737 OR
 17284                                   ER-2740 OR
 17285                                   ER-2744 OR
 17286                                   ER-2749 OR
 17287                                   ER-2750 OR
 17288                                   ER-2755 OR
 17289                                   ER-2757 OR
 17290                                   ER-2760 OR
 17291                                   ER-2771 OR
 17292                                   ER-2772 OR
 17293                                   ER-2773 OR
 17294                                   ER-2775 OR
 17295                                   ER-2777 OR
 17296                                   ER-2794
 17297        GO TO 4100-UPDATE-AH-COVERAGE.
 17298
 17299     GO TO 4100-CHECK-AH-ERRORS.
 17300
 17301 4100-UPDATE-AH-COVERAGE.
 17302
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 313
* EL050.cbl
 17303     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17304     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17305     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17306     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17307                                      TO CM-CREDIT-INTERFACE-SW-2.
 17308     IF CM-AH-CANCEL-DT = LOW-VALUE
 17309         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17310
 17311     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17312         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17313                                         CM-AH-STATUS-AT-CANCEL.
 17314
 17315     IF LF-COVERAGE-CANCELLED
 17316         IF PB-RECORD-RETURNED
 17317              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17318          ELSE
 17319              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17320
 17321     GO TO 4299-EXIT.
 17322
 17323 4100-AH-CANCEL-CONT.
 17324     IF PB-C-AH-CANCEL-VOIDED
 17325         GO TO 4299-EXIT.
 17326
 17327     if cm-credit-interface-sw-2 = ' '
 17328        if pb-fatal-errors or pb-unforced-errors
 17329           move '4'              to cm-credit-interface-sw-2
 17330        else
 17331           move '1'              to cm-credit-interface-sw-2
 17332        end-if
 17333     end-if
 17334     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17335         GO TO 4299-EXIT.
 17336
 17337     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17338        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17339           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17340        ELSE
 17341           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17342
 17343     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17344     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17345
 17346     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17347         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17348
 17349     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17350         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17351         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17352
 17353     IF PB-RECORD-RETURNED
 17354        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17355      ELSE
 17356        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17357
 17358     GO TO 4299-EXIT.
 17359
 17360 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 314
* EL050.cbl
 17361     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17362
 17363     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17364        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17365                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17366     ELSE
 17367        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17368                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17369
 17370     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17371        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17372                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17373     ELSE
 17374        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17375                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17376
 17377     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17378        NEXT SENTENCE
 17379     ELSE
 17380        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17381
 17382     GO TO 4299-EXIT.
 17383
 17384 4200-REVERSE-LF-CANCEL.
 17385     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17386
 17387     IF CM-LF-CANCEL-APPLIED
 17388        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17389        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17390        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17391
 17392     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17393
 17394     IF PB-RECORD-RETURNED
 17395        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17396       ELSE
 17397        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17398
 17399 4200-REVERSE-LF-EXIT.
 17400       EXIT.
 17401
 17402 4200-REVERSE-AH-CANCEL.
 17403     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17404
 17405     IF CM-AH-CANCEL-APPLIED
 17406        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17407        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17408        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17409
 17410     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17411
 17412     IF PB-RECORD-RETURNED
 17413        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17414       ELSE
 17415        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17416
 17417 4200-REVERSE-AH-EXIT.
 17418       EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 315
* EL050.cbl
 17419
 17420 4299-EXIT.
 17421       EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 316
* EL050.cbl
 17423
 17424 4500-UPDATE-NEW-CERT.
 17425     IF CERT-WAS-FOUND
 17426         NEXT SENTENCE
 17427       ELSE
 17428         GO TO 4520-BUILD-NEW-KEY.
 17429
 17430     IF  CLASIC-CREATED-CERT
 17431         GO TO 4999-EXIT.
 17432
 17433     IF  CERT-WAS-CREATED-FOR-CLAIM
 17434         GO TO 4520-BUILD-NEW-KEY.
 17435
 17436     IF CERT-ADDED-BATCH
 17437        IF CM-RECORD-ID = 'CM'
 17438            GO TO 4999-EXIT.
 17439
 17440 4520-BUILD-NEW-KEY.
 17441* BUILD CONTROL PRIMARY
 17442
 17443     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17444                                       CM-COMPANY-CD-A1
 17445                                       CM-COMPANY-CD-A2
 17446                                       CM-COMPANY-CD-A4
 17447                                       CM-COMPANY-CD-A5.
 17448
 17449     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17450     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17451     MOVE PB-SV-STATE               TO CM-STATE.
 17452     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17453     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17454     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17455     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17456
 17457     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17458
 17459     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17460     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17461     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17462     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17463
 17464     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17465        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17466
 17467     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17468         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17469         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17470         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17471         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17472     ELSE
 17473         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17474
 17475     IF PB-COMPANY-ID   EQUAL  'CRI'
 17476         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17477         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17478         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17479         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17480         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 317
* EL050.cbl
 17481
 17482     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17483        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17484         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17485
 17486     IF PB-COMPANY-ID  = 'LBL'
 17487        IF PB-I-JOINT-COVERAGE
 17488            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17489                                           PB-I-MEMBER-NO
 17490            GO TO 4550-CONT-CERT-PROCESS.
 17491
 17492     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17493        NEXT SENTENCE
 17494     ELSE
 17495        GO TO 4540-BUILD-MEMBER-NO.
 17496
 17497******************************************************************
 17498*                                                                *
 17499*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17500*    FOR 'MON'.                                                  *
 17501*                                                                *
 17502******************************************************************
 17503
 17504     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17505     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17506     MOVE +1                     TO WS-SUB1
 17507                                    WS-SUB2.
 17508
 17509 4530-EDIT-MEMB-NAME.
 17510
 17511     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17512        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17513        ADD +1                       TO WS-SUB2.
 17514
 17515     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17516        ADD +1                       TO WS-SUB1
 17517        GO TO 4530-EDIT-MEMB-NAME.
 17518
 17519     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17520     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17521     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17522*    MOVE SPACE                      TO DC-OPTION-CODE.
 17523     SET  BIN-TO-GREG                TO TRUE.
 17524     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17525     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17526
 17527     GO TO 4550-CONT-CERT-PROCESS.
 17528
 17529******************************************************************
 17530*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17531******************************************************************
 17532
 17533 4540-BUILD-MEMBER-NO.
 17534
 17535     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17536         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17537         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17538         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 318
* EL050.cbl
 17539         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17540     ELSE
 17541         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17542
 17543     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17544        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17545         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17546
 17547 4550-CONT-CERT-PROCESS.
 17548
 17549*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17550*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17551*    ELSE
 17552*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17553
 17554     IF CERT-WAS-CREATED-FOR-CLAIM
 17555        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17556        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17557
 17558     IF CERT-AND-CLAIM-ONLINE
 17559        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17560        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17561
 17562     MOVE 'CM'                     TO CM-RECORD-ID.
 17563     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17564
 17565     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17566        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17567        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17568     ELSE
 17569        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17570        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17571
 17572     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17573     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17574     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17575     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17576     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17577     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17578     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17579                                      CM-LF-ITD-CANCEL-AMT
 17580                                      CM-LF-ITD-DEATH-AMT
 17581                                      CM-AH-ITD-AH-PMT
 17582                                      CM-AH-ITD-LUMP-PMT
 17583                                      CM-AH-ITD-CANCEL-AMT
 17584                                      CM-LF-NSP-PREMIUM-AMT
 17585                                      CM-AH-NSP-PREMIUM-AMT.
 17586*                                     CM-CLAIM-DEDUCT-WITHHELD
 17587*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17588     if pb-i-loan-apr = +99.9999
 17589        move zeros                 to cm-loan-apr
 17590     else
 17591        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17592     end-if
 17593     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17594     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17595     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17596     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 319
* EL050.cbl
 17597     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17598     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17599     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17600     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17601     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17602     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17603     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17604
 17605     IF PB-I-LIVES NOT NUMERIC
 17606         MOVE ZERO                 TO PB-I-LIVES.
 17607
 17608     IF PB-I-NUM-BILLED NOT NUMERIC
 17609         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17610
 17611     MOVE PB-I-LIVES               TO CM-LIVES.
 17612     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17613
 17614     IF PB-COMPANY-ID EQUAL  'DMD'
 17615         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17616         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17617
 17618     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17619     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17620     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17621     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17622     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17623     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17624
 17625     IF PB-I-LF-POLICY-FEE NUMERIC
 17626        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17627     ELSE
 17628        MOVE +0                    TO CM-LF-POLICY-FEE.
 17629
 17630     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17631        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17632        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17633     ELSE
 17634        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17635
 17636     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17637     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17638     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17639     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17640     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17641     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17642     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17643     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17644     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17645
 17646     IF PB-I-AH-POLICY-FEE NUMERIC
 17647        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17648     ELSE
 17649        MOVE +0                    TO CM-AH-POLICY-FEE.
 17650
 17651     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17652        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17653     ELSE
 17654        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 320
* EL050.cbl
 17655
 17656     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17657     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17658
 17659     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17660                                      CM-LF-DEATH-EXIT-DT
 17661                                      CM-AH-SETTLEMENT-EXIT-DT.
 17662
 17663*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17664*                       'TIH' OR 'OFL' OR 'FLA' OR
 17665*                       'TII' OR 'TMS' OR 'CRI' OR
 17666*                       'NCL'
 17667     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17668
 17669     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17670         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17671            MOVE '2'                TO CM-PREMIUM-TYPE.
 17672
 17673     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17674         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17675            MOVE '2'                TO CM-PREMIUM-TYPE.
 17676
 17677     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17678         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17679     ELSE
 17680         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17681         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17682
 17683     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17684     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17685     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17686     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17687     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17688     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17689     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17690     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17691
 17692     IF PB-NO-MONTHS-SKIPPED
 17693         MOVE SPACE                 TO CM-SKIP-CODE
 17694     ELSE
 17695         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17696
 17697     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17698     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17699                                       CM-LF-STATUS-AT-CANCEL.
 17700
 17701     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17702     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17703                                       CM-AH-STATUS-AT-CANCEL.
 17704
 17705     MOVE '1'                       TO CM-ENTRY-STATUS.
 17706
 17707     IF PB-REISSUED-CERT
 17708        MOVE '5'                    TO CM-ENTRY-STATUS.
 17709
 17710     IF PB-MONTHLY-CERT
 17711        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17712
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 321
* EL050.cbl
 17713     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17714     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17715     IF PB-POLICY-IS-DECLINED
 17716        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17717
 17718     IF PB-POLICY-IS-VOIDED
 17719        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17720
 17721     IF PB-NEEDS-UNDERWRITING
 17722        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17723
 17724     IF PB-REIN-ONLY-CERT
 17725        MOVE '9'                    TO CM-ENTRY-STATUS.
 17726
 17727     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17728         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17729     ELSE
 17730         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17731
 17732     IF PB-RECORD-RETURNED
 17733        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17734      ELSE
 17735        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17736
 17737     IF PB-I-MAIL-ADDRS-PRESENT
 17738        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17739
 17740     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17741                                       CM-ENTRY-DT.
 17742
 17743 4999-EXIT.
 17744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 322
* EL050.cbl
 17746
 17747 5000-PROCESS-REPS.
 17748     MOVE ' '                    TO AGTC-MASTER-SW
 17749     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17750     MOVE CO-TYPE                TO AGTC-TYPE
 17751     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17752     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17753     IF (AGTC-MASTER-SW NOT = 'N')
 17754        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17755        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17756        PERFORM 8583-READ-ERAGTC-NEXT
 17757                                 THRU 8583-EXIT
 17758     END-IF
 17759     IF AGTC-MASTER-SW = 'N'
 17760        CONTINUE
 17761     ELSE
 17762        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17763           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17764              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17765              MOVE 'Y'           TO AGTC-MASTER-SW
 17766           END-IF
 17767        END-IF
 17768     END-IF
 17769     .
 17770 5000-EXIT.
 17771     EXIT.
 17772 6370-EDIT-INPUT-LF-CODE.
 17773     move ' ' to ws-benefit-cd-chg-sw
 17774     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17775        MOVE +1                  TO SUB
 17776        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17777        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17778        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17779        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17780        GO TO 6370-SEARCH-LOOP.
 17781
 17782     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17783
 17784     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17785     MOVE SPACES                 TO CNTL-ACCESS.
 17786*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17787     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17788     MOVE +0                     TO CNTL-SEQ-NO.
 17789     MOVE '4' TO RC-SW-2.
 17790     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17791
 17792     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17793        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17794        GO TO 6370-NO-LF-FOUND.
 17795
 17796     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17797     MOVE +1                     TO SUB.
 17798
 17799 6370-SEARCH-LOOP.
 17800     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17801         GO TO 6370-NO-LF-FOUND.
 17802
 17803     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 323
* EL050.cbl
 17804        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17805           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17806           set benefit-code-chg to true
 17807        end-if
 17808        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17809        GO TO 6370-HER-NET-PAY-CHECK.
 17810
 17811     ADD 1   TO SUB.
 17812*    IF SUB GREATER 120
 17813     IF SUB GREATER 200
 17814         GO TO 6370-NO-LF-FOUND.
 17815
 17816     GO TO 6370-SEARCH-LOOP.
 17817
 17818 6370-NO-LF-FOUND.
 17819
 17820     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17821        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17822        set benefit-code-chg to true
 17823     end-if
 17824     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17825
 17826 6370-HER-NET-PAY-CHECK.
 17827
 17828     IF PB-COMPANY-ID = 'CID'
 17829        IF PB-SV-STATE = 'CA' OR 'MN'
 17830           IF PB-I-LF-BENEFIT-CD = '02'
 17831              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17832           ELSE
 17833              IF PB-I-LF-BENEFIT-CD = '04'
 17834                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17835              END-IF
 17836           END-IF
 17837        END-IF
 17838     END-IF
 17839
 17840     IF PB-COMPANY-ID NOT = 'HER'
 17841         GO TO 6370-EXIT.
 17842
 17843     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17844         GO TO 6370-EXIT.
 17845
 17846     IF PB-I-LF-TERM NOT NUMERIC
 17847         MOVE ZEROS              TO PB-I-LF-TERM.
 17848
 17849     IF PB-I-LOAN-TERM NOT NUMERIC
 17850         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17851
 17852     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17853         GO TO 6370-EXIT.
 17854
 17855     IF PB-I-LF-BENEFIT-CD = '33'
 17856         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17857
 17858     IF PB-I-LF-BENEFIT-CD = '34'
 17859         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17860
 17861 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 324
* EL050.cbl
 17862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 325
* EL050.cbl
 17864
 17865 6380-EDIT-INPUT-AH-CODE.
 17866     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17867        MOVE +1                  TO SUB
 17868        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17869        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17870        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17871        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17872        GO TO 6380-SEARCH-LOOP.
 17873
 17874     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17875
 17876     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17877     MOVE SPACES                 TO CNTL-ACCESS.
 17878     MOVE 'A'                    TO CNTL-REC-TYPE.
 17879*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17880     MOVE +0                     TO CNTL-SEQ-NO.
 17881     MOVE '5' TO RC-SW-2.
 17882     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17883
 17884     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17885        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17886        GO TO 6380-NO-AH-FOUND.
 17887
 17888     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17889     MOVE +1 TO SUB.
 17890
 17891 6380-SEARCH-LOOP.
 17892     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17893         GO TO 6380-NO-AH-FOUND.
 17894
 17895     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17896         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17897         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17898
 17899     ADD 1   TO SUB.
 17900     IF SUB GREATER THAN 96
 17901*    IF SUB GREATER THAN 300
 17902         GO TO 6380-NO-AH-FOUND.
 17903
 17904     GO TO 6380-SEARCH-LOOP.
 17905
 17906 6380-NO-AH-FOUND.
 17907
 17908     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17909
 17910     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17911         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17912     ELSE
 17913         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17914
 17915 6380-CSO-AH-ONLY-CHECKS.
 17916
 17917     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17918        NEXT SENTENCE
 17919      ELSE
 17920        GO TO 6380-EXIT.
 17921
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 326
* EL050.cbl
 17922     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17923         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17924
 17925
 17926     GO TO 6380-EXIT
 17927     .
 17928 6380-CSO-LIFE-WITH-AH-CHECKS.
 17929
 17930
 17931     .
 17932 6380-EXIT.
 17933     EXIT.
 17934
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 327
* EL050.cbl
 17936
 17937 6400-COMPUTE-EXTENSION-DAYS.
 17938
 17939******************************************************************
 17940*                                                                *
 17941*                   COMPUTE EXTENSION DAYS                       *
 17942*                                                                *
 17943*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17944*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17945*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17946*    THE EXTENSION DAYS.                                         *
 17947*                                                                *
 17948******************************************************************
 17949
 17950     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17951     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17952
 17953******************************************************************
 17954*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17955*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17956******************************************************************
 17957
 17958     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17959        COMPUTE WS-ODD-DAYS-OVER =
 17960               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17961     ELSE
 17962        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17963
 17964     IF WS-ODD-DAYS-OVER = ZEROS
 17965           GO TO 6499-EXIT
 17966     ELSE
 17967        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17968           IF WS-WDF-MONTH = 02
 17969              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17970              ADD 2       TO  WS-ODD-DAYS-OVER
 17971              GO TO 6499-EXIT
 17972           ELSE
 17973              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17974                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17975                 GO TO 6499-EXIT
 17976               ELSE
 17977                 GO TO 6499-EXIT
 17978        ELSE
 17979           GO TO 6499-EXIT.
 17980
 17981 6412-CHECK-TO-DAY.
 17982
 17983        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17984           IF WS-WDT-DAY = 28
 17985              ADD 2              TO WS-ODD-DAYS-OVER
 17986           ELSE
 17987              IF WS-WDT-DAY = 29
 17988                 ADD 1           TO WS-ODD-DAYS-OVER
 17989              ELSE
 17990                 NEXT SENTENCE
 17991        ELSE
 17992           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17993              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 328
* EL050.cbl
 17994
 17995     GO TO 6499-EXIT.
 17996
 17997
 17998 6415-CHECK-LEAP-YEAR.
 17999
 18000     IF DC-DAYS-IN-MONTH = 29
 18001        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18002
 18003 6415-EXIT.
 18004     EXIT.
 18005
 18006 6499-EXIT.
 18007      EXIT.
 18008
 18009 6500-END.
 18010     EXIT.
 18011
 18012
 18013******************************************************************
 18014************* PROCEDURE DIVISION FOR EL050 ***********************
 18015********************** ELC50PD END *******************************
 18016
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 329
* EL050.cbl
 18018
 18019**START***********************************************************
 18020*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18021*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18022******************************************************************
 18023*
 18024 6600-GET-STATE-MUNICIPAL-TAX.
 18025
 18026     IF PB-COMPANY-ID NOT = 'DMD'
 18027         GO TO 6640-EXIT.
 18028
 18029     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18030     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18031     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18032*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18033*
 18034***  Y2K PROJ 7744
 18035     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18036     SET BIN-TO-GREG          TO TRUE.
 18037     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18038
 18039     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18040
 18041     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18042     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18043
 18044
 18045* EXEC CICS HANDLE CONDITION
 18046*        INVREQ    (6610-START-BROWSE)
 18047*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18048*        NOTFND    (6630-END-OF-FILE)
 18049*    END-EXEC.
 18050*    MOVE '"$8JI                 ! # #00018032' TO DFHEIV0
 18051     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18053     MOVE X'2320233030303138303332' TO DFHEIV0(25:11)
 18054     CALL 'kxdfhei1' USING DFHEIV0
 18055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18056
 18057
 18058 6610-START-BROWSE.
 18059
 18060
 18061* EXEC CICS HANDLE CONDITION
 18062*        NOTFND    (6630-END-OF-FILE)
 18063*        DISABLED  (6630-ERRESS-PROBLEM)
 18064*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18065*        ENDFILE   (6630-END-OF-FILE)
 18066*    END-EXEC.
 18067*    MOVE '"$IcJ''                ! $ #00018040' TO DFHEIV0
 18068     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18070     MOVE X'2420233030303138303430' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0
 18072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18073
 18074
 18075
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 330
* EL050.cbl
 18076* EXEC CICS STARTBR
 18077*        DATASET (FILE-ID-ERRESS)
 18078*        RIDFLD  (WS-ERRESS-KEY)
 18079*        GTEQ
 18080*    END-EXEC.
 18081     MOVE 0
 18082       TO DFHEIV11
 18083*    MOVE '&,         G          &   #00018047' TO DFHEIV0
 18084     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18085     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18086     MOVE X'2020233030303138303437' TO DFHEIV0(25:11)
 18087     CALL 'kxdfhei1' USING DFHEIV0,
 18088           FILE-ID-ERRESS,
 18089           WS-ERRESS-KEY,
 18090           DFHEIV99,
 18091           DFHEIV11,
 18092           DFHEIV99
 18093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18094
 18095
 18096 6620-READ-NEXT-ERRESS-MASTER.
 18097
 18098
 18099* EXEC CICS HANDLE CONDITION
 18100*        NOTFND    (6630-END-OF-FILE)
 18101*        ENDFILE   (6630-END-OF-FILE)
 18102*        DISABLED  (6630-ERRESS-PROBLEM)
 18103*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18104*    END-EXEC.
 18105*    MOVE '"$I''cJ                ! % #00018055' TO DFHEIV0
 18106     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18108     MOVE X'2520233030303138303535' TO DFHEIV0(25:11)
 18109     CALL 'kxdfhei1' USING DFHEIV0
 18110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18111
 18112
 18113
 18114* EXEC CICS READNEXT
 18115*        DATASET (FILE-ID-ERRESS)
 18116*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18117*        RIDFLD  (WS-ERRESS-KEY)
 18118*    END-EXEC.
 18119     MOVE LENGTH OF
 18120      RESIDENT-STATE-TAX-MASTER
 18121       TO DFHEIV12
 18122     MOVE 0
 18123       TO DFHEIV11
 18124*    MOVE '&.IL                  )   #00018062' TO DFHEIV0
 18125     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18126     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18127     MOVE X'2020233030303138303632' TO DFHEIV0(25:11)
 18128     CALL 'kxdfhei1' USING DFHEIV0,
 18129           FILE-ID-ERRESS,
 18130           RESIDENT-STATE-TAX-MASTER,
 18131           DFHEIV12,
 18132           WS-ERRESS-KEY,
 18133           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 331
* EL050.cbl
 18134           DFHEIV11,
 18135           DFHEIV99,
 18136           DFHEIV99
 18137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18138
 18139
 18140     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18141
 18142* EXEC CICS ENDBR
 18143*            DATASET (FILE-ID-ERRESS)
 18144*       END-EXEC
 18145     MOVE 0
 18146       TO DFHEIV11
 18147*    MOVE '&2                    $   #00018069' TO DFHEIV0
 18148     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18149     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18150     MOVE X'2020233030303138303639' TO DFHEIV0(25:11)
 18151     CALL 'kxdfhei1' USING DFHEIV0,
 18152           FILE-ID-ERRESS,
 18153           DFHEIV11,
 18154           DFHEIV99
 18155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18156        GO TO 6630-END-OF-FILE.
 18157
 18158     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18159        NEXT SENTENCE
 18160      ELSE
 18161        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18162
 18163*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18164*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18165*
 18166     MOVE +2                     TO WS-SUB1.
 18167
 18168     IF PB-ISSUE
 18169     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18170        MOVE +1                  TO WS-SUB1.
 18171
 18172     IF PB-CANCELLATION
 18173     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18174        MOVE +1                  TO WS-SUB1.
 18175*
 18176*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18177*
 18178***  Y2K PROJ 7744
 18179     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18180***  Y2K PROJ 7744
 18181
 18182*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18183* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18184* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18185
 18186     ADD 1                    TO WS-YEAR-YY.
 18187
 18188     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18189         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18190                              TO WS-RES-STATE-TAX
 18191         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 332
* EL050.cbl
 18192                              TO WS-RES-MUNI-TAX
 18193     ELSE
 18194         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18195                              TO WS-RES-STATE-TAX
 18196         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18197                              TO WS-RES-MUNI-TAX.
 18198
 18199*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18200
 18201     IF PB-CANCELLATION
 18202         GO TO 6640-CANCEL-TAX.
 18203
 18204     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18205         COMPUTE PB-I-STATE-TAX ROUNDED =
 18206                                   PB-I-LF-PREMIUM-AMT
 18207                                 * WS-RES-STATE-TAX
 18208         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18209                                   PB-I-LF-PREMIUM-AMT
 18210                                 * WS-RES-MUNI-TAX
 18211     ELSE
 18212     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18213         COMPUTE PB-I-STATE-TAX ROUNDED =
 18214                                   PB-I-AH-PREMIUM-AMT
 18215                                 * WS-RES-STATE-TAX
 18216         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18217                                   PB-I-AH-PREMIUM-AMT
 18218                                 * WS-RES-MUNI-TAX.
 18219
 18220
 18221* EXEC CICS ENDBR
 18222*         DATASET (FILE-ID-ERRESS)
 18223*    END-EXEC.
 18224     MOVE 0
 18225       TO DFHEIV11
 18226*    MOVE '&2                    $   #00018136' TO DFHEIV0
 18227     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18228     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18229     MOVE X'2020233030303138313336' TO DFHEIV0(25:11)
 18230     CALL 'kxdfhei1' USING DFHEIV0,
 18231           FILE-ID-ERRESS,
 18232           DFHEIV11,
 18233           DFHEIV99
 18234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18235
 18236
 18237     GO TO 6640-EXIT.
 18238
 18239 6640-CANCEL-TAX.
 18240     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18241
 18242     IF PB-C-LF-CANCEL-AMT > ZEROS
 18243         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18244                                   PB-C-LF-CANCEL-AMT
 18245                                 * WS-RES-STATE-TAX
 18246         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18247                                   PB-C-LF-CANCEL-AMT
 18248                                *  WS-RES-MUNI-TAX
 18249     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 333
* EL050.cbl
 18250     IF PB-C-AH-CANCEL-AMT > ZEROS
 18251         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18252                                   PB-C-AH-CANCEL-AMT
 18253                                 * WS-RES-STATE-TAX
 18254         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18255                                   PB-C-AH-CANCEL-AMT
 18256                                *  WS-RES-MUNI-TAX.
 18257
 18258
 18259* EXEC CICS ENDBR
 18260*         DATASET (FILE-ID-ERRESS)
 18261*    END-EXEC.
 18262     MOVE 0
 18263       TO DFHEIV11
 18264*    MOVE '&2                    $   #00018161' TO DFHEIV0
 18265     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18267     MOVE X'2020233030303138313631' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0,
 18269           FILE-ID-ERRESS,
 18270           DFHEIV11,
 18271           DFHEIV99
 18272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18273
 18274
 18275     GO TO 6640-EXIT.
 18276
 18277 6630-END-OF-FILE.
 18278     MOVE ER-8002              TO WS-ERROR.
 18279     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18280
 18281     GO TO 6640-EXIT.
 18282
 18283 6630-ERRESS-PROBLEM.
 18284     MOVE ER-8044              TO WS-ERROR.
 18285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18286
 18287 6640-EXIT.
 18288     EXIT.
 18289
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 334
* EL050.cbl
 18291 6650-GET-RES-STATE-COMM.
 18292
 18293     IF PB-COMPANY-ID NOT = 'DMD'
 18294         GO TO 6700-COMM-EXIT.
 18295
 18296     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18297     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18298     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18299     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18300     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18301     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18302     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18303
 18304*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18305*
 18306***  Y2K PROJ 7744
 18307     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18308     SET BIN-TO-GREG          TO TRUE.
 18309     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18310
 18311     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18312***  Y2K PROJ 7744
 18313
 18314     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18315
 18316
 18317* EXEC CICS HANDLE CONDITION
 18318*        INVREQ    (6660-START-BROWSE)
 18319*        DISABLED  (6690-ERRESC-PROBLEM)
 18320*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18321*        NOTFND    (6690-END-OF-FILE)
 18322*    END-EXEC.
 18323*    MOVE '"$8cJI                ! & #00018206' TO DFHEIV0
 18324     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18326     MOVE X'2620233030303138323036' TO DFHEIV0(25:11)
 18327     CALL 'kxdfhei1' USING DFHEIV0
 18328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18329
 18330
 18331
 18332* EXEC CICS RESETBR
 18333*        DATASET (FILE-ID-ERRESC)
 18334*        RIDFLD  (WS-ERRESC-KEY)
 18335*    END-EXEC.
 18336     MOVE 0
 18337       TO DFHEIV11
 18338*    MOVE '&4         G          &   #00018213' TO DFHEIV0
 18339     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18340     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18341     MOVE X'2020233030303138323133' TO DFHEIV0(25:11)
 18342     CALL 'kxdfhei1' USING DFHEIV0,
 18343           FILE-ID-ERRESC,
 18344           WS-ERRESC-KEY,
 18345           DFHEIV99,
 18346           DFHEIV11,
 18347           DFHEIV99
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 335
* EL050.cbl
 18349
 18350
 18351 6660-START-BROWSE.
 18352
 18353
 18354* EXEC CICS HANDLE CONDITION
 18355*        NOTFND    (6690-END-OF-FILE)
 18356*        DISABLED  (6690-ERRESC-PROBLEM)
 18357*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18358*        ENDFILE   (6690-END-OF-FILE)
 18359*    END-EXEC.
 18360*    MOVE '"$IcJ''                ! '' #00018220' TO DFHEIV0
 18361     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18363     MOVE X'2720233030303138323230' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0
 18365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18366
 18367
 18368
 18369* EXEC CICS STARTBR
 18370*        DATASET (FILE-ID-ERRESC)
 18371*        RIDFLD  (WS-ERRESC-KEY)
 18372*        GTEQ
 18373*    END-EXEC.
 18374     MOVE 0
 18375       TO DFHEIV11
 18376*    MOVE '&,         G          &   #00018227' TO DFHEIV0
 18377     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18378     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18379     MOVE X'2020233030303138323237' TO DFHEIV0(25:11)
 18380     CALL 'kxdfhei1' USING DFHEIV0,
 18381           FILE-ID-ERRESC,
 18382           WS-ERRESC-KEY,
 18383           DFHEIV99,
 18384           DFHEIV11,
 18385           DFHEIV99
 18386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18387
 18388
 18389     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18390
 18391 6670-READ-NEXT-ERRESC-MASTER.
 18392
 18393
 18394* EXEC CICS HANDLE CONDITION
 18395*        NOTFND    (6690-END-OF-FILE)
 18396*        DISABLED  (6690-ERRESC-PROBLEM)
 18397*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18398*        ENDFILE   (6690-END-OF-FILE)
 18399*    END-EXEC.
 18400*    MOVE '"$IcJ''                ! ( #00018237' TO DFHEIV0
 18401     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18403     MOVE X'2820233030303138323337' TO DFHEIV0(25:11)
 18404     CALL 'kxdfhei1' USING DFHEIV0
 18405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18406
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 336
* EL050.cbl
 18407
 18408
 18409* EXEC CICS READNEXT
 18410*        DATASET (FILE-ID-ERRESC)
 18411*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18412*        RIDFLD  (ERRESC-RECORD-KEY)
 18413*    END-EXEC.
 18414     MOVE LENGTH OF
 18415      ACCOUNT-RESIDENT-ST-COMMISSION
 18416       TO DFHEIV12
 18417     MOVE 0
 18418       TO DFHEIV11
 18419*    MOVE '&.IL                  )   #00018244' TO DFHEIV0
 18420     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18421     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18422     MOVE X'2020233030303138323434' TO DFHEIV0(25:11)
 18423     CALL 'kxdfhei1' USING DFHEIV0,
 18424           FILE-ID-ERRESC,
 18425           ACCOUNT-RESIDENT-ST-COMMISSION,
 18426           DFHEIV12,
 18427           ERRESC-RECORD-KEY,
 18428           DFHEIV99,
 18429           DFHEIV11,
 18430           DFHEIV99,
 18431           DFHEIV99
 18432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18433
 18434
 18435     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18436        NEXT SENTENCE
 18437     ELSE
 18438
 18439* EXEC CICS ENDBR
 18440*            DATASET (FILE-ID-ERRESC)
 18441*       END-EXEC
 18442     MOVE 0
 18443       TO DFHEIV11
 18444*    MOVE '&2                    $   #00018253' TO DFHEIV0
 18445     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18446     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18447     MOVE X'2020233030303138323533' TO DFHEIV0(25:11)
 18448     CALL 'kxdfhei1' USING DFHEIV0,
 18449           FILE-ID-ERRESC,
 18450           DFHEIV11,
 18451           DFHEIV99
 18452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18453        GO TO 6690-END-OF-FILE.
 18454
 18455     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18456
 18457* EXEC CICS ENDBR
 18458*            DATASET (FILE-ID-ERRESC)
 18459*       END-EXEC
 18460     MOVE 0
 18461       TO DFHEIV11
 18462*    MOVE '&2                    $   #00018259' TO DFHEIV0
 18463     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 337
* EL050.cbl
 18465     MOVE X'2020233030303138323539' TO DFHEIV0(25:11)
 18466     CALL 'kxdfhei1' USING DFHEIV0,
 18467           FILE-ID-ERRESC,
 18468           DFHEIV11,
 18469           DFHEIV99
 18470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18471        GO TO 6690-END-OF-FILE.
 18472
 18473     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18474        NEXT SENTENCE
 18475      ELSE
 18476        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18477
 18478* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18479*
 18480     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18481
 18482     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18483
 18484     IF WS-SUB1 > ZERO
 18485         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18486             PERFORM 6680-SET-COMMISSION
 18487         ELSE
 18488             PERFORM 6680-SET-TABLE-CODE.
 18489
 18490
 18491* EXEC CICS ENDBR
 18492*         DATASET (FILE-ID-ERRESC)
 18493*    END-EXEC.
 18494     MOVE 0
 18495       TO DFHEIV11
 18496*    MOVE '&2                    $   #00018281' TO DFHEIV0
 18497     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18498     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18499     MOVE X'2020233030303138323831' TO DFHEIV0(25:11)
 18500     CALL 'kxdfhei1' USING DFHEIV0,
 18501           FILE-ID-ERRESC,
 18502           DFHEIV11,
 18503           DFHEIV99
 18504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18505
 18506
 18507     GO TO 6700-COMM-EXIT.
 18508
 18509 6680-SET-TABLE-CODE.
 18510     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18511        MOVE ZEROS             TO WS-SUB1
 18512     ELSE
 18513* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18514* TO COMPUTE AH COMMISSION.
 18515        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18516        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18517        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18518        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18519        PERFORM 6680-READ-CTBL-TABLE
 18520        IF WS-CTBL-READ-SW NOT = 'Y'
 18521           MOVE ZEROS          TO WS-SUB1.
 18522
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 338
* EL050.cbl
 18523 6680-READ-CTBL-TABLE.
 18524*
 18525* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18526* TO COMPUTE LIFE COMMISSION
 18527
 18528     IF CTBL-SW = '0540'
 18529        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18530        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18531        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18532
 18533     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18534
 18535     IF CTBL-TABLE-FOUND
 18536        IF CTBL-SW = '0530'
 18537             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18538                                    * PB-I-AH-TERM
 18539             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18540             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18541        ELSE
 18542             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18543             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18544             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18545     ELSE
 18546        IF FIRST-TIME-THROUGH
 18547            GO TO 6680-READ-CTBL-TABLE
 18548        ELSE
 18549            MOVE ZEROS         TO WS-SUB1.
 18550
 18551 6680-SET-COMMISSION.
 18552     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18553           MOVE ZEROS          TO WS-SUB1
 18554       ELSE
 18555           MOVE RESC-COMMISSION-PER (WS-SUB)
 18556                               TO WS-COMMISSION
 18557           IF CTBL-SW = '0530'
 18558               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18559           ELSE
 18560               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18561
 18562 6680-SEARCH-CATEGORY.
 18563     ADD +1                   TO WS-SUB.
 18564     IF WS-SUB > +12
 18565         GO TO 6680-EXIT.
 18566
 18567     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18568          MOVE WS-SUB         TO WS-SUB1
 18569          GO TO 6680-EXIT.
 18570
 18571     GO TO 6680-SEARCH-CATEGORY.
 18572
 18573 6680-EXIT.
 18574     EXIT.
 18575
 18576 6690-END-OF-FILE.
 18577     GO TO 6700-COMM-EXIT.
 18578
 18579 6690-ERRESC-PROBLEM.
 18580      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 339
* EL050.cbl
 18581      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18582
 18583      GO TO 6700-COMM-EXIT.
 18584
 18585 6700-COMM-EXIT.
 18586     EXIT.
 18587
 18588 7000-GET-RATE.
 18589
 18590* EXEC CICS LINK
 18591*        PROGRAM    ('ELRATE')
 18592*        COMMAREA   (CALCULATION-PASS-AREA)
 18593*        LENGTH     (CP-COMM-LENGTH)
 18594*    END-EXEC.
 18595     MOVE 'ELRATE' TO DFHEIV1
 18596*    MOVE '."C                   (   #00018367' TO DFHEIV0
 18597     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18599     MOVE X'2020233030303138333637' TO DFHEIV0(25:11)
 18600     CALL 'kxdfhei1' USING DFHEIV0,
 18601           DFHEIV1,
 18602           CALCULATION-PASS-AREA,
 18603           CP-COMM-LENGTH,
 18604           DFHEIV99,
 18605           DFHEIV99,
 18606           DFHEIV99,
 18607           DFHEIV99
 18608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18609
 18610
 18611 7000-EXIT.
 18612     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 340
* EL050.cbl
 18614 7100-FIND-BENEFIT-IN-STATE.
 18615     MOVE 'N'                    TO BEN-SEARCH-SW.
 18616
 18617     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18618         VARYING SUB3 FROM 1 BY 1 UNTIL
 18619            ((SUB3 GREATER 50) OR
 18620              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18621               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18622
 18623     IF SUB3 NOT = 51
 18624         MOVE 'Y'                TO BEN-SEARCH-SW.
 18625
 18626     GO TO 7199-EXIT.
 18627
 18628 7100-BENEFIT-DUMMY.
 18629
 18630 7100-DUMMY-EXIT.
 18631     EXIT.
 18632
 18633 7199-EXIT.
 18634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 341
* EL050.cbl
 18636 7200-FIND-BENEFIT.
 18637     MOVE 'N'                    TO BEN-SEARCH-SW.
 18638
 18639     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18640         VARYING SUB3 FROM 1 BY 1 UNTIL
 18641            ((SUB3 GREATER 8) OR
 18642            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18643
 18644     IF SUB3 NOT = 9
 18645         MOVE 'Y'                TO BEN-SEARCH-SW.
 18646
 18647     GO TO 7200-EXIT.
 18648
 18649 7200-BENEFIT-DUMMY.
 18650
 18651 7200-DUMMY-EXIT.
 18652     EXIT.
 18653
 18654 7200-EXIT.
 18655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 342
* EL050.cbl
 18657 7250-LOOK-FOR-RESCINDED-CLAIM.
 18658     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18659                                    W-CL-COMP-CD.
 18660     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18661                                    W-CL-CERT-NO.
 18662
 18663
 18664* EXEC CICS HANDLE CONDITION
 18665*        NOTFND  (7250-CONTINUE)
 18666*        ENDFILE (7250-CONTINUE)
 18667*    END-EXEC.
 18668*    MOVE '"$I''                  ! ) #00018425' TO DFHEIV0
 18669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18671     MOVE X'2920233030303138343235' TO DFHEIV0(25:11)
 18672     CALL 'kxdfhei1' USING DFHEIV0
 18673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18674
 18675
 18676
 18677* EXEC CICS IGNORE CONDITION
 18678*        DUPKEY
 18679*    END-EXEC.
 18680*    MOVE '"*$                   !   #00018430' TO DFHEIV0
 18681     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18683     MOVE X'2020233030303138343330' TO DFHEIV0(25:11)
 18684     CALL 'kxdfhei1' USING DFHEIV0
 18685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18686
 18687
 18688
 18689* EXEC CICS STARTBR
 18690*        DATASET   (CLMS-ID)
 18691*        RIDFLD    (ELMSTR-KEY)
 18692*        GENERIC   EQUAL
 18693*        KEYLENGTH (ELMSTR-LENGTH)
 18694*    END-EXEC.
 18695     MOVE 0
 18696       TO DFHEIV11
 18697*    MOVE '&,   KG    E          &   #00018434' TO DFHEIV0
 18698     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18700     MOVE X'2020233030303138343334' TO DFHEIV0(25:11)
 18701     CALL 'kxdfhei1' USING DFHEIV0,
 18702           CLMS-ID,
 18703           ELMSTR-KEY,
 18704           ELMSTR-LENGTH,
 18705           DFHEIV11,
 18706           DFHEIV99
 18707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18708
 18709
 18710     MOVE 'Y'                    TO W-BROWSE-SW.
 18711
 18712 7250-NEXT-CLAIM.
 18713
 18714
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 343
* EL050.cbl
 18715* EXEC CICS READNEXT
 18716*        DATASET   (CLMS-ID)
 18717*        RIDFLD    (ELMSTR-KEY)
 18718*        SET       (ADDRESS OF CLAIM-MASTER)
 18719*    END-EXEC.
 18720     MOVE 0
 18721       TO DFHEIV11
 18722*    MOVE '&.S                   )   #00018445' TO DFHEIV0
 18723     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18724     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18725     MOVE X'2020233030303138343435' TO DFHEIV0(25:11)
 18726     CALL 'kxdfhei1' USING DFHEIV0,
 18727           CLMS-ID,
 18728           DFHEIV20,
 18729           DFHEIV99,
 18730           ELMSTR-KEY,
 18731           DFHEIV99,
 18732           DFHEIV11,
 18733           DFHEIV99,
 18734           DFHEIV99
 18735     SET ADDRESS OF CLAIM-MASTER TO
 18736         DFHEIV20
 18737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18738
 18739
 18740     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18741        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18742         GO TO 7250-CONTINUE
 18743     END-IF.
 18744
 18745     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18746        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18747        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18748        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18749        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18750         GO TO 7250-NEXT-CLAIM
 18751     END-IF.
 18752
 18753     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18754        OR (CL-CLAIM-TYPE = 'I')
 18755        OR (CL-CLAIM-TYPE = 'G')
 18756          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18757              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18758              GO TO 7250-CONTINUE
 18759          END-IF
 18760     END-IF.
 18761
 18762     GO TO 7250-NEXT-CLAIM.
 18763
 18764 7250-CONTINUE.
 18765
 18766     IF W-BROWSE-SW = 'Y'
 18767
 18768* EXEC CICS ENDBR
 18769*            DATASET   (CLMS-ID)
 18770*        END-EXEC
 18771     MOVE 0
 18772       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 344
* EL050.cbl
 18773*    MOVE '&2                    $   #00018478' TO DFHEIV0
 18774     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18775     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18776     MOVE X'2020233030303138343738' TO DFHEIV0(25:11)
 18777     CALL 'kxdfhei1' USING DFHEIV0,
 18778           CLMS-ID,
 18779           DFHEIV11,
 18780           DFHEIV99
 18781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18782         MOVE 'N' TO W-BROWSE-SW
 18783     END-IF.
 18784
 18785 7250-EXIT.
 18786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 345
* EL050.cbl
 18788 7300-CHECK-FOR-OPEN-CLMS.
 18789
 18790*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18791*    MOVE SPACES                 TO CNTL-ACCESS.
 18792*    MOVE '1'                    TO CNTL-REC-TYPE.
 18793*    MOVE +0                     TO CNTL-SEQ-NO.
 18794
 18795*    MOVE '3'                    TO RC-SW-1.
 18796*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18797
 18798*    IF NOT CF-COMPANY-MASTER
 18799*         PERFORM 0099-COMPANY-NOT-FOUND
 18800*         GO TO 7300-EXIT.
 18801
 18802     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18803                                    W-CL-COMP-CD.
 18804     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18805                                    W-CL-CERT-NO.
 18806
 18807
 18808* EXEC CICS HANDLE CONDITION
 18809*        NOTFND  (7300-CONTINUE)
 18810*        ENDFILE (7300-CONTINUE)
 18811*    END-EXEC.
 18812*    MOVE '"$I''                  ! * #00018506' TO DFHEIV0
 18813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18815     MOVE X'2A20233030303138353036' TO DFHEIV0(25:11)
 18816     CALL 'kxdfhei1' USING DFHEIV0
 18817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18818
 18819
 18820
 18821* EXEC CICS IGNORE CONDITION
 18822*        DUPKEY
 18823*    END-EXEC.
 18824*    MOVE '"*$                   !   #00018511' TO DFHEIV0
 18825     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18827     MOVE X'2020233030303138353131' TO DFHEIV0(25:11)
 18828     CALL 'kxdfhei1' USING DFHEIV0
 18829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18830
 18831
 18832
 18833* EXEC CICS STARTBR
 18834*        DATASET   (CLMS-ID)
 18835*        RIDFLD    (ELMSTR-KEY)
 18836*        GENERIC   EQUAL
 18837*        KEYLENGTH (ELMSTR-LENGTH)
 18838*    END-EXEC.
 18839     MOVE 0
 18840       TO DFHEIV11
 18841*    MOVE '&,   KG    E          &   #00018515' TO DFHEIV0
 18842     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18844     MOVE X'2020233030303138353135' TO DFHEIV0(25:11)
 18845     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 346
* EL050.cbl
 18846           CLMS-ID,
 18847           ELMSTR-KEY,
 18848           ELMSTR-LENGTH,
 18849           DFHEIV11,
 18850           DFHEIV99
 18851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18852
 18853
 18854     MOVE 'Y'                    TO W-BROWSE-SW.
 18855
 18856 7300-NEXT-CLAIM.
 18857
 18858
 18859* EXEC CICS READNEXT
 18860*        DATASET   (CLMS-ID)
 18861*        RIDFLD    (ELMSTR-KEY)
 18862*        SET       (ADDRESS OF CLAIM-MASTER)
 18863*    END-EXEC.
 18864     MOVE 0
 18865       TO DFHEIV11
 18866*    MOVE '&.S                   )   #00018526' TO DFHEIV0
 18867     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18868     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18869     MOVE X'2020233030303138353236' TO DFHEIV0(25:11)
 18870     CALL 'kxdfhei1' USING DFHEIV0,
 18871           CLMS-ID,
 18872           DFHEIV20,
 18873           DFHEIV99,
 18874           ELMSTR-KEY,
 18875           DFHEIV99,
 18876           DFHEIV11,
 18877           DFHEIV99,
 18878           DFHEIV99
 18879     SET ADDRESS OF CLAIM-MASTER TO
 18880         DFHEIV20
 18881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18882
 18883
 18884     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18885        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18886         GO TO 7300-CONTINUE.
 18887
 18888     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18889        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18890        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18891        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18892        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18893         GO TO 7300-NEXT-CLAIM.
 18894
 18895*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18896     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18897        OR (CL-CLAIM-TYPE = 'I')
 18898        OR (CL-CLAIM-TYPE = 'G')
 18899        IF CLAIM-IS-OPEN
 18900           EVALUATE TRUE
 18901             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18902                 MOVE ER-2884      TO WS-ERROR
 18903             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 347
* EL050.cbl
 18904                 MOVE ER-2887      TO WS-ERROR
 18905             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18906                 MOVE ER-2886      TO WS-ERROR
 18907             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18908                 MOVE ER-2888      TO WS-ERROR
 18909             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18910                 MOVE ER-2885      TO WS-ERROR
 18911             WHEN OTHER
 18912                 MOVE ER-2768      TO WS-ERROR
 18913           END-EVALUATE
 18914           IF PB-C-AH-CANCEL-VOIDED OR
 18915              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18916                NOT AH-COVERAGE-CANCELLED)
 18917               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18918               MOVE ER-2768      TO WS-ERROR
 18919           END-IF
 18920           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18921           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18922              PB-FORCE-CODE NOT EQUAL '8'
 18923               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18924           END-IF
 18925           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18926           GO TO 7300-CONTINUE
 18927        ELSE
 18928           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18929*****THIS IS A RESCISSION OR REFORMATION
 18930              IF (AH-COVERAGE-CANCELLED AND
 18931                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18932                    MOVE ER-2890 TO WS-ERROR
 18933                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18934                    GO TO 7300-CONTINUE
 18935              END-IF
 18936           ELSE
 18937              IF CL-DENIAL-TYPE = '1'  AND
 18938                 CL-TOTAL-PAID-AMT = 0
 18939                    GO TO 7300-NEXT-CLAIM
 18940              END-IF
 18941              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18942               AND PB-C-AH-CANCEL-DT > SPACES
 18943                 MOVE ER-2756        TO WS-ERROR
 18944                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18945                 GO TO 7300-CONTINUE
 18946              END-IF
 18947           END-IF
 18948        END-IF
 18949     ELSE
 18950*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18951        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18952           IF CLAIM-IS-OPEN
 18953              MOVE ER-2889      TO WS-ERROR
 18954              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18955              GO TO 7300-CONTINUE
 18956           ELSE
 18957              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18958*****THIS IS A RESCISSION OR REFORMATION
 18959                 IF (LF-COVERAGE-CANCELLED AND
 18960                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18961                       MOVE ER-2890 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 348
* EL050.cbl
 18962                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18963                       GO TO 7300-CONTINUE
 18964                 END-IF
 18965              ELSE
 18966                 IF CL-DENIAL-TYPE = '1'  AND
 18967                    CL-TOTAL-PAID-AMT = 0
 18968                       GO TO 7300-NEXT-CLAIM
 18969                 END-IF
 18970                 IF (AH-COVERAGE-CANCELLED AND
 18971                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18972                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18973                    (LF-COVERAGE-CANCELLED AND
 18974                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18975                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18976                       MOVE ER-2965 TO WS-ERROR
 18977                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18978                       GO TO 7300-CONTINUE
 18979                 END-IF
 18980                 IF LF-COVERAGE-CANCELLED
 18981                  IF CL-TOTAL-PAID-AMT > 0
 18982                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18983                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18984                        MOVE ER-2891 TO WS-ERROR
 18985                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18986                        GO TO 7300-CONTINUE
 18987                      END-IF
 18988                    ELSE
 18989                      MOVE ER-2892 TO WS-ERROR
 18990                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18991                      GO TO 7300-CONTINUE
 18992                    END-IF
 18993                  END-IF
 18994                 END-IF
 18995              END-IF
 18996           END-IF
 18997        END-IF
 18998     END-IF
 18999
 19000     GO TO 7300-NEXT-CLAIM.
 19001
 19002 7300-CONTINUE.
 19003
 19004     IF W-BROWSE-SW = 'Y'
 19005
 19006* EXEC CICS ENDBR
 19007*            DATASET   (CLMS-ID)
 19008*        END-EXEC.
 19009     MOVE 0
 19010       TO DFHEIV11
 19011*    MOVE '&2                    $   #00018653' TO DFHEIV0
 19012     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19014     MOVE X'2020233030303138363533' TO DFHEIV0(25:11)
 19015     CALL 'kxdfhei1' USING DFHEIV0,
 19016           CLMS-ID,
 19017           DFHEIV11,
 19018           DFHEIV99
 19019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 349
* EL050.cbl
 19020
 19021
 19022 7300-EXIT.
 19023     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 350
* EL050.cbl
 19025
 19026 7400-GET-REMAIN-TERM.
 19027
 19028* EXEC CICS LINK
 19029*        PROGRAM    ('ELRTRM')
 19030*        COMMAREA   (CALCULATION-PASS-AREA)
 19031*        LENGTH     (CP-COMM-LENGTH)
 19032*    END-EXEC.
 19033     MOVE 'ELRTRM' TO DFHEIV1
 19034*    MOVE '."C                   (   #00018662' TO DFHEIV0
 19035     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19037     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 19038     CALL 'kxdfhei1' USING DFHEIV0,
 19039           DFHEIV1,
 19040           CALCULATION-PASS-AREA,
 19041           CP-COMM-LENGTH,
 19042           DFHEIV99,
 19043           DFHEIV99,
 19044           DFHEIV99,
 19045           DFHEIV99
 19046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19047
 19048
 19049 7400-EXIT.
 19050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 351
* EL050.cbl
 19052
 19053 7500-GET-REMAIN-AMOUNT.
 19054
 19055* EXEC CICS LINK
 19056*        PROGRAM    ('ELRAMT')
 19057*        COMMAREA   (CALCULATION-PASS-AREA)
 19058*        LENGTH     (CP-COMM-LENGTH)
 19059*    END-EXEC.
 19060     MOVE 'ELRAMT' TO DFHEIV1
 19061*    MOVE '."C                   (   #00018673' TO DFHEIV0
 19062     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19064     MOVE X'2020233030303138363733' TO DFHEIV0(25:11)
 19065     CALL 'kxdfhei1' USING DFHEIV0,
 19066           DFHEIV1,
 19067           CALCULATION-PASS-AREA,
 19068           CP-COMM-LENGTH,
 19069           DFHEIV99,
 19070           DFHEIV99,
 19071           DFHEIV99,
 19072           DFHEIV99
 19073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19074
 19075
 19076 7500-EXIT.
 19077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 352
* EL050.cbl
 19079
 19080 7600-GET-REFUND.
 19081
 19082* EXEC CICS LINK
 19083*        PROGRAM    ('ELRFND')
 19084*        COMMAREA   (CALCULATION-PASS-AREA)
 19085*        LENGTH     (CP-COMM-LENGTH)
 19086*    END-EXEC.
 19087     MOVE 'ELRFND' TO DFHEIV1
 19088*    MOVE '."C                   (   #00018684' TO DFHEIV0
 19089     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19091     MOVE X'2020233030303138363834' TO DFHEIV0(25:11)
 19092     CALL 'kxdfhei1' USING DFHEIV0,
 19093           DFHEIV1,
 19094           CALCULATION-PASS-AREA,
 19095           CP-COMM-LENGTH,
 19096           DFHEIV99,
 19097           DFHEIV99,
 19098           DFHEIV99,
 19099           DFHEIV99
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19101
 19102
 19103 7600-EXIT.
 19104     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 353
* EL050.cbl
 19106 7700-CALL-DL1.
 19107
 19108* EXEC CICS LINK
 19109*        PROGRAM    ('DLO001')
 19110*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19111*        LENGTH     (DLO001-COMM-LENGTH)
 19112*    END-EXEC.
 19113     MOVE 'DLO001' TO DFHEIV1
 19114*    MOVE '."C                   (   #00018694' TO DFHEIV0
 19115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19117     MOVE X'2020233030303138363934' TO DFHEIV0(25:11)
 19118     CALL 'kxdfhei1' USING DFHEIV0,
 19119           DFHEIV1,
 19120           WS-DLO-MASTER-POLICY-FORM,
 19121           DLO001-COMM-LENGTH,
 19122           DFHEIV99,
 19123           DFHEIV99,
 19124           DFHEIV99,
 19125           DFHEIV99
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19127
 19128
 19129 7700-EXIT.
 19130     EXIT.
 19131
 19132 7710-CALL-DL2.
 19133
 19134* EXEC CICS LINK
 19135*        PROGRAM    ('DLO002')
 19136*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19137*        LENGTH     (DLO002-COMM-LENGTH)
 19138*    END-EXEC.
 19139     MOVE 'DLO002' TO DFHEIV1
 19140*    MOVE '."C                   (   #00018704' TO DFHEIV0
 19141     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19143     MOVE X'2020233030303138373034' TO DFHEIV0(25:11)
 19144     CALL 'kxdfhei1' USING DFHEIV0,
 19145           DFHEIV1,
 19146           WS-DLO-INTERNAL-POLICY-FORM,
 19147           DLO002-COMM-LENGTH,
 19148           DFHEIV99,
 19149           DFHEIV99,
 19150           DFHEIV99,
 19151           DFHEIV99
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155 7710-EXIT.
 19156     EXIT.
 19157
 19158 7720-CALL-DL3.
 19159
 19160* EXEC CICS LINK
 19161*        PROGRAM    ('DLO003')
 19162*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19163*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 354
* EL050.cbl
 19164*    END-EXEC.
 19165     MOVE 'DLO003' TO DFHEIV1
 19166*    MOVE '."C                   (   #00018714' TO DFHEIV0
 19167     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19169     MOVE X'2020233030303138373134' TO DFHEIV0(25:11)
 19170     CALL 'kxdfhei1' USING DFHEIV0,
 19171           DFHEIV1,
 19172           WS-DLO-VALID-BANK-ID,
 19173           DLO003-COMM-LENGTH,
 19174           DFHEIV99,
 19175           DFHEIV99,
 19176           DFHEIV99,
 19177           DFHEIV99
 19178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19179
 19180
 19181 7720-EXIT.
 19182     EXIT.
 19183
 19184 7730-CALL-DL7.
 19185
 19186* EXEC CICS LINK
 19187*        PROGRAM    ('DLO007')
 19188*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19189*        LENGTH     (DLO007-COMM-LENGTH)
 19190*    END-EXEC.
 19191     MOVE 'DLO007' TO DFHEIV1
 19192*    MOVE '."C                   (   #00018724' TO DFHEIV0
 19193     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19194     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19195     MOVE X'2020233030303138373234' TO DFHEIV0(25:11)
 19196     CALL 'kxdfhei1' USING DFHEIV0,
 19197           DFHEIV1,
 19198           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19199           DLO007-COMM-LENGTH,
 19200           DFHEIV99,
 19201           DFHEIV99,
 19202           DFHEIV99,
 19203           DFHEIV99
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19205
 19206
 19207 7730-EXIT.
 19208     EXIT.
 19209
 19210 7740-CALL-DL11.
 19211
 19212* EXEC CICS LINK
 19213*        PROGRAM    ('DLO011')
 19214*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19215*        LENGTH     (DLO011-COMM-LENGTH)
 19216*    END-EXEC.
 19217     MOVE 'DLO011' TO DFHEIV1
 19218*    MOVE '."C                   (   #00018734' TO DFHEIV0
 19219     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19221     MOVE X'2020233030303138373334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 355
* EL050.cbl
 19222     CALL 'kxdfhei1' USING DFHEIV0,
 19223           DFHEIV1,
 19224           WS-DLO-PREM-RATES-BEN-TYPE,
 19225           DLO011-COMM-LENGTH,
 19226           DFHEIV99,
 19227           DFHEIV99,
 19228           DFHEIV99,
 19229           DFHEIV99
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19231
 19232
 19233 7740-EXIT.
 19234     EXIT.
 19235
 19236 7750-CALL-DL17.
 19237
 19238* EXEC CICS LINK
 19239*        PROGRAM    ('DLO017')
 19240*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19241*        LENGTH     (DLO017-COMM-LENGTH)
 19242*    END-EXEC.
 19243     MOVE 'DLO017' TO DFHEIV1
 19244*    MOVE '."C                   (   #00018744' TO DFHEIV0
 19245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19247     MOVE X'2020233030303138373434' TO DFHEIV0(25:11)
 19248     CALL 'kxdfhei1' USING DFHEIV0,
 19249           DFHEIV1,
 19250           WS-DLO-VALID-RATE-CODE,
 19251           DLO017-COMM-LENGTH,
 19252           DFHEIV99,
 19253           DFHEIV99,
 19254           DFHEIV99,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259 7750-EXIT.
 19260     EXIT.
 19261
 19262 7755-CALL-DL19.
 19263
 19264* EXEC CICS LINK
 19265*        PROGRAM    ('DLO019')
 19266*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19267*        LENGTH     (DLO019-COMM-LENGTH)
 19268*    END-EXEC.
 19269     MOVE 'DLO019' TO DFHEIV1
 19270*    MOVE '."C                   (   #00018754' TO DFHEIV0
 19271     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19273     MOVE X'2020233030303138373534' TO DFHEIV0(25:11)
 19274     CALL 'kxdfhei1' USING DFHEIV0,
 19275           DFHEIV1,
 19276           WS-DLO-ORIG-COV-CAT,
 19277           DLO019-COMM-LENGTH,
 19278           DFHEIV99,
 19279           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 356
* EL050.cbl
 19280           DFHEIV99,
 19281           DFHEIV99
 19282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19283
 19284
 19285 7755-EXIT.
 19286     EXIT.
 19287
 19288 7760-CALL-DL21.
 19289
 19290* EXEC CICS LINK
 19291*        PROGRAM    ('DLO021')
 19292*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19293*        LENGTH     (DLO021-COMM-LENGTH)
 19294*    END-EXEC.
 19295     MOVE 'DLO021' TO DFHEIV1
 19296*    MOVE '."C                   (   #00018764' TO DFHEIV0
 19297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19299     MOVE X'2020233030303138373634' TO DFHEIV0(25:11)
 19300     CALL 'kxdfhei1' USING DFHEIV0,
 19301           DFHEIV1,
 19302           WS-DLO-VALID-LOAN-OFFICER,
 19303           DLO021-COMM-LENGTH,
 19304           DFHEIV99,
 19305           DFHEIV99,
 19306           DFHEIV99,
 19307           DFHEIV99
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311 7760-EXIT.
 19312     EXIT.
 19313
 19314 7770-CALL-DL22.
 19315
 19316* EXEC CICS LINK
 19317*        PROGRAM    ('DLO022')
 19318*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19319*        LENGTH     (DLO022-COMM-LENGTH)
 19320*    END-EXEC.
 19321     MOVE 'DLO022' TO DFHEIV1
 19322*    MOVE '."C                   (   #00018774' TO DFHEIV0
 19323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19325     MOVE X'2020233030303138373734' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0,
 19327           DFHEIV1,
 19328           WS-DLO-VALID-STATE-CODE,
 19329           DLO022-COMM-LENGTH,
 19330           DFHEIV99,
 19331           DFHEIV99,
 19332           DFHEIV99,
 19333           DFHEIV99
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 357
* EL050.cbl
 19338     EXIT.
 19339
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 358
* EL050.cbl
 19341
 19342 7800-REWRITE-CERT.
 19343******************************************************************
 19344*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19345*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19346******************************************************************
 19347
 19348     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19349        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19350        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19351        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19352
 19353* EXEC CICS REWRITE
 19354*                  DATASET (CERT-ID)
 19355*                  FROM    (CERTIFICATE-MASTER)
 19356*              END-EXEC
 19357     MOVE LENGTH OF
 19358      CERTIFICATE-MASTER
 19359       TO DFHEIV11
 19360*    MOVE '&& L                  %   #00018795' TO DFHEIV0
 19361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19363     MOVE X'2020233030303138373935' TO DFHEIV0(25:11)
 19364     CALL 'kxdfhei1' USING DFHEIV0,
 19365           CERT-ID,
 19366           CERTIFICATE-MASTER,
 19367           DFHEIV11,
 19368           DFHEIV99
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19370        GO TO 7800-EXIT.
 19371
 19372       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19373       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19374
 19375 7800-EXIT.
 19376      EXIT.
 19377
 19378 7900-DELETE-CERT.
 19379
 19380* EXEC CICS DELETE
 19381*        DATASET (CERT-ID)
 19382*    END-EXEC.
 19383*    MOVE '&(                    &   #00018808' TO DFHEIV0
 19384     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19386     MOVE X'2020233030303138383038' TO DFHEIV0(25:11)
 19387     CALL 'kxdfhei1' USING DFHEIV0,
 19388           CERT-ID,
 19389           DFHEIV99,
 19390           DFHEIV99,
 19391           DFHEIV99,
 19392           DFHEIV99
 19393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19394
 19395
 19396 7900-EXIT.
 19397     EXIT.
 19398
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 359
* EL050.cbl
 19399 8000-WRITE-CERT.
 19400
 19401* EXEC CICS HANDLE CONDITION
 19402*        DUPKEY    (8000-FREE-MAIN)
 19403*    END-EXEC.
 19404*    MOVE '"$$                   ! + #00018816' TO DFHEIV0
 19405     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19407     MOVE X'2B20233030303138383136' TO DFHEIV0(25:11)
 19408     CALL 'kxdfhei1' USING DFHEIV0
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412
 19413* EXEC CICS WRITE
 19414*        DATASET     (CERT-ID)
 19415*        FROM        (CERTIFICATE-MASTER)
 19416*        RIDFLD      (ELCERT-KEY)
 19417*    END-EXEC.
 19418     MOVE LENGTH OF
 19419      CERTIFICATE-MASTER
 19420       TO DFHEIV11
 19421*    MOVE '&$ L                  ''   #00018820' TO DFHEIV0
 19422     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19424     MOVE X'2020233030303138383230' TO DFHEIV0(25:11)
 19425     CALL 'kxdfhei1' USING DFHEIV0,
 19426           CERT-ID,
 19427           CERTIFICATE-MASTER,
 19428           DFHEIV11,
 19429           ELCERT-KEY,
 19430           DFHEIV99,
 19431           DFHEIV99
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435 8000-FREE-MAIN.
 19436
 19437 8000-EXIT.
 19438      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 360
* EL050.cbl
 19440
 19441 8100-READ-ERPNDM.
 19442
 19443* EXEC CICS HANDLE CONDITION
 19444*         NOTFND     (8100-NOTFND)
 19445*         ENDFILE    (8100-NOTFND)
 19446*    END-EXEC.
 19447*    MOVE '"$I''                  ! , #00018833' TO DFHEIV0
 19448     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19450     MOVE X'2C20233030303138383333' TO DFHEIV0(25:11)
 19451     CALL 'kxdfhei1' USING DFHEIV0
 19452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19453
 19454
 19455     MOVE SPACES                 TO ERPNDM-FOUND.
 19456     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19457
 19458
 19459* EXEC CICS READ
 19460*         DATASET   (FILE-ERPNDM)
 19461*         RIDFLD    (PM-CONTROL-PRIMARY)
 19462*         INTO      (PENDING-MAILING-DATA)
 19463*    END-EXEC.
 19464     MOVE LENGTH OF
 19465      PENDING-MAILING-DATA
 19466       TO DFHEIV11
 19467*    MOVE '&"IL       E          (   #00018841' TO DFHEIV0
 19468     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19470     MOVE X'2020233030303138383431' TO DFHEIV0(25:11)
 19471     CALL 'kxdfhei1' USING DFHEIV0,
 19472           FILE-ERPNDM,
 19473           PENDING-MAILING-DATA,
 19474           DFHEIV11,
 19475           PM-CONTROL-PRIMARY,
 19476           DFHEIV99,
 19477           DFHEIV99,
 19478           DFHEIV99
 19479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19480
 19481
 19482     GO TO 8100-EXIT.
 19483
 19484 8100-NOTFND.
 19485
 19486     MOVE 'X'                    TO ERPNDM-FOUND.
 19487     MOVE ER-2694                TO WS-ERROR.
 19488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19489     MOVE ER-2883                TO WS-ERROR
 19490     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19491     .
 19492 8100-EXIT.
 19493     EXIT.
 19494
 19495 8110-READ-ERMAIL.
 19496
 19497* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 361
* EL050.cbl
 19498*         NOTFND     (8110-NOTFND)
 19499*         ENDFILE    (8110-NOTFND)
 19500*    END-EXEC.
 19501*    MOVE '"$I''                  ! - #00018861' TO DFHEIV0
 19502     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19504     MOVE X'2D20233030303138383631' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0
 19506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19507
 19508
 19509     MOVE SPACES                 TO ERMAIL-FOUND.
 19510     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19511     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19512     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19513     MOVE PB-SV-STATE            TO MA-STATE.
 19514
 19515
 19516* EXEC CICS READ
 19517*         UPDATE
 19518*         DATASET   (FILE-ERMAIL)
 19519*         RIDFLD    (MA-CONTROL-PRIMARY)
 19520*         INTO      (MAILING-DATA)
 19521*    END-EXEC.
 19522     MOVE LENGTH OF
 19523      MAILING-DATA
 19524       TO DFHEIV11
 19525*    MOVE '&"IL       EU         (   #00018872' TO DFHEIV0
 19526     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303138383732' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0,
 19530           FILE-ERMAIL,
 19531           MAILING-DATA,
 19532           DFHEIV11,
 19533           MA-CONTROL-PRIMARY,
 19534           DFHEIV99,
 19535           DFHEIV99,
 19536           DFHEIV99
 19537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19538
 19539
 19540     GO TO 8110-EXIT.
 19541
 19542 8110-NOTFND.
 19543     MOVE 'X'                    TO ERMAIL-FOUND.
 19544
 19545 8110-EXIT.
 19546     EXIT.
 19547
 19548 8120-REWRITE-ERMAIL.
 19549
 19550* EXEC CICS REWRITE
 19551*         DATASET    (FILE-ERMAIL)
 19552*         FROM       (MAILING-DATA)
 19553*    END-EXEC.
 19554     MOVE LENGTH OF
 19555      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 362
* EL050.cbl
 19556       TO DFHEIV11
 19557*    MOVE '&& L                  %   #00018888' TO DFHEIV0
 19558     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19559     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19560     MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
 19561     CALL 'kxdfhei1' USING DFHEIV0,
 19562           FILE-ERMAIL,
 19563           MAILING-DATA,
 19564           DFHEIV11,
 19565           DFHEIV99
 19566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19567
 19568
 19569 8120-EXIT.
 19570     EXIT.
 19571
 19572 8130-WRITE-ERMAIL.
 19573
 19574* EXEC CICS HANDLE CONDITION
 19575*         DUPKEY   (8130-EXIT)
 19576*    END-EXEC.
 19577*    MOVE '"$$                   ! . #00018897' TO DFHEIV0
 19578     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19580     MOVE X'2E20233030303138383937' TO DFHEIV0(25:11)
 19581     CALL 'kxdfhei1' USING DFHEIV0
 19582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19583
 19584
 19585
 19586* EXEC CICS WRITE
 19587*         DATASET     (FILE-ERMAIL)
 19588*         RIDFLD      (MA-CONTROL-PRIMARY)
 19589*         FROM        (MAILING-DATA)
 19590*    END-EXEC.
 19591     MOVE LENGTH OF
 19592      MAILING-DATA
 19593       TO DFHEIV11
 19594*    MOVE '&$ L                  ''   #00018901' TO DFHEIV0
 19595     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19596     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19597     MOVE X'2020233030303138393031' TO DFHEIV0(25:11)
 19598     CALL 'kxdfhei1' USING DFHEIV0,
 19599           FILE-ERMAIL,
 19600           MAILING-DATA,
 19601           DFHEIV11,
 19602           MA-CONTROL-PRIMARY,
 19603           DFHEIV99,
 19604           DFHEIV99
 19605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19606
 19607
 19608 8130-EXIT.
 19609     EXIT.
 19610
 19611 8140-UNLOCK-ERMAIL.
 19612
 19613* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 363
* EL050.cbl
 19614*         DATASET   (FILE-ERMAIL)
 19615*    END-EXEC.
 19616*    MOVE '&*                    #   #00018911' TO DFHEIV0
 19617     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19618     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19619     MOVE X'2020233030303138393131' TO DFHEIV0(25:11)
 19620     CALL 'kxdfhei1' USING DFHEIV0,
 19621           FILE-ERMAIL,
 19622           DFHEIV99
 19623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19624
 19625
 19626 8140-EXIT.
 19627     EXIT.
 19628
 19629 8150-read-elcrtt.
 19630
 19631
 19632* EXEC CICS HANDLE CONDITION
 19633*        NOTFND   (8150-exit)
 19634*    END-EXEC
 19635*    MOVE '"$I                   ! / #00018920' TO DFHEIV0
 19636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19638     MOVE X'2F20233030303138393230' TO DFHEIV0(25:11)
 19639     CALL 'kxdfhei1' USING DFHEIV0
 19640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19641
 19642     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19643     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19644
 19645
 19646* EXEC CICS READ
 19647*        DATASET  (CRTT-ID)
 19648*        RIDFLD   (WS-ELCRTT-KEY)
 19649*        INTO     (CERTIFICATE-TRAILERS)
 19650*    END-EXEC
 19651     MOVE LENGTH OF
 19652      CERTIFICATE-TRAILERS
 19653       TO DFHEIV11
 19654*    MOVE '&"IL       E          (   #00018927' TO DFHEIV0
 19655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19657     MOVE X'2020233030303138393237' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0,
 19659           CRTT-ID,
 19660           CERTIFICATE-TRAILERS,
 19661           DFHEIV11,
 19662           WS-ELCRTT-KEY,
 19663           DFHEIV99,
 19664           DFHEIV99,
 19665           DFHEIV99
 19666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19667
 19668     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19669     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19670
 19671     .
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 364
* EL050.cbl
 19672 8150-exit.
 19673     exit.
 19674 8180-UPDATE-VIN-NUMBER.
 19675
 19676* EXEC CICS HANDLE CONDITION
 19677*        NOTFND   (8180-NOTFND)
 19678*    END-EXEC.
 19679*    MOVE '"$I                   ! 0 #00018940' TO DFHEIV0
 19680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19682     MOVE X'3020233030303138393430' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19688     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19689
 19690
 19691* EXEC CICS READ
 19692*        UPDATE
 19693*        DATASET  (CRTT-ID)
 19694*        RIDFLD   (WS-ELCRTT-KEY)
 19695*        INTO     (CERTIFICATE-TRAILERS)
 19696*    END-EXEC.
 19697     MOVE LENGTH OF
 19698      CERTIFICATE-TRAILERS
 19699       TO DFHEIV11
 19700*    MOVE '&"IL       EU         (   #00018947' TO DFHEIV0
 19701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19702     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19703     MOVE X'2020233030303138393437' TO DFHEIV0(25:11)
 19704     CALL 'kxdfhei1' USING DFHEIV0,
 19705           CRTT-ID,
 19706           CERTIFICATE-TRAILERS,
 19707           DFHEIV11,
 19708           WS-ELCRTT-KEY,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19716         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19717
 19718* EXEC CICS REWRITE
 19719*           DATASET  (CRTT-ID)
 19720*           FROM     (CERTIFICATE-TRAILERS)
 19721*        END-EXEC
 19722     MOVE LENGTH OF
 19723      CERTIFICATE-TRAILERS
 19724       TO DFHEIV11
 19725*    MOVE '&& L                  %   #00018956' TO DFHEIV0
 19726     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303138393536' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 365
* EL050.cbl
 19730           CRTT-ID,
 19731           CERTIFICATE-TRAILERS,
 19732           DFHEIV11,
 19733           DFHEIV99
 19734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19735     ELSE
 19736
 19737* EXEC CICS UNLOCK
 19738*          DATASET  (CRTT-ID)
 19739*       END-EXEC
 19740*    MOVE '&*                    #   #00018961' TO DFHEIV0
 19741     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19742     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19743     MOVE X'2020233030303138393631' TO DFHEIV0(25:11)
 19744     CALL 'kxdfhei1' USING DFHEIV0,
 19745           CRTT-ID,
 19746           DFHEIV99
 19747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19748     END-IF.
 19749
 19750     GO TO 8180-EXIT.
 19751
 19752 8180-NOTFND.
 19753
 19754     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19755     MOVE 'CS'         TO CS-RECORD-ID.
 19756     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19757     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19758     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19759     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19760
 19761* EXEC CICS WRITE
 19762*       DATASET  (CRTT-ID)
 19763*       RIDFLD   (WS-ELCRTT-KEY)
 19764*       FROM     (CERTIFICATE-TRAILERS)
 19765*    END-EXEC.
 19766     MOVE LENGTH OF
 19767      CERTIFICATE-TRAILERS
 19768       TO DFHEIV11
 19769*    MOVE '&$ L                  ''   #00018976' TO DFHEIV0
 19770     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19772     MOVE X'2020233030303138393736' TO DFHEIV0(25:11)
 19773     CALL 'kxdfhei1' USING DFHEIV0,
 19774           CRTT-ID,
 19775           CERTIFICATE-TRAILERS,
 19776           DFHEIV11,
 19777           WS-ELCRTT-KEY,
 19778           DFHEIV99,
 19779           DFHEIV99
 19780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19781
 19782
 19783 8180-EXIT.
 19784     EXIT.
 19785
 19786 8190-UPDATE-REFUND-CLAIM-FLAG.
 19787
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 366
* EL050.cbl
 19788* EXEC CICS HANDLE CONDITION
 19789*        NOTFND   (8190-NOTFND)
 19790*    END-EXEC.
 19791*    MOVE '"$I                   ! 1 #00018986' TO DFHEIV0
 19792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19794     MOVE X'3120233030303138393836' TO DFHEIV0(25:11)
 19795     CALL 'kxdfhei1' USING DFHEIV0
 19796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19797
 19798
 19799     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19800     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19801
 19802
 19803* EXEC CICS READ
 19804*        UPDATE
 19805*        DATASET  (CRTT-ID)
 19806*        RIDFLD   (WS-ELCRTT-KEY)
 19807*        INTO     (CERTIFICATE-TRAILERS)
 19808*    END-EXEC.
 19809     MOVE LENGTH OF
 19810      CERTIFICATE-TRAILERS
 19811       TO DFHEIV11
 19812*    MOVE '&"IL       EU         (   #00018993' TO DFHEIV0
 19813     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19814     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19815     MOVE X'2020233030303138393933' TO DFHEIV0(25:11)
 19816     CALL 'kxdfhei1' USING DFHEIV0,
 19817           CRTT-ID,
 19818           CERTIFICATE-TRAILERS,
 19819           DFHEIV11,
 19820           WS-ELCRTT-KEY,
 19821           DFHEIV99,
 19822           DFHEIV99,
 19823           DFHEIV99
 19824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19825
 19826
 19827     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19828
 19829* EXEC CICS REWRITE
 19830*       DATASET  (CRTT-ID)
 19831*       FROM     (CERTIFICATE-TRAILERS)
 19832*    END-EXEC.
 19833     MOVE LENGTH OF
 19834      CERTIFICATE-TRAILERS
 19835       TO DFHEIV11
 19836*    MOVE '&& L                  %   #00019001' TO DFHEIV0
 19837     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19838     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19839     MOVE X'2020233030303139303031' TO DFHEIV0(25:11)
 19840     CALL 'kxdfhei1' USING DFHEIV0,
 19841           CRTT-ID,
 19842           CERTIFICATE-TRAILERS,
 19843           DFHEIV11,
 19844           DFHEIV99
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 367
* EL050.cbl
 19846
 19847
 19848     GO TO 8190-EXIT.
 19849
 19850 8190-NOTFND.
 19851
 19852     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19853     MOVE 'CS'         TO CS-RECORD-ID.
 19854     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19855     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19856     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19857     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19858
 19859* EXEC CICS WRITE
 19860*       DATASET  (CRTT-ID)
 19861*       RIDFLD   (WS-ELCRTT-KEY)
 19862*       FROM     (CERTIFICATE-TRAILERS)
 19863*    END-EXEC.
 19864     MOVE LENGTH OF
 19865      CERTIFICATE-TRAILERS
 19866       TO DFHEIV11
 19867*    MOVE '&$ L                  ''   #00019016' TO DFHEIV0
 19868     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19869     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19870     MOVE X'2020233030303139303136' TO DFHEIV0(25:11)
 19871     CALL 'kxdfhei1' USING DFHEIV0,
 19872           CRTT-ID,
 19873           CERTIFICATE-TRAILERS,
 19874           DFHEIV11,
 19875           WS-ELCRTT-KEY,
 19876           DFHEIV99,
 19877           DFHEIV99
 19878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19879
 19880
 19881 8190-EXIT.
 19882     EXIT.
 19883
 19884 8195-UPDATE-AGE-FLAGS.
 19885
 19886* EXEC CICS HANDLE CONDITION
 19887*        NOTFND   (8195-NOTFND)
 19888*    END-EXEC.
 19889*    MOVE '"$I                   ! 2 #00019026' TO DFHEIV0
 19890     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19892     MOVE X'3220233030303139303236' TO DFHEIV0(25:11)
 19893     CALL 'kxdfhei1' USING DFHEIV0
 19894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19895
 19896
 19897     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19898     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19899
 19900
 19901* EXEC CICS READ
 19902*        UPDATE
 19903*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 368
* EL050.cbl
 19904*        RIDFLD   (WS-ELCRTT-KEY)
 19905*        INTO     (CERTIFICATE-TRAILERS)
 19906*    END-EXEC.
 19907     MOVE LENGTH OF
 19908      CERTIFICATE-TRAILERS
 19909       TO DFHEIV11
 19910*    MOVE '&"IL       EU         (   #00019033' TO DFHEIV0
 19911     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19912     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19913     MOVE X'2020233030303139303333' TO DFHEIV0(25:11)
 19914     CALL 'kxdfhei1' USING DFHEIV0,
 19915           CRTT-ID,
 19916           CERTIFICATE-TRAILERS,
 19917           DFHEIV11,
 19918           WS-ELCRTT-KEY,
 19919           DFHEIV99,
 19920           DFHEIV99,
 19921           DFHEIV99
 19922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19923
 19924
 19925     IF WS-INS-AGE-SET = 'Y'
 19926        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19927     END-IF
 19928     IF WS-JNT-AGE-SET = 'Y'
 19929        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19930     END-IF
 19931
 19932
 19933* EXEC CICS REWRITE
 19934*       DATASET  (CRTT-ID)
 19935*       FROM     (CERTIFICATE-TRAILERS)
 19936*    END-EXEC.
 19937     MOVE LENGTH OF
 19938      CERTIFICATE-TRAILERS
 19939       TO DFHEIV11
 19940*    MOVE '&& L                  %   #00019047' TO DFHEIV0
 19941     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19942     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19943     MOVE X'2020233030303139303437' TO DFHEIV0(25:11)
 19944     CALL 'kxdfhei1' USING DFHEIV0,
 19945           CRTT-ID,
 19946           CERTIFICATE-TRAILERS,
 19947           DFHEIV11,
 19948           DFHEIV99
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952     GO TO 8195-EXIT.
 19953
 19954 8195-NOTFND.
 19955
 19956     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19957     MOVE 'CS'         TO CS-RECORD-ID.
 19958     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19959     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19960     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19961     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 369
* EL050.cbl
 19962     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19963
 19964* EXEC CICS WRITE
 19965*       DATASET  (CRTT-ID)
 19966*       RIDFLD   (WS-ELCRTT-KEY)
 19967*       FROM     (CERTIFICATE-TRAILERS)
 19968*    END-EXEC.
 19969     MOVE LENGTH OF
 19970      CERTIFICATE-TRAILERS
 19971       TO DFHEIV11
 19972*    MOVE '&$ L                  ''   #00019063' TO DFHEIV0
 19973     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19974     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19975     MOVE X'2020233030303139303633' TO DFHEIV0(25:11)
 19976     CALL 'kxdfhei1' USING DFHEIV0,
 19977           CRTT-ID,
 19978           CERTIFICATE-TRAILERS,
 19979           DFHEIV11,
 19980           WS-ELCRTT-KEY,
 19981           DFHEIV99,
 19982           DFHEIV99
 19983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19984
 19985
 19986 8195-EXIT.
 19987     EXIT.
 19988
 19989 8200-READ-REIN-TABLE.
 19990
 19991* EXEC CICS HANDLE CONDITION
 19992*         NOTFND   (8200-NOTFND)
 19993*    END-EXEC.
 19994*    MOVE '"$I                   ! 3 #00019073' TO DFHEIV0
 19995     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19996     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19997     MOVE X'3320233030303139303733' TO DFHEIV0(25:11)
 19998     CALL 'kxdfhei1' USING DFHEIV0
 19999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20000
 20001
 20002
 20003* EXEC CICS READ
 20004*        DATASET     (REIN-ID)
 20005*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20006*        RIDFLD      (ERREIN-KEY)
 20007*    END-EXEC.
 20008*    MOVE '&"S        E          (   #00019077' TO DFHEIV0
 20009     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20011     MOVE X'2020233030303139303737' TO DFHEIV0(25:11)
 20012     CALL 'kxdfhei1' USING DFHEIV0,
 20013           REIN-ID,
 20014           DFHEIV20,
 20015           DFHEIV99,
 20016           ERREIN-KEY,
 20017           DFHEIV99,
 20018           DFHEIV99,
 20019           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 370
* EL050.cbl
 20020     SET ADDRESS OF REINSURANCE-RECORD TO
 20021         DFHEIV20
 20022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20023
 20024
 20025     GO TO 8200-EXIT.
 20026
 20027 8200-NOTFND.
 20028     MOVE 'N'             TO WS-REIN-READ-SW.
 20029
 20030 8200-EXIT.
 20031      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 371
* EL050.cbl
 20033
 20034 8300-READ-CTBL-TABLE.
 20035
 20036* EXEC CICS HANDLE CONDITION
 20037*        NOTFND    (8300-NOTFND)
 20038*        DISABLED  (8300-ERRESS-PROBLEM)
 20039*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20040*        ENDFILE   (8300-NOTFND)
 20041*    END-EXEC.
 20042*    MOVE '"$IcJ''                ! 4 #00019093' TO DFHEIV0
 20043     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20045     MOVE X'3420233030303139303933' TO DFHEIV0(25:11)
 20046     CALL 'kxdfhei1' USING DFHEIV0
 20047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20048
 20049
 20050
 20051* EXEC CICS READ
 20052*        DATASET     (CTBL-ID)
 20053*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20054*        RIDFLD      (ERCTBL-KEY)
 20055*    END-EXEC.
 20056*    MOVE '&"S        E          (   #00019100' TO DFHEIV0
 20057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20059     MOVE X'2020233030303139313030' TO DFHEIV0(25:11)
 20060     CALL 'kxdfhei1' USING DFHEIV0,
 20061           CTBL-ID,
 20062           DFHEIV20,
 20063           DFHEIV99,
 20064           ERCTBL-KEY,
 20065           DFHEIV99,
 20066           DFHEIV99,
 20067           DFHEIV99
 20068     SET ADDRESS OF COMM-TABLE-RECORD TO
 20069         DFHEIV20
 20070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20071
 20072
 20073     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20074
 20075     GO TO 8300-EXIT.
 20076
 20077 8300-NOTFND.
 20078
 20079     IF CTBL-SW = '0530'
 20080         MOVE 'AA'                     TO WS-AH-COMP-CD
 20081         MOVE '0550'                   TO CTBL-SW
 20082         MOVE '1'                      TO WS-CTBL-READ-SW
 20083         GO TO 8300-EXIT.
 20084
 20085     IF CTBL-SW = '0540'
 20086         MOVE 'AA'                     TO WS-LF-COMP-CD
 20087         MOVE '0550'                   TO CTBL-SW
 20088         MOVE '1'                      TO WS-CTBL-READ-SW
 20089         GO TO 8300-EXIT.
 20090
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 372
* EL050.cbl
 20091     IF CTBL-SW = '0550'
 20092         MOVE '2'                      TO WS-CTBL-READ-SW
 20093         GO TO 8300-EXIT.
 20094
 20095     GO TO 8300-EXIT.
 20096
 20097 8300-ERRESS-PROBLEM.
 20098
 20099      MOVE ER-8050              TO WS-ERROR.
 20100      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20101
 20102     GO TO 8300-EXIT.
 20103
 20104 8300-EXIT.
 20105      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 373
* EL050.cbl
 20107
 20108
 20109 8400-GETMAIN-ERFORM.
 20110
 20111
 20112* EXEC CICS   GETMAIN
 20113*        LENGTH  (500)
 20114*        SET     (ADDRESS OF FORM-MASTER)
 20115*    END-EXEC.
 20116     MOVE 500
 20117       TO DFHEIV11
 20118*    MOVE '," L                  $   #00019144' TO DFHEIV0
 20119     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139313434' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           DFHEIV20,
 20124           DFHEIV11,
 20125           DFHEIV99
 20126     SET ADDRESS OF FORM-MASTER TO
 20127         DFHEIV20
 20128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20129
 20130
 20131     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20132
 20133 8400-EXIT.
 20134      EXIT.
 20135
 20136 8450-READ-FORM-MASTER.
 20137
 20138
 20139* EXEC CICS  HANDLE CONDITION
 20140*        NOTFND   (8450-FORM-NOT-FOUND)
 20141*        ENDFILE  (8450-FORM-NOT-FOUND)
 20142*    END-EXEC.
 20143*    MOVE '"$I''                  ! 5 #00019156' TO DFHEIV0
 20144     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20146     MOVE X'3520233030303139313536' TO DFHEIV0(25:11)
 20147     CALL 'kxdfhei1' USING DFHEIV0
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20149
 20150
 20151
 20152* EXEC CICS   READ
 20153*        DATASET   (FORM-ID)
 20154*        RIDFLD    (ERFORM-KEY)
 20155*        INTO      (FORM-MASTER)
 20156*        GTEQ
 20157*    END-EXEC.
 20158     MOVE LENGTH OF
 20159      FORM-MASTER
 20160       TO DFHEIV11
 20161*    MOVE '&"IL       G          (   #00019161' TO DFHEIV0
 20162     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20164     MOVE X'2020233030303139313631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 374
* EL050.cbl
 20165     CALL 'kxdfhei1' USING DFHEIV0,
 20166           FORM-ID,
 20167           FORM-MASTER,
 20168           DFHEIV11,
 20169           ERFORM-KEY,
 20170           DFHEIV99,
 20171           DFHEIV99,
 20172           DFHEIV99
 20173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20174
 20175
 20176     MOVE  'Y'           TO  FORM-MASTER-SW.
 20177
 20178     GO TO  8450-EXIT.
 20179
 20180 8450-FORM-NOT-FOUND.
 20181
 20182     MOVE  'N'           TO  FORM-MASTER-SW.
 20183
 20184 8450-EXIT.
 20185      EXIT.
 20186
 20187 8500-DATE-CONVERT.
 20188
 20189* EXEC CICS LINK
 20190*        PROGRAM    ('ELDATCV')
 20191*        COMMAREA   (DATE-CONVERSION-DATA)
 20192*        LENGTH     (DC-COMM-LENGTH)
 20193*    END-EXEC.
 20194     MOVE 'ELDATCV' TO DFHEIV1
 20195*    MOVE '."C                   (   #00019180' TO DFHEIV0
 20196     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20198     MOVE X'2020233030303139313830' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0,
 20200           DFHEIV1,
 20201           DATE-CONVERSION-DATA,
 20202           DC-COMM-LENGTH,
 20203           DFHEIV99,
 20204           DFHEIV99,
 20205           DFHEIV99,
 20206           DFHEIV99
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210 8500-EXIT.
 20211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 375
* EL050.cbl
 20213
 20214 8555-RELOAD-CONTROL-FILE.
 20215     CONTINUE.
 20216
 20217 8555-EXIT.
 20218     EXIT.
 20219
 20220 8557-GETMAIN-ERPLAN.
 20221
 20222
 20223* EXEC CICS GETMAIN
 20224*        LENGTH    (840)
 20225*        SET       (ADDRESS OF PLAN-RECORDS)
 20226*    END-EXEC.
 20227     MOVE 840
 20228       TO DFHEIV11
 20229*    MOVE '," L                  $   #00019198' TO DFHEIV0
 20230     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20231     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20232     MOVE X'2020233030303139313938' TO DFHEIV0(25:11)
 20233     CALL 'kxdfhei1' USING DFHEIV0,
 20234           DFHEIV20,
 20235           DFHEIV11,
 20236           DFHEIV99
 20237     SET ADDRESS OF PLAN-RECORDS TO
 20238         DFHEIV20
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20243
 20244 8557-EXIT.
 20245     EXIT.
 20246
 20247 8560-GETMAIN.
 20248
 20249* EXEC CICS GETMAIN
 20250*        LENGTH    (2000)
 20251*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20252*    END-EXEC.
 20253     MOVE 2000
 20254       TO DFHEIV11
 20255*    MOVE '," L                  $   #00019209' TO DFHEIV0
 20256     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20257     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20258     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
 20259     CALL 'kxdfhei1' USING DFHEIV0,
 20260           DFHEIV20,
 20261           DFHEIV11,
 20262           DFHEIV99
 20263     SET ADDRESS OF ACCOUNT-MASTER TO
 20264         DFHEIV20
 20265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20266
 20267
 20268     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20269
 20270 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 376
* EL050.cbl
 20271     EXIT.
 20272
 20273 8570-START-ACCOUNT-MASTER.
 20274
 20275* EXEC CICS HANDLE CONDITION
 20276*        NOTFND    (0199-ACCT-NOT-FOUND)
 20277*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20278*    END-EXEC.
 20279*    MOVE '"$I''                  ! 6 #00019220' TO DFHEIV0
 20280     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20282     MOVE X'3620233030303139323230' TO DFHEIV0(25:11)
 20283     CALL 'kxdfhei1' USING DFHEIV0
 20284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20285
 20286
 20287
 20288* EXEC CICS STARTBR
 20289*        DATASET    (ACCT-ID)
 20290*        RIDFLD     (ERACCT-KEY)
 20291*        GTEQ
 20292*    END-EXEC.
 20293     MOVE 0
 20294       TO DFHEIV11
 20295*    MOVE '&,         G          &   #00019225' TO DFHEIV0
 20296     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20298     MOVE X'2020233030303139323235' TO DFHEIV0(25:11)
 20299     CALL 'kxdfhei1' USING DFHEIV0,
 20300           ACCT-ID,
 20301           ERACCT-KEY,
 20302           DFHEIV99,
 20303           DFHEIV11,
 20304           DFHEIV99
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308 8570-EXIT.
 20309     EXIT.
 20310
 20311 8580-READ-ACCOUNT-MASTER.
 20312
 20313* EXEC CICS HANDLE CONDITION
 20314*        NOTFND    (0199-ACCT-NOT-FOUND)
 20315*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20316*    END-EXEC.
 20317*    MOVE '"$I''                  ! 7 #00019235' TO DFHEIV0
 20318     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20320     MOVE X'3720233030303139323335' TO DFHEIV0(25:11)
 20321     CALL 'kxdfhei1' USING DFHEIV0
 20322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20323
 20324
 20325
 20326* EXEC CICS READNEXT
 20327*        DATASET     (ACCT-ID)
 20328*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 377
* EL050.cbl
 20329*        RIDFLD      (ERACCT-KEY)
 20330*    END-EXEC.
 20331     MOVE LENGTH OF
 20332      ACCOUNT-MASTER
 20333       TO DFHEIV12
 20334     MOVE 0
 20335       TO DFHEIV11
 20336*    MOVE '&.IL                  )   #00019240' TO DFHEIV0
 20337     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20338     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20339     MOVE X'2020233030303139323430' TO DFHEIV0(25:11)
 20340     CALL 'kxdfhei1' USING DFHEIV0,
 20341           ACCT-ID,
 20342           ACCOUNT-MASTER,
 20343           DFHEIV12,
 20344           ERACCT-KEY,
 20345           DFHEIV99,
 20346           DFHEIV11,
 20347           DFHEIV99,
 20348           DFHEIV99
 20349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20350
 20351
 20352 8580-EXIT.
 20353     EXIT.
 20354
 20355 8582-READ-COMPENSATION-MASTER.
 20356
 20357* EXEC CICS HANDLE CONDITION
 20358*        NOTFND    (8582-COMP-NOT-FOUND)
 20359*        ENDFILE   (8582-COMP-NOT-FOUND)
 20360*    END-EXEC.
 20361*    MOVE '"$I''                  ! 8 #00019250' TO DFHEIV0
 20362     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20364     MOVE X'3820233030303139323530' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369
 20370* EXEC CICS READ
 20371*        DATASET     (COMP-ID)
 20372*        INTO        (COMPENSATION-MASTER)
 20373*        RIDFLD      (ERCOMP-KEY)
 20374*    END-EXEC.
 20375     MOVE LENGTH OF
 20376      COMPENSATION-MASTER
 20377       TO DFHEIV11
 20378*    MOVE '&"IL       E          (   #00019255' TO DFHEIV0
 20379     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20381     MOVE X'2020233030303139323535' TO DFHEIV0(25:11)
 20382     CALL 'kxdfhei1' USING DFHEIV0,
 20383           COMP-ID,
 20384           COMPENSATION-MASTER,
 20385           DFHEIV11,
 20386           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 378
* EL050.cbl
 20387           DFHEIV99,
 20388           DFHEIV99,
 20389           DFHEIV99
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392
 20393     MOVE 'Y'                    TO COMP-MASTER-SW
 20394
 20395     GO TO 8582-EXIT
 20396     .
 20397 8582-COMP-NOT-FOUND.
 20398
 20399     MOVE 'N'                    TO COMP-MASTER-SW.
 20400
 20401 8582-EXIT.
 20402     EXIT.
 20403
 20404 8583-READ-ERAGTC.
 20405
 20406* EXEC CICS HANDLE CONDITION
 20407*        NOTFND    (8583-AGTC-NOT-FOUND)
 20408*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20409*    END-EXEC.
 20410*    MOVE '"$I''                  ! 9 #00019273' TO DFHEIV0
 20411     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20413     MOVE X'3920233030303139323733' TO DFHEIV0(25:11)
 20414     CALL 'kxdfhei1' USING DFHEIV0
 20415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20416
 20417
 20418
 20419* EXEC CICS STARTBR
 20420*        DATASET    (AGTC-ID)
 20421*        RIDFLD     (ERAGTC-KEY)
 20422*        GTEQ
 20423*    END-EXEC.
 20424     MOVE 0
 20425       TO DFHEIV11
 20426*    MOVE '&,         G          &   #00019278' TO DFHEIV0
 20427     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20428     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20429     MOVE X'2020233030303139323738' TO DFHEIV0(25:11)
 20430     CALL 'kxdfhei1' USING DFHEIV0,
 20431           AGTC-ID,
 20432           ERAGTC-KEY,
 20433           DFHEIV99,
 20434           DFHEIV11,
 20435           DFHEIV99
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439 8583-READ-ERAGTC-NEXT.
 20440
 20441* EXEC CICS READNEXT
 20442*        DATASET     (AGTC-ID)
 20443*        INTO        (AGENT-COMMISSIONS)
 20444*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 379
* EL050.cbl
 20445*    END-EXEC.
 20446     MOVE LENGTH OF
 20447      AGENT-COMMISSIONS
 20448       TO DFHEIV12
 20449     MOVE 0
 20450       TO DFHEIV11
 20451*    MOVE '&.IL                  )   #00019285' TO DFHEIV0
 20452     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303139323835' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           AGTC-ID,
 20457           AGENT-COMMISSIONS,
 20458           DFHEIV12,
 20459           ERAGTC-KEY,
 20460           DFHEIV99,
 20461           DFHEIV11,
 20462           DFHEIV99,
 20463           DFHEIV99
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
 20467*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20468
 20469     GO TO 8583-EXIT
 20470     .
 20471 8583-AGTC-NOT-FOUND.
 20472
 20473     MOVE 'N'                    TO AGTC-MASTER-SW.
 20474
 20475 8583-EXIT.
 20476     EXIT.
 20477
 20478 8584-READ-BANK-CROSS-REF.
 20479
 20480* EXEC CICS HANDLE CONDITION
 20481*        NOTFND    (8584-BXRF-NOT-FOUND)
 20482*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20483*    END-EXEC.
 20484*    MOVE '"$I''                  ! : #00019303' TO DFHEIV0
 20485     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20487     MOVE X'3A20233030303139333033' TO DFHEIV0(25:11)
 20488     CALL 'kxdfhei1' USING DFHEIV0
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492
 20493* EXEC CICS READ
 20494*        DATASET     (BXRF-ID)
 20495*        INTO        (BANK-CROSS-REFERENCE)
 20496*        RIDFLD      (ERBXRF-KEY)
 20497*        LENGTH      (BXRF-REC-LENGTH)
 20498*    END-EXEC.
 20499*    MOVE '&"IL       E          (   #00019308' TO DFHEIV0
 20500     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20502     MOVE X'2020233030303139333038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 380
* EL050.cbl
 20503     CALL 'kxdfhei1' USING DFHEIV0,
 20504           BXRF-ID,
 20505           BANK-CROSS-REFERENCE,
 20506           BXRF-REC-LENGTH,
 20507           ERBXRF-KEY,
 20508           DFHEIV99,
 20509           DFHEIV99,
 20510           DFHEIV99
 20511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20512
 20513
 20514     MOVE 'Y'                    TO BXRF-MASTER-SW
 20515
 20516     GO TO 8584-EXIT
 20517     .
 20518 8584-BXRF-NOT-FOUND.
 20519
 20520     MOVE 'N'                    TO BXRF-MASTER-SW.
 20521
 20522 8584-EXIT.
 20523     EXIT.
 20524
 20525 8585-READ-PLAN-MASTER.
 20526
 20527
 20528* EXEC CICS HANDLE CONDITION
 20529*        NOTFND    (8585-PLAN-NOT-FOUND)
 20530*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20531*    END-EXEC.
 20532*    MOVE '"$I''                  ! ; #00019328' TO DFHEIV0
 20533     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20535     MOVE X'3B20233030303139333238' TO DFHEIV0(25:11)
 20536     CALL 'kxdfhei1' USING DFHEIV0
 20537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20538
 20539
 20540
 20541* EXEC CICS READ
 20542*        DATASET     (PLAN-ID)
 20543*        INTO        (PLAN-MASTER)
 20544*        RIDFLD      (ERPLAN-KEY)
 20545*    END-EXEC.
 20546     MOVE LENGTH OF
 20547      PLAN-MASTER
 20548       TO DFHEIV11
 20549*    MOVE '&"IL       E          (   #00019333' TO DFHEIV0
 20550     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303139333333' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           PLAN-ID,
 20555           PLAN-MASTER,
 20556           DFHEIV11,
 20557           ERPLAN-KEY,
 20558           DFHEIV99,
 20559           DFHEIV99,
 20560           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 381
* EL050.cbl
 20561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20562
 20563
 20564     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20565
 20566     GO TO 8585-EXIT.
 20567
 20568 8585-PLAN-NOT-FOUND.
 20569
 20570     MOVE 'N'                    TO PLAN-MASTER-SW.
 20571
 20572 8585-EXIT.
 20573     EXIT.
 20574
 20575 8586-READ-LOAN-OFFICER.
 20576
 20577* EXEC CICS READ
 20578*        DATASET     (LOFC-ID)
 20579*        INTO        (LOAN-OFFICER-MASTER)
 20580*        RIDFLD      (ERLOFC-KEY)
 20581*        RESP        (WS-RESPONSE)
 20582*    END-EXEC
 20583     MOVE LENGTH OF
 20584      LOAN-OFFICER-MASTER
 20585       TO DFHEIV11
 20586*    MOVE '&"IL       E          (  N#00019351' TO DFHEIV0
 20587     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20589     MOVE X'204E233030303139333531' TO DFHEIV0(25:11)
 20590     CALL 'kxdfhei1' USING DFHEIV0,
 20591           LOFC-ID,
 20592           LOAN-OFFICER-MASTER,
 20593           DFHEIV11,
 20594           ERLOFC-KEY,
 20595           DFHEIV99,
 20596           DFHEIV99,
 20597           DFHEIV99
 20598     MOVE EIBRESP  TO WS-RESPONSE
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20600
 20601     IF WS-RESP-NORMAL
 20602        MOVE 'Y'                 TO LOFC-MASTER-SW
 20603     ELSE
 20604        MOVE 'N'                 TO LOFC-MASTER-SW
 20605     END-IF
 20606     .
 20607 8586-EXIT.
 20608     EXIT.
 20609 8587-START-ERPDEF.
 20610
 20611* EXEC CICS STARTBR
 20612*       DATASET   (PDEF-ID)
 20613*       RIDFLD    (ERPDEF-KEY)
 20614*       GTEQ
 20615*       RESP      (WS-RESPONSE)
 20616*    END-EXEC
 20617     MOVE 0
 20618       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 382
* EL050.cbl
 20619*    MOVE '&,         G          &  N#00019367' TO DFHEIV0
 20620     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20622     MOVE X'204E233030303139333637' TO DFHEIV0(25:11)
 20623     CALL 'kxdfhei1' USING DFHEIV0,
 20624           PDEF-ID,
 20625           ERPDEF-KEY,
 20626           DFHEIV99,
 20627           DFHEIV11,
 20628           DFHEIV99
 20629     MOVE EIBRESP  TO WS-RESPONSE
 20630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20631     IF WS-RESP-NORMAL
 20632        MOVE 'Y'                 TO PDEF-MASTER-SW
 20633     ELSE
 20634        MOVE 'N'                 TO PDEF-MASTER-SW
 20635     END-IF
 20636     .
 20637 8587-EXIT.
 20638     EXIT.
 20639 8588-READ-ERPDEF.
 20640
 20641* EXEC CICS READNEXT
 20642*       DATASET   (PDEF-ID)
 20643*       RIDFLD    (ERPDEF-KEY)
 20644*       INTO      (PRODUCT-MASTER)
 20645*       RESP      (WS-RESPONSE)
 20646*    END-EXEC
 20647     MOVE LENGTH OF
 20648      PRODUCT-MASTER
 20649       TO DFHEIV12
 20650     MOVE 0
 20651       TO DFHEIV11
 20652*    MOVE '&.IL                  )  N#00019382' TO DFHEIV0
 20653     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20655     MOVE X'204E233030303139333832' TO DFHEIV0(25:11)
 20656     CALL 'kxdfhei1' USING DFHEIV0,
 20657           PDEF-ID,
 20658           PRODUCT-MASTER,
 20659           DFHEIV12,
 20660           ERPDEF-KEY,
 20661           DFHEIV99,
 20662           DFHEIV11,
 20663           DFHEIV99,
 20664           DFHEIV99
 20665     MOVE EIBRESP  TO WS-RESPONSE
 20666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20667     IF WS-RESP-NORMAL
 20668        MOVE 'Y'                 TO PDEF-MASTER-SW
 20669     ELSE
 20670        MOVE 'N'                 TO PDEF-MASTER-SW
 20671     END-IF
 20672     .
 20673 8588-EXIT.
 20674     EXIT.
 20675 8589-ENDBR-ERPDEF.
 20676
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 383
* EL050.cbl
 20677* EXEC CICS ENDBR
 20678*       DATASET   (PDEF-ID)
 20679*    END-EXEC
 20680     MOVE 0
 20681       TO DFHEIV11
 20682*    MOVE '&2                    $   #00019397' TO DFHEIV0
 20683     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20685     MOVE X'2020233030303139333937' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           PDEF-ID,
 20688           DFHEIV11,
 20689           DFHEIV99
 20690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20691     .
 20692 8589-EXIT.
 20693     EXIT.
 20694 8590-READ-CERT-MASTER.
 20695     IF PB-COMPANY-ID = 'UCL'
 20696         GO TO 8690-READ-CERT-MASTER-UCL.
 20697
 20698
 20699* EXEC CICS HANDLE CONDITION
 20700*         NOTFND    (0299-CERT-NOT-FOUND)
 20701*    END-EXEC.
 20702*    MOVE '"$I                   ! < #00019407' TO DFHEIV0
 20703     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20705     MOVE X'3C20233030303139343037' TO DFHEIV0(25:11)
 20706     CALL 'kxdfhei1' USING DFHEIV0
 20707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20708
 20709
 20710
 20711* EXEC CICS READ
 20712*        DATASET     (CERT-ID)
 20713*        INTO        (CERTIFICATE-MASTER)
 20714*        RIDFLD      (ELCERT-KEY)
 20715*        UPDATE
 20716*    END-EXEC.
 20717     MOVE LENGTH OF
 20718      CERTIFICATE-MASTER
 20719       TO DFHEIV11
 20720*    MOVE '&"IL       EU         (   #00019411' TO DFHEIV0
 20721     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20722     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20723     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 20724     CALL 'kxdfhei1' USING DFHEIV0,
 20725           CERT-ID,
 20726           CERTIFICATE-MASTER,
 20727           DFHEIV11,
 20728           ELCERT-KEY,
 20729           DFHEIV99,
 20730           DFHEIV99,
 20731           DFHEIV99
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 384
* EL050.cbl
 20735 8590-EXIT.
 20736     EXIT.
 20737
 20738 8690-READ-CERT-MASTER-UCL.
 20739
 20740* EXEC CICS HANDLE CONDITION
 20741*         NOTFND    (8700-READ-CERT-MASTER)
 20742*    END-EXEC.
 20743*    MOVE '"$I                   ! = #00019422' TO DFHEIV0
 20744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20746     MOVE X'3D20233030303139343232' TO DFHEIV0(25:11)
 20747     CALL 'kxdfhei1' USING DFHEIV0
 20748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20749
 20750
 20751 8690-READ-CERT-CONT.
 20752
 20753* EXEC CICS READ
 20754*        DATASET     (CERT-ID)
 20755*        INTO        (CERTIFICATE-MASTER)
 20756*        RIDFLD      (ELCERT-KEY)
 20757*        UPDATE
 20758*    END-EXEC.
 20759     MOVE LENGTH OF
 20760      CERTIFICATE-MASTER
 20761       TO DFHEIV11
 20762*    MOVE '&"IL       EU         (   #00019427' TO DFHEIV0
 20763     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20764     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20765     MOVE X'2020233030303139343237' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0,
 20767           CERT-ID,
 20768           CERTIFICATE-MASTER,
 20769           DFHEIV11,
 20770           ELCERT-KEY,
 20771           DFHEIV99,
 20772           DFHEIV99,
 20773           DFHEIV99
 20774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20775
 20776
 20777     GO TO 8590-EXIT.
 20778
 20779 8700-READ-CERT-MASTER.
 20780     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20781     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20782
 20783* EXEC CICS HANDLE CONDITION
 20784*         DUPKEY    (8720-COMP-ACCOUNTS)
 20785*         ENDFILE   (8730-END-BROWSE)
 20786*         NOTFND    (8740-NOT-FOUND)
 20787*    END-EXEC.
 20788*    MOVE '"$$''I                 ! > #00019439' TO DFHEIV0
 20789     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20791     MOVE X'3E20233030303139343339' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 385
* EL050.cbl
 20793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20794
 20795
 20796
 20797* EXEC CICS STARTBR
 20798*        DATASET     ('ELCERT5')
 20799*        RIDFLD      (ELCERT2-KEY)
 20800*        EQUAL
 20801*    END-EXEC.
 20802     MOVE 'ELCERT5' TO DFHEIV1
 20803     MOVE 0
 20804       TO DFHEIV11
 20805*    MOVE '&,         E          &   #00019445' TO DFHEIV0
 20806     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20808     MOVE X'2020233030303139343435' TO DFHEIV0(25:11)
 20809     CALL 'kxdfhei1' USING DFHEIV0,
 20810           DFHEIV1,
 20811           ELCERT2-KEY,
 20812           DFHEIV99,
 20813           DFHEIV11,
 20814           DFHEIV99
 20815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20816
 20817
 20818 8710-READ-NEXT.
 20819
 20820* EXEC CICS READNEXT
 20821*        DATASET     ('ELCERT5')
 20822*        INTO        (CERTIFICATE-MASTER)
 20823*        RIDFLD      (ELCERT2-KEY)
 20824*    END-EXEC.
 20825     MOVE LENGTH OF
 20826      CERTIFICATE-MASTER
 20827       TO DFHEIV12
 20828     MOVE 'ELCERT5' TO DFHEIV1
 20829     MOVE 0
 20830       TO DFHEIV11
 20831*    MOVE '&.IL                  )   #00019452' TO DFHEIV0
 20832     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20834     MOVE X'2020233030303139343532' TO DFHEIV0(25:11)
 20835     CALL 'kxdfhei1' USING DFHEIV0,
 20836           DFHEIV1,
 20837           CERTIFICATE-MASTER,
 20838           DFHEIV12,
 20839           ELCERT2-KEY,
 20840           DFHEIV99,
 20841           DFHEIV11,
 20842           DFHEIV99,
 20843           DFHEIV99
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20845
 20846
 20847 8720-COMP-ACCOUNTS.
 20848
 20849* EXEC CICS ENTER
 20850*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 386
* EL050.cbl
 20851*         FROM (PB-C-LAST-NAME)
 20852*    END-EXEC.
 20853     MOVE 001
 20854       TO DFHEIV11
 20855*    MOVE ':$F                   %   #00019459' TO DFHEIV0
 20856     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20857     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20858     MOVE X'2020233030303139343539' TO DFHEIV0(25:11)
 20859     CALL 'kxdfhei1' USING DFHEIV0,
 20860           DFHEIV11,
 20861           PB-C-LAST-NAME,
 20862           DFHEIV99,
 20863           DFHEIV99
 20864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20865
 20866
 20867
 20868* EXEC CICS ENTER
 20869*         TRACEID (002)
 20870*         FROM (CM-INSURED-LAST-NAME)
 20871*    END-EXEC.
 20872     MOVE 002
 20873       TO DFHEIV11
 20874*    MOVE ':$F                   %   #00019464' TO DFHEIV0
 20875     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20876     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20877     MOVE X'2020233030303139343634' TO DFHEIV0(25:11)
 20878     CALL 'kxdfhei1' USING DFHEIV0,
 20879           DFHEIV11,
 20880           CM-INSURED-LAST-NAME,
 20881           DFHEIV99,
 20882           DFHEIV99
 20883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20884
 20885
 20886     IF PB-CERT-NO NOT = CM-CERT-NO
 20887         GO TO 8730-END-BROWSE.
 20888
 20889     IF PB-ACCOUNT = CM-ACCOUNT
 20890         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20891             MOVE ER-2799        TO WS-ERROR
 20892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20893             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20894             GO TO 8730-END-BROWSE.
 20895
 20896     GO TO 8710-READ-NEXT.
 20897
 20898 8730-END-BROWSE.
 20899
 20900* EXEC CICS ENDBR
 20901*         DATASET    ('ELCERT5')
 20902*    END-EXEC.
 20903     MOVE 'ELCERT5' TO DFHEIV1
 20904     MOVE 0
 20905       TO DFHEIV11
 20906*    MOVE '&2                    $   #00019482' TO DFHEIV0
 20907     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20908     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 387
* EL050.cbl
 20909     MOVE X'2020233030303139343832' TO DFHEIV0(25:11)
 20910     CALL 'kxdfhei1' USING DFHEIV0,
 20911           DFHEIV1,
 20912           DFHEIV11,
 20913           DFHEIV99
 20914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20915
 20916
 20917 8740-NOT-FOUND.
 20918     GO TO 0299-CERT-NOT-FOUND.
 20919
 20920 8750-START-ELSTAT.
 20921
 20922* EXEC CICS STARTBR
 20923*       DATASET   (STAT-ID)
 20924*       RIDFLD    (ELSTAT-KEY)
 20925*       GTEQ
 20926*       RESP      (WS-RESPONSE)
 20927*    END-EXEC
 20928     MOVE 0
 20929       TO DFHEIV11
 20930*    MOVE '&,         G          &  N#00019490' TO DFHEIV0
 20931     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20932     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20933     MOVE X'204E233030303139343930' TO DFHEIV0(25:11)
 20934     CALL 'kxdfhei1' USING DFHEIV0,
 20935           STAT-ID,
 20936           ELSTAT-KEY,
 20937           DFHEIV99,
 20938           DFHEIV11,
 20939           DFHEIV99
 20940     MOVE EIBRESP  TO WS-RESPONSE
 20941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20942     IF WS-RESP-NORMAL
 20943        MOVE 'Y'                 TO STAT-MASTER-SW
 20944     ELSE
 20945        MOVE 'N'                 TO STAT-MASTER-SW
 20946     END-IF
 20947     .
 20948 8750-EXIT.
 20949     EXIT.
 20950 8752-READ-ELSTAT.
 20951
 20952* EXEC CICS READNEXT
 20953*       DATASET   (STAT-ID)
 20954*       RIDFLD    (ELSTAT-KEY)
 20955*       INTO      (STATE-FILE)
 20956*       RESP      (WS-RESPONSE)
 20957*    END-EXEC
 20958     MOVE LENGTH OF
 20959      STATE-FILE
 20960       TO DFHEIV12
 20961     MOVE 0
 20962       TO DFHEIV11
 20963*    MOVE '&.IL                  )  N#00019505' TO DFHEIV0
 20964     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20965     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20966     MOVE X'204E233030303139353035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 388
* EL050.cbl
 20967     CALL 'kxdfhei1' USING DFHEIV0,
 20968           STAT-ID,
 20969           STATE-FILE,
 20970           DFHEIV12,
 20971           ELSTAT-KEY,
 20972           DFHEIV99,
 20973           DFHEIV11,
 20974           DFHEIV99,
 20975           DFHEIV99
 20976     MOVE EIBRESP  TO WS-RESPONSE
 20977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20978     IF WS-RESP-NORMAL
 20979        MOVE 'Y'                 TO STAT-MASTER-SW
 20980     ELSE
 20981        MOVE 'N'                 TO STAT-MASTER-SW
 20982     END-IF
 20983     .
 20984 8752-EXIT.
 20985     EXIT.
 20986 8800-GET-COMP-RATE.
 20987     MOVE +1 TO IB.
 20988     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20989         ADD +9 TO IB
 20990         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20991             ADD +9 TO IB
 20992             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20993                MOVE ZEROS       TO WS-WK-RATE
 20994                GO TO 8800-EXIT.
 20995
 20996     IF PB-I-AGE GREATER CT-AGE (1)
 20997         ADD +3 TO IB
 20998         IF PB-I-AGE GREATER CT-AGE (2)
 20999             ADD +3 TO IB
 21000             IF PB-I-AGE GREATER CT-AGE (3)
 21001                MOVE ZEROS       TO WS-WK-RATE
 21002                GO TO 8800-EXIT.
 21003
 21004     IF WS-WORK-TERM GREATER CT-TRM (1)
 21005         ADD +1 TO IB
 21006         IF WS-WORK-TERM GREATER CT-TRM (2)
 21007             ADD +1 TO IB
 21008             IF WS-WORK-TERM GREATER CT-TRM (3)
 21009                MOVE ZEROS       TO WS-WK-RATE
 21010                GO TO 8800-EXIT.
 21011
 21012     IF CT-RT (IB) NOT NUMERIC
 21013         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21014         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21015         GO TO 8800-GET-COMP-RATE.
 21016
 21017     MOVE CT-RT (IB) TO WS-WK-RATE.
 21018
 21019 8800-EXIT.
 21020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 389
* EL050.cbl
 21022 8900-ADDRESS-FILE.
 21023     IF ERACCT-FILE-ADDRESSED
 21024         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21025         GO TO 8900-ADDRESS-EXIT.
 21026
 21027     IF ELCNTL-FILE-ADDRESSED
 21028         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21029         GO TO 8900-ADDRESS-EXIT.
 21030
 21031     IF ERPLAN-FILE-ADDRESSED
 21032         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21033         GO TO 8900-ADDRESS-EXIT.
 21034
 21035     IF ERFORM-FILE-ADDRESSED
 21036         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21037         GO TO 8900-ADDRESS-EXIT.
 21038
 21039 8900-ADDRESS-EXIT.
 21040     EXIT.
 21041
 21042 9000-READ-CONTROL.
 21043
 21044* EXEC CICS HANDLE CONDITION
 21045*        NOTFND    (9000-NOTFND)
 21046*    END-EXEC.
 21047*    MOVE '"$I                   ! ? #00019576' TO DFHEIV0
 21048     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21050     MOVE X'3F20233030303139353736' TO DFHEIV0(25:11)
 21051     CALL 'kxdfhei1' USING DFHEIV0
 21052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21053
 21054
 21055
 21056* EXEC CICS READ
 21057*        DATASET     (CNTL-ID)
 21058*        SET         (ADDRESS OF CONTROL-FILE)
 21059*        RIDFLD      (ELCNTL-KEY)
 21060*        GTEQ
 21061*    END-EXEC.
 21062*    MOVE '&"S        G          (   #00019580' TO DFHEIV0
 21063     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21065     MOVE X'2020233030303139353830' TO DFHEIV0(25:11)
 21066     CALL 'kxdfhei1' USING DFHEIV0,
 21067           CNTL-ID,
 21068           DFHEIV20,
 21069           DFHEIV99,
 21070           ELCNTL-KEY,
 21071           DFHEIV99,
 21072           DFHEIV99,
 21073           DFHEIV99
 21074     SET ADDRESS OF CONTROL-FILE TO
 21075         DFHEIV20
 21076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21077
 21078
 21079     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 390
* EL050.cbl
 21080
 21081 9000-NOTFND.
 21082     IF RC-SW-1 = '1'
 21083        MOVE ER-2616              TO WS-ERROR
 21084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21085        GO TO 9000-EXIT.
 21086
 21087     IF RC-SW-1 = '2'
 21088        MOVE ER-2602              TO WS-ERROR
 21089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21090
 21091 9000-EXIT.
 21092      EXIT.
 21093
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 391
* EL050.cbl
 21095 9100-READ-CONTROL.
 21096
 21097* EXEC CICS HANDLE CONDITION
 21098*        NOTFND  (9100-NOTFND)
 21099*        ENDFILE (9100-NOTFND)
 21100*    END-EXEC.
 21101*    MOVE '"$I''                  ! @ #00019604' TO DFHEIV0
 21102     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21104     MOVE X'4020233030303139363034' TO DFHEIV0(25:11)
 21105     CALL 'kxdfhei1' USING DFHEIV0
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21107
 21108
 21109
 21110* EXEC CICS READ
 21111*        DATASET     (CNTL-ID)
 21112*        INTO        (CONTROL-FILE)
 21113*        RIDFLD      (ELCNTL-KEY)
 21114*        GTEQ
 21115*    END-EXEC.
 21116     MOVE LENGTH OF
 21117      CONTROL-FILE
 21118       TO DFHEIV11
 21119*    MOVE '&"IL       G          (   #00019609' TO DFHEIV0
 21120     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21122     MOVE X'2020233030303139363039' TO DFHEIV0(25:11)
 21123     CALL 'kxdfhei1' USING DFHEIV0,
 21124           CNTL-ID,
 21125           CONTROL-FILE,
 21126           DFHEIV11,
 21127           ELCNTL-KEY,
 21128           DFHEIV99,
 21129           DFHEIV99,
 21130           DFHEIV99
 21131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21132
 21133
 21134     GO TO 9100-EXIT.
 21135
 21136 9100-NOTFND.
 21137     IF RC-SW-2 = '0'
 21138        MOVE '1'                  TO STATE-RECORD-ERROR
 21139        GO TO 9100-EXIT
 21140     END-IF
 21141     IF RC-SW-2 = '1'
 21142        MOVE '1'                  TO LF-BENEFIT-ERROR
 21143        MOVE ER-2604              TO WS-ERROR
 21144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21145        GO TO 9100-EXIT.
 21146
 21147     IF RC-SW-2 = '2'
 21148        MOVE '1'                  TO AH-BENEFIT-ERROR
 21149        MOVE ER-2605              TO WS-ERROR
 21150        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21151        GO TO 9100-EXIT.
 21152
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 392
* EL050.cbl
 21153     IF RC-SW-2 = '3'
 21154         MOVE ER-2603           TO WS-ERROR
 21155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21156         GO TO 9100-EXIT.
 21157
 21158     IF RC-SW-2 = '4'
 21159         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21160         GO TO 9100-EXIT.
 21161
 21162     IF RC-SW-2 = '5'
 21163         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21164         IF WS-AH-INPUT-CD-1 = SPACE
 21165             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21166         ELSE
 21167             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21168
 21169 9100-EXIT.
 21170      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 393
* EL050.cbl
 21172 9200-CONTROL-GETMAIN.
 21173
 21174* EXEC CICS GETMAIN
 21175*         LENGTH   (750)
 21176*         SET      (ADDRESS OF CONTROL-FILE)
 21177*    END-EXEC.
 21178     MOVE 750
 21179       TO DFHEIV11
 21180*    MOVE '," L                  $   #00019655' TO DFHEIV0
 21181     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21183     MOVE X'2020233030303139363535' TO DFHEIV0(25:11)
 21184     CALL 'kxdfhei1' USING DFHEIV0,
 21185           DFHEIV20,
 21186           DFHEIV11,
 21187           DFHEIV99
 21188     SET ADDRESS OF CONTROL-FILE TO
 21189         DFHEIV20
 21190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21191
 21192
 21193     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21194
 21195 9200-EXIT.
 21196     EXIT.
 21197
 21198 9250-UNLOCK-RETURN.
 21199
 21200* EXEC CICS UNLOCK
 21201*        DATASET   (CERT-ID)
 21202*    END-EXEC.
 21203*    MOVE '&*                    #   #00019666' TO DFHEIV0
 21204     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21205     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21206     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 21207     CALL 'kxdfhei1' USING DFHEIV0,
 21208           CERT-ID,
 21209           DFHEIV99
 21210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21211
 21212
 21213 9300-ABEND.
 21214     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21215
 21216
 21217* EXEC CICS LINK
 21218*        PROGRAM   ('EL004')
 21219*        COMMAREA  (WS-ERROR-LINE)
 21220*        LENGTH    (72)
 21221*    END-EXEC.
 21222     MOVE 'EL004' TO DFHEIV1
 21223     MOVE 72
 21224       TO DFHEIV11
 21225*    MOVE '."C                   (   #00019673' TO DFHEIV0
 21226     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21228     MOVE X'2020233030303139363733' TO DFHEIV0(25:11)
 21229     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 394
* EL050.cbl
 21230           DFHEIV1,
 21231           WS-ERROR-LINE,
 21232           DFHEIV11,
 21233           DFHEIV99,
 21234           DFHEIV99,
 21235           DFHEIV99,
 21236           DFHEIV99
 21237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21238
 21239
 21240     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21241
 21242
 21243* EXEC CICS ABEND
 21244*        ABCODE ('EL50')
 21245*    END-EXEC.
 21246     MOVE 'EL50' TO DFHEIV5
 21247*    MOVE '.,A                   "   #00019681' TO DFHEIV0
 21248     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21249     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21250     MOVE X'2020233030303139363831' TO DFHEIV0(25:11)
 21251     CALL 'kxdfhei1' USING DFHEIV0,
 21252           DFHEIV5
 21253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21254
 21255
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 395
* EL050.cbl
 21257
 21258******************************************************************
 21259*                                                                *
 21260*            E R R O R   F O R M A T   R O U T I N E             *
 21261*                                                                *
 21262******************************************************************
 21263
 21264 9900-ERROR-FORMAT.
 21265
 21266     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21267                    PB-COMMON-ERROR (2) OR
 21268                    PB-COMMON-ERROR (3) OR
 21269                    PB-COMMON-ERROR (4) OR
 21270                    PB-COMMON-ERROR (5) OR
 21271                    PB-COMMON-ERROR (6) OR
 21272                    PB-COMMON-ERROR (7) OR
 21273                    PB-COMMON-ERROR (8) OR
 21274                    PB-COMMON-ERROR (9) OR
 21275                    PB-COMMON-ERROR (10)
 21276        GO TO 9900-EXIT.
 21277
 21278     IF PB-NO-OF-ERRORS = +10
 21279        GO TO 9900-EXIT.
 21280
 21281     ADD +1  TO PB-NO-OF-ERRORS.
 21282     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21283                                       (PB-NO-OF-ERRORS).
 21284 9900-EXIT.
 21285     EXIT.
 21286
 21287 9990-RETURN.
 21288     IF BROWSE-STARTED
 21289
 21290* EXEC CICS ENDBR
 21291*            DATASET  (ACCT-ID)
 21292*       END-EXEC.
 21293     MOVE 0
 21294       TO DFHEIV11
 21295*    MOVE '&2                    $   #00019718' TO DFHEIV0
 21296     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21297     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21298     MOVE X'2020233030303139373138' TO DFHEIV0(25:11)
 21299     CALL 'kxdfhei1' USING DFHEIV0,
 21300           ACCT-ID,
 21301           DFHEIV11,
 21302           DFHEIV99
 21303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21304
 21305
 21306 9990-EXIT.
 21307     EXIT.
 21308
 21309
 21310****Check for CRTO record, add one if not found.
 21311 9991-CHECK-FOR-ELCRTO.
 21312
 21313* EXEC CICS HANDLE CONDITION
 21314*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 396
* EL050.cbl
 21315*         ENDFILE (9991-CRTO-NOT-FOUND)
 21316*     END-EXEC.
 21317*    MOVE '"$I''                  ! A #00019728' TO DFHEIV0
 21318     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21320     MOVE X'4120233030303139373238' TO DFHEIV0(25:11)
 21321     CALL 'kxdfhei1' USING DFHEIV0
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21323
 21324     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21325     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21326     MOVE +0                     TO ELCRTO-SEQ-NO
 21327
 21328
 21329* EXEC CICS READ
 21330*       DATASET   ('ELCRTO')
 21331*       INTO      (ORIGINAL-CERTIFICATE)
 21332*       RIDFLD    (ELCRTO-KEY)
 21333*       GTEQ
 21334*       RESP      (WS-RESPONSE)
 21335*    END-EXEC
 21336     MOVE LENGTH OF
 21337      ORIGINAL-CERTIFICATE
 21338       TO DFHEIV11
 21339     MOVE 'ELCRTO' TO DFHEIV1
 21340*    MOVE '&"IL       G          (  N#00019736' TO DFHEIV0
 21341     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21343     MOVE X'204E233030303139373336' TO DFHEIV0(25:11)
 21344     CALL 'kxdfhei1' USING DFHEIV0,
 21345           DFHEIV1,
 21346           ORIGINAL-CERTIFICATE,
 21347           DFHEIV11,
 21348           ELCRTO-KEY,
 21349           DFHEIV99,
 21350           DFHEIV99,
 21351           DFHEIV99
 21352     MOVE EIBRESP  TO WS-RESPONSE
 21353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21354
 21355     IF WS-RESP-NORMAL
 21356        AND (OC-CONTROL-PRIMARY (1:33) =
 21357                 PB-CONTROL-BY-ACCOUNT (1:33))
 21358        AND (OC-RECORD-TYPE =  'I')
 21359           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21360               GO TO 9991-CHECK-INDICATORS
 21361           ELSE
 21362               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21363               GO TO 9991-CRTO-ADD-REC
 21364           END-IF
 21365     END-IF.
 21366
 21367 9991-CRTO-NOT-FOUND.
 21368
 21369     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21370     MOVE 'OC'                TO OC-RECORD-ID
 21371     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21372                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 397
* EL050.cbl
 21373     MOVE +4096               TO OC-KEY-SEQ-NO.
 21374
 21375 9991-CRTO-ADD-REC.
 21376
 21377     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21378     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21379     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21380     MOVE 'I'                 TO OC-RECORD-TYPE
 21381     IF PB-ISSUE
 21382         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21383         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21384         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21385         MOVE PB-I-AGE               TO OC-INS-AGE
 21386         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21387         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21388         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21389         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21390         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21391         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21392         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21393         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21394         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21395         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21396         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21397         IF PB-I-JOINT-COMMISSION > +0
 21398             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21399         ELSE
 21400             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21401         END-IF
 21402         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21403         MOVE +0                     TO OC-LF-CANCEL-AMT
 21404                                        OC-LF-ITD-CANCEL-AMT
 21405         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21406         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21407         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21408         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21409         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21410         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21411         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21412         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21413         MOVE +0                     TO OC-AH-CANCEL-AMT
 21414                                        OC-AH-ITD-CANCEL-AMT
 21415         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21416         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21417         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21418     ELSE
 21419         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21420         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21421         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21422         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21423         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21424         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21425         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21426         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21427         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21428          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21429             MOVE SPACES             TO OC-LF-BENCD
 21430             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 398
* EL050.cbl
 21431                                        OC-LF-BEN-AMT
 21432                                        OC-LF-PRM-AMT
 21433                                        OC-LF-ALT-BEN-AMT
 21434                                        OC-LF-ALT-PRM-AMT
 21435                                        OC-LF-COMM-PCT
 21436                                        OC-LF-CANCEL-AMT
 21437             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21438             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21439         ELSE
 21440             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21441             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21442             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21443             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21444             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21445             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21446             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21447             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21448             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21449             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21450         END-IF
 21451         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21452         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21453          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21454             MOVE SPACES             TO OC-AH-BENCD
 21455             MOVE ZEROS              TO OC-AH-TERM
 21456                                        OC-AH-BEN-AMT
 21457                                        OC-AH-PRM-AMT
 21458                                        OC-AH-COMM-PCT
 21459                                        OC-AH-CANCEL-AMT
 21460                                        OC-AH-CP
 21461             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21462             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21463         ELSE
 21464             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21465             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21466             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21467             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21468             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21469             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21470             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21471             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21472             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21473         END-IF
 21474         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21475         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21476         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21477         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21478     END-IF
 21479     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21480
 21481     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21482
 21483
 21484* EXEC CICS READ
 21485*         DATASET   (FILE-ERMAIL)
 21486*         RIDFLD    (MA-CONTROL-PRIMARY)
 21487*         INTO      (MAILING-DATA)
 21488*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 399
* EL050.cbl
 21489*    END-EXEC
 21490     MOVE LENGTH OF
 21491      MAILING-DATA
 21492       TO DFHEIV11
 21493*    MOVE '&"IL       E          (  N#00019872' TO DFHEIV0
 21494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21496     MOVE X'204E233030303139383732' TO DFHEIV0(25:11)
 21497     CALL 'kxdfhei1' USING DFHEIV0,
 21498           FILE-ERMAIL,
 21499           MAILING-DATA,
 21500           DFHEIV11,
 21501           MA-CONTROL-PRIMARY,
 21502           DFHEIV99,
 21503           DFHEIV99,
 21504           DFHEIV99
 21505     MOVE EIBRESP  TO WS-RESPONSE
 21506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21507
 21508     IF WS-RESP-NORMAL
 21509         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21510     END-IF.
 21511
 21512     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21513     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21514
 21515
 21516* EXEC CICS READ
 21517*         DATASET  (CRTT-ID)
 21518*         RIDFLD   (WS-ELCRTT-KEY)
 21519*         INTO     (CERTIFICATE-TRAILERS)
 21520*         RESP     (WS-RESPONSE)
 21521*    END-EXEC
 21522     MOVE LENGTH OF
 21523      CERTIFICATE-TRAILERS
 21524       TO DFHEIV11
 21525*    MOVE '&"IL       E          (  N#00019886' TO DFHEIV0
 21526     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21528     MOVE X'204E233030303139383836' TO DFHEIV0(25:11)
 21529     CALL 'kxdfhei1' USING DFHEIV0,
 21530           CRTT-ID,
 21531           CERTIFICATE-TRAILERS,
 21532           DFHEIV11,
 21533           WS-ELCRTT-KEY,
 21534           DFHEIV99,
 21535           DFHEIV99,
 21536           DFHEIV99
 21537     MOVE EIBRESP  TO WS-RESPONSE
 21538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21539
 21540     IF WS-RESP-NORMAL
 21541         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21542         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21543     END-IF.
 21544
 21545
 21546* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 400
* EL050.cbl
 21547*       DATASET   ('ELCRTO')
 21548*       FROM      (ORIGINAL-CERTIFICATE)
 21549*       RIDFLD    (OC-CONTROL-PRIMARY)
 21550*       RESP      (WS-RESPONSE)
 21551*    END-EXEC.
 21552     MOVE LENGTH OF
 21553      ORIGINAL-CERTIFICATE
 21554       TO DFHEIV11
 21555     MOVE 'ELCRTO' TO DFHEIV1
 21556*    MOVE '&$ L                  ''  N#00019898' TO DFHEIV0
 21557     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21558     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21559     MOVE X'204E233030303139383938' TO DFHEIV0(25:11)
 21560     CALL 'kxdfhei1' USING DFHEIV0,
 21561           DFHEIV1,
 21562           ORIGINAL-CERTIFICATE,
 21563           DFHEIV11,
 21564           OC-CONTROL-PRIMARY,
 21565           DFHEIV99,
 21566           DFHEIV99
 21567     MOVE EIBRESP  TO WS-RESPONSE
 21568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21569
 21570
 21571     GO TO 9991-EXIT.
 21572
 21573 9991-CHECK-INDICATORS.
 21574
 21575     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21576         GO TO 9991-EXIT
 21577     END-IF.
 21578
 21579     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21580         GO TO 9991-EXIT
 21581     END-IF.
 21582
 21583
 21584* EXEC CICS READ
 21585*       DATASET   ('ELCRTO')
 21586*       INTO      (ORIGINAL-CERTIFICATE)
 21587*       RIDFLD    (OC-CONTROL-PRIMARY)
 21588*       UPDATE
 21589*       RESP      (WS-RESPONSE)
 21590*    END-EXEC
 21591     MOVE LENGTH OF
 21592      ORIGINAL-CERTIFICATE
 21593       TO DFHEIV11
 21594     MOVE 'ELCRTO' TO DFHEIV1
 21595*    MOVE '&"IL       EU         (  N#00019917' TO DFHEIV0
 21596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21598     MOVE X'204E233030303139393137' TO DFHEIV0(25:11)
 21599     CALL 'kxdfhei1' USING DFHEIV0,
 21600           DFHEIV1,
 21601           ORIGINAL-CERTIFICATE,
 21602           DFHEIV11,
 21603           OC-CONTROL-PRIMARY,
 21604           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 401
* EL050.cbl
 21605           DFHEIV99,
 21606           DFHEIV99
 21607     MOVE EIBRESP  TO WS-RESPONSE
 21608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21609     IF WS-RESP-NORMAL
 21610        IF PB-ISSUE
 21611          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21612          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21613          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21614          MOVE PB-I-AGE               TO OC-INS-AGE
 21615          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21616          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21617          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21618          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21619          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21620          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21621          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21622          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21623          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21624          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21625          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21626          IF PB-I-JOINT-COMMISSION > +0
 21627              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21628          ELSE
 21629              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21630          END-IF
 21631          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21632          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21633          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21634          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21635          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21636          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21637          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21638          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21639          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21640
 21641          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21642
 21643* EXEC CICS READ
 21644*             DATASET   (FILE-ERMAIL)
 21645*             RIDFLD    (MA-CONTROL-PRIMARY)
 21646*             INTO      (MAILING-DATA)
 21647*             RESP      (WS-RESPONSE)
 21648*         END-EXEC
 21649     MOVE LENGTH OF
 21650      MAILING-DATA
 21651       TO DFHEIV11
 21652*    MOVE '&"IL       E          (  N#00019957' TO DFHEIV0
 21653     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21655     MOVE X'204E233030303139393537' TO DFHEIV0(25:11)
 21656     CALL 'kxdfhei1' USING DFHEIV0,
 21657           FILE-ERMAIL,
 21658           MAILING-DATA,
 21659           DFHEIV11,
 21660           MA-CONTROL-PRIMARY,
 21661           DFHEIV99,
 21662           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 402
* EL050.cbl
 21663           DFHEIV99
 21664     MOVE EIBRESP  TO WS-RESPONSE
 21665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21666          IF WS-RESP-NORMAL
 21667             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21668          END-IF
 21669
 21670          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21671          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21672
 21673* EXEC CICS READ
 21674*             DATASET  (CRTT-ID)
 21675*             RIDFLD   (WS-ELCRTT-KEY)
 21676*             INTO     (CERTIFICATE-TRAILERS)
 21677*             RESP     (WS-RESPONSE)
 21678*         END-EXEC
 21679     MOVE LENGTH OF
 21680      CERTIFICATE-TRAILERS
 21681       TO DFHEIV11
 21682*    MOVE '&"IL       E          (  N#00019969' TO DFHEIV0
 21683     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21685     MOVE X'204E233030303139393639' TO DFHEIV0(25:11)
 21686     CALL 'kxdfhei1' USING DFHEIV0,
 21687           CRTT-ID,
 21688           CERTIFICATE-TRAILERS,
 21689           DFHEIV11,
 21690           WS-ELCRTT-KEY,
 21691           DFHEIV99,
 21692           DFHEIV99,
 21693           DFHEIV99
 21694     MOVE EIBRESP  TO WS-RESPONSE
 21695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21696          IF WS-RESP-NORMAL
 21697             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21698                               OC-INS-AGE-DEFAULT-FLAG
 21699             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21700                               OC-JNT-AGE-DEFAULT-FLAG
 21701          END-IF
 21702
 21703        ELSE
 21704          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21705             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21706             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21707             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21708          END-IF
 21709          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21710             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21711             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21712             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21713          END-IF
 21714          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21715        END-IF
 21716
 21717* EXEC CICS REWRITE
 21718*          DATASET   ('ELCRTO')
 21719*          FROM      (ORIGINAL-CERTIFICATE)
 21720*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 403
* EL050.cbl
 21721*       END-EXEC
 21722     MOVE LENGTH OF
 21723      ORIGINAL-CERTIFICATE
 21724       TO DFHEIV11
 21725     MOVE 'ELCRTO' TO DFHEIV1
 21726*    MOVE '&& L                  %  N#00019995' TO DFHEIV0
 21727     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21728     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21729     MOVE X'204E233030303139393935' TO DFHEIV0(25:11)
 21730     CALL 'kxdfhei1' USING DFHEIV0,
 21731           DFHEIV1,
 21732           ORIGINAL-CERTIFICATE,
 21733           DFHEIV11,
 21734           DFHEIV99
 21735     MOVE EIBRESP  TO WS-RESPONSE
 21736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21737     END-IF.
 21738
 21739 9991-EXIT.
 21740     EXIT.
 21741
 21742
 21743 9999-RETURN.
 21744     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21745
 21746
 21747* EXEC CICS RETURN
 21748*    END-EXEC.
 21749*    MOVE '.(                    ''   #00020009' TO DFHEIV0
 21750     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21752     MOVE X'2020233030303230303039' TO DFHEIV0(25:11)
 21753     CALL 'kxdfhei1' USING DFHEIV0,
 21754           DFHEIV99,
 21755           DFHEIV99,
 21756           DFHEIV99,
 21757           DFHEIV99,
 21758           DFHEIV99,
 21759           DFHEIV99
 21760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21761
 21762
 21763
 21764* GOBACK.
 21765     MOVE '9%                    "   ' TO DFHEIV0
 21766     MOVE 'EL050' TO DFHEIV1
 21767     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21768     GOBACK.
 21769
 21770 9999-DFHBACK SECTION.
 21771     MOVE '9%                    "   ' TO DFHEIV0
 21772     MOVE 'EL050' TO DFHEIV1
 21773     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21774     GOBACK.
 21775 9999-DFHEXIT.
 21776     IF DFHEIGDJ EQUAL 0001
 21777         NEXT SENTENCE
 21778     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 404
* EL050.cbl
 21779         GO TO 9300-ABEND,
 21780               3990-FILES-NOT-OPEN
 21781         DEPENDING ON DFHEIGDI
 21782     ELSE IF DFHEIGDJ EQUAL 3
 21783         GO TO 6610-START-BROWSE,
 21784               6630-ERRESS-PROBLEM,
 21785               6630-END-OF-FILE
 21786         DEPENDING ON DFHEIGDI
 21787     ELSE IF DFHEIGDJ EQUAL 4
 21788         GO TO 6630-END-OF-FILE,
 21789               6630-ERRESS-PROBLEM,
 21790               6630-ERRESS-PROBLEM,
 21791               6630-END-OF-FILE
 21792         DEPENDING ON DFHEIGDI
 21793     ELSE IF DFHEIGDJ EQUAL 5
 21794         GO TO 6630-END-OF-FILE,
 21795               6630-END-OF-FILE,
 21796               6630-ERRESS-PROBLEM,
 21797               6630-ERRESS-PROBLEM
 21798         DEPENDING ON DFHEIGDI
 21799     ELSE IF DFHEIGDJ EQUAL 6
 21800         GO TO 6660-START-BROWSE,
 21801               6690-ERRESC-PROBLEM,
 21802               6690-ERRESC-PROBLEM,
 21803               6690-END-OF-FILE
 21804         DEPENDING ON DFHEIGDI
 21805     ELSE IF DFHEIGDJ EQUAL 7
 21806         GO TO 6690-END-OF-FILE,
 21807               6690-ERRESC-PROBLEM,
 21808               6690-ERRESC-PROBLEM,
 21809               6690-END-OF-FILE
 21810         DEPENDING ON DFHEIGDI
 21811     ELSE IF DFHEIGDJ EQUAL 8
 21812         GO TO 6690-END-OF-FILE,
 21813               6690-ERRESC-PROBLEM,
 21814               6690-ERRESC-PROBLEM,
 21815               6690-END-OF-FILE
 21816         DEPENDING ON DFHEIGDI
 21817     ELSE IF DFHEIGDJ EQUAL 9
 21818         GO TO 7250-CONTINUE,
 21819               7250-CONTINUE
 21820         DEPENDING ON DFHEIGDI
 21821     ELSE IF DFHEIGDJ EQUAL 10
 21822         GO TO 7300-CONTINUE,
 21823               7300-CONTINUE
 21824         DEPENDING ON DFHEIGDI
 21825     ELSE IF DFHEIGDJ EQUAL 11
 21826         GO TO 8000-FREE-MAIN
 21827         DEPENDING ON DFHEIGDI
 21828     ELSE IF DFHEIGDJ EQUAL 12
 21829         GO TO 8100-NOTFND,
 21830               8100-NOTFND
 21831         DEPENDING ON DFHEIGDI
 21832     ELSE IF DFHEIGDJ EQUAL 13
 21833         GO TO 8110-NOTFND,
 21834               8110-NOTFND
 21835         DEPENDING ON DFHEIGDI
 21836     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 405
* EL050.cbl
 21837         GO TO 8130-EXIT
 21838         DEPENDING ON DFHEIGDI
 21839     ELSE IF DFHEIGDJ EQUAL 15
 21840         GO TO 8150-exit
 21841         DEPENDING ON DFHEIGDI
 21842     ELSE IF DFHEIGDJ EQUAL 16
 21843         GO TO 8180-NOTFND
 21844         DEPENDING ON DFHEIGDI
 21845     ELSE IF DFHEIGDJ EQUAL 17
 21846         GO TO 8190-NOTFND
 21847         DEPENDING ON DFHEIGDI
 21848     ELSE IF DFHEIGDJ EQUAL 18
 21849         GO TO 8195-NOTFND
 21850         DEPENDING ON DFHEIGDI
 21851     ELSE IF DFHEIGDJ EQUAL 19
 21852         GO TO 8200-NOTFND
 21853         DEPENDING ON DFHEIGDI
 21854     ELSE IF DFHEIGDJ EQUAL 20
 21855         GO TO 8300-NOTFND,
 21856               8300-ERRESS-PROBLEM,
 21857               8300-ERRESS-PROBLEM,
 21858               8300-NOTFND
 21859         DEPENDING ON DFHEIGDI
 21860     ELSE IF DFHEIGDJ EQUAL 21
 21861         GO TO 8450-FORM-NOT-FOUND,
 21862               8450-FORM-NOT-FOUND
 21863         DEPENDING ON DFHEIGDI
 21864     ELSE IF DFHEIGDJ EQUAL 22
 21865         GO TO 0199-ACCT-NOT-FOUND,
 21866               0199-ACCT-NOT-FOUND
 21867         DEPENDING ON DFHEIGDI
 21868     ELSE IF DFHEIGDJ EQUAL 23
 21869         GO TO 0199-ACCT-NOT-FOUND,
 21870               0199-ACCT-NOT-FOUND
 21871         DEPENDING ON DFHEIGDI
 21872     ELSE IF DFHEIGDJ EQUAL 24
 21873         GO TO 8582-COMP-NOT-FOUND,
 21874               8582-COMP-NOT-FOUND
 21875         DEPENDING ON DFHEIGDI
 21876     ELSE IF DFHEIGDJ EQUAL 25
 21877         GO TO 8583-AGTC-NOT-FOUND,
 21878               8583-AGTC-NOT-FOUND
 21879         DEPENDING ON DFHEIGDI
 21880     ELSE IF DFHEIGDJ EQUAL 26
 21881         GO TO 8584-BXRF-NOT-FOUND,
 21882               8584-BXRF-NOT-FOUND
 21883         DEPENDING ON DFHEIGDI
 21884     ELSE IF DFHEIGDJ EQUAL 27
 21885         GO TO 8585-PLAN-NOT-FOUND,
 21886               8585-PLAN-NOT-FOUND
 21887         DEPENDING ON DFHEIGDI
 21888     ELSE IF DFHEIGDJ EQUAL 28
 21889         GO TO 0299-CERT-NOT-FOUND
 21890         DEPENDING ON DFHEIGDI
 21891     ELSE IF DFHEIGDJ EQUAL 29
 21892         GO TO 8700-READ-CERT-MASTER
 21893         DEPENDING ON DFHEIGDI
 21894     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 14-Apr-14 13:36 Page 406
* EL050.cbl
 21895         GO TO 8720-COMP-ACCOUNTS,
 21896               8730-END-BROWSE,
 21897               8740-NOT-FOUND
 21898         DEPENDING ON DFHEIGDI
 21899     ELSE IF DFHEIGDJ EQUAL 31
 21900         GO TO 9000-NOTFND
 21901         DEPENDING ON DFHEIGDI
 21902     ELSE IF DFHEIGDJ EQUAL 32
 21903         GO TO 9100-NOTFND,
 21904               9100-NOTFND
 21905         DEPENDING ON DFHEIGDI
 21906     ELSE IF DFHEIGDJ EQUAL 33
 21907         GO TO 9991-CRTO-NOT-FOUND,
 21908               9991-CRTO-NOT-FOUND
 21909         DEPENDING ON DFHEIGDI.
 21910     MOVE '9%                    "   ' TO DFHEIV0
 21911     MOVE 'EL050' TO DFHEIV1
 21912     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21913     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40016     Code:       88355
