* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   1
* EL106.cbl
* Options: int("EL106.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL106.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL106.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL106.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL106.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:41:00.
     7*                            VMOD=2.026.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   2
* EL106.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION- EX10 - STATE MAINTENANCE
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* Changes are marked by the Change Effective date.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100108    2008022800002  AJRA  ADD CHECK NUMBER TO STATE FOR AK
    34* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
    35* 011211    2010030900001  AJRA  ADD OPTION 4 AND 5 TO REFUND IND
    36* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
    37* 031512    2011120900003  AJRA  ADD AHL COMPANY CODE
    38* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
    39* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    40******************************************************************
    41
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   3
* EL106.cbl
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL106 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.026 ***********'.
    50
    51*                                COPY ELCSCTM.
    52******************************************************************
    53*                                                                *
    54*                                                                *
    55*                            ELCSCTM                             *
    56*                            VMOD=2.001                          *
    57*                                                                *
    58*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    59*                                                                *
    60******************************************************************
    61 01  SECURITY-MESSAGE.
    62     12  FILLER                          PIC X(30)
    63            VALUE '** LOGIC SECURITY VIOLATION -'.
    64     12  SM-READ                         PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' PGM='.
    67     12  SM-PGM                          PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' OPR='.
    70     12  SM-PROCESSOR-ID                 PIC X(4).
    71     12  FILLER                          PIC X(6)
    72            VALUE ' TERM='.
    73     12  SM-TERMID                       PIC X(4).
    74     12  FILLER                          PIC XX   VALUE SPACE.
    75     12  SM-JUL-DATE                     PIC 9(5).
    76     12  FILLER                          PIC X    VALUE SPACE.
    77     12  SM-TIME                         PIC 99.99.
    78
    79*                                COPY ELCSCRTY.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCRTY                            *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    87*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    88*        SAVED IN PI-SECURITY-ADDRESS.                           *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-CONTROL.
    92     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    93     12  FILLER                       PIC XX    VALUE 'SC'.
    94     12  SC-CREDIT-CODES.
    95         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    96             20  SC-CREDIT-DISPLAY    PIC X.
    97             20  SC-CREDIT-UPDATE     PIC X.
    98     12  SC-CLAIMS-CODES.
    99         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   100             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   4
* EL106.cbl
   101             20  SC-CLAIMS-UPDATE     PIC X.
   102*                                COPY MPCSCRT.
   103******************************************************************
   104*                                                                *
   105*                            MPCSCRT                             *
   106*                            VMOD=1.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   109*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   110*                                      (MP MORTGAGE PROTECTION)  *
   111*                                                                *
   112******************************************************************
   113*
   114 01  SECURITY-CONTROL-E.
   115     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   116     12  FILLER                       PIC  X(02) VALUE 'SC'.
   117     12  SC-QUID-KEY.
   118         16  SC-QUID-TERMINAL         PIC  X(04).
   119         16  SC-QUID-SYSTEM           PIC  X(04).
   120     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   121     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   122     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   123         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   124         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   125     12  SC-MP-CODES.
   126         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   127             20  SC-MP-DISPLAY        PIC  X(01).
   128             20  SC-MP-UPDATE         PIC  X(01).
   129     12  FILLER                       PIC  X(40).
   130
   131 01  WS-DATE-AREA.
   132     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   133     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   134
   135 01  WS.
   136     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   137     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   138     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   139     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   140     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   141     05  QID.
   142         16  QID-TERM        PIC X(4).
   143         16  FILLER          PIC X(4)    VALUE '106A'.
   144
   145     05  WS-ST-TOL-PREM-PCT  PIC S9V9(4)    VALUE +0.
   146     05  WS-ST-TOL-REF-PCT   PIC S9V9(4)    VALUE +0.
   147     05  WS-ST-OVR-SHT-PCT   PIC S9V9(4)    VALUE +0.
   148     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   149     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   150     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   151     05  WS-ST-LF-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   152     05  WS-ST-AH-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   153     05  WS-ST-TARGET-LOSS-RATIO
   154                             PIC S9V9(4)    VALUE +0.
   155     05  WS-ST-CALC-INTEREST PIC S9V9(4)    VALUE +0.
   156     05  WS-COMSL            PIC S9V9(4)    VALUE +0.
   157     05  WS-COMJL            PIC S9V9(4)    VALUE +0.
   158     05  WS-COMSA            PIC S9V9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   5
* EL106.cbl
   159     05  WS-COMJA            PIC S9V9(4)    VALUE +0.
   160     05  WS-RESIDENT-TAX     PIC S9V9(4)    VALUE +0.
   161     05  WS-IRATE            PIC S9V9(4)    VALUE +0.
   162     05  WS-IRATE1           PIC S9V9(4)    VALUE +0.
   163     05  WS-IRATE2           PIC S9V9(4)    VALUE +0.
   164     05  WS-IRATE3           PIC S9V9(4)    VALUE +0.
   165     05  WS-FREE-LOOK-DAYS   PIC S9(3)      VALUE +0.
   166
   167 01  STANDARD-AREAS.
   168     12  MAP-NAME            PIC X(8)    VALUE 'EL106A'.
   169     12  MAPSET-NAME         PIC X(8)    VALUE 'EL106S'.
   170     12  TRANS-ID            PIC X(4)    VALUE 'EX10'.
   171     12  PGM-NAME            PIC X(8).
   172     12  TIME-IN             PIC S9(7).
   173     12  TIME-OUT-R  REDEFINES TIME-IN.
   174         16  FILLER          PIC X.
   175         16  TIME-OUT        PIC 99V99.
   176         16  FILLER          PIC XX.
   177     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   178     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   179     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   180     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   181     12  XCTL-EL6565         PIC X(8)    VALUE 'EL6565'.
   182     12  XCTL-EL6507         PIC X(8)    VALUE 'EL6507'.
   183     12  XCTL-EL1061         PIC X(8)    VALUE 'EL1061'.
   184     12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
   185     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   186     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   187     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   188     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   189     12  THIS-PGM            PIC X(8)    VALUE 'EL106'.
   190     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   191     12  ELLETR-ID           PIC X(8)    VALUE 'ELLETR'.
   192     12  SUB                 PIC S9(4)   COMP.
   193     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   194     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   195         88  FIRST-TIME                  VALUE 'Y'.
   196     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   197         88  RETURN-DISPLAY              VALUE 'Y'.
   198
   199 01  ACCESS-KEYS.
   200     12  ELCNTL-KEY.
   201         16  CK-COMP-ID      PIC X(3).
   202         16  FILLER          PIC X       VALUE '3'.
   203         16  CK-STATE-CD     PIC X(4)    VALUE SPACES.
   204         16  CK-SEQ          PIC S9(4)   VALUE +0    COMP.
   205     12  W-WORKING-TEXT-KEY.
   206         16  W-TEXT-COMPANY-CD
   207                             PIC X.
   208         16  W-TEXT-FORM-NO  PIC X(12).
   209         16  W-TEXT-LINE-SEQ PIC S9(4)   COMP.
   210
   211 01  ERROR-MESSAGES.
   212     12  ER-0000                 PIC X(4)  VALUE '0000'.
   213     12  ER-0004                 PIC X(4)  VALUE '0004'.
   214     12  ER-0013                 PIC X(4)  VALUE '0013'.
   215     12  ER-0023                 PIC X(4)  VALUE '0023'.
   216     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   6
* EL106.cbl
   217     12  ER-0042                 PIC X(4)  VALUE '0042'.
   218     12  ER-0050                 PIC X(4)  VALUE '0050'.
   219     12  ER-0068                 PIC X(4)  VALUE '0068'.
   220     12  ER-0070                 PIC X(4)  VALUE '0070'.
   221     12  ER-0141                 PIC X(4)  VALUE '0141'.
   222     12  ER-0144                 PIC X(4)  VALUE '0144'.
   223     12  ER-0145                 PIC X(4)  VALUE '0145'.
   224     12  ER-0146                 PIC X(4)  VALUE '0146'.
   225     12  ER-0147                 PIC X(4)  VALUE '0147'.
   226     12  ER-0148                 PIC X(4)  VALUE '0148'.
   227     12  ER-0149                 PIC X(4)  VALUE '0149'.
   228     12  ER-0150                 PIC X(4)  VALUE '0150'.
   229     12  ER-0151                 PIC X(4)  VALUE '0151'.
   230     12  ER-0152                 PIC X(4)  VALUE '0152'.
   231     12  ER-0153                 PIC X(4)  VALUE '0153'.
   232     12  ER-0159                 PIC X(4)  VALUE '0159'.
   233     12  ER-0160                 PIC X(4)  VALUE '0160'.
   234     12  ER-0161                 PIC X(4)  VALUE '0161'.
   235     12  ER-0582                 PIC X(4)  VALUE '0582'.
   236     12  ER-0805                 PIC X(4)  VALUE '0805'.
   237     12  ER-1614                 PIC X(4)  VALUE '1614'.
   238     12  ER-2009                 PIC X(4)  VALUE '2009'.
   239     12  ER-2010                 PIC X(4)  VALUE '2010'.
   240     12  ER-2012                 PIC X(4)  VALUE '2012'.
   241     12  ER-2014                 PIC X(4)  VALUE '2014'.
   242     12  ER-2024                 PIC X(4)  VALUE '2024'.
   243     12  ER-2028                 PIC X(4)  VALUE '2028'.
   244     12  ER-2032                 PIC X(4)  VALUE '2032'.
   245     12  ER-2033                 PIC X(4)  VALUE '2033'.
   246     12  ER-2082                 PIC X(4)  VALUE '2082'.
   247     12  ER-2084                 PIC X(4)  VALUE '2084'.
   248     12  ER-2137                 PIC X(4)  VALUE '2137'.
   249     12  ER-2298                 PIC X(4)  VALUE '2298'.
   250     12  ER-2299                 PIC X(4)  VALUE '2299'.
   251     12  ER-3030                 PIC X(4)  VALUE '3030'.
   252     12  ER-3031                 PIC X(4)  VALUE '3031'.
   253     12  ER-3032                 PIC X(4)  VALUE '3032'.
   254     12  ER-3033                 PIC X(4)  VALUE '3033'.
   255     12  ER-3034                 PIC X(4)  VALUE '3034'.
   256     12  ER-3035                 PIC X(4)  VALUE '3035'.
   257     12  ER-3036                 PIC X(4)  VALUE '3036'.
   258     12  ER-3040                 PIC X(4)  VALUE '3040'.
   259     12  ER-7008                 PIC X(4)  VALUE '7008'.
   260     12  ER-7346                 PIC X(4)  VALUE '7346'.
   261     12  ER-7531                 PIC X(4)  VALUE '7531'.
   262     12  ER-7532                 PIC X(4)  VALUE '7532'.
   263     12  ER-7536                 PIC X(4)  VALUE '7536'.
   264     12  ER-7578                 PIC X(4)  VALUE '7578'.
   265     12  ER-7581                 PIC X(4)  VALUE '7581'.
   266     12  ER-7717                 PIC X(4)  VALUE '7717'.
   267     12  ER-7735                 PIC X(4)  VALUE '7735'.
   268     12  ER-8159                 PIC X(4)  VALUE '8159'.
   269     12  ER-9074                 PIC X(4)  VALUE '9074'.
   270     12  ER-9097                 PIC X(4)  VALUE '9097'.
   271     12  ER-9447                 PIC X(4)  VALUE '9447'.
   272     12  ER-9448                 PIC X(4)  VALUE '9448'.
   273     12  ER-9478                 PIC X(4)  VALUE '9478'.
   274     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   7
* EL106.cbl
   276*    COPY ELCDATE.
   277******************************************************************
   278*                                                                *
   279*                                                                *
   280*                            ELCDATE.                            *
   281*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   282*                            VMOD=2.003
   283*                                                                *
   284*                                                                *
   285*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   286*                 LENGTH = 200                                   *
   287******************************************************************
   288
   289 01  DATE-CONVERSION-DATA.
   290     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   291     12  DC-OPTION-CODE                PIC X.
   292         88  BIN-TO-GREG                VALUE ' '.
   293         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   294         88  EDIT-GREG-TO-BIN           VALUE '2'.
   295         88  YMD-GREG-TO-BIN            VALUE '3'.
   296         88  MDY-GREG-TO-BIN            VALUE '4'.
   297         88  JULIAN-TO-BIN              VALUE '5'.
   298         88  BIN-PLUS-ELAPSED           VALUE '6'.
   299         88  FIND-CENTURY               VALUE '7'.
   300         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   301         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   302         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   303         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   304         88  JULIAN-TO-BIN-3            VALUE 'C'.
   305         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   306         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   307         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   308         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   309         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   310         88  CHECK-LEAP-YEAR            VALUE 'H'.
   311         88  BIN-3-TO-GREG              VALUE 'I'.
   312         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   313         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   314         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   315         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   316         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   317         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   318         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   319         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   320         88  THREE-CHARACTER-BIN
   321                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   322         88  GREGORIAN-TO-BIN
   323                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   324         88  BIN-TO-GREGORIAN
   325                  VALUES ' ' '1' 'I' '8' 'G'.
   326         88  JULIAN-TO-BINARY
   327                  VALUES '5' 'C' 'E' 'F'.
   328     12  DC-ERROR-CODE                 PIC X.
   329         88  NO-CONVERSION-ERROR        VALUE ' '.
   330         88  DATE-CONVERSION-ERROR
   331                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   332         88  DATE-IS-ZERO               VALUE '1'.
   333         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   8
* EL106.cbl
   334         88  DATE-IS-INVALID            VALUE '3'.
   335         88  DATE1-GREATER-DATE2        VALUE '4'.
   336         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   337         88  DATE-INVALID-OPTION        VALUE '9'.
   338         88  INVALID-CENTURY            VALUE 'A'.
   339         88  ONLY-CENTURY               VALUE 'B'.
   340         88  ONLY-LEAP-YEAR             VALUE 'C'.
   341         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   342     12  DC-END-OF-MONTH               PIC X.
   343         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   344     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   345         88  USE-NORMAL-PROCESS         VALUE ' '.
   346         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   347         88  ADJUST-UP-100-YRS          VALUE '2'.
   348     12  FILLER                        PIC X.
   349     12  DC-CONVERSION-DATES.
   350         16  DC-BIN-DATE-1             PIC XX.
   351         16  DC-BIN-DATE-2             PIC XX.
   352         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   353         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   354                       DC-GREG-DATE-1-EDIT.
   355             20  DC-EDIT1-MONTH        PIC 99.
   356             20  SLASH1-1              PIC X.
   357             20  DC-EDIT1-DAY          PIC 99.
   358             20  SLASH1-2              PIC X.
   359             20  DC-EDIT1-YEAR         PIC 99.
   360         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   361         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   362                     DC-GREG-DATE-2-EDIT.
   363             20  DC-EDIT2-MONTH        PIC 99.
   364             20  SLASH2-1              PIC X.
   365             20  DC-EDIT2-DAY          PIC 99.
   366             20  SLASH2-2              PIC X.
   367             20  DC-EDIT2-YEAR         PIC 99.
   368         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   369         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   370                     DC-GREG-DATE-1-YMD.
   371             20  DC-YMD-YEAR           PIC 99.
   372             20  DC-YMD-MONTH          PIC 99.
   373             20  DC-YMD-DAY            PIC 99.
   374         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   375         16  DC-GREG-DATE-1-MDY-R REDEFINES
   376                      DC-GREG-DATE-1-MDY.
   377             20  DC-MDY-MONTH          PIC 99.
   378             20  DC-MDY-DAY            PIC 99.
   379             20  DC-MDY-YEAR           PIC 99.
   380         16  DC-GREG-DATE-1-ALPHA.
   381             20  DC-ALPHA-MONTH        PIC X(10).
   382             20  DC-ALPHA-DAY          PIC 99.
   383             20  FILLER                PIC XX.
   384             20  DC-ALPHA-CENTURY.
   385                 24 DC-ALPHA-CEN-N     PIC 99.
   386             20  DC-ALPHA-YEAR         PIC 99.
   387         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   388         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   389         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   390         16  DC-JULIAN-DATE            PIC 9(05).
   391         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   9
* EL106.cbl
   392                                       PIC 9(05).
   393         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   394             20  DC-JULIAN-YEAR        PIC 99.
   395             20  DC-JULIAN-DAYS        PIC 999.
   396         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   397         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   398         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   399     12  DATE-CONVERSION-VARIBLES.
   400         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   401         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   402             20  FILLER                PIC 9(3).
   403             20  HOLD-CEN-1-CCYY.
   404                 24  HOLD-CEN-1-CC     PIC 99.
   405                 24  HOLD-CEN-1-YY     PIC 99.
   406             20  HOLD-CEN-1-MO         PIC 99.
   407             20  HOLD-CEN-1-DA         PIC 99.
   408         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   409             20  HOLD-CEN-1-R-MO       PIC 99.
   410             20  HOLD-CEN-1-R-DA       PIC 99.
   411             20  HOLD-CEN-1-R-CCYY.
   412                 24  HOLD-CEN-1-R-CC   PIC 99.
   413                 24  HOLD-CEN-1-R-YY   PIC 99.
   414             20  FILLER                PIC 9(3).
   415         16  HOLD-CENTURY-1-X.
   416             20  FILLER                PIC X(3)  VALUE SPACES.
   417             20  HOLD-CEN-1-X-CCYY.
   418                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   419                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   420             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   421             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   422         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   423             20  HOLD-CEN-1-R-X-MO     PIC XX.
   424             20  HOLD-CEN-1-R-X-DA     PIC XX.
   425             20  HOLD-CEN-1-R-X-CCYY.
   426                 24  HOLD-CEN-1-R-X-CC PIC XX.
   427                 24  HOLD-CEN-1-R-X-YY PIC XX.
   428             20  FILLER                PIC XXX.
   429         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   430         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   431         16  DC-JULIAN-DATE-1          PIC 9(07).
   432         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   433             20  DC-JULIAN-1-CCYY.
   434                 24  DC-JULIAN-1-CC    PIC 99.
   435                 24  DC-JULIAN-1-YR    PIC 99.
   436             20  DC-JULIAN-DA-1        PIC 999.
   437         16  DC-JULIAN-DATE-2          PIC 9(07).
   438         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   439             20  DC-JULIAN-2-CCYY.
   440                 24  DC-JULIAN-2-CC    PIC 99.
   441                 24  DC-JULIAN-2-YR    PIC 99.
   442             20  DC-JULIAN-DA-2        PIC 999.
   443         16  DC-GREG-DATE-A-EDIT.
   444             20  DC-EDITA-MONTH        PIC 99.
   445             20  SLASHA-1              PIC X VALUE '/'.
   446             20  DC-EDITA-DAY          PIC 99.
   447             20  SLASHA-2              PIC X VALUE '/'.
   448             20  DC-EDITA-CCYY.
   449                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  10
* EL106.cbl
   450                 24  DC-EDITA-YEAR     PIC 99.
   451         16  DC-GREG-DATE-B-EDIT.
   452             20  DC-EDITB-MONTH        PIC 99.
   453             20  SLASHB-1              PIC X VALUE '/'.
   454             20  DC-EDITB-DAY          PIC 99.
   455             20  SLASHB-2              PIC X VALUE '/'.
   456             20  DC-EDITB-CCYY.
   457                 24  DC-EDITB-CENT     PIC 99.
   458                 24  DC-EDITB-YEAR     PIC 99.
   459         16  DC-GREG-DATE-CYMD         PIC 9(08).
   460         16  DC-GREG-DATE-CYMD-R REDEFINES
   461                              DC-GREG-DATE-CYMD.
   462             20  DC-CYMD-CEN           PIC 99.
   463             20  DC-CYMD-YEAR          PIC 99.
   464             20  DC-CYMD-MONTH         PIC 99.
   465             20  DC-CYMD-DAY           PIC 99.
   466         16  DC-GREG-DATE-MDCY         PIC 9(08).
   467         16  DC-GREG-DATE-MDCY-R REDEFINES
   468                              DC-GREG-DATE-MDCY.
   469             20  DC-MDCY-MONTH         PIC 99.
   470             20  DC-MDCY-DAY           PIC 99.
   471             20  DC-MDCY-CEN           PIC 99.
   472             20  DC-MDCY-YEAR          PIC 99.
   473    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   474        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   475    12  DC-EL310-DATE                  PIC X(21).
   476    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  11
* EL106.cbl
   478*    COPY ELCLOGOF.
   479******************************************************************
   480*                                                                *
   481*                                                                *
   482*                            ELCLOGOF.                           *
   483*                            VMOD=2.001                          *
   484*                                                                *
   485*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   486*                                                                *
   487******************************************************************
   488 01  CLASIC-LOGOFF.
   489     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   490     12  LOGOFF-TEXT.
   491         16  FILLER          PIC X(5)    VALUE SPACES.
   492         16  LOGOFF-MSG.
   493             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   494             20  FILLER      PIC X       VALUE SPACES.
   495             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   496         16  FILLER          PIC X(80)
   497           VALUE '* YOU ARE NOW LOGGED OFF'.
   498         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   499         16  FILLER          PIC X       VALUE QUOTE.
   500         16  LOGOFF-SYS-MSG  PIC X(17)
   501           VALUE 'S CLAS-IC SYSTEM '.
   502     12  TEXT-MESSAGES.
   503         16  UNACCESS-MSG    PIC X(29)
   504             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   505         16  PGMIDERR-MSG    PIC X(17)
   506             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  12
* EL106.cbl
   508*    COPY ELCATTR.
   509******************************************************************
   510*                                                                *
   511*                            ELCATTR.                            *
   512*                            VMOD=2.001                          *
   513*                                                                *
   514*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   515*                                                                *
   516*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   517*                                                                *
   518*                   POS 1   P=PROTECTED                          *
   519*                           U=UNPROTECTED                        *
   520*                           S=ASKIP                              *
   521*                   POS 2   A=ALPHA/NUMERIC                      *
   522*                           N=NUMERIC                            *
   523*                   POS 3   N=NORMAL                             *
   524*                           B=BRIGHT                             *
   525*                           D=DARK                               *
   526*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   527*                           OF=MODIFIED DATA TAG OFF             *
   528*                                                                *
   529*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   530******************************************************************
   531 01  ATTRIBUTE-LIST.
   532     12  AL-PABOF            PIC X       VALUE 'Y'.
   533     12  AL-PABON            PIC X       VALUE 'Z'.
   534     12  AL-PADOF            PIC X       VALUE '%'.
   535     12  AL-PADON            PIC X       VALUE '_'.
   536     12  AL-PANOF            PIC X       VALUE '-'.
   537     12  AL-PANON            PIC X       VALUE '/'.
   538     12  AL-SABOF            PIC X       VALUE '8'.
   539     12  AL-SABON            PIC X       VALUE '9'.
   540     12  AL-SADOF            PIC X       VALUE '@'.
   541     12  AL-SADON            PIC X       VALUE QUOTE.
   542     12  AL-SANOF            PIC X       VALUE '0'.
   543     12  AL-SANON            PIC X       VALUE '1'.
   544     12  AL-UABOF            PIC X       VALUE 'H'.
   545     12  AL-UABON            PIC X       VALUE 'I'.
   546     12  AL-UADOF            PIC X       VALUE '<'.
   547     12  AL-UADON            PIC X       VALUE '('.
   548     12  AL-UANOF            PIC X       VALUE ' '.
   549     12  AL-UANON            PIC X       VALUE 'A'.
   550     12  AL-UNBOF            PIC X       VALUE 'Q'.
   551     12  AL-UNBON            PIC X       VALUE 'R'.
   552     12  AL-UNDOF            PIC X       VALUE '*'.
   553     12  AL-UNDON            PIC X       VALUE ')'.
   554     12  AL-UNNOF            PIC X       VALUE '&'.
   555     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  13
* EL106.cbl
   557*    COPY ELCEMIB.
   558******************************************************************
   559*                                                                *
   560*                                                                *
   561*                            ELCEMIB.                            *
   562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   563*                            VMOD=2.005                          *
   564*                                                                *
   565*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   566*                                                                *
   567******************************************************************
   568 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   569     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   570     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   571     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   572     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   573     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   574     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   575     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   576     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   577     12  EMI-SWITCH1             PIC X        VALUE '1'.
   578         88  EMI-NO-ERRORS                    VALUE '1'.
   579         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   580         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   581     12  EMI-SWITCH2             PIC X        VALUE '1'.
   582         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   583     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   584         88  EMI-AREA1-EMPTY                  VALUE '1'.
   585         88  EMI-AREA1-FULL                   VALUE '2'.
   586     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   587         88  EMI-AREA2-EMPTY                  VALUE '1'.
   588         88  EMI-AREA2-FULL                   VALUE '2'.
   589     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   590         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   591         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   592         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   593         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   594         88  EMI-BYPASS-FATALS                VALUE 'X'.
   595     12  EMI-ERROR-LINES.
   596         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   597         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   598         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   599         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   600             20  EMI-ERR-CODES OCCURS 10 TIMES.
   601                 24  EMI-ERR-NUM         PIC X(4).
   602                 24  EMI-FILLER          PIC X.
   603                 24  EMI-SEV             PIC X.
   604                 24  FILLER              PIC X.
   605             20  FILLER                  PIC X(02).
   606     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   607         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   608             20  EMI-ERROR-NUMBER    PIC X(4).
   609             20  EMI-FILL            PIC X.
   610             20  EMI-SEVERITY        PIC X.
   611             20  FILLER              PIC X.
   612             20  EMI-ERROR-TEXT.
   613                 24  EMI-TEXT-VARIABLE   PIC X(10).
   614                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  14
* EL106.cbl
   615     12  EMI-SEVERITY-SAVE           PIC X.
   616         88  EMI-NOTE                    VALUE 'N'.
   617         88  EMI-WARNING                 VALUE 'W'.
   618         88  EMI-FORCABLE                VALUE 'F'.
   619         88  EMI-FATAL                   VALUE 'X'.
   620     12  EMI-MESSAGE-FLAG            PIC X.
   621         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   622         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   623     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   624     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   625         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   626         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   627         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   628     12  emi-claim-no                pic x(7).
   629     12  emi-claim-type              pic x(6).
   630     12  FILLER                      PIC X(124)  VALUE SPACES.
   631     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   632     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   633     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   634     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  15
* EL106.cbl
   636*    COPY ELCJPFX.
   637******************************************************************
   638*                                                                *
   639*                                                                *
   640*                            ELCJPFX.                            *
   641*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   642*                            VMOD=2.002                          *
   643*                                                                *
   644*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   645*                                                                *
   646*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   647*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   648*        ELCNTL - CONTROL FILE                                   *
   649*        ELMSTR - CLAIM MASTERS                                  *
   650*        ELTRLR - ACTIVITY TRAILERS                              *
   651*        ELCHKQ - CHECK QUE                                      *
   652******************************************************************
   653 01  JOURNAL-RECORD.
   654     12  jp-date                     pic s9(5) comp-3.
   655     12  jp-time                     pic s9(7) comp-3.
   656     12  JP-USER-ID                  PIC X(4).
   657     12  JP-FILE-ID                  PIC X(8).
   658     12  JP-PROGRAM-ID               PIC X(8).
   659     12  JP-RECORD-TYPE              PIC X.
   660         88 JP-ADD              VALUE 'A'.
   661         88 JP-BEFORE-CHANGE    VALUE 'B'.
   662         88 JP-AFTER-CHANGE     VALUE 'C'.
   663         88 JP-DELETE           VALUE 'D'.
   664         88 JP-GENERIC-DELETE   VALUE 'G'.
   665         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   666         88 JP-KEY-CHG-ADD      VALUE 'N'.
   667     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   668     12  JP-RECORD-AREA
   669
   670
   671             PIC X(530).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  16
* EL106.cbl
   673*    COPY ELCINTF.
   674******************************************************************
   675*                                                                *
   676*                                                                *
   677*                            ELCINTF.                            *
   678*                            VMOD=2.017                          *
   679*                                                                *
   680*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   681*                                                                *
   682*       LENGTH = 1024                                            *
   683*                                                                *
   684******************************************************************
   685*                   C H A N G E   L O G
   686*
   687* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   688*-----------------------------------------------------------------
   689*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   690* EFFECTIVE    NUMBER
   691*-----------------------------------------------------------------
   692* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   693******************************************************************
   694 01  PROGRAM-INTERFACE-BLOCK.
   695     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   696     12  PI-CALLING-PROGRAM              PIC X(8).
   697     12  PI-SAVED-PROGRAM-1              PIC X(8).
   698     12  PI-SAVED-PROGRAM-2              PIC X(8).
   699     12  PI-SAVED-PROGRAM-3              PIC X(8).
   700     12  PI-SAVED-PROGRAM-4              PIC X(8).
   701     12  PI-SAVED-PROGRAM-5              PIC X(8).
   702     12  PI-SAVED-PROGRAM-6              PIC X(8).
   703     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   704     12  PI-COMPANY-ID                   PIC XXX.
   705     12  PI-COMPANY-CD                   PIC X.
   706
   707     12  PI-COMPANY-PASSWORD             PIC X(8).
   708
   709     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   710
   711     12  PI-CONTROL-IN-PROGRESS.
   712         16  PI-CARRIER                  PIC X.
   713         16  PI-GROUPING                 PIC X(6).
   714         16  PI-STATE                    PIC XX.
   715         16  PI-ACCOUNT                  PIC X(10).
   716         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   717                                         PIC X(10).
   718         16  PI-CLAIM-CERT-GRP.
   719             20  PI-CLAIM-NO             PIC X(7).
   720             20  PI-CERT-NO.
   721                 25  PI-CERT-PRIME       PIC X(10).
   722                 25  PI-CERT-SFX         PIC X.
   723             20  PI-CERT-EFF-DT          PIC XX.
   724         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   725             20  PI-PLAN-CODE            PIC X(2).
   726             20  PI-REVISION-NUMBER      PIC X(3).
   727             20  PI-PLAN-EFF-DT          PIC X(2).
   728             20  PI-PLAN-EXP-DT          PIC X(2).
   729             20  FILLER                  PIC X(11).
   730         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  17
* EL106.cbl
   731             20  PI-OE-REFERENCE-1.
   732                 25  PI-OE-REF-1-PRIME   PIC X(18).
   733                 25  PI-OE-REF-1-SUFF    PIC XX.
   734
   735     12  PI-SESSION-IN-PROGRESS          PIC X.
   736         88  CLAIM-SESSION                   VALUE '1'.
   737         88  CREDIT-SESSION                  VALUE '2'.
   738         88  WARRANTY-SESSION                VALUE '3'.
   739         88  MORTGAGE-SESSION                VALUE '4'.
   740         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   741
   742
   743*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   744
   745     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   746     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   747
   748     12  PI-CREDIT-USER                  PIC X.
   749         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   750         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   751
   752     12  PI-CLAIM-USER                   PIC X.
   753         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   754         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   755
   756     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   757         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   758         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   759         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   760         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   761         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   762
   763     12  PI-PROCESSOR-ID                 PIC X(4).
   764
   765     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   766
   767     12  PI-MEMBER-CAPTION               PIC X(10).
   768
   769     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   770         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   771
   772     12  PI-LIFE-OVERRIDE-L1             PIC X.
   773     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   774     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   775     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   776
   777     12  PI-AH-OVERRIDE-L1               PIC X.
   778     12  PI-AH-OVERRIDE-L2               PIC XX.
   779     12  PI-AH-OVERRIDE-L6               PIC X(6).
   780     12  PI-AH-OVERRIDE-L12              PIC X(12).
   781
   782     12  PI-NEW-SYSTEM                   PIC X(2).
   783
   784     12  PI-PRIMARY-CERT-NO              PIC X(11).
   785     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   786         88  PI-USES-PAID-TO                 VALUE '1'.
   787     12  PI-CRDTCRD-SYSTEM.
   788         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  18
* EL106.cbl
   789             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   790             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   791         16  PI-CC-MONTH-END-DT          PIC XX.
   792     12  PI-PROCESSOR-PRINTER            PIC X(4).
   793
   794     12  PI-OE-REFERENCE-2.
   795         16  PI-OE-REF-2-PRIME           PIC X(10).
   796         16  PI-OE-REF-2-SUFF            PIC X.
   797
   798     12  PI-REM-TRM-CALC-OPTION          PIC X.
   799
   800     12  PI-LANGUAGE-TYPE                PIC X.
   801             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   802             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   803             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   804
   805     12  PI-POLICY-LINKAGE-IND           PIC X.
   806         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   807         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   808                                                   LOW-VALUES.
   809
   810     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   811     12  PI-CLAIM-PW-SESSION             PIC X(1).
   812         88  PI-CLAIM-CREDIT                 VALUE '1'.
   813         88  PI-CLAIM-CONVEN                 VALUE '2'.
   814
   815     12  PI-PROCESSOR-CSR-IND            PIC X.
   816         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   817         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   818
   819     12  FILLER                          PIC X(3).
   820
   821     12  PI-SYSTEM-LEVEL                 PIC X(145).
   822
   823     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   824         PI-SYSTEM-LEVEL.
   825
   826         16  PI-ENTRY-CODES.
   827             20  PI-ENTRY-CD-1           PIC X.
   828             20  PI-ENTRY-CD-2           PIC X.
   829
   830         16  PI-RETURN-CODES.
   831             20  PI-RETURN-CD-1          PIC X.
   832             20  PI-RETURN-CD-2          PIC X.
   833
   834         16  PI-UPDATE-STATUS-SAVE.
   835             20  PI-UPDATE-BY            PIC X(4).
   836             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   837
   838         16  PI-LOWER-CASE-LETTERS       PIC X.
   839             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   840
   841*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   842*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   843*            88  CARRIER-CLM-CNTL            VALUE '2'.
   844
   845         16  PI-CERT-ACCESS-CONTROL      PIC X.
   846             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  19
* EL106.cbl
   847             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   848             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   849             88  ACCNT-CNTL                  VALUE '3'.
   850             88  CARR-ACCNT-CNTL             VALUE '4'.
   851
   852         16  PI-PROCESSOR-CAP-LIST.
   853             20  PI-SYSTEM-CONTROLS.
   854                24 PI-SYSTEM-DISPLAY     PIC X.
   855                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   856                24 PI-SYSTEM-MODIFY      PIC X.
   857                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   858             20  FILLER                  PIC XX.
   859             20  PI-DISPLAY-CAP          PIC X.
   860                 88  DISPLAY-CAP             VALUE 'Y'.
   861             20  PI-MODIFY-CAP           PIC X.
   862                 88  MODIFY-CAP              VALUE 'Y'.
   863             20  PI-MSG-AT-LOGON-CAP     PIC X.
   864                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   865             20  PI-FORCE-CAP            PIC X.
   866                 88  FORCE-CAP               VALUE 'Y'.
   867
   868         16  PI-PROGRAM-CONTROLS.
   869             20  PI-PGM-PRINT-OPT        PIC X.
   870             20  PI-PGM-FORMAT-OPT       PIC X.
   871             20  PI-PGM-PROCESS-OPT      PIC X.
   872             20  PI-PGM-TOTALS-OPT       PIC X.
   873
   874         16  PI-HELP-INTERFACE.
   875             20  PI-LAST-ERROR-NO        PIC X(4).
   876             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   877
   878         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   879             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   880
   881         16  PI-CR-CONTROL-IN-PROGRESS.
   882             20  PI-CR-CARRIER           PIC X.
   883             20  PI-CR-GROUPING          PIC X(6).
   884             20  PI-CR-STATE             PIC XX.
   885             20  PI-CR-ACCOUNT           PIC X(10).
   886             20  PI-CR-FIN-RESP          PIC X(10).
   887             20  PI-CR-TYPE              PIC X.
   888
   889         16  PI-CR-BATCH-NUMBER          PIC X(6).
   890
   891         16  PI-CR-MONTH-END-DT          PIC XX.
   892
   893         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   894             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   895             88  PI-ZERO-CARRIER             VALUE '1'.
   896             88  PI-ZERO-GROUPING            VALUE '2'.
   897             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   898
   899         16  PI-CARRIER-SECURITY         PIC X.
   900             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   901
   902         16  PI-ACCOUNT-SECURITY         PIC X(10).
   903             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   904             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  20
* EL106.cbl
   905
   906         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   907             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   908                                         INDEXED BY PI-ACCESS-NDX
   909                                         PIC X.
   910
   911         16  PI-GA-BILLING-CONTROL       PIC X.
   912             88  PI-GA-BILLING               VALUE '1'.
   913
   914         16  PI-MAIL-PROCESSING          PIC X.
   915             88  PI-MAIL-YES                 VALUE 'Y'.
   916
   917         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   918
   919         16  PI-AR-SYSTEM.
   920             20  PI-AR-PROCESSING-CNTL   PIC X.
   921                 88  PI-AR-PROCESSING        VALUE 'Y'.
   922             20  PI-AR-SUMMARY-CODE      PIC X(6).
   923             20  PI-AR-MONTH-END-DT      PIC XX.
   924
   925         16  PI-MP-SYSTEM.
   926             20  PI-MORTGAGE-USER            PIC X.
   927                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   928                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   929             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   930                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   931                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   932                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   933                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   934                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   935             20  PI-MP-MONTH-END-DT          PIC XX.
   936             20  PI-MP-REFERENCE-NO.
   937                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   938                 24  PI-MP-REFERENCE-SFX     PIC XX.
   939
   940         16  PI-LABEL-CONTROL            PIC X(01).
   941             88  PI-CREATE-LABELS                    VALUE 'Y'.
   942             88  PI-BYPASS-LABELS                    VALUE 'N'.
   943
   944         16  PI-BILL-GROUPING-CODE       PIC X(01).
   945             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   946
   947         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   948             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   949             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   950
   951         16  FILLER                      PIC X(14).
   952
   953     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   954******************************************************************
   955     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   956         16  FILLER              PIC X(101).
   957         16  PI-WS-STATE         PIC XX.
   958         16  PI-WS-CLASS         PIC XX.
   959         16  PI-WS-DEV           PIC XXX.
   960         16  PI-WS-TYPE          PIC X.
   961         16  PI-WS-PLAN          PIC XX.
   962         16  PI-PREV-STATE       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  21
* EL106.cbl
   963         16  FILLER              PIC X(525).
   964
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  22
* EL106.cbl
   966*    COPY ELCAID.
   967******************************************************************
   968*                                                                *
   969*                            ELCAID.                             *
   970*                            VMOD=2.001                          *
   971*                                                                *
   972*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   973*                                                                *
   974*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   975*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   976******************************************************************
   977
   978 01  DFHAID.
   979   02  DFHNULL   PIC  X  VALUE  ' '.
   980   02  DFHENTER  PIC  X  VALUE  QUOTE.
   981   02  DFHCLEAR  PIC  X  VALUE  '_'.
   982   02  DFHPEN    PIC  X  VALUE  '='.
   983   02  DFHOPID   PIC  X  VALUE  'W'.
   984   02  DFHPA1    PIC  X  VALUE  '%'.
   985   02  DFHPA2    PIC  X  VALUE  '>'.
   986   02  DFHPA3    PIC  X  VALUE  ','.
   987   02  DFHPF1    PIC  X  VALUE  '1'.
   988   02  DFHPF2    PIC  X  VALUE  '2'.
   989   02  DFHPF3    PIC  X  VALUE  '3'.
   990   02  DFHPF4    PIC  X  VALUE  '4'.
   991   02  DFHPF5    PIC  X  VALUE  '5'.
   992   02  DFHPF6    PIC  X  VALUE  '6'.
   993   02  DFHPF7    PIC  X  VALUE  '7'.
   994   02  DFHPF8    PIC  X  VALUE  '8'.
   995   02  DFHPF9    PIC  X  VALUE  '9'.
   996   02  DFHPF10   PIC  X  VALUE  ':'.
   997   02  DFHPF11   PIC  X  VALUE  '#'.
   998   02  DFHPF12   PIC  X  VALUE  '@'.
   999   02  DFHPF13   PIC  X  VALUE  'A'.
  1000   02  DFHPF14   PIC  X  VALUE  'B'.
  1001   02  DFHPF15   PIC  X  VALUE  'C'.
  1002   02  DFHPF16   PIC  X  VALUE  'D'.
  1003   02  DFHPF17   PIC  X  VALUE  'E'.
  1004   02  DFHPF18   PIC  X  VALUE  'F'.
  1005   02  DFHPF19   PIC  X  VALUE  'G'.
  1006   02  DFHPF20   PIC  X  VALUE  'H'.
  1007   02  DFHPF21   PIC  X  VALUE  'I'.
  1008*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1009   02  DFHPF22   PIC  X  VALUE  '['.
  1010   02  DFHPF23   PIC  X  VALUE  '.'.
  1011   02  DFHPF24   PIC  X  VALUE  '<'.
  1012   02  DFHMSRE   PIC  X  VALUE  'X'.
  1013   02  DFHSTRF   PIC  X  VALUE  'h'.
  1014   02  DFHTRIG   PIC  X  VALUE  '"'.
  1015 01  FILLER REDEFINES DFHAID.
  1016     12  FILLER              PIC X(8).
  1017     12  PF-VALUES           PIC X       OCCURS 2.
  1018
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  23
* EL106.cbl
  1020*    COPY EL106S.
  1021 01  EL106AI.
  1022     05  FILLER            PIC  X(0012).
  1023*    -------------------------------
  1024     05  RUNDTEL PIC S9(0004) COMP.
  1025     05  RUNDTEF PIC  X(0001).
  1026     05  FILLER REDEFINES RUNDTEF.
  1027         10  RUNDTEA PIC  X(0001).
  1028     05  RUNDTEI PIC  X(0008).
  1029*    -------------------------------
  1030     05  RUNTIMEL PIC S9(0004) COMP.
  1031     05  RUNTIMEF PIC  X(0001).
  1032     05  FILLER REDEFINES RUNTIMEF.
  1033         10  RUNTIMEA PIC  X(0001).
  1034     05  RUNTIMEI PIC  X(0005).
  1035*    -------------------------------
  1036     05  MAINTL PIC S9(0004) COMP.
  1037     05  MAINTF PIC  X(0001).
  1038     05  FILLER REDEFINES MAINTF.
  1039         10  MAINTA PIC  X(0001).
  1040     05  MAINTI PIC  X(0001).
  1041*    -------------------------------
  1042     05  LSTUSRL PIC S9(0004) COMP.
  1043     05  LSTUSRF PIC  X(0001).
  1044     05  FILLER REDEFINES LSTUSRF.
  1045         10  LSTUSRA PIC  X(0001).
  1046     05  LSTUSRI PIC  X(0004).
  1047*    -------------------------------
  1048     05  LSTDTEL PIC S9(0004) COMP.
  1049     05  LSTDTEF PIC  X(0001).
  1050     05  FILLER REDEFINES LSTDTEF.
  1051         10  LSTDTEA PIC  X(0001).
  1052     05  LSTDTEI PIC  X(0008).
  1053*    -------------------------------
  1054     05  LSTTIMEL PIC S9(0004) COMP.
  1055     05  LSTTIMEF PIC  X(0001).
  1056     05  FILLER REDEFINES LSTTIMEF.
  1057         10  LSTTIMEA PIC  X(0001).
  1058     05  LSTTIMEI PIC  X(0005).
  1059*    -------------------------------
  1060     05  STCDL PIC S9(0004) COMP.
  1061     05  STCDF PIC  X(0001).
  1062     05  FILLER REDEFINES STCDF.
  1063         10  STCDA PIC  X(0001).
  1064     05  STCDI PIC  X(0002).
  1065*    -------------------------------
  1066     05  STABRL PIC S9(0004) COMP.
  1067     05  STABRF PIC  X(0001).
  1068     05  FILLER REDEFINES STABRF.
  1069         10  STABRA PIC  X(0001).
  1070     05  STABRI PIC  X(0002).
  1071*    -------------------------------
  1072     05  STNAMEL PIC S9(0004) COMP.
  1073     05  STNAMEF PIC  X(0001).
  1074     05  FILLER REDEFINES STNAMEF.
  1075         10  STNAMEA PIC  X(0001).
  1076     05  STNAMEI PIC  X(0025).
  1077*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  24
* EL106.cbl
  1078     05  LEXPLBLL PIC S9(0004) COMP.
  1079     05  LEXPLBLF PIC  X(0001).
  1080     05  FILLER REDEFINES LEXPLBLF.
  1081         10  LEXPLBLA PIC  X(0001).
  1082     05  LEXPLBLI PIC  X(0006).
  1083*    -------------------------------
  1084     05  LFEXPL PIC S9(0004) COMP.
  1085     05  LFEXPF PIC  X(0001).
  1086     05  FILLER REDEFINES LFEXPF.
  1087         10  LFEXPA PIC  X(0001).
  1088     05  LFEXPI PIC  S9(3)V9999.
  1089*    -------------------------------
  1090     05  AEXPLBLL PIC S9(0004) COMP.
  1091     05  AEXPLBLF PIC  X(0001).
  1092     05  FILLER REDEFINES AEXPLBLF.
  1093         10  AEXPLBLA PIC  X(0001).
  1094     05  AEXPLBLI PIC  X(0006).
  1095*    -------------------------------
  1096     05  AHEXPL PIC S9(0004) COMP.
  1097     05  AHEXPF PIC  X(0001).
  1098     05  FILLER REDEFINES AHEXPF.
  1099         10  AHEXPA PIC  X(0001).
  1100     05  AHEXPI PIC  S9(3)V9999.
  1101*    -------------------------------
  1102     05  REMTERML PIC S9(0004) COMP.
  1103     05  REMTERMF PIC  X(0001).
  1104     05  FILLER REDEFINES REMTERMF.
  1105         10  REMTERMA PIC  X(0001).
  1106     05  REMTERMI PIC  X(0001).
  1107*    -------------------------------
  1108     05  QUOTCALL PIC S9(0004) COMP.
  1109     05  QUOTCALF PIC  X(0001).
  1110     05  FILLER REDEFINES QUOTCALF.
  1111         10  QUOTCALA PIC  X(0001).
  1112     05  QUOTCALI PIC  S9(4)V99.
  1113*    -------------------------------
  1114     05  PREMTOLL PIC S9(0004) COMP.
  1115     05  PREMTOLF PIC  X(0001).
  1116     05  FILLER REDEFINES PREMTOLF.
  1117         10  PREMTOLA PIC  X(0001).
  1118     05  PREMTOLI PIC  S9(4)V99.
  1119*    -------------------------------
  1120     05  REFTOLL PIC S9(0004) COMP.
  1121     05  REFTOLF PIC  X(0001).
  1122     05  FILLER REDEFINES REFTOLF.
  1123         10  REFTOLA PIC  X(0001).
  1124     05  REFTOLI PIC  S9(4)V99.
  1125*    -------------------------------
  1126     05  PRMPCTL PIC S9(0004) COMP.
  1127     05  PRMPCTF PIC  X(0001).
  1128     05  FILLER REDEFINES PRMPCTF.
  1129         10  PRMPCTA PIC  X(0001).
  1130     05  PRMPCTI PIC  S9(1)V9(4).
  1131*    -------------------------------
  1132     05  REFPCTL PIC S9(0004) COMP.
  1133     05  REFPCTF PIC  X(0001).
  1134     05  FILLER REDEFINES REFPCTF.
  1135         10  REFPCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  25
* EL106.cbl
  1136     05  REFPCTI PIC  S9(1)V9(4).
  1137*    -------------------------------
  1138     05  OVSAMTL PIC S9(0004) COMP.
  1139     05  OVSAMTF PIC  X(0001).
  1140     05  FILLER REDEFINES OVSAMTF.
  1141         10  OVSAMTA PIC  X(0001).
  1142     05  OVSAMTI PIC  S9(4)V99.
  1143*    -------------------------------
  1144     05  OVSPCTL PIC S9(0004) COMP.
  1145     05  OVSPCTF PIC  X(0001).
  1146     05  FILLER REDEFINES OVSPCTF.
  1147         10  OVSPCTA PIC  X(0001).
  1148     05  OVSPCTI PIC  S9(1)V9(4).
  1149*    -------------------------------
  1150     05  CLREJECL PIC S9(0004) COMP.
  1151     05  CLREJECF PIC  X(0001).
  1152     05  FILLER REDEFINES CLREJECF.
  1153         10  CLREJECA PIC  X(0001).
  1154     05  CLREJECI PIC  X(0001).
  1155*    -------------------------------
  1156     05  ISSREJL PIC S9(0004) COMP.
  1157     05  ISSREJF PIC  X(0001).
  1158     05  FILLER REDEFINES ISSREJF.
  1159         10  ISSREJA PIC  X(0001).
  1160     05  ISSREJI PIC  X(0001).
  1161*    -------------------------------
  1162     05  REFREJL PIC S9(0004) COMP.
  1163     05  REFREJF PIC  X(0001).
  1164     05  FILLER REDEFINES REFREJF.
  1165         10  REFREJA PIC  X(0001).
  1166     05  REFREJI PIC  X(0001).
  1167*    -------------------------------
  1168     05  REFMINL PIC S9(0004) COMP.
  1169     05  REFMINF PIC  X(0001).
  1170     05  FILLER REDEFINES REFMINF.
  1171         10  REFMINA PIC  X(0001).
  1172     05  REFMINI PIC  S9(4)V99.
  1173*    -------------------------------
  1174     05  REFDAY1L PIC S9(0004) COMP.
  1175     05  REFDAY1F PIC  X(0001).
  1176     05  FILLER REDEFINES REFDAY1F.
  1177         10  REFDAY1A PIC  X(0001).
  1178     05  REFDAY1I PIC  X(0002).
  1179*    -------------------------------
  1180     05  REFDAYSL PIC S9(0004) COMP.
  1181     05  REFDAYSF PIC  X(0001).
  1182     05  FILLER REDEFINES REFDAYSF.
  1183         10  REFDAYSA PIC  X(0001).
  1184     05  REFDAYSI PIC  X(0002).
  1185*    -------------------------------
  1186     05  SPLPMTL PIC S9(0004) COMP.
  1187     05  SPLPMTF PIC  X(0001).
  1188     05  FILLER REDEFINES SPLPMTF.
  1189         10  SPLPMTA PIC  X(0001).
  1190     05  SPLPMTI PIC  X(0001).
  1191*    -------------------------------
  1192     05  STUEL PIC S9(0004) COMP.
  1193     05  STUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  26
* EL106.cbl
  1194     05  FILLER REDEFINES STUEF.
  1195         10  STUEA PIC  X(0001).
  1196     05  STUEI PIC  X(0001).
  1197*    -------------------------------
  1198     05  STCNTLL PIC S9(0004) COMP.
  1199     05  STCNTLF PIC  X(0001).
  1200     05  FILLER REDEFINES STCNTLF.
  1201         10  STCNTLA PIC  X(0001).
  1202     05  STCNTLI PIC  X(0001).
  1203*    -------------------------------
  1204     05  STDEVL PIC S9(0004) COMP.
  1205     05  STDEVF PIC  X(0001).
  1206     05  FILLER REDEFINES STDEVF.
  1207         10  STDEVA PIC  X(0001).
  1208     05  STDEVI PIC  X(0003).
  1209*    -------------------------------
  1210     05  EXTDAYSL PIC S9(0004) COMP.
  1211     05  EXTDAYSF PIC  X(0001).
  1212     05  FILLER REDEFINES EXTDAYSF.
  1213         10  EXTDAYSA PIC  X(0001).
  1214     05  EXTDAYSI PIC  X(0003).
  1215*    -------------------------------
  1216     05  EXTCHGL PIC S9(0004) COMP.
  1217     05  EXTCHGF PIC  X(0001).
  1218     05  FILLER REDEFINES EXTCHGF.
  1219         10  EXTCHGA PIC  X(0001).
  1220     05  EXTCHGI PIC  X(0001).
  1221*    -------------------------------
  1222     05  LFTAXL PIC S9(0004) COMP.
  1223     05  LFTAXF PIC  X(0001).
  1224     05  FILLER REDEFINES LFTAXF.
  1225         10  LFTAXA PIC  X(0001).
  1226     05  LFTAXI PIC  S9(1)V9(4).
  1227*    -------------------------------
  1228     05  REPLAWL PIC S9(0004) COMP.
  1229     05  REPLAWF PIC  X(0001).
  1230     05  FILLER REDEFINES REPLAWF.
  1231         10  REPLAWA PIC  X(0001).
  1232     05  REPLAWI PIC  X(0001).
  1233*    -------------------------------
  1234     05  REPLETRL PIC S9(0004) COMP.
  1235     05  REPLETRF PIC  X(0001).
  1236     05  FILLER REDEFINES REPLETRF.
  1237         10  REPLETRA PIC  X(0001).
  1238     05  REPLETRI PIC  X(0004).
  1239*    -------------------------------
  1240     05  AHITAXL PIC S9(0004) COMP.
  1241     05  AHITAXF PIC  X(0001).
  1242     05  FILLER REDEFINES AHITAXF.
  1243         10  AHITAXA PIC  X(0001).
  1244     05  AHITAXI PIC  S9(1)V9(4).
  1245*    -------------------------------
  1246     05  TARRATL PIC S9(0004) COMP.
  1247     05  TARRATF PIC  X(0001).
  1248     05  FILLER REDEFINES TARRATF.
  1249         10  TARRATA PIC  X(0001).
  1250     05  TARRATI PIC  S9(2)V9(4).
  1251*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  27
* EL106.cbl
  1252     05  CALCINTL PIC S9(0004) COMP.
  1253     05  CALCINTF PIC  X(0001).
  1254     05  FILLER REDEFINES CALCINTF.
  1255         10  CALCINTA PIC  X(0001).
  1256     05  CALCINTI PIC  S9(2)V9(4).
  1257*    -------------------------------
  1258     05  AHGTAXL PIC S9(0004) COMP.
  1259     05  AHGTAXF PIC  X(0001).
  1260     05  FILLER REDEFINES AHGTAXF.
  1261         10  AHGTAXA PIC  X(0001).
  1262     05  AHGTAXI PIC  S9(1)V9(4).
  1263*    -------------------------------
  1264     05  COMSLL PIC S9(0004) COMP.
  1265     05  COMSLF PIC  X(0001).
  1266     05  FILLER REDEFINES COMSLF.
  1267         10  COMSLA PIC  X(0001).
  1268     05  COMSLI PIC  S99V9(4).
  1269*    -------------------------------
  1270     05  LIMITL PIC S9(0004) COMP.
  1271     05  LIMITF PIC  X(0001).
  1272     05  FILLER REDEFINES LIMITF.
  1273         10  LIMITA PIC  X(0001).
  1274     05  LIMITI PIC  X(0001).
  1275*    -------------------------------
  1276     05  COMJLL PIC S9(0004) COMP.
  1277     05  COMJLF PIC  X(0001).
  1278     05  FILLER REDEFINES COMJLF.
  1279         10  COMJLA PIC  X(0001).
  1280     05  COMJLI PIC  S99V9(4).
  1281*    -------------------------------
  1282     05  LFREDL PIC S9(0004) COMP.
  1283     05  LFREDF PIC  X(0001).
  1284     05  FILLER REDEFINES LFREDF.
  1285         10  LFREDA PIC  X(0001).
  1286     05  LFREDI PIC  X(0001).
  1287*    -------------------------------
  1288     05  LFLEVL PIC S9(0004) COMP.
  1289     05  LFLEVF PIC  X(0001).
  1290     05  FILLER REDEFINES LFLEVF.
  1291         10  LFLEVA PIC  X(0001).
  1292     05  LFLEVI PIC  X(0001).
  1293*    -------------------------------
  1294     05  LFNETL PIC S9(0004) COMP.
  1295     05  LFNETF PIC  X(0001).
  1296     05  FILLER REDEFINES LFNETF.
  1297         10  LFNETA PIC  X(0001).
  1298     05  LFNETI PIC  X(0001).
  1299*    -------------------------------
  1300     05  COMSAL PIC S9(0004) COMP.
  1301     05  COMSAF PIC  X(0001).
  1302     05  FILLER REDEFINES COMSAF.
  1303         10  COMSAA PIC  X(0001).
  1304     05  COMSAI PIC  S99V9(4).
  1305*    -------------------------------
  1306     05  AHAHL PIC S9(0004) COMP.
  1307     05  AHAHF PIC  X(0001).
  1308     05  FILLER REDEFINES AHAHF.
  1309         10  AHAHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  28
* EL106.cbl
  1310     05  AHAHI PIC  X(0001).
  1311*    -------------------------------
  1312     05  AHCPL PIC S9(0004) COMP.
  1313     05  AHCPF PIC  X(0001).
  1314     05  FILLER REDEFINES AHCPF.
  1315         10  AHCPA PIC  X(0001).
  1316     05  AHCPI PIC  X(0001).
  1317*    -------------------------------
  1318     05  COMJAL PIC S9(0004) COMP.
  1319     05  COMJAF PIC  X(0001).
  1320     05  FILLER REDEFINES COMJAF.
  1321         10  COMJAA PIC  X(0001).
  1322     05  COMJAI PIC  S99V9(4).
  1323*    -------------------------------
  1324     05  STCHKHDL PIC S9(0004) COMP.
  1325     05  STCHKHDF PIC  X(0001).
  1326     05  FILLER REDEFINES STCHKHDF.
  1327         10  STCHKHDA PIC  X(0001).
  1328     05  STCHKHDI PIC  X(0013).
  1329*    -------------------------------
  1330     05  STCHKNOL PIC S9(0004) COMP.
  1331     05  STCHKNOF PIC  X(0001).
  1332     05  FILLER REDEFINES STCHKNOF.
  1333         10  STCHKNOA PIC  X(0001).
  1334     05  STCHKNOI PIC  9(8).
  1335*    -------------------------------
  1336     05  RESTAXL PIC S9(0004) COMP.
  1337     05  RESTAXF PIC  X(0001).
  1338     05  FILLER REDEFINES RESTAXF.
  1339         10  RESTAXA PIC  X(0001).
  1340     05  RESTAXI PIC  S99V9(4).
  1341*    -------------------------------
  1342     05  FREELKL PIC S9(0004) COMP.
  1343     05  FREELKF PIC  X(0001).
  1344     05  FILLER REDEFINES FREELKF.
  1345         10  FREELKA PIC  X(0001).
  1346     05  FREELKI PIC  X(0003).
  1347*    -------------------------------
  1348     05  CAUSALL PIC S9(0004) COMP.
  1349     05  CAUSALF PIC  X(0001).
  1350     05  FILLER REDEFINES CAUSALF.
  1351         10  CAUSALA PIC  X(0001).
  1352     05  CAUSALI PIC  X(0001).
  1353*    -------------------------------
  1354     05  REFCLML PIC S9(0004) COMP.
  1355     05  REFCLMF PIC  X(0001).
  1356     05  FILLER REDEFINES REFCLMF.
  1357         10  REFCLMA PIC  X(0001).
  1358     05  REFCLMI PIC  X(0001).
  1359*    -------------------------------
  1360     05  VFYBENEL PIC S9(0004) COMP.
  1361     05  VFYBENEF PIC  X(0001).
  1362     05  FILLER REDEFINES VFYBENEF.
  1363         10  VFYBENEA PIC  X(0001).
  1364     05  VFYBENEI PIC  X(0001).
  1365*    -------------------------------
  1366     05  ERRMSG1L PIC S9(0004) COMP.
  1367     05  ERRMSG1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  29
* EL106.cbl
  1368     05  FILLER REDEFINES ERRMSG1F.
  1369         10  ERRMSG1A PIC  X(0001).
  1370     05  ERRMSG1I PIC  X(0076).
  1371*    -------------------------------
  1372     05  ERRMSG2L PIC S9(0004) COMP.
  1373     05  ERRMSG2F PIC  X(0001).
  1374     05  FILLER REDEFINES ERRMSG2F.
  1375         10  ERRMSG2A PIC  X(0001).
  1376     05  ERRMSG2I PIC  X(0076).
  1377*    -------------------------------
  1378     05  ENTERPFL PIC S9(0004) COMP.
  1379     05  ENTERPFF PIC  X(0001).
  1380     05  FILLER REDEFINES ENTERPFF.
  1381         10  ENTERPFA PIC  X(0001).
  1382     05  ENTERPFI PIC  9(2).
  1383 01  EL106AO REDEFINES EL106AI.
  1384     05  FILLER            PIC  X(0012).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  RUNDTEO PIC  X(0008).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  RUNTIMEO PIC  99.99.
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  MAINTO PIC  X(0001).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  LSTUSRO PIC  X(0004).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  LSTDTEO PIC  X(0008).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  LSTTIMEO PIC  99.99.
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  STCDO PIC  X(0002).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  STABRO PIC  X(0002).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  STNAMEO PIC  X(0025).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  LEXPLBLO PIC  X(0006).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  LFEXPO PIC  99.9999.
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  AEXPLBLO PIC  X(0006).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  AHEXPO PIC  99.9999.
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  30
* EL106.cbl
  1426     05  REMTERMO PIC  X(0001).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  QUOTCALO PIC  ZZ9.99.
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  PREMTOLO PIC  ZZ9.99.
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  REFTOLO PIC  ZZ9.99.
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  PRMPCTO PIC  .9999.
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  REFPCTO PIC  .9999.
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  OVSAMTO PIC  ZZ9.99.
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  OVSPCTO PIC  .9999.
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  CLREJECO PIC  X(0001).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  ISSREJO PIC  X(0001).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  REFREJO PIC  X(0001).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  REFMINO PIC  ZZ9.99.
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  REFDAY1O PIC  99.
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  REFDAYSO PIC  99.
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  SPLPMTO PIC  X(0001).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  STUEO PIC  X(0001).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  STCNTLO PIC  X(0001).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  STDEVO PIC  X(0003).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  EXTDAYSO PIC  999.
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  EXTCHGO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  31
* EL106.cbl
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  LFTAXO PIC  .9999.
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  REPLAWO PIC  X(0001).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  REPLETRO PIC  X(0004).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  AHITAXO PIC  .9999.
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  TARRATO PIC  9.9999.
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  CALCINTO PIC  9.9999.
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  AHGTAXO PIC  .9999.
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  COMSLO PIC  9.9999.
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  LIMITO PIC  X(0001).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  COMJLO PIC  9.9999.
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  LFREDO PIC  X(0001).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  LFLEVO PIC  X(0001).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  LFNETO PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  COMSAO PIC  9.9999.
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  AHAHO PIC  X(0001).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  AHCPO PIC  X(0001).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  COMJAO PIC  9.9999.
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  STCHKHDO PIC  X(0013).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  STCHKNOO PIC  9(8).
  1541*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  32
* EL106.cbl
  1542     05  FILLER            PIC  X(0003).
  1543     05  RESTAXO PIC  9.9999.
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  FREELKO PIC  999.
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  CAUSALO PIC  X(0001).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  REFCLMO PIC  X(0001).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  VFYBENEO PIC  X(0001).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  ERRMSG1O PIC  X(0076).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  ERRMSG2O PIC  X(0076).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  ENTERPFO PIC  X(0002).
  1565*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  33
* EL106.cbl
  1567****************************************************************
  1568*
  1569* Copyright (c) 2007 by Clerity Solutions, Inc.
  1570* All rights reserved.
  1571*
  1572****************************************************************
  1573 01  DFHEIV.
  1574   02  DFHEIV0               PIC X(35).
  1575   02  DFHEIV1               PIC X(08).
  1576   02  DFHEIV2               PIC X(08).
  1577   02  DFHEIV3               PIC X(08).
  1578   02  DFHEIV4               PIC X(06).
  1579   02  DFHEIV5               PIC X(04).
  1580   02  DFHEIV6               PIC X(04).
  1581   02  DFHEIV7               PIC X(02).
  1582   02  DFHEIV8               PIC X(02).
  1583   02  DFHEIV9               PIC X(01).
  1584   02  DFHEIV10              PIC S9(7) COMP-3.
  1585   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1586   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1587   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1588   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1589   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1590   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1591   02  DFHEIV17              PIC X(04).
  1592   02  DFHEIV18              PIC X(04).
  1593   02  DFHEIV19              PIC X(04).
  1594   02  DFHEIV20              USAGE IS POINTER.
  1595   02  DFHEIV21              USAGE IS POINTER.
  1596   02  DFHEIV22              USAGE IS POINTER.
  1597   02  DFHEIV23              USAGE IS POINTER.
  1598   02  DFHEIV24              USAGE IS POINTER.
  1599   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1600   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1601   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1602   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1603   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1604   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1605   02  FILLER                PIC X(02).
  1606   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1607   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1608   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1609   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1610   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1611 LINKAGE  SECTION.
  1612*****************************************************************
  1613*                                                               *
  1614* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1615* All rights reserved.                                          *
  1616*                                                               *
  1617*****************************************************************
  1618 01  dfheiblk.
  1619     02  eibtime          pic s9(7) comp-3.
  1620     02  eibdate          pic s9(7) comp-3.
  1621     02  eibtrnid         pic x(4).
  1622     02  eibtaskn         pic s9(7) comp-3.
  1623     02  eibtrmid         pic x(4).
  1624     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  34
* EL106.cbl
  1625     02  eibcposn         pic s9(4) comp.
  1626     02  eibcalen         pic s9(4) comp.
  1627     02  eibaid           pic x(1).
  1628     02  eibfiller1       pic x(1).
  1629     02  eibfn            pic x(2).
  1630     02  eibfiller2       pic x(2).
  1631     02  eibrcode         pic x(6).
  1632     02  eibfiller3       pic x(2).
  1633     02  eibds            pic x(8).
  1634     02  eibreqid         pic x(8).
  1635     02  eibrsrce         pic x(8).
  1636     02  eibsync          pic x(1).
  1637     02  eibfree          pic x(1).
  1638     02  eibrecv          pic x(1).
  1639     02  eibsend          pic x(1).
  1640     02  eibatt           pic x(1).
  1641     02  eibeoc           pic x(1).
  1642     02  eibfmh           pic x(1).
  1643     02  eibcompl         pic x(1).
  1644     02  eibsig           pic x(1).
  1645     02  eibconf          pic x(1).
  1646     02  eiberr           pic x(1).
  1647     02  eibrldbk         pic x(1).
  1648     02  eiberrcd         pic x(4).
  1649     02  eibsynrb         pic x(1).
  1650     02  eibnodat         pic x(1).
  1651     02  eibfiller5       pic x(2).
  1652     02  eibresp          pic 9(09) comp.
  1653     02  eibresp2         pic 9(09) comp.
  1654     02  dfheigdj         pic s9(4) comp.
  1655     02  dfheigdk         pic s9(4) comp.
  1656 01  DFHCOMMAREA             PIC X(1500).
  1657*01 PARMLIST .
  1658*    02  FILLER              PIC S9(8)   COMP.
  1659*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1660*    02  ELLETR-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  35
* EL106.cbl
  1662*    COPY ELCCNTL.
  1663******************************************************************
  1664*                                                                *
  1665*                                                                *
  1666*                            ELCCNTL.                            *
  1667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1668*                            VMOD=2.059                          *
  1669*                                                                *
  1670*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1671*                                                                *
  1672*   FILE TYPE = VSAM,KSDS                                        *
  1673*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1674*                                                                *
  1675*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1676*       ALTERNATE INDEX = NONE                                   *
  1677*                                                                *
  1678*   LOG = YES                                                    *
  1679*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1680******************************************************************
  1681*                   C H A N G E   L O G
  1682*
  1683* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1684*-----------------------------------------------------------------
  1685*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1686* EFFECTIVE    NUMBER
  1687*-----------------------------------------------------------------
  1688* 082503                   PEMA  ADD BENEFIT GROUP
  1689* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1690* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1691* 092705    2005050300006  PEMA  ADD SPP LEASES
  1692* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1693* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1694* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1695* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1696* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1697* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1698* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1699* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1700* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1701******************************************************************
  1702*
  1703 01  CONTROL-FILE.
  1704     12  CF-RECORD-ID                       PIC XX.
  1705         88  VALID-CF-ID                        VALUE 'CF'.
  1706
  1707     12  CF-CONTROL-PRIMARY.
  1708         16  CF-COMPANY-ID                  PIC XXX.
  1709         16  CF-RECORD-TYPE                 PIC X.
  1710             88  CF-COMPANY-MASTER              VALUE '1'.
  1711             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1712             88  CF-STATE-MASTER                VALUE '3'.
  1713             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1714             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1715             88  CF-CARRIER-MASTER              VALUE '6'.
  1716             88  CF-MORTALITY-MASTER            VALUE '7'.
  1717             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1718             88  CF-TERMINAL-MASTER             VALUE '9'.
  1719             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  36
* EL106.cbl
  1720             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1721             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1722             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1723             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1724             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1725             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1726             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1727             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1728         16  CF-ACCESS-CD-GENL              PIC X(4).
  1729         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1730             20  CF-PROCESSOR               PIC X(4).
  1731         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1732             20  CF-STATE-CODE              PIC XX.
  1733             20  FILLER                     PIC XX.
  1734         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1735             20  FILLER                     PIC XX.
  1736             20  CF-HI-BEN-IN-REC           PIC XX.
  1737         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1738             20  FILLER                     PIC XXX.
  1739             20  CF-CARRIER-CNTL            PIC X.
  1740         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1741             20  FILLER                     PIC XX.
  1742             20  CF-HI-TYPE-IN-REC          PIC 99.
  1743         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1744             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1745                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1746             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1747             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1748         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1749             20  FILLER                     PIC X.
  1750             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1751         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1752             20  FILLER                     PIC XX.
  1753             20  CF-MORTGAGE-PLAN           PIC XX.
  1754         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1755
  1756     12  CF-LAST-MAINT-DT                   PIC XX.
  1757     12  CF-LAST-MAINT-BY                   PIC X(4).
  1758     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1759
  1760     12  CF-RECORD-BODY                     PIC X(728).
  1761
  1762
  1763****************************************************************
  1764*             COMPANY MASTER RECORD                            *
  1765****************************************************************
  1766
  1767     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1768         16  CF-COMPANY-ADDRESS.
  1769             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1770             20  CF-CL-IN-CARE-OF           PIC X(30).
  1771             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1772             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1773             20  CF-CL-CITY-STATE           PIC X(30).
  1774             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1775             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1776         16  CF-COMPANY-CD                  PIC X.
  1777         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  37
* EL106.cbl
  1778         16  CF-SECURITY-OPTION             PIC X.
  1779             88  ALL-SECURITY                   VALUE '1'.
  1780             88  COMPANY-VERIFY                 VALUE '2'.
  1781             88  PROCESSOR-VERIFY               VALUE '3'.
  1782             88  NO-SECURITY                    VALUE '4'.
  1783             88  ALL-BUT-TERM                   VALUE '5'.
  1784         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1785             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1786         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1787             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1788         16  CF-INFORCE-LOCATION            PIC X.
  1789             88  CERTS-ARE-ONLINE               VALUE '1'.
  1790             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1791             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1792         16  CF-LOWER-CASE-LETTERS          PIC X.
  1793         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1794             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1795             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1796             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1797             88  CF-ACCNT-CNTL                  VALUE '3'.
  1798             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1799
  1800         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1801         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1802
  1803         16  CF-LGX-CREDIT-USER             PIC X.
  1804             88  CO-IS-NOT-USER                 VALUE 'N'.
  1805             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1806
  1807         16 CF-CREDIT-CALC-CODES.
  1808             20  CF-CR-REM-TERM-CALC PIC X.
  1809               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1810               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1811               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1812               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1813               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1814               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1815               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1816             20  CF-CR-R78-METHOD           PIC X.
  1817               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1818               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1819
  1820         16  CF-CLAIM-CONTROL-COUNTS.
  1821             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1822                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1823
  1824             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1825                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1826
  1827             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1828                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1829
  1830             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1831                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1832
  1833         16  CF-CURRENT-MONTH-END           PIC XX.
  1834
  1835         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  38
* EL106.cbl
  1836             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1837             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1838             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1839             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1840                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1841                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1842             20  CF-CO-PREM-REJECT-SW       PIC X.
  1843                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1844                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1845             20  CF-CO-REF-REJECT-SW        PIC X.
  1846                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1847                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1848
  1849         16  CF-CO-REPORTING-DT             PIC XX.
  1850         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1851         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1852           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1853           88  CF-CO-MONTH-END                  VALUE '1'.
  1854
  1855         16  CF-LGX-CLAIM-USER              PIC X.
  1856             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1857             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1858
  1859         16  CF-CREDIT-EDIT-CONTROLS.
  1860             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1861             20  CF-MIN-AGE                 PIC 99.
  1862             20  CF-DEFAULT-AGE             PIC 99.
  1863             20  CF-MIN-TERM                PIC S999      COMP-3.
  1864             20  CF-MAX-TERM                PIC S999      COMP-3.
  1865             20  CF-DEFAULT-SEX             PIC X.
  1866             20  CF-JOINT-AGE-INPUT         PIC X.
  1867                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1868             20  CF-BIRTH-DATE-INPUT        PIC X.
  1869                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1870             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1871                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1872                 88  CF-ZERO-CARRIER            VALUE '1'.
  1873                 88  CF-ZERO-GROUPING           VALUE '2'.
  1874                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1875             20  CF-EDIT-SW                 PIC X.
  1876                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1877             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1878             20  CF-CR-PR-METHOD            PIC X.
  1879               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1880               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1881             20  FILLER                     PIC X.
  1882
  1883         16  CF-CREDIT-MISC-CONTROLS.
  1884             20  CF-REIN-TABLE-SW           PIC X.
  1885                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1886             20  CF-COMP-TABLE-SW           PIC X.
  1887                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1888             20  CF-EXPERIENCE-RETENTION-AGE
  1889                                            PIC S9        COMP-3.
  1890             20  CF-CONVERSION-DT           PIC XX.
  1891             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1892             20  CF-RUN-FREQUENCY-SW        PIC X.
  1893                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  39
* EL106.cbl
  1894                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1895
  1896             20  CF-CR-CHECK-NO-CONTROL.
  1897                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1898                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1899                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1900                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1901                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1902                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1903
  1904                 24  CF-CR-CHECK-COUNT       REDEFINES
  1905                     CF-CR-CHECK-COUNTER      PIC X(4).
  1906
  1907                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1908                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1909
  1910                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1911                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1912                 24  CF-MAIL-PROCESSING       PIC X.
  1913                     88  MAIL-PROCESSING          VALUE 'Y'.
  1914
  1915         16  CF-MISC-SYSTEM-CONTROL.
  1916             20  CF-SYSTEM-C                 PIC X.
  1917                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1918             20  CF-SYSTEM-D                 PIC X.
  1919                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1920             20  CF-SOC-SEC-NO-SW            PIC X.
  1921                 88  SOC-SEC-NO-USED             VALUE '1'.
  1922             20  CF-MEMBER-NO-SW             PIC X.
  1923                 88  MEMBER-NO-USED              VALUE '1'.
  1924             20  CF-TAX-ID-NUMBER            PIC X(11).
  1925             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1926             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1927                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1928                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1929                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1930                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1931             20  CF-SYSTEM-E                 PIC X.
  1932                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1933
  1934         16  CF-LGX-LIFE-USER               PIC X.
  1935             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1936             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1937
  1938         16  CF-CR-MONTH-END-DT             PIC XX.
  1939
  1940         16  CF-FILE-MAINT-DATES.
  1941             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1942                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1943             20  CF-LAST-BATCH       REDEFINES
  1944                 CF-LAST-BATCH-NO               PIC X(4).
  1945             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1946             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1947             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1948             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1949             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1950             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1951             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  40
* EL106.cbl
  1952             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1953             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1954             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1955
  1956         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1957         16  FILLER                         PIC X.
  1958
  1959         16  CF-ALT-MORT-CODE               PIC X(4).
  1960         16  CF-MEMBER-CAPTION              PIC X(10).
  1961
  1962         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1963             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1964             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1965             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1966             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1967             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1968
  1969         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1970
  1971         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1972         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1973         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1974         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1975
  1976         16  CF-AH-OVERRIDE-L1              PIC X.
  1977         16  CF-AH-OVERRIDE-L2              PIC XX.
  1978         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1979         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1980
  1981         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1982         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1983
  1984         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1985         16  CF-AR-LAST-EL860-DT            PIC XX.
  1986         16  CF-MP-MONTH-END-DT             PIC XX.
  1987
  1988         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1989         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1990             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1991
  1992         16  CF-AR-MONTH-END-DT             PIC XX.
  1993
  1994         16  CF-CRDTCRD-USER                PIC X.
  1995             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1996             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1997
  1998         16  CF-CC-MONTH-END-DT             PIC XX.
  1999
  2000         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2001
  2002         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2003             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2004             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2005             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2006         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2007         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2008         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2009         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  41
* EL106.cbl
  2010             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2011             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2012         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2013         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2014         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2015             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2016         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2017
  2018         16  CF-CL-ZIP-CODE.
  2019             20  CF-CL-ZIP-PRIME.
  2020                 24  CF-CL-ZIP-1ST          PIC X.
  2021                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2022                 24  FILLER                 PIC X(4).
  2023             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2024         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2025             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2026             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2027             20  FILLER                     PIC XXX.
  2028
  2029         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2030         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2031         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2032         16  CF-CO-OPTION-START-DATE        PIC XX.
  2033         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2034           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2035                                                      '3' '4'.
  2036           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2037           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2038           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2039           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2040           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2041           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2042
  2043         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2044
  2045         16  CF-PAYMENT-APPROVAL-LEVELS.
  2046             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2047             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2048             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2049             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2050             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2051             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2052
  2053         16  CF-END-USER-REPORTING-USER     PIC X.
  2054             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2055             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2056
  2057         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2058             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2059             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2060
  2061         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2062
  2063         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2064         16  FILLER                         PIC X.
  2065
  2066         16  CF-CREDIT-ARCHIVE-CNTL.
  2067             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  42
* EL106.cbl
  2068             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2069             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2070
  2071         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2072
  2073         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2074             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2075             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2076
  2077         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2078             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2079             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2080
  2081         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2082
  2083         16  CF-CO-ACH-ID-CODE              PIC  X.
  2084             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2085             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2086             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2087         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2088         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2089         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2090         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2091         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2092         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2093         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2094         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2095         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2096                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2097         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2098                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2099
  2100         16  CF-CO-OVER-SHORT.
  2101             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2102             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2103
  2104*         16  FILLER                         PIC X(102).
  2105         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2106             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2107             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2108
  2109         16  CF-AH-APPROVAL-DAYS.
  2110             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2111             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2112             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2113             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2114
  2115         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2116
  2117         16  CF-APPROV-LEV-5.
  2118             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2119             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2120             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2121
  2122         16  FILLER                         PIC X(68).
  2123****************************************************************
  2124*             PROCESSOR/USER RECORD                            *
  2125****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  43
* EL106.cbl
  2126
  2127     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2128         16  CF-PROCESSOR-NAME              PIC X(30).
  2129         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2130         16  CF-PROCESSOR-TITLE             PIC X(26).
  2131         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2132                 88  MESSAGE-YES                VALUE 'Y'.
  2133                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2134
  2135*****************************************************
  2136****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2137****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2138****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2139****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2140*****************************************************
  2141
  2142         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2143             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2144             20  CF-APPLICATION-FORCE       PIC X.
  2145             20  CF-INDIVIDUAL-APP.
  2146                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2147                     28  CF-BROWSE-APP      PIC X.
  2148                     28  CF-UPDATE-APP      PIC X.
  2149
  2150         16  CF-CURRENT-TERM-ON             PIC X(4).
  2151         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2152             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2153             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2154             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2155             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2156             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2157             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2158             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2159         16  CF-PROCESSOR-CARRIER           PIC X.
  2160             88  NO-CARRIER-SECURITY            VALUE ' '.
  2161         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2162             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2163         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2164             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2165         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2166             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2167
  2168         16  CF-PROC-SYS-ACCESS-SW.
  2169             20  CF-PROC-CREDIT-CLAIMS-SW.
  2170                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2171                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2172                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2173                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2174             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2175                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2176                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2177             20  CF-PROC-LIFE-GNRLDGR-SW.
  2178                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2179                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2180                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2181                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2182             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2183                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  44
* EL106.cbl
  2184                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2185         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2186             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2187             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2188         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2189
  2190         16  CF-APPROVAL-LEVEL                  PIC X.
  2191             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2192             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2193             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2194             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2195             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2196
  2197         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2198
  2199         16  CF-LANGUAGE-TYPE                   PIC X.
  2200             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2201             88  CF-LANG-IS-FR                      VALUE 'F'.
  2202
  2203         16  CF-CSR-IND                         PIC X.
  2204         16  FILLER                             PIC X(239).
  2205
  2206****************************************************************
  2207*             PROCESSOR/REMINDERS RECORD                       *
  2208****************************************************************
  2209
  2210     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2211         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2212             20  CF-START-REMIND-DT         PIC XX.
  2213             20  CF-END-REMIND-DT           PIC XX.
  2214             20  CF-REMINDER-TEXT           PIC X(50).
  2215         16  FILLER                         PIC X(296).
  2216
  2217
  2218****************************************************************
  2219*             STATE MASTER RECORD                              *
  2220****************************************************************
  2221
  2222     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2223         16  CF-STATE-ABBREVIATION          PIC XX.
  2224         16  CF-STATE-NAME                  PIC X(25).
  2225         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2226         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2227             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2228             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2229             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2230             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2231                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2232                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2233             20  CF-ST-PREM-REJECT-SW       PIC X.
  2234                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2235                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2236             20  CF-ST-REF-REJECT-SW        PIC X.
  2237                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2238                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2239         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2240         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2241         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  45
* EL106.cbl
  2242             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2243             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2244             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2245         16  CF-ST-FST-PMT-EXTENSION.
  2246             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2247             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2248                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2249                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2250                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2251                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2252         16  CF-ST-STATE-CALL.
  2253             20  CF-ST-CALL-UNEARNED        PIC X.
  2254             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2255             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2256         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2257             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2258             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2259         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2260         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2261         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2262         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2263         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2264         16  FILLER                         PIC X.
  2265         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2266             20  CF-ST-BENEFIT-CD           PIC XX.
  2267             20  CF-ST-BENEFIT-KIND         PIC X.
  2268                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2269                 88  CF-ST-AH-KIND              VALUE 'A'.
  2270             20  CF-ST-REM-TERM-CALC        PIC X.
  2271                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2272                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2273                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2274                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2275                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2276                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2277                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2278                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2279
  2280             20  CF-ST-REFUND-CALC          PIC X.
  2281                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2282                 88  ST-REFD-BY-R78             VALUE '1'.
  2283                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2284                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2285                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2286                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2287                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2288                 88  ST-REFD-UTAH               VALUE '7'.
  2289                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2290                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2291                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2292
  2293             20  CF-ST-EARNING-CALC         PIC X.
  2294                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2295                 88  ST-EARN-BY-R78             VALUE '1'.
  2296                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2297                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2298                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2299                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  46
* EL106.cbl
  2300                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2301                 88  ST-EARN-MEAN               VALUE '8'.
  2302                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2303
  2304             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2305                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2306                 88  ST-OVRD-BY-R78             VALUE '1'.
  2307                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2308                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2309                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2310                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2311                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2312                 88  ST-OVRD-MEAN               VALUE '8'.
  2313                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2314             20  FILLER                     PIC X.
  2315
  2316         16  CF-ST-COMMISSION-CAPS.
  2317             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2318             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2319             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2320             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2321         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2322                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2323
  2324         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2325
  2326         16  CF-ST-STATUTORY-INTEREST.
  2327             20  CF-ST-STAT-DATE-FROM       PIC X.
  2328                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2329                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2330             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2331             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2332             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2333             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2334             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2335
  2336         16  CF-ST-OVER-SHORT.
  2337             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2338             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2339
  2340         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2341
  2342         16  CF-ST-RT-CALC                  PIC X.
  2343
  2344         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2345         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2346         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2347         16  CF-ST-RF-LR-CALC               PIC X.
  2348         16  CF-ST-RF-LL-CALC               PIC X.
  2349         16  CF-ST-RF-LN-CALC               PIC X.
  2350         16  CF-ST-RF-AH-CALC               PIC X.
  2351         16  CF-ST-RF-CP-CALC               PIC X.
  2352*        16  FILLER                         PIC X(206).
  2353*CIDMOD         16  FILLER                         PIC X(192).
  2354         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2355             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2356         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2357         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  47
* EL106.cbl
  2358         16  CF-ST-CAUSAL-STATE             PIC X.
  2359         16  FILLER                         PIC X(185).
  2360
  2361****************************************************************
  2362*             BENEFIT MASTER RECORD                            *
  2363****************************************************************
  2364
  2365     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2366         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2367             20  CF-BENEFIT-CODE            PIC XX.
  2368             20  CF-BENEFIT-NUMERIC  REDEFINES
  2369                 CF-BENEFIT-CODE            PIC XX.
  2370             20  CF-BENEFIT-ALPHA           PIC XXX.
  2371             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2372             20  CF-BENEFIT-COMMENT         PIC X(10).
  2373
  2374             20  CF-LF-COVERAGE-TYPE        PIC X.
  2375                 88  CF-REDUCING                VALUE 'R'.
  2376                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2377
  2378             20  CF-SPECIAL-CALC-CD         PIC X.
  2379                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2380                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2381                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2382                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2383                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2384                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2385                 88  CF-FARM-PLAN               VALUE 'F'.
  2386                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2387                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2388                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2389                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2390                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2391                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2392                 88  CF-PRUDENTIAL              VALUE 'P'.
  2393                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2394                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2395                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2396                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2397                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2398                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2399
  2400             20  CF-JOINT-INDICATOR         PIC X.
  2401                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2402
  2403*            20  FILLER                     PIC X(12).
  2404             20  FILLER                     PIC X(11).
  2405             20  CF-BENEFIT-CATEGORY        PIC X.
  2406             20  CF-LOAN-TYPE               PIC X(8).
  2407
  2408             20  CF-CO-REM-TERM-CALC        PIC X.
  2409                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2410                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2411                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2412                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2413                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2414
  2415             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  48
* EL106.cbl
  2416                 88  CO-EARN-BY-R78             VALUE '1'.
  2417                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2418                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2419                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2420                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2421                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2422                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2423                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2424
  2425             20  CF-CO-REFUND-CALC          PIC X.
  2426                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2427                 88  CO-REFD-BY-R78             VALUE '1'.
  2428                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2429                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2430                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2431                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2432                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2433                 88  CO-REFD-MEAN               VALUE '8'.
  2434                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2435                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2436                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2437
  2438             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2439                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2440                 88  CO-OVRD-BY-R78             VALUE '1'.
  2441                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2442                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2443                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2444                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2445                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2446                 88  CO-OVRD-MEAN               VALUE '8'.
  2447                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2448
  2449             20  CF-CO-BEN-I-G-CD           PIC X.
  2450                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2451                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2452                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2453
  2454         16  FILLER                         PIC X(304).
  2455
  2456
  2457****************************************************************
  2458*             CARRIER MASTER RECORD                            *
  2459****************************************************************
  2460
  2461     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2462         16  CF-ADDRESS-DATA.
  2463             20  CF-MAIL-TO-NAME            PIC X(30).
  2464             20  CF-IN-CARE-OF              PIC X(30).
  2465             20  CF-ADDRESS-LINE-1          PIC X(30).
  2466             20  CF-ADDRESS-LINE-2          PIC X(30).
  2467             20  CF-CITY-STATE              PIC X(30).
  2468             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2469             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2470
  2471         16  CF-CLAIM-NO-CONTROL.
  2472             20  CF-CLAIM-NO-METHOD         PIC X.
  2473                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  49
* EL106.cbl
  2474                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2475                 88  CLAIM-NO-SEQ               VALUE '3'.
  2476                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2477             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2478                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2479                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2480                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2481
  2482         16  CF-CHECK-NO-CONTROL.
  2483             20  CF-CHECK-NO-METHOD         PIC X.
  2484                 88  CHECK-NO-MANUAL            VALUE '1'.
  2485                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2486                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2487                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2488             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2489                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2490
  2491         16  CF-DOMICILE-STATE              PIC XX.
  2492
  2493         16  CF-EXPENSE-CONTROLS.
  2494             20  CF-EXPENSE-METHOD          PIC X.
  2495                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2496                 88  DOLLARS-PER-PMT            VALUE '2'.
  2497                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2498                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2499             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2500             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2501
  2502         16  CF-CORRESPONDENCE-CONTROL.
  2503             20  CF-LETTER-RESEND-OPT       PIC X.
  2504                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2505                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2506             20  FILLER                     PIC X(4).
  2507
  2508         16  CF-RESERVE-CONTROLS.
  2509             20  CF-MANUAL-SW               PIC X.
  2510                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2511             20  CF-FUTURE-SW               PIC X.
  2512                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2513             20  CF-PTC-SW                  PIC X.
  2514                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2515             20  CF-IBNR-SW                 PIC X.
  2516                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2517             20  CF-PTC-LF-SW               PIC X.
  2518                 88  CF-LF-PTC-USED             VALUE '1'.
  2519             20  CF-CDT-ACCESS-METHOD       PIC X.
  2520                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2521                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2522                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2523             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2524
  2525         16  CF-CLAIM-CALC-METHOD           PIC X.
  2526             88  360-PLUS-MONTHS                VALUE '1'.
  2527             88  365-PLUS-MONTHS                VALUE '2'.
  2528             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2529             88  360-DAILY                      VALUE '4'.
  2530             88  365-DAILY                      VALUE '5'.
  2531
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  50
* EL106.cbl
  2532         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2533         16  FILLER                         PIC X(11).
  2534
  2535         16  CF-LIMIT-AMOUNTS.
  2536             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2537             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2538             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2539             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2540             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2541             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2542             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2543             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2544             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2545             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2546
  2547         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2548         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2549         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2550
  2551         16  CF-ZIP-CODE.
  2552             20  CF-ZIP-PRIME.
  2553                 24  CF-ZIP-1ST             PIC X.
  2554                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2555                 24  FILLER                 PIC X(4).
  2556             20  CF-ZIP-PLUS4               PIC X(4).
  2557         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2558             20  CF-CAN-POSTAL-1            PIC XXX.
  2559             20  CF-CAN-POSTAL-2            PIC XXX.
  2560             20  FILLER                     PIC XXX.
  2561
  2562         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2563         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2564         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2565
  2566         16  CF-RATING-SWITCH               PIC X.
  2567             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2568             88  CF-NO-RATING                   VALUE 'N'.
  2569
  2570         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2571
  2572         16  CF-CARRIER-OVER-SHORT.
  2573             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2574             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2575
  2576         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2577         16  CF-SECPAY-SWITCH               PIC X.
  2578             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2579             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2580         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2581         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2582         16  FILLER                         PIC X(444).
  2583*        16  FILLER                         PIC X(452).
  2584
  2585
  2586****************************************************************
  2587*             MORTALITY MASTER RECORD                          *
  2588****************************************************************
  2589
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  51
* EL106.cbl
  2590     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2591         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2592                                INDEXED BY CF-MORT-NDX.
  2593             20  CF-MORT-TABLE              PIC X(5).
  2594             20  CF-MORT-TABLE-TYPE         PIC X.
  2595                 88  CF-MORT-JOINT              VALUE 'J'.
  2596                 88  CF-MORT-SINGLE             VALUE 'S'.
  2597                 88  CF-MORT-COMBINED           VALUE 'C'.
  2598                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2599                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2600             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2601             20  CF-MORT-AGE-METHOD         PIC XX.
  2602                 88  CF-AGE-LAST                VALUE 'AL'.
  2603                 88  CF-AGE-NEAR                VALUE 'AN'.
  2604             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2605             20  CF-MORT-ADJUSTMENT-DIRECTION
  2606                                            PIC X.
  2607                 88  CF-MINUS                   VALUE '-'.
  2608                 88  CF-PLUS                    VALUE '+'.
  2609             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2610             20  CF-MORT-JOINT-CODE         PIC X.
  2611                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2612             20  CF-MORT-PC-Q               PIC X.
  2613                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2614             20  CF-MORT-TABLE-CODE         PIC X(4).
  2615             20  CF-MORT-COMMENTS           PIC X(15).
  2616             20  FILLER                     PIC X(14).
  2617
  2618         16  FILLER                         PIC X(251).
  2619
  2620
  2621****************************************************************
  2622*             BUSSINESS TYPE MASTER RECORD                     *
  2623****************************************************************
  2624
  2625     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2626* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2627* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2628* AND RECORD 05 IS TYPES 81-99
  2629         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2630             20  CF-BUSINESS-TITLE          PIC  X(19).
  2631             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2632                                            PIC S9V9(4) COMP-3.
  2633             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2634             20  FILLER                     PIC  X.
  2635         16  FILLER                         PIC  X(248).
  2636
  2637
  2638****************************************************************
  2639*             TERMINAL MASTER RECORD                           *
  2640****************************************************************
  2641
  2642     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2643
  2644         16  CF-COMPANY-TERMINALS.
  2645             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2646                                  PIC X(4).
  2647         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  52
* EL106.cbl
  2648
  2649
  2650****************************************************************
  2651*             LIFE EDIT MASTER RECORD                          *
  2652****************************************************************
  2653
  2654     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2655         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2656             20  CF-LIFE-CODE-IN            PIC XX.
  2657             20  CF-LIFE-CODE-OUT           PIC XX.
  2658         16  FILLER                         PIC X(248).
  2659
  2660
  2661****************************************************************
  2662*             AH EDIT MASTER RECORD                            *
  2663****************************************************************
  2664
  2665     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2666         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2667             20  CF-AH-CODE-IN              PIC XXX.
  2668             20  CF-AH-CODE-OUT             PIC XX.
  2669         16  FILLER                         PIC X(248).
  2670
  2671
  2672****************************************************************
  2673*             CREDIBILITY TABLES                               *
  2674****************************************************************
  2675
  2676     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2677         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2678                             INDEXED BY CF-CRDB-NDX.
  2679             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2680             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2681             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2682         16  FILLER                         PIC  X(332).
  2683
  2684
  2685****************************************************************
  2686*             REPORT CUSTOMIZATION RECORD                      *
  2687****************************************************************
  2688
  2689     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2690         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2691             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2692             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2693             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2694**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2695****       A T-TRANSFER.                                   ****
  2696             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2697
  2698         16  FILLER                         PIC XX.
  2699
  2700         16  CF-CARRIER-CNTL-OPT.
  2701             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2702                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2703                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2704             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2705                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  53
* EL106.cbl
  2706         16  CF-GROUP-CNTL-OPT.
  2707             20  CF-GROUP-OPT-SEQ           PIC 9.
  2708                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2709                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2710             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2711                                            PIC X(6).
  2712         16  CF-STATE-CNTL-OPT.
  2713             20  CF-STATE-OPT-SEQ           PIC 9.
  2714                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2715                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2716             20  CF-STATE-SELECT OCCURS 3 TIMES
  2717                                            PIC XX.
  2718         16  CF-ACCOUNT-CNTL-OPT.
  2719             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2720                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2721                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2722             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2723                                            PIC X(10).
  2724         16  CF-BUS-TYP-CNTL-OPT.
  2725             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2726                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2727                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2728             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2729                                            PIC XX.
  2730         16  CF-LF-TYP-CNTL-OPT.
  2731             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2732                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2733                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2734             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2735                                            PIC XX.
  2736         16  CF-AH-TYP-CNTL-OPT.
  2737             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2738                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2739                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2740             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2741                                            PIC XX.
  2742         16  CF-REPTCD1-CNTL-OPT.
  2743             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2744                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2745                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2746             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2747                                            PIC X(10).
  2748         16  CF-REPTCD2-CNTL-OPT.
  2749             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2750                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2751                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2752             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2753                                            PIC X(10).
  2754         16  CF-USER1-CNTL-OPT.
  2755             20  CF-USER1-OPT-SEQ           PIC 9.
  2756                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2757                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2758             20  CF-USER1-SELECT OCCURS 3 TIMES
  2759                                            PIC X(10).
  2760         16  CF-USER2-CNTL-OPT.
  2761             20  CF-USER2-OPT-SEQ           PIC 9.
  2762                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2763                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  54
* EL106.cbl
  2764             20  CF-USER2-SELECT OCCURS 3 TIMES
  2765                                            PIC X(10).
  2766         16  CF-USER3-CNTL-OPT.
  2767             20  CF-USER3-OPT-SEQ           PIC 9.
  2768                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2769                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2770             20  CF-USER3-SELECT OCCURS 3 TIMES
  2771                                            PIC X(10).
  2772         16  CF-USER4-CNTL-OPT.
  2773             20  CF-USER4-OPT-SEQ           PIC 9.
  2774                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2775                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2776             20  CF-USER4-SELECT OCCURS 3 TIMES
  2777                                            PIC X(10).
  2778         16  CF-USER5-CNTL-OPT.
  2779             20  CF-USER5-OPT-SEQ           PIC 9.
  2780                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2781                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2782             20  CF-USER5-SELECT OCCURS 3 TIMES
  2783                                            PIC X(10).
  2784         16  CF-REINS-CNTL-OPT.
  2785             20  CF-REINS-OPT-SEQ           PIC 9.
  2786                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2787                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2788             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2789                 24  CF-REINS-PRIME         PIC XXX.
  2790                 24  CF-REINS-SUB           PIC XXX.
  2791
  2792         16  CF-AGENT-CNTL-OPT.
  2793             20  CF-AGENT-OPT-SEQ           PIC 9.
  2794                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2795                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2796             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2797                                            PIC X(10).
  2798
  2799         16  FILLER                         PIC X(43).
  2800
  2801         16  CF-LOSS-RATIO-SELECT.
  2802             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2803             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2804         16  CF-ENTRY-DATE-SELECT.
  2805             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2806             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2807         16  CF-EFFECTIVE-DATE-SELECT.
  2808             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2809             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2810
  2811         16  CF-EXCEPTION-LIST-IND          PIC X.
  2812             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2813
  2814         16  FILLER                         PIC X(318).
  2815
  2816****************************************************************
  2817*                  EXCEPTION REPORTING RECORD                  *
  2818****************************************************************
  2819
  2820     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2821         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  55
* EL106.cbl
  2822             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2823
  2824         16  CF-COMBINED-LIFE-AH-OPT.
  2825             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2826             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2827             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2828             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2829
  2830         16  CF-LIFE-OPT.
  2831             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2832             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2833             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2834             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2835             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2836             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2837             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2838             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2839             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2840             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2841
  2842         16  CF-AH-OPT.
  2843             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2844             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2845             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2846             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2847             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2848             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2849             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2850             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2851             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2852             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2853
  2854         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2855             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2856             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2857             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2858
  2859         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2860
  2861         16  FILLER                         PIC X(673).
  2862
  2863
  2864****************************************************************
  2865*             MORTGAGE SYSTEM PLAN RECORD                      *
  2866****************************************************************
  2867
  2868     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2869         16  CF-PLAN-TYPE                   PIC X.
  2870             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2871             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2872             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2873         16  CF-PLAN-ABBREV                 PIC XXX.
  2874         16  CF-PLAN-DESCRIPT               PIC X(10).
  2875         16  CF-PLAN-NOTES                  PIC X(20).
  2876         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2877         16  CF-PLAN-UNDERWRITING.
  2878             20  CF-PLAN-TERM-DATA.
  2879                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  56
* EL106.cbl
  2880                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2881             20  CF-PLAN-AGE-DATA.
  2882                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2883                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2884                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2885             20  CF-PLAN-BENEFIT-DATA.
  2886                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2887                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2888                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2889                                            PIC S9(7)V99  COMP-3.
  2890         16  CF-PLAN-POLICY-FORMS.
  2891             20  CF-POLICY-FORM             PIC X(12).
  2892             20  CF-MASTER-APPLICATION      PIC X(12).
  2893             20  CF-MASTER-POLICY           PIC X(12).
  2894         16  CF-PLAN-RATING.
  2895             20  CF-RATE-CODE               PIC X(5).
  2896             20  CF-SEX-RATING              PIC X.
  2897                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2898                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2899             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2900             20  CF-SUB-STD-TYPE            PIC X.
  2901                 88  CF-PCT-OF-PREM            VALUE '1'.
  2902                 88  CF-PCT-OF-BENE            VALUE '2'.
  2903         16  CF-PLAN-PREM-TOLERANCES.
  2904             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2905             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2906         16  CF-PLAN-PYMT-TOLERANCES.
  2907             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2908             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2909         16  CF-PLAN-MISC-DATA.
  2910             20  FILLER                     PIC X.
  2911             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2912             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2913         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2914         16  CF-PLAN-IND-GRP                PIC X.
  2915             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2916                                                     '1'.
  2917             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2918                                                     '2'.
  2919         16  CF-MIB-SEARCH-SW               PIC X.
  2920             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2921             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2922             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2923             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2924         16  CF-ALPHA-SEARCH-SW             PIC X.
  2925             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2926             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2927             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2928             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2929             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2930             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2931             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2932             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2933             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2934             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2935                                                     'A' 'B' 'C'
  2936                                                     'X' 'Y' 'Z'.
  2937         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  57
* EL106.cbl
  2938             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2939             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2940             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2941             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2942             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2943         16  FILLER                         PIC X(4).
  2944         16  CF-HEALTH-QUESTIONS            PIC X.
  2945             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2946         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2947         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2948         16  CF-PLAN-SNGL-JNT               PIC X.
  2949             88  CF-COMBINED-PLAN              VALUE 'C'.
  2950             88  CF-JNT-PLAN                   VALUE 'J'.
  2951             88  CF-SNGL-PLAN                  VALUE 'S'.
  2952         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2953         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2954         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2955         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2956         16  CF-RERATE-CNTL                 PIC  X.
  2957             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2958             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2959             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2960             88  CF-AUTO-RECALC                 VALUE '4'.
  2961         16  CF-BENEFIT-TYPE                PIC  X.
  2962             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2963             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2964         16  CF-POLICY-FEE                  PIC S999V99
  2965                                                    COMP-3.
  2966         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2967         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2968         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2969         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2970         16  FILLER                         PIC  X(32).
  2971         16  CF-TERMINATION-FORM            PIC  X(04).
  2972         16  FILLER                         PIC  X(08).
  2973         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2974                                                       COMP-3.
  2975         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2976         16  CF-ISSUE-LETTER                PIC  X(4).
  2977         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2978         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2979             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2980             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2981         16  CF-MP-REFUND-CALC              PIC X.
  2982             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2983             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2984             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2985             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2986             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2987             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2988             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2989             88  CF-MP-REFD-MEAN                VALUE '8'.
  2990         16  CF-ALT-RATE-CODE               PIC  X(5).
  2991
  2992
  2993         16  FILLER                         PIC X(498).
  2994****************************************************************
  2995*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  58
* EL106.cbl
  2996****************************************************************
  2997
  2998     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2999         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3000         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3001             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3002             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3003             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3004             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3005             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3006
  3007         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3008         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3009         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3010         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3011         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3012
  3013         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3014             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3015         16  CF-MP-RECON-USE-IND            PIC X(1).
  3016             88  CF-MP-USE-RECON             VALUE 'Y'.
  3017         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3018             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3019         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3020             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3021             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3022         16  FILLER                         PIC X(1).
  3023         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3024             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3025         16  CF-MORTG-MIB-VERSION           PIC X.
  3026             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3027             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3028             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3029         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3030             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3031                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3032             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3033                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3034             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3035                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3036             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3037                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3038             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3039                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3040             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3041                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3042         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3043         16  FILLER                         PIC X(7).
  3044         16  CF-MORTG-DESTINATION-SYMBOL.
  3045             20  CF-MORTG-MIB-COMM          PIC X(5).
  3046             20  CF-MORTG-MIB-TERM          PIC X(5).
  3047         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3048             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3049         16  FILLER                         PIC X(03).
  3050         16  CF-MP-CHECK-NO-CONTROL.
  3051             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3052                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3053                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  59
* EL106.cbl
  3054                                                ' ' LOW-VALUES.
  3055                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3056                                               VALUE '3'.
  3057         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3058         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3059         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3060             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3061                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3062             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3063                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3064             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3065                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3066             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3067                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3068             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3069                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3070             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3071                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3072         16  CF-MORTG-BILLING-AREA.
  3073             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3074                                            PIC X.
  3075         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3076         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3077         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3078         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3079             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3080             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3081         16  FILLER                         PIC X.
  3082         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3083             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3084             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3085         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3086         16  FILLER                         PIC X(8).
  3087         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3088         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3089         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3090         16  CF-ACH-COMPANY-ID.
  3091             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3092                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3093                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3094                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3095             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3096         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3097             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3098         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3099             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3100             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3101         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3102         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3103         16  FILLER                         PIC X(536).
  3104
  3105****************************************************************
  3106*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3107****************************************************************
  3108
  3109     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3110         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3111             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  60
* EL106.cbl
  3112                 24  CF-FEMALE-FT           PIC 99.
  3113                 24  CF-FEMALE-IN           PIC 99.
  3114             20  CF-FEMALE-MIN-WT           PIC 999.
  3115             20  CF-FEMALE-MAX-WT           PIC 999.
  3116         16  FILLER                         PIC X(428).
  3117
  3118     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3119         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3120             20  CF-MALE-HEIGHT.
  3121                 24  CF-MALE-FT             PIC 99.
  3122                 24  CF-MALE-IN             PIC 99.
  3123             20  CF-MALE-MIN-WT             PIC 999.
  3124             20  CF-MALE-MAX-WT             PIC 999.
  3125         16  FILLER                         PIC X(428).
  3126******************************************************************
  3127*             AUTOMATIC ACTIVITY RECORD                          *
  3128******************************************************************
  3129     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3130         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3131             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3132             20  CF-SYS-LETTER-ID           PIC X(04).
  3133             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3134             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3135             20  CF-SYS-RESET-SW            PIC X(01).
  3136             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3137             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3138
  3139         16  FILLER                         PIC X(50).
  3140
  3141         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3142             20  CF-USER-ACTIVE-SW          PIC X(01).
  3143             20  CF-USER-LETTER-ID          PIC X(04).
  3144             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3145             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3146             20  CF-USER-RESET-SW           PIC X(01).
  3147             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3148             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3149             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3150
  3151         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  61
* EL106.cbl
  3153*    COPY ELCTEXT.
  3154******************************************************************
  3155*                                                                *
  3156*                                                                *
  3157*                            ELCTEXT.                            *
  3158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3159*                            VMOD=2.008                          *
  3160*                                                                *
  3161*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3162*                                     FORM LETTERS,              *
  3163*                                     CERT FORM DISPLAY.
  3164*                                                                *
  3165*   FILE TYPE = VSAM,KSDS                                        *
  3166*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3167*                                                                *
  3168*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3169*       ALTERNATE INDEX = NONE                                   *
  3170*                                                                *
  3171*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3172*       ALTERNATE INDEX = NONE                                   *
  3173*                                                                *
  3174*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3175*       ALTERNATE INDEX = NONE                                   *
  3176*                                                                *
  3177*   LOG = NO                                                     *
  3178*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3179******************************************************************
  3180 01  TEXT-FILES.
  3181     12  TEXT-FILE-ID                PIC XX.
  3182         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3183         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3184         88  HELP-FILE-TEXT             VALUE 'TH'.
  3185
  3186     12  TX-CONTROL-PRIMARY.
  3187         16  TX-COMPANY-CD           PIC X.
  3188             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3189         16  TX-ACCESS-CD-GENL       PIC X(12).
  3190
  3191         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3192             20  TX-LETTER-NO        PIC X(4).
  3193             20  FILLER              PIC X(8).
  3194
  3195         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3196             20  TX-FORM-NO          PIC X(12).
  3197
  3198         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3199             20  TX-HELP-TYPE        PIC X.
  3200                 88  HELP-FOR-GENERAL   VALUE ' '.
  3201                 88  HELP-BY-SCREEN     VALUE 'S'.
  3202                 88  HELP-BY-ERROR      VALUE 'E'.
  3203             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3204                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3205             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3206                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3207             20  FILLER              PIC X(4).
  3208
  3209         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3210
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  62
* EL106.cbl
  3211     12  TX-PROCESS-CONTROL          PIC XX.
  3212         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3213
  3214     12  TX-TEXT-LINE                PIC X(70).
  3215
  3216     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3217         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3218         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3219         88  TX-VALID-FORM-SQUEEZE-VALUE
  3220                                        VALUE 'Y' ' '.
  3221
  3222     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3223         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3224         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3225         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3226         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3227         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3228         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3229         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3230                                              'K' 'N' ' '
  3231                                              'Z'.
  3232
  3233     12  TX-ARCHIVE-SW               PIC X.
  3234         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3235         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3236         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3237
  3238     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3239     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3240
  3241     12  TX-BSR-CODE                 PIC X.
  3242         88  TX-BSR-LETTER              VALUE 'B'.
  3243         88  TX-NON-BSR-LETTER          VALUE ' '.
  3244
  3245     12  FILLER                      PIC X.
  3246*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  63
* EL106.cbl
  3248 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3249                          TEXT-FILES.
  3250 0000-DFHEXIT SECTION.
  3251     MOVE '9#                    $   ' TO DFHEIV0.
  3252     MOVE 'EL106' TO DFHEIV1.
  3253     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3254
  3255     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3256     MOVE '5'                   TO DC-OPTION-CODE.
  3257     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3258     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3259     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3260
  3261     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  3262     MOVE 2                     TO EMI-NUMBER-OF-LINES
  3263                                   EMI-SWITCH2.
  3264
  3265     MOVE EIBTRMID              TO QID-TERM.
  3266
  3267     IF EIBCALEN = 0
  3268         GO TO 8800-UNAUTHORIZED-ACCESS.
  3269
  3270     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3271         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3272       ELSE
  3273         MOVE SPACES             TO RETURNED-FROM.
  3274
  3275     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3276         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3277             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3278             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3279             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3280             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3281             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3282             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3283             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3284             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3285             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3286         ELSE
  3287             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3288             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3289             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3290             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3291             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3292             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3293             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3294             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3295
  3296     MOVE 'N' TO WS-DISPLAY-SW.
  3297
  3298
  3299* EXEC CICS HANDLE CONDITION
  3300*        DUPREC  (8850-DUPREC)
  3301*        NOTOPEN (8870-NOTOPEN)
  3302*        NOTFND  (8880-NOT-FOUND)
  3303*        PGMIDERR(9600-PGMID-ERROR)
  3304*        ERROR   (9990-ABEND)
  3305*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  64
* EL106.cbl
  3306*    MOVE '"$%JIL.               ! " #00003294' TO DFHEIV0
  3307     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3309     MOVE X'2220233030303033323934' TO DFHEIV0(25:11)
  3310     CALL 'kxdfhei1' USING DFHEIV0
  3311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3312
  3313
  3314     IF EIBTRNID NOT = TRANS-ID
  3315       IF RETURNED-FROM = XCTL-EL6565
  3316           MOVE LOW-VALUES           TO EL106AO
  3317           PERFORM 6500-RECOVER-TEMP-STORAGE THRU 6500-EXIT
  3318           GO TO 8100-SEND-INITIAL-MAP
  3319        ELSE
  3320       IF RETURNED-FROM = XCTL-EL1061
  3321           MOVE LOW-VALUES           TO EL106AO
  3322           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3323               GO TO 8100-SEND-INITIAL-MAP
  3324           ELSE
  3325               MOVE PI-WS-STATE TO STCDI
  3326               MOVE 'Y' TO WS-DISPLAY-SW
  3327               GO TO 1000-SHOW-STATE
  3328        ELSE
  3329       IF PI-RETURN-TO-PROGRAM = XCTL-EL6507
  3330           MOVE LOW-VALUES           TO EL106AO
  3331           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3332               GO TO 8100-SEND-INITIAL-MAP
  3333           ELSE
  3334               MOVE PI-WS-STATE TO STCDI
  3335               MOVE 'Y' TO WS-DISPLAY-SW
  3336               GO TO 1000-SHOW-STATE
  3337        ELSE
  3338         MOVE LOW-VALUES           TO EL106AO
  3339         GO TO 8100-SEND-INITIAL-MAP.
  3340
  3341     IF EIBAID = DFHCLEAR
  3342         GO TO 9400-CLEAR.
  3343
  3344     IF NOT DISPLAY-CAP
  3345         MOVE 'READ'         TO SM-READ
  3346         PERFORM 9995-SECURITY-VIOLATION
  3347         MOVE ER-0070        TO EMI-ERROR
  3348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3349         GO TO 8100-SEND-INITIAL-MAP.
  3350
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  65
* EL106.cbl
  3352 0200-RECEIVE.
  3353     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3354         MOVE LOW-VALUES TO EL106AI
  3355         MOVE ER-7008    TO EMI-ERROR
  3356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3357         MOVE -1 TO MAINTL
  3358         GO TO 8200-SEND-DATAONLY.
  3359
  3360
  3361* EXEC CICS RECEIVE
  3362*        MAP   (MAP-NAME)
  3363*        MAPSET(MAPSET-NAME)
  3364*        INTO  (EL106AI)
  3365*    END-EXEC.
  3366     MOVE LENGTH OF
  3367      EL106AI
  3368       TO DFHEIV11
  3369*    MOVE '8"T I  L              ''   #00003348' TO DFHEIV0
  3370     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3372     MOVE X'2020233030303033333438' TO DFHEIV0(25:11)
  3373     CALL 'kxdfhei1' USING DFHEIV0,
  3374           MAP-NAME,
  3375           EL106AI,
  3376           DFHEIV11,
  3377           MAPSET-NAME,
  3378           DFHEIV99,
  3379           DFHEIV99
  3380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3381
  3382
  3383     IF ENTERPFL = 0
  3384         GO TO 0300-CHECK-PFKEYS.
  3385
  3386     IF EIBAID NOT = DFHENTER
  3387         MOVE ER-0004 TO EMI-ERROR
  3388         GO TO 0320-INPUT-ERROR.
  3389
  3390     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3391         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3392     ELSE
  3393         MOVE ER-0029 TO EMI-ERROR
  3394         GO TO 0320-INPUT-ERROR.
  3395
  3396 0300-CHECK-PFKEYS.
  3397     IF EIBAID = DFHPF23
  3398         GO TO 8810-PF23.
  3399
  3400     IF EIBAID = DFHPF24
  3401         GO TO 9200-RETURN-MAIN-MENU.
  3402
  3403     IF EIBAID = DFHPF12
  3404         GO TO 9500-PF12.
  3405
  3406     IF MAINTL NOT = 0  AND
  3407        EIBAID NOT = DFHENTER
  3408          MOVE ER-0050 TO EMI-ERROR
  3409          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  66
* EL106.cbl
  3410
  3411     IF EIBAID = DFHPF1
  3412         GO TO 5000-FIND-NEXT-STATE.
  3413
  3414     IF EIBAID = DFHPF2
  3415         GO TO 5500-FIND-PREV-STATE.
  3416
  3417     IF EIBAID = DFHPF3
  3418         IF NOT MORTGAGE-SESSION
  3419             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3420                 MOVE ER-0029        TO  EMI-ERROR
  3421                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3422                 MOVE -1             TO  ENTERPFL
  3423                 MOVE AL-UNBON       TO  ENTERPFA
  3424                 GO TO 8200-SEND-DATAONLY
  3425             ELSE
  3426                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3427                 MOVE SPACES         TO  PI-WS-CLASS
  3428                                         PI-WS-DEV
  3429                                         PI-WS-TYPE
  3430                                         PI-WS-PLAN
  3431                 PERFORM 6400-CREATE-TEMP-STORAGE THRU 6400-EXIT
  3432                 MOVE XCTL-EL6565    TO  PGM-NAME
  3433                 GO TO 9300-XCTL
  3434         ELSE
  3435             MOVE ER-7536 TO EMI-ERROR
  3436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3437             MOVE AL-UNBON TO ENTERPFA
  3438             IF ENTERPFL = 0
  3439                 MOVE -1 TO MAINTL
  3440                 GO TO 8200-SEND-DATAONLY
  3441             ELSE
  3442                 MOVE -1 TO ENTERPFL
  3443                 GO TO 8200-SEND-DATAONLY.
  3444
  3445     IF EIBAID = DFHPF4
  3446         IF NOT MORTGAGE-SESSION
  3447             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3448                 MOVE ER-0029        TO  EMI-ERROR
  3449                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3450                 MOVE -1             TO  ENTERPFL
  3451                 MOVE AL-UNBON       TO  ENTERPFA
  3452                 GO TO 8200-SEND-DATAONLY
  3453             ELSE
  3454                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3455                 MOVE SPACES         TO  PI-WS-CLASS
  3456                                         PI-WS-DEV
  3457                                         PI-WS-TYPE
  3458                                         PI-WS-PLAN
  3459                 MOVE XCTL-EL1061    TO  PGM-NAME
  3460                 GO TO 9300-XCTL
  3461         ELSE
  3462             MOVE ER-7536 TO EMI-ERROR
  3463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3464             MOVE AL-UNBON TO ENTERPFA
  3465             IF ENTERPFL = 0
  3466                 MOVE -1 TO MAINTL
  3467                 GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  67
* EL106.cbl
  3468             ELSE
  3469                 MOVE -1 TO ENTERPFL
  3470                 GO TO 8200-SEND-DATAONLY.
  3471
  3472     IF EIBAID = DFHENTER
  3473         GO TO 0330-EDIT-DATA.
  3474
  3475     MOVE ER-0029 TO EMI-ERROR.
  3476 0320-INPUT-ERROR.
  3477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3478     MOVE AL-UNBON TO ENTERPFA.
  3479
  3480     IF ENTERPFL = 0
  3481         MOVE -1 TO MAINTL
  3482     ELSE
  3483         MOVE -1 TO ENTERPFL.
  3484
  3485     GO TO 8200-SEND-DATAONLY.
  3486
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  68
* EL106.cbl
  3488 0330-EDIT-DATA.
  3489     IF STCDL = ZERO AND
  3490        STABRL = ZERO
  3491         MOVE ER-0144       TO EMI-ERROR
  3492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3493         MOVE -1            TO STCDL
  3494         MOVE AL-UABON      TO STCDA
  3495         GO TO 8200-SEND-DATAONLY.
  3496
  3497     IF STCDL = ZERO AND
  3498        STABRL NOT = ZERO
  3499         PERFORM 0500-GET-STATE-CD THRU 0600-EXIT.
  3500
  3501     IF MAINTI = 'S'
  3502         GO TO 1000-SHOW-STATE.
  3503
  3504     IF MODIFY-CAP
  3505        NEXT SENTENCE
  3506       ELSE
  3507        IF MAINTI = 'A' OR 'C' OR 'D'
  3508         MOVE 'UPDATE'       TO SM-READ
  3509         PERFORM 9995-SECURITY-VIOLATION
  3510         MOVE ER-0070        TO EMI-ERROR
  3511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3512         MOVE LOW-VALUES     TO EL106AO
  3513         GO TO 8100-SEND-INITIAL-MAP.
  3514
  3515     IF MAINTI = 'C'
  3516         GO TO 2000-CHANGE-STATE.
  3517
  3518     IF MAINTI = 'A'
  3519         GO TO 3000-ADD-STATE.
  3520
  3521     IF MAINTI = 'D'
  3522         GO TO 4000-DELETE-STATE.
  3523
  3524     MOVE ER-0023 TO EMI-ERROR.
  3525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3526     MOVE -1       TO MAINTL.
  3527     MOVE AL-UABON TO MAINTA.
  3528     GO TO 8200-SEND-DATAONLY.
  3529
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  69
* EL106.cbl
  3531 0500-GET-STATE-CD.
  3532     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  3533     MOVE LOW-VALUES     TO CK-STATE-CD.
  3534     MOVE +0             TO CK-SEQ.
  3535
  3536
  3537* EXEC CICS HANDLE CONDITION
  3538*        ENDFILE(8880-NOT-FOUND)
  3539*        NOTFND (8880-NOT-FOUND)
  3540*    END-EXEC.
  3541*    MOVE '"$''I                  ! # #00003507' TO DFHEIV0
  3542     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3544     MOVE X'2320233030303033353037' TO DFHEIV0(25:11)
  3545     CALL 'kxdfhei1' USING DFHEIV0
  3546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3547
  3548
  3549
  3550* EXEC CICS STARTBR
  3551*        DATASET  (ELCNTL-ID)
  3552*        RIDFLD   (ELCNTL-KEY)
  3553*    END-EXEC.
  3554     MOVE 0
  3555       TO DFHEIV11
  3556*    MOVE '&,         G          &   #00003512' TO DFHEIV0
  3557     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3558     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3559     MOVE X'2020233030303033353132' TO DFHEIV0(25:11)
  3560     CALL 'kxdfhei1' USING DFHEIV0,
  3561           ELCNTL-ID,
  3562           ELCNTL-KEY,
  3563           DFHEIV99,
  3564           DFHEIV11,
  3565           DFHEIV99
  3566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3567
  3568
  3569 0510-GET-NEXT-CD.
  3570
  3571* EXEC CICS READNEXT
  3572*        DATASET(ELCNTL-ID)
  3573*        SET    (ADDRESS OF CONTROL-FILE)
  3574*        RIDFLD (ELCNTL-KEY)
  3575*    END-EXEC.
  3576     MOVE 0
  3577       TO DFHEIV11
  3578*    MOVE '&.S                   )   #00003518' TO DFHEIV0
  3579     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3581     MOVE X'2020233030303033353138' TO DFHEIV0(25:11)
  3582     CALL 'kxdfhei1' USING DFHEIV0,
  3583           ELCNTL-ID,
  3584           DFHEIV20,
  3585           DFHEIV99,
  3586           ELCNTL-KEY,
  3587           DFHEIV99,
  3588           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  70
* EL106.cbl
  3589           DFHEIV99,
  3590           DFHEIV99
  3591     SET ADDRESS OF CONTROL-FILE TO
  3592         DFHEIV20
  3593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3594
  3595
  3596     IF CF-COMPANY-ID NOT = PI-COMPANY-ID
  3597
  3598* EXEC CICS ENDBR
  3599*            DATASET  (ELCNTL-ID)
  3600*        END-EXEC
  3601     MOVE 0
  3602       TO DFHEIV11
  3603*    MOVE '&2                    $   #00003525' TO DFHEIV0
  3604     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3605     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3606     MOVE X'2020233030303033353235' TO DFHEIV0(25:11)
  3607     CALL 'kxdfhei1' USING DFHEIV0,
  3608           ELCNTL-ID,
  3609           DFHEIV11,
  3610           DFHEIV99
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3612         GO TO 8880-NOT-FOUND.
  3613
  3614     IF CF-RECORD-TYPE NOT = '3'
  3615         GO TO 0510-GET-NEXT-CD.
  3616
  3617     IF CF-STATE-ABBREVIATION = STABRI
  3618         NEXT SENTENCE
  3619       ELSE
  3620         GO TO 0510-GET-NEXT-CD.
  3621
  3622     MOVE CF-STATE-CODE      TO STCDI.
  3623     MOVE AL-UANON           TO STCDA.
  3624     MOVE +2                 TO STCDL.
  3625
  3626
  3627* EXEC CICS ENDBR
  3628*        DATASET  (ELCNTL-ID)
  3629*    END-EXEC.
  3630     MOVE 0
  3631       TO DFHEIV11
  3632*    MOVE '&2                    $   #00003542' TO DFHEIV0
  3633     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3634     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3635     MOVE X'2020233030303033353432' TO DFHEIV0(25:11)
  3636     CALL 'kxdfhei1' USING DFHEIV0,
  3637           ELCNTL-ID,
  3638           DFHEIV11,
  3639           DFHEIV99
  3640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3641
  3642
  3643 0600-EXIT.
  3644      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  71
* EL106.cbl
  3646 1000-SHOW-STATE.
  3647     IF RETURN-DISPLAY
  3648
  3649* EXEC CICS HANDLE CONDITION
  3650*            NOTFND  (8100-SEND-INITIAL-MAP)
  3651*        END-EXEC.
  3652*    MOVE '"$I                   ! $ #00003551' TO DFHEIV0
  3653     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3655     MOVE X'2420233030303033353531' TO DFHEIV0(25:11)
  3656     CALL 'kxdfhei1' USING DFHEIV0
  3657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3658
  3659
  3660     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3661     MOVE STCDI         TO CK-STATE-CD
  3662                           PI-WS-STATE.
  3663
  3664
  3665* EXEC CICS READ
  3666*        DATASET(ELCNTL-ID)
  3667*        SET    (ADDRESS OF CONTROL-FILE)
  3668*        RIDFLD (ELCNTL-KEY)
  3669*    END-EXEC.
  3670*    MOVE '&"S        E          (   #00003559' TO DFHEIV0
  3671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3673     MOVE X'2020233030303033353539' TO DFHEIV0(25:11)
  3674     CALL 'kxdfhei1' USING DFHEIV0,
  3675           ELCNTL-ID,
  3676           DFHEIV20,
  3677           DFHEIV99,
  3678           ELCNTL-KEY,
  3679           DFHEIV99,
  3680           DFHEIV99,
  3681           DFHEIV99
  3682     SET ADDRESS OF CONTROL-FILE TO
  3683         DFHEIV20
  3684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3685
  3686
  3687     GO TO 7000-BUILD-OUTPUT-MAP.
  3688
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  72
* EL106.cbl
  3690 2000-CHANGE-STATE.
  3691     IF STCDI NOT = PI-PREV-STATE
  3692         MOVE ER-0145 TO EMI-ERROR
  3693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3694         MOVE -1       TO STCDL
  3695         MOVE AL-UABON TO STCDA
  3696         GO TO 8200-SEND-DATAONLY.
  3697
  3698     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3699
  3700     IF NOT EMI-NO-ERRORS
  3701         GO TO 8200-SEND-DATAONLY.
  3702
  3703     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3704     MOVE STCDI         TO CK-STATE-CD
  3705                           PI-WS-STATE.
  3706
  3707
  3708* EXEC CICS READ
  3709*        UPDATE
  3710*        DATASET(ELCNTL-ID)
  3711*        SET    (ADDRESS OF CONTROL-FILE)
  3712*        RIDFLD (ELCNTL-KEY)
  3713*    END-EXEC.
  3714*    MOVE '&"S        EU         (   #00003585' TO DFHEIV0
  3715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3716     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3717     MOVE X'2020233030303033353835' TO DFHEIV0(25:11)
  3718     CALL 'kxdfhei1' USING DFHEIV0,
  3719           ELCNTL-ID,
  3720           DFHEIV20,
  3721           DFHEIV99,
  3722           ELCNTL-KEY,
  3723           DFHEIV99,
  3724           DFHEIV99,
  3725           DFHEIV99
  3726     SET ADDRESS OF CONTROL-FILE TO
  3727         DFHEIV20
  3728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3729
  3730
  3731     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  3732        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  3733
  3734* EXEC CICS UNLOCK
  3735*            DATASET(ELCNTL-ID)
  3736*        END-EXEC
  3737*    MOVE '&*                    #   #00003594' TO DFHEIV0
  3738     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3739     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3740     MOVE X'2020233030303033353934' TO DFHEIV0(25:11)
  3741     CALL 'kxdfhei1' USING DFHEIV0,
  3742           ELCNTL-ID,
  3743           DFHEIV99
  3744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3745         MOVE ER-0068 TO EMI-ERROR
  3746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3747         GO TO 1000-SHOW-STATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  73
* EL106.cbl
  3748
  3749     MOVE 'B'                    TO JP-RECORD-TYPE.
  3750     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3751     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3752
  3753     MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY.
  3754     MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS.
  3755     MOVE EIBDATE         TO DC-JULIAN-YYDDD.
  3756     MOVE '5'             TO DC-OPTION-CODE.
  3757     MOVE LINK-ELDATCV    TO PGM-NAME.
  3758
  3759
  3760* EXEC CICS LINK
  3761*        PROGRAM (PGM-NAME)
  3762*        COMMAREA(DATE-CONVERSION-DATA)
  3763*        LENGTH  (DC-COMM-LENGTH)
  3764*    END-EXEC.
  3765*    MOVE '."C                   (   #00003611' TO DFHEIV0
  3766     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3768     MOVE X'2020233030303033363131' TO DFHEIV0(25:11)
  3769     CALL 'kxdfhei1' USING DFHEIV0,
  3770           PGM-NAME,
  3771           DATE-CONVERSION-DATA,
  3772           DC-COMM-LENGTH,
  3773           DFHEIV99,
  3774           DFHEIV99,
  3775           DFHEIV99,
  3776           DFHEIV99
  3777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3778
  3779
  3780     IF DATE-CONVERSION-ERROR
  3781         MOVE LOW-VALUES          TO CF-LAST-MAINT-DT
  3782     ELSE
  3783         MOVE DC-BIN-DATE-1       TO CF-LAST-MAINT-DT.
  3784
  3785     IF STABRL NOT = ZEROS
  3786         MOVE STABRI              TO CF-STATE-ABBREVIATION.
  3787
  3788     IF STNAMEL NOT = ZEROS
  3789         MOVE STNAMEI             TO CF-STATE-NAME.
  3790
  3791     IF LFEXPL NOT = ZEROS
  3792         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  3793
  3794     IF AHEXPL NOT = ZEROS
  3795         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  3796
  3797     IF QUOTCALL NOT = ZEROS
  3798         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  3799
  3800     IF PREMTOLL NOT = ZEROS
  3801         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  3802
  3803     IF REFTOLL NOT = ZEROS
  3804         MOVE REFTOLI             TO CF-ST-TOL-REFUND.
  3805
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  74
* EL106.cbl
  3806     IF OVSAMTL > 0
  3807         MOVE OVSAMTI TO CF-ST-OVR-SHT-AMT
  3808     END-IF.
  3809
  3810     IF PRMPCTL NOT = ZEROS
  3811         MOVE WS-ST-TOL-PREM-PCT  TO CF-ST-TOL-PREM-PCT.
  3812
  3813     IF REFPCTL NOT = ZEROS
  3814         MOVE  WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  3815
  3816     IF OVSPCTL > +0
  3817         MOVE WS-ST-OVR-SHT-PCT TO CF-ST-OVR-SHT-PCT
  3818     END-IF.
  3819
  3820     IF CLREJECL NOT = ZEROS
  3821         MOVE CLREJECI            TO CF-ST-CLAIM-REJECT-SW.
  3822
  3823     IF ISSREJL NOT = ZEROS
  3824         MOVE ISSREJI             TO CF-ST-PREM-REJECT-SW.
  3825
  3826     IF REFREJL NOT = ZEROS
  3827         MOVE REFREJI             TO CF-ST-REF-REJECT-SW.
  3828
  3829     IF REFMINL NOT = ZEROS
  3830         MOVE REFMINI             TO CF-ST-REFUND-MIN.
  3831
  3832     IF REFDAY1L NOT = ZEROS
  3833         MOVE REFDAY1I            TO CF-ST-REFUND-DAYS-FIRST.
  3834
  3835     IF REFDAYSL NOT = ZEROS
  3836         MOVE REFDAYSI            TO CF-ST-REFUND-DAYS-SUBSEQ.
  3837
  3838     IF SPLPMTL NOT = ZEROS
  3839         MOVE SPLPMTI             TO CF-ST-SPLIT-PAYMENT.
  3840
  3841     IF EXTDAYSL NOT = ZEROS
  3842         MOVE EXTDAYSI            TO CF-ST-FST-PMT-DAYS-MAX.
  3843
  3844*    IF INTDAYSL NOT = ZEROS
  3845*        MOVE INTDAYSI            TO CF-ST-NO-DAYS-ELAPSED.
  3846
  3847     IF EXTCHGL NOT = ZEROS
  3848         MOVE EXTCHGI             TO CF-ST-FST-PMT-DAYS-CHG.
  3849
  3850     IF REMTERML NOT = ZEROS
  3851        MOVE REMTERMI             TO CF-ST-RT-CALC
  3852     END-IF
  3853
  3854     IF LFREDL NOT = ZEROS
  3855        MOVE LFREDI               TO CF-ST-RF-LR-CALC
  3856     END-IF
  3857
  3858     IF LFLEVL NOT = ZEROS
  3859        MOVE LFLEVI               TO CF-ST-RF-LL-CALC
  3860     END-IF
  3861
  3862     IF LFNETL NOT = ZEROS
  3863        MOVE LFNETI               TO CF-ST-RF-LN-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  75
* EL106.cbl
  3864     END-IF
  3865
  3866     IF AHAHL NOT = ZEROS
  3867        MOVE AHAHI                TO CF-ST-RF-AH-CALC
  3868     END-IF
  3869
  3870     IF AHCPL NOT = ZEROS
  3871        MOVE AHCPI                TO CF-ST-RF-CP-CALC
  3872     END-IF
  3873
  3874     IF LFTAXL > +0
  3875        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  3876     END-IF
  3877
  3878     IF AHITAXL > +0
  3879        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  3880     END-IF
  3881
  3882     IF AHGTAXL > +0
  3883        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  3884     END-IF
  3885
  3886     IF REFCLML NOT = ZEROS
  3887         MOVE REFCLMI             TO CF-ST-REF-AH-DEATH-IND
  3888     END-IF.
  3889
  3890     IF VFYBENEL NOT = ZEROS
  3891         MOVE VFYBENEI            TO CF-ST-VFY-2ND-BENE
  3892     END-IF.
  3893
  3894     IF CAUSALL NOT = ZEROS
  3895         MOVE CAUSALI             TO CF-ST-CAUSAL-STATE
  3896     END-IF.
  3897
  3898     IF STUEL NOT = ZEROS
  3899         MOVE STUEI               TO CF-ST-CALL-UNEARNED.
  3900
  3901     IF STCNTLL NOT = ZEROS
  3902         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  3903
  3904     IF STDEVL NOT = ZEROS
  3905         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  3906
  3907     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  3908     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  3909
  3910     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  3911
  3912*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  3913
  3914     IF WS-COMSL NUMERIC AND
  3915        WS-COMSL NOT = ZEROS
  3916         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL
  3917      ELSE
  3918         MOVE ZEROS              TO CF-ST-COMM-CAP-SL.
  3919
  3920     IF WS-COMJL NUMERIC AND
  3921        WS-COMJL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  76
* EL106.cbl
  3922         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL
  3923      ELSE
  3924         MOVE ZEROS              TO CF-ST-COMM-CAP-JL.
  3925
  3926     IF WS-COMSA NUMERIC AND
  3927        WS-COMSA NOT = ZEROS
  3928         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA
  3929      ELSE
  3930         MOVE ZEROS              TO CF-ST-COMM-CAP-SA.
  3931
  3932     IF WS-COMJA NUMERIC AND
  3933        WS-COMJA NOT = ZEROS
  3934         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA
  3935      ELSE
  3936         MOVE ZEROS              TO CF-ST-COMM-CAP-JA.
  3937
  3938     IF WS-IRATE NUMERIC AND
  3939        WS-IRATE NOT = ZEROS
  3940         MOVE WS-IRATE           TO CF-ST-STAT-INTEREST
  3941      ELSE
  3942         MOVE ZEROS              TO CF-ST-STAT-INTEREST.
  3943
  3944     IF WS-IRATE1 NUMERIC AND
  3945        WS-IRATE1 NOT = ZEROS
  3946         MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1
  3947      ELSE
  3948         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1.
  3949
  3950     IF WS-IRATE2 NUMERIC AND
  3951        WS-IRATE2 NOT = ZEROS
  3952         MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2
  3953      ELSE
  3954         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2.
  3955
  3956     IF WS-IRATE3 NUMERIC AND
  3957        WS-IRATE3 NOT = ZEROS
  3958         MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3
  3959      ELSE
  3960         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3.
  3961
  3962     IF WS-RESIDENT-TAX NUMERIC AND
  3963        WS-RESIDENT-TAX NOT = ZEROS
  3964         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT
  3965      ELSE
  3966         MOVE ZEROS              TO CF-ST-RES-TAX-PCT.
  3967
  3968     IF WS-FREE-LOOK-DAYS NUMERIC
  3969             AND
  3970        WS-FREE-LOOK-DAYS NOT EQUAL ZEROS
  3971         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD
  3972      ELSE
  3973         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD.
  3974
  3975     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  3976             AND
  3977         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  3978         MOVE WS-ST-TARGET-LOSS-RATIO
  3979                                 TO CF-ST-TARGET-LOSS-RATIO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  77
* EL106.cbl
  3980     ELSE
  3981         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  3982
  3983     IF  WS-ST-CALC-INTEREST NUMERIC
  3984             AND
  3985         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  3986         MOVE WS-ST-CALC-INTEREST
  3987                                 TO CF-ST-CALC-INTEREST
  3988     ELSE
  3989         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  3990
  3991     MOVE 'C'                    TO JP-RECORD-TYPE.
  3992     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3993
  3994* EXEC CICS REWRITE
  3995*        DATASET(ELCNTL-ID)
  3996*        FROM   (CONTROL-FILE)
  3997*    END-EXEC.
  3998     MOVE LENGTH OF
  3999      CONTROL-FILE
  4000       TO DFHEIV11
  4001*    MOVE '&& L                  %   #00003830' TO DFHEIV0
  4002     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4003     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4004     MOVE X'2020233030303033383330' TO DFHEIV0(25:11)
  4005     CALL 'kxdfhei1' USING DFHEIV0,
  4006           ELCNTL-ID,
  4007           CONTROL-FILE,
  4008           DFHEIV11,
  4009           DFHEIV99
  4010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4011
  4012
  4013     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4014     MOVE ER-0000 TO EMI-ERROR.
  4015     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4016     MOVE LOW-VALUES  TO EL106AO.
  4017     MOVE -1          TO MAINTL.
  4018     MOVE SPACES      TO PI-PREV-STATE.
  4019     MOVE CK-STATE-CD TO STCDO.
  4020     MOVE AL-UANON    TO STCDA.
  4021     GO TO 1000-SHOW-STATE.
  4022
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  78
* EL106.cbl
  4024 3000-ADD-STATE.
  4025     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  4026
  4027     IF NOT EMI-NO-ERRORS
  4028         GO TO 8200-SEND-DATAONLY.
  4029
  4030
  4031* EXEC CICS GETMAIN
  4032*        SET    (ADDRESS OF CONTROL-FILE)
  4033*        LENGTH (750)
  4034*        INITIMG(GETMAIN-SPACE)
  4035*    END-EXEC.
  4036     MOVE 750
  4037       TO DFHEIV11
  4038*    MOVE ',"IL                  $   #00003852' TO DFHEIV0
  4039     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4040     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4041     MOVE X'2020233030303033383532' TO DFHEIV0(25:11)
  4042     CALL 'kxdfhei1' USING DFHEIV0,
  4043           DFHEIV20,
  4044           DFHEIV11,
  4045           GETMAIN-SPACE
  4046     SET ADDRESS OF CONTROL-FILE TO
  4047         DFHEIV20
  4048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4049
  4050
  4051     MOVE 'CF'          TO CF-RECORD-ID.
  4052     MOVE PI-COMPANY-ID TO CF-COMPANY-ID.
  4053     MOVE '3'           TO CF-RECORD-TYPE.
  4054     MOVE STCDI         TO CF-ACCESS-OF-STATE.
  4055     MOVE +0            TO CF-SEQUENCE-NO.
  4056
  4057     MOVE EIBDATE       TO DC-JULIAN-YYDDD.
  4058     MOVE '5'           TO DC-OPTION-CODE.
  4059     MOVE LINK-ELDATCV  TO PGM-NAME.
  4060
  4061* EXEC CICS LINK
  4062*        PROGRAM (PGM-NAME)
  4063*        COMMAREA(DATE-CONVERSION-DATA)
  4064*        LENGTH  (DC-COMM-LENGTH)
  4065*    END-EXEC.
  4066*    MOVE '."C                   (   #00003867' TO DFHEIV0
  4067     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4069     MOVE X'2020233030303033383637' TO DFHEIV0(25:11)
  4070     CALL 'kxdfhei1' USING DFHEIV0,
  4071           PGM-NAME,
  4072           DATE-CONVERSION-DATA,
  4073           DC-COMM-LENGTH,
  4074           DFHEIV99,
  4075           DFHEIV99,
  4076           DFHEIV99,
  4077           DFHEIV99
  4078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4079
  4080
  4081     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  79
* EL106.cbl
  4082         MOVE LOW-VALUES    TO CF-LAST-MAINT-DT
  4083       ELSE
  4084         MOVE DC-BIN-DATE-1 TO CF-LAST-MAINT-DT.
  4085
  4086     MOVE PI-PROCESSOR-ID   TO CF-LAST-MAINT-BY.
  4087     MOVE EIBTIME           TO CF-LAST-MAINT-HHMMSS.
  4088
  4089     MOVE STNAMEI           TO CF-STATE-NAME.
  4090     MOVE STABRI            TO CF-STATE-ABBREVIATION.
  4091
  4092     IF LFEXPL = ZEROS
  4093         MOVE ZEROS               TO CF-ST-LF-EXP-PCT
  4094       ELSE
  4095         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  4096
  4097     IF AHEXPL = ZEROS
  4098         MOVE ZEROS               TO CF-ST-AH-EXP-PCT
  4099       ELSE
  4100         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  4101
  4102     IF QUOTCALL = ZEROS
  4103         MOVE ZEROS               TO CF-ST-TOL-CLAIM
  4104       ELSE
  4105         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  4106
  4107     IF PREMTOLL = ZEROS
  4108         MOVE ZEROS               TO CF-ST-TOL-PREM
  4109       ELSE
  4110         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  4111
  4112     IF OVSAMTL = ZEROS
  4113         MOVE ZEROS              TO CF-ST-OVR-SHT-AMT
  4114       ELSE
  4115         MOVE OVSAMTI            TO CF-ST-OVR-SHT-AMT.
  4116
  4117     IF REFTOLL = ZEROS
  4118         MOVE ZEROS              TO CF-ST-TOL-REFUND
  4119       ELSE
  4120         MOVE REFTOLI            TO CF-ST-TOL-REFUND.
  4121
  4122     IF PRMPCTL = ZEROS
  4123         MOVE ZEROS              TO CF-ST-TOL-PREM-PCT
  4124       ELSE
  4125         MOVE WS-ST-TOL-PREM-PCT TO CF-ST-TOL-PREM-PCT.
  4126
  4127     IF OVSPCTL = ZEROS
  4128         MOVE ZEROS              TO CF-ST-OVR-SHT-PCT
  4129       ELSE
  4130         MOVE WS-ST-OVR-SHT-PCT  TO CF-ST-OVR-SHT-PCT.
  4131
  4132     IF REFPCTL = ZEROS
  4133         MOVE ZEROS              TO CF-ST-TOL-REF-PCT
  4134       ELSE
  4135         MOVE WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  4136
  4137     IF CLREJECL = ZEROS
  4138         MOVE SPACE              TO CF-ST-CLAIM-REJECT-SW
  4139       ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  80
* EL106.cbl
  4140         MOVE CLREJECI           TO CF-ST-CLAIM-REJECT-SW.
  4141
  4142     IF ISSREJL = ZEROS
  4143         MOVE SPACE              TO CF-ST-PREM-REJECT-SW
  4144       ELSE
  4145         MOVE ISSREJI            TO CF-ST-PREM-REJECT-SW.
  4146
  4147     IF REFREJL = ZEROS
  4148         MOVE SPACE              TO CF-ST-REF-REJECT-SW
  4149       ELSE
  4150         MOVE REFREJI            TO CF-ST-REF-REJECT-SW.
  4151
  4152     IF REFMINL = ZEROS
  4153         MOVE ZEROS              TO CF-ST-REFUND-MIN
  4154       ELSE
  4155         MOVE REFMINI            TO CF-ST-REFUND-MIN.
  4156
  4157     IF REFDAY1L  = ZERO
  4158         MOVE ZEROS              TO CF-ST-REFUND-DAYS-FIRST
  4159       ELSE
  4160         MOVE REFDAY1I           TO CF-ST-REFUND-DAYS-FIRST.
  4161
  4162     IF REFDAYSL = ZERO
  4163         MOVE ZEROS              TO CF-ST-REFUND-DAYS-SUBSEQ
  4164       ELSE
  4165         MOVE REFDAYSI           TO CF-ST-REFUND-DAYS-SUBSEQ.
  4166
  4167     IF SPLPMTL = ZERO
  4168         MOVE 'N'                TO CF-ST-SPLIT-PAYMENT
  4169     ELSE
  4170         MOVE SPLPMTI            TO CF-ST-SPLIT-PAYMENT.
  4171
  4172     IF EXTDAYSL = ZERO
  4173         MOVE ZEROS              TO CF-ST-FST-PMT-DAYS-MAX
  4174       ELSE
  4175         MOVE EXTDAYSI           TO CF-ST-FST-PMT-DAYS-MAX.
  4176
  4177*    IF INTDAYSL = ZERO
  4178*        MOVE ZEROS              TO CF-ST-NO-DAYS-ELAPSED
  4179*      ELSE
  4180*        MOVE INTDAYSI           TO CF-ST-NO-DAYS-ELAPSED.
  4181
  4182     IF EXTCHGL = ZEROS
  4183         MOVE SPACES             TO CF-ST-FST-PMT-DAYS-CHG
  4184       ELSE
  4185         MOVE EXTCHGI            TO CF-ST-FST-PMT-DAYS-CHG.
  4186
  4187     IF REMTERML = ZEROS
  4188        MOVE SPACES              TO CF-ST-RT-CALC
  4189     ELSE
  4190        MOVE REMTERMI            TO CF-ST-RT-CALC
  4191     END-IF
  4192
  4193     IF LFTAXL = ZEROS
  4194        MOVE ZEROS               TO CF-ST-LF-PREM-TAX
  4195     ELSE
  4196        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  4197     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  81
* EL106.cbl
  4198
  4199     IF AHITAXL = ZEROS
  4200        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-I
  4201     ELSE
  4202        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  4203     END-IF
  4204
  4205     IF AHGTAXL = ZEROS
  4206        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-G
  4207     ELSE
  4208        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  4209     END-IF
  4210
  4211     IF STUEL = ZEROS
  4212         MOVE SPACES             TO CF-ST-CALL-UNEARNED
  4213       ELSE
  4214         MOVE STUEI              TO CF-ST-CALL-UNEARNED.
  4215
  4216     IF STCNTLL = ZEROS
  4217         MOVE SPACES             TO CF-ST-CALL-RPT-CNTL
  4218       ELSE
  4219         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  4220
  4221     IF STDEVL = ZEROS
  4222         MOVE SPACES             TO CF-ST-CALL-RATE-DEV
  4223       ELSE
  4224         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  4225
  4226     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  4227             AND
  4228         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  4229         MOVE WS-ST-TARGET-LOSS-RATIO
  4230                                 TO CF-ST-TARGET-LOSS-RATIO
  4231     ELSE
  4232         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  4233
  4234     IF  WS-ST-CALC-INTEREST NUMERIC
  4235             AND
  4236         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  4237         MOVE WS-ST-CALC-INTEREST
  4238                                 TO CF-ST-CALC-INTEREST
  4239     ELSE
  4240         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  4241
  4242     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  4243     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  4244
  4245     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  4246
  4247*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  4248
  4249     IF COMSLL = ZEROS
  4250         MOVE ZEROS              TO CF-ST-COMM-CAP-SL
  4251       ELSE
  4252         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL.
  4253
  4254     IF COMJLL = ZEROS
  4255         MOVE ZEROS              TO CF-ST-COMM-CAP-JL
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  82
* EL106.cbl
  4256       ELSE
  4257         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL.
  4258
  4259     IF COMSAL = ZEROS
  4260         MOVE ZEROS              TO CF-ST-COMM-CAP-SA
  4261       ELSE
  4262         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA.
  4263
  4264     IF COMJAL = ZEROS
  4265         MOVE ZEROS              TO CF-ST-COMM-CAP-JA
  4266       ELSE
  4267         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA.
  4268
  4269     IF RESTAXL = ZEROS
  4270         MOVE ZEROS              TO CF-ST-RES-TAX-PCT
  4271       ELSE
  4272         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT.
  4273
  4274     IF FREELKL = ZEROS
  4275         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD
  4276       ELSE
  4277         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD.
  4278
  4279*    IF STATRL = ZEROS
  4280         MOVE ZEROS              TO CF-ST-STAT-INTEREST
  4281*      ELSE
  4282*        MOVE WS-IRATE           TO CF-ST-STAT-INTEREST.
  4283
  4284*    IF STATR1L = ZEROS
  4285         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1
  4286*      ELSE
  4287*        MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1.
  4288
  4289*    IF STATR2L = ZEROS
  4290         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2
  4291*      ELSE
  4292*        MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2.
  4293
  4294*    IF STATR3L = ZEROS
  4295         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3
  4296*      ELSE
  4297*        MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3.
  4298
  4299     PERFORM 6100-INITIALIZE-BENEFIT-CNTL THRU 6199-EXIT
  4300             VARYING SUB FROM +1 BY +1
  4301             UNTIL SUB GREATER THAN +50.
  4302
  4303     MOVE 'A'                    TO JP-RECORD-TYPE.
  4304     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4305
  4306
  4307* EXEC CICS WRITE
  4308*        FROM   (CONTROL-FILE)
  4309*        DATASET(ELCNTL-ID)
  4310*        RIDFLD (CF-CONTROL-PRIMARY)
  4311*    END-EXEC.
  4312     MOVE LENGTH OF
  4313      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  83
* EL106.cbl
  4314       TO DFHEIV11
  4315*    MOVE '&$ L                  ''   #00004098' TO DFHEIV0
  4316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4318     MOVE X'2020233030303034303938' TO DFHEIV0(25:11)
  4319     CALL 'kxdfhei1' USING DFHEIV0,
  4320           ELCNTL-ID,
  4321           CONTROL-FILE,
  4322           DFHEIV11,
  4323           CF-CONTROL-PRIMARY,
  4324           DFHEIV99,
  4325           DFHEIV99
  4326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4327
  4328
  4329     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4330     MOVE ER-0000 TO EMI-ERROR.
  4331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4332     MOVE LOW-VALUES  TO EL106AO.
  4333     MOVE -1          TO MAINTL.
  4334     MOVE SPACES      TO PI-PREV-STATE.
  4335     MOVE CK-STATE-CD TO STCDO.
  4336     MOVE AL-UANON    TO STCDA.
  4337     GO TO 8100-SEND-INITIAL-MAP.
  4338
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  84
* EL106.cbl
  4340 4000-DELETE-STATE.
  4341     IF STCDI NOT = PI-PREV-STATE
  4342         MOVE ER-0145  TO EMI-ERROR
  4343         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4344         MOVE -1       TO STCDL
  4345         MOVE AL-UABON TO STCDA
  4346         GO TO 8200-SEND-DATAONLY.
  4347
  4348     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  4349     MOVE STCDI         TO CK-STATE-CD.
  4350
  4351* EXEC CICS READ
  4352*        UPDATE
  4353*        DATASET(ELCNTL-ID)
  4354*        SET    (ADDRESS OF CONTROL-FILE)
  4355*        RIDFLD (ELCNTL-KEY)
  4356*    END-EXEC.
  4357*    MOVE '&"S        EU         (   #00004125' TO DFHEIV0
  4358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4359     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4360     MOVE X'2020233030303034313235' TO DFHEIV0(25:11)
  4361     CALL 'kxdfhei1' USING DFHEIV0,
  4362           ELCNTL-ID,
  4363           DFHEIV20,
  4364           DFHEIV99,
  4365           ELCNTL-KEY,
  4366           DFHEIV99,
  4367           DFHEIV99,
  4368           DFHEIV99
  4369     SET ADDRESS OF CONTROL-FILE TO
  4370         DFHEIV20
  4371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4372
  4373
  4374     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  4375        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  4376
  4377* EXEC CICS UNLOCK
  4378*            DATASET(ELCNTL-ID)
  4379*        END-EXEC
  4380*    MOVE '&*                    #   #00004134' TO DFHEIV0
  4381     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4382     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4383     MOVE X'2020233030303034313334' TO DFHEIV0(25:11)
  4384     CALL 'kxdfhei1' USING DFHEIV0,
  4385           ELCNTL-ID,
  4386           DFHEIV99
  4387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4388         MOVE ER-0068 TO EMI-ERROR
  4389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4390         GO TO 1000-SHOW-STATE.
  4391
  4392     MOVE 'D'                    TO JP-RECORD-TYPE.
  4393     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4394
  4395* EXEC CICS DELETE
  4396*        DATASET(ELCNTL-ID)
  4397*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  85
* EL106.cbl
  4398*    MOVE '&(                    &   #00004143' TO DFHEIV0
  4399     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4400     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4401     MOVE X'2020233030303034313433' TO DFHEIV0(25:11)
  4402     CALL 'kxdfhei1' USING DFHEIV0,
  4403           ELCNTL-ID,
  4404           DFHEIV99,
  4405           DFHEIV99,
  4406           DFHEIV99,
  4407           DFHEIV99
  4408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4409
  4410
  4411     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT
  4412     MOVE ER-0000 TO EMI-ERROR.
  4413     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4414     MOVE LOW-VALUES  TO EL106AO.
  4415     MOVE -1          TO MAINTL.
  4416     MOVE SPACES      TO PI-PREV-STATE
  4417     MOVE CK-STATE-CD TO STCDO.
  4418     MOVE AL-UANON    TO STCDA.
  4419     GO TO 8100-SEND-INITIAL-MAP.
  4420
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  86
* EL106.cbl
  4422 5000-FIND-NEXT-STATE.
  4423     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  4424
  4425     IF STCDL = 0
  4426         MOVE LOW-VALUES TO CK-STATE-CD
  4427         MOVE +0         TO CK-SEQ
  4428     ELSE
  4429         MOVE STCDI      TO CK-STATE-CD
  4430         MOVE +1         TO CK-SEQ.
  4431
  4432     MOVE SPACES TO PI-PREV-STATE.
  4433
  4434
  4435* EXEC CICS HANDLE CONDITION
  4436*        NOTFND (8860-ENDFILE)
  4437*    END-EXEC.
  4438*    MOVE '"$I                   ! % #00004170' TO DFHEIV0
  4439     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4441     MOVE X'2520233030303034313730' TO DFHEIV0(25:11)
  4442     CALL 'kxdfhei1' USING DFHEIV0
  4443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4444
  4445
  4446
  4447* EXEC CICS READ
  4448*        DATASET(ELCNTL-ID)
  4449*        SET    (ADDRESS OF CONTROL-FILE)
  4450*        RIDFLD (ELCNTL-KEY)
  4451*        GTEQ
  4452*    END-EXEC.
  4453*    MOVE '&"S        G          (   #00004174' TO DFHEIV0
  4454     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4456     MOVE X'2020233030303034313734' TO DFHEIV0(25:11)
  4457     CALL 'kxdfhei1' USING DFHEIV0,
  4458           ELCNTL-ID,
  4459           DFHEIV20,
  4460           DFHEIV99,
  4461           ELCNTL-KEY,
  4462           DFHEIV99,
  4463           DFHEIV99,
  4464           DFHEIV99
  4465     SET ADDRESS OF CONTROL-FILE TO
  4466         DFHEIV20
  4467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4468
  4469
  4470     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4471        CF-RECORD-TYPE NOT = '3'
  4472         GO TO 8860-ENDFILE.
  4473
  4474     IF STCDL = 0
  4475         MOVE ER-0146 TO EMI-ERROR
  4476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4477
  4478     GO TO 7000-BUILD-OUTPUT-MAP.
  4479
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  87
* EL106.cbl
  4481 5500-FIND-PREV-STATE.
  4482     MOVE PI-COMPANY-ID          TO  CK-COMP-ID.
  4483     MOVE PI-PREV-STATE          TO  CK-STATE-CD.
  4484
  4485     IF STCDL GREATER +0
  4486         MOVE STCDI              TO  CK-STATE-CD.
  4487
  4488     MOVE SPACES                 TO  PI-PREV-STATE.
  4489
  4490
  4491* EXEC CICS HANDLE CONDITION
  4492*        NOTFND(8860-ENDFILE)
  4493*    END-EXEC.
  4494*    MOVE '"$I                   ! & #00004201' TO DFHEIV0
  4495     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4497     MOVE X'2620233030303034323031' TO DFHEIV0(25:11)
  4498     CALL 'kxdfhei1' USING DFHEIV0
  4499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4500
  4501
  4502
  4503* EXEC CICS STARTBR
  4504*        DATASET  (ELCNTL-ID)
  4505*        RIDFLD   (ELCNTL-KEY)
  4506*    END-EXEC.
  4507     MOVE 0
  4508       TO DFHEIV11
  4509*    MOVE '&,         G          &   #00004205' TO DFHEIV0
  4510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4512     MOVE X'2020233030303034323035' TO DFHEIV0(25:11)
  4513     CALL 'kxdfhei1' USING DFHEIV0,
  4514           ELCNTL-ID,
  4515           ELCNTL-KEY,
  4516           DFHEIV99,
  4517           DFHEIV11,
  4518           DFHEIV99
  4519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4520
  4521
  4522 5600-READ-PREV-STATE-RECORD.
  4523
  4524* EXEC CICS READPREV
  4525*        DATASET  (ELCNTL-ID)
  4526*        SET      (ADDRESS OF CONTROL-FILE)
  4527*        RIDFLD   (ELCNTL-KEY)
  4528*    END-EXEC.
  4529     MOVE 0
  4530       TO DFHEIV11
  4531*    MOVE '&0S                   )   #00004211' TO DFHEIV0
  4532     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4533     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4534     MOVE X'2020233030303034323131' TO DFHEIV0(25:11)
  4535     CALL 'kxdfhei1' USING DFHEIV0,
  4536           ELCNTL-ID,
  4537           DFHEIV20,
  4538           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  88
* EL106.cbl
  4539           ELCNTL-KEY,
  4540           DFHEIV99,
  4541           DFHEIV11,
  4542           DFHEIV99,
  4543           DFHEIV99
  4544     SET ADDRESS OF CONTROL-FILE TO
  4545         DFHEIV20
  4546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4547
  4548
  4549     IF FIRST-TIME
  4550         MOVE 'N'                TO  WS-FIRST-TIME-SW
  4551         GO TO 5600-READ-PREV-STATE-RECORD.
  4552
  4553     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4554        CF-RECORD-TYPE NOT = '3'
  4555         GO TO 8860-ENDFILE.
  4556
  4557     IF STCDL = 0
  4558         MOVE ER-0146 TO EMI-ERROR
  4559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4560
  4561     GO TO 7000-BUILD-OUTPUT-MAP.
  4562
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  89
* EL106.cbl
  4564 6000-EDIT-INPUT-DATA.
  4565     IF STABRL = ZEROS AND MAINTI = 'A'
  4566        MOVE -1  TO STABRL
  4567        MOVE ER-0152 TO EMI-ERROR
  4568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4569
  4570     IF STNAMEL = ZEROS AND MAINTI = 'A'
  4571        MOVE -1   TO STNAMEL
  4572        MOVE ER-0153 TO EMI-ERROR
  4573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4574
  4575     IF LFEXPL NOT = ZEROS
  4576
  4577* EXEC CICS BIF
  4578*            DEEDIT
  4579*            FIELD (LFEXPI)
  4580*            LENGTH(7)
  4581*       END-EXEC
  4582     MOVE 7
  4583       TO DFHEIV11
  4584*    MOVE '@"L                   #   #00004244' TO DFHEIV0
  4585     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4586     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4587     MOVE X'2020233030303034323434' TO DFHEIV0(25:11)
  4588     CALL 'kxdfhei1' USING DFHEIV0,
  4589           LFEXPI,
  4590           DFHEIV11
  4591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4592      IF LFEXPI NUMERIC
  4593            MOVE AL-UNNON        TO LFEXPA
  4594            MOVE LFEXPI          TO WS-ST-LF-EXP-PCT
  4595        ELSE
  4596            MOVE ER-7531         TO EMI-ERROR
  4597            MOVE -1              TO LFEXPL
  4598            MOVE AL-UNBON        TO LFEXPA
  4599            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4600
  4601     IF AHEXPL NOT = ZEROS
  4602
  4603* EXEC CICS BIF
  4604*            DEEDIT
  4605*            FIELD (AHEXPI)
  4606*            LENGTH(7)
  4607*       END-EXEC
  4608     MOVE 7
  4609       TO DFHEIV11
  4610*    MOVE '@"L                   #   #00004259' TO DFHEIV0
  4611     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4612     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4613     MOVE X'2020233030303034323539' TO DFHEIV0(25:11)
  4614     CALL 'kxdfhei1' USING DFHEIV0,
  4615           AHEXPI,
  4616           DFHEIV11
  4617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4618      IF AHEXPI NUMERIC
  4619            MOVE AL-UNNON        TO AHEXPA
  4620            MOVE AHEXPI          TO WS-ST-AH-EXP-PCT
  4621        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  90
* EL106.cbl
  4622            MOVE ER-7531         TO EMI-ERROR
  4623            MOVE -1              TO AHEXPL
  4624            MOVE AL-UNBON        TO AHEXPA
  4625            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4626
  4627     IF QUOTCALL NOT = ZEROS
  4628
  4629* EXEC CICS BIF
  4630*            DEEDIT
  4631*            FIELD (QUOTCALI)
  4632*            LENGTH(6)
  4633*       END-EXEC
  4634     MOVE 6
  4635       TO DFHEIV11
  4636*    MOVE '@"L                   #   #00004274' TO DFHEIV0
  4637     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4638     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4639     MOVE X'2020233030303034323734' TO DFHEIV0(25:11)
  4640     CALL 'kxdfhei1' USING DFHEIV0,
  4641           QUOTCALI,
  4642           DFHEIV11
  4643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4644        IF QUOTCALI NOT NUMERIC
  4645           MOVE -1               TO QUOTCALL
  4646           MOVE AL-UNBON         TO QUOTCALA
  4647           MOVE ER-2009          TO EMI-ERROR
  4648           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4649        ELSE
  4650        IF QUOTCALI GREATER THAN 9999
  4651           MOVE -1               TO QUOTCALL
  4652           MOVE AL-UNBON         TO QUOTCALA
  4653           MOVE ER-2009          TO EMI-ERROR
  4654           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4655
  4656     IF OVSAMTL NOT = ZEROS
  4657
  4658* EXEC CICS BIF
  4659*            DEEDIT
  4660*            FIELD (OVSAMTI)
  4661*            LENGTH(6)
  4662*       END-EXEC
  4663     MOVE 6
  4664       TO DFHEIV11
  4665*    MOVE '@"L                   #   #00004292' TO DFHEIV0
  4666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4668     MOVE X'2020233030303034323932' TO DFHEIV0(25:11)
  4669     CALL 'kxdfhei1' USING DFHEIV0,
  4670           OVSAMTI,
  4671           DFHEIV11
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4673        IF OVSAMTI  NOT NUMERIC
  4674           MOVE -1               TO OVSAMTL
  4675           MOVE AL-UNBON         TO OVSAMTA
  4676           MOVE ER-2010          TO EMI-ERROR
  4677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4678        ELSE
  4679        IF OVSAMTI  GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  91
* EL106.cbl
  4680           MOVE -1               TO OVSAMTL
  4681           MOVE AL-UNBON         TO OVSAMTA
  4682           MOVE ER-2010          TO EMI-ERROR
  4683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4684
  4685     IF PREMTOLL NOT = ZEROS
  4686
  4687* EXEC CICS BIF
  4688*            DEEDIT
  4689*            FIELD (PREMTOLI)
  4690*            LENGTH(6)
  4691*       END-EXEC
  4692     MOVE 6
  4693       TO DFHEIV11
  4694*    MOVE '@"L                   #   #00004310' TO DFHEIV0
  4695     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4696     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4697     MOVE X'2020233030303034333130' TO DFHEIV0(25:11)
  4698     CALL 'kxdfhei1' USING DFHEIV0,
  4699           PREMTOLI,
  4700           DFHEIV11
  4701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4702        IF PREMTOLI NOT NUMERIC
  4703           MOVE -1               TO PREMTOLL
  4704           MOVE AL-UNBON         TO PREMTOLA
  4705           MOVE ER-2010          TO EMI-ERROR
  4706           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4707        ELSE
  4708        IF PREMTOLI GREATER THAN 9999
  4709           MOVE -1               TO PREMTOLL
  4710           MOVE AL-UNBON         TO PREMTOLA
  4711           MOVE ER-2010          TO EMI-ERROR
  4712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4713
  4714     IF REFTOLL NOT = ZEROS
  4715
  4716* EXEC CICS BIF
  4717*            DEEDIT
  4718*            FIELD(REFTOLI)
  4719*            LENGTH(6)
  4720*       END-EXEC
  4721     MOVE 6
  4722       TO DFHEIV11
  4723*    MOVE '@"L                   #   #00004328' TO DFHEIV0
  4724     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4725     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4726     MOVE X'2020233030303034333238' TO DFHEIV0(25:11)
  4727     CALL 'kxdfhei1' USING DFHEIV0,
  4728           REFTOLI,
  4729           DFHEIV11
  4730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4731        IF REFTOLI NOT NUMERIC
  4732           MOVE -1               TO REFTOLL
  4733           MOVE AL-UNBON         TO REFTOLA
  4734           MOVE ER-2014          TO EMI-ERROR
  4735           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4736        ELSE
  4737        IF REFTOLI GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  92
* EL106.cbl
  4738           MOVE -1               TO REFTOLL
  4739           MOVE AL-UNBON         TO REFTOLA
  4740           MOVE ER-2014          TO EMI-ERROR
  4741           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4742
  4743     IF CLREJECL NOT = ZEROS
  4744        IF CLREJECI = SPACES OR '1'
  4745           NEXT SENTENCE
  4746          ELSE
  4747           MOVE -1               TO CLREJECL
  4748           MOVE AL-UABON         TO CLREJECA
  4749           MOVE ER-2024          TO EMI-ERROR
  4750           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4751
  4752     IF ISSREJL NOT = ZEROS
  4753        IF ISSREJI = SPACES OR '1'
  4754           NEXT SENTENCE
  4755          ELSE
  4756           MOVE -1               TO ISSREJL
  4757           MOVE AL-UABON         TO ISSREJA
  4758           MOVE ER-2012          TO EMI-ERROR
  4759           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4760
  4761     IF REFREJL NOT = ZEROS
  4762        IF REFREJI = SPACES OR '1'
  4763           NEXT SENTENCE
  4764          ELSE
  4765           MOVE -1               TO REFREJL
  4766           MOVE AL-UABON         TO REFREJA
  4767           MOVE ER-2028          TO EMI-ERROR
  4768           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4769
  4770     IF REFMINL NOT = ZEROS
  4771
  4772* EXEC CICS BIF
  4773*            DEEDIT
  4774*            FIELD (REFMINI)
  4775*            LENGTH(6)
  4776*       END-EXEC
  4777     MOVE 6
  4778       TO DFHEIV11
  4779*    MOVE '@"L                   #   #00004373' TO DFHEIV0
  4780     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4782     MOVE X'2020233030303034333733' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0,
  4784           REFMINI,
  4785           DFHEIV11
  4786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4787        IF REFMINI NOT NUMERIC
  4788           MOVE -1               TO REFMINL
  4789           MOVE AL-UNBON         TO REFMINA
  4790           MOVE ER-3030          TO EMI-ERROR
  4791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4792
  4793     IF REFDAY1L NOT = ZERO
  4794        IF REFDAY1I LESS '00' OR GREATER '31'
  4795            MOVE -1               TO REFDAY1L
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  93
* EL106.cbl
  4796            MOVE AL-UNBON         TO REFDAY1A
  4797            MOVE ER-3031          TO EMI-ERROR
  4798            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4799
  4800     IF REFDAYSL NOT = ZERO
  4801        IF REFDAYSI LESS '00' OR GREATER '31'
  4802            MOVE -1               TO REFDAYSL
  4803            MOVE AL-UNBON         TO REFDAYSA
  4804            MOVE ER-3031          TO EMI-ERROR
  4805            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4806
  4807     IF SPLPMTL NOT = ZERO
  4808        IF (SPLPMTI IS EQUAL TO 'Y' OR 'N' OR ' ')
  4809            NEXT SENTENCE
  4810        ELSE
  4811            MOVE -1               TO SPLPMTL
  4812            MOVE AL-UABON         TO SPLPMTA
  4813            MOVE ER-0805          TO EMI-ERROR
  4814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4815
  4816     IF EXTDAYSL NOT = ZERO
  4817        IF EXTDAYSI NOT NUMERIC
  4818            MOVE -1               TO EXTDAYSL
  4819            MOVE AL-UNBON         TO EXTDAYSA
  4820            MOVE ER-3032          TO EMI-ERROR
  4821            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4822
  4823*    IF INTDAYSL NOT = ZERO
  4824*       IF INTDAYSI NOT NUMERIC
  4825*           MOVE -1               TO INTDAYSL
  4826*           MOVE AL-UNBON         TO INTDAYSA
  4827*           MOVE ER-0141          TO EMI-ERROR
  4828*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4829
  4830     IF EXTCHGL NOT = ZEROS
  4831        IF EXTCHGI = SPACES OR '1' OR '2' OR '3'
  4832           NEXT SENTENCE
  4833          ELSE
  4834           MOVE -1               TO EXTCHGL
  4835           MOVE AL-UABON         TO EXTCHGA
  4836           MOVE ER-3033          TO EMI-ERROR
  4837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4838
  4839     IF REMTERML NOT = ZEROS
  4840        IF (REMTERMI = ' ') OR
  4841           (REMTERMI > '0' AND < '8')
  4842           CONTINUE
  4843        ELSE
  4844           MOVE -1               TO REMTERML
  4845           MOVE AL-UABON         TO REMTERMA
  4846           MOVE ER-2298          TO EMI-ERROR
  4847           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4848        END-IF
  4849     END-IF
  4850
  4851     IF LFREDL NOT = ZEROS
  4852        IF LFREDI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4853                 OR '6' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  94
* EL106.cbl
  4854           CONTINUE
  4855        ELSE
  4856           MOVE -1               TO LFREDL
  4857           MOVE AL-UABON         TO LFREDA
  4858           MOVE ER-0582          TO EMI-ERROR
  4859           PERFORM 9900-ERROR-FORMAT
  4860                                 THRU 9900-EXIT
  4861        END-IF
  4862     END-IF
  4863
  4864     IF LFLEVL NOT = ZEROS
  4865        IF LFLEVI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4866                 OR '6' OR '8' OR '9'
  4867           CONTINUE
  4868        ELSE
  4869           MOVE -1               TO LFLEVL
  4870           MOVE AL-UABON         TO LFLEVA
  4871           MOVE ER-0582          TO EMI-ERROR
  4872           PERFORM 9900-ERROR-FORMAT
  4873                                 THRU 9900-EXIT
  4874        END-IF
  4875     END-IF
  4876
  4877     IF LFNETL NOT = ZEROS
  4878        IF LFNETI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4879                 OR '6' OR '8' OR '9'
  4880           CONTINUE
  4881        ELSE
  4882           MOVE -1               TO LFNETL
  4883           MOVE AL-UABON         TO LFNETA
  4884           MOVE ER-0582          TO EMI-ERROR
  4885           PERFORM 9900-ERROR-FORMAT
  4886                                 THRU 9900-EXIT
  4887        END-IF
  4888     END-IF
  4889
  4890     IF AHAHL  NOT = ZEROS
  4891        IF AHAHI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4892                 OR '6' OR '8' OR '9'
  4893           CONTINUE
  4894        ELSE
  4895           MOVE -1               TO AHAHL
  4896           MOVE AL-UABON         TO AHAHA
  4897           MOVE ER-0582          TO EMI-ERROR
  4898           PERFORM 9900-ERROR-FORMAT
  4899                                 THRU 9900-EXIT
  4900        END-IF
  4901     END-IF
  4902
  4903     IF AHCPL  NOT = ZEROS
  4904        IF AHCPI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4905                 OR '6' OR '8' OR '9'
  4906           CONTINUE
  4907        ELSE
  4908           MOVE -1               TO AHCPL
  4909           MOVE AL-UABON         TO AHCPA
  4910           MOVE ER-0582          TO EMI-ERROR
  4911           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  95
* EL106.cbl
  4912                                 THRU 9900-EXIT
  4913        END-IF
  4914     END-IF
  4915
  4916     IF STUEL NOT = ZEROS
  4917        IF STUEI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4918           NEXT SENTENCE
  4919          ELSE
  4920           MOVE -1               TO STUEL
  4921           MOVE AL-UABON         TO STUEA
  4922           MOVE ER-3034          TO EMI-ERROR
  4923           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4924
  4925     IF STCNTLL NOT = ZEROS
  4926        IF STCNTLI = SPACES
  4927           NEXT SENTENCE
  4928        ELSE
  4929           IF STCNTLI = '1' OR '2' OR '3' OR '4' OR
  4930                        '5' OR '6' OR '7' OR '8' OR
  4931                        '9' OR 'A' OR 'B' OR 'X'
  4932              NEXT SENTENCE
  4933           ELSE
  4934              MOVE -1               TO STCNTLL
  4935              MOVE AL-UABON         TO STCNTLA
  4936              MOVE ER-3035          TO EMI-ERROR
  4937              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4938
  4939     IF  REPLAWL GREATER THAN ZEROS
  4940         IF  REPLAWI = 'Y'
  4941             MOVE REPLAWI        TO REPLAWO
  4942             MOVE AL-UANON       TO REPLAWA
  4943         ELSE
  4944             IF  REPLAWI = 'N' OR SPACES OR LOW-VALUES
  4945                 MOVE 'N'        TO REPLAWO
  4946                 MOVE AL-UANON   TO REPLAWA
  4947             ELSE
  4948                 MOVE ER-9074    TO EMI-ERROR
  4949                 MOVE -1         TO REPLAWL
  4950                 MOVE AL-UABON   TO REPLAWA
  4951                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4952
  4953     IF  REPLETRL GREATER THAN +0
  4954         IF  REPLAWI = 'Y'
  4955             IF  REPLETRI GREATER THAN SPACES
  4956                 MOVE SPACES     TO W-WORKING-TEXT-KEY
  4957                 MOVE PI-COMPANY-CD
  4958                                 TO W-TEXT-COMPANY-CD
  4959                 MOVE REPLETRI   TO W-TEXT-FORM-NO
  4960                 MOVE +1         TO W-TEXT-LINE-SEQ
  4961
  4962* EXEC CICS HANDLE CONDITION
  4963*                    NOTFND   (6010-LETR-NOT-FOUND)
  4964*                    ENDFILE  (6010-LETR-NOT-FOUND)
  4965*                    NOTOPEN  (8890-LETR-NOT-OPEN)
  4966*                END-EXEC
  4967*    MOVE '"$I''J                 ! '' #00004552' TO DFHEIV0
  4968     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  96
* EL106.cbl
  4970     MOVE X'2720233030303034353532' TO DFHEIV0(25:11)
  4971     CALL 'kxdfhei1' USING DFHEIV0
  4972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4973
  4974* EXEC CICS READ
  4975*                    SET     (ADDRESS OF TEXT-FILES)
  4976*                    DATASET (ELLETR-ID)
  4977*                    RIDFLD  (W-WORKING-TEXT-KEY)
  4978*                END-EXEC
  4979*    MOVE '&"S        E          (   #00004557' TO DFHEIV0
  4980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4982     MOVE X'2020233030303034353537' TO DFHEIV0(25:11)
  4983     CALL 'kxdfhei1' USING DFHEIV0,
  4984           ELLETR-ID,
  4985           DFHEIV20,
  4986           DFHEIV99,
  4987           W-WORKING-TEXT-KEY,
  4988           DFHEIV99,
  4989           DFHEIV99,
  4990           DFHEIV99
  4991     SET ADDRESS OF TEXT-FILES TO
  4992         DFHEIV20
  4993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4994                 MOVE AL-UANON   TO REPLETRA
  4995             ELSE
  4996                 MOVE ER-9448    TO EMI-ERROR
  4997                 MOVE -1         TO REPLETRL
  4998                 MOVE AL-UABON   TO REPLETRA
  4999                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5000         ELSE
  5001             IF  REPLETRI EQUAL SPACES OR LOW-VALUES
  5002                 MOVE LOW-VALUES TO REPLETRO
  5003                 MOVE AL-UANON   TO REPLETRA
  5004             ELSE
  5005                 MOVE ER-9478    TO EMI-ERROR
  5006                 MOVE -1         TO REPLAWL
  5007                 MOVE AL-UABON   TO REPLAWA
  5008                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5009     ELSE
  5010         IF  REPLAWI = 'Y'
  5011             MOVE ER-9448        TO EMI-ERROR
  5012             MOVE -1             TO REPLETRL
  5013             MOVE AL-UABON       TO REPLETRA
  5014             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5015
  5016     IF LIMITL GREATER ZEROS
  5017         IF LIMITI = 'A'
  5018             MOVE LIMITI         TO LIMITO
  5019             MOVE AL-UANON       TO LIMITA
  5020          ELSE
  5021             IF LIMITI = SPACES OR LOW-VALUES
  5022                 MOVE ' '        TO LIMITO
  5023                 MOVE AL-UANON   TO LIMITA
  5024         ELSE
  5025             MOVE ER-2137    TO EMI-ERROR
  5026             MOVE -1         TO LIMITL
  5027             MOVE AL-UABON   TO LIMITA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  97
* EL106.cbl
  5028             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5029
  5030*    IF STATIL GREATER ZEROS
  5031*        IF STATII = 'I' OR 'R'
  5032*            MOVE STATII         TO STATIO
  5033*            MOVE AL-UANON       TO STATIA
  5034*         ELSE
  5035*            IF STATII = SPACES OR LOW-VALUES
  5036*                MOVE ' '        TO STATIO
  5037*                MOVE AL-UANON   TO STATIA
  5038*        ELSE
  5039*            MOVE ER-7346    TO EMI-ERROR
  5040*            MOVE -1         TO STATIL
  5041*            MOVE AL-UABON   TO STATIA
  5042*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5043
  5044     IF COMSLL GREATER ZEROS
  5045
  5046* EXEC CICS BIF
  5047*            DEEDIT
  5048*            FIELD (COMSLI)
  5049*            LENGTH(6)
  5050*       END-EXEC
  5051     MOVE 6
  5052       TO DFHEIV11
  5053*    MOVE '@"L                   #   #00004613' TO DFHEIV0
  5054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5056     MOVE X'2020233030303034363133' TO DFHEIV0(25:11)
  5057     CALL 'kxdfhei1' USING DFHEIV0,
  5058           COMSLI,
  5059           DFHEIV11
  5060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5061      IF COMSLI NUMERIC
  5062            MOVE AL-UNNON        TO COMSLA
  5063            MOVE COMSLI          TO WS-COMSL
  5064                                    COMSLO
  5065        ELSE
  5066            MOVE ER-1614         TO EMI-ERROR
  5067            MOVE -1              TO COMSLL
  5068            MOVE AL-UNBON        TO COMSLA
  5069            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5070
  5071     IF COMJLL GREATER ZEROS
  5072
  5073* EXEC CICS BIF
  5074*            DEEDIT
  5075*            FIELD (COMJLI)
  5076*            LENGTH(6)
  5077*       END-EXEC
  5078     MOVE 6
  5079       TO DFHEIV11
  5080*    MOVE '@"L                   #   #00004629' TO DFHEIV0
  5081     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5082     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5083     MOVE X'2020233030303034363239' TO DFHEIV0(25:11)
  5084     CALL 'kxdfhei1' USING DFHEIV0,
  5085           COMJLI,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  98
* EL106.cbl
  5086           DFHEIV11
  5087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5088      IF COMJLI NUMERIC
  5089            MOVE AL-UNNON        TO COMJLA
  5090            MOVE COMJLI          TO WS-COMJL
  5091                                    COMJLO
  5092        ELSE
  5093            MOVE ER-1614         TO EMI-ERROR
  5094            MOVE -1              TO COMJLL
  5095            MOVE AL-UNBON        TO COMJLA
  5096            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5097
  5098     IF COMSAL GREATER ZEROS
  5099
  5100* EXEC CICS BIF
  5101*            DEEDIT
  5102*            FIELD (COMSAI)
  5103*            LENGTH(6)
  5104*       END-EXEC
  5105     MOVE 6
  5106       TO DFHEIV11
  5107*    MOVE '@"L                   #   #00004645' TO DFHEIV0
  5108     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5109     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5110     MOVE X'2020233030303034363435' TO DFHEIV0(25:11)
  5111     CALL 'kxdfhei1' USING DFHEIV0,
  5112           COMSAI,
  5113           DFHEIV11
  5114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5115      IF COMSAI NUMERIC
  5116            MOVE AL-UNNON        TO COMSAA
  5117            MOVE COMSAI          TO WS-COMSA
  5118                                    COMSAO
  5119        ELSE
  5120            MOVE ER-1614         TO EMI-ERROR
  5121            MOVE -1              TO COMSAL
  5122            MOVE AL-UNBON        TO COMSAA
  5123            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5124
  5125     IF COMJAL GREATER ZEROS
  5126
  5127* EXEC CICS BIF
  5128*            DEEDIT
  5129*            FIELD (COMJAI)
  5130*            LENGTH(6)
  5131*       END-EXEC
  5132     MOVE 6
  5133       TO DFHEIV11
  5134*    MOVE '@"L                   #   #00004661' TO DFHEIV0
  5135     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5137     MOVE X'2020233030303034363631' TO DFHEIV0(25:11)
  5138     CALL 'kxdfhei1' USING DFHEIV0,
  5139           COMJAI,
  5140           DFHEIV11
  5141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5142      IF COMJAI NUMERIC
  5143            MOVE AL-UNNON        TO COMJAA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  99
* EL106.cbl
  5144            MOVE COMJAI          TO WS-COMJA
  5145                                    COMJAO
  5146        ELSE
  5147            MOVE ER-1614         TO EMI-ERROR
  5148            MOVE -1              TO COMJAL
  5149            MOVE AL-UNBON        TO COMJAA
  5150            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5151
  5152     IF RESTAXL GREATER ZEROS
  5153
  5154* EXEC CICS BIF
  5155*            DEEDIT
  5156*            FIELD (RESTAXI)
  5157*            LENGTH(6)
  5158*       END-EXEC
  5159     MOVE 6
  5160       TO DFHEIV11
  5161*    MOVE '@"L                   #   #00004677' TO DFHEIV0
  5162     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5164     MOVE X'2020233030303034363737' TO DFHEIV0(25:11)
  5165     CALL 'kxdfhei1' USING DFHEIV0,
  5166           RESTAXI,
  5167           DFHEIV11
  5168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5169      IF RESTAXI NUMERIC
  5170            MOVE AL-UNNON        TO RESTAXA
  5171            MOVE RESTAXI         TO WS-RESIDENT-TAX
  5172                                    RESTAXO
  5173        ELSE
  5174            MOVE ER-1614         TO EMI-ERROR
  5175            MOVE -1              TO RESTAXL
  5176            MOVE AL-UNBON        TO RESTAXA
  5177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5178
  5179     IF FREELKI  NUMERIC
  5180            MOVE AL-UNNON        TO FREELKA
  5181            MOVE FREELKI         TO WS-FREE-LOOK-DAYS
  5182                                    FREELKO
  5183        ELSE
  5184            MOVE -1               TO FREELKL
  5185            MOVE AL-UNBON         TO FREELKA
  5186            MOVE ER-8159          TO EMI-ERROR
  5187            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5188
  5189*    IF STATRL GREATER ZEROS
  5190*       EXEC CICS BIF
  5191*            DEEDIT
  5192*            FIELD (STATRI)
  5193*            LENGTH(6)
  5194*       END-EXEC
  5195*     IF STATRI NUMERIC
  5196*           MOVE AL-UNNON        TO STATRA
  5197*           MOVE STATRI          TO WS-IRATE
  5198*                                   STATRO
  5199*       ELSE
  5200*           MOVE ER-1614         TO EMI-ERROR
  5201*           MOVE -1              TO STATRL
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 100
* EL106.cbl
  5202*           MOVE AL-UNBON        TO STATRA
  5203*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5204
  5205*    IF STATR1L GREATER ZEROS
  5206*       EXEC CICS BIF
  5207*            DEEDIT
  5208*            FIELD (STATR1I)
  5209*            LENGTH(6)
  5210*       END-EXEC
  5211*     IF STATR1I NUMERIC
  5212*           MOVE AL-UNNON        TO STATR1A
  5213*           MOVE STATR1I         TO WS-IRATE1
  5214*                                   STATR1O
  5215*       ELSE
  5216*           MOVE ER-1614         TO EMI-ERROR
  5217*           MOVE -1              TO STATR1L
  5218*           MOVE AL-UNBON        TO STATR1A
  5219*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5220*
  5221*    IF STATR2L GREATER ZEROS
  5222*       EXEC CICS BIF
  5223*            DEEDIT
  5224*            FIELD (STATR2I)
  5225*            LENGTH(6)
  5226*       END-EXEC
  5227*     IF STATR2I NUMERIC
  5228*           MOVE AL-UNNON        TO STATR2A
  5229*           MOVE STATR2I         TO WS-IRATE2
  5230*                                   STATR2O
  5231*       ELSE
  5232*           MOVE ER-1614         TO EMI-ERROR
  5233*           MOVE -1              TO STATR2L
  5234*           MOVE AL-UNBON        TO STATR2A
  5235*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5236*
  5237*    IF STATR3L GREATER ZEROS
  5238*       EXEC CICS BIF
  5239*            DEEDIT
  5240*            FIELD (STATR3I)
  5241*            LENGTH(6)
  5242*       END-EXEC
  5243*     IF STATR3I NUMERIC
  5244*           MOVE AL-UNNON        TO STATR3A
  5245*           MOVE STATR3I         TO WS-IRATE3
  5246*                                   STATR3O
  5247*       ELSE
  5248*           MOVE ER-1614         TO EMI-ERROR
  5249*           MOVE -1              TO STATR3L
  5250*           MOVE AL-UNBON        TO STATR3A
  5251*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5252
  5253     GO TO 6020-CONTINUE.
  5254
  5255 6010-LETR-NOT-FOUND.
  5256     MOVE ER-9447                TO EMI-ERROR.
  5257     MOVE -1                     TO REPLETRL.
  5258     MOVE AL-UABON               TO REPLETRA.
  5259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 101
* EL106.cbl
  5260
  5261 6020-CONTINUE.
  5262
  5263     IF  TARRATL NOT = ZEROS
  5264
  5265* EXEC CICS BIF
  5266*             DEEDIT
  5267*             FIELD (TARRATI)
  5268*             LENGTH (6)
  5269*        END-EXEC
  5270     MOVE 6
  5271       TO DFHEIV11
  5272*    MOVE '@"L                   #   #00004777' TO DFHEIV0
  5273     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5274     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5275     MOVE X'2020233030303034373737' TO DFHEIV0(25:11)
  5276     CALL 'kxdfhei1' USING DFHEIV0,
  5277           TARRATI,
  5278           DFHEIV11
  5279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5280
  5281         IF  TARRATI NUMERIC
  5282             MOVE AL-UNNON       TO TARRATA
  5283             MOVE TARRATI        TO WS-ST-TARGET-LOSS-RATIO
  5284                                    TARRATO
  5285         ELSE
  5286             MOVE ER-7717        TO EMI-ERROR
  5287             MOVE -1             TO TARRATL
  5288             MOVE AL-UNBON       TO TARRATA
  5289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5290
  5291     IF  CALCINTL NOT = ZEROS
  5292
  5293* EXEC CICS BIF
  5294*             DEEDIT
  5295*             FIELD (CALCINTI)
  5296*             LENGTH (6)
  5297*        END-EXEC
  5298     MOVE 6
  5299       TO DFHEIV11
  5300*    MOVE '@"L                   #   #00004794' TO DFHEIV0
  5301     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5302     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5303     MOVE X'2020233030303034373934' TO DFHEIV0(25:11)
  5304     CALL 'kxdfhei1' USING DFHEIV0,
  5305           CALCINTI,
  5306           DFHEIV11
  5307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5308
  5309         IF  CALCINTI NUMERIC
  5310             MOVE AL-UNNON       TO CALCINTA
  5311             MOVE CALCINTI       TO WS-ST-CALC-INTEREST
  5312                                    CALCINTO
  5313         ELSE
  5314             MOVE ER-7735        TO EMI-ERROR
  5315             MOVE -1             TO CALCINTL
  5316             MOVE AL-UNBON       TO CALCINTA
  5317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 102
* EL106.cbl
  5318
  5319     IF PRMPCTL NOT = ZEROS
  5320
  5321* EXEC CICS BIF
  5322*            DEEDIT
  5323*            FIELD (PRMPCTI)
  5324*            LENGTH(5)
  5325*       END-EXEC
  5326     MOVE 5
  5327       TO DFHEIV11
  5328*    MOVE '@"L                   #   #00004811' TO DFHEIV0
  5329     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5331     MOVE X'2020233030303034383131' TO DFHEIV0(25:11)
  5332     CALL 'kxdfhei1' USING DFHEIV0,
  5333           PRMPCTI,
  5334           DFHEIV11
  5335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5336      IF PRMPCTI NUMERIC
  5337            MOVE AL-UNNON        TO PRMPCTA
  5338            MOVE PRMPCTI         TO WS-ST-TOL-PREM-PCT
  5339        ELSE
  5340            MOVE ER-7532         TO EMI-ERROR
  5341            MOVE -1              TO PRMPCTL
  5342            MOVE AL-UNBON        TO PRMPCTA
  5343            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5344
  5345     IF OVSPCTL NOT = ZEROS
  5346
  5347* EXEC CICS BIF
  5348*            DEEDIT
  5349*            FIELD (OVSPCTI)
  5350*            LENGTH(5)
  5351*       END-EXEC
  5352     MOVE 5
  5353       TO DFHEIV11
  5354*    MOVE '@"L                   #   #00004826' TO DFHEIV0
  5355     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5356     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5357     MOVE X'2020233030303034383236' TO DFHEIV0(25:11)
  5358     CALL 'kxdfhei1' USING DFHEIV0,
  5359           OVSPCTI,
  5360           DFHEIV11
  5361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5362      IF OVSPCTI NUMERIC
  5363            MOVE AL-UNNON        TO OVSPCTA
  5364            MOVE OVSPCTI         TO WS-ST-OVR-SHT-PCT
  5365        ELSE
  5366            MOVE ER-7532         TO EMI-ERROR
  5367            MOVE -1              TO OVSPCTL
  5368            MOVE AL-UNBON        TO OVSPCTA
  5369            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5370
  5371     IF REFPCTL NOT = ZEROS
  5372
  5373* EXEC CICS BIF
  5374*            DEEDIT
  5375*            FIELD (REFPCTI)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 103
* EL106.cbl
  5376*            LENGTH(5)
  5377*       END-EXEC
  5378     MOVE 5
  5379       TO DFHEIV11
  5380*    MOVE '@"L                   #   #00004841' TO DFHEIV0
  5381     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5382     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5383     MOVE X'2020233030303034383431' TO DFHEIV0(25:11)
  5384     CALL 'kxdfhei1' USING DFHEIV0,
  5385           REFPCTI,
  5386           DFHEIV11
  5387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5388      IF REFPCTI NUMERIC
  5389            MOVE AL-UNNON        TO REFPCTA
  5390            MOVE REFPCTI         TO WS-ST-TOL-REF-PCT
  5391        ELSE
  5392            MOVE ER-7532         TO EMI-ERROR
  5393            MOVE -1              TO REFPCTL
  5394            MOVE AL-UNBON        TO REFPCTA
  5395            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5396
  5397     IF LFTAXL NOT = ZEROS
  5398
  5399* EXEC CICS BIF
  5400*            DEEDIT
  5401*            FIELD (LFTAXI)
  5402*            LENGTH(5)
  5403*       END-EXEC
  5404     MOVE 5
  5405       TO DFHEIV11
  5406*    MOVE '@"L                   #   #00004856' TO DFHEIV0
  5407     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5408     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5409     MOVE X'2020233030303034383536' TO DFHEIV0(25:11)
  5410     CALL 'kxdfhei1' USING DFHEIV0,
  5411           LFTAXI,
  5412           DFHEIV11
  5413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5414        IF LFTAXI NUMERIC
  5415           MOVE AL-UNNON         TO LFTAXA
  5416           MOVE LFTAXI           TO WS-ST-LF-PREM-TAX
  5417        ELSE
  5418           MOVE ER-2082          TO EMI-ERROR
  5419           MOVE -1               TO LFTAXL
  5420           MOVE AL-UNBON         TO LFTAXA
  5421           PERFORM 9900-ERROR-FORMAT
  5422                                 THRU 9900-EXIT
  5423        END-IF
  5424     END-IF
  5425
  5426     IF AHITAXL NOT = ZEROS
  5427
  5428* EXEC CICS BIF
  5429*            DEEDIT
  5430*            FIELD (AHITAXI)
  5431*            LENGTH(5)
  5432*       END-EXEC
  5433     MOVE 5
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 104
* EL106.cbl
  5434       TO DFHEIV11
  5435*    MOVE '@"L                   #   #00004874' TO DFHEIV0
  5436     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5437     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5438     MOVE X'2020233030303034383734' TO DFHEIV0(25:11)
  5439     CALL 'kxdfhei1' USING DFHEIV0,
  5440           AHITAXI,
  5441           DFHEIV11
  5442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5443        IF AHITAXI NUMERIC
  5444           MOVE AL-UNNON         TO AHITAXA
  5445           MOVE AHITAXI          TO WS-ST-AH-PREM-TAX-I
  5446        ELSE
  5447           MOVE ER-2084          TO EMI-ERROR
  5448           MOVE -1               TO AHITAXL
  5449           MOVE AL-UNBON         TO AHITAXA
  5450           PERFORM 9900-ERROR-FORMAT
  5451                                 THRU 9900-EXIT
  5452        END-IF
  5453     END-IF
  5454
  5455     IF AHGTAXL NOT = ZEROS
  5456
  5457* EXEC CICS BIF
  5458*            DEEDIT
  5459*            FIELD (AHGTAXI)
  5460*            LENGTH(5)
  5461*       END-EXEC
  5462     MOVE 5
  5463       TO DFHEIV11
  5464*    MOVE '@"L                   #   #00004892' TO DFHEIV0
  5465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5467     MOVE X'2020233030303034383932' TO DFHEIV0(25:11)
  5468     CALL 'kxdfhei1' USING DFHEIV0,
  5469           AHGTAXI,
  5470           DFHEIV11
  5471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5472        IF AHGTAXI NUMERIC
  5473           MOVE AL-UNNON         TO AHGTAXA
  5474           MOVE AHGTAXI          TO WS-ST-AH-PREM-TAX-G
  5475        ELSE
  5476           MOVE ER-2084          TO EMI-ERROR
  5477           MOVE -1               TO AHGTAXL
  5478           MOVE AL-UNBON         TO AHGTAXA
  5479           PERFORM 9900-ERROR-FORMAT
  5480                                 THRU 9900-EXIT
  5481        END-IF
  5482     END-IF
  5483
  5484     IF REFCLML NOT = ZEROS
  5485        IF REFCLMI = SPACES OR '1' OR '2' OR '3' OR '4' OR '5'
  5486           NEXT SENTENCE
  5487        ELSE
  5488           MOVE -1               TO REFCLML
  5489           MOVE AL-UABON         TO REFCLMA
  5490           MOVE ER-3036          TO EMI-ERROR
  5491           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 105
* EL106.cbl
  5492        END-IF
  5493     END-IF.
  5494
  5495     IF VFYBENEL NOT = ZEROS
  5496        IF VFYBENEI = SPACES OR 'A' OR 'L' OR 'B'
  5497           NEXT SENTENCE
  5498        ELSE
  5499           MOVE -1               TO VFYBENEL
  5500           MOVE AL-UABON         TO VFYBENEA
  5501           MOVE ER-7581          TO EMI-ERROR
  5502           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5503        END-IF
  5504     END-IF.
  5505
  5506     IF CAUSALL NOT = ZEROS
  5507        IF CAUSALI = SPACES OR 'A' OR 'L' OR 'B'
  5508           NEXT SENTENCE
  5509        ELSE
  5510           MOVE -1               TO CAUSALL
  5511           MOVE AL-UABON         TO CAUSALA
  5512           MOVE ER-7578          TO EMI-ERROR
  5513           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5514        END-IF
  5515     END-IF.
  5516
  5517     .
  5518 6099-EXIT.
  5519     EXIT.
  5520
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 106
* EL106.cbl
  5522 6100-INITIALIZE-BENEFIT-CNTL.
  5523
  5524     MOVE SPACES   TO   CF-ST-BENEFIT-CD         (SUB)
  5525                        CF-ST-BENEFIT-KIND       (SUB)
  5526                        CF-ST-REM-TERM-CALC      (SUB)
  5527                        CF-ST-REFUND-CALC        (SUB)
  5528                        CF-ST-EARNING-CALC       (SUB)
  5529                        CF-ST-OVRD-EARNINGS-CALC (SUB).
  5530
  5531 6199-EXIT.
  5532     EXIT.
  5533
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 107
* EL106.cbl
  5535 6400-CREATE-TEMP-STORAGE.
  5536     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5537
  5538
  5539* EXEC CICS WRITEQ TS
  5540*        QUEUE   (QID)
  5541*        FROM    (EL106AO)
  5542*        LENGTH  (WS-MAP-LENGTH)
  5543*    END-EXEC.
  5544*    MOVE '*"                    ''   #00004963' TO DFHEIV0
  5545     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5547     MOVE X'2020233030303034393633' TO DFHEIV0(25:11)
  5548     CALL 'kxdfhei1' USING DFHEIV0,
  5549           QID,
  5550           EL106AO,
  5551           WS-MAP-LENGTH,
  5552           DFHEIV99,
  5553           DFHEIV99,
  5554           DFHEIV99
  5555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5556
  5557
  5558 6400-EXIT.
  5559      EXIT.
  5560
  5561 6500-RECOVER-TEMP-STORAGE.
  5562
  5563* EXEC CICS READQ TS
  5564*        QUEUE   (QID)
  5565*        INTO    (EL106AO)
  5566*        LENGTH  (WS-MAP-LENGTH)
  5567*    END-EXEC.
  5568*    MOVE '*$I    L              ''   #00004973' TO DFHEIV0
  5569     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5571     MOVE X'2020233030303034393733' TO DFHEIV0(25:11)
  5572     CALL 'kxdfhei1' USING DFHEIV0,
  5573           QID,
  5574           EL106AO,
  5575           WS-MAP-LENGTH,
  5576           DFHEIV99,
  5577           DFHEIV99,
  5578           DFHEIV99
  5579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5580
  5581
  5582     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5583
  5584 6500-EXIT.
  5585      EXIT.
  5586
  5587 6600-DELETE-TEMP-STORAGE.
  5588
  5589* EXEC CICS HANDLE CONDITION
  5590*        QIDERR  (6600-EXIT)
  5591*    END-EXEC.
  5592*    MOVE '"$N                   ! ( #00004985' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 108
* EL106.cbl
  5593     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5595     MOVE X'2820233030303034393835' TO DFHEIV0(25:11)
  5596     CALL 'kxdfhei1' USING DFHEIV0
  5597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5598
  5599
  5600
  5601* EXEC CICS DELETEQ TS
  5602*        QUEUE  (QID)
  5603*    END-EXEC.
  5604*    MOVE '*&                    #   #00004989' TO DFHEIV0
  5605     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5606     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5607     MOVE X'2020233030303034393839' TO DFHEIV0(25:11)
  5608     CALL 'kxdfhei1' USING DFHEIV0,
  5609           QID,
  5610           DFHEIV99
  5611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5612
  5613
  5614 6600-EXIT.
  5615      EXIT.
  5616
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 109
* EL106.cbl
  5618***************************************************************
  5619*                                                             *
  5620*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  5621*                                                             *
  5622***************************************************************
  5623 7000-BUILD-OUTPUT-MAP.
  5624     MOVE LOW-VALUES            TO EL106AO.
  5625     MOVE CF-STATE-CODE         TO STCDO
  5626                                   PI-WS-STATE.
  5627     MOVE CF-ST-TOL-CLAIM       TO QUOTCALO.
  5628     MOVE CF-ST-TOL-PREM        TO PREMTOLO.
  5629     MOVE CF-ST-TOL-REFUND      TO REFTOLO.
  5630     MOVE CF-ST-CLAIM-REJECT-SW TO CLREJECO.
  5631     MOVE CF-ST-PREM-REJECT-SW  TO ISSREJO.
  5632     MOVE CF-ST-REF-REJECT-SW   TO REFREJO.
  5633     MOVE CF-ST-FST-PMT-DAYS-CHG
  5634                                TO EXTCHGO.
  5635     MOVE CF-ST-RT-CALC         TO REMTERMO
  5636     MOVE CF-ST-RF-LR-CALC      TO LFREDO
  5637     MOVE CF-ST-RF-LL-CALC      TO LFLEVO
  5638     MOVE CF-ST-RF-LN-CALC      TO LFNETO
  5639     MOVE CF-ST-RF-AH-CALC      TO AHAHO
  5640     MOVE CF-ST-RF-CP-CALC      TO AHCPO
  5641     MOVE CF-ST-CALL-UNEARNED   TO STUEO.
  5642     MOVE CF-ST-CALL-RPT-CNTL   TO STCNTLO.
  5643     MOVE CF-ST-CALL-RATE-DEV   TO STDEVO.
  5644     MOVE CF-STATE-ABBREVIATION TO STABRO.
  5645     MOVE CF-STATE-NAME         TO STNAMEO.
  5646     MOVE CF-ST-REF-AH-DEATH-IND TO REFCLMO.
  5647     MOVE CF-ST-VFY-2ND-BENE    TO VFYBENEO.
  5648     MOVE CF-ST-CAUSAL-STATE    TO CAUSALO.
  5649     IF  CF-ST-CHECK-COUNTER NUMERIC
  5650        MOVE CF-ST-CHECK-COUNTER TO STCHKNOO
  5651     ELSE
  5652        MOVE ZEROS             TO STCHKNOO
  5653     END-IF.
  5654
  5655     IF CF-ST-LF-EXP-PCT      NUMERIC
  5656         IF CF-ST-LF-EXP-PCT NOT = ZEROS
  5657             MOVE CF-ST-LF-EXP-PCT  TO LFEXPO.
  5658
  5659     IF CF-ST-AH-EXP-PCT      NUMERIC
  5660         IF CF-ST-AH-EXP-PCT NOT = ZEROS
  5661             MOVE CF-ST-AH-EXP-PCT  TO AHEXPO.
  5662
  5663     IF CF-ST-TOL-PREM-PCT    NUMERIC
  5664         IF CF-ST-TOL-PREM-PCT NOT = ZEROS
  5665             MOVE CF-ST-TOL-PREM-PCT TO PRMPCTO.
  5666
  5667     IF CF-ST-OVR-SHT-AMT NUMERIC
  5668        IF CF-ST-OVR-SHT-AMT > ZEROS
  5669           MOVE CF-ST-OVR-SHT-AMT TO OVSAMTO
  5670        END-IF
  5671     END-IF.
  5672
  5673     IF CF-ST-OVR-SHT-PCT NUMERIC
  5674         IF CF-ST-OVR-SHT-PCT > ZEROS
  5675             MOVE CF-ST-OVR-SHT-PCT TO OVSPCTO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 110
* EL106.cbl
  5676         END-IF
  5677     END-IF.
  5678
  5679     IF CF-ST-TOL-REF-PCT     NUMERIC
  5680         IF CF-ST-TOL-REF-PCT NOT = ZEROS
  5681             MOVE CF-ST-TOL-REF-PCT TO REFPCTO.
  5682
  5683     IF CF-ST-REFUND-MIN      NUMERIC
  5684         IF CF-ST-REFUND-MIN NOT = ZEROS
  5685             MOVE CF-ST-REFUND-MIN  TO REFMINO.
  5686
  5687     IF CF-ST-REFUND-DAYS-FIRST NUMERIC
  5688       IF CF-ST-REFUND-DAYS-FIRST NOT = ZEROS
  5689         MOVE CF-ST-REFUND-DAYS-FIRST
  5690                                TO REFDAY1O.
  5691
  5692     IF CF-ST-REFUND-DAYS-SUBSEQ NUMERIC
  5693       IF CF-ST-REFUND-DAYS-SUBSEQ NOT = ZEROS
  5694         MOVE CF-ST-REFUND-DAYS-SUBSEQ
  5695                                TO REFDAYSO.
  5696
  5697     IF CF-ST-SPLIT-PAYMENT IS EQUAL TO ' '
  5698         MOVE 'N'               TO SPLPMTO
  5699     ELSE
  5700         MOVE CF-ST-SPLIT-PAYMENT
  5701                                TO SPLPMTO.
  5702
  5703     IF CF-ST-FST-PMT-DAYS-MAX NUMERIC
  5704       IF CF-ST-FST-PMT-DAYS-MAX NOT = ZEROS
  5705         MOVE CF-ST-FST-PMT-DAYS-MAX
  5706                                TO EXTDAYSO.
  5707
  5708     IF CF-ST-LF-PREM-TAX NUMERIC
  5709        IF CF-ST-LF-PREM-TAX > ZEROS
  5710           MOVE CF-ST-LF-PREM-TAX
  5711                                 TO LFTAXO
  5712        END-IF
  5713     END-IF
  5714
  5715     IF CF-ST-AH-PREM-TAX-I NUMERIC
  5716        IF CF-ST-AH-PREM-TAX-I > ZEROS
  5717           MOVE CF-ST-AH-PREM-TAX-I
  5718                                 TO AHITAXO
  5719        END-IF
  5720     END-IF
  5721
  5722     IF CF-ST-AH-PREM-TAX-G NUMERIC
  5723        IF CF-ST-AH-PREM-TAX-G > ZEROS
  5724           MOVE CF-ST-AH-PREM-TAX-G
  5725                                 TO AHGTAXO
  5726        END-IF
  5727     END-IF
  5728
  5729*    IF PI-COMPANY-ID = 'NCL'
  5730*    IF CF-ST-NO-DAYS-ELAPSED NUMERIC
  5731*      IF CF-ST-NO-DAYS-ELAPSED NOT = ZEROS
  5732*        MOVE CF-ST-NO-DAYS-ELAPSED
  5733*                               TO INTDAYSO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 111
* EL106.cbl
  5734
  5735     IF  CF-REPLACEMENT-LAW-SW NOT EQUAL 'Y'
  5736             AND
  5737         CF-REPLACEMENT-LAW-SW NOT EQUAL 'N'
  5738         MOVE 'N'               TO REPLAWO
  5739         MOVE LOW-VALUES        TO REPLETRO
  5740     ELSE
  5741         MOVE CF-REPLACEMENT-LAW-SW
  5742                                TO REPLAWO
  5743
  5744         IF  CF-REPLACEMENT-LETTER GREATER THAN SPACES
  5745             MOVE CF-REPLACEMENT-LETTER
  5746                                TO REPLETRO
  5747         ELSE
  5748             MOVE LOW-VALUES    TO REPLETRO.
  5749
  5750     IF  CF-ST-TARGET-LOSS-RATIO NUMERIC
  5751         IF  CF-ST-TARGET-LOSS-RATIO NOT = ZEROS
  5752             MOVE CF-ST-TARGET-LOSS-RATIO
  5753                                TO TARRATO
  5754         ELSE
  5755             MOVE ZEROS         TO TARRATO
  5756     ELSE
  5757         MOVE ZEROS             TO TARRATO.
  5758
  5759     IF  CF-ST-CALC-INTEREST NUMERIC
  5760         IF  CF-ST-CALC-INTEREST NOT = ZEROS
  5761             MOVE CF-ST-CALC-INTEREST
  5762                                TO CALCINTO
  5763         ELSE
  5764             MOVE ZEROS         TO CALCINTO
  5765     ELSE
  5766         MOVE ZEROS             TO CALCINTO.
  5767
  5768     IF  CF-ST-COMM-CAP-SL NUMERIC
  5769         IF  CF-ST-COMM-CAP-SL NOT = ZEROS
  5770             MOVE CF-ST-COMM-CAP-SL
  5771                                TO COMSLO
  5772         ELSE
  5773             MOVE ZEROS         TO COMSLO
  5774     ELSE
  5775         MOVE ZEROS             TO COMSLO.
  5776
  5777     IF  CF-ST-COMM-CAP-JL NUMERIC
  5778         IF  CF-ST-COMM-CAP-JL NOT = ZEROS
  5779             MOVE CF-ST-COMM-CAP-JL
  5780                                TO COMJLO
  5781         ELSE
  5782             MOVE ZEROS         TO COMJLO
  5783     ELSE
  5784         MOVE ZEROS             TO COMJLO.
  5785
  5786     IF  CF-ST-COMM-CAP-SA NUMERIC
  5787         IF  CF-ST-COMM-CAP-SA NOT = ZEROS
  5788             MOVE CF-ST-COMM-CAP-SA
  5789                                TO COMSAO
  5790         ELSE
  5791             MOVE ZEROS         TO COMSAO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 112
* EL106.cbl
  5792     ELSE
  5793         MOVE ZEROS             TO COMSAO.
  5794
  5795     IF  CF-ST-COMM-CAP-JA NUMERIC
  5796         IF  CF-ST-COMM-CAP-JA NOT = ZEROS
  5797             MOVE CF-ST-COMM-CAP-JA
  5798                                TO COMJAO
  5799         ELSE
  5800             MOVE ZEROS         TO COMJAO
  5801     ELSE
  5802         MOVE ZEROS             TO COMJAO.
  5803
  5804     IF  CF-ST-RES-TAX-PCT NUMERIC
  5805         IF  CF-ST-RES-TAX-PCT NOT = ZEROS
  5806             MOVE CF-ST-RES-TAX-PCT
  5807                                TO RESTAXO
  5808         ELSE
  5809             MOVE ZEROS         TO RESTAXO
  5810     ELSE
  5811         MOVE ZEROS             TO RESTAXO.
  5812
  5813     IF CF-ST-FREE-LOOK-PERIOD NUMERIC
  5814        IF CF-ST-FREE-LOOK-PERIOD NOT = ZEROS
  5815             MOVE CF-ST-FREE-LOOK-PERIOD
  5816                                TO FREELKO
  5817        ELSE
  5818             MOVE ZEROS         TO FREELKO
  5819     ELSE
  5820         MOVE ZEROS             TO FREELKO.
  5821
  5822*    IF PI-COMPANY-ID = 'NCL'
  5823*    IF  CF-ST-STAT-INTEREST NUMERIC
  5824*        IF  CF-ST-STAT-INTEREST NOT = ZEROS
  5825*            MOVE CF-ST-STAT-INTEREST
  5826*                               TO STATRO
  5827*        ELSE
  5828*            MOVE ZEROS         TO STATRO
  5829*    ELSE
  5830*        MOVE ZEROS             TO STATRO.
  5831
  5832*    IF PI-COMPANY-ID = 'NCL'
  5833*    IF  CF-ST-STAT-INTEREST-1 NUMERIC
  5834*        IF  CF-ST-STAT-INTEREST-1 NOT = ZEROS
  5835*            MOVE CF-ST-STAT-INTEREST-1
  5836*                               TO STATR1O
  5837*        ELSE
  5838*            MOVE ZEROS         TO STATR1O
  5839*    ELSE
  5840*        MOVE ZEROS             TO STATR1O.
  5841
  5842*    IF PI-COMPANY-ID = 'NCL'
  5843*    IF  CF-ST-STAT-INTEREST-2 NUMERIC
  5844*        IF  CF-ST-STAT-INTEREST-2 NOT = ZEROS
  5845*            MOVE CF-ST-STAT-INTEREST-2
  5846*                               TO STATR2O
  5847*        ELSE
  5848*            MOVE ZEROS         TO STATR2O
  5849*    ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 113
* EL106.cbl
  5850*        MOVE ZEROS             TO STATR2O.
  5851
  5852*    IF PI-COMPANY-ID = 'NCL'
  5853*    IF  CF-ST-STAT-INTEREST-3 NUMERIC
  5854*        IF  CF-ST-STAT-INTEREST-3 NOT = ZEROS
  5855*            MOVE CF-ST-STAT-INTEREST-3
  5856*                               TO STATR3O
  5857*        ELSE
  5858*            MOVE ZEROS         TO STATR3O
  5859*    ELSE
  5860*        MOVE ZEROS             TO STATR3O.
  5861
  5862     MOVE CF-COMM-CAP-LIMIT-TO  TO LIMITO.
  5863*    MOVE CF-ST-STAT-DATE-FROM  TO STATIO.
  5864
  5865     MOVE CF-LAST-MAINT-BY      TO LSTUSRO.
  5866     MOVE ' '                   TO DC-OPTION-CODE.
  5867     MOVE CF-LAST-MAINT-DT      TO DC-BIN-DATE-1.
  5868     MOVE LINK-ELDATCV          TO PGM-NAME.
  5869
  5870* EXEC CICS LINK
  5871*        PROGRAM (PGM-NAME)
  5872*        COMMAREA(DATE-CONVERSION-DATA)
  5873*        LENGTH  (DC-COMM-LENGTH)
  5874*    END-EXEC.
  5875*    MOVE '."C                   (   #00005248' TO DFHEIV0
  5876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5878     MOVE X'2020233030303035323438' TO DFHEIV0(25:11)
  5879     CALL 'kxdfhei1' USING DFHEIV0,
  5880           PGM-NAME,
  5881           DATE-CONVERSION-DATA,
  5882           DC-COMM-LENGTH,
  5883           DFHEIV99,
  5884           DFHEIV99,
  5885           DFHEIV99,
  5886           DFHEIV99
  5887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5888
  5889
  5890     IF DATE-CONVERSION-ERROR
  5891         MOVE ZEROS              TO LSTDTEO
  5892     ELSE
  5893         MOVE DC-GREG-DATE-1-EDIT
  5894                                 TO LSTDTEO.
  5895
  5896     MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
  5897     MOVE TIME-OUT               TO LSTTIMEO.
  5898     MOVE -1                     TO MAINTL.
  5899     MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
  5900     MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  5901     MOVE CF-STATE-CODE          TO PI-PREV-STATE.
  5902     MOVE AL-UANOF               TO MAINTA.
  5903     MOVE AL-UANON               TO STCDA
  5904                                  STNAMEA
  5905                                  STABRA
  5906                                  CLREJECA ISSREJA REFREJA
  5907                                  EXTCHGA STUEA STCNTLA STDEVA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 114
* EL106.cbl
  5908                                  REMTERMA
  5909                                  LFREDA LFLEVA LFNETA
  5910                                  AHAHA  AHCPA
  5911                                  REPLAWA REPLETRA SPLPMTA
  5912                                  LIMITA.
  5913*    IF PI-COMPANY-ID = 'NCL'
  5914*        MOVE AL-UANON           TO STATIA.
  5915
  5916     MOVE AL-UNNON               TO LFEXPA AHEXPA
  5917                                  QUOTCALA PREMTOLA REFTOLA
  5918                                  OVSAMTA  OVSPCTA
  5919                                  LFTAXA   AHITAXA  AHGTAXA
  5920                                  PRMPCTA  REFPCTA
  5921                                  REFDAY1A REFDAYSA
  5922                                  REFMINA EXTDAYSA
  5923                                  TARRATA
  5924                                  CALCINTA
  5925                                  RESTAXA FREELKA
  5926                                  COMSLA COMJLA COMSAA COMJAA.
  5927
  5928*    IF PI-COMPANY-ID = 'NCL'
  5929*        MOVE AL-UNNON           TO STATRA STATR1A STATR2A
  5930*                                                  STATR3A
  5931*                                                  INTDAYSA.
  5932
  5933     IF RETURN-DISPLAY
  5934         GO TO 8100-SEND-INITIAL-MAP
  5935     ELSE
  5936         GO TO 8200-SEND-DATAONLY.
  5937
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 115
* EL106.cbl
  5939 8100-SEND-INITIAL-MAP.
  5940     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  5941       AND PI-WS-STATE = 'AK'
  5942        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5943     ELSE
  5944        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5945     END-IF.
  5946     MOVE SAVE-DATE              TO RUNDTEO.
  5947     MOVE EIBTIME                TO TIME-IN.
  5948     MOVE TIME-OUT               TO RUNTIMEO.
  5949     MOVE -1                     TO MAINTL.
  5950     MOVE PI-LIFE-OVERRIDE-L6    TO LEXPLBLO.
  5951     MOVE PI-AH-OVERRIDE-L6      TO AEXPLBLO.
  5952     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5953     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5954
  5955*    IF PI-COMPANY-ID = 'NCL'
  5956*       MOVE AL-SANON            TO STATZA
  5957*                                   INTDAYZA
  5958*                                   STATRZA
  5959*                                   RNG1A
  5960*                                   RNG2A
  5961*                                   RNG3A
  5962*       MOVE AL-UANON            TO STATIA
  5963*                                   STATRA
  5964*                                   STATR1A
  5965*                                   STATR2A
  5966*                                   STATR3A
  5967*       MOVE AL-UNNON            TO INTDAYSA.
  5968
  5969
  5970* EXEC CICS SEND
  5971*        MAP   (MAP-NAME)
  5972*        MAPSET(MAPSET-NAME)
  5973*        FROM  (EL106AO)
  5974*        ERASE
  5975*        CURSOR
  5976*    END-EXEC.
  5977     MOVE LENGTH OF
  5978      EL106AO
  5979       TO DFHEIV12
  5980     MOVE -1
  5981       TO DFHEIV11
  5982*    MOVE '8$     CT  E    H L F ,   #00005333' TO DFHEIV0
  5983     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5984     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5985     MOVE X'2020233030303035333333' TO DFHEIV0(25:11)
  5986     CALL 'kxdfhei1' USING DFHEIV0,
  5987           MAP-NAME,
  5988           EL106AO,
  5989           DFHEIV12,
  5990           MAPSET-NAME,
  5991           DFHEIV99,
  5992           DFHEIV99,
  5993           DFHEIV99,
  5994           DFHEIV11,
  5995           DFHEIV99,
  5996           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 116
* EL106.cbl
  5997           DFHEIV99
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5999
  6000
  6001     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 117
* EL106.cbl
  6003 8200-SEND-DATAONLY.
  6004
  6005     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  6006       AND PI-WS-STATE = 'AK'
  6007        MOVE AL-SANON TO STCHKHDA STCHKNOA
  6008     ELSE
  6009        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  6010     END-IF.
  6011
  6012     MOVE SAVE-DATE      TO RUNDTEO.
  6013     MOVE EIBTIME        TO TIME-IN.
  6014     MOVE TIME-OUT       TO RUNTIMEO.
  6015
  6016     IF QUOTCALL NOT = ZEROS
  6017        IF QUOTCALI NUMERIC
  6018           MOVE QUOTCALI TO QUOTCALO.
  6019
  6020     IF PREMTOLL NOT = ZEROS
  6021        IF PREMTOLI NUMERIC
  6022           MOVE PREMTOLI TO PREMTOLO.
  6023
  6024     IF OVSAMTL NOT = ZEROS
  6025        IF OVSAMTI NUMERIC
  6026           MOVE OVSAMTI TO OVSAMTO.
  6027
  6028     IF REFTOLL NOT = ZEROS
  6029        IF REFTOLI NUMERIC
  6030           MOVE REFTOLI TO REFTOLO.
  6031
  6032     IF PRMPCTL NOT = ZEROS
  6033        IF PRMPCTI NUMERIC
  6034           MOVE PRMPCTI TO PRMPCTO.
  6035
  6036     IF OVSPCTL NOT = ZEROS
  6037        IF OVSPCTI NUMERIC
  6038           MOVE OVSPCTI TO OVSPCTO.
  6039
  6040     IF LFTAXL NOT = ZEROS
  6041        IF LFTAXI NUMERIC
  6042           MOVE LFTAXI           TO LFTAXO
  6043        END-IF
  6044     END-IF
  6045
  6046     IF AHITAXL NOT = ZEROS
  6047        IF AHITAXI NUMERIC
  6048           MOVE AHITAXI          TO AHITAXO
  6049        END-IF
  6050     END-IF
  6051
  6052     IF AHGTAXL NOT = ZEROS
  6053        IF AHGTAXI NUMERIC
  6054           MOVE AHGTAXI          TO AHGTAXO
  6055        END-IF
  6056     END-IF
  6057
  6058     IF REFPCTL NOT = ZEROS
  6059        IF REFPCTI NUMERIC
  6060           MOVE REFPCTI TO REFPCTO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 118
* EL106.cbl
  6061
  6062     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  6063     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  6064
  6065
  6066* EXEC CICS SEND
  6067*        MAP   (MAP-NAME)
  6068*        MAPSET(MAPSET-NAME)
  6069*        FROM  (EL106AO)
  6070*        DATAONLY
  6071*        ERASEAUP
  6072*        CURSOR
  6073*    END-EXEC.
  6074     MOVE LENGTH OF
  6075      EL106AO
  6076       TO DFHEIV12
  6077     MOVE -1
  6078       TO DFHEIV11
  6079*    MOVE '8$D    CT  A    H L F ,   #00005405' TO DFHEIV0
  6080     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  6081     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6082     MOVE X'2020233030303035343035' TO DFHEIV0(25:11)
  6083     CALL 'kxdfhei1' USING DFHEIV0,
  6084           MAP-NAME,
  6085           EL106AO,
  6086           DFHEIV12,
  6087           MAPSET-NAME,
  6088           DFHEIV99,
  6089           DFHEIV99,
  6090           DFHEIV99,
  6091           DFHEIV11,
  6092           DFHEIV99,
  6093           DFHEIV99,
  6094           DFHEIV99
  6095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6096
  6097
  6098     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 119
* EL106.cbl
  6100 8300-SEND-TEXT.
  6101
  6102* EXEC CICS SEND TEXT
  6103*        FROM  (LOGOFF-TEXT)
  6104*        LENGTH(LOGOFF-LENGTH)
  6105*        ERASE
  6106*        FREEKB
  6107*    END-EXEC.
  6108*    MOVE '8&      T  E F  H   F -   #00005417' TO DFHEIV0
  6109     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6110     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6111     MOVE X'2020233030303035343137' TO DFHEIV0(25:11)
  6112     CALL 'kxdfhei1' USING DFHEIV0,
  6113           LOGOFF-TEXT,
  6114           LOGOFF-LENGTH,
  6115           DFHEIV99,
  6116           DFHEIV99,
  6117           DFHEIV99,
  6118           DFHEIV99,
  6119           DFHEIV99,
  6120           DFHEIV99,
  6121           DFHEIV99,
  6122           DFHEIV99,
  6123           DFHEIV99,
  6124           DFHEIV99
  6125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6126
  6127
  6128
  6129* EXEC CICS RETURN
  6130*    END-EXEC.
  6131*    MOVE '.(                    ''   #00005424' TO DFHEIV0
  6132     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6133     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6134     MOVE X'2020233030303035343234' TO DFHEIV0(25:11)
  6135     CALL 'kxdfhei1' USING DFHEIV0,
  6136           DFHEIV99,
  6137           DFHEIV99,
  6138           DFHEIV99,
  6139           DFHEIV99,
  6140           DFHEIV99,
  6141           DFHEIV99
  6142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6143
  6144
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 120
* EL106.cbl
  6146 8400-LOG-JOURNAL-RECORD.
  6147     IF PI-JOURNAL-FILE-ID = 0
  6148         GO TO 8400-EXIT.
  6149
  6150     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6151     MOVE ELCNTL-ID              TO JP-FILE-ID.
  6152     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6153*    EXEC CICS JOURNAL
  6154*         JFILEID(PI-JOURNAL-FILE-ID)
  6155*         JTYPEID('EL')
  6156*         FROM   (JOURNAL-RECORD)
  6157*         LENGTH (773)
  6158*    END-EXEC.
  6159
  6160 8400-EXIT.
  6161     EXIT.
  6162
  6163 8800-UNAUTHORIZED-ACCESS.
  6164     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  6165     GO TO 8300-SEND-TEXT.
  6166
  6167 8810-PF23.
  6168     MOVE EIBAID   TO PI-ENTRY-CD-1.
  6169     MOVE XCTL-EL005 TO PGM-NAME.
  6170     GO TO 9300-XCTL.
  6171
  6172 8850-DUPREC.
  6173     MOVE ER-0147 TO EMI-ERROR.
  6174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6175     MOVE -1       TO STCDL.
  6176     MOVE AL-UABON TO STCDA.
  6177     GO TO 8200-SEND-DATAONLY.
  6178
  6179 8860-ENDFILE.
  6180     MOVE LOW-VALUES TO EL106AO.
  6181     MOVE ER-0148    TO EMI-ERROR.
  6182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6183     MOVE -1 TO MAINTL.
  6184     MOVE SPACES TO PI-WS-STATE.
  6185     GO TO 8100-SEND-INITIAL-MAP.
  6186
  6187 8870-NOTOPEN.
  6188     MOVE ER-0042 TO EMI-ERROR.
  6189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6190     MOVE -1 TO MAINTL.
  6191     GO TO 8200-SEND-DATAONLY.
  6192
  6193 8880-NOT-FOUND.
  6194     MOVE ER-0149 TO EMI-ERROR.
  6195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6196     MOVE -1       TO STCDL.
  6197     MOVE AL-UABON TO STCDA.
  6198     GO TO 8200-SEND-DATAONLY.
  6199
  6200 8890-LETR-NOT-OPEN.
  6201     MOVE ER-0013                TO EMI-ERROR.
  6202     MOVE -1                     TO REPLETRL.
  6203     MOVE AL-UABON               TO REPLETRA.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 121
* EL106.cbl
  6204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6205     GO TO 8200-SEND-DATAONLY.
  6206
  6207 9000-RETURN-CICS.
  6208
  6209* EXEC CICS RETURN
  6210*    END-EXEC.
  6211*    MOVE '.(                    ''   #00005490' TO DFHEIV0
  6212     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6213     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6214     MOVE X'2020233030303035343930' TO DFHEIV0(25:11)
  6215     CALL 'kxdfhei1' USING DFHEIV0,
  6216           DFHEIV99,
  6217           DFHEIV99,
  6218           DFHEIV99,
  6219           DFHEIV99,
  6220           DFHEIV99,
  6221           DFHEIV99
  6222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6223
  6224
  6225 9100-RETURN-TRAN.
  6226     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6227     MOVE '106A'                 TO PI-CURRENT-SCREEN-NO.
  6228
  6229
  6230* EXEC CICS RETURN
  6231*        TRANSID (TRANS-ID)
  6232*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6233*        LENGTH  (WS-COMM-LENGTH)
  6234*    END-EXEC.
  6235*    MOVE '.(CT                  ''   #00005497' TO DFHEIV0
  6236     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6237     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6238     MOVE X'2020233030303035343937' TO DFHEIV0(25:11)
  6239     CALL 'kxdfhei1' USING DFHEIV0,
  6240           TRANS-ID,
  6241           PROGRAM-INTERFACE-BLOCK,
  6242           WS-COMM-LENGTH,
  6243           DFHEIV99,
  6244           DFHEIV99,
  6245           DFHEIV99
  6246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6247
  6248
  6249 9200-RETURN-MAIN-MENU.
  6250     IF  CREDIT-SESSION
  6251         MOVE XCTL-EL626           TO PGM-NAME
  6252     ELSE
  6253     IF  CLAIM-SESSION
  6254         MOVE XCTL-EL126           TO PGM-NAME
  6255     ELSE
  6256     IF  MORTGAGE-SESSION
  6257         MOVE XCTL-EM626           TO PGM-NAME
  6258     ELSE
  6259     IF  GENERAL-LEDGER-SESSION
  6260         MOVE XCTL-GL800           TO PGM-NAME.
  6261
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 122
* EL106.cbl
  6262     GO TO 9300-XCTL.
  6263
  6264 9300-XCTL.
  6265
  6266* EXEC CICS XCTL
  6267*        PROGRAM (PGM-NAME)
  6268*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6269*        LENGTH  (WS-COMM-LENGTH)
  6270*    END-EXEC.
  6271*    MOVE '.$C                   %   #00005519' TO DFHEIV0
  6272     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6273     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6274     MOVE X'2020233030303035353139' TO DFHEIV0(25:11)
  6275     CALL 'kxdfhei1' USING DFHEIV0,
  6276           PGM-NAME,
  6277           PROGRAM-INTERFACE-BLOCK,
  6278           WS-COMM-LENGTH,
  6279           DFHEIV99
  6280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6281
  6282
  6283 9400-CLEAR.
  6284     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6285     GO TO 9300-XCTL.
  6286
  6287 9500-PF12.
  6288     MOVE XCTL-EL010 TO PGM-NAME.
  6289     GO TO 9300-XCTL.
  6290
  6291 9600-PGMID-ERROR.
  6292
  6293* EXEC CICS HANDLE CONDITION
  6294*        PGMIDERR(8300-SEND-TEXT)
  6295*    END-EXEC.
  6296*    MOVE '"$L                   ! ) #00005534' TO DFHEIV0
  6297     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6299     MOVE X'2920233030303035353334' TO DFHEIV0(25:11)
  6300     CALL 'kxdfhei1' USING DFHEIV0
  6301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6302
  6303
  6304     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  6305     MOVE ' '           TO PI-ENTRY-CD-1.
  6306     MOVE XCTL-EL005    TO PGM-NAME.
  6307     MOVE PGM-NAME      TO LOGOFF-PGM.
  6308     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  6309     GO TO 9300-XCTL.
  6310
  6311 9700-LINK-DATE-CONVERT.
  6312
  6313* EXEC CICS LINK
  6314*        PROGRAM    ('ELDATCV')
  6315*        COMMAREA   (DATE-CONVERSION-DATA)
  6316*        LENGTH     (DC-COMM-LENGTH)
  6317*    END-EXEC.
  6318     MOVE 'ELDATCV' TO DFHEIV1
  6319*    MOVE '."C                   (   #00005546' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 123
* EL106.cbl
  6320     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6322     MOVE X'2020233030303035353436' TO DFHEIV0(25:11)
  6323     CALL 'kxdfhei1' USING DFHEIV0,
  6324           DFHEIV1,
  6325           DATE-CONVERSION-DATA,
  6326           DC-COMM-LENGTH,
  6327           DFHEIV99,
  6328           DFHEIV99,
  6329           DFHEIV99,
  6330           DFHEIV99
  6331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6332
  6333
  6334 9700-EXIT.
  6335     EXIT.
  6336
  6337 9900-ERROR-FORMAT.
  6338     IF NOT EMI-ERRORS-COMPLETE
  6339         MOVE LINK-EL001 TO PGM-NAME
  6340
  6341* EXEC CICS LINK
  6342*            PROGRAM (PGM-NAME)
  6343*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  6344*            LENGTH  (EMI-COMM-LENGTH)
  6345*        END-EXEC.
  6346*    MOVE '."C                   (   #00005558' TO DFHEIV0
  6347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6349     MOVE X'2020233030303035353538' TO DFHEIV0(25:11)
  6350     CALL 'kxdfhei1' USING DFHEIV0,
  6351           PGM-NAME,
  6352           ERROR-MESSAGE-INTERFACE-BLOCK,
  6353           EMI-COMM-LENGTH,
  6354           DFHEIV99,
  6355           DFHEIV99,
  6356           DFHEIV99,
  6357           DFHEIV99
  6358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6359
  6360
  6361 9900-EXIT.
  6362     EXIT.
  6363
  6364 9910-INITIALIZE-SECURITY.
  6365******************************************************************
  6366*                                                                *
  6367*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6368*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6369*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6370*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6371*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6372*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6373*                                                                *
  6374******************************************************************
  6375     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  6376         IF  MORTGAGE-SESSION
  6377             MOVE '125E'             TO SC-QUID-SYSTEM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 124
* EL106.cbl
  6378             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6379
  6380* EXEC CICS READQ TS
  6381*                QUEUE  (SC-QUID-KEY)
  6382*                INTO   (SECURITY-CONTROL-E)
  6383*                LENGTH (SC-COMM-LENGTH-E)
  6384*                ITEM   (SC-ITEM)
  6385*            END-EXEC
  6386*    MOVE '*$II   L              ''   #00005582' TO DFHEIV0
  6387     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6389     MOVE X'2020233030303035353832' TO DFHEIV0(25:11)
  6390     CALL 'kxdfhei1' USING DFHEIV0,
  6391           SC-QUID-KEY,
  6392           SECURITY-CONTROL-E,
  6393           SC-COMM-LENGTH-E,
  6394           SC-ITEM,
  6395           DFHEIV99,
  6396           DFHEIV99
  6397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6398             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6399                                     TO PI-DISPLAY-CAP
  6400             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6401                                     TO PI-MODIFY-CAP
  6402             IF  NOT DISPLAY-CAP
  6403                 MOVE 'READ'         TO SM-READ
  6404                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6405                 MOVE ER-9097        TO EMI-ERROR
  6406                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6407                 GO TO 8100-SEND-INITIAL-MAP
  6408             ELSE
  6409                 GO TO 9910-EXIT
  6410         ELSE
  6411
  6412* EXEC CICS  READQ TS
  6413*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6414*                INTO    (SECURITY-CONTROL)
  6415*                LENGTH  (SC-COMM-LENGTH)
  6416*                ITEM    (SC-ITEM-CL-CR)
  6417*                END-EXEC
  6418*    MOVE '*$II   L              ''   #00005601' TO DFHEIV0
  6419     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6420     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6421     MOVE X'2020233030303035363031' TO DFHEIV0(25:11)
  6422     CALL 'kxdfhei1' USING DFHEIV0,
  6423           PI-SECURITY-TEMP-STORE-ID,
  6424           SECURITY-CONTROL,
  6425           SC-COMM-LENGTH,
  6426           SC-ITEM-CL-CR,
  6427           DFHEIV99,
  6428           DFHEIV99
  6429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6430             MOVE SC-CREDIT-DISPLAY (29)
  6431                                 TO PI-DISPLAY-CAP
  6432             MOVE SC-CREDIT-UPDATE  (29)
  6433                                 TO PI-MODIFY-CAP
  6434             IF  NOT DISPLAY-CAP
  6435                 MOVE 'READ'     TO SM-READ
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 125
* EL106.cbl
  6436                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6437                 MOVE ER-0070    TO  EMI-ERROR
  6438                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6439                 GO TO 8100-SEND-INITIAL-MAP.
  6440 9910-EXIT.
  6441     EXIT.
  6442 9990-ABEND.
  6443     MOVE LINK-EL004             TO PGM-NAME.
  6444     MOVE DFHEIBLK               TO EMI-LINE1.
  6445
  6446* EXEC CICS LINK
  6447*        PROGRAM   (PGM-NAME)
  6448*        COMMAREA  (EMI-LINE1)
  6449*        LENGTH    (72)
  6450*    END-EXEC.
  6451     MOVE 72
  6452       TO DFHEIV11
  6453*    MOVE '."C                   (   #00005622' TO DFHEIV0
  6454     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6456     MOVE X'2020233030303035363232' TO DFHEIV0(25:11)
  6457     CALL 'kxdfhei1' USING DFHEIV0,
  6458           PGM-NAME,
  6459           EMI-LINE1,
  6460           DFHEIV11,
  6461           DFHEIV99,
  6462           DFHEIV99,
  6463           DFHEIV99,
  6464           DFHEIV99
  6465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6466
  6467
  6468     GO TO 8200-SEND-DATAONLY.
  6469
  6470 9995-SECURITY-VIOLATION.
  6471*           COPY ELCSCTP.
  6472******************************************************************
  6473*                                                                *
  6474*                            ELCSCTP                             *
  6475*                            VMOD=2.001                          *
  6476*                                                                *
  6477*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6478******************************************************************
  6479
  6480
  6481     MOVE EIBDATE          TO SM-JUL-DATE.
  6482     MOVE EIBTRMID         TO SM-TERMID.
  6483     MOVE THIS-PGM         TO SM-PGM.
  6484     MOVE EIBTIME          TO TIME-IN.
  6485     MOVE TIME-OUT         TO SM-TIME.
  6486     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6487
  6488
  6489* EXEC CICS LINK
  6490*         PROGRAM  ('EL003')
  6491*         COMMAREA (SECURITY-MESSAGE)
  6492*         LENGTH   (80)
  6493*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 126
* EL106.cbl
  6494     MOVE 'EL003' TO DFHEIV1
  6495     MOVE 80
  6496       TO DFHEIV11
  6497*    MOVE '."C                   (   #00005648' TO DFHEIV0
  6498     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6500     MOVE X'2020233030303035363438' TO DFHEIV0(25:11)
  6501     CALL 'kxdfhei1' USING DFHEIV0,
  6502           DFHEIV1,
  6503           SECURITY-MESSAGE,
  6504           DFHEIV11,
  6505           DFHEIV99,
  6506           DFHEIV99,
  6507           DFHEIV99,
  6508           DFHEIV99
  6509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6510
  6511
  6512******************************************************************
  6513
  6514
  6515 9995-EXIT.
  6516      EXIT.
  6517
  6518
  6519 9999-DFHBACK SECTION.
  6520     MOVE '9%                    "   ' TO DFHEIV0
  6521     MOVE 'EL106' TO DFHEIV1
  6522     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6523     GOBACK.
  6524 9999-DFHEXIT.
  6525     IF DFHEIGDJ EQUAL 0001
  6526         NEXT SENTENCE
  6527     ELSE IF DFHEIGDJ EQUAL 2
  6528         GO TO 8850-DUPREC,
  6529               8870-NOTOPEN,
  6530               8880-NOT-FOUND,
  6531               9600-PGMID-ERROR,
  6532               9990-ABEND
  6533         DEPENDING ON DFHEIGDI
  6534     ELSE IF DFHEIGDJ EQUAL 3
  6535         GO TO 8880-NOT-FOUND,
  6536               8880-NOT-FOUND
  6537         DEPENDING ON DFHEIGDI
  6538     ELSE IF DFHEIGDJ EQUAL 4
  6539         GO TO 8100-SEND-INITIAL-MAP
  6540         DEPENDING ON DFHEIGDI
  6541     ELSE IF DFHEIGDJ EQUAL 5
  6542         GO TO 8860-ENDFILE
  6543         DEPENDING ON DFHEIGDI
  6544     ELSE IF DFHEIGDJ EQUAL 6
  6545         GO TO 8860-ENDFILE
  6546         DEPENDING ON DFHEIGDI
  6547     ELSE IF DFHEIGDJ EQUAL 7
  6548         GO TO 6010-LETR-NOT-FOUND,
  6549               6010-LETR-NOT-FOUND,
  6550               8890-LETR-NOT-OPEN
  6551         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 127
* EL106.cbl
  6552     ELSE IF DFHEIGDJ EQUAL 8
  6553         GO TO 6600-EXIT
  6554         DEPENDING ON DFHEIGDI
  6555     ELSE IF DFHEIGDJ EQUAL 9
  6556         GO TO 8300-SEND-TEXT
  6557         DEPENDING ON DFHEIGDI.
  6558     MOVE '9%                    "   ' TO DFHEIV0
  6559     MOVE 'EL106' TO DFHEIV1
  6560     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6561     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5116     Code:       19000
