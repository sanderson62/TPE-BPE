* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46******************************************************************
    47
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   3
* EL131.cbl
    49 ENVIRONMENT DIVISION.
    50
    51 DATA DIVISION.
    52
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55
    56 77  FILLER  PIC X(32)  VALUE '********************************'.
    57 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    58 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    59 77  s1                          pic s999 comp-3 value+0.
    60 77  s2                          pic s999 comp-3 value+0.
    61 77  a1                          pic s999 comp-3 value+0.
    62 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    63 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    64 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    65 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    66 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    67 77  ws-max-extension            pic s999 comp-3 value +0.
    68 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    69 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    70 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    71     88  ERPDEF-FOUND                 VALUE 'Y'.
    72 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    73     88  TRLR-FILE-EOF                VALUE 'Y'.
    74 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    75     88  PAYMENT-PENDING              VALUE 'Y'.
    76 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    77     88  AUTH-RCVD                    VALUE 'Y'.
    78     88  NO-AUTH-RCVD                 VALUE 'N'.
    79 77  ws-eracct-sw                pic x  value ' '.
    80     88  acct-found                value 'Y'.
    81 77  ws-benper-sw                pic x   value ' '.
    82     88  good-benper               value 'Y'.
    83 77  ws-claim-type               pic x value ' '.
    84 77  ws-ben-per                  pic 99 value 00.
    85 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    86 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    87 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    88 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    89
    90 01  LCP-TIME-OF-DAY-XX.
    91     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    92     05  FILLER                    PIC 99.
    93 01  LCP-CICS-TIME                 PIC 9(15).
    94*                            COPY ELCSCTM.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCTM                             *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-MESSAGE.
   105     12  FILLER                          PIC X(30)
   106            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   4
* EL131.cbl
   107     12  SM-READ                         PIC X(6).
   108     12  FILLER                          PIC X(5)
   109            VALUE ' PGM='.
   110     12  SM-PGM                          PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' OPR='.
   113     12  SM-PROCESSOR-ID                 PIC X(4).
   114     12  FILLER                          PIC X(6)
   115            VALUE ' TERM='.
   116     12  SM-TERMID                       PIC X(4).
   117     12  FILLER                          PIC XX   VALUE SPACE.
   118     12  SM-JUL-DATE                     PIC 9(5).
   119     12  FILLER                          PIC X    VALUE SPACE.
   120     12  SM-TIME                         PIC 99.99.
   121
   122
   123*                            COPY ELCSCRTY.
   124******************************************************************
   125*                                                                *
   126*                                                                *
   127*                            ELCSCRTY                            *
   128*                            VMOD=2.001                          *
   129*                                                                *
   130*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   131*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   132*        SAVED IN PI-SECURITY-ADDRESS.                           *
   133*                                                                *
   134******************************************************************
   135 01  SECURITY-CONTROL.
   136     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   137     12  FILLER                       PIC XX    VALUE 'SC'.
   138     12  SC-CREDIT-CODES.
   139         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   140             20  SC-CREDIT-DISPLAY    PIC X.
   141             20  SC-CREDIT-UPDATE     PIC X.
   142     12  SC-CLAIMS-CODES.
   143         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   144             20  SC-CLAIMS-DISPLAY    PIC X.
   145             20  SC-CLAIMS-UPDATE     PIC X.
   146
   147*                            COPY ELCNWA.
   148*****************************************************************
   149*                                                               *
   150*                                                               *
   151*                            ELCNWA.                            *
   152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   153*                            VMOD=2.003                         *
   154*                                                               *
   155*            M O V E   N A M E   W O R K   A R E A.             *
   156*                                                               *
   157*****************************************************************.
   158
   159 01  WS-NAME-WORK-AREA.
   160     05  WS-INSURED-LAST-NAME        PIC X(15).
   161     05  WS-INSURED-1ST-NAME         PIC X(12).
   162     05  WS-INSURED-MID-INIT         PIC X.
   163
   164     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   5
* EL131.cbl
   165         10  WS-NW                   PIC X
   166             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   167
   168     05  WS-NAME-WORK2.
   169         10  WS-NW2                  PIC X
   170             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   171                                        NWA-INDEX0.
   172
   173     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   174                                     COMP-3.
   175
   176
   177 01  ws-dcc-error-line.
   178     05  filler occurs 15.
   179         10  ws-error-no        pic x(4).
   180 01  WS-DATE-AREA.
   181     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   182     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   183     12  SAVE-DATE-CCYYMMDD.
   184         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   185         16  SAVE-DATE-YMD.
   186             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   187             20  FILLER         PIC X(4)    VALUE SPACES.
   188
   189 01  WS-BLANK                   PIC X       VALUE ' '.
   190
   191 01  CSO-WORK-FIELDS.
   192     05  WS-HOLD-CLAIM-STATUS    PIC X.
   193     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   194     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   195         10  WS-RECURRENT-YN     PIC X.
   196         10  FILLER              PIC X.
   197
   198 01  LITERALS-NUMBERS.
   199     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   200     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   201     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   202     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   203     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   204     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   205     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   206     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   207
   208     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   209     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   210     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   211     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   212     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   213     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   214     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   215     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   216     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   217     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   218
   219     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   220
   221     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   222
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   6
* EL131.cbl
   223     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   224     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   225     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   226     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   227     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   228     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   229     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   230     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   231     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   232     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   233     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   234
   235     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   236     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   237     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   238     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   239         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   240     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   241     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   242     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   243     12  WS-ICD-CODE-1           PIC X(8).
   244     12  WS-ICD-CODE-2           PIC X(8).
   245     12  WS-CLAIM-SEQU.
   246         16  FILLER              PIC X VALUE '('.
   247         16  WS-CURRENT-SEQU     PIC Z9.
   248         16  FILLER              PIC X(04) VALUE ' OF '.
   249         16  WS-OF-SEQU          PIC Z9.
   250         16  FILLER              PIC X VALUE ')'.
   251     12  WS-EDIT-BEN-CODE        PIC XX.
   252         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   253                                          '90' THRU '99'.
   254
   255     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   256     12  WS-EDIT-NUMBER          PIC ZZZ9.
   257
   258     12  WS-RESPONSE             PIC S9(8)   COMP.
   259         88  WS-RESP-NORMAL              VALUE +00.
   260         88  WS-RESP-ERROR               VALUE +01.
   261         88  WS-RESP-NOTFND              VALUE +13.
   262         88  WS-RESP-DUPKEY              VALUE +15.
   263         88  WS-RESP-NOTOPEN             VALUE +19.
   264         88  WS-RESP-ENDFILE             VALUE +20.
   265
   266     12  WS-MOS-PAID             PIC 999.
   267     12  WS-ODD-DAYS             PIC 99.
   268     12  WS-REM-MOS              PIC 999.
   269     12  WS-REM-DAYS             PIC 99.
   270     12  WS-TERM-IN-DAYS         PIC 9(4).
   271     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   272
   273     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   274     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   275     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   276     12  WS-RESET-SW             PIC X       VALUE 'N'.
   277     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   278     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   279     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   280
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   7
* EL131.cbl
   281 01  DMD-DATE-YYYYMMDD.
   282     12  DMD-DECADE          PIC XX      VALUE SPACES.
   283     12  DMD-YYMMDD.
   284         16  DMD-YY          PIC XX      VALUE SPACES.
   285         16  DMD-MM          PIC XX      VALUE SPACES.
   286         16  DMD-DD          PIC XX      VALUE SPACES.
   287
   288 01  DMD-DATE-MMDDYYYY.
   289     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   290     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   291     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   292     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   293     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   294     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   295
   296 01  WS-MAIL-CODE.
   297     12  FILLER              PIC X.
   298     12  DMD-MAIL-CODE.
   299         16  WS-MAIL-4       PIC X(4).
   300         16  WS-MAIL-5       PIC X.
   301     12  FILLER              PIC X(4).
   302
   303     12  W-NAME-LAST             PIC  X(15).
   304     12  W-NAME-FIRST            PIC  X(15).
   305     12  W-NAME-MIDDLE.
   306         16  FILLER              PIC  X.
   307         16  W-NAME-MIDDLE-2     PIC  X.
   308         16  FILLER              PIC  X(13).
   309
   310*    COPY ELCDCTB.
   311******************************************************************
   312*                                                                *
   313*                                                                *
   314*                            ELCDCTB.                            *
   315*                            VMOD=2.002                          *
   316*                                                                *
   317*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   318*       COMMUNICATIONS AREA                                      *
   319*                                                                *
   320******************************************************************
   321 01  DCT-COMMUNICATION-AREA.
   322     12  DCT-BILLING-BANK-ID      PIC  X(05).
   323     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   324     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   325     12  DCT-PRODUCT-CODE         PIC  X(02).
   326     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   327     12  DCT-RETURN-CODE          PIC  X(02).
   328     12  DCT-MAIL-CODE            PIC  X(05).
   329     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   330     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   8
* EL131.cbl
   332 01  ERROR-SWITCHES.
   333     12  ERROR-SWITCH            PIC X.
   334         88  SCREEN-ERROR                    VALUE 'X'.
   335     12  MSTR-KEY-SWITCH         PIC X.
   336         88  MSTR-KEY-CHANGED                VALUE 'X'.
   337     12  CERT-KEY-SWITCH         PIC X.
   338*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   339         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   340*********SET TO Y IF PRIMARY KEY WILL CHANGE
   341         88  CERT-KEY-CHANGED                VALUE 'Y'.
   342     12  MSTR-SWITCH             PIC X.
   343         88  MSTR-UPDATES                    VALUE 'X'.
   344     12  crtt-switch             pic x value spaces.
   345         88  crtt-update             value 'X'.
   346     12  CERT-SWITCH             PIC X.
   347         88  CERT-UPDATES                    VALUE 'X'.
   348     12  UPDATE-SWITCH           PIC X.
   349         88  UPDATES-PRESENT                 VALUE 'X'.
   350     12  TRLR-SWITCH             PIC X.
   351         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   352         88  UPDATE-MADE                     VALUE 'Y'.
   353     12  NINETY-TRLR-SWITCH      PIC X.
   354         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   355     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   356         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   357     12  EARNINGS-CALC-SWITCH    PIC X.
   358         88  TEX-REG                         VALUE '4'.
   359         88  NET-PAY                         VALUE '5'.
   360     12  DLYACTV-SW              PIC X       VALUE 'N'.
   361         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page   9
* EL131.cbl
   363 01  EDIT-WORK-AREA.
   364     12  COUNT-2                 PIC 9.
   365     12  CALL-PGM                PIC X(8).
   366     12  TRANS-ID                PIC X(4).
   367     12  CHECK-PFKEYS            PIC 99.
   368     12  CHECK-MAINT             PIC X.
   369         88  ADD-ALPHA-RECORD                VALUE 'A'.
   370         88  CHANGE-CLAIM                    VALUE 'C'.
   371         88  DELETE-CLAIM                    VALUE 'D'.
   372         88  CHANGE-NAME                     VALUE 'N'.
   373         88  VALID-OPTIONS                   VALUE 'A' 'C'
   374                                                   'D' 'N'.
   375
   376     12  HOLD-BENEFIT            PIC XX.
   377     12  HOLD-FREQ               PIC XX.
   378     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   379     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   380     12  HOLD-PDTHRU             PIC XX.
   381     12  HOLD-ADDON              PIC XX.
   382     12  HOLD-NODAYS             PIC 9(4).
   383     12  HOLD-NOPMTS             PIC 9(3).
   384     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   385     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   386     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   387     12  HOLD-BIRTH              PIC XX.
   388     12  HOLD-END                PIC XX.
   389     12  HOLD-EFF                PIC XX.
   390     12  HOLD-ENTRY              PIC XX.
   391     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   392     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   393     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   394     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   395     12  HOLD-LF-CV-CAN          PIC XX.
   396     12  HOLD-AH-CV-CAN          PIC XX.
   397     12  DIVIDE-QUOT             PIC 9(3).
   398     12  DIVIDE-REM              PIC 9(3).
   399
   400     12  WS-ALPHA-DATE.
   401         16  WS-ALPHA-YEAR.
   402             20  WS-ALPHA-YY-1   PIC 99.
   403             20  WS-ALPHA-YY-2   PIC 99.
   404         16  WS-ALPHA-MM         PIC 99.
   405         16  WS-ALPHA-DD         PIC 99.
   406
   407     12  BUILD-VALID-DATE.
   408         16  BUILD-MONTH         PIC 99.
   409         16  BUILD-DAY           PIC 99.
   410         16  BUILD-YEAR          PIC 99.
   411     12  DEEDIT-MMYY-INPUT.
   412         16  FILLER              PIC X.
   413         16  DEEDIT-MONTH        PIC XX.
   414         16  DEEDIT-YEAR         PIC XX.
   415     12  DEEDIT-BEN              PIC 9(9)V99.
   416     12  DEEDIT-DATE-INPUT.
   417         16  FILLER              PIC XX.
   418         16  DEEDIT-DATE         PIC X(6).
   419     12  WORK-DATE-MDY.
   420         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  10
* EL131.cbl
   421         16  FILLER              PIC X(4).
   422         16  YEAR-WORK           PIC XX.
   423     12  WORK-DATE-MY.
   424         16  WORK-MONTH          PIC XX.
   425         16  WORK-SLASH          PIC X       VALUE '/'.
   426         16  WORK-YEAR           PIC XX.
   427     12  HOLD-DATE.
   428         16  HOLD-MONTH          PIC 99.
   429         16  FILLER              PIC X(4).
   430         16  HOLD-YEAR           PIC 99.
   431     12  SPLIT-INFO-LINE-1.
   432         16  SPLIT-INFO-DESC     PIC X(15).
   433         16  FILLER              PIC X(5)    VALUE ' OLD='.
   434         16  SPLIT-INFO-OLD      PIC X(40).
   435     12  EFF-TERM-MO             PIC 9(4).
   436     12  CURR-MO                 PIC 9(4).
   437     12  WS-BIN-CURRENT-DT       PIC XX.
   438     12  WS-CALC-METHOD          PIC X.
   439     12  WS-INITIALS.
   440         16  WS-INIT-1           PIC X.
   441         16  WS-INIT-2           PIC X.
   442     12  WS-REIN-TABLE.
   443         16  WS-REIN-1           PIC X.
   444         16  WS-REIN-2           PIC X.
   445         16  WS-REIN-3           PIC X.
   446     12  PI-KEY.
   447         16  PI-TERM             PIC X(4).
   448         16  PI-QUAL             PIC X(4).
   449     12  CHECK-KEY               PIC X(20).
   450     12  SAVE-ACCT-KEY           PIC X(20).
   451     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   452     12  WS-SOC-SEC-NUMBER.
   453         16  WS-SOC-SEC-NO       PIC 9(9).
   454         16  WS-SOC-SEC-BLANK    PIC X(2).
   455     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   456         16  WS-SSN-1-3          PIC 9(3).
   457         16  WS-SSN-DASH1        PIC X(1).
   458         16  WS-SSN-4-5          PIC 9(2).
   459         16  WS-SSN-DASH2        PIC X(1).
   460         16  WS-SSN-6-9          PIC 9(4).
   461     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   462     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   463
   464 01  WS-SAVE-FIELDS.
   465     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   466     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   467     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   469     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   471     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   473     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   475     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   477     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  11
* EL131.cbl
   479     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   481     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   483     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   485     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   487     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   489     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   491     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   493     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   495     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   497     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   499     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   501     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   503     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   505     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   507     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   509     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   511     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   513     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   515     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   517     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   519     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   520
   521 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   522     12  M                   PIC S9(7)V99           VALUE ZEROS.
   523     12  L                   PIC S9(7)V99           VALUE ZEROS.
   524     12  N                   PIC S9(3)              VALUE ZEROS.
   525     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   526     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   527     12  I                   PIC S99V9(5)           VALUE ZEROS.
   528     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   529     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   530     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   531     12  R                   PIC S9(3)              VALUE ZEROS.
   532     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   533     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   534     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   535     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   536     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  12
* EL131.cbl
   537     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   538     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   539     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   540     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   541
   542 01  TERM-CALC-WORK-AREA.
   543     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   544     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   545     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   546     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   547     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   548     12  V-EXPONENTS.
   549        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   550     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   551
   552 01  TIME-IN.
   553     12  UN-HOURS                PIC XX.
   554     12  UN-MINUTES              PIC XX.
   555     12  FILLER                  PIC XX.
   556
   557 01  TIME-OUT.
   558     12  FOR-HOURS               PIC XX.
   559     12  FILLER                  PIC X       VALUE '.'.
   560     12  FOR-MINUTES             PIC XX.
   561
   562 01  ERROR-NUMBERS.
   563     12  ER-0000                 PIC X(4)    VALUE '0000'.
   564     12  ER-0004                 PIC X(4)    VALUE '0004'.
   565     12  ER-0008                 PIC X(4)    VALUE '0008'.
   566     12  ER-0023                 PIC X(4)    VALUE '0023'.
   567     12  ER-0029                 PIC X(4)    VALUE '0029'.
   568     12  ER-0068                 PIC X(4)    VALUE '0068'.
   569     12  ER-0070                 PIC X(4)    VALUE '0070'.
   570     12  ER-0149                 PIC X(4)    VALUE '0149'.
   571     12  ER-0154                 PIC X(4)    VALUE '0154'.
   572     12  ER-0169                 PIC X(4)    VALUE '0169'.
   573     12  ER-0192                 PIC X(4)    VALUE '0192'.
   574     12  ER-0199                 PIC X(4)    VALUE '0199'.
   575     12  ER-0203                 PIC X(4)    VALUE '0203'.
   576     12  ER-0204                 PIC X(4)    VALUE '0204'.
   577     12  ER-0205                 PIC X(4)    VALUE '0205'.
   578     12  ER-0206                 PIC X(4)    VALUE '0206'.
   579     12  ER-0208                 PIC X(4)    VALUE '0208'.
   580     12  ER-0210                 PIC X(4)    VALUE '0210'.
   581     12  ER-0215                 PIC X(4)    VALUE '0215'.
   582     12  ER-0219                 PIC X(4)    VALUE '0219'.
   583     12  ER-0220                 PIC X(4)    VALUE '0220'.
   584     12  ER-0222                 PIC X(4)    VALUE '0222'.
   585     12  ER-0223                 PIC X(4)    VALUE '0223'.
   586     12  ER-0224                 PIC X(4)    VALUE '0224'.
   587     12  ER-0227                 PIC X(4)    VALUE '0227'.
   588     12  ER-0230                 PIC X(4)    VALUE '0230'.
   589     12  ER-0232                 PIC X(4)    VALUE '0232'.
   590     12  ER-0233                 PIC X(4)    VALUE '0233'.
   591     12  ER-0236                 PIC X(4)    VALUE '0236'.
   592     12  ER-0237                 PIC X(4)    VALUE '0237'.
   593     12  ER-0238                 PIC X(4)    VALUE '0238'.
   594     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  13
* EL131.cbl
   595     12  ER-0241                 PIC X(4)    VALUE '0241'.
   596     12  ER-0243                 PIC X(4)    VALUE '0243'.
   597     12  ER-0244                 PIC X(4)    VALUE '0244'.
   598     12  ER-0246                 PIC X(4)    VALUE '0246'.
   599     12  ER-0247                 PIC X(4)    VALUE '0247'.
   600     12  ER-0248                 PIC X(4)    VALUE '0248'.
   601     12  ER-0250                 PIC X(4)    VALUE '0250'.
   602     12  ER-0251                 PIC X(4)    VALUE '0251'.
   603     12  ER-0253                 PIC X(4)    VALUE '0253'.
   604     12  ER-0256                 PIC X(4)    VALUE '0256'.
   605     12  ER-0257                 PIC X(4)    VALUE '0257'.
   606     12  ER-0258                 PIC X(4)    VALUE '0258'.
   607     12  ER-0259                 PIC X(4)    VALUE '0259'.
   608     12  ER-0260                 PIC X(4)    VALUE '0260'.
   609     12  ER-0261                 PIC X(4)    VALUE '0261'.
   610     12  ER-0262                 PIC X(4)    VALUE '0262'.
   611     12  ER-0263                 PIC X(4)    VALUE '0263'.
   612     12  ER-0273                 PIC X(4)    VALUE '0273'.
   613     12  ER-0274                 PIC X(4)    VALUE '0274'.
   614     12  ER-0276                 PIC X(4)    VALUE '0276'.
   615     12  ER-0282                 PIC X(4)    VALUE '0282'.
   616     12  ER-0283                 PIC X(4)    VALUE '0283'.
   617     12  ER-0309                 PIC X(4)    VALUE '0309'.
   618     12  ER-0310                 PIC X(4)    VALUE '0310'.
   619     12  ER-0311                 PIC X(4)    VALUE '0311'.
   620     12  ER-0333                 PIC X(4)    VALUE '0333'.
   621     12  ER-0360                 PIC X(4)    VALUE '0360'.
   622     12  ER-0377                 PIC X(4)    VALUE '0377'.
   623     12  ER-0402                 PIC X(4)    VALUE '0402'.
   624     12  ER-0416                 PIC X(4)    VALUE '0416'.
   625     12  ER-0426                 PIC X(4)    VALUE '0426'.
   626     12  ER-0427                 PIC X(4)    VALUE '0427'.
   627     12  ER-0428                 PIC X(4)    VALUE '0428'.
   628     12  ER-0429                 PIC X(4)    VALUE '0429'.
   629     12  ER-0430                 PIC X(4)    VALUE '0430'.
   630     12  ER-0458                 PIC X(4)    VALUE '0458'.
   631     12  ER-0475                 PIC X(4)    VALUE '0475'.
   632     12  ER-0491                 PIC X(4)    VALUE '0491'.
   633     12  ER-0509                 PIC X(4)    VALUE '0509'.
   634     12  ER-0510                 PIC X(4)    VALUE '0510'.
   635     12  ER-0511                 PIC X(4)    VALUE '0511'.
   636     12  ER-0512                 PIC X(4)    VALUE '0512'.
   637     12  ER-0519                 PIC X(4)    VALUE '0519'.
   638     12  ER-0520                 PIC X(4)    VALUE '0520'.
   639     12  ER-0521                 PIC X(4)    VALUE '0521'.
   640     12  ER-0547                 PIC X(4)    VALUE '0547'.
   641     12  ER-0548                 PIC X(4)    VALUE '0548'.
   642     12  ER-0549                 PIC X(4)    VALUE '0549'.
   643     12  ER-0565                 PIC X(4)    VALUE '0565'.
   644     12  ER-0598                 PIC X(4)    VALUE '0598'.
   645     12  ER-0639                 PIC X(4)    VALUE '0639'.
   646     12  ER-0797                 PIC X(4)    VALUE '0797'.
   647     12  ER-0802                 PIC X(4)    VALUE '0802'.
   648     12  ER-0803                 PIC X(4)    VALUE '0803'.
   649     12  ER-0849                 PIC X(4)    VALUE '0849'.
   650     12  ER-0885                 PIC X(4)    VALUE '0885'.
   651     12  ER-0887                 PIC X(4)    VALUE '0887'.
   652     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  14
* EL131.cbl
   653     12  ER-0921                 PIC X(4)    VALUE '0921'.
   654     12  ER-0938                 PIC X(4)    VALUE '0938'.
   655     12  ER-0946                 PIC X(4)    VALUE '0946'.
   656     12  ER-0947                 PIC X(4)    VALUE '0947'.
   657     12  ER-0948                 PIC X(4)    VALUE '0948'.
   658     12  ER-0949                 PIC X(4)    VALUE '0949'.
   659     12  ER-0950                 PIC X(4)    VALUE '0950'.
   660     12  ER-0951                 PIC X(4)    VALUE '0951'.
   661     12  ER-0954                 PIC X(4)    VALUE '0954'.
   662     12  ER-0974                 PIC X(4)    VALUE '0974'.
   663     12  ER-0975                 PIC X(4)    VALUE '0975'.
   664     12  ER-0992                 PIC X(4)    VALUE '0992'.
   665     12  er-1581                 pic x(4)    value '1581'.
   666     12  ER-1651                 PIC X(4)    VALUE '1651'.
   667     12  ER-1652                 PIC X(4)    VALUE '1652'.
   668     12  ER-1653                 PIC X(4)    VALUE '1653'.
   669     12  ER-1654                 PIC X(4)    VALUE '1654'.
   670     12  ER-1655                 PIC X(4)    VALUE '1655'.
   671     12  er-1656                 pic x(4)    value '1656'.
   672     12  ER-1661                 PIC X(4)    VALUE '1661'.
   673     12  ER-1662                 PIC X(4)    VALUE '1662'.
   674     12  ER-1663                 PIC X(4)    VALUE '1663'.
   675     12  er-1664                 pic x(4)    value '1664'.
   676     12  er-1665                 pic x(4)    value '1665'.
   677     12  er-1666                 pic x(4)    value '1666'.
   678     12  er-1668                 pic x(4)    value '1668'.
   679     12  er-1669                 pic x(4)    value '1669'.
   680     12  er-1676                 pic x(4)    value '1676'.
   681     12  ER-1772                 PIC X(4)    VALUE '1772'.
   682     12  ER-1773                 PIC X(4)    VALUE '1773'.
   683     12  ER-2280                 PIC X(4)    VALUE '2280'.
   684     12  ER-2878                 PIC X(4)    VALUE '2878'.
   685     12  ER-7641                 PIC X(4)    VALUE '7641'.
   686     12  ER-7642                 PIC X(4)    VALUE '7642'.
   687     12  ER-7650                 PIC X(4)    VALUE '7650'.
   688     12  ER-7651                 PIC X(4)    VALUE '7651'.
   689     12  ER-7687                 PIC X(4)    VALUE '7687'.
   690     12  ER-7689                 PIC X(4)    VALUE '7689'.
   691     12  ER-7690                 PIC X(4)    VALUE '7690'.
   692     12  ER-7691                 PIC X(4)    VALUE '7691'.
   693     12  ER-8003                 PIC X(4)    VALUE '8003'.
   694     12  ER-8051                 PIC X(4)    VALUE '8051'.
   695     12  ER-8052                 PIC X(4)    VALUE '8052'.
   696     12  ER-8053                 PIC X(4)    VALUE '8053'.
   697     12  ER-8054                 PIC X(4)    VALUE '8054'.
   698     12  ER-8055                 PIC X(4)    VALUE '8055'.
   699     12  ER-8056                 PIC X(4)    VALUE '8056'.
   700     12  ER-8057                 PIC X(4)    VALUE '8057'.
   701     12  ER-8058                 PIC X(4)    VALUE '8058'.
   702     12  ER-8059                 PIC X(4)    VALUE '8059'.
   703     12  ER-8060                 PIC X(4)    VALUE '8060'.
   704     12  ER-8061                 PIC X(4)    VALUE '8061'.
   705     12  ER-8062                 PIC X(4)    VALUE '8062'.
   706     12  ER-8063                 PIC X(4)    VALUE '8063'.
   707     12  ER-8064                 PIC X(4)    VALUE '8064'.
   708     12  ER-8065                 PIC X(4)    VALUE '8065'.
   709     12  ER-8066                 PIC X(4)    VALUE '8066'.
   710     12  ER-8152                 PIC X(4)    VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  15
* EL131.cbl
   711     12  ER-8153                 PIC X(4)    VALUE '8153'.
   712     12  ER-8154                 PIC X(4)    VALUE '8154'.
   713     12  ER-8155                 PIC X(4)    VALUE '8155'.
   714 01  ERPDEF-KEY-SAVE             PIC X(18).
   715 01  ERPDEF-KEY.
   716     12  ERPDEF-COMPANY-CD       PIC X.
   717     12  ERPDEF-STATE            PIC XX.
   718     12  ERPDEF-PROD-CD          PIC XXX.
   719     12  F                       PIC X(7).
   720     12  ERPDEF-BEN-TYPE         PIC X.
   721     12  ERPDEF-BEN-CODE         PIC XX.
   722     12  ERPDEF-EXP-DT           PIC XX.
   723 01  MSTR-KEY.
   724     12  COMPANY-CODE            PIC X.
   725     12  CARRIER-CODE            PIC X.
   726     12  CLAIM-NO                PIC X(7).
   727     12  CERT-NO.
   728         16  CERT-NO-PRIME       PIC X(10).
   729         16  CERT-NO-SUFX        PIC X.
   730
   731 01  WS-SAVE-CLAIM-KEY.
   732     12  WS-SAVE-COMPANY-CD      PIC X.
   733     12  WS-SAVE-CARRIER         PIC X.
   734     12  WS-SAVE-CLAIM-NO        PIC X(7).
   735     12  WS-SAVE-CERT-NO.
   736         16  WS-CERT-NO-PRIME    PIC X(10).
   737         16  WS-CERT-NO-SUFX     PIC X.
   738
   739 01  CERT-KEY.
   740     12  CERT-COMPANY-CODE       PIC X.
   741     12  CERT-CARRIER            PIC X.
   742     12  CERT-GROUP              PIC X(6).
   743     12  CERT-STATE              PIC XX.
   744     12  CERT-ACCOUNT            PIC X(10).
   745     12  CERT-DATE               PIC XX.
   746     12  CERT-CERT.
   747         16  CERT-CERT-PRIME     PIC X(10).
   748         16  CERT-CERT-SUFX      PIC X.
   749
   750 01  ELCRTT-KEY.
   751     05  CTRLR-COMP-CD       PIC X.
   752     05  CTRLR-CARRIER       PIC X.
   753     05  CTRLR-GROUPING      PIC X(6).
   754     05  CTRLR-STATE         PIC X(2).
   755     05  CTRLR-ACCOUNT       PIC X(10).
   756     05  CTRLR-EFF-DT        PIC XX.
   757     05  CTRLR-CERT-NO       PIC X(11).
   758     05  CTRLR-REC-TYPE      PIC X.
   759 01  NOTE-KEY.
   760     12  NOTE-COMP-CD            PIC X.
   761     12  NOTE-CERT-KEY.
   762         16  NOTE-CARRIER        PIC X.
   763         16  NOTE-GROUP          PIC X(6).
   764         16  NOTE-STATE          PIC XX.
   765         16  NOTE-ACCOUNT        PIC X(10).
   766         16  NOTE-DATE           PIC XX.
   767         16  NOTE-CERT-NO        PIC X(11).
   768
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  16
* EL131.cbl
   769 01  TRLR-KEY.
   770     12  TRLR-MAIN-KEY.
   771         16  TRLR-COMPANY-CD     PIC X.
   772         16  TRLR-CARRIER        PIC X.
   773         16  TRLR-CLAIM-NO       PIC X(07).
   774         16  TRLR-CERT-NO        PIC X(11).
   775     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   776
   777 01  BENEFIT-KEY.
   778     12  BEN-CO-ID               PIC X(3).
   779     12  BEN-REC-TYPE            PIC X.
   780     12  FILLER                  PIC XX.
   781     12  BEN-ACC-CD              PIC XX.
   782     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   783
   784 01  CNTL-KEY.
   785     12  CNTL-CO-ID              PIC X(3).
   786     12  CNTL-REC-TYPE           PIC X.
   787     12  CNTL-PROC-ID            PIC X(4).
   788     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   789         16  CNTL-STATE-NUMBER   PIC XX.
   790         16  FILLER              PIC XX.
   791     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   792         16  FILLER              PIC X(3).
   793         16  CNTL-CARRIER        PIC X.
   794     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   795
   796 01  ACTQ-KEY                    PIC X(20).
   797
   798 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   799
   800 01  CHKQ-KEY.
   801     12  CHKQ-COMPANY-CODE       PIC X.
   802     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   803     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   804
   805 01  ARCH-KEY.
   806     12  ARCH-COMPANY-CODE       PIC X.
   807     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   808     12  ARCH-RECORD-TYPE        PIC X.
   809     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   810
   811 01  ACCT-KEY.
   812     05  ACCT-PARTIAL-KEY.
   813         12  ACCT-COMPANY-CODE   PIC X.
   814         12  ACCT-CARRIER        PIC X.
   815         12  ACCT-GROUP          PIC X(6).
   816         12  ACCT-STATE          PIC XX.
   817         12  ACCT-ACCOUNT        PIC X(10).
   818     05  ACCT-DATE               PIC XX.
   819
   820 01  WS-ELBENE-KEY.
   821     12  WS-ELBENE-COMPANY-CD    PIC X.
   822     12  WS-ELBENE-RECORD-TYPE   PIC X.
   823     12  WS-ELBENE-ID            PIC X(10).
   824
   825 01  ELALPH-KEY.
   826     12  ELALPH-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  17
* EL131.cbl
   827     12  ELALPH-SOURCE           PIC X.
   828     12  ELALPH-NAME.
   829         16  ELALPH-LAST-NAME    PIC X(15).
   830         16  ELALPH-FIRST-NAME.
   831             20  ELALPH-FIRST-INIT   PIC X.
   832             20  FILLER              PIC X(11).
   833         16  ELALPH-MIDDLE-INIT  PIC X.
   834     12  ELALPH-DATE             PIC X(08).
   835     12  ELALPH-TIME             PIC S9(04)    COMP.
   836
   837 01  COMP-LENGTHS.
   838     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   839     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   840     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   841     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   842     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   843     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   844     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   845     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   846     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   847     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   848     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   849     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   850     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   851     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  18
* EL131.cbl
   853*                                COPY ELCLNKLT.
   854******************************************************************
   855*                                                                *
   856*                                                                *
   857*                           ELCLNKLT                             *
   858*                            VMOD=2.003                          *
   859*                                                                *
   860*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   861*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   862*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   863*                                                                *
   864*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   865*   COMPLETING THE REQUIRED FIELDS.                              *
   866*                                                                *
   867*   THE CALLING PROGRAM SHOULD CHECK:                            *
   868*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   869*                              9999 INDICATES AN UNKNOWN ABEND   *
   870*                                   WAS DETECTED.                *
   871*                              ALL OTHER VALUES ARE NORMAL ERROR *
   872*                              CODES FOUND IN THE ERROR FILE.    *
   873******************************************************************
   874 01  W-1523-LINKDATA.
   875     12  W-1523-COMMON-PI-DATA.
   876         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   877         16  FILLER              PIC  X(67).
   878         16  W-1523-COMPANY-CD   PIC  X(01).
   879         16  FILLER              PIC  X(10).
   880         16  W-1523-CONTROL-IN-PROGRESS.
   881             20  W-1523-CARRIER  PIC  X(01).
   882             20  W-1523-GROUPING PIC  X(06).
   883             20  W-1523-STATE    PIC  X(02).
   884             20  W-1523-ACCOUNT  PIC  X(10).
   885             20  W-1523-CLAIM-CERT-GRP.
   886                 24  W-1523-CLAIM-NO
   887                                 PIC  X(07).
   888                 24  W-1523-CERT-NO.
   889                     28  W-1523-CERT-PRIME
   890                                 PIC  X(10).
   891                     28  W-1523-CERT-SFX
   892                                 PIC  X(01).
   893                 24  W-1523-CERT-EFF-DT
   894                                 PIC  X(02).
   895         16  FILLER              PIC X(265).
   896
   897     12  W-1523-WORK-AREA.
   898         16  W-1523-FORM-NUMBER  PIC  X(04).
   899         16  W-1523-NUMBER-COPIES
   900                                 PIC  9(01).
   901         16  W-1523-ADDR-TYPE    PIC  X(02).
   902         16  W-1523-FOLLOW-UP-DATE
   903                                 PIC  X(02).
   904         16  W-1523-RESEND-DATE  PIC  X(02).
   905         16  W-1523-ERROR-CODE   PIC  9(04).
   906             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   907             88  W-1523-FATAL-ERROR
   908                                    VALUES  0006 0013 0042
   909                                            0154 0168 0169
   910                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  19
* EL131.cbl
   911                                            0179 0186 0281
   912                                            0332 2055 3697
   913                                            3698 3699 3770
   914                                            3771 3772 7675
   915                                            9106 9808 9883
   916                                            9887.
   917             88  W-1523-STOP-ERRORS
   918                                    VALUES  0013 0042 0154
   919                                            0168 0169 0172
   920                                            0281 0332 2055
   921                                            3698 3699 7675
   922                                            9106 9808 9883
   923                                            9999.
   924         16  W-1523-REASON       PIC  X(70).
   925         16  W-1523-ARCHIVE-NUMBER
   926                                 PIC  9(08).
   927     12  W-1523-POINTER-AREA.
   928         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   929         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   930         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   931         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   932         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  20
* EL131.cbl
   934*                                COPY ELCINTF.
   935******************************************************************
   936*                                                                *
   937*                                                                *
   938*                            ELCINTF.                            *
   939*                            VMOD=2.017                          *
   940*                                                                *
   941*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   942*                                                                *
   943*       LENGTH = 1024                                            *
   944*                                                                *
   945******************************************************************
   946*                   C H A N G E   L O G
   947*
   948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   949*-----------------------------------------------------------------
   950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   951* EFFECTIVE    NUMBER
   952*-----------------------------------------------------------------
   953* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   954******************************************************************
   955 01  PROGRAM-INTERFACE-BLOCK.
   956     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   957     12  PI-CALLING-PROGRAM              PIC X(8).
   958     12  PI-SAVED-PROGRAM-1              PIC X(8).
   959     12  PI-SAVED-PROGRAM-2              PIC X(8).
   960     12  PI-SAVED-PROGRAM-3              PIC X(8).
   961     12  PI-SAVED-PROGRAM-4              PIC X(8).
   962     12  PI-SAVED-PROGRAM-5              PIC X(8).
   963     12  PI-SAVED-PROGRAM-6              PIC X(8).
   964     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   965     12  PI-COMPANY-ID                   PIC XXX.
   966     12  PI-COMPANY-CD                   PIC X.
   967
   968     12  PI-COMPANY-PASSWORD             PIC X(8).
   969
   970     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   971
   972     12  PI-CONTROL-IN-PROGRESS.
   973         16  PI-CARRIER                  PIC X.
   974         16  PI-GROUPING                 PIC X(6).
   975         16  PI-STATE                    PIC XX.
   976         16  PI-ACCOUNT                  PIC X(10).
   977         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   978                                         PIC X(10).
   979         16  PI-CLAIM-CERT-GRP.
   980             20  PI-CLAIM-NO             PIC X(7).
   981             20  PI-CERT-NO.
   982                 25  PI-CERT-PRIME       PIC X(10).
   983                 25  PI-CERT-SFX         PIC X.
   984             20  PI-CERT-EFF-DT          PIC XX.
   985         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   986             20  PI-PLAN-CODE            PIC X(2).
   987             20  PI-REVISION-NUMBER      PIC X(3).
   988             20  PI-PLAN-EFF-DT          PIC X(2).
   989             20  PI-PLAN-EXP-DT          PIC X(2).
   990             20  FILLER                  PIC X(11).
   991         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  21
* EL131.cbl
   992             20  PI-OE-REFERENCE-1.
   993                 25  PI-OE-REF-1-PRIME   PIC X(18).
   994                 25  PI-OE-REF-1-SUFF    PIC XX.
   995
   996     12  PI-SESSION-IN-PROGRESS          PIC X.
   997         88  CLAIM-SESSION                   VALUE '1'.
   998         88  CREDIT-SESSION                  VALUE '2'.
   999         88  WARRANTY-SESSION                VALUE '3'.
  1000         88  MORTGAGE-SESSION                VALUE '4'.
  1001         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1002
  1003
  1004*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1005
  1006     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1007     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1008
  1009     12  PI-CREDIT-USER                  PIC X.
  1010         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1011         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1012
  1013     12  PI-CLAIM-USER                   PIC X.
  1014         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1015         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1016
  1017     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1018         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1019         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1020         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1021         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1022         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1023
  1024     12  PI-PROCESSOR-ID                 PIC X(4).
  1025
  1026     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1027
  1028     12  PI-MEMBER-CAPTION               PIC X(10).
  1029
  1030     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1031         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1032
  1033     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1034     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1035     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1036     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1037
  1038     12  PI-AH-OVERRIDE-L1               PIC X.
  1039     12  PI-AH-OVERRIDE-L2               PIC XX.
  1040     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1041     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1042
  1043     12  PI-NEW-SYSTEM                   PIC X(2).
  1044
  1045     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1046     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1047         88  PI-USES-PAID-TO                 VALUE '1'.
  1048     12  PI-CRDTCRD-SYSTEM.
  1049         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  22
* EL131.cbl
  1050             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1051             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1052         16  PI-CC-MONTH-END-DT          PIC XX.
  1053     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1054
  1055     12  PI-OE-REFERENCE-2.
  1056         16  PI-OE-REF-2-PRIME           PIC X(10).
  1057         16  PI-OE-REF-2-SUFF            PIC X.
  1058
  1059     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1060
  1061     12  PI-LANGUAGE-TYPE                PIC X.
  1062             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1063             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1064             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1065
  1066     12  PI-POLICY-LINKAGE-IND           PIC X.
  1067         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1068         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1069                                                   LOW-VALUES.
  1070
  1071     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1072     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1073         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1074         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1075
  1076     12  PI-PROCESSOR-CSR-IND            PIC X.
  1077         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1078         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1079
  1080     12  FILLER                          PIC X(3).
  1081
  1082     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1083
  1084     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1085         PI-SYSTEM-LEVEL.
  1086
  1087         16  PI-ENTRY-CODES.
  1088             20  PI-ENTRY-CD-1           PIC X.
  1089             20  PI-ENTRY-CD-2           PIC X.
  1090
  1091         16  PI-RETURN-CODES.
  1092             20  PI-RETURN-CD-1          PIC X.
  1093             20  PI-RETURN-CD-2          PIC X.
  1094
  1095         16  PI-UPDATE-STATUS-SAVE.
  1096             20  PI-UPDATE-BY            PIC X(4).
  1097             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1098
  1099         16  PI-LOWER-CASE-LETTERS       PIC X.
  1100             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1101
  1102*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1103*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1104*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1105
  1106         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1107             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  23
* EL131.cbl
  1108             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1109             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1110             88  ACCNT-CNTL                  VALUE '3'.
  1111             88  CARR-ACCNT-CNTL             VALUE '4'.
  1112
  1113         16  PI-PROCESSOR-CAP-LIST.
  1114             20  PI-SYSTEM-CONTROLS.
  1115                24 PI-SYSTEM-DISPLAY     PIC X.
  1116                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1117                24 PI-SYSTEM-MODIFY      PIC X.
  1118                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1119             20  FILLER                  PIC XX.
  1120             20  PI-DISPLAY-CAP          PIC X.
  1121                 88  DISPLAY-CAP             VALUE 'Y'.
  1122             20  PI-MODIFY-CAP           PIC X.
  1123                 88  MODIFY-CAP              VALUE 'Y'.
  1124             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1125                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1126             20  PI-FORCE-CAP            PIC X.
  1127                 88  FORCE-CAP               VALUE 'Y'.
  1128
  1129         16  PI-PROGRAM-CONTROLS.
  1130             20  PI-PGM-PRINT-OPT        PIC X.
  1131             20  PI-PGM-FORMAT-OPT       PIC X.
  1132             20  PI-PGM-PROCESS-OPT      PIC X.
  1133             20  PI-PGM-TOTALS-OPT       PIC X.
  1134
  1135         16  PI-HELP-INTERFACE.
  1136             20  PI-LAST-ERROR-NO        PIC X(4).
  1137             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1138
  1139         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1140             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1141
  1142         16  PI-CR-CONTROL-IN-PROGRESS.
  1143             20  PI-CR-CARRIER           PIC X.
  1144             20  PI-CR-GROUPING          PIC X(6).
  1145             20  PI-CR-STATE             PIC XX.
  1146             20  PI-CR-ACCOUNT           PIC X(10).
  1147             20  PI-CR-FIN-RESP          PIC X(10).
  1148             20  PI-CR-TYPE              PIC X.
  1149
  1150         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1151
  1152         16  PI-CR-MONTH-END-DT          PIC XX.
  1153
  1154         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1155             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1156             88  PI-ZERO-CARRIER             VALUE '1'.
  1157             88  PI-ZERO-GROUPING            VALUE '2'.
  1158             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1159
  1160         16  PI-CARRIER-SECURITY         PIC X.
  1161             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1162
  1163         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1164             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1165             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  24
* EL131.cbl
  1166
  1167         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1168             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1169                                         INDEXED BY PI-ACCESS-NDX
  1170                                         PIC X.
  1171
  1172         16  PI-GA-BILLING-CONTROL       PIC X.
  1173             88  PI-GA-BILLING               VALUE '1'.
  1174
  1175         16  PI-MAIL-PROCESSING          PIC X.
  1176             88  PI-MAIL-YES                 VALUE 'Y'.
  1177
  1178         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1179
  1180         16  PI-AR-SYSTEM.
  1181             20  PI-AR-PROCESSING-CNTL   PIC X.
  1182                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1183             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1184             20  PI-AR-MONTH-END-DT      PIC XX.
  1185
  1186         16  PI-MP-SYSTEM.
  1187             20  PI-MORTGAGE-USER            PIC X.
  1188                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1189                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1190             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1191                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1192                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1193                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1194                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1195                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1196             20  PI-MP-MONTH-END-DT          PIC XX.
  1197             20  PI-MP-REFERENCE-NO.
  1198                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1199                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1200
  1201         16  PI-LABEL-CONTROL            PIC X(01).
  1202             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1203             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1204
  1205         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1206             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1207
  1208         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1209             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1210             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1211
  1212         16  FILLER                      PIC X(14).
  1213
  1214     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1215******************************************************************
  1216     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1217         16  PI-NO-PMTS                    PIC 9(4).
  1218         16  PI-CERT-SWITCH                PIC X.
  1219             88  CREATED-CERT              VALUE '2'.
  1220         16  PI-PREM-TYPE                  PIC X.
  1221         16  PI-SAVE-CERT-NO.
  1222             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1223             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  25
* EL131.cbl
  1224         16  FILLER                        PIC X(46).
  1225         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1226         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1227         16  PI-REC-FOUND-SW               PIC X.
  1228         16  PI-LETTER-SW                  PIC X.
  1229         16  PI-PREV-TRLR-KEY              PIC X(22).
  1230         16  pi-claim-type                 pic x.
  1231         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1232         16  pi-approval-level             pic x.
  1233         16  FILLER                        PIC X(543).
  1234
  1235 01  SAVE-RECORD                 PIC X(450).
  1236
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  26
* EL131.cbl
  1238*                                COPY ELCLOGOF SUPPRESS.
  1239******************************************************************
  1240*                                                                *
  1241*                                                                *
  1242*                            ELCLOGOF.                           *
  1243*                            VMOD=2.001                          *
  1244*                                                                *
  1245*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1246*                                                                *
  1247******************************************************************
  1248 01  CLASIC-LOGOFF.
  1249     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1250     12  LOGOFF-TEXT.
  1251         16  FILLER          PIC X(5)    VALUE SPACES.
  1252         16  LOGOFF-MSG.
  1253             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1254             20  FILLER      PIC X       VALUE SPACES.
  1255             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1256         16  FILLER          PIC X(80)
  1257           VALUE '* YOU ARE NOW LOGGED OFF'.
  1258         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1259         16  FILLER          PIC X       VALUE QUOTE.
  1260         16  LOGOFF-SYS-MSG  PIC X(17)
  1261           VALUE 'S CLAS-IC SYSTEM '.
  1262     12  TEXT-MESSAGES.
  1263         16  UNACCESS-MSG    PIC X(29)
  1264             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1265         16  PGMIDERR-MSG    PIC X(17)
  1266             VALUE 'PROGRAM NOT FOUND'.
  1267
  1268*                                COPY ELCATTR SUPPRESS.
  1269******************************************************************
  1270*                                                                *
  1271*                            ELCATTR.                            *
  1272*                            VMOD=2.001                          *
  1273*                                                                *
  1274*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1275*                                                                *
  1276*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1277*                                                                *
  1278*                   POS 1   P=PROTECTED                          *
  1279*                           U=UNPROTECTED                        *
  1280*                           S=ASKIP                              *
  1281*                   POS 2   A=ALPHA/NUMERIC                      *
  1282*                           N=NUMERIC                            *
  1283*                   POS 3   N=NORMAL                             *
  1284*                           B=BRIGHT                             *
  1285*                           D=DARK                               *
  1286*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1287*                           OF=MODIFIED DATA TAG OFF             *
  1288*                                                                *
  1289*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1290******************************************************************
  1291 01  ATTRIBUTE-LIST.
  1292     12  AL-PABOF            PIC X       VALUE 'Y'.
  1293     12  AL-PABON            PIC X       VALUE 'Z'.
  1294     12  AL-PADOF            PIC X       VALUE '%'.
  1295     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  27
* EL131.cbl
  1296     12  AL-PANOF            PIC X       VALUE '-'.
  1297     12  AL-PANON            PIC X       VALUE '/'.
  1298     12  AL-SABOF            PIC X       VALUE '8'.
  1299     12  AL-SABON            PIC X       VALUE '9'.
  1300     12  AL-SADOF            PIC X       VALUE '@'.
  1301     12  AL-SADON            PIC X       VALUE QUOTE.
  1302     12  AL-SANOF            PIC X       VALUE '0'.
  1303     12  AL-SANON            PIC X       VALUE '1'.
  1304     12  AL-UABOF            PIC X       VALUE 'H'.
  1305     12  AL-UABON            PIC X       VALUE 'I'.
  1306     12  AL-UADOF            PIC X       VALUE '<'.
  1307     12  AL-UADON            PIC X       VALUE '('.
  1308     12  AL-UANOF            PIC X       VALUE ' '.
  1309     12  AL-UANON            PIC X       VALUE 'A'.
  1310     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1311     12  AL-UNBON            PIC X       VALUE 'R'.
  1312     12  AL-UNDOF            PIC X       VALUE '*'.
  1313     12  AL-UNDON            PIC X       VALUE ')'.
  1314     12  AL-UNNOF            PIC X       VALUE '&'.
  1315     12  AL-UNNON            PIC X       VALUE 'J'.
  1316
  1317*                                COPY ELCAID SUPPRESS.
  1318******************************************************************
  1319*                                                                *
  1320*                            ELCAID.                             *
  1321*                            VMOD=2.001                          *
  1322*                                                                *
  1323*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1324*                                                                *
  1325*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1326*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1327******************************************************************
  1328
  1329 01  DFHAID.
  1330   02  DFHNULL   PIC  X  VALUE  ' '.
  1331   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1332   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1333   02  DFHPEN    PIC  X  VALUE  '='.
  1334   02  DFHOPID   PIC  X  VALUE  'W'.
  1335   02  DFHPA1    PIC  X  VALUE  '%'.
  1336   02  DFHPA2    PIC  X  VALUE  '>'.
  1337   02  DFHPA3    PIC  X  VALUE  ','.
  1338   02  DFHPF1    PIC  X  VALUE  '1'.
  1339   02  DFHPF2    PIC  X  VALUE  '2'.
  1340   02  DFHPF3    PIC  X  VALUE  '3'.
  1341   02  DFHPF4    PIC  X  VALUE  '4'.
  1342   02  DFHPF5    PIC  X  VALUE  '5'.
  1343   02  DFHPF6    PIC  X  VALUE  '6'.
  1344   02  DFHPF7    PIC  X  VALUE  '7'.
  1345   02  DFHPF8    PIC  X  VALUE  '8'.
  1346   02  DFHPF9    PIC  X  VALUE  '9'.
  1347   02  DFHPF10   PIC  X  VALUE  ':'.
  1348   02  DFHPF11   PIC  X  VALUE  '#'.
  1349   02  DFHPF12   PIC  X  VALUE  '@'.
  1350   02  DFHPF13   PIC  X  VALUE  'A'.
  1351   02  DFHPF14   PIC  X  VALUE  'B'.
  1352   02  DFHPF15   PIC  X  VALUE  'C'.
  1353   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  28
* EL131.cbl
  1354   02  DFHPF17   PIC  X  VALUE  'E'.
  1355   02  DFHPF18   PIC  X  VALUE  'F'.
  1356   02  DFHPF19   PIC  X  VALUE  'G'.
  1357   02  DFHPF20   PIC  X  VALUE  'H'.
  1358   02  DFHPF21   PIC  X  VALUE  'I'.
  1359*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1360   02  DFHPF22   PIC  X  VALUE  '['.
  1361   02  DFHPF23   PIC  X  VALUE  '.'.
  1362   02  DFHPF24   PIC  X  VALUE  '<'.
  1363   02  DFHMSRE   PIC  X  VALUE  'X'.
  1364   02  DFHSTRF   PIC  X  VALUE  'h'.
  1365   02  DFHTRIG   PIC  X  VALUE  '"'.
  1366 01  FILLER REDEFINES DFHAID.
  1367     12  FILLER                  PIC X(8).
  1368     12  AID-KEYS OCCURS 24 TIMES.
  1369         16  FILLER              PIC X.
  1370
  1371*                                COPY EL131S.
  1372 01  EL131AI.
  1373     05  FILLER            PIC  X(0012).
  1374*    -------------------------------
  1375     05  DATEL PIC S9(0004) COMP.
  1376     05  DATEF PIC  X(0001).
  1377     05  FILLER REDEFINES DATEF.
  1378         10  DATEA PIC  X(0001).
  1379     05  DATEI PIC  X(0008).
  1380*    -------------------------------
  1381     05  TIMEL PIC S9(0004) COMP.
  1382     05  TIMEF PIC  X(0001).
  1383     05  FILLER REDEFINES TIMEF.
  1384         10  TIMEA PIC  X(0001).
  1385     05  TIMEI PIC  X(0005).
  1386*    -------------------------------
  1387     05  SEQUL PIC S9(0004) COMP.
  1388     05  SEQUF PIC  X(0001).
  1389     05  FILLER REDEFINES SEQUF.
  1390         10  SEQUA PIC  X(0001).
  1391     05  SEQUI PIC  X(0010).
  1392*    -------------------------------
  1393     05  COMPL PIC S9(0004) COMP.
  1394     05  COMPF PIC  X(0001).
  1395     05  FILLER REDEFINES COMPF.
  1396         10  COMPA PIC  X(0001).
  1397     05  COMPI PIC  X(0003).
  1398*    -------------------------------
  1399     05  USERIDL PIC S9(0004) COMP.
  1400     05  USERIDF PIC  X(0001).
  1401     05  FILLER REDEFINES USERIDF.
  1402         10  USERIDA PIC  X(0001).
  1403     05  USERIDI PIC  X(0004).
  1404*    -------------------------------
  1405     05  LABEL1L PIC S9(0004) COMP.
  1406     05  LABEL1F PIC  X(0001).
  1407     05  FILLER REDEFINES LABEL1F.
  1408         10  LABEL1A PIC  X(0001).
  1409     05  LABEL1I PIC  X(0011).
  1410*    -------------------------------
  1411     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  29
* EL131.cbl
  1412     05  PCERTNOF PIC  X(0001).
  1413     05  FILLER REDEFINES PCERTNOF.
  1414         10  PCERTNOA PIC  X(0001).
  1415     05  PCERTNOI PIC  X(0010).
  1416*    -------------------------------
  1417     05  PSUFXL PIC S9(0004) COMP.
  1418     05  PSUFXF PIC  X(0001).
  1419     05  FILLER REDEFINES PSUFXF.
  1420         10  PSUFXA PIC  X(0001).
  1421     05  PSUFXI PIC  X(0001).
  1422*    -------------------------------
  1423     05  CCNOL PIC S9(0004) COMP.
  1424     05  CCNOF PIC  X(0001).
  1425     05  FILLER REDEFINES CCNOF.
  1426         10  CCNOA PIC  X(0001).
  1427     05  CCNOI PIC  X(0016).
  1428*    -------------------------------
  1429     05  MAINTL PIC S9(0004) COMP.
  1430     05  MAINTF PIC  X(0001).
  1431     05  FILLER REDEFINES MAINTF.
  1432         10  MAINTA PIC  X(0001).
  1433     05  MAINTI PIC  X(0001).
  1434*    -------------------------------
  1435     05  CLAIML PIC S9(0004) COMP.
  1436     05  CLAIMF PIC  X(0001).
  1437     05  FILLER REDEFINES CLAIMF.
  1438         10  CLAIMA PIC  X(0001).
  1439     05  CLAIMI PIC  X(0007).
  1440*    -------------------------------
  1441     05  CARRL PIC S9(0004) COMP.
  1442     05  CARRF PIC  X(0001).
  1443     05  FILLER REDEFINES CARRF.
  1444         10  CARRA PIC  X(0001).
  1445     05  CARRI PIC  X(0001).
  1446*    -------------------------------
  1447     05  CERTL PIC S9(0004) COMP.
  1448     05  CERTF PIC  X(0001).
  1449     05  FILLER REDEFINES CERTF.
  1450         10  CERTA PIC  X(0001).
  1451     05  CERTI PIC  X(0010).
  1452*    -------------------------------
  1453     05  SUFXL PIC S9(0004) COMP.
  1454     05  SUFXF PIC  X(0001).
  1455     05  FILLER REDEFINES SUFXF.
  1456         10  SUFXA PIC  X(0001).
  1457     05  SUFXI PIC  X(0001).
  1458*    -------------------------------
  1459     05  TYPEL PIC S9(0004) COMP.
  1460     05  TYPEF PIC  X(0001).
  1461     05  FILLER REDEFINES TYPEF.
  1462         10  TYPEA PIC  X(0001).
  1463     05  TYPEI PIC  X(0001).
  1464*    -------------------------------
  1465     05  BENPERL PIC S9(0004) COMP.
  1466     05  BENPERF PIC  X(0001).
  1467     05  FILLER REDEFINES BENPERF.
  1468         10  BENPERA PIC  X(0001).
  1469     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  30
* EL131.cbl
  1470*    -------------------------------
  1471     05  INSTYPEL PIC S9(0004) COMP.
  1472     05  INSTYPEF PIC  X(0001).
  1473     05  FILLER REDEFINES INSTYPEF.
  1474         10  INSTYPEA PIC  X(0001).
  1475     05  INSTYPEI PIC  X(0001).
  1476*    -------------------------------
  1477     05  STATUSL PIC S9(0004) COMP.
  1478     05  STATUSF PIC  X(0001).
  1479     05  FILLER REDEFINES STATUSF.
  1480         10  STATUSA PIC  X(0001).
  1481     05  STATUSI PIC  X(0006).
  1482*    -------------------------------
  1483     05  INCL PIC S9(0004) COMP.
  1484     05  INCF PIC  X(0001).
  1485     05  FILLER REDEFINES INCF.
  1486         10  INCA PIC  X(0001).
  1487     05  INCI PIC  X(0008).
  1488*    -------------------------------
  1489     05  REPL PIC S9(0004) COMP.
  1490     05  REPF PIC  X(0001).
  1491     05  FILLER REDEFINES REPF.
  1492         10  REPA PIC  X(0001).
  1493     05  REPI PIC  X(0008).
  1494*    -------------------------------
  1495     05  ICD1L PIC S9(0004) COMP.
  1496     05  ICD1F PIC  X(0001).
  1497     05  FILLER REDEFINES ICD1F.
  1498         10  ICD1A PIC  X(0001).
  1499     05  ICD1I PIC  X(0008).
  1500*    -------------------------------
  1501     05  ICD2L PIC S9(0004) COMP.
  1502     05  ICD2F PIC  X(0001).
  1503     05  FILLER REDEFINES ICD2F.
  1504         10  ICD2A PIC  X(0001).
  1505     05  ICD2I PIC  X(0008).
  1506*    -------------------------------
  1507     05  DIAGL PIC S9(0004) COMP.
  1508     05  DIAGF PIC  X(0001).
  1509     05  FILLER REDEFINES DIAGF.
  1510         10  DIAGA PIC  X(0001).
  1511     05  DIAGI PIC  X(0060).
  1512*    -------------------------------
  1513     05  ACCSWL PIC S9(0004) COMP.
  1514     05  ACCSWF PIC  X(0001).
  1515     05  FILLER REDEFINES ACCSWF.
  1516         10  ACCSWA PIC  X(0001).
  1517     05  ACCSWI PIC  X(0001).
  1518*    -------------------------------
  1519     05  BENEL PIC S9(0004) COMP.
  1520     05  BENEF PIC  X(0001).
  1521     05  FILLER REDEFINES BENEF.
  1522         10  BENEA PIC  X(0001).
  1523     05  BENEI PIC  X(0010).
  1524*    -------------------------------
  1525     05  BIRTHL PIC S9(0004) COMP.
  1526     05  BIRTHF PIC  X(0001).
  1527     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  31
* EL131.cbl
  1528         10  BIRTHA PIC  X(0001).
  1529     05  BIRTHI PIC  X(0008).
  1530*    -------------------------------
  1531     05  SOCIALL PIC S9(0004) COMP.
  1532     05  SOCIALF PIC  X(0001).
  1533     05  FILLER REDEFINES SOCIALF.
  1534         10  SOCIALA PIC  X(0001).
  1535     05  SOCIALI PIC  X(0011).
  1536*    -------------------------------
  1537     05  SEXL PIC S9(0004) COMP.
  1538     05  SEXF PIC  X(0001).
  1539     05  FILLER REDEFINES SEXF.
  1540         10  SEXA PIC  X(0001).
  1541     05  SEXI PIC  X(0001).
  1542*    -------------------------------
  1543     05  MLNAMEL PIC S9(0004) COMP.
  1544     05  MLNAMEF PIC  X(0001).
  1545     05  FILLER REDEFINES MLNAMEF.
  1546         10  MLNAMEA PIC  X(0001).
  1547     05  MLNAMEI PIC  X(0015).
  1548*    -------------------------------
  1549     05  MFNAMEL PIC S9(0004) COMP.
  1550     05  MFNAMEF PIC  X(0001).
  1551     05  FILLER REDEFINES MFNAMEF.
  1552         10  MFNAMEA PIC  X(0001).
  1553     05  MFNAMEI PIC  X(0012).
  1554*    -------------------------------
  1555     05  MMINITL PIC S9(0004) COMP.
  1556     05  MMINITF PIC  X(0001).
  1557     05  FILLER REDEFINES MMINITF.
  1558         10  MMINITA PIC  X(0001).
  1559     05  MMINITI PIC  X(0001).
  1560*    -------------------------------
  1561     05  AUTHRCVL PIC S9(0004) COMP.
  1562     05  AUTHRCVF PIC  X(0001).
  1563     05  FILLER REDEFINES AUTHRCVF.
  1564         10  AUTHRCVA PIC  X(0001).
  1565     05  AUTHRCVI PIC  X(0001).
  1566*    -------------------------------
  1567     05  CRTLNMEL PIC S9(0004) COMP.
  1568     05  CRTLNMEF PIC  X(0001).
  1569     05  FILLER REDEFINES CRTLNMEF.
  1570         10  CRTLNMEA PIC  X(0001).
  1571     05  CRTLNMEI PIC  X(0015).
  1572*    -------------------------------
  1573     05  CRTFNMEL PIC S9(0004) COMP.
  1574     05  CRTFNMEF PIC  X(0001).
  1575     05  FILLER REDEFINES CRTFNMEF.
  1576         10  CRTFNMEA PIC  X(0001).
  1577     05  CRTFNMEI PIC  X(0012).
  1578*    -------------------------------
  1579     05  CRTINITL PIC S9(0004) COMP.
  1580     05  CRTINITF PIC  X(0001).
  1581     05  FILLER REDEFINES CRTINITF.
  1582         10  CRTINITA PIC  X(0001).
  1583     05  CRTINITI PIC  X(0001).
  1584*    -------------------------------
  1585     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  32
* EL131.cbl
  1586     05  LOANBALF PIC  X(0001).
  1587     05  FILLER REDEFINES LOANBALF.
  1588         10  LOANBALA PIC  X(0001).
  1589     05  LOANBALI PIC  9(7)V99.
  1590*    -------------------------------
  1591     05  PROCL PIC S9(0004) COMP.
  1592     05  PROCF PIC  X(0001).
  1593     05  FILLER REDEFINES PROCF.
  1594         10  PROCA PIC  X(0001).
  1595     05  PROCI PIC  X(0004).
  1596*    -------------------------------
  1597     05  SUPVL PIC S9(0004) COMP.
  1598     05  SUPVF PIC  X(0001).
  1599     05  FILLER REDEFINES SUPVF.
  1600         10  SUPVA PIC  X(0001).
  1601     05  SUPVI PIC  X(0001).
  1602*    -------------------------------
  1603     05  PRICDL PIC S9(0004) COMP.
  1604     05  PRICDF PIC  X(0001).
  1605     05  FILLER REDEFINES PRICDF.
  1606         10  PRICDA PIC  X(0001).
  1607     05  PRICDI PIC  X(0001).
  1608*    -------------------------------
  1609     05  CRITPL PIC S9(0004) COMP.
  1610     05  CRITPF PIC  X(0001).
  1611     05  FILLER REDEFINES CRITPF.
  1612         10  CRITPA PIC  X(0001).
  1613     05  CRITPI PIC  X(0002).
  1614*    -------------------------------
  1615     05  EXTENSL PIC S9(0004) COMP.
  1616     05  EXTENSF PIC  X(0001).
  1617     05  FILLER REDEFINES EXTENSF.
  1618         10  EXTENSA PIC  X(0001).
  1619     05  EXTENSI PIC  99.
  1620*    -------------------------------
  1621     05  FILETOL PIC S9(0004) COMP.
  1622     05  FILETOF PIC  X(0001).
  1623     05  FILLER REDEFINES FILETOF.
  1624         10  FILETOA PIC  X(0001).
  1625     05  FILETOI PIC  X(0004).
  1626*    -------------------------------
  1627     05  PTHRHDGL PIC S9(0004) COMP.
  1628     05  PTHRHDGF PIC  X(0001).
  1629     05  FILLER REDEFINES PTHRHDGF.
  1630         10  PTHRHDGA PIC  X(0001).
  1631     05  PTHRHDGI PIC  X(0010).
  1632*    -------------------------------
  1633     05  PDTHRUL PIC S9(0004) COMP.
  1634     05  PDTHRUF PIC  X(0001).
  1635     05  FILLER REDEFINES PDTHRUF.
  1636         10  PDTHRUA PIC  X(0001).
  1637     05  PDTHRUI PIC  X(0008).
  1638*    -------------------------------
  1639     05  PDAMTL PIC S9(0004) COMP.
  1640     05  PDAMTF PIC  X(0001).
  1641     05  FILLER REDEFINES PDAMTF.
  1642         10  PDAMTA PIC  X(0001).
  1643     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  33
* EL131.cbl
  1644*    -------------------------------
  1645     05  NODAYSL PIC S9(0004) COMP.
  1646     05  NODAYSF PIC  X(0001).
  1647     05  FILLER REDEFINES NODAYSF.
  1648         10  NODAYSA PIC  X(0001).
  1649     05  NODAYSI PIC  9(5).
  1650*    -------------------------------
  1651     05  NOPMTSL PIC S9(0004) COMP.
  1652     05  NOPMTSF PIC  X(0001).
  1653     05  FILLER REDEFINES NOPMTSF.
  1654         10  NOPMTSA PIC  X(0001).
  1655     05  NOPMTSI PIC  9(4).
  1656*    -------------------------------
  1657     05  FORMTYPL PIC S9(0004) COMP.
  1658     05  FORMTYPF PIC  X(0001).
  1659     05  FILLER REDEFINES FORMTYPF.
  1660         10  FORMTYPA PIC  X(0001).
  1661     05  FORMTYPI PIC  X(0001).
  1662*    -------------------------------
  1663     05  ESTL PIC S9(0004) COMP.
  1664     05  ESTF PIC  X(0001).
  1665     05  FILLER REDEFINES ESTF.
  1666         10  ESTA PIC  X(0001).
  1667     05  ESTI PIC  X(0008).
  1668*    -------------------------------
  1669     05  AUIDL PIC S9(0004) COMP.
  1670     05  AUIDF PIC  X(0001).
  1671     05  FILLER REDEFINES AUIDF.
  1672         10  AUIDA PIC  X(0001).
  1673     05  AUIDI PIC  X(0004).
  1674*    -------------------------------
  1675     05  OCCL PIC S9(0004) COMP.
  1676     05  OCCF PIC  X(0001).
  1677     05  FILLER REDEFINES OCCF.
  1678         10  OCCA PIC  X(0001).
  1679     05  OCCI PIC  X(0006).
  1680*    -------------------------------
  1681     05  MNTDTL PIC S9(0004) COMP.
  1682     05  MNTDTF PIC  X(0001).
  1683     05  FILLER REDEFINES MNTDTF.
  1684         10  MNTDTA PIC  X(0001).
  1685     05  MNTDTI PIC  X(0008).
  1686*    -------------------------------
  1687     05  MNTTYPEL PIC S9(0004) COMP.
  1688     05  MNTTYPEF PIC  X(0001).
  1689     05  FILLER REDEFINES MNTTYPEF.
  1690         10  MNTTYPEA PIC  X(0001).
  1691     05  MNTTYPEI PIC  X(0006).
  1692*    -------------------------------
  1693     05  CERTCARL PIC S9(0004) COMP.
  1694     05  CERTCARF PIC  X(0001).
  1695     05  FILLER REDEFINES CERTCARF.
  1696         10  CERTCARA PIC  X(0001).
  1697     05  CERTCARI PIC  X(0001).
  1698*    -------------------------------
  1699     05  CERTGRPL PIC S9(0004) COMP.
  1700     05  CERTGRPF PIC  X(0001).
  1701     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  34
* EL131.cbl
  1702         10  CERTGRPA PIC  X(0001).
  1703     05  CERTGRPI PIC  X(0006).
  1704*    -------------------------------
  1705     05  CERTSTL PIC S9(0004) COMP.
  1706     05  CERTSTF PIC  X(0001).
  1707     05  FILLER REDEFINES CERTSTF.
  1708         10  CERTSTA PIC  X(0001).
  1709     05  CERTSTI PIC  X(0002).
  1710*    -------------------------------
  1711     05  CERTACTL PIC S9(0004) COMP.
  1712     05  CERTACTF PIC  X(0001).
  1713     05  FILLER REDEFINES CERTACTF.
  1714         10  CERTACTA PIC  X(0001).
  1715     05  CERTACTI PIC  X(0010).
  1716*    -------------------------------
  1717     05  CERTEFFL PIC S9(0004) COMP.
  1718     05  CERTEFFF PIC  X(0001).
  1719     05  FILLER REDEFINES CERTEFFF.
  1720         10  CERTEFFA PIC  X(0001).
  1721     05  CERTEFFI PIC  X(0008).
  1722*    -------------------------------
  1723     05  ISSAGEL PIC S9(0004) COMP.
  1724     05  ISSAGEF PIC  X(0001).
  1725     05  FILLER REDEFINES ISSAGEF.
  1726         10  ISSAGEA PIC  X(0001).
  1727     05  ISSAGEI PIC  X(0002).
  1728*    -------------------------------
  1729     05  APRL PIC S9(0004) COMP.
  1730     05  APRF PIC  X(0001).
  1731     05  FILLER REDEFINES APRF.
  1732         10  APRA PIC  X(0001).
  1733     05  APRI PIC  9(4)V9(4).
  1734*    -------------------------------
  1735     05  PMTFREQL PIC S9(0004) COMP.
  1736     05  PMTFREQF PIC  X(0001).
  1737     05  FILLER REDEFINES PMTFREQF.
  1738         10  PMTFREQA PIC  X(0001).
  1739     05  PMTFREQI PIC  99.
  1740*    -------------------------------
  1741     05  INDGRPL PIC S9(0004) COMP.
  1742     05  INDGRPF PIC  X(0001).
  1743     05  FILLER REDEFINES INDGRPF.
  1744         10  INDGRPA PIC  X(0001).
  1745     05  INDGRPI PIC  X(0001).
  1746*    -------------------------------
  1747     05  PREMTYPL PIC S9(0004) COMP.
  1748     05  PREMTYPF PIC  X(0001).
  1749     05  FILLER REDEFINES PREMTYPF.
  1750         10  PREMTYPA PIC  X(0001).
  1751     05  PREMTYPI PIC  X(0001).
  1752*    -------------------------------
  1753     05  REINCDL PIC S9(0004) COMP.
  1754     05  REINCDF PIC  X(0001).
  1755     05  FILLER REDEFINES REINCDF.
  1756         10  REINCDA PIC  X(0001).
  1757     05  REINCDI PIC  X(0001).
  1758*    -------------------------------
  1759     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  35
* EL131.cbl
  1760     05  JNTLNMEF PIC  X(0001).
  1761     05  FILLER REDEFINES JNTLNMEF.
  1762         10  JNTLNMEA PIC  X(0001).
  1763     05  JNTLNMEI PIC  X(0015).
  1764*    -------------------------------
  1765     05  JNTFNMEL PIC S9(0004) COMP.
  1766     05  JNTFNMEF PIC  X(0001).
  1767     05  FILLER REDEFINES JNTFNMEF.
  1768         10  JNTFNMEA PIC  X(0001).
  1769     05  JNTFNMEI PIC  X(0012).
  1770*    -------------------------------
  1771     05  JNTINITL PIC S9(0004) COMP.
  1772     05  JNTINITF PIC  X(0001).
  1773     05  FILLER REDEFINES JNTINITF.
  1774         10  JNTINITA PIC  X(0001).
  1775     05  JNTINITI PIC  X(0001).
  1776*    -------------------------------
  1777     05  JNTAGEL PIC S9(0004) COMP.
  1778     05  JNTAGEF PIC  X(0001).
  1779     05  FILLER REDEFINES JNTAGEF.
  1780         10  JNTAGEA PIC  X(0001).
  1781     05  JNTAGEI PIC  X(0002).
  1782*    -------------------------------
  1783     05  ADDONDTL PIC S9(0004) COMP.
  1784     05  ADDONDTF PIC  X(0001).
  1785     05  FILLER REDEFINES ADDONDTF.
  1786         10  ADDONDTA PIC  X(0001).
  1787     05  ADDONDTI PIC  X(0008).
  1788*    -------------------------------
  1789     05  LCVDSCRL PIC S9(0004) COMP.
  1790     05  LCVDSCRF PIC  X(0001).
  1791     05  FILLER REDEFINES LCVDSCRF.
  1792         10  LCVDSCRA PIC  X(0001).
  1793     05  LCVDSCRI PIC  X(0006).
  1794*    -------------------------------
  1795     05  LCVKINDL PIC S9(0004) COMP.
  1796     05  LCVKINDF PIC  X(0001).
  1797     05  FILLER REDEFINES LCVKINDF.
  1798         10  LCVKINDA PIC  X(0001).
  1799     05  LCVKINDI PIC  X(0003).
  1800*    -------------------------------
  1801     05  LCVCDL PIC S9(0004) COMP.
  1802     05  LCVCDF PIC  X(0001).
  1803     05  FILLER REDEFINES LCVCDF.
  1804         10  LCVCDA PIC  X(0001).
  1805     05  LCVCDI PIC  X(0002).
  1806*    -------------------------------
  1807     05  LCVOTRML PIC S9(0004) COMP.
  1808     05  LCVOTRMF PIC  X(0001).
  1809     05  FILLER REDEFINES LCVOTRMF.
  1810         10  LCVOTRMA PIC  X(0001).
  1811     05  LCVOTRMI PIC  999.
  1812*    -------------------------------
  1813     05  LCVRTRML PIC S9(0004) COMP.
  1814     05  LCVRTRMF PIC  X(0001).
  1815     05  FILLER REDEFINES LCVRTRMF.
  1816         10  LCVRTRMA PIC  X(0001).
  1817     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  36
* EL131.cbl
  1818*    -------------------------------
  1819     05  LCVRATEL PIC S9(0004) COMP.
  1820     05  LCVRATEF PIC  X(0001).
  1821     05  FILLER REDEFINES LCVRATEF.
  1822         10  LCVRATEA PIC  X(0001).
  1823     05  LCVRATEI PIC  9999V99.
  1824*    -------------------------------
  1825     05  LCVBENEL PIC S9(0004) COMP.
  1826     05  LCVBENEF PIC  X(0001).
  1827     05  FILLER REDEFINES LCVBENEF.
  1828         10  LCVBENEA PIC  X(0001).
  1829     05  LCVBENEI PIC  9(9)V99.
  1830*    -------------------------------
  1831     05  LCVFORML PIC S9(0004) COMP.
  1832     05  LCVFORMF PIC  X(0001).
  1833     05  FILLER REDEFINES LCVFORMF.
  1834         10  LCVFORMA PIC  X(0001).
  1835     05  LCVFORMI PIC  X(0012).
  1836*    -------------------------------
  1837     05  LCVCNDTL PIC S9(0004) COMP.
  1838     05  LCVCNDTF PIC  X(0001).
  1839     05  FILLER REDEFINES LCVCNDTF.
  1840         10  LCVCNDTA PIC  X(0001).
  1841     05  LCVCNDTI PIC  X(0008).
  1842*    -------------------------------
  1843     05  LCVEXITL PIC S9(0004) COMP.
  1844     05  LCVEXITF PIC  X(0001).
  1845     05  FILLER REDEFINES LCVEXITF.
  1846         10  LCVEXITA PIC  X(0001).
  1847     05  LCVEXITI PIC  X(0008).
  1848*    -------------------------------
  1849     05  LCVSTATL PIC S9(0004) COMP.
  1850     05  LCVSTATF PIC  X(0001).
  1851     05  FILLER REDEFINES LCVSTATF.
  1852         10  LCVSTATA PIC  X(0001).
  1853     05  LCVSTATI PIC  X(0006).
  1854*    -------------------------------
  1855     05  ACVDSCRL PIC S9(0004) COMP.
  1856     05  ACVDSCRF PIC  X(0001).
  1857     05  FILLER REDEFINES ACVDSCRF.
  1858         10  ACVDSCRA PIC  X(0001).
  1859     05  ACVDSCRI PIC  X(0006).
  1860*    -------------------------------
  1861     05  ACVKINDL PIC S9(0004) COMP.
  1862     05  ACVKINDF PIC  X(0001).
  1863     05  FILLER REDEFINES ACVKINDF.
  1864         10  ACVKINDA PIC  X(0001).
  1865     05  ACVKINDI PIC  X(0003).
  1866*    -------------------------------
  1867     05  ACVCDL PIC S9(0004) COMP.
  1868     05  ACVCDF PIC  X(0001).
  1869     05  FILLER REDEFINES ACVCDF.
  1870         10  ACVCDA PIC  X(0001).
  1871     05  ACVCDI PIC  X(0002).
  1872*    -------------------------------
  1873     05  ACVOTRML PIC S9(0004) COMP.
  1874     05  ACVOTRMF PIC  X(0001).
  1875     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  37
* EL131.cbl
  1876         10  ACVOTRMA PIC  X(0001).
  1877     05  ACVOTRMI PIC  999.
  1878*    -------------------------------
  1879     05  ACVRTRML PIC S9(0004) COMP.
  1880     05  ACVRTRMF PIC  X(0001).
  1881     05  FILLER REDEFINES ACVRTRMF.
  1882         10  ACVRTRMA PIC  X(0001).
  1883     05  ACVRTRMI PIC  X(0003).
  1884*    -------------------------------
  1885     05  ACVRATEL PIC S9(0004) COMP.
  1886     05  ACVRATEF PIC  X(0001).
  1887     05  FILLER REDEFINES ACVRATEF.
  1888         10  ACVRATEA PIC  X(0001).
  1889     05  ACVRATEI PIC  9999V99.
  1890*    -------------------------------
  1891     05  ACVBENEL PIC S9(0004) COMP.
  1892     05  ACVBENEF PIC  X(0001).
  1893     05  FILLER REDEFINES ACVBENEF.
  1894         10  ACVBENEA PIC  X(0001).
  1895     05  ACVBENEI PIC  9(9)V99.
  1896*    -------------------------------
  1897     05  ACVFORML PIC S9(0004) COMP.
  1898     05  ACVFORMF PIC  X(0001).
  1899     05  FILLER REDEFINES ACVFORMF.
  1900         10  ACVFORMA PIC  X(0001).
  1901     05  ACVFORMI PIC  X(0012).
  1902*    -------------------------------
  1903     05  ACVCNDTL PIC S9(0004) COMP.
  1904     05  ACVCNDTF PIC  X(0001).
  1905     05  FILLER REDEFINES ACVCNDTF.
  1906         10  ACVCNDTA PIC  X(0001).
  1907     05  ACVCNDTI PIC  X(0008).
  1908*    -------------------------------
  1909     05  ACVEXITL PIC S9(0004) COMP.
  1910     05  ACVEXITF PIC  X(0001).
  1911     05  FILLER REDEFINES ACVEXITF.
  1912         10  ACVEXITA PIC  X(0001).
  1913     05  ACVEXITI PIC  X(0008).
  1914*    -------------------------------
  1915     05  ACVSTATL PIC S9(0004) COMP.
  1916     05  ACVSTATF PIC  X(0001).
  1917     05  FILLER REDEFINES ACVSTATF.
  1918         10  ACVSTATA PIC  X(0001).
  1919     05  ACVSTATI PIC  X(0006).
  1920*    -------------------------------
  1921     05  LABEL2L PIC S9(0004) COMP.
  1922     05  LABEL2F PIC  X(0001).
  1923     05  FILLER REDEFINES LABEL2F.
  1924         10  LABEL2A PIC  X(0001).
  1925     05  LABEL2I PIC  X(0014).
  1926*    -------------------------------
  1927     05  BCERT1L PIC S9(0004) COMP.
  1928     05  BCERT1F PIC  X(0001).
  1929     05  FILLER REDEFINES BCERT1F.
  1930         10  BCERT1A PIC  X(0001).
  1931     05  BCERT1I PIC  X(0010).
  1932*    -------------------------------
  1933     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  38
* EL131.cbl
  1934     05  BSUFX1F PIC  X(0001).
  1935     05  FILLER REDEFINES BSUFX1F.
  1936         10  BSUFX1A PIC  X(0001).
  1937     05  BSUFX1I PIC  X(0001).
  1938*    -------------------------------
  1939     05  BCERT2L PIC S9(0004) COMP.
  1940     05  BCERT2F PIC  X(0001).
  1941     05  FILLER REDEFINES BCERT2F.
  1942         10  BCERT2A PIC  X(0001).
  1943     05  BCERT2I PIC  X(0010).
  1944*    -------------------------------
  1945     05  BSUFX2L PIC S9(0004) COMP.
  1946     05  BSUFX2F PIC  X(0001).
  1947     05  FILLER REDEFINES BSUFX2F.
  1948         10  BSUFX2A PIC  X(0001).
  1949     05  BSUFX2I PIC  X(0001).
  1950*    -------------------------------
  1951     05  BCERT3L PIC S9(0004) COMP.
  1952     05  BCERT3F PIC  X(0001).
  1953     05  FILLER REDEFINES BCERT3F.
  1954         10  BCERT3A PIC  X(0001).
  1955     05  BCERT3I PIC  X(0010).
  1956*    -------------------------------
  1957     05  BSUFX3L PIC S9(0004) COMP.
  1958     05  BSUFX3F PIC  X(0001).
  1959     05  FILLER REDEFINES BSUFX3F.
  1960         10  BSUFX3A PIC  X(0001).
  1961     05  BSUFX3I PIC  X(0001).
  1962*    -------------------------------
  1963     05  BCERT4L PIC S9(0004) COMP.
  1964     05  BCERT4F PIC  X(0001).
  1965     05  FILLER REDEFINES BCERT4F.
  1966         10  BCERT4A PIC  X(0001).
  1967     05  BCERT4I PIC  X(0010).
  1968*    -------------------------------
  1969     05  BSUFX4L PIC S9(0004) COMP.
  1970     05  BSUFX4F PIC  X(0001).
  1971     05  FILLER REDEFINES BSUFX4F.
  1972         10  BSUFX4A PIC  X(0001).
  1973     05  BSUFX4I PIC  X(0001).
  1974*    -------------------------------
  1975     05  BCERT5L PIC S9(0004) COMP.
  1976     05  BCERT5F PIC  X(0001).
  1977     05  FILLER REDEFINES BCERT5F.
  1978         10  BCERT5A PIC  X(0001).
  1979     05  BCERT5I PIC  X(0010).
  1980*    -------------------------------
  1981     05  BSUFX5L PIC S9(0004) COMP.
  1982     05  BSUFX5F PIC  X(0001).
  1983     05  FILLER REDEFINES BSUFX5F.
  1984         10  BSUFX5A PIC  X(0001).
  1985     05  BSUFX5I PIC  X(0001).
  1986*    -------------------------------
  1987     05  MSG1L PIC S9(0004) COMP.
  1988     05  MSG1F PIC  X(0001).
  1989     05  FILLER REDEFINES MSG1F.
  1990         10  MSG1A PIC  X(0001).
  1991     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  39
* EL131.cbl
  1992*    -------------------------------
  1993     05  MSG2L PIC S9(0004) COMP.
  1994     05  MSG2F PIC  X(0001).
  1995     05  FILLER REDEFINES MSG2F.
  1996         10  MSG2A PIC  X(0001).
  1997     05  MSG2I PIC  X(0072).
  1998*    -------------------------------
  1999     05  PFKEYL PIC S9(0004) COMP.
  2000     05  PFKEYF PIC  X(0001).
  2001     05  FILLER REDEFINES PFKEYF.
  2002         10  PFKEYA PIC  X(0001).
  2003     05  PFKEYI PIC  99.
  2004*    -------------------------------
  2005     05  PFKEY6L PIC S9(0004) COMP.
  2006     05  PFKEY6F PIC  X(0001).
  2007     05  FILLER REDEFINES PFKEY6F.
  2008         10  PFKEY6A PIC  X(0001).
  2009     05  PFKEY6I PIC  X(0016).
  2010 01  EL131AO REDEFINES EL131AI.
  2011     05  FILLER            PIC  X(0012).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  DATEO PIC  X(0008).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  TIMEO PIC  99.99.
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  SEQUO PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  COMPO PIC  X(0003).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  USERIDO PIC  X(0004).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  LABEL1O PIC  X(0011).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  PCERTNOO PIC  X(0010).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  PSUFXO PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CCNOO PIC  X(0016).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  MAINTO PIC  X(0001).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  CLAIMO PIC  X(0007).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CARRO PIC  X(0001).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  40
* EL131.cbl
  2050     05  CERTO PIC  X(0010).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  SUFXO PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  TYPEO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  BENPERO PIC  X(0002).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  INSTYPEO PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  STATUSO PIC  X(0006).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  INCO PIC  X(0008).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  REPO PIC  X(0008).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  ICD1O PIC  X(0008).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  ICD2O PIC  X(0008).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  DIAGO PIC  X(0060).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  ACCSWO PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  BENEO PIC  X(0010).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BIRTHO PIC  X(0008).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  SOCIALO PIC  X(0011).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  SEXO PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  MLNAMEO PIC  X(0015).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  MFNAMEO PIC  X(0012).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MMINITO PIC  X(0001).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  41
* EL131.cbl
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  CRTLNMEO PIC  X(0015).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  CRTFNMEO PIC  X(0012).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  CRTINITO PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  LOANBALO PIC  ZZZZZ9.99.
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  PROCO PIC  X(0004).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  SUPVO PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  PRICDO PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  CRITPO PIC  X(0002).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  EXTENSO PIC  X(0002).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  FILETOO PIC  X(0004).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  PTHRHDGO PIC  X(0010).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  PDTHRUO PIC  X(0008).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  PDAMTO PIC  Z(06).99.
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  NODAYSO PIC  ZZZ99.
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  NOPMTSO PIC  ZZ99.
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  FORMTYPO PIC  X(0001).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  ESTO PIC  X(0008).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  AUIDO PIC  X(0004).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  OCCO PIC  X(0006).
  2165*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  42
* EL131.cbl
  2166     05  FILLER            PIC  X(0003).
  2167     05  MNTDTO PIC  X(0008).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  MNTTYPEO PIC  X(0006).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  CERTCARO PIC  X(0001).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  CERTGRPO PIC  X(0006).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  CERTSTO PIC  X(0002).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  CERTACTO PIC  X(0010).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  CERTEFFO PIC  X(0008).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  ISSAGEO PIC  X(0002).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  APRO PIC  9(3).9(4).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  PMTFREQO PIC  99.
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  INDGRPO PIC  X(0001).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  PREMTYPO PIC  X(0001).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  REINCDO PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  JNTLNMEO PIC  X(0015).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  JNTFNMEO PIC  X(0012).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  JNTINITO PIC  X(0001).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  JNTAGEO PIC  X(0002).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  ADDONDTO PIC  X(0008).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  LCVDSCRO PIC  X(0006).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  43
* EL131.cbl
  2224     05  LCVKINDO PIC  X(0003).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  LCVCDO PIC  X(0002).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LCVOTRMO PIC  999.
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  LCVRTRMO PIC  999.
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  LCVRATEO PIC  ZZZ.ZZ.
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVFORMO PIC  X(0012).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVCNDTO PIC  X(0008).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVEXITO PIC  X(0008).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVSTATO PIC  X(0006).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  ACVDSCRO PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  ACVKINDO PIC  X(0003).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  ACVCDO PIC  X(0002).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACVOTRMO PIC  999.
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  ACVRTRMO PIC  999.
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  ACVRATEO PIC  ZZZ.ZZ.
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVFORMO PIC  X(0012).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVCNDTO PIC  X(0008).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  44
* EL131.cbl
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVSTATO PIC  X(0006).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  LABEL2O PIC  X(0014).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  BCERT1O PIC  X(0010).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  BSUFX1O PIC  X(0001).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  BCERT2O PIC  X(0010).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  BSUFX2O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  BCERT3O PIC  X(0010).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BSUFX3O PIC  X(0001).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BCERT4O PIC  X(0010).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BSUFX4O PIC  X(0001).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BCERT5O PIC  X(0010).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BSUFX5O PIC  X(0001).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  MSG1O PIC  X(0072).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSG2O PIC  X(0072).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  PFKEYO PIC  X(0002).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  PFKEY6O PIC  X(0016).
  2330*    -------------------------------
  2331
  2332*                                COPY ELCEMIB SUPPRESS.
  2333******************************************************************
  2334*                                                                *
  2335*                                                                *
  2336*                            ELCEMIB.                            *
  2337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2338*                            VMOD=2.005                          *
  2339*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  45
* EL131.cbl
  2340*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2341*                                                                *
  2342******************************************************************
  2343 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2344     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2345     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2346     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2347     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2348     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2349     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2350     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2351     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2352     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2353         88  EMI-NO-ERRORS                    VALUE '1'.
  2354         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2355         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2356     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2357         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2358     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2359         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2360         88  EMI-AREA1-FULL                   VALUE '2'.
  2361     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2362         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2363         88  EMI-AREA2-FULL                   VALUE '2'.
  2364     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2365         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2366         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2367         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2368         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2369         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2370     12  EMI-ERROR-LINES.
  2371         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2372         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2373         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2374         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2375             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2376                 24  EMI-ERR-NUM         PIC X(4).
  2377                 24  EMI-FILLER          PIC X.
  2378                 24  EMI-SEV             PIC X.
  2379                 24  FILLER              PIC X.
  2380             20  FILLER                  PIC X(02).
  2381     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2382         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2383             20  EMI-ERROR-NUMBER    PIC X(4).
  2384             20  EMI-FILL            PIC X.
  2385             20  EMI-SEVERITY        PIC X.
  2386             20  FILLER              PIC X.
  2387             20  EMI-ERROR-TEXT.
  2388                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2389                 24  FILLER          PIC X(55).
  2390     12  EMI-SEVERITY-SAVE           PIC X.
  2391         88  EMI-NOTE                    VALUE 'N'.
  2392         88  EMI-WARNING                 VALUE 'W'.
  2393         88  EMI-FORCABLE                VALUE 'F'.
  2394         88  EMI-FATAL                   VALUE 'X'.
  2395     12  EMI-MESSAGE-FLAG            PIC X.
  2396         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2397         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  46
* EL131.cbl
  2398     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2399     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2400         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2401         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2402         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2403     12  emi-claim-no                pic x(7).
  2404     12  emi-claim-type              pic x(6).
  2405     12  FILLER                      PIC X(124)  VALUE SPACES.
  2406     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2407     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2408     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2409     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2410
  2411*                                COPY ELCJPFX SUPPRESS.
  2412******************************************************************
  2413*                                                                *
  2414*                                                                *
  2415*                            ELCJPFX.                            *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.002                          *
  2418*                                                                *
  2419*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2420*                                                                *
  2421*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2422*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2423*        ELCNTL - CONTROL FILE                                   *
  2424*        ELMSTR - CLAIM MASTERS                                  *
  2425*        ELTRLR - ACTIVITY TRAILERS                              *
  2426*        ELCHKQ - CHECK QUE                                      *
  2427******************************************************************
  2428 01  JOURNAL-RECORD.
  2429     12  jp-date                     pic s9(5) comp-3.
  2430     12  jp-time                     pic s9(7) comp-3.
  2431     12  JP-USER-ID                  PIC X(4).
  2432     12  JP-FILE-ID                  PIC X(8).
  2433     12  JP-PROGRAM-ID               PIC X(8).
  2434     12  JP-RECORD-TYPE              PIC X.
  2435         88 JP-ADD              VALUE 'A'.
  2436         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2437         88 JP-AFTER-CHANGE     VALUE 'C'.
  2438         88 JP-DELETE           VALUE 'D'.
  2439         88 JP-GENERIC-DELETE   VALUE 'G'.
  2440         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2441         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2442     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2443     12  JP-RECORD-AREA
  2444
  2445
  2446                                 PIC X(750).
  2447
  2448*                                COPY ELCCALC.
  2449******************************************************************
  2450*                                                                *
  2451*                           ELCCALC.                            *
  2452*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2453*                            VMOD=2.025                          *
  2454*                                                                *
  2455*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  47
* EL131.cbl
  2456*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2457*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2458*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2459*                                                                *
  2460*  PASSED TO ELRTRM                                              *
  2461*  -----------------                                             *
  2462*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2463*  ORIGINAL TERM                                                 *
  2464*  BEGINNING DATE                                                *
  2465*  ENDING DATE                                                   *
  2466*  COMPANY I.D.                                                  *
  2467*  ACCOUNT MASTER USER FIELD                                     *
  2468*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2469*  FREE LOOK DAYS                                                *
  2470*                                                                *
  2471*  RETURNED FROM ELRTRM                                          *
  2472*  ---------------------                                         *
  2473*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2474*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2475*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2476*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2477*----------------------------------------------------------------*
  2478*  PASSED TO ELRAMT                                              *
  2479*  ----------------                                              *
  2480*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2481*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2482*  ORIGINAL AMOUNT                                               *
  2483*  ALTERNATE BENEFIT (BALLON)                                    *
  2484*  A.P.R. - NET PAY ONLY                                         *
  2485*  METHOD
  2486*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2487*  COMPANY I.D.                                                  *
  2488*  BENEFIT TYPE                                                  *
  2489*                                                                *
  2490*  RETURNED FROM ELRAMT                                          *
  2491*  --------------------                                          *
  2492*  REMAINING AMOUNT 1 - CURRENT                                  *
  2493*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2494*  REMAINING AMOUNT FACTOR
  2495*----------------------------------------------------------------*
  2496*  PASSED TO ELRESV                                              *
  2497*  -----------------                                             *
  2498*  CERTIFICATE EFFECTIVE DATE                                    *
  2499*  VALUATION DATE                                                *
  2500*  PAID THRU DATE                                                *
  2501*  BENEFIT                                                       *
  2502*  INCURRED DATE                                                 *
  2503*  REPORTED DATE                                                 *
  2504*  ISSUE AGE                                                     *
  2505*  TERM                                                          *
  2506*  CDT PERCENT                                                   *
  2507*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2508* *CLAIM TYPE (LIFE, A/H)                                        *
  2509* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2510* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2511*                                                                *
  2512*  RETURNED FROM ELRESV                                          *
  2513*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  48
* EL131.cbl
  2514*  CDT TABLE USED                                                *
  2515*  CDT FACTOR USED                                               *
  2516*  PAY TO CURRENT RESERVE                                        *
  2517*  I.B.N.R. - A/H ONLY                                           *
  2518*  FUTURE (ACCRUED) AH ONLY                                      *
  2519*----------------------------------------------------------------*
  2520*  PASSED TO ELRATE                                              *
  2521*  ----------------                                              *
  2522*  CERT ISSUE DATE                                               *
  2523*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2524*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2525*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2526*  STATE CODE (CLIENT DEFINED)                                   *
  2527*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2528*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2529*  DEVIATION CODE                                                *
  2530*  ISSUE AGE                                                     *
  2531*  ORIGINAL BENEFIT AMOUNT                                       *
  2532*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2533*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2534*  BENEFIT KIND (LIFE OR A/H)                                    *
  2535*  A.P.R.                                                        *
  2536*  METHOD
  2537*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2538*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2539*  COMPANY I.D. (3 CHARACTER)                                    *
  2540*  BENEFIT CODE                                                  *
  2541*  BENEFIT OVERRIDE CODE                                         *
  2542*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2543*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2544*  JOINT INDICATOR (CSL ONLY)                                    *
  2545*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2546*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2547*                                                                *
  2548*  RETURNED FROM ELRATE                                          *
  2549*  --------------------                                          *
  2550*  CALCULATED PREMIUM                                            *
  2551*  PREMIUM RATE                                                  *
  2552*  MORTALITY CODE                                                *
  2553*  MAX ATTAINED AGE                                              *
  2554*  MAX AGE                                                       *
  2555*  MAX TERM                                                      *
  2556*  MAX MONTHLY BENEFIT                                           *
  2557*  MAX TOTAL BENIFIT                                             *
  2558*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2559*----------------------------------------------------------------*
  2560*  PASSED TO ELRFND                                              *
  2561*  ----------------                                              *
  2562*  CERT ISSUE DATE                                               *
  2563*  REFUND DATE                                                   *
  2564*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2565*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2566*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2567*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2568*  STATE CODE (CLIENT DEFINED)                                   *
  2569*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2570*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2571*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  49
* EL131.cbl
  2572*  ISSUE AGE                                                     *
  2573*  ORIGINAL BENEFIT AMOUNT                                       *
  2574*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2575*  PROCESS TYPE (CANCEL)                                         *
  2576*  BENEFIT KIND (LIFE OR A/H)                                    *
  2577*  A.P.R.                                                        *
  2578*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2579*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2580*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2581*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2582*  COMPANY I.D. (3 CHARACTER)                                    *
  2583*  BENEFIT CODE                                                  *
  2584*  BENEFIT OVERRIDE CODE                                         *
  2585*                                                                *
  2586*  RETURNED FROM ELRFND                                          *
  2587*  --------------------                                          *
  2588*  CALCULATED REFUND                                             *
  2589*----------------------------------------------------------------*
  2590*  PASSED TO ELEARN                                              *
  2591*  ----------------                                              *
  2592*  CERT ISSUE DATE                                               *
  2593*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2594*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2595*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2596*  STATE CODE (CLIENT DEFINED)                                   *
  2597*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2598*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2599*  DEVIATION CODE                                                *
  2600*  ISSUE AGE                                                     *
  2601*  ORIGINAL BENEFIT AMOUNT                                       *
  2602*  BENEFIT KIND (LIFE OR A/H)                                    *
  2603*  A.P.R.                                                        *
  2604*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2605*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2606*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2607*  COMPANY I.D. (3 CHARACTER)                                    *
  2608*  BENEFIT CODE                                                  *
  2609*  BENEFIT OVERRIDE CODE                                         *
  2610*                                                                *
  2611*  RETURNED FROM ELEARN                                          *
  2612*  --------------------                                          *
  2613*  INDICATED  EARNINGS                                           *
  2614*----------------------------------------------------------------*
  2615*                 LENGTH = 450                                   *
  2616*                                                                *
  2617******************************************************************
  2618******************************************************************
  2619*                   C H A N G E   L O G
  2620*
  2621* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2622*-----------------------------------------------------------------
  2623*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2624* EFFECTIVE    NUMBER
  2625*-----------------------------------------------------------------
  2626* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2627* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2628* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2629* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  50
* EL131.cbl
  2630* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2631* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2632* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2633* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2634* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2635* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2636* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2637******************************************************************
  2638
  2639 01  CALCULATION-PASS-AREA.
  2640     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2641                                     COMP.
  2642
  2643     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2644       88  NO-CP-ERROR                             VALUE ZERO.
  2645       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2646                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2647       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2648       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2649       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2650       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2651       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2652       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2653       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2654       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2655       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2656       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2657       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2658       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2659       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2660       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2661       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2662       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2663       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2664
  2665     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2666       88  NO-CP-ERROR-2                           VALUE ZERO.
  2667***********************  INPUT AREAS ****************************
  2668
  2669     12  CP-CALCULATION-AREA.
  2670         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2671         16  CP-CERT-EFF-DT        PIC XX.
  2672         16  CP-VALUATION-DT       PIC XX.
  2673         16  CP-PAID-THRU-DT       PIC XX.
  2674         16  CP-BENEFIT-TYPE       PIC X.
  2675           88  CP-AH                               VALUE 'A' 'D'
  2676                                                   'I' 'U'.
  2677           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2678           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2679         16  CP-INCURRED-DT        PIC XX.
  2680         16  CP-REPORTED-DT        PIC XX.
  2681         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2682         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2683         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2684                                     COMP-3.
  2685         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2686                                     COMP-3.
  2687         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  51
* EL131.cbl
  2688           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2689           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2690           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2691         16  CP-CLAIM-TYPE         PIC X.
  2692           88  CP-AH-CLAIM                         VALUE 'A'.
  2693           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2694         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2695                                     COMP-3.
  2696         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2697                                     COMP-3.
  2698         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2701                                     COMP-3.
  2702         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2703                                     COMP-3.
  2704         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2705                                     COMP-3.
  2706         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-REM-TERM-METHOD    PIC X.
  2709           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2710           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2711           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2712           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2713           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2714           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2715           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2716         16  CP-EARNING-METHOD     PIC X.
  2717           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2718           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2719           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2720           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2721           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2722           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2723           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2724           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2725           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2726           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2727           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2728           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2729           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2730           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2731         16  CP-PROCESS-TYPE       PIC X.
  2732           88  CP-CLAIM                            VALUE '1'.
  2733           88  CP-CANCEL                           VALUE '2'.
  2734           88  CP-ISSUE                            VALUE '3'.
  2735         16  CP-SPECIAL-CALC-CD    PIC X.
  2736           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2737           88  CP-1-MTH-INTEREST               VALUE ' '.
  2738           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2739           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2740           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2741           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2742           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2743           88  CP-FARM-PLAN                    VALUE 'F'.
  2744           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2745           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  52
* EL131.cbl
  2746           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2747           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2748           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2749           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2750           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2751           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2752           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2753           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2754                                                     'W' 'X'.
  2755           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2756           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2757           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2758           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2759           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2760           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2761           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2762           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2763           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2764           88  CP-CSL-METH-1                   VALUE '5'.
  2765           88  CP-CSL-METH-2                   VALUE '6'.
  2766           88  CP-CSL-METH-3                   VALUE '7'.
  2767           88  CP-CSL-METH-4                   VALUE '8'.
  2768
  2769         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2770                                     COMP-3.
  2771         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2772         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2773         16  CP-STATE              PIC XX          VALUE SPACE.
  2774         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2775         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2776           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2777               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2778         16  CP-R78-OPTION         PIC X.
  2779           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2780           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2781
  2782         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2783         16  CP-IBNR-RESERVE-SW    PIC X.
  2784         16  CP-CLAIM-STATUS       PIC X.
  2785         16  CP-RATE-FILE          PIC X.
  2786         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2787                                     COMP-3.
  2788
  2789         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2790         16  CP-AH-OVERRIDE-CODE   PIC X.
  2791
  2792         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2795                                   PIC S9(5)V99 COMP-3.
  2796         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2799                                     COMP-3.
  2800         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2801                                     COMP-3.
  2802         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2803                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  53
* EL131.cbl
  2804
  2805         16  CP-PAID-FROM-DATE     PIC X(02).
  2806         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2807         16  CP-EXT-DAYS-CALC      PIC X.
  2808           88  CP-EXT-NO-CHG                   VALUE ' '.
  2809           88  CP-EXT-CHG-LF                   VALUE '1'.
  2810           88  CP-EXT-CHG-AH                   VALUE '2'.
  2811           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2812         16  CP-DOMICILE-STATE     PIC XX.
  2813         16  CP-CARRIER            PIC X.
  2814         16  CP-REIN-FLAG          PIC X.
  2815         16  CP-REM-TRM-CALC-OPTION PIC X.
  2816           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2817                      '2' '3' '4' '5'.
  2818           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2819           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2820           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2821           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2822           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2823           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2824           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2825           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2826         16  CP-SIG-SWITCH         PIC X.
  2827         16  CP-RATING-METHOD      PIC X.
  2828           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2829           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2830           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2831           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2832           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2833           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2834           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2835           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2836           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2837         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2838                                     COMP-3.
  2839         16  CP-BEN-CATEGORY       PIC X.
  2840         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2841         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2842                                   PIC S99V9(5) COMP-3.
  2843         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2844         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2845                                   PIC S99V9(5) COMP-3.
  2846         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2847         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2848         16  CP-EXPIRE-DT          PIC XX.
  2849         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2850         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2851         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2852         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2853         16  CP-DDF-SPEC-CALC      PIC X.
  2854             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2855             88  CP-CALC-CLP              VALUE 'C'.
  2856         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2857         16  CP-CANCEL-REASON      PIC X.
  2858         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2859         16  CP-PMT-MODE           PIC X.
  2860         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2861         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  54
* EL131.cbl
  2862         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2863         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2864         16  FILLER                PIC X.
  2865
  2866***************    OUTPUT FROM ELRESV   ************************
  2867
  2868         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2869
  2870         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2871                                     COMP-3.
  2872         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2873                                     COMP-3.
  2874         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2875                                     COMP-3.
  2876         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2877                                     COMP-3.
  2878         16  FILLER                PIC X(09).
  2879***************    OUTPUT FROM ELRTRM   *************************
  2880
  2881         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2882                                     COMP-3.
  2883         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2884                                     COMP-3.
  2885         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2888                                     COMP-3.
  2889         16  FILLER                PIC X(12).
  2890
  2891***************    OUTPUT FROM ELRAMT   *************************
  2892
  2893         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2894                                     COMP-3.
  2895         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2896                                     COMP-3.
  2897         16  FILLER                PIC X(12).
  2898
  2899***************    OUTPUT FROM ELRATE   *************************
  2900
  2901         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2902                                     COMP-3.
  2903         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2904                                     COMP-3.
  2905         16  CP-MORTALITY-CODE     PIC X(4).
  2906         16  CP-RATE-EDIT-FLAG     PIC X.
  2907             88  CP-RATES-NEED-APR                  VALUE '1'.
  2908         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2909                                     COMP-3.
  2910         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2911         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2912         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2913                                   PIC S9(7)V99 COMP-3.
  2914         16  FILLER                PIC X(07).
  2915
  2916***************    OUTPUT FROM ELRFND   *************************
  2917
  2918         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2919                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  55
* EL131.cbl
  2920         16  CP-REFUND-TYPE-USED   PIC X.
  2921           88  CP-R-AS-R78                         VALUE '1'.
  2922           88  CP-R-AS-PRORATA                     VALUE '2'.
  2923           88  CP-R-AS-CALIF                       VALUE '3'.
  2924           88  CP-R-AS-TEXAS                       VALUE '4'.
  2925           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2926           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2927           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2928           88  CP-R-AS-MEAN                        VALUE '8'.
  2929           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2930           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2931           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2932           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2933           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2934           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2935         16  FILLER                PIC X(12).
  2936
  2937***************    OUTPUT FROM ELEARN   *************************
  2938
  2939         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2940                                     COMP-3.
  2941         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2942                                     COMP-3.
  2943         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2944                                     COMP-3.
  2945         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2946                                     COMP-3.
  2947         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2948                                     COMP-3.
  2949         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2950                                     COMP-3.
  2951         16  CP-EARNING-TYPE-USED  PIC X.
  2952           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2953           88  CP-E-AS-R78                         VALUE '1'.
  2954           88  CP-E-AS-PRORATA                     VALUE '2'.
  2955           88  CP-E-AS-TEXAS                       VALUE '4'.
  2956           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2957           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2958           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2959           88  CP-E-AS-MEAN                        VALUE '8'.
  2960           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2961         16  FILLER                PIC X(12).
  2962
  2963***************    OUTPUT FROM ELPMNT   *************************
  2964
  2965         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2968                                     COMP-3.
  2969         16  FILLER                PIC X(12).
  2970
  2971***************   MISC WORK AREAS    *****************************
  2972         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2973                                     COMP-3.
  2974         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2975                                     COMP-3.
  2976         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2977                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  56
* EL131.cbl
  2978         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2979                                     COMP-3.
  2980         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2981                                     COMP-3.
  2982         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2983                                     COMP-3.
  2984         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2985             88  OPEN-RATE-FILE                   VALUE 'O'.
  2986             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2987             88  IO-ERROR                         VALUE 'E'.
  2988
  2989         16  CP-FIRST-PAY-DATE     PIC XX.
  2990
  2991         16  CP-JOINT-INDICATOR    PIC X.
  2992
  2993         16  CP-RESERVE-REMAINING-TERM
  2994                                   PIC S9(4)V9    VALUE ZERO
  2995                                     COMP-3.
  2996
  2997         16  CP-INSURED-BIRTH-DT   PIC XX.
  2998
  2999         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3000                                     COMP-3.
  3001
  3002         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3003                                     COMP-3.
  3004
  3005         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3006                                     COMP-3.
  3007
  3008         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3009                                     COMP-3.
  3010
  3011         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3012                                     COMP-3.
  3013
  3014         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3015                                     COMP-3.
  3016
  3017         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3018                                     COMP-3.
  3019
  3020         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3021             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3022
  3023         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3024                                     COMP-3.
  3025         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3026                                     COMP-3.
  3027         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3028         16  cp-extra-periods      pic 9 value zeros.
  3029         16  cp-net-only-state     pic x value spaces.
  3030         16  FILLER                PIC X(13).
  3031******************************************************************
  3032
  3033*                                COPY ELCDATE.
  3034******************************************************************
  3035*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  57
* EL131.cbl
  3036*                                                                *
  3037*                            ELCDATE.                            *
  3038*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3039*                            VMOD=2.003
  3040*                                                                *
  3041*                                                                *
  3042*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3043*                 LENGTH = 200                                   *
  3044******************************************************************
  3045
  3046 01  DATE-CONVERSION-DATA.
  3047     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3048     12  DC-OPTION-CODE                PIC X.
  3049         88  BIN-TO-GREG                VALUE ' '.
  3050         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3051         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3052         88  YMD-GREG-TO-BIN            VALUE '3'.
  3053         88  MDY-GREG-TO-BIN            VALUE '4'.
  3054         88  JULIAN-TO-BIN              VALUE '5'.
  3055         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3056         88  FIND-CENTURY               VALUE '7'.
  3057         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3058         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3059         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3060         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3061         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3062         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3063         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3064         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3065         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3066         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3067         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3068         88  BIN-3-TO-GREG              VALUE 'I'.
  3069         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3070         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3071         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3072         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3073         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3074         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3075         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3076         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3077         88  THREE-CHARACTER-BIN
  3078                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3079         88  GREGORIAN-TO-BIN
  3080                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3081         88  BIN-TO-GREGORIAN
  3082                  VALUES ' ' '1' 'I' '8' 'G'.
  3083         88  JULIAN-TO-BINARY
  3084                  VALUES '5' 'C' 'E' 'F'.
  3085     12  DC-ERROR-CODE                 PIC X.
  3086         88  NO-CONVERSION-ERROR        VALUE ' '.
  3087         88  DATE-CONVERSION-ERROR
  3088                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3089         88  DATE-IS-ZERO               VALUE '1'.
  3090         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3091         88  DATE-IS-INVALID            VALUE '3'.
  3092         88  DATE1-GREATER-DATE2        VALUE '4'.
  3093         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  58
* EL131.cbl
  3094         88  DATE-INVALID-OPTION        VALUE '9'.
  3095         88  INVALID-CENTURY            VALUE 'A'.
  3096         88  ONLY-CENTURY               VALUE 'B'.
  3097         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3098         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3099     12  DC-END-OF-MONTH               PIC X.
  3100         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3101     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3102         88  USE-NORMAL-PROCESS         VALUE ' '.
  3103         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3104         88  ADJUST-UP-100-YRS          VALUE '2'.
  3105     12  FILLER                        PIC X.
  3106     12  DC-CONVERSION-DATES.
  3107         16  DC-BIN-DATE-1             PIC XX.
  3108         16  DC-BIN-DATE-2             PIC XX.
  3109         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3110         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3111                       DC-GREG-DATE-1-EDIT.
  3112             20  DC-EDIT1-MONTH        PIC 99.
  3113             20  SLASH1-1              PIC X.
  3114             20  DC-EDIT1-DAY          PIC 99.
  3115             20  SLASH1-2              PIC X.
  3116             20  DC-EDIT1-YEAR         PIC 99.
  3117         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3118         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3119                     DC-GREG-DATE-2-EDIT.
  3120             20  DC-EDIT2-MONTH        PIC 99.
  3121             20  SLASH2-1              PIC X.
  3122             20  DC-EDIT2-DAY          PIC 99.
  3123             20  SLASH2-2              PIC X.
  3124             20  DC-EDIT2-YEAR         PIC 99.
  3125         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3126         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3127                     DC-GREG-DATE-1-YMD.
  3128             20  DC-YMD-YEAR           PIC 99.
  3129             20  DC-YMD-MONTH          PIC 99.
  3130             20  DC-YMD-DAY            PIC 99.
  3131         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3132         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3133                      DC-GREG-DATE-1-MDY.
  3134             20  DC-MDY-MONTH          PIC 99.
  3135             20  DC-MDY-DAY            PIC 99.
  3136             20  DC-MDY-YEAR           PIC 99.
  3137         16  DC-GREG-DATE-1-ALPHA.
  3138             20  DC-ALPHA-MONTH        PIC X(10).
  3139             20  DC-ALPHA-DAY          PIC 99.
  3140             20  FILLER                PIC XX.
  3141             20  DC-ALPHA-CENTURY.
  3142                 24 DC-ALPHA-CEN-N     PIC 99.
  3143             20  DC-ALPHA-YEAR         PIC 99.
  3144         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3145         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3146         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3147         16  DC-JULIAN-DATE            PIC 9(05).
  3148         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3149                                       PIC 9(05).
  3150         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3151             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  59
* EL131.cbl
  3152             20  DC-JULIAN-DAYS        PIC 999.
  3153         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3154         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3155         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3156     12  DATE-CONVERSION-VARIBLES.
  3157         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3158         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3159             20  FILLER                PIC 9(3).
  3160             20  HOLD-CEN-1-CCYY.
  3161                 24  HOLD-CEN-1-CC     PIC 99.
  3162                 24  HOLD-CEN-1-YY     PIC 99.
  3163             20  HOLD-CEN-1-MO         PIC 99.
  3164             20  HOLD-CEN-1-DA         PIC 99.
  3165         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3166             20  HOLD-CEN-1-R-MO       PIC 99.
  3167             20  HOLD-CEN-1-R-DA       PIC 99.
  3168             20  HOLD-CEN-1-R-CCYY.
  3169                 24  HOLD-CEN-1-R-CC   PIC 99.
  3170                 24  HOLD-CEN-1-R-YY   PIC 99.
  3171             20  FILLER                PIC 9(3).
  3172         16  HOLD-CENTURY-1-X.
  3173             20  FILLER                PIC X(3)  VALUE SPACES.
  3174             20  HOLD-CEN-1-X-CCYY.
  3175                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3176                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3177             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3178             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3179         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3180             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3181             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3182             20  HOLD-CEN-1-R-X-CCYY.
  3183                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3184                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3185             20  FILLER                PIC XXX.
  3186         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3187         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3188         16  DC-JULIAN-DATE-1          PIC 9(07).
  3189         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3190             20  DC-JULIAN-1-CCYY.
  3191                 24  DC-JULIAN-1-CC    PIC 99.
  3192                 24  DC-JULIAN-1-YR    PIC 99.
  3193             20  DC-JULIAN-DA-1        PIC 999.
  3194         16  DC-JULIAN-DATE-2          PIC 9(07).
  3195         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3196             20  DC-JULIAN-2-CCYY.
  3197                 24  DC-JULIAN-2-CC    PIC 99.
  3198                 24  DC-JULIAN-2-YR    PIC 99.
  3199             20  DC-JULIAN-DA-2        PIC 999.
  3200         16  DC-GREG-DATE-A-EDIT.
  3201             20  DC-EDITA-MONTH        PIC 99.
  3202             20  SLASHA-1              PIC X VALUE '/'.
  3203             20  DC-EDITA-DAY          PIC 99.
  3204             20  SLASHA-2              PIC X VALUE '/'.
  3205             20  DC-EDITA-CCYY.
  3206                 24  DC-EDITA-CENT     PIC 99.
  3207                 24  DC-EDITA-YEAR     PIC 99.
  3208         16  DC-GREG-DATE-B-EDIT.
  3209             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  60
* EL131.cbl
  3210             20  SLASHB-1              PIC X VALUE '/'.
  3211             20  DC-EDITB-DAY          PIC 99.
  3212             20  SLASHB-2              PIC X VALUE '/'.
  3213             20  DC-EDITB-CCYY.
  3214                 24  DC-EDITB-CENT     PIC 99.
  3215                 24  DC-EDITB-YEAR     PIC 99.
  3216         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3217         16  DC-GREG-DATE-CYMD-R REDEFINES
  3218                              DC-GREG-DATE-CYMD.
  3219             20  DC-CYMD-CEN           PIC 99.
  3220             20  DC-CYMD-YEAR          PIC 99.
  3221             20  DC-CYMD-MONTH         PIC 99.
  3222             20  DC-CYMD-DAY           PIC 99.
  3223         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3224         16  DC-GREG-DATE-MDCY-R REDEFINES
  3225                              DC-GREG-DATE-MDCY.
  3226             20  DC-MDCY-MONTH         PIC 99.
  3227             20  DC-MDCY-DAY           PIC 99.
  3228             20  DC-MDCY-CEN           PIC 99.
  3229             20  DC-MDCY-YEAR          PIC 99.
  3230    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3231        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3232    12  DC-EL310-DATE                  PIC X(21).
  3233    12  FILLER                         PIC X(28).
  3234
  3235*                                COPY ELCDMO.
  3236******************************************************************
  3237*                                                                *
  3238*                                                                *
  3239*                            ELCDMO.                             *
  3240*                            VMOD=2.004                          *
  3241*                                                                *
  3242*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3243*        COMMUNICATION AREA                                      *
  3244*   FILE TYPE = NA                                               *
  3245*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3246*                                                                *
  3247******************************************************************
  3248 01  DMO-COMMUNICATION-AREA.
  3249     12  DM-RECORD-TYPE                  PIC  X(02).
  3250             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3251             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3252             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3253     12  DM-DIST-CODE                    PIC  X(04).
  3254     12  DM-MAIL-CODE                    PIC  X(05).
  3255     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3256     12  DM-INSURED-NAME                 PIC  X(30).
  3257     12  DM-CLAIM-NO                     PIC  X(07).
  3258     12  DM-CLAIM-TYPE                   PIC  X.
  3259
  3260     12  DM-STATUS-DATA-AREA.
  3261         16  DM-CLAIM-STATUS             PIC  X.
  3262             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3263             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3264             88  DM-CLOSED                        VALUE '3'.
  3265             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3266             88  DM-DEFAULT                       VALUE '9'.
  3267         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  61
* EL131.cbl
  3268******YYYYMMDD
  3269         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3270             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3271             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3272             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3273             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3274             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3275             88  DM-RE-OPENED                     VALUE 'R'.
  3276             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3277             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3278             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3279         16  DM-STAT-CARRIER             PIC X.
  3280
  3281     12  DM-DRAFT-DATA-AREA.
  3282         16  DM-PAYMENT-TYPE             PIC  X.
  3283             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3284         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3285         16  DM-PAYMENT-DATE             PIC  X(08).
  3286******YYYYMMDD
  3287         16  DM-CERT-NO                  PIC  X(11).
  3288         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3289         16  DM-CARRIER                  PIC  X.
  3290
  3291     12  DM-RETURN-CODE                  PIC  XX.
  3292*                                COPY ERCPDEF.
  3293******************************************************************
  3294*                                                                *
  3295*                                                                *
  3296*                            ERCPDEF.                            *
  3297*                                                                *
  3298*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3299*                                                                *
  3300*    FILE TYPE = VSAM,KSDS                                       *
  3301*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3302*                                                                *
  3303*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3304*                                                                *
  3305*    LOG = YES                                                   *
  3306*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3307******************************************************************
  3308*                   C H A N G E   L O G
  3309*
  3310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3311*-----------------------------------------------------------------
  3312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3313* EFFECTIVE    NUMBER
  3314*-----------------------------------------------------------------
  3315* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3316* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3317* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3318******************************************************************
  3319 01  PRODUCT-MASTER.
  3320    12  PD-RECORD-ID                 PIC X(02).
  3321        88  VALID-PD-ID                  VALUE 'PD'.
  3322    12  PD-CONTROL-PRIMARY.
  3323        16  PD-COMPANY-CD            PIC X.
  3324        16  PD-STATE                 PIC XX.
  3325        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  62
* EL131.cbl
  3326        16  PD-FILLER                PIC X(7).
  3327        16  PD-BEN-TYPE              PIC X.
  3328        16  PD-BEN-CODE              PIC XX.
  3329        16  PD-PROD-EXP-DT           PIC XX.
  3330    12  FILLER                       PIC X(50).
  3331    12  PD-PRODUCT-DATA OCCURS 8.
  3332        16  PD-PROD-CODE             PIC X.
  3333            88  PD-PROD-LIFE           VALUE 'L'.
  3334            88  PD-PROD-PROP           VALUE 'P'.
  3335            88  PD-PROD-AH             VALUE 'A'.
  3336            88  PD-PROD-IU             VALUE 'I'.
  3337            88  PD-PROD-GAP            VALUE 'G'.
  3338            88  PD-PROD-FAML           VALUE 'F'.
  3339        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3340        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3341        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3342        16  PD-MAX-TERM              PIC S999        COMP-3.
  3343        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3344        16  FILLER                   PIC X.
  3345        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3346        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3347        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3348        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3349        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3350        16  PD-REC-CRIT-PERIOD       PIC 99.
  3351        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3352            20  PD-RECURRING-YN      PIC X.
  3353            20  FILLER               PIC X.
  3354        16  PD-RTW-MOS               PIC 99.
  3355        16  PD-MAX-EXTENSION         PIC 99.
  3356        16  pd-ben-pct               pic sv999 comp-3.
  3357*       16  FILLER                   PIC XX.
  3358    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3359    12  PD-TERM-LIMITS OCCURS 15.
  3360        16  PD-LOW-TERM              PIC S999        COMP-3.
  3361        16  PD-HI-TERM               PIC S999        COMP-3.
  3362*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3363    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3364        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3365        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3366    12  PD-EARN-FACTORS.
  3367        16  FILLER OCCURS 15.
  3368            20  FILLER OCCURS 15.
  3369                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3370    12  PD-PRODUCT-DESC              PIC X(80).
  3371    12  PD-TRUNCATED                 PIC X.
  3372    12  FILLER                       PIC X(59).
  3373    12  PD-MAINT-INFORMATION.
  3374        16  PD-LAST-MAINT-DT         PIC X(02).
  3375        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3376        16  PD-LAST-MAINT-BY         PIC X(04).
  3377*                                COPY ELCCRTT.
  3378******************************************************************
  3379*                                                                *
  3380*                            ELCCRTT.                            *
  3381*                                                                *
  3382*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3383*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  63
* EL131.cbl
  3384*   FILE TYPE = VSAM,KSDS                                        *
  3385*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3386*                                                                *
  3387*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3388*                                                                *
  3389*   LOG = YES                                                    *
  3390*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3391******************************************************************
  3392*                   C H A N G E   L O G
  3393*
  3394* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3395*-----------------------------------------------------------------
  3396*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3397* EFFECTIVE    NUMBER
  3398*-----------------------------------------------------------------
  3399* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3400* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3401* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3402* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3403* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3404* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3405* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3406* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3407* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3408******************************************************************
  3409
  3410 01  CERTIFICATE-TRAILERS.
  3411     12  CS-RECORD-ID                      PIC XX.
  3412         88  VALID-CS-ID                      VALUE 'CS'.
  3413
  3414     12  CS-CONTROL-PRIMARY.
  3415         16  CS-COMPANY-CD                 PIC X.
  3416         16  CS-CARRIER                    PIC X.
  3417         16  CS-GROUPING                   PIC X(6).
  3418         16  CS-STATE                      PIC XX.
  3419         16  CS-ACCOUNT                    PIC X(10).
  3420         16  CS-CERT-EFF-DT                PIC XX.
  3421         16  CS-CERT-NO.
  3422             20  CS-CERT-PRIME             PIC X(10).
  3423             20  CS-CERT-SFX               PIC X.
  3424         16  CS-TRAILER-TYPE               PIC X.
  3425             88  COMM-TRLR           VALUE 'A'.
  3426             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3427             88  CERT-DATA-TRLR      VALUE 'C'.
  3428
  3429     12  CS-DATA-AREA                      PIC X(516).
  3430
  3431     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3432         16  CS-BANK-COMMISSION-AREA.
  3433             20  CS-BANK-COMMS       OCCURS 10.
  3434                 24  CS-AGT                PIC X(10).
  3435                 24  CS-COM-TYP            PIC X.
  3436                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3437                 24  CS-RECALC-LV-INDIC    PIC X.
  3438                 24  FILLER                PIC X(10).
  3439         16  FILLER                        PIC X(256).
  3440
  3441     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  64
* EL131.cbl
  3442****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3443         16  CS-MB-CLAIM-DATA OCCURS 24.
  3444             20  CS-CLAIM-NO               PIC X(7).
  3445             20  CS-CLAIM-TYPE             PIC X.
  3446                 88  CS-AH-CLM               VALUE 'A'.
  3447                 88  CS-IU-CLM               VALUE 'I'.
  3448                 88  CS-GP-CLM               VALUE 'G'.
  3449                 88  CS-LF-CLM               VALUE 'L'.
  3450                 88  CS-PR-CLM               VALUE 'P'.
  3451                 88  CS-FL-CLM               VALUE 'F'.
  3452             20  CS-INSURED-TYPE           PIC X.
  3453                 88  CS-PRIM-INSURED          VALUE 'P'.
  3454                 88  CS-CO-BORROWER           VALUE 'C'.
  3455             20  CS-BENEFIT-PERIOD         PIC 99.
  3456             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3457             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3458             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3459         16  FILLER                        PIC X(12).
  3460     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3461         16  CS-VIN-NUMBER                 PIC X(17).
  3462         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3463         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3464         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3465         16  cs-agent-name.
  3466             20  cs-agent-fname            pic x(20).
  3467             20  cs-agent-mi               pic x.
  3468             20  cs-agent-lname            pic x(25).
  3469         16  cs-license-no                 pic x(15).
  3470         16  cs-npn-number                 pic x(10).
  3471         16  cs-agent-edit-status          pic x.
  3472             88  cs-ae-refer-to-manager      value 'M'.
  3473             88  cs-ae-cover-sheet           value 'C'.
  3474             88  cs-ae-sig-form              value 'S'.
  3475             88  cs-ae-verified              value 'V'.
  3476             88  cs-unidentified-signature   value 'U'.
  3477             88  cs-cert-returned            value 'R'.
  3478             88  cs-accept-no-commission     value 'N'.
  3479         16  cs-year                       pic 9999.
  3480         16  cs-make                       pic x(20).
  3481         16  cs-model                      pic x(20).
  3482         16  cs-future                     pic x(20).
  3483         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3484         16  FILLER                        PIC X(356). *> was 420
  3485*        16  FILLER                        PIC X(496).
  3486
  3487****************************************************************
  3488*
  3489* Copyright (c) 2007-2013 Dell Inc.
  3490* All rights reserved.
  3491*
  3492****************************************************************
  3493 01  DFHEIV.
  3494   02  DFHEIV0               PIC X(35).
  3495   02  DFHEIV1               PIC X(08).
  3496   02  DFHEIV2               PIC X(08).
  3497   02  DFHEIV3               PIC X(08).
  3498   02  DFHEIV4               PIC X(06).
  3499   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  65
* EL131.cbl
  3500   02  DFHEIV6               PIC X(04).
  3501   02  DFHEIV7               PIC X(02).
  3502   02  DFHEIV8               PIC X(02).
  3503   02  DFHEIV9               PIC X(01).
  3504   02  DFHEIV10              PIC S9(7) COMP-3.
  3505   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3506   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3507   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3508   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3509   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3510   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3511   02  DFHEIV17              PIC X(04).
  3512   02  DFHEIV18              PIC X(04).
  3513   02  DFHEIV19              PIC X(04).
  3514   02  DFHEIV20              USAGE IS POINTER.
  3515   02  DFHEIV21              USAGE IS POINTER.
  3516   02  DFHEIV22              USAGE IS POINTER.
  3517   02  DFHEIV23              USAGE IS POINTER.
  3518   02  DFHEIV24              USAGE IS POINTER.
  3519   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3520   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3521   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3522   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3523   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3524   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3525   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3526   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3527   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3528   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3529   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3530   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3531   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3532   02  FILLER                PIC X(02).
  3533   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3534   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3535   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3536   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3537   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3538   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3539   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3540 LINKAGE  SECTION.
  3541*****************************************************************
  3542*                                                               *
  3543* Copyright (c) 2007-2013 Dell Inc.                             *
  3544* All rights reserved.                                          *
  3545*                                                               *
  3546*****************************************************************
  3547 01  dfheiblk.
  3548     02  eibtime          pic s9(7) comp-3.
  3549     02  eibdate          pic s9(7) comp-3.
  3550     02  eibtrnid         pic x(4).
  3551     02  eibtaskn         pic s9(7) comp-3.
  3552     02  eibtrmid         pic x(4).
  3553     02  dfheigdi         pic s9(4) comp.
  3554     02  eibcposn         pic s9(4) comp.
  3555     02  eibcalen         pic s9(4) comp.
  3556     02  eibaid           pic x(1).
  3557     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  66
* EL131.cbl
  3558     02  eibfn            pic x(2).
  3559     02  eibfiller2       pic x(2).
  3560     02  eibrcode         pic x(6).
  3561     02  eibfiller3       pic x(2).
  3562     02  eibds            pic x(8).
  3563     02  eibreqid         pic x(8).
  3564     02  eibrsrce         pic x(8).
  3565     02  eibsync          pic x(1).
  3566     02  eibfree          pic x(1).
  3567     02  eibrecv          pic x(1).
  3568     02  eibsend          pic x(1).
  3569     02  eibatt           pic x(1).
  3570     02  eibeoc           pic x(1).
  3571     02  eibfmh           pic x(1).
  3572     02  eibcompl         pic x(1).
  3573     02  eibsig           pic x(1).
  3574     02  eibconf          pic x(1).
  3575     02  eiberr           pic x(1).
  3576     02  eibrldbk         pic x(1).
  3577     02  eiberrcd         pic x(4).
  3578     02  eibsynrb         pic x(1).
  3579     02  eibnodat         pic x(1).
  3580     02  eibfiller5       pic x(2).
  3581     02  eibresp          pic s9(8) comp.
  3582     02  eibresp2         pic s9(8) comp.
  3583     02  dfheigdj         pic s9(4) comp.
  3584     02  dfheigdk         pic s9(4) comp.
  3585 01  DFHCOMMAREA                 PIC X(1024).
  3586
  3587*                                COPY ELCMSTR.
  3588******************************************************************
  3589*                                                                *
  3590*                            ELCMSTR.                            *
  3591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3592*                            VMOD=2.012                          *
  3593*                                                                *
  3594*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3595*                                                                *
  3596*   FILE TYPE = VSAM,KSDS                                        *
  3597*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3598*                                                                *
  3599*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3600*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3601*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3602*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3603*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3604*                                                 RKP=75,LEN=21  *
  3605*                                                                *
  3606*   **** NOTE ****                                               *
  3607*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3608*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3609*                                                                *
  3610*   LOG = YES                                                    *
  3611*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3612******************************************************************
  3613*                   C H A N G E   L O G
  3614*
  3615* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  67
* EL131.cbl
  3616*-----------------------------------------------------------------
  3617*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3618* EFFECTIVE    NUMBER
  3619*-----------------------------------------------------------------
  3620* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3621* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3622* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3623* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3624* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3625******************************************************************
  3626 01  CLAIM-MASTER.
  3627     12  CL-RECORD-ID                PIC XX.
  3628         88  VALID-CL-ID         VALUE 'CL'.
  3629
  3630     12  CL-CONTROL-PRIMARY.
  3631         16  CL-COMPANY-CD           PIC X.
  3632         16  CL-CARRIER              PIC X.
  3633         16  CL-CLAIM-NO             PIC X(7).
  3634         16  CL-CERT-NO.
  3635             20  CL-CERT-PRIME       PIC X(10).
  3636             20  CL-CERT-SFX         PIC X.
  3637
  3638     12  CL-CONTROL-BY-NAME.
  3639         16  CL-COMPANY-CD-A1        PIC X.
  3640         16  CL-INSURED-LAST-NAME    PIC X(15).
  3641         16  CL-INSURED-NAME.
  3642             20  CL-INSURED-1ST-NAME PIC X(12).
  3643             20  CL-INSURED-MID-INIT PIC X.
  3644
  3645     12  CL-CONTROL-BY-SSN.
  3646         16  CL-COMPANY-CD-A2        PIC X.
  3647         16  CL-SOC-SEC-NO.
  3648             20  CL-SSN-STATE        PIC XX.
  3649             20  CL-SSN-ACCOUNT      PIC X(6).
  3650             20  CL-SSN-LN3          PIC X(3).
  3651
  3652     12  CL-CONTROL-BY-CERT-NO.
  3653         16  CL-COMPANY-CD-A4        PIC X.
  3654         16  CL-CERT-NO-A4.
  3655             20  CL-CERT-A4-PRIME    PIC X(10).
  3656             20  CL-CERT-A4-SFX      PIC X.
  3657
  3658     12  CL-CONTROL-BY-CCN.
  3659         16  CL-COMPANY-CD-A5        PIC X.
  3660         16  CL-CCN-A5.
  3661             20  CL-CCN.
  3662                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3663                 24  CL-CCN-PRIME-A5 PIC X(12).
  3664             20  CL-CCN-FILLER-A5    PIC X(4).
  3665
  3666     12  CL-INSURED-PROFILE-DATA.
  3667         16  CL-INSURED-BIRTH-DT     PIC XX.
  3668         16  CL-INSURED-SEX-CD       PIC X.
  3669             88  INSURED-IS-MALE        VALUE 'M'.
  3670             88  INSURED-IS-FEMALE      VALUE 'F'.
  3671             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3672         16  CL-INSURED-OCC-CD       PIC X(6).
  3673         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  68
* EL131.cbl
  3674
  3675     12  CL-PROCESSING-INFO.
  3676         16  CL-PROCESSOR-ID         PIC X(4).
  3677         16  CL-CLAIM-STATUS         PIC X.
  3678             88  CLAIM-IS-OPEN          VALUE 'O'.
  3679             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3680         16  CL-CLAIM-TYPE           PIC X.
  3681*            88  AH-CLAIM               VALUE 'A'.
  3682*            88  LIFE-CLAIM             VALUE 'L'.
  3683*            88  PROPERTY-CLAIM         VALUE 'P'.
  3684*            88  IUI-CLAIM              VALUE 'I'.
  3685*            88  GAP-CLAIM              VALUE 'G'.
  3686*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3687         16  CL-CLAIM-PREM-TYPE      PIC X.
  3688             88  SINGLE-PREMIUM         VALUE '1'.
  3689             88  O-B-COVERAGE           VALUE '2'.
  3690             88  OPEN-END-COVERAGE      VALUE '3'.
  3691         16  CL-INCURRED-DT          PIC XX.
  3692         16  CL-REPORTED-DT          PIC XX.
  3693         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3694         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3695         16  CL-LAST-PMT-DT          PIC XX.
  3696         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3697         16  CL-PAID-THRU-DT         PIC XX.
  3698         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3699         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3700         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3701         16  CL-PMT-CALC-METHOD      PIC X.
  3702             88  CL-360-DAY-YR          VALUE '1'.
  3703             88  CL-365-DAY-YR          VALUE '2'.
  3704             88  CL-FULL-MONTHS         VALUE '3'.
  3705         16  CL-CAUSE-CD             PIC X(6).
  3706
  3707         16  CL-PRIME-CERT-NO.
  3708             20  CL-PRIME-CERT-PRIME PIC X(10).
  3709             20  CL-PRIME-CERT-SFX   PIC X.
  3710
  3711         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3712             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3713             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3714
  3715         16  CL-MICROFILM-NO         PIC X(10).
  3716         16  FILLER REDEFINES CL-MICROFILM-NO.
  3717             20  CL-BENEFIT-PERIOD   PIC 99.
  3718             20  FILLER              PIC X(8).
  3719         16  CL-PROG-FORM-TYPE       PIC X.
  3720         16  CL-LAST-ADD-ON-DT       PIC XX.
  3721
  3722         16  CL-LAST-REOPEN-DT       PIC XX.
  3723         16  CL-LAST-CLOSE-DT        PIC XX.
  3724         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3725             88  FINAL-PAID             VALUE '1'.
  3726             88  CLAIM-DENIED           VALUE '2'.
  3727             88  AUTO-CLOSE             VALUE '3'.
  3728             88  MANUAL-CLOSE           VALUE '4'.
  3729             88  BENEFITS-CHANGED       VALUE 'C'.
  3730             88  SETUP-ERRORS           VALUE 'E'.
  3731         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  69
* EL131.cbl
  3732         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3733         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3734             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3735         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3736         16  FILLER                  PIC X.
  3737
  3738     12  CL-CERTIFICATE-DATA.
  3739         16  CL-CERT-ORIGIN          PIC X.
  3740             88  CERT-WAS-ONLINE        VALUE '1'.
  3741             88  CERT-WAS-CREATED       VALUE '2'.
  3742             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3743         16  CL-CERT-KEY-DATA.
  3744             20  CL-CERT-CARRIER     PIC X.
  3745             20  CL-CERT-GROUPING    PIC X(6).
  3746             20  CL-CERT-STATE       PIC XX.
  3747             20  CL-CERT-ACCOUNT.
  3748                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3749                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3750             20  CL-CERT-EFF-DT      PIC XX.
  3751
  3752     12  CL-STATUS-CONTROLS.
  3753         16  CL-PRIORITY-CD          PIC X.
  3754             88  CONFIDENTIAL-DATA      VALUE '8'.
  3755             88  HIGHEST-PRIORITY       VALUE '9'.
  3756         16  CL-SUPV-ATTN-CD         PIC X.
  3757             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3758             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3759         16  CL-PURGED-DT            PIC XX.
  3760         16  CL-RESTORED-DT          PIC XX.
  3761         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3762         16  CL-NEXT-RESEND-DT       PIC XX.
  3763         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3764         16  CL-CRITICAL-PERIOD      PIC 99.
  3765*        16  FILLER                  PIC XX.
  3766         16  CL-LAST-MAINT-DT        PIC XX.
  3767         16  CL-LAST-MAINT-USER      PIC X(4).
  3768         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3769         16  CL-LAST-MAINT-TYPE      PIC X.
  3770             88  CLAIM-SET-UP           VALUE ' '.
  3771             88  PAYMENT-MADE           VALUE '1'.
  3772             88  LETTER-SENT            VALUE '2'.
  3773             88  MASTER-WAS-ALTERED     VALUE '3'.
  3774             88  MASTER-WAS-RESTORED    VALUE '4'.
  3775             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3776             88  FILE-CONVERTED         VALUE '6'.
  3777             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3778             88  ERROR-CORRECTION       VALUE 'E'.
  3779         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3780         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3781         16  CL-BENEFICIARY          PIC X(10).
  3782         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3783         16  CL-DENIAL-TYPE          PIC X.
  3784             88  CL-TYPE-DENIAL          VALUE '1'.
  3785             88  CL-TYPE-RESCISSION      VALUE '2'.
  3786             88  CL-TYPE-REFORMATION     VALUE '3'.
  3787             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3788             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3789         16  filler                  pic x(5).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  70
* EL131.cbl
  3790*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3791*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3792*        16  CL-RTW-DT               PIC XX.
  3793
  3794     12  CL-TRAILER-CONTROLS.
  3795         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3796             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3797             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3798             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3799         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3800         16  FILLER                  PIC XX.
  3801         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3802         16  CL-ADDRESS-TRAILER-CNT.
  3803             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3804                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3805             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3806                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3807             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3808                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3809             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3810                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3811             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3812                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3813             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3814                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3815             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3816                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3817
  3818     12  CL-CV-REFERENCE-NO.
  3819         16  CL-CV-REFNO-PRIME       PIC X(18).
  3820         16  CL-CV-REFNO-SFX         PIC XX.
  3821
  3822     12  CL-FILE-LOCATION            PIC X(4).
  3823
  3824     12  CL-PROCESS-ERRORS.
  3825         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3826             88  NO-FATAL-ERRORS        VALUE ZERO.
  3827         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3828             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3829
  3830     12  CL-PRODUCT-CD               PIC X.
  3831
  3832     12  CL-CURRENT-KEY-DATA.
  3833         16  CL-CURRENT-CARRIER      PIC X.
  3834         16  CL-CURRENT-GROUPING     PIC X(6).
  3835         16  CL-CURRENT-STATE        PIC XX.
  3836         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3837
  3838     12  CL-ASSOCIATES               PIC X.
  3839         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3840         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3841         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3842         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3843
  3844     12  CL-ACTIVITY-CODE            PIC 99.
  3845     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3846     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3847
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  71
* EL131.cbl
  3848     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3849     12  CL-LAG-REPORT-CODE          PIC 9.
  3850     12  CL-LOAN-TYPE                PIC XX.
  3851     12  CL-LEGAL-STATE              PIC XX.
  3852
  3853     12  CL-YESNOSW                  PIC X.
  3854     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3855         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3856         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3857         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3858     12  cl-insured-type             pic x.
  3859         88  cl-claim-on-primary         value 'P'.
  3860         88  cl-claim-on-co-borrower     value 'C'.
  3861     12  cl-benefit-expiration-dt    PIC XX.
  3862
  3863*                                COPY ELCCERT.
  3864******************************************************************
  3865*                                                                *
  3866*                            ELCCERT.                            *
  3867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3868*                            VMOD=2.013                          *
  3869*                                                                *
  3870*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3871*                                                                *
  3872*   FILE TYPE = VSAM,KSDS                                        *
  3873*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3874*                                                                *
  3875*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3876*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3877*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3878*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3879*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3880*                                                                *
  3881*   LOG = YES                                                    *
  3882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3883******************************************************************
  3884*                   C H A N G E   L O G
  3885*
  3886* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3887*-----------------------------------------------------------------
  3888*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3889* EFFECTIVE    NUMBER
  3890*-----------------------------------------------------------------
  3891* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3892* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3893* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3894* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3895* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3896* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3897* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3898* 032612  CR2011110200001  PEMA  AHL CHANGES
  3899* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3900* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3901******************************************************************
  3902
  3903 01  CERTIFICATE-MASTER.
  3904     12  CM-RECORD-ID                      PIC XX.
  3905         88  VALID-CM-ID                      VALUE 'CM'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  72
* EL131.cbl
  3906
  3907     12  CM-CONTROL-PRIMARY.
  3908         16  CM-COMPANY-CD                 PIC X.
  3909         16  CM-CARRIER                    PIC X.
  3910         16  CM-GROUPING.
  3911             20  CM-GROUPING-PREFIX        PIC X(3).
  3912             20  CM-GROUPING-PRIME         PIC X(3).
  3913         16  CM-STATE                      PIC XX.
  3914         16  CM-ACCOUNT.
  3915             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3916             20  CM-ACCOUNT-PRIME          PIC X(6).
  3917         16  CM-CERT-EFF-DT                PIC XX.
  3918         16  CM-CERT-NO.
  3919             20  CM-CERT-PRIME             PIC X(10).
  3920             20  CM-CERT-SFX               PIC X.
  3921
  3922     12  CM-CONTROL-BY-NAME.
  3923         16  CM-COMPANY-CD-A1              PIC X.
  3924         16  CM-INSURED-LAST-NAME          PIC X(15).
  3925         16  CM-INSURED-INITIALS.
  3926             20  CM-INSURED-INITIAL1       PIC X.
  3927             20  CM-INSURED-INITIAL2       PIC X.
  3928
  3929     12  CM-CONTROL-BY-SSN.
  3930         16  CM-COMPANY-CD-A2              PIC X.
  3931         16  CM-SOC-SEC-NO.
  3932             20  CM-SSN-STATE              PIC XX.
  3933             20  CM-SSN-ACCOUNT            PIC X(6).
  3934             20  CM-SSN-LN3.
  3935                 25  CM-INSURED-INITIALS-A2.
  3936                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3937                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3938                 25 CM-PART-LAST-NAME-A2         PIC X.
  3939
  3940     12  CM-CONTROL-BY-CERT-NO.
  3941         16  CM-COMPANY-CD-A4              PIC X.
  3942         16  CM-CERT-NO-A4                 PIC X(11).
  3943
  3944     12  CM-CONTROL-BY-MEMB.
  3945         16  CM-COMPANY-CD-A5              PIC X.
  3946         16  CM-MEMBER-NO.
  3947             20  CM-MEMB-STATE             PIC XX.
  3948             20  CM-MEMB-ACCOUNT           PIC X(6).
  3949             20  CM-MEMB-LN4.
  3950                 25  CM-INSURED-INITIALS-A5.
  3951                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3952                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3953                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3954
  3955     12  CM-INSURED-PROFILE-DATA.
  3956         16  CM-INSURED-FIRST-NAME.
  3957             20  CM-INSURED-1ST-INIT       PIC X.
  3958             20  FILLER                    PIC X(9).
  3959         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3960         16  CM-INSURED-SEX                PIC X.
  3961             88  CM-SEX-MALE                  VALUE 'M'.
  3962             88  CM-SEX-FEMAL                 VALUE 'F'.
  3963         16  CM-INSURED-JOINT-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  73
* EL131.cbl
  3964         16  CM-JOINT-INSURED-NAME.
  3965             20  CM-JT-LAST-NAME           PIC X(15).
  3966             20  CM-JT-FIRST-NAME.
  3967                 24  CM-JT-1ST-INIT        PIC X.
  3968                 24  FILLER                PIC X(9).
  3969             20  CM-JT-INITIAL             PIC X.
  3970
  3971     12  CM-LIFE-DATA.
  3972         16  CM-LF-BENEFIT-CD              PIC XX.
  3973         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3974         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3975         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3976         16  CM-LF-DEV-CODE                PIC XXX.
  3977         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3978         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3979         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3980         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3981         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3982         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3983         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3984         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3985         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3986         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3987         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3988         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3989         16  cm-temp-epiq                  pic xx.
  3990             88  EPIQ-CLASS                  value 'EQ'.
  3991*        16  FILLER                        PIC XX.
  3992
  3993     12  CM-AH-DATA.
  3994         16  CM-AH-BENEFIT-CD              PIC XX.
  3995         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3996         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3997         16  CM-AH-DEV-CODE                PIC XXX.
  3998         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3999         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4000         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4001         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4002         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4003         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4004         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4005         16  CM-AH-PAID-THRU-DT            PIC XX.
  4006             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4007         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4008         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4009         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4010         16  FILLER                        PIC X.
  4011
  4012     12  CM-LOAN-INFORMATION.
  4013         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4014         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4015                                           PIC S9(5)V99  COMP-3.
  4016         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4017         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4018         16  CM-PAY-FREQUENCY              PIC S99.
  4019         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4020         16  CM-RATE-CLASS                 PIC XX.
  4021         16  CM-BENEFICIARY                PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  74
* EL131.cbl
  4022         16  CM-POLICY-FORM-NO             PIC X(12).
  4023         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4024         16  CM-LAST-ADD-ON-DT             PIC XX.
  4025         16  CM-DEDUCTIBLE-AMOUNTS.
  4026             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4027             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4028         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4029             20  CM-RESIDENT-STATE         PIC XX.
  4030             20  CM-RATE-CODE              PIC X(4).
  4031             20  FILLER                    PIC XX.
  4032         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4033             20  CM-LOAN-OFFICER           PIC X(5).
  4034             20  FILLER                    PIC XXX.
  4035         16  CM-CSR-CODE                   PIC XXX.
  4036         16  CM-UNDERWRITING-CODE          PIC X.
  4037             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4038         16  CM-POST-CARD-IND              PIC X.
  4039         16  CM-NH-INTERFACE-SW            PIC X.
  4040         16  CM-PREMIUM-TYPE               PIC X.
  4041             88  CM-SING-PRM                  VALUE '1'.
  4042             88  CM-O-B-COVERAGE              VALUE '2'.
  4043             88  CM-OPEN-END                  VALUE '3'.
  4044         16  CM-IND-GRP-TYPE               PIC X.
  4045             88  CM-INDIVIDUAL                VALUE 'I'.
  4046             88  CM-GROUP                     VALUE 'G'.
  4047         16  CM-SKIP-CODE                  PIC X.
  4048             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4049             88  SKIP-JULY                    VALUE '1'.
  4050             88  SKIP-AUGUST                  VALUE '2'.
  4051             88  SKIP-SEPTEMBER               VALUE '3'.
  4052             88  SKIP-JULY-AUG                VALUE '4'.
  4053             88  SKIP-AUG-SEPT                VALUE '5'.
  4054             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4055             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4056             88  SKIP-JUNE                    VALUE '8'.
  4057             88  SKIP-JUNE-JULY               VALUE '9'.
  4058             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4059             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4060         16  CM-PAYMENT-MODE               PIC X.
  4061             88  PAY-MONTHLY                  VALUE SPACE.
  4062             88  PAY-WEEKLY                   VALUE '1'.
  4063             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4064             88  PAY-BI-WEEKLY                VALUE '3'.
  4065             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4066         16  CM-LOAN-NUMBER                PIC X(8).
  4067         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4068         16  CM-OLD-LOF                    PIC XXX.
  4069*        16  CM-LOAN-OFFICER               PIC XXX.
  4070         16  CM-REIN-TABLE                 PIC XXX.
  4071         16  CM-SPECIAL-REIN-CODE          PIC X.
  4072         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4073         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4074         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4075
  4076     12  CM-STATUS-DATA.
  4077         16  CM-ENTRY-STATUS               PIC X.
  4078         16  CM-ENTRY-DT                   PIC XX.
  4079
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  75
* EL131.cbl
  4080         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4081         16  CM-LF-CANCEL-DT               PIC XX.
  4082         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4083
  4084         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4085         16  CM-LF-DEATH-DT                PIC XX.
  4086         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4087
  4088         16  CM-LF-CURRENT-STATUS          PIC X.
  4089             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4090                                                'M' '4' '5' '9'.
  4091             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4092             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4093             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4094             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4095             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4096             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4097             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4098             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4099             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4100             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4101             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4102             88  CM-LF-DECLINED               VALUE 'D'.
  4103             88  CM-LF-VOIDED                 VALUE 'V'.
  4104
  4105         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4106         16  CM-AH-CANCEL-DT               PIC XX.
  4107         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4108
  4109         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4110         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4111         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4112
  4113         16  CM-AH-CURRENT-STATUS          PIC X.
  4114             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4115                                                'M' '4' '5' '9'.
  4116             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4117             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4118             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4119             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4120             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4121             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4122             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4123             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4124             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4125             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4126             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4127             88  CM-AH-DECLINED               VALUE 'D'.
  4128             88  CM-AH-VOIDED                 VALUE 'V'.
  4129
  4130         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4131             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4132             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4133             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4134         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4135
  4136         16  CM-ENTRY-BATCH                PIC X(6).
  4137         16  CM-LF-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  76
* EL131.cbl
  4138         16  CM-AH-EXIT-BATCH              PIC X(6).
  4139         16  CM-LAST-MONTH-END             PIC XX.
  4140
  4141     12  CM-NOTE-SW                        PIC X.
  4142         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4143         88  CERT-NOTES-PRESENT               VALUE '1'.
  4144         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4145         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4146         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4147         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4148         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4149         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4150     12  CM-COMP-EXCP-SW                   PIC X.
  4151         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4152         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4153     12  CM-INSURED-ADDRESS-SW             PIC X.
  4154         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4155         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4156
  4157*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4158     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4159     12  FILLER                            PIC X.
  4160
  4161*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4162     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4163     12  FILLER                            PIC X.
  4164*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4165     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4166
  4167     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4168         88  CERT-ADDED-BATCH                 VALUE ' '.
  4169         88  CERT-ADDED-ONLINE                VALUE '1'.
  4170         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4171         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4172         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4173     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4174         88  CERT-AS-LOADED                   VALUE ' '.
  4175         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4176         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4177         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4178         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4179         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4180         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4181         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4182
  4183     12  CM-ACCOUNT-COMM-PCTS.
  4184         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4185         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4186
  4187     12  CM-USER-FIELD                     PIC X.
  4188     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4189     12  CM-CLP-STATE                      PIC XX.
  4190     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4191     12  CM-USER-RESERVED                  PIC XXX.
  4192     12  FILLER REDEFINES CM-USER-RESERVED.
  4193         16  CM-AH-CLASS-CD                PIC XX.
  4194         16  F                             PIC X.
  4195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  77
* EL131.cbl
  4196
  4197*                                COPY ELCTRLR.
  4198******************************************************************
  4199*                                                                *
  4200*                            ELCTRLR.                            *
  4201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4202*                            VMOD=2.014                          *
  4203*                                                                *
  4204*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4205*                                                                *
  4206*   FILE TYPE = VSAM,KSDS                                        *
  4207*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4208*                                                                *
  4209*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4210*       ALTERNATE INDEX = NONE                                   *
  4211*                                                                *
  4212*   LOG = YES                                                    *
  4213*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4214******************************************************************
  4215*                   C H A N G E   L O G
  4216*
  4217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4218*-----------------------------------------------------------------
  4219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4220* EFFECTIVE    NUMBER
  4221*-----------------------------------------------------------------
  4222* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4223* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4224* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4225* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4226* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4227* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4228* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4229* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4230* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4231* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4232* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4233* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4234* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4235* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4236* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4237* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4238* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4239* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4240* 040814    2014030500002  AJRA  ADD ICD CODES
  4241* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4242* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4243* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4244******************************************************************
  4245 01  ACTIVITY-TRAILERS.
  4246     12  AT-RECORD-ID                    PIC XX.
  4247         88  VALID-AT-ID                       VALUE 'AT'.
  4248
  4249     12  AT-CONTROL-PRIMARY.
  4250         16  AT-COMPANY-CD               PIC X.
  4251         16  AT-CARRIER                  PIC X.
  4252         16  AT-CLAIM-NO                 PIC X(7).
  4253         16  AT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  78
* EL131.cbl
  4254             20  AT-CERT-PRIME           PIC X(10).
  4255             20  AT-CERT-SFX             PIC X.
  4256         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4257             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4258             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4259             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4260             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4261             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4262             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4263             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4264             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4265             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4266             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4267             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4268             88  AT-BENEFICIARY-TRL           VALUE +91.
  4269             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4270             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4271             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4272             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4273
  4274     12  AT-TRAILER-TYPE                 PIC X.
  4275         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4276         88  PAYMENT-TR                       VALUE '2'.
  4277         88  AUTO-PAY-TR                      VALUE '3'.
  4278         88  CORRESPONDENCE-TR                VALUE '4'.
  4279         88  ADDRESS-TR                       VALUE '5'.
  4280         88  GENERAL-INFO-TR                  VALUE '6'.
  4281         88  AUTO-PROMPT-TR                   VALUE '7'.
  4282         88  DENIAL-TR                        VALUE '8'.
  4283         88  INCURRED-CHG-TR                  VALUE '9'.
  4284         88  FORM-CONTROL-TR                  VALUE 'A'.
  4285
  4286     12  AT-RECORDED-DT                  PIC XX.
  4287     12  AT-RECORDED-BY                  PIC X(4).
  4288     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4289
  4290     12  AT-TRAILER-BODY                 PIC X(165).
  4291
  4292     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4293         16  AT-RESERVE-CONTROLS.
  4294             20  AT-MANUAL-SW            PIC X.
  4295                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4296             20  AT-FUTURE-SW            PIC X.
  4297                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4298             20  AT-PTC-SW               PIC X.
  4299                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4300             20  AT-IBNR-SW              PIC X.
  4301                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4302             20  AT-PTC-LF-SW            PIC X.
  4303                 88  AT-LF-PTC-USED          VALUE '1'.
  4304             20  AT-CDT-ACCESS-METHOD    PIC X.
  4305                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4306                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4307                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4308             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4309         16  AT-LAST-COMPUTED-DT         PIC XX.
  4310         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4311         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  79
* EL131.cbl
  4312         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4313         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4314         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4315         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4316         16  AT-EXPENSE-CONTROLS.
  4317             20  AT-EXPENSE-METHOD       PIC X.
  4318                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4319                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4320                 88  PERCENT-OF-PMT           VALUE '3'.
  4321                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4322             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4323             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4324         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4325         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4326
  4327         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4328         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4329
  4330*        16  FILLER                      PIC X(53).
  4331         16  FILLER                      PIC X(47).
  4332
  4333         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4334         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4335
  4336         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4337             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4338             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4339*                    C = CLOSED
  4340*                    O = OPEN
  4341             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4342*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4343
  4344     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4345         16  AT-PAYMENT-TYPE             PIC X.
  4346             88  PARTIAL-PAYMENT                VALUE '1'.
  4347             88  FINAL-PAYMENT                  VALUE '2'.
  4348             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4349             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4350             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4351             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4352             88  VOIDED-PAYMENT                 VALUE '9'.
  4353             88  TRANSFER                       VALUE 'T'.
  4354             88  LIFE-INTEREST                  VALUE 'I'.
  4355
  4356         16  AT-CLAIM-TYPE               PIC X.
  4357             88  PAID-FOR-AH                    VALUE 'A'.
  4358             88  PAID-FOR-LIFE                  VALUE 'L'.
  4359             88  PAID-FOR-IUI                   VALUE 'I'.
  4360             88  PAID-FOR-GAP                   VALUE 'G'.
  4361             88  PAID-FOR-FAM                   VALUE 'F'.
  4362         16  AT-CLAIM-PREM-TYPE          PIC X.
  4363             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4364             88  AT-O-B-COVERAGE                VALUE '2'.
  4365             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4366         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4367         16  AT-CHECK-NO                 PIC X(7).
  4368         16  AT-PAID-FROM-DT             PIC XX.
  4369         16  AT-PAID-THRU-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  80
* EL131.cbl
  4370         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4371         16  AT-ACH-PAYMENT              PIC X.
  4372*        16  FILLER                      PIC X.
  4373         16  AT-PAYEES-NAME              PIC X(30).
  4374         16  AT-PAYMENT-ORIGIN           PIC X.
  4375             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4376             88  ONLINE-AUTO-PMT                VALUE '2'.
  4377             88  OFFLINE-PMT                    VALUE '3'.
  4378         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4379         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4380         16  AT-VOID-DATA.
  4381             20  AT-VOID-DT              PIC XX.
  4382*00144       20  AT-VOID-REASON          PIC X(30).
  4383             20  AT-VOID-REASON          PIC X(26).
  4384         16  AT-PMT-APPROVED-BY          PIC X(04).
  4385         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4386         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4387         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4388                                         PIC S99V9(5)  COMP-3.
  4389         16  AT-CREDIT-INTERFACE.
  4390             20  AT-PMT-SELECT-DT        PIC XX.
  4391                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4392             20  AT-PMT-ACCEPT-DT        PIC XX.
  4393                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4394             20  AT-VOID-SELECT-DT       PIC XX.
  4395                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4396             20  AT-VOID-ACCEPT-DT       PIC XX.
  4397                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4398
  4399         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4400                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4401                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4402         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4403
  4404         16  AT-FORCE-CONTROL            PIC X.
  4405             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4406         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4407         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4408         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4409         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4410         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4411         16  AT-BENEFIT-TYPE             PIC X.
  4412
  4413         16  AT-EXPENSE-TYPE             PIC X.
  4414         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4415
  4416         16  AT-PAYEE-TYPE-CD.
  4417             20  AT-PAYEE-TYPE           PIC X.
  4418                 88  INSURED-PAID           VALUE 'I'.
  4419                 88  BENEFICIARY-PAID       VALUE 'B'.
  4420                 88  ACCOUNT-PAID           VALUE 'A'.
  4421                 88  OTHER-1-PAID           VALUE 'O'.
  4422                 88  OTHER-2-PAID           VALUE 'Q'.
  4423                 88  DOCTOR-PAID            VALUE 'P'.
  4424                 88  EMPLOYER-PAID          VALUE 'E'.
  4425             20  AT-PAYEE-SEQ            PIC X.
  4426
  4427         16  AT-CASH-PAYMENT             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  81
* EL131.cbl
  4428         16  AT-GROUPED-PAYMENT          PIC X.
  4429         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4430         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4431         16  AT-APPROVED-LEVEL           PIC X.
  4432         16  AT-VOID-TYPE                PIC X.
  4433             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4434             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4435         16  AT-AIG-UNEMP-IND            PIC X.
  4436             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4437         16  AT-ASSOCIATES               PIC X.
  4438             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4439             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4440
  4441         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4442         16  AT-CV-PMT-CODE              PIC X.
  4443             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4444             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4445             88  FULL-ADD-PAYMENT           VALUE '3'.
  4446             88  HALF-ADD-PAYMENT           VALUE '4'.
  4447             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4448             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4449             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4450             88  ADDL-PAYMENT               VALUE '8'.
  4451
  4452         16  AT-EOB-CODE1                PIC XXX.
  4453         16  AT-EOB-CODE2                PIC XXX.
  4454         16  AT-EOB-CODE3                PIC XXX.
  4455         16  FILLER REDEFINES AT-EOB-CODE3.
  4456             20  AT-PRINT-CLM-FORM       PIC X.
  4457             20  AT-PRINT-SURVEY         PIC X.
  4458             20  AT-SPECIAL-RELEASE      PIC X.
  4459         16  AT-EOB-CODE4                PIC XXX.
  4460         16  FILLER REDEFINES AT-EOB-CODE4.
  4461             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4462             20  FILLER                  PIC X.
  4463         16  AT-EOB-CODE5                PIC XXX.
  4464         16  FILLER REDEFINES AT-EOB-CODE5.
  4465             20  AT-PMT-PROOF-DT         PIC XX.
  4466             20  FILLER                  PIC X.
  4467
  4468         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4469             88  AT-PRINT-EOB            VALUE 'Y'.
  4470
  4471         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4472         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4473
  4474     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4475         16  AT-SCHEDULE-START-DT        PIC XX.
  4476         16  AT-SCHEDULE-END-DT          PIC XX.
  4477         16  AT-TERMINATED-DT            PIC XX.
  4478         16  AT-LAST-PMT-TYPE            PIC X.
  4479             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4480             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4481         16  AT-FIRST-PMT-DATA.
  4482             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4483             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4484             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4485         16  AT-REGULAR-PMT-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  82
* EL131.cbl
  4486             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4487             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4488             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4489         16  AT-AUTO-PAYEE-CD.
  4490             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4491                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4492                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4493                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4494                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4495                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4496             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4497         16  AT-AUTO-PAY-DAY             PIC 99.
  4498         16  AT-AUTO-CASH                PIC X.
  4499             88  AT-CASH                      VALUE 'Y'.
  4500             88  AT-NON-CASH                  VALUE 'N'.
  4501*        16  FILLER                      PIC X(129).
  4502         16  AT-AUTO-END-LETTER          PIC X(4).
  4503         16  FILLER                      PIC X(125).
  4504
  4505         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4506         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4507
  4508     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4509         16  AT-LETTER-SENT-DT           PIC XX.
  4510         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4511         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4512         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4513         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4514         16  AT-LETTER-ORIGIN            PIC X.
  4515             88  ONLINE-CREATION              VALUE '1' '3'.
  4516             88  OFFLINE-CREATION             VALUE '2' '4'.
  4517             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4518             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4519         16  AT-STD-LETTER-FORM          PIC X(4).
  4520         16  AT-REASON-TEXT              PIC X(70).
  4521         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4522         16  AT-ADDRESEE-TYPE            PIC X.
  4523              88  INSURED-ADDRESEE            VALUE 'I'.
  4524              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4525              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4526              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4527              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4528              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4529              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4530         16  AT-ADDRESSEE-NAME           PIC X(30).
  4531         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4532         16  AT-RESEND-PRINT-DATE        PIC XX.
  4533         16  AT-CORR-SOL-UNSOL           PIC X.
  4534         16  AT-LETTER-PURGED-DT         PIC XX.
  4535*
  4536*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4537*
  4538         16  AT-CSO-REDEFINITION.
  4539             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4540             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4541             20  AT-LETTER-TO-BENE       PIC X(1).
  4542             20  AT-STOP-LETTER-DT       PIC X(2).
  4543             20  AT-AUTH-RCVD            PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  83
* EL131.cbl
  4544             20  FILLER                  PIC X(18).
  4545*             20  FILLER                  PIC X(27).
  4546             20  AT-CSO-LETTER-STATUS    PIC X.
  4547                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4548                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4549                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4550             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4551             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4552*
  4553*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4554*
  4555*        16  FILLER                      PIC X(26).
  4556*
  4557*        16  AT-DMD-BSR-CODE             PIC X.
  4558*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4559*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4560*
  4561*        16  AT-DMD-LETTER-STATUS        PIC X.
  4562*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4563*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4564*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4565*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4566*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4567
  4568         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4569         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4570
  4571     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4572         16  AT-ADDRESS-TYPE             PIC X.
  4573             88  INSURED-ADDRESS               VALUE 'I'.
  4574             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4575             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4576             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4577             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4578             88  OTHER-ADDRESS-1               VALUE 'O'.
  4579             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4580         16  AT-MAIL-TO-NAME             PIC X(30).
  4581         16  AT-ADDRESS-LINE-1           PIC X(30).
  4582         16  AT-ADDRESS-LINE-2           PIC X(30).
  4583         16  AT-CITY-STATE.
  4584             20  AT-CITY                 PIC X(28).
  4585             20  AT-STATE                PIC XX.
  4586         16  AT-ZIP.
  4587             20  AT-ZIP-CODE.
  4588                 24  AT-ZIP-1ST          PIC X.
  4589                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4590                 24  FILLER              PIC X(4).
  4591             20  AT-ZIP-PLUS4            PIC X(4).
  4592         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4593             20  AT-CAN-POSTAL-1         PIC XXX.
  4594             20  AT-CAN-POSTAL-2         PIC XXX.
  4595             20  FILLER                  PIC XXX.
  4596         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4597*         16  FILLER                      PIC X(23).
  4598         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4599         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4600         16  FILLER                      PIC X(13).
  4601         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  84
* EL131.cbl
  4602         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4603
  4604     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4605         16  AT-INFO-LINE-1              PIC X(60).
  4606         16  FILLER REDEFINES AT-INFO-LINE-1.
  4607             20  AT-NOTE-ERROR-NO OCCURS 15
  4608                                         PIC X(4).
  4609         16  AT-INFO-LINE-2              PIC X(60).
  4610         16  FILLER REDEFINES AT-INFO-LINE-2.
  4611             20  AT-ICD-CODE-1           PIC X(8).
  4612             20  AT-ICD-CODE-2           PIC X(8).
  4613             20  FILLER                  PIC X(44).
  4614         16  AT-INFO-TRAILER-TYPE        PIC X.
  4615             88  AT-ERRORS-NOTE          VALUE 'E'.
  4616             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4617             88  AT-CALL-NOTE            VALUE 'C'.
  4618             88  AT-MAINT-NOTE           VALUE 'M'.
  4619             88  AT-CERT-CHANGE          VALUE 'X'.
  4620             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4621             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4622             88  AT-CERT-CANCELLED       VALUE 'T'.
  4623         16  AT-CALL-TYPE                PIC X.
  4624             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4625             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4626         16  AT-NOTE-CONTINUATION        PIC X.
  4627             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4628         16  AT-EOB-CODES-EXIST          PIC X.
  4629             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4630         16  FILLER                      PIC X(35).
  4631         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4632         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4633
  4634     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4635         16  AT-PROMPT-LINE-1            PIC X(60).
  4636         16  AT-PROMPT-LINE-2            PIC X(60).
  4637         16  AT-PROMPT-START-DT          PIC XX.
  4638         16  AT-PROMPT-END-DT            PIC XX.
  4639         16  FILLER                      PIC X(35).
  4640         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4641         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4642
  4643     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4644         16  AT-DENIAL-INFO-1            PIC X(60).
  4645         16  AT-DENIAL-INFO-2            PIC X(60).
  4646         16  AT-DENIAL-DT                PIC XX.
  4647         16  AT-RETRACTION-DT            PIC XX.
  4648         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4649*         16  FILLER                      PIC X(31).
  4650         16  AT-DENIAL-PROOF-DT          PIC XX.
  4651         16  FILLER                      PIC X(29).
  4652         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4653         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4654
  4655     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4656         16  AT-OLD-INCURRED-DT          PIC XX.
  4657         16  AT-OLD-REPORTED-DT          PIC XX.
  4658         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4659         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  85
* EL131.cbl
  4660         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4661         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4662         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4663         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4664         16  FILLER                      PIC X(26).
  4665         16  AT-OLD-DIAG-CODE            PIC X(6).
  4666         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4667         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4668         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4669         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4670         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4671         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4672         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4673         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4674         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4675         16  FILLER                      PIC X(9).
  4676         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4677
  4678     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4679         16  AT-FORM-SEND-ON-DT          PIC XX.
  4680         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4681         16  AT-FORM-RE-SEND-DT          PIC XX.
  4682         16  AT-FORM-ANSWERED-DT         PIC XX.
  4683         16  AT-FORM-PRINTED-DT          PIC XX.
  4684         16  AT-FORM-REPRINT-DT          PIC XX.
  4685         16  AT-FORM-TYPE                PIC X.
  4686             88  INITIAL-FORM                  VALUE '1'.
  4687             88  PROGRESS-FORM                 VALUE '2'.
  4688         16  AT-INSTRUCT-LN-1            PIC X(28).
  4689         16  AT-INSTRUCT-LN-2            PIC X(28).
  4690         16  AT-INSTRUCT-LN-3            PIC X(28).
  4691         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4692         16  AT-FORM-ADDRESS             PIC X.
  4693             88  FORM-TO-INSURED              VALUE 'I'.
  4694             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4695             88  FORM-TO-OTHER-1              VALUE 'O'.
  4696             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4697         16  AT-RELATED-1.
  4698             20 AT-REL-CARR-1            PIC X.
  4699             20 AT-REL-CLAIM-1           PIC X(7).
  4700             20 AT-REL-CERT-1            PIC X(11).
  4701         16  AT-RELATED-2.
  4702             20 AT-REL-CARR-2            PIC X.
  4703             20 AT-REL-CLAIM-2           PIC X(7).
  4704             20 AT-REL-CERT-2            PIC X(11).
  4705         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4706         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4707         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4708         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4709         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4710         16  AT-STOP-FORM-DT             PIC X(2).
  4711
  4712         16  FILLER                      PIC X(09).
  4713         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4714         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4715******************************************************************
  4716
  4717*                                COPY ELCCNTL.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  86
* EL131.cbl
  4718******************************************************************
  4719*                                                                *
  4720*                                                                *
  4721*                            ELCCNTL.                            *
  4722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4723*                            VMOD=2.059                          *
  4724*                                                                *
  4725*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4726*                                                                *
  4727*   FILE TYPE = VSAM,KSDS                                        *
  4728*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4729*                                                                *
  4730*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4731*       ALTERNATE INDEX = NONE                                   *
  4732*                                                                *
  4733*   LOG = YES                                                    *
  4734*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4735******************************************************************
  4736*                   C H A N G E   L O G
  4737*
  4738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4739*-----------------------------------------------------------------
  4740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4741* EFFECTIVE    NUMBER
  4742*-----------------------------------------------------------------
  4743* 082503                   PEMA  ADD BENEFIT GROUP
  4744* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4745* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4746* 092705    2005050300006  PEMA  ADD SPP LEASES
  4747* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4748* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4749* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4750* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4751* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4752* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4753* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4754* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4755* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4756* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4757******************************************************************
  4758*
  4759 01  CONTROL-FILE.
  4760     12  CF-RECORD-ID                       PIC XX.
  4761         88  VALID-CF-ID                        VALUE 'CF'.
  4762
  4763     12  CF-CONTROL-PRIMARY.
  4764         16  CF-COMPANY-ID                  PIC XXX.
  4765         16  CF-RECORD-TYPE                 PIC X.
  4766             88  CF-COMPANY-MASTER              VALUE '1'.
  4767             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4768             88  CF-STATE-MASTER                VALUE '3'.
  4769             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4770             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4771             88  CF-CARRIER-MASTER              VALUE '6'.
  4772             88  CF-MORTALITY-MASTER            VALUE '7'.
  4773             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4774             88  CF-TERMINAL-MASTER             VALUE '9'.
  4775             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  87
* EL131.cbl
  4776             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4777             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4778             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4779             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4780             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4781             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4782             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4783             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4784         16  CF-ACCESS-CD-GENL              PIC X(4).
  4785         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4786             20  CF-PROCESSOR               PIC X(4).
  4787         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4788             20  CF-STATE-CODE              PIC XX.
  4789             20  FILLER                     PIC XX.
  4790         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4791             20  FILLER                     PIC XX.
  4792             20  CF-HI-BEN-IN-REC           PIC XX.
  4793         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4794             20  FILLER                     PIC XXX.
  4795             20  CF-CARRIER-CNTL            PIC X.
  4796         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4797             20  FILLER                     PIC XX.
  4798             20  CF-HI-TYPE-IN-REC          PIC 99.
  4799         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4800             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4801                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4802             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4803             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4804         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4805             20  FILLER                     PIC X.
  4806             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4807         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4808             20  FILLER                     PIC XX.
  4809             20  CF-MORTGAGE-PLAN           PIC XX.
  4810         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4811
  4812     12  CF-LAST-MAINT-DT                   PIC XX.
  4813     12  CF-LAST-MAINT-BY                   PIC X(4).
  4814     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4815
  4816     12  CF-RECORD-BODY                     PIC X(728).
  4817
  4818
  4819****************************************************************
  4820*             COMPANY MASTER RECORD                            *
  4821****************************************************************
  4822
  4823     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4824         16  CF-COMPANY-ADDRESS.
  4825             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4826             20  CF-CL-IN-CARE-OF           PIC X(30).
  4827             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4828             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4829             20  CF-CL-CITY-STATE           PIC X(30).
  4830             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4831             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4832         16  CF-COMPANY-CD                  PIC X.
  4833         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  88
* EL131.cbl
  4834         16  CF-SECURITY-OPTION             PIC X.
  4835             88  ALL-SECURITY                   VALUE '1'.
  4836             88  COMPANY-VERIFY                 VALUE '2'.
  4837             88  PROCESSOR-VERIFY               VALUE '3'.
  4838             88  NO-SECURITY                    VALUE '4'.
  4839             88  ALL-BUT-TERM                   VALUE '5'.
  4840         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4841             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4842         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4843             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4844         16  CF-INFORCE-LOCATION            PIC X.
  4845             88  CERTS-ARE-ONLINE               VALUE '1'.
  4846             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4847             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4848         16  CF-LOWER-CASE-LETTERS          PIC X.
  4849         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4850             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4851             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4852             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4853             88  CF-ACCNT-CNTL                  VALUE '3'.
  4854             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4855
  4856         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4857         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4858
  4859         16  CF-LGX-CREDIT-USER             PIC X.
  4860             88  CO-IS-NOT-USER                 VALUE 'N'.
  4861             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4862
  4863         16 CF-CREDIT-CALC-CODES.
  4864             20  CF-CR-REM-TERM-CALC PIC X.
  4865               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4866               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4867               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4868               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4869               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4870               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4871               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4872             20  CF-CR-R78-METHOD           PIC X.
  4873               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4874               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4875
  4876         16  CF-CLAIM-CONTROL-COUNTS.
  4877             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4878                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4879
  4880             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4881                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4882
  4883             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4884                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4885
  4886             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4887                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4888
  4889         16  CF-CURRENT-MONTH-END           PIC XX.
  4890
  4891         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  89
* EL131.cbl
  4892             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4893             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4894             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4895             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4896                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4897                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4898             20  CF-CO-PREM-REJECT-SW       PIC X.
  4899                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4900                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4901             20  CF-CO-REF-REJECT-SW        PIC X.
  4902                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4903                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4904
  4905         16  CF-CO-REPORTING-DT             PIC XX.
  4906         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4907         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4908           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4909           88  CF-CO-MONTH-END                  VALUE '1'.
  4910
  4911         16  CF-LGX-CLAIM-USER              PIC X.
  4912             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4913             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4914
  4915         16  CF-CREDIT-EDIT-CONTROLS.
  4916             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4917             20  CF-MIN-AGE                 PIC 99.
  4918             20  CF-DEFAULT-AGE             PIC 99.
  4919             20  CF-MIN-TERM                PIC S999      COMP-3.
  4920             20  CF-MAX-TERM                PIC S999      COMP-3.
  4921             20  CF-DEFAULT-SEX             PIC X.
  4922             20  CF-JOINT-AGE-INPUT         PIC X.
  4923                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4924             20  CF-BIRTH-DATE-INPUT        PIC X.
  4925                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4926             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4927                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4928                 88  CF-ZERO-CARRIER            VALUE '1'.
  4929                 88  CF-ZERO-GROUPING           VALUE '2'.
  4930                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4931             20  CF-EDIT-SW                 PIC X.
  4932                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4933             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4934             20  CF-CR-PR-METHOD            PIC X.
  4935               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4936               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4937             20  FILLER                     PIC X.
  4938
  4939         16  CF-CREDIT-MISC-CONTROLS.
  4940             20  CF-REIN-TABLE-SW           PIC X.
  4941                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4942             20  CF-COMP-TABLE-SW           PIC X.
  4943                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4944             20  CF-EXPERIENCE-RETENTION-AGE
  4945                                            PIC S9        COMP-3.
  4946             20  CF-CONVERSION-DT           PIC XX.
  4947             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4948             20  CF-RUN-FREQUENCY-SW        PIC X.
  4949                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  90
* EL131.cbl
  4950                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4951
  4952             20  CF-CR-CHECK-NO-CONTROL.
  4953                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4954                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4955                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4956                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4957                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4958                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4959
  4960                 24  CF-CR-CHECK-COUNT       REDEFINES
  4961                     CF-CR-CHECK-COUNTER      PIC X(4).
  4962
  4963                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4964                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4965
  4966                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4967                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4968                 24  CF-MAIL-PROCESSING       PIC X.
  4969                     88  MAIL-PROCESSING          VALUE 'Y'.
  4970
  4971         16  CF-MISC-SYSTEM-CONTROL.
  4972             20  CF-SYSTEM-C                 PIC X.
  4973                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4974             20  CF-SYSTEM-D                 PIC X.
  4975                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4976             20  CF-SOC-SEC-NO-SW            PIC X.
  4977                 88  SOC-SEC-NO-USED             VALUE '1'.
  4978             20  CF-MEMBER-NO-SW             PIC X.
  4979                 88  MEMBER-NO-USED              VALUE '1'.
  4980             20  CF-TAX-ID-NUMBER            PIC X(11).
  4981             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4982             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4983                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4984                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4985                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4986                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4987             20  CF-SYSTEM-E                 PIC X.
  4988                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4989
  4990         16  CF-LGX-LIFE-USER               PIC X.
  4991             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4992             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4993
  4994         16  CF-CR-MONTH-END-DT             PIC XX.
  4995
  4996         16  CF-FILE-MAINT-DATES.
  4997             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4998                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4999             20  CF-LAST-BATCH       REDEFINES
  5000                 CF-LAST-BATCH-NO               PIC X(4).
  5001             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5002             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5003             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5004             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5005             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5006             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5007             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  91
* EL131.cbl
  5008             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5009             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5010             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5011
  5012         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5013         16  FILLER                         PIC X.
  5014
  5015         16  CF-ALT-MORT-CODE               PIC X(4).
  5016         16  CF-MEMBER-CAPTION              PIC X(10).
  5017
  5018         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5019             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5020             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5021             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5022             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5023             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5024
  5025         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5026
  5027         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5028         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5029         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5030         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5031
  5032         16  CF-AH-OVERRIDE-L1              PIC X.
  5033         16  CF-AH-OVERRIDE-L2              PIC XX.
  5034         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5035         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5036
  5037         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5038         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5039
  5040         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5041         16  CF-AR-LAST-EL860-DT            PIC XX.
  5042         16  CF-MP-MONTH-END-DT             PIC XX.
  5043
  5044         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5045         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5046             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5047
  5048         16  CF-AR-MONTH-END-DT             PIC XX.
  5049
  5050         16  CF-CRDTCRD-USER                PIC X.
  5051             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5052             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5053
  5054         16  CF-CC-MONTH-END-DT             PIC XX.
  5055
  5056         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5057
  5058         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5059             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5060             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5061             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5062         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5063         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5064         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5065         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  92
* EL131.cbl
  5066             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5067             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5068         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5069         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5070         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5071             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5072         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5073
  5074         16  CF-CL-ZIP-CODE.
  5075             20  CF-CL-ZIP-PRIME.
  5076                 24  CF-CL-ZIP-1ST          PIC X.
  5077                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5078                 24  FILLER                 PIC X(4).
  5079             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5080         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5081             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5082             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5083             20  FILLER                     PIC XXX.
  5084
  5085         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5086         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5087         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5088         16  CF-CO-OPTION-START-DATE        PIC XX.
  5089         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5090           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5091                                                      '3' '4'.
  5092           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5093           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5094           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5095           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5096           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5097           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5098
  5099         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5100
  5101         16  CF-PAYMENT-APPROVAL-LEVELS.
  5102             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5103             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5104             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5105             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5106             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5107             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5108
  5109         16  CF-END-USER-REPORTING-USER     PIC X.
  5110             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5111             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5112
  5113         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5114             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5115             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5116
  5117         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5118
  5119         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5120         16  FILLER                         PIC X.
  5121
  5122         16  CF-CREDIT-ARCHIVE-CNTL.
  5123             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  93
* EL131.cbl
  5124             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5125             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5126
  5127         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5128
  5129         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5130             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5131             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5132
  5133         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5134             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5135             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5136
  5137         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5138
  5139         16  CF-CO-ACH-ID-CODE              PIC  X.
  5140             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5141             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5142             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5143         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5144         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5145         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5146         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5147         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5148         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5149         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5150         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5151         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5152                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5153         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5154                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5155
  5156         16  CF-CO-OVER-SHORT.
  5157             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5158             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5159
  5160*         16  FILLER                         PIC X(102).
  5161         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5162             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5163             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5164
  5165         16  CF-AH-APPROVAL-DAYS.
  5166             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5167             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5168             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5169             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5170
  5171         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5172
  5173         16  CF-APPROV-LEV-5.
  5174             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5175             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5176             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5177
  5178         16  FILLER                         PIC X(68).
  5179****************************************************************
  5180*             PROCESSOR/USER RECORD                            *
  5181****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  94
* EL131.cbl
  5182
  5183     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5184         16  CF-PROCESSOR-NAME              PIC X(30).
  5185         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5186         16  CF-PROCESSOR-TITLE             PIC X(26).
  5187         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5188                 88  MESSAGE-YES                VALUE 'Y'.
  5189                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5190
  5191*****************************************************
  5192****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5193****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5194****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5195****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5196*****************************************************
  5197
  5198         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5199             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5200             20  CF-APPLICATION-FORCE       PIC X.
  5201             20  CF-INDIVIDUAL-APP.
  5202                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5203                     28  CF-BROWSE-APP      PIC X.
  5204                     28  CF-UPDATE-APP      PIC X.
  5205
  5206         16  CF-CURRENT-TERM-ON             PIC X(4).
  5207         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5208             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5209             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5210             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5211             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5212             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5213             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5214             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5215         16  CF-PROCESSOR-CARRIER           PIC X.
  5216             88  NO-CARRIER-SECURITY            VALUE ' '.
  5217         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5218             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5219         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5220             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5221         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5222             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5223
  5224         16  CF-PROC-SYS-ACCESS-SW.
  5225             20  CF-PROC-CREDIT-CLAIMS-SW.
  5226                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5227                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5228                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5229                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5230             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5231                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5232                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5233             20  CF-PROC-LIFE-GNRLDGR-SW.
  5234                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5235                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5236                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5237                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5238             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5239                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  95
* EL131.cbl
  5240                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5241         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5242             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5243             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5244         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5245
  5246         16  CF-APPROVAL-LEVEL                  PIC X.
  5247             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5248             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5249             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5250             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5251             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5252
  5253         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5254
  5255         16  CF-LANGUAGE-TYPE                   PIC X.
  5256             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5257             88  CF-LANG-IS-FR                      VALUE 'F'.
  5258
  5259         16  CF-CSR-IND                         PIC X.
  5260         16  FILLER                             PIC X(239).
  5261
  5262****************************************************************
  5263*             PROCESSOR/REMINDERS RECORD                       *
  5264****************************************************************
  5265
  5266     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5267         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5268             20  CF-START-REMIND-DT         PIC XX.
  5269             20  CF-END-REMIND-DT           PIC XX.
  5270             20  CF-REMINDER-TEXT           PIC X(50).
  5271         16  FILLER                         PIC X(296).
  5272
  5273
  5274****************************************************************
  5275*             STATE MASTER RECORD                              *
  5276****************************************************************
  5277
  5278     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5279         16  CF-STATE-ABBREVIATION          PIC XX.
  5280         16  CF-STATE-NAME                  PIC X(25).
  5281         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5282         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5283             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5284             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5285             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5286             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5287                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5288                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5289             20  CF-ST-PREM-REJECT-SW       PIC X.
  5290                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5291                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5292             20  CF-ST-REF-REJECT-SW        PIC X.
  5293                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5294                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5295         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5296         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5297         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  96
* EL131.cbl
  5298             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5299             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5300             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5301         16  CF-ST-FST-PMT-EXTENSION.
  5302             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5303             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5304                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5305                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5306                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5307                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5308         16  CF-ST-STATE-CALL.
  5309             20  CF-ST-CALL-UNEARNED        PIC X.
  5310             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5311             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5312         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5313             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5314             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5315         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5316         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5317         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5318         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5319         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5320         16  FILLER                         PIC X.
  5321         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5322             20  CF-ST-BENEFIT-CD           PIC XX.
  5323             20  CF-ST-BENEFIT-KIND         PIC X.
  5324                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5325                 88  CF-ST-AH-KIND              VALUE 'A'.
  5326             20  CF-ST-REM-TERM-CALC        PIC X.
  5327                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5328                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5329                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5330                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5331                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5332                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5333                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5334                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5335
  5336             20  CF-ST-REFUND-CALC          PIC X.
  5337                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5338                 88  ST-REFD-BY-R78             VALUE '1'.
  5339                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5340                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5341                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5342                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5343                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5344                 88  ST-REFD-UTAH               VALUE '7'.
  5345                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5346                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5347                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5348
  5349             20  CF-ST-EARNING-CALC         PIC X.
  5350                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5351                 88  ST-EARN-BY-R78             VALUE '1'.
  5352                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5353                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5354                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5355                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  97
* EL131.cbl
  5356                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5357                 88  ST-EARN-MEAN               VALUE '8'.
  5358                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5359
  5360             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5361                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5362                 88  ST-OVRD-BY-R78             VALUE '1'.
  5363                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5364                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5365                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5366                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5367                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5368                 88  ST-OVRD-MEAN               VALUE '8'.
  5369                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5370             20  cf-st-extra-periods        pic 9.
  5371*            20  FILLER                     PIC X.
  5372
  5373         16  CF-ST-COMMISSION-CAPS.
  5374             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5375             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5376             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5377             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5378         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5379                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5380
  5381         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5382
  5383         16  CF-ST-STATUTORY-INTEREST.
  5384             20  CF-ST-STAT-DATE-FROM       PIC X.
  5385                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5386                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5387             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5388             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5389             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5390             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5391             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5392
  5393         16  CF-ST-OVER-SHORT.
  5394             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5395             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5396
  5397         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5398
  5399         16  CF-ST-RT-CALC                  PIC X.
  5400
  5401         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5402         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5403         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5404         16  CF-ST-RF-LR-CALC               PIC X.
  5405         16  CF-ST-RF-LL-CALC               PIC X.
  5406         16  CF-ST-RF-LN-CALC               PIC X.
  5407         16  CF-ST-RF-AH-CALC               PIC X.
  5408         16  CF-ST-RF-CP-CALC               PIC X.
  5409*        16  FILLER                         PIC X(206).
  5410*CIDMOD         16  FILLER                         PIC X(192).
  5411         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5412             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5413         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  98
* EL131.cbl
  5414         16  CF-ST-VFY-2ND-BENE             PIC X.
  5415         16  CF-ST-CAUSAL-STATE             PIC X.
  5416         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5417         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5418         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5419             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5420         16  CF-ST-NET-ONLY-STATE           PIC X.
  5421             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5422         16  FILLER                         PIC X(181).
  5423
  5424****************************************************************
  5425*             BENEFIT MASTER RECORD                            *
  5426****************************************************************
  5427
  5428     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5430             20  CF-BENEFIT-CODE            PIC XX.
  5431             20  CF-BENEFIT-NUMERIC  REDEFINES
  5432                 CF-BENEFIT-CODE            PIC XX.
  5433             20  CF-BENEFIT-ALPHA           PIC XXX.
  5434             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5435             20  CF-BENEFIT-COMMENT         PIC X(10).
  5436
  5437             20  CF-LF-COVERAGE-TYPE        PIC X.
  5438                 88  CF-REDUCING                VALUE 'R'.
  5439                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5440
  5441             20  CF-SPECIAL-CALC-CD         PIC X.
  5442                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5443                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5444                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5445                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5446                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5447                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5448                 88  CF-FARM-PLAN               VALUE 'F'.
  5449                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5450                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5451                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5452                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5453                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5454                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5455                 88  CF-PRUDENTIAL              VALUE 'P'.
  5456                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5457                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5458                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5459                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5460                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5461                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5462
  5463             20  CF-JOINT-INDICATOR         PIC X.
  5464                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5465
  5466*            20  FILLER                     PIC X(12).
  5467             20  cf-maximum-benefits        pic s999 comp-3.
  5468             20  FILLER                     PIC X(09).
  5469             20  CF-BENEFIT-CATEGORY        PIC X.
  5470             20  CF-LOAN-TYPE               PIC X(8).
  5471
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page  99
* EL131.cbl
  5472             20  CF-CO-REM-TERM-CALC        PIC X.
  5473                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5474                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5475                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5476                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5477                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5478
  5479             20  CF-CO-EARNINGS-CALC        PIC X.
  5480                 88  CO-EARN-BY-R78             VALUE '1'.
  5481                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5482                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5483                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5484                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5485                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5486                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5487                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5488
  5489             20  CF-CO-REFUND-CALC          PIC X.
  5490                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5491                 88  CO-REFD-BY-R78             VALUE '1'.
  5492                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5493                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5494                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5495                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5496                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5497                 88  CO-REFD-MEAN               VALUE '8'.
  5498                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5499                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5500                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5501
  5502             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5503                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5504                 88  CO-OVRD-BY-R78             VALUE '1'.
  5505                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5506                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5507                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5508                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5509                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5510                 88  CO-OVRD-MEAN               VALUE '8'.
  5511                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5512
  5513             20  CF-CO-BEN-I-G-CD           PIC X.
  5514                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5515                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5516                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5517
  5518         16  FILLER                         PIC X(304).
  5519
  5520
  5521****************************************************************
  5522*             CARRIER MASTER RECORD                            *
  5523****************************************************************
  5524
  5525     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5526         16  CF-ADDRESS-DATA.
  5527             20  CF-MAIL-TO-NAME            PIC X(30).
  5528             20  CF-IN-CARE-OF              PIC X(30).
  5529             20  CF-ADDRESS-LINE-1          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 100
* EL131.cbl
  5530             20  CF-ADDRESS-LINE-2          PIC X(30).
  5531             20  CF-CITY-STATE              PIC X(30).
  5532             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5533             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5534
  5535         16  CF-CLAIM-NO-CONTROL.
  5536             20  CF-CLAIM-NO-METHOD         PIC X.
  5537                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5538                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5539                 88  CLAIM-NO-SEQ               VALUE '3'.
  5540                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5541             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5542                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5543                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5544                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5545
  5546         16  CF-CHECK-NO-CONTROL.
  5547             20  CF-CHECK-NO-METHOD         PIC X.
  5548                 88  CHECK-NO-MANUAL            VALUE '1'.
  5549                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5550                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5551                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5552             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5553                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5554
  5555         16  CF-DOMICILE-STATE              PIC XX.
  5556
  5557         16  CF-EXPENSE-CONTROLS.
  5558             20  CF-EXPENSE-METHOD          PIC X.
  5559                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5560                 88  DOLLARS-PER-PMT            VALUE '2'.
  5561                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5562                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5563             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5564             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5565
  5566         16  CF-CORRESPONDENCE-CONTROL.
  5567             20  CF-LETTER-RESEND-OPT       PIC X.
  5568                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5569                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5570             20  FILLER                     PIC X(4).
  5571
  5572         16  CF-RESERVE-CONTROLS.
  5573             20  CF-MANUAL-SW               PIC X.
  5574                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5575             20  CF-FUTURE-SW               PIC X.
  5576                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5577             20  CF-PTC-SW                  PIC X.
  5578                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5579             20  CF-IBNR-SW                 PIC X.
  5580                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5581             20  CF-PTC-LF-SW               PIC X.
  5582                 88  CF-LF-PTC-USED             VALUE '1'.
  5583             20  CF-CDT-ACCESS-METHOD       PIC X.
  5584                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5585                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5586                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5587             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 101
* EL131.cbl
  5588
  5589         16  CF-CLAIM-CALC-METHOD           PIC X.
  5590             88  360-PLUS-MONTHS                VALUE '1'.
  5591             88  365-PLUS-MONTHS                VALUE '2'.
  5592             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5593             88  360-DAILY                      VALUE '4'.
  5594             88  365-DAILY                      VALUE '5'.
  5595
  5596         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5597         16  FILLER                         PIC X(11).
  5598
  5599         16  CF-LIMIT-AMOUNTS.
  5600             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5601             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5602             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5603             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5604             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5605             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5606             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5607             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5608             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5609             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5610
  5611         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5612         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5613         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5614
  5615         16  CF-ZIP-CODE.
  5616             20  CF-ZIP-PRIME.
  5617                 24  CF-ZIP-1ST             PIC X.
  5618                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5619                 24  FILLER                 PIC X(4).
  5620             20  CF-ZIP-PLUS4               PIC X(4).
  5621         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5622             20  CF-CAN-POSTAL-1            PIC XXX.
  5623             20  CF-CAN-POSTAL-2            PIC XXX.
  5624             20  FILLER                     PIC XXX.
  5625
  5626         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5627         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5628         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5629
  5630         16  CF-RATING-SWITCH               PIC X.
  5631             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5632             88  CF-NO-RATING                   VALUE 'N'.
  5633
  5634         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5635
  5636         16  CF-CARRIER-OVER-SHORT.
  5637             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5638             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5639
  5640         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5641         16  CF-SECPAY-SWITCH               PIC X.
  5642             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5643             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5644         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5645         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 102
* EL131.cbl
  5646         16  FILLER                         PIC X(444).
  5647*        16  FILLER                         PIC X(452).
  5648
  5649
  5650****************************************************************
  5651*             MORTALITY MASTER RECORD                          *
  5652****************************************************************
  5653
  5654     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5655         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5656                                INDEXED BY CF-MORT-NDX.
  5657             20  CF-MORT-TABLE              PIC X(5).
  5658             20  CF-MORT-TABLE-TYPE         PIC X.
  5659                 88  CF-MORT-JOINT              VALUE 'J'.
  5660                 88  CF-MORT-SINGLE             VALUE 'S'.
  5661                 88  CF-MORT-COMBINED           VALUE 'C'.
  5662                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5663                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5664             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5665             20  CF-MORT-AGE-METHOD         PIC XX.
  5666                 88  CF-AGE-LAST                VALUE 'AL'.
  5667                 88  CF-AGE-NEAR                VALUE 'AN'.
  5668             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5669             20  CF-MORT-ADJUSTMENT-DIRECTION
  5670                                            PIC X.
  5671                 88  CF-MINUS                   VALUE '-'.
  5672                 88  CF-PLUS                    VALUE '+'.
  5673             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5674             20  CF-MORT-JOINT-CODE         PIC X.
  5675                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5676             20  CF-MORT-PC-Q               PIC X.
  5677                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5678             20  CF-MORT-TABLE-CODE         PIC X(4).
  5679             20  CF-MORT-COMMENTS           PIC X(15).
  5680             20  FILLER                     PIC X(14).
  5681
  5682         16  FILLER                         PIC X(251).
  5683
  5684
  5685****************************************************************
  5686*             BUSSINESS TYPE MASTER RECORD                     *
  5687****************************************************************
  5688
  5689     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5690* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5691* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5692* AND RECORD 05 IS TYPES 81-99
  5693         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5694             20  CF-BUSINESS-TITLE          PIC  X(19).
  5695             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5696                                            PIC S9V9(4) COMP-3.
  5697             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5698             20  FILLER                     PIC  X.
  5699         16  FILLER                         PIC  X(248).
  5700
  5701
  5702****************************************************************
  5703*             TERMINAL MASTER RECORD                           *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 103
* EL131.cbl
  5704****************************************************************
  5705
  5706     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5707
  5708         16  CF-COMPANY-TERMINALS.
  5709             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5710                                  PIC X(4).
  5711         16  FILLER               PIC X(248).
  5712
  5713
  5714****************************************************************
  5715*             LIFE EDIT MASTER RECORD                          *
  5716****************************************************************
  5717
  5718     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5719         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5720             20  CF-LIFE-CODE-IN            PIC XX.
  5721             20  CF-LIFE-CODE-OUT           PIC XX.
  5722         16  FILLER                         PIC X(248).
  5723
  5724
  5725****************************************************************
  5726*             AH EDIT MASTER RECORD                            *
  5727****************************************************************
  5728
  5729     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5730         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5731             20  CF-AH-CODE-IN              PIC XXX.
  5732             20  CF-AH-CODE-OUT             PIC XX.
  5733         16  FILLER                         PIC X(248).
  5734
  5735
  5736****************************************************************
  5737*             CREDIBILITY TABLES                               *
  5738****************************************************************
  5739
  5740     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5741         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5742                             INDEXED BY CF-CRDB-NDX.
  5743             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5744             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5745             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5746         16  FILLER                         PIC  X(332).
  5747
  5748
  5749****************************************************************
  5750*             REPORT CUSTOMIZATION RECORD                      *
  5751****************************************************************
  5752
  5753     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5754         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5755             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5756             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5757             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5758**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5759****       A T-TRANSFER.                                   ****
  5760             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5761
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 104
* EL131.cbl
  5762         16  FILLER                         PIC XX.
  5763
  5764         16  CF-CARRIER-CNTL-OPT.
  5765             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5766                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5767                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5768             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5769                                            PIC X.
  5770         16  CF-GROUP-CNTL-OPT.
  5771             20  CF-GROUP-OPT-SEQ           PIC 9.
  5772                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5773                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5774             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5775                                            PIC X(6).
  5776         16  CF-STATE-CNTL-OPT.
  5777             20  CF-STATE-OPT-SEQ           PIC 9.
  5778                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5779                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5780             20  CF-STATE-SELECT OCCURS 3 TIMES
  5781                                            PIC XX.
  5782         16  CF-ACCOUNT-CNTL-OPT.
  5783             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5784                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5785                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5786             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5787                                            PIC X(10).
  5788         16  CF-BUS-TYP-CNTL-OPT.
  5789             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5790                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5791                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5792             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5793                                            PIC XX.
  5794         16  CF-LF-TYP-CNTL-OPT.
  5795             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5796                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5797                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5798             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5799                                            PIC XX.
  5800         16  CF-AH-TYP-CNTL-OPT.
  5801             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5802                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5803                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5804             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5805                                            PIC XX.
  5806         16  CF-REPTCD1-CNTL-OPT.
  5807             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5808                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5809                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5810             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5811                                            PIC X(10).
  5812         16  CF-REPTCD2-CNTL-OPT.
  5813             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5814                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5815                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5816             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5817                                            PIC X(10).
  5818         16  CF-USER1-CNTL-OPT.
  5819             20  CF-USER1-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 105
* EL131.cbl
  5820                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5821                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5822             20  CF-USER1-SELECT OCCURS 3 TIMES
  5823                                            PIC X(10).
  5824         16  CF-USER2-CNTL-OPT.
  5825             20  CF-USER2-OPT-SEQ           PIC 9.
  5826                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5827                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5828             20  CF-USER2-SELECT OCCURS 3 TIMES
  5829                                            PIC X(10).
  5830         16  CF-USER3-CNTL-OPT.
  5831             20  CF-USER3-OPT-SEQ           PIC 9.
  5832                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5833                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5834             20  CF-USER3-SELECT OCCURS 3 TIMES
  5835                                            PIC X(10).
  5836         16  CF-USER4-CNTL-OPT.
  5837             20  CF-USER4-OPT-SEQ           PIC 9.
  5838                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5839                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5840             20  CF-USER4-SELECT OCCURS 3 TIMES
  5841                                            PIC X(10).
  5842         16  CF-USER5-CNTL-OPT.
  5843             20  CF-USER5-OPT-SEQ           PIC 9.
  5844                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5845                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5846             20  CF-USER5-SELECT OCCURS 3 TIMES
  5847                                            PIC X(10).
  5848         16  CF-REINS-CNTL-OPT.
  5849             20  CF-REINS-OPT-SEQ           PIC 9.
  5850                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5851                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5852             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5853                 24  CF-REINS-PRIME         PIC XXX.
  5854                 24  CF-REINS-SUB           PIC XXX.
  5855
  5856         16  CF-AGENT-CNTL-OPT.
  5857             20  CF-AGENT-OPT-SEQ           PIC 9.
  5858                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5859                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5860             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5861                                            PIC X(10).
  5862
  5863         16  FILLER                         PIC X(43).
  5864
  5865         16  CF-LOSS-RATIO-SELECT.
  5866             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5867             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5868         16  CF-ENTRY-DATE-SELECT.
  5869             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5870             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5871         16  CF-EFFECTIVE-DATE-SELECT.
  5872             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5873             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5874
  5875         16  CF-EXCEPTION-LIST-IND          PIC X.
  5876             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5877
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 106
* EL131.cbl
  5878         16  FILLER                         PIC X(318).
  5879
  5880****************************************************************
  5881*                  EXCEPTION REPORTING RECORD                  *
  5882****************************************************************
  5883
  5884     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5885         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5886             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5887
  5888         16  CF-COMBINED-LIFE-AH-OPT.
  5889             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5890             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5891             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5892             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5893
  5894         16  CF-LIFE-OPT.
  5895             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5896             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5897             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5898             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5899             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5900             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5901             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5902             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5903             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5904             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5905
  5906         16  CF-AH-OPT.
  5907             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5908             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5909             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5910             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5911             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5912             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5913             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5914             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5915             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5916             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5917
  5918         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5919             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5920             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5921             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5922
  5923         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5924
  5925         16  FILLER                         PIC X(673).
  5926
  5927
  5928****************************************************************
  5929*             MORTGAGE SYSTEM PLAN RECORD                      *
  5930****************************************************************
  5931
  5932     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5933         16  CF-PLAN-TYPE                   PIC X.
  5934             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5935             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 107
* EL131.cbl
  5936             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5937         16  CF-PLAN-ABBREV                 PIC XXX.
  5938         16  CF-PLAN-DESCRIPT               PIC X(10).
  5939         16  CF-PLAN-NOTES                  PIC X(20).
  5940         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5941         16  CF-PLAN-UNDERWRITING.
  5942             20  CF-PLAN-TERM-DATA.
  5943                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5944                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5945             20  CF-PLAN-AGE-DATA.
  5946                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5947                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5948                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5949             20  CF-PLAN-BENEFIT-DATA.
  5950                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5951                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5952                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5953                                            PIC S9(7)V99  COMP-3.
  5954         16  CF-PLAN-POLICY-FORMS.
  5955             20  CF-POLICY-FORM             PIC X(12).
  5956             20  CF-MASTER-APPLICATION      PIC X(12).
  5957             20  CF-MASTER-POLICY           PIC X(12).
  5958         16  CF-PLAN-RATING.
  5959             20  CF-RATE-CODE               PIC X(5).
  5960             20  CF-SEX-RATING              PIC X.
  5961                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5962                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5963             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5964             20  CF-SUB-STD-TYPE            PIC X.
  5965                 88  CF-PCT-OF-PREM            VALUE '1'.
  5966                 88  CF-PCT-OF-BENE            VALUE '2'.
  5967         16  CF-PLAN-PREM-TOLERANCES.
  5968             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5969             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5970         16  CF-PLAN-PYMT-TOLERANCES.
  5971             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5972             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5973         16  CF-PLAN-MISC-DATA.
  5974             20  FILLER                     PIC X.
  5975             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5976             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5977         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5978         16  CF-PLAN-IND-GRP                PIC X.
  5979             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5980                                                     '1'.
  5981             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5982                                                     '2'.
  5983         16  CF-MIB-SEARCH-SW               PIC X.
  5984             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5985             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5986             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5987             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5988         16  CF-ALPHA-SEARCH-SW             PIC X.
  5989             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5990             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5991             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5992             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5993             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 108
* EL131.cbl
  5994             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5995             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5996             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5997             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5998             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5999                                                     'A' 'B' 'C'
  6000                                                     'X' 'Y' 'Z'.
  6001         16  CF-EFF-DT-RULE-SW              PIC X.
  6002             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6003             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6004             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6005             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6006             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6007         16  FILLER                         PIC X(4).
  6008         16  CF-HEALTH-QUESTIONS            PIC X.
  6009             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6010         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6011         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6012         16  CF-PLAN-SNGL-JNT               PIC X.
  6013             88  CF-COMBINED-PLAN              VALUE 'C'.
  6014             88  CF-JNT-PLAN                   VALUE 'J'.
  6015             88  CF-SNGL-PLAN                  VALUE 'S'.
  6016         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6017         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6018         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6019         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6020         16  CF-RERATE-CNTL                 PIC  X.
  6021             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6022             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6023             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6024             88  CF-AUTO-RECALC                 VALUE '4'.
  6025         16  CF-BENEFIT-TYPE                PIC  X.
  6026             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6027             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6028         16  CF-POLICY-FEE                  PIC S999V99
  6029                                                    COMP-3.
  6030         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6031         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6032         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6033         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6034         16  FILLER                         PIC  X(32).
  6035         16  CF-TERMINATION-FORM            PIC  X(04).
  6036         16  FILLER                         PIC  X(08).
  6037         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6038                                                       COMP-3.
  6039         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6040         16  CF-ISSUE-LETTER                PIC  X(4).
  6041         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6042         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6043             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6044             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6045         16  CF-MP-REFUND-CALC              PIC X.
  6046             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6047             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6048             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6049             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6050             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6051             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 109
* EL131.cbl
  6052             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6053             88  CF-MP-REFD-MEAN                VALUE '8'.
  6054         16  CF-ALT-RATE-CODE               PIC  X(5).
  6055
  6056
  6057         16  FILLER                         PIC X(498).
  6058****************************************************************
  6059*             MORTGAGE COMPANY MASTER RECORD                   *
  6060****************************************************************
  6061
  6062     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6063         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6064         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6065             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6066             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6067             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6068             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6069             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6070
  6071         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6072         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6073         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6074         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6075         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6076
  6077         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6078             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6079         16  CF-MP-RECON-USE-IND            PIC X(1).
  6080             88  CF-MP-USE-RECON             VALUE 'Y'.
  6081         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6082             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6083         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6084             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6085             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6086         16  FILLER                         PIC X(1).
  6087         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6088             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6089         16  CF-MORTG-MIB-VERSION           PIC X.
  6090             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6091             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6092             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6093         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6094             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6095                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6096             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6097                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6098             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6099                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6100             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6101                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6102             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6103                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6104             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6105                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6106         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6107         16  FILLER                         PIC X(7).
  6108         16  CF-MORTG-DESTINATION-SYMBOL.
  6109             20  CF-MORTG-MIB-COMM          PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 110
* EL131.cbl
  6110             20  CF-MORTG-MIB-TERM          PIC X(5).
  6111         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6112             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6113         16  FILLER                         PIC X(03).
  6114         16  CF-MP-CHECK-NO-CONTROL.
  6115             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6116                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6117                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6118                                                ' ' LOW-VALUES.
  6119                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6120                                               VALUE '3'.
  6121         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6122         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6123         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6124             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6125                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6126             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6127                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6128             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6129                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6130             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6131                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6132             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6133                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6134             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6135                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6136         16  CF-MORTG-BILLING-AREA.
  6137             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6138                                            PIC X.
  6139         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6140         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6141         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6142         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6143             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6144             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6145         16  FILLER                         PIC X.
  6146         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6147             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6148             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6149         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6150         16  FILLER                         PIC X(8).
  6151         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6152         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6153         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6154         16  CF-ACH-COMPANY-ID.
  6155             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6156                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6157                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6158                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6159             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6160         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6161             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6162         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6163             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6164             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6165         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6166         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6167         16  FILLER                         PIC X(536).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 111
* EL131.cbl
  6168
  6169****************************************************************
  6170*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6171****************************************************************
  6172
  6173     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6174         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6175             20  CF-FEMALE-HEIGHT.
  6176                 24  CF-FEMALE-FT           PIC 99.
  6177                 24  CF-FEMALE-IN           PIC 99.
  6178             20  CF-FEMALE-MIN-WT           PIC 999.
  6179             20  CF-FEMALE-MAX-WT           PIC 999.
  6180         16  FILLER                         PIC X(428).
  6181
  6182     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6183         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6184             20  CF-MALE-HEIGHT.
  6185                 24  CF-MALE-FT             PIC 99.
  6186                 24  CF-MALE-IN             PIC 99.
  6187             20  CF-MALE-MIN-WT             PIC 999.
  6188             20  CF-MALE-MAX-WT             PIC 999.
  6189         16  FILLER                         PIC X(428).
  6190******************************************************************
  6191*             AUTOMATIC ACTIVITY RECORD                          *
  6192******************************************************************
  6193     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6194         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6195             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6196             20  CF-SYS-LETTER-ID           PIC X(04).
  6197             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6198             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6199             20  CF-SYS-RESET-SW            PIC X(01).
  6200             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6201             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6202
  6203         16  FILLER                         PIC X(50).
  6204
  6205         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6206             20  CF-USER-ACTIVE-SW          PIC X(01).
  6207             20  CF-USER-LETTER-ID          PIC X(04).
  6208             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6209             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6210             20  CF-USER-RESET-SW           PIC X(01).
  6211             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6212             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6213             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6214
  6215         16  FILLER                         PIC X(246).
  6216
  6217*                                COPY ELCACTQ.
  6218******************************************************************
  6219*                                                                *
  6220*                            ELCACTQ.                            *
  6221*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6222*                            VMOD=2.004                          *
  6223*                                                                *
  6224*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6225*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 112
* EL131.cbl
  6226*   FILE TYPE = VSAM,KSDS                                        *
  6227*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6228*                                                                *
  6229*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6230*       ALTERNATE INDEX = NONE                                   *
  6231*                                                                *
  6232*   LOG = YES                                                    *
  6233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6234*                                                                *
  6235*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6236******************************************************************
  6237
  6238 01  ACTIVITY-QUE.
  6239     12  AQ-RECORD-ID                PIC XX.
  6240         88  VALID-AQ-ID                VALUE 'AQ'.
  6241
  6242     12  AQ-CONTROL-PRIMARY.
  6243         16  AQ-COMPANY-CD           PIC X.
  6244         16  AQ-CARRIER              PIC X.
  6245         16  AQ-CLAIM-NO             PIC X(7).
  6246         16  AQ-CERT-NO.
  6247             20  AQ-CERT-PRIME       PIC X(10).
  6248             20  AQ-CERT-SFX         PIC X.
  6249
  6250     12  AQ-PENDING-ACTIVITY-FLAGS.
  6251         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6252         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6253             88  PENDING-PAYMENTS       VALUE '1'.
  6254         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6255             88  PENDING-FULL-PRINT     VALUE '1'.
  6256             88  PENDING-PART-PRINT     VALUE '2'.
  6257         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6258             88  PENDING-LETTERS        VALUE '1'.
  6259         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6260             88  PENDING-RESTORE        VALUE 'C'.
  6261             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6262
  6263     12  FILLER                      PIC X(20).
  6264
  6265     12  AQ-RESEND-DATE              PIC XX.
  6266     12  AQ-FOLLOWUP-DATE            PIC XX.
  6267     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6268     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6269     12  AQ-AUTO-LETTER              PIC X(4).
  6270     12  FILLER                      PIC XX.
  6271     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6272*****************************************************************
  6273
  6274*                                COPY ERCACCT.
  6275******************************************************************
  6276*                                                                *
  6277*                                                                *
  6278*                            ERCACCT                             *
  6279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6280*                            VMOD=2.031                          *
  6281*                                                                *
  6282*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6283*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 113
* EL131.cbl
  6284*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6285*   VSAM ACCOUNT MASTER FILES.                                   *
  6286*                                                                *
  6287*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6288*                                                                *
  6289*   FILE TYPE = VSAM,KSDS                                        *
  6290*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6291*                                                                *
  6292*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6293*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6294*                                                                *
  6295*   LOG = NO                                                     *
  6296*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6297*                                                                *
  6298*                                                                *
  6299******************************************************************
  6300*                   C H A N G E   L O G
  6301*
  6302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6303*-----------------------------------------------------------------
  6304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6305* EFFECTIVE    NUMBER
  6306*-----------------------------------------------------------------
  6307* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6308* 092705    2005050300006  PEMA  ADD SPP LEASES
  6309* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6310* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6311* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6312* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6313* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6314* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6315******************************************************************
  6316
  6317 01  ACCOUNT-MASTER.
  6318     12  AM-RECORD-ID                      PIC XX.
  6319         88  VALID-AM-ID                      VALUE 'AM'.
  6320
  6321     12  AM-CONTROL-PRIMARY.
  6322         16  AM-COMPANY-CD                 PIC X.
  6323         16  AM-MSTR-CNTRL.
  6324             20  AM-CONTROL-A.
  6325                 24  AM-CARRIER            PIC X.
  6326                 24  AM-GROUPING.
  6327                     28 AM-GROUPING-PREFIX PIC XXX.
  6328                     28 AM-GROUPING-PRIME  PIC XXX.
  6329                 24  AM-STATE              PIC XX.
  6330                 24  AM-ACCOUNT.
  6331                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6332                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6333             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6334                                           PIC X(19).
  6335             20  AM-CNTRL-B.
  6336                 24  AM-EXPIRATION-DT      PIC XX.
  6337                 24  FILLER                PIC X(4).
  6338             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6339                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6340
  6341     12  AM-CONTROL-BY-VAR-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 114
* EL131.cbl
  6342         16  AM-COMPANY-CD-A1              PIC X.
  6343         16  AM-VG-CARRIER                 PIC X.
  6344         16  AM-VG-GROUPING                PIC X(6).
  6345         16  AM-VG-STATE                   PIC XX.
  6346         16  AM-VG-ACCOUNT                 PIC X(10).
  6347         16  AM-VG-DATE.
  6348             20  AM-VG-EXPIRATION-DT       PIC XX.
  6349             20  FILLER                    PIC X(4).
  6350         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6351                                           PIC 9(11)      COMP-3.
  6352     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6353         16  FILLER                        PIC X(10).
  6354         16  AM-VG-KEY3.
  6355             20  AM-VG3-ACCOUNT            PIC X(10).
  6356             20  AM-VG3-EXP-DT             PIC XX.
  6357         16  FILLER                        PIC X(4).
  6358     12  AM-MAINT-INFORMATION.
  6359         16  AM-LAST-MAINT-DT              PIC XX.
  6360         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6361         16  AM-LAST-MAINT-USER            PIC X(4).
  6362         16  FILLER                        PIC XX.
  6363
  6364     12  AM-EFFECTIVE-DT                   PIC XX.
  6365     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6366
  6367     12  AM-PREV-DATES  COMP-3.
  6368         16  AM-PREV-EXP-DT                PIC 9(11).
  6369         16  AM-PREV-EFF-DT                PIC 9(11).
  6370
  6371     12  AM-REPORT-CODE-1                  PIC X(10).
  6372     12  AM-REPORT-CODE-2                  PIC X(10).
  6373
  6374     12  AM-CITY-CODE                      PIC X(4).
  6375     12  AM-COUNTY-PARISH                  PIC X(6).
  6376
  6377     12  AM-NAME                           PIC X(30).
  6378     12  AM-PERSON                         PIC X(30).
  6379     12  AM-ADDRS                          PIC X(30).
  6380     12  AM-CITY.
  6381         16  AM-ADDR-CITY                  PIC X(28).
  6382         16  AM-ADDR-STATE                 PIC XX.
  6383     12  AM-ZIP.
  6384         16  AM-ZIP-PRIME.
  6385             20  AM-ZIP-PRI-1ST            PIC X.
  6386                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6387             20  FILLER                    PIC X(4).
  6388         16  AM-ZIP-PLUS4                  PIC X(4).
  6389     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6390         16  AM-CAN-POSTAL-1               PIC XXX.
  6391         16  AM-CAN-POSTAL-2               PIC XXX.
  6392         16  FILLER                        PIC XXX.
  6393     12  AM-TEL-NO.
  6394         16  AM-AREA-CODE                  PIC 999.
  6395         16  AM-TEL-PRE                    PIC 999.
  6396         16  AM-TEL-NBR                    PIC 9(4).
  6397     12  AM-TEL-LOC                        PIC X.
  6398         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6399         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 115
* EL131.cbl
  6400
  6401     12  AM-COMM-STRUCTURE.
  6402         16  AM-DEFN-1.
  6403             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6404                 24  AM-AGT.
  6405                     28  AM-AGT-PREFIX     PIC X(4).
  6406                     28  AM-AGT-PRIME      PIC X(6).
  6407                 24  AM-COM-TYP            PIC X.
  6408                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6409                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6410                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6411                 24  AM-RECALC-LV-INDIC    PIC X.
  6412                 24  AM-RETRO-LV-INDIC     PIC X.
  6413                 24  AM-GL-CODES           PIC X.
  6414                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6415                 24  FILLER                PIC X(01).
  6416         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6417             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6418                 24  FILLER                PIC X(11).
  6419                 24  AM-L-COMA             PIC XXX.
  6420                 24  AM-J-COMA             PIC XXX.
  6421                 24  AM-A-COMA             PIC XXX.
  6422                 24  FILLER                PIC X(6).
  6423
  6424     12  AM-COMM-CHANGE-STATUS             PIC X.
  6425         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6426
  6427     12  AM-CSR-CODE                       PIC X(4).
  6428
  6429     12  AM-BILLING-STATUS                 PIC X.
  6430         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6431         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6432     12  AM-AUTO-REFUND-SW                 PIC X.
  6433         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6434         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6435     12  AM-GPCD                           PIC 99.
  6436     12  AM-IG                             PIC X.
  6437         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6438         88  AM-HAS-GROUP                     VALUE '2'.
  6439     12  AM-STATUS                         PIC X.
  6440         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6441         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6442         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6443         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6444         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6445         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6446         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6447         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6448         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6449         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6450     12  AM-REMIT-TO                       PIC 99.
  6451     12  AM-ID-NO                          PIC X(11).
  6452
  6453     12  AM-CAL-TABLE                      PIC XX.
  6454     12  AM-LF-DEVIATION                   PIC XXX.
  6455     12  AM-AH-DEVIATION                   PIC XXX.
  6456     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6457     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 116
* EL131.cbl
  6458     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6459     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6460     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6461     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6462
  6463     12  AM-USER-FIELDS.
  6464         16  AM-FLD-1                      PIC XX.
  6465         16  AM-FLD-2                      PIC XX.
  6466         16  AM-FLD-3                      PIC XX.
  6467         16  AM-FLD-4                      PIC XX.
  6468         16  AM-FLD-5                      PIC XX.
  6469
  6470     12  AM-1ST-PROD-DATE.
  6471         16  AM-1ST-PROD-YR                PIC XX.
  6472         16  AM-1ST-PROD-MO                PIC XX.
  6473         16  AM-1ST-PROD-DA                PIC XX.
  6474     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6475     12  AM-CERTS-PURGED-DATE.
  6476         16  AM-PUR-YR                     PIC XX.
  6477         16  AM-PUR-MO                     PIC XX.
  6478         16  AM-PUR-DA                     PIC XX.
  6479     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6480     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6481     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6482     12  AM-INACTIVE-DATE.
  6483         16  AM-INA-MO                     PIC 99.
  6484         16  AM-INA-DA                     PIC 99.
  6485         16  AM-INA-YR                     PIC 99.
  6486     12  AM-AR-HI-CERT-DATE                PIC XX.
  6487
  6488     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6489     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6490
  6491     12  AM-OB-PAYMENT-MODE                PIC X.
  6492         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6493         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6494         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6495         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6496
  6497     12  AM-AH-ONLY-INDICATOR              PIC X.
  6498         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6499         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6500
  6501     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6502
  6503     12  AM-OVER-SHORT.
  6504         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6505         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6506
  6507     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6508     12  AM-DCC-CLP-STATE                  PIC XX.
  6509
  6510     12  AM-RECALC-COMM                    PIC X.
  6511     12  AM-RECALC-REIN                    PIC X.
  6512
  6513     12  AM-REI-TABLE                      PIC XXX.
  6514     12  AM-REI-ET-LF                      PIC X.
  6515     12  AM-REI-ET-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 117
* EL131.cbl
  6516     12  AM-REI-PE-LF                      PIC X.
  6517     12  AM-REI-PE-AH                      PIC X.
  6518     12  AM-REI-PRT-ST                     PIC X.
  6519     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6520     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6521     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6522     12  AM-REI-GROUP-A                    PIC X(6).
  6523     12  AM-REI-MORT                       PIC X(4).
  6524     12  AM-REI-PRT-OW                     PIC X.
  6525     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6526     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6527     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6528     12  AM-REI-GROUP-B                    PIC X(6).
  6529
  6530     12  AM-TRUST-TYPE                     PIC X(2).
  6531
  6532     12  AM-EMPLOYER-STMT-USED             PIC X.
  6533     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6534
  6535     12  AM-STD-AH-TYPE                    PIC XX.
  6536     12  AM-EARN-METHODS.
  6537         16  AM-EARN-METHOD-R              PIC X.
  6538             88 AM-REF-RL-R78                 VALUE 'R'.
  6539             88 AM-REF-RL-PR                  VALUE 'P'.
  6540             88 AM-REF-RL-MEAN                VALUE 'M'.
  6541             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6542         16  AM-EARN-METHOD-L              PIC X.
  6543             88 AM-REF-LL-R78                 VALUE 'R'.
  6544             88 AM-REF-LL-PR                  VALUE 'P'.
  6545             88 AM-REF-LL-MEAN                VALUE 'M'.
  6546             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6547         16  AM-EARN-METHOD-A              PIC X.
  6548             88 AM-REF-AH-R78                 VALUE 'R'.
  6549             88 AM-REF-AH-PR                  VALUE 'P'.
  6550             88 AM-REF-AH-MEAN                VALUE 'M'.
  6551             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6552             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6553             88 AM-REF-AH-NET                 VALUE 'N'.
  6554
  6555     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6556     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6557     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6558
  6559     12  AM-RET-Y-N                        PIC X.
  6560     12  AM-RET-P-E                        PIC X.
  6561     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6562     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6563     12  AM-RET-GRP                        PIC X(6).
  6564     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6565         16  AM-POOL-PRIME                 PIC XXX.
  6566         16  AM-POOL-SUB                   PIC XXX.
  6567     12  AM-RETRO-EARNINGS.
  6568         16  AM-RET-EARN-R                 PIC X.
  6569         16  AM-RET-EARN-L                 PIC X.
  6570         16  AM-RET-EARN-A                 PIC X.
  6571     12  AM-RET-ST-TAX-USE                 PIC X.
  6572         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6573         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 118
* EL131.cbl
  6574     12  AM-RETRO-BEG-EARNINGS.
  6575         16  AM-RET-BEG-EARN-R             PIC X.
  6576         16  AM-RET-BEG-EARN-L             PIC X.
  6577         16  AM-RET-BEG-EARN-A             PIC X.
  6578     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6579     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6580
  6581     12  AM-USER-SELECT-OPTIONS.
  6582         16  AM-USER-SELECT-1              PIC X(10).
  6583         16  AM-USER-SELECT-2              PIC X(10).
  6584         16  AM-USER-SELECT-3              PIC X(10).
  6585         16  AM-USER-SELECT-4              PIC X(10).
  6586         16  AM-USER-SELECT-5              PIC X(10).
  6587
  6588     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6589
  6590     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6591
  6592     12  AM-RPT045A-SWITCH                 PIC X.
  6593         88  RPT045A-OFF                   VALUE 'N'.
  6594
  6595     12  AM-INSURANCE-LIMITS.
  6596         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6597         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6598
  6599     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6600         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6601
  6602     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6603         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6604         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6605
  6606     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6607
  6608     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6609     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6610     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6611     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6612     12  AM-DCC-UEF-STATE                  PIC XX.
  6613     12  FILLER                            PIC XXX.
  6614     12  AM-REPORT-CODE-3                  PIC X(10).
  6615*    12  FILLER                            PIC X(22).
  6616
  6617     12  AM-RESERVE-DATE.
  6618         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6619         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6620         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6621
  6622     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6623     12  AM-NOTIFICATION-TYPES.
  6624         16  AM-NOTIF-OF-LETTERS           PIC X.
  6625         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6626         16  AM-NOTIF-OF-REPORTS           PIC X.
  6627         16  AM-NOTIF-OF-STATUS            PIC X.
  6628
  6629     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6630         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6631         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 119
* EL131.cbl
  6632         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6633         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6634
  6635     12  AM-BENEFIT-CONTROLS.
  6636         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6637             20  AM-BENEFIT-CODE           PIC XX.
  6638             20  AM-BENEFIT-TYPE           PIC X.
  6639             20  AM-BENEFIT-REVISION       PIC XXX.
  6640             20  AM-BENEFIT-REM-TERM       PIC X.
  6641             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6642             20  FILLER                    PIC XX.
  6643         16  FILLER                        PIC X(80).
  6644
  6645     12  AM-TRANSFER-DATA.
  6646         16  AM-TRANSFERRED-FROM.
  6647             20  AM-TRNFROM-CARRIER        PIC X.
  6648             20  AM-TRNFROM-GROUPING.
  6649                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6650                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6651             20  AM-TRNFROM-STATE          PIC XX.
  6652             20  AM-TRNFROM-ACCOUNT.
  6653                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6654                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6655             20  AM-TRNFROM-DTE            PIC XX.
  6656         16  AM-TRANSFERRED-TO.
  6657             20  AM-TRNTO-CARRIER          PIC X.
  6658             20  AM-TRNTO-GROUPING.
  6659                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6660                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6661             20  AM-TRNTO-STATE            PIC XX.
  6662             20  AM-TRNTO-ACCOUNT.
  6663                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6664                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6665             20  AM-TRNTO-DTE              PIC XX.
  6666         16  FILLER                        PIC X(10).
  6667
  6668     12  AM-SAVED-REMIT-TO                 PIC 99.
  6669
  6670     12  AM-COMM-STRUCTURE-SAVED.
  6671         16  AM-DEFN-1-SAVED.
  6672             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6673                 24  AM-AGT-SV             PIC X(10).
  6674                 24  AM-COM-TYP-SV         PIC X.
  6675                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6676                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6677                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6678                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6679                 24  FILLER                PIC X.
  6680                 24  AM-GL-CODES-SV        PIC X.
  6681                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6682                 24  FILLER                PIC X.
  6683         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6684             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6685                 24  FILLER                PIC X(11).
  6686                 24  AM-L-COMA-SV          PIC XXX.
  6687                 24  AM-J-COMA-SV          PIC XXX.
  6688                 24  AM-A-COMA-SV          PIC XXX.
  6689                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 120
* EL131.cbl
  6690
  6691     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6692         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6693            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6694            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6695            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6696
  6697     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6698     12  FILLER                            PIC X(120).
  6699
  6700     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6701         16  AM-CONTROL-NAME               PIC X(30).
  6702         16  AM-EXECUTIVE-ONE.
  6703             20  AM-EXEC1-NAME             PIC X(15).
  6704             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6705                                                          COMP-3.
  6706             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6707                                                          COMP-3.
  6708         16  AM-EXECUTIVE-TWO.
  6709             20  AM-EXEC2-NAME             PIC X(15).
  6710             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6711                                                          COMP-3.
  6712             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6713                                                          COMP-3.
  6714
  6715     12  AM-RETRO-ADDITIONAL-DATA.
  6716         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6717         16  AM-RETRO-PREM-P-E             PIC X.
  6718         16  AM-RETRO-CLMS-P-I             PIC X.
  6719         16  AM-RETRO-RET-BRACKET-LF.
  6720             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6721                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6722                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6723             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6724                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6725                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6726             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6727                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6728                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6729         16  AM-RETRO-RET-BRACKET-AH.
  6730             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6731                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6732                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6733                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6734             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6735                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6736                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6737             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6738                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6739                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6740
  6741     12  AM-COMMENTS.
  6742         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6743
  6744     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6745         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6746         16  AM-FLI-BILLING-CODE           PIC X.
  6747         16  AM-FLI-ALT-STATE-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 121
* EL131.cbl
  6748         16  AM-FLI-UNITED-IDENT           PIC X.
  6749         16  AM-FLI-INTEREST-LOST-DATA.
  6750             20  AM-FLI-BANK-NO            PIC X(5).
  6751             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6752             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6753             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6754         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6755             20  AM-FLI-AGT                PIC X(9).
  6756             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6757             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6758         16  FILLER                        PIC X(102).
  6759
  6760     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6761         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6762             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6763             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6764             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6765             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6766             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6767         16  FILLER                          PIC X(10).
  6768******************************************************************
  6769
  6770*                                COPY ELCCHKQ.
  6771******************************************************************
  6772*                                                                *
  6773*                                                                *
  6774*                            ELCCHKQ.                            *
  6775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6776*                            VMOD=2.007                          *
  6777*                                                                *
  6778*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6779*                                                                *
  6780*   FILE TYPE = VSAM,KSDS                                        *
  6781*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6782*                                                                *
  6783*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6784*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6785*                                                                *
  6786*   LOG = YES                                                    *
  6787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6788******************************************************************
  6789 01  CHECK-QUE.
  6790     12  CQ-RECORD-ID                PIC XX.
  6791         88  VALID-CQ-ID         VALUE 'CQ'.
  6792
  6793     12  CQ-CONTROL-PRIMARY.
  6794         16  CQ-COMPANY-CD           PIC X.
  6795         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6796         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6797
  6798     12  CQ-CONTROL-BY-PAYEE.
  6799         16  CQ-CONTROL-BY-NUMBER.
  6800             20  CQ-COMPANY-CD-A1     PIC X.
  6801             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6802         16  CQ-PAYEE-CARRIER        PIC X.
  6803         16  CQ-PAYEE-GROUPING       PIC X(6).
  6804         16  CQ-PAYEE-STATE          PIC XX.
  6805         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 122
* EL131.cbl
  6806         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6807
  6808     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6809         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6810         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6811         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6812         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6813         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6814         16  FILLER                  PIC X(3).
  6815
  6816     12  CQ-ENTRY-TYPE               PIC X.
  6817             88  CHECK-ON-QUE           VALUE 'Q'.
  6818             88  ALIGNMENT-CHECK        VALUE 'A'.
  6819             88  SPOILED-CHECK          VALUE 'S'.
  6820             88  PAYMENT-ABORTED        VALUE 'X'.
  6821
  6822     12  CQ-CLAIM-MAST-CNTL.
  6823         16  CQ-CARRIER              PIC X.
  6824         16  CQ-CLAIM-NO             PIC X(7).
  6825         16  CQ-CERT-NO.
  6826             20  CQ-CERT-PRIME       PIC X(10).
  6827             20  CQ-CERT-SFX         PIC X.
  6828         16  CQ-CLAIM-TYPE           PIC X.
  6829             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6830             88  CQ-AH-CLAIM            VALUE 'A'.
  6831         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6832             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6833             88  CQ-O-B-COVERAGE        VALUE '2'.
  6834             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6835
  6836     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6837     12  CQ-CHECK-NUMBER             PIC X(7).
  6838     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6839     12  CQ-PAYMENT-TYPE             PIC X.
  6840             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6841             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6842             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6843             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6844             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6845             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6846             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6847             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6848     12  CQ-VOID-INDICATOR           PIC X.
  6849             88  CHECK-IS-STOPPED          VALUE 'S'.
  6850             88  CHECK-IS-VOID             VALUE 'V'.
  6851     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6852     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6853     12  CQ-CHECK-BY-USER            PIC X(4).
  6854     12  CQ-PRE-NUMBERING-SW         PIC X.
  6855       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6856       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6857
  6858     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6859     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6860     12  CQ-LEDGER-FLAG              PIC X(01).
  6861     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6862     12  CQ-LAST-UPDATED-DT          PIC XX.
  6863     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 123
* EL131.cbl
  6864     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6865
  6866     12  FILLER                      PIC X(04).
  6867
  6868******************************************************************
  6869
  6870*                                COPY ELCARCH.
  6871******************************************************************
  6872*                                                                *
  6873*                            ELCARCH.                            *
  6874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6875*                            VMOD=2.007                          *
  6876*                                                                *
  6877*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6878*                                                                *
  6879*   FILE TYPE = VSAM,KSDS                                        *
  6880*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6881*                                                                *
  6882*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6883*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6884*                                                                *
  6885*   LOG = NO                                                     *
  6886*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6887*                                                                *
  6888*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6889******************************************************************
  6890 01  LETTER-ARCHIVE.
  6891     12  LA-RECORD-ID                PIC XX.
  6892         88  VALID-LA-ID                VALUE 'LA'.
  6893
  6894     12  LA-CONTROL-PRIMARY.
  6895         16  LA-COMPANY-CD           PIC X.
  6896         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6897         16  LA-RECORD-TYPE          PIC X.
  6898             88  LA-HEADER-DATA         VALUE '1'.
  6899             88  LA-ADDRESS-DATA        VALUE '2'.
  6900             88  LA-TEXT-DATA           VALUE '3'.
  6901             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6902         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6903
  6904     12  LA-CONTROL-BY-TYPE.
  6905         16  LA-COMPANY-CD-A1        PIC X.
  6906         16  LA-RECORD-TYPE-A1       PIC X.
  6907         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6908         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6909
  6910     12  LA-TEXT-RECORD.
  6911         16  LA-SKIP-CONTROL         PIC XX.
  6912             88  NO-LINES-SKIPPED       VALUE SPACES.
  6913             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6914         16  LA-TEXT-LINE            PIC X(70).
  6915
  6916     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6917         16  FILLER                  PIC XX.
  6918         16  LA-ADDRESS-LINE         PIC X(30).
  6919         16  FILLER                  PIC X(40).
  6920
  6921     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 124
* EL131.cbl
  6922         16  FILLER                  PIC XX.
  6923         16  LA-CARRIER              PIC X.
  6924         16  LA-CLAIM-NO             PIC X(7).
  6925         16  LA-CERT-NO.
  6926             20  LA-CERT-PRIME       PIC X(10).
  6927             20  LA-CERT-SFX         PIC X.
  6928         16  LA-NO-OF-COPIES         PIC S9.
  6929         16  LA-RESEND-DATE          PIC XX.
  6930         16  LA-PROCESSOR-CD         PIC X(4).
  6931         16  LA-CREATION-DT          PIC XX.
  6932         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6933         16  LA-RESEND-PRINT-DATE    PIC XX.
  6934         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6935         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6936*
  6937* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6938*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6939*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6940*   I        20  LA-DMD-RES-ST           PIC XX.
  6941*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6942*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6943*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6944*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6945*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6946*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6947*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6948*   I        20  LA-DMD-UND-CODE         PIC XX.
  6949*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6950*   V    16  FILLER                  PIC X(15).
  6951* -----
  6952*
  6953* REINSERTED  CSO  MODS
  6954*
  6955         16  FILLER.
  6956             20  FILLER                  PIC X(29).
  6957             20  LA-CSO-LETTER-STATUS    PIC X.
  6958                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6959                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6960                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6961             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6962             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6963*
  6964
  6965     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6966         16  FILLER                  PIC XX.
  6967         16  LA4-CARRIER             PIC X.
  6968         16  LA4-CLAIM-NO            PIC X(7).
  6969         16  LA4-CERT-NO.
  6970             20  LA4-CERT-PRIME      PIC X(10).
  6971             20  LA4-CERT-SFX        PIC X.
  6972         16  LA4-NO-OF-COPIES        PIC S9.
  6973         16  LA4-RESEND-DATE         PIC XX.
  6974         16  LA4-PROCESSOR-CD        PIC X(4).
  6975         16  LA4-CREATION-DT         PIC XX.
  6976         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6977         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6978         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6979         16  LA4-FORM-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 125
* EL131.cbl
  6980             88  LA4-INITIAL-FORM    VALUE '1'.
  6981             88  LA4-PROGRESS-FORM   VALUE '2'.
  6982         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6983         16  LA4-STATE               PIC X(02).
  6984         16  FILLER                  PIC X(31).
  6985******************************************************************
  6986
  6987*                                COPY ELCBENE.
  6988******************************************************************
  6989*                                                                *
  6990*                            ELCBENE.                            *
  6991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6992*                            VMOD=2.006                          *
  6993*                                                                *
  6994*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6995*                                                                *
  6996*   FILE TYPE = VSAM,KSDS                                        *
  6997*   RECORD SIZE = 500   RECFORM = FIX                            *
  6998*                                                                *
  6999*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7000*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7001*                                                                *
  7002*   LOG = YES                                                    *
  7003*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7004*                                                                *
  7005*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7006******************************************************************
  7007*                   C H A N G E   L O G
  7008*
  7009* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7010*-----------------------------------------------------------------
  7011*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7012* EFFECTIVE    NUMBER
  7013*-----------------------------------------------------------------
  7014* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7015******************************************************************
  7016
  7017 01  BENEFICIARY-MASTER.
  7018     12  BE-RECORD-ID                PIC XX.
  7019         88  VALID-BE-ID                VALUE 'BE'.
  7020
  7021     12  BE-CONTROL-PRIMARY.
  7022         16  BE-COMPANY-CD           PIC X.
  7023         16  BE-RECORD-TYPE          PIC X.
  7024             88  BENEFICIARY-RECORD  VALUE 'B'.
  7025             88  ADJUSTOR-RECORD     VALUE 'A'.
  7026         16  BE-BENEFICIARY          PIC X(10).
  7027     12  BE-CONTROL-BY-NAME.
  7028         16  BE-COMPANY-CD-A1        PIC X.
  7029         16  BE-RECORD-TYPE-A1       PIC X.
  7030         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7031         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7032
  7033     12  BE-LAST-MAINT-DT            PIC XX.
  7034     12  BE-LAST-MAINT-BY            PIC X(4).
  7035     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7036
  7037     12  BE-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 126
* EL131.cbl
  7038         16  BE-MAIL-TO-NAME         PIC X(30).
  7039         16  BE-ADDRESS-LINE-1       PIC X(30).
  7040         16  BE-ADDRESS-LINE-2       PIC X(30).
  7041         16  BE-ADDRESS-LINE-3       PIC X(30).
  7042         16  BE-CITY-STATE.
  7043             20  BE-CITY             PIC X(28).
  7044             20  BE-STATE            PIC XX.
  7045         16  BE-ZIP-CODE.
  7046             20  BE-ZIP-PRIME.
  7047                 24  BE-ZIP-1ST      PIC X.
  7048                     88  BE-CANADIAN-POST-CODE
  7049                                         VALUE 'A' THRU 'Z'.
  7050                 24  FILLER          PIC X(4).
  7051             20  BE-ZIP-PLUS4        PIC X(4).
  7052         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7053             20  BE-CAN-POSTAL-1     PIC XXX.
  7054             20  BE-CAN-POSTAL-2     PIC XXX.
  7055             20  FILLER              PIC XXX.
  7056         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7057         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7058
  7059******************************************************************
  7060*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7061*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7062******************************************************************
  7063     12  BE-CARRIER                  PIC X.
  7064
  7065     12  BE-ADDRESS-DATA2.
  7066         16  BE-MAIL-TO-NAME2        PIC X(30).
  7067         16  BE-ADDRESS-LINE-12      PIC X(30).
  7068         16  BE-ADDRESS-LINE-22      PIC X(30).
  7069         16  BE-ADDRESS-LINE-32      PIC X(30).
  7070         16  BE-CITY-STATE2.
  7071             20  BE-CITY2            PIC X(28).
  7072             20  BE-STATE2           PIC XX.
  7073         16  BE-ZIP-CODE2.
  7074             20  BE-ZIP-PRIME2.
  7075                 24  BE-ZIP-1ST2     PIC X.
  7076                     88  BE-CANADIAN-POST-CODE2
  7077                                         VALUE 'A' THRU 'Z'.
  7078                 24  FILLER          PIC X(4).
  7079             20  BE-ZIP-PLUS42       PIC X(4).
  7080         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7081             20  BE-CAN-POSTAL-12    PIC XXX.
  7082             20  BE-CAN-POSTAL-22    PIC XXX.
  7083             20  FILLER              PIC XXX.
  7084         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7085         16  BE-ACH-DATA.
  7086             20  BE-ACH-YES-OR-NO    PIC X.
  7087                 88  BE-ON-ACH       VALUE 'Y'.
  7088                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7089             20  BE-ACH-ABA-ROUTING-NUMBER
  7090                                     PIC X(15).
  7091             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7092                                     PIC X(20).
  7093             20  FILLER              PIC X(25).
  7094         16  BE-BILLING-STMT-DATA.
  7095*            20  BE-BSR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 127
* EL131.cbl
  7096*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7097*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7098*            20  BE-BSR-FROM         PIC X(30).
  7099*            20  BE-BSR-DEPT         PIC X(30).
  7100             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7101             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7102             20  BE-OUTPUT-TYPE      PIC X.
  7103                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7104                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7105
  7106     12  FILLER                      PIC X(28).
  7107******************************************************************
  7108
  7109*                                COPY ELCDAR.
  7110******************************************************************
  7111*                                                                *
  7112*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7113*   FILE TYPE = VSAM,KSDS                                        *
  7114*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7115*   BASE CLUSTER = DLYACTV                                       *
  7116*   LOG = YES                                                    *
  7117*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7118*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7119*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7120*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7121*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7122*               BY PROGRAM "LGINFCE".                            *
  7123*                                                                *
  7124******************************************************************
  7125 01  DAILY-ACTIVITY-RECORD.
  7126     05  DA-KEY.
  7127         10  DA-COMP-CD          PIC X.
  7128         10  DA-CARRIER          PIC X.
  7129         10  DA-CLAIM-NO         PIC X(7).
  7130         10  DA-CERT-NO.
  7131             15  DA-CERT-PRIME   PIC X(10).
  7132             15  DA-CERT-SFX     PIC X.
  7133     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7134     05  DA-RECORD-TYPE          PIC X.
  7135     05  FILLER                  PIC X(2).
  7136******************************************************************
  7137
  7138*                                COPY ELCALPH.
  7139******************************************************************
  7140*                                                                *
  7141*                            ELCALPH.                            *
  7142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7143*                            VMOD=2.003                          *
  7144*                                                                *
  7145*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7146*                                                                *
  7147*   FILE TYPE = VSAM,KSDS                                        *
  7148*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7149*                                                                *
  7150*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7151*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7152*                                                                *
  7153*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 128
* EL131.cbl
  7154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7155*                                                                *
  7156*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7157******************************************************************
  7158
  7159 01  ALPHA-INDEX.
  7160     12  AI-RECORD-ID                         PIC XX.
  7161         88  VALID-AI-ID                  VALUE 'AI'.
  7162     12  AI-CONTROL-PRIMARY.
  7163         16  AI-COMPANY-CD                     PIC X.
  7164         16  AI-SOURCE                         PIC X.
  7165             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7166             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7167         16  AI-NAME.
  7168             20  AI-LAST-NAME                  PIC X(15).
  7169             20  AI-FIRST-NAME.
  7170                 24  AI-FIRST-INITIAL          PIC X.
  7171                 24  FILLER                    PIC X(11).
  7172             20  AI-MIDDLE-INIT                PIC X.
  7173         16  AI-DATE                           PIC X(8).
  7174         16  AI-TIME                           PIC S9(07) COMP-3.
  7175
  7176     12  AI-CONTROL-BY-ADMIN-KEY.
  7177         16  AI-CM-COMPANY-CD                  PIC X.
  7178         16  AI-CM-SOURCE                      PIC X.
  7179         16  AI-CM-CARRIER                     PIC X.
  7180         16  AI-CM-GROUPING.
  7181             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7182             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7183         16  AI-CM-STATE                       PIC XX.
  7184         16  AI-CM-PRODUCER.
  7185             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7186             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7187         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7188         16  AI-CM-CERTIFICATE-NUMBER.
  7189             20  AI-CM-CERT-PRIME              PIC X(10).
  7190             20  AI-CM-CERT-SFX                PIC X.
  7191         16  AI-CM-DATE                        PIC X(8).
  7192         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7193         16  FILLER                            PIC X(11).
  7194
  7195     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7196         AI-CONTROL-BY-ADMIN-KEY.
  7197         16  AI-CL-COMPANY-CD                  PIC X.
  7198         16  AI-CL-SOURCE                      PIC X.
  7199         16  AI-CL-CARRIER                     PIC X.
  7200         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7201         16  AI-CL-CERTIFICATE-NUMBER.
  7202             20  AI-CL-CERT-PRIME              PIC X(10).
  7203             20  AI-CL-CERT-SFX                PIC X.
  7204         16  AI-CL-DATE                        PIC X(8).
  7205         16  AI-CL-INCURRED-DATE               PIC XX.
  7206         16  AI-CL-CLOSE-DATE                  PIC XX.
  7207         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7208         16  AI-CREDIT-CARD-NUMBER.
  7209             20  AI-CCN.
  7210                 24  AI-CCN-PREFIX             PIC X(4).
  7211                 24  AI-CCN-PRIME              PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 129
* EL131.cbl
  7212             20  AI-CCN-FILLER                 PIC X(4).
  7213
  7214     12  AI-MAINT-INFO.
  7215         16  AI-LAST-MAINT-BY                  PIC X(4).
  7216         16  AI-LAST-MAINT-DT                  PIC XX.
  7217         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7218
  7219     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7220
  7221     12  FILLER                                PIC X(15).
  7222
  7223
  7224*                                COPY ERCDMDNT.
  7225******************************************************************
  7226*                                                                *
  7227*                            ERCDMDNT                            *
  7228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7229*                            VMOD=2.005                          *
  7230*                                                                *
  7231*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7232*                                                                *
  7233*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7234*                                                                *
  7235*        FILE TYPE= VSAM,KSDS                                    *
  7236*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7237*                                                                *
  7238*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7239*                                                                *
  7240*        LOG = YES                                               *
  7241*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7242*                                                                *
  7243******************************************************************
  7244
  7245 01  CERTIFICATE-NOTE.
  7246     12  CN-RECORD-ID                     PIC  XX.
  7247         88  VALID-CN-ID                      VALUE 'CN'.
  7248
  7249     12  CN-CONTROL-PRIMARY.
  7250         16  CN-COMPANY-CD                PIC X.
  7251         16  CN-CERT-KEY.
  7252             20  CN-CARRIER               PIC X.
  7253             20  CN-GROUPING.
  7254                 24  CN-GROUPING-PREFIX   PIC XXX.
  7255                 24  CN-GROUPING-PRIME    PIC XXX.
  7256             20  CN-STATE                 PIC XX.
  7257             20  CN-ACCOUNT.
  7258                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7259                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7260             20  CN-CERT-EFF-DT           PIC XX.
  7261             20  CN-CERT-NO.
  7262                 24  CN-CERT-PRIME        PIC X(10).
  7263                 24  CN-CERT-SFX          PIC X.
  7264
  7265     12  CN-BILLING-START-LINE-NO         PIC 99.
  7266     12  CN-BILLING-END-LINE-NO           PIC 99.
  7267
  7268     12  CN-LINES.
  7269         16  CN-LINE                      PIC X(77)  OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 130
* EL131.cbl
  7270
  7271     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7272         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7273         16  CN-CSI-GENERAL-DATA-AREA.
  7274             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7275
  7276         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7277             CN-CSI-GENERAL-DATA-AREA.
  7278             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7279             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7280             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7281             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7282             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7283             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7284             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7285             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7286             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7287             20  FILLER                       PIC XX.
  7288             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7289             20  FILLER                       PIC X(38).
  7290
  7291         16  CN-CSI-PRODUCT-DATA-AREA.
  7292             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7293
  7294         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7295             CN-CSI-PRODUCT-DATA-AREA.
  7296             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7297             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7298             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7299             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7300             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7301             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7302             20  FILLER                   PIC XX.
  7303             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7304             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7305             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7306             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7307             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7308             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7309             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7310             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7311             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7312             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7313             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7314             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7315             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7316             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7317             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7318             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7319             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7320             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7321             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7322             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7323             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7324             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7325             20  FILLER                   PIC X(25).
  7326
  7327         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 131
* EL131.cbl
  7328             CN-CSI-CREDIT-CARD-DATA.
  7329             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7330             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7331             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7332             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7333             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7334             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7335             20  FILLER                   PIC XX.
  7336             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7337             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7338             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7339             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7340             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7341             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7342             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7343             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7344             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7345             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7346             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7347             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7348             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7349             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7350             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7351             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7352             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7353             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7354             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7355             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7356             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7357             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7358             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7359             20  FILLER                   PIC X(17).
  7360
  7361         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7362             CN-CSI-FAMILY-LEAVE-DATA.
  7363             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7364             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7365             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7366             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7367             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7368             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7369             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7370             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7371             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7372             20  CN-CSI-SL-INT-ON-PROCEEDS
  7373                                          PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7375             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7376             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7377             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7378             20  CN-CSI-SL-POLICY-BENEFITS
  7379                                          PIC S9(5)V99  COMP-3.
  7380             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7381             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7382             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7383             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7384             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7385             20  CN-CSI-SL-PREM-MODE      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 132
* EL131.cbl
  7386             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7387             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7388             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7389             20  CN-CSI-SL-STATE-NOT      PIC X.
  7390             20  FILLER                   PIC XX.
  7391
  7392         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7393             CN-CSI-SENIOR-LIFE-DATA.
  7394             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7395             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7396             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7397                                          PIC S9(5)V99  COMP-3.
  7398             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7399             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7400             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7401             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7402             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7403             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7404             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7405             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7406             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7407             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7408             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7409             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7410             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7411             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7412             20  CN-CSI-PP-REPAIR         PIC X.
  7413             20  CN-CSI-PP-REPLACE        PIC X.
  7414             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7415             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7416             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7417             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7418             20  FILLER                   PIC X(5).
  7419
  7420         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7421             CN-CSI-PURCH-PROP-DATA.
  7422             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7423             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7424             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7425             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7426             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7427             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7428             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7429             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7430             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7431             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7432             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7433             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7434             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7435             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7436             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7437             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7438             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7439             20  CN-CSI-EW-REPLACE        PIC X.
  7440             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7441             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7442             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7443             20  CN-CSI-EW-TERM-AGE       PIC 999.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 133
* EL131.cbl
  7444             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7445             20  FILLER                   PIC X(4).
  7446
  7447     12  CN-LAST-MAINT-DT                 PIC XX.
  7448     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7449     12  CN-LAST-MAINT-USER               PIC X(4).
  7450     12  FILLER                           PIC X(6).
  7451
  7452******************************************************************
  7453
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 134
* EL131.cbl
  7455 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7456                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7457                          CONTROL-FILE ACTIVITY-QUE
  7458                          ACCOUNT-MASTER CHECK-QUE
  7459                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7460                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7461                          CERTIFICATE-NOTE.
  7462 0000-DFHEXIT SECTION.
  7463     MOVE '9#                    $   ' TO DFHEIV0.
  7464     MOVE 'EL131' TO DFHEIV1.
  7465     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7466
  7467     IF EIBCALEN = ZERO
  7468         GO TO 8800-UNAUTHORIZED-ACCESS.
  7469
  7470     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7471     MOVE '5'                    TO DC-OPTION-CODE.
  7472     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7473     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7474     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7475     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7476
  7477     IF SAVE-DATE-YY GREATER 70
  7478         MOVE 19                 TO SAVE-DATE-CC
  7479      ELSE
  7480         MOVE 20                 TO SAVE-DATE-CC.
  7481
  7482
  7483* EXEC CICS HANDLE CONDITION
  7484*        PGMIDERR (8820-XCTL-ERROR)
  7485*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7486*        ERROR    (9990-ABEND)
  7487*    END-EXEC.
  7488*    MOVE '"$LI.                 ! " #00007478' TO DFHEIV0
  7489     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7491     MOVE X'2220233030303037343738' TO DFHEIV0(25:11)
  7492     CALL 'kxdfhei1' USING DFHEIV0
  7493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7494
  7495
  7496     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7497     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7498     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7499
  7500     INITIALIZE    EDIT-WORK-AREA.
  7501     MOVE '/'                    TO WORK-SLASH.
  7502     MOVE SPACES                 TO ERROR-SWITCHES.
  7503
  7504     MOVE TRAN-ID                TO TRANS-ID.
  7505     MOVE EIBTRMID               TO PI-TERM.
  7506     MOVE MAP-ID                 TO PI-QUAL.
  7507
  7508     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7509
  7510     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7511         MOVE LOW-VALUES         TO EL131AO
  7512         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 135
* EL131.cbl
  7513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7514         MOVE -1                 TO MAINTL
  7515         GO TO 8110-SEND-DATA.
  7516
  7517     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7518         MOVE LOW-VALUES         TO EL131AO
  7519         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7520         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7521         MOVE 'X'                TO PI-RETURN-CD-1
  7522         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7523         MOVE -1                 TO MAINTL
  7524         IF WS-RETURNED-FROM = XCTL-EL114
  7525             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7526         END-IF
  7527         GO TO 8100-SEND-MAP.
  7528
  7529     IF EIBAID = DFHCLEAR
  7530         GO TO 8200-RETURN-PRIOR.
  7531
  7532     IF PI-PROCESSOR-ID = 'LGXX'
  7533         NEXT SENTENCE
  7534     ELSE
  7535
  7536* EXEC CICS READQ TS
  7537*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7538*            INTO    (SECURITY-CONTROL)
  7539*            LENGTH  (SC-COMM-LENGTH)
  7540*            ITEM    (SC-ITEM)
  7541*        END-EXEC
  7542*    MOVE '*$II   L              ''   #00007523' TO DFHEIV0
  7543     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7545     MOVE X'2020233030303037353233' TO DFHEIV0(25:11)
  7546     CALL 'kxdfhei1' USING DFHEIV0,
  7547           PI-SECURITY-TEMP-STORE-ID,
  7548           SECURITY-CONTROL,
  7549           SC-COMM-LENGTH,
  7550           SC-ITEM,
  7551           DFHEIV99,
  7552           DFHEIV99
  7553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7554         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7555         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7556         IF NOT DISPLAY-CAP
  7557             MOVE 'READ'               TO  SM-READ
  7558             PERFORM 9995-SECURITY-VIOLATION
  7559             MOVE ER-0070              TO  EMI-ERROR
  7560             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7561             GO TO 8100-SEND-MAP.
  7562
  7563
  7564* EXEC CICS RECEIVE
  7565*        MAP    ('EL131A')
  7566*        MAPSET ('EL131S')
  7567*    END-EXEC.
  7568     MOVE 'EL131A' TO DFHEIV1
  7569     MOVE 'EL131S' TO DFHEIV2
  7570*    MOVE '8"T                   ''   #00007538' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 136
* EL131.cbl
  7571     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7572     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7573     MOVE X'2020233030303037353338' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0,
  7575           DFHEIV1,
  7576           EL131AI,
  7577           DFHEIV99,
  7578           DFHEIV2,
  7579           DFHEIV99,
  7580           DFHEIV99
  7581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7582
  7583
  7584     IF PFKEYL GREATER THAN ZERO
  7585         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7586
  7587     IF SCREEN-ERROR
  7588         MOVE ER-0004 TO EMI-ERROR
  7589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7590         MOVE -1 TO MAINTL
  7591         GO TO 8110-SEND-DATA.
  7592
  7593     IF EIBAID = DFHPF3
  7594         GO TO 8500-TRLR-MNT.
  7595
  7596     IF EIBAID = DFHPF4
  7597         GO TO 8600-ADDR-MNT.
  7598
  7599     IF EIBAID = DFHPF5
  7600         GO TO 8700-CERT-MNT.
  7601
  7602     IF PI-COMPANY-ID = 'DMD'
  7603       IF EIBAID = DFHPF6
  7604         GO TO 8750-DMD-CLM-FIX.
  7605
  7606     IF EIBAID = DFHPF7
  7607         GO TO 4000-FORCE-ERRORS.
  7608
  7609     IF EIBAID = DFHPF12
  7610         GO TO 8300-GET-HELP.
  7611
  7612     IF EIBAID = DFHPF15
  7613         GO TO 8725-BENEFICIARY-MNT
  7614     END-IF.
  7615
  7616     IF EIBAID = DFHPF23
  7617         GO TO 8810-PF23-ENTERED.
  7618
  7619     IF EIBAID = DFHPF24
  7620         GO TO 8400-RETURN-MASTER.
  7621
  7622     IF EIBAID NOT = DFHENTER
  7623         MOVE ER-0029            TO EMI-ERROR
  7624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7625         MOVE -1                 TO MAINTL
  7626         GO TO 8110-SEND-DATA.
  7627
  7628     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 137
* EL131.cbl
  7629         MOVE ER-0311            TO EMI-ERROR
  7630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7631         MOVE -1                 TO MAINTL
  7632         GO TO 8110-SEND-DATA.
  7633
  7634     IF MAINTI = 'A'
  7635         GO TO 0500-ADD-ALPHA-ONLY.
  7636
  7637     IF MAINTI = 'N'
  7638         GO TO 0600-CHANGE-NAME.
  7639
  7640     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7641
  7642     IF SCREEN-ERROR
  7643         GO TO 8110-SEND-DATA.
  7644
  7645     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7646         MOVE ER-0276            TO EMI-ERROR
  7647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7648         MOVE -1                 TO MAINTL
  7649         GO TO 8110-SEND-DATA.
  7650
  7651     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7652
  7653     IF SCREEN-ERROR
  7654         GO TO 8110-SEND-DATA.
  7655
  7656     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7657
  7658     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7659
  7660     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7661         GO TO 8110-SEND-DATA.
  7662
  7663     IF EMI-FATAL-CTR GREATER THAN ZERO
  7664         GO TO 8110-SEND-DATA.
  7665
  7666     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7667
  7668     IF WS-OPEN-CLOSE-SW = 'Y'
  7669         IF PI-LETTER-SW = 'Y'
  7670             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7671             MOVE 'T'            TO  CNTL-REC-TYPE
  7672             MOVE SPACES         TO  CNTL-PROC-ID
  7673             MOVE +0             TO  CNTL-SEQ-NO
  7674
  7675* EXEC CICS READ
  7676*                DATASET   (CNTL-FILE-ID)
  7677*                RIDFLD    (CNTL-KEY)
  7678*                SET       (ADDRESS OF CONTROL-FILE)
  7679*            END-EXEC
  7680*    MOVE '&"S        E          (   #00007633' TO DFHEIV0
  7681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7683     MOVE X'2020233030303037363333' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0,
  7685           CNTL-FILE-ID,
  7686           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 138
* EL131.cbl
  7687           DFHEIV99,
  7688           CNTL-KEY,
  7689           DFHEIV99,
  7690           DFHEIV99,
  7691           DFHEIV99
  7692     SET ADDRESS OF CONTROL-FILE TO
  7693         DFHEIV20
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7695             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7696
  7697     MOVE ER-0000                TO EMI-ERROR.
  7698     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7699
  7700     MOVE SPACE                  TO MAINTO.
  7701     MOVE -1                     TO MAINTL.
  7702     GO TO 8100-SEND-MAP.
  7703
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 139
* EL131.cbl
  7705 0100-UPDATE-PI.
  7706
  7707     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7708     IF WS-RETURNED-FROM = XCTL-EL114
  7709***sometimes there is crap in positions 7-10 when no code was sele
  7710        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7711          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7712        END-IF
  7713     END-IF.
  7714
  7715     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7716         GO TO 0110-UPDATE-UP.
  7717
  7718     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7719     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7720     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7721     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7722     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7723     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7724     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7725     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7726     GO TO 0120-UPDATE-PI-EXIT.
  7727
  7728 0110-UPDATE-UP.
  7729     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7730     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7731     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7732     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7733     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7734     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7735     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7736     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7737
  7738
  7739* EXEC CICS HANDLE CONDITION
  7740*         QIDERR    (0130-TS-ERROR)
  7741*         ITEMERR   (0130-TS-ERROR)
  7742*    END-EXEC.
  7743*    MOVE '"$N<                  ! # #00007681' TO DFHEIV0
  7744     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7746     MOVE X'2320233030303037363831' TO DFHEIV0(25:11)
  7747     CALL 'kxdfhei1' USING DFHEIV0
  7748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7749
  7750
  7751     IF WS-RETURNED-FROM = XCTL-EL114
  7752
  7753* EXEC CICS READQ TS
  7754*            QUEUE    (PI-KEY)
  7755*            INTO     (EL131AI)
  7756*            LENGTH   (MAP-LENGTH)
  7757*       END-EXEC
  7758*    MOVE '*$I    L              ''   #00007687' TO DFHEIV0
  7759     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7761     MOVE X'2020233030303037363837' TO DFHEIV0(25:11)
  7762     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 140
* EL131.cbl
  7763           PI-KEY,
  7764           EL131AI,
  7765           MAP-LENGTH,
  7766           DFHEIV99,
  7767           DFHEIV99,
  7768           DFHEIV99
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7770
  7771        IF WS-SAVE-BENEFICIARY > SPACES
  7772            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7773            MOVE +10            TO BENEL
  7774            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7775        END-IF
  7776        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7777     END-IF.
  7778
  7779
  7780* EXEC CICS READQ TS
  7781*         QUEUE    (PI-KEY)
  7782*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7783*         LENGTH   (PI-COMM-LENGTH)
  7784*    END-EXEC.
  7785*    MOVE '*$I    L              ''   #00007701' TO DFHEIV0
  7786     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7788     MOVE X'2020233030303037373031' TO DFHEIV0(25:11)
  7789     CALL 'kxdfhei1' USING DFHEIV0,
  7790           PI-KEY,
  7791           PROGRAM-INTERFACE-BLOCK,
  7792           PI-COMM-LENGTH,
  7793           DFHEIV99,
  7794           DFHEIV99,
  7795           DFHEIV99
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7797
  7798
  7799
  7800* EXEC CICS DELETEQ TS
  7801*         QUEUE    (PI-KEY)
  7802*    END-EXEC.
  7803*    MOVE '*&                    #   #00007707' TO DFHEIV0
  7804     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7805     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7806     MOVE X'2020233030303037373037' TO DFHEIV0(25:11)
  7807     CALL 'kxdfhei1' USING DFHEIV0,
  7808           PI-KEY,
  7809           DFHEIV99
  7810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7811
  7812
  7813 0120-UPDATE-PI-EXIT.
  7814     EXIT.
  7815
  7816 0130-TS-ERROR.
  7817     MOVE LOW-VALUES             TO EL131AO.
  7818     MOVE ER-0192                TO EMI-ERROR.
  7819
  7820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 141
* EL131.cbl
  7821
  7822     GO TO 8100-SEND-MAP.
  7823
  7824 0200-TRANS-PF.
  7825     IF EIBAID NOT = DFHENTER
  7826         MOVE 'X'                TO ERROR-SWITCH
  7827         GO TO 0210-EXIT.
  7828
  7829     IF PFKEYI NOT NUMERIC
  7830         MOVE 'X'                TO ERROR-SWITCH
  7831         GO TO 0210-EXIT.
  7832
  7833     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7834
  7835     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7836         MOVE 'X' TO ERROR-SWITCH
  7837         GO TO 0210-EXIT.
  7838
  7839     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7840
  7841 0210-EXIT.
  7842     EXIT.
  7843
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 142
* EL131.cbl
  7845 0500-ADD-ALPHA-ONLY.
  7846******************************************************************
  7847*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7848*    RECORD.                                                     *
  7849******************************************************************
  7850
  7851     IF MLNAMEL = +0 AND
  7852        MFNAMEL = +0 AND
  7853        MMINITL = +0
  7854         MOVE ER-0797                TO  EMI-ERROR
  7855         MOVE -1                     TO  MAINTL
  7856         MOVE AL-UABON               TO  MAINTA
  7857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7858         GO TO 8110-SEND-DATA.
  7859
  7860     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7861     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7862     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7863     MOVE PI-CERT-NO                 TO  CERT-NO.
  7864
  7865
  7866* EXEC CICS READ
  7867*        DATASET   (CLMS-FILE-ID)
  7868*        RIDFLD    (MSTR-KEY)
  7869*        SET       (ADDRESS OF CLAIM-MASTER)
  7870*    END-EXEC.
  7871*    MOVE '&"S        E          (   #00007763' TO DFHEIV0
  7872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7874     MOVE X'2020233030303037373633' TO DFHEIV0(25:11)
  7875     CALL 'kxdfhei1' USING DFHEIV0,
  7876           CLMS-FILE-ID,
  7877           DFHEIV20,
  7878           DFHEIV99,
  7879           MSTR-KEY,
  7880           DFHEIV99,
  7881           DFHEIV99,
  7882           DFHEIV99
  7883     SET ADDRESS OF CLAIM-MASTER TO
  7884         DFHEIV20
  7885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7886
  7887
  7888
  7889* EXEC CICS GETMAIN
  7890*        SET       (ADDRESS OF ALPHA-INDEX)
  7891*        LENGTH    (ALPH-LENGTH)
  7892*        INITIMG   (GETMAIN-SPACE)
  7893*    END-EXEC.
  7894*    MOVE ',"IL                  $   #00007769' TO DFHEIV0
  7895     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7896     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7897     MOVE X'2020233030303037373639' TO DFHEIV0(25:11)
  7898     CALL 'kxdfhei1' USING DFHEIV0,
  7899           DFHEIV20,
  7900           ALPH-LENGTH,
  7901           GETMAIN-SPACE
  7902     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 143
* EL131.cbl
  7903         DFHEIV20
  7904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7905
  7906
  7907     MOVE 'AI'                       TO  AI-RECORD-ID.
  7908     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7909                                         AI-CL-COMPANY-CD.
  7910     MOVE 'C'                        TO  AI-SOURCE
  7911                                         AI-CL-SOURCE.
  7912
  7913     IF MLNAMEL IS GREATER THAN +0
  7914         MOVE MLNAMEI                TO  AI-LAST-NAME
  7915     ELSE
  7916         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7917
  7918     IF MFNAMEL IS GREATER THAN +0
  7919         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7920     ELSE
  7921         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7922
  7923     IF MMINITL IS GREATER THAN +0
  7924         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7925     ELSE
  7926         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7927
  7928     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7929     MOVE '5'                        TO  DC-OPTION-CODE.
  7930     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7931     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7932     IF BUILD-YEAR IS GREATER THAN 50
  7933         MOVE '19'                   TO  WS-ALPHA-YY-1
  7934         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7935         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7936         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7937     ELSE
  7938         MOVE '20'                   TO  WS-ALPHA-YY-1
  7939         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7940         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7941         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7942
  7943     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7944                                         AI-CL-DATE.
  7945
  7946     MOVE EIBTIME                    TO  AI-TIME
  7947                                         AI-CL-TIME.
  7948
  7949     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7950     MOVE 'C'                        TO  AI-CL-SOURCE.
  7951     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7952     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7953     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7954     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7955     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7956
  7957     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7958     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7959     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7960
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 144
* EL131.cbl
  7961
  7962* EXEC CICS WRITE
  7963*        DATASET   (ALPH-FILE-ID)
  7964*        RIDFLD    (AI-CONTROL-PRIMARY)
  7965*        FROM      (ALPHA-INDEX)
  7966*    END-EXEC.
  7967     MOVE LENGTH OF
  7968      ALPHA-INDEX
  7969       TO DFHEIV11
  7970*    MOVE '&$ L                  ''   #00007829' TO DFHEIV0
  7971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7973     MOVE X'2020233030303037383239' TO DFHEIV0(25:11)
  7974     CALL 'kxdfhei1' USING DFHEIV0,
  7975           ALPH-FILE-ID,
  7976           ALPHA-INDEX,
  7977           DFHEIV11,
  7978           AI-CONTROL-PRIMARY,
  7979           DFHEIV99,
  7980           DFHEIV99
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7982
  7983
  7984     MOVE LOW-VALUES                 TO  EL131AO.
  7985     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7986     MOVE ER-0000                    TO  EMI-ERROR.
  7987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7988     MOVE -1                         TO  MAINTL.
  7989     GO TO 8100-SEND-MAP.
  7990
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 145
* EL131.cbl
  7992 0600-CHANGE-NAME.
  7993******************************************************************
  7994*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7995*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7996******************************************************************
  7997
  7998     IF MLNAMEL = +0 AND
  7999        MFNAMEL = +0 AND
  8000        MMINITL = +0
  8001         MOVE ER-0276                TO  EMI-ERROR
  8002         MOVE -1                     TO  MAINTL
  8003         MOVE AL-UABON               TO  MAINTA
  8004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8005         GO TO 8110-SEND-DATA.
  8006
  8007     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8008     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8009     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8010     MOVE PI-CERT-NO                 TO  CERT-NO.
  8011
  8012
  8013* EXEC CICS READ
  8014*        DATASET   (CLMS-FILE-ID)
  8015*        RIDFLD    (MSTR-KEY)
  8016*        SET       (ADDRESS OF CLAIM-MASTER)
  8017*    END-EXEC.
  8018*    MOVE '&"S        E          (   #00007863' TO DFHEIV0
  8019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8021     MOVE X'2020233030303037383633' TO DFHEIV0(25:11)
  8022     CALL 'kxdfhei1' USING DFHEIV0,
  8023           CLMS-FILE-ID,
  8024           DFHEIV20,
  8025           DFHEIV99,
  8026           MSTR-KEY,
  8027           DFHEIV99,
  8028           DFHEIV99,
  8029           DFHEIV99
  8030     SET ADDRESS OF CLAIM-MASTER TO
  8031         DFHEIV20
  8032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8033
  8034
  8035
  8036* EXEC CICS GETMAIN
  8037*        SET       (ADDRESS OF ALPHA-INDEX)
  8038*        LENGTH    (ALPH-LENGTH)
  8039*        INITIMG   (GETMAIN-SPACE)
  8040*    END-EXEC.
  8041*    MOVE ',"IL                  $   #00007869' TO DFHEIV0
  8042     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8043     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8044     MOVE X'2020233030303037383639' TO DFHEIV0(25:11)
  8045     CALL 'kxdfhei1' USING DFHEIV0,
  8046           DFHEIV20,
  8047           ALPH-LENGTH,
  8048           GETMAIN-SPACE
  8049     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 146
* EL131.cbl
  8050         DFHEIV20
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054     MOVE 'AI'                       TO  AI-RECORD-ID.
  8055     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8056                                         AI-CL-COMPANY-CD.
  8057     MOVE 'C'                        TO  AI-SOURCE
  8058                                         AI-CL-SOURCE.
  8059
  8060     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8061     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8062     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8063
  8064     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8065     MOVE '5'                        TO  DC-OPTION-CODE.
  8066     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8067     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8068     IF BUILD-YEAR IS GREATER THAN 50
  8069         MOVE '19'                   TO  WS-ALPHA-YY-1
  8070         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8071         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8072         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8073     ELSE
  8074         MOVE '20'                   TO  WS-ALPHA-YY-1
  8075         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8076         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8077         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8078
  8079     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8080                                         AI-CL-DATE.
  8081
  8082     MOVE EIBTIME                    TO  AI-TIME
  8083                                         AI-CL-TIME.
  8084
  8085     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8086     MOVE 'C'                        TO  AI-CL-SOURCE.
  8087     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8088     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8089     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8090     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8091     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8092
  8093     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8094     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8095     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8096
  8097     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8098         MOVE 'Y'                TO CL-YESNOSW
  8099     END-IF.
  8100
  8101
  8102* EXEC CICS WRITE
  8103*        DATASET   (ALPH-FILE-ID)
  8104*        RIDFLD    (AI-CONTROL-PRIMARY)
  8105*        FROM      (ALPHA-INDEX)
  8106*    END-EXEC.
  8107     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 147
* EL131.cbl
  8108      ALPHA-INDEX
  8109       TO DFHEIV11
  8110*    MOVE '&$ L                  ''   #00007922' TO DFHEIV0
  8111     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037393232' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           ALPH-FILE-ID,
  8116           ALPHA-INDEX,
  8117           DFHEIV11,
  8118           AI-CONTROL-PRIMARY,
  8119           DFHEIV99,
  8120           DFHEIV99
  8121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8122
  8123
  8124
  8125* EXEC CICS READ
  8126*        DATASET   (CLMS-FILE-ID)
  8127*        RIDFLD    (MSTR-KEY)
  8128*        SET       (ADDRESS OF CLAIM-MASTER)
  8129*        UPDATE
  8130*    END-EXEC.
  8131*    MOVE '&"S        EU         (   #00007928' TO DFHEIV0
  8132     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8133     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8134     MOVE X'2020233030303037393238' TO DFHEIV0(25:11)
  8135     CALL 'kxdfhei1' USING DFHEIV0,
  8136           CLMS-FILE-ID,
  8137           DFHEIV20,
  8138           DFHEIV99,
  8139           MSTR-KEY,
  8140           DFHEIV99,
  8141           DFHEIV99,
  8142           DFHEIV99
  8143     SET ADDRESS OF CLAIM-MASTER TO
  8144         DFHEIV20
  8145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8146
  8147
  8148     if (cl-priority-cd = '8')
  8149        and (pi-processor-id not = 'PEMA'and 'JMS '
  8150             AND 'AMWA' AND 'KMSB')
  8151        MOVE ER-8003             TO EMI-ERROR
  8152        PERFORM 9900-ERROR-FORMAT
  8153                                 THRU 9900-EXIT
  8154        MOVE -1                  TO MAINTL
  8155        GO TO 8110-SEND-DATA
  8156     end-if
  8157
  8158     IF MLNAMEL IS GREATER THAN +0
  8159         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8160
  8161     IF MFNAMEL IS GREATER THAN +0
  8162         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8163
  8164     IF MMINITL IS GREATER THAN +0
  8165         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 148
* EL131.cbl
  8166
  8167     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8168     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8169     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8170     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8171
  8172     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8173         MOVE 'Y'                TO CL-YESNOSW
  8174     END-IF.
  8175
  8176
  8177* EXEC CICS HANDLE CONDITION
  8178*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8179*    END-EXEC.
  8180*    MOVE '"$$                   ! $ #00007963' TO DFHEIV0
  8181     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8183     MOVE X'2420233030303037393633' TO DFHEIV0(25:11)
  8184     CALL 'kxdfhei1' USING DFHEIV0
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8186
  8187
  8188
  8189* EXEC CICS REWRITE
  8190*        DATASET   (CLMS-FILE-ID)
  8191*        FROM      (CLAIM-MASTER)
  8192*    END-EXEC.
  8193     MOVE LENGTH OF
  8194      CLAIM-MASTER
  8195       TO DFHEIV11
  8196*    MOVE '&& L                  %   #00007967' TO DFHEIV0
  8197     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8198     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8199     MOVE X'2020233030303037393637' TO DFHEIV0(25:11)
  8200     CALL 'kxdfhei1' USING DFHEIV0,
  8201           CLMS-FILE-ID,
  8202           CLAIM-MASTER,
  8203           DFHEIV11,
  8204           DFHEIV99
  8205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8206
  8207
  8208 0600-CONTINUE-NAME-UPDATE.
  8209
  8210     MOVE LOW-VALUES                 TO  EL131AO.
  8211     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8212     MOVE ER-0000                    TO  EMI-ERROR.
  8213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8214     MOVE -1                         TO  MAINTL.
  8215     GO TO 8100-SEND-MAP.
  8216
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 149
* EL131.cbl
  8218 1000-EDIT-SCREEN.
  8219
  8220     MOVE MAINTI                 TO CHECK-MAINT.
  8221
  8222     IF NOT VALID-OPTIONS
  8223         MOVE 'X'                TO ERROR-SWITCH
  8224         MOVE -1                 TO MAINTL
  8225         MOVE AL-UABON           TO MAINTA
  8226         MOVE ER-0023            TO EMI-ERROR
  8227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8228         GO TO 1010-EXIT.
  8229
  8230     IF NOT MODIFY-CAP
  8231         MOVE 'UPDATE'           TO  SM-READ
  8232         PERFORM 9995-SECURITY-VIOLATION
  8233         MOVE ER-0070               TO  EMI-ERROR
  8234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8235         GO TO 8100-SEND-MAP.
  8236
  8237     IF DELETE-CLAIM
  8238         MOVE AL-UANON TO MAINTA
  8239         GO TO 1010-EXIT.
  8240
  8241     MOVE AL-UANON               TO MAINTA.
  8242
  8243     IF CCNOI GREATER THAN LOW-VALUES
  8244         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8245
  8246     IF PI-COMPANY-ID = 'CSL'
  8247        CONTINUE
  8248     ELSE
  8249        IF TYPEL > ZERO
  8250           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8251              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8252                    PI-LIFE-OVERRIDE-L1))
  8253                       OR
  8254              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8255              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8256                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8257              MOVE AL-UANON      TO TYPEA
  8258              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8259           ELSE
  8260              MOVE ER-0199       TO EMI-ERROR
  8261              PERFORM 9900-ERROR-FORMAT
  8262                                 THRU 9900-EXIT
  8263              MOVE AL-UABON      TO TYPEA
  8264              MOVE -1            TO TYPEL
  8265              MOVE 'X'           TO ERROR-SWITCH
  8266           END-IF
  8267        ELSE
  8268           MOVE AL-UANOF         TO TYPEA
  8269        END-IF
  8270     END-IF
  8271     IF STATUSI GREATER THAN LOW-VALUES
  8272         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8273             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8274             MOVE AL-UANON       TO STATUSA
  8275             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 150
* EL131.cbl
  8276             MOVE 'Y'            TO DLYACTV-SW
  8277         ELSE
  8278             MOVE ER-0333        TO EMI-ERROR
  8279             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8280             MOVE AL-UABON       TO STATUSA
  8281             MOVE -1             TO STATUSL
  8282             MOVE 'X'            TO ERROR-SWITCH
  8283         END-IF
  8284     ELSE
  8285         MOVE SPACE              TO TRLR-SWITCH
  8286         MOVE 'N'                TO DLYACTV-SW
  8287         MOVE AL-UANOF           TO STATUSA.
  8288
  8289     IF PROCI GREATER THAN LOW-VALUES
  8290         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8291     ELSE
  8292         MOVE AL-UANOF TO PROCA.
  8293
  8294     IF SEXI GREATER THAN LOW-VALUES
  8295         IF SEXI = 'F' OR 'M'
  8296             MOVE AL-UANON       TO SEXA
  8297             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8298           ELSE
  8299             MOVE ER-0219        TO EMI-ERROR
  8300             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8301             MOVE AL-UABON       TO SEXA
  8302             MOVE -1             TO SEXL
  8303             MOVE 'X'            TO ERROR-SWITCH
  8304       ELSE
  8305         MOVE AL-UANOF           TO SEXA.
  8306
  8307     IF BIRTHL = +0
  8308         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8309         MOVE AL-UANOF           TO  BIRTHA
  8310         GO TO 1000-CONTINUE-EDITS.
  8311
  8312     IF BIRTHI = SPACES
  8313         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8314         MOVE 'X'                TO  UPDATE-SWITCH
  8315                                     MSTR-SWITCH
  8316         GO TO 1000-CONTINUE-EDITS.
  8317
  8318     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8319     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8320     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8321     MOVE '4'                    TO  DC-OPTION-CODE.
  8322     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8323     IF DATE-CONVERSION-ERROR
  8324         MOVE ER-0220            TO  EMI-ERROR
  8325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8326         MOVE AL-UABON           TO  BIRTHA
  8327         MOVE -1                 TO  BIRTHL
  8328         MOVE 'X'                TO  ERROR-SWITCH
  8329         GO TO 1000-CONTINUE-EDITS.
  8330
  8331******************************************************************
  8332**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8333**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 151
* EL131.cbl
  8334**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8335******************************************************************
  8336     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8337         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8338         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8339         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8340         MOVE '4'                TO  DC-OPTION-CODE
  8341         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8342         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8343                                     DC-ELAPSED-DAYS
  8344         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8345         IF DATE-CONVERSION-ERROR
  8346             MOVE ER-0220        TO  EMI-ERROR
  8347             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8348             MOVE AL-UABON       TO  BIRTHA
  8349             MOVE -1             TO  BIRTHL
  8350             MOVE 'X'            TO  ERROR-SWITCH
  8351             GO TO 1000-CONTINUE-EDITS.
  8352
  8353     MOVE AL-UANON               TO  BIRTHA.
  8354     MOVE 'X'                    TO  UPDATE-SWITCH
  8355                                     MSTR-SWITCH.
  8356     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8357     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8358     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8359
  8360 1000-CONTINUE-EDITS.
  8361
  8362     IF SOCIALI GREATER THAN LOW-VALUES
  8363         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8364         IF WS-SOC-SEC-NO NUMERIC AND
  8365           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8366             NEXT SENTENCE
  8367         ELSE
  8368            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8369               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8370               WS-SSN-DASH2 = '-'
  8371                 NEXT SENTENCE
  8372            ELSE
  8373                 MOVE ER-0887        TO  EMI-ERROR
  8374                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8375                 MOVE AL-UABON       TO  SOCIALA
  8376                 MOVE -1             TO  SOCIALL
  8377                 MOVE 'X'            TO  ERROR-SWITCH
  8378            END-IF
  8379        END-IF
  8380     END-IF.
  8381     if critpl > zeros
  8382        and critpi numeric
  8383        move al-uanon            to critpa
  8384        move 'X'                 to update-switch
  8385     end-if
  8386     IF SOCIALI GREATER THAN LOW-VALUES
  8387         MOVE AL-UANON           TO SOCIALA
  8388         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8389     ELSE
  8390         MOVE AL-UANOF           TO SOCIALA.
  8391
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 152
* EL131.cbl
  8392     IF OCCI GREATER THAN LOW-VALUES
  8393         MOVE AL-UANON           TO OCCA
  8394         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8395     ELSE
  8396         MOVE AL-UANOF           TO OCCA.
  8397
  8398     IF BENEL NOT GREATER THAN ZERO
  8399            GO TO 1005-CONTINUE-EDITS.
  8400
  8401     IF BENEI = SPACES
  8402        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8403           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8404           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8405           IF AUTO-PAY-TO-BENE = 'Y'
  8406               MOVE ER-1773      TO  EMI-ERROR
  8407               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8408               MOVE 'X'          TO ERROR-SWITCH
  8409               MOVE AL-UABON     TO BENEA
  8410               MOVE -1           TO BENEL
  8411           ELSE
  8412               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8413           END-IF
  8414        ELSE
  8415           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8416           IF PAYMENT-PENDING
  8417               MOVE ER-1772      TO  EMI-ERROR
  8418               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419               MOVE 'X'          TO ERROR-SWITCH
  8420               MOVE AL-UABON     TO BENEA
  8421               MOVE -1           TO BENEL
  8422           END-IF
  8423           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8424        END-IF
  8425        GO TO 1005-CONTINUE-EDITS.
  8426
  8427
  8428* EXEC CICS HANDLE CONDITION
  8429*        NOTFND (1004-BENE-NOT-FOUND)
  8430*    END-EXEC.
  8431*    MOVE '"$I                   ! % #00008191' TO DFHEIV0
  8432     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8434     MOVE X'2520233030303038313931' TO DFHEIV0(25:11)
  8435     CALL 'kxdfhei1' USING DFHEIV0
  8436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8437
  8438
  8439     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8440     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8441     MOVE BENEI                  TO  WS-ELBENE-ID.
  8442
  8443
  8444* EXEC CICS READ
  8445*        DATASET ('ELBENE')
  8446*        RIDFLD  (WS-ELBENE-KEY)
  8447*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8448*    END-EXEC.
  8449     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 153
* EL131.cbl
  8450*    MOVE '&"S        E          (   #00008199' TO DFHEIV0
  8451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8453     MOVE X'2020233030303038313939' TO DFHEIV0(25:11)
  8454     CALL 'kxdfhei1' USING DFHEIV0,
  8455           DFHEIV1,
  8456           DFHEIV20,
  8457           DFHEIV99,
  8458           WS-ELBENE-KEY,
  8459           DFHEIV99,
  8460           DFHEIV99,
  8461           DFHEIV99
  8462     SET ADDRESS OF BENEFICIARY-MASTER TO
  8463         DFHEIV20
  8464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8465
  8466
  8467     MOVE AL-UANON               TO  BENEA.
  8468     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8469
  8470     GO TO 1005-CONTINUE-EDITS.
  8471
  8472 1004-BENE-NOT-FOUND.
  8473     MOVE ER-0565                TO  EMI-ERROR.
  8474
  8475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8476     MOVE 'X'                    TO ERROR-SWITCH.
  8477     MOVE AL-UABON               TO BENEA.
  8478     MOVE -1                     TO BENEL.
  8479
  8480 1005-CONTINUE-EDITS.
  8481
  8482     IF DIAGI GREATER THAN LOW-VALUES
  8483         MOVE AL-UANON           TO DIAGA
  8484         MOVE 'X'                TO UPDATE-SWITCH
  8485                                    NINETY-TRLR-SWITCH
  8486     ELSE
  8487         MOVE AL-UANOF           TO DIAGA.
  8488
  8489     IF ICD1I GREATER THAN LOW-VALUES
  8490         IF (ICD1I GREATER THAN SPACES) AND
  8491            (ICD1I(4:1) NOT = '.')
  8492             IF ICD1I(4:1) = ' '
  8493                 MOVE '.' TO ICD1I(4:1)
  8494             ELSE
  8495                 IF ICD1I(8:1) = ' '
  8496                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8497                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8498                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8499                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8500                     MOVE '.'        TO ICD1I(4:1)
  8501                 END-IF
  8502             END-IF
  8503         END-IF
  8504         IF (ICD1I GREATER THAN SPACES) AND
  8505            (ICD1I(1:1) NOT > ' ' OR
  8506             ICD1I(2:1) NOT > ' ' OR
  8507             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 154
* EL131.cbl
  8508             ICD1I(4:1) NOT = '.')
  8509              MOVE ER-0992        TO  EMI-ERROR
  8510              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8511              MOVE 'X'            TO ERROR-SWITCH
  8512              MOVE AL-UABON       TO ICD1A
  8513              MOVE -1             TO ICD1L
  8514         ELSE
  8515             MOVE AL-UANON       TO ICD1A
  8516             MOVE 'X'            TO UPDATE-SWITCH
  8517                                    NINETY-TRLR-SWITCH
  8518         END-IF
  8519     ELSE
  8520         MOVE AL-UANOF           TO ICD1A
  8521     END-IF.
  8522
  8523     IF ICD2I GREATER THAN LOW-VALUES
  8524         IF (ICD2I GREATER THAN SPACES) AND
  8525            (ICD2I(4:1) NOT = '.')
  8526             IF ICD2I(4:1) = ' '
  8527                 MOVE '.' TO ICD2I(4:1)
  8528             ELSE
  8529                 IF ICD2I(8:1) = ' '
  8530                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8531                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8532                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8533                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8534                     MOVE '.'        TO ICD2I(4:1)
  8535                 END-IF
  8536             END-IF
  8537         END-IF
  8538         IF (ICD2I GREATER THAN SPACES) AND
  8539            (ICD2I(1:1) NOT > ' ' OR
  8540             ICD2I(2:1) NOT > ' ' OR
  8541             ICD2I(3:1) NOT > ' ' OR
  8542             ICD2I(4:1) NOT = '.')
  8543              MOVE ER-0992        TO EMI-ERROR
  8544              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8545              MOVE 'X'            TO ERROR-SWITCH
  8546              MOVE AL-UABON       TO ICD2A
  8547              MOVE -1             TO ICD2L
  8548         ELSE
  8549             MOVE AL-UANON       TO ICD2A
  8550             MOVE 'X'            TO UPDATE-SWITCH
  8551                                    NINETY-TRLR-SWITCH
  8552         END-IF
  8553     ELSE
  8554         MOVE AL-UANOF           TO ICD2A
  8555     END-IF.
  8556
  8557*    IF CAUSEI GREATER THAN LOW-VALUES
  8558*        MOVE AL-UANON           TO CAUSEA
  8559*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8560*    ELSE
  8561*        MOVE AL-UANOF           TO CAUSEA.
  8562
  8563*    IF ENDL GREATER THAN ZERO
  8564*        MOVE LOW-VALUES         TO HOLD-END
  8565*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 155
* EL131.cbl
  8566*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8567*        ELSE
  8568*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8569*            EXEC CICS BIF DEEDIT
  8570*                FIELD    (DEEDIT-DATE-INPUT)
  8571*                LENGTH   (DATE-LENGTH)
  8572*            END-EXEC
  8573*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8574*            MOVE '4'            TO DC-OPTION-CODE
  8575*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8576*            IF NOT DATE-CONVERSION-ERROR
  8577*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8578*                MOVE AL-UANON   TO ENDA
  8579*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8580*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8581*            ELSE
  8582*                MOVE ER-0224    TO EMI-ERROR
  8583*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8584*                MOVE AL-UABON   TO ENDA
  8585*                MOVE -1         TO ENDL
  8586*                MOVE 'X'        TO ERROR-SWITCH
  8587*      ELSE
  8588*          MOVE AL-UANOF         TO ENDA.
  8589
  8590     IF INCL GREATER THAN ZERO
  8591         MOVE LOW-VALUES         TO HOLD-INCUR
  8592         IF INCI = SPACES
  8593             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8594         ELSE
  8595             MOVE INCI           TO DEEDIT-DATE-INPUT
  8596
  8597* EXEC CICS BIF DEEDIT
  8598*                FIELD    (DEEDIT-DATE-INPUT)
  8599*                LENGTH   (DATE-LENGTH)
  8600*            END-EXEC
  8601*    MOVE '@"L                   #   #00008334' TO DFHEIV0
  8602     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8603     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8604     MOVE X'2020233030303038333334' TO DFHEIV0(25:11)
  8605     CALL 'kxdfhei1' USING DFHEIV0,
  8606           DEEDIT-DATE-INPUT,
  8607           DATE-LENGTH
  8608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8609             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8610             MOVE '4'            TO DC-OPTION-CODE
  8611             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8612             IF NOT DATE-CONVERSION-ERROR
  8613                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8614                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8615                 MOVE AL-UANON           TO INCA
  8616                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8617             ELSE
  8618                 MOVE ER-0222    TO EMI-ERROR
  8619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8620                 MOVE AL-UABON   TO INCA
  8621                 MOVE -1         TO INCL
  8622                 MOVE 'X'        TO ERROR-SWITCH
  8623       ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 156
* EL131.cbl
  8624           IF PI-NO-PMTS = ZEROS
  8625               MOVE AL-UANOF     TO INCA.
  8626
  8627     IF REPL GREATER THAN ZERO
  8628         MOVE LOW-VALUES         TO HOLD-REPORTED
  8629         IF REPI = SPACES
  8630             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8631         ELSE
  8632             MOVE REPI           TO DEEDIT-DATE-INPUT
  8633
  8634* EXEC CICS BIF DEEDIT
  8635*                FIELD    (DEEDIT-DATE-INPUT)
  8636*                LENGTH   (DATE-LENGTH)
  8637*            END-EXEC
  8638*    MOVE '@"L                   #   #00008362' TO DFHEIV0
  8639     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8640     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8641     MOVE X'2020233030303038333632' TO DFHEIV0(25:11)
  8642     CALL 'kxdfhei1' USING DFHEIV0,
  8643           DEEDIT-DATE-INPUT,
  8644           DATE-LENGTH
  8645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8646             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8647             MOVE '4'            TO DC-OPTION-CODE
  8648             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8649             IF NOT DATE-CONVERSION-ERROR
  8650                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8651                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8652                 MOVE AL-UANON   TO REPA
  8653                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8654             ELSE
  8655                 MOVE ER-0223    TO EMI-ERROR
  8656                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8657                 MOVE AL-UABON   TO REPA
  8658                 MOVE -1         TO REPL
  8659                 MOVE 'X'        TO ERROR-SWITCH
  8660       ELSE
  8661         MOVE AL-UANOF TO REPA.
  8662
  8663     IF PDTHRUI GREATER THAN LOW-VALUES
  8664        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8665        IF PDTHRUI = SPACES
  8666           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8667        ELSE
  8668           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8669
  8670* EXEC CICS BIF DEEDIT
  8671*               FIELD    (DEEDIT-DATE-INPUT)
  8672*               LENGTH   (DATE-LENGTH)
  8673*          END-EXEC
  8674*    MOVE '@"L                   #   #00008389' TO DFHEIV0
  8675     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8676     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8677     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  8678     CALL 'kxdfhei1' USING DFHEIV0,
  8679           DEEDIT-DATE-INPUT,
  8680           DATE-LENGTH
  8681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 157
* EL131.cbl
  8682           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8683           MOVE '4'            TO DC-OPTION-CODE
  8684           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8685           IF NOT DATE-CONVERSION-ERROR
  8686              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8687              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8688              MOVE AL-UANON   TO PDTHRUA
  8689              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8690              IF PI-USES-PAID-TO
  8691                 MOVE '6'            TO DC-OPTION-CODE
  8692                 MOVE -1             TO DC-ELAPSED-DAYS
  8693                 MOVE +0             TO DC-ELAPSED-MONTHS
  8694                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8695                 IF NO-CONVERSION-ERROR
  8696                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8697                 ELSE
  8698                    NEXT SENTENCE
  8699              ELSE
  8700                 NEXT SENTENCE
  8701           ELSE
  8702              MOVE ER-0475    TO EMI-ERROR
  8703              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704              MOVE AL-UABON   TO PDTHRUA
  8705              MOVE -1         TO PDTHRUL
  8706              MOVE 'X'        TO ERROR-SWITCH
  8707     ELSE
  8708        IF MODIFY-CAP
  8709           MOVE AL-UANOF        TO PDTHRUA.
  8710
  8711     IF PDAMTL GREATER THAN +0
  8712         MOVE ZEROS              TO HOLD-PDAMT
  8713
  8714* EXEC CICS BIF DEEDIT
  8715*            FIELD    (PDAMTI)
  8716*            LENGTH   (9)
  8717*        END-EXEC
  8718     MOVE 9
  8719       TO DFHEIV11
  8720*    MOVE '@"L                   #   #00008424' TO DFHEIV0
  8721     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8722     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8723     MOVE X'2020233030303038343234' TO DFHEIV0(25:11)
  8724     CALL 'kxdfhei1' USING DFHEIV0,
  8725           PDAMTI,
  8726           DFHEIV11
  8727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8728         IF PDAMTI NUMERIC
  8729             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8730             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8731             MOVE AL-UNNON       TO PDAMTA
  8732         ELSE
  8733             MOVE ER-0547        TO EMI-ERROR
  8734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8735             MOVE AL-UNBON       TO PDAMTA
  8736             MOVE -1             TO PDAMTL
  8737             MOVE 'X'            TO ERROR-SWITCH
  8738     ELSE
  8739         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 158
* EL131.cbl
  8740            MOVE AL-UNNOF        TO PDAMTA.
  8741
  8742     IF NODAYSI GREATER THAN LOW-VALUES
  8743         MOVE ZEROS              TO HOLD-NODAYS
  8744
  8745* EXEC CICS BIF DEEDIT
  8746*            FIELD (NODAYSI)
  8747*            LENGTH (5)
  8748*        END-EXEC
  8749     MOVE 5
  8750       TO DFHEIV11
  8751*    MOVE '@"L                   #   #00008444' TO DFHEIV0
  8752     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8754     MOVE X'2020233030303038343434' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0,
  8756           NODAYSI,
  8757           DFHEIV11
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8759         IF NODAYSI NUMERIC
  8760             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8761             MOVE AL-UNNON       TO NODAYSA
  8762             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8763         ELSE
  8764             MOVE ER-0491        TO EMI-ERROR
  8765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8766             MOVE AL-UNBON       TO NODAYSA
  8767             MOVE -1             TO NODAYSL
  8768             MOVE 'X'            TO ERROR-SWITCH
  8769     ELSE
  8770         IF MODIFY-CAP
  8771            MOVE AL-UNNOF        TO NODAYSA.
  8772
  8773     IF NOPMTSI GREATER THAN LOW-VALUES
  8774         MOVE ZEROS              TO HOLD-NOPMTS
  8775
  8776* EXEC CICS BIF DEEDIT
  8777*            FIELD (NOPMTSI)
  8778*            LENGTH (4)
  8779*        END-EXEC
  8780     MOVE 4
  8781       TO DFHEIV11
  8782*    MOVE '@"L                   #   #00008464' TO DFHEIV0
  8783     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8784     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8785     MOVE X'2020233030303038343634' TO DFHEIV0(25:11)
  8786     CALL 'kxdfhei1' USING DFHEIV0,
  8787           NOPMTSI,
  8788           DFHEIV11
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8790         IF NOPMTSI NUMERIC
  8791             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8792             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8793             MOVE AL-UNNON       TO NOPMTSA
  8794           ELSE
  8795             MOVE ER-0548        TO EMI-ERROR
  8796             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8797             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 159
* EL131.cbl
  8798             MOVE -1             TO NOPMTSL
  8799             MOVE 'X'            TO ERROR-SWITCH
  8800       ELSE
  8801         IF MODIFY-CAP
  8802            MOVE AL-UNNOF        TO NOPMTSA.
  8803
  8804     IF FORMTYPI GREATER THAN LOW-VALUES
  8805         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8806             MOVE AL-UANON       TO FORMTYPA
  8807             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8808           ELSE
  8809             MOVE ER-7650        TO EMI-ERROR
  8810             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8811             MOVE AL-UABON       TO FORMTYPA
  8812             MOVE -1             TO FORMTYPL
  8813             MOVE 'X'            TO ERROR-SWITCH
  8814       ELSE
  8815         MOVE AL-UANOF           TO FORMTYPA.
  8816
  8817     IF PRICDL GREATER THAN ZERO
  8818         IF (PRICDI = ' ') OR
  8819            (PRICDI GREATER THAN ZERO   AND
  8820             PRICDI NOT GREATER THAN '9')
  8821             MOVE AL-UANON       TO PRICDA
  8822             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8823         ELSE
  8824             MOVE ER-0274        TO EMI-ERROR
  8825             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8826             MOVE AL-UABON       TO PRICDA
  8827             MOVE -1             TO PRICDL
  8828             MOVE 'X'            TO ERROR-SWITCH
  8829     ELSE
  8830         MOVE AL-UANOF TO PRICDA.
  8831
  8832     IF PI-COMPANY-ID = 'DMD'
  8833     IF PRICDL GREATER THAN ZERO
  8834       IF SYSTEM-MODIFY-CAP  OR
  8835          PI-PROCESSOR-ID = 'LGXX'
  8836             NEXT SENTENCE
  8837           ELSE
  8838            IF CL-PRIORITY-CD = '9'  OR
  8839               PRICDI         = '9'
  8840                  MOVE ER-0938        TO EMI-ERROR
  8841                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8842                  MOVE AL-UABON       TO PRICDA
  8843                  MOVE -1             TO PRICDL
  8844                  MOVE 'X'            TO ERROR-SWITCH.
  8845
  8846     IF FILETOL GREATER THAN ZERO
  8847         MOVE AL-UANON           TO FILETOA
  8848         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8849     ELSE
  8850         MOVE AL-UANOF TO FILETOA.
  8851
  8852     IF SUPVL GREATER THAN ZERO
  8853         IF SUPVI = 'Y' OR 'N' OR SPACE
  8854             MOVE AL-UANON       TO SUPVA
  8855             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 160
* EL131.cbl
  8856         ELSE
  8857             MOVE ER-0230        TO EMI-ERROR
  8858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8859             MOVE AL-UABON       TO SUPVA
  8860             MOVE -1             TO SUPVL
  8861             MOVE 'X'            TO ERROR-SWITCH
  8862     ELSE
  8863         MOVE AL-UANOF           TO SUPVA.
  8864
  8865     IF MLNAMEL GREATER THAN ZERO
  8866         IF MLNAMEI GREATER THAN SPACES
  8867            MOVE AL-UANON        TO MLNAMEA
  8868            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8869                                     MSTR-KEY-SWITCH
  8870         ELSE
  8871            MOVE ER-0236         TO EMI-ERROR
  8872            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8873            MOVE AL-UABON        TO MLNAMEA
  8874            MOVE -1              TO MLNAMEL
  8875            MOVE 'X'             TO ERROR-SWITCH
  8876     ELSE
  8877         MOVE AL-UANOF           TO MLNAMEA.
  8878
  8879     IF MFNAMEI GREATER THAN LOW-VALUES
  8880         MOVE AL-UANON           TO MFNAMEA
  8881         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8882     ELSE
  8883         MOVE AL-UANOF           TO MFNAMEA.
  8884
  8885     IF MMINITI GREATER THAN LOW-VALUES
  8886         MOVE AL-UANON           TO MMINITA
  8887         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8888     ELSE
  8889         MOVE AL-UANOF           TO MMINITA.
  8890
  8891     IF CRTLNMEI GREATER THAN LOW-VALUES
  8892         IF CRTLNMEI NOT = SPACES
  8893            MOVE AL-UANON        TO CRTLNMEA
  8894            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8895                                     CERT-KEY-SWITCH
  8896        ELSE
  8897            MOVE ER-0236         TO EMI-ERROR
  8898            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8899            MOVE AL-UABON        TO CRTLNMEA
  8900            MOVE -1              TO CRTLNMEL
  8901            MOVE 'X'             TO ERROR-SWITCH
  8902     ELSE
  8903         MOVE AL-UANOF           TO CRTLNMEA.
  8904
  8905     IF CRTFNMEI GREATER THAN LOW-VALUES
  8906         MOVE AL-UANON           TO CRTFNMEA
  8907         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8908     ELSE
  8909         MOVE AL-UANOF           TO CRTFNMEA.
  8910
  8911     IF CRTINITI GREATER THAN LOW-VALUES
  8912         MOVE AL-UANON           TO CRTINITA
  8913         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 161
* EL131.cbl
  8914     ELSE
  8915         MOVE AL-UANOF           TO CRTINITA.
  8916
  8917     IF ISSAGEL GREATER THAN ZERO
  8918         IF ISSAGEI NUMERIC
  8919            MOVE AL-UANON        TO ISSAGEA
  8920            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8921         ELSE
  8922            MOVE ER-0237         TO EMI-ERROR
  8923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8924            MOVE AL-UABON        TO ISSAGEA
  8925            MOVE -1              TO ISSAGEL
  8926            MOVE 'X'             TO ERROR-SWITCH
  8927     ELSE
  8928         MOVE AL-UANOF           TO ISSAGEA.
  8929
  8930     IF JNTFNMEI GREATER THAN LOW-VALUES
  8931         MOVE AL-UANON           TO JNTFNMEA
  8932         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8933     ELSE
  8934         MOVE AL-UANOF           TO JNTFNMEA.
  8935
  8936     IF JNTLNMEI GREATER THAN LOW-VALUES
  8937         MOVE AL-UANON           TO JNTLNMEA
  8938         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8939     ELSE
  8940         MOVE AL-UANOF           TO JNTLNMEA.
  8941
  8942     IF JNTINITI GREATER THAN LOW-VALUES
  8943         MOVE AL-UANON           TO JNTINITA
  8944         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8945     ELSE
  8946         MOVE AL-UANOF           TO JNTINITA.
  8947
  8948     IF JNTAGEL GREATER THAN ZERO
  8949         IF JNTAGEI NUMERIC
  8950            MOVE AL-UANON        TO JNTAGEA
  8951            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8952         ELSE
  8953            MOVE ER-0238         TO EMI-ERROR
  8954            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8955            MOVE AL-UABON        TO JNTAGEA
  8956            MOVE -1              TO JNTAGEL
  8957            MOVE 'X'             TO ERROR-SWITCH
  8958     ELSE
  8959         MOVE AL-UANOF           TO JNTAGEA.
  8960
  8961     IF ADDONDTI GREATER THAN LOW-VALUES
  8962         MOVE LOW-VALUES         TO HOLD-ADDON
  8963         IF ADDONDTI = SPACES
  8964             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8965         ELSE
  8966             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8967
  8968* EXEC CICS BIF DEEDIT
  8969*                FIELD    (DEEDIT-DATE-INPUT)
  8970*                LENGTH   (DATE-LENGTH)
  8971*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 162
* EL131.cbl
  8972*    MOVE '@"L                   #   #00008645' TO DFHEIV0
  8973     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8974     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8975     MOVE X'2020233030303038363435' TO DFHEIV0(25:11)
  8976     CALL 'kxdfhei1' USING DFHEIV0,
  8977           DEEDIT-DATE-INPUT,
  8978           DATE-LENGTH
  8979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8980             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8981             MOVE '4'            TO DC-OPTION-CODE
  8982             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8983             IF NOT DATE-CONVERSION-ERROR
  8984                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8985                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8986                                                  CERT-SWITCH
  8987                 MOVE AL-UANON   TO ADDONDTA
  8988                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8989             ELSE
  8990                 MOVE ER-7651    TO EMI-ERROR
  8991                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8992                 MOVE AL-UABON   TO ADDONDTA
  8993                 MOVE -1         TO ADDONDTL
  8994                 MOVE 'X'        TO ERROR-SWITCH
  8995       ELSE
  8996         MOVE AL-UANOF TO ADDONDTA.
  8997
  8998     IF LCVCDI GREATER THAN LOW-VALUES
  8999         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9000         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9001     ELSE
  9002         MOVE AL-UANOF           TO LCVCDA.
  9003
  9004     IF ACVCDI GREATER THAN LOW-VALUES
  9005         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9006         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9007     ELSE
  9008         MOVE AL-UANOF           TO ACVCDA.
  9009
  9010     IF LCVOTRMI GREATER THAN LOW-VALUES
  9011
  9012* EXEC CICS BIF DEEDIT
  9013*            FIELD (LCVOTRMI)
  9014*            LENGTH(3)
  9015*        END-EXEC
  9016     MOVE 3
  9017       TO DFHEIV11
  9018*    MOVE '@"L                   #   #00008680' TO DFHEIV0
  9019     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9020     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9021     MOVE X'2020233030303038363830' TO DFHEIV0(25:11)
  9022     CALL 'kxdfhei1' USING DFHEIV0,
  9023           LCVOTRMI,
  9024           DFHEIV11
  9025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9026         IF LCVOTRMI IS NUMERIC
  9027             MOVE LCVOTRMI       TO LCVOTRMO
  9028             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9029             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 163
* EL131.cbl
  9030         ELSE
  9031             MOVE ER-0241        TO EMI-ERROR
  9032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9033             MOVE AL-UNBON       TO LCVOTRMA
  9034             MOVE 'X'            TO ERROR-SWITCH
  9035             MOVE -1             TO LCVOTRML
  9036     ELSE
  9037         MOVE AL-UANOF           TO LCVOTRMA.
  9038
  9039     IF ACVOTRMI GREATER THAN LOW-VALUES
  9040
  9041* EXEC CICS BIF DEEDIT
  9042*            FIELD (ACVOTRMI)
  9043*            LENGTH(3)
  9044*        END-EXEC
  9045     MOVE 3
  9046       TO DFHEIV11
  9047*    MOVE '@"L                   #   #00008698' TO DFHEIV0
  9048     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9049     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9050     MOVE X'2020233030303038363938' TO DFHEIV0(25:11)
  9051     CALL 'kxdfhei1' USING DFHEIV0,
  9052           ACVOTRMI,
  9053           DFHEIV11
  9054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9055         IF ACVOTRMI IS NUMERIC
  9056             MOVE ACVOTRMI       TO ACVOTRMO
  9057             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9058             MOVE AL-UANON       TO ACVOTRMA
  9059         ELSE
  9060             MOVE ER-0241        TO EMI-ERROR
  9061             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9062             MOVE AL-UNBON       TO ACVOTRMA
  9063             MOVE 'X'            TO ERROR-SWITCH
  9064             MOVE -1             TO ACVOTRML
  9065     ELSE
  9066         MOVE AL-UANOF           TO ACVOTRMA.
  9067
  9068     IF LCVRATEL GREATER THAN +0
  9069
  9070* EXEC CICS BIF DEEDIT
  9071*            FIELD (LCVRATEI)
  9072*            LENGTH(6)
  9073*        END-EXEC
  9074     MOVE 6
  9075       TO DFHEIV11
  9076*    MOVE '@"L                   #   #00008716' TO DFHEIV0
  9077     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9079     MOVE X'2020233030303038373136' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           LCVRATEI,
  9082           DFHEIV11
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9084         IF LCVRATEI IS NUMERIC
  9085             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9086             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9087             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 164
* EL131.cbl
  9088         ELSE
  9089             MOVE ER-2280        TO EMI-ERROR
  9090             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9091             MOVE AL-UNBON       TO LCVRATEA
  9092             MOVE 'X'            TO ERROR-SWITCH
  9093             MOVE -1             TO LCVRATEL
  9094     ELSE
  9095         MOVE AL-UNNOF           TO LCVRATEA.
  9096
  9097     IF ACVRATEL GREATER THAN +0
  9098
  9099* EXEC CICS BIF DEEDIT
  9100*            FIELD (ACVRATEI)
  9101*            LENGTH(6)
  9102*        END-EXEC
  9103     MOVE 6
  9104       TO DFHEIV11
  9105*    MOVE '@"L                   #   #00008734' TO DFHEIV0
  9106     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9107     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9108     MOVE X'2020233030303038373334' TO DFHEIV0(25:11)
  9109     CALL 'kxdfhei1' USING DFHEIV0,
  9110           ACVRATEI,
  9111           DFHEIV11
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9113         IF ACVRATEI IS NUMERIC
  9114             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9115             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9116             MOVE AL-UNNON       TO ACVRATEA
  9117         ELSE
  9118             MOVE ER-2280        TO EMI-ERROR
  9119             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9120             MOVE AL-UNBON       TO ACVRATEA
  9121             MOVE 'X'            TO ERROR-SWITCH
  9122             MOVE -1             TO ACVRATEL
  9123     ELSE
  9124         MOVE AL-UNNOF           TO ACVRATEA.
  9125
  9126     IF LCVBENEL GREATER THAN ZERO
  9127
  9128* EXEC CICS BIF DEEDIT
  9129*            FIELD (LCVBENEI)
  9130*            LENGTH (11)
  9131*        END-EXEC
  9132     MOVE 11
  9133       TO DFHEIV11
  9134*    MOVE '@"L                   #   #00008752' TO DFHEIV0
  9135     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9137     MOVE X'2020233030303038373532' TO DFHEIV0(25:11)
  9138     CALL 'kxdfhei1' USING DFHEIV0,
  9139           LCVBENEI,
  9140           DFHEIV11
  9141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9142         IF LCVBENEI IS NUMERIC
  9143            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9144            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9145            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 165
* EL131.cbl
  9146         ELSE
  9147            MOVE ER-0243         TO EMI-ERROR
  9148            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9149            MOVE AL-UNBON        TO LCVBENEA
  9150            MOVE -1              TO LCVBENEL
  9151            MOVE 'X'             TO ERROR-SWITCH
  9152     ELSE
  9153         MOVE AL-UANOF           TO LCVBENEA.
  9154
  9155     IF ACVBENEL GREATER THAN ZERO
  9156
  9157* EXEC CICS BIF DEEDIT
  9158*            FIELD (ACVBENEI)
  9159*            LENGTH (11)
  9160*        END-EXEC
  9161     MOVE 11
  9162       TO DFHEIV11
  9163*    MOVE '@"L                   #   #00008770' TO DFHEIV0
  9164     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9165     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9166     MOVE X'2020233030303038373730' TO DFHEIV0(25:11)
  9167     CALL 'kxdfhei1' USING DFHEIV0,
  9168           ACVBENEI,
  9169           DFHEIV11
  9170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9171         IF ACVBENEI IS NUMERIC
  9172            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9173            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9174            MOVE AL-UNNON        TO ACVBENEA
  9175         ELSE
  9176            MOVE ER-0243         TO EMI-ERROR
  9177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9178            MOVE AL-UNBON        TO ACVBENEA
  9179            MOVE -1              TO ACVBENEL
  9180            MOVE 'X'             TO ERROR-SWITCH
  9181     ELSE
  9182         MOVE AL-UANOF           TO ACVBENEA.
  9183
  9184     IF LCVFORMI GREATER THAN LOW-VALUES
  9185        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9186        MOVE AL-UANON            TO LCVFORMA
  9187     ELSE
  9188        MOVE AL-UANOF            TO LCVFORMA.
  9189
  9190     IF ACVFORMI GREATER THAN LOW-VALUES
  9191        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9192        MOVE AL-UANON            TO ACVFORMA
  9193     ELSE
  9194        MOVE AL-UANOF            TO ACVFORMA.
  9195
  9196     IF LCVCNDTL GREATER THAN ZERO
  9197         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9198         IF LCVCNDTI = SPACES
  9199             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9200         ELSE
  9201             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9202             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9203             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 166
* EL131.cbl
  9204             MOVE '4'            TO DC-OPTION-CODE
  9205             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9206             IF NOT DATE-CONVERSION-ERROR
  9207                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9208                 MOVE AL-UANON   TO LCVCNDTA
  9209                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9210                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9211             ELSE
  9212                 MOVE ER-0246    TO EMI-ERROR
  9213                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9214                 MOVE AL-UABON   TO LCVCNDTA
  9215                 MOVE -1         TO LCVCNDTL
  9216                 MOVE 'X'        TO ERROR-SWITCH
  9217     ELSE
  9218         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9219         MOVE AL-UANOF           TO LCVCNDTA.
  9220
  9221     IF ACVCNDTL GREATER THAN ZERO
  9222         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9223         IF ACVCNDTI = SPACES
  9224             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9225         ELSE
  9226             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9227             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9228             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9229             MOVE '4'            TO DC-OPTION-CODE
  9230             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9231             IF NOT DATE-CONVERSION-ERROR
  9232                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9233                 MOVE AL-UANON   TO ACVCNDTA
  9234                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9235                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9236             ELSE
  9237                 MOVE ER-0246    TO EMI-ERROR
  9238                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9239                 MOVE AL-UABON   TO ACVCNDTA
  9240                 MOVE -1         TO ACVCNDTL
  9241                 MOVE 'X'        TO ERROR-SWITCH
  9242     ELSE
  9243         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9244         MOVE AL-UANOF           TO ACVCNDTA.
  9245
  9246     IF APRL GREATER THAN +0
  9247
  9248* EXEC CICS BIF DEEDIT
  9249*            FIELD    (APRI)
  9250*            LENGTH   (8)
  9251*        END-EXEC
  9252     MOVE 8
  9253       TO DFHEIV11
  9254*    MOVE '@"L                   #   #00008850' TO DFHEIV0
  9255     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9256     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9257     MOVE X'2020233030303038383530' TO DFHEIV0(25:11)
  9258     CALL 'kxdfhei1' USING DFHEIV0,
  9259           APRI,
  9260           DFHEIV11
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 167
* EL131.cbl
  9262         IF APRI NUMERIC
  9263            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9264            MOVE APRI            TO HOLD-APR APRO
  9265            MOVE AL-UANON        TO APRA
  9266          ELSE
  9267            MOVE ER-0259         TO EMI-ERROR
  9268            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9269            MOVE AL-UABON        TO APRA
  9270            MOVE -1              TO APRL
  9271            MOVE 'X'             TO ERROR-SWITCH
  9272     ELSE
  9273         MOVE AL-UANOF           TO APRA.
  9274
  9275     IF PMTFREQL GREATER THAN ZERO
  9276
  9277* EXEC CICS BIF DEEDIT
  9278*            FIELD    (PMTFREQI)
  9279*            LENGTH   (2)
  9280*        END-EXEC
  9281     MOVE 2
  9282       TO DFHEIV11
  9283*    MOVE '@"L                   #   #00008868' TO DFHEIV0
  9284     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9285     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9286     MOVE X'2020233030303038383638' TO DFHEIV0(25:11)
  9287     CALL 'kxdfhei1' USING DFHEIV0,
  9288           PMTFREQI,
  9289           DFHEIV11
  9290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9291         IF PMTFREQI NUMERIC
  9292            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9293            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9294            MOVE AL-UANON        TO PMTFREQA
  9295          ELSE
  9296            MOVE ER-0427         TO EMI-ERROR
  9297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9298            MOVE AL-UABON        TO PMTFREQA
  9299            MOVE -1              TO PMTFREQL
  9300            MOVE 'X'             TO ERROR-SWITCH
  9301     ELSE
  9302         MOVE AL-UANOF           TO PMTFREQA.
  9303
  9304     IF INDGRPL GREATER THAN ZERO
  9305         IF INDGRPI = 'I' OR 'G' OR SPACE
  9306             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9307             MOVE AL-UANON       TO INDGRPA
  9308          ELSE
  9309             MOVE ER-0260        TO EMI-ERROR
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9311             MOVE AL-UABON       TO INDGRPA
  9312             MOVE -1             TO INDGRPL
  9313             MOVE 'X'            TO ERROR-SWITCH
  9314     ELSE
  9315         MOVE AL-UANOF           TO INDGRPA.
  9316
  9317     IF PREMTYPL GREATER THAN ZERO
  9318         IF PREMTYPI = '1' OR '2' OR '3'
  9319            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 168
* EL131.cbl
  9320            MOVE AL-UNNON        TO PREMTYPA
  9321            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9322          ELSE
  9323            MOVE ER-0227         TO EMI-ERROR
  9324            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9325            MOVE AL-UNBON        TO PREMTYPA
  9326            MOVE -1              TO PREMTYPL
  9327            MOVE 'X'             TO ERROR-SWITCH
  9328     ELSE
  9329         MOVE AL-UANOF           TO PREMTYPA.
  9330
  9331     IF LOANBALL GREATER THAN ZERO
  9332
  9333* EXEC CICS BIF DEEDIT
  9334*             FIELD    (LOANBALI)
  9335*             LENGTH   (9)
  9336*        END-EXEC
  9337     MOVE 9
  9338       TO DFHEIV11
  9339*    MOVE '@"L                   #   #00008913' TO DFHEIV0
  9340     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9341     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9342     MOVE X'2020233030303038393133' TO DFHEIV0(25:11)
  9343     CALL 'kxdfhei1' USING DFHEIV0,
  9344           LOANBALI,
  9345           DFHEIV11
  9346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9347         IF LOANBALI NUMERIC
  9348             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9349             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9350             MOVE AL-UNNON TO LOANBALA
  9351         ELSE
  9352             MOVE ER-0639        TO EMI-ERROR
  9353             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9354             MOVE AL-UNBON       TO LOANBALA
  9355             MOVE -1             TO LOANBALL
  9356             MOVE 'X'            TO ERROR-SWITCH
  9357     ELSE
  9358         MOVE AL-UNNOF           TO LOANBALA.
  9359
  9360*    IF LOANNOL GREATER THAN ZERO
  9361*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9362*          MOVE AL-UANON            TO LOANNOA
  9363*       ELSE
  9364*          MOVE AL-UANOF            TO LOANNOA.
  9365
  9366     IF REINCDI GREATER THAN LOW-VALUES
  9367        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9368        MOVE AL-UANON            TO REINCDA
  9369     ELSE
  9370        MOVE AL-UANOF            TO REINCDA.
  9371
  9372     IF CERTI GREATER THAN LOW-VALUES
  9373         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9374     ELSE
  9375         MOVE AL-UANOF           TO CERTA.
  9376
  9377     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 169
* EL131.cbl
  9378         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9379     ELSE
  9380         MOVE AL-UANOF           TO CERTEFFA.
  9381
  9382     IF CERTACTI GREATER THAN LOW-VALUES
  9383         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9384     ELSE
  9385         MOVE AL-UANOF           TO CERTACTA.
  9386
  9387     IF CERTSTI GREATER THAN LOW-VALUES
  9388         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9389     ELSE
  9390         MOVE AL-UANOF           TO CERTSTA.
  9391
  9392     IF CERTCARI GREATER THAN LOW-VALUES
  9393         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9394     ELSE
  9395         MOVE AL-UANOF           TO CERTCARA.
  9396
  9397     IF DLYACTV-RECORD-NEEDED
  9398         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9399                 1150-EXIT
  9400     END-IF.
  9401
  9402     IF CERTEFFI GREATER LOW-VALUES OR
  9403        CERTACTI GREATER LOW-VALUES OR
  9404        CERTSTI  GREATER LOW-VALUES OR
  9405        CERTCARI GREATER LOW-VALUES OR
  9406        CERTGRPI GREATER LOW-VALUES
  9407        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9408
  9409*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9410*      IF PI-PREM-TYPE NOT = '1'  AND
  9411*         PI-NO-PMTS = ZEROS
  9412*          IF LOANBALL GREATER +0 OR
  9413*             ACVBENEL GREATER +0
  9414*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9415     if not acct-found
  9416        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9417     end-if
  9418     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9419     MOVE PI-CARRIER             TO CARRIER-CODE
  9420     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9421     MOVE PI-CERT-NO             TO CERT-NO
  9422
  9423* EXEC CICS READ
  9424*        DATASET   (CLMS-FILE-ID)
  9425*        RIDFLD    (MSTR-KEY)
  9426*        SET       (ADDRESS OF CLAIM-MASTER)
  9427*        RESP      (WS-RESPONSE)
  9428*    END-EXEC
  9429*    MOVE '&"S        E          (  N#00008992' TO DFHEIV0
  9430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9432     MOVE X'204E233030303038393932' TO DFHEIV0(25:11)
  9433     CALL 'kxdfhei1' USING DFHEIV0,
  9434           CLMS-FILE-ID,
  9435           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 170
* EL131.cbl
  9436           DFHEIV99,
  9437           MSTR-KEY,
  9438           DFHEIV99,
  9439           DFHEIV99,
  9440           DFHEIV99
  9441     SET ADDRESS OF CLAIM-MASTER TO
  9442         DFHEIV20
  9443     MOVE EIBRESP  TO WS-RESPONSE
  9444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9445     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9446     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9447     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9448     MOVE CL-CERT-STATE          TO CERT-STATE
  9449     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9450     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9451     MOVE CL-CERT-NO             TO CERT-CERT
  9452
  9453* EXEC CICS READ
  9454*       DATASET   (CERT-FILE-ID)
  9455*       RIDFLD    (CERT-KEY)
  9456*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9457*       RESP      (WS-RESPONSE)
  9458*    END-EXEC
  9459*    MOVE '&"S        E          (  N#00009005' TO DFHEIV0
  9460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9462     MOVE X'204E233030303039303035' TO DFHEIV0(25:11)
  9463     CALL 'kxdfhei1' USING DFHEIV0,
  9464           CERT-FILE-ID,
  9465           DFHEIV20,
  9466           DFHEIV99,
  9467           CERT-KEY,
  9468           DFHEIV99,
  9469           DFHEIV99,
  9470           DFHEIV99
  9471     SET ADDRESS OF CERTIFICATE-MASTER TO
  9472         DFHEIV20
  9473     MOVE EIBRESP  TO WS-RESPONSE
  9474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9475     if mfnamei > low-values
  9476        move mfnamei to w-name-first
  9477     else
  9478        move cl-insured-1st-name to w-name-first
  9479     end-if
  9480     if mlnamei > low-values
  9481        move mlnamei to w-name-last
  9482     else
  9483        move cl-insured-last-name to w-name-last
  9484     end-if
  9485     if instypel > zeros
  9486        evaluate true
  9487           when cl-no-of-days-paid > zeros
  9488              move er-1668       to emi-error
  9489              perform 9900-error-format
  9490                                 thru 9900-exit
  9491              move al-uabon      to instypea
  9492              move -1            to instypel
  9493              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 171
* EL131.cbl
  9494           when instypei = 'C'
  9495              if w-name-first (1:10) = cm-insured-first-name
  9496                 move er-1666    to emi-error
  9497                 PERFORM 9900-ERROR-FORMAT
  9498                                 THRU 9900-EXIT
  9499                 move al-uabon   to instypea
  9500                 move -1         to instypel
  9501                 move 'X'        to error-switch
  9502              end-if
  9503           when instypei = 'P'
  9504              if (w-name-first (1:10) <> cm-insured-first-name)
  9505                 or (w-name-last <> cm-insured-last-name)
  9506                 move er-1676    to emi-error
  9507                 PERFORM 9900-ERROR-FORMAT
  9508                                 THRU 9900-EXIT
  9509                 move al-uabon   to instypea
  9510                 move -1         to instypel
  9511                 move 'X'        to error-switch
  9512              end-if
  9513        end-evaluate
  9514     end-if
  9515*    if (instypel > zeros)
  9516*       and (cl-no-of-days-paid > zero)
  9517*       move er-1668             to emi-error
  9518*       perform 9900-error-format thru 9900-exit
  9519*       move al-uabon            to instypea
  9520*       move -1                  to instypel
  9521*       move 'X'                 to error-switch
  9522*    end-if
  9523*
  9524*    if instypel > zero
  9525*       if instypei = 'C'
  9526*          if w-name-first (1:10) = cm-insured-first-name
  9527*             move er-1666          to emi-error
  9528*             PERFORM 9900-ERROR-FORMAT
  9529*                                   THRU 9900-EXIT
  9530*             move al-uabon         to instypea
  9531*             move -1               to instypel
  9532*             move 'X'              to error-switch
  9533*          end-if
  9534*       end-if
  9535*    end-if
  9536     if (pi-company-id = 'DCC' OR 'VPP')
  9537        and (acct-found)
  9538        perform 2120-check-pdef  thru 2120-exit
  9539     end-if
  9540     if benperl > zeros
  9541        move al-uanon            to benpera
  9542     end-if
  9543     if benperl > zeros
  9544        if benperi numeric
  9545           perform 1015-edit-benefit-period
  9546                                 thru 1015-exit
  9547        else
  9548           move er-1669          to emi-error
  9549           PERFORM 9900-ERROR-FORMAT
  9550                                 THRU 9900-EXIT
  9551           move al-uabon         to benpera
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 172
* EL131.cbl
  9552           move -1               to benperl
  9553           move 'X'              to error-switch
  9554        end-if
  9555    end-if
  9556     if instypel > zeros
  9557        if instypei = 'P' OR 'C'
  9558           move 'X'              to update-switch
  9559                                    mstr-switch
  9560           move al-uanon         to instypea
  9561        else
  9562            move er-1654          to emi-error
  9563           PERFORM 9900-ERROR-FORMAT
  9564                                 THRU 9900-EXIT
  9565           move al-uabon         to instypea
  9566           move -1               to instypel
  9567           move 'X'              to error-switch
  9568        end-if
  9569    end-if
  9570     if accswl > zeros
  9571        if accswi = 'Y' OR 'N'
  9572           MOVE 'X'              TO UPDATE-SWITCH
  9573                                    MSTR-SWITCH
  9574           MOVE AL-UANON         TO accswa
  9575*       else
  9576*          move er-1656          to emi-error
  9577*          PERFORM 9900-ERROR-FORMAT
  9578*                                THRU 9900-EXIT
  9579*          move al-uabon         to accswa
  9580*          move -1               to accswl
  9581*          move 'X'              to error-switch
  9582*          move al-uanof         to accswa
  9583        end-if
  9584     end-if
  9585     IF CERTL = ZEROS AND
  9586        SUFXL = ZEROS
  9587          GO TO 1010-EXIT.
  9588
  9589     IF CERTL GREATER THAN ZEROS
  9590         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9591             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9592             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9593             MOVE 'X'            TO ERROR-SWITCH
  9594             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9595
  9596     IF SUFXL GREATER THAN ZEROS
  9597         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9598             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9599             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9600             MOVE 'X'            TO ERROR-SWITCH
  9601             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9602
  9603 1010-EXIT.
  9604     EXIT.
  9605
  9606 1015-edit-benefit-period.
  9607     move ' '                    to ws-benper-sw
  9608     evaluate true
  9609        when not erpdef-found
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 173
* EL131.cbl
  9610           set good-benper       to true
  9611        when pd-recurring-yn (a1) = 'Y'
  9612           set good-benper       to true
  9613        when pd-recurring-yn (a1) = 'N'
  9614           if benperi < 02
  9615              set good-benper    to true
  9616           end-if
  9617        when pd-rec-crit-period (a1) numeric
  9618           if benperi <= pd-rec-crit-period (a1)
  9619              set good-benper    to true
  9620           end-if
  9621     end-evaluate
  9622     MOVE CERT-KEY               TO ELCRTT-KEY
  9623     MOVE 'B'                    TO CTRLR-REC-TYPE
  9624
  9625* EXEC CICS READ
  9626*       DATASET   ('ELCRTT')
  9627*       RIDFLD    (ELCRTT-KEY)
  9628*       INTO      (CERTIFICATE-TRAILERS)
  9629*       RESP      (WS-RESPONSE)
  9630*    END-EXEC
  9631     MOVE LENGTH OF
  9632      CERTIFICATE-TRAILERS
  9633       TO DFHEIV11
  9634     MOVE 'ELCRTT' TO DFHEIV1
  9635*    MOVE '&"IL       E          (  N#00009160' TO DFHEIV0
  9636     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9638     MOVE X'204E233030303039313630' TO DFHEIV0(25:11)
  9639     CALL 'kxdfhei1' USING DFHEIV0,
  9640           DFHEIV1,
  9641           CERTIFICATE-TRAILERS,
  9642           DFHEIV11,
  9643           ELCRTT-KEY,
  9644           DFHEIV99,
  9645           DFHEIV99,
  9646           DFHEIV99
  9647     MOVE EIBRESP  TO WS-RESPONSE
  9648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9649     IF WS-RESP-NORMAL
  9650        perform varying s1 from +1 by +1 until
  9651           (s1 > +24)
  9652           or ((cs-claim-type (s1) = cl-claim-type)
  9653           and (cs-insured-type (s1) = cl-insured-type)
  9654           and (cs-benefit-period (s1) > benperi))
  9655        end-perform
  9656        if s1 < +25
  9657           move er-1665          to emi-error
  9658           PERFORM 9900-ERROR-FORMAT
  9659                                 THRU 9900-EXIT
  9660           move al-uabon         to benpera
  9661           move -1               to benperl
  9662           move 'X'              to error-switch
  9663           go to 1015-exit
  9664*       else
  9665*          set good-benper       to true
  9666        end-if
  9667     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 174
* EL131.cbl
  9668     if good-benper
  9669        move 'X'                 to update-switch
  9670                                    mstr-switch
  9671        move al-uanon            to benpera
  9672     else
  9673        move er-1669             to emi-error
  9674        PERFORM 9900-ERROR-FORMAT
  9675                                 THRU 9900-EXIT
  9676        move al-uabon            to benpera
  9677        move -1                  to benperl
  9678        move 'X'                 to error-switch
  9679     end-if
  9680     .
  9681 1015-exit.
  9682     exit.
  9683 1050-EDIT-BENE.
  9684     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9685     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9686     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9687     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9688     MOVE 1000               TO TRLR-SEQ-NO.
  9689
  9690
  9691* EXEC CICS HANDLE CONDITION
  9692*         NOTFND    (1052-DONE)
  9693*         ENDFILE   (1052-DONE)
  9694*    END-EXEC.
  9695*    MOVE '"$I''                  ! & #00009207' TO DFHEIV0
  9696     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9698     MOVE X'2620233030303039323037' TO DFHEIV0(25:11)
  9699     CALL 'kxdfhei1' USING DFHEIV0
  9700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9701
  9702
  9703
  9704* EXEC CICS STARTBR
  9705*        DATASET (TRLR-FILE-ID)
  9706*        RIDFLD  (TRLR-KEY)
  9707*    END-EXEC
  9708     MOVE 0
  9709       TO DFHEIV11
  9710*    MOVE '&,         G          &   #00009212' TO DFHEIV0
  9711     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9713     MOVE X'2020233030303039323132' TO DFHEIV0(25:11)
  9714     CALL 'kxdfhei1' USING DFHEIV0,
  9715           TRLR-FILE-ID,
  9716           TRLR-KEY,
  9717           DFHEIV99,
  9718           DFHEIV11,
  9719           DFHEIV99
  9720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9721
  9722
  9723     MOVE SPACES TO WS-TRLR-FILE-EOF
  9724                    WS-PAYMENT-PENDING
  9725     PERFORM 1052-READ-TRLR THRU 1052-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 175
* EL131.cbl
  9726       UNTIL  TRLR-FILE-EOF
  9727         OR PAYMENT-PENDING
  9728
  9729
  9730* EXEC CICS ENDBR
  9731*        DATASET (TRLR-FILE-ID)
  9732*    END-EXEC.
  9733     MOVE 0
  9734       TO DFHEIV11
  9735*    MOVE '&2                    $   #00009224' TO DFHEIV0
  9736     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9738     MOVE X'2020233030303039323234' TO DFHEIV0(25:11)
  9739     CALL 'kxdfhei1' USING DFHEIV0,
  9740           TRLR-FILE-ID,
  9741           DFHEIV11,
  9742           DFHEIV99
  9743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9744
  9745 1050-EXIT.
  9746     EXIT.
  9747
  9748 1052-READ-TRLR.
  9749
  9750* EXEC CICS READNEXT
  9751*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9752*         DATASET  (TRLR-FILE-ID)
  9753*         RIDFLD   (TRLR-KEY)
  9754*    END-EXEC.
  9755     MOVE 0
  9756       TO DFHEIV11
  9757*    MOVE '&.S                   )   #00009231' TO DFHEIV0
  9758     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9759     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9760     MOVE X'2020233030303039323331' TO DFHEIV0(25:11)
  9761     CALL 'kxdfhei1' USING DFHEIV0,
  9762           TRLR-FILE-ID,
  9763           DFHEIV20,
  9764           DFHEIV99,
  9765           TRLR-KEY,
  9766           DFHEIV99,
  9767           DFHEIV11,
  9768           DFHEIV99,
  9769           DFHEIV99
  9770     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9771         DFHEIV20
  9772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9773
  9774
  9775     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9776       AND PI-CARRIER  = TRLR-CARRIER
  9777       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9778       AND PI-CERT-NO  = TRLR-CERT-NO
  9779        CONTINUE
  9780     ELSE
  9781        GO TO 1052-DONE
  9782     END-IF.
  9783
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 176
* EL131.cbl
  9784     IF PAYMENT-TR
  9785       AND BENEFICIARY-PAID
  9786       AND AT-VOID-DT = LOW-VALUES
  9787       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9788         SET PAYMENT-PENDING TO TRUE
  9789     END-IF.
  9790
  9791     IF CORRESPONDENCE-TR
  9792        IF AT-AUTH-RCVD = 'Y'
  9793           SET AUTH-RCVD TO TRUE
  9794        ELSE
  9795        IF AT-AUTH-RCVD = 'N'
  9796           SET NO-AUTH-RCVD TO TRUE
  9797        END-IF
  9798        END-IF
  9799     END-IF.
  9800
  9801     GO TO 1052-EXIT.
  9802
  9803 1052-DONE.
  9804     SET TRLR-FILE-EOF TO TRUE.
  9805 1052-EXIT.
  9806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 177
* EL131.cbl
  9808 1120-EDIT-PROC.
  9809     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9810     MOVE '2'                    TO CNTL-REC-TYPE.
  9811     MOVE PROCI                  TO CNTL-PROC-ID.
  9812     MOVE ZERO                   TO CNTL-SEQ-NO.
  9813
  9814
  9815* EXEC CICS HANDLE CONDITION
  9816*         NOTFND    (1120-CNTL-NOTFND)
  9817*    END-EXEC.
  9818*    MOVE '"$I                   ! '' #00009276' TO DFHEIV0
  9819     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9821     MOVE X'2720233030303039323736' TO DFHEIV0(25:11)
  9822     CALL 'kxdfhei1' USING DFHEIV0
  9823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9824
  9825
  9826
  9827* EXEC CICS READ
  9828*         SET      (ADDRESS OF CONTROL-FILE)
  9829*         DATASET  (CNTL-FILE-ID)
  9830*         RIDFLD   (CNTL-KEY)
  9831*    END-EXEC.
  9832*    MOVE '&"S        E          (   #00009280' TO DFHEIV0
  9833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9835     MOVE X'2020233030303039323830' TO DFHEIV0(25:11)
  9836     CALL 'kxdfhei1' USING DFHEIV0,
  9837           CNTL-FILE-ID,
  9838           DFHEIV20,
  9839           DFHEIV99,
  9840           CNTL-KEY,
  9841           DFHEIV99,
  9842           DFHEIV99,
  9843           DFHEIV99
  9844     SET ADDRESS OF CONTROL-FILE TO
  9845         DFHEIV20
  9846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9847
  9848
  9849     MOVE AL-UANON               TO PROCA.
  9850     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9851     GO TO 1120-EXIT.
  9852
  9853 1120-CNTL-NOTFND.
  9854     MOVE ER-0273                TO EMI-ERROR.
  9855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9856     MOVE AL-UABON               TO PROCA.
  9857     MOVE -1                     TO PROCL.
  9858     MOVE 'X'                    TO ERROR-SWITCH.
  9859
  9860 1120-EXIT.
  9861     EXIT.
  9862
  9863*************************************************************
  9864*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9865*************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 178
* EL131.cbl
  9866
  9867 1150-OUTPUT-ACTIVITY-RECORD.
  9868
  9869
  9870* EXEC CICS GETMAIN
  9871*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9872*        LENGTH (25)
  9873*        INITIMG (WS-BLANK)
  9874*    END-EXEC.
  9875     MOVE 25
  9876       TO DFHEIV11
  9877*    MOVE ',"IL                  $   #00009306' TO DFHEIV0
  9878     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9880     MOVE X'2020233030303039333036' TO DFHEIV0(25:11)
  9881     CALL 'kxdfhei1' USING DFHEIV0,
  9882           DFHEIV20,
  9883           DFHEIV11,
  9884           WS-BLANK
  9885     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9886         DFHEIV20
  9887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9888
  9889
  9890     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9891     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9892     MOVE PI-CARRIER             TO DA-CARRIER.
  9893     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9894     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9895     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9896     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9897
  9898
  9899* EXEC CICS HANDLE CONDITION
  9900*        NOTOPEN (1150-NOTOPEN-ERROR)
  9901*        DUPREC (1150-EXIT)
  9902*    END-EXEC.
  9903*    MOVE '"$J%                  ! ( #00009320' TO DFHEIV0
  9904     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9906     MOVE X'2820233030303039333230' TO DFHEIV0(25:11)
  9907     CALL 'kxdfhei1' USING DFHEIV0
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9909
  9910     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9911     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9912     MOVE 'A'                    TO JP-RECORD-TYPE.
  9913     MOVE +48                    TO JOURNAL-LENGTH.
  9914
  9915
  9916* EXEC CICS WRITE
  9917*        DATASET ('DLYACTV')
  9918*        RIDFLD (DA-KEY)
  9919*        FROM (DAILY-ACTIVITY-RECORD)
  9920*        LENGTH (25)
  9921*    END-EXEC.
  9922     MOVE 'DLYACTV' TO DFHEIV1
  9923     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 179
* EL131.cbl
  9924       TO DFHEIV11
  9925*    MOVE '&$ L                  ''   #00009329' TO DFHEIV0
  9926     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9928     MOVE X'2020233030303039333239' TO DFHEIV0(25:11)
  9929     CALL 'kxdfhei1' USING DFHEIV0,
  9930           DFHEIV1,
  9931           DAILY-ACTIVITY-RECORD,
  9932           DFHEIV11,
  9933           DA-KEY,
  9934           DFHEIV99,
  9935           DFHEIV99
  9936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9937
  9938
  9939     GO TO 1150-EXIT.
  9940
  9941 1150-NOTOPEN-ERROR.
  9942
  9943     MOVE '2955'                 TO EMI-ERROR.
  9944     MOVE -1                     TO MAINTL.
  9945     MOVE AL-UANON               TO MAINTA.
  9946     MOVE 'X'                    TO ERROR-SWITCH.
  9947     PERFORM 9900-ERROR-FORMAT THRU
  9948             9900-EXIT.
  9949
  9950 1150-EXIT.
  9951     EXIT.
  9952
  9953*************************************************************
  9954*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9955*************************************************************
  9956
  9957 1240-EDIT-LIFE-CODE.
  9958
  9959     IF INVALID-BENEFIT-CODE
  9960         GO TO 1240-SET-ERROR.
  9961
  9962     MOVE SPACES                 TO BENEFIT-KEY.
  9963     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9964     MOVE '4'                    TO BEN-REC-TYPE.
  9965     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9966     MOVE ZERO                   TO BEN-SEQ-NO.
  9967
  9968
  9969* EXEC CICS READ GTEQ
  9970*         DATASET  (CNTL-FILE-ID)
  9971*         RIDFLD   (BENEFIT-KEY)
  9972*         SET      (ADDRESS OF CONTROL-FILE)
  9973*    END-EXEC.
  9974*    MOVE '&"S        G          (   #00009365' TO DFHEIV0
  9975     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9977     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
  9978     CALL 'kxdfhei1' USING DFHEIV0,
  9979           CNTL-FILE-ID,
  9980           DFHEIV20,
  9981           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 180
* EL131.cbl
  9982           BENEFIT-KEY,
  9983           DFHEIV99,
  9984           DFHEIV99,
  9985           DFHEIV99
  9986     SET ADDRESS OF CONTROL-FILE TO
  9987         DFHEIV20
  9988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9989
  9990
  9991     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9992        CF-RECORD-TYPE NOT = '4'
  9993         GO TO 1240-SET-ERROR.
  9994
  9995     MOVE ZERO                   TO COUNT-2.
  9996     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9997
  9998     IF SCREEN-ERROR
  9999         GO TO 1240-SET-ERROR.
 10000
 10001 1240-SET-CODE-SWITCHES.
 10002     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10003     MOVE AL-UANON               TO LCVCDA.
 10004     GO TO 1240-EXIT.
 10005
 10006 1240-SET-ERROR.
 10007     MOVE ER-0240                TO EMI-ERROR.
 10008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10009     MOVE 'X'                    TO ERROR-SWITCH.
 10010     MOVE AL-UABON               TO LCVCDA.
 10011     MOVE -1                     TO LCVCDL.
 10012
 10013 1240-EXIT.
 10014     EXIT.
 10015
 10016 1310-EDIT-AH-CODE.
 10017     IF INVALID-BENEFIT-CODE
 10018         GO TO 1310-SET-ERROR.
 10019
 10020     MOVE SPACES                 TO BENEFIT-KEY.
 10021     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10022     MOVE '5'                    TO BEN-REC-TYPE.
 10023     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10024     MOVE ZERO                   TO BEN-SEQ-NO.
 10025
 10026
 10027* EXEC CICS READ GTEQ
 10028*         DATASET  (CNTL-FILE-ID)
 10029*         RIDFLD   (BENEFIT-KEY)
 10030*         SET      (ADDRESS OF CONTROL-FILE)
 10031*    END-EXEC.
 10032*    MOVE '&"S        G          (   #00009406' TO DFHEIV0
 10033     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10035     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10036     CALL 'kxdfhei1' USING DFHEIV0,
 10037           CNTL-FILE-ID,
 10038           DFHEIV20,
 10039           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 181
* EL131.cbl
 10040           BENEFIT-KEY,
 10041           DFHEIV99,
 10042           DFHEIV99,
 10043           DFHEIV99
 10044     SET ADDRESS OF CONTROL-FILE TO
 10045         DFHEIV20
 10046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10047
 10048
 10049     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10050        CF-RECORD-TYPE NOT = '5'
 10051         GO TO 1310-SET-ERROR.
 10052
 10053     MOVE ZERO                   TO COUNT-2.
 10054     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10055     IF SCREEN-ERROR
 10056         GO TO 1310-SET-ERROR.
 10057
 10058 1310-SET-CODE-SWITCHES.
 10059     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10060     MOVE AL-UANON               TO ACVCDA.
 10061     GO TO 1310-EXIT.
 10062
 10063 1310-SET-ERROR.
 10064     MOVE ER-0250                TO EMI-ERROR.
 10065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10066     MOVE AL-UABON               TO ACVCDA.
 10067     MOVE 'X'                    TO ERROR-SWITCH.
 10068     MOVE -1                     TO ACVCDL.
 10069
 10070 1310-EXIT.
 10071     EXIT.
 10072
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 182
* EL131.cbl
 10074 1460-EDIT-CERT-NO.
 10075     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10076     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10077
 10078     IF WS-SAVE-CERT-NO = SPACES
 10079         MOVE ER-0203            TO EMI-ERROR
 10080         GO TO 1460-CERT-NO-ERROR.
 10081
 10082     IF WS-CERT-NO-PRIME = SPACES AND
 10083        WS-CERT-NO-SUFX GREATER THAN SPACE
 10084            MOVE ER-0210         TO EMI-ERROR
 10085            GO TO 1460-CERT-NO-ERROR.
 10086
 10087     MOVE 'X'                    TO UPDATE-SWITCH.
 10088     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10089     MOVE AL-UANON               TO CERTA.
 10090
 10091     IF SUFXL IS GREATER THAN 0
 10092         MOVE AL-UANON           TO SUFXA.
 10093
 10094     GO TO 1460-EXIT.
 10095
 10096 1460-CERT-NO-ERROR.
 10097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10098     MOVE AL-UABON               TO SUFXA.
 10099     MOVE AL-UABON               TO CERTA.
 10100     MOVE -1                     TO CERTL.
 10101     MOVE 'X'                    TO ERROR-SWITCH.
 10102
 10103 1460-EXIT.
 10104     EXIT.
 10105
 10106 1470-EDIT-EFF.
 10107     IF CERTEFFI = SPACES
 10108         GO TO 1470-DATE-ERROR.
 10109
 10110     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10111     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10112     IF DEEDIT-DATE = ZERO
 10113         GO TO 1470-DATE-ERROR.
 10114
 10115     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10116     MOVE '4'                    TO DC-OPTION-CODE.
 10117     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10118     IF NOT DATE-CONVERSION-ERROR
 10119         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10120         MOVE AL-UANON           TO CERTEFFA
 10121         MOVE 'X'                TO UPDATE-SWITCH
 10122         MOVE 'Y'                TO CERT-KEY-SWITCH
 10123         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10124         GO TO 1470-EXIT.
 10125
 10126 1470-DATE-ERROR.
 10127     MOVE ER-0215                TO EMI-ERROR.
 10128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10129     MOVE AL-UABON               TO CERTEFFA.
 10130     MOVE -1                     TO CERTEFFL.
 10131     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 183
* EL131.cbl
 10132
 10133 1470-EXIT.
 10134     EXIT.
 10135
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 184
* EL131.cbl
 10137 1480-EDIT-ACCT.
 10138     IF CERTACTI = SPACES
 10139         MOVE ER-0232            TO EMI-ERROR
 10140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10141         MOVE AL-UABON           TO CERTACTA
 10142         MOVE -1                 TO CERTACTL
 10143         MOVE 'X'                TO ERROR-SWITCH
 10144     ELSE
 10145         MOVE 'X'                TO UPDATE-SWITCH
 10146         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10147
 10148 1480-EXIT.
 10149     EXIT.
 10150
 10151 1490-EDIT-STATE.
 10152     IF CERTSTI = SPACES
 10153         MOVE ER-0233            TO EMI-ERROR
 10154         GO TO 1490-STATE-ERROR.
 10155
 10156     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10157     MOVE '3'                    TO CNTL-REC-TYPE.
 10158     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10159     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10160     MOVE ZERO                   TO CNTL-SEQ-NO.
 10161
 10162
 10163* EXEC CICS HANDLE CONDITION
 10164*         NOTFND (1490-STATE-NOTFND)
 10165*    END-EXEC.
 10166*    MOVE '"$I                   ! ) #00009525' TO DFHEIV0
 10167     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10169     MOVE X'2920233030303039353235' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0
 10171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10172
 10173
 10174
 10175* EXEC CICS READ
 10176*         SET        (ADDRESS OF CONTROL-FILE)
 10177*         DATASET    ('ELCNTL')
 10178*         RIDFLD     (CNTL-KEY)
 10179*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10180*         GENERIC
 10181*    END-EXEC.
 10182     MOVE 'ELCNTL' TO DFHEIV1
 10183*    MOVE '&"S  KG    E          (   #00009529' TO DFHEIV0
 10184     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10186     MOVE X'2020233030303039353239' TO DFHEIV0(25:11)
 10187     CALL 'kxdfhei1' USING DFHEIV0,
 10188           DFHEIV1,
 10189           DFHEIV20,
 10190           DFHEIV99,
 10191           CNTL-KEY,
 10192           CNTL-GENERIC-LENGTH,
 10193           DFHEIV99,
 10194           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 185
* EL131.cbl
 10195     SET ADDRESS OF CONTROL-FILE TO
 10196         DFHEIV20
 10197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10198
 10199
 10200     MOVE AL-UANON               TO CERTSTA.
 10201     MOVE 'X'                    TO UPDATE-SWITCH.
 10202     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10203     GO TO 1490-EXIT.
 10204
 10205 1490-STATE-NOTFND.
 10206     MOVE ER-0149                TO EMI-ERROR.
 10207
 10208 1490-STATE-ERROR.
 10209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10210     MOVE AL-UABON               TO CERTSTA.
 10211     MOVE -1                     TO CERTSTL.
 10212     MOVE 'X'                    TO ERROR-SWITCH.
 10213
 10214 1490-EXIT.
 10215     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 186
* EL131.cbl
 10217 1500-EDIT-CARR.
 10218     IF CERTCARI = SPACES
 10219         GO TO 1500-CARR-NOTFND.
 10220
 10221     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10222     MOVE '6'                    TO CNTL-REC-TYPE.
 10223     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10224     MOVE CERTCARI               TO CNTL-CARRIER.
 10225     MOVE ZERO                   TO CNTL-SEQ-NO.
 10226
 10227
 10228* EXEC CICS HANDLE CONDITION
 10229*         NOTFND   (1500-CARR-NOTFND)
 10230*    END-EXEC.
 10231*    MOVE '"$I                   ! * #00009564' TO DFHEIV0
 10232     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10234     MOVE X'2A20233030303039353634' TO DFHEIV0(25:11)
 10235     CALL 'kxdfhei1' USING DFHEIV0
 10236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10237
 10238
 10239
 10240* EXEC CICS READ
 10241*         SET        (ADDRESS OF CONTROL-FILE)
 10242*         DATASET    ('ELCNTL')
 10243*         RIDFLD     (CNTL-KEY)
 10244*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10245*         GENERIC
 10246*    END-EXEC.
 10247     MOVE 'ELCNTL' TO DFHEIV1
 10248*    MOVE '&"S  KG    E          (   #00009568' TO DFHEIV0
 10249     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10251     MOVE X'2020233030303039353638' TO DFHEIV0(25:11)
 10252     CALL 'kxdfhei1' USING DFHEIV0,
 10253           DFHEIV1,
 10254           DFHEIV20,
 10255           DFHEIV99,
 10256           CNTL-KEY,
 10257           CNTL-GENERIC-LENGTH,
 10258           DFHEIV99,
 10259           DFHEIV99
 10260     SET ADDRESS OF CONTROL-FILE TO
 10261         DFHEIV20
 10262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10263
 10264
 10265     MOVE AL-UANON               TO CERTCARA.
 10266     MOVE 'X'                    TO UPDATE-SWITCH.
 10267     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10268     GO TO 1500-EXIT.
 10269
 10270 1500-CARR-NOTFND.
 10271     MOVE ER-0360                TO EMI-ERROR.
 10272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10273     MOVE AL-UABON               TO CERTCARA.
 10274     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 187
* EL131.cbl
 10275     MOVE 'X'                    TO ERROR-SWITCH.
 10276
 10277 1500-EXIT.
 10278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 188
* EL131.cbl
 10280 1510-DEEDIT-DATE.
 10281
 10282* EXEC CICS BIF DEEDIT
 10283*         FIELD    (DEEDIT-DATE-INPUT)
 10284*         LENGTH   (DATE-LENGTH)
 10285*    END-EXEC.
 10286*    MOVE '@"L                   #   #00009592' TO DFHEIV0
 10287     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10288     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10289     MOVE X'2020233030303039353932' TO DFHEIV0(25:11)
 10290     CALL 'kxdfhei1' USING DFHEIV0,
 10291           DEEDIT-DATE-INPUT,
 10292           DATE-LENGTH
 10293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10294
 10295
 10296 1510-EXIT.
 10297     EXIT.
 10298
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 189
* EL131.cbl
 10300 1620-VERIFY-ACCT.
 10301
 10302     move ' '                    to ws-eracct-sw
 10303     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10304     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10305     MOVE PI-GROUPING            TO ACCT-GROUP.
 10306     MOVE PI-STATE               TO ACCT-STATE.
 10307     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10308
 10309     IF CERTEFFI GREATER THAN LOW-VALUES
 10310         MOVE HOLD-EFF           TO ACCT-DATE
 10311     ELSE
 10312         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10313
 10314     IF CERTACTI GREATER THAN LOW-VALUES
 10315         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10316     IF CERTSTI GREATER THAN LOW-VALUES
 10317         MOVE CERTSTI            TO  ACCT-STATE.
 10318     IF CERTCARI GREATER THAN LOW-VALUES
 10319         MOVE CERTCARI           TO  ACCT-CARRIER.
 10320     IF CERTGRPI GREATER THAN LOW-VALUES
 10321         MOVE CERTGRPI           TO ACCT-GROUP.
 10322
 10323     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10324
 10325
 10326* EXEC CICS HANDLE CONDITION
 10327*         NOTFND  (1620-ACCT-NOTFND)
 10328*    END-EXEC.
 10329*    MOVE '"$I                   ! + #00009626' TO DFHEIV0
 10330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10332     MOVE X'2B20233030303039363236' TO DFHEIV0(25:11)
 10333     CALL 'kxdfhei1' USING DFHEIV0
 10334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10335
 10336
 10337
 10338* EXEC CICS STARTBR
 10339*         DATASET   (ACCT-FILE-ID)
 10340*         RIDFLD    (ACCT-KEY)
 10341*    END-EXEC.
 10342     MOVE 0
 10343       TO DFHEIV11
 10344*    MOVE '&,         G          &   #00009630' TO DFHEIV0
 10345     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10347     MOVE X'2020233030303039363330' TO DFHEIV0(25:11)
 10348     CALL 'kxdfhei1' USING DFHEIV0,
 10349           ACCT-FILE-ID,
 10350           ACCT-KEY,
 10351           DFHEIV99,
 10352           DFHEIV11,
 10353           DFHEIV99
 10354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10355
 10356
 10357 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 190
* EL131.cbl
 10358
 10359
 10360* EXEC CICS READNEXT
 10361*         DATASET  (ACCT-FILE-ID)
 10362*         RIDFLD   (ACCT-KEY)
 10363*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10364*    END-EXEC.
 10365     MOVE 0
 10366       TO DFHEIV11
 10367*    MOVE '&.S                   )   #00009637' TO DFHEIV0
 10368     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10370     MOVE X'2020233030303039363337' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0,
 10372           ACCT-FILE-ID,
 10373           DFHEIV20,
 10374           DFHEIV99,
 10375           ACCT-KEY,
 10376           DFHEIV99,
 10377           DFHEIV11,
 10378           DFHEIV99,
 10379           DFHEIV99
 10380     SET ADDRESS OF ACCOUNT-MASTER TO
 10381         DFHEIV20
 10382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10383
 10384
 10385     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10386         GO TO 1620-ACCT-NOTFND.
 10387
 10388     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10389        HOLD-EFF     LESS AM-EXPIRATION-DT
 10390         NEXT SENTENCE
 10391     ELSE
 10392         GO TO 1620-ACCT-LOOP.
 10393
 10394     set acct-found to true
 10395     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10396         GO TO 1620-ACCT-END-BROWSE.
 10397
 10398     IF LOANBALL GREATER THAN +0
 10399         IF AM-MAX-TOT-BEN NUMERIC  AND
 10400            AM-MAX-TOT-BEN GREATER THAN ZERO
 10401             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10402                 MOVE AL-UNBON     TO LOANBALA
 10403                 MOVE -1           TO LOANBALL
 10404                 MOVE 'X'          TO ERROR-SWITCH
 10405                 MOVE ER-7641      TO EMI-ERROR
 10406                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10407
 10408     IF ACVBENEL GREATER THAN +0
 10409         IF AM-MAX-MON-BEN NUMERIC  AND
 10410            AM-MAX-MON-BEN GREATER THAN ZERO
 10411             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10412                 MOVE AL-UNBON     TO ACVBENEA
 10413                 MOVE -1           TO ACVBENEL
 10414                 MOVE 'X'          TO ERROR-SWITCH
 10415                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 191
* EL131.cbl
 10416                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10417
 10418 1620-ACCT-END-BROWSE.
 10419
 10420
 10421* EXEC CICS ENDBR
 10422*         DATASET (ACCT-FILE-ID)
 10423*    END-EXEC.
 10424     MOVE 0
 10425       TO DFHEIV11
 10426*    MOVE '&2                    $   #00009678' TO DFHEIV0
 10427     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10428     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10429     MOVE X'2020233030303039363738' TO DFHEIV0(25:11)
 10430     CALL 'kxdfhei1' USING DFHEIV0,
 10431           ACCT-FILE-ID,
 10432           DFHEIV11,
 10433           DFHEIV99
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437     GO TO 1620-EXIT.
 10438
 10439 1620-ACCT-NOTFND.
 10440
 10441     MOVE -1                     TO MAINTL.
 10442     MOVE 'X'                    TO ERROR-SWITCH.
 10443     MOVE ER-0426                TO EMI-ERROR.
 10444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10445
 10446 1620-EXIT.
 10447     EXIT.
 10448
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 192
* EL131.cbl
 10450 2000-UPDATE-CLAIM.
 10451
 10452     MOVE SPACES                 TO ERROR-SWITCH.
 10453     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10454     MOVE PI-CARRIER             TO CARRIER-CODE.
 10455     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10456     MOVE PI-CERT-NO             TO CERT-NO.
 10457
 10458     IF DELETE-CLAIM
 10459         GO TO 3000-DELETE-CLAIM.
 10460
 10461     IF  NOT MODIFY-CAP
 10462         MOVE ER-0070            TO EMI-ERROR
 10463         MOVE 'X'                TO ERROR-SWITCH
 10464         MOVE -1                 TO MAINTL
 10465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10466         GO TO 2000-EXIT.
 10467
 10468     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10469     MOVE ZERO                   TO TRLR-SEQ-NO.
 10470
 10471
 10472* EXEC CICS READ UPDATE
 10473*         SET       (ADDRESS OF CLAIM-MASTER)
 10474*         DATASET   (CLMS-FILE-ID)
 10475*         RIDFLD    (MSTR-KEY)
 10476*    END-EXEC.
 10477*    MOVE '&"S        EU         (   #00009716' TO DFHEIV0
 10478     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10480     MOVE X'2020233030303039373136' TO DFHEIV0(25:11)
 10481     CALL 'kxdfhei1' USING DFHEIV0,
 10482           CLMS-FILE-ID,
 10483           DFHEIV20,
 10484           DFHEIV99,
 10485           MSTR-KEY,
 10486           DFHEIV99,
 10487           DFHEIV99,
 10488           DFHEIV99
 10489     SET ADDRESS OF CLAIM-MASTER TO
 10490         DFHEIV20
 10491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10492
 10493
 10494     if (incl > zeros)
 10495        and (cl-no-of-pmts-made > 0)
 10496        and (hold-incur > low-values)
 10497        and (hold-incur not = cl-incurred-dt)
 10498        if hold-incur > cl-incurred-dt
 10499           move cl-incurred-dt   to dc-bin-date-1
 10500           move hold-incur       to dc-bin-date-2
 10501        else
 10502           move hold-incur       to dc-bin-date-1
 10503           move cl-incurred-dt   to dc-bin-date-2
 10504        end-if
 10505        move '1'                 to dc-option-code
 10506        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10507        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 193
* EL131.cbl
 10508           MOVE ER-1663             TO EMI-ERROR
 10509           PERFORM 9900-ERROR-FORMAT
 10510                                 THRU 9900-EXIT
 10511           MOVE -1                  TO MAINTL
 10512           GO TO 8110-SEND-DATA
 10513        end-if
 10514     end-if
 10515     IF (CL-PRIORITY-CD = '8')
 10516        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10517             AND 'AMWA' AND 'KMSB')
 10518        MOVE ER-8003             TO EMI-ERROR
 10519        PERFORM 9900-ERROR-FORMAT
 10520                                 THRU 9900-EXIT
 10521        MOVE -1                  TO MAINTL
 10522        GO TO 8110-SEND-DATA
 10523     END-IF
 10524
 10525     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10526         MOVE ER-0068            TO EMI-ERROR
 10527         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10528         GO TO 2000-EXIT.
 10529
 10530     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10531         MOVE ER-0068            TO EMI-ERROR
 10532         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10533         GO TO 2000-EXIT.
 10534
 10535     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10536         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10537
 10538     IF CL-PURGED-DT NOT = LOW-VALUES
 10539         MOVE ER-7691            TO EMI-ERROR
 10540         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10541         GO TO 2000-EXIT.
 10542
 10543     IF CERT-KEY-CHANGED
 10544         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10545
 10546     IF SCREEN-ERROR
 10547         MOVE ER-0068            TO EMI-ERROR
 10548         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10549         GO TO 2000-EXIT.
 10550
 10551     IF NINETY-TRLR-UPDATED
 10552         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10553
 10554     IF MSTR-KEY-CHANGED
 10555         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10556        ELSE
 10557         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10558
 10559     IF TRLR-UPDATE-REQUIRED
 10560         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10561
 10562 2000-CHECK-CERT.
 10563     IF NOT CERT-UPDATES
 10564         GO TO 2000-EXIT.
 10565
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 194
* EL131.cbl
 10566     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10567     MOVE PI-CARRIER             TO CERT-CARRIER.
 10568     MOVE PI-GROUPING            TO CERT-GROUP.
 10569     MOVE PI-STATE               TO CERT-STATE.
 10570     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10571     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10572     MOVE PI-CERT-NO             TO CERT-CERT.
 10573
 10574     IF CERT-ALT-KEY-CHANGED
 10575         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10576     ELSE
 10577         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10578
 10579 2000-EXIT.
 10580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 195
* EL131.cbl
 10582 2010-RELEASE-REC.
 10583
 10584* EXEC CICS UNLOCK
 10585*         DATASET  (CLMS-FILE-ID)
 10586*    END-EXEC
 10587*    MOVE '&*                    #   #00009811' TO DFHEIV0
 10588     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10590     MOVE X'2020233030303039383131' TO DFHEIV0(25:11)
 10591     CALL 'kxdfhei1' USING DFHEIV0,
 10592           CLMS-FILE-ID,
 10593           DFHEIV99
 10594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10595
 10596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10597     MOVE 'X'                    TO ERROR-SWITCH.
 10598
 10599 2010-EXIT.
 10600     EXIT.
 10601
 10602 2020-NORMAL-UPDATE.
 10603     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10604
 10605     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10606
 10607     IF WS-OPEN-CLOSE-SW = 'Y'
 10608       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10609       IF PI-REC-FOUND-SW = 'Y'
 10610         IF CL-ACTIVITY-CODE = 09
 10611           NEXT SENTENCE
 10612         ELSE
 10613           IF WS-RESET-SW = 'Y'
 10614             IF CL-CLAIM-STATUS = 'C'
 10615               MOVE 07               TO  CL-ACTIVITY-CODE
 10616               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10617               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10618             ELSE
 10619               MOVE 08               TO  CL-ACTIVITY-CODE
 10620               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10621               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10622
 10623     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10624         MOVE 'Y'                TO CL-YESNOSW
 10625     END-IF.
 10626
 10627     if pi-company-id = 'DCC' OR 'VPP'
 10628        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10629        perform 2120-check-pdef  thru 2120-exit
 10630     end-if
 10631     if ((benperl <> zeros)
 10632        and (benperi numeric))
 10633                  or
 10634            (instypel <> zeros)
 10635        perform 2140-update-elcrtt thru 2140-exit
 10636     end-if
 10637
 10638* EXEC CICS HANDLE CONDITION
 10639*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 196
* EL131.cbl
 10640*    END-EXEC.
 10641*    MOVE '"$$                   ! , #00009856' TO DFHEIV0
 10642     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10644     MOVE X'2C20233030303039383536' TO DFHEIV0(25:11)
 10645     CALL 'kxdfhei1' USING DFHEIV0
 10646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10647
 10648
 10649
 10650* EXEC CICS REWRITE
 10651*         DATASET   (CLMS-FILE-ID)
 10652*         FROM      (CLAIM-MASTER)
 10653*    END-EXEC.
 10654     MOVE LENGTH OF
 10655      CLAIM-MASTER
 10656       TO DFHEIV11
 10657*    MOVE '&& L                  %   #00009860' TO DFHEIV0
 10658     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10659     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10660     MOVE X'2020233030303039383630' TO DFHEIV0(25:11)
 10661     CALL 'kxdfhei1' USING DFHEIV0,
 10662           CLMS-FILE-ID,
 10663           CLAIM-MASTER,
 10664           DFHEIV11,
 10665           DFHEIV99
 10666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10667
 10668
 10669 2020-EXIT.
 10670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 197
* EL131.cbl
 10672 2030-KEY-UPDATE.
 10673     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10674
 10675
 10676* EXEC CICS DELETE
 10677*        DATASET  (CLMS-FILE-ID)
 10678*    END-EXEC.
 10679*    MOVE '&(                    &   #00009871' TO DFHEIV0
 10680     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10682     MOVE X'2020233030303039383731' TO DFHEIV0(25:11)
 10683     CALL 'kxdfhei1' USING DFHEIV0,
 10684           CLMS-FILE-ID,
 10685           DFHEIV99,
 10686           DFHEIV99,
 10687           DFHEIV99,
 10688           DFHEIV99
 10689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10690
 10691
 10692
 10693* EXEC CICS GETMAIN
 10694*         SET      (ADDRESS OF CLAIM-MASTER)
 10695*         LENGTH   (MSTR-LENGTH)
 10696*         INITIMG  (GETMAIN-SPACE)
 10697*    END-EXEC.
 10698*    MOVE ',"IL                  $   #00009875' TO DFHEIV0
 10699     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10701     MOVE X'2020233030303039383735' TO DFHEIV0(25:11)
 10702     CALL 'kxdfhei1' USING DFHEIV0,
 10703           DFHEIV20,
 10704           MSTR-LENGTH,
 10705           GETMAIN-SPACE
 10706     SET ADDRESS OF CLAIM-MASTER TO
 10707         DFHEIV20
 10708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10709
 10710
 10711     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10712
 10713     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10714
 10715     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10716
 10717     IF WS-OPEN-CLOSE-SW = 'Y'
 10718       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10719         IF PI-REC-FOUND-SW = 'Y'
 10720           IF CL-ACTIVITY-CODE = 09
 10721             NEXT SENTENCE
 10722           ELSE
 10723             IF WS-RESET-SW = 'Y'
 10724               IF CL-CLAIM-STATUS = 'C'
 10725                 MOVE 07             TO  CL-ACTIVITY-CODE
 10726                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10727                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10728               ELSE
 10729                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 198
* EL131.cbl
 10730                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10731                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10732
 10733
 10734* EXEC CICS HANDLE CONDITION
 10735*         DUPKEY    (2030-EXIT)
 10736*    END-EXEC.
 10737*    MOVE '"$$                   ! - #00009903' TO DFHEIV0
 10738     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10740     MOVE X'2D20233030303039393033' TO DFHEIV0(25:11)
 10741     CALL 'kxdfhei1' USING DFHEIV0
 10742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10743
 10744
 10745** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10746*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10747
 10748     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10749         MOVE 'Y'                TO CL-YESNOSW
 10750     END-IF.
 10751
 10752
 10753* EXEC CICS WRITE
 10754*         DATASET   (CLMS-FILE-ID)
 10755*         RIDFLD    (MSTR-KEY)
 10756*         FROM      (CLAIM-MASTER)
 10757*    END-EXEC.
 10758     MOVE LENGTH OF
 10759      CLAIM-MASTER
 10760       TO DFHEIV11
 10761*    MOVE '&$ L                  ''   #00009914' TO DFHEIV0
 10762     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10763     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10764     MOVE X'2020233030303039393134' TO DFHEIV0(25:11)
 10765     CALL 'kxdfhei1' USING DFHEIV0,
 10766           CLMS-FILE-ID,
 10767           CLAIM-MASTER,
 10768           DFHEIV11,
 10769           MSTR-KEY,
 10770           DFHEIV99,
 10771           DFHEIV99
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
 10775 2030-EXIT.
 10776     EXIT.
 10777
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 199
* EL131.cbl
 10779 2040-NORMAL-UPDATE.
 10780
 10781* EXEC CICS READ UPDATE
 10782*         DATASET  (CERT-FILE-ID)
 10783*         RIDFLD   (CERT-KEY)
 10784*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10785*    END-EXEC.
 10786*    MOVE '&"S        EU         (   #00009925' TO DFHEIV0
 10787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10789     MOVE X'2020233030303039393235' TO DFHEIV0(25:11)
 10790     CALL 'kxdfhei1' USING DFHEIV0,
 10791           CERT-FILE-ID,
 10792           DFHEIV20,
 10793           DFHEIV99,
 10794           CERT-KEY,
 10795           DFHEIV99,
 10796           DFHEIV99,
 10797           DFHEIV99
 10798     SET ADDRESS OF CERTIFICATE-MASTER TO
 10799         DFHEIV20
 10800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10801
 10802
 10803     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10804
 10805
 10806* EXEC CICS HANDLE CONDITION
 10807*         DUPKEY   (2040-EXIT)
 10808*    END-EXEC.
 10809*    MOVE '"$$                   ! . #00009933' TO DFHEIV0
 10810     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10812     MOVE X'2E20233030303039393333' TO DFHEIV0(25:11)
 10813     CALL 'kxdfhei1' USING DFHEIV0
 10814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10815
 10816
 10817
 10818* EXEC CICS REWRITE
 10819*         DATASET  (CERT-FILE-ID)
 10820*         FROM     (CERTIFICATE-MASTER)
 10821*    END-EXEC.
 10822     MOVE LENGTH OF
 10823      CERTIFICATE-MASTER
 10824       TO DFHEIV11
 10825*    MOVE '&& L                  %   #00009937' TO DFHEIV0
 10826     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10827     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10828     MOVE X'2020233030303039393337' TO DFHEIV0(25:11)
 10829     CALL 'kxdfhei1' USING DFHEIV0,
 10830           CERT-FILE-ID,
 10831           CERTIFICATE-MASTER,
 10832           DFHEIV11,
 10833           DFHEIV99
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10835
 10836
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 200
* EL131.cbl
 10837 2040-EXIT.
 10838     EXIT.
 10839
 10840 2050-KEY-UPDATE.
 10841
 10842* EXEC CICS READ UPDATE
 10843*         DATASET  (CERT-FILE-ID)
 10844*         RIDFLD   (CERT-KEY)
 10845*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10846*    END-EXEC.
 10847*    MOVE '&"S        EU         (   #00009946' TO DFHEIV0
 10848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10850     MOVE X'2020233030303039393436' TO DFHEIV0(25:11)
 10851     CALL 'kxdfhei1' USING DFHEIV0,
 10852           CERT-FILE-ID,
 10853           DFHEIV20,
 10854           DFHEIV99,
 10855           CERT-KEY,
 10856           DFHEIV99,
 10857           DFHEIV99,
 10858           DFHEIV99
 10859     SET ADDRESS OF CERTIFICATE-MASTER TO
 10860         DFHEIV20
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
 10864     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10865
 10866
 10867* EXEC CICS DELETE
 10868*         DATASET   (CERT-FILE-ID)
 10869*    END-EXEC.
 10870*    MOVE '&(                    &   #00009954' TO DFHEIV0
 10871     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10872     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10873     MOVE X'2020233030303039393534' TO DFHEIV0(25:11)
 10874     CALL 'kxdfhei1' USING DFHEIV0,
 10875           CERT-FILE-ID,
 10876           DFHEIV99,
 10877           DFHEIV99,
 10878           DFHEIV99,
 10879           DFHEIV99
 10880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10881
 10882
 10883
 10884* EXEC CICS GETMAIN
 10885*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10886*         LENGTH    (CERT-LENGTH)
 10887*         INITIMG   (GETMAIN-SPACE)
 10888*    END-EXEC.
 10889*    MOVE ',"IL                  $   #00009958' TO DFHEIV0
 10890     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10892     MOVE X'2020233030303039393538' TO DFHEIV0(25:11)
 10893     CALL 'kxdfhei1' USING DFHEIV0,
 10894           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 201
* EL131.cbl
 10895           CERT-LENGTH,
 10896           GETMAIN-SPACE
 10897     SET ADDRESS OF CERTIFICATE-MASTER TO
 10898         DFHEIV20
 10899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10900
 10901
 10902     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10903
 10904     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10905
 10906
 10907* EXEC CICS HANDLE CONDITION
 10908*         DUPKEY (2050-EXIT)
 10909*    END-EXEC.
 10910*    MOVE '"$$                   ! / #00009968' TO DFHEIV0
 10911     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10913     MOVE X'2F20233030303039393638' TO DFHEIV0(25:11)
 10914     CALL 'kxdfhei1' USING DFHEIV0
 10915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10916
 10917
 10918
 10919* EXEC CICS WRITE
 10920*         DATASET  (CERT-FILE-ID)
 10921*         RIDFLD   (CERT-KEY)
 10922*         FROM     (CERTIFICATE-MASTER)
 10923*    END-EXEC.
 10924     MOVE LENGTH OF
 10925      CERTIFICATE-MASTER
 10926       TO DFHEIV11
 10927*    MOVE '&$ L                  ''   #00009972' TO DFHEIV0
 10928     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10930     MOVE X'2020233030303039393732' TO DFHEIV0(25:11)
 10931     CALL 'kxdfhei1' USING DFHEIV0,
 10932           CERT-FILE-ID,
 10933           CERTIFICATE-MASTER,
 10934           DFHEIV11,
 10935           CERT-KEY,
 10936           DFHEIV99,
 10937           DFHEIV99
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10939
 10940
 10941 2050-EXIT.
 10942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 202
* EL131.cbl
 10944 2060-CHANGE-CERT.
 10945     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10946     MOVE PI-CARRIER             TO CERT-CARRIER.
 10947     MOVE PI-GROUPING            TO CERT-GROUP.
 10948     MOVE PI-STATE               TO CERT-STATE.
 10949     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10950     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10951     MOVE PI-CERT-NO             TO CERT-CERT.
 10952     IF CERTEFFI GREATER THAN LOW-VALUES
 10953         MOVE HOLD-EFF           TO CERT-DATE.
 10954     IF CERTACTI GREATER THAN LOW-VALUES
 10955         MOVE CERTACTI           TO CERT-ACCOUNT.
 10956     IF CERTSTI GREATER THAN LOW-VALUES
 10957         MOVE CERTSTI            TO CERT-STATE.
 10958     IF CERTCARI GREATER THAN LOW-VALUES
 10959         MOVE CERTCARI           TO CERT-CARRIER.
 10960     IF CERTGRPI GREATER THAN LOW-VALUES
 10961         MOVE CERTGRPI           TO CERT-GROUP.
 10962     IF CERTI GREATER THAN LOW-VALUES
 10963         MOVE CERTI              TO CERT-CERT-PRIME.
 10964     IF SUFXI GREATER THAN LOW-VALUES
 10965         MOVE SUFXI              TO CERT-CERT-SUFX.
 10966
 10967
 10968* EXEC CICS HANDLE CONDITION
 10969*         NOTFND   (2060-CERT-NOTFND)
 10970*    END-EXEC.
 10971*    MOVE '"$I                   ! 0 #00010004' TO DFHEIV0
 10972     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10974     MOVE X'3020233030303130303034' TO DFHEIV0(25:11)
 10975     CALL 'kxdfhei1' USING DFHEIV0
 10976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10977
 10978
 10979
 10980* EXEC CICS READ UPDATE
 10981*         DATASET  (CERT-FILE-ID)
 10982*         RIDFLD   (CERT-KEY)
 10983*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10984*    END-EXEC.
 10985*    MOVE '&"S        EU         (   #00010008' TO DFHEIV0
 10986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10988     MOVE X'2020233030303130303038' TO DFHEIV0(25:11)
 10989     CALL 'kxdfhei1' USING DFHEIV0,
 10990           CERT-FILE-ID,
 10991           DFHEIV20,
 10992           DFHEIV99,
 10993           CERT-KEY,
 10994           DFHEIV99,
 10995           DFHEIV99,
 10996           DFHEIV99
 10997     SET ADDRESS OF CERTIFICATE-MASTER TO
 10998         DFHEIV20
 10999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11000
 11001
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 203
* EL131.cbl
 11002     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11003
 11004     IF CM-CLAIM-INTERFACE-SW = SPACES
 11005        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11006
 11007
 11008* EXEC CICS HANDLE CONDITION
 11009*         DUPKEY   (2060-DUPKEY)
 11010*    END-EXEC.
 11011*    MOVE '"$$                   ! 1 #00010019' TO DFHEIV0
 11012     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11014     MOVE X'3120233030303130303139' TO DFHEIV0(25:11)
 11015     CALL 'kxdfhei1' USING DFHEIV0
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11017
 11018
 11019
 11020* EXEC CICS REWRITE
 11021*         DATASET  (CERT-FILE-ID)
 11022*         FROM     (CERTIFICATE-MASTER)
 11023*    END-EXEC.
 11024     MOVE LENGTH OF
 11025      CERTIFICATE-MASTER
 11026       TO DFHEIV11
 11027*    MOVE '&& L                  %   #00010023' TO DFHEIV0
 11028     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11029     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11030     MOVE X'2020233030303130303233' TO DFHEIV0(25:11)
 11031     CALL 'kxdfhei1' USING DFHEIV0,
 11032           CERT-FILE-ID,
 11033           CERTIFICATE-MASTER,
 11034           DFHEIV11,
 11035           DFHEIV99
 11036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11037
 11038
 11039 2060-DUPKEY.
 11040
 11041     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11042
 11043 2060-CHANGE-TRLR-ACTQ.
 11044     IF SCREEN-ERROR
 11045         GO TO 2060-EXIT.
 11046
 11047     IF CERTI    GREATER LOW-VALUES OR
 11048        SUFXI    GREATER LOW-VALUES OR
 11049        CERTCARI GREATER LOW-VALUES
 11050         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11051         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11052
 11053     MOVE SPACES                 TO CERT-KEY-SWITCH
 11054                                    CERT-SWITCH
 11055                                    TRLR-SWITCH
 11056                                    NINETY-TRLR-SWITCH.
 11057     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11058     GO TO 2060-EXIT.
 11059
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 204
* EL131.cbl
 11060 2060-CERT-NOTFND.
 11061     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11062
 11063     IF WS-REC-FOUND-SW = 'N'
 11064         MOVE ER-0206            TO  EMI-ERROR
 11065         MOVE -1                 TO  MAINTL
 11066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11067
 11068* EXEC CICS UNLOCK
 11069*            DATASET   (CLMS-FILE-ID)
 11070*        END-EXEC
 11071*    MOVE '&*                    #   #00010056' TO DFHEIV0
 11072     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11073     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11074     MOVE X'2020233030303130303536' TO DFHEIV0(25:11)
 11075     CALL 'kxdfhei1' USING DFHEIV0,
 11076           CLMS-FILE-ID,
 11077           DFHEIV99
 11078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11079         GO TO 8110-SEND-DATA.
 11080
 11081     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11082
 11083     GO TO 2060-CHANGE-TRLR-ACTQ.
 11084
 11085 2060-EXIT.
 11086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 205
* EL131.cbl
 11088 2070-CHECK-OLD.
 11089
 11090
 11091* EXEC CICS HANDLE CONDITION
 11092*        NOTFND   (2070-NOT-FOUND)
 11093*    END-EXEC.
 11094*    MOVE '"$I                   ! 2 #00010070' TO DFHEIV0
 11095     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11097     MOVE X'3220233030303130303730' TO DFHEIV0(25:11)
 11098     CALL 'kxdfhei1' USING DFHEIV0
 11099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11100
 11101
 11102     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11103     MOVE PI-CARRIER             TO CERT-CARRIER.
 11104     MOVE PI-GROUPING            TO CERT-GROUP.
 11105     MOVE PI-STATE               TO CERT-STATE.
 11106     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11107     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11108     MOVE PI-CERT-NO             TO CERT-CERT.
 11109
 11110
 11111* EXEC CICS READ UPDATE
 11112*         DATASET  (CERT-FILE-ID)
 11113*         RIDFLD   (CERT-KEY)
 11114*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11115*    END-EXEC.
 11116*    MOVE '&"S        EU         (   #00010082' TO DFHEIV0
 11117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11118     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11119     MOVE X'2020233030303130303832' TO DFHEIV0(25:11)
 11120     CALL 'kxdfhei1' USING DFHEIV0,
 11121           CERT-FILE-ID,
 11122           DFHEIV20,
 11123           DFHEIV99,
 11124           CERT-KEY,
 11125           DFHEIV99,
 11126           DFHEIV99,
 11127           DFHEIV99
 11128     SET ADDRESS OF CERTIFICATE-MASTER TO
 11129         DFHEIV20
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11131
 11132
 11133     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11134     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11135     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11136
 11137     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11138         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11139
 11140     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11141       AND
 11142        CERT-WAS-CREATED-FOR-CLAIM
 11143         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11144
 11145* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 206
* EL131.cbl
 11146*             DATASET   (CERT-FILE-ID)
 11147*        END-EXEC
 11148*    MOVE '&(                    &   #00010099' TO DFHEIV0
 11149     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11150     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11151     MOVE X'2020233030303130303939' TO DFHEIV0(25:11)
 11152     CALL 'kxdfhei1' USING DFHEIV0,
 11153           CERT-FILE-ID,
 11154           DFHEIV99,
 11155           DFHEIV99,
 11156           DFHEIV99,
 11157           DFHEIV99
 11158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11159         GO TO 2070-EXIT.
 11160
 11161     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11162         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11163
 11164
 11165* EXEC CICS HANDLE CONDITION
 11166*         DUPKEY   (2070-EXIT)
 11167*    END-EXEC.
 11168*    MOVE '"$$                   ! 3 #00010107' TO DFHEIV0
 11169     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11171     MOVE X'3320233030303130313037' TO DFHEIV0(25:11)
 11172     CALL 'kxdfhei1' USING DFHEIV0
 11173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11174
 11175
 11176
 11177* EXEC CICS REWRITE
 11178*         DATASET  (CERT-FILE-ID)
 11179*         FROM     (CERTIFICATE-MASTER)
 11180*    END-EXEC.
 11181     MOVE LENGTH OF
 11182      CERTIFICATE-MASTER
 11183       TO DFHEIV11
 11184*    MOVE '&& L                  %   #00010111' TO DFHEIV0
 11185     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11187     MOVE X'2020233030303130313131' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0,
 11189           CERT-FILE-ID,
 11190           CERTIFICATE-MASTER,
 11191           DFHEIV11,
 11192           DFHEIV99
 11193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11194
 11195
 11196     GO TO 2070-EXIT.
 11197
 11198 2070-NOT-FOUND.
 11199     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11200
 11201 2070-EXIT.
 11202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 207
* EL131.cbl
 11204 2080-CREATE-CERT.
 11205
 11206* EXEC CICS GETMAIN
 11207*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11208*         LENGTH    (CERT-LENGTH)
 11209*         INITIMG   (GETMAIN-SPACE)
 11210*    END-EXEC.
 11211*    MOVE ',"IL                  $   #00010125' TO DFHEIV0
 11212     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11213     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11214     MOVE X'2020233030303130313235' TO DFHEIV0(25:11)
 11215     CALL 'kxdfhei1' USING DFHEIV0,
 11216           DFHEIV20,
 11217           CERT-LENGTH,
 11218           GETMAIN-SPACE
 11219     SET ADDRESS OF CERTIFICATE-MASTER TO
 11220         DFHEIV20
 11221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11222
 11223
 11224     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11225
 11226     IF CERTEFFI GREATER THAN LOW-VALUES
 11227         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11228                                    DC-BIN-DATE-1
 11229         MOVE '6'                TO DC-OPTION-CODE
 11230         MOVE +1                 TO DC-ELAPSED-MONTHS
 11231         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11232         IF NO-CONVERSION-ERROR
 11233             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11234
 11235     IF CERTACTI GREATER THAN LOW-VALUES
 11236         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11237     IF CERTSTI GREATER THAN LOW-VALUES
 11238         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11239     IF CERTCARI GREATER THAN LOW-VALUES
 11240         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11241     IF CERTGRPI GREATER THAN LOW-VALUES
 11242         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11243     IF CERTI GREATER THAN LOW-VALUES
 11244         MOVE CERTI              TO CERT-CERT-PRIME
 11245                                    CM-CERT-PRIME
 11246         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11247
 11248     IF SUFXI GREATER THAN LOW-VALUES
 11249         MOVE SUFXI              TO CERT-CERT-SUFX
 11250                                    CM-CERT-SFX
 11251         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11252
 11253     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11254
 11255     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11256
 11257     MOVE SPACES                 TO CM-ENTRY-BATCH
 11258                                    CM-LF-EXIT-BATCH
 11259                                    CM-AH-EXIT-BATCH
 11260                                    CM-CREDIT-INTERFACE-SW-1
 11261                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 208
* EL131.cbl
 11262
 11263     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11264                               '9' OR 'D' OR 'V'
 11265         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11266
 11267     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11268                               '9' OR 'D' OR 'V'
 11269         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11270
 11271     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11272                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11273     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11274
 11275
 11276* EXEC CICS HANDLE CONDITION
 11277*         DUPKEY (2080-EXIT)
 11278*    END-EXEC.
 11279*    MOVE '"$$                   ! 4 #00010182' TO DFHEIV0
 11280     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11282     MOVE X'3420233030303130313832' TO DFHEIV0(25:11)
 11283     CALL 'kxdfhei1' USING DFHEIV0
 11284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11285
 11286
 11287
 11288* EXEC CICS WRITE
 11289*         DATASET  (CERT-FILE-ID)
 11290*         RIDFLD   (CERT-KEY)
 11291*         FROM     (CERTIFICATE-MASTER)
 11292*    END-EXEC.
 11293     MOVE LENGTH OF
 11294      CERTIFICATE-MASTER
 11295       TO DFHEIV11
 11296*    MOVE '&$ L                  ''   #00010186' TO DFHEIV0
 11297     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11299     MOVE X'2020233030303130313836' TO DFHEIV0(25:11)
 11300     CALL 'kxdfhei1' USING DFHEIV0,
 11301           CERT-FILE-ID,
 11302           CERTIFICATE-MASTER,
 11303           DFHEIV11,
 11304           CERT-KEY,
 11305           DFHEIV99,
 11306           DFHEIV99
 11307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11308
 11309
 11310 2080-EXIT.
 11311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 209
* EL131.cbl
 11313 2100-MOVE-MSTR.
 11314     IF TYPEI GREATER THAN LOW-VALUES
 11315         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11316
 11317     IF STATUSI = LOW-VALUES
 11318         GO TO 2100-NO-STATUS-CHANGE.
 11319
 11320     IF STATUSI = 'OPEN' OR 'O'
 11321         IF CL-CLAIM-STATUS = 'O'
 11322             MOVE SPACES         TO TRLR-SWITCH
 11323                 GO TO 2100-NO-STATUS-CHANGE.
 11324
 11325     IF STATUSI = 'CLOSED' OR 'C'
 11326         IF CL-CLAIM-STATUS = 'C'
 11327             MOVE SPACES         TO TRLR-SWITCH
 11328                 GO TO 2100-NO-STATUS-CHANGE.
 11329
 11330     IF PI-COMPANY-ID = 'DMD'
 11331        IF STATUSI = 'OPEN' OR 'O'
 11332           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11333              MOVE ZERO       TO STATUSL
 11334              MOVE LOW-VALUES TO STATUSI
 11335              GO TO 2100-NO-STATUS-CHANGE.
 11336
 11337     IF PI-COMPANY-ID = 'DMD'
 11338         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11339
 11340     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11341
 11342 2100-NO-STATUS-CHANGE.
 11343
 11344     IF CCNOI GREATER THAN LOW-VALUES
 11345         MOVE CCNOI              TO CL-CCN.
 11346
 11347     IF PROCI GREATER THAN LOW-VALUES
 11348         MOVE PROCI              TO CL-PROCESSOR-ID.
 11349
 11350     if (accswi > low-values)
 11351        and (accswi = 'Y' OR 'N')
 11352        move accswi              to cl-accident-claim-sw
 11353     end-if
 11354     if benperi > low-values
 11355        and benperi numeric
 11356        move benperi             to cl-benefit-period
 11357     end-if
 11358     if instypei > low-values
 11359        move instypei            to cl-insured-type
 11360     end-if
 11361     IF SEXI GREATER THAN LOW-VALUES
 11362         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11363
 11364     IF BIRTHI GREATER THAN LOW-VALUES
 11365         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11366
 11367     IF SOCIALI GREATER THAN LOW-VALUES
 11368       AND
 11369        SOCIALI = SPACES
 11370         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 210
* EL131.cbl
 11371         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11372         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11373     ELSE
 11374         IF SOCIALI GREATER THAN LOW-VALUES
 11375             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11376
 11377     IF OCCI GREATER THAN LOW-VALUES
 11378         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11379
 11380     IF BENEL GREATER THAN ZERO
 11381         MOVE BENEI              TO CL-BENEFICIARY.
 11382
 11383     IF DIAGI GREATER THAN LOW-VALUES
 11384         MOVE DIAGI              TO WS-DIAGNOSIS.
 11385
 11386     IF ICD1I GREATER THAN LOW-VALUES
 11387         MOVE ICD1I              TO WS-ICD-CODE-1
 11388     END-IF.
 11389
 11390     IF ICD2I GREATER THAN LOW-VALUES
 11391         MOVE ICD2I              TO WS-ICD-CODE-2
 11392     END-IF.
 11393
 11394     IF PREMTYPI GREATER THAN LOW-VALUES
 11395         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11396
 11397*    IF CAUSEI GREATER THAN LOW-VALUES
 11398*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11399
 11400*    IF ENDI GREATER THAN LOW-VALUES
 11401*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11402
 11403     IF PDTHRUI GREATER THAN LOW-VALUES
 11404        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11405
 11406     IF PDAMTL GREATER THAN +0
 11407        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11408
 11409     IF NODAYSI GREATER THAN LOW-VALUES
 11410        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11411
 11412     IF NOPMTSI GREATER THAN LOW-VALUES
 11413        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11414
 11415     IF FORMTYPI GREATER THAN LOW-VALUES
 11416        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11417
 11418     IF INCI GREATER THAN LOW-VALUES
 11419        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11420
 11421     IF REPI GREATER THAN LOW-VALUES
 11422        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11423
 11424     IF ADDONDTI GREATER THAN LOW-VALUES
 11425        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11426
 11427     IF PRICDI GREATER THAN LOW-VALUES
 11428         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 211
* EL131.cbl
 11429
 11430     IF CRITPL  > ZEROS
 11431        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11432     END-IF
 11433
 11434*    IF CRITPTL > ZEROS
 11435*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11436*    END-IF
 11437
 11438*    IF RTWMOSL > ZEROS
 11439*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11440*    END-IF
 11441     IF FILETOI GREATER THAN LOW-VALUES
 11442         MOVE FILETOI            TO CL-FILE-LOCATION.
 11443
 11444     IF SUPVI GREATER THAN LOW-VALUES
 11445         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11446
 11447     IF MLNAMEI GREATER THAN LOW-VALUES
 11448         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11449
 11450     IF MFNAMEI GREATER THAN LOW-VALUES
 11451         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11452
 11453     IF MMINITI GREATER THAN LOW-VALUES
 11454         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11455
 11456     IF CERTEFFI GREATER THAN LOW-VALUES
 11457         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11458
 11459     IF CERTACTI GREATER THAN LOW-VALUES
 11460         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11461
 11462     IF CERTSTI GREATER THAN LOW-VALUES
 11463         MOVE CERTSTI            TO CL-CERT-STATE.
 11464
 11465     IF CERTCARI GREATER THAN LOW-VALUES
 11466         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11467                                    CL-CARRIER.
 11468
 11469     IF CERTGRPI GREATER THAN LOW-VALUES
 11470         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11471
 11472     IF CERTI GREATER THAN LOW-VALUES
 11473         MOVE CERTI              TO CERT-NO-PRIME.
 11474
 11475     IF SUFXI GREATER THAN LOW-VALUES
 11476         MOVE SUFXI              TO CERT-NO-SUFX.
 11477
 11478     MOVE CERT-NO                TO CL-CERT-NO
 11479                                    CL-CERT-NO-A4.
 11480
 11481     IF PI-COMPANY-ID = 'FLA'
 11482          NEXT SENTENCE
 11483     ELSE
 11484         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11485         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11486         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 212
* EL131.cbl
 11487         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11488
 11489     IF TRLR-UPDATE-REQUIRED
 11490        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11491        MOVE ZEROS              TO TRLR-SEQ-NO
 11492
 11493* EXEC CICS READ
 11494*            DATASET   (TRLR-FILE-ID)
 11495*            RIDFLD    (TRLR-KEY)
 11496*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11497*       END-EXEC
 11498*    MOVE '&"S        E          (   #00010374' TO DFHEIV0
 11499     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11501     MOVE X'2020233030303130333734' TO DFHEIV0(25:11)
 11502     CALL 'kxdfhei1' USING DFHEIV0,
 11503           TRLR-FILE-ID,
 11504           DFHEIV20,
 11505           DFHEIV99,
 11506           TRLR-KEY,
 11507           DFHEIV99,
 11508           DFHEIV99,
 11509           DFHEIV99
 11510     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11511         DFHEIV20
 11512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11513        IF AT-TRAILER-TYPE = '1'
 11514           MOVE +1 TO MISC-SUB
 11515           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11516           MISC-SUB GREATER THAN +6 OR
 11517           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11518           IF MISC-SUB GREATER THAN +1
 11519              SUBTRACT +1 FROM MISC-SUB
 11520              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11521                 GO TO 2100-BYPASS-LAST-UPDATE.
 11522
 11523     IF TRLR-UPDATE-REQUIRED AND
 11524        CLAIM-IS-OPEN
 11525         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11526     ELSE
 11527         IF TRLR-UPDATE-REQUIRED AND
 11528            CLAIM-IS-CLOSED
 11529             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11530             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11531
 11532 2100-BYPASS-LAST-UPDATE.
 11533     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11534     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11535
 11536     GO TO 2100-EXIT.
 11537
 11538 2100-BUMP-OPEN-CLOSE-HIST.
 11539     ADD +1                      TO MISC-SUB.
 11540
 11541 2100-EXIT.
 11542     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 213
* EL131.cbl
 11544 2120-check-pdef.
 11545     move +0                     to s1
 11546     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11547     move spaces                 to ws-dcc-error-line
 11548     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11549     IF ERPDEF-FOUND
 11550        perform 2130-check-trlr  thru 2130-exit
 11551        move +1                  to s1
 11552*       if cl-accident-claim-sw = ' '
 11553*          move er-1655             to ws-error-no (s1)
 11554*          add +1 to s1
 11555*       end-if
 11556        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11557        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11558        if (hold-incur > low-values)
 11559           and (incl > zeros)
 11560           and (hold-incur not = cl-incurred-dt)
 11561           move hold-incur       to dc-bin-date-2
 11562        end-if
 11563        MOVE '1'                 TO DC-OPTION-CODE
 11564        MOVE +0                  TO DC-ELAPSED-MONTHS
 11565                                    DC-ELAPSED-DAYS
 11566        PERFORM 9800-CONVERT-DATE
 11567                                 THRU 9800-EXIT
 11568        IF NO-CONVERSION-ERROR
 11569           MOVE DC-ELAPSED-MONTHS
 11570                                 TO WS-MONTHS-BETWEEN
 11571           IF DC-ELAPSED-DAYS > 1
 11572              ADD 1 TO WS-MONTHS-BETWEEN
 11573           END-IF
 11574        ELSE
 11575           display ' dte conv error ' dc-error-code
 11576           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11577        END-IF
 11578        IF (WS-EXCL-PERIOD = ZEROS)
 11579           OR (WS-MONTHS-BETWEEN = ZEROS)
 11580           CONTINUE
 11581        ELSE
 11582           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11583              MOVE ER-1651       TO ws-error-no (s1)
 11584              add +1             to s1
 11585           END-IF
 11586        END-IF
 11587        IF (WS-COV-ENDS = ZEROS)
 11588           OR (WS-MONTHS-BETWEEN = ZEROS)
 11589           CONTINUE
 11590        ELSE
 11591           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11592              MOVE -1            TO MAINTL
 11593              MOVE ER-1653       TO ws-error-no (s1)
 11594              add +1 to s1
 11595           END-IF
 11596        END-IF
 11597        IF (WS-ACC-PERIOD = ZEROS)
 11598           OR (WS-MONTHS-BETWEEN = ZEROS)
 11599           CONTINUE
 11600        ELSE
 11601           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 214
* EL131.cbl
 11602              and (accswi = spaces or low-values)
 11603*             and (cl-accident-claim-sw = ' ')
 11604              move er-1655       to ws-error-no (s1)
 11605              add +1             to s1
 11606           end-if
 11607           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11608*             if (cl-accident-claim-sw not = 'Y')
 11609              if (accswi not = 'Y')
 11610                 MOVE ER-1652    TO ws-error-no (s1)
 11611              else
 11612                 move er-1662    to ws-error-no (s1)
 11613              end-if
 11614              MOVE -1            TO MAINTL
 11615              add +1             to s1
 11616           END-IF
 11617        END-IF
 11618        if cl-claim-type  = 'I'
 11619           move er-1661          to ws-error-no (s1)
 11620           add +1                to s1
 11621        end-if
 11622        perform 2130-check-trlr  thru 2130-exit
 11623     END-IF
 11624
 11625     .
 11626 2120-exit.
 11627     exit.
 11628
 11629 2130-check-trlr.
 11630
 11631     evaluate true
 11632        when s1 = +0
 11633           move cl-control-primary
 11634                                 to trlr-key
 11635           MOVE +95              TO TRLR-SEQ-NO
 11636
 11637* EXEC CICS READ
 11638*             update
 11639*             DATASET  ('ELTRLR')
 11640*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11641*             RIDFLD   (TRLR-KEY)
 11642*             RESP     (WS-RESPONSE)
 11643*          END-EXEC
 11644     MOVE 'ELTRLR' TO DFHEIV1
 11645*    MOVE '&"S        EU         (  N#00010502' TO DFHEIV0
 11646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11648     MOVE X'204E233030303130353032' TO DFHEIV0(25:11)
 11649     CALL 'kxdfhei1' USING DFHEIV0,
 11650           DFHEIV1,
 11651           DFHEIV20,
 11652           DFHEIV99,
 11653           TRLR-KEY,
 11654           DFHEIV99,
 11655           DFHEIV99,
 11656           DFHEIV99
 11657     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11658         DFHEIV20
 11659     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 215
* EL131.cbl
 11660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11661           if ws-resp-normal
 11662              move spaces        to at-info-line-1
 11663           end-if
 11664        when s1 = +1
 11665           if ws-resp-normal
 11666
 11667* exec cics rewrite
 11668*                dataset   ('ELTRLR')
 11669*                from      (activity-trailers)
 11670*             end-exec
 11671     MOVE LENGTH OF
 11672      activity-trailers
 11673       TO DFHEIV11
 11674     MOVE 'ELTRLR' TO DFHEIV1
 11675*    MOVE '&& L                  %   #00010514' TO DFHEIV0
 11676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11678     MOVE X'2020233030303130353134' TO DFHEIV0(25:11)
 11679     CALL 'kxdfhei1' USING DFHEIV0,
 11680           DFHEIV1,
 11681           activity-trailers,
 11682           DFHEIV11,
 11683           DFHEIV99
 11684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11685           end-if
 11686        when s1 > +1
 11687           if ws-resp-normal
 11688              move ws-dcc-error-line
 11689                                 to at-info-line-1
 11690
 11691* exec cics rewrite
 11692*                dataset   ('ELTRLR')
 11693*                from      (activity-trailers)
 11694*             end-exec
 11695     MOVE LENGTH OF
 11696      activity-trailers
 11697       TO DFHEIV11
 11698     MOVE 'ELTRLR' TO DFHEIV1
 11699*    MOVE '&& L                  %   #00010523' TO DFHEIV0
 11700     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11701     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11702     MOVE X'2020233030303130353233' TO DFHEIV0(25:11)
 11703     CALL 'kxdfhei1' USING DFHEIV0,
 11704           DFHEIV1,
 11705           activity-trailers,
 11706           DFHEIV11,
 11707           DFHEIV99
 11708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11709           else
 11710
 11711* EXEC CICS GETMAIN
 11712*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11713*                LENGTH   (TRLR-LENGTH)
 11714*                INITIMG  (GETMAIN-SPACE)
 11715*             END-EXEC
 11716*    MOVE ',"IL                  $   #00010528' TO DFHEIV0
 11717     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 216
* EL131.cbl
 11718     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11719     MOVE X'2020233030303130353238' TO DFHEIV0(25:11)
 11720     CALL 'kxdfhei1' USING DFHEIV0,
 11721           DFHEIV20,
 11722           TRLR-LENGTH,
 11723           GETMAIN-SPACE
 11724     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11725         DFHEIV20
 11726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11727              move 'AT'          to at-record-id
 11728              move cl-control-primary
 11729                                 to at-control-primary
 11730              move +95           to at-sequence-no
 11731              move '6'           to at-trailer-type
 11732              move ws-dcc-error-line
 11733                                 to at-info-line-1
 11734              move 'E'           to at-info-trailer-type
 11735              move save-bin-date to at-recorded-dt
 11736                                    at-gen-info-last-maint-dt
 11737              move pi-processor-id
 11738                                 to at-recorded-by
 11739                                    at-gen-info-last-updated-by
 11740              move eibtime       to at-last-maint-hhmmss
 11741
 11742* exec cics write
 11743*                dataset   ('ELTRLR')
 11744*                from      (activity-trailers)
 11745*                ridfld    (trlr-key)
 11746*             end-exec
 11747     MOVE LENGTH OF
 11748      activity-trailers
 11749       TO DFHEIV11
 11750     MOVE 'ELTRLR' TO DFHEIV1
 11751*    MOVE '&$ L                  ''   #00010547' TO DFHEIV0
 11752     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11754     MOVE X'2020233030303130353437' TO DFHEIV0(25:11)
 11755     CALL 'kxdfhei1' USING DFHEIV0,
 11756           DFHEIV1,
 11757           activity-trailers,
 11758           DFHEIV11,
 11759           trlr-key,
 11760           DFHEIV99,
 11761           DFHEIV99
 11762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11763              perform varying s1 from +1 by +1 until
 11764                 ws-error-no (s1) = spaces
 11765                 move ws-error-no (s1)
 11766                                 to emi-error
 11767                 PERFORM 9900-ERROR-FORMAT
 11768                                 THRU 9900-EXIT
 11769              end-perform
 11770           end-if
 11771     end-evaluate
 11772
 11773     .
 11774 2130-exit.
 11775     exit.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 217
* EL131.cbl
 11776 2140-update-elcrtt.
 11777     move ' '                    to crtt-switch
 11778     MOVE CERT-KEY               TO ELCRTT-KEY
 11779     MOVE 'B'                    TO CTRLR-REC-TYPE
 11780
 11781* EXEC CICS READ
 11782*       UPDATE
 11783*       DATASET   ('ELCRTT')
 11784*       RIDFLD    (ELCRTT-KEY)
 11785*       INTO      (CERTIFICATE-TRAILERS)
 11786*       RESP      (WS-RESPONSE)
 11787*    END-EXEC
 11788     MOVE LENGTH OF
 11789      CERTIFICATE-TRAILERS
 11790       TO DFHEIV11
 11791     MOVE 'ELCRTT' TO DFHEIV1
 11792*    MOVE '&"IL       EU         (  N#00010569' TO DFHEIV0
 11793     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11795     MOVE X'204E233030303130353639' TO DFHEIV0(25:11)
 11796     CALL 'kxdfhei1' USING DFHEIV0,
 11797           DFHEIV1,
 11798           CERTIFICATE-TRAILERS,
 11799           DFHEIV11,
 11800           ELCRTT-KEY,
 11801           DFHEIV99,
 11802           DFHEIV99,
 11803           DFHEIV99
 11804     MOVE EIBRESP  TO WS-RESPONSE
 11805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11806     IF WS-RESP-NORMAL
 11807        perform varying s1 from +1 by +1 until
 11808           (s1 > +24)
 11809           or (cs-claim-no (s1) = cl-claim-no)
 11810        end-perform
 11811        if (s1 < +25)
 11812           if (benperl <> zeros)
 11813              and (cs-benefit-period (s1) not = benperi)
 11814              move benperi       to cs-benefit-period (s1)
 11815              set crtt-update    to true
 11816          end-if
 11817          if (instypel <> zeros)
 11818             and (instypei not = cs-insured-type (s1))
 11819             move instypei      to cs-insured-type (s1)
 11820             set crtt-update    to true
 11821          end-if
 11822          move cs-claim-type (s1) to ws-claim-type
 11823          move cs-benefit-period (s1) to ws-ben-per
 11824        end-if
 11825        if crtt-update
 11826           perform 2150-accum    thru 2150-exit
 11827
 11828* EXEC CICS REWRITE
 11829*             DATASET   ('ELCRTT')
 11830*             FROM      (CERTIFICATE-TRAILERS)
 11831*          END-EXEC
 11832     MOVE LENGTH OF
 11833      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 218
* EL131.cbl
 11834       TO DFHEIV11
 11835     MOVE 'ELCRTT' TO DFHEIV1
 11836*    MOVE '&& L                  %   #00010597' TO DFHEIV0
 11837     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11838     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11839     MOVE X'2020233030303130353937' TO DFHEIV0(25:11)
 11840     CALL 'kxdfhei1' USING DFHEIV0,
 11841           DFHEIV1,
 11842           CERTIFICATE-TRAILERS,
 11843           DFHEIV11,
 11844           DFHEIV99
 11845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11846        else
 11847
 11848* exec cics unlock
 11849*             dataset   ('ELCRTT')
 11850*          end-exec
 11851     MOVE 'ELCRTT' TO DFHEIV1
 11852*    MOVE '&*                    #   #00010602' TO DFHEIV0
 11853     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11855     MOVE X'2020233030303130363032' TO DFHEIV0(25:11)
 11856     CALL 'kxdfhei1' USING DFHEIV0,
 11857           DFHEIV1,
 11858           DFHEIV99
 11859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11860        end-if
 11861     end-if
 11862     .
 11863 2140-exit.
 11864     exit.
 11865 2150-accum.
 11866     if not erpdef-found
 11867        perform 3997-get-erpdef  thru 3997-exit
 11868     end-if
 11869     if (erpdef-found)
 11870        and (ws-max-moben not = zeros)
 11871        and (ws-max-moben < cm-ah-benefit-amt)
 11872        continue
 11873     else
 11874        move cm-ah-benefit-amt   to ws-max-moben
 11875     end-if
 11876     move cm-ah-orig-term        to ws-max-bens
 11877     if cl-critical-period not = zeros and spaces
 11878        move cl-critical-period  to ws-max-bens
 11879     end-if
 11880     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11881     perform varying s2 from +1 by +1 until
 11882        (s2 > +24)
 11883        or (cs-claim-no (s2) = spaces)
 11884        if (cs-benefit-period (s2) = ws-ben-per)
 11885           and (cs-claim-type (s2) = ws-claim-type)
 11886           and (cs-insured-type (s2) = cl-insured-type)
 11887*          compute ws-tot-days-paid =
 11888*             ws-tot-days-paid + cs-days-paid (s2)
 11889           compute ws-tot-amt-paid =
 11890              ws-tot-amt-paid + cs-total-paid (s2)
 11891        end-if
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 219
* EL131.cbl
 11892     end-perform
 11893     if s2 < +25
 11894        compute ws-pd-bens rounded =
 11895           ws-tot-amt-paid / ws-max-moben
 11896        compute cs-remaining-bens (s1) =
 11897           ws-max-bens - ws-pd-bens
 11898        if cs-remaining-bens (s1) < zeros
 11899           move zeros            to cs-remaining-bens (s1)
 11900        end-if
 11901     end-if
 11902     .
 11903 2150-exit.
 11904     exit.
 11905 2200-MOVE-CERT.
 11906     IF CRTLNMEI GREATER THAN LOW-VALUES
 11907         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11908
 11909     IF CRTFNMEI GREATER THAN LOW-VALUES
 11910         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11911         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11912
 11913     IF CRTINITI GREATER THAN LOW-VALUES
 11914         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11915
 11916     IF CM-INSURED-INITIALS = SPACES
 11917         MOVE '**'               TO CM-INSURED-INITIALS.
 11918
 11919     IF ISSAGEI GREATER THAN LOW-VALUES
 11920         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11921
 11922     IF JNTFNMEI GREATER THAN LOW-VALUES
 11923         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11924
 11925     IF JNTLNMEI GREATER THAN LOW-VALUES
 11926         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11927
 11928     IF JNTINITI GREATER THAN LOW-VALUES
 11929         MOVE JNTINITI           TO CM-JT-INITIAL.
 11930
 11931     IF JNTAGEI GREATER THAN LOW-VALUES
 11932         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11933
 11934     IF ADDONDTI GREATER THAN LOW-VALUES
 11935        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11936
 11937     IF LCVCDI GREATER THAN LOW-VALUES
 11938        IF LCVCDI = SPACES OR ZEROS
 11939           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11940        ELSE
 11941           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11942
 11943     IF LCVOTRMI GREATER THAN LOW-VALUES
 11944         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11945
 11946     IF LCVRATEL GREATER THAN +0
 11947         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11948
 11949     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 220
* EL131.cbl
 11950         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11951
 11952     IF LCVFORMI GREATER THAN LOW-VALUES
 11953         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11954
 11955     IF LCVCNDTI = LOW-VALUES
 11956        GO TO 2210-SET-STATUS.
 11957
 11958     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11959        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11960        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11961        GO TO 2210-SET-STATUS.
 11962
 11963     IF CM-LF-CURRENT-STATUS = '7'
 11964        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11965        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11966        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11967                                    CM-LF-DEATH-DT
 11968        GO TO 2210-SET-STATUS.
 11969
 11970     IF CM-LF-CURRENT-STATUS = '8'
 11971        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11972        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11973                                    CM-LF-CANCEL-DT.
 11974
 11975 2210-SET-STATUS.
 11976
 11977     IF CM-LF-CURRENT-STATUS = SPACES
 11978         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11979
 11980     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11981         MOVE '6'                TO DC-OPTION-CODE
 11982         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11983         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11984         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11985         IF NO-CONVERSION-ERROR
 11986             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11987         ELSE
 11988             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11989     ELSE
 11990         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11991
 11992 2215-PROCESS-AH-SIDE.
 11993
 11994     IF ACVCDI GREATER THAN LOW-VALUES
 11995        IF ACVCDI = SPACES OR ZEROS
 11996           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11997        ELSE
 11998           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11999
 12000     IF ACVOTRMI GREATER THAN LOW-VALUES
 12001         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12002
 12003     IF ACVRATEL GREATER THAN +0
 12004         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12005
 12006     IF ACVBENEL GREATER THAN +0
 12007         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 221
* EL131.cbl
 12008                                    PI-PAYMENT-AMT.
 12009
 12010     IF ACVFORMI GREATER THAN LOW-VALUES
 12011         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12012
 12013     IF ACVCNDTI = LOW-VALUES
 12014        GO TO 2220-SET-STATUS.
 12015
 12016     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12017        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12018        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12019        GO TO 2220-SET-STATUS.
 12020
 12021     IF CM-AH-CURRENT-STATUS = '6'
 12022        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12023                                 TO CM-AH-CURRENT-STATUS
 12024        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12025        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12026                                    CM-AH-SETTLEMENT-DT
 12027        GO TO 2220-SET-STATUS.
 12028
 12029     IF CM-AH-CURRENT-STATUS = '8'
 12030        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12031        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12032                                    CM-AH-CANCEL-DT.
 12033
 12034 2220-SET-STATUS.
 12035     IF CM-AH-CURRENT-STATUS = SPACES
 12036         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12037
 12038     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12039         MOVE '6'                TO DC-OPTION-CODE
 12040         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12041         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12042         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12043         IF NO-CONVERSION-ERROR
 12044             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12045         ELSE
 12046             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12047     ELSE
 12048         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12049
 12050 2225-FINISH-CERT.
 12051     IF APRL GREATER THAN +0
 12052         MOVE HOLD-APR           TO CM-LOAN-APR.
 12053
 12054     IF PMTFREQI GREATER THAN LOW-VALUES
 12055         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12056
 12057     IF INDGRPI GREATER THAN LOW-VALUES
 12058         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12059
 12060*    IF LOANNOI GREATER THAN LOW-VALUES
 12061*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12062
 12063     IF LOANBALL GREATER THAN +0
 12064        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12065
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 222
* EL131.cbl
 12066     IF PREMTYPI GREATER THAN LOW-VALUES
 12067         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12068
 12069     IF REINCDI GREATER THAN LOW-VALUES
 12070         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12071                                    WS-REIN-1
 12072                                    WS-REIN-2
 12073                                    WS-REIN-3
 12074         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12075
 12076     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12077
 12078     MOVE ZEROS                  TO CM-LOAN-TERM
 12079                                    CM-LIFE-COMM-PCT
 12080                                    CM-AH-COMM-PCT.
 12081
 12082*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12083*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12084*         PI-NO-PMTS = ZEROS
 12085*          IF LOANBALL GREATER THAN +0          OR
 12086*             ACVBENEL GREATER THAN +0          OR
 12087*             APRL     GREATER THAN +0          OR
 12088*             LCVRATEL GREATER THAN +0          OR
 12089*             ACVRATEL GREATER THAN +0
 12090*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12091
 12092 2200-EXIT.
 12093     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 223
* EL131.cbl
 12095 2300-UPDATE-TRLR.
 12096     MOVE ZERO                   TO TRLR-SEQ-NO.
 12097
 12098* EXEC CICS READ UPDATE
 12099*         DATASET  (TRLR-FILE-ID)
 12100*         RIDFLD   (TRLR-KEY)
 12101*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12102*    END-EXEC.
 12103*    MOVE '&"S        EU         (   #00010842' TO DFHEIV0
 12104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12105     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12106     MOVE X'2020233030303130383432' TO DFHEIV0(25:11)
 12107     CALL 'kxdfhei1' USING DFHEIV0,
 12108           TRLR-FILE-ID,
 12109           DFHEIV20,
 12110           DFHEIV99,
 12111           TRLR-KEY,
 12112           DFHEIV99,
 12113           DFHEIV99,
 12114           DFHEIV99
 12115     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12116         DFHEIV20
 12117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12118
 12119
 12120     MOVE ZERO                   TO COUNT-2.
 12121
 12122     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12123         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12124
 12125     IF NOT UPDATE-MADE
 12126         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12127
 12128
 12129* EXEC CICS REWRITE
 12130*         DATASET  (TRLR-FILE-ID)
 12131*         FROM     (ACTIVITY-TRAILERS)
 12132*    END-EXEC.
 12133     MOVE LENGTH OF
 12134      ACTIVITY-TRAILERS
 12135       TO DFHEIV11
 12136*    MOVE '&& L                  %   #00010856' TO DFHEIV0
 12137     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12138     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12139     MOVE X'2020233030303130383536' TO DFHEIV0(25:11)
 12140     CALL 'kxdfhei1' USING DFHEIV0,
 12141           TRLR-FILE-ID,
 12142           ACTIVITY-TRAILERS,
 12143           DFHEIV11,
 12144           DFHEIV99
 12145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12146
 12147
 12148 2300-EXIT.
 12149     EXIT.
 12150
 12151 2310-INS-STATUS.
 12152     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 224
* EL131.cbl
 12153     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12154         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12155         MOVE 'Y'                TO TRLR-SWITCH.
 12156
 12157 2310-EXIT.
 12158     EXIT.
 12159
 12160 2320-SHIFT-STATUS.
 12161     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12162        MOVE 6                   TO COUNT-2
 12163        GO TO 2320-EXIT.
 12164
 12165     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12166     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12167     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12168     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12169     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12170     MOVE 6       TO COUNT-2.
 12171     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12172
 12173 2320-EXIT.
 12174     EXIT.
 12175
 12176 2330-ADD-UPDATE.
 12177
 12178     IF COUNT-2 GREATER THAN 1
 12179        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12180        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12181           GO TO 2330-EXIT.
 12182
 12183     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12184                                   AT-RESERVES-LAST-MAINT-DT
 12185
 12186     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12187     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12188     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12189     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12190
 12191 2330-EXIT.
 12192     EXIT.
 12193
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 225
* EL131.cbl
 12195 2400-UPDATE-TRLR.
 12196
 12197* EXEC CICS HANDLE CONDITION
 12198*         NOTFND    (2400-TRLR-NOTFND)
 12199*         ENDFILE   (2410-EXIT)
 12200*    END-EXEC.
 12201*    MOVE '"$I''                  ! 5 #00010909' TO DFHEIV0
 12202     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12204     MOVE X'3520233030303130393039' TO DFHEIV0(25:11)
 12205     CALL 'kxdfhei1' USING DFHEIV0
 12206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12207
 12208
 12209
 12210* EXEC CICS STARTBR
 12211*        DATASET (TRLR-FILE-ID)
 12212*        RIDFLD  (TRLR-KEY)
 12213*    END-EXEC.
 12214     MOVE 0
 12215       TO DFHEIV11
 12216*    MOVE '&,         G          &   #00010914' TO DFHEIV0
 12217     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12219     MOVE X'2020233030303130393134' TO DFHEIV0(25:11)
 12220     CALL 'kxdfhei1' USING DFHEIV0,
 12221           TRLR-FILE-ID,
 12222           TRLR-KEY,
 12223           DFHEIV99,
 12224           DFHEIV11,
 12225           DFHEIV99
 12226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12227
 12228
 12229
 12230* EXEC CICS GETMAIN
 12231*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12232*         LENGTH    (TRLR-LENGTH)
 12233*         INITIMG   (GETMAIN-SPACE)
 12234*    END-EXEC.
 12235*    MOVE ',"IL                  $   #00010919' TO DFHEIV0
 12236     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12237     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12238     MOVE X'2020233030303130393139' TO DFHEIV0(25:11)
 12239     CALL 'kxdfhei1' USING DFHEIV0,
 12240           DFHEIV20,
 12241           TRLR-LENGTH,
 12242           GETMAIN-SPACE
 12243     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12244         DFHEIV20
 12245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12246
 12247
 12248     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12249
 12250
 12251* EXEC CICS ENDBR
 12252*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 226
* EL131.cbl
 12253*    END-EXEC.
 12254     MOVE 0
 12255       TO DFHEIV11
 12256*    MOVE '&2                    $   #00010927' TO DFHEIV0
 12257     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12258     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12259     MOVE X'2020233030303130393237' TO DFHEIV0(25:11)
 12260     CALL 'kxdfhei1' USING DFHEIV0,
 12261           TRLR-FILE-ID,
 12262           DFHEIV11,
 12263           DFHEIV99
 12264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12265
 12266
 12267     GO TO 2400-EXIT.
 12268
 12269 2400-TRLR-NOTFND.
 12270     MOVE ER-0205                TO EMI-ERROR.
 12271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12272     MOVE 'X'                    TO ERROR-SWITCH.
 12273
 12274 2400-EXIT.
 12275     EXIT.
 12276
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 227
* EL131.cbl
 12278 2410-CHANGE-TRLR.
 12279
 12280* EXEC CICS READNEXT
 12281*        DATASET (TRLR-FILE-ID)
 12282*        RIDFLD  (TRLR-KEY)
 12283*        INTO    (ACTIVITY-TRAILERS)
 12284*    END-EXEC.
 12285     MOVE LENGTH OF
 12286      ACTIVITY-TRAILERS
 12287       TO DFHEIV12
 12288     MOVE 0
 12289       TO DFHEIV11
 12290*    MOVE '&.IL                  )   #00010943' TO DFHEIV0
 12291     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12293     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0,
 12295           TRLR-FILE-ID,
 12296           ACTIVITY-TRAILERS,
 12297           DFHEIV12,
 12298           TRLR-KEY,
 12299           DFHEIV99,
 12300           DFHEIV11,
 12301           DFHEIV99,
 12302           DFHEIV99
 12303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12304
 12305
 12306     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12307        GO TO 2410-CHANGE-TRLR.
 12308
 12309     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12310                                    CHECK-KEY.
 12311
 12312     IF CHECK-KEY NOT = MSTR-KEY
 12313         GO TO 2410-EXIT.
 12314
 12315
 12316* EXEC CICS ENDBR
 12317*        DATASET (TRLR-FILE-ID)
 12318*    END-EXEC.
 12319     MOVE 0
 12320       TO DFHEIV11
 12321*    MOVE '&2                    $   #00010958' TO DFHEIV0
 12322     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12324     MOVE X'2020233030303130393538' TO DFHEIV0(25:11)
 12325     CALL 'kxdfhei1' USING DFHEIV0,
 12326           TRLR-FILE-ID,
 12327           DFHEIV11,
 12328           DFHEIV99
 12329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12330
 12331
 12332
 12333* EXEC CICS READ UPDATE
 12334*        DATASET (TRLR-FILE-ID)
 12335*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 228
* EL131.cbl
 12336*        INTO    (ACTIVITY-TRAILERS)
 12337*    END-EXEC.
 12338     MOVE LENGTH OF
 12339      ACTIVITY-TRAILERS
 12340       TO DFHEIV11
 12341*    MOVE '&"IL       EU         (   #00010962' TO DFHEIV0
 12342     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12344     MOVE X'2020233030303130393632' TO DFHEIV0(25:11)
 12345     CALL 'kxdfhei1' USING DFHEIV0,
 12346           TRLR-FILE-ID,
 12347           ACTIVITY-TRAILERS,
 12348           DFHEIV11,
 12349           TRLR-KEY,
 12350           DFHEIV99,
 12351           DFHEIV99,
 12352           DFHEIV99
 12353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12354
 12355
 12356
 12357* EXEC CICS DELETE
 12358*        DATASET (TRLR-FILE-ID)
 12359*    END-EXEC.
 12360*    MOVE '&(                    &   #00010968' TO DFHEIV0
 12361     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12363     MOVE X'2020233030303130393638' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           TRLR-FILE-ID,
 12366           DFHEIV99,
 12367           DFHEIV99,
 12368           DFHEIV99,
 12369           DFHEIV99
 12370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12371
 12372
 12373     IF AT-SEQUENCE-NO = ZERO AND
 12374        TRLR-UPDATE-REQUIRED
 12375         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12376
 12377     IF CERTI GREATER THAN LOW-VALUES
 12378        MOVE CERTI               TO AT-CERT-PRIME.
 12379
 12380     IF SUFXI GREATER THAN LOW-VALUES
 12381        MOVE SUFXI               TO AT-CERT-SFX.
 12382
 12383     IF CERTCARI GREATER THAN LOW-VALUES
 12384        MOVE CERTCARI            TO AT-CARRIER.
 12385
 12386     IF PAYMENT-TR
 12387        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12388           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12389              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12390
 12391     IF CORRESPONDENCE-TR
 12392        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12393           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 229
* EL131.cbl
 12394
 12395
 12396* EXEC CICS WRITE
 12397*         DATASET  (TRLR-FILE-ID)
 12398*         RIDFLD   (AT-CONTROL-PRIMARY)
 12399*         FROM     (ACTIVITY-TRAILERS)
 12400*    END-EXEC.
 12401     MOVE LENGTH OF
 12402      ACTIVITY-TRAILERS
 12403       TO DFHEIV11
 12404*    MOVE '&$ L                  ''   #00010994' TO DFHEIV0
 12405     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12406     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12407     MOVE X'2020233030303130393934' TO DFHEIV0(25:11)
 12408     CALL 'kxdfhei1' USING DFHEIV0,
 12409           TRLR-FILE-ID,
 12410           ACTIVITY-TRAILERS,
 12411           DFHEIV11,
 12412           AT-CONTROL-PRIMARY,
 12413           DFHEIV99,
 12414           DFHEIV99
 12415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12416
 12417
 12418
 12419* EXEC CICS STARTBR
 12420*         DATASET  (TRLR-FILE-ID)
 12421*         RIDFLD   (TRLR-KEY)
 12422*    END-EXEC.
 12423     MOVE 0
 12424       TO DFHEIV11
 12425*    MOVE '&,         G          &   #00011000' TO DFHEIV0
 12426     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12427     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12428     MOVE X'2020233030303131303030' TO DFHEIV0(25:11)
 12429     CALL 'kxdfhei1' USING DFHEIV0,
 12430           TRLR-FILE-ID,
 12431           TRLR-KEY,
 12432           DFHEIV99,
 12433           DFHEIV11,
 12434           DFHEIV99
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12436
 12437
 12438     GO TO 2410-CHANGE-TRLR.
 12439
 12440 2410-EXIT.
 12441     EXIT.
 12442
 12443 2420-UPDATE-TRLR.
 12444     MOVE ZERO TO COUNT-2.
 12445     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12446         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12447
 12448     IF NOT UPDATE-MADE
 12449         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12450
 12451 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 230
* EL131.cbl
 12452     EXIT.
 12453
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 231
* EL131.cbl
 12455 2425-UPDATE-NINETY-TRLR.
 12456
 12457     MOVE +90                    TO TRLR-SEQ-NO.
 12458
 12459
 12460* EXEC CICS HANDLE CONDITION
 12461*         NOTFND    (2425-NINETY-NOTFND)
 12462*         ENDFILE   (2425-NINETY-NOTFND)
 12463*    END-EXEC.
 12464*    MOVE '"$I''                  ! 6 #00011026' TO DFHEIV0
 12465     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12467     MOVE X'3620233030303131303236' TO DFHEIV0(25:11)
 12468     CALL 'kxdfhei1' USING DFHEIV0
 12469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12470
 12471
 12472
 12473* EXEC CICS READ UPDATE
 12474*        DATASET (TRLR-FILE-ID)
 12475*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12476*        RIDFLD  (TRLR-KEY)
 12477*    END-EXEC.
 12478*    MOVE '&"S        EU         (   #00011031' TO DFHEIV0
 12479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12480     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12481     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 12482     CALL 'kxdfhei1' USING DFHEIV0,
 12483           TRLR-FILE-ID,
 12484           DFHEIV20,
 12485           DFHEIV99,
 12486           TRLR-KEY,
 12487           DFHEIV99,
 12488           DFHEIV99,
 12489           DFHEIV99
 12490     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12491         DFHEIV20
 12492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12493
 12494     if (diagi > low-values)
 12495        and (diagi not = at-info-line-1)
 12496        and (cl-total-paid-amt > zeros)
 12497        move cl-cert-eff-dt      to dc-bin-date-1
 12498        move cl-paid-thru-dt     to dc-bin-date-2
 12499        move '1'                 to dc-option-code
 12500        perform 9800-convert-date
 12501                                 thru 9800-exit
 12502        if no-conversion-error
 12503           and dc-elapsed-months < +24
 12504           and (not emi-bypass-forcables)
 12505           move er-1581          to emi-error
 12506           perform 9900-error-format
 12507                                thru 9900-exit
 12508           move -1              to diagl
 12509           go to 8110-send-data
 12510        end-if
 12511     end-if
 12512     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 232
* EL131.cbl
 12513     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12514     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12515
 12516     IF DIAGI GREATER THAN LOW-VALUES
 12517         MOVE DIAGI             TO AT-INFO-LINE-1
 12518     END-IF.
 12519
 12520     IF ICD1I GREATER THAN LOW-VALUES
 12521         MOVE ICD1I             TO AT-ICD-CODE-1
 12522     END-IF.
 12523
 12524     IF ICD2I GREATER THAN LOW-VALUES
 12525         MOVE ICD2I             TO AT-ICD-CODE-2
 12526     END-IF.
 12527
 12528
 12529* EXEC CICS REWRITE
 12530*        DATASET (TRLR-FILE-ID)
 12531*        FROM    (ACTIVITY-TRAILERS)
 12532*    END-EXEC.
 12533     MOVE LENGTH OF
 12534      ACTIVITY-TRAILERS
 12535       TO DFHEIV11
 12536*    MOVE '&& L                  %   #00011070' TO DFHEIV0
 12537     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12539     MOVE X'2020233030303131303730' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0,
 12541           TRLR-FILE-ID,
 12542           ACTIVITY-TRAILERS,
 12543           DFHEIV11,
 12544           DFHEIV99
 12545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12546
 12547
 12548     IF DIAGI GREATER THAN LOW-VALUES
 12549       AND DIAGI NOT = WS-DIAGNOSIS
 12550         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12551         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12552         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12553
 12554     IF ICD1I GREATER THAN LOW-VALUES
 12555       AND ICD1I NOT = WS-ICD-CODE-1
 12556         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12557         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12558         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12559     END-IF.
 12560
 12561     IF ICD2I GREATER THAN LOW-VALUES
 12562       AND ICD2I NOT = WS-ICD-CODE-2
 12563         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12564         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12565         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12566     END-IF.
 12567
 12568     GO TO 2425-EXIT.
 12569
 12570 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 233
* EL131.cbl
 12571
 12572
 12573* EXEC CICS GETMAIN
 12574*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12575*         LENGTH    (TRLR-LENGTH)
 12576*         INITIMG   (GETMAIN-SPACE)
 12577*    END-EXEC.
 12578*    MOVE ',"IL                  $   #00011099' TO DFHEIV0
 12579     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12580     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12581     MOVE X'2020233030303131303939' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0,
 12583           DFHEIV20,
 12584           TRLR-LENGTH,
 12585           GETMAIN-SPACE
 12586     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12587         DFHEIV20
 12588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12589
 12590
 12591     MOVE +90                  TO TRLR-SEQ-NO.
 12592     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12593
 12594     MOVE 'AT'                 TO AT-RECORD-ID
 12595     MOVE '6'                  TO AT-TRAILER-TYPE
 12596     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12597                                  AT-GEN-INFO-LAST-MAINT-DT
 12598     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12599                                  AT-GEN-INFO-LAST-UPDATED-BY
 12600     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12601     MOVE DIAGI                TO AT-INFO-LINE-1.
 12602     MOVE ICD1I                TO AT-ICD-CODE-1.
 12603     MOVE ICD2I                TO AT-ICD-CODE-2.
 12604
 12605
 12606* EXEC CICS WRITE
 12607*        DATASET (TRLR-FILE-ID)
 12608*        FROM    (ACTIVITY-TRAILERS)
 12609*        RIDFLD  (TRLR-KEY)
 12610*    END-EXEC.
 12611     MOVE LENGTH OF
 12612      ACTIVITY-TRAILERS
 12613       TO DFHEIV11
 12614*    MOVE '&$ L                  ''   #00011119' TO DFHEIV0
 12615     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12616     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12617     MOVE X'2020233030303131313139' TO DFHEIV0(25:11)
 12618     CALL 'kxdfhei1' USING DFHEIV0,
 12619           TRLR-FILE-ID,
 12620           ACTIVITY-TRAILERS,
 12621           DFHEIV11,
 12622           TRLR-KEY,
 12623           DFHEIV99,
 12624           DFHEIV99
 12625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12626
 12627
 12628 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 234
* EL131.cbl
 12629     EXIT.
 12630
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 235
* EL131.cbl
 12632 2430-UPDATE-ACTQ.
 12633
 12634* EXEC CICS HANDLE CONDITION
 12635*         NOTFND    (2430-EXIT)
 12636*         ENDFILE   (2440-EXIT)
 12637*    END-EXEC.
 12638*    MOVE '"$I''                  ! 7 #00011130' TO DFHEIV0
 12639     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12641     MOVE X'3720233030303131313330' TO DFHEIV0(25:11)
 12642     CALL 'kxdfhei1' USING DFHEIV0
 12643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12644
 12645
 12646
 12647* EXEC CICS STARTBR
 12648*         DATASET  (ACTQ-FILE-ID)
 12649*         RIDFLD   (ACTQ-KEY)
 12650*    END-EXEC.
 12651     MOVE 0
 12652       TO DFHEIV11
 12653*    MOVE '&,         G          &   #00011135' TO DFHEIV0
 12654     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303131313335' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           ACTQ-FILE-ID,
 12659           ACTQ-KEY,
 12660           DFHEIV99,
 12661           DFHEIV11,
 12662           DFHEIV99
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12664
 12665
 12666
 12667* EXEC CICS GETMAIN
 12668*         SET      (ADDRESS OF ACTIVITY-QUE)
 12669*         LENGTH   (ACTQ-LENGTH)
 12670*         INITIMG  (GETMAIN-SPACE)
 12671*    END-EXEC.
 12672*    MOVE ',"IL                  $   #00011140' TO DFHEIV0
 12673     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12674     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12675     MOVE X'2020233030303131313430' TO DFHEIV0(25:11)
 12676     CALL 'kxdfhei1' USING DFHEIV0,
 12677           DFHEIV20,
 12678           ACTQ-LENGTH,
 12679           GETMAIN-SPACE
 12680     SET ADDRESS OF ACTIVITY-QUE TO
 12681         DFHEIV20
 12682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12683
 12684
 12685     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12686
 12687 2430-EXIT.
 12688     EXIT.
 12689
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 236
* EL131.cbl
 12690 2440-CHANGE-ACTQ.
 12691
 12692
 12693* EXEC CICS READNEXT
 12694*         DATASET  (ACTQ-FILE-ID)
 12695*         RIDFLD   (ACTQ-KEY)
 12696*         INTO     (ACTIVITY-QUE)
 12697*    END-EXEC.
 12698     MOVE LENGTH OF
 12699      ACTIVITY-QUE
 12700       TO DFHEIV12
 12701     MOVE 0
 12702       TO DFHEIV11
 12703*    MOVE '&.IL                  )   #00011153' TO DFHEIV0
 12704     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12705     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12706     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 12707     CALL 'kxdfhei1' USING DFHEIV0,
 12708           ACTQ-FILE-ID,
 12709           ACTIVITY-QUE,
 12710           DFHEIV12,
 12711           ACTQ-KEY,
 12712           DFHEIV99,
 12713           DFHEIV11,
 12714           DFHEIV99,
 12715           DFHEIV99
 12716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12717
 12718
 12719
 12720* EXEC CICS ENDBR
 12721*         DATASET (ACTQ-FILE-ID)
 12722*    END-EXEC.
 12723     MOVE 0
 12724       TO DFHEIV11
 12725*    MOVE '&2                    $   #00011159' TO DFHEIV0
 12726     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12728     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 12729     CALL 'kxdfhei1' USING DFHEIV0,
 12730           ACTQ-FILE-ID,
 12731           DFHEIV11,
 12732           DFHEIV99
 12733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12734
 12735
 12736     IF ACTQ-KEY NOT = MSTR-KEY
 12737         GO TO 2440-EXIT.
 12738
 12739
 12740* EXEC CICS READ UPDATE
 12741*         DATASET  (ACTQ-FILE-ID)
 12742*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12743*         SET      (ADDRESS OF ACTIVITY-QUE)
 12744*    END-EXEC.
 12745*    MOVE '&"S        EU         (   #00011166' TO DFHEIV0
 12746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 237
* EL131.cbl
 12748     MOVE X'2020233030303131313636' TO DFHEIV0(25:11)
 12749     CALL 'kxdfhei1' USING DFHEIV0,
 12750           ACTQ-FILE-ID,
 12751           DFHEIV20,
 12752           DFHEIV99,
 12753           AQ-CONTROL-PRIMARY,
 12754           DFHEIV99,
 12755           DFHEIV99,
 12756           DFHEIV99
 12757     SET ADDRESS OF ACTIVITY-QUE TO
 12758         DFHEIV20
 12759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12760
 12761
 12762     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12763
 12764
 12765* EXEC CICS DELETE
 12766*         DATASET (ACTQ-FILE-ID)
 12767*    END-EXEC.
 12768*    MOVE '&(                    &   #00011174' TO DFHEIV0
 12769     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12771     MOVE X'2020233030303131313734' TO DFHEIV0(25:11)
 12772     CALL 'kxdfhei1' USING DFHEIV0,
 12773           ACTQ-FILE-ID,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99,
 12777           DFHEIV99
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12779
 12780
 12781     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12782     IF CERTI GREATER THAN LOW-VALUES
 12783        MOVE CERTI               TO AQ-CERT-PRIME.
 12784     IF SUFXI GREATER THAN LOW-VALUES
 12785        MOVE SUFXI               TO AQ-CERT-SFX.
 12786     IF CERTCARI GREATER THAN LOW-VALUES
 12787        MOVE CERTCARI            TO AQ-CARRIER.
 12788
 12789
 12790* EXEC CICS HANDLE CONDITION
 12791*         DUPREC   (2440-EXIT)
 12792*    END-EXEC.
 12793*    MOVE '"$%                   ! 8 #00011186' TO DFHEIV0
 12794     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12796     MOVE X'3820233030303131313836' TO DFHEIV0(25:11)
 12797     CALL 'kxdfhei1' USING DFHEIV0
 12798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12799
 12800
 12801
 12802* EXEC CICS WRITE
 12803*         DATASET  (ACTQ-FILE-ID)
 12804*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12805*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 238
* EL131.cbl
 12806*    END-EXEC.
 12807     MOVE LENGTH OF
 12808      ACTIVITY-QUE
 12809       TO DFHEIV11
 12810*    MOVE '&$ L                  ''   #00011190' TO DFHEIV0
 12811     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12813     MOVE X'2020233030303131313930' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0,
 12815           ACTQ-FILE-ID,
 12816           ACTIVITY-QUE,
 12817           DFHEIV11,
 12818           AQ-CONTROL-PRIMARY,
 12819           DFHEIV99,
 12820           DFHEIV99
 12821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12822
 12823
 12824 2440-EXIT.
 12825     EXIT.
 12826
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 239
* EL131.cbl
 12828 2460-UPDATE-CHECKQ.
 12829
 12830* EXEC CICS HANDLE CONDITION
 12831*         NOTFND   (2460-EXIT)
 12832*    END-EXEC.
 12833*    MOVE '"$I                   ! 9 #00011201' TO DFHEIV0
 12834     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12836     MOVE X'3920233030303131323031' TO DFHEIV0(25:11)
 12837     CALL 'kxdfhei1' USING DFHEIV0
 12838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12839
 12840
 12841     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12842     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12843     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12844
 12845
 12846* EXEC CICS READ UPDATE
 12847*         DATASET   (CHKQ-FILE-ID)
 12848*         RIDFLD    (CHKQ-KEY)
 12849*         SET       (ADDRESS OF CHECK-QUE)
 12850*    END-EXEC.
 12851*    MOVE '&"S        EU         (   #00011209' TO DFHEIV0
 12852     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12853     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12854     MOVE X'2020233030303131323039' TO DFHEIV0(25:11)
 12855     CALL 'kxdfhei1' USING DFHEIV0,
 12856           CHKQ-FILE-ID,
 12857           DFHEIV20,
 12858           DFHEIV99,
 12859           CHKQ-KEY,
 12860           DFHEIV99,
 12861           DFHEIV99,
 12862           DFHEIV99
 12863     SET ADDRESS OF CHECK-QUE TO
 12864         DFHEIV20
 12865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12866
 12867
 12868     IF CERTI GREATER THAN LOW-VALUES
 12869        MOVE CERTI               TO CQ-CERT-PRIME.
 12870     IF SUFXI GREATER THAN LOW-VALUES
 12871        MOVE SUFXI               TO CQ-CERT-SFX.
 12872     IF CERTCARI GREATER THAN LOW-VALUES
 12873        MOVE CERTCARI            TO CQ-CARRIER.
 12874
 12875
 12876* EXEC CICS REWRITE
 12877*         DATASET  (CHKQ-FILE-ID)
 12878*         FROM     (CHECK-QUE)
 12879*    END-EXEC.
 12880     MOVE LENGTH OF
 12881      CHECK-QUE
 12882       TO DFHEIV11
 12883*    MOVE '&& L                  %   #00011222' TO DFHEIV0
 12884     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12885     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 240
* EL131.cbl
 12886     MOVE X'2020233030303131323232' TO DFHEIV0(25:11)
 12887     CALL 'kxdfhei1' USING DFHEIV0,
 12888           CHKQ-FILE-ID,
 12889           CHECK-QUE,
 12890           DFHEIV11,
 12891           DFHEIV99
 12892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12893
 12894
 12895 2460-EXIT.
 12896     EXIT.
 12897
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 241
* EL131.cbl
 12899 2475-UPDATE-LETTER.
 12900
 12901* EXEC CICS HANDLE CONDITION
 12902*         NOTFND   (2475-EXIT)
 12903*    END-EXEC.
 12904*    MOVE '"$I                   ! : #00011232' TO DFHEIV0
 12905     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12907     MOVE X'3A20233030303131323332' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0
 12909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12910
 12911
 12912     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12913     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12914     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12915     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12916
 12917
 12918* EXEC CICS READ UPDATE
 12919*         DATASET   (ARCH-FILE-ID)
 12920*         RIDFLD    (ARCH-KEY)
 12921*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12922*    END-EXEC.
 12923*    MOVE '&"S        EU         (   #00011241' TO DFHEIV0
 12924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12925     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12926     MOVE X'2020233030303131323431' TO DFHEIV0(25:11)
 12927     CALL 'kxdfhei1' USING DFHEIV0,
 12928           ARCH-FILE-ID,
 12929           DFHEIV20,
 12930           DFHEIV99,
 12931           ARCH-KEY,
 12932           DFHEIV99,
 12933           DFHEIV99,
 12934           DFHEIV99
 12935     SET ADDRESS OF LETTER-ARCHIVE TO
 12936         DFHEIV20
 12937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12938
 12939
 12940* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12941* TO THIS MASTER-KEY INFORMATION.
 12942
 12943     IF LA-CARRIER  = CARRIER-CODE AND
 12944        LA-CLAIM-NO = CLAIM-NO     AND
 12945        LA-CERT-NO  = CERT-NO
 12946        NEXT SENTENCE
 12947     ELSE
 12948        GO TO 2475-UNLOCK.
 12949
 12950     IF CERTI GREATER THAN LOW-VALUES
 12951        MOVE CERTI               TO LA-CERT-PRIME.
 12952     IF SUFXI GREATER THAN LOW-VALUES
 12953        MOVE SUFXI               TO LA-CERT-SFX.
 12954     IF CERTCARI GREATER THAN LOW-VALUES
 12955        MOVE CERTCARI            TO LA-CARRIER.
 12956
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 242
* EL131.cbl
 12957
 12958* EXEC CICS REWRITE
 12959*         DATASET  (ARCH-FILE-ID)
 12960*         FROM     (LETTER-ARCHIVE)
 12961*    END-EXEC.
 12962     MOVE LENGTH OF
 12963      LETTER-ARCHIVE
 12964       TO DFHEIV11
 12965*    MOVE '&& L                  %   #00011264' TO DFHEIV0
 12966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12968     MOVE X'2020233030303131323634' TO DFHEIV0(25:11)
 12969     CALL 'kxdfhei1' USING DFHEIV0,
 12970           ARCH-FILE-ID,
 12971           LETTER-ARCHIVE,
 12972           DFHEIV11,
 12973           DFHEIV99
 12974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12975
 12976
 12977     GO TO 2475-EXIT.
 12978
 12979 2475-UNLOCK.
 12980
 12981* EXEC CICS UNLOCK
 12982*         DATASET  (ARCH-FILE-ID)
 12983*    END-EXEC.
 12984*    MOVE '&*                    #   #00011272' TO DFHEIV0
 12985     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12986     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12987     MOVE X'2020233030303131323732' TO DFHEIV0(25:11)
 12988     CALL 'kxdfhei1' USING DFHEIV0,
 12989           ARCH-FILE-ID,
 12990           DFHEIV99
 12991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12992
 12993
 12994 2475-EXIT.
 12995     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 243
* EL131.cbl
 12997 2600-CREATE-MAINT-NOTE.
 12998     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12999     MOVE '1'                    TO CNTL-REC-TYPE.
 13000     MOVE SPACES                 TO CNTL-PROC-ID.
 13001     MOVE ZERO                   TO CNTL-SEQ-NO.
 13002
 13003
 13004* EXEC CICS READ
 13005*         SET        (ADDRESS OF CONTROL-FILE)
 13006*         DATASET    ('ELCNTL')
 13007*         RIDFLD     (CNTL-KEY)
 13008*    END-EXEC.
 13009     MOVE 'ELCNTL' TO DFHEIV1
 13010*    MOVE '&"S        E          (   #00011285' TO DFHEIV0
 13011     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13013     MOVE X'2020233030303131323835' TO DFHEIV0(25:11)
 13014     CALL 'kxdfhei1' USING DFHEIV0,
 13015           DFHEIV1,
 13016           DFHEIV20,
 13017           DFHEIV99,
 13018           CNTL-KEY,
 13019           DFHEIV99,
 13020           DFHEIV99,
 13021           DFHEIV99
 13022     SET ADDRESS OF CONTROL-FILE TO
 13023         DFHEIV20
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13025
 13026
 13027     IF CO-NO-USE-AUDIT-CHANGES
 13028         GO TO 2600-EXIT.
 13029
 13030     IF PROCL GREATER ZERO
 13031     IF PROCI NOT = LOW-VALUES
 13032     IF PROCI NOT = CL-PROCESSOR-ID
 13033         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13034         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13035         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13036
 13037     IF SEXL GREATER ZERO
 13038     IF SEXI NOT = LOW-VALUES
 13039     IF SEXI NOT = CL-INSURED-SEX-CD
 13040         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13041         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13042         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13043
 13044     IF BIRTHL GREATER ZERO
 13045     IF HOLD-BIRTH NOT = LOW-VALUES
 13046     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13047         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13048         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13049         MOVE SPACES               TO DC-OPTION-CODE
 13050         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13051         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13052         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13053
 13054     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 244
* EL131.cbl
 13055     IF SOCIALI NOT = LOW-VALUES
 13056     IF SOCIALI NOT = CL-SOC-SEC-NO
 13057         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13058         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13059         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13060
 13061     IF OCCL GREATER ZERO
 13062     IF OCCI NOT = LOW-VALUES
 13063     IF OCCI NOT = CL-INSURED-OCC-CD
 13064         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13065         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13066         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13067
 13068     IF BENEL GREATER ZERO
 13069     IF BENEI NOT = LOW-VALUES
 13070     IF BENEI NOT = CL-BENEFICIARY
 13071         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13072         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13073         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13074
 13075     IF PREMTYPL GREATER ZERO
 13076     IF PREMTYPI NOT = LOW-VALUES
 13077     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13078         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13079         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13080         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13081
 13082*    IF CAUSEL GREATER ZERO
 13083*    IF CAUSEI NOT = LOW-VALUES
 13084*    IF CAUSEI NOT = CL-CAUSE-CD
 13085*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13086*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13087*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13088
 13089*    IF ENDL GREATER ZERO
 13090*    IF HOLD-END NOT = LOW-VALUES
 13091*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13092*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13093*        MOVE CL-EST-END-OF-DISAB-DT
 13094*                                  TO DC-BIN-DATE-1
 13095*        MOVE SPACES               TO DC-OPTION-CODE
 13096*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13097*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13098*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13099
 13100     IF PDTHRUL GREATER ZERO
 13101     IF HOLD-PDTHRU NOT = LOW-VALUES
 13102     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13103         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13104         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13105         MOVE SPACES               TO DC-OPTION-CODE
 13106         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13107         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13108         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13109
 13110     IF PDAMTL GREATER ZERO
 13111     IF HOLD-PDAMT NOT = ZEROS
 13112     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 245
* EL131.cbl
 13113         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13114         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13115         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13116         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13117
 13118     IF NODAYSL GREATER ZERO
 13119     IF HOLD-NODAYS NOT = ZEROS
 13120     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13121         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13122         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13123         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13124         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13125
 13126     IF NOPMTSL GREATER ZERO
 13127     IF HOLD-NOPMTS NOT = ZEROS
 13128     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13129         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13130         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13131         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13132         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13133
 13134     IF FORMTYPL GREATER ZERO
 13135     IF FORMTYPI NOT = LOW-VALUES
 13136     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13137         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13138         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13139         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13140
 13141     IF REPL GREATER ZERO
 13142     IF HOLD-REPORTED NOT = LOW-VALUES
 13143     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13144         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13145         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13146         MOVE SPACES               TO DC-OPTION-CODE
 13147         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13148         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13149         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13150
 13151     IF ADDONDTL GREATER ZERO
 13152     IF HOLD-ADDON NOT = LOW-VALUES
 13153     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13154         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13155         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13156         MOVE SPACES               TO DC-OPTION-CODE
 13157         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13158         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13159         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13160
 13161     IF PRICDL GREATER ZERO
 13162     IF PRICDI NOT = LOW-VALUES
 13163     IF PRICDI NOT = CL-PRIORITY-CD
 13164         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13165         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13166         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13167
 13168     IF FILETOL GREATER ZERO
 13169     IF FILETOI NOT = LOW-VALUES
 13170     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 246
* EL131.cbl
 13171         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13172         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13173         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13174
 13175     IF SUPVL GREATER ZERO
 13176     IF SUPVI NOT = LOW-VALUES
 13177     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13178         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13179         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13180         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13181*    IF (CRITPTL > ZERO)
 13182*       AND (CRITPTI NOT = LOW-VALUES)
 13183*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13184*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13185*       MOVE CL-CRIT-PER-RECURRENT
 13186*                                TO SPLIT-INFO-OLD
 13187*       PERFORM 2650-WRITE-MAINT-NOTE
 13188*                                THRU 2650-EXIT
 13189*    END-IF
 13190
 13191*    IF (RTWMOSL > ZERO)
 13192*       AND (RTWMOSI NOT = LOW-VALUES)
 13193*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13194*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13195*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13196*       PERFORM 2650-WRITE-MAINT-NOTE
 13197*                                THRU 2650-EXIT
 13198*    END-IF
 13199     IF MLNAMEL GREATER ZERO
 13200     IF MLNAMEI NOT = LOW-VALUES
 13201     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13202         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13203         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13204         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13205
 13206     IF MFNAMEL GREATER ZERO
 13207     IF MFNAMEI NOT = LOW-VALUES
 13208     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13209         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13210         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13211         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13212
 13213     IF MMINITL GREATER ZERO
 13214     IF MMINITI NOT = LOW-VALUES
 13215     IF MMINITI NOT = CL-INSURED-MID-INIT
 13216         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13217         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13218         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13219
 13220     IF CERTEFFL GREATER ZERO
 13221     IF HOLD-EFF NOT = LOW-VALUES
 13222     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13223         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13224         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13225         MOVE SPACES               TO DC-OPTION-CODE
 13226         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13227         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 247
* EL131.cbl
 13229
 13230     IF CERTACTL GREATER ZERO
 13231     IF CERTACTI NOT = LOW-VALUES
 13232     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13233         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13234         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13235         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13236
 13237     IF CERTSTL GREATER ZERO
 13238     IF CERTSTI NOT = LOW-VALUES
 13239     IF CERTSTI NOT = CL-CERT-STATE
 13240         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13241         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13242         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13243
 13244     IF CERTCARL GREATER ZERO
 13245     IF CERTCARI NOT = LOW-VALUES
 13246     IF CERTCARI NOT = CL-CERT-CARRIER
 13247         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13248         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13249         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13250
 13251     IF CERTGRPL GREATER ZERO
 13252     IF CERTGRPI NOT = LOW-VALUES
 13253     IF CERTGRPI NOT = CL-CERT-GROUPING
 13254         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13255         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13256         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13257
 13258     IF CERTL GREATER ZERO OR
 13259        SUFXL GREATER ZERO
 13260     IF (CERTI NOT = LOW-VALUES AND
 13261                     CL-CERT-PRIME)
 13262                OR
 13263        (SUFXI NOT = LOW-VALUES AND
 13264                     CL-CERT-SFX)
 13265         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13266         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13267         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13268     IF incl > zeros
 13269        IF (HOLD-INCUR NOT = LOW-VALUES)
 13270           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13271           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13272           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13273           MOVE SPACES           TO DC-OPTION-CODE
 13274           PERFORM 9800-CONVERT-DATE
 13275                                 THRU 9800-EXIT
 13276           MOVE DC-GREG-DATE-1-EDIT
 13277                                 TO SPLIT-INFO-OLD
 13278           PERFORM 2650-WRITE-MAINT-NOTE
 13279                                 THRU 2650-EXIT
 13280        END-IF
 13281     END-IF
 13282     .
 13283 2600-EXIT.
 13284      EXIT.
 13285
 13286 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 248
* EL131.cbl
 13287
 13288* EXEC CICS GETMAIN
 13289*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13290*         LENGTH   (TRLR-LENGTH)
 13291*         INITIMG  (GETMAIN-SPACE)
 13292*    END-EXEC.
 13293*    MOVE ',"IL                  $   #00011551' TO DFHEIV0
 13294     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13295     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13296     MOVE X'2020233030303131353531' TO DFHEIV0(25:11)
 13297     CALL 'kxdfhei1' USING DFHEIV0,
 13298           DFHEIV20,
 13299           TRLR-LENGTH,
 13300           GETMAIN-SPACE
 13301     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13302         DFHEIV20
 13303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13304
 13305
 13306
 13307* EXEC CICS HANDLE CONDITION
 13308*         DUPREC   (2650-EXIT)
 13309*    END-EXEC.
 13310*    MOVE '"$%                   ! ; #00011557' TO DFHEIV0
 13311     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13313     MOVE X'3B20233030303131353537' TO DFHEIV0(25:11)
 13314     CALL 'kxdfhei1' USING DFHEIV0
 13315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13316
 13317
 13318     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13319
 13320     IF CERTL GREATER ZERO
 13321         MOVE CERTI          TO CL-CERT-PRIME.
 13322
 13323     IF SUFXL GREATER ZERO
 13324         MOVE SUFXI          TO CL-CERT-SFX.
 13325
 13326     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13327
 13328     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13329     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13330
 13331     MOVE 'AT'               TO AT-RECORD-ID.
 13332
 13333     MOVE '6'                TO AT-TRAILER-TYPE.
 13334     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13335                                AT-GEN-INFO-LAST-MAINT-DT.
 13336     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13337                                AT-GEN-INFO-LAST-UPDATED-BY.
 13338     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13339     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13340     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13341
 13342
 13343* EXEC CICS WRITE
 13344*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 249
* EL131.cbl
 13345*         RIDFLD   (AT-CONTROL-PRIMARY)
 13346*         FROM     (ACTIVITY-TRAILERS)
 13347*    END-EXEC.
 13348     MOVE LENGTH OF
 13349      ACTIVITY-TRAILERS
 13350       TO DFHEIV11
 13351*    MOVE '&$ L                  ''   #00011585' TO DFHEIV0
 13352     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13354     MOVE X'2020233030303131353835' TO DFHEIV0(25:11)
 13355     CALL 'kxdfhei1' USING DFHEIV0,
 13356           TRLR-FILE-ID,
 13357           ACTIVITY-TRAILERS,
 13358           DFHEIV11,
 13359           AT-CONTROL-PRIMARY,
 13360           DFHEIV99,
 13361           DFHEIV99
 13362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13363
 13364
 13365 2650-EXIT.
 13366      EXIT.
 13367
 13368 2800-CHECK-AUTO-PAY.
 13369
 13370     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13371     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13372     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13373     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13374     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13375
 13376
 13377* EXEC CICS HANDLE CONDITION
 13378*         NOTFND    (2800-EXIT)
 13379*         ENDFILE   (2800-EXIT)
 13380*    END-EXEC.
 13381*    MOVE '"$I''                  ! < #00011602' TO DFHEIV0
 13382     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13384     MOVE X'3C20233030303131363032' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0
 13386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13387
 13388
 13389
 13390* EXEC CICS READ
 13391*        DATASET (TRLR-FILE-ID)
 13392*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13393*        RIDFLD  (TRLR-KEY)
 13394*    END-EXEC.
 13395*    MOVE '&"S        E          (   #00011607' TO DFHEIV0
 13396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13398     MOVE X'2020233030303131363037' TO DFHEIV0(25:11)
 13399     CALL 'kxdfhei1' USING DFHEIV0,
 13400           TRLR-FILE-ID,
 13401           DFHEIV20,
 13402           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 250
* EL131.cbl
 13403           TRLR-KEY,
 13404           DFHEIV99,
 13405           DFHEIV99,
 13406           DFHEIV99
 13407     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13408         DFHEIV20
 13409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13410
 13411
 13412     IF BENEFICIARY-PAID-AUTO
 13413         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13414     END-IF.
 13415
 13416 2800-EXIT.
 13417      EXIT.
 13418
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 251
* EL131.cbl
 13420 3000-DELETE-CLAIM.
 13421     IF  NOT MODIFY-CAP
 13422         MOVE ER-0070            TO EMI-ERROR
 13423         MOVE -1                 TO MAINTL
 13424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13425         GO TO 8110-SEND-DATA.
 13426
 13427
 13428* EXEC CICS READ
 13429*         SET      (ADDRESS OF CLAIM-MASTER)
 13430*         DATASET  (CLMS-FILE-ID)
 13431*         RIDFLD   (MSTR-KEY)
 13432*    END-EXEC.
 13433*    MOVE '&"S        E          (   #00011628' TO DFHEIV0
 13434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13436     MOVE X'2020233030303131363238' TO DFHEIV0(25:11)
 13437     CALL 'kxdfhei1' USING DFHEIV0,
 13438           CLMS-FILE-ID,
 13439           DFHEIV20,
 13440           DFHEIV99,
 13441           MSTR-KEY,
 13442           DFHEIV99,
 13443           DFHEIV99,
 13444           DFHEIV99
 13445     SET ADDRESS OF CLAIM-MASTER TO
 13446         DFHEIV20
 13447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13448
 13449
 13450     IF CL-1ST-TRL-AVAIL
 13451         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13452     ELSE
 13453        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13454        MOVE 0                   TO TRLR-SEQ-NO
 13455
 13456* EXEC CICS STARTBR
 13457*            DATASET (TRLR-FILE-ID)
 13458*            RIDFLD  (TRLR-KEY)
 13459*        END-EXEC
 13460     MOVE 0
 13461       TO DFHEIV11
 13462*    MOVE '&,         G          &   #00011639' TO DFHEIV0
 13463     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13465     MOVE X'2020233030303131363339' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0,
 13467           TRLR-FILE-ID,
 13468           TRLR-KEY,
 13469           DFHEIV99,
 13470           DFHEIV11,
 13471           DFHEIV99
 13472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13473         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13474
 13475* EXEC CICS ENDBR
 13476*            DATASET (TRLR-FILE-ID)
 13477*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 252
* EL131.cbl
 13478     MOVE 0
 13479       TO DFHEIV11
 13480*    MOVE '&2                    $   #00011644' TO DFHEIV0
 13481     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13482     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13483     MOVE X'2020233030303131363434' TO DFHEIV0(25:11)
 13484     CALL 'kxdfhei1' USING DFHEIV0,
 13485           TRLR-FILE-ID,
 13486           DFHEIV11,
 13487           DFHEIV99
 13488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13489        IF SCREEN-ERROR
 13490            MOVE ER-0208         TO EMI-ERROR
 13491            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13492            MOVE -1              TO MAINTL
 13493            GO TO 8110-SEND-DATA
 13494        ELSE
 13495            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13496
 13497     IF SCREEN-ERROR
 13498         MOVE -1                 TO MAINTL
 13499         GO TO 8110-SEND-DATA.
 13500
 13501     MOVE -1                     TO ONE-OR-MIN1.
 13502     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13503
 13504     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13505         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13506                                    WS-SAVE-CLAIM-KEY
 13507         MOVE +1                 TO ONE-OR-MIN1
 13508         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13509
 13510     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13511
 13512     MOVE LOW-VALUES             TO EL131AO.
 13513     MOVE ER-0000                TO EMI-ERROR.
 13514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13515     MOVE 'X'                    TO PI-RETURN-CD-1.
 13516     MOVE -1                     TO MAINTL.
 13517     GO TO 8100-SEND-MAP.
 13518
 13519 3010-DEL-MSTR-TRLR.
 13520
 13521* EXEC CICS READ UPDATE
 13522*         SET       (ADDRESS OF CLAIM-MASTER)
 13523*         DATASET   (CLMS-FILE-ID)
 13524*         RIDFLD    (MSTR-KEY)
 13525*    END-EXEC.
 13526*    MOVE '&"S        EU         (   #00011678' TO DFHEIV0
 13527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13528     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13529     MOVE X'2020233030303131363738' TO DFHEIV0(25:11)
 13530     CALL 'kxdfhei1' USING DFHEIV0,
 13531           CLMS-FILE-ID,
 13532           DFHEIV20,
 13533           DFHEIV99,
 13534           MSTR-KEY,
 13535           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 253
* EL131.cbl
 13536           DFHEIV99,
 13537           DFHEIV99
 13538     SET ADDRESS OF CLAIM-MASTER TO
 13539         DFHEIV20
 13540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13541
 13542
 13543     if (cl-priority-cd = '8')
 13544        and (pi-processor-id not = 'PEMA' and 'JMS '
 13545             AND 'AMWA')
 13546        MOVE ER-8003             TO EMI-ERROR
 13547        PERFORM 9900-ERROR-FORMAT
 13548                                 THRU 9900-EXIT
 13549        MOVE -1                  TO MAINTL
 13550        GO TO 8110-SEND-DATA
 13551     end-if
 13552
 13553     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13554     MOVE ZERO                   TO TRLR-SEQ-NO.
 13555
 13556
 13557* EXEC CICS HANDLE CONDITION
 13558*         NOTFND    (3010-DEL-ACTQ)
 13559*         ENDFILE   (3040-EXIT)
 13560*    END-EXEC.
 13561*    MOVE '"$I''                  ! = #00011697' TO DFHEIV0
 13562     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13564     MOVE X'3D20233030303131363937' TO DFHEIV0(25:11)
 13565     CALL 'kxdfhei1' USING DFHEIV0
 13566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13567
 13568
 13569     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13570
 13571 3010-DEL-ACTQ.
 13572
 13573
 13574* EXEC CICS HANDLE CONDITION
 13575*         NOTFND    (3010-NO-ACTIVITY)
 13576*         ENDFILE   (3050-EXIT)
 13577*    END-EXEC.
 13578*    MOVE '"$I''                  ! > #00011706' TO DFHEIV0
 13579     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13581     MOVE X'3E20233030303131373036' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0
 13583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13584
 13585
 13586
 13587* EXEC CICS STARTBR
 13588*         DATASET  (ACTQ-FILE-ID)
 13589*         RIDFLD   (ACTQ-KEY)
 13590*    END-EXEC.
 13591     MOVE 0
 13592       TO DFHEIV11
 13593*    MOVE '&,         G          &   #00011711' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 254
* EL131.cbl
 13594     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13596     MOVE X'2020233030303131373131' TO DFHEIV0(25:11)
 13597     CALL 'kxdfhei1' USING DFHEIV0,
 13598           ACTQ-FILE-ID,
 13599           ACTQ-KEY,
 13600           DFHEIV99,
 13601           DFHEIV11,
 13602           DFHEIV99
 13603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13604
 13605
 13606
 13607* EXEC CICS GETMAIN
 13608*         SET      (ADDRESS OF ACTIVITY-QUE)
 13609*         LENGTH   (ACTQ-LENGTH)
 13610*         INITIMG  (GETMAIN-SPACE)
 13611*    END-EXEC.
 13612*    MOVE ',"IL                  $   #00011716' TO DFHEIV0
 13613     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13614     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13615     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 13616     CALL 'kxdfhei1' USING DFHEIV0,
 13617           DFHEIV20,
 13618           ACTQ-LENGTH,
 13619           GETMAIN-SPACE
 13620     SET ADDRESS OF ACTIVITY-QUE TO
 13621         DFHEIV20
 13622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13623
 13624
 13625     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13626
 13627
 13628* EXEC CICS ENDBR
 13629*         DATASET (ACTQ-FILE-ID)
 13630*    END-EXEC.
 13631     MOVE 0
 13632       TO DFHEIV11
 13633*    MOVE '&2                    $   #00011724' TO DFHEIV0
 13634     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13636     MOVE X'2020233030303131373234' TO DFHEIV0(25:11)
 13637     CALL 'kxdfhei1' USING DFHEIV0,
 13638           ACTQ-FILE-ID,
 13639           DFHEIV11,
 13640           DFHEIV99
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13642
 13643
 13644 3010-NO-ACTIVITY.
 13645
 13646
 13647* EXEC CICS HANDLE CONDITION
 13648*        NOTFND   (3010-CERT-NOT-FOUND)
 13649*    END-EXEC.
 13650*    MOVE '"$I                   ! ? #00011730' TO DFHEIV0
 13651     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 255
* EL131.cbl
 13652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13653     MOVE X'3F20233030303131373330' TO DFHEIV0(25:11)
 13654     CALL 'kxdfhei1' USING DFHEIV0
 13655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13656
 13657
 13658     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13659     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13660     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13661     MOVE CL-CERT-STATE          TO CERT-STATE.
 13662     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13663     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13664     MOVE CL-CERT-NO             TO CERT-CERT.
 13665
 13666
 13667* EXEC CICS READ
 13668*        DATASET   (CERT-FILE-ID)
 13669*        RIDFLD    (CERT-KEY)
 13670*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13671*    END-EXEC.
 13672*    MOVE '&"S        E          (   #00011742' TO DFHEIV0
 13673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13675     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 13676     CALL 'kxdfhei1' USING DFHEIV0,
 13677           CERT-FILE-ID,
 13678           DFHEIV20,
 13679           DFHEIV99,
 13680           CERT-KEY,
 13681           DFHEIV99,
 13682           DFHEIV99,
 13683           DFHEIV99
 13684     SET ADDRESS OF CERTIFICATE-MASTER TO
 13685         DFHEIV20
 13686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13687
 13688
 13689     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13690       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13691         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13692     ELSE
 13693         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13694
 13695 3010-UPDATE-CERT-TRLR.
 13696
 13697     MOVE CERT-KEY               TO ELCRTT-KEY
 13698     MOVE 'B'                    TO CTRLR-REC-TYPE
 13699
 13700* EXEC CICS READ
 13701*       UPDATE
 13702*       DATASET   ('ELCRTT')
 13703*       RIDFLD    (ELCRTT-KEY)
 13704*       INTO      (CERTIFICATE-TRAILERS)
 13705*       RESP      (WS-RESPONSE)
 13706*    END-EXEC
 13707     MOVE LENGTH OF
 13708      CERTIFICATE-TRAILERS
 13709       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 256
* EL131.cbl
 13710     MOVE 'ELCRTT' TO DFHEIV1
 13711*    MOVE '&"IL       EU         (  N#00011758' TO DFHEIV0
 13712     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13713     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13714     MOVE X'204E233030303131373538' TO DFHEIV0(25:11)
 13715     CALL 'kxdfhei1' USING DFHEIV0,
 13716           DFHEIV1,
 13717           CERTIFICATE-TRAILERS,
 13718           DFHEIV11,
 13719           ELCRTT-KEY,
 13720           DFHEIV99,
 13721           DFHEIV99,
 13722           DFHEIV99
 13723     MOVE EIBRESP  TO WS-RESPONSE
 13724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13725     IF WS-RESP-NORMAL
 13726        perform varying s1 from +1 by +1 until
 13727           (s1 > +24)
 13728           or (cs-claim-no (s1) = cl-claim-no)
 13729        end-perform
 13730        if s1 < +25
 13731           move spaces           to cs-claim-no (s1)
 13732                                    cs-claim-type (s1)
 13733                                    cs-insured-type (s1)
 13734           move zeros            to cs-days-paid (s1)
 13735                                    cs-total-paid (s1)
 13736                                    cs-benefit-period (s1)
 13737           if s1 not = +24
 13738              compute s2 = s1 + +1
 13739              perform 3015-bump  thru 3015-exit
 13740           end-if
 13741
 13742* EXEC CICS REWRITE
 13743*             DATASET   ('ELCRTT')
 13744*             FROM      (CERTIFICATE-TRAILERS)
 13745*          END-EXEC
 13746     MOVE LENGTH OF
 13747      CERTIFICATE-TRAILERS
 13748       TO DFHEIV11
 13749     MOVE 'ELCRTT' TO DFHEIV1
 13750*    MOVE '&& L                  %   #00011781' TO DFHEIV0
 13751     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13752     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13753     MOVE X'2020233030303131373831' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0,
 13755           DFHEIV1,
 13756           CERTIFICATE-TRAILERS,
 13757           DFHEIV11,
 13758           DFHEIV99
 13759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13760        end-if
 13761     end-if
 13762     .
 13763 3010-CERT-NOT-FOUND.
 13764
 13765
 13766* EXEC CICS DELETE
 13767*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 257
* EL131.cbl
 13768*    END-EXEC.
 13769*    MOVE '&(                    &   #00011790' TO DFHEIV0
 13770     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13772     MOVE X'2020233030303131373930' TO DFHEIV0(25:11)
 13773     CALL 'kxdfhei1' USING DFHEIV0,
 13774           CLMS-FILE-ID,
 13775           DFHEIV99,
 13776           DFHEIV99,
 13777           DFHEIV99,
 13778           DFHEIV99
 13779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13780
 13781
 13782 3010-EXIT.
 13783      EXIT.
 13784
 13785 3015-bump.
 13786     perform varying s2 from s2 by +1 until s2 > +24
 13787        move cs-mb-claim-data (s2)
 13788                                 to cs-mb-claim-data (s1)
 13789        move spaces              to cs-mb-claim-data (s2)
 13790        add +1 to s1
 13791     end-perform
 13792     .
 13793 3015-exit.
 13794     exit.
 13795 3020-UPDATE-CERT.
 13796
 13797* EXEC CICS READ UPDATE
 13798*         DATASET  (CERT-FILE-ID)
 13799*         RIDFLD   (CERT-KEY)
 13800*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13801*    END-EXEC.
 13802*    MOVE '&"S        EU         (   #00011808' TO DFHEIV0
 13803     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13804     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13805     MOVE X'2020233030303131383038' TO DFHEIV0(25:11)
 13806     CALL 'kxdfhei1' USING DFHEIV0,
 13807           CERT-FILE-ID,
 13808           DFHEIV20,
 13809           DFHEIV99,
 13810           CERT-KEY,
 13811           DFHEIV99,
 13812           DFHEIV99,
 13813           DFHEIV99
 13814     SET ADDRESS OF CERTIFICATE-MASTER TO
 13815         DFHEIV20
 13816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13817
 13818
 13819     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13820
 13821
 13822* EXEC CICS HANDLE CONDITION
 13823*         DUPKEY   (3020-EXIT)
 13824*    END-EXEC.
 13825*    MOVE '"$$                   ! @ #00011816' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 258
* EL131.cbl
 13826     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13828     MOVE X'4020233030303131383136' TO DFHEIV0(25:11)
 13829     CALL 'kxdfhei1' USING DFHEIV0
 13830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13831
 13832
 13833
 13834* EXEC CICS REWRITE
 13835*         DATASET  (CERT-FILE-ID)
 13836*         FROM     (CERTIFICATE-MASTER)
 13837*    END-EXEC.
 13838     MOVE LENGTH OF
 13839      CERTIFICATE-MASTER
 13840       TO DFHEIV11
 13841*    MOVE '&& L                  %   #00011820' TO DFHEIV0
 13842     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13844     MOVE X'2020233030303131383230' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0,
 13846           CERT-FILE-ID,
 13847           CERTIFICATE-MASTER,
 13848           DFHEIV11,
 13849           DFHEIV99
 13850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13851
 13852
 13853 3020-EXIT.
 13854     EXIT.
 13855
 13856 3030-DELETE-CERT.
 13857
 13858* EXEC CICS READ UPDATE
 13859*         DATASET  (CERT-FILE-ID)
 13860*         RIDFLD   (CERT-KEY)
 13861*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13862*    END-EXEC.
 13863*    MOVE '&"S        EU         (   #00011829' TO DFHEIV0
 13864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13865     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13866     MOVE X'2020233030303131383239' TO DFHEIV0(25:11)
 13867     CALL 'kxdfhei1' USING DFHEIV0,
 13868           CERT-FILE-ID,
 13869           DFHEIV20,
 13870           DFHEIV99,
 13871           CERT-KEY,
 13872           DFHEIV99,
 13873           DFHEIV99,
 13874           DFHEIV99
 13875     SET ADDRESS OF CERTIFICATE-MASTER TO
 13876         DFHEIV20
 13877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13878
 13879
 13880
 13881* EXEC CICS DELETE
 13882*         DATASET   (CERT-FILE-ID)
 13883*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 259
* EL131.cbl
 13884*    MOVE '&(                    &   #00011835' TO DFHEIV0
 13885     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13887     MOVE X'2020233030303131383335' TO DFHEIV0(25:11)
 13888     CALL 'kxdfhei1' USING DFHEIV0,
 13889           CERT-FILE-ID,
 13890           DFHEIV99,
 13891           DFHEIV99,
 13892           DFHEIV99,
 13893           DFHEIV99
 13894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13895
 13896
 13897 3030-EXIT.
 13898     EXIT.
 13899
 13900 3040-DELETE-TRLR.
 13901
 13902* EXEC CICS READ
 13903*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13904*         DATASET  (TRLR-FILE-ID)
 13905*         RIDFLD   (TRLR-KEY)
 13906*         GTEQ
 13907*    END-EXEC.
 13908*    MOVE '&"S        G          (   #00011843' TO DFHEIV0
 13909     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13911     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 13912     CALL 'kxdfhei1' USING DFHEIV0,
 13913           TRLR-FILE-ID,
 13914           DFHEIV20,
 13915           DFHEIV99,
 13916           TRLR-KEY,
 13917           DFHEIV99,
 13918           DFHEIV99,
 13919           DFHEIV99
 13920     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13921         DFHEIV20
 13922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13923
 13924
 13925     IF PI-COMPANY-CD = AT-COMPANY-CD
 13926        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13927        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13928           GO TO 3040-EXIT
 13929        ELSE
 13930           NEXT SENTENCE
 13931     ELSE
 13932        GO TO 3040-EXIT.
 13933
 13934
 13935* EXEC CICS DELETE
 13936*         DATASET  (TRLR-FILE-ID)
 13937*         RIDFLD   (TRLR-KEY)
 13938*    END-EXEC.
 13939*    MOVE '&(  R                 &   #00011859' TO DFHEIV0
 13940     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13941     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 260
* EL131.cbl
 13942     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 13943     CALL 'kxdfhei1' USING DFHEIV0,
 13944           TRLR-FILE-ID,
 13945           TRLR-KEY,
 13946           DFHEIV99,
 13947           DFHEIV99,
 13948           DFHEIV99
 13949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13950
 13951
 13952     GO TO 3040-DELETE-TRLR.
 13953
 13954 3040-EXIT.
 13955     EXIT.
 13956
 13957 3050-DELETE-ACTQ.
 13958
 13959* EXEC CICS READNEXT
 13960*         DATASET  (ACTQ-FILE-ID)
 13961*         RIDFLD   (ACTQ-KEY)
 13962*         INTO     (ACTIVITY-QUE)
 13963*    END-EXEC.
 13964     MOVE LENGTH OF
 13965      ACTIVITY-QUE
 13966       TO DFHEIV12
 13967     MOVE 0
 13968       TO DFHEIV11
 13969*    MOVE '&.IL                  )   #00011870' TO DFHEIV0
 13970     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13971     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13972     MOVE X'2020233030303131383730' TO DFHEIV0(25:11)
 13973     CALL 'kxdfhei1' USING DFHEIV0,
 13974           ACTQ-FILE-ID,
 13975           ACTIVITY-QUE,
 13976           DFHEIV12,
 13977           ACTQ-KEY,
 13978           DFHEIV99,
 13979           DFHEIV11,
 13980           DFHEIV99,
 13981           DFHEIV99
 13982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13983
 13984
 13985     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13986         GO TO 3050-EXIT.
 13987
 13988
 13989* EXEC CICS ENDBR
 13990*         DATASET  (ACTQ-FILE-ID)
 13991*    END-EXEC.
 13992     MOVE 0
 13993       TO DFHEIV11
 13994*    MOVE '&2                    $   #00011879' TO DFHEIV0
 13995     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13996     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13997     MOVE X'2020233030303131383739' TO DFHEIV0(25:11)
 13998     CALL 'kxdfhei1' USING DFHEIV0,
 13999           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 261
* EL131.cbl
 14000           DFHEIV11,
 14001           DFHEIV99
 14002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14003
 14004
 14005
 14006* EXEC CICS DELETE
 14007*         DATASET   (ACTQ-FILE-ID)
 14008*         RIDFLD    (ACTQ-KEY)
 14009*    END-EXEC.
 14010*    MOVE '&(  R                 &   #00011883' TO DFHEIV0
 14011     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14012     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14013     MOVE X'2020233030303131383833' TO DFHEIV0(25:11)
 14014     CALL 'kxdfhei1' USING DFHEIV0,
 14015           ACTQ-FILE-ID,
 14016           ACTQ-KEY,
 14017           DFHEIV99,
 14018           DFHEIV99,
 14019           DFHEIV99
 14020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14021
 14022
 14023
 14024* EXEC CICS STARTBR
 14025*         DATASET   (ACTQ-FILE-ID)
 14026*         RIDFLD    (ACTQ-KEY)
 14027*    END-EXEC.
 14028     MOVE 0
 14029       TO DFHEIV11
 14030*    MOVE '&,         G          &   #00011888' TO DFHEIV0
 14031     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14033     MOVE X'2020233030303131383838' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0,
 14035           ACTQ-FILE-ID,
 14036           ACTQ-KEY,
 14037           DFHEIV99,
 14038           DFHEIV11,
 14039           DFHEIV99
 14040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14041
 14042
 14043     GO TO 3050-DELETE-ACTQ.
 14044
 14045 3050-EXIT.
 14046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 262
* EL131.cbl
 14048 3060-READ-TRLR.
 14049
 14050* EXEC CICS HANDLE CONDITION
 14051*         NOTFND    (3060-EXIT)
 14052*         ENDFILE   (3060-EXIT)
 14053*    END-EXEC.
 14054*    MOVE '"$I''                  ! A #00011899' TO DFHEIV0
 14055     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14057     MOVE X'4120233030303131383939' TO DFHEIV0(25:11)
 14058     CALL 'kxdfhei1' USING DFHEIV0
 14059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14060
 14061
 14062 3060-LOOP.
 14063
 14064* EXEC CICS READNEXT
 14065*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14066*         DATASET  (TRLR-FILE-ID)
 14067*         RIDFLD   (TRLR-KEY)
 14068*    END-EXEC.
 14069     MOVE 0
 14070       TO DFHEIV11
 14071*    MOVE '&.S                   )   #00011905' TO DFHEIV0
 14072     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14073     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14074     MOVE X'2020233030303131393035' TO DFHEIV0(25:11)
 14075     CALL 'kxdfhei1' USING DFHEIV0,
 14076           TRLR-FILE-ID,
 14077           DFHEIV20,
 14078           DFHEIV99,
 14079           TRLR-KEY,
 14080           DFHEIV99,
 14081           DFHEIV11,
 14082           DFHEIV99,
 14083           DFHEIV99
 14084     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14085         DFHEIV20
 14086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14087
 14088
 14089     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14090         GO TO 3060-EXIT.
 14091
 14092     IF FORM-CONTROL-TR
 14093         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14094             NEXT SENTENCE
 14095         ELSE
 14096             MOVE 'X'            TO ERROR-SWITCH
 14097             GO TO 3060-EXIT
 14098     ELSE
 14099         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14100            MOVE 'X'                 TO ERROR-SWITCH
 14101            GO TO 3060-EXIT.
 14102
 14103     GO TO 3060-LOOP.
 14104
 14105 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 263
* EL131.cbl
 14106     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 264
* EL131.cbl
 14108 3997-GET-ERPDEF.
 14109
 14110     move cl-company-cd          to cert-company-code
 14111     move cl-cert-key-data       to cert-key (2:21)
 14112     move cl-cert-no             to cert-cert
 14113
 14114
 14115* EXEC CICS READ
 14116*        DATASET   (CERT-FILE-ID)
 14117*        RIDFLD    (CERT-KEY)
 14118*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14119*        resp      (ws-response)
 14120*    END-EXEC
 14121*    MOVE '&"S        E          (  N#00011936' TO DFHEIV0
 14122     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14123     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14124     MOVE X'204E233030303131393336' TO DFHEIV0(25:11)
 14125     CALL 'kxdfhei1' USING DFHEIV0,
 14126           CERT-FILE-ID,
 14127           DFHEIV20,
 14128           DFHEIV99,
 14129           CERT-KEY,
 14130           DFHEIV99,
 14131           DFHEIV99,
 14132           DFHEIV99
 14133     SET ADDRESS OF CERTIFICATE-MASTER TO
 14134         DFHEIV20
 14135     MOVE EIBRESP  TO ws-response
 14136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14137
 14138     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14139                                    WS-ERPDEF-SW
 14140     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14141                                    WS-CRIT-PER-RTW-MOS
 14142
 14143     if cm-clp-state = spaces or low-values or zeros
 14144        move cm-state            to cm-clp-state
 14145     end-if
 14146     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14147     MOVE CM-clp-state           TO ERPDEF-STATE
 14148     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14149     evaluate true
 14150        when (cl-claim-type = 'L' or 'P')
 14151           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14152             and 'CU')
 14153           move 'L'              to erpdef-ben-type
 14154           move cm-lf-benefit-cd to erpdef-ben-code
 14155        when (cl-claim-type not = 'L' and 'P')
 14156           and (cm-ah-benefit-cd not = '00' and '  ')
 14157           move 'A'              to erpdef-ben-type
 14158           move cm-ah-benefit-cd to erpdef-ben-code
 14159        when (cl-claim-type not = 'L' and 'P')
 14160           and (cm-ah-benefit-cd = '00' or '  ')
 14161           move 'L'              to erpdef-ben-type
 14162           move cm-lf-benefit-cd to erpdef-ben-code
 14163        when (cl-claim-type = 'L' or 'P')
 14164           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14165           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 265
* EL131.cbl
 14166           move cm-ah-benefit-cd to erpdef-ben-code
 14167        when other
 14168           move 'A'              to erpdef-ben-type
 14169           move cm-ah-benefit-cd to erpdef-ben-code
 14170     end-evaluate
 14171
 14172*    if (cl-claim-type = 'L' or 'P')
 14173*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14174*          and 'CU')
 14175*       move 'L'                 to erpdef-ben-type
 14176*       move cm-lf-benefit-cd    to erpdef-ben-code
 14177*    else
 14178*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14179*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14180*    end-if
 14181     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14182     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14183
 14184
 14185* EXEC CICS STARTBR
 14186*        DATASET  ('ERPDEF')
 14187*        RIDFLD   (ERPDEF-KEY)
 14188*        GTEQ
 14189*        RESP     (WS-RESPONSE)
 14190*    END-EXEC
 14191     MOVE 'ERPDEF' TO DFHEIV1
 14192     MOVE 0
 14193       TO DFHEIV11
 14194*    MOVE '&,         G          &  N#00011989' TO DFHEIV0
 14195     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14197     MOVE X'204E233030303131393839' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0,
 14199           DFHEIV1,
 14200           ERPDEF-KEY,
 14201           DFHEIV99,
 14202           DFHEIV11,
 14203           DFHEIV99
 14204     MOVE EIBRESP  TO WS-RESPONSE
 14205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14206
 14207     IF WS-RESP-NORMAL
 14208
 14209* EXEC CICS READNEXT
 14210*          DATASET  ('ERPDEF')
 14211*          INTO     (PRODUCT-MASTER)
 14212*          RIDFLD   (ERPDEF-KEY)
 14213*          RESP     (WS-RESPONSE)
 14214*       END-EXEC
 14215     MOVE LENGTH OF
 14216      PRODUCT-MASTER
 14217       TO DFHEIV12
 14218     MOVE 'ERPDEF' TO DFHEIV1
 14219     MOVE 0
 14220       TO DFHEIV11
 14221*    MOVE '&.IL                  )  N#00011997' TO DFHEIV0
 14222     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14223     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 266
* EL131.cbl
 14224     MOVE X'204E233030303131393937' TO DFHEIV0(25:11)
 14225     CALL 'kxdfhei1' USING DFHEIV0,
 14226           DFHEIV1,
 14227           PRODUCT-MASTER,
 14228           DFHEIV12,
 14229           ERPDEF-KEY,
 14230           DFHEIV99,
 14231           DFHEIV11,
 14232           DFHEIV99,
 14233           DFHEIV99
 14234     MOVE EIBRESP  TO WS-RESPONSE
 14235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14236        IF WS-RESP-NORMAL
 14237           IF (ERPDEF-KEY-SAVE (1:16) =
 14238              PD-CONTROL-PRIMARY (1:16))
 14239              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14240              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14241                 (A1 > +8)
 14242                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14243              END-PERFORM
 14244              IF A1 < +9
 14245                 SET ERPDEF-FOUND TO TRUE
 14246                 MOVE PD-CRIT-PERIOD (A1)
 14247                              TO WS-CRITICAL-PERIOD
 14248                 MOVE PD-REC-CRIT-PERIOD (A1)
 14249                              TO WS-CRIT-PER-RECURRENT
 14250                 IF PD-RTW-MOS (A1) NUMERIC
 14251                    MOVE PD-RTW-MOS (A1)
 14252                              TO WS-CRIT-PER-RTW-MOS
 14253                 ELSE
 14254                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14255                 END-IF
 14256                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14257                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14258                                 TO WS-EXCL-PERIOD
 14259                 END-IF
 14260                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14261                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14262                                 TO WS-COV-ENDS
 14263                 END-IF
 14264                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14265                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14266                                 TO WS-ACC-PERIOD
 14267                 END-IF
 14268                 if pd-max-extension (a1) numeric
 14269                    move pd-max-extension (a1)
 14270                                 to ws-max-extension
 14271                 end-if
 14272                 if pd-max-amt (a1) numeric
 14273                    move pd-max-amt (a1)
 14274                                 to ws-max-moben
 14275                 end-if
 14276              END-IF
 14277           END-IF
 14278        END-IF
 14279     END-IF
 14280
 14281     .
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 267
* EL131.cbl
 14282 3997-EXIT.
 14283     EXIT.
 14284 4000-FORCE-ERRORS.
 14285     IF PI-RETURN-CD-1 = 'X'
 14286         MOVE ER-0311            TO EMI-ERROR
 14287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14288         MOVE -1                 TO MAINTL
 14289         GO TO 8110-SEND-DATA.
 14290
 14291     IF NOT FORCE-CAP
 14292         MOVE ER-0416            TO EMI-ERROR
 14293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14294         MOVE -1                 TO MAINTL
 14295         GO TO 8110-SEND-DATA.
 14296
 14297     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14298     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14299     IF EMI-FATAL-CTR GREATER THAN ZERO
 14300         GO TO 4000-FATAL-ERRORS.
 14301
 14302     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14303
 14304     IF EMI-FATAL-CTR GREATER THAN ZERO
 14305         GO TO 4000-FATAL-ERRORS.
 14306
 14307     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14308
 14309     IF EMI-FATAL-CTR GREATER THAN ZERO
 14310         GO TO 4000-FATAL-ERRORS.
 14311
 14312     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14313     MOVE AL-UANOF               TO CERTA.
 14314     MOVE ER-0000 TO EMI-ERROR.
 14315     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14316
 14317 4000-FATAL-ERRORS.
 14318     MOVE -1                     TO MAINTL.
 14319     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 268
* EL131.cbl
 14321
 14322 4100-SAVE-CHANGES.
 14323     IF MAINTL > 0
 14324         MOVE MAINTI  TO WS-SAVE-MAINTI
 14325         MOVE MAINTL  TO WS-SAVE-MAINTL
 14326     END-IF
 14327     IF STATUSL > 0
 14328         MOVE STATUSI  TO WS-SAVE-STATUSI
 14329         MOVE STATUSL  TO WS-SAVE-STATUSL
 14330     END-IF
 14331     IF REPL > 0
 14332         MOVE REPI  TO WS-SAVE-REPI
 14333         MOVE REPL  TO WS-SAVE-REPL
 14334     END-IF
 14335*    IF CAUSEL > 0
 14336*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14337*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14338*    END-IF
 14339*    IF ENDL > 0
 14340*        MOVE ENDI  TO WS-SAVE-ENDI
 14341*        MOVE ENDL  TO WS-SAVE-ENDL
 14342*    END-IF
 14343     IF DIAGL > 0
 14344         MOVE DIAGI  TO WS-SAVE-DIAGI
 14345         MOVE DIAGL  TO WS-SAVE-DIAGL
 14346     END-IF
 14347     IF ICD1L > 0
 14348         MOVE ICD1I  TO WS-SAVE-ICD1I
 14349         MOVE ICD1L  TO WS-SAVE-ICD1L
 14350     END-IF
 14351     IF ICD2L > 0
 14352         MOVE ICD2I  TO WS-SAVE-ICD2I
 14353         MOVE ICD2L  TO WS-SAVE-ICD2L
 14354     END-IF
 14355     IF BENEL > 0
 14356         MOVE BENEI  TO WS-SAVE-BENEI
 14357         MOVE BENEL  TO WS-SAVE-BENEL
 14358     END-IF
 14359     IF BIRTHL > 0
 14360         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14361         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14362     END-IF
 14363     IF SOCIALL > 0
 14364         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14365         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14366     END-IF
 14367     IF SEXL > 0
 14368         MOVE SEXI  TO WS-SAVE-SEXI
 14369         MOVE SEXL  TO WS-SAVE-SEXL
 14370     END-IF
 14371     IF MLNAMEL > 0
 14372         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14373         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14374     END-IF
 14375     IF MFNAMEL > 0
 14376         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14377         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14378     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 269
* EL131.cbl
 14379     IF MMINITL > 0
 14380         MOVE MMINITI  TO WS-SAVE-MMINITI
 14381         MOVE MMINITL  TO WS-SAVE-MMINITL
 14382     END-IF
 14383*    IF LOANNOL > 0
 14384*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14385*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14386*    END-IF
 14387     IF LOANBALL > 0
 14388         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14389         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14390     END-IF
 14391     IF PROCL > 0
 14392         MOVE PROCI  TO WS-SAVE-PROCI
 14393         MOVE PROCL  TO WS-SAVE-PROCL
 14394     END-IF
 14395     IF SUPVL > 0
 14396         MOVE SUPVI  TO WS-SAVE-SUPVI
 14397         MOVE SUPVL  TO WS-SAVE-SUPVL
 14398     END-IF
 14399     IF PRICDL > 0
 14400         MOVE PRICDI  TO WS-SAVE-PRICDI
 14401         MOVE PRICDL  TO WS-SAVE-PRICDL
 14402     END-IF
 14403     IF FILETOL > 0
 14404         MOVE FILETOI  TO WS-SAVE-FILETOI
 14405         MOVE FILETOL  TO WS-SAVE-FILETOL
 14406     END-IF
 14407     IF PDTHRUL > 0
 14408         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14409         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14410     END-IF
 14411     IF PDAMTL > 0
 14412         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14413         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14414     END-IF
 14415     IF NODAYSL > 0
 14416         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14417         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14418     END-IF
 14419     IF NOPMTSL > 0
 14420         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14421         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14422     END-IF
 14423     IF FORMTYPL > 0
 14424         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14425         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14426     END-IF
 14427     IF OCCL > 0
 14428         MOVE OCCI  TO WS-SAVE-OCCI
 14429         MOVE OCCL  TO WS-SAVE-OCCL
 14430     END-IF.
 14431 4100-EXIT.
 14432      EXIT.
 14433
 14434 4200-LOAD-CHANGES.
 14435     IF WS-SAVE-MAINTL > 0
 14436         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 270
* EL131.cbl
 14437         MOVE WS-SAVE-MAINTL  TO MAINTL
 14438         MOVE AL-UANON        TO MAINTA
 14439     END-IF
 14440     IF WS-SAVE-STATUSL > 0
 14441         MOVE WS-SAVE-STATUSI  TO STATUSI
 14442         MOVE WS-SAVE-STATUSL  TO STATUSL
 14443         MOVE AL-UANON         TO STATUSA
 14444     END-IF
 14445     IF WS-SAVE-REPL > 0
 14446         MOVE WS-SAVE-REPI  TO REPI
 14447         MOVE WS-SAVE-REPL  TO REPL
 14448         MOVE AL-UANON      TO REPA
 14449     END-IF
 14450*    IF WS-SAVE-CAUSEL > 0
 14451*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14452*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14453*        MOVE AL-UANON        TO CAUSEA
 14454*    END-IF
 14455*    IF WS-SAVE-ENDL > 0
 14456*        MOVE WS-SAVE-ENDI  TO ENDI
 14457*        MOVE WS-SAVE-ENDL  TO ENDL
 14458*        MOVE AL-UANON      TO ENDA
 14459*    END-IF
 14460     IF WS-SAVE-DIAGL > 0
 14461         MOVE WS-SAVE-DIAGI  TO DIAGI
 14462         MOVE WS-SAVE-DIAGL  TO DIAGL
 14463         MOVE AL-UANON       TO DIAGA
 14464     END-IF
 14465     IF WS-SAVE-ICD1L > 0
 14466         MOVE WS-SAVE-ICD1I  TO ICD1I
 14467         MOVE WS-SAVE-ICD1L  TO ICD1L
 14468         MOVE AL-UANON       TO ICD1A
 14469     END-IF
 14470     IF WS-SAVE-ICD2L > 0
 14471         MOVE WS-SAVE-ICD2I  TO ICD2I
 14472         MOVE WS-SAVE-ICD2L  TO ICD2L
 14473         MOVE AL-UANON       TO ICD2A
 14474     END-IF
 14475     IF WS-SAVE-BENEL > 0
 14476         MOVE WS-SAVE-BENEI  TO BENEI
 14477         MOVE WS-SAVE-BENEL  TO BENEL
 14478         MOVE AL-UANON       TO BENEA
 14479     END-IF
 14480     IF WS-SAVE-BIRTHL > 0
 14481         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14482         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14483         MOVE AL-UANON        TO BIRTHA
 14484     END-IF
 14485     IF WS-SAVE-SOCIALL > 0
 14486         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14487         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14488         MOVE AL-UANON         TO SOCIALA
 14489     END-IF
 14490     IF WS-SAVE-SEXL > 0
 14491         MOVE WS-SAVE-SEXI  TO SEXI
 14492         MOVE WS-SAVE-SEXL  TO SEXL
 14493         MOVE AL-UANON      TO SEXA
 14494     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 271
* EL131.cbl
 14495     IF WS-SAVE-MLNAMEL > 0
 14496         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14497         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14498         MOVE AL-UANON         TO MLNAMEA
 14499     END-IF
 14500     IF WS-SAVE-MFNAMEL > 0
 14501         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14502         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14503         MOVE AL-UANON         TO MFNAMEA
 14504     END-IF
 14505     IF WS-SAVE-MMINITL > 0
 14506         MOVE WS-SAVE-MMINITI  TO MMINITI
 14507         MOVE WS-SAVE-MMINITL  TO MMINITL
 14508         MOVE AL-UANON         TO MMINITA
 14509     END-IF
 14510*    IF WS-SAVE-LOANNOL > 0
 14511*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14512*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14513*        MOVE AL-UANON         TO LOANNOA
 14514*    END-IF
 14515     IF WS-SAVE-LOANBALL > 0
 14516         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14517         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14518         MOVE AL-UANON          TO LOANBALA
 14519     END-IF
 14520     IF WS-SAVE-PROCL > 0
 14521         MOVE WS-SAVE-PROCI  TO PROCI
 14522         MOVE WS-SAVE-PROCL  TO PROCL
 14523         MOVE AL-UANON       TO PROCA
 14524     END-IF
 14525     IF WS-SAVE-SUPVL > 0
 14526         MOVE WS-SAVE-SUPVI  TO SUPVI
 14527         MOVE WS-SAVE-SUPVL  TO SUPVL
 14528         MOVE AL-UANON       TO SUPVA
 14529     END-IF
 14530     IF WS-SAVE-PRICDL > 0
 14531         MOVE WS-SAVE-PRICDI  TO PRICDI
 14532         MOVE WS-SAVE-PRICDL  TO PRICDL
 14533         MOVE AL-UANON        TO PRICDA
 14534     END-IF
 14535     IF WS-SAVE-FILETOL > 0
 14536         MOVE WS-SAVE-FILETOI  TO FILETOI
 14537         MOVE WS-SAVE-FILETOL  TO FILETOL
 14538         MOVE AL-UANON         TO FILETOA
 14539     END-IF
 14540     IF WS-SAVE-PDTHRUL > 0
 14541         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14542         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14543         MOVE AL-UANON         TO PDTHRUA
 14544     END-IF
 14545     IF WS-SAVE-PDAMTL > 0
 14546         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14547         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14548         MOVE AL-UANON        TO PDAMTA
 14549     END-IF
 14550     IF WS-SAVE-NODAYSL > 0
 14551         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14552         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 272
* EL131.cbl
 14553         MOVE AL-UANON         TO NODAYSA
 14554     END-IF
 14555     IF WS-SAVE-NOPMTSL > 0
 14556         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14557         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14558         MOVE AL-UANON         TO NOPMTSA
 14559     END-IF
 14560     IF WS-SAVE-FORMTYPL > 0
 14561         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14562         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14563         MOVE AL-UANON          TO FORMTYPA
 14564     END-IF
 14565     IF WS-SAVE-OCCL > 0
 14566         MOVE WS-SAVE-OCCI  TO OCCI
 14567         MOVE WS-SAVE-OCCL  TO OCCL
 14568         MOVE AL-UANON      TO OCCA
 14569     END-IF.
 14570 4200-EXIT.
 14571      EXIT.
 14572
 14573 5000-BUILD-MAP.
 14574     IF PI-RETURN-CD-1 = SPACE
 14575         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14576
 14577     MOVE SPACE                  TO PI-RETURN-CD-1.
 14578
 14579     MOVE LOW-VALUES             TO EL131AI.
 14580
 14581     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14582     MOVE PI-CARRIER             TO CARRIER-CODE.
 14583     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14584     MOVE PI-CERT-NO             TO CERT-NO.
 14585
 14586 5000-READ-CLAIM-MASTER.
 14587
 14588
 14589* EXEC CICS READ
 14590*         SET      (ADDRESS OF CLAIM-MASTER)
 14591*         DATASET  (CLMS-FILE-ID)
 14592*         RIDFLD   (MSTR-KEY)
 14593*    END-EXEC.
 14594*    MOVE '&"S        E          (   #00012355' TO DFHEIV0
 14595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14597     MOVE X'2020233030303132333535' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           CLMS-FILE-ID,
 14600           DFHEIV20,
 14601           DFHEIV99,
 14602           MSTR-KEY,
 14603           DFHEIV99,
 14604           DFHEIV99,
 14605           DFHEIV99
 14606     SET ADDRESS OF CLAIM-MASTER TO
 14607         DFHEIV20
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 273
* EL131.cbl
 14611     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14612
 14613 5000-READ-DIAGNOSIS-TRAILER.
 14614
 14615
 14616* EXEC CICS HANDLE CONDITION
 14617*         NOTFND (5000-TRLR-NOT-FOUND)
 14618*    END-EXEC.
 14619*    MOVE '"$I                   ! B #00012365' TO DFHEIV0
 14620     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14622     MOVE X'4220233030303132333635' TO DFHEIV0(25:11)
 14623     CALL 'kxdfhei1' USING DFHEIV0
 14624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14625
 14626
 14627     MOVE MSTR-KEY               TO TRLR-KEY.
 14628     MOVE NINETY                 TO TRLR-SEQ-NO.
 14629
 14630
 14631* EXEC CICS READ
 14632*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14633*         DATASET  (TRLR-FILE-ID)
 14634*         RIDFLD   (TRLR-KEY)
 14635*    END-EXEC.
 14636*    MOVE '&"S        E          (   #00012372' TO DFHEIV0
 14637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14639     MOVE X'2020233030303132333732' TO DFHEIV0(25:11)
 14640     CALL 'kxdfhei1' USING DFHEIV0,
 14641           TRLR-FILE-ID,
 14642           DFHEIV20,
 14643           DFHEIV99,
 14644           TRLR-KEY,
 14645           DFHEIV99,
 14646           DFHEIV99,
 14647           DFHEIV99
 14648     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14649         DFHEIV20
 14650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14651
 14652
 14653     MOVE AT-INFO-LINE-1         TO DIAGO.
 14654     MOVE AT-ICD-CODE-1          TO ICD1O.
 14655     MOVE AT-ICD-CODE-2          TO ICD2O.
 14656
 14657 5000-READ-CERTIFICATE-MASTER.
 14658
 14659     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14660     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14661     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14662     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14663     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14664     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14665     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14666
 14667
 14668* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 274
* EL131.cbl
 14669*         NOTFND (5000-CERT-NOT-FOUND)
 14670*    END-EXEC.
 14671*    MOVE '"$I                   ! C #00012392' TO DFHEIV0
 14672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14674     MOVE X'4320233030303132333932' TO DFHEIV0(25:11)
 14675     CALL 'kxdfhei1' USING DFHEIV0
 14676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14677
 14678
 14679
 14680* EXEC CICS READ
 14681*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14682*         DATASET  (CERT-FILE-ID)
 14683*         RIDFLD   (CERT-KEY)
 14684*    END-EXEC.
 14685*    MOVE '&"S        E          (   #00012396' TO DFHEIV0
 14686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14688     MOVE X'2020233030303132333936' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0,
 14690           CERT-FILE-ID,
 14691           DFHEIV20,
 14692           DFHEIV99,
 14693           CERT-KEY,
 14694           DFHEIV99,
 14695           DFHEIV99,
 14696           DFHEIV99
 14697     SET ADDRESS OF CERTIFICATE-MASTER TO
 14698         DFHEIV20
 14699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14700
 14701
 14702     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14703     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 14704     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14705
 14706     GO TO 5000-EXIT.
 14707
 14708 5000-TRLR-NOT-FOUND.
 14709     MOVE ER-7687                TO EMI-ERROR.
 14710     MOVE -1                     TO DIAGL.
 14711     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14712     GO TO 5000-EXIT.
 14713
 14714 5000-CERT-NOT-FOUND.
 14715     MOVE ER-0206                TO EMI-ERROR.
 14716     MOVE -1                     TO CERTL.
 14717     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14718
 14719 5000-EXIT.
 14720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 275
* EL131.cbl
 14722 5010-RESET-PI-AREA.
 14723     IF CERTI GREATER THAN LOW-VALUES
 14724         MOVE CERTI              TO PI-CERT-PRIME.
 14725
 14726     IF SUFXI GREATER THAN LOW-VALUES
 14727         MOVE SUFXI              TO PI-CERT-SFX.
 14728
 14729     IF CERTEFFI GREATER THAN LOW-VALUES
 14730         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14731
 14732     IF CERTACTI GREATER THAN LOW-VALUES
 14733         MOVE CERTACTI           TO PI-ACCOUNT.
 14734
 14735     IF CERTSTI GREATER THAN LOW-VALUES
 14736         MOVE CERTSTI            TO PI-STATE.
 14737
 14738     IF CERTCARI GREATER THAN LOW-VALUES
 14739         MOVE CERTCARI           TO PI-CARRIER.
 14740
 14741     IF CERTGRPI GREATER THAN LOW-VALUES
 14742         MOVE CERTGRPI           TO PI-GROUPING.
 14743
 14744 5010-EXIT.
 14745     EXIT.
 14746
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 276
* EL131.cbl
 14748 5020-MOVE-MSTR.
 14749
 14750     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14751     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14752     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14753     MOVE AL-SABON               TO SEQUA.
 14754     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14755     MOVE CL-CLAIM-TYPE          TO TYPEO
 14756                                    pi-claim-type
 14757
 14758     IF CL-TOTAL-PAID-AMT  = +0 AND
 14759        CL-LAST-PMT-AMT    = +0 AND
 14760        CL-NO-OF-PMTS-MADE = +0
 14761          MOVE AL-UANON          TO TYPEA.
 14762
 14763     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14764     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14765     MOVE CL-CERT-PRIME          TO CERTO.
 14766     MOVE CL-CERT-SFX            TO SUFXO.
 14767     MOVE CL-CERT-CARRIER        TO CARRO.
 14768
 14769     IF CL-CLAIM-STATUS = 'C'
 14770         MOVE 'CLOSED'           TO STATUSO
 14771     ELSE
 14772         MOVE 'OPEN  '           TO STATUSO.
 14773
 14774     move cl-accident-claim-sw   to accswo
 14775     if cl-benefit-period not numeric
 14776        move zeros               to cl-benefit-period
 14777     end-if
 14778     move cl-benefit-period      to benpero
 14779     move cl-insured-type        to instypeo
 14780     MOVE CL-PROCESSOR-ID        TO PROCO.
 14781
 14782     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14783     MOVE CL-CCN                 TO CCNOO.
 14784
 14785     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14786     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14787     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14788     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14789
 14790     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14791         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14792         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14793         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14794         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14795     ELSE
 14796         MOVE SPACES             TO BIRTHO.
 14797
 14798     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14799        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14800         NEXT SENTENCE
 14801       ELSE
 14802         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14803
 14804     IF PI-COMPANY-ID = 'DMD'
 14805       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 277
* EL131.cbl
 14806          IF SOCIALO = SPACES OR LOW-VALUES
 14807            MOVE ER-0885         TO EMI-ERROR
 14808            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14809
 14810     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14811*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14812
 14813*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14814*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14815*        MOVE SPACES                 TO DC-OPTION-CODE
 14816*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14817*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14818*    ELSE
 14819*        MOVE SPACES             TO ENDO.
 14820
 14821     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14822        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14823        MOVE SPACES             TO DC-OPTION-CODE
 14824        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14825        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14826        IF PI-USES-PAID-TO
 14827           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14828           MOVE '6'                TO DC-OPTION-CODE
 14829           MOVE +1                 TO DC-ELAPSED-DAYS
 14830           MOVE +0                 TO DC-ELAPSED-MONTHS
 14831           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14832           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14833        ELSE
 14834           NEXT SENTENCE
 14835     ELSE
 14836        MOVE SPACES             TO PDTHRUO.
 14837
 14838     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14839     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14840     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14841     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14842
 14843     IF MODIFY-CAP
 14844        MOVE AL-UNNOF            TO PDAMTA
 14845                                    NODAYSA
 14846                                    NOPMTSA
 14847        MOVE AL-UANOF            TO PDTHRUA.
 14848     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14849     MOVE '2'                    TO CNTL-REC-TYPE
 14850     MOVE +0                     TO CNTL-SEQ-NO
 14851     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14852
 14853
 14854* EXEC CICS READ
 14855*         DATASET  (CNTL-FILE-ID)
 14856*         SET      (ADDRESS OF CONTROL-FILE)
 14857*         RIDFLD   (CNTL-KEY)
 14858*         RESP     (WS-RESPONSE)
 14859*    END-EXEC
 14860*    MOVE '&"S        E          (  N#00012553' TO DFHEIV0
 14861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14863     MOVE X'204E233030303132353533' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 278
* EL131.cbl
 14864     CALL 'kxdfhei1' USING DFHEIV0,
 14865           CNTL-FILE-ID,
 14866           DFHEIV20,
 14867           DFHEIV99,
 14868           CNTL-KEY,
 14869           DFHEIV99,
 14870           DFHEIV99,
 14871           DFHEIV99
 14872     SET ADDRESS OF CONTROL-FILE TO
 14873         DFHEIV20
 14874     MOVE EIBRESP  TO WS-RESPONSE
 14875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14876
 14877     IF WS-RESP-NORMAL
 14878        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14879     end-if
 14880     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14881         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14882         MOVE SPACES             TO DC-OPTION-CODE
 14883         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14884         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14885     ELSE
 14886         MOVE SPACES             TO INCO.
 14887
 14888     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14889        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14890        MOVE AL-UANOF            TO INCA
 14891     end-if
 14892     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14893
 14894     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14895         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14896         MOVE SPACES             TO DC-OPTION-CODE
 14897         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14898         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14899     ELSE
 14900         MOVE SPACES             TO REPO.
 14901
 14902     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14903         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14904         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14905         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14906         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14907     ELSE
 14908         MOVE SPACES             TO ESTO.
 14909
 14910     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14911         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14912         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14913         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14914         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14915     ELSE
 14916         MOVE SPACES             TO MNTDTO.
 14917
 14918
 14919     IF CL-LAST-MAINT-TYPE = SPACE
 14920         MOVE 'SET-UP'           TO MNTTYPEO
 14921     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 279
* EL131.cbl
 14922     IF CL-LAST-MAINT-TYPE = '1'
 14923         MOVE 'PAYMNT'           TO MNTTYPEO
 14924     ELSE
 14925     IF CL-LAST-MAINT-TYPE = '2'
 14926         MOVE 'LETTER'           TO MNTTYPEO
 14927     ELSE
 14928     IF CL-LAST-MAINT-TYPE = '3'
 14929         MOVE 'UPDATE'           TO MNTTYPEO
 14930     ELSE
 14931     IF CL-LAST-MAINT-TYPE = '4'
 14932         MOVE 'RESTOR'           TO MNTTYPEO
 14933     ELSE
 14934     IF CL-LAST-MAINT-TYPE = '5'
 14935         MOVE 'INC DT'           TO MNTTYPEO
 14936     ELSE
 14937     IF CL-LAST-MAINT-TYPE = '6'
 14938         MOVE ' CONV'            TO MNTTYPEO
 14939     ELSE
 14940     IF CL-LAST-MAINT-TYPE = 'C'
 14941         MOVE 'CHGBEN'           TO MNTTYPEO
 14942     ELSE
 14943     IF CL-LAST-MAINT-TYPE = 'E'
 14944         MOVE 'ERRCOR'           TO MNTTYPEO
 14945     ELSE
 14946         MOVE SPACES             TO MNTTYPEO.
 14947
 14948     MOVE CL-BENEFICIARY         TO BENEO.
 14949     MOVE CL-FILE-LOCATION       TO FILETOO.
 14950     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14951        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14952     END-IF
 14953     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14954*    MOVE CL-CRIT-PER-RECURRENT
 14955*                                TO CRITPTO
 14956*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14957*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14958*    END-IF
 14959*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14960     MOVE CL-PRIORITY-CD         TO PRICDO.
 14961     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14962     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14963     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14964     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14965
 14966 5020-EXIT.
 14967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 280
* EL131.cbl
 14969 5030-MOVE-CERT.
 14970
 14971     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14972         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14973         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14974         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14975         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14976       ELSE
 14977         MOVE SPACES             TO CERTEFFO
 14978         MOVE ZERO               TO HOLD-DATE.
 14979
 14980     MOVE CM-ACCOUNT             TO CERTACTO.
 14981     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14982     MOVE CM-GROUPING            TO CERTGRPO.
 14983     MOVE CM-CARRIER             TO CERTCARO.
 14984     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14985     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14986     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14987     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14988     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14989     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14990     MOVE CM-JT-INITIAL          TO JNTINITO.
 14991     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14992
 14993*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14994     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14995     MOVE '3'                    TO CNTL-REC-TYPE.
 14996     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14997     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14998     MOVE ZERO                   TO CNTL-SEQ-NO.
 14999
 15000
 15001* EXEC CICS READ
 15002*         SET        (ADDRESS OF CONTROL-FILE)
 15003*         DATASET    ('ELCNTL')
 15004*         RIDFLD     (CNTL-KEY)
 15005*         RESP       (WS-RESPONSE)
 15006*    END-EXEC.
 15007     MOVE 'ELCNTL' TO DFHEIV1
 15008*    MOVE '&"S        E          (  N#00012683' TO DFHEIV0
 15009     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15011     MOVE X'204E233030303132363833' TO DFHEIV0(25:11)
 15012     CALL 'kxdfhei1' USING DFHEIV0,
 15013           DFHEIV1,
 15014           DFHEIV20,
 15015           DFHEIV99,
 15016           CNTL-KEY,
 15017           DFHEIV99,
 15018           DFHEIV99,
 15019           DFHEIV99
 15020     SET ADDRESS OF CONTROL-FILE TO
 15021         DFHEIV20
 15022     MOVE EIBRESP  TO WS-RESPONSE
 15023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15024
 15025
 15026     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 281
* EL131.cbl
 15027        MOVE ZERO                TO CP-FREE-LOOK
 15028     ELSE
 15029        MOVE CF-ST-FREE-LOOK-PERIOD
 15030                                 TO CP-FREE-LOOK.
 15031
 15032     IF CM-LF-BENEFIT-CD = '00'
 15033        GO TO 5030-MOVE-CERT-AH.
 15034
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 282
* EL131.cbl
 15036     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15037     MOVE '5'                    TO DC-OPTION-CODE
 15038     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15039     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15040     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15041     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15042     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15043     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15044     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15045     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15046     MOVE '4'                    TO CP-REM-TERM-METHOD
 15047     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15048     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15049     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15050
 15051     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15052     IF CM-LF-PREMIUM-RATE NUMERIC
 15053         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15054     ELSE
 15055         MOVE ZEROS              TO LCVRATEO.
 15056
 15057     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15058         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15059
 15060     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15061
 15062     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15063
 15064     IF CM-LF-CURRENT-STATUS = '8'
 15065        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15066            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15067            MOVE ' '             TO DC-OPTION-CODE
 15068            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15069            IF NOT DATE-CONVERSION-ERROR
 15070                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15071
 15072     IF CM-LF-CURRENT-STATUS = '7'
 15073        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15074            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15075            MOVE ' '             TO DC-OPTION-CODE
 15076            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15077            IF NOT DATE-CONVERSION-ERROR
 15078                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15079
 15080     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15081         MOVE ' '                TO DC-OPTION-CODE
 15082         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15083         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15084         IF NOT DATE-CONVERSION-ERROR
 15085             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15086             MOVE HOLD-MONTH     TO WORK-MONTH
 15087             MOVE HOLD-YEAR      TO WORK-YEAR
 15088             MOVE WORK-DATE-MY   TO LCVEXITO.
 15089
 15090     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15091        IF CP-REMAINING-TERM-3 = ZEROS
 15092           MOVE 'EXPIRED'        TO LCVSTATO
 15093        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 283
* EL131.cbl
 15094           MOVE 'ACTIVE'         TO LCVSTATO.
 15095
 15096     IF CM-LF-CURRENT-STATUS = '2'
 15097        MOVE 'PEND   '           TO LCVSTATO.
 15098     IF CM-LF-CURRENT-STATUS = '3'
 15099        MOVE 'RESTORE'           TO LCVSTATO.
 15100     IF CM-LF-CURRENT-STATUS = '5'
 15101        MOVE 'REISSUE'           TO LCVSTATO.
 15102     IF CM-LF-CURRENT-STATUS = '6'
 15103        MOVE 'LMP DIS'           TO LCVSTATO.
 15104     IF CM-LF-CURRENT-STATUS = '7'
 15105        MOVE 'DEATH  '           TO LCVSTATO.
 15106     IF CM-LF-CURRENT-STATUS = '8'
 15107        MOVE 'CANCEL '           TO LCVSTATO.
 15108     IF CM-LF-CURRENT-STATUS = '9'
 15109        MOVE 'RE-ONLY'           TO LCVSTATO.
 15110     IF CM-LF-CURRENT-STATUS = 'V'
 15111        MOVE 'VOID   '           TO LCVSTATO.
 15112     IF CM-LF-CURRENT-STATUS = 'D'
 15113        MOVE 'DECLINE'           TO LCVSTATO.
 15114
 15115     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15116     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15117     MOVE '4'                    TO BEN-REC-TYPE.
 15118     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15119     MOVE ZERO                   TO BEN-SEQ-NO.
 15120
 15121
 15122* EXEC CICS READ GTEQ
 15123*         DATASET  (CNTL-FILE-ID)
 15124*         RIDFLD   (BENEFIT-KEY)
 15125*         SET      (ADDRESS OF CONTROL-FILE)
 15126*    END-EXEC.
 15127*    MOVE '&"S        G          (   #00012785' TO DFHEIV0
 15128     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15130     MOVE X'2020233030303132373835' TO DFHEIV0(25:11)
 15131     CALL 'kxdfhei1' USING DFHEIV0,
 15132           CNTL-FILE-ID,
 15133           DFHEIV20,
 15134           DFHEIV99,
 15135           BENEFIT-KEY,
 15136           DFHEIV99,
 15137           DFHEIV99,
 15138           DFHEIV99
 15139     SET ADDRESS OF CONTROL-FILE TO
 15140         DFHEIV20
 15141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15142
 15143
 15144     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15145        CF-RECORD-TYPE NOT = '4'
 15146         MOVE ER-0240            TO EMI-ERROR
 15147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15148         GO TO 5030-MOVE-CERT-FINISH.
 15149
 15150     MOVE ZERO                   TO COUNT-2.
 15151     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 284
* EL131.cbl
 15152
 15153     IF SCREEN-ERROR
 15154         MOVE ER-0282            TO EMI-ERROR
 15155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15156        ELSE
 15157         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15158
 15159 5030-MOVE-CERT-AH.
 15160
 15161     IF CM-LF-BENEFIT-CD = '00'
 15162         IF CM-AH-BENEFIT-CD = '00'
 15163             GO TO 5030-MOVE-CERT-FINISH.
 15164
 15165     IF CM-AH-BENEFIT-CD = '00'
 15166        MOVE SPACES             TO ACVKINDO
 15167        COMPUTE PI-PAYMENT-AMT =
 15168                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15169        GO TO 5030-MOVE-CERT-FINISH.
 15170
 15171     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15172     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15173     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15174     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15175     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15176     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15177     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15178     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15179
 15180**DMD **********************************************
 15181     IF PI-COMPANY-ID = 'DMD'
 15182         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15183                                   CM-PMT-EXTENSION-DAYS
 15184         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15185                                      CL-NO-OF-DAYS-PAID
 15186         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15187             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15188         MOVE WS-REM-MOS         TO ACVRTRMO
 15189                                    CP-REMAINING-TERM-3
 15190*        MOVE WS-REM-DAYS        TO DAYSPO
 15191         GO TO 5030-SKIP-RTRM.
 15192**DMD **********************************************
 15193
 15194     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15195     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15196     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15197     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15198
 15199 5030-SKIP-RTRM.
 15200     IF CM-AH-PREMIUM-RATE NUMERIC
 15201         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15202     ELSE
 15203         MOVE ZEROS              TO ACVRATEO.
 15204
 15205     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15206     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15207
 15208     IF CM-AH-CURRENT-STATUS = '8'
 15209        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 285
* EL131.cbl
 15210            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15211            MOVE ' '             TO DC-OPTION-CODE
 15212            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15213            IF NOT DATE-CONVERSION-ERROR
 15214                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15215
 15216     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15217        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15218            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15219            MOVE ' '             TO DC-OPTION-CODE
 15220            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15221            IF NOT DATE-CONVERSION-ERROR
 15222                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15223
 15224     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15225        IF CP-REMAINING-TERM-3 = ZEROS
 15226           MOVE 'EXPIRED'        TO ACVSTATO
 15227        ELSE
 15228           MOVE 'ACTIVE'         TO ACVSTATO.
 15229
 15230     IF CM-AH-CURRENT-STATUS = '2'
 15231        MOVE 'PEND   '           TO ACVSTATO.
 15232     IF CM-AH-CURRENT-STATUS = '3'
 15233        MOVE 'RESTORE'           TO ACVSTATO.
 15234     IF CM-AH-CURRENT-STATUS = '5'
 15235        MOVE 'REISSUE'           TO ACVSTATO.
 15236     IF CM-AH-CURRENT-STATUS = '6'
 15237        MOVE 'LMP DIS'           TO ACVSTATO.
 15238     IF CM-AH-CURRENT-STATUS = '7'
 15239        MOVE 'DEATH  '           TO ACVSTATO.
 15240     IF CM-AH-CURRENT-STATUS = '8'
 15241        MOVE 'CANCEL '           TO ACVSTATO.
 15242     IF CM-AH-CURRENT-STATUS = '9'
 15243        MOVE 'RE-ONLY'           TO ACVSTATO.
 15244     IF CM-AH-CURRENT-STATUS = 'V'
 15245        MOVE 'VOID   '           TO ACVSTATO.
 15246     IF CM-AH-CURRENT-STATUS = '9'
 15247        MOVE 'DECLINE'           TO ACVSTATO.
 15248
 15249     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15250         MOVE ' '                TO DC-OPTION-CODE
 15251         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15252         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15253         IF NOT DATE-CONVERSION-ERROR
 15254             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15255             MOVE HOLD-MONTH     TO WORK-MONTH
 15256             MOVE HOLD-YEAR      TO WORK-YEAR
 15257             MOVE WORK-DATE-MY   TO ACVEXITO.
 15258
 15259     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15260
 15261     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15262     MOVE '5'                    TO BEN-REC-TYPE.
 15263     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15264     MOVE ZERO                   TO BEN-SEQ-NO.
 15265
 15266
 15267* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 286
* EL131.cbl
 15268*         DATASET  (CNTL-FILE-ID)
 15269*         RIDFLD   (BENEFIT-KEY)
 15270*         SET      (ADDRESS OF CONTROL-FILE)
 15271*    END-EXEC.
 15272*    MOVE '&"S        G          (   #00012913' TO DFHEIV0
 15273     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15275     MOVE X'2020233030303132393133' TO DFHEIV0(25:11)
 15276     CALL 'kxdfhei1' USING DFHEIV0,
 15277           CNTL-FILE-ID,
 15278           DFHEIV20,
 15279           DFHEIV99,
 15280           BENEFIT-KEY,
 15281           DFHEIV99,
 15282           DFHEIV99,
 15283           DFHEIV99
 15284     SET ADDRESS OF CONTROL-FILE TO
 15285         DFHEIV20
 15286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15287
 15288
 15289     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15290        CF-RECORD-TYPE NOT = '5'
 15291         MOVE ER-0250            TO EMI-ERROR
 15292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15293         GO TO 5030-MOVE-CERT-FINISH.
 15294
 15295     MOVE ZERO                   TO COUNT-2.
 15296     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15297
 15298     IF SCREEN-ERROR
 15299         MOVE ER-0283            TO EMI-ERROR
 15300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15301       ELSE
 15302         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15303
 15304 5030-MOVE-CERT-FINISH.
 15305
 15306     MOVE CM-LOAN-APR            TO APRO.
 15307     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15308     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15309     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15310*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15311     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15312     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15313
 15314     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15315         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15316         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15317         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15318         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15319     ELSE
 15320         MOVE SPACES               TO ADDONDTO.
 15321
 15322     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15323
 15324 5030-EXIT.
 15325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 287
* EL131.cbl
 15327 5040-FIND-BENEFIT.
 15328     ADD 1                       TO COUNT-2.
 15329     IF COUNT-2 GREATER THAN 8
 15330         GO TO 5050-BENEFIT-NOTFND.
 15331
 15332     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15333         GO TO 5060-EXIT.
 15334
 15335     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15336         GO TO 5050-BENEFIT-NOTFND.
 15337
 15338     GO TO 5040-FIND-BENEFIT.
 15339
 15340 5050-BENEFIT-NOTFND.
 15341     MOVE 'X'                    TO ERROR-SWITCH.
 15342
 15343 5060-EXIT.
 15344     EXIT.
 15345 5100-LOAD-CORR-TRLR.
 15346     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15347     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15348     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15349     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15350     MOVE 1000               TO TRLR-SEQ-NO.
 15351
 15352
 15353* EXEC CICS HANDLE CONDITION
 15354*         NOTFND    (1052-DONE)
 15355*         ENDFILE   (1052-DONE)
 15356*    END-EXEC.
 15357*    MOVE '"$I''                  ! D #00012982' TO DFHEIV0
 15358     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15360     MOVE X'4420233030303132393832' TO DFHEIV0(25:11)
 15361     CALL 'kxdfhei1' USING DFHEIV0
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365
 15366* EXEC CICS STARTBR
 15367*        DATASET (TRLR-FILE-ID)
 15368*        RIDFLD  (TRLR-KEY)
 15369*    END-EXEC
 15370     MOVE 0
 15371       TO DFHEIV11
 15372*    MOVE '&,         G          &   #00012987' TO DFHEIV0
 15373     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15375     MOVE X'2020233030303132393837' TO DFHEIV0(25:11)
 15376     CALL 'kxdfhei1' USING DFHEIV0,
 15377           TRLR-FILE-ID,
 15378           TRLR-KEY,
 15379           DFHEIV99,
 15380           DFHEIV11,
 15381           DFHEIV99
 15382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15383
 15384
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 288
* EL131.cbl
 15385     MOVE SPACES TO WS-TRLR-FILE-EOF
 15386                    WS-AUTH-RCVD
 15387     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15388       UNTIL  TRLR-FILE-EOF
 15389         OR WS-AUTH-RCVD > SPACES.
 15390
 15391
 15392* EXEC CICS ENDBR
 15393*        DATASET (TRLR-FILE-ID)
 15394*    END-EXEC.
 15395     MOVE 0
 15396       TO DFHEIV11
 15397*    MOVE '&2                    $   #00012999' TO DFHEIV0
 15398     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15399     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15400     MOVE X'2020233030303132393939' TO DFHEIV0(25:11)
 15401     CALL 'kxdfhei1' USING DFHEIV0,
 15402           TRLR-FILE-ID,
 15403           DFHEIV11,
 15404           DFHEIV99
 15405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15406
 15407
 15408     IF AUTH-RCVD
 15409        MOVE 'Y' TO AUTHRCVO
 15410     ELSE
 15411        MOVE 'N' TO AUTHRCVO
 15412     END-IF.
 15413
 15414
 15415 5100-EXIT.
 15416     EXIT.
 15417
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 289
* EL131.cbl
 15419 6000-CALCULATE-CERT-TERM.
 15420
 15421     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15422         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15423     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15424         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15425     IF CM-LOAN-APR NOT NUMERIC
 15426         MOVE ZEROS              TO CM-LOAN-APR.
 15427
 15428*    IF WS-CALC-METHOD  = 'G'
 15429         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15430*     ELSE
 15431*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15432
 15433     IF N GREATER 120
 15434         MOVE 120                TO N.
 15435
 15436     MOVE '6'                    TO DC-OPTION-CODE.
 15437     MOVE N                      TO DC-ELAPSED-MONTHS.
 15438     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15439     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15440
 15441     IF CM-LF-BENEFIT-CD NOT = ZERO
 15442         MOVE N                  TO CM-LF-ORIG-TERM
 15443         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15444         IF NO-CONVERSION-ERROR
 15445             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15446
 15447     IF CM-AH-BENEFIT-CD NOT = ZERO
 15448         MOVE N                  TO CM-AH-ORIG-TERM
 15449         IF NO-CONVERSION-ERROR
 15450             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15451
 15452 6000-EXIT.
 15453      EXIT.
 15454
 15455 6100-CALC-GROSS-TERM.
 15456     MOVE CM-LOAN-BALANCE         TO L.
 15457     MOVE PI-PAYMENT-AMT          TO M.
 15458
 15459     COMPUTE N = L / M.
 15460     IF N LESS 1
 15461         MOVE 1  TO N.
 15462
 15463     IF CM-LF-BENEFIT-CD NOT = ZERO
 15464         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15465     ELSE
 15466         MOVE ZEROS               TO WS-LF-RATE.
 15467
 15468     IF CM-AH-BENEFIT-CD NOT = ZERO
 15469         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15470     ELSE
 15471         MOVE ZEROS               TO WS-AH-RATE.
 15472
 15473     COMPUTE I = CM-LOAN-APR / +1200.
 15474
 15475 6105-LOOP.
 15476     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 290
* EL131.cbl
 15477         GO TO 6200-EXIT.
 15478     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15479     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15480         ADD 1 TO N
 15481         GO TO 6105-LOOP.
 15482
 15483 6200-EXIT.
 15484      EXIT.
 15485
 15486 6210-CALC-LEFT-RIGHTONE.
 15487      MOVE L         TO LEFT-TOT-1.
 15488      SUBTRACT 1 FROM N.
 15489      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15490      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15491      ADD 1 TO N.
 15492 6211-CALC-TERM1.
 15493      MOVE N         TO TERM1.
 15494      MULTIPLY M BY TERM1.
 15495 6212-LOOP.
 15496      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15497      ADD 1 TO A-N.
 15498      MULTIPLY A-N BY TERM1.
 15499      SUBTRACT 1 FROM A-N.
 15500      ADD TERM1 TO LEFT-TOT-1.
 15501 6213-CALC-TERM2.
 15502      MOVE M         TO TERM2.
 15503      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15504      MULTIPLY IA-N BY TERM2.
 15505      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15506 6215-CALC-RIGHTONE.
 15507      MOVE M         TO RIGHT-TOT-1.
 15508      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15509      MULTIPLY A-N BY RIGHT-TOT-1.
 15510 6220-EXIT.
 15511      EXIT.
 15512
 15513 6300-CALC-A-N.
 15514     IF N LESS 1
 15515         MOVE 0     TO A-N
 15516         GO TO 6300-EXIT.
 15517     IF I = 0
 15518         MOVE .00001 TO I.
 15519     ADD 1 TO I.
 15520     DIVIDE I INTO 1 GIVING V.
 15521     SUBTRACT 1 FROM I.
 15522     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15523     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15524     DIVIDE I INTO TERM3 GIVING A-N.
 15525 6300-EXIT.
 15526      EXIT.
 15527
 15528 6350-CALC-IA-N.
 15529     IF N LESS 1
 15530         MOVE 0      TO IA-N
 15531         GO TO 6400-EXIT.
 15532     ADD 1 TO N.
 15533     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15534     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 291
* EL131.cbl
 15535     MULTIPLY N BY V-EX-N GIVING TERM3.
 15536     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15537     SUBTRACT V FROM 1 GIVING TERM4.
 15538     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15539 6400-EXIT.
 15540      EXIT.
 15541
 15542 6450-CALC-V-EX-N.
 15543     IF N LESS 1
 15544         MOVE 1    TO V-EX-N
 15545         GO TO 6490-EXIT.
 15546     MOVE N        TO NV-STORE.
 15547     IF V-EX-ONETIME = 1  OR
 15548        V NOT = V-EXPONENT (1)
 15549          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15550 6460-LOOP.
 15551     IF N GREATER 248
 15552         MOVE 248 TO N.
 15553     IF N = 1
 15554         MOVE V               TO V-EX-N
 15555      ELSE
 15556         MOVE V-EXPONENT (N)  TO V-EX-N.
 15557     GO TO 6490-EXIT.
 15558
 15559 6470-BUILD-V-EX-TABLE.
 15560     MOVE 2      TO N.
 15561     MOVE V      TO V-EXPONENT (1)
 15562                    V-EX-N.
 15563 6471-LOOP.
 15564     MULTIPLY V BY V-EX-N.
 15565     MOVE V-EX-N   TO V-EXPONENT (N).
 15566     ADD 1 TO N.
 15567     IF N LESS 248
 15568         GO TO 6471-LOOP.
 15569     MOVE NV-STORE     TO N.
 15570     MOVE 0            TO V-EX-ONETIME.
 15571 6480-EXIT.
 15572      EXIT.
 15573
 15574 6490-EXIT.
 15575      EXIT.
 15576
 15577 6500-CALC-NET-TERM.
 15578     MOVE CM-LOAN-BALANCE         TO L.
 15579     MOVE PI-PAYMENT-AMT          TO M.
 15580
 15581     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15582     IF WS-REMAIN GREATER ZERO
 15583         ADD 1 TO N.
 15584     IF N = 0
 15585         MOVE 1 TO N.
 15586
 15587 6700-EXIT.
 15588      EXIT.
 15589
 15590 6999-CALC-TERM-EXIT.
 15591     EXIT.
 15592
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 292
* EL131.cbl
 15594 7000-RESET-ATTRIBUTE.
 15595
 15596     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15597                                    CERTSTA   CERTCARA
 15598                                    CERTGRPA.
 15599     MOVE -1                     TO CERTCARL.
 15600
 15601 7000-EXIT.
 15602     EXIT.
 15603
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 293
* EL131.cbl
 15605 7600-BROWSE-CLAIM.
 15606
 15607
 15608* EXEC CICS READ
 15609*        DATASET(CLMS-FILE-ID)
 15610*        SET    (ADDRESS OF CLAIM-MASTER)
 15611*        RIDFLD (MSTR-KEY)
 15612*        GENERIC
 15613*        EQUAL
 15614*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15615*    END-EXEC.
 15616*    MOVE '&"S  KG    E          (   #00013202' TO DFHEIV0
 15617     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15619     MOVE X'2020233030303133323032' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0,
 15621           CLMS-FILE-ID,
 15622           DFHEIV20,
 15623           DFHEIV99,
 15624           MSTR-KEY,
 15625           ELMSTR-GENERIC-LENGTH,
 15626           DFHEIV99,
 15627           DFHEIV99
 15628     SET ADDRESS OF CLAIM-MASTER TO
 15629         DFHEIV20
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15631
 15632
 15633     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15634
 15635     if cl-assoc-cert-total = 0
 15636        move 1 to cl-assoc-cert-total
 15637     end-if
 15638     IF CL-ASSOC-CERT-SEQU = 0
 15639        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15640     END-IF
 15641
 15642     IF CL-ASSOC-CERT-TOTAL = 1
 15643         MOVE AL-SADOF           TO BCERT1A
 15644                                    BSUFX1A
 15645                                    BCERT2A
 15646                                    BSUFX2A
 15647                                    BCERT3A
 15648                                    BSUFX3A
 15649                                    BCERT4A
 15650                                    BSUFX4A
 15651                                    BCERT5A
 15652                                    BSUFX5A
 15653                                    PCERTNOA
 15654                                    PSUFXA
 15655                                    LABEL1A
 15656                                    LABEL2A
 15657         GO TO 7699-EXIT.
 15658
 15659 7610-BROWSE-CLAIM-LOOP.
 15660
 15661     MOVE LOW-VALUES             TO BCERT1O
 15662                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 294
* EL131.cbl
 15663                                    BCERT2O
 15664                                    BSUFX2O
 15665                                    BCERT3O
 15666                                    BSUFX3O
 15667                                    BCERT4O
 15668                                    BSUFX4O
 15669                                    BCERT5O
 15670                                    BSUFX5O.
 15671
 15672
 15673* EXEC CICS HANDLE CONDITION
 15674*        ENDFILE  (7630-END-BROWSE)
 15675*    END-EXEC.
 15676*    MOVE '"$''                   ! E #00013250' TO DFHEIV0
 15677     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15679     MOVE X'4520233030303133323530' TO DFHEIV0(25:11)
 15680     CALL 'kxdfhei1' USING DFHEIV0
 15681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15682
 15683
 15684
 15685* EXEC CICS STARTBR
 15686*        DATASET    (CLMS-FILE-ID)
 15687*        RIDFLD     (MSTR-KEY)
 15688*    END-EXEC.
 15689     MOVE 0
 15690       TO DFHEIV11
 15691*    MOVE '&,         G          &   #00013254' TO DFHEIV0
 15692     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15694     MOVE X'2020233030303133323534' TO DFHEIV0(25:11)
 15695     CALL 'kxdfhei1' USING DFHEIV0,
 15696           CLMS-FILE-ID,
 15697           MSTR-KEY,
 15698           DFHEIV99,
 15699           DFHEIV11,
 15700           DFHEIV99
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15702
 15703
 15704     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15705
 15706 7620-READ-CLAIM-LOOP.
 15707
 15708
 15709* EXEC CICS READNEXT
 15710*        DATASET   (CLMS-FILE-ID)
 15711*        SET       (ADDRESS OF CLAIM-MASTER)
 15712*        RIDFLD    (MSTR-KEY)
 15713*    END-EXEC.
 15714     MOVE 0
 15715       TO DFHEIV11
 15716*    MOVE '&.S                   )   #00013263' TO DFHEIV0
 15717     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15718     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15719     MOVE X'2020233030303133323633' TO DFHEIV0(25:11)
 15720     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 295
* EL131.cbl
 15721           CLMS-FILE-ID,
 15722           DFHEIV20,
 15723           DFHEIV99,
 15724           MSTR-KEY,
 15725           DFHEIV99,
 15726           DFHEIV11,
 15727           DFHEIV99,
 15728           DFHEIV99
 15729     SET ADDRESS OF CLAIM-MASTER TO
 15730         DFHEIV20
 15731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15732
 15733
 15734     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15735        CL-CARRIER     NOT = CARRI           OR
 15736        CL-CLAIM-NO    NOT = CLAIMI
 15737        GO TO 7630-END-BROWSE.
 15738
 15739     IF WS-ASSOCIATED-CERTS = 1
 15740         MOVE CL-CERT-PRIME      TO BCERT1O
 15741         MOVE CL-CERT-SFX        TO BSUFX1O.
 15742
 15743     IF WS-ASSOCIATED-CERTS = 2
 15744         MOVE CL-CERT-PRIME      TO BCERT2O
 15745         MOVE CL-CERT-SFX        TO BSUFX2O.
 15746
 15747     IF WS-ASSOCIATED-CERTS = 3
 15748         MOVE CL-CERT-PRIME      TO BCERT3O
 15749         MOVE CL-CERT-SFX        TO BSUFX3O.
 15750
 15751     IF WS-ASSOCIATED-CERTS = 4
 15752         MOVE CL-CERT-PRIME      TO BCERT4O
 15753         MOVE CL-CERT-SFX        TO BSUFX4O.
 15754
 15755     IF WS-ASSOCIATED-CERTS = 5
 15756         MOVE CL-CERT-PRIME      TO BCERT5O
 15757         MOVE CL-CERT-SFX        TO BSUFX5O
 15758     ELSE
 15759         ADD +1                  TO WS-ASSOCIATED-CERTS
 15760         GO TO 7620-READ-CLAIM-LOOP.
 15761
 15762 7630-END-BROWSE.
 15763
 15764
 15765* EXEC CICS ENDBR
 15766*        DATASET   (CLMS-FILE-ID)
 15767*    END-EXEC.
 15768     MOVE 0
 15769       TO DFHEIV11
 15770*    MOVE '&2                    $   #00013299' TO DFHEIV0
 15771     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15772     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15773     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 15774     CALL 'kxdfhei1' USING DFHEIV0,
 15775           CLMS-FILE-ID,
 15776           DFHEIV11,
 15777           DFHEIV99
 15778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 296
* EL131.cbl
 15779
 15780
 15781 7640-HIGHLIGHT-CERT-DISPLAYED.
 15782
 15783     MOVE AL-SANON               TO BCERT1A
 15784                                    BSUFX1A
 15785                                    BCERT2A
 15786                                    BSUFX2A
 15787                                    BCERT3A
 15788                                    BSUFX3A
 15789                                    BCERT4A
 15790                                    BSUFX4A
 15791                                    BCERT5A
 15792                                    BSUFX5A.
 15793
 15794     IF BCERT1O = CERTI AND
 15795        BSUFX1O = SUFXI
 15796            MOVE AL-SABON        TO BCERT1A
 15797                                    BSUFX1A.
 15798
 15799     IF BCERT2O = CERTI AND
 15800        BSUFX2O = SUFXI
 15801            MOVE AL-SABON        TO BCERT2A
 15802                                    BSUFX2A.
 15803
 15804     IF BCERT3O = CERTI AND
 15805        BSUFX3O = SUFXI
 15806            MOVE AL-SABON        TO BCERT3A
 15807                                    BSUFX3A.
 15808
 15809     IF BCERT4O = CERTI AND
 15810        BSUFX4O = SUFXI
 15811            MOVE AL-SABON        TO BCERT4A
 15812                                    BSUFX4A.
 15813
 15814     IF BCERT5O = CERTI AND
 15815        BSUFX5O = SUFXI
 15816            MOVE AL-SABON        TO BCERT5A
 15817                                    BSUFX5A.
 15818
 15819 7699-EXIT.
 15820     EXIT.
 15821
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 297
* EL131.cbl
 15823 7700-CHECK-SEQUENCE.
 15824
 15825
 15826* EXEC CICS HANDLE CONDITION
 15827*        ENDFILE  (7799-EXIT)
 15828*        NOTFND   (7799-EXIT)
 15829*    END-EXEC.
 15830*    MOVE '"$''I                  ! F #00013347' TO DFHEIV0
 15831     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15833     MOVE X'4620233030303133333437' TO DFHEIV0(25:11)
 15834     CALL 'kxdfhei1' USING DFHEIV0
 15835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15836
 15837
 15838
 15839* EXEC CICS READ
 15840*        DATASET(CLMS-FILE-ID)
 15841*        SET    (ADDRESS OF CLAIM-MASTER)
 15842*        RIDFLD (MSTR-KEY)
 15843*        GENERIC
 15844*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15845*    END-EXEC.
 15846*    MOVE '&"S  KG    E          (   #00013352' TO DFHEIV0
 15847     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15849     MOVE X'2020233030303133333532' TO DFHEIV0(25:11)
 15850     CALL 'kxdfhei1' USING DFHEIV0,
 15851           CLMS-FILE-ID,
 15852           DFHEIV20,
 15853           DFHEIV99,
 15854           MSTR-KEY,
 15855           ELMSTR-GENERIC-LENGTH,
 15856           DFHEIV99,
 15857           DFHEIV99
 15858     SET ADDRESS OF CLAIM-MASTER TO
 15859         DFHEIV20
 15860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15861
 15862
 15863     COMPUTE WS-ASSOC-CERT-TOTAL =
 15864             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15865
 15866     GO TO 7799-EXIT.
 15867
 15868 7710-RESEQUENCE-CLAIMS.
 15869
 15870
 15871* EXEC CICS HANDLE CONDITION
 15872*        ENDFILE  (7799-EXIT)
 15873*    END-EXEC.
 15874*    MOVE '"$''                   ! G #00013367' TO DFHEIV0
 15875     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15877     MOVE X'4720233030303133333637' TO DFHEIV0(25:11)
 15878     CALL 'kxdfhei1' USING DFHEIV0
 15879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15880
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 298
* EL131.cbl
 15881
 15882
 15883* EXEC CICS STARTBR
 15884*        DATASET(CLMS-FILE-ID)
 15885*        RIDFLD (MSTR-KEY)
 15886*    END-EXEC.
 15887     MOVE 0
 15888       TO DFHEIV11
 15889*    MOVE '&,         G          &   #00013371' TO DFHEIV0
 15890     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15891     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15892     MOVE X'2020233030303133333731' TO DFHEIV0(25:11)
 15893     CALL 'kxdfhei1' USING DFHEIV0,
 15894           CLMS-FILE-ID,
 15895           MSTR-KEY,
 15896           DFHEIV99,
 15897           DFHEIV11,
 15898           DFHEIV99
 15899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15900
 15901
 15902     COMPUTE WS-ASSOC-CERT-SEQU =
 15903             WS-ASSOC-CERT-SEQU + 1.
 15904
 15905     COMPUTE WS-READNEXT-SWITCH =
 15906             WS-READNEXT-SWITCH + 1.
 15907
 15908 7720-READ-CLAIM-LOOP.
 15909
 15910
 15911* EXEC CICS READNEXT
 15912*        DATASET(CLMS-FILE-ID)
 15913*        SET    (ADDRESS OF CLAIM-MASTER)
 15914*        RIDFLD (MSTR-KEY)
 15915*    END-EXEC.
 15916     MOVE 0
 15917       TO DFHEIV11
 15918*    MOVE '&.S                   )   #00013384' TO DFHEIV0
 15919     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15920     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15921     MOVE X'2020233030303133333834' TO DFHEIV0(25:11)
 15922     CALL 'kxdfhei1' USING DFHEIV0,
 15923           CLMS-FILE-ID,
 15924           DFHEIV20,
 15925           DFHEIV99,
 15926           MSTR-KEY,
 15927           DFHEIV99,
 15928           DFHEIV11,
 15929           DFHEIV99,
 15930           DFHEIV99
 15931     SET ADDRESS OF CLAIM-MASTER TO
 15932         DFHEIV20
 15933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15934
 15935
 15936     IF WS-READNEXT-SWITCH = 1
 15937         ADD 1                   TO WS-READNEXT-SWITCH
 15938         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 299
* EL131.cbl
 15939
 15940 7730-END-BROWSE.
 15941
 15942
 15943* EXEC CICS ENDBR
 15944*        DATASET(CLMS-FILE-ID)
 15945*    END-EXEC.
 15946     MOVE 0
 15947       TO DFHEIV11
 15948*    MOVE '&2                    $   #00013396' TO DFHEIV0
 15949     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15950     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15951     MOVE X'2020233030303133333936' TO DFHEIV0(25:11)
 15952     CALL 'kxdfhei1' USING DFHEIV0,
 15953           CLMS-FILE-ID,
 15954           DFHEIV11,
 15955           DFHEIV99
 15956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15957
 15958
 15959 7740-READ-CLAIM-UPDATE.
 15960
 15961     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15962        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15963        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15964        GO TO 7799-EXIT
 15965     ELSE
 15966        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15967
 15968
 15969* EXEC CICS READ
 15970*        DATASET(CLMS-FILE-ID)
 15971*        SET    (ADDRESS OF CLAIM-MASTER)
 15972*        RIDFLD (MSTR-KEY)
 15973*        UPDATE
 15974*    END-EXEC.
 15975*    MOVE '&"S        EU         (   #00013409' TO DFHEIV0
 15976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15978     MOVE X'2020233030303133343039' TO DFHEIV0(25:11)
 15979     CALL 'kxdfhei1' USING DFHEIV0,
 15980           CLMS-FILE-ID,
 15981           DFHEIV20,
 15982           DFHEIV99,
 15983           MSTR-KEY,
 15984           DFHEIV99,
 15985           DFHEIV99,
 15986           DFHEIV99
 15987     SET ADDRESS OF CLAIM-MASTER TO
 15988         DFHEIV20
 15989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15990
 15991
 15992     if (cl-priority-cd = '8')
 15993        and (pi-processor-id not = 'PEMA' and 'JMS '
 15994             AND 'AMWA')
 15995        MOVE ER-8003             TO EMI-ERROR
 15996        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 300
* EL131.cbl
 15997                                 THRU 9900-EXIT
 15998        MOVE -1                  TO MAINTL
 15999        GO TO 8110-SEND-DATA
 16000     end-if
 16001
 16002     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16003         MOVE 'Y'                TO CL-YESNOSW
 16004     END-IF.
 16005
 16006     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16007     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16008
 16009
 16010* EXEC CICS REWRITE
 16011*         DATASET(CLMS-FILE-ID)
 16012*         FROM   (CLAIM-MASTER)
 16013*    END-EXEC.
 16014     MOVE LENGTH OF
 16015      CLAIM-MASTER
 16016       TO DFHEIV11
 16017*    MOVE '&& L                  %   #00013433' TO DFHEIV0
 16018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16020     MOVE X'2020233030303133343333' TO DFHEIV0(25:11)
 16021     CALL 'kxdfhei1' USING DFHEIV0,
 16022           CLMS-FILE-ID,
 16023           CLAIM-MASTER,
 16024           DFHEIV11,
 16025           DFHEIV99
 16026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16027
 16028
 16029     GO TO 7710-RESEQUENCE-CLAIMS.
 16030
 16031 7799-EXIT.
 16032     EXIT.
 16033
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 301
* EL131.cbl
 16035 7800-CHECK-AUTO-ACTIVITY.
 16036
 16037
 16038* EXEC CICS HANDLE CONDITION
 16039*        NOTFND   (7800-NOT-FOUND)
 16040*    END-EXEC.
 16041*    MOVE '"$I                   ! H #00013446' TO DFHEIV0
 16042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16044     MOVE X'4820233030303133343436' TO DFHEIV0(25:11)
 16045     CALL 'kxdfhei1' USING DFHEIV0
 16046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16047
 16048
 16049     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16050     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16051     MOVE SPACES                     TO  CNTL-PROC-ID.
 16052     MOVE +0                         TO  CNTL-SEQ-NO.
 16053
 16054
 16055* EXEC CICS READ
 16056*        DATASET   (CNTL-FILE-ID)
 16057*        RIDFLD    (CNTL-KEY)
 16058*        SET       (ADDRESS OF CONTROL-FILE)
 16059*    END-EXEC.
 16060*    MOVE '&"S        E          (   #00013455' TO DFHEIV0
 16061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16063     MOVE X'2020233030303133343535' TO DFHEIV0(25:11)
 16064     CALL 'kxdfhei1' USING DFHEIV0,
 16065           CNTL-FILE-ID,
 16066           DFHEIV20,
 16067           DFHEIV99,
 16068           CNTL-KEY,
 16069           DFHEIV99,
 16070           DFHEIV99,
 16071           DFHEIV99
 16072     SET ADDRESS OF CONTROL-FILE TO
 16073         DFHEIV20
 16074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16075
 16076
 16077     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16078         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16079
 16080     IF CL-ACTIVITY-CODE NOT = ZEROS
 16081         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16082         IF MISC-SUB IS GREATER THAN +9
 16083             SUBTRACT +9 FROM MISC-SUB
 16084             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16085         ELSE
 16086             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16087     ELSE
 16088         MOVE 'Y'                              TO  WS-RESET-SW.
 16089
 16090     IF STATUSI = 'C' OR 'CLOSED'
 16091         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16092             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 302
* EL131.cbl
 16093                                         PI-LETTER-SW
 16094             GO TO 7800-EXIT.
 16095
 16096     IF STATUSI = 'C' OR 'CLOSED'
 16097         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16098             MOVE 'N'                TO  PI-LETTER-SW
 16099         ELSE
 16100             MOVE 'Y'                TO  PI-LETTER-SW.
 16101
 16102     IF STATUSI = 'O' OR 'OPEN'
 16103         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16104             MOVE 'N'                TO  PI-REC-FOUND-SW
 16105                                         PI-LETTER-SW
 16106             GO TO 7800-EXIT.
 16107
 16108     IF STATUSI = 'O' OR 'OPEN'
 16109         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16110             MOVE 'N'                TO  PI-LETTER-SW
 16111         ELSE
 16112             MOVE 'Y'                TO  PI-LETTER-SW.
 16113
 16114     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16115     GO TO 7800-EXIT.
 16116
 16117 7800-NOT-FOUND.
 16118
 16119     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16120                                         PI-LETTER-SW.
 16121
 16122 7800-EXIT.
 16123     EXIT.
 16124
 16125 7850-AUTO-LETTER-WRITER.
 16126
 16127     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16128     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16129
 16130     IF STATUSI = 'C' OR 'CLOSED'
 16131         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16132     ELSE
 16133         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16134
 16135     IF STATUSI = 'C' OR 'CLOSED'
 16136         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16137             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16138             MOVE '6'                TO  DC-OPTION-CODE
 16139             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16140             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16141             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16142             IF NO-CONVERSION-ERROR
 16143                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16144             ELSE
 16145                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16146
 16147     IF STATUSI = 'C' OR 'CLOSED'
 16148         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16149             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16150             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 303
* EL131.cbl
 16151             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16152             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16153             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16154             IF NO-CONVERSION-ERROR
 16155                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16156             ELSE
 16157                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16158
 16159     IF STATUSI = 'O' OR 'OPEN'
 16160         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16161             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16162             MOVE '6'                TO  DC-OPTION-CODE
 16163             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16164             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16165             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16166             IF NO-CONVERSION-ERROR
 16167                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16168             ELSE
 16169                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16170
 16171     IF STATUSI = 'O' OR 'OPEN'
 16172         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16173             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16174             MOVE '6'                TO  DC-OPTION-CODE
 16175             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16176             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16177             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16178             IF NO-CONVERSION-ERROR
 16179                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16180             ELSE
 16181                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16182
 16183
 16184* EXEC CICS LINK
 16185*        PROGRAM    (LINK-1523)
 16186*        COMMAREA   (W-1523-LINKDATA)
 16187*        LENGTH     (W-1523-COMM-LENGTH)
 16188*    END-EXEC.
 16189*    MOVE '."C                   (   #00013567' TO DFHEIV0
 16190     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16192     MOVE X'2020233030303133353637' TO DFHEIV0(25:11)
 16193     CALL 'kxdfhei1' USING DFHEIV0,
 16194           LINK-1523,
 16195           W-1523-LINKDATA,
 16196           W-1523-COMM-LENGTH,
 16197           DFHEIV99,
 16198           DFHEIV99,
 16199           DFHEIV99,
 16200           DFHEIV99
 16201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16202
 16203
 16204     IF W-1523-ERROR-CODE = ZEROS
 16205         GO TO 7850-EXIT.
 16206
 16207     IF W-1523-FATAL-ERROR
 16208         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 304
* EL131.cbl
 16209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16210
 16211     IF W-1523-ERROR-CODE = 0191
 16212         MOVE ER-0803                TO  EMI-ERROR
 16213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16214
 16215 7850-EXIT.
 16216     EXIT.
 16217
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 305
* EL131.cbl
 16219 8000-CREATE-DMO-REC.
 16220     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16221     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16222     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16223
 16224
 16225* EXEC CICS HANDLE CONDITION
 16226*         NOTFND   (8000-NOTE-NOT-FOUND)
 16227*    END-EXEC.
 16228*    MOVE '"$I                   ! I #00013593' TO DFHEIV0
 16229     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16231     MOVE X'4920233030303133353933' TO DFHEIV0(25:11)
 16232     CALL 'kxdfhei1' USING DFHEIV0
 16233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16234
 16235
 16236
 16237* EXEC CICS READ
 16238*         DATASET(NOTE-FILE-ID)
 16239*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16240*         RIDFLD (NOTE-KEY)
 16241*    END-EXEC.
 16242*    MOVE '&"S        E          (   #00013597' TO DFHEIV0
 16243     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16244     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16245     MOVE X'2020233030303133353937' TO DFHEIV0(25:11)
 16246     CALL 'kxdfhei1' USING DFHEIV0,
 16247           NOTE-FILE-ID,
 16248           DFHEIV20,
 16249           DFHEIV99,
 16250           NOTE-KEY,
 16251           DFHEIV99,
 16252           DFHEIV99,
 16253           DFHEIV99
 16254     SET ADDRESS OF CERTIFICATE-NOTE TO
 16255         DFHEIV20
 16256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16257
 16258
 16259     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16260     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16261     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16262
 16263     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16264         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16265     ELSE
 16266         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16267
 16268     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16269     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16270
 16271
 16272* EXEC CICS LINK
 16273*        PROGRAM    ('DLO006')
 16274*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16275*        LENGTH     (WS-DCT-LENGTH)
 16276*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 306
* EL131.cbl
 16277     MOVE 'DLO006' TO DFHEIV1
 16278*    MOVE '."C                   (   #00013615' TO DFHEIV0
 16279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16281     MOVE X'2020233030303133363135' TO DFHEIV0(25:11)
 16282     CALL 'kxdfhei1' USING DFHEIV0,
 16283           DFHEIV1,
 16284           DCT-COMMUNICATION-AREA,
 16285           WS-DCT-LENGTH,
 16286           DFHEIV99,
 16287           DFHEIV99,
 16288           DFHEIV99,
 16289           DFHEIV99
 16290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16291
 16292
 16293     IF  DCT-RETURN-CODE = 'OK'
 16294         GO TO 8000-CONT.
 16295
 16296     IF DCT-RETURN-CODE = '01' OR '02'
 16297         GO TO 8000-EXIT.
 16298
 16299     IF DCT-RETURN-CODE = '03'
 16300         MOVE ER-0951            TO EMI-ERROR
 16301         MOVE -1                 TO MAINTL
 16302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16303         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16304         GO TO 8110-SEND-DATA.
 16305
 16306     IF DCT-RETURN-CODE = '04'
 16307         MOVE ER-0946            TO EMI-ERROR
 16308         MOVE -1                 TO MAINTL
 16309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16310         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16311         GO TO 8110-SEND-DATA.
 16312
 16313     IF DCT-RETURN-CODE = '05'
 16314         MOVE ER-0947            TO EMI-ERROR
 16315         MOVE -1                 TO MAINTL
 16316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16317         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16318         GO TO 8110-SEND-DATA.
 16319
 16320     IF DCT-RETURN-CODE = '06'
 16321         MOVE ER-0921            TO EMI-ERROR
 16322         MOVE -1                 TO MAINTL
 16323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16324         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16325         GO TO 8110-SEND-DATA.
 16326
 16327     IF DCT-RETURN-CODE = '07'
 16328         MOVE ER-0919            TO EMI-ERROR
 16329         MOVE -1                 TO MAINTL
 16330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16331         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16332         GO TO 8110-SEND-DATA.
 16333
 16334     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 307
* EL131.cbl
 16335         MOVE ER-0948            TO EMI-ERROR
 16336         MOVE -1                 TO MAINTL
 16337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16338         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16339         GO TO 8110-SEND-DATA.
 16340
 16341     IF DCT-RETURN-CODE = 'N1'
 16342         MOVE ER-0950            TO EMI-ERROR
 16343         MOVE -1                 TO MAINTL
 16344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16345         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16346         GO TO 8110-SEND-DATA.
 16347
 16348     IF DCT-RETURN-CODE = 'E1'
 16349         MOVE ER-0974            TO EMI-ERROR
 16350         MOVE -1                 TO MAINTL
 16351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16352         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16353         GO TO 8110-SEND-DATA.
 16354
 16355     IF DCT-RETURN-CODE = 'E2'
 16356         MOVE ER-0975            TO EMI-ERROR
 16357         MOVE -1                 TO MAINTL
 16358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16359         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16360         GO TO 8110-SEND-DATA.
 16361
 16362     IF DCT-RETURN-CODE NOT = 'OK'
 16363         MOVE ER-0949            TO EMI-ERROR
 16364         MOVE -1                 TO MAINTL
 16365         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16366         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16367         GO TO 8110-SEND-DATA.
 16368
 16369 8000-CONT.
 16370
 16371     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16372     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16373     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16374     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16375     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16376     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16377     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16378     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16379
 16380     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16381     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16382     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16383     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16384     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16385
 16386     IF STATUSI = 'OPEN' OR 'O'
 16387         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16388      ELSE
 16389         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16390
 16391     IF STATUSI = 'OPEN' OR 'O'
 16392        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 308
* EL131.cbl
 16393         MOVE '1'                TO DM-CLAIM-STATUS
 16394      ELSE
 16395         MOVE '2'                TO DM-CLAIM-STATUS.
 16396
 16397     IF STATUSI = 'CLOSED' OR 'C'
 16398        IF NOT FINAL-PAID
 16399         MOVE '3'                TO DM-CLAIM-STATUS
 16400      ELSE
 16401         MOVE '4'                TO DM-CLAIM-STATUS.
 16402
 16403     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16404
 16405
 16406* EXEC CICS LINK
 16407*        PROGRAM    ('DLO025')
 16408*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16409*        LENGTH     (WS-DMO-LENGTH)
 16410*    END-EXEC.
 16411     MOVE 'DLO025' TO DFHEIV1
 16412*    MOVE '."C                   (   #00013733' TO DFHEIV0
 16413     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16415     MOVE X'2020233030303133373333' TO DFHEIV0(25:11)
 16416     CALL 'kxdfhei1' USING DFHEIV0,
 16417           DFHEIV1,
 16418           DMO-COMMUNICATION-AREA,
 16419           WS-DMO-LENGTH,
 16420           DFHEIV99,
 16421           DFHEIV99,
 16422           DFHEIV99,
 16423           DFHEIV99
 16424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16425
 16426
 16427     IF  DM-RETURN-CODE = 'OK'
 16428         GO TO 8000-EXIT.
 16429
 16430     IF DM-RETURN-CODE = '01'
 16431         MOVE ER-8051            TO EMI-ERROR
 16432         MOVE -1                 TO MAINTL
 16433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16434         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16435         GO TO 8110-SEND-DATA.
 16436
 16437     IF DM-RETURN-CODE = '02'
 16438         MOVE ER-8052            TO EMI-ERROR
 16439         MOVE -1                 TO MAINTL
 16440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16441         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16442         GO TO 8110-SEND-DATA.
 16443
 16444     IF DM-RETURN-CODE = '03'
 16445         MOVE ER-8053            TO EMI-ERROR
 16446         MOVE -1                 TO MAINTL
 16447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16448         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16449         GO TO 8110-SEND-DATA.
 16450
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 309
* EL131.cbl
 16451     IF DM-RETURN-CODE = '04'
 16452         MOVE ER-8054            TO EMI-ERROR
 16453         MOVE -1                 TO MAINTL
 16454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16455         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16456         GO TO 8110-SEND-DATA.
 16457
 16458     IF DM-RETURN-CODE = '05'
 16459         MOVE ER-8055            TO EMI-ERROR
 16460         MOVE -1                 TO MAINTL
 16461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16462         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16463         GO TO 8110-SEND-DATA.
 16464
 16465     IF DM-RETURN-CODE = '06'
 16466         MOVE ER-8056            TO EMI-ERROR
 16467         MOVE -1                 TO MAINTL
 16468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16469         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16470         GO TO 8110-SEND-DATA.
 16471
 16472     IF DM-RETURN-CODE = '07'
 16473         MOVE ER-8057            TO EMI-ERROR
 16474         MOVE -1                 TO MAINTL
 16475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16476         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16477         GO TO 8110-SEND-DATA.
 16478
 16479     IF DM-RETURN-CODE = '08'
 16480         MOVE ER-8058            TO EMI-ERROR
 16481         MOVE -1                 TO MAINTL
 16482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16483         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16484         GO TO 8110-SEND-DATA.
 16485
 16486     IF DM-RETURN-CODE = '09'
 16487         MOVE ER-8059            TO EMI-ERROR
 16488         MOVE -1                 TO MAINTL
 16489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16490         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16491         GO TO 8110-SEND-DATA.
 16492
 16493     IF DM-RETURN-CODE = '10'
 16494         MOVE ER-8060            TO EMI-ERROR
 16495         MOVE -1                 TO MAINTL
 16496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16497         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16498         GO TO 8110-SEND-DATA.
 16499
 16500     IF DM-RETURN-CODE = '11'
 16501         MOVE ER-8061            TO EMI-ERROR
 16502         MOVE -1                 TO MAINTL
 16503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16504         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16505         GO TO 8110-SEND-DATA.
 16506
 16507     IF DM-RETURN-CODE = '12'
 16508         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 310
* EL131.cbl
 16509         MOVE -1                 TO MAINTL
 16510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16511         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16512         GO TO 8110-SEND-DATA.
 16513
 16514     IF DM-RETURN-CODE = '13'
 16515         MOVE ER-8063            TO EMI-ERROR
 16516         MOVE -1                 TO MAINTL
 16517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16518         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16519         GO TO 8110-SEND-DATA.
 16520
 16521     IF DM-RETURN-CODE = '14'
 16522         MOVE ER-8064            TO EMI-ERROR
 16523         MOVE -1                 TO MAINTL
 16524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16525         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16526         GO TO 8110-SEND-DATA.
 16527
 16528     IF DM-RETURN-CODE = '15'
 16529         MOVE ER-8065            TO EMI-ERROR
 16530         MOVE -1                 TO MAINTL
 16531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16532         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16533         GO TO 8110-SEND-DATA.
 16534
 16535     IF DM-RETURN-CODE = '16'
 16536         MOVE ER-8154            TO EMI-ERROR
 16537         MOVE -1                 TO MAINTL
 16538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16539         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16540         GO TO 8110-SEND-DATA.
 16541
 16542     IF DM-RETURN-CODE = '17'
 16543         MOVE ER-8155            TO EMI-ERROR
 16544         MOVE -1                 TO MAINTL
 16545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16546         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16547         GO TO 8110-SEND-DATA.
 16548
 16549     IF DM-RETURN-CODE = 'N1'
 16550         MOVE ER-8152            TO EMI-ERROR
 16551         MOVE -1                 TO MAINTL
 16552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16553         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16554         GO TO 8110-SEND-DATA.
 16555
 16556     IF DM-RETURN-CODE = 'E1'
 16557         MOVE ER-8153            TO EMI-ERROR
 16558         MOVE -1                 TO MAINTL
 16559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16560         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16561         GO TO 8110-SEND-DATA.
 16562
 16563     MOVE ER-8066                TO EMI-ERROR.
 16564     MOVE -1                     TO MAINTL.
 16565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16566     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 311
* EL131.cbl
 16567     GO TO 8110-SEND-DATA.
 16568
 16569 8000-NOTE-NOT-FOUND.
 16570
 16571* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16572*    MOVE '6"R                   !   #00013882' TO DFHEIV0
 16573     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16575     MOVE X'2020233030303133383832' TO DFHEIV0(25:11)
 16576     CALL 'kxdfhei1' USING DFHEIV0
 16577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16578
 16579     MOVE ER-0954                TO EMI-ERROR.
 16580     MOVE -1                     TO MAINTL.
 16581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16582     GO TO 8110-SEND-DATA.
 16583
 16584 8000-EXIT.
 16585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 312
* EL131.cbl
 16587 8050-FORMAT-LAST-NAME-1ST.
 16588*****************************************************************
 16589*             M O V E   N A M E   R O U T I N E                 *
 16590*                                                               *
 16591*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16592*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16593*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16594*                                                               *
 16595*                  FIELD               VALUE                    *
 16596*                  -----               -----                    *
 16597*           W-NAME-LAST    (CL15)      SMITH                    *
 16598*           W-NAME-FIRST   (CL15)      JOHN                     *
 16599*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16600*                                                               *
 16601*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16602*                SMITH, JOHN ALLEN                              *
 16603*                     OR                                        *
 16604*                SMITH, JOHN A.                                 *
 16605*                                                               *
 16606*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16607*     COPYBOOK, ELCNWA.                                         *
 16608*****************************************************************.
 16609
 16610     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16611     MOVE ZERO                   TO WS-NAME-SW.
 16612     SET NWA-INDEX               TO +1.
 16613
 16614     IF W-NAME-LAST   = SPACES  AND
 16615        W-NAME-MIDDLE = SPACES
 16616          MOVE +1                TO WS-NAME-SW.
 16617
 16618     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16619     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16620
 16621     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16622     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16623
 16624     SET NWA-INDEX UP BY +1.
 16625
 16626     IF W-NAME-MIDDLE NOT = SPACES
 16627         IF W-NAME-MIDDLE-2 = SPACES
 16628             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16629             SET NWA-INDEX UP BY +1
 16630             MOVE '.'            TO WS-NW (NWA-INDEX)
 16631             SET NWA-INDEX UP BY +2
 16632         ELSE
 16633             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16634             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16635
 16636 8050-EXIT.
 16637     EXIT.
 16638
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 313
* EL131.cbl
 16640 8060-MOVE-NAME.
 16641     IF WS-NAME-SW GREATER THAN +1
 16642         GO TO 8060-EXIT.
 16643
 16644     IF WS-NAME-WORK2 = SPACES
 16645         GO TO 8060-EXIT.
 16646
 16647     SET NWA-INDEX2            TO +1.
 16648     SET NWA-INDEX3            TO +2.
 16649
 16650 8060-MOVE-NAME-CYCLE.
 16651     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16652
 16653     IF NWA-INDEX LESS THAN +30
 16654         SET NWA-INDEX UP BY +1
 16655     ELSE
 16656         ADD +2 TO  WS-NAME-SW
 16657         GO TO 8060-EXIT.
 16658
 16659     IF NWA-INDEX2 LESS THAN +20
 16660         SET NWA-INDEX3 UP BY +1
 16661         SET NWA-INDEX2 UP BY +1.
 16662
 16663     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16664        WS-NW2 (NWA-INDEX3) = SPACES
 16665         IF WS-NAME-SW = ZERO
 16666             MOVE ','            TO WS-NW (NWA-INDEX)
 16667             SET NWA-INDEX UP BY +2
 16668             MOVE +1             TO WS-NAME-SW
 16669             GO TO 8060-EXIT
 16670         ELSE
 16671             GO TO 8060-EXIT.
 16672
 16673     GO TO 8060-MOVE-NAME-CYCLE.
 16674
 16675 8060-EXIT.
 16676     EXIT.
 16677
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 314
* EL131.cbl
 16679
 16680 8070-UNLOCK-CLAIM-MSTR.
 16681
 16682* EXEC CICS UNLOCK
 16683*        DATASET   (CLMS-FILE-ID)
 16684*    END-EXEC.
 16685*    MOVE '&*                    #   #00013985' TO DFHEIV0
 16686     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16687     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16688     MOVE X'2020233030303133393835' TO DFHEIV0(25:11)
 16689     CALL 'kxdfhei1' USING DFHEIV0,
 16690           CLMS-FILE-ID,
 16691           DFHEIV99
 16692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16693
 16694
 16695 8070-EXIT.
 16696      EXIT.
 16697
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 315
* EL131.cbl
 16699 8100-SEND-MAP.
 16700     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16701
 16702     move al-uanon               to accswa
 16703     IF NOT PI-NO-CARRIER-SECURITY
 16704        MOVE AL-SANOF            TO CERTCARA.
 16705     IF NOT PI-NO-ACCOUNT-SECURITY
 16706        MOVE AL-SANOF            TO CERTACTA.
 16707
 16708     IF PI-PROCESSOR-ID = 'LGXX'
 16709        MOVE AL-UANON            TO CCNOA.
 16710
 16711     IF PI-COMPANY-ID = 'DMD'
 16712        NEXT SENTENCE
 16713     ELSE
 16714        MOVE AL-SADOF            TO PFKEY6A.
 16715
 16716     IF PI-USES-PAID-TO
 16717        MOVE 'PAID TO  :' TO PTHRHDGO.
 16718
 16719
 16720* EXEC CICS SEND
 16721*         MAP     ('EL131A')
 16722*         MAPSET  ('EL131S')
 16723*         ERASE
 16724*         FREEKB
 16725*         CURSOR
 16726*    END-EXEC.
 16727     MOVE 'EL131A' TO DFHEIV1
 16728     MOVE -1
 16729       TO DFHEIV11
 16730     MOVE 'EL131S' TO DFHEIV2
 16731*    MOVE '8$     CT  E F  H     ,   #00014013' TO DFHEIV0
 16732     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16733     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16734     MOVE X'2020233030303134303133' TO DFHEIV0(25:11)
 16735     CALL 'kxdfhei1' USING DFHEIV0,
 16736           DFHEIV1,
 16737           EL131AO,
 16738           DFHEIV99,
 16739           DFHEIV2,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV11,
 16744           DFHEIV99,
 16745           DFHEIV99,
 16746           DFHEIV99
 16747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16748
 16749
 16750     GO TO 9000-RETURN-TRANS.
 16751
 16752 8110-SEND-DATA.
 16753     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16754
 16755     IF PI-USES-PAID-TO
 16756        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 316
* EL131.cbl
 16757
 16758     IF PI-PROCESSOR-ID = 'LGXX'
 16759        MOVE AL-UANON            TO CCNOA.
 16760
 16761     IF PI-COMPANY-ID = 'DMD'
 16762        NEXT SENTENCE
 16763     ELSE
 16764        MOVE AL-SADOF            TO PFKEY6A.
 16765
 16766
 16767* EXEC CICS SEND
 16768*         MAP      ('EL131A')
 16769*         MAPSET   ('EL131S')
 16770*         DATAONLY
 16771*         FREEKB
 16772*         CURSOR
 16773*    END-EXEC.
 16774     MOVE 'EL131A' TO DFHEIV1
 16775     MOVE -1
 16776       TO DFHEIV11
 16777     MOVE 'EL131S' TO DFHEIV2
 16778*    MOVE '8$D    CT    F  H     ,   #00014037' TO DFHEIV0
 16779     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16780     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16781     MOVE X'2020233030303134303337' TO DFHEIV0(25:11)
 16782     CALL 'kxdfhei1' USING DFHEIV0,
 16783           DFHEIV1,
 16784           EL131AO,
 16785           DFHEIV99,
 16786           DFHEIV2,
 16787           DFHEIV99,
 16788           DFHEIV99,
 16789           DFHEIV99,
 16790           DFHEIV11,
 16791           DFHEIV99,
 16792           DFHEIV99,
 16793           DFHEIV99
 16794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16795
 16796
 16797     GO TO 9000-RETURN-TRANS.
 16798
 16799 8120-FORMAT-TIME-DATE.
 16800     perform 8140-check-for-prev-errors
 16801                                 thru 8140-exit
 16802     IF SKIP-ATTRIBUTE = 'Y'
 16803        MOVE SPACES              TO SKIP-ATTRIBUTE
 16804        MOVE ER-0598             TO EMI-ERROR
 16805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16806        GO TO 8125-SKIP-ATTRIBUTE.
 16807
 16808*     IF PI-COMPANY-ID = 'DMD'
 16809      IF PI-PROCESSOR-ID <> 'EMER'
 16810         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16811                                    CERTCARA  CERTGRPA CERTA SUFXA
 16812
 16813     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16814                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 317
* EL131.cbl
 16815                                    JNTINITA  JNTAGEA   APRA
 16816                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16817                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16818                                    LCVEXITA  LCVSTATA  LCVKINDA
 16819                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16820                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16821                                    ACVEXITA  ACVSTATA  ACVKINDA
 16822                                    PMTFREQA  INDGRPA   PREMTYPA
 16823                                    REINCDA   LCVRATEA  ACVRATEA
 16824                                    ADDONDTA.
 16825
 16826*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16827*       IF PI-COMPANY-ID = 'DMD'
 16828*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16829*                                   SUFXA
 16830*                                   PDAMTA    NODAYSA   NOPMTSA
 16831*                                   INCA      OCCA
 16832*          IF NOT SYSTEM-MODIFY-CAP
 16833*              MOVE AL-SANOF         TO PDTHRUA.
 16834
 16835     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16836         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16837
 16838 8125-SKIP-ATTRIBUTE.
 16839
 16840     MOVE SAVE-DATE              TO DATEO.
 16841
 16842* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16843*    END-EXEC
 16844*    MOVE '0"A                   "   #00014089' TO DFHEIV0
 16845     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16846     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16847     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 16848     CALL 'kxdfhei1' USING DFHEIV0,
 16849           LCP-CICS-TIME
 16850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16851
 16852* EXEC CICS FORMATTIME
 16853*              ABSTIME(LCP-CICS-TIME)
 16854*              TIME(LCP-TIME-OF-DAY-XX)
 16855*    END-EXEC
 16856*    MOVE 'j$(     (             #   #00014091' TO DFHEIV0
 16857     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16858     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16859     MOVE X'2020233030303134303931' TO DFHEIV0(25:11)
 16860     CALL 'kxdfhei1' USING DFHEIV0,
 16861           LCP-CICS-TIME,
 16862           LCP-TIME-OF-DAY-XX
 16863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16864     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16865     MOVE UN-HOURS               TO FOR-HOURS.
 16866     MOVE UN-MINUTES             TO FOR-MINUTES.
 16867     MOVE TIME-OUT               TO TIMEO.
 16868     MOVE PI-COMPANY-ID          TO COMPO.
 16869     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16870     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16871     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16872     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 318
* EL131.cbl
 16873     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16874
 16875 8130-EXIT.
 16876     EXIT.
 16877
 16878 8140-check-for-prev-errors.
 16879
 16880     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16881     MOVE PI-CARRIER             TO trlr-carrier
 16882     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16883     MOVE PI-CERT-NO             TO trlr-cert-no
 16884     MOVE +95                    TO TRLR-SEQ-NO
 16885
 16886
 16887* EXEC CICS READ
 16888*       DATASET  ('ELTRLR')
 16889*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16890*       RIDFLD   (TRLR-KEY)
 16891*       RESP     (WS-RESPONSE)
 16892*    END-EXEC
 16893     MOVE 'ELTRLR' TO DFHEIV1
 16894*    MOVE '&"S        E          (  N#00014117' TO DFHEIV0
 16895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16897     MOVE X'204E233030303134313137' TO DFHEIV0(25:11)
 16898     CALL 'kxdfhei1' USING DFHEIV0,
 16899           DFHEIV1,
 16900           DFHEIV20,
 16901           DFHEIV99,
 16902           TRLR-KEY,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99
 16906     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16907         DFHEIV20
 16908     MOVE EIBRESP  TO WS-RESPONSE
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16910
 16911     if ws-resp-normal
 16912        perform varying s1 from +1 by +1 until
 16913           at-note-error-no (s1) = spaces
 16914           if at-note-error-no (s1) = '1652'
 16915              continue
 16916           else
 16917              move at-note-error-no (s1)
 16918                                 to emi-error
 16919              move -1 to maintl
 16920              if at-note-error-no (s1) = '1653'
 16921                 evaluate true
 16922                    when pi-claim-type = 'L'
 16923                       move '  LF  '
 16924                        to emi-claim-type
 16925                    when pi-claim-type = 'I'
 16926                       move '  IU  '
 16927                        to emi-claim-type
 16928                    WHEN PI-CLAIM-TYPE = 'F'
 16929                       MOVE '  FL  '
 16930                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 319
* EL131.cbl
 16931                    when other
 16932                       move '  AH  '
 16933                        to emi-claim-type
 16934                 end-evaluate
 16935              end-if
 16936              PERFORM 9900-ERROR-FORMAT
 16937                                 THRU 9900-EXIT
 16938           end-if
 16939*          if at-note-error-no (s1) = '1653'
 16940*             perform varying emi-sub from 1 by 1 until
 16941*                emi-sub > 3
 16942*                if emi-error-number (emi-sub) = '1653'
 16943*                   evaluate true
 16944*                      when pi-claim-type = 'L'
 16945*                         move '  LF  '
 16946*                          to emi-claim-type
 16947*                      when pi-claim-type = 'I'
 16948*                         move '  IU  '
 16949*                          to emi-claim-type
 16950*                      when other
 16951*                         move '  AH  '
 16952*                          to emi-claim-type
 16953*                   end-evaluate
 16954*                end-if
 16955*             end-perform
 16956*          end-if
 16957        end-perform
 16958     else
 16959        display ' resp not normal ' ws-response ' '
 16960        trlr-key (2:19)
 16961     end-if
 16962
 16963     .
 16964 8140-exit.
 16965     exit.
 16966 8150-ENTERED-CLAIM-NOTFOUND.
 16967
 16968     MOVE ER-0204                TO EMI-ERROR.
 16969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16970     MOVE -1                     TO MAINTL.
 16971     GO TO 8100-SEND-MAP.
 16972
 16973 8200-RETURN-PRIOR.
 16974     MOVE SPACE                  TO PI-RETURN-CD-1.
 16975     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16976     GO TO 9200-XCTL.
 16977
 16978 8300-GET-HELP.
 16979     MOVE XCTL-EL010             TO CALL-PGM.
 16980     GO TO 9200-XCTL.
 16981
 16982 8400-RETURN-MASTER.
 16983     MOVE SPACE                  TO PI-RETURN-CD-1.
 16984     MOVE XCTL-EL126             TO CALL-PGM.
 16985     GO TO 9200-XCTL.
 16986
 16987 8500-TRLR-MNT.
 16988     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 320
* EL131.cbl
 16989         MOVE ER-0311            TO EMI-ERROR
 16990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16991         MOVE -1                 TO MAINTL
 16992         GO TO 8110-SEND-DATA.
 16993
 16994
 16995* EXEC CICS WRITEQ TS
 16996*         QUEUE     (PI-KEY)
 16997*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16998*         LENGTH    (PI-COMM-LENGTH)
 16999*    END-EXEC.
 17000*    MOVE '*"     L              ''   #00014207' TO DFHEIV0
 17001     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17003     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 17004     CALL 'kxdfhei1' USING DFHEIV0,
 17005           PI-KEY,
 17006           PROGRAM-INTERFACE-BLOCK,
 17007           PI-COMM-LENGTH,
 17008           DFHEIV99,
 17009           DFHEIV99,
 17010           DFHEIV99
 17011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17012
 17013
 17014     MOVE XCTL-EL142             TO CALL-PGM.
 17015     GO TO 9200-XCTL.
 17016
 17017 8600-ADDR-MNT.
 17018     IF PI-RETURN-CD-1 = 'X'
 17019         MOVE ER-0311            TO EMI-ERROR
 17020         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17021         MOVE -1                 TO MAINTL
 17022         GO TO 8110-SEND-DATA.
 17023
 17024
 17025* EXEC CICS WRITEQ TS
 17026*         QUEUE     (PI-KEY)
 17027*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17028*         LENGTH    (PI-COMM-LENGTH)
 17029*    END-EXEC.
 17030*    MOVE '*"     L              ''   #00014223' TO DFHEIV0
 17031     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17033     MOVE X'2020233030303134323233' TO DFHEIV0(25:11)
 17034     CALL 'kxdfhei1' USING DFHEIV0,
 17035           PI-KEY,
 17036           PROGRAM-INTERFACE-BLOCK,
 17037           PI-COMM-LENGTH,
 17038           DFHEIV99,
 17039           DFHEIV99,
 17040           DFHEIV99
 17041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17042
 17043
 17044     MOVE XCTL-EL141             TO CALL-PGM.
 17045     GO TO 9200-XCTL.
 17046
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 321
* EL131.cbl
 17047 8700-CERT-MNT.
 17048     IF PI-RETURN-CD-1 = 'X'
 17049         MOVE ER-7690            TO EMI-ERROR
 17050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17051         MOVE -1                 TO MAINTL
 17052         GO TO 8110-SEND-DATA.
 17053
 17054
 17055* EXEC CICS WRITEQ TS
 17056*         QUEUE     (PI-KEY)
 17057*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17058*         LENGTH    (PI-COMM-LENGTH)
 17059*    END-EXEC.
 17060*    MOVE '*"     L              ''   #00014239' TO DFHEIV0
 17061     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17062     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17063     MOVE X'2020233030303134323339' TO DFHEIV0(25:11)
 17064     CALL 'kxdfhei1' USING DFHEIV0,
 17065           PI-KEY,
 17066           PROGRAM-INTERFACE-BLOCK,
 17067           PI-COMM-LENGTH,
 17068           DFHEIV99,
 17069           DFHEIV99,
 17070           DFHEIV99
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17072
 17073
 17074     MOVE XCTL-EL1273            TO CALL-PGM.
 17075     GO TO 9200-XCTL.
 17076
 17077 8725-BENEFICIARY-MNT.
 17078     IF PI-RETURN-CD-1 = 'X'
 17079         MOVE ER-0311            TO EMI-ERROR
 17080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17081         MOVE -1                 TO MAINTL
 17082         GO TO 8110-SEND-DATA.
 17083
 17084
 17085* EXEC CICS WRITEQ TS
 17086*         QUEUE     (PI-KEY)
 17087*         FROM      (EL131AI)
 17088*         LENGTH    (MAP-LENGTH)
 17089*    END-EXEC.
 17090*    MOVE '*"     L              ''   #00014255' TO DFHEIV0
 17091     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17092     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17093     MOVE X'2020233030303134323535' TO DFHEIV0(25:11)
 17094     CALL 'kxdfhei1' USING DFHEIV0,
 17095           PI-KEY,
 17096           EL131AI,
 17097           MAP-LENGTH,
 17098           DFHEIV99,
 17099           DFHEIV99,
 17100           DFHEIV99
 17101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17102
 17103
 17104
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 322
* EL131.cbl
 17105* EXEC CICS WRITEQ TS
 17106*         QUEUE     (PI-KEY)
 17107*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17108*         LENGTH    (PI-COMM-LENGTH)
 17109*    END-EXEC.
 17110*    MOVE '*"     L              ''   #00014261' TO DFHEIV0
 17111     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17113     MOVE X'2020233030303134323631' TO DFHEIV0(25:11)
 17114     CALL 'kxdfhei1' USING DFHEIV0,
 17115           PI-KEY,
 17116           PROGRAM-INTERFACE-BLOCK,
 17117           PI-COMM-LENGTH,
 17118           DFHEIV99,
 17119           DFHEIV99,
 17120           DFHEIV99
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17122
 17123
 17124     MOVE XCTL-EL114             TO CALL-PGM.
 17125     GO TO 9200-XCTL.
 17126
 17127 8750-DMD-CLM-FIX.
 17128
 17129* EXEC CICS WRITEQ TS
 17130*         QUEUE     (PI-KEY)
 17131*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17132*         LENGTH    (PI-COMM-LENGTH)
 17133*    END-EXEC.
 17134*    MOVE '*"     L              ''   #00014271' TO DFHEIV0
 17135     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17136     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17137     MOVE X'2020233030303134323731' TO DFHEIV0(25:11)
 17138     CALL 'kxdfhei1' USING DFHEIV0,
 17139           PI-KEY,
 17140           PROGRAM-INTERFACE-BLOCK,
 17141           PI-COMM-LENGTH,
 17142           DFHEIV99,
 17143           DFHEIV99,
 17144           DFHEIV99
 17145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17146
 17147
 17148     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17149     GO TO 9200-XCTL.
 17150
 17151 8800-UNAUTHORIZED-ACCESS.
 17152     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17153     GO TO 8990-SEND-TEXT.
 17154
 17155 8810-PF23-ENTERED.
 17156     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17157     MOVE XCTL-EL005             TO CALL-PGM.
 17158     GO TO 9200-XCTL.
 17159
 17160 8820-XCTL-ERROR.
 17161
 17162* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 323
* EL131.cbl
 17163*        PGMIDERR (8990-SEND-TEXT)
 17164*    END-EXEC.
 17165*    MOVE '"$L                   ! J #00014290' TO DFHEIV0
 17166     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17168     MOVE X'4A20233030303134323930' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0
 17170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17171
 17172
 17173     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17174     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17175     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17176     MOVE XCTL-EL005            TO CALL-PGM.
 17177     GO TO 9200-XCTL.
 17178
 17179 8990-SEND-TEXT.
 17180
 17181* EXEC CICS SEND TEXT
 17182*         FROM      (LOGOFF-TEXT)
 17183*         LENGTH    (LOGOFF-LENGTH)
 17184*         ERASE
 17185*         FREEKB
 17186*    END-EXEC.
 17187*    MOVE '8&      T  E F  H   F -   #00014301' TO DFHEIV0
 17188     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17189     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17190     MOVE X'2020233030303134333031' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0,
 17192           LOGOFF-TEXT,
 17193           LOGOFF-LENGTH,
 17194           DFHEIV99,
 17195           DFHEIV99,
 17196           DFHEIV99,
 17197           DFHEIV99,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99,
 17201           DFHEIV99,
 17202           DFHEIV99,
 17203           DFHEIV99
 17204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17205
 17206
 17207     GO TO 9100-RETURN-CICS.
 17208
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 324
* EL131.cbl
 17210 9000-RETURN-TRANS.
 17211
 17212* EXEC CICS RETURN
 17213*         TRANSID   (TRANS-ID)
 17214*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17215*         LENGTH    (PI-COMM-LENGTH)
 17216*    END-EXEC.
 17217*    MOVE '.(CT                  ''   #00014312' TO DFHEIV0
 17218     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17219     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17220     MOVE X'2020233030303134333132' TO DFHEIV0(25:11)
 17221     CALL 'kxdfhei1' USING DFHEIV0,
 17222           TRANS-ID,
 17223           PROGRAM-INTERFACE-BLOCK,
 17224           PI-COMM-LENGTH,
 17225           DFHEIV99,
 17226           DFHEIV99,
 17227           DFHEIV99
 17228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17229
 17230
 17231
 17232* GOBACK.
 17233     MOVE '9%                    "   ' TO DFHEIV0
 17234     MOVE 'EL131' TO DFHEIV1
 17235     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17236     GOBACK.
 17237
 17238 9100-RETURN-CICS.
 17239
 17240* EXEC CICS RETURN
 17241*    END-EXEC.
 17242*    MOVE '.(                    ''   #00014321' TO DFHEIV0
 17243     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17244     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17245     MOVE X'2020233030303134333231' TO DFHEIV0(25:11)
 17246     CALL 'kxdfhei1' USING DFHEIV0,
 17247           DFHEIV99,
 17248           DFHEIV99,
 17249           DFHEIV99,
 17250           DFHEIV99,
 17251           DFHEIV99,
 17252           DFHEIV99
 17253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17254
 17255
 17256
 17257* GOBACK.
 17258     MOVE '9%                    "   ' TO DFHEIV0
 17259     MOVE 'EL131' TO DFHEIV1
 17260     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17261     GOBACK.
 17262
 17263 9200-XCTL.
 17264
 17265* EXEC CICS XCTL
 17266*         PROGRAM    (CALL-PGM)
 17267*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 325
* EL131.cbl
 17268*         LENGTH     (PI-COMM-LENGTH)
 17269*    END-EXEC.
 17270*    MOVE '.$C                   %   #00014327' TO DFHEIV0
 17271     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17272     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303134333237' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0,
 17275           CALL-PGM,
 17276           PROGRAM-INTERFACE-BLOCK,
 17277           PI-COMM-LENGTH,
 17278           DFHEIV99
 17279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17280
 17281
 17282 9700-LINK-RTRM-FILE-ID.
 17283
 17284* EXEC CICS LINK
 17285*        PROGRAM  (RTRM-FILE-ID)
 17286*        COMMAREA (CALCULATION-PASS-AREA)
 17287*        LENGTH   (CP-COMM-LENGTH)
 17288*    END-EXEC.
 17289*    MOVE '."C                   (   #00014334' TO DFHEIV0
 17290     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17292     MOVE X'2020233030303134333334' TO DFHEIV0(25:11)
 17293     CALL 'kxdfhei1' USING DFHEIV0,
 17294           RTRM-FILE-ID,
 17295           CALCULATION-PASS-AREA,
 17296           CP-COMM-LENGTH,
 17297           DFHEIV99,
 17298           DFHEIV99,
 17299           DFHEIV99,
 17300           DFHEIV99
 17301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17302
 17303
 17304 9700-EXIT.
 17305      EXIT.
 17306
 17307 9800-CONVERT-DATE.
 17308     MOVE SPACES TO DC-ERROR-CODE.
 17309
 17310* EXEC CICS LINK
 17311*         PROGRAM    (DATE-CONV)
 17312*         COMMAREA   (DATE-CONVERSION-DATA)
 17313*         LENGTH     (DC-COMM-LENGTH)
 17314*    END-EXEC.
 17315*    MOVE '."C                   (   #00014345' TO DFHEIV0
 17316     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17318     MOVE X'2020233030303134333435' TO DFHEIV0(25:11)
 17319     CALL 'kxdfhei1' USING DFHEIV0,
 17320           DATE-CONV,
 17321           DATE-CONVERSION-DATA,
 17322           DC-COMM-LENGTH,
 17323           DFHEIV99,
 17324           DFHEIV99,
 17325           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 326
* EL131.cbl
 17326           DFHEIV99
 17327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17328
 17329
 17330 9800-EXIT.
 17331     EXIT.
 17332
 17333 9900-ERROR-FORMAT.
 17334
 17335* EXEC CICS LINK
 17336*         PROGRAM    (XCTL-EL001)
 17337*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17338*         LENGTH     (EMI-COMM-LENGTH)
 17339*    END-EXEC.
 17340*    MOVE '."C                   (   #00014355' TO DFHEIV0
 17341     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17343     MOVE X'2020233030303134333535' TO DFHEIV0(25:11)
 17344     CALL 'kxdfhei1' USING DFHEIV0,
 17345           XCTL-EL001,
 17346           ERROR-MESSAGE-INTERFACE-BLOCK,
 17347           EMI-COMM-LENGTH,
 17348           DFHEIV99,
 17349           DFHEIV99,
 17350           DFHEIV99,
 17351           DFHEIV99
 17352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17353
 17354
 17355 9900-EXIT.
 17356     EXIT.
 17357
 17358 9990-ABEND.
 17359     MOVE DFHEIBLK               TO EMI-LINE1.
 17360
 17361* EXEC CICS LINK
 17362*         PROGRAM   (XCTL-EL004)
 17363*         COMMAREA  (EMI-LINE1)
 17364*         LENGTH    (72)
 17365*     END-EXEC.
 17366     MOVE 72
 17367       TO DFHEIV11
 17368*    MOVE '."C                   (   #00014366' TO DFHEIV0
 17369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17371     MOVE X'2020233030303134333636' TO DFHEIV0(25:11)
 17372     CALL 'kxdfhei1' USING DFHEIV0,
 17373           XCTL-EL004,
 17374           EMI-LINE1,
 17375           DFHEIV11,
 17376           DFHEIV99,
 17377           DFHEIV99,
 17378           DFHEIV99,
 17379           DFHEIV99
 17380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17381
 17382
 17383     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 327
* EL131.cbl
 17384
 17385     GO TO 8110-SEND-DATA.
 17386
 17387 9995-SECURITY-VIOLATION.
 17388*           COPY ELCSCTP.
 17389******************************************************************
 17390*                                                                *
 17391*                            ELCSCTP                             *
 17392*                            VMOD=2.001                          *
 17393*                                                                *
 17394*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17395******************************************************************
 17396
 17397
 17398     MOVE EIBDATE          TO SM-JUL-DATE.
 17399     MOVE EIBTRMID         TO SM-TERMID.
 17400     MOVE THIS-PGM         TO SM-PGM.
 17401     MOVE EIBTIME          TO TIME-IN.
 17402     MOVE TIME-OUT         TO SM-TIME.
 17403     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17404
 17405
 17406* EXEC CICS LINK
 17407*         PROGRAM  ('EL003')
 17408*         COMMAREA (SECURITY-MESSAGE)
 17409*         LENGTH   (80)
 17410*    END-EXEC.
 17411     MOVE 'EL003' TO DFHEIV1
 17412     MOVE 80
 17413       TO DFHEIV11
 17414*    MOVE '."C                   (   #00014394' TO DFHEIV0
 17415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17417     MOVE X'2020233030303134333934' TO DFHEIV0(25:11)
 17418     CALL 'kxdfhei1' USING DFHEIV0,
 17419           DFHEIV1,
 17420           SECURITY-MESSAGE,
 17421           DFHEIV11,
 17422           DFHEIV99,
 17423           DFHEIV99,
 17424           DFHEIV99,
 17425           DFHEIV99
 17426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17427
 17428
 17429******************************************************************
 17430
 17431
 17432
 17433 9999-DFHBACK SECTION.
 17434     MOVE '9%                    "   ' TO DFHEIV0
 17435     MOVE 'EL131' TO DFHEIV1
 17436     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17437     GOBACK.
 17438 9999-DFHEXIT.
 17439     IF DFHEIGDJ EQUAL 0001
 17440         NEXT SENTENCE
 17441     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 328
* EL131.cbl
 17442         GO TO 8820-XCTL-ERROR,
 17443               8150-ENTERED-CLAIM-NOTFOUND,
 17444               9990-ABEND
 17445         DEPENDING ON DFHEIGDI
 17446     ELSE IF DFHEIGDJ EQUAL 3
 17447         GO TO 0130-TS-ERROR,
 17448               0130-TS-ERROR
 17449         DEPENDING ON DFHEIGDI
 17450     ELSE IF DFHEIGDJ EQUAL 4
 17451         GO TO 0600-CONTINUE-NAME-UPDATE
 17452         DEPENDING ON DFHEIGDI
 17453     ELSE IF DFHEIGDJ EQUAL 5
 17454         GO TO 1004-BENE-NOT-FOUND
 17455         DEPENDING ON DFHEIGDI
 17456     ELSE IF DFHEIGDJ EQUAL 6
 17457         GO TO 1052-DONE,
 17458               1052-DONE
 17459         DEPENDING ON DFHEIGDI
 17460     ELSE IF DFHEIGDJ EQUAL 7
 17461         GO TO 1120-CNTL-NOTFND
 17462         DEPENDING ON DFHEIGDI
 17463     ELSE IF DFHEIGDJ EQUAL 8
 17464         GO TO 1150-NOTOPEN-ERROR,
 17465               1150-EXIT
 17466         DEPENDING ON DFHEIGDI
 17467     ELSE IF DFHEIGDJ EQUAL 9
 17468         GO TO 1490-STATE-NOTFND
 17469         DEPENDING ON DFHEIGDI
 17470     ELSE IF DFHEIGDJ EQUAL 10
 17471         GO TO 1500-CARR-NOTFND
 17472         DEPENDING ON DFHEIGDI
 17473     ELSE IF DFHEIGDJ EQUAL 11
 17474         GO TO 1620-ACCT-NOTFND
 17475         DEPENDING ON DFHEIGDI
 17476     ELSE IF DFHEIGDJ EQUAL 12
 17477         GO TO 2020-EXIT
 17478         DEPENDING ON DFHEIGDI
 17479     ELSE IF DFHEIGDJ EQUAL 13
 17480         GO TO 2030-EXIT
 17481         DEPENDING ON DFHEIGDI
 17482     ELSE IF DFHEIGDJ EQUAL 14
 17483         GO TO 2040-EXIT
 17484         DEPENDING ON DFHEIGDI
 17485     ELSE IF DFHEIGDJ EQUAL 15
 17486         GO TO 2050-EXIT
 17487         DEPENDING ON DFHEIGDI
 17488     ELSE IF DFHEIGDJ EQUAL 16
 17489         GO TO 2060-CERT-NOTFND
 17490         DEPENDING ON DFHEIGDI
 17491     ELSE IF DFHEIGDJ EQUAL 17
 17492         GO TO 2060-DUPKEY
 17493         DEPENDING ON DFHEIGDI
 17494     ELSE IF DFHEIGDJ EQUAL 18
 17495         GO TO 2070-NOT-FOUND
 17496         DEPENDING ON DFHEIGDI
 17497     ELSE IF DFHEIGDJ EQUAL 19
 17498         GO TO 2070-EXIT
 17499         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 329
* EL131.cbl
 17500     ELSE IF DFHEIGDJ EQUAL 20
 17501         GO TO 2080-EXIT
 17502         DEPENDING ON DFHEIGDI
 17503     ELSE IF DFHEIGDJ EQUAL 21
 17504         GO TO 2400-TRLR-NOTFND,
 17505               2410-EXIT
 17506         DEPENDING ON DFHEIGDI
 17507     ELSE IF DFHEIGDJ EQUAL 22
 17508         GO TO 2425-NINETY-NOTFND,
 17509               2425-NINETY-NOTFND
 17510         DEPENDING ON DFHEIGDI
 17511     ELSE IF DFHEIGDJ EQUAL 23
 17512         GO TO 2430-EXIT,
 17513               2440-EXIT
 17514         DEPENDING ON DFHEIGDI
 17515     ELSE IF DFHEIGDJ EQUAL 24
 17516         GO TO 2440-EXIT
 17517         DEPENDING ON DFHEIGDI
 17518     ELSE IF DFHEIGDJ EQUAL 25
 17519         GO TO 2460-EXIT
 17520         DEPENDING ON DFHEIGDI
 17521     ELSE IF DFHEIGDJ EQUAL 26
 17522         GO TO 2475-EXIT
 17523         DEPENDING ON DFHEIGDI
 17524     ELSE IF DFHEIGDJ EQUAL 27
 17525         GO TO 2650-EXIT
 17526         DEPENDING ON DFHEIGDI
 17527     ELSE IF DFHEIGDJ EQUAL 28
 17528         GO TO 2800-EXIT,
 17529               2800-EXIT
 17530         DEPENDING ON DFHEIGDI
 17531     ELSE IF DFHEIGDJ EQUAL 29
 17532         GO TO 3010-DEL-ACTQ,
 17533               3040-EXIT
 17534         DEPENDING ON DFHEIGDI
 17535     ELSE IF DFHEIGDJ EQUAL 30
 17536         GO TO 3010-NO-ACTIVITY,
 17537               3050-EXIT
 17538         DEPENDING ON DFHEIGDI
 17539     ELSE IF DFHEIGDJ EQUAL 31
 17540         GO TO 3010-CERT-NOT-FOUND
 17541         DEPENDING ON DFHEIGDI
 17542     ELSE IF DFHEIGDJ EQUAL 32
 17543         GO TO 3020-EXIT
 17544         DEPENDING ON DFHEIGDI
 17545     ELSE IF DFHEIGDJ EQUAL 33
 17546         GO TO 3060-EXIT,
 17547               3060-EXIT
 17548         DEPENDING ON DFHEIGDI
 17549     ELSE IF DFHEIGDJ EQUAL 34
 17550         GO TO 5000-TRLR-NOT-FOUND
 17551         DEPENDING ON DFHEIGDI
 17552     ELSE IF DFHEIGDJ EQUAL 35
 17553         GO TO 5000-CERT-NOT-FOUND
 17554         DEPENDING ON DFHEIGDI
 17555     ELSE IF DFHEIGDJ EQUAL 36
 17556         GO TO 1052-DONE,
 17557               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 11:23 Page 330
* EL131.cbl
 17558         DEPENDING ON DFHEIGDI
 17559     ELSE IF DFHEIGDJ EQUAL 37
 17560         GO TO 7630-END-BROWSE
 17561         DEPENDING ON DFHEIGDI
 17562     ELSE IF DFHEIGDJ EQUAL 38
 17563         GO TO 7799-EXIT,
 17564               7799-EXIT
 17565         DEPENDING ON DFHEIGDI
 17566     ELSE IF DFHEIGDJ EQUAL 39
 17567         GO TO 7799-EXIT
 17568         DEPENDING ON DFHEIGDI
 17569     ELSE IF DFHEIGDJ EQUAL 40
 17570         GO TO 7800-NOT-FOUND
 17571         DEPENDING ON DFHEIGDI
 17572     ELSE IF DFHEIGDJ EQUAL 41
 17573         GO TO 8000-NOTE-NOT-FOUND
 17574         DEPENDING ON DFHEIGDI
 17575     ELSE IF DFHEIGDJ EQUAL 42
 17576         GO TO 8990-SEND-TEXT
 17577         DEPENDING ON DFHEIGDI.
 17578     MOVE '9%                    "   ' TO DFHEIV0
 17579     MOVE 'EL131' TO DFHEIV1
 17580     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17581     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14132     Code:       60937
