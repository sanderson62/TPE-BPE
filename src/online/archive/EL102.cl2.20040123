00001  ID DIVISION.
00002
00003  PROGRAM-ID.                 EL102.
00004 *              PROGRAM CONVERTED BY
00005 *              COBOL CONVERSION AID PO 5785-ABJ
00006 *              CONVERSION DATE 03/20/95 08:33:29.
00007 *                            VMOD=2.057
00008 *
00009
00010 *AUTHOR.     LOGIC,INC.
00011 *            DALLAS, TEXAS.
00012
00013 *DATE-COMPILED.
00014 *SECURITY.   *****************************************************
00015 *            *                                                   *
00016 *            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
00017 *            *                                                   *
00018 *            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
00019 *            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
00020 *            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
00021 *            *                                                   *
00022 *            *****************************************************
00023
00024 *REMARKS.    TRANSACTION - EX08 - COMPANY IDENTIFICATION
00025 *                                 AND CONTROL
00026
00027      EJECT
00028  ENVIRONMENT DIVISION.
00029  DATA DIVISION.
00030  WORKING-STORAGE SECTION.
00031  77  FILLER  PIC X(32)  VALUE '********************************'.
00032  77  FILLER  PIC X(32)  VALUE '*    EL102 WORKING STORAGE     *'.
00033  77  FILLER  PIC X(32)  VALUE '********* VMOD=2.057 ***********'.
00034
00035      COPY ELCSCTM.
00036      COPY ELCSCRTY.
00037      EJECT
00038  01  WS-DATE-AREA.
00039      05  SAVE-DATE           PIC X(8)    VALUE SPACES.
00040      05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
00041
00042  01  STANDARD-AREAS.
00043      12  MAP-NAME            PIC X(8)    VALUE 'EL102A'.
00044      12  MAPSET-NAME         PIC X(8)    VALUE 'EL102S'.
00045      12  TRANS-ID            PIC X(4)    VALUE 'EX08'.
00046      12  THIS-PGM            PIC X(8)    VALUE 'EL102'.
00047      12  PGM-NAME            PIC X(8).
00048      12  WS-COMP-CD-R.
00049          16  FILLER          PIC X.
00050          16  WS-COMP-CD-X    PIC X.
00051      12  WS-COMP-CD   REDEFINES WS-COMP-CD-R  PIC S9(4)     COMP.
00052      12  TIME-IN             PIC S9(7).
00053      12  TIME-OUT-R  REDEFINES TIME-IN.
00054          16  FILLER          PIC X.
00055          16  TIME-OUT        PIC 99V99.
00056          16  FILLER          PIC XX.
00057      12  XCTL-005            PIC X(8)    VALUE 'EL005'.
00058      12  XCTL-010            PIC X(8)    VALUE 'EL010'.
00059      12  XCTL-126            PIC X(8)    VALUE 'EL126'.
00060      12  XCTL-626            PIC X(8)    VALUE 'EL626'.
00061      12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
00062      12  XCTL-400            PIC X(8)    VALUE 'LF400'.
00063      12  XCTL-800            PIC X(8)    VALUE 'GL800'.
00064      12  LINK-001            PIC X(8)    VALUE 'EL001'.
00065      12  LINK-004            PIC X(8)    VALUE 'EL004'.
00066      12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
00067      12  FILE-ID             PIC X(8)    VALUE 'ELCNTL'.
00068
00069  01  MISC-WORK-AREAS.
00070      12  W-OPTIONAL-RESERVE-AREAS.
00071          16 W-CREDIBLITY-TABLE   PIC  X(01).
00072          16 W-IBLGMTH            PIC S9(3)   VALUE ZERO.
00073          16 W-CIDADIS            PIC S9V9(4) VALUE ZERO.
00074          16 W-CALCINT            PIC S9V9(4) VALUE ZERO.
00075          16 W-IBNRLFF            PIC S9V9(4) VALUE ZERO.
00076          16 W-IBNRAHF            PIC S9V9(4) VALUE ZERO.
00077          16 W-OPTDTE             PIC XX      VALUE SPACES.
00078      12  WS-ZIP-CODE.
00079          16  WS-ZIP-1            PIC X.
00080              88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
00081          16  WS-ZIP-2-3          PIC XX.
00082          16  WS-ZIP-4            PIC X.
00083          16  WS-ZIP-5            PIC X.
00084          16  WS-ZIP-6            PIC X.
00085          16  FILLER              PIC X(4).
00086      12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
00087          16  WS-ZIP-AM-1-CODE    PIC X(5).
00088          16  WS-ZIP-AM-1-PLUS4   PIC X(4).
00089          16  FILLER              PIC X.
00090      12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
00091          16  WS-ZIP-AM-2-CODE    PIC X(5).
00092          16  WS-ZIP-AM-2-DASH    PIC X.
00093          16  WS-ZIP-AM-2-PLUS4   PIC X(4).
00094      12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
00095          16  WS-ZIP-CAN-1-POST1  PIC X(3).
00096          16  WS-ZIP-CAN-1-POST2  PIC X(3).
00097          16  FILLER              PIC X(4).
00098      12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
00099          16  WS-ZIP-CAN-2-POST1  PIC X(3).
00100          16  FILLER              PIC X.
00101          16  WS-ZIP-CAN-2-POST2  PIC X(3).
00102          16  FILLER              PIC X(3).
00103
00104      12  WS-ZIP-CODE-NUM         PIC 9(9).
00105
00106      12  WS-PHONE-IN         PIC 9(11).
00107      12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
00108          16  FILLER          PIC X.
00109          16  WSPI-AREA       PIC X(3).
00110          16  WSPI-PFX        PIC X(3).
00111          16  WSPI-SFX        PIC X(4).
00112      12  WS-PHONE-OUT.
00113          16  WSPO-AREA       PIC X(3).
00114          16  FILLER          PIC X       VALUE '-'.
00115          16  WSPO-PFX        PIC X(3).
00116          16  FILLER          PIC X       VALUE '-'.
00117          16  WSPO-SFX        PIC X(4).
00118      12  WS-COV-DESCRIPTION.
00119          16  FILLER          PIC X(15)
00120                                 VALUE 'BENEFIT DESC - '.
00121          16  WS-COV-DESC-2   PIC XX.
00122          16  FILLER          PIC XX      VALUE ' :'.
00123      12  TERMINAL-TEST-AREA.
00124          16  TTA-1           PIC X.
00125          16  TTA-2           PIC X.
00126          16  TTA-3           PIC X.
00127          16  TTA-4           PIC X.
00128      12  DEEDIT-FIELD            PIC X(17).
00129      12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(17).
00130      12  SUB1                PIC S9(4)   VALUE +0    COMP.
00131      12  SUB2                PIC S9(4)   VALUE +0    COMP.
00132      12  SV-CLMTOL           PIC 9(3)V99  VALUE ZERO.
00133      12  SV-QTECAL           PIC 9(3)V99  VALUE ZERO.
00134      12  SV-OVSAMT           PIC 9(3)V99  VALUE ZERO.
00135      12  SV-MTOLCAP          PIC 9(3)V99  VALUE ZERO.
00136      12  SV-DAPR             PIC 9(3)V9(4) VALUE ZERO.
00137      12  SV-QTEREF           PIC 9(3)V99  VALUE ZERO.
00138      12  SV-MINPREM          PIC 9(3)V99  VALUE ZERO.
00139      12  SV-COMPWTE          PIC 9(3)V99  VALUE ZERO.
00140      12  SV-PHONE            PIC 9(11)    VALUE ZERO.
00141      12  SV-MORTG-REF-NUM    PIC 9(17)    VALUE ZERO.
00142      12  SV-APPROVAL-LEVELS.
00143          16  SV-LLEV1        PIC 9(7)     VALUE ZERO.
00144          16  SV-LLEV2        PIC 9(7)     VALUE ZERO.
00145          16  SV-LLEV3        PIC 9(7)     VALUE ZERO.
00146          16  SV-ALEV1        PIC 9(7)     VALUE ZERO.
00147          16  SV-ALEV2        PIC 9(7)     VALUE ZERO.
00148          16  SV-ALEV3        PIC 9(7)     VALUE ZERO.
00149      12  DATE-TEST-AREA      PIC 9(6).
00150      12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
00151          16  DATE-TEST-MM    PIC 99.
00152          16  DATE-TEST-DD    PIC 99.
00153          16  DATE-TEST-YY    PIC 99.
00154      12  DIVIDE-RESULT       PIC 99.
00155      12  DIVIDE-REMAINDER    PIC 9.
00156      12  WS-TOL-PREM-PCT     PIC S9V9(4) VALUE ZERO.
00157      12  WS-TOL-REFUND-PCT   PIC S9V9(4) VALUE ZERO.
00158      12  WS-CO-OVR-SHT-PCT   PIC S9V9(4) VALUE ZERO.
00159      12  W-EXPRETN           PIC 9          VALUE ZERO.
00160
00161  01  WS-PASSWORD-NUMERIC            PIC X.
00162  01  WS-PASSWORD-SIXDIGIT           PIC X.
00163
00164  01  WS-SAVE-PASSWORD.
00165      12  WS-PASSWORD-X1             PIC X.
00166      12  WS-PASSWORD-X2             PIC X.
00167      12  WS-PASSWORD-X3             PIC X.
00168      12  WS-PASSWORD-X4             PIC X.
00169      12  WS-PASSWORD-X5             PIC X.
00170      12  WS-PASSWORD-X6             PIC X.
00171      12  WS-PASSWORD-X7             PIC X.
00172      12  WS-PASSWORD-X8             PIC X.
00173
00174  01  WS-SAVE-PASSWORD-NUMERIC REDEFINES  WS-SAVE-PASSWORD.
00175      12  WS-PASSWORD-N1             PIC 9.
00176      12  WS-PASSWORD-N2             PIC 9.
00177      12  WS-PASSWORD-N3             PIC 9.
00178      12  WS-PASSWORD-N4             PIC 9.
00179      12  WS-PASSWORD-N5             PIC 9.
00180      12  WS-PASSWORD-N6             PIC 9.
00181      12  WS-PASSWORD-N7             PIC 9.
00182      12  WS-PASSWORD-N8             PIC 9.
00183
00184
00185  01  ACCESS-KEYS.
00186      12  ELCNTL-KEY.
00187          16  CK-COMP-ID      PIC X(3).
00188          16  CK-REC-TYPE     PIC X       VALUE '1'.
00189          16  FILLER          PIC X(4)    VALUE SPACES.
00190          16  CK-SEQ-NO       PIC S9(4)   VALUE +0    COMP.
00191      12  W-WORKING-CNTL-KEY.
00192          16  W-CNTL-COMP-ID  PIC  X(3).
00193          16  W-CNTL-REC-TYPE PIC  X.
00194          16  W-CNTL-TABLE-INDICATOR
00195                              PIC  X.
00196          16  W-CNTL-BENEFIT-TYPE
00197                              PIC  X.
00198          16  W-CNTL-WAITING-PERIOD
00199                              PIC  XX.
00200          16  W-CNTL-SEQUENCE-NO
00201                              PIC S9(4)  COMP.
00202
00203  01  WS-ELCNTL-KEY.
00204      16  WS-COMP-ID      PIC X(3)    VALUE SPACES.
00205      16  WS-TYPE         PIC X       VALUE SPACES.
00206      16  WS-USER         PIC X(4)    VALUE SPACES.
00207      16  WS-SEQ          PIC S9(4)   VALUE +0    COMP.
00208
00209  01  WS-LNAME-SEARCH-CNTL.
00210      03  WS-MIB-LNAME-SEARCH         PIC X.
00211      03  WS-ALP-LNAME-SEARCH         PIC X.
00212  01  WS-FNAME-SEARCH-CNTL.
00213      03  WS-MIB-FNAME-SEARCH         PIC X.
00214      03  WS-ALP-FNAME-SEARCH         PIC X.
00215  01  WS-MNAME-SEARCH-CNTL.
00216      03  WS-MIB-MNAME-SEARCH         PIC X.
00217      03  WS-ALP-MNAME-SEARCH         PIC X.
00218  01  WS-BDATE-SEARCH-CNTL.
00219      03  WS-MIB-BDATE-SEARCH         PIC X.
00220      03  WS-ALP-BDATE-SEARCH         PIC X.
00221  01  WS-BSTATE-SEARCH-CNTL.
00222      03  WS-MIB-BSTATE-SEARCH        PIC X.
00223      03  WS-ALP-BSTATE-SEARCH        PIC X.
00224  01  WS-RSTATE-SEARCH-CNTL.
00225      03  WS-MIB-RSTATE-SEARCH        PIC X.
00226      03  WS-ALP-RSTATE-SEARCH        PIC X.
00227
00228  01  WS-SAVE-DATES.
00229      05  WS-SAVE-CONDTE      PIC XX.
00230      05  WS-SAVE-RTEFILC     PIC XX.
00231      05  WS-SAVE-COMTABC     PIC XX.
00232      05  WS-SAVE-PRDMSTC     PIC XX.
00233      05  WS-SAVE-ACTMSTC     PIC XX.
00234      05  WS-SAVE-RENTABC     PIC XX.
00235      05  WS-SAVE-CMPMSTC     PIC XX.
00236      05  WS-SAVE-RTEFILM     PIC XX.
00237      05  WS-SAVE-COMTABM     PIC XX.
00238      05  WS-SAVE-ACTMSTM     PIC XX.
00239      05  WS-SAVE-PRDMSTM     PIC XX.
00240      05  WS-SAVE-RENTABM     PIC XX.
00241      05  WS-SAVE-CMPMSTM     PIC XX.
00242      05  WS-SAVE-CURRMEDT    PIC XX.
00243      05  WS-SAVE-CREDMEDT    PIC XX.
00244      05  WS-SAVE-MORTMEDT    PIC XX.
00245      05  WS-SAVE-ARMEDT      PIC XX.
00246      05  WS-SAVE-AR860DT     PIC XX.
00247      05  WS-SAVE-COFFDTE     PIC XX.
00248      05  WS-SAVE-PROCDT      PIC XX.
00249
00250  01  CONTROL-FILE-SAVE-AREA.
00251      05  FILLER              PIC X(750).
00252
00253      EJECT
00254      COPY ELCDATE.
00255      EJECT
00256      COPY ELCLOGOF.
00257      EJECT
00258      COPY ELCATTR.
00259      EJECT
00260      COPY ELCEMIB.
00261
00262  01  WS-ERROR-MESSAGE-AREA.
00263      12  ER-0000                 PIC 9(4)   VALUE 0000.
00264      12  ER-0004                 PIC 9(4)   VALUE 0004.
00265      12  ER-0007                 PIC 9(4)   VALUE 0007.
00266      12  ER-0008                 PIC 9(4)   VALUE 0008.
00267      12  ER-0021                 PIC 9(4)   VALUE 0021.
00268      12  ER-0029                 PIC 9(4)   VALUE 0029.
00269      12  ER-0042                 PIC 9(4)   VALUE 0042.
00270      12  ER-0043                 PIC 9(4)   VALUE 0043.
00271      12  ER-0052                 PIC 9(4)   VALUE 0052.
00272      12  ER-0053                 PIC 9(4)   VALUE 0053.
00273      12  ER-0054                 PIC 9(4)   VALUE 0054.
00274      12  ER-0055                 PIC 9(4)   VALUE 0055.
00275      12  ER-0056                 PIC 9(4)   VALUE 0056.
00276      12  ER-0060                 PIC 9(4)   VALUE 0060.
00277      12  ER-0062                 PIC 9(4)   VALUE 0062.
00278      12  ER-0063                 PIC 9(4)   VALUE 0063.
00279      12  ER-0068                 PIC 9(4)   VALUE 0068.
00280      12  ER-0070                 PIC 9(4)   VALUE 0070.
00281      12  ER-0071                 PIC 9(4)   VALUE 0071.
00282      12  ER-0072                 PIC 9(4)   VALUE 0072.
00283      12  ER-0089                 PIC 9(4)   VALUE 0089.
00284      12  ER-0228                 PIC 9(4)   VALUE 0228.
00285      12  ER-0248                 PIC 9(4)   VALUE 0248.
00286      12  ER-0314                 PIC 9(4)   VALUE 0314.
00287      12  ER-0340                 PIC 9(4)   VALUE 0340.
00288      12  ER-0451                 PIC 9(4)   VALUE 0451.
00289      12  ER-0496                 PIC 9(4)   VALUE 0496.
00290      12  ER-0587                 PIC 9(4)   VALUE 0587.
00291      12  ER-0600                 PIC 9(4)   VALUE 0600.
00292      12  ER-0601                 PIC 9(4)   VALUE 0601.
00293      12  ER-0602                 PIC 9(4)   VALUE 0602.
00294      12  ER-0603                 PIC 9(4)   VALUE 0603.
00295      12  ER-0604                 PIC 9(4)   VALUE 0604.
00296      12  ER-0605                 PIC 9(4)   VALUE 0605.
00297      12  ER-0606                 PIC 9(4)   VALUE 0606.
00298      12  ER-0607                 PIC 9(4)   VALUE 0607.
00299      12  ER-0608                 PIC 9(4)   VALUE 0608.
00300      12  ER-0610                 PIC 9(4)   VALUE 0610.
00301      12  ER-0611                 PIC 9(4)   VALUE 0611.
00302      12  ER-0612                 PIC 9(4)   VALUE 0612.
00303      12  ER-0613                 PIC 9(4)   VALUE 0613.
00304      12  ER-0615                 PIC 9(4)   VALUE 0615.
00305      12  ER-0631                 PIC 9(4)   VALUE 0631.
00306      12  ER-0633                 PIC 9(4)   VALUE 0633.
00307      12  ER-0634                 PIC 9(4)   VALUE 0634.
00308      12  ER-0635                 PIC 9(4)   VALUE 0635.
00309      12  ER-0680                 PIC 9(4)   VALUE 0680.
00310      12  ER-0762                 PIC 9(4)   VALUE 0762.
00311      12  ER-0771                 PIC 9(4)   VALUE 0771.
00312      12  ER-1887                 PIC 9(4)   VALUE 1887.
00313      12  ER-1888                 PIC 9(4)   VALUE 1888.
00314      12  ER-1890                 PIC 9(4)   VALUE 1890.
00315      12  ER-2001                 PIC 9(4)   VALUE 2001.
00316      12  ER-2003                 PIC 9(4)   VALUE 2003.
00317      12  ER-2004                 PIC 9(4)   VALUE 2004.
00318      12  ER-2010                 PIC 9(4)   VALUE 2010.
00319      12  ER-2011                 PIC 9(4)   VALUE 2011.
00320      12  ER-2012                 PIC 9(4)   VALUE 2012.
00321      12  ER-2013                 PIC 9(4)   VALUE 2013.
00322      12  ER-2014                 PIC 9(4)   VALUE 2014.
00323      12  ER-2015                 PIC 9(4)   VALUE 2015.
00324      12  ER-2016                 PIC 9(4)   VALUE 2016.
00325      12  ER-2017                 PIC 9(4)   VALUE 2017.
00326      12  ER-2018                 PIC 9(4)   VALUE 2018.
00327      12  ER-2019                 PIC 9(4)   VALUE 2019.
00328      12  ER-2020                 PIC 9(4)   VALUE 2020.
00329      12  ER-2021                 PIC 9(4)   VALUE 2021.
00330      12  ER-2022                 PIC 9(4)   VALUE 2022.
00331      12  ER-2023                 PIC 9(4)   VALUE 2023.
00332      12  ER-2024                 PIC 9(4)   VALUE 2024.
00333      12  ER-2028                 PIC 9(4)   VALUE 2028.
00334      12  ER-2029                 PIC 9(4)   VALUE 2029.
00335      12  ER-2030                 PIC 9(4)   VALUE 2030.
00336      12  ER-2034                 PIC 9(4)   VALUE 2034.
00337      12  ER-2035                 PIC 9(4)   VALUE 2035.
00338      12  ER-2036                 PIC 9(4)   VALUE 2036.
00339      12  ER-2037                 PIC 9(4)   VALUE 2037.
00340      12  ER-2357                 PIC 9(4)   VALUE 2357.
00341      12  ER-2549                 PIC 9(4)   VALUE 2549.
00342      12  ER-2518                 PIC 9(4)   VALUE 2518.
00343      12  ER-2565                 PIC 9(4)   VALUE 2565.
00344      12  ER-2610                 PIC 9(4)   VALUE 2610.
00345      12  ER-2904                 PIC 9(4)   VALUE 2904.
00346      12  ER-3035                 PIC 9(4)   VALUE 3035.
00347      12  ER-3143                 PIC 9(4)   VALUE 3143.
00348      12  ER-3156                 PIC 9(4)   VALUE 3156.
00349      12  ER-3187                 PIC 9(4)   VALUE 3187.
00350      12  ER-3736                 PIC 9(4)   VALUE 3736.
00351      12  ER-7099                 PIC 9(4)   VALUE 7099.
00352      12  ER-7219                 PIC 9(4)   VALUE 7219.
00353      12  ER-7228                 PIC 9(4)   VALUE 7228.
00354      12  ER-7229                 PIC 9(4)   VALUE 7229.
00355      12  ER-7355                 PIC 9(4)   VALUE 7355.
00356      12  ER-7356                 PIC 9(4)   VALUE 7356.
00357      12  ER-7380                 PIC 9(4)   VALUE 7380.
00358      12  ER-7532                 PIC 9(4)   VALUE 7532.
00359      12  ER-7533                 PIC 9(4)   VALUE 7533.
00360      12  ER-7692                 PIC 9(4)   VALUE 7692.
00361      12  ER-7720                 PIC 9(4)   VALUE 7720.
00362      12  ER-7721                 PIC 9(4)   VALUE 7721.
00363      12  ER-7722                 PIC 9(4)   VALUE 7722.
00364      12  ER-7723                 PIC 9(4)   VALUE 7723.
00365      12  ER-7724                 PIC 9(4)   VALUE 7724.
00366      12  ER-7735                 PIC 9(4)   VALUE 7735.
00367      12  ER-7738                 PIC 9(4)   VALUE 7738.
00368      12  ER-7739                 PIC 9(4)   VALUE 7739.
00369      12  ER-7740                 PIC 9(4)   VALUE 7740.
00370      12  ER-7741                 PIC 9(4)   VALUE 7741.
00371      12  ER-7742                 PIC 9(4)   VALUE 7742.
00372      12  ER-7744                 PIC 9(4)   VALUE 7744.
00373      12  ER-8129                 PIC 9(4)   VALUE 8129.
00374      12  ER-8130                 PIC 9(4)   VALUE 8130.
00375      12  ER-8132                 PIC 9(4)   VALUE 8132.
00376      12  ER-9001                 PIC 9(4)   VALUE 9001.
00377      12  ER-9192                 PIC 9(4)   VALUE 9192.
00378      12  ER-9193                 PIC 9(4)   VALUE 9193.
00379      12  ER-9194                 PIC 9(4)   VALUE 9194.
00380      12  ER-9322                 PIC 9(4)   VALUE 9322.
00381      12  ER-9417                 PIC 9(4)   VALUE 9417.
00382      12  ER-9446                 PIC 9(4)   VALUE 9446.
00383      12  ER-9460                 PIC 9(4)   VALUE 9460.
00384      12  ER-9533                 PIC 9(4)   VALUE 9533.
00385      12  ER-9576                 PIC 9(4)   VALUE 9576.
00386      12  ER-9598                 PIC 9(4)   VALUE 9598.
00387      12  ER-9790                 PIC 9(4)   VALUE 9790.
00388      12  ER-9791                 PIC 9(4)   VALUE 9791.
00389      12  ER-9909                 PIC 9(4)   VALUE 9909.
00390      EJECT
00391      COPY ELCINTF.
00392      12 FILLER REDEFINES PI-PROGRAM-WORK-AREA.
00393         16 PI-MAP-NAME                 PIC X(8).
00394         16 PI-MORTG-CO-UPDATE-BY       PIC X(4).
00395         16 PI-MORTG-CO-UPDATE-HHMMSS   PIC S9(7)   COMP-3.
00396         16 PI-OPTIONAL-RESERVE-SW      PIC X.
00397         16 FILLER                      PIC X(623).
00398      EJECT
00399      COPY ELCJPFX.
00400                              PIC X(750).
00401
00402      EJECT
00403      COPY ELCAID.
00404  01  FILLER    REDEFINES DFHAID.
00405      12  FILLER              PIC X(8).
00406      12  PF-VALUES           PIC X       OCCURS 2.
00407
00408  01  WS-WORK-AREA-2          PIC X(100) VALUE SPACES.
00409
00410      EJECT
00411      COPY EL102S.
00412
00413      EJECT
00414  LINKAGE SECTION.
00415  01  DFHCOMMAREA             PIC X(1024).
00416
00417 *01 PARMLIST .
00418 *    02  FILLER              PIC S9(8)   COMP.
00419 *    02  ELCNTL-POINTER      PIC S9(8)   COMP.
00420      EJECT
00421      COPY ELCCNTL.
00422      EJECT
00423  PROCEDURE DIVISION.
00424
00425      MOVE EIBDATE               TO DC-JULIAN-YYDDD.
00426      MOVE '5'                   TO DC-OPTION-CODE.
00427      PERFORM 8000-CONVERT-DATE THRU 8000-EXIT.
00428      MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
00429      MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
00430
00431      MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
00432
00433      MOVE +3                    TO EMI-NUMBER-OF-LINES.
00434
00435      IF EIBCALEN = 0
00436          GO TO 8800-UNAUTHORIZED-ACCESS.
00437
00438      IF PI-CALLING-PROGRAM NOT = THIS-PGM
00439          IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
00440              MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
00441              MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
00442              MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
00443              MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
00444              MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
00445              MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
00446              MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
00447              MOVE THIS-PGM             TO PI-CALLING-PROGRAM
00448              MOVE 'EL102A'             TO PI-MAP-NAME
00449          ELSE
00450              MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
00451              MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
00452              MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
00453              MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
00454              MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
00455              MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
00456              MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
00457              MOVE SPACES               TO PI-SAVED-PROGRAM-6.
00458
00459      EJECT
00460      EXEC CICS HANDLE CONDITION
00461          NOTOPEN  (8870-NOTOPEN)
00462          NOTFND   (8880-NOT-FOUND)
00463          PGMIDERR (9600-PGMID-ERROR)
00464          ERROR    (9990-ABEND)
00465      END-EXEC.
00466
00467      MOVE PI-MAP-NAME TO MAP-NAME.
00468
00469      IF NOT SYSTEM-DISPLAY-CAP
00470         NEXT SENTENCE
00471       ELSE
00472      IF EIBTRNID NOT = TRANS-ID
00473          GO TO 7000-BUILD-INITIAL-MAP.
00474
00475      IF EIBAID = DFHCLEAR
00476          GO TO 9400-CLEAR.
00477
00478      IF NOT SYSTEM-DISPLAY-CAP
00479          MOVE 'READ'    TO SM-READ
00480          PERFORM 9995-SECURITY-VIOLATION
00481          MOVE ER-0070 TO EMI-ERROR
00482          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00483          GO TO 7000-BUILD-INITIAL-MAP.
00484
00485      EJECT
00486  0200-RECEIVE.
00487      MOVE LOW-VALUES TO EL102AI.
00488
00489      IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
00490          MOVE ER-0008 TO EMI-ERROR
00491          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00492          MOVE -1 TO COMPNMEL
00493          GO TO 8200-SEND-DATAONLY.
00494
00495      EXEC CICS RECEIVE
00496          MAP   (MAP-NAME)
00497          MAPSET(MAPSET-NAME)
00498          INTO  (EL102AI)
00499      END-EXEC.
00500
00501      IF PI-MAP-NAME = 'EL102A'
00502         GO TO 0290-MAP-A.
00503
00504      IF PI-MAP-NAME = 'EL102B'
00505         GO TO 0250-MAP-B.
00506
00507      IF PI-MAP-NAME = 'EL102C'
00508         GO TO 0260-MAP-C.
00509
00510      IF PI-MAP-NAME = 'EL102D'
00511         GO TO 0270-MAP-D.
00512
00513      IF PI-MAP-NAME = 'EL102E'
00514         GO TO 0280-MAP-E.
00515
00516  0250-MAP-B.
00517      IF ENTRBPFL = 0
00518          GO TO 0300-CHECK-PFKEYS.
00519
00520      IF EIBAID NOT = DFHENTER
00521          MOVE ER-0004 TO EMI-ERROR
00522          GO TO 0320-INPUT-ERROR.
00523
00524      IF (ENTRBPFI NUMERIC) AND (ENTRBPFI GREATER 0 AND LESS 25)
00525          MOVE PF-VALUES (ENTRBPFI) TO EIBAID
00526      ELSE
00527          MOVE ER-0029 TO EMI-ERROR
00528          GO TO 0320-INPUT-ERROR.
00529
00530      GO TO 0300-CHECK-PFKEYS.
00531
00532  0260-MAP-C.
00533      IF ENTRCPFL = 0
00534          GO TO 0300-CHECK-PFKEYS.
00535
00536      IF EIBAID NOT = DFHENTER
00537          MOVE ER-0004 TO EMI-ERROR
00538          GO TO 0320-INPUT-ERROR.
00539
00540      IF (ENTRCPFI NUMERIC) AND (ENTRCPFI GREATER 0 AND LESS 25)
00541          MOVE PF-VALUES (ENTRCPFI) TO EIBAID
00542      ELSE
00543          MOVE ER-0029 TO EMI-ERROR
00544          GO TO 0320-INPUT-ERROR.
00545
00546      GO TO 0300-CHECK-PFKEYS.
00547
00548  0270-MAP-D.
00549      IF ENTRDPFL = 0
00550          GO TO 0300-CHECK-PFKEYS.
00551
00552      IF EIBAID NOT = DFHENTER
00553          MOVE ER-0004 TO EMI-ERROR
00554          GO TO 0320-INPUT-ERROR.
00555
00556      IF (ENTRDPFI NUMERIC) AND (ENTRDPFI GREATER 0 AND LESS 25)
00557          MOVE PF-VALUES (ENTRDPFI) TO EIBAID
00558      ELSE
00559          MOVE ER-0029 TO EMI-ERROR
00560          GO TO 0320-INPUT-ERROR.
00561
00562      GO TO 0300-CHECK-PFKEYS.
00563
00564  0280-MAP-E.
00565      IF ENTREPFL = 0
00566          GO TO 0300-CHECK-PFKEYS.
00567
00568      IF EIBAID NOT = DFHENTER
00569          MOVE ER-0004 TO EMI-ERROR
00570          GO TO 0320-INPUT-ERROR.
00571
00572      IF (ENTREPFI NUMERIC) AND (ENTREPFI GREATER 0 AND LESS 25)
00573          MOVE PF-VALUES (ENTREPFI) TO EIBAID
00574      ELSE
00575          MOVE ER-0029 TO EMI-ERROR
00576          GO TO 0320-INPUT-ERROR.
00577
00578      GO TO 0300-CHECK-PFKEYS.
00579
00580  0290-MAP-A.
00581      IF ENTERPFL = 0
00582          GO TO 0300-CHECK-PFKEYS.
00583
00584      IF EIBAID NOT = DFHENTER
00585          MOVE ER-0004 TO EMI-ERROR
00586          GO TO 0320-INPUT-ERROR.
00587
00588      IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
00589          MOVE PF-VALUES (ENTERPFI) TO EIBAID
00590      ELSE
00591          MOVE ER-0029 TO EMI-ERROR
00592          GO TO 0320-INPUT-ERROR.
00593
00594      EJECT
00595  0300-CHECK-PFKEYS.
00596      IF EIBAID = DFHPF23
00597          GO TO 8810-PF23.
00598      IF EIBAID = DFHPF24
00599          GO TO 9200-RETURN-MAIN-MENU.
00600      IF EIBAID = DFHPF12
00601          GO TO 9500-PF12.
00602
00603      IF EIBAID = DFHENTER AND NOT SYSTEM-MODIFY-CAP
00604          MOVE 'UPDATE'  TO SM-READ
00605          PERFORM 9995-SECURITY-VIOLATION
00606          MOVE ER-0070 TO EMI-ERROR
00607          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00608          IF PI-MAP-NAME = 'EL102A'
00609             GO TO 7000-BUILD-INITIAL-MAP
00610          ELSE
00611          IF PI-MAP-NAME = 'EL102B'
00612             GO TO 7200-BUILD-INITIAL-MAP
00613          ELSE
00614          IF PI-MAP-NAME = 'EL102C'
00615             GO TO 7300-BUILD-INITIAL-MAP
00616          ELSE
00617          IF PI-MAP-NAME = 'EL102D'
00618             GO TO 7400-BUILD-INITIAL-MAP
00619          ELSE
00620             GO TO 7500-BUILD-INITIAL-MAP.
00621
00622      IF EIBAID = DFHENTER AND PI-MAP-NAME = 'EL102A'
00623          GO TO 0330-EDIT-DATA.
00624      IF EIBAID = DFHENTER AND PI-MAP-NAME = 'EL102B'
00625          GO TO 0530-EDIT-DATA.
00626      IF EIBAID = DFHENTER AND PI-MAP-NAME = 'EL102C'
00627          GO TO 0630-EDIT-DATA.
00628      IF EIBAID = DFHENTER AND PI-MAP-NAME = 'EL102D'
00629          GO TO 0730-EDIT-DATA.
00630      IF EIBAID = DFHENTER AND PI-MAP-NAME = 'EL102E'
00631          GO TO 0760-EDIT-DATA.
00632
00633      IF EIBAID = DFHPF1
00634         MOVE 'EL102A'   TO PI-MAP-NAME MAP-NAME
00635         GO TO 7000-BUILD-INITIAL-MAP.
00636
00637      IF EIBAID = DFHPF2
00638         MOVE 'EL102B'   TO PI-MAP-NAME MAP-NAME
00639         GO TO 7200-BUILD-INITIAL-MAP.
00640
00641      IF EIBAID = DFHPF3
00642         MOVE 'EL102C'   TO PI-MAP-NAME MAP-NAME
00643         GO TO 7300-BUILD-INITIAL-MAP.
00644
00645      IF EIBAID = DFHPF4
00646         MOVE 'EL102D'   TO PI-MAP-NAME MAP-NAME
00647         GO TO 7400-BUILD-INITIAL-MAP.
00648
00649      IF EIBAID = DFHPF5
00650         MOVE 'EL102E'   TO PI-MAP-NAME MAP-NAME
00651         GO TO 7500-BUILD-INITIAL-MAP.
00652
00653      MOVE ER-0029 TO EMI-ERROR.
00654  0320-INPUT-ERROR.
00655      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00656      MOVE AL-UNBON TO ENTERPFA.
00657      MOVE -1       TO ENTERPFL.
00658
00659      IF PI-MAP-NAME = 'EL102B'
00660         GO TO 8210-SEND-DATAONLY.
00661
00662      IF PI-MAP-NAME = 'EL102C'
00663         GO TO 8220-SEND-DATAONLY.
00664
00665      IF PI-MAP-NAME = 'EL102D'
00666         GO TO 8230-SEND-DATAONLY.
00667
00668      IF PI-MAP-NAME = 'EL102E'
00669         GO TO 8240-SEND-DATAONLY.
00670
00671      GO TO 8200-SEND-DATAONLY.
00672
00673      EJECT
00674  0330-EDIT-DATA.
00675 *    EDIT MAP A GENERAL DATA
00676
00677      IF ZIPCODEL NOT = ZERO
00678          MOVE AL-UANON               TO ZIPCODEA.
00679
00680      IF PHONEL NOT = ZERO
00681          MOVE PHONEI  TO DEEDIT-FIELD
00682          PERFORM 0800-DEEDIT THRU 0800-EXIT
00683          IF DEEDIT-FIELD-V0 GREATER 9999999999  OR
00684             DEEDIT-FIELD-V0 LESS    0000000000
00685              MOVE -1       TO PHONEL
00686              MOVE AL-UNBON TO PHONEA
00687              MOVE ER-0053  TO EMI-ERROR
00688              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00689          ELSE
00690              MOVE DEEDIT-FIELD       TO SV-PHONE
00691              MOVE AL-UNNON TO PHONEA.
00692
00693      IF JOURNIDL NOT = ZERO
00694         IF JOURNIDI GREATER 99
00695            MOVE ER-0451 TO EMI-ERROR
00696            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00697            MOVE -1 TO JOURNIDL
00698            MOVE AL-UNBON TO JOURNIDA
00699         ELSE
00700            MOVE AL-UNNON TO JOURNIDA.
00701
00702      IF SECOPTL NOT = ZERO
00703         IF SECOPTI NOT = '1' AND '2' AND '3' AND '4' AND '5'
00704             MOVE -1       TO SECOPTL
00705             MOVE AL-UABON TO SECOPTA
00706             MOVE ER-0055  TO EMI-ERROR
00707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00708          ELSE
00709             MOVE AL-UANON TO SECOPTA.
00710
00711      IF FPIDL NOT = ZERO
00712          MOVE FPIDI TO TERMINAL-TEST-AREA
00713          IF TERMINAL-TEST-AREA = SPACES
00714              MOVE AL-UANON TO FPIDA
00715          ELSE
00716              IF ' ' = TTA-1 OR TTA-2 OR TTA-3 OR TTA-4
00717                  MOVE -1       TO FPIDL
00718                  MOVE AL-UABON TO FPIDA
00719                  MOVE ER-0062  TO EMI-ERROR
00720                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00721              ELSE
00722                  MOVE AL-UANON TO FPIDA.
00723
00724      IF CPIDL NOT = ZERO
00725          MOVE CPIDI TO TERMINAL-TEST-AREA
00726          IF TERMINAL-TEST-AREA = SPACES
00727              MOVE AL-UANON TO CPIDA
00728          ELSE
00729              IF ' ' = TTA-1 OR TTA-2 OR TTA-3 OR TTA-4
00730                  MOVE -1       TO CPIDL
00731                  MOVE AL-UABON TO CPIDA
00732                  MOVE ER-0062  TO EMI-ERROR
00733                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00734              ELSE
00735                  MOVE AL-UANON TO CPIDA.
00736
00737      IF PASSWDL  GREATER ZERO
00738          MOVE SPACES TO  WS-SAVE-PASSWORD
00739          MOVE 'N'    TO  WS-PASSWORD-NUMERIC
00740          MOVE 'N'    TO  WS-PASSWORD-SIXDIGIT
00741          MOVE PASSWDI  TO  WS-SAVE-PASSWORD
00742          IF (WS-PASSWORD-X1 > SPACE) AND
00743             (WS-PASSWORD-X2 > SPACE) AND
00744             (WS-PASSWORD-X3 > SPACE) AND
00745             (WS-PASSWORD-X4 > SPACE) AND
00746             (WS-PASSWORD-X5 > SPACE) AND
00747             (WS-PASSWORD-X6 > SPACE)
00748             MOVE 'Y' TO  WS-PASSWORD-SIXDIGIT
00749          END-IF
00750          IF (WS-PASSWORD-N1  NUMERIC) OR
00751             (WS-PASSWORD-N2  NUMERIC) OR
00752             (WS-PASSWORD-N3  NUMERIC) OR
00753             (WS-PASSWORD-N4  NUMERIC) OR
00754             (WS-PASSWORD-N5  NUMERIC) OR
00755             (WS-PASSWORD-N6  NUMERIC) OR
00756             (WS-PASSWORD-N7  NUMERIC) OR
00757             (WS-PASSWORD-N8  NUMERIC)
00758             MOVE 'Y' TO  WS-PASSWORD-NUMERIC
00759          END-IF
00760          IF WS-PASSWORD-NUMERIC = 'N'  OR
00761             WS-PASSWORD-SIXDIGIT = 'N'
00762             MOVE -1             TO PASSWDL
00763             MOVE AL-UADON       TO PASSWDA
00764             MOVE ER-2549        TO EMI-ERROR
00765             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
00766          ELSE
00767             MOVE AL-UADON       TO PASSWDA.
00768
00769
00770      IF NEXTCOL NOT = ZERO
00771         IF PI-PROCESSOR-ID = 'LGXX' OR SYSTEM-MODIFY-CAP
00772            IF NEXTCOI NOT = ZERO
00773               MOVE CONTROL-FILE TO CONTROL-FILE-SAVE-AREA
00774               MOVE NEXTCOI TO WS-COMP-ID
00775               MOVE '1'     TO WS-TYPE
00776               PERFORM 1500-VERIFY-NEXT-COMPANY THRU 1599-EXIT
00777            ELSE
00778               MOVE -1       TO NEXTCOL
00779               MOVE AL-UABON TO NEXTCOA
00780               MOVE ER-0089  TO EMI-ERROR
00781               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00782         ELSE
00783            MOVE -1       TO NEXTCOL
00784            MOVE AL-UABON TO NEXTCOA
00785            MOVE ER-0070  TO EMI-ERROR
00786            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00787
00788      EXEC CICS HANDLE CONDITION
00789          NOTFND(8880-NOT-FOUND)
00790      END-EXEC.
00791
00792      IF CRSYSL NOT = ZERO
00793          IF CRSYSI NOT = 'N' AND 'Y'
00794              MOVE -1       TO CRSYSL
00795              MOVE AL-UNBON TO CRSYSA
00796              MOVE ER-2001  TO EMI-ERROR
00797              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00798          ELSE
00799              MOVE AL-UNNON TO CRSYSA
00800      ELSE
00801          MOVE ER-2565        TO EMI-ERROR
00802          MOVE -1             TO CRSYSL
00803          MOVE AL-UABON       TO CRSYSA
00804          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00805
00806      IF CLSYSL NOT = ZERO
00807          IF CLSYSI NOT = 'N' AND 'Y'
00808              MOVE -1       TO CLSYSL
00809              MOVE AL-UNBON TO CLSYSA
00810              MOVE ER-2001  TO EMI-ERROR
00811              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00812          ELSE
00813              MOVE AL-UNNON TO CLSYSA
00814      ELSE
00815          MOVE ER-2565        TO EMI-ERROR
00816          MOVE -1             TO CLSYSL
00817          MOVE AL-UABON       TO CLSYSA
00818          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00819
00820      IF MPSYSL NOT = ZERO
00821          IF MPSYSI  = 'N' OR 'Y'
00822              MOVE AL-UNNON TO MPSYSA
00823          ELSE
00824              MOVE -1       TO MPSYSL
00825              MOVE AL-UNBON TO MPSYSA
00826              MOVE ER-7219  TO EMI-ERROR
00827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00828
00829      IF CCSYSL NOT = ZERO
00830          IF CCSYSI  = 'N' OR 'Y'
00831              MOVE AL-UANON TO CCSYSA
00832          ELSE
00833              MOVE -1       TO CCSYSL
00834              MOVE AL-UABON TO CCSYSA
00835              MOVE ER-7228  TO EMI-ERROR
00836              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00837
00838      IF EUSYSL NOT = ZERO
00839          IF PI-PROCESSOR-ID = 'LGXX'
00840              IF EUSYSI = 'Y' OR 'N' OR ' '
00841                  MOVE AL-UANON TO EUSYSA
00842              ELSE
00843                  MOVE -1       TO EUSYSL
00844                  MOVE AL-UABON TO EUSYSA
00845                  MOVE ER-3736  TO EMI-ERROR
00846                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00847          ELSE
00848              MOVE -1       TO EUSYSL
00849              MOVE AL-UABON TO EUSYSA
00850              MOVE ER-0007  TO EMI-ERROR
00851              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00852
00853      IF LCCODEL NOT = ZERO
00854          IF LCCODEI = 'N' OR 'Y' OR ' '
00855              MOVE AL-UANON TO LCCODEA
00856          ELSE
00857              MOVE -1       TO LCCODEL
00858              MOVE AL-UABON TO LCCODEA
00859              MOVE ER-7229  TO EMI-ERROR
00860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00861
00862      IF ARSYSL NOT = ZERO
00863          IF PI-PROCESSOR-ID = 'LGXX'
00864              IF ARSYSI = 'Y' OR 'N' OR ' '
00865                  MOVE AL-UANON TO ARSYSA
00866              ELSE
00867                  MOVE -1       TO ARSYSL
00868                  MOVE AL-UABON TO ARSYSA
00869                  MOVE ER-0633  TO EMI-ERROR
00870                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00871          ELSE
00872              MOVE -1       TO ARSYSL
00873              MOVE AL-UABON TO ARSYSA
00874              MOVE ER-3143  TO EMI-ERROR
00875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00876
00877      IF PI-PROCESSOR-ID = 'LGXX'
00878          IF LFOVR1L NOT = ZERO
00879              IF LFOVR1I NOT = SPACES
00880                  MOVE AL-UNNON TO LFOVR1A
00881              ELSE
00882                  MOVE -1       TO LFOVR1L
00883                  MOVE AL-UNBON TO LFOVR1A
00884                  MOVE ER-2610  TO EMI-ERROR
00885                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00886
00887      IF PI-PROCESSOR-ID = 'LGXX'
00888          IF LFOVR2L NOT = ZERO
00889              IF LFOVR2I NOT = SPACES
00890                  MOVE AL-UNNON TO LFOVR2A
00891              ELSE
00892                  MOVE -1       TO LFOVR2L
00893                  MOVE AL-UNBON TO LFOVR2A
00894                  MOVE ER-2610  TO EMI-ERROR
00895                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00896
00897      IF PI-PROCESSOR-ID = 'LGXX'
00898          IF LFOVR6L NOT = ZERO
00899              IF LFOVR6I NOT = SPACES
00900                  MOVE AL-UNNON TO LFOVR6A
00901              ELSE
00902                  MOVE -1       TO LFOVR6L
00903                  MOVE AL-UNBON TO LFOVR6A
00904                  MOVE ER-2610  TO EMI-ERROR
00905                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00906
00907      IF PI-PROCESSOR-ID = 'LGXX'
00908          IF LFOVR12L NOT = ZERO
00909              IF LFOVR12I NOT = SPACES
00910                  MOVE AL-UNNON TO LFOVR12A
00911              ELSE
00912                  MOVE -1       TO LFOVR12L
00913                  MOVE AL-UNBON TO LFOVR12A
00914                  MOVE ER-2610  TO EMI-ERROR
00915                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00916
00917      IF PI-PROCESSOR-ID = 'LGXX'
00918          IF AHOVR1L NOT = ZERO
00919              IF AHOVR1I NOT = SPACES
00920                  MOVE AL-UNNON TO AHOVR1A
00921              ELSE
00922                  MOVE -1       TO AHOVR1L
00923                  MOVE AL-UNBON TO AHOVR1A
00924                  MOVE ER-2610  TO EMI-ERROR
00925                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00926
00927      IF PI-PROCESSOR-ID = 'LGXX'
00928          IF AHOVR2L NOT = ZERO
00929              IF AHOVR2I NOT = SPACES
00930                  MOVE AL-UNNON TO AHOVR2A
00931              ELSE
00932                  MOVE -1       TO AHOVR2L
00933                  MOVE AL-UNBON TO AHOVR2A
00934                  MOVE ER-2610  TO EMI-ERROR
00935                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00936
00937      IF PI-PROCESSOR-ID = 'LGXX'
00938          IF AHOVR6L NOT = ZERO
00939              IF AHOVR6I NOT = SPACES
00940                  MOVE AL-UNNON TO AHOVR6A
00941              ELSE
00942                  MOVE -1       TO AHOVR6L
00943                  MOVE AL-UNBON TO AHOVR6A
00944                  MOVE ER-2610  TO EMI-ERROR
00945                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00946
00947      IF PI-PROCESSOR-ID = 'LGXX'
00948          IF AHOVR12L NOT = ZERO
00949              IF AHOVR12I NOT = SPACES
00950                  MOVE AL-UNNON TO AHOVR12A
00951              ELSE
00952                  MOVE -1       TO AHOVR12L
00953                  MOVE AL-UNBON TO AHOVR12A
00954                  MOVE ER-2610  TO EMI-ERROR
00955                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00956
00957      IF CLSYSI = 'Y'
00958          MOVE AL-UNNON TO CURRMEA
00959          MOVE AL-SABOF TO CURRMEDA
00960      ELSE
00961          MOVE AL-SADOF TO CURRMEA
00962                           CURRMEDA
00963          GO TO 0350-EDIT-CREDIT-MONTH-END.
00964
00965      IF CURRMEL = ZERO
00966         GO TO 0340-DAY-ERROR.
00967
00968      MOVE AL-UNNON     TO CURRMEA.
00969      MOVE AL-SABOF     TO CURRMEDA.
00970      MOVE CURRMEI      TO DEEDIT-FIELD.
00971      PERFORM 0800-DEEDIT THRU 0800-EXIT.
00972      MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY.
00973      MOVE '4'          TO DC-OPTION-CODE.
00974      MOVE LINK-ELDATCV TO PGM-NAME.
00975      EXEC CICS LINK
00976           PROGRAM (PGM-NAME)
00977           COMMAREA(DATE-CONVERSION-DATA)
00978           LENGTH  (DC-COMM-LENGTH)
00979      END-EXEC.
00980
00981      IF DATE-CONVERSION-ERROR
00982         GO TO 0340-DAY-ERROR.
00983
00984      MOVE DC-BIN-DATE-1          TO WS-SAVE-CURRMEDT.
00985      MOVE DC-GREG-DATE-1-EDIT    TO CURRMEI.
00986      MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
00987
00988      IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
00989         GO TO 0350-EDIT-CREDIT-MONTH-END.
00990
00991  0340-DAY-ERROR.
00992      MOVE -1       TO CURRMEL.
00993      MOVE AL-UABON TO CURRMEA.
00994      MOVE ER-0340  TO EMI-ERROR.
00995      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00996
00997  0350-EDIT-CREDIT-MONTH-END.
00998      IF CRSYSI = 'Y'
00999          MOVE AL-UNNON TO CREDMEA
01000          MOVE AL-SABOF TO CREDMEDA
01001      ELSE
01002          MOVE AL-SADOF TO CREDMEA
01003                           CREDMEDA
01004          GO TO 0375-EDIT-MORTGAGE-MONTH-END.
01005
01006      IF CREDMEL = ZERO
01007         GO TO 0370-DAY-ERROR.
01008
01009      MOVE AL-UNNON     TO CREDMEA.
01010      MOVE AL-SABOF     TO CREDMEDA.
01011      MOVE CREDMEI      TO DEEDIT-FIELD.
01012      PERFORM 0800-DEEDIT THRU 0800-EXIT.
01013      MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY.
01014      MOVE '4'          TO DC-OPTION-CODE.
01015      MOVE LINK-ELDATCV TO PGM-NAME.
01016      EXEC CICS LINK
01017           PROGRAM (PGM-NAME)
01018           COMMAREA(DATE-CONVERSION-DATA)
01019           LENGTH  (DC-COMM-LENGTH)
01020      END-EXEC.
01021
01022      IF DATE-CONVERSION-ERROR
01023          GO TO 0370-DAY-ERROR.
01024
01025      MOVE DC-BIN-DATE-1          TO WS-SAVE-CREDMEDT.
01026      MOVE DC-GREG-DATE-1-EDIT    TO CREDMEI.
01027      MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
01028      IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
01029         GO TO 0375-EDIT-MORTGAGE-MONTH-END.
01030
01031  0370-DAY-ERROR.
01032      MOVE -1       TO CREDMEL.
01033      MOVE AL-UABON TO CREDMEA.
01034      MOVE ER-0587  TO EMI-ERROR.
01035      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01036
01037  0375-EDIT-MORTGAGE-MONTH-END.
01038
01039      IF MORTMEL = ZERO
01040         GO TO 0395-EDIT-AR-MONTH-END.
01041
01042      IF MPSYSI = 'Y'
01043          MOVE AL-UNNON TO MORTMEA
01044          MOVE AL-SABOF TO MORTMEDA
01045      ELSE
01046          MOVE AL-SADOF TO MORTMEA
01047                           MORTMEDA
01048          GO TO 0395-EDIT-AR-MONTH-END.
01049
01050      MOVE AL-UNNON     TO MORTMEA.
01051      MOVE AL-SABOF     TO MORTMEDA.
01052      MOVE MORTMEI      TO DEEDIT-FIELD.
01053      PERFORM 0800-DEEDIT THRU 0800-EXIT.
01054      MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY.
01055      MOVE '4'          TO DC-OPTION-CODE.
01056      MOVE LINK-ELDATCV TO PGM-NAME.
01057      EXEC CICS LINK
01058           PROGRAM (PGM-NAME)
01059           COMMAREA(DATE-CONVERSION-DATA)
01060           LENGTH  (DC-COMM-LENGTH)
01061      END-EXEC.
01062
01063      IF DATE-CONVERSION-ERROR
01064         GO TO 0380-DAY-ERROR.
01065
01066      MOVE DC-BIN-DATE-1          TO WS-SAVE-MORTMEDT.
01067      MOVE DC-GREG-DATE-1-EDIT    TO MORTMEI.
01068      MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
01069
01070      IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
01071         GO TO 0395-EDIT-AR-MONTH-END.
01072
01073  0380-DAY-ERROR.
01074      MOVE -1       TO MORTMEL.
01075      MOVE AL-UABON TO MORTMEA.
01076      MOVE ER-9001  TO EMI-ERROR.
01077      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01078
01079  0395-EDIT-AR-MONTH-END.
01080      IF PI-PROCESSOR-ID = 'LGXX' AND
01081         (PI-AR-PROCESSING OR ARSYSI = 'Y')
01082          MOVE AL-UNNON TO ARMEA
01083          MOVE AL-SABOF TO ARMEDA
01084          MOVE AL-UNNON TO AR860DTA
01085      ELSE
01086          MOVE AL-SADOF TO ARMEA
01087                           ARMEDA
01088                           AR860DTA
01089          GO TO 0400-EDIT-DATA-CONTINUE.
01090
01091      IF AR860DTL = ZERO
01092         NEXT SENTENCE
01093      ELSE
01094          MOVE AR860DTI     TO DEEDIT-FIELD
01095          PERFORM 0800-DEEDIT THRU 0800-EXIT
01096          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
01097          MOVE '4'          TO DC-OPTION-CODE
01098          MOVE LINK-ELDATCV TO PGM-NAME
01099          EXEC CICS LINK
01100               PROGRAM (PGM-NAME)
01101               COMMAREA(DATE-CONVERSION-DATA)
01102               LENGTH  (DC-COMM-LENGTH)
01103          END-EXEC
01104          IF DATE-CONVERSION-ERROR
01105              MOVE -1       TO AR860DTL
01106              MOVE AL-UABON TO AR860DTA
01107              MOVE ER-3187  TO EMI-ERROR
01108              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01109              GO TO 0400-EDIT-DATA-CONTINUE
01110          ELSE
01111              MOVE DC-BIN-DATE-1          TO WS-SAVE-AR860DT
01112              MOVE DC-GREG-DATE-1-EDIT    TO AR860DTI.
01113
01114      IF ARMEL = ZERO
01115         GO TO 0397-DAY-ERROR.
01116
01117      MOVE AL-UNNON     TO ARMEA.
01118      MOVE AL-SABOF     TO ARMEDA.
01119      MOVE AL-SANOF     TO AR860DTA.
01120      MOVE ARMEI        TO DEEDIT-FIELD.
01121      PERFORM 0800-DEEDIT THRU 0800-EXIT.
01122      MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY.
01123      MOVE '4'          TO DC-OPTION-CODE.
01124      MOVE LINK-ELDATCV TO PGM-NAME.
01125      EXEC CICS LINK
01126           PROGRAM (PGM-NAME)
01127           COMMAREA(DATE-CONVERSION-DATA)
01128           LENGTH  (DC-COMM-LENGTH)
01129      END-EXEC.
01130
01131      IF DATE-CONVERSION-ERROR
01132         GO TO 0397-DAY-ERROR.
01133
01134      MOVE DC-BIN-DATE-1          TO WS-SAVE-ARMEDT.
01135      MOVE DC-GREG-DATE-1-EDIT    TO ARMEI.
01136      MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
01137
01138      IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
01139         GO TO 0400-EDIT-DATA-CONTINUE.
01140
01141  0397-DAY-ERROR.
01142      MOVE -1       TO ARMEL.
01143      MOVE AL-UABON TO ARMEA.
01144      MOVE ER-3156  TO EMI-ERROR.
01145      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01146
01147  0400-EDIT-DATA-CONTINUE.
01148
01149      IF EMI-NO-ERRORS
01150          GO TO 1000-UPDATE-FILE.
01151
01152      GO TO 8200-SEND-DATAONLY.
01153
01154      EJECT
01155  0530-EDIT-DATA.
01156 *    EDIT EL102 MAP B CLAIM DATA
01157
01158      IF APPROVL NOT = +0
01159          IF APPROVI NOT = 'N' AND 'Y' AND 'G'
01160              MOVE -1       TO APPROVL
01161              MOVE AL-UABON TO APPROVA
01162              MOVE ER-1888  TO EMI-ERROR
01163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01164          ELSE
01165              MOVE AL-UANON TO APPROVA.
01166
01167      IF  LLEV1L NOT = ZERO
01168          MOVE LLEV1I              TO DEEDIT-FIELD
01169          PERFORM 0800-DEEDIT THRU 0800-EXIT
01170          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01171              MOVE -1               TO LLEV1L
01172              MOVE AL-UNBON         TO LLEV1A
01173              MOVE ER-1890          TO EMI-ERROR
01174              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01175          ELSE
01176              IF  DEEDIT-FIELD-V0 = ZEROS
01177                      AND
01178                  APPROVI = 'G'
01179                  MOVE -1           TO LLEV1L
01180                  MOVE AL-UNBON     TO LLEV1A
01181                  MOVE ER-1890      TO EMI-ERROR
01182                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01183              ELSE
01184                  MOVE DEEDIT-FIELD-V0
01185                                    TO SV-LLEV1
01186                                       LLEV1O
01187                  MOVE AL-UNNON     TO LLEV1A
01188      ELSE
01189          IF  APPROVI = 'G'
01190              MOVE -1               TO LLEV1L
01191              MOVE AL-UNBON         TO LLEV1A
01192              MOVE ER-1887          TO EMI-ERROR
01193              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01194
01195      IF  LLEV2L NOT = ZERO
01196          MOVE LLEV2I               TO DEEDIT-FIELD
01197          PERFORM 0800-DEEDIT THRU 0800-EXIT
01198          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01199              MOVE -1               TO LLEV2L
01200              MOVE AL-UNBON         TO LLEV2A
01201              MOVE ER-1890          TO EMI-ERROR
01202              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01203          ELSE
01204              IF  DEEDIT-FIELD-V0 = ZEROS
01205                      AND
01206                  APPROVI = 'G'
01207                  MOVE -1           TO LLEV2L
01208                  MOVE AL-UNBON     TO LLEV2A
01209                  MOVE ER-1890      TO EMI-ERROR
01210                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01211
01212              ELSE
01213                  MOVE DEEDIT-FIELD-V0
01214                                    TO SV-LLEV2
01215                                       LLEV2O
01216                  MOVE AL-UNNON     TO LLEV2A
01217      ELSE
01218          IF  APPROVI = 'G'
01219              MOVE -1               TO LLEV2L
01220              MOVE AL-UNBON         TO LLEV2A
01221              MOVE ER-1887          TO EMI-ERROR
01222              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01223
01224      IF  LLEV3L NOT = ZERO
01225          MOVE LLEV3I               TO DEEDIT-FIELD
01226          PERFORM 0800-DEEDIT THRU 0800-EXIT
01227          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01228              MOVE -1               TO LLEV3L
01229              MOVE AL-UNBON         TO LLEV3A
01230              MOVE ER-1890          TO EMI-ERROR
01231              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01232          ELSE
01233              IF  DEEDIT-FIELD-V0 = ZEROS
01234                      AND
01235                  APPROVI = 'G'
01236                  MOVE -1           TO LLEV3L
01237                  MOVE AL-UNBON     TO LLEV3A
01238                  MOVE ER-1890      TO EMI-ERROR
01239                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01240
01241              ELSE
01242                  MOVE DEEDIT-FIELD-V0
01243                                    TO SV-LLEV3
01244                                       LLEV3O
01245                  MOVE AL-UNNON     TO LLEV3A
01246      ELSE
01247          IF  APPROVI = 'G'
01248              MOVE -1               TO LLEV3L
01249              MOVE AL-UNBON         TO LLEV3A
01250              MOVE ER-1887          TO EMI-ERROR
01251              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01252
01253      IF  ALEV1L NOT = ZERO
01254          MOVE ALEV1I              TO DEEDIT-FIELD
01255          PERFORM 0800-DEEDIT THRU 0800-EXIT
01256          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01257              MOVE -1              TO ALEV1L
01258              MOVE AL-UNBON        TO ALEV1A
01259              MOVE ER-1890         TO EMI-ERROR
01260              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01261          ELSE
01262              IF  DEEDIT-FIELD-V0 = ZEROS
01263                      AND
01264                  APPROVI = 'G'
01265                  MOVE -1           TO ALEV1L
01266                  MOVE AL-UNBON     TO ALEV1A
01267                  MOVE ER-1890      TO EMI-ERROR
01268                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01269
01270              ELSE
01271                  MOVE DEEDIT-FIELD-V0
01272                                    TO SV-ALEV1
01273                                       ALEV1O
01274                  MOVE AL-UNNON     TO ALEV1A
01275      ELSE
01276          IF  APPROVI = 'G'
01277              MOVE -1              TO ALEV1L
01278              MOVE AL-UNBON        TO ALEV1A
01279              MOVE ER-1887         TO EMI-ERROR
01280              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01281
01282      IF  ALEV2L NOT = ZERO
01283          MOVE ALEV2I              TO DEEDIT-FIELD
01284          PERFORM 0800-DEEDIT THRU 0800-EXIT
01285          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01286              MOVE -1              TO ALEV2L
01287              MOVE AL-UNBON        TO ALEV2A
01288              MOVE ER-1890         TO EMI-ERROR
01289              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01290          ELSE
01291              IF  DEEDIT-FIELD-V0 = ZEROS
01292                      AND
01293                  APPROVI = 'G'
01294                  MOVE -1           TO ALEV2L
01295                  MOVE AL-UNBON     TO ALEV2A
01296                  MOVE ER-1890      TO EMI-ERROR
01297                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01298
01299              ELSE
01300                  MOVE DEEDIT-FIELD-V0
01301                                    TO SV-ALEV2
01302                                       ALEV2O
01303                  MOVE AL-UNNON     TO ALEV2A
01304      ELSE
01305          IF  APPROVI = 'G'
01306              MOVE -1              TO ALEV2L
01307              MOVE AL-UNBON        TO ALEV2A
01308              MOVE ER-1887         TO EMI-ERROR
01309              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01310
01311      IF  ALEV3L NOT = ZERO
01312          MOVE ALEV3I              TO DEEDIT-FIELD
01313          PERFORM 0800-DEEDIT THRU 0800-EXIT
01314          IF  DEEDIT-FIELD-V0 NOT NUMERIC
01315              MOVE -1              TO ALEV3L
01316              MOVE AL-UNBON        TO ALEV3A
01317              MOVE ER-1890         TO EMI-ERROR
01318              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01319          ELSE
01320              IF  DEEDIT-FIELD-V0 = ZEROS
01321                      AND
01322                  APPROVI = 'G'
01323                  MOVE -1           TO ALEV3L
01324                  MOVE AL-UNBON     TO ALEV3A
01325                  MOVE ER-1890      TO EMI-ERROR
01326                  PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
01327
01328              ELSE
01329                  MOVE DEEDIT-FIELD-V0
01330                                    TO SV-ALEV3
01331                                       ALEV3O
01332                  MOVE AL-UNNON     TO ALEV3A
01333      ELSE
01334          IF  APPROVI = 'G'
01335              MOVE -1              TO ALEV3L
01336              MOVE AL-UNBON        TO ALEV3A
01337              MOVE ER-1887         TO EMI-ERROR
01338              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01339
01340  0535-CK-PROC.
01341      IF PI-PROCESSOR-ID = 'LGXX'
01342          IF LSTCLML NOT = ZERO
01343              IF LSTCLMI NOT NUMERIC
01344                  MOVE -1       TO LSTCLML
01345                  MOVE AL-UNBON TO LSTCLMA
01346                  MOVE ER-0610  TO EMI-ERROR
01347                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01348              ELSE
01349                  MOVE AL-UNNON               TO LSTCLMA.
01350
01351      IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
01352          IF LSTARCHL NOT = ZERO
01353              IF LSTARCHI NOT NUMERIC
01354                  MOVE -1       TO LSTARCHL
01355                  MOVE AL-UNBON TO LSTARCHA
01356                  MOVE ER-0611  TO EMI-ERROR
01357                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01358              ELSE
01359                  MOVE AL-UNNON               TO LSTARCHA.
01360
01361      IF PI-PROCESSOR-ID = 'LGXX'
01362          IF LSTCHKL NOT = ZERO
01363              IF LSTCHKI NOT NUMERIC
01364                  MOVE -1       TO LSTCHKL
01365                  MOVE AL-UNBON TO LSTCHKA
01366                  MOVE ER-0612  TO EMI-ERROR
01367                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01368              ELSE
01369                  MOVE AL-UNNON               TO LSTCHKA.
01370
01371      IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
01372          IF STARCHL NOT = ZERO
01373              IF STARCHI NOT NUMERIC
01374                  MOVE -1       TO STARCHL
01375                  MOVE AL-UNBON TO STARCHA
01376                  MOVE ER-0611  TO EMI-ERROR
01377                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01378              ELSE
01379                  MOVE AL-UNNON               TO STARCHA.
01380
01381      IF CLMTOLL NOT = ZERO
01382          EXEC CICS BIF
01383              DEEDIT
01384              FIELD (CLMTOLI)
01385              LENGTH(5)
01386          END-EXEC
01387          IF CLMTOLI NOT NUMERIC
01388              MOVE -1               TO CLMTOLL
01389              MOVE AL-UNBON         TO CLMTOLA
01390              MOVE ER-0496          TO EMI-ERROR
01391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01392            ELSE
01393              MOVE CLMTOLI          TO SV-CLMTOL
01394                                       CLMTOLO
01395              MOVE AL-UNNON         TO CLMTOLA.
01396
01397      IF PI-PROCESSOR-ID = 'LGXX'
01398          IF LSTQUEL NOT = ZERO
01399              IF LSTQUEI NOT NUMERIC
01400                  MOVE -1       TO LSTQUEL
01401                  MOVE AL-UNBON TO LSTQUEA
01402                  MOVE ER-0613  TO EMI-ERROR
01403                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01404              ELSE
01405                  MOVE AL-UNNON               TO LSTQUEA.
01406
01407      IF CLMREJL NOT = ZERO
01408          IF CLMREJI NOT = '1' AND ' '
01409              MOVE -1       TO CLMREJL
01410              MOVE AL-UABON TO CLMREJA
01411              MOVE ER-2024  TO EMI-ERROR
01412              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01413          ELSE
01414              MOVE AL-UANON TO CLMREJA.
01415
01416      IF PMTSCHKL GREATER THAN +0
01417         IF PMTSCHKI NUMERIC
01418            NEXT SENTENCE
01419         ELSE
01420            MOVE -1       TO PMTSCHKL
01421            MOVE AL-UNBON TO PMTSCHKA
01422            MOVE ER-0631  TO EMI-ERROR
01423            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01424
01425      IF THRUTOL GREATER THAN +0
01426         IF THRUTOI = '1' OR ' '
01427            NEXT SENTENCE
01428         ELSE
01429            MOVE -1       TO THRUTOL
01430            MOVE AL-UNBON TO THRUTOA
01431            MOVE ER-0634  TO EMI-ERROR
01432            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01433
01434      IF ADDRLBLL IS GREATER THAN +0
01435          IF ADDRLBLI NOT = ' ' AND 'Y' AND 'N'
01436              MOVE -1             TO  ADDRLBLL
01437              MOVE AL-UABON       TO  ADDRLBLA
01438              MOVE ER-0680        TO  EMI-ERROR
01439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01440          ELSE
01441              MOVE AL-UANON       TO  ADDRLBLA.
01442
01443      IF RECONL IS GREATER THAN +0
01444          IF (RECONI NOT = ' ' AND 'Y' AND 'N')
01445              MOVE ER-0762        TO  EMI-ERROR
01446              MOVE -1             TO  RECONL
01447              MOVE AL-UABON       TO  RECONA
01448              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01449          ELSE
01450              MOVE AL-UANON       TO  RECONA.
01451
01452      IF PI-PROCESSOR-ID = 'LGXX'
01453          IF PROCDTL NOT = ZERO
01454              MOVE PROCDTI        TO  DEEDIT-FIELD
01455              PERFORM 0800-DEEDIT THRU 0800-EXIT
01456              MOVE DEEDIT-FIELD   TO  DC-GREG-DATE-1-MDY
01457              MOVE '4'            TO  DC-OPTION-CODE
01458              PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
01459              IF NO-CONVERSION-ERROR
01460                  MOVE DC-GREG-DATE-1-EDIT
01461                                  TO  PROCDTI
01462                  MOVE DC-BIN-DATE-1  TO  WS-SAVE-PROCDT
01463              ELSE
01464                  MOVE ER-0021    TO  EMI-ERROR
01465                  MOVE -1         TO  PROCDTL
01466                  MOVE AL-UABON   TO  PROCDTA
01467                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01468
01469      MOVE LOW-VALUES TO WS-SAVE-COFFDTE.
01470
01471      IF COFFDTL EQUAL +0
01472         GO TO 0530-MAPB.
01473
01474      MOVE COFFDTI      TO DEEDIT-FIELD.
01475      PERFORM 0800-DEEDIT THRU 0800-EXIT.
01476
01477      IF DEEDIT-FIELD EQUAL ZEROS
01478         MOVE LOW-VALUES TO WS-SAVE-COFFDTE
01479         MOVE SPACES TO COFFDTI
01480         GO TO 0530-MAPB.
01481
01482      MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY.
01483      MOVE '4'          TO DC-OPTION-CODE.
01484      PERFORM 8000-CONVERT-DATE.
01485
01486      IF DATE-CONVERSION-ERROR
01487         MOVE -1       TO COFFDTL
01488         MOVE AL-UABON TO COFFDTA
01489         MOVE ER-0314  TO EMI-ERROR
01490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01491         GO TO 0530-MAPB.
01492
01493      MOVE DC-BIN-DATE-1          TO WS-SAVE-COFFDTE.
01494      MOVE DC-GREG-DATE-1-EDIT    TO COFFDTI.
01495
01496  0530-MAPB.
01497      IF  EXPRETNL GREATER THAN +0
01498          IF  EXPRETNI NOT NUMERIC
01499                  OR
01500              EXPRETNI LESS THAN 1
01501                  OR
01502              EXPRETNI GREATER THAN 6
01503              MOVE -1             TO  EXPRETNL
01504              MOVE AL-UABON       TO  EXPRETNA
01505              MOVE ER-7744        TO  EMI-ERROR
01506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01507          ELSE
01508              MOVE EXPRETNI       TO  W-EXPRETN
01509                                      EXPRETNO
01510              MOVE AL-UNNON       TO  EXPRETNA.
01511
01512      IF  RSVOPSWL NOT = ZERO
01513              AND
01514          RSVOPSWI NOT EQUAL PI-OPTIONAL-RESERVE-SW
01515
01516          IF  PI-PROCESSOR-ID NOT = 'LHJ '
01517              MOVE 'N'            TO RSVOPSWI
01518              MOVE -1             TO RSVOPSWL
01519              MOVE AL-UABON       TO RSVOPSWA
01520              MOVE ER-7720        TO EMI-ERROR
01521              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01522
01523          ELSE
01524              IF  RSVOPSWI EQUAL 'Y' OR 'N'
01525                  MOVE AL-UANON   TO RSVOPSWA
01526                  MOVE RSVOPSWI   TO PI-OPTIONAL-RESERVE-SW
01527
01528              ELSE
01529                  MOVE -1         TO RSVOPSWL
01530                  MOVE AL-UABON   TO RSVOPSWA
01531                  MOVE ER-7721    TO EMI-ERROR
01532                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01533
01534      IF  PI-OPTIONAL-RESERVE-SW EQUAL 'N'
01535          MOVE -1                 TO RSVOPSWL
01536          MOVE AL-UABON           TO RSVOPSWA
01537          MOVE ER-7724            TO EMI-ERROR
01538          MOVE ZEROS              TO IBLGMTHO
01539                                     W-IBLGMTH
01540                                     CIDADISO
01541                                     W-CIDADIS
01542                                     CALCINTO
01543                                     W-CALCINT
01544                                     IBNRLFFO
01545                                     W-IBNRAHF
01546                                     IBNRAHFO
01547                                     W-IBNRAHF
01548          MOVE LOW-VALUES         TO CRDTBLUO
01549                                     OPTDTEO
01550                                     W-OPTDTE
01551          MOVE AL-UNNON           TO CALCINTA
01552                                     CIDADISA
01553                                     IBLGMTHA
01554                                     IBNRAHFA
01555                                     IBNRLFFA
01556          MOVE AL-UANON           TO RSVOPSWA
01557                                     CRDTBLUA
01558                                     OPTDTEA
01559          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01560          GO TO 0530-SCRNB-CONT.
01561
01562      IF  OPTDTEL GREATER THAN +0
01563          MOVE LOW-VALUES         TO W-OPTDTE
01564          EXEC CICS BIF
01565               DEEDIT
01566               FIELD  (OPTDTEI)
01567               LENGTH (08)
01568          END-EXEC
01569
01570          IF  OPTDTEI NUMERIC
01571
01572              IF  OPTDTEI EQUAL ZEROS
01573                  MOVE SPACES     TO OPTDTEI
01574
01575              ELSE
01576                  MOVE OPTDTEI    TO DC-GREG-DATE-1-MDY
01577                  MOVE '4'        TO DC-OPTION-CODE
01578                  PERFORM 8000-CONVERT-DATE
01579
01580                  IF  DATE-CONVERSION-ERROR
01581                      MOVE -1     TO OPTDTEL
01582                      MOVE AL-UABON
01583                                  TO OPTDTEA
01584                      MOVE ER-7740
01585                                  TO EMI-ERROR
01586                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01587
01588                  ELSE
01589                      MOVE DC-BIN-DATE-1
01590                                  TO W-OPTDTE
01591                      MOVE DC-GREG-DATE-1-EDIT
01592                                  TO OPTDTEO
01593                      MOVE AL-UANON
01594                                  TO OPTDTEA
01595
01596          ELSE
01597              MOVE -1             TO OPTDTEL
01598              MOVE AL-UABON       TO OPTDTEA
01599              MOVE ER-7740        TO EMI-ERROR
01600              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01601
01602      IF  CIDADISL GREATER THAN ZEROS
01603          MOVE ZERO               TO W-CIDADIS
01604          EXEC CICS BIF
01605               DEEDIT
01606               FIELD  (CIDADISI)
01607               LENGTH (06)
01608          END-EXEC
01609
01610          IF  CIDADISI NUMERIC
01611              MOVE AL-UNNON       TO CIDADISA
01612              MOVE CIDADISI       TO W-CIDADIS
01613                                     CIDADISO
01614
01615          ELSE
01616              MOVE ZEROS          TO W-CIDADIS
01617              MOVE -1             TO CIDADISL
01618              MOVE AL-UABON       TO CIDADISA
01619              MOVE ER-7723        TO EMI-ERROR
01620              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01621
01622      IF  CRDTBLUL GREATER THAN ZEROS
01623          PERFORM 0560-CHECK-TABLE THRU 0560-EXIT.
01624
01625      IF  IBNRLFFL GREATER THAN ZEROS
01626          MOVE ZERO               TO W-IBNRLFF
01627          EXEC CICS BIF
01628               DEEDIT
01629               FIELD  (IBNRLFFI)
01630               LENGTH (06)
01631          END-EXEC
01632
01633          IF  IBNRLFFI NUMERIC
01634              MOVE AL-UNNON       TO IBNRLFFA
01635              MOVE IBNRLFFI       TO W-IBNRLFF
01636                                     IBNRLFFO
01637
01638          ELSE
01639              MOVE ZEROS          TO W-IBNRLFF
01640              MOVE -1             TO IBNRLFFL
01641              MOVE AL-UABON       TO IBNRLFFA
01642              MOVE ER-7742        TO EMI-ERROR
01643              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01644
01645      IF  IBNRAHFL GREATER THAN ZEROS
01646          MOVE ZERO               TO W-IBNRAHF
01647          EXEC CICS BIF
01648               DEEDIT
01649               FIELD  (IBNRAHFI)
01650               LENGTH (06)
01651          END-EXEC
01652
01653          IF  IBNRAHFI NUMERIC
01654              MOVE AL-UNNON       TO IBNRAHFA
01655              MOVE IBNRAHFI       TO W-IBNRAHF
01656                                     IBNRAHFO
01657
01658          ELSE
01659              MOVE ZEROS          TO W-IBNRAHF
01660              MOVE -1             TO IBNRAHFL
01661              MOVE AL-UABON       TO IBNRAHFA
01662              MOVE ER-7741        TO EMI-ERROR
01663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01664
01665      IF  IBLGMTHL GREATER THAN ZEROS
01666          MOVE ZERO               TO W-IBLGMTH
01667          EXEC CICS BIF
01668               DEEDIT
01669               FIELD  (IBLGMTHI)
01670               LENGTH (03)
01671          END-EXEC
01672
01673          IF  IBLGMTHI NUMERIC
01674              MOVE AL-UNNON       TO IBLGMTHA
01675              MOVE IBLGMTHI       TO W-IBLGMTH
01676                                     IBLGMTHO
01677
01678          ELSE
01679              MOVE ZEROS          TO W-IBLGMTH
01680              MOVE -1             TO IBLGMTHL
01681              MOVE AL-UABON       TO IBLGMTHA
01682              MOVE ER-7722        TO EMI-ERROR
01683              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01684
01685      IF  CALCINTL GREATER THAN ZEROS
01686          MOVE ZERO               TO W-CALCINT
01687          EXEC CICS BIF
01688               DEEDIT
01689               FIELD  (CALCINTI)
01690               LENGTH (06)
01691          END-EXEC
01692
01693          IF  CALCINTI NUMERIC
01694              MOVE AL-UNNON       TO CALCINTA
01695              MOVE CALCINTI       TO W-CALCINT
01696                                     CALCINTO
01697
01698          ELSE
01699              MOVE ZEROS          TO W-CALCINT
01700              MOVE -1             TO CALCINTL
01701              MOVE AL-UABON       TO CALCINTA
01702              MOVE ER-7735        TO EMI-ERROR
01703              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01704
01705  0530-SCRNB-CONT.
01706
01707      IF EMI-NO-ERRORS
01708             OR
01709         EMI-FATAL-CTR EQUAL ZERO
01710         GO TO 2000-UPDATE-FILE.
01711
01712      GO TO 8210-SEND-DATAONLY.
01713
01714  0530-EXIT.
01715      EXIT.
01716                                  EJECT
01717  0560-CHECK-TABLE.
01718
01719      IF  CRDTBLUI EQUAL SPACES
01720          MOVE '9'                TO CRDTBLUI.
01721
01722      EXEC CICS HANDLE CONDITION
01723          NOTOPEN (8870-NOTOPEN)
01724          NOTFND  (0560-NOT-FOUND)
01725          ENDFILE (0560-NOT-FOUND)
01726      END-EXEC.
01727
01728      MOVE LOW-VALUES             TO W-WORKING-CNTL-KEY.
01729      MOVE PI-COMPANY-ID          TO W-CNTL-COMP-ID.
01730      MOVE 'B'                    TO W-CNTL-REC-TYPE.
01731      MOVE CRDTBLUI               TO W-CNTL-TABLE-INDICATOR
01732                                     W-CREDIBLITY-TABLE.
01733
01734      EXEC CICS STARTBR
01735          DATASET ('ELCNTL')
01736          RIDFLD  (W-WORKING-CNTL-KEY)
01737          GTEQ
01738      END-EXEC.
01739
01740      EXEC CICS READNEXT
01741          DATASET ('ELCNTL')
01742          RIDFLD  (W-WORKING-CNTL-KEY)
01743          SET     (ADDRESS OF CONTROL-FILE)
01744      END-EXEC.
01745
01746      IF  CRDTBLUI EQUAL W-CNTL-TABLE-INDICATOR
01747          MOVE AL-UNNON           TO CRDTBLUA
01748          GO TO 0560-EXIT.
01749
01750  0560-NOT-FOUND.
01751
01752      MOVE -1                     TO CRDTBLUL.
01753      MOVE AL-UABON               TO CRDTBLUA.
01754      MOVE ER-7738                TO EMI-ERROR.
01755      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01756
01757  0560-EXIT.
01758      EXIT.
01759      EJECT
01760  0630-EDIT-DATA.
01761      IF PI-PROCESSOR-ID = 'LGXX'
01762          IF CRTACSL NOT = ZERO
01763              IF CRTACSI NOT = ' ' AND '1' AND '2' AND '3' AND '4'
01764                  MOVE -1       TO CRTACSL
01765                  MOVE AL-UABON TO CRTACSA
01766                  MOVE ER-0056  TO EMI-ERROR
01767                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01768              ELSE
01769                  MOVE AL-UANON TO CRTACSA.
01770
01771      IF REMTRML NOT = ZERO
01772          IF REMTRMI NOT = '1' AND '2' AND '3' AND '4'
01773                     AND '5' AND '6' AND '7'
01774              MOVE -1       TO REMTRML
01775              MOVE AL-UABON TO REMTRMA
01776              MOVE ER-0771  TO EMI-ERROR
01777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01778          ELSE
01779              MOVE AL-UANON TO REMTRMA.
01780
01781      IF R78MTHL NOT = ZERO
01782          IF R78MTHI NOT = ' ' AND '1'
01783              MOVE -1       TO R78MTHL
01784              MOVE AL-UABON TO R78MTHA
01785              MOVE ER-0072  TO EMI-ERROR
01786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01787          ELSE
01788              MOVE AL-UANON TO R78MTHA.
01789
01790      IF TRMOPTNL NOT = ZERO
01791          IF TRMOPTNI NOT = '1' AND '2' AND '3' AND '4' AND ' '
01792              MOVE -1       TO TRMOPTNL
01793              MOVE AL-UABON TO TRMOPTNA
01794              MOVE ER-0071  TO EMI-ERROR
01795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01796          ELSE
01797              MOVE AL-UANON TO TRMOPTNA.
01798
01799      IF DABILLL NOT = ZERO
01800          IF DABILLI NOT = 'Y' AND 'N' AND ' '
01801              MOVE -1       TO DABILLL
01802              MOVE AL-UABON TO DABILLA
01803              MOVE ER-2003  TO EMI-ERROR
01804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01805          ELSE
01806              MOVE AL-UANON TO DABILLA.
01807
01808      IF SSNL NOT = ZERO
01809          IF SSNI NOT = 'Y' AND 'N' AND ' '
01810              MOVE -1       TO SSNL
01811              MOVE AL-UABON TO SSNA
01812              MOVE ER-0607  TO EMI-ERROR
01813              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01814          ELSE
01815              MOVE AL-UANON TO SSNA.
01816
01817      IF AGECALCL NOT = ZERO
01818          IF AGECALCI EQUAL '1' OR '2' OR '3'
01819              MOVE AL-UANON TO AGECALCA
01820          ELSE
01821              MOVE -1       TO AGECALCL
01822              MOVE AL-UABON TO AGECALCA
01823              MOVE ER-7692  TO EMI-ERROR
01824              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01825
01826      IF CONSYSL NOT = ZERO
01827          IF CONSYSI NOT = 'Y' AND 'N' AND ' '
01828              MOVE -1       TO CONSYSL
01829              MOVE AL-UABON TO CONSYSA
01830              MOVE ER-2004  TO EMI-ERROR
01831              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01832          ELSE
01833              MOVE AL-UANON TO CONSYSA.
01834
01835      IF MEMBNOL NOT = ZERO
01836          IF MEMBNOI NOT = 'Y' AND 'N' AND ' '
01837              MOVE -1       TO MEMBNOL
01838              MOVE AL-UABON TO MEMBNOA
01839              MOVE ER-0608  TO EMI-ERROR
01840              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01841          ELSE
01842              MOVE AL-UANON TO MEMBNOA.
01843
01844      IF MAILL NOT = ZERO
01845          IF MAILI = 'Y' OR 'N' OR ' '
01846              MOVE AL-UANON TO MAILA
01847          ELSE
01848              MOVE -1       TO MAILL
01849              MOVE AL-UABON TO MAILA
01850              MOVE ER-0608  TO EMI-ERROR
01851              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01852
01853      IF AMRTCDL NOT = ZERO
01854         IF AMRTCDI NOT = SPACES
01855            PERFORM 0850-CHECK-ALT-MORT THRU 0850-XIT.
01856
01857      IF QTECALL NOT = ZERO
01858          EXEC CICS BIF
01859              DEEDIT
01860              FIELD (QTECALI)
01861              LENGTH(5)
01862          END-EXEC
01863          IF QTECALI NOT NUMERIC
01864              MOVE -1               TO QTECALL
01865              MOVE AL-UNBON         TO QTECALA
01866              MOVE ER-2010          TO EMI-ERROR
01867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01868            ELSE
01869              MOVE QTECALI          TO SV-QTECAL
01870                                       QTECALO
01871              MOVE AL-UNNON         TO QTECALA.
01872
01873      IF OVSAMTL NOT = ZERO
01874          EXEC CICS BIF
01875              DEEDIT
01876              FIELD (OVSAMTI)
01877              LENGTH(5)
01878          END-EXEC
01879          IF OVSAMTI NUMERIC
01880              MOVE AL-UNNON           TO OVSAMTA
01881              MOVE OVSAMTI            TO SV-OVSAMT
01882                                         OVSAMTO
01883          ELSE
01884              MOVE ER-7533            TO EMI-ERROR
01885              MOVE -1                 TO OVSAMTL
01886              MOVE AL-UNBON           TO OVSAMTA
01887              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01888
01889      IF OVSPCTL NOT = ZERO
01890          EXEC CICS BIF
01891              DEEDIT
01892              FIELD (OVSPCTI)
01893              LENGTH(5)
01894          END-EXEC
01895          IF OVSPCTI NUMERIC
01896             MOVE AL-UNNON           TO OVSPCTA
01897             MOVE OVSPCTI            TO WS-CO-OVR-SHT-PCT
01898                                        OVSPCTO
01899          ELSE
01900             MOVE ER-7532            TO EMI-ERROR
01901             MOVE -1                 TO OVSPCTL
01902             MOVE AL-UNBON           TO OVSPCTA
01903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01904
01905      IF MINAGEL NOT = ZERO
01906          IF MINAGEI NOT NUMERIC
01907             MOVE -1              TO MINAGEL
01908             MOVE AL-UNBON        TO MINAGEA
01909             MOVE ER-2011         TO EMI-ERROR
01910             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01911          ELSE
01912             MOVE AL-UNNON        TO MINAGEA.
01913
01914      IF PREJCTL NOT = ZERO
01915          IF PREJCTI NOT = ' ' AND '1'
01916             MOVE -1              TO PREJCTL
01917             MOVE AL-UABON        TO PREJCTA
01918             MOVE ER-2012         TO EMI-ERROR
01919             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01920          ELSE
01921             MOVE AL-UANON        TO PREJCTA.
01922
01923      IF MAXTERML NOT = ZERO
01924          IF MAXTERMI NOT NUMERIC
01925             MOVE -1 TO MAXTERML
01926             MOVE AL-UABON TO MAXTERMA
01927             MOVE ER-2013 TO EMI-ERROR
01928             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01929          ELSE
01930             MOVE AL-UANON TO MAXTERMA.
01931
01932      IF QTEREFL NOT = ZERO
01933          EXEC CICS BIF
01934              DEEDIT
01935              FIELD (QTEREFI)
01936              LENGTH(5)
01937          END-EXEC
01938          IF QTEREFI NOT NUMERIC
01939              MOVE -1               TO QTEREFL
01940              MOVE AL-UNBON         TO QTEREFA
01941              MOVE ER-2014          TO EMI-ERROR
01942              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01943            ELSE
01944              MOVE QTEREFI          TO SV-QTEREF
01945                                       QTEREFO
01946              MOVE AL-UNNON         TO QTEREFA.
01947
01948      IF REFREJL NOT = ZERO
01949          IF REFREJI NOT = ' ' AND '1'
01950             MOVE -1              TO REFREJL
01951             MOVE AL-UABON        TO REFREJA
01952             MOVE ER-2028         TO EMI-ERROR
01953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01954          ELSE
01955             MOVE AL-UANON        TO REFREJA.
01956
01957      IF DAGEL NOT = ZERO
01958          IF DAGEI NOT NUMERIC
01959             MOVE -1       TO DAGEL
01960             MOVE AL-UABON TO DAGEA
01961             MOVE ER-2015  TO EMI-ERROR
01962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01963          ELSE
01964             MOVE AL-UANON TO DAGEA.
01965
01966      IF DSEXL NOT = ZERO
01967          IF DSEXI NOT = 'M' AND 'F' AND ' '
01968             MOVE -1       TO DSEXL
01969             MOVE AL-UABON TO DSEXA
01970             MOVE ER-2016  TO EMI-ERROR
01971             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01972          ELSE
01973             MOVE AL-UANON TO DSEXA.
01974
01975      IF DAPRL NOT = ZERO
01976          EXEC CICS BIF
01977              DEEDIT
01978              FIELD (DAPRI)
01979              LENGTH(8)
01980          END-EXEC
01981          IF DAPRI NOT NUMERIC
01982              MOVE -1               TO DAPRL
01983              MOVE AL-UNBON         TO DAPRA
01984              MOVE ER-0248          TO EMI-ERROR
01985              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01986           ELSE
01987              MOVE DAPRI            TO SV-DAPR
01988                                       DAPRO
01989              MOVE AL-UNNON TO DAPRA.
01990
01991      IF JAGEL NOT = ZERO
01992          IF JAGEI NOT = 'Y' AND 'N' AND ' '
01993             MOVE -1       TO JAGEL
01994             MOVE AL-UABON TO JAGEA
01995             MOVE ER-2017  TO EMI-ERROR
01996             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01997          ELSE
01998             MOVE AL-UANON TO JAGEA.
01999
02000      IF PRCESSFL NOT = ZERO
02001          IF PRCESSFI NOT = 'Q' AND 'M' AND ' '
02002             MOVE -1              TO PRCESSFL
02003             MOVE AL-UABON        TO PRCESSFA
02004             MOVE ER-2029         TO EMI-ERROR
02005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02006          ELSE
02007             MOVE AL-UANON        TO PRCESSFA.
02008
02009      IF BINPUTL NOT = ZERO
02010          IF BINPUTI NOT = 'Y' AND 'N'      AND ' '
02011             MOVE -1       TO BINPUTL
02012             MOVE AL-UABON TO BINPUTA
02013             MOVE ER-2018  TO EMI-ERROR
02014             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02015          ELSE
02016             MOVE AL-UANON TO BINPUTA.
02017
02018      IF PRMPCTL NOT = ZEROS
02019         EXEC CICS BIF
02020             DEEDIT
02021             FIELD (PRMPCTI)
02022             LENGTH(5)
02023         END-EXEC
02024        IF PRMPCTI NUMERIC
02025             MOVE AL-UNNON           TO PRMPCTA
02026             MOVE PRMPCTI            TO WS-TOL-PREM-PCT
02027                                        PRMPCTO
02028         ELSE
02029             MOVE ER-7532            TO EMI-ERROR
02030             MOVE -1                 TO PRMPCTL
02031             MOVE AL-UNBON           TO PRMPCTA
02032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02033
02034      IF REFPCTL NOT = ZEROS
02035         EXEC CICS BIF
02036             DEEDIT
02037             FIELD (REFPCTI)
02038             LENGTH (5)
02039         END-EXEC
02040        IF REFPCTI NUMERIC
02041             MOVE AL-UNNON           TO REFPCTA
02042             MOVE REFPCTI            TO WS-TOL-REFUND-PCT
02043                                        REFPCTO
02044        ELSE
02045             MOVE ER-7532            TO EMI-ERROR
02046             MOVE -1                 TO REFPCTL
02047             MOVE AL-UNBON           TO REFPCTA
02048             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02049
02050      IF MTOLCAPL NOT = ZERO
02051          EXEC CICS BIF
02052              DEEDIT
02053              FIELD (MTOLCAPI)
02054              LENGTH(5)
02055          END-EXEC
02056         IF MTOLCAPI NOT NUMERIC
02057            MOVE -1               TO MTOLCAPL
02058            MOVE AL-UNBON         TO MTOLCAPA
02059            MOVE ER-7533          TO EMI-ERROR
02060            PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
02061         ELSE
02062         IF MTOLCAPI GREATER THAN 9999
02063            MOVE -1               TO MTOLCAPL
02064            MOVE AL-UNBON         TO MTOLCAPA
02065            MOVE ER-7533          TO EMI-ERROR
02066            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02067         ELSE
02068            MOVE MTOLCAPI          TO SV-MTOLCAP
02069                                      MTOLCAPO
02070            MOVE AL-UNNON          TO MTOLCAPA.
02071
02072      IF MINPREML NOT = ZERO
02073          EXEC CICS BIF
02074              DEEDIT
02075              FIELD (MINPREMI)
02076              LENGTH(5)
02077          END-EXEC
02078         IF MINPREMI NOT NUMERIC
02079            MOVE -1               TO MINPREML
02080            MOVE AL-UNBON         TO MINPREMA
02081            MOVE ER-2020          TO EMI-ERROR
02082            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02083         ELSE
02084            MOVE MINPREMI          TO SV-MINPREM
02085                                      MINPREMO
02086            MOVE AL-UNNON          TO MINPREMA.
02087
02088      IF COMPWTEL NOT = ZERO
02089          EXEC CICS BIF
02090              DEEDIT
02091              FIELD (COMPWTEI)
02092              LENGTH(5)
02093          END-EXEC
02094         IF COMPWTEI NOT NUMERIC
02095            MOVE -1               TO COMPWTEL
02096            MOVE AL-UNBON         TO COMPWTEA
02097            MOVE ER-2023          TO EMI-ERROR
02098            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02099         ELSE
02100            MOVE COMPWTEI         TO SV-COMPWTE
02101                                     COMPWTEO
02102            MOVE AL-UNNON         TO COMPWTEA.
02103
02104      IF CONDTEL NOT = ZERO
02105          MOVE AL-UNNON     TO CONDTEA
02106          MOVE CONDTEI      TO DEEDIT-FIELD
02107          PERFORM 0800-DEEDIT THRU 0800-EXIT
02108          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02109          MOVE '4'          TO DC-OPTION-CODE
02110          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02111          IF DATE-CONVERSION-ERROR
02112              MOVE -1       TO CONDTEL
02113              MOVE AL-UABON TO CONDTEA
02114              MOVE ER-2022  TO EMI-ERROR
02115              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02116          ELSE
02117              MOVE DC-GREG-DATE-1-EDIT    TO CONDTEI
02118              MOVE DC-BIN-DATE-1          TO WS-SAVE-CONDTE.
02119
02120      IF PI-PROCESSOR-ID = 'LGXX'
02121          IF LSTBTCHL NOT = ZERO
02122              IF LSTBTCHI NOT NUMERIC
02123                  MOVE -1       TO LSTBTCHL
02124                  MOVE AL-UNBON TO LSTBTCHA
02125                  MOVE ER-0615  TO EMI-ERROR
02126                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02127              ELSE
02128                  MOVE AL-UNNON               TO LSTBTCHA.
02129
02130      IF CMETHODL NOT = ZERO
02131          IF CMETHODI = '1' OR '2' OR '4'
02132              MOVE AL-UNNON TO CMETHODA
02133          ELSE
02134              MOVE AL-UNBON TO CMETHODA
02135              MOVE -1       TO CMETHODL
02136              MOVE ER-2357  TO EMI-ERROR
02137              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02138
02139      IF PI-PROCESSOR-ID = 'LGXX'
02140          IF CARGRPOL NOT = ZERO
02141              IF CARGRPOI = ' ' OR '1' OR '2' OR '3'
02142                  MOVE AL-UANON TO CARGRPOA
02143              ELSE
02144                  MOVE AL-UABON TO CARGRPOA
02145                  MOVE -1       TO CARGRPOL
02146                  MOVE ER-0635  TO EMI-ERROR
02147                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02148
02149      IF STCNTLL NOT EQUAL ZEROS
02150          IF STCNTLI EQUAL '1' OR '2' OR '3' OR '4' OR
02151                           '5' OR '6' OR '7' OR '8' OR
02152                           '9' OR 'A' OR 'B' OR 'X'
02153             NEXT SENTENCE
02154          ELSE
02155             MOVE -1         TO STCNTLL
02156             MOVE AL-UABON   TO STCNTLA
02157             MOVE ER-3035    TO EMI-ERROR
02158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02159
02160      IF PI-PROCESSOR-ID = 'LGXX'
02161          IF ARCHSTL NOT = ZERO
02162              IF ARCHSTI NOT NUMERIC
02163                  MOVE -1         TO ARCHSTL
02164                  MOVE AL-UNBON   TO ARCHSTA
02165                  MOVE ER-0611    TO EMI-ERROR
02166                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02167              ELSE
02168                  MOVE AL-UNNON   TO ARCHSTA.
02169
02170      IF PI-PROCESSOR-ID = 'LGXX'
02171          IF ARCHLSTL NOT = ZERO
02172              IF ARCHLSTI NOT NUMERIC
02173                  MOVE -1         TO ARCHLSTL
02174                  MOVE AL-UNBON   TO ARCHLSTA
02175                  MOVE ER-0611    TO EMI-ERROR
02176                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02177              ELSE
02178                  MOVE AL-UNNON   TO ARCHLSTA.
02179
02180      IF ARCHPYRL NOT = ZERO
02181          IF ARCHPYRI NOT NUMERIC
02182              MOVE -1             TO ARCHPYRL
02183              MOVE AL-UNBON       TO ARCHPYRA
02184              MOVE ER-7356        TO EMI-ERROR
02185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02186          ELSE
02187              MOVE AL-UNNON       TO ARCHPYRA.
02188
02189      IF PI-PROCESSOR-ID = 'LGXX'
02190          IF CKCOUNTL NOT = ZERO
02191              IF CKCOUNTI NOT NUMERIC
02192                  MOVE -1       TO CKCOUNTL
02193                  MOVE AL-UNBON TO CKCOUNTA
02194                  MOVE ER-0605  TO EMI-ERROR
02195                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02196              ELSE
02197                  MOVE AL-UNNON               TO CKCOUNTA.
02198
02199      IF PI-PROCESSOR-ID = 'LGXX'
02200          IF QUCOUNTL NOT = ZERO
02201              IF QUCOUNTI NOT NUMERIC
02202                  MOVE -1       TO QUCOUNTL
02203                  MOVE AL-UNBON TO QUCOUNTA
02204                  MOVE ER-0606  TO EMI-ERROR
02205                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02206              ELSE
02207                  MOVE AL-UNNON               TO QUCOUNTA.
02208
02209      IF CRLABELL NOT = ZERO
02210          IF CRLABELI NOT = 'Y' AND 'N'
02211              MOVE -1             TO CRLABELL
02212              MOVE AL-UABON       TO CRLABELA
02213              MOVE ER-7380        TO EMI-ERROR
02214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02215          ELSE
02216              MOVE AL-UANON       TO CRLABELA.
02217
02218  0630-MAPC.
02219      IF EMI-NO-ERRORS
02220          GO TO 3000-UPDATE-FILE.
02221
02222      GO TO 8220-SEND-DATAONLY.
02223
02224  0630-EXIT.
02225      EXIT.
02226      EJECT
02227  0730-EDIT-DATA.
02228
02229      IF MIBVERL NOT = ZERO
02230          IF MIBVERI = '0'
02231              IF MIBCSWI EQUAL 'Y' OR
02232                 MIBTSWI EQUAL 'Y'
02233                  MOVE AL-UABON TO MIBCSWA
02234                  MOVE -1       TO MIBCSWL
02235                  MOVE ER-9460  TO EMI-ERROR
02236                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02237
02238      IF MIBVERL NOT = ZERO
02239          IF MIBVERI = '0' OR '1' OR '2' OR '3'
02240              MOVE AL-UANON TO MIBVERA
02241          ELSE
02242              MOVE AL-UABON TO MIBVERA
02243              MOVE -1       TO MIBVERL
02244              MOVE ER-9193  TO EMI-ERROR
02245              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02246
02247      IF DAMRTCDL NOT = ZERO
02248         IF DAMRTCDI NOT = SPACES
02249            PERFORM 0950-CHECK-ALT-MORT THRU 0950-XIT.
02250
02251      IF MIBCSWL NOT = ZERO AND
02252         MIBTSWL NOT = ZERO
02253          IF MIBCSWI EQUAL 'Y' AND
02254             MIBTSWI EQUAL 'Y'
02255              MOVE AL-UABON TO MIBCSWA
02256              MOVE -1       TO MIBCSWL
02257              MOVE ER-9322  TO EMI-ERROR
02258              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02259
02260      IF MIBCSWL NOT = ZERO
02261          IF MIBCSWI EQUAL 'N' AND
02262             MIBTSWL = ZERO
02263              MOVE AL-UABON TO MIBCSWA
02264              MOVE -1       TO MIBCSWL
02265              MOVE ER-9322  TO EMI-ERROR
02266              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02267
02268      IF MIBTSWL NOT = ZERO
02269          IF MIBTSWI EQUAL 'N' AND
02270             MIBCSWL = ZERO
02271              MOVE AL-UABON TO MIBCSWA
02272              MOVE -1       TO MIBCSWL
02273              MOVE ER-9322  TO EMI-ERROR
02274              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02275
02276      IF DRESURL NOT = ZERO
02277          IF DRESURI NOT = 'Y' AND 'N' AND ' '
02278             MOVE -1       TO DRESURL
02279             MOVE AL-UABON TO DRESURA
02280             MOVE ER-2019  TO EMI-ERROR
02281             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02282          ELSE
02283             MOVE AL-UANON TO DRESURA.
02284
02285      IF RATESWL NOT = ZERO
02286          IF RATESWI = ' ' OR 'N' OR 'Y'
02287              NEXT SENTENCE
02288          ELSE
02289              MOVE AL-UABON TO RATESWA
02290              MOVE -1       TO RATESWL
02291              MOVE ER-9446  TO EMI-ERROR
02292              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02293
02294      IF PI-PROCESSOR-ID = 'LGXX'
02295          IF CMPCNTLL NOT = ZERO
02296              IF CMPCNTLI = ' ' OR '1' OR '2' OR '3'
02297                  MOVE AL-UANON TO CMPCNTLA
02298              ELSE
02299                  MOVE AL-UABON TO CMPCNTLA
02300                  MOVE -1       TO CMPCNTLL
02301                  MOVE ER-0635  TO EMI-ERROR
02302                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02303
02304
02305      IF CNVDTEL NOT = ZERO
02306          MOVE AL-UNNON     TO CNVDTEA
02307          MOVE CNVDTEI      TO DEEDIT-FIELD
02308          PERFORM 0800-DEEDIT THRU 0800-EXIT
02309          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02310          MOVE '4'          TO DC-OPTION-CODE
02311          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02312          IF DATE-CONVERSION-ERROR
02313              MOVE -1       TO CNVDTEL
02314              MOVE AL-UABON TO CNVDTEA
02315              MOVE ER-2022  TO EMI-ERROR
02316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02317          ELSE
02318              MOVE DC-GREG-DATE-1-EDIT    TO CNVDTEI
02319              MOVE DC-BIN-DATE-1          TO WS-SAVE-CONDTE.
02320
02321      IF PI-PROCESSOR-ID = 'LGXX'
02322          IF AUTOREFL NOT = ZERO
02323              IF AUTOREFI EQUAL 'Y' OR 'N'
02324                  MOVE AL-UANON   TO AUTOREFA
02325              ELSE
02326                  MOVE -1         TO AUTOREFL
02327                  MOVE AL-UABON   TO AUTOREFA
02328                  MOVE ER-9909    TO EMI-ERROR
02329                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02330
02331      IF PI-PROCESSOR-ID = 'LGXX'
02332          IF MGCNTLL NOT = ZERO
02333              IF MGCNTLI NOT = ' ' AND '1' AND '2' AND '3'
02334                 MOVE -1       TO MGCNTLL
02335                 MOVE AL-UABON TO MGCNTLA
02336                 MOVE ER-9192  TO EMI-ERROR
02337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02338              ELSE
02339                 MOVE AL-UANON TO MGCNTLA.
02340
02341      IF PI-PROCESSOR-ID = 'LGXX'
02342          IF SHFTLNOL NOT = ZERO
02343              IF SHFTLNOI EQUAL 'L' OR 'R'
02344                  MOVE AL-UANON   TO SHFTLNOA
02345              ELSE
02346                  MOVE -1         TO SHFTLNOL
02347                  MOVE AL-UABON   TO SHFTLNOA
02348                  MOVE ER-9791    TO EMI-ERROR
02349                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02350
02351      IF PI-PROCESSOR-ID = 'LGXX'
02352          IF CHKPMTHL NOT = ZERO
02353              IF CHKPMTHI EQUAL '1' OR '2' OR '3'
02354                  MOVE AL-UANON   TO CHKPMTHA
02355              ELSE
02356                  MOVE -1         TO CHKPMTHL
02357                  MOVE AL-UABON   TO CHKPMTHA
02358                  MOVE ER-9791    TO EMI-ERROR
02359                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02360
02361      IF PI-PROCESSOR-ID = 'LGXX'
02362          IF MRECONL NOT = ZERO
02363              IF MRECONI EQUAL 'Y' OR 'N'
02364                  MOVE AL-UANON   TO MRECONA
02365              ELSE
02366                  MOVE -1         TO MRECONL
02367                  MOVE AL-UABON   TO MRECONA
02368                  MOVE ER-9533    TO EMI-ERROR
02369                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02370
02371      IF RPTLANGL IS GREATER THAN +0
02372          IF RPTLANGI NOT = ' ' AND 'E' AND 'F'
02373              MOVE ER-9598        TO EMI-ERROR
02374              MOVE -1             TO RPTLANGL
02375              MOVE AL-UABON       TO RPTLANGA
02376              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02377          ELSE
02378              MOVE AL-UANON       TO  RPTLANGA.
02379
02380      IF PLCYLNKL IS GREATER THAN +0
02381          IF PLCYLNKI NOT = ' ' AND 'Y' AND 'N'
02382              MOVE ER-9576        TO EMI-ERROR
02383              MOVE -1             TO PLCYLNKL
02384              MOVE AL-UABON       TO PLCYLNKA
02385              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02386          ELSE
02387              MOVE AL-UANON       TO  PLCYLNKA.
02388
02389      IF GRPSWL  NOT = ZERO
02390          IF GRPSWI = ' ' OR 'N' OR 'Y'
02391              NEXT SENTENCE
02392          ELSE
02393              MOVE AL-UABON TO GRPSWA
02394              MOVE -1       TO GRPSWL
02395              MOVE ER-9417  TO EMI-ERROR
02396              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02397
02398      IF PI-PROCESSOR-ID = 'LGXX'
02399          IF REFNOL NOT = ZERO
02400              MOVE REFNOI         TO DEEDIT-FIELD
02401              PERFORM 0800-DEEDIT THRU 0800-EXIT
02402              IF DEEDIT-FIELD-V0 NOT NUMERIC
02403                  MOVE -1         TO REFNOL
02404                  MOVE AL-UNBON   TO REFNOA
02405                  MOVE ER-9790    TO EMI-ERROR
02406                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02407              ELSE
02408                  MOVE DEEDIT-FIELD
02409                                  TO SV-MORTG-REF-NUM
02410                  MOVE AL-UNNON   TO REFNOA.
02411
02412      IF LNMESERL NOT = ZERO
02413          MOVE LNMESERI TO WS-LNAME-SEARCH-CNTL
02414          IF WS-MIB-LNAME-SEARCH = ' ' OR 'N' OR 'Y'
02415              MOVE AL-UANON TO LNMESERA
02416          ELSE
02417              MOVE AL-UABON TO LNMESERA
02418              MOVE -1       TO LNMESERL
02419              MOVE ER-9194  TO EMI-ERROR
02420              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02421
02422      IF LNMESERL NOT = ZERO
02423          IF WS-ALP-LNAME-SEARCH = ' ' OR 'N' OR 'Y'
02424              MOVE AL-UANON TO LNMESERA
02425          ELSE
02426              MOVE AL-UABON TO LNMESERA
02427              MOVE -1       TO LNMESERL
02428              MOVE ER-9194  TO EMI-ERROR
02429              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02430
02431      IF FNMESERL NOT = ZERO
02432          MOVE FNMESERI TO WS-FNAME-SEARCH-CNTL
02433          IF WS-MIB-FNAME-SEARCH = ' ' OR 'N' OR 'Y'
02434              MOVE AL-UANON TO FNMESERA
02435          ELSE
02436              MOVE AL-UABON TO FNMESERA
02437              MOVE -1       TO FNMESERL
02438              MOVE ER-9194  TO EMI-ERROR
02439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02440
02441      IF FNMESERL NOT = ZERO
02442          IF WS-ALP-FNAME-SEARCH = ' ' OR 'N' OR 'Y'
02443              MOVE AL-UANON TO FNMESERA
02444          ELSE
02445              MOVE AL-UABON TO FNMESERA
02446              MOVE -1       TO FNMESERL
02447              MOVE ER-9194  TO EMI-ERROR
02448              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02449
02450      IF MNMESERL NOT = ZERO
02451          MOVE MNMESERI TO WS-MNAME-SEARCH-CNTL
02452          IF WS-MIB-MNAME-SEARCH = ' ' OR 'N' OR 'Y'
02453              MOVE AL-UANON TO MNMESERA
02454          ELSE
02455              MOVE AL-UABON TO MNMESERA
02456              MOVE -1       TO MNMESERL
02457              MOVE ER-9194  TO EMI-ERROR
02458              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02459
02460      IF MNMESERL NOT = ZERO
02461          IF WS-ALP-MNAME-SEARCH = ' ' OR 'N' OR 'Y'
02462              MOVE AL-UANON TO MNMESERA
02463          ELSE
02464              MOVE AL-UABON TO MNMESERA
02465              MOVE -1       TO MNMESERL
02466              MOVE ER-9194  TO EMI-ERROR
02467              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02468
02469      IF BDATEL NOT = ZERO
02470          MOVE BDATEI TO WS-BDATE-SEARCH-CNTL
02471          IF WS-MIB-BDATE-SEARCH = ' ' OR 'N' OR 'Y'
02472              MOVE AL-UANON TO BDATEA
02473          ELSE
02474              MOVE AL-UABON TO BDATEA
02475              MOVE -1       TO BDATEL
02476              MOVE ER-9194  TO EMI-ERROR
02477              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02478
02479      IF BDATEL NOT = ZERO
02480          IF WS-ALP-BDATE-SEARCH = ' ' OR 'N' OR 'Y'
02481              MOVE AL-UANON TO BDATEA
02482          ELSE
02483              MOVE AL-UABON TO BDATEA
02484              MOVE -1       TO BDATEL
02485              MOVE ER-9194  TO EMI-ERROR
02486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02487
02488      IF BSTATEL NOT = ZERO
02489          MOVE BSTATEI TO WS-BSTATE-SEARCH-CNTL
02490          IF WS-MIB-BSTATE-SEARCH = ' ' OR 'N' OR 'Y'
02491              MOVE AL-UANON TO BSTATEA
02492          ELSE
02493              MOVE AL-UABON TO BSTATEA
02494              MOVE -1       TO BSTATEL
02495              MOVE ER-9194  TO EMI-ERROR
02496              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02497
02498      IF BSTATEL NOT = ZERO
02499          IF WS-ALP-BSTATE-SEARCH = ' ' OR 'N' OR 'Y'
02500              MOVE AL-UANON TO BSTATEA
02501          ELSE
02502              MOVE AL-UABON TO BSTATEA
02503              MOVE -1       TO BSTATEL
02504              MOVE ER-9194  TO EMI-ERROR
02505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02506
02507      IF RSTATEL NOT = ZERO
02508          MOVE RSTATEI TO WS-RSTATE-SEARCH-CNTL
02509          IF WS-MIB-RSTATE-SEARCH = ' ' OR 'N' OR 'Y'
02510              MOVE AL-UANON TO RSTATEA
02511          ELSE
02512              MOVE AL-UABON TO RSTATEA
02513              MOVE -1       TO RSTATEL
02514              MOVE ER-9194  TO EMI-ERROR
02515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02516
02517      IF RSTATEL NOT = ZERO
02518          IF WS-ALP-RSTATE-SEARCH = ' ' OR 'N' OR 'Y'
02519              MOVE AL-UANON TO RSTATEA
02520          ELSE
02521              MOVE AL-UABON TO RSTATEA
02522              MOVE -1       TO RSTATEL
02523              MOVE ER-9194  TO EMI-ERROR
02524              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02525
02526      IF PI-PROCESSOR-ID = 'LGXX'
02527          IF RATFILML NOT = ZERO
02528              IF RATFILMI EQUAL SPACES
02529                  MOVE LOW-VALUES   TO WS-SAVE-RTEFILM
02530              ELSE
02531                  MOVE AL-UNNON     TO RATFILMA
02532                  MOVE RATFILMI     TO DEEDIT-FIELD
02533                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02534                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02535                  MOVE '4'          TO DC-OPTION-CODE
02536                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02537                  IF DATE-CONVERSION-ERROR
02538                      MOVE -1       TO RATFILML
02539                      MOVE AL-UABON TO RATFILMA
02540                      MOVE ER-0600  TO EMI-ERROR
02541                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02542                  ELSE
02543                      MOVE DC-GREG-DATE-1-EDIT TO RATFILMI
02544                      MOVE DC-BIN-DATE-1       TO WS-SAVE-RTEFILM.
02545
02546      IF RATFILCL NOT = ZERO
02547          MOVE AL-UNNON     TO RATFILCA
02548          MOVE RATFILCI     TO DEEDIT-FIELD
02549          PERFORM 0800-DEEDIT THRU 0800-EXIT
02550          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02551          MOVE '4'          TO DC-OPTION-CODE
02552          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02553          IF DATE-CONVERSION-ERROR
02554              MOVE -1       TO RATFILCL
02555              MOVE AL-UABON TO RATFILCA
02556              MOVE ER-2034  TO EMI-ERROR
02557              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02558          ELSE
02559              MOVE DC-GREG-DATE-1-EDIT    TO RATFILCI
02560              MOVE DC-BIN-DATE-1          TO WS-SAVE-RTEFILC.
02561
02562      IF PI-PROCESSOR-ID = 'LGXX'
02563          IF CHKCNTRL NOT = ZERO
02564              IF CHKCNTRI NOT NUMERIC
02565                  MOVE -1       TO CHKCNTRL
02566                  MOVE AL-UNBON TO CHKCNTRA
02567                  MOVE ER-0605  TO EMI-ERROR
02568                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02569              ELSE
02570                  MOVE AL-UNNON               TO CHKCNTRA.
02571
02572      IF PI-PROCESSOR-ID = 'LGXX'
02573          IF PRDMSTML NOT = ZERO
02574              IF PRDMSTMI EQUAL SPACES
02575                  MOVE LOW-VALUES   TO WS-SAVE-PRDMSTM
02576              ELSE
02577                  MOVE AL-UNNON     TO PRDMSTMA
02578                  MOVE PRDMSTMI     TO DEEDIT-FIELD
02579                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02580                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02581                  MOVE '4'          TO DC-OPTION-CODE
02582                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02583                  IF DATE-CONVERSION-ERROR
02584                      MOVE -1       TO PRDMSTML
02585                      MOVE AL-UABON TO PRDMSTMA
02586                      MOVE ER-0602  TO EMI-ERROR
02587                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02588                  ELSE
02589                      MOVE DC-GREG-DATE-1-EDIT TO PRDMSTMI
02590                      MOVE DC-BIN-DATE-1       TO WS-SAVE-PRDMSTM.
02591
02592      IF PRDMSTCL NOT = ZERO
02593          MOVE AL-UNNON     TO PRDMSTCA
02594          MOVE PRDMSTCI     TO DEEDIT-FIELD
02595          PERFORM 0800-DEEDIT THRU 0800-EXIT
02596          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02597          MOVE '4'          TO DC-OPTION-CODE
02598          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02599          IF DATE-CONVERSION-ERROR
02600              MOVE -1       TO PRDMSTCL
02601              MOVE AL-UABON TO PRDMSTCA
02602              MOVE ER-2036  TO EMI-ERROR
02603              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02604          ELSE
02605              MOVE DC-GREG-DATE-1-EDIT    TO PRDMSTCI
02606              MOVE DC-BIN-DATE-1          TO WS-SAVE-PRDMSTC.
02607
02608      IF PI-PROCESSOR-ID = 'LGXX'
02609          IF QUECNTRL NOT = ZERO
02610              IF QUECNTRI NOT NUMERIC
02611                  MOVE -1       TO QUECNTRL
02612                  MOVE AL-UNBON TO QUECNTRA
02613                  MOVE ER-0606  TO EMI-ERROR
02614                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02615              ELSE
02616                  MOVE AL-UNNON               TO QUECNTRA.
02617
02618      IF PI-PROCESSOR-ID = 'LGXX'
02619          IF RENTBLML NOT = ZERO
02620              IF RENTBLMI EQUAL SPACES
02621                  MOVE LOW-VALUES TO WS-SAVE-RENTABM
02622              ELSE
02623                  MOVE AL-UNNON TO RENTBLMA
02624                  MOVE RENTBLMI TO DEEDIT-FIELD
02625                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02626                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02627                  MOVE '4'          TO DC-OPTION-CODE
02628                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02629                  IF DATE-CONVERSION-ERROR
02630                      MOVE -1       TO RENTBLML
02631                      MOVE AL-UABON TO RENTBLMA
02632                      MOVE ER-0603  TO EMI-ERROR
02633                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02634                  ELSE
02635                      MOVE DC-GREG-DATE-1-EDIT TO RENTBLMI
02636                      MOVE DC-BIN-DATE-1       TO WS-SAVE-RENTABM.
02637
02638      IF RENTBLCL NOT = ZERO
02639          MOVE AL-UNNON     TO RENTBLCA
02640          MOVE RENTBLCI     TO DEEDIT-FIELD
02641          PERFORM 0800-DEEDIT THRU 0800-EXIT
02642          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02643          MOVE '4'          TO DC-OPTION-CODE
02644          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02645          IF DATE-CONVERSION-ERROR
02646              MOVE -1       TO RENTBLCL
02647              MOVE AL-UABON TO RENTBLCA
02648              MOVE ER-2037  TO EMI-ERROR
02649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02650          ELSE
02651              MOVE DC-GREG-DATE-1-EDIT    TO RENTBLCI
02652              MOVE DC-BIN-DATE-1          TO WS-SAVE-RENTABC.
02653
02654      IF PI-PROCESSOR-ID = 'LGXX'
02655          IF COMMSTML NOT = ZERO
02656              IF COMMSTMI EQUAL SPACES
02657                  MOVE LOW-VALUES   TO WS-SAVE-CMPMSTM
02658              ELSE
02659                  MOVE AL-UNNON     TO COMMSTMA
02660                  MOVE COMMSTMI     TO DEEDIT-FIELD
02661                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02662                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02663                  MOVE '4'          TO DC-OPTION-CODE
02664                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02665                  IF DATE-CONVERSION-ERROR
02666                      MOVE -1       TO COMMSTML
02667                      MOVE AL-UABON TO COMMSTMA
02668                      MOVE ER-0604  TO EMI-ERROR
02669                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02670                  ELSE
02671                      MOVE DC-GREG-DATE-1-EDIT TO COMMSTMI
02672                      MOVE DC-BIN-DATE-1       TO WS-SAVE-CMPMSTM.
02673
02674      IF COMMSTCL NOT = ZERO
02675          MOVE AL-UNNON     TO COMMSTCA
02676          MOVE COMMSTCI     TO DEEDIT-FIELD
02677          PERFORM 0800-DEEDIT THRU 0800-EXIT
02678          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02679          MOVE '4'          TO DC-OPTION-CODE
02680          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02681          IF DATE-CONVERSION-ERROR
02682              MOVE -1       TO COMMSTCL
02683              MOVE AL-UABON TO COMMSTCA
02684              MOVE ER-2037  TO EMI-ERROR
02685              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02686          ELSE
02687              MOVE DC-GREG-DATE-1-EDIT    TO COMMSTCI
02688              MOVE DC-BIN-DATE-1          TO WS-SAVE-CMPMSTC.
02689
02690  0730-MAPD.
02691      IF EMI-NO-ERRORS
02692          GO TO 4000-UPDATE-FILE.
02693
02694      GO TO 8230-SEND-DATAONLY.
02695  0730-EXIT.
02696      EXIT.
02697
02698      EJECT
02699  0760-EDIT-DATA.
02700      IF PI-PROCESSOR-ID = 'LGXX' or 'PEMA'
02701          IF RTEFILML NOT = ZERO
02702              IF RTEFILMI EQUAL SPACES
02703                  MOVE LOW-VALUES   TO WS-SAVE-RTEFILM
02704              ELSE
02705                  MOVE AL-UNNON     TO RTEFILMA
02706                  MOVE RTEFILMI     TO DEEDIT-FIELD
02707                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02708                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02709                  MOVE '4'          TO DC-OPTION-CODE
02710                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02711                  IF DATE-CONVERSION-ERROR
02712                      MOVE -1       TO RTEFILML
02713                      MOVE AL-UABON TO RTEFILMA
02714                      MOVE ER-0600  TO EMI-ERROR
02715                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02716                  ELSE
02717                      MOVE DC-GREG-DATE-1-EDIT TO RTEFILMI
02718                      MOVE DC-BIN-DATE-1       TO WS-SAVE-RTEFILM.
02719
02720      IF RTEFILCL NOT = ZERO
02721          MOVE AL-UNNON     TO RTEFILCA
02722          MOVE RTEFILCI     TO DEEDIT-FIELD
02723          PERFORM 0800-DEEDIT THRU 0800-EXIT
02724          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02725          MOVE '4'          TO DC-OPTION-CODE
02726          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02727          IF DATE-CONVERSION-ERROR
02728              MOVE -1       TO RTEFILCL
02729              MOVE AL-UABON TO RTEFILCA
02730              MOVE ER-2034  TO EMI-ERROR
02731              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02732          ELSE
02733              MOVE DC-GREG-DATE-1-EDIT    TO RTEFILCI
02734              MOVE DC-BIN-DATE-1          TO WS-SAVE-RTEFILC.
02735
02736      IF PI-PROCESSOR-ID = 'LGXX' or 'PEMA'
02737          IF COMTABML NOT = ZERO
02738              IF COMTABMI EQUAL SPACES
02739                  MOVE LOW-VALUES   TO WS-SAVE-COMTABM
02740              ELSE
02741                  MOVE AL-UNNON     TO COMTABMA
02742                  MOVE COMTABMI     TO DEEDIT-FIELD
02743                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02744                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02745                  MOVE '4'          TO DC-OPTION-CODE
02746                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02747                  IF DATE-CONVERSION-ERROR
02748                      MOVE -1       TO COMTABML
02749                      MOVE AL-UABON TO COMTABMA
02750                      MOVE ER-0601  TO EMI-ERROR
02751                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02752                  ELSE
02753                      MOVE DC-GREG-DATE-1-EDIT TO COMTABMI
02754                      MOVE DC-BIN-DATE-1      TO WS-SAVE-COMTABM.
02755
02756      IF COMTABCL NOT = ZERO
02757          MOVE AL-UNNON     TO COMTABCA
02758          MOVE COMTABCI     TO DEEDIT-FIELD
02759          PERFORM 0800-DEEDIT THRU 0800-EXIT
02760          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02761          MOVE '4'          TO DC-OPTION-CODE
02762          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02763          IF DATE-CONVERSION-ERROR
02764              MOVE -1       TO COMTABCL
02765              MOVE AL-UABON TO COMTABCA
02766              MOVE ER-2035  TO EMI-ERROR
02767              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02768          ELSE
02769              MOVE DC-GREG-DATE-1-EDIT    TO COMTABCI
02770              MOVE DC-BIN-DATE-1          TO WS-SAVE-COMTABC.
02771
02772      IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
02773          IF ACTMSTML NOT = ZERO
02774              IF ACTMSTMI EQUAL SPACES
02775                  MOVE LOW-VALUES   TO WS-SAVE-ACTMSTM
02776              ELSE
02777                  MOVE AL-UNNON     TO ACTMSTMA
02778                  MOVE ACTMSTMI     TO DEEDIT-FIELD
02779                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02780                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02781                  MOVE '4'          TO DC-OPTION-CODE
02782                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02783                  IF DATE-CONVERSION-ERROR
02784                      MOVE -1       TO ACTMSTML
02785                      MOVE AL-UABON TO ACTMSTMA
02786                      MOVE ER-0602  TO EMI-ERROR
02787                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02788                  ELSE
02789                      MOVE DC-GREG-DATE-1-EDIT TO ACTMSTMI
02790                      MOVE DC-BIN-DATE-1       TO WS-SAVE-ACTMSTM.
02791
02792      IF ACTMSTCL NOT = ZERO
02793          MOVE AL-UNNON     TO ACTMSTCA
02794          MOVE ACTMSTCI     TO DEEDIT-FIELD
02795          PERFORM 0800-DEEDIT THRU 0800-EXIT
02796          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02797          MOVE '4'          TO DC-OPTION-CODE
02798          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02799          IF DATE-CONVERSION-ERROR
02800              MOVE -1       TO ACTMSTCL
02801              MOVE AL-UABON TO ACTMSTCA
02802              MOVE ER-2036  TO EMI-ERROR
02803              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02804          ELSE
02805              MOVE DC-GREG-DATE-1-EDIT    TO ACTMSTCI
02806              MOVE DC-BIN-DATE-1          TO WS-SAVE-ACTMSTC.
02807
02808      IF PI-PROCESSOR-ID = 'LGXX' or 'PEMA'
02809          IF RENTABML NOT = ZERO
02810              IF RENTABMI EQUAL SPACES
02811                  MOVE LOW-VALUES TO WS-SAVE-RENTABM
02812              ELSE
02813                  MOVE AL-UNNON TO RENTABMA
02814                  MOVE RENTABMI TO DEEDIT-FIELD
02815                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02816                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02817                  MOVE '4'          TO DC-OPTION-CODE
02818                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02819                  IF DATE-CONVERSION-ERROR
02820                      MOVE -1       TO RENTABML
02821                      MOVE AL-UABON TO RENTABMA
02822                      MOVE ER-0603  TO EMI-ERROR
02823                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02824                  ELSE
02825                      MOVE DC-GREG-DATE-1-EDIT TO RENTABMI
02826                      MOVE DC-BIN-DATE-1       TO WS-SAVE-RENTABM.
02827
02828      IF RENTABCL NOT = ZERO
02829          MOVE AL-UNNON     TO RENTABCA
02830          MOVE RENTABCI     TO DEEDIT-FIELD
02831          PERFORM 0800-DEEDIT THRU 0800-EXIT
02832          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02833          MOVE '4'          TO DC-OPTION-CODE
02834          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02835          IF DATE-CONVERSION-ERROR
02836              MOVE -1       TO RENTABCL
02837              MOVE AL-UABON TO RENTABCA
02838              MOVE ER-2037  TO EMI-ERROR
02839              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02840          ELSE
02841              MOVE DC-GREG-DATE-1-EDIT    TO RENTABCI
02842              MOVE DC-BIN-DATE-1          TO WS-SAVE-RENTABC.
02843
02844      IF PI-PROCESSOR-ID = 'LGXX' or 'PEMA'
02845          IF CMPMSTML NOT = ZERO
02846              IF CMPMSTMI EQUAL SPACES
02847                  MOVE LOW-VALUES   TO WS-SAVE-CMPMSTM
02848              ELSE
02849                  MOVE AL-UNNON     TO CMPMSTMA
02850                  MOVE CMPMSTMI     TO DEEDIT-FIELD
02851                  PERFORM 0800-DEEDIT THRU 0800-EXIT
02852                  MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02853                  MOVE '4'          TO DC-OPTION-CODE
02854                  PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02855                  IF DATE-CONVERSION-ERROR
02856                      MOVE -1       TO CMPMSTML
02857                      MOVE AL-UABON TO CMPMSTMA
02858                      MOVE ER-0604  TO EMI-ERROR
02859                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02860                  ELSE
02861                      MOVE DC-GREG-DATE-1-EDIT TO CMPMSTMI
02862                      MOVE DC-BIN-DATE-1       TO WS-SAVE-CMPMSTM.
02863
02864      IF CMPMSTCL NOT = ZERO
02865          MOVE AL-UNNON     TO CMPMSTCA
02866          MOVE CMPMSTCI     TO DEEDIT-FIELD
02867          PERFORM 0800-DEEDIT THRU 0800-EXIT
02868          MOVE DEEDIT-FIELD TO DC-GREG-DATE-1-MDY
02869          MOVE '4'          TO DC-OPTION-CODE
02870          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
02871          IF DATE-CONVERSION-ERROR
02872              MOVE -1       TO CMPMSTCL
02873              MOVE AL-UABON TO CMPMSTCA
02874              MOVE ER-2037  TO EMI-ERROR
02875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02876          ELSE
02877              MOVE DC-GREG-DATE-1-EDIT    TO CMPMSTCI
02878              MOVE DC-BIN-DATE-1          TO WS-SAVE-CMPMSTC.
02879
02880  0760-MAPE.
02881      IF EMI-NO-ERRORS
02882          GO TO 5000-UPDATE-FILE.
02883
02884      GO TO 8240-SEND-DATAONLY.
02885
02886  0760-EXIT.
02887      EXIT.
02888
02889      EJECT
02890  0800-DEEDIT.
02891      EXEC CICS BIF
02892           DEEDIT
02893           FIELD (DEEDIT-FIELD)
02894           LENGTH(17)
02895       END-EXEC.
02896
02897  0800-EXIT.
02898      EXIT.
02899      EJECT
02900
02901  0850-CHECK-ALT-MORT.
02902      EXEC CICS HANDLE CONDITION
02903              NOTFND(0850-NOT-FOUND)
02904      END-EXEC.
02905
02906  0850-READ-MORT.
02907      MOVE PI-COMPANY-ID TO CK-COMP-ID.
02908      MOVE '7'           TO CK-REC-TYPE.
02909
02910      EXEC CICS READ
02911          DATASET('ELCNTL')
02912          SET    (ADDRESS OF CONTROL-FILE)
02913          RIDFLD (ELCNTL-KEY)
02914      END-EXEC.
02915
02916      SET CF-MORT-NDX             TO +1.
02917      SEARCH CF-MORT-TABLE-LINE
02918          VARYING CF-MORT-NDX
02919          AT END
02920              ADD +1              TO CK-SEQ-NO
02921              GO TO 0850-READ-MORT
02922          WHEN
02923              CF-MORT-TABLE-CODE (CF-MORT-NDX) GREATER THAN AMRTCDI
02924                  OR
02925              CF-MORT-TABLE-CODE (CF-MORT-NDX) = LOW-VALUES
02926              GO TO 0850-NOT-FOUND
02927          WHEN
02928              CF-MORT-TABLE-CODE (CF-MORT-NDX) EQUAL AMRTCDI
02929              MOVE +0       TO CK-SEQ-NO
02930              MOVE AL-UNNON TO AMRTCDA
02931              GO TO 0850-XIT.
02932
02933  0850-NOT-FOUND.
02934      MOVE +0       TO CK-SEQ-NO.
02935      MOVE -1       TO AMRTCDL.
02936      MOVE AL-UNBON TO AMRTCDA.
02937      MOVE ER-2904  TO EMI-ERROR.
02938      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02939
02940  0850-XIT.
02941      EXIT.
02942      EJECT
02943
02944  0950-CHECK-ALT-MORT.
02945      EXEC CICS HANDLE CONDITION
02946              NOTFND(0950-NOT-FOUND)
02947      END-EXEC.
02948
02949  0950-READ-MORT.
02950      MOVE PI-COMPANY-ID TO CK-COMP-ID.
02951      MOVE '7'           TO CK-REC-TYPE.
02952
02953      EXEC CICS READ
02954          DATASET('ELCNTL')
02955          SET    (ADDRESS OF CONTROL-FILE)
02956          RIDFLD (ELCNTL-KEY)
02957      END-EXEC.
02958
02959      SET CF-MORT-NDX             TO +1.
02960      SEARCH CF-MORT-TABLE-LINE
02961          VARYING CF-MORT-NDX
02962          AT END
02963              ADD +1              TO CK-SEQ-NO
02964              GO TO 0950-READ-MORT
02965          WHEN
02966              CF-MORT-TABLE-CODE (CF-MORT-NDX)
02967                  GREATER THAN DAMRTCDI
02968                  OR
02969              CF-MORT-TABLE-CODE (CF-MORT-NDX) = LOW-VALUES
02970              GO TO 0950-NOT-FOUND
02971          WHEN
02972              CF-MORT-TABLE-CODE (CF-MORT-NDX) EQUAL DAMRTCDI
02973              MOVE +0       TO CK-SEQ-NO
02974              MOVE AL-UNNON TO DAMRTCDA
02975              GO TO 0950-XIT.
02976
02977  0950-NOT-FOUND.
02978      MOVE +0       TO CK-SEQ-NO.
02979      MOVE -1       TO DAMRTCDL.
02980      MOVE AL-UNBON TO DAMRTCDA.
02981      MOVE ER-2904  TO EMI-ERROR.
02982      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02983
02984  0950-XIT.
02985      EXIT.
02986
02987      EJECT
02988
02989  1000-UPDATE-FILE.
02990 *    UPDATE FIELDS FROM MAP A
02991
02992      MOVE PI-COMPANY-ID TO CK-COMP-ID.
02993      MOVE '1'           TO CK-REC-TYPE.
02994
02995      EXEC CICS READ
02996          UPDATE
02997          DATASET('ELCNTL')
02998          SET    (ADDRESS OF CONTROL-FILE)
02999          RIDFLD (ELCNTL-KEY)
03000      END-EXEC.
03001
03002      IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY     OR
03003         CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
03004          EXEC CICS UNLOCK
03005              DATASET('ELCNTL')
03006          END-EXEC
03007          MOVE ER-0068 TO EMI-ERROR
03008          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03009          GO TO 7000-BUILD-INITIAL-MAP.
03010
03011      MOVE 'B'          TO JP-RECORD-TYPE.
03012      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03013      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03014
03015      IF COMPNMEL NOT = ZERO
03016          MOVE COMPNMEI   TO CF-CL-MAIL-TO-NAME.
03017      IF INCAREL NOT = ZERO
03018          MOVE INCAREI    TO CF-CL-IN-CARE-OF.
03019      IF ADDR1L NOT = ZERO
03020          MOVE ADDR1I     TO CF-CL-ADDR-LINE-1.
03021      IF ADDR2L NOT = ZERO
03022          MOVE ADDR2I     TO CF-CL-ADDR-LINE-2.
03023      IF CITYSTL NOT = ZERO
03024          MOVE CITYSTI    TO CF-CL-CITY-STATE.
03025
03026      IF CF-CL-ZIP-CODE-NUM NUMERIC  AND
03027         CF-CL-ZIP-CODE-NUM NOT = ZEROS
03028          MOVE CF-CL-ZIP-CODE-NUM       TO WS-ZIP-CODE-NUM
03029          MOVE WS-ZIP-CODE-NUM          TO CF-CL-ZIP-CODE.
03030
03031      IF ZIPCODEL NOT = ZERO
03032          MOVE ZIPCODEI                 TO  WS-ZIP-CODE
03033          MOVE ZEROS                    TO  CF-CL-ZIP-CODE-NUM
03034      ELSE
03035          GO TO 1010-CONTINUE-UPDATE.
03036
03037      IF WS-CANADIAN-ZIP
03038          IF WS-ZIP-4 = SPACE  OR  '-'
03039              MOVE WS-ZIP-CAN-2-POST1   TO CF-CL-CAN-POSTAL-1
03040              MOVE WS-ZIP-CAN-2-POST2   TO CF-CL-CAN-POSTAL-2
03041          ELSE
03042              MOVE WS-ZIP-CAN-1-POST1   TO CF-CL-CAN-POSTAL-1
03043              MOVE WS-ZIP-CAN-1-POST2   TO CF-CL-CAN-POSTAL-2
03044      ELSE
03045          IF WS-ZIP-6 = SPACE  OR  '-'
03046              MOVE WS-ZIP-AM-2-CODE     TO CF-CL-ZIP-PRIME
03047              MOVE WS-ZIP-AM-2-PLUS4    TO CF-CL-ZIP-PLUS4
03048          ELSE
03049              MOVE WS-ZIP-AM-1-CODE     TO CF-CL-ZIP-PRIME
03050              MOVE WS-ZIP-AM-1-PLUS4    TO CF-CL-ZIP-PLUS4.
03051
03052  1010-CONTINUE-UPDATE.
03053      IF PHONEL NOT = ZERO
03054          MOVE SV-PHONE   TO CF-CL-PHONE-NO.
03055      IF JOURNIDL NOT = ZERO
03056         MOVE JOURNIDI    TO CF-JOURNAL-FILE-ID.
03057      IF PASSWDL NOT = ZERO
03058          MOVE PASSWDI    TO CF-COMPANY-PASSWORD.
03059      IF SECOPTL NOT = ZERO
03060          MOVE SECOPTI    TO CF-SECURITY-OPTION.
03061      IF FPIDL NOT = ZERO
03062          MOVE FPIDI      TO CF-FORMS-PRINTER-ID.
03063      IF CPIDL NOT = ZERO
03064          MOVE CPIDI      TO CF-CHECK-PRINTER-ID.
03065      IF NEXTCOL NOT = ZERO
03066         MOVE NEXTCOI     TO CF-NEXT-COMPANY-ID.
03067      IF CLMREJL NOT = ZERO
03068          MOVE CLMREJI    TO CF-CO-CLAIM-REJECT-SW.
03069
03070      IF ARSYSL NOT = ZERO
03071         IF ARSYSI = 'Y' OR 'N' OR ' '
03072             MOVE ARSYSI          TO PI-AR-PROCESSING-CNTL
03073                                     CF-SYSTEM-E
03074             MOVE LOW-VALUES      TO CF-AR-LAST-EL860-DT
03075                                     CF-AR-MONTH-END-DT.
03076      IF TAXIDL NOT = ZERO
03077         MOVE TAXIDI              TO CF-TAX-ID-NUMBER.
03078      IF CLSYSL NOT = ZERO
03079         MOVE CLSYSI              TO CF-LGX-CLAIM-USER.
03080      IF MPSYSL NOT = ZERO
03081         MOVE MPSYSI              TO CF-LGX-LIFE-USER.
03082      IF CCSYSL NOT = ZERO
03083         MOVE CCSYSI              TO CF-CRDTCRD-USER.
03084
03085      IF EUSYSL NOT = ZERO
03086         IF EUSYSI = 'Y' OR 'N' OR ' '
03087             MOVE EUSYSI          TO CF-END-USER-REPORTING-USER.
03088
03089      IF LCCODEL NOT = ZERO
03090         MOVE LCCODEI             TO CF-LOWER-CASE-LETTERS.
03091      IF CRSYSL NOT = ZERO
03092         MOVE CRSYSI              TO CF-LGX-CREDIT-USER.
03093      IF MEMBCAPL NOT = ZERO
03094         MOVE MEMBCAPI            TO CF-MEMBER-CAPTION.
03095      IF LFOVR1L NOT = ZERO
03096          MOVE LFOVR1I            TO CF-LIFE-OVERRIDE-L1
03097                                     PI-LIFE-OVERRIDE-L1.
03098      IF LFOVR2L NOT = ZERO
03099          MOVE LFOVR2I            TO CF-LIFE-OVERRIDE-L2
03100                                     PI-LIFE-OVERRIDE-L2.
03101      IF LFOVR6L NOT = ZERO
03102          MOVE LFOVR6I            TO CF-LIFE-OVERRIDE-L6
03103                                     PI-LIFE-OVERRIDE-L6.
03104      IF LFOVR12L NOT = ZERO
03105          MOVE LFOVR12I           TO CF-LIFE-OVERRIDE-L12
03106                                     PI-LIFE-OVERRIDE-L12.
03107      IF AHOVR1L NOT = ZERO
03108          MOVE AHOVR1I            TO CF-AH-OVERRIDE-L1
03109                                     PI-AH-OVERRIDE-L1.
03110      IF AHOVR2L NOT = ZERO
03111          MOVE AHOVR2I            TO CF-AH-OVERRIDE-L2
03112                                     PI-AH-OVERRIDE-L2.
03113      IF AHOVR6L NOT = ZERO
03114          MOVE AHOVR6I            TO CF-AH-OVERRIDE-L6
03115                                     PI-AH-OVERRIDE-L6.
03116      IF AHOVR12L NOT = ZERO
03117          MOVE AHOVR12I           TO CF-AH-OVERRIDE-L12
03118                                     PI-AH-OVERRIDE-L12.
03119      IF RPTCD1L NOT = ZERO
03120         MOVE RPTCD1I             TO CF-REPORT-CD1-CAPTION.
03121      IF RPTCD2L NOT = ZERO
03122         MOVE RPTCD2I             TO CF-REPORT-CD2-CAPTION.
03123
03124      IF MORTMEL NOT = ZERO
03125          MOVE WS-SAVE-MORTMEDT   TO CF-MP-MONTH-END-DT.
03126
03127      IF CURRMEL NOT = ZERO
03128          MOVE WS-SAVE-CURRMEDT   TO CF-CURRENT-MONTH-END.
03129      IF CREDMEL NOT = ZERO
03130          MOVE WS-SAVE-CREDMEDT   TO CF-CR-MONTH-END-DT.
03131      IF ARMEL   NOT = ZERO
03132          MOVE WS-SAVE-ARMEDT     TO CF-AR-MONTH-END-DT.
03133      IF AR860DTL NOT = ZERO
03134          MOVE WS-SAVE-AR860DT    TO CF-AR-LAST-EL860-DT.
03135
03136      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03137                              PI-UPDATE-BY.
03138      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03139                              PI-UPDATE-HHMMSS.
03140
03141      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03142      MOVE 'C'           TO JP-RECORD-TYPE.
03143      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03144      EXEC CICS REWRITE
03145          DATASET('ELCNTL')
03146          FROM   (CONTROL-FILE)
03147      END-EXEC.
03148
03149      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03150      MOVE ER-0000 TO EMI-ERROR.
03151      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03152
03153 * UPDATE MORTGAGE COMPANY RECORD IF M/E DATE CHANGED
03154      IF MORTMEL = ZERO
03155          GO TO 7000-BUILD-INITIAL-MAP.
03156
03157      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03158      MOVE 'N'           TO CK-REC-TYPE.
03159
03160      EXEC CICS READ
03161          UPDATE
03162          DATASET('ELCNTL')
03163          SET    (ADDRESS OF CONTROL-FILE)
03164          RIDFLD (ELCNTL-KEY)
03165      END-EXEC.
03166
03167      IF (CF-LAST-MAINT-BY     NOT = PI-MORTG-CO-UPDATE-BY)
03168                            OR
03169         (CF-LAST-MAINT-HHMMSS NOT = PI-MORTG-CO-UPDATE-HHMMSS)
03170          EXEC CICS UNLOCK
03171              DATASET('ELCNTL')
03172          END-EXEC
03173          MOVE ER-0068 TO EMI-ERROR
03174          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03175          GO TO 7000-BUILD-INITIAL-MAP.
03176
03177      MOVE 'B'          TO JP-RECORD-TYPE.
03178      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03179      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03180
03181      MOVE WS-SAVE-MORTMEDT   TO CF-MORTG-MONTH-END-DT.
03182      MOVE SPACES TO CF-MORTG-BILLING-AREA.
03183
03184      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03185                              PI-MORTG-CO-UPDATE-BY.
03186      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03187                              PI-MORTG-CO-UPDATE-HHMMSS.
03188
03189      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03190      MOVE 'C'           TO JP-RECORD-TYPE.
03191      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03192      EXEC CICS REWRITE
03193          DATASET('ELCNTL')
03194          FROM   (CONTROL-FILE)
03195      END-EXEC.
03196
03197      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03198      MOVE ER-0000 TO EMI-ERROR.
03199      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03200
03201      GO TO 7000-BUILD-INITIAL-MAP.
03202
03203      EJECT
03204  2000-UPDATE-FILE.
03205 *    UPDATE FIELDS FROM MAP B
03206
03207      IF ZERO = APPROVL  AND
03208                LSTCLML  AND
03209                LSTARCHL AND
03210                STARCHL  AND
03211                LSTCHKL  AND
03212                CLMTOLL  AND
03213                LSTQUEL  AND
03214                CARRCLL  AND
03215                CLMREJL  AND
03216                COFFDTL  AND
03217                PMTSCHKL AND
03218                THRUTOL  AND
03219                RSVOPSWL AND
03220                IBLGMTHL AND
03221                CIDADISL AND
03222                CRDTBLUL AND
03223                CALCINTL AND
03224                IBNRLFFL AND
03225                IBNRAHFL AND
03226                OPTDTEL  AND
03227                LLEV1L   AND
03228                LLEV2L   AND
03229                LLEV3L   AND
03230                ALEV1L   AND
03231                ALEV2L   AND
03232                ALEV3L
03233         GO TO 7200-BUILD-INITIAL-MAP.
03234
03235      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03236      MOVE '1'           TO CK-REC-TYPE.
03237      EXEC CICS READ
03238          UPDATE
03239          DATASET('ELCNTL')
03240          SET    (ADDRESS OF CONTROL-FILE)
03241          RIDFLD (ELCNTL-KEY)
03242      END-EXEC.
03243
03244      IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY     OR
03245         CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
03246          EXEC CICS UNLOCK
03247              DATASET('ELCNTL')
03248          END-EXEC
03249          MOVE ER-0068 TO EMI-ERROR
03250          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03251          GO TO 7200-BUILD-INITIAL-MAP.
03252
03253      MOVE 'B'          TO JP-RECORD-TYPE.
03254      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03255      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03256
03257      IF APPROVL NOT = ZERO
03258         MOVE APPROVI     TO CF-PAYMENT-APPROVAL-SW.
03259
03260      IF CF-PAYMENT-APPROVAL-SW NOT = 'G'
03261         MOVE ZEROS       TO CF-LIFE-PAY-APP-LEVEL-1
03262                             CF-LIFE-PAY-APP-LEVEL-2
03263                             CF-LIFE-PAY-APP-LEVEL-3
03264                             CF-AH-PAY-APP-LEVEL-1
03265                             CF-AH-PAY-APP-LEVEL-2
03266                             CF-AH-PAY-APP-LEVEL-3
03267         GO TO 2010-CONTINUE.
03268
03269      IF LLEV1L NOT = ZERO
03270         MOVE SV-LLEV1    TO CF-LIFE-PAY-APP-LEVEL-1.
03271      IF LLEV2L NOT = ZERO
03272         MOVE SV-LLEV2    TO CF-LIFE-PAY-APP-LEVEL-2.
03273      IF LLEV3L NOT = ZERO
03274         MOVE SV-LLEV3    TO CF-LIFE-PAY-APP-LEVEL-3.
03275
03276      IF ALEV1L NOT = ZERO
03277         MOVE SV-ALEV1    TO CF-AH-PAY-APP-LEVEL-1.
03278      IF ALEV2L NOT = ZERO
03279         MOVE SV-ALEV2    TO CF-AH-PAY-APP-LEVEL-2.
03280      IF ALEV3L NOT = ZERO
03281         MOVE SV-ALEV3    TO CF-AH-PAY-APP-LEVEL-3.
03282
03283  2010-CONTINUE.
03284      IF LSTCLML NOT = ZERO
03285          MOVE LSTCLMI    TO CF-CO-CLAIM-COUNTER.
03286      IF LSTARCHL NOT = ZERO
03287          MOVE LSTARCHI   TO CF-CO-ARCHIVE-COUNTER.
03288      IF STARCHL NOT = ZERO
03289          MOVE STARCHI    TO CF-STARTING-ARCH-NO.
03290      IF LSTCHKL NOT = ZERO
03291          MOVE LSTCHKI    TO CF-CO-CHECK-COUNTER.
03292      IF CLMTOLL NOT = ZERO
03293          MOVE SV-CLMTOL  TO CF-CO-TOL-CLAIM.
03294      IF LSTQUEL NOT = ZERO
03295          MOVE LSTQUEI    TO CF-CO-CHECK-QUE-COUNTER.
03296      IF CARRCLL NOT = ZERO
03297         MOVE CARRCLI     TO CF-CARRIER-CONTROL-LEVEL.
03298      IF CLMREJL NOT = ZERO
03299         MOVE CLMREJI     TO CF-CO-CLAIM-REJECT-SW.
03300      IF COFFDTL NOT = ZERO
03301         MOVE WS-SAVE-COFFDTE TO CF-CLAIM-CUTOFF-DATE.
03302      IF PMTSCHKL NOT = ZERO
03303         MOVE PMTSCHKI TO CF-MAX-NUM-PMTS-CHECK.
03304      IF THRUTOL NOT = ZERO
03305         MOVE THRUTOI TO CF-CLAIM-PAID-THRU-TO.
03306
03307      IF ADDRLBLL NOT = ZERO
03308         IF ADDRLBLI = ' ' OR 'N'
03309             MOVE 'N'             TO  CF-PRINT-ADDRESS-LABELS
03310         ELSE
03311             MOVE 'Y'             TO  CF-PRINT-ADDRESS-LABELS.
03312
03313      IF RECONL NOT = ZERO
03314         IF (RECONI = ' ' OR 'N')
03315             MOVE 'N'             TO  CF-CLAIMS-CHECK-RECON-USER
03316         ELSE
03317             MOVE 'Y'             TO  CF-CLAIMS-CHECK-RECON-USER.
03318
03319      IF PROCDTL NOT = ZERO
03320          MOVE WS-SAVE-PROCDT     TO  CF-CLAIMS-LAST-PROCESS-DT.
03321
03322      IF AUDCLCGL NOT = ZERO
03323         IF (AUDCLCGI = ' ' OR 'N')
03324             MOVE 'N'             TO  CF-CLAIMS-AUDIT-CHANGES
03325         ELSE
03326            IF  AUDCLCGI = 'Y'
03327                MOVE 'Y'          TO  CF-CLAIMS-AUDIT-CHANGES
03328            ELSE
03329                MOVE -1           TO AUDCLCGL
03330                MOVE AL-UNBON     TO AUDCLCGA
03331                MOVE ER-8129      TO EMI-ERROR
03332                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03333
03334      IF CRDCDINL NOT = ZERO
03335         IF (CRDCDINI = ' ' OR 'N')
03336             MOVE 'N'             TO  CF-CLAIMS-CREDIT-CARD-INDEX
03337         ELSE
03338             IF CRDCDINI = 'Y'
03339                MOVE 'Y'          TO  CF-CLAIMS-CREDIT-CARD-INDEX
03340             ELSE
03341                MOVE -1           TO CRDCDINL
03342                MOVE AL-UNBON     TO CRDCDINA
03343                MOVE ER-8132      TO EMI-ERROR
03344                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03345
03346      IF LTRMTDTL NOT = ZERO
03347         IF LTRMTDTI NUMERIC
03348            MOVE LTRMTDTI         TO CF-CLAIMS-LETTER-MAINT-DAYS
03349         ELSE
03350            MOVE -1               TO LTRMTDTL
03351            MOVE AL-UNBON         TO LTRMTDTA
03352            MOVE ER-8130          TO EMI-ERROR
03353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03354
03355      IF  EXPRETNL NOT = ZERO
03356          MOVE W-EXPRETN          TO CF-EXPERIENCE-RETENTION-AGE.
03357
03358      IF  RSVOPSWL NOT = ZERO
03359
03360          IF  RSVOPSWI = ' ' OR 'N' OR LOW-VALUES
03361              MOVE 'N'            TO CF-CO-RESERVE-OPTION-SWITCH
03362
03363          ELSE
03364              MOVE 'Y'            TO CF-CO-RESERVE-OPTION-SWITCH.
03365
03366      IF  IBLGMTHL NOT = ZERO
03367          MOVE W-IBLGMTH          TO CF-CO-IBNR-LAG-MONTHS.
03368
03369      IF  CIDADISL NOT = ZERO
03370          MOVE W-CIDADIS          TO CF-CO-CIDA-TABLE-DISCOUNT-PCT.
03371
03372      IF  CRDTBLUL NOT = ZERO
03373
03374          IF  CF-CO-RESERVE-OPTION-SWITCH EQUAL 'Y'
03375                  AND
03376              CRDTBLUI NOT GREATER THAN SPACES
03377              MOVE '9'            TO CF-CO-CRDB-TABLE-SELECTION
03378
03379          ELSE
03380              MOVE CRDTBLUI       TO CF-CO-CRDB-TABLE-SELECTION.
03381
03382      IF  CALCINTL NOT = ZERO
03383          MOVE W-CALCINT          TO CF-CO-CALCULATION-INTEREST.
03384
03385      IF  IBNRLFFL NOT = ZERO
03386          MOVE W-IBNRLFF          TO CF-CO-IBNR-LIFE-FACTOR.
03387
03388      IF  IBNRAHFL NOT = ZERO
03389          MOVE W-IBNRAHF          TO CF-CO-IBNR-AH-FACTOR.
03390
03391      IF  OPTDTEL NOT = ZERO
03392          MOVE W-OPTDTE           TO CF-CO-OPTION-START-DATE.
03393
03394      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY  PI-UPDATE-BY.
03395      MOVE EIBTIME TO CF-LAST-MAINT-HHMMSS      PI-UPDATE-HHMMSS.
03396
03397      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03398      MOVE 'C'           TO JP-RECORD-TYPE.
03399      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03400      EXEC CICS REWRITE
03401          DATASET('ELCNTL')
03402          FROM   (CONTROL-FILE)
03403      END-EXEC.
03404
03405      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03406
03407      IF  EMI-FATAL-CTR GREATER THAN ZEROS
03408          GO TO 8210-SEND-DATAONLY.
03409
03410      MOVE ER-0000 TO EMI-ERROR.
03411      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03412      MOVE -1                        TO CARRCLL.
03413
03414      GO TO 8210-SEND-DATAONLY.
03415
03416      EJECT
03417  3000-UPDATE-FILE.
03418 *    UPDATE FIELDS FROM MAP C
03419
03420      EXEC CICS HANDLE CONDITION
03421          NOTFND(8880-NOT-FOUND)
03422      END-EXEC.
03423
03424      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03425      MOVE '1'           TO CK-REC-TYPE.
03426      EXEC CICS READ
03427          UPDATE
03428          DATASET('ELCNTL')
03429          SET    (ADDRESS OF CONTROL-FILE)
03430          RIDFLD (ELCNTL-KEY)
03431      END-EXEC.
03432
03433      IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY     OR
03434         CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
03435          EXEC CICS UNLOCK
03436              DATASET('ELCNTL')
03437          END-EXEC
03438          MOVE ER-0068 TO EMI-ERROR
03439          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03440          GO TO 7300-BUILD-INITIAL-MAP.
03441
03442      MOVE 'B'          TO JP-RECORD-TYPE.
03443      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03444      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03445
03446      IF CRTACSL NOT = ZERO
03447          MOVE CRTACSI    TO CF-CERT-ACCESS-CONTROL.
03448      IF REMTRML NOT = ZERO
03449          MOVE REMTRMI    TO CF-CR-REM-TERM-CALC.
03450      IF R78MTHL NOT = ZERO
03451          MOVE R78MTHI    TO CF-CR-R78-METHOD.
03452      IF TRMOPTNL NOT = ZERO
03453          MOVE TRMOPTNI   TO CF-REM-TRM-CALC-OPTION
03454                             PI-REM-TRM-CALC-OPTION.
03455      IF DABILLL NOT = ZERO
03456         IF DABILLI = 'Y'
03457            MOVE '1'      TO CF-SYSTEM-D
03458         ELSE
03459            MOVE ' '      TO CF-SYSTEM-D.
03460
03461      IF SSNL NOT = ZERO
03462         IF SSNI = 'Y'
03463            MOVE '1'      TO CF-SOC-SEC-NO-SW
03464         ELSE
03465            MOVE ' '      TO CF-SOC-SEC-NO-SW.
03466
03467      IF  AGECALCL NOT = ZERO
03468          MOVE AGECALCI   TO CF-MORTALITY-AGE-CALC-METHOD.
03469
03470      IF CONSYSL NOT = ZERO
03471         IF CONSYSI = 'Y'
03472            MOVE '1'      TO CF-SYSTEM-C
03473         ELSE
03474            MOVE ' '      TO CF-SYSTEM-C.
03475
03476      IF MEMBNOL NOT = ZERO
03477         IF MEMBNOI = 'Y'
03478            MOVE '1'      TO CF-MEMBER-NO-SW
03479         ELSE
03480            MOVE ' '      TO CF-MEMBER-NO-SW.
03481
03482      IF MAILL NOT = ZERO
03483         IF MAILI = 'Y' OR 'N' OR ' '
03484             MOVE MAILI           TO PI-MAIL-PROCESSING
03485                                     CF-MAIL-PROCESSING.
03486      IF AMRTCDL NOT = ZERO
03487          MOVE AMRTCDI    TO CF-ALT-MORT-CODE.
03488      IF QTECALL NOT = ZERO
03489          MOVE SV-QTECAL  TO CF-CO-TOL-PREM.
03490      IF QTEREFL NOT = ZERO
03491          MOVE SV-QTEREF  TO CF-CO-TOL-REFUND.
03492      IF OVSAMTL > +0
03493         MOVE SV-OVSAMT  TO CF-CO-OVR-SHT-AMT
03494                            OVSAMTO.
03495
03496      IF MINPREML NOT = ZERO
03497          MOVE SV-MINPREM TO CF-MIN-PREMIUM.
03498      IF COMPWTEL NOT = ZERO
03499          MOVE SV-COMPWTE TO CF-COMP-WRITE-OFF-AMT.
03500      IF MINAGEL NOT = ZERO
03501         MOVE MINAGEI     TO CF-MIN-AGE.
03502
03503      MOVE ZERO           TO CF-MIN-TERM.
03504
03505      IF MAXTERML NOT = ZERO
03506         MOVE MAXTERMI    TO CF-MAX-TERM.
03507      IF PREJCTL NOT = ZERO
03508         MOVE PREJCTI     TO CF-CO-PREM-REJECT-SW.
03509      IF REFREJL NOT = ZERO
03510         MOVE REFREJI     TO CF-CO-REF-REJECT-SW.
03511      IF DAGEL NOT = ZERO
03512         MOVE DAGEI       TO CF-DEFAULT-AGE.
03513      IF DSEXL NOT = ZERO
03514         MOVE DSEXI       TO CF-DEFAULT-SEX.
03515
03516      IF DAPRL NOT = ZERO
03517         MOVE SV-DAPR     TO CF-DEFAULT-APR.
03518
03519      IF JAGEL NOT = ZERO
03520         IF JAGEI = 'Y'
03521            MOVE '1'                 TO CF-JOINT-AGE-INPUT
03522           ELSE
03523            MOVE SPACE               TO CF-JOINT-AGE-INPUT.
03524
03525      IF PRCESSFL NOT = ZERO
03526         IF PRCESSFI = 'Q'
03527            MOVE '1'                 TO CF-RUN-FREQUENCY-SW
03528           ELSE
03529            MOVE SPACE               TO CF-RUN-FREQUENCY-SW.
03530
03531      IF BINPUTL NOT = ZERO
03532         IF BINPUTI = 'Y'
03533            MOVE '1'                 TO CF-BIRTH-DATE-INPUT
03534           ELSE
03535            MOVE SPACE               TO CF-BIRTH-DATE-INPUT.
03536
03537      IF MTOLCAPL NOT = ZERO
03538          MOVE SV-MTOLCAP      TO CF-CO-TOL-CAP.
03539
03540      IF PRMPCTL NOT = ZERO
03541         MOVE WS-TOL-PREM-PCT     TO CF-CO-TOL-PREM-PCT.
03542
03543      IF OVSPCTL > +0
03544         MOVE WS-CO-OVR-SHT-PCT TO CF-CO-OVR-SHT-PCT
03545                                   OVSPCTO.
03546
03547      IF REFPCTL NOT = ZERO
03548         MOVE WS-TOL-REFUND-PCT   TO   CF-CO-TOL-REFUND-PCT.
03549
03550      IF CONDTEL NOT = ZERO
03551         MOVE WS-SAVE-CONDTE   TO CF-CONVERSION-DT.
03552
03553      IF LSTBTCHL NOT = ZERO
03554          MOVE LSTBTCHI        TO CF-LAST-BATCH-NO.
03555
03556      IF CMETHODL NOT = ZERO
03557         MOVE CMETHODI         TO CF-CR-CHECK-NO-METHOD.
03558
03559      IF CARGRPOL NOT = ZERO
03560         MOVE CARGRPOI         TO CF-CAR-GROUP-ACCESS-CNTL.
03561
03562      IF STCNTLL NOT = ZERO
03563         MOVE STCNTLI          TO CF-CO-ST-CALL-RPT-CNTL.
03564
03565      IF ARCHSTL NOT = ZERO
03566         MOVE ARCHSTI          TO CF-CREDIT-START-ARCH-NUM
03567
03568      ELSE
03569          IF  CF-CREDIT-START-ARCH-NUM NOT NUMERIC
03570              MOVE ZEROS       TO CF-CREDIT-START-ARCH-NUM.
03571
03572      IF ARCHLSTL NOT = ZERO
03573         MOVE ARCHLSTI         TO CF-CREDIT-LAST-ARCH-NUM
03574
03575      ELSE
03576          IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
03577              MOVE ZEROS       TO CF-CREDIT-LAST-ARCH-NUM.
03578
03579      IF ARCHPYRL NOT = ZERO
03580         MOVE ARCHPYRI         TO CF-CREDIT-ARCH-PURGE-YR.
03581
03582      IF CKCOUNTL NOT = ZERO
03583         MOVE CKCOUNTI         TO CF-CR-CHECK-COUNTER.
03584
03585      IF QUCOUNTL NOT = ZERO
03586         MOVE QUCOUNTI         TO CF-CR-CHECK-QUE-COUNTER.
03587
03588      IF CRLABELL NOT = ZERO
03589         MOVE CRLABELI         TO CF-CR-PRINT-ADDRESS-LABELS.
03590
03591      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03592                              PI-UPDATE-BY.
03593      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03594                              PI-UPDATE-HHMMSS.
03595
03596      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03597      MOVE 'C'           TO JP-RECORD-TYPE.
03598      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03599      EXEC CICS REWRITE
03600          DATASET('ELCNTL')
03601          FROM   (CONTROL-FILE)
03602      END-EXEC.
03603
03604      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03605      MOVE ER-0000 TO EMI-ERROR.
03606      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03607      MOVE -1                     TO PREJCTL.
03608
03609      GO TO 8220-SEND-DATAONLY.
03610
03611      EJECT
03612  4000-UPDATE-FILE.
03613 *    UPDATE FIELDS FROM MAP D
03614
03615      EXEC CICS HANDLE CONDITION
03616          NOTFND(8880-NOT-FOUND)
03617      END-EXEC.
03618
03619      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03620      MOVE 'N'           TO CK-REC-TYPE.
03621      EXEC CICS READ
03622          UPDATE
03623          DATASET('ELCNTL')
03624          SET    (ADDRESS OF CONTROL-FILE)
03625          RIDFLD (ELCNTL-KEY)
03626      END-EXEC.
03627
03628      IF CF-LAST-MAINT-BY     NOT = PI-MORTG-CO-UPDATE-BY    OR
03629         CF-LAST-MAINT-HHMMSS NOT = PI-MORTG-CO-UPDATE-HHMMSS
03630          EXEC CICS UNLOCK
03631              DATASET('ELCNTL')
03632          END-EXEC
03633          MOVE ER-0068 TO EMI-ERROR
03634          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03635          GO TO 7400-BUILD-INITIAL-MAP.
03636
03637      MOVE 'B'          TO JP-RECORD-TYPE.
03638      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03639      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03640
03641      IF MIBVERL NOT EQUAL ZERO
03642          MOVE MIBVERI TO CF-MORTG-MIB-VERSION.
03643
03644      IF DAMRTCDL NOT EQUAL ZERO
03645          MOVE DAMRTCDI TO CF-MORTG-ALT-MORT-CODE.
03646
03647      IF LNMESERL NOT EQUAL ZERO
03648          MOVE LNMESERI TO WS-LNAME-SEARCH-CNTL
03649          MOVE WS-MIB-LNAME-SEARCH TO CF-MORTG-MIB-LNAME-SEARCH
03650          MOVE WS-ALP-LNAME-SEARCH TO CF-MORTG-ALP-LNAME-SEARCH.
03651
03652      IF FNMESERL NOT EQUAL ZERO
03653          MOVE FNMESERI TO WS-FNAME-SEARCH-CNTL
03654          MOVE WS-MIB-FNAME-SEARCH TO CF-MORTG-MIB-FNAME-SEARCH
03655          MOVE WS-ALP-FNAME-SEARCH TO CF-MORTG-ALP-FNAME-SEARCH.
03656
03657      IF MNMESERL NOT EQUAL ZERO
03658          MOVE MNMESERI TO WS-MNAME-SEARCH-CNTL
03659          MOVE WS-MIB-MNAME-SEARCH TO CF-MORTG-MIB-MNAME-SEARCH
03660          MOVE WS-ALP-MNAME-SEARCH TO CF-MORTG-ALP-MNAME-SEARCH.
03661
03662      IF BDATEL NOT EQUAL ZERO
03663          MOVE BDATEI TO WS-BDATE-SEARCH-CNTL
03664          MOVE WS-MIB-BDATE-SEARCH TO CF-MORTG-MIB-BDATE-SEARCH
03665          MOVE WS-ALP-BDATE-SEARCH TO CF-MORTG-ALP-BDATE-SEARCH.
03666
03667      IF BSTATEL NOT EQUAL ZERO
03668          MOVE BSTATEI TO WS-BSTATE-SEARCH-CNTL
03669          MOVE WS-MIB-BSTATE-SEARCH TO CF-MORTG-MIB-BSTATE-SEARCH
03670          MOVE WS-ALP-BSTATE-SEARCH TO CF-MORTG-ALP-BSTATE-SEARCH.
03671
03672      IF RSTATEL NOT EQUAL ZERO
03673          MOVE RSTATEI TO WS-RSTATE-SEARCH-CNTL
03674          MOVE WS-MIB-RSTATE-SEARCH TO CF-MORTG-MIB-RSTATE-SEARCH
03675          MOVE WS-ALP-RSTATE-SEARCH TO CF-MORTG-ALP-RSTATE-SEARCH.
03676
03677      IF MIBSYML NOT EQUAL ZERO
03678          MOVE MIBSYMI TO CF-MORTG-MIB-COMPANY-SYMBOL.
03679
03680      IF MGCNTLL NOT EQUAL ZERO
03681          MOVE MGCNTLI TO CF-MORTG-ACCESS-CONTROL.
03682
03683      IF MIBCOMML NOT EQUAL ZERO
03684          MOVE MIBCOMMI TO CF-MORTG-MIB-COMM.
03685
03686      IF MIBCSWL NOT EQUAL ZERO
03687          IF MIBCSWI EQUAL 'Y'
03688              MOVE '1' TO CF-MORTG-MIB-DEST-SW.
03689
03690      IF MIBTSWL NOT EQUAL ZERO
03691          IF MIBTSWI EQUAL 'Y'
03692              MOVE '2' TO CF-MORTG-MIB-DEST-SW.
03693
03694      IF (MIBCSWL NOT EQUAL ZERO) AND
03695         (MIBTSWL NOT EQUAL ZERO)
03696          IF (MIBCSWI EQUAL 'N') AND
03697             (MIBTSWI EQUAL 'N')
03698              MOVE '0' TO CF-MORTG-MIB-DEST-SW.
03699
03700      IF MIBTERML NOT EQUAL ZERO
03701          MOVE MIBTERMI TO CF-MORTG-MIB-TERM.
03702
03703      IF CF-MORTG-MIB-VERSION EQUAL '0'
03704         IF CF-MORTG-MIB-DEST-SW EQUAL '1' OR '2'
03705             EXEC CICS UNLOCK
03706                DATASET('ELCNTL')
03707             END-EXEC
03708             MOVE AL-UABON TO MIBCSWA
03709             MOVE -1       TO MIBCSWL
03710             MOVE ER-9460  TO EMI-ERROR
03711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03712             GO TO 8230-SEND-DATAONLY.
03713
03714      IF GRPSWL NOT EQUAL ZERO
03715          MOVE GRPSWI             TO CF-MORTG-BILL-GROUPING-CODE.
03716      IF RATESWL NOT EQUAL ZERO
03717          MOVE RATESWI            TO CF-RATE-DEV-AUTHORIZATION.
03718      IF RATFILCL NOT = ZERO
03719         MOVE WS-SAVE-RTEFILC  TO CF-MORTG-RATE-FILE-CREAT-DATE.
03720
03721      IF PI-USER-ALMIGHTY-YES
03722          IF STARCHNL NOT = ZERO
03723              IF STARCHNI NOT NUMERIC
03724                  MOVE -1         TO STARCHNL
03725                  MOVE AL-UNBON   TO STARCHNA
03726                  MOVE ER-0611    TO EMI-ERROR
03727                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03728              ELSE
03729                  MOVE AL-UNNON   TO STARCHNA
03730                  MOVE STARCHNI   TO CF-MORTG-START-ARCH-NUM.
03731
03732      IF PI-USER-ALMIGHTY-YES
03733          IF ARCHNBRL NOT = ZERO
03734              IF ARCHNBRI NOT NUMERIC
03735                  MOVE -1         TO ARCHNBRL
03736                  MOVE AL-UNBON   TO ARCHNBRA
03737                  MOVE ER-0611    TO EMI-ERROR
03738                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03739              ELSE
03740                  MOVE AL-UNNON   TO ARCHNBRA
03741                  MOVE ARCHNBRI   TO CF-MORTG-CURRENT-ARCH-NUM.
03742
03743      IF PI-PROCESSOR-ID = 'LGXX'
03744         IF LABCNTLL NOT EQUAL ZERO
03745             MOVE LABCNTLI        TO CF-MORTG-LABEL-CONTROL.
03746
03747      IF PI-PROCESSOR-ID = 'LGXX'
03748         IF BCYCLE1L NOT EQUAL ZERO
03749             MOVE BCYCLE1I TO CF-MORTG-BILL-CYCLE (1).
03750
03751      IF PI-PROCESSOR-ID = 'LGXX'
03752         IF BCYCLE2L NOT EQUAL ZERO
03753             MOVE BCYCLE2I TO CF-MORTG-BILL-CYCLE (2).
03754
03755      IF PI-PROCESSOR-ID = 'LGXX'
03756         IF BCYCLE3L NOT EQUAL ZERO
03757             MOVE BCYCLE3I TO CF-MORTG-BILL-CYCLE (3).
03758
03759      IF PI-PROCESSOR-ID = 'LGXX'
03760         IF BCYCLE4L NOT EQUAL ZERO
03761             MOVE BCYCLE4I TO CF-MORTG-BILL-CYCLE (4).
03762
03763      IF PI-PROCESSOR-ID = 'LGXX'
03764         IF BCYCLE5L NOT EQUAL ZERO
03765             MOVE BCYCLE5I TO CF-MORTG-BILL-CYCLE (5).
03766
03767      IF  PI-PROCESSOR-ID = 'LGXX'
03768          MOVE SV-MORTG-REF-NUM
03769                              TO CF-MORTG-SOLICITATION-NUM.
03770
03771      IF  PI-PROCESSOR-ID = 'LGXX'
03772          MOVE AUTOREFI       TO CF-ASSIGN-POLICY-NO-SW.
03773
03774      IF  PI-PROCESSOR-ID = 'LGXX'
03775          MOVE SHFTLNOI       TO CF-MORTG-LOAN-SHIFT-IND.
03776
03777      IF  PI-PROCESSOR-ID = 'LGXX'
03778          MOVE CHKPMTHI       TO CF-MP-CHECK-NO-METHOD.
03779
03780      IF  PI-PROCESSOR-ID = 'LGXX'
03781          MOVE MRECONI        TO CF-MP-RECON-USE-IND.
03782
03783      IF  RPTLANGA NOT = ZERO
03784          MOVE RPTLANGI       TO CF-MP-REPORT-LANGUAGE-IND.
03785
03786      IF  PLCYLNKA NOT = ZERO
03787          MOVE PLCYLNKI       TO CF-MP-POLICY-LINKAGE-IND.
03788
03789      IF RATFILML NOT = ZERO
03790         MOVE WS-SAVE-RTEFILM  TO CF-MORTG-RATE-FILE-MAINT-DATE.
03791
03792      IF PRDMSTCL NOT = ZERO
03793         MOVE WS-SAVE-PRDMSTC  TO CF-MORTG-PROD-FILE-CREAT-DATE.
03794
03795      IF PRDMSTML NOT = ZERO
03796         MOVE WS-SAVE-PRDMSTM  TO CF-MORTG-PROD-FILE-MAINT-DATE.
03797
03798      IF CNVDTEL NOT = ZERO
03799         MOVE WS-SAVE-CONDTE   TO CF-MORTG-CONVERSION-DATE.
03800
03801      IF CHKCNTRL NOT = ZERO
03802         MOVE CHKCNTRI         TO CF-MORTG-CHECK-NO-COUNTER.
03803
03804      IF QUECNTRL NOT = ZERO
03805         MOVE QUECNTRI         TO CF-MORTG-CHECK-QUEUE-COUNTER.
03806
03807      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03808                              PI-MORTG-CO-UPDATE-BY.
03809      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03810                              PI-MORTG-CO-UPDATE-HHMMSS.
03811
03812      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03813      MOVE 'C'           TO JP-RECORD-TYPE.
03814      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03815      EXEC CICS REWRITE
03816          DATASET('ELCNTL')
03817          FROM   (CONTROL-FILE)
03818      END-EXEC.
03819
03820      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03821      MOVE ER-0000 TO EMI-ERROR.
03822      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03823      MOVE -1                     TO MIBSYML.
03824
03825      IF RENTBLCL  = ZERO AND
03826         COMMSTCL  = ZERO AND
03827         RENTBLML  = ZERO AND
03828         COMMSTML  = ZERO AND
03829         DRESURL   = ZERO AND
03830         CMPCNTLL  = ZERO
03831          GO TO 8230-SEND-DATAONLY.
03832
03833      EXEC CICS HANDLE CONDITION
03834          NOTFND(8880-NOT-FOUND)
03835      END-EXEC.
03836
03837      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03838      MOVE '1'           TO CK-REC-TYPE.
03839      EXEC CICS READ
03840          UPDATE
03841          DATASET('ELCNTL')
03842          SET    (ADDRESS OF CONTROL-FILE)
03843          RIDFLD (ELCNTL-KEY)
03844      END-EXEC.
03845
03846      IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY     OR
03847         CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
03848          EXEC CICS UNLOCK
03849              DATASET('ELCNTL')
03850          END-EXEC
03851          MOVE ER-0068 TO EMI-ERROR
03852          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03853          GO TO 7400-BUILD-INITIAL-MAP.
03854
03855      MOVE 'B'          TO JP-RECORD-TYPE.
03856      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03857      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03858
03859      IF DRESURL NOT = ZERO
03860         IF DRESURI = 'Y'
03861            MOVE '1'              TO CF-REIN-TABLE-SW
03862           ELSE
03863            MOVE ' '              TO CF-REIN-TABLE-SW.
03864
03865      IF CMPCNTLL NOT = ZERO
03866         MOVE CMPCNTLI         TO CF-CAR-GROUP-ACCESS-CNTL.
03867
03868      IF RENTBLCL NOT = ZERO
03869         MOVE WS-SAVE-RENTABC  TO CF-REINSURANCE-TAB-CREATE-DT.
03870
03871      IF COMMSTCL NOT = ZERO
03872         MOVE WS-SAVE-CMPMSTC  TO CF-COMPENSATION-MSTR-CREATE-DT.
03873
03874      IF RENTBLML NOT = ZERO
03875         MOVE WS-SAVE-RENTABM  TO CF-REINSURANCE-TAB-MAINT-DT.
03876
03877      IF COMMSTML NOT = ZERO
03878         MOVE WS-SAVE-CMPMSTM  TO CF-COMPENSATION-MSTR-MAINT-DT.
03879
03880      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03881                              PI-UPDATE-BY.
03882      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03883                              PI-UPDATE-HHMMSS.
03884
03885      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03886      MOVE 'C'           TO JP-RECORD-TYPE.
03887      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03888      EXEC CICS REWRITE
03889          DATASET('ELCNTL')
03890          FROM   (CONTROL-FILE)
03891      END-EXEC.
03892
03893      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03894      MOVE ER-0000 TO EMI-ERROR.
03895      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03896      MOVE -1                     TO MIBSYML.
03897
03898      GO TO 8230-SEND-DATAONLY.
03899
03900      EJECT
03901  5000-UPDATE-FILE.
03902 *    UPDATE FIELDS FROM MAP E
03903
03904      EXEC CICS HANDLE CONDITION
03905          NOTFND(8880-NOT-FOUND)
03906      END-EXEC.
03907
03908      MOVE PI-COMPANY-ID TO CK-COMP-ID.
03909      MOVE '1'           TO CK-REC-TYPE.
03910      EXEC CICS READ
03911          UPDATE
03912          DATASET('ELCNTL')
03913          SET    (ADDRESS OF CONTROL-FILE)
03914          RIDFLD (ELCNTL-KEY)
03915      END-EXEC.
03916
03917      IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY     OR
03918         CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
03919          EXEC CICS UNLOCK
03920              DATASET('ELCNTL')
03921          END-EXEC
03922          MOVE ER-0068 TO EMI-ERROR
03923          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03924          GO TO 7500-BUILD-INITIAL-MAP.
03925
03926      MOVE 'B'          TO JP-RECORD-TYPE.
03927      MOVE CONTROL-FILE TO JP-RECORD-AREA.
03928      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03929
03930      IF COMTABCL NOT = ZERO
03931         MOVE WS-SAVE-COMTABC  TO CF-COMMISSION-TAB-CREATE-DT.
03932
03933      IF RTEFILCL NOT = ZERO
03934         MOVE WS-SAVE-RTEFILC  TO CF-RATES-FILE-CREATE-DT.
03935
03936      IF ACTMSTCL NOT = ZERO
03937         MOVE WS-SAVE-ACTMSTC  TO CF-ACCOUNT-MSTR-CREATE-DT.
03938
03939      IF RENTABCL NOT = ZERO
03940         MOVE WS-SAVE-RENTABC  TO CF-REINSURANCE-TAB-CREATE-DT.
03941
03942      IF CMPMSTCL NOT = ZERO
03943         MOVE WS-SAVE-CMPMSTC  TO CF-COMPENSATION-MSTR-CREATE-DT.
03944
03945      IF RTEFILML NOT = ZERO
03946         MOVE WS-SAVE-RTEFILM  TO CF-RATES-FILE-MAINT-DT.
03947
03948      IF COMTABML NOT = ZERO
03949         MOVE WS-SAVE-COMTABM  TO CF-COMMISSION-TAB-MAINT-DT.
03950
03951      IF ACTMSTML NOT = ZERO
03952         MOVE WS-SAVE-ACTMSTM  TO CF-ACCOUNT-MSTR-MAINT-DT.
03953
03954      IF RENTABML NOT = ZERO
03955         MOVE WS-SAVE-RENTABM  TO CF-REINSURANCE-TAB-MAINT-DT.
03956
03957      IF CMPMSTML NOT = ZERO
03958         MOVE WS-SAVE-CMPMSTM  TO CF-COMPENSATION-MSTR-MAINT-DT.
03959
03960      MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY
03961                              PI-UPDATE-BY.
03962      MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS
03963                              PI-UPDATE-HHMMSS.
03964
03965      MOVE SAVE-BIN-DATE TO CF-LAST-MAINT-DT.
03966      MOVE 'C'           TO JP-RECORD-TYPE.
03967      MOVE CONTROL-FILE  TO JP-RECORD-AREA.
03968      EXEC CICS REWRITE
03969          DATASET('ELCNTL')
03970          FROM   (CONTROL-FILE)
03971      END-EXEC.
03972
03973      PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
03974      MOVE ER-0000 TO EMI-ERROR.
03975      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03976      MOVE -1                     TO RTEFILML.
03977
03978      GO TO 8240-SEND-DATAONLY.
03979
03980      EJECT
03981  1500-VERIFY-NEXT-COMPANY.
03982      IF NEXTCOI = SPACES
03983         GO TO 1599-EXIT.
03984
03985      EXEC CICS HANDLE CONDITION
03986           NOTFND(1550-NOT-FOUND)
03987      END-EXEC.
03988
03989      EXEC CICS READ
03990           DATASET('ELCNTL')
03991           SET    (ADDRESS OF CONTROL-FILE)
03992           RIDFLD (WS-ELCNTL-KEY)
03993      END-EXEC.
03994
03995      IF PI-PROCESSOR-ID NOT = 'LGXX'
03996         MOVE '2'             TO WS-TYPE
03997         MOVE PI-PROCESSOR-ID TO WS-USER
03998         MOVE NEXTCOI         TO WS-COMP-ID
03999         MOVE +0              TO WS-SEQ
04000         EXEC CICS READ
04001           DATASET('ELCNTL')
04002           SET    (ADDRESS OF CONTROL-FILE)
04003           RIDFLD (WS-ELCNTL-KEY)
04004         END-EXEC.
04005
04006      MOVE CONTROL-FILE-SAVE-AREA TO CONTROL-FILE.
04007      MOVE AL-UANON               TO NEXTCOA.
04008      GO TO 1599-EXIT.
04009
04010  1550-NOT-FOUND.
04011      IF WS-TYPE = '1'
04012         MOVE ER-0089 TO EMI-ERROR
04013      ELSE
04014         MOVE ER-0228 TO EMI-ERROR.
04015
04016      MOVE -1       TO NEXTCOL.
04017      MOVE AL-UABON TO NEXTCOA.
04018      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04019      GO TO 8200-SEND-DATAONLY.
04020
04021  1599-EXIT.
04022      EXIT.
04023
04024      EJECT
04025  7000-BUILD-INITIAL-MAP.
04026 *    BUILD MAP A
04027
04028      MOVE LOW-VALUES TO EL102AO.
04029      MOVE PI-COMPANY-ID TO CK-COMP-ID.
04030      MOVE '1'           TO CK-REC-TYPE.
04031      EXEC CICS READ
04032          DATASET('ELCNTL')
04033          SET    (ADDRESS OF CONTROL-FILE)
04034          RIDFLD (ELCNTL-KEY)
04035      END-EXEC.
04036
04037      MOVE LOW-VALUES         TO WS-COMP-CD-R.
04038      MOVE CF-COMPANY-CD      TO WS-COMP-CD-X.
04039      MOVE WS-COMP-CD         TO COMPCDO.
04040      MOVE CF-CL-ADDR-LINE-1  TO ADDR1O.
04041      MOVE CF-CL-ADDR-LINE-2  TO ADDR2O.
04042      MOVE CF-CL-CITY-STATE   TO CITYSTO.
04043      MOVE CF-JOURNAL-FILE-ID TO JOURNIDO.
04044
04045      IF PI-PROCESSOR-ID = 'LGXX'
04046         MOVE AL-UNNON TO JOURNIDA
04047         MOVE AL-UANON TO LFOVR1A
04048                          LFOVR2A
04049                          LFOVR6A
04050                          LFOVR12A
04051                          AHOVR1A
04052                          AHOVR2A
04053                          AHOVR6A
04054                          AHOVR12A
04055      ELSE
04056         MOVE AL-SANON TO CRSYSA
04057         MOVE AL-SANON TO MPSYSA
04058         MOVE AL-SANOF TO JOURNIDA.
04059
04060      MOVE ' '              TO DC-OPTION-CODE.
04061      MOVE CF-LAST-MAINT-DT TO DC-BIN-DATE-1.
04062      MOVE LINK-ELDATCV     TO PGM-NAME.
04063      EXEC CICS LINK
04064          PROGRAM (PGM-NAME)
04065          COMMAREA(DATE-CONVERSION-DATA)
04066          LENGTH  (DC-COMM-LENGTH)
04067      END-EXEC.
04068
04069      MOVE CF-LAST-MAINT-BY       TO LSTUSRO.
04070      MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
04071      MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
04072      MOVE TIME-OUT               TO LSTTIMEO.
04073
04074      IF CF-CL-ZIP-CODE-NUM NUMERIC  AND
04075         CF-CL-ZIP-CODE-NUM NOT = ZEROS
04076          MOVE CF-CL-ZIP-CODE-NUM   TO WS-ZIP-CODE-NUM
04077          MOVE WS-ZIP-CODE-NUM      TO CF-CL-ZIP-CODE.
04078
04079      MOVE SPACES                   TO WS-ZIP-CODE.
04080      IF CF-CL-CAN-POST-CODE
04081          MOVE CF-CL-CAN-POSTAL-1   TO WS-ZIP-CAN-2-POST1
04082          MOVE CF-CL-CAN-POSTAL-2   TO WS-ZIP-CAN-2-POST2
04083      ELSE
04084          MOVE CF-CL-ZIP-PRIME      TO WS-ZIP-AM-2-CODE
04085          IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
04086              MOVE '-'              TO WS-ZIP-AM-2-DASH
04087              MOVE CF-CL-ZIP-PLUS4  TO WS-ZIP-AM-2-PLUS4.
04088
04089      MOVE WS-ZIP-CODE              TO ZIPCODEO.
04090
04091      MOVE CF-CL-PHONE-NO         TO WS-PHONE-IN.
04092      MOVE WSPI-AREA              TO WSPO-AREA.
04093      MOVE WSPI-PFX               TO WSPO-PFX.
04094      MOVE WSPI-SFX               TO WSPO-SFX.
04095      MOVE WS-PHONE-OUT           TO PHONEO.
04096      MOVE CF-SECURITY-OPTION     TO SECOPTO.
04097      MOVE CF-FORMS-PRINTER-ID    TO FPIDO.
04098      MOVE CF-CHECK-PRINTER-ID    TO CPIDO.
04099      MOVE CF-NEXT-COMPANY-ID     TO NEXTCOO.
04100      MOVE CF-SYSTEM-E            TO ARSYSO
04101                                     PI-AR-PROCESSING-CNTL.
04102      MOVE CF-TAX-ID-NUMBER       TO TAXIDO.
04103      MOVE AL-UANON               TO TAXIDA.
04104      MOVE CF-LGX-CREDIT-USER     TO CRSYSO.
04105      MOVE CF-LGX-LIFE-USER       TO MPSYSO.
04106      MOVE CF-CRDTCRD-USER        TO CCSYSO.
04107      MOVE CF-END-USER-REPORTING-USER
04108                                  TO EUSYSO.
04109
04110      IF CF-LOWER-CASE-LETTERS = 'Y' OR 'N' OR ' '
04111         MOVE CF-LOWER-CASE-LETTERS  TO LCCODEO
04112         ELSE
04113         MOVE SPACES                 TO LCCODEO.
04114
04115      MOVE CF-LGX-CLAIM-USER      TO CLSYSO.
04116
04117      IF CF-MEMBER-CAPTION = SPACES OR LOW-VALUES
04118          MOVE 'MEMBER NO.'          TO MEMBCAPO
04119      ELSE
04120          MOVE CF-MEMBER-CAPTION     TO MEMBCAPO.
04121
04122      IF CF-REPORT-CD1-CAPTION = SPACES OR LOW-VALUES
04123          MOVE 'RPT CODE 1'          TO RPTCD1O
04124      ELSE
04125          MOVE CF-REPORT-CD1-CAPTION TO RPTCD1O.
04126
04127      IF CF-REPORT-CD2-CAPTION = SPACES OR LOW-VALUES
04128          MOVE 'RPT CODE 2'          TO RPTCD2O
04129      ELSE
04130          MOVE CF-REPORT-CD2-CAPTION TO RPTCD2O.
04131
04132      MOVE AL-UANON               TO CRSYSA
04133                                     CLSYSA
04134                                     MPSYSA
04135                                     CCSYSA
04136                                     LCCODEA.
04137
04138      IF CO-HAS-CLAS-IC-CLAIM
04139          MOVE ' '                  TO DC-OPTION-CODE
04140          MOVE CF-CURRENT-MONTH-END TO DC-BIN-DATE-1
04141          MOVE LINK-ELDATCV         TO PGM-NAME
04142          EXEC CICS LINK
04143              PROGRAM (PGM-NAME)
04144              COMMAREA(DATE-CONVERSION-DATA)
04145              LENGTH  (DC-COMM-LENGTH)
04146          END-EXEC
04147          MOVE DC-GREG-DATE-1-EDIT TO CURRMEO
04148          MOVE AL-UNNON            TO CURRMEA
04149          MOVE AL-SABOF            TO CURRMEDA
04150      ELSE
04151          MOVE AL-SADOF TO CURRMEA
04152                           CURRMEDA.
04153
04154      IF CO-HAS-CLAS-IC-CREDIT
04155          IF CF-CR-MONTH-END-DT = SPACES
04156              MOVE AL-SABOF       TO CREDMEDA
04157          ELSE
04158              MOVE ' '                TO DC-OPTION-CODE
04159              MOVE CF-CR-MONTH-END-DT TO DC-BIN-DATE-1
04160              MOVE LINK-ELDATCV       TO PGM-NAME
04161              EXEC CICS LINK
04162                  PROGRAM (PGM-NAME)
04163                  COMMAREA(DATE-CONVERSION-DATA)
04164                  LENGTH  (DC-COMM-LENGTH)
04165              END-EXEC
04166              MOVE DC-GREG-DATE-1-EDIT TO CREDMEO
04167              MOVE AL-UNNON            TO CREDMEA
04168              MOVE AL-SABOF            TO CREDMEDA
04169      ELSE
04170          MOVE AL-SADOF TO CREDMEA
04171                           CREDMEDA.
04172
04173      IF CF-AR-SYSTEM-USED
04174          IF CF-AR-MONTH-END-DT = SPACES
04175              MOVE AL-SABOF           TO ARMEDA
04176          ELSE
04177              MOVE ' '                TO DC-OPTION-CODE
04178              MOVE CF-AR-MONTH-END-DT TO DC-BIN-DATE-1
04179              MOVE LINK-ELDATCV       TO PGM-NAME
04180              EXEC CICS LINK
04181                  PROGRAM (PGM-NAME)
04182                  COMMAREA(DATE-CONVERSION-DATA)
04183                  LENGTH  (DC-COMM-LENGTH)
04184              END-EXEC
04185              MOVE DC-GREG-DATE-1-EDIT TO ARMEO
04186              MOVE AL-SABOF            TO ARMEDA
04187              MOVE CF-AR-LAST-EL860-DT TO DC-BIN-DATE-1
04188              MOVE LINK-ELDATCV       TO PGM-NAME
04189              EXEC CICS LINK
04190                  PROGRAM (PGM-NAME)
04191                  COMMAREA(DATE-CONVERSION-DATA)
04192                  LENGTH  (DC-COMM-LENGTH)
04193              END-EXEC
04194              MOVE DC-GREG-DATE-1-EDIT TO AR860DTO
04195              MOVE AL-SANOF            TO AR860DTA
04196              IF  PI-PROCESSOR-ID = 'LGXX'
04197                  MOVE AL-UNNON            TO ARMEA
04198                  MOVE AL-UNNON            TO AR860DTA
04199              ELSE
04200                  MOVE AL-SANOF            TO ARMEA
04201      ELSE
04202          MOVE AL-SADOF TO ARMEA
04203                           ARMEDA
04204                           AR860DTA.
04205
04206      MOVE -1                   TO COMPNMEL.
04207      MOVE CF-LAST-MAINT-BY     TO PI-UPDATE-BY.
04208      MOVE CF-LAST-MAINT-HHMMSS TO PI-UPDATE-HHMMSS.
04209      MOVE CF-CL-MAIL-TO-NAME   TO COMPNMEO.
04210      MOVE CF-COMPANY-ID        TO COMPIDO.
04211      MOVE CF-CL-IN-CARE-OF     TO INCAREO.
PEMMOD*    MOVE AL-UANOF             TO INCAREA.
04213
04214      IF NOT CO-HAS-CLAS-IC-LIFE
04215          MOVE AL-SADOF TO MORTMEA
04216                           MORTMEDA
04217          GO TO 8100-SEND-INITIAL-MAP.
04218
04219      MOVE PI-COMPANY-ID          TO CK-COMP-ID.
04220      MOVE 'N'                    TO CK-REC-TYPE.
04221      EXEC CICS READ
04222          DATASET   ('ELCNTL')
04223          SET       (ADDRESS OF CONTROL-FILE)
04224          RIDFLD    (ELCNTL-KEY)
04225      END-EXEC.
04226
04227      MOVE ' '              TO DC-OPTION-CODE.
04228      MOVE CF-LAST-MAINT-DT TO DC-BIN-DATE-1.
04229      MOVE LINK-ELDATCV     TO PGM-NAME.
04230      EXEC CICS LINK
04231          PROGRAM (PGM-NAME)
04232          COMMAREA(DATE-CONVERSION-DATA)
04233          LENGTH  (DC-COMM-LENGTH)
04234      END-EXEC.
04235
04236      MOVE CF-LAST-MAINT-BY       TO PI-MORTG-CO-UPDATE-BY.
04237      MOVE CF-LAST-MAINT-HHMMSS   TO PI-MORTG-CO-UPDATE-HHMMSS.
04238
04239      IF CF-MORTG-MONTH-END-DT = SPACES
04240          MOVE AL-SABOF       TO MORTMEDA
04241      ELSE
04242          MOVE ' '                TO DC-OPTION-CODE
04243          MOVE CF-MORTG-MONTH-END-DT TO DC-BIN-DATE-1
04244          MOVE LINK-ELDATCV       TO PGM-NAME
04245          EXEC CICS LINK
04246              PROGRAM (PGM-NAME)
04247              COMMAREA(DATE-CONVERSION-DATA)
04248              LENGTH  (DC-COMM-LENGTH)
04249          END-EXEC
04250          MOVE DC-GREG-DATE-1-EDIT TO MORTMEO
04251          MOVE AL-UNNOF            TO MORTMEA
04252          MOVE AL-SABOF            TO MORTMEDA.
04253
04254      GO TO 8100-SEND-INITIAL-MAP.
04255
04256      EJECT
04257  7200-BUILD-INITIAL-MAP.
04258 *    BUILD MAP B
04259
04260      MOVE LOW-VALUES    TO EL102BO.
04261      MOVE PI-COMPANY-ID TO CK-COMP-ID.
04262      MOVE '1'           TO CK-REC-TYPE.
04263
04264      EXEC CICS READ
04265          DATASET('ELCNTL')
04266          SET    (ADDRESS OF CONTROL-FILE)
04267          RIDFLD (ELCNTL-KEY)
04268      END-EXEC.
04269
04270      MOVE -1                       TO CARRCLL.
04271
04272      IF CF-PAYMENT-APPROVAL-SW NOT = 'G' AND 'Y'
04273          MOVE 'N'                  TO APPROVO
04274          GO TO 7720-CONTINUE
04275      ELSE
04276          MOVE CF-PAYMENT-APPROVAL-SW
04277                                    TO APPROVO
04278          IF CF-PAYMENT-APPROVAL-SW = 'Y'
04279              GO TO 7720-CONTINUE.
04280
04281      IF CF-LIFE-PAY-APP-LEVEL-1 NUMERIC
04282          MOVE CF-LIFE-PAY-APP-LEVEL-1  TO LLEV1O
04283          MOVE AL-UNNON                 TO LLEV1A.
04284
04285      IF CF-LIFE-PAY-APP-LEVEL-2 NUMERIC
04286          MOVE CF-LIFE-PAY-APP-LEVEL-2  TO LLEV2O
04287          MOVE AL-UNNON                 TO LLEV2A.
04288
04289      IF CF-LIFE-PAY-APP-LEVEL-3 NUMERIC
04290          MOVE CF-LIFE-PAY-APP-LEVEL-3  TO LLEV3O.
04291          MOVE AL-UNNON                 TO LLEV3A.
04292
04293      IF CF-AH-PAY-APP-LEVEL-1  NUMERIC
04294          MOVE CF-AH-PAY-APP-LEVEL-1    TO ALEV1O
04295          MOVE AL-UNNON                 TO ALEV1A.
04296
04297      IF CF-AH-PAY-APP-LEVEL-2  NUMERIC
04298          MOVE CF-AH-PAY-APP-LEVEL-2    TO ALEV2O
04299          MOVE AL-UNNON                 TO ALEV2A.
04300
04301      IF CF-AH-PAY-APP-LEVEL-3 NUMERIC
04302          MOVE CF-AH-PAY-APP-LEVEL-3    TO ALEV3O
04303          MOVE AL-UNNON                 TO ALEV3A.
04304
04305  7720-CONTINUE.
04306
04307      MOVE CF-CARRIER-CONTROL-LEVEL TO CARRCLO.
04308      MOVE CF-CO-CLAIM-COUNTER      TO LSTCLMO.
04309      MOVE CF-CO-ARCHIVE-COUNTER    TO LSTARCHO.
04310      MOVE CF-STARTING-ARCH-NO      TO STARCHO.
04311      MOVE CF-CO-CHECK-COUNTER      TO LSTCHKO.
04312      MOVE CF-CO-CHECK-QUE-COUNTER  TO LSTQUEO.
04313      MOVE CF-CO-TOL-CLAIM          TO CLMTOLO.
04314      MOVE CF-CO-CLAIM-REJECT-SW    TO CLMREJO.
04315
04316      IF CF-CLAIM-CUTOFF-DATE EQUAL SPACES OR LOW-VALUES
04317         MOVE SPACES TO COFFDTO
04318      ELSE
04319         MOVE CF-CLAIM-CUTOFF-DATE TO DC-BIN-DATE-1
04320         MOVE ' '                  TO DC-OPTION-CODE
04321         PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04322         IF NO-CONVERSION-ERROR
04323            MOVE DC-GREG-DATE-1-EDIT TO COFFDTO.
04324
04325      IF CF-MAX-NUM-PMTS-CHECK NOT NUMERIC
04326         MOVE ZEROS                 TO PMTSCHKO
04327      ELSE
04328         MOVE CF-MAX-NUM-PMTS-CHECK TO PMTSCHKO.
04329
04330      IF CF-CLAIM-PAID-THRU-TO EQUAL '1'
04331         MOVE '1'     TO THRUTOO
04332      ELSE
04333         MOVE SPACES  TO THRUTOO.
04334
04335      IF CF-PRINT-ADDRESS-LABELS = ' '
04336          MOVE 'N'                        TO  ADDRLBLO
04337      ELSE
04338          MOVE CF-PRINT-ADDRESS-LABELS    TO  ADDRLBLO.
04339
04340      IF CF-CLAIMS-CHECK-RECON-USER = ' '
04341          MOVE 'N'                        TO  RECONO
04342      ELSE
04343          MOVE CF-CLAIMS-CHECK-RECON-USER TO  RECONO.
04344
04345      IF (CF-CLAIMS-LAST-PROCESS-DT EQUAL SPACES OR LOW-VALUES)
04346          MOVE SPACES                     TO  PROCDTO
04347      ELSE
04348          MOVE CF-CLAIMS-LAST-PROCESS-DT  TO  DC-BIN-DATE-1
04349          MOVE ' '                        TO  DC-OPTION-CODE
04350          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04351          IF NO-CONVERSION-ERROR
04352              MOVE DC-GREG-DATE-1-EDIT    TO  PROCDTO
04353          ELSE
04354              MOVE SPACES                 TO  PROCDTO.
04355
04356      IF CF-CLAIMS-AUDIT-CHANGES = ' '
04357         MOVE 'N'                         TO AUDCLCGO
04358      ELSE
04359         MOVE CF-CLAIMS-AUDIT-CHANGES     TO AUDCLCGO.
04360
04361      IF CF-CLAIMS-CREDIT-CARD-INDEX = ' '
04362         MOVE 'N'                         TO CRDCDINO
04363      ELSE
04364         MOVE CF-CLAIMS-CREDIT-CARD-INDEX TO CRDCDINO.
04365
04366      IF CF-CLAIMS-LETTER-MAINT-DAYS NOT NUMERIC
04367         MOVE ZEROS                       TO LTRMTDTO
04368      ELSE
04369         MOVE CF-CLAIMS-LETTER-MAINT-DAYS TO LTRMTDTO.
04370
04371      IF  CF-EXPERIENCE-RETENTION-AGE IS NUMERIC
04372              AND
04373          CF-EXPERIENCE-RETENTION-AGE GREATER THAN ZERO
04374              AND
04375          CF-EXPERIENCE-RETENTION-AGE LESS THAN 7
04376          MOVE CF-EXPERIENCE-RETENTION-AGE
04377                                          TO  EXPRETNO
04378      ELSE
04379          MOVE 2                          TO  EXPRETNO.
04380
04381      IF  CF-CO-RESERVE-OPTION-SWITCH NOT EQUAL 'Y'
04382          MOVE 'N'                TO RSVOPSWO
04383                                     PI-OPTIONAL-RESERVE-SW
04384      ELSE
04385          MOVE CF-CO-RESERVE-OPTION-SWITCH
04386                                  TO RSVOPSWO
04387                                     PI-OPTIONAL-RESERVE-SW.
04388
04389      IF  CF-CO-IBNR-LAG-MONTHS NOT NUMERIC
04390          MOVE ZEROS              TO IBLGMTHO
04391      ELSE
04392          MOVE CF-CO-IBNR-LAG-MONTHS
04393                                  TO IBLGMTHO.
04394
04395      IF  CF-CO-CIDA-TABLE-DISCOUNT-PCT NOT NUMERIC
04396          MOVE ZEROS              TO CIDADISO
04397      ELSE
04398          MOVE CF-CO-CIDA-TABLE-DISCOUNT-PCT
04399                                  TO CIDADISO.
04400
04401      IF  CF-CO-CRDB-TABLE-SELECTION NOT GREATER THAN SPACES
04402          MOVE SPACES             TO CRDTBLUO
04403      ELSE
04404          MOVE CF-CO-CRDB-TABLE-SELECTION
04405                                  TO CRDTBLUO.
04406
04407      IF  CF-CO-CALCULATION-INTEREST NOT NUMERIC
04408          MOVE ZEROS              TO CALCINTO
04409      ELSE
04410          MOVE CF-CO-CALCULATION-INTEREST
04411                                  TO CALCINTO.
04412
04413      IF  CF-CO-IBNR-LIFE-FACTOR NOT NUMERIC
04414          MOVE ZEROS              TO IBNRLFFO
04415      ELSE
04416          MOVE CF-CO-IBNR-LIFE-FACTOR
04417                                  TO IBNRLFFO.
04418
04419      IF  CF-CO-IBNR-AH-FACTOR NOT NUMERIC
04420          MOVE ZEROS              TO IBNRAHFO
04421      ELSE
04422          MOVE CF-CO-IBNR-AH-FACTOR
04423                                  TO IBNRAHFO.
04424
04425      IF CF-CO-OPTION-START-DATE = SPACES OR LOW-VALUES
04426          MOVE SPACES             TO OPTDTEO
04427      ELSE
04428          MOVE CF-CO-OPTION-START-DATE
04429                                  TO DC-BIN-DATE-1
04430          MOVE ' '                TO DC-OPTION-CODE
04431          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04432          IF  NO-CONVERSION-ERROR
04433              MOVE DC-GREG-DATE-1-EDIT
04434                                  TO OPTDTEO
04435          ELSE
04436              MOVE SPACES         TO OPTDTEO.
04437
04438      MOVE AL-UNNON               TO CALCINTA
04439                                     CIDADISA
04440                                     IBLGMTHA
04441                                     IBNRAHFA
04442                                     IBNRLFFA.
04443      MOVE AL-UANON               TO RSVOPSWA
04444                                     CRDTBLUA
04445                                     OPTDTEA.
04446
04447      IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
04448          MOVE AL-UNNON          TO LSTCLMA
04449                                    LSTARCHA
04450                                    STARCHA
04451                                    LSTCHKA
04452                                    LSTQUEA
04453                                    PROCDTA.
04454      GO TO 8110-SEND-INITIAL-MAP.
04455
04456      EJECT
04457
04458  7300-BUILD-INITIAL-MAP.
04459 *    BUILD MAP C
04460
04461      MOVE LOW-VALUES             TO EL102CO.
04462      MOVE PI-COMPANY-ID          TO CK-COMP-ID.
04463      MOVE '1'                    TO CK-REC-TYPE.
04464      EXEC CICS READ
04465          DATASET   ('ELCNTL')
04466          SET       (ADDRESS OF CONTROL-FILE)
04467          RIDFLD    (ELCNTL-KEY)
04468      END-EXEC.
04469
04470      MOVE -1                     TO PREJCTL.
04471
04472      MOVE CF-CERT-ACCESS-CONTROL TO CRTACSO.
04473      MOVE CF-CR-REM-TERM-CALC    TO REMTRMO.
04474      MOVE CF-CR-R78-METHOD       TO R78MTHO.
04475
04476      IF CF-SYSTEM-D = '1'
04477         MOVE 'Y' TO DABILLO
04478      ELSE
04479         MOVE 'N' TO DABILLO.
04480
04481      IF CF-SYSTEM-C = '1'
04482         MOVE 'Y' TO CONSYSO
04483      ELSE
04484         MOVE 'N' TO CONSYSO.
04485
04486      IF CF-SOC-SEC-NO-SW = '1'
04487         MOVE 'Y' TO SSNO
04488      ELSE
04489         MOVE 'N' TO SSNO.
04490
04491      IF  CF-MORTALITY-AGE-CALC-METHOD EQUAL '1' OR '2' OR '3'
04492          MOVE CF-MORTALITY-AGE-CALC-METHOD
04493                                  TO AGECALCO
04494      ELSE
04495          MOVE '1'                TO AGECALCO.
04496
04497      IF CF-MEMBER-NO-SW = '1'
04498         MOVE 'Y' TO MEMBNOO
04499      ELSE
04500         MOVE 'N' TO MEMBNOO.
04501
04502      MOVE CF-MAIL-PROCESSING     TO MAILO.
04503
04504      IF CF-ALT-MORT-CODE NOT = SPACES
04505          MOVE CF-ALT-MORT-CODE   TO AMRTCDO.
04506      IF CF-CO-TOL-PREM NUMERIC
04507          MOVE CF-CO-TOL-PREM     TO QTECALO.
04508      IF CF-CO-TOL-REFUND NUMERIC
04509          MOVE CF-CO-TOL-REFUND   TO QTEREFO.
04510      IF CF-CO-OVR-SHT-AMT NUMERIC
04511         MOVE CF-CO-OVR-SHT-AMT   TO OVSAMTO.
04512
04513      IF CF-CO-OVR-SHT-PCT NUMERIC
04514         MOVE CF-CO-OVR-SHT-PCT   TO OVSPCTO.
04515
04516      IF CF-MIN-PREMIUM NUMERIC
04517          MOVE CF-MIN-PREMIUM     TO MINPREMO.
04518      IF CF-COMP-WRITE-OFF-AMT NUMERIC
04519          MOVE CF-COMP-WRITE-OFF-AMT  TO COMPWTEO.
04520      IF CF-MIN-TERM NUMERIC
04521          MOVE CF-MIN-AGE         TO MINAGEO.
04522      IF CF-MAX-TERM NUMERIC
04523         MOVE CF-MAX-TERM         TO MAXTERMO.
04524
04525      MOVE CF-CO-PREM-REJECT-SW   TO PREJCTO.
04526      MOVE CF-CO-REF-REJECT-SW    TO REFREJO.
04527
04528      IF CO-IS-PROCESSED-ON-QTR
04529         MOVE 'Q'                 TO PRCESSFO
04530        ELSE
04531         MOVE 'M'                 TO PRCESSFO.
04532
04533      MOVE CF-DEFAULT-AGE         TO DAGEO.
04534      MOVE CF-DEFAULT-SEX         TO DSEXO.
04535
04536      IF CF-DEFAULT-APR NUMERIC
04537          MOVE CF-DEFAULT-APR     TO DAPRO.
04538
04539      IF CF-VALID-REM-TRM-OPTION
04540          MOVE CF-REM-TRM-CALC-OPTION
04541                                  TO TRMOPTNO.
04542
04543      IF CF-JOINT-AGE-IS-INPUT
04544         MOVE 'Y'                 TO JAGEO
04545        ELSE
04546         MOVE 'N'                 TO JAGEO.
04547
04548      IF CF-BIRTH-DATE-IS-INPUT
04549         MOVE 'Y'                 TO BINPUTO
04550        ELSE
04551         MOVE 'N'                 TO BINPUTO.
04552
04553      IF CF-CO-TOL-PREM-PCT NUMERIC
04554         IF CF-CO-TOL-PREM-PCT NOT EQUAL ZEROS
04555             MOVE CF-CO-TOL-PREM-PCT  TO  PRMPCTO.
04556
04557      IF CF-CO-TOL-REFUND-PCT NUMERIC
04558         IF CF-CO-TOL-REFUND-PCT NOT EQUAL ZEROS
04559             MOVE CF-CO-TOL-REFUND-PCT TO REFPCTO.
04560
04561      IF CF-CO-TOL-CAP NUMERIC
04562         IF CF-CO-TOL-CAP NOT EQUAL ZEROS
04563             MOVE CF-CO-TOL-CAP     TO MTOLCAPO.
04564
04565      IF CF-LAST-BATCH NOT = LOW-VALUES
04566          MOVE CF-LAST-BATCH-NO TO LSTBTCHO.
04567
04568      MOVE CF-CR-CHECK-NO-METHOD    TO CMETHODO.
04569      MOVE CF-CAR-GROUP-ACCESS-CNTL TO CARGRPOO.
04570
04571      IF CF-CONVERSION-DT NOT = LOW-VALUES
04572          MOVE ' '                 TO DC-OPTION-CODE
04573          MOVE CF-CONVERSION-DT    TO DC-BIN-DATE-1
04574          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04575          MOVE DC-GREG-DATE-1-EDIT TO CONDTEO.
04576
04577      MOVE CF-CO-ST-CALL-RPT-CNTL             TO STCNTLO.
04578
04579      IF  CF-CREDIT-START-ARCH-NUM NUMERIC
04580          MOVE CF-CREDIT-START-ARCH-NUM
04581                                  TO ARCHSTO
04582      ELSE
04583          MOVE ZEROS              TO ARCHSTO
04584          MOVE +8                 TO ARCHSTL
04585          MOVE AL-UNNON           TO ARCHSTA.
04586
04587      IF  CF-CREDIT-LAST-ARCH-NUM NUMERIC
04588          MOVE CF-CREDIT-LAST-ARCH-NUM
04589                                  TO ARCHLSTO
04590      ELSE
04591          MOVE ZEROS              TO ARCHLSTO
04592          MOVE +8                 TO ARCHLSTL
04593          MOVE AL-UNNON           TO ARCHLSTA.
04594
04595      IF  CF-CREDIT-ARCH-PURGE-YR NUMERIC
04596          MOVE AL-UNNON           TO ARCHPYRA
04597          MOVE CF-CREDIT-ARCH-PURGE-YR
04598                                  TO ARCHPYRO.
04599
04600      IF CF-CR-CHECK-COUNT NOT = LOW-VALUES
04601          MOVE CF-CR-CHECK-COUNTER TO CKCOUNTO.
04602
04603      IF CF-CR-CHECK-QUE-COUNT NOT = LOW-VALUES
04604          MOVE CF-CR-CHECK-QUE-COUNTER TO QUCOUNTO.
04605
04606      IF  CF-CR-PRINT-ADDRESS-LABELS = 'Y' OR 'N'
04607          MOVE CF-CR-PRINT-ADDRESS-LABELS
04608                                 TO CRLABELO
04609          MOVE AL-UANON          TO CRLABELA
04610      ELSE
04611          MOVE AL-UANON          TO CRLABELA
04612          MOVE 'N'               TO CRLABELO.
04613
04614      IF PI-PROCESSOR-ID = 'LGXX'
04615          MOVE AL-UNNON          TO CKCOUNTA
04616                                    LSTBTCHA
04617                                    QUCOUNTA
04618                                    ARCHSTA
04619                                    ARCHLSTA
04620      ELSE
04621          MOVE AL-PANOF          TO CARGRPOA
04622                                    QUCOUNTA
04623                                    CRTACSA
04624                                    ARCHSTA
04625                                    ARCHLSTA.
04626
04627  7300-CONT.
04628      GO TO 8120-SEND-INITIAL-MAP.
04629
04630      EJECT
04631  7400-BUILD-INITIAL-MAP.
04632 *    BUILD MAP D
04633
04634      MOVE LOW-VALUES             TO EL102DO.
04635      MOVE PI-COMPANY-ID          TO CK-COMP-ID.
04636      MOVE 'N'                    TO CK-REC-TYPE.
04637      EXEC CICS READ
04638          DATASET   ('ELCNTL')
04639          SET       (ADDRESS OF CONTROL-FILE)
04640          RIDFLD    (ELCNTL-KEY)
04641      END-EXEC.
04642
04643      MOVE ' '              TO DC-OPTION-CODE.
04644      MOVE CF-LAST-MAINT-DT TO DC-BIN-DATE-1.
04645      MOVE LINK-ELDATCV     TO PGM-NAME.
04646      EXEC CICS LINK
04647          PROGRAM (PGM-NAME)
04648          COMMAREA(DATE-CONVERSION-DATA)
04649          LENGTH  (DC-COMM-LENGTH)
04650      END-EXEC.
04651
04652      MOVE CF-LAST-MAINT-BY       TO PI-MORTG-CO-UPDATE-BY.
04653      MOVE CF-LAST-MAINT-HHMMSS   TO PI-MORTG-CO-UPDATE-HHMMSS.
04654      MOVE CF-LAST-MAINT-BY       TO LSTUSERO.
04655      MOVE DC-GREG-DATE-1-EDIT    TO LSTDATEO.
04656      MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
04657      MOVE TIME-OUT               TO LSTTMEO.
04658      MOVE -1                     TO MIBSYML.
04659      MOVE CF-MORTG-ALT-MORT-CODE TO DAMRTCDO.
04660      MOVE CF-MORTG-MIB-VERSION   TO MIBVERO.
04661      MOVE CF-MORTG-MIB-LNAME-SEARCH TO WS-MIB-LNAME-SEARCH.
04662      MOVE CF-MORTG-ALP-LNAME-SEARCH TO WS-ALP-LNAME-SEARCH.
04663      MOVE WS-LNAME-SEARCH-CNTL   TO LNMESERO.
04664      MOVE CF-MORTG-MIB-FNAME-SEARCH TO WS-MIB-FNAME-SEARCH.
04665      MOVE CF-MORTG-ALP-FNAME-SEARCH TO WS-ALP-FNAME-SEARCH.
04666      MOVE WS-FNAME-SEARCH-CNTL   TO FNMESERO.
04667      MOVE CF-MORTG-MIB-MNAME-SEARCH TO WS-MIB-MNAME-SEARCH.
04668      MOVE CF-MORTG-ALP-MNAME-SEARCH TO WS-ALP-MNAME-SEARCH.
04669      MOVE WS-MNAME-SEARCH-CNTL   TO MNMESERO.
04670      MOVE CF-MORTG-MIB-BDATE-SEARCH TO WS-MIB-BDATE-SEARCH.
04671      MOVE CF-MORTG-ALP-BDATE-SEARCH TO WS-ALP-BDATE-SEARCH.
04672      MOVE WS-BDATE-SEARCH-CNTL   TO BDATEO.
04673      MOVE CF-MORTG-MIB-BSTATE-SEARCH TO BSTATEO.
04674      MOVE CF-MORTG-MIB-BSTATE-SEARCH TO WS-MIB-BSTATE-SEARCH.
04675      MOVE CF-MORTG-ALP-BSTATE-SEARCH TO WS-ALP-BSTATE-SEARCH.
04676      MOVE WS-BSTATE-SEARCH-CNTL  TO BSTATEO.
04677      MOVE CF-MORTG-MIB-RSTATE-SEARCH TO WS-MIB-RSTATE-SEARCH.
04678      MOVE CF-MORTG-ALP-RSTATE-SEARCH TO WS-ALP-RSTATE-SEARCH.
04679      MOVE WS-RSTATE-SEARCH-CNTL  TO RSTATEO.
04680      MOVE CF-MORTG-MIB-COMM      TO MIBCOMMO.
04681      MOVE CF-MORTG-MIB-TERM      TO MIBTERMO.
04682      MOVE CF-MORTG-MIB-COMPANY-SYMBOL TO MIBSYMO.
04683      MOVE CF-MORTG-BILL-GROUPING-CODE TO GRPSWO.
04684      MOVE CF-RATE-DEV-AUTHORIZATION   TO RATESWO.
04685
04686      IF CF-MORTG-MIB-COMM-DEST
04687          MOVE 'Y' TO MIBCSWO
04688          MOVE 'N' TO MIBTSWO
04689      ELSE
04690      IF CF-MORTG-MIB-TERM-DEST
04691          MOVE 'N' TO MIBCSWO
04692          MOVE 'Y' TO MIBTSWO
04693      ELSE
04694          MOVE 'N' TO MIBCSWO
04695                      MIBTSWO.
04696
04697      MOVE CF-MORTG-ACCESS-CONTROL TO MGCNTLO.
04698
04699      IF  CF-MORTG-SOLICITATION-NUM NUMERIC
04700          MOVE CF-MORTG-SOLICITATION-NUM
04701                                  TO REFNOO
04702      ELSE
04703          MOVE ZEROS              TO REFNOO.
04704
04705      IF  CF-ASSIGN-POLICY-NO-SW EQUAL 'Y' OR 'N'
04706          MOVE CF-ASSIGN-POLICY-NO-SW
04707                                  TO AUTOREFO
04708      ELSE
04709          MOVE 'N'                TO AUTOREFO.
04710
04711      IF  CF-MORTG-LOAN-SHIFT-IND EQUAL 'L' OR 'R'
04712          MOVE CF-MORTG-LOAN-SHIFT-IND
04713                                  TO SHFTLNOO
04714      ELSE
04715          MOVE 'L'                TO SHFTLNOO.
04716
04717      IF  CF-MP-CHECK-NO-METHOD EQUAL '1' OR '2' OR '3'
04718          MOVE CF-MP-CHECK-NO-METHOD
04719                                  TO CHKPMTHO
04720      ELSE
04721          MOVE '2'                TO CHKPMTHO.
04722
04723      IF  CF-MP-RECON-USE-IND EQUAL 'Y' OR 'N'
04724          MOVE CF-MP-RECON-USE-IND TO MRECONO
04725      ELSE
04726          MOVE 'N'                TO MRECONO.
04727
04728      IF  CF-MP-REPORT-LANGUAGE-IND EQUAL 'E' OR 'F'
04729          MOVE CF-MP-REPORT-LANGUAGE-IND
04730                                  TO RPTLANGO
04731      ELSE
04732          MOVE 'E'                TO RPTLANGO.
04733
04734      IF  CF-MP-POLICY-LINKAGE-IND EQUAL 'Y' OR 'N'
04735          MOVE CF-MP-POLICY-LINKAGE-IND
04736                                  TO PLCYLNKO
04737      ELSE
04738          MOVE 'N'                TO PLCYLNKO.
04739
04740      MOVE CF-MORTG-START-ARCH-NUM TO STARCHNO.
04741      MOVE CF-MORTG-CURRENT-ARCH-NUM
04742                                   TO ARCHNBRO.
04743      MOVE CF-MORTG-LABEL-CONTROL  TO LABCNTLO.
04744      MOVE CF-MORTG-BILL-CYCLE (1) TO BCYCLE1O.
04745      MOVE CF-MORTG-BILL-CYCLE (2) TO BCYCLE2O.
04746      MOVE CF-MORTG-BILL-CYCLE (3) TO BCYCLE3O.
04747      MOVE CF-MORTG-BILL-CYCLE (4) TO BCYCLE4O.
04748      MOVE CF-MORTG-BILL-CYCLE (5) TO BCYCLE5O.
04749
04750      IF CF-MORTG-CONVERSION-DATE NOT = LOW-VALUES
04751          MOVE ' '                 TO DC-OPTION-CODE
04752          MOVE CF-MORTG-CONVERSION-DATE TO DC-BIN-DATE-1
04753          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04754          MOVE DC-GREG-DATE-1-EDIT TO CNVDTEO.
04755
04756      IF CF-MORTG-RATE-FILE-MAINT-DATE NOT = LOW-VALUES
04757          MOVE ' '                    TO DC-OPTION-CODE
04758          MOVE CF-MORTG-RATE-FILE-MAINT-DATE TO DC-BIN-DATE-1
04759          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04760          MOVE DC-GREG-DATE-1-EDIT    TO RATFILMO.
04761
04762      IF CF-MORTG-RATE-FILE-CREAT-DATE NOT = LOW-VALUES
04763          MOVE ' '                     TO DC-OPTION-CODE
04764          MOVE CF-MORTG-RATE-FILE-CREAT-DATE TO DC-BIN-DATE-1
04765          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04766          MOVE DC-GREG-DATE-1-EDIT     TO RATFILCO.
04767
04768      IF CF-MORTG-PROD-FILE-MAINT-DATE NOT = LOW-VALUES
04769          MOVE ' '                      TO DC-OPTION-CODE
04770          MOVE CF-MORTG-PROD-FILE-MAINT-DATE TO DC-BIN-DATE-1
04771          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04772          MOVE DC-GREG-DATE-1-EDIT      TO PRDMSTMO.
04773
04774      IF CF-MORTG-PROD-FILE-CREAT-DATE NOT = LOW-VALUES
04775          MOVE ' '                      TO DC-OPTION-CODE
04776          MOVE CF-MORTG-PROD-FILE-CREAT-DATE TO DC-BIN-DATE-1
04777          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04778          MOVE DC-GREG-DATE-1-EDIT      TO PRDMSTCO.
04779
04780      IF CF-MORTG-CHECK-NO-COUNTER NOT = LOW-VALUES
04781          MOVE CF-MORTG-CHECK-NO-COUNTER TO CHKCNTRO.
04782
04783      IF CF-MORTG-CHECK-QUEUE-COUNTER NOT = LOW-VALUES
04784          MOVE CF-MORTG-CHECK-QUEUE-COUNTER TO QUECNTRO.
04785
04786      MOVE PI-COMPANY-ID          TO CK-COMP-ID.
04787      MOVE '1'                    TO CK-REC-TYPE.
04788      EXEC CICS READ
04789          DATASET   ('ELCNTL')
04790          SET       (ADDRESS OF CONTROL-FILE)
04791          RIDFLD    (ELCNTL-KEY)
04792      END-EXEC.
04793
04794      MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
04795      MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
04796      IF REIN-TABLES-ARE-USED
04797         MOVE 'Y' TO DRESURO
04798        ELSE
04799         MOVE 'N' TO DRESURO.
04800
04801      MOVE CF-CAR-GROUP-ACCESS-CNTL TO CMPCNTLO.
04802
04803      IF CF-REINSURANCE-TAB-MAINT-DT = LOW-VALUES
04804          NEXT SENTENCE
04805      ELSE
04806          MOVE ' '                         TO DC-OPTION-CODE
04807          MOVE CF-REINSURANCE-TAB-MAINT-DT TO DC-BIN-DATE-1
04808          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04809          MOVE DC-GREG-DATE-1-EDIT         TO RENTBLMO.
04810
04811      IF CF-REINSURANCE-TAB-CREATE-DT = LOW-VALUES
04812          NEXT SENTENCE
04813      ELSE
04814          MOVE ' '                          TO DC-OPTION-CODE
04815          MOVE CF-REINSURANCE-TAB-CREATE-DT TO DC-BIN-DATE-1
04816          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04817          MOVE DC-GREG-DATE-1-EDIT          TO RENTBLCO.
04818
04819      IF CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
04820          NEXT SENTENCE
04821      ELSE
04822          MOVE ' '                           TO DC-OPTION-CODE
04823          MOVE CF-COMPENSATION-MSTR-MAINT-DT TO DC-BIN-DATE-1
04824          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04825          MOVE DC-GREG-DATE-1-EDIT           TO COMMSTMO.
04826
04827      IF CF-COMPENSATION-MSTR-CREATE-DT = LOW-VALUES
04828          NEXT SENTENCE
04829      ELSE
04830          MOVE ' '                            TO DC-OPTION-CODE
04831          MOVE CF-COMPENSATION-MSTR-CREATE-DT TO DC-BIN-DATE-1
04832          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04833          MOVE DC-GREG-DATE-1-EDIT            TO COMMSTCO.
04834
04835      IF PI-PROCESSOR-ID = 'LGXX'
04836          MOVE AL-UNNON          TO RATFILMA
04837                                    STARCHNA
04838                                    ARCHNBRA
04839                                    LABCNTLA
04840                                    REFNOA
04841                                    BCYCLE1A
04842                                    BCYCLE2A
04843                                    BCYCLE3A
04844                                    BCYCLE4A
04845                                    BCYCLE5A
04846                                    PRDMSTMA
04847                                    RENTBLMA
04848                                    COMMSTMA
04849                                    CHKCNTRA
04850                                    QUECNTRA
04851
04852      ELSE
04853          MOVE AL-PANOF          TO RATFILMA
04854                                    MGCNTLA
04855                                    CMPCNTLA
04856                                    STARCHNA
04857                                    ARCHNBRA
04858                                    LABCNTLA
04859                                    REFNOA
04860                                    BCYCLE1A
04861                                    BCYCLE2A
04862                                    BCYCLE3A
04863                                    BCYCLE4A
04864                                    BCYCLE5A
04865                                    PRDMSTMA
04866                                    RENTBLMA
04867                                    COMMSTMA
04868                                    CHKCNTRA
04869                                    QUECNTRA.
04870
04871      MOVE AL-UANON              TO AUTOREFA
04872                                    SHFTLNOA
04873                                    CHKPMTHA
04874                                    MRECONA
04875                                    RPTLANGA
04876                                    PLCYLNKA.
04877
04878      IF PI-USER-ALMIGHTY-YES
04879          MOVE AL-UNNON          TO STARCHNA
04880                                    ARCHNBRA.
04881
04882  7400-CONT.
04883      GO TO 8130-SEND-INITIAL-MAP.
04884
04885  7500-BUILD-INITIAL-MAP.
04886 *    BUILD MAP E
04887
04888      MOVE LOW-VALUES             TO EL102EO.
04889      MOVE PI-COMPANY-ID          TO CK-COMP-ID.
04890      MOVE '1'                    TO CK-REC-TYPE.
04891      EXEC CICS READ
04892          DATASET   ('ELCNTL')
04893          SET       (ADDRESS OF CONTROL-FILE)
04894          RIDFLD    (ELCNTL-KEY)
04895      END-EXEC.
04896
04897      MOVE -1                     TO RTEFILML.
04898
04899      IF CF-RATES-FILE-MAINT-DT = LOW-VALUES OR SPACES
04900          NEXT SENTENCE
04901      ELSE
04902          MOVE ' '                    TO DC-OPTION-CODE
04903          MOVE CF-RATES-FILE-MAINT-DT TO DC-BIN-DATE-1
04904          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04905          MOVE DC-GREG-DATE-1-EDIT    TO RTEFILMO.
04906
04907      IF CF-RATES-FILE-CREATE-DT = LOW-VALUES OR SPACES
04908          NEXT SENTENCE
04909      ELSE
04910          MOVE ' '                     TO DC-OPTION-CODE
04911          MOVE CF-RATES-FILE-CREATE-DT TO DC-BIN-DATE-1
04912          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04913          MOVE DC-GREG-DATE-1-EDIT     TO RTEFILCO.
04914
04915      IF CF-COMMISSION-TAB-MAINT-DT = LOW-VALUES OR SPACES
04916          NEXT SENTENCE
04917      ELSE
04918          MOVE ' '                        TO DC-OPTION-CODE
04919          MOVE CF-COMMISSION-TAB-MAINT-DT TO DC-BIN-DATE-1
04920          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04921          MOVE DC-GREG-DATE-1-EDIT        TO COMTABMO.
04922
04923      IF CF-COMMISSION-TAB-CREATE-DT = LOW-VALUES OR SPACES
04924          NEXT SENTENCE
04925      ELSE
04926          MOVE ' '                         TO DC-OPTION-CODE
04927          MOVE CF-COMMISSION-TAB-CREATE-DT TO DC-BIN-DATE-1
04928          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04929          MOVE DC-GREG-DATE-1-EDIT         TO COMTABCO.
04930
04931      IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES OR SPACES
04932          NEXT SENTENCE
04933      ELSE
04934          MOVE ' '                      TO DC-OPTION-CODE
04935          MOVE CF-ACCOUNT-MSTR-MAINT-DT TO DC-BIN-DATE-1
04936          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04937          MOVE DC-GREG-DATE-1-EDIT      TO ACTMSTMO.
04938
04939      IF CF-ACCOUNT-MSTR-CREATE-DT = LOW-VALUES OR SPACES
04940          NEXT SENTENCE
04941      ELSE
04942          MOVE ' '                       TO DC-OPTION-CODE
04943          MOVE CF-ACCOUNT-MSTR-CREATE-DT TO DC-BIN-DATE-1
04944          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04945          MOVE DC-GREG-DATE-1-EDIT       TO ACTMSTCO.
04946
04947      IF CF-REINSURANCE-TAB-MAINT-DT = LOW-VALUES OR SPACES
04948          NEXT SENTENCE
04949      ELSE
04950          MOVE ' '                         TO DC-OPTION-CODE
04951          MOVE CF-REINSURANCE-TAB-MAINT-DT TO DC-BIN-DATE-1
04952          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04953          MOVE DC-GREG-DATE-1-EDIT         TO RENTABMO.
04954
04955      IF CF-REINSURANCE-TAB-CREATE-DT = LOW-VALUES OR SPACES
04956          NEXT SENTENCE
04957      ELSE
04958          MOVE ' '                          TO DC-OPTION-CODE
04959          MOVE CF-REINSURANCE-TAB-CREATE-DT TO DC-BIN-DATE-1
04960          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04961          MOVE DC-GREG-DATE-1-EDIT          TO RENTABCO.
04962
04963      IF CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES OR SPACES
04964          NEXT SENTENCE
04965      ELSE
04966          MOVE ' '                           TO DC-OPTION-CODE
04967          MOVE CF-COMPENSATION-MSTR-MAINT-DT TO DC-BIN-DATE-1
04968          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04969          MOVE DC-GREG-DATE-1-EDIT           TO CMPMSTMO.
04970
04971      IF CF-COMPENSATION-MSTR-CREATE-DT = LOW-VALUES OR SPACES
04972          NEXT SENTENCE
04973      ELSE
04974          MOVE ' '                            TO DC-OPTION-CODE
04975          MOVE CF-COMPENSATION-MSTR-CREATE-DT TO DC-BIN-DATE-1
04976          PERFORM 8000-CONVERT-DATE THRU 8000-EXIT
04977          MOVE DC-GREG-DATE-1-EDIT            TO CMPMSTCO.
04978
04979      IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
04980          MOVE AL-UNNON          TO RTEFILMA
04981                                    COMTABMA
04982                                    ACTMSTMA
04983                                    RENTABMA
04984                                    CMPMSTMA.
04985
04986
04987  7500-CONT.
04988      GO TO 8140-SEND-INITIAL-MAP.
04989
04990      EJECT
04991  8000-CONVERT-DATE.
04992      MOVE LINK-ELDATCV TO PGM-NAME.
04993      EXEC CICS LINK
04994          PROGRAM    (PGM-NAME)
04995          COMMAREA   (DATE-CONVERSION-DATA)
04996          LENGTH     (DC-COMM-LENGTH)
04997      END-EXEC.
04998
04999  8000-EXIT.
05000      EXIT.
05001      EJECT
05002
05003  8100-SEND-INITIAL-MAP.
05004      MOVE SAVE-DATE            TO RUNDTEO.
05005      MOVE EIBTIME              TO TIME-IN.
05006      MOVE TIME-OUT             TO RUNTIMEO.
05007
PEMTST     IF PI-COMPANY-ID NOT = 'CID'
PEMTST        MOVE AL-UANON          TO COMPNMEA
PEMTST                                  INCAREA
                                        ADDR1A
                                        ADDR2A
                                        CITYSTA
                                        ZIPCODEA
           END-IF
PEMTST
05008      MOVE PI-COMPANY-ID        TO COAO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDAO
05009      MOVE PI-LIFE-OVERRIDE-L2  TO WS-COV-DESC-2.
05010      MOVE WS-COV-DESCRIPTION   TO LFDESCO.
05011      MOVE PI-LIFE-OVERRIDE-L1  TO LFOVR1O.
05012      MOVE PI-LIFE-OVERRIDE-L2  TO LFOVR2O.
05013      MOVE PI-LIFE-OVERRIDE-L6  TO LFOVR6O.
05014      MOVE PI-LIFE-OVERRIDE-L12 TO LFOVR12O.
05015      MOVE PI-AH-OVERRIDE-L2    TO WS-COV-DESC-2.
05016      MOVE WS-COV-DESCRIPTION   TO AHDESCO.
05017      MOVE PI-AH-OVERRIDE-L1    TO AHOVR1O.
05018      MOVE PI-AH-OVERRIDE-L2    TO AHOVR2O.
05019      MOVE PI-AH-OVERRIDE-L6    TO AHOVR6O.
05020      MOVE PI-AH-OVERRIDE-L12   TO AHOVR12O.
05021
05022      MOVE EMI-MESSAGE-AREA (1) TO ERRMSGO.
05023
05024      EXEC CICS SEND
05025          MAP   (MAP-NAME)
05026          MAPSET(MAPSET-NAME)
05027          FROM  (EL102AO)
05028          ERASE
05029          CURSOR
05030      END-EXEC.
05031
05032      MOVE '102A' TO PI-CURRENT-SCREEN-NO.
05033
05034      GO TO 9100-RETURN-TRAN.
05035
05036      EJECT
05037  8110-SEND-INITIAL-MAP.
05038      MOVE PI-COMPANY-ID        TO COBO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDBO
05039      MOVE SAVE-DATE            TO BRUNDTEO.
05040      MOVE EIBTIME              TO TIME-IN.
05041      MOVE TIME-OUT             TO BRUNTMEO.
05042      MOVE EMI-MESSAGE-AREA (1) TO BERMSG1O.
05043      EXEC CICS SEND
05044          MAP   (MAP-NAME)
05045          MAPSET(MAPSET-NAME)
05046          FROM  (EL102BO)
05047          ERASE
05048          CURSOR
05049      END-EXEC.
05050
05051      MOVE '102B' TO PI-CURRENT-SCREEN-NO.
05052
05053      GO TO 9100-RETURN-TRAN.
05054
05055      EJECT
05056  8120-SEND-INITIAL-MAP.
05057      MOVE PI-COMPANY-ID        TO COCO
05058                                   COEO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDCO
PEMTST                                  USERIDEO
05059      MOVE SAVE-DATE            TO CRUNDTEO.
05060      MOVE EIBTIME              TO TIME-IN.
05061      MOVE TIME-OUT             TO CRUNTMEO.
05062      MOVE EMI-MESSAGE-AREA (1) TO CERMSG1O.
05063      EXEC CICS SEND
05064          MAP   (MAP-NAME)
05065          MAPSET(MAPSET-NAME)
05066          FROM  (EL102CO)
05067          ERASE
05068          CURSOR
05069      END-EXEC.
05070
05071      MOVE '102C' TO PI-CURRENT-SCREEN-NO.
05072
05073      GO TO 9100-RETURN-TRAN.
05074
05075      EJECT
05076  8130-SEND-INITIAL-MAP.
05077      MOVE PI-COMPANY-ID        TO CODO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDDO
05078      MOVE SAVE-DATE            TO DRUNDTEO.
05079      MOVE EIBTIME              TO TIME-IN.
05080      MOVE TIME-OUT             TO DRUNTMEO.
05081      MOVE EMI-MESSAGE-AREA (1) TO DERMSG1O.
05082      EXEC CICS SEND
05083          MAP   (MAP-NAME)
05084          MAPSET(MAPSET-NAME)
05085          FROM  (EL102DO)
05086          ERASE
05087          CURSOR
05088      END-EXEC.
05089
05090      MOVE '102D' TO PI-CURRENT-SCREEN-NO.
05091
05092      GO TO 9100-RETURN-TRAN.
05093
05094      EJECT
05095
05096  8140-SEND-INITIAL-MAP.
05097      MOVE PI-COMPANY-ID        TO COEO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDEO
05098      MOVE SAVE-DATE            TO ERUNDTEO.
05099      MOVE EIBTIME              TO TIME-IN.
05100      MOVE TIME-OUT             TO ERUNTMEO.
05101      MOVE EMI-MESSAGE-AREA (1) TO EERMSG1O.
05102      EXEC CICS SEND
05103          MAP   (MAP-NAME)
05104          MAPSET(MAPSET-NAME)
05105          FROM  (EL102EO)
05106          ERASE
05107          CURSOR
05108      END-EXEC.
05109      MOVE '102E' TO PI-CURRENT-SCREEN-NO.
05110
05111      GO TO 9100-RETURN-TRAN.
05112
05113      EJECT
05114  8200-SEND-DATAONLY.

PEMTST     IF PI-COMPANY-ID NOT = 'CID'
PEMTST        MOVE AL-UANON          TO COMPNMEA
PEMTST                                  INCAREA
                                        ADDR1A
                                        ADDR2A
                                        CITYSTA
                                        ZIPCODEA
           END-IF
PEMTST
05115      MOVE PI-COMPANY-ID        TO COAO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDAO
05116      MOVE SAVE-DATE            TO RUNDTEO.
05117      MOVE EIBTIME              TO TIME-IN.
05118      MOVE TIME-OUT             TO RUNTIMEO.
05119
05120      MOVE PI-LIFE-OVERRIDE-L2  TO WS-COV-DESC-2.
05121      MOVE WS-COV-DESCRIPTION   TO LFDESCO.
05122      MOVE PI-LIFE-OVERRIDE-L1  TO LFOVR1O.
05123      MOVE PI-LIFE-OVERRIDE-L2  TO LFOVR2O.
05124      MOVE PI-LIFE-OVERRIDE-L6  TO LFOVR6O.
05125      MOVE PI-LIFE-OVERRIDE-L12 TO LFOVR12O.
05126      MOVE PI-AH-OVERRIDE-L2    TO WS-COV-DESC-2.
05127      MOVE WS-COV-DESCRIPTION   TO AHDESCO.
05128      MOVE PI-AH-OVERRIDE-L1    TO AHOVR1O.
05129      MOVE PI-AH-OVERRIDE-L2    TO AHOVR2O.
05130      MOVE PI-AH-OVERRIDE-L6    TO AHOVR6O.
05131      MOVE PI-AH-OVERRIDE-L12   TO AHOVR12O.
05132
05133      MOVE EMI-MESSAGE-AREA (1) TO ERRMSGO.
05134
05135      EXEC CICS SEND
05136          MAP   (MAP-NAME)
05137          MAPSET(MAPSET-NAME)
05138          FROM  (EL102AO)
05139          DATAONLY
05140          CURSOR
05141      END-EXEC.
05142
05143      MOVE '102A' TO PI-CURRENT-SCREEN-NO.
05144
05145      GO TO 9100-RETURN-TRAN.
05146
05147      EJECT
05148  8210-SEND-DATAONLY.
05149      MOVE PI-COMPANY-ID        TO COBO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDBO
05150      MOVE SAVE-DATE            TO BRUNDTEO.
05151      MOVE EIBTIME              TO TIME-IN.
05152      MOVE TIME-OUT             TO BRUNTMEO.
05153      MOVE EMI-MESSAGE-AREA (1) TO BERMSG1O.
05154      MOVE EMI-MESSAGE-AREA (2) TO BERMSG2O.
05155      MOVE EMI-MESSAGE-AREA (3) TO BERMSG3O.
05156      EXEC CICS SEND
05157          MAP   (MAP-NAME)
05158          MAPSET(MAPSET-NAME)
05159          FROM  (EL102BO)
05160          DATAONLY
05161          CURSOR
05162      END-EXEC.
05163
05164      MOVE '102B' TO PI-CURRENT-SCREEN-NO.
05165
05166      GO TO 9100-RETURN-TRAN.
05167
05168      EJECT
05169  8220-SEND-DATAONLY.
05170      MOVE PI-COMPANY-ID        TO COCO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDCO
05171      MOVE SAVE-DATE            TO CRUNDTEO.
05172      MOVE EIBTIME              TO TIME-IN.
05173      MOVE TIME-OUT             TO CRUNTMEO.
05174      MOVE EMI-MESSAGE-AREA (1) TO CERMSG1O.
05175      EXEC CICS SEND
05176          MAP   (MAP-NAME)
05177          MAPSET(MAPSET-NAME)
05178          FROM  (EL102CO)
05179          DATAONLY
05180          CURSOR
05181      END-EXEC.
05182
05183      MOVE '102C' TO PI-CURRENT-SCREEN-NO.
05184
05185      GO TO 9100-RETURN-TRAN.
05186
05187      EJECT
05188  8230-SEND-DATAONLY.
05189      MOVE PI-COMPANY-ID        TO CODO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDDO
05190      MOVE SAVE-DATE            TO DRUNDTEO.
05191      MOVE EIBTIME              TO TIME-IN.
05192      MOVE TIME-OUT             TO DRUNTMEO.
05193      MOVE EMI-MESSAGE-AREA (1) TO DERMSG1O.
05194      EXEC CICS SEND
05195          MAP   (MAP-NAME)
05196          MAPSET(MAPSET-NAME)
05197          FROM  (EL102DO)
05198          DATAONLY
05199          CURSOR
05200      END-EXEC.
05201
05202      MOVE '102D' TO PI-CURRENT-SCREEN-NO.
05203
05204      GO TO 9100-RETURN-TRAN.
05205      EJECT
05206  8240-SEND-DATAONLY.
05207      MOVE PI-COMPANY-ID        TO COEO.
PEMTST     MOVE PI-PROCESSOR-ID      TO USERIDEO
05208      MOVE SAVE-DATE            TO ERUNDTEO.
05209      MOVE EIBTIME              TO TIME-IN.
05210      MOVE TIME-OUT             TO ERUNTMEO.
05211      MOVE EMI-MESSAGE-AREA (1) TO EERMSG1O.
05212      EXEC CICS SEND
05213          MAP   (MAP-NAME)
05214          MAPSET(MAPSET-NAME)
05215          FROM  (EL102EO)
05216          DATAONLY
05217          CURSOR
05218      END-EXEC.
05219
05220      MOVE '102E' TO PI-CURRENT-SCREEN-NO.
05221
05222      GO TO 9100-RETURN-TRAN.
05223      EJECT
05224  8300-SEND-TEXT.
05225      EXEC CICS SEND TEXT
05226          FROM  (LOGOFF-TEXT)
05227          LENGTH(LOGOFF-LENGTH)
05228          ERASE
05229          FREEKB
05230      END-EXEC.
05231
05232      EXEC CICS RETURN
05233      END-EXEC.
05234
05235      EJECT
05236  8400-LOG-JOURNAL-RECORD.
05237 *    IF PI-JOURNAL-FILE-ID = 0
05238 *        GO TO 8400-EXIT.
05239 *
05240 *    MOVE PI-PROCESSOR-ID TO JP-USER-ID.
05241 *    MOVE FILE-ID         TO JP-FILE-ID.
05242 *    MOVE THIS-PGM        TO JP-PROGRAM-ID.
05243 *    EXEC CICS JOURNAL
05244 *        JFILEID(PI-JOURNAL-FILE-ID)
05245 *        JTYPEID('EL')
05246 *        FROM   (JOURNAL-RECORD)
05247 *        LENGTH (773)
05248 *    END-EXEC.
05249 *
05250  8400-EXIT.
05251      EXIT.
05252
05253  8800-UNAUTHORIZED-ACCESS.
05254      MOVE UNACCESS-MSG TO LOGOFF-MSG.
05255      GO TO 8300-SEND-TEXT.
05256
05257  8810-PF23.
05258      MOVE EIBAID   TO PI-ENTRY-CD-1.
05259      MOVE XCTL-005 TO PGM-NAME.
05260      GO TO 9300-XCTL.
05261
05262  8870-NOTOPEN.
05263      MOVE ER-0042 TO EMI-ERROR.
05264      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05265      MOVE -1 TO ENTERPFL.
05266      IF EIBTRNID NOT = TRANS-ID
05267          GO TO 8100-SEND-INITIAL-MAP.
05268
05269      GO TO 8200-SEND-DATAONLY.
05270
05271  8880-NOT-FOUND.
05272      MOVE ER-0043 TO EMI-ERROR.
05273      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05274      MOVE -1 TO ENTERPFL.
05275      IF EIBTRNID NOT = TRANS-ID
05276          GO TO 8100-SEND-INITIAL-MAP.
05277
05278      GO TO 8200-SEND-DATAONLY.
05279
05280  9000-RETURN-CICS.
05281      EXEC CICS RETURN
05282      END-EXEC.
05283
05284  9100-RETURN-TRAN.
05285      MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
05286      EXEC CICS RETURN
05287          TRANSID (TRANS-ID)
05288          COMMAREA(PROGRAM-INTERFACE-BLOCK)
05289          LENGTH  (PI-COMM-LENGTH)
05290      END-EXEC.
05291
05292  9200-RETURN-MAIN-MENU.
05293
05294      MOVE XCTL-626               TO PGM-NAME.
05295
05296      IF CLAIM-SESSION
05297          MOVE XCTL-126           TO PGM-NAME.
05298
05299      IF MORTGAGE-SESSION
05300          MOVE XCTL-EM626         TO PGM-NAME.
05301
05302      IF GENERAL-LEDGER-SESSION
05303          MOVE XCTL-800           TO PGM-NAME.
05304
05305  9300-XCTL.
05306      EXEC CICS XCTL
05307          PROGRAM (PGM-NAME)
05308          COMMAREA(PROGRAM-INTERFACE-BLOCK)
05309          LENGTH  (PI-COMM-LENGTH)
05310          END-EXEC.
05311
05312  9400-CLEAR.
05313      MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
05314      GO TO 9300-XCTL.
05315
05316  9500-PF12.
05317      MOVE XCTL-010 TO PGM-NAME.
05318      GO TO 9300-XCTL.
05319
05320  9600-PGMID-ERROR.
05321      EXEC CICS HANDLE CONDITION
05322          PGMIDERR(8300-SEND-TEXT)
05323      END-EXEC.
05324
05325      MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
05326      MOVE ' '          TO PI-ENTRY-CD-1.
05327      MOVE XCTL-005     TO PGM-NAME.
05328      MOVE PGM-NAME     TO LOGOFF-PGM.
05329      MOVE PGMIDERR-MSG TO LOGOFF-FILL.
05330      GO TO 9300-XCTL.
05331
05332  9900-ERROR-FORMAT.
05333      IF NOT EMI-ERRORS-COMPLETE
05334          MOVE LINK-001 TO PGM-NAME
05335          EXEC CICS LINK
05336              PROGRAM (PGM-NAME)
05337              COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
05338              LENGTH  (EMI-COMM-LENGTH)
05339          END-EXEC.
05340
05341  9900-EXIT.
05342      EXIT.
05343
05344  9990-ABEND.
05345      MOVE LINK-004 TO PGM-NAME.
05346      MOVE DFHEIBLK               TO EMI-LINE1.
05347      EXEC CICS LINK
05348          PROGRAM   (PGM-NAME)
05349          COMMAREA  (EMI-LINE1)
05350          LENGTH    (72)
05351      END-EXEC.
05352
05353      GO TO 8200-SEND-DATAONLY.
05354
05355  9995-SECURITY-VIOLATION.
05356                COPY ELCSCTP.
05357
05358  9995-EXIT.
05359       EXIT.
05360
05361  9999-LAST-PARAGRAPH SECTION.
05362      MOVE ZEROS  TO RETURN-CODE.
05362      GOBACK.
