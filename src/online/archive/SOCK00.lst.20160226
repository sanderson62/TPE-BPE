* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    19* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    20*-----------------------------------------------------------------
    21 identification division.
    22 program-id. SOCK00.
    23*         This program is the first invoked by the SOCK
    24*         transaction. This transaction must be submited
    25*         by a message transmited over a stream socket.
    26*         The first message format is:
    27*         aaaa,bbbbb              ccc
    28*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    29*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    30*         DCC or CID or any future company id
    31*         Information on the originating message and
    32*         remote socket is provided in the DFHCOMMAREA.
    33*         As its first action this program must send a
    34*         message to the requesting socket. This lets the
    35*         remote program know its request has been
    36*         accepted and the transaction started.
    37*         The program will make four transmissions to
    38*         the initating program in response to received
    39*         messages and then close the socket.
    40*         This program is provided to show method and
    41*         has minimal checking and error messages.
    42*         The Cobol compiler, unless instructed otherwise,
    43*         will hold its working storage integer data items in
    44*         machine idependent form. This matches the network
    45*         ordering of information. Care should be exercised
    46*         to ensure that this data ordering is correct when
    47*         calling system library functions or passing data
    48*         structure containing such data to functions.
    49 environment division.
    50 data division.
    51 working-storage section.
    52 01  DFH-START PIC X(04).
    53*
    54* program buffers
    55*
    56 77 ws-send-msg-size           pic s9(8) comp value 4096.
    57 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    58 77 ws-recv-buf                pic x(4096).
    59 77 ws-send-buf                pic x(4096) VALUE SPACES.
    60 77 ws-recv-total              pic s9(8) comp value 0.
    61 77 ws-recv-left               pic s9(8) comp value 0.
    62 77 ws-seq-num                 pic s9(8) comp value 0.
    63 77 ws-flags                   pic s9(8) comp value 0.
    64 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    65 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    66 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    67 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    68 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    69 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    70 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    71 77 S1                           PIC S999 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   3
* SOCK00.cbl
    72 77 S2                           PIC S999 COMP-3 VALUE +0.
    73 77 WS-BUILD-SW                  PIC X.
    74    88  TIME-TO-BUILD               VALUE 'Y'.
    75 77 WS-SAVE-ERACCT               PIC X(2000).
    76 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    77 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    78    88  GET-RATES                    VALUE 'R'.
    79    88  GET-ACT-ACCTS                VALUE 'A'.
    80 77 ws-bin-eff-dt                pic xx  value low-values.
    81 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    82 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    83 77 ws-disp-rate                 pic z9.99999.
    84 77  WS-ERACCT-SW                PIC X VALUE ' '.
    85     88  END-OF-ERACCT                 VALUE 'Y'.
    86 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    87     88  END-OF-ERCTBL                 VALUE 'Y'.
    88 77  WS-STATUS                   PIC X.
    89 01  ws-work-date.
    90     05  ws-work-ccyy            pic x(4).
    91     05  ws-work-mm              pic xx.
    92     05  ws-work-dd              pic xx.
    93 01  ws-work-date-num redefines ws-work-date
    94                                 pic 9(8).
    95 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    96 01  ws-work-apr.
    97     05  ws-apr-num              pic 99V999.
    98 01  ws-work-ben.
    99     05  ws-ben-num              pic 9(5).
   100 01  ws-work-term.
   101     05  ws-term-num             pic 999.
   102 01  ws-get-rate-data.
   103     05  rate-state              pic xx.
   104     05  rate-lf-ah              pic x.
   105     05  rate-ben-code           pic xx.
   106     05  rate-earn-meth          pic x.
   107     05  rate-ben-amt            pic x(5).
   108     05  rate-eff-date           pic x(10).
   109     05  rate-term               pic xxx.
   110     05  rate-apr                pic x(5).
   111 01  WS-FIN-RESP                 PIC X(10).
   112 01  WS-GA-DATA.
   113     05  WS-GA-NUM               PIC X(10).
   114     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   115     05  WS-GA-NAME              PIC X(30).
   116     05  WS-GA-MAIL-NAME         PIC X(30).
   117     05  WS-GA-ADDR1             PIC X(30).
   118     05  WS-GA-ADDR2             PIC X(30).
   119     05  WS-GA-ADDR3             PIC X(30).
   120     05  WS-GA-ZIP               PIC X(9).
   121     05  WS-GA-PHONE             PIC X(10).
   122 01  WS-AM-KEY.
   123     05  WS-AM-COMPANY-CD        PIC X.
   124     05  WS-AM-CARRIER           PIC X.
   125     05  WS-AM-GROUP             PIC X(6).
   126     05  WS-AM-STATE             PIC XX.
   127     05  WS-AM-ACCOUNT           PIC X(10).
   128     05  WS-AM-EXP-DT            PIC XX.
   129     05  FILLER                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   4
* SOCK00.cbl
   130 01  WS-NT-KEY.
   131     05  WS-NT-COMPANY-CD        PIC X.
   132     05  WS-NT-CARRIER           PIC X.
   133     05  WS-NT-GROUP             PIC X(6).
   134     05  WS-NT-STATE             PIC XX.
   135     05  WS-NT-ACCOUNT           PIC X(10).
   136     05  WS-NT-REC-TYPE          PIC X.
   137     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   138 01  WS-AM-ALT-KEY.
   139     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   140     05  WS-AM-ALT-EXP-DT        PIC XX.
   141 01  WS-CT-KEY-SAVE              PIC X(5).
   142 01  WS-CT-KEY.
   143     05  WS-CT-COMPANY-CD        PIC X.
   144     05  WS-CT-TABLE             PIC XXX.
   145     05  WS-CT-BEN-TYPE          PIC X.
   146     05  WS-CT-BEN-CODE          PIC XX.
   147 01  WS-CF-KEY-SAVE              PIC X(10).
   148 01  WS-CF-KEY.
   149     05  WS-CF-COMPANY-ID        PIC XXX.
   150     05  WS-CF-RECORD-TYPE       PIC X.
   151     05  WS-CF-ACCESS            PIC X(4).
   152     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   153 01  WS-CO-KEY.
   154     05  WS-CO-COMPANY-CD        PIC X.
   155     05  WS-CO-CARRIER           PIC X.
   156     05  WS-CO-GROUP             PIC X(6).
   157     05  WS-CO-FIN-RESP          PIC X(10).
   158     05  WS-CO-ACCOUNT           PIC X(10).
   159     05  WS-CO-TYPE              PIC X.
   160 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   161 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   162 01  WS-POLICY-NO                PIC X(6).
   163 01  WS-SHORT-ACCT-NAME          PIC X(30).
   164 01  WS-LONG-ACCT-NAME           PIC X(60).
   165 01  WS-CONTR-NAME               PIC X(60).
   166 01  WS-SL-COMM                  PIC 9.99999.
   167 01  WS-JL-COMM                  PIC 9.99999.
   168 01  WS-SAH-COMM                 PIC 9.99999.
   169 01  WS-JAH-COMM                 PIC 9.99999.
   170 01  WS-CID-NO                   PIC X(8).
   171 01  WS-DISP-RESP                PIC 9(5).
   172 01  WS-RESPONSE                 PIC S9(8)   COMP.
   173     88  RESP-NORMAL                  VALUE +00.
   174     88  RESP-NOTFND                  VALUE +13.
   175     88  RESP-NOTOPEN                 VALUE +19.
   176     88  RESP-ENDFILE                 VALUE +20.
   177*                                 COPY ERCACNT.
   178******************************************************************
   179*                                                                *
   180*                                                                *
   181*                            ERCACNT.                            *
   182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   183*                            VMOD=2.002                          *
   184*                                                                *
   185*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   186*                                                                *
   187*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   5
* SOCK00.cbl
   188*   RECORD SIZE = 120   RECFORM = FIXED                          *
   189*                                                                *
   190*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   191*       ALTERNATE INDEX = NONE                                   *
   192*                                                                *
   193*                                                                *
   194*   LOG = YES                                                    *
   195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   196******************************************************************
   197*                   C H A N G E   L O G
   198*
   199* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   200*-----------------------------------------------------------------
   201*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   202* EFFECTIVE    NUMBER
   203*-----------------------------------------------------------------
   204* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   205*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   206******************************************************************
   207 01  NOTE-FILE.
   208     12  NT-FILE-ID                  PIC XX.
   209         88  VALID-NOTE-ID              VALUE 'NT'.
   210
   211     12  NT-CONTROL-PRIMARY.
   212         16  NT-COMPANY-CD           PIC X.
   213         16  NT-ACCT-NOTE-KEY.
   214             18  NT-CARRIER              PIC X.
   215             18  NT-GROUPING             PIC X(06).
   216             18  NT-STATE                PIC XX.
   217             18  NT-ACCOUNT              PIC X(10).
   218         16  NT-RECORD-TYPE          PIC X.
   219              88  ACCT-NOTE          VALUE '1'.
   220              88  ACCT-BRANCH-LOC    VALUE '2'.
   221              88  ACCT-SHIPPING-ADDR VALUE '3'.
   222         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   223
   224     12  NT-LAST-MAINT-DT            PIC XX.
   225     12  NT-LAST-MAINT-BY            PIC X(4).
   226     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   227
   228*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   229*     SEQUENCE NUMBERS
   230     12  NT-NOTE-INFORMATION.
   231         16  NT-NOTE-LINE            PIC X(60).
   232         16  FILLER                  PIC X(25).
   233*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   234     12  NT-LOCATION-INFORMATION REDEFINES
   235                         NT-NOTE-INFORMATION.
   236         16  NT-BRANCH-LOC-LINE      PIC X(60).
   237         16  FILLER                  PIC X(25).
   238*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   239*     SEQUENCE NUMBER 1 IS NAME LINE 1
   240*     SEQUENCE NUMBER 2 IS NAME LINE 2
   241*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   242*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   243*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   244*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   245     12  NT-SHIPPING-INFORMATION REDEFINES
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   6
* SOCK00.cbl
   246                         NT-NOTE-INFORMATION.
   247         16  NT-SHIPPING-LINE        PIC X(60).
   248         16  NT-SHIP-STATE           PIC XX.
   249         16  NT-SHIP-ZIP             PIC X(10).
   250         16  FILLER                  PIC X(13).
   251*****************************************************************
   252*                                 COPY ERCACCT.
   253******************************************************************
   254*                                                                *
   255*                                                                *
   256*                            ERCACCT                             *
   257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   258*                            VMOD=2.031                          *
   259*                                                                *
   260*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   261*                                                                *
   262*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   263*   VSAM ACCOUNT MASTER FILES.                                   *
   264*                                                                *
   265*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   266*                                                                *
   267*   FILE TYPE = VSAM,KSDS                                        *
   268*   RECORD SIZE = 2000  RECFORM = FIX                            *
   269*                                                                *
   270*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   271*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   272*                                                                *
   273*   LOG = NO                                                     *
   274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   275*                                                                *
   276*                                                                *
   277******************************************************************
   278*                   C H A N G E   L O G
   279*
   280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   281*-----------------------------------------------------------------
   282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   283* EFFECTIVE    NUMBER
   284*-----------------------------------------------------------------
   285* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   286* 092705    2005050300006  PEMA  ADD SPP LEASES
   287* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   288* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   289* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   290* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   291* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   292******************************************************************
   293
   294 01  ACCOUNT-MASTER.
   295     12  AM-RECORD-ID                      PIC XX.
   296         88  VALID-AM-ID                      VALUE 'AM'.
   297
   298     12  AM-CONTROL-PRIMARY.
   299         16  AM-COMPANY-CD                 PIC X.
   300         16  AM-MSTR-CNTRL.
   301             20  AM-CONTROL-A.
   302                 24  AM-CARRIER            PIC X.
   303                 24  AM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   7
* SOCK00.cbl
   304                     28 AM-GROUPING-PREFIX PIC XXX.
   305                     28 AM-GROUPING-PRIME  PIC XXX.
   306                 24  AM-STATE              PIC XX.
   307                 24  AM-ACCOUNT.
   308                     28  AM-ACCOUNT-PREFIX PIC X(4).
   309                     28  AM-ACCOUNT-PRIME  PIC X(6).
   310             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   311                                           PIC X(19).
   312             20  AM-CNTRL-B.
   313                 24  AM-EXPIRATION-DT      PIC XX.
   314                 24  FILLER                PIC X(4).
   315             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   316                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   317
   318     12  AM-CONTROL-BY-VAR-GRP.
   319         16  AM-COMPANY-CD-A1              PIC X.
   320         16  AM-VG-CARRIER                 PIC X.
   321         16  AM-VG-GROUPING                PIC X(6).
   322         16  AM-VG-STATE                   PIC XX.
   323         16  AM-VG-ACCOUNT                 PIC X(10).
   324         16  AM-VG-DATE.
   325             20  AM-VG-EXPIRATION-DT       PIC XX.
   326             20  FILLER                    PIC X(4).
   327         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   328                                           PIC 9(11)      COMP-3.
   329     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   330         16  FILLER                        PIC X(10).
   331         16  AM-VG-KEY3.
   332             20  AM-VG3-ACCOUNT            PIC X(10).
   333             20  AM-VG3-EXP-DT             PIC XX.
   334         16  FILLER                        PIC X(4).
   335     12  AM-MAINT-INFORMATION.
   336         16  AM-LAST-MAINT-DT              PIC XX.
   337         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   338         16  AM-LAST-MAINT-USER            PIC X(4).
   339         16  FILLER                        PIC XX.
   340
   341     12  AM-EFFECTIVE-DT                   PIC XX.
   342     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   343
   344     12  AM-PREV-DATES  COMP-3.
   345         16  AM-PREV-EXP-DT                PIC 9(11).
   346         16  AM-PREV-EFF-DT                PIC 9(11).
   347
   348     12  AM-REPORT-CODE-1                  PIC X(10).
   349     12  AM-REPORT-CODE-2                  PIC X(10).
   350
   351     12  AM-CITY-CODE                      PIC X(4).
   352     12  AM-COUNTY-PARISH                  PIC X(6).
   353
   354     12  AM-NAME                           PIC X(30).
   355     12  AM-PERSON                         PIC X(30).
   356     12  AM-ADDRS                          PIC X(30).
   357     12  AM-CITY.
   358         16  AM-ADDR-CITY                  PIC X(28).
   359         16  AM-ADDR-STATE                 PIC XX.
   360     12  AM-ZIP.
   361         16  AM-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   8
* SOCK00.cbl
   362             20  AM-ZIP-PRI-1ST            PIC X.
   363                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   364             20  FILLER                    PIC X(4).
   365         16  AM-ZIP-PLUS4                  PIC X(4).
   366     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   367         16  AM-CAN-POSTAL-1               PIC XXX.
   368         16  AM-CAN-POSTAL-2               PIC XXX.
   369         16  FILLER                        PIC XXX.
   370     12  AM-TEL-NO.
   371         16  AM-AREA-CODE                  PIC 999.
   372         16  AM-TEL-PRE                    PIC 999.
   373         16  AM-TEL-NBR                    PIC 9(4).
   374     12  AM-TEL-LOC                        PIC X.
   375         88  AM-TEL-AT-HOME                   VALUE 'H'.
   376         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   377
   378     12  AM-COMM-STRUCTURE.
   379         16  AM-DEFN-1.
   380             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   381                 24  AM-AGT.
   382                     28  AM-AGT-PREFIX     PIC X(4).
   383                     28  AM-AGT-PRIME      PIC X(6).
   384                 24  AM-COM-TYP            PIC X.
   385                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   386                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   387                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   388                 24  AM-RECALC-LV-INDIC    PIC X.
   389                 24  AM-RETRO-LV-INDIC     PIC X.
   390                 24  AM-GL-CODES           PIC X.
   391                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   392                 24  FILLER                PIC X(01).
   393         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   394             20  AM-COM-TBLS        OCCURS 10 TIMES.
   395                 24  FILLER                PIC X(11).
   396                 24  AM-L-COMA             PIC XXX.
   397                 24  AM-J-COMA             PIC XXX.
   398                 24  AM-A-COMA             PIC XXX.
   399                 24  FILLER                PIC X(6).
   400
   401     12  AM-COMM-CHANGE-STATUS             PIC X.
   402         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   403
   404     12  AM-CSR-CODE                       PIC X(4).
   405
   406     12  AM-BILLING-STATUS                 PIC X.
   407         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   408         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   409     12  AM-AUTO-REFUND-SW                 PIC X.
   410         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   411         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   412     12  AM-GPCD                           PIC 99.
   413     12  AM-IG                             PIC X.
   414         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   415         88  AM-HAS-GROUP                     VALUE '2'.
   416     12  AM-STATUS                         PIC X.
   417         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   418         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   419         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   9
* SOCK00.cbl
   420         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   421         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   422         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   423     12  AM-REMIT-TO                       PIC 99.
   424     12  AM-ID-NO                          PIC X(11).
   425
   426     12  AM-CAL-TABLE                      PIC XX.
   427     12  AM-LF-DEVIATION                   PIC XXX.
   428     12  AM-AH-DEVIATION                   PIC XXX.
   429     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   430     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   431     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   432     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   433     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   434     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   435
   436     12  AM-USER-FIELDS.
   437         16  AM-FLD-1                      PIC XX.
   438         16  AM-FLD-2                      PIC XX.
   439         16  AM-FLD-3                      PIC XX.
   440         16  AM-FLD-4                      PIC XX.
   441         16  AM-FLD-5                      PIC XX.
   442
   443     12  AM-1ST-PROD-DATE.
   444         16  AM-1ST-PROD-YR                PIC XX.
   445         16  AM-1ST-PROD-MO                PIC XX.
   446         16  AM-1ST-PROD-DA                PIC XX.
   447     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   448     12  AM-CERTS-PURGED-DATE.
   449         16  AM-PUR-YR                     PIC XX.
   450         16  AM-PUR-MO                     PIC XX.
   451         16  AM-PUR-DA                     PIC XX.
   452     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   453     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   454     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   455     12  AM-INACTIVE-DATE.
   456         16  AM-INA-MO                     PIC 99.
   457         16  AM-INA-DA                     PIC 99.
   458         16  AM-INA-YR                     PIC 99.
   459     12  AM-AR-HI-CERT-DATE                PIC XX.
   460
   461     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   462     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   463
   464     12  AM-OB-PAYMENT-MODE                PIC X.
   465         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   466         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   467         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   468         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   469
   470     12  AM-AH-ONLY-INDICATOR              PIC X.
   471         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   472         88  AM-NO-AH-ONLY                    VALUE 'N'.
   473
   474     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   475
   476     12  AM-OVER-SHORT.
   477         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  10
* SOCK00.cbl
   478         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   479
   480     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   481     12  AM-DCC-CLP-STATE                  PIC XX.
   482
   483     12  AM-RECALC-COMM                    PIC X.
   484     12  AM-RECALC-REIN                    PIC X.
   485
   486     12  AM-REI-TABLE                      PIC XXX.
   487     12  AM-REI-ET-LF                      PIC X.
   488     12  AM-REI-ET-AH                      PIC X.
   489     12  AM-REI-PE-LF                      PIC X.
   490     12  AM-REI-PE-AH                      PIC X.
   491     12  AM-REI-PRT-ST                     PIC X.
   492     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   493     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   494     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   495     12  AM-REI-GROUP-A                    PIC X(6).
   496     12  AM-REI-MORT                       PIC X(4).
   497     12  AM-REI-PRT-OW                     PIC X.
   498     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   499     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   500     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   501     12  AM-REI-GROUP-B                    PIC X(6).
   502
   503     12  AM-TRUST-TYPE                     PIC X(2).
   504
   505     12  AM-EMPLOYER-STMT-USED             PIC X.
   506     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   507
   508     12  AM-STD-AH-TYPE                    PIC XX.
   509     12  AM-EARN-METHODS.
   510         16  AM-EARN-METHOD-R              PIC X.
   511             88 AM-REF-RL-R78                 VALUE 'R'.
   512             88 AM-REF-RL-PR                  VALUE 'P'.
   513             88 AM-REF-RL-MEAN                VALUE 'M'.
   514             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   515         16  AM-EARN-METHOD-L              PIC X.
   516             88 AM-REF-LL-R78                 VALUE 'R'.
   517             88 AM-REF-LL-PR                  VALUE 'P'.
   518             88 AM-REF-LL-MEAN                VALUE 'M'.
   519             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   520         16  AM-EARN-METHOD-A              PIC X.
   521             88 AM-REF-AH-R78                 VALUE 'R'.
   522             88 AM-REF-AH-PR                  VALUE 'P'.
   523             88 AM-REF-AH-MEAN                VALUE 'M'.
   524             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   525             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   526             88 AM-REF-AH-NET                 VALUE 'N'.
   527
   528     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   529     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   530     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   531
   532     12  AM-RET-Y-N                        PIC X.
   533     12  AM-RET-P-E                        PIC X.
   534     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   535     12  AM-AH-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  11
* SOCK00.cbl
   536     12  AM-RET-GRP                        PIC X(6).
   537     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   538         16  AM-POOL-PRIME                 PIC XXX.
   539         16  AM-POOL-SUB                   PIC XXX.
   540     12  AM-RETRO-EARNINGS.
   541         16  AM-RET-EARN-R                 PIC X.
   542         16  AM-RET-EARN-L                 PIC X.
   543         16  AM-RET-EARN-A                 PIC X.
   544     12  AM-RET-ST-TAX-USE                 PIC X.
   545         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   546         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   547     12  AM-RETRO-BEG-EARNINGS.
   548         16  AM-RET-BEG-EARN-R             PIC X.
   549         16  AM-RET-BEG-EARN-L             PIC X.
   550         16  AM-RET-BEG-EARN-A             PIC X.
   551     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   552     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   553
   554     12  AM-USER-SELECT-OPTIONS.
   555         16  AM-USER-SELECT-1              PIC X(10).
   556         16  AM-USER-SELECT-2              PIC X(10).
   557         16  AM-USER-SELECT-3              PIC X(10).
   558         16  AM-USER-SELECT-4              PIC X(10).
   559         16  AM-USER-SELECT-5              PIC X(10).
   560
   561     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   562
   563     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   564
   565     12  AM-RPT045A-SWITCH                 PIC X.
   566         88  RPT045A-OFF                   VALUE 'N'.
   567
   568     12  AM-INSURANCE-LIMITS.
   569         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   570         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   571
   572     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   573         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   574
   575     12  AM-DISMBR-COVERAGE-SW             PIC X.
   576         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   577         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   578
   579     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   580
   581     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   582     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   583     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   584     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   585     12  AM-DCC-UEF-STATE                  PIC XX.
   586     12  FILLER                            PIC XXX.
   587     12  AM-REPORT-CODE-3                  PIC X(10).
   588*    12  FILLER                            PIC X(22).
   589
   590     12  AM-RESERVE-DATE.
   591         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   592         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   593         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  12
* SOCK00.cbl
   594
   595     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   596     12  AM-NOTIFICATION-TYPES.
   597         16  AM-NOTIF-OF-LETTERS           PIC X.
   598         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   599         16  AM-NOTIF-OF-REPORTS           PIC X.
   600         16  AM-NOTIF-OF-STATUS            PIC X.
   601
   602     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   603         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   604         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   605         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   606         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   607
   608     12  AM-BENEFIT-CONTROLS.
   609         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   610             20  AM-BENEFIT-CODE           PIC XX.
   611             20  AM-BENEFIT-TYPE           PIC X.
   612             20  AM-BENEFIT-REVISION       PIC XXX.
   613             20  AM-BENEFIT-REM-TERM       PIC X.
   614             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   615             20  FILLER                    PIC XX.
   616         16  FILLER                        PIC X(80).
   617
   618     12  AM-TRANSFER-DATA.
   619         16  AM-TRANSFERRED-FROM.
   620             20  AM-TRNFROM-CARRIER        PIC X.
   621             20  AM-TRNFROM-GROUPING.
   622                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   623                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   624             20  AM-TRNFROM-STATE          PIC XX.
   625             20  AM-TRNFROM-ACCOUNT.
   626                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   627                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   628             20  AM-TRNFROM-DTE            PIC XX.
   629         16  AM-TRANSFERRED-TO.
   630             20  AM-TRNTO-CARRIER          PIC X.
   631             20  AM-TRNTO-GROUPING.
   632                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   633                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   634             20  AM-TRNTO-STATE            PIC XX.
   635             20  AM-TRNTO-ACCOUNT.
   636                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   637                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   638             20  AM-TRNTO-DTE              PIC XX.
   639         16  FILLER                        PIC X(10).
   640
   641     12  AM-SAVED-REMIT-TO                 PIC 99.
   642
   643     12  AM-COMM-STRUCTURE-SAVED.
   644         16  AM-DEFN-1-SAVED.
   645             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   646                 24  AM-AGT-SV             PIC X(10).
   647                 24  AM-COM-TYP-SV         PIC X.
   648                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   649                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   650                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   651                 24  AM-RECALC-LV-INDIC-SV PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  13
* SOCK00.cbl
   652                 24  FILLER                PIC X.
   653                 24  AM-GL-CODES-SV        PIC X.
   654                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   655                 24  FILLER                PIC X.
   656         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   657             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   658                 24  FILLER                PIC X(11).
   659                 24  AM-L-COMA-SV          PIC XXX.
   660                 24  AM-J-COMA-SV          PIC XXX.
   661                 24  AM-A-COMA-SV          PIC XXX.
   662                 24  FILLER                PIC X(6).
   663
   664     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   665         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   666            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   667            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   668            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   669
   670     12  AM-ORIG-DEALER-NO                 PIC X(10).
   671     12  FILLER                            PIC X(120).
   672
   673     12  AM-ACCOUNT-EXECUTIVE-DATA.
   674         16  AM-CONTROL-NAME               PIC X(30).
   675         16  AM-EXECUTIVE-ONE.
   676             20  AM-EXEC1-NAME             PIC X(15).
   677             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   678                                                          COMP-3.
   679             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   680                                                          COMP-3.
   681         16  AM-EXECUTIVE-TWO.
   682             20  AM-EXEC2-NAME             PIC X(15).
   683             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   684                                                          COMP-3.
   685             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   686                                                          COMP-3.
   687
   688     12  AM-RETRO-ADDITIONAL-DATA.
   689         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   690         16  AM-RETRO-PREM-P-E             PIC X.
   691         16  AM-RETRO-CLMS-P-I             PIC X.
   692         16  AM-RETRO-RET-BRACKET-LF.
   693             20  AM-RETRO-RET-METHOD-LF    PIC X.
   694                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   695                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   696             20  AM-RETRO-RET-BASIS-LF     PIC X.
   697                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   698                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   699             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   700                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   701                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   702         16  AM-RETRO-RET-BRACKET-AH.
   703             20  AM-RETRO-RET-METHOD-AH    PIC X.
   704                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   705                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   706                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   707             20  AM-RETRO-RET-BASIS-AH     PIC X.
   708                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   709                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  14
* SOCK00.cbl
   710             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   711                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   712                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   713
   714     12  AM-COMMENTS.
   715         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   716
   717     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   718         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   719         16  AM-FLI-BILLING-CODE           PIC X.
   720         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   721         16  AM-FLI-UNITED-IDENT           PIC X.
   722         16  AM-FLI-INTEREST-LOST-DATA.
   723             20  AM-FLI-BANK-NO            PIC X(5).
   724             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   725             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   726             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   727         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   728             20  AM-FLI-AGT                PIC X(9).
   729             20  AM-FLI-AGT-COMM-ACC       PIC X.
   730             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   731         16  FILLER                        PIC X(102).
   732
   733     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   734         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   735             20  AM-BENEFIT-DMD-CODE         PIC XX.
   736             20  AM-BENEFIT-DMD-TYPE         PIC X.
   737             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   738             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   739             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   740         16  FILLER                          PIC X(10).
   741******************************************************************
   742*                                 COPY ERCCOMP.
   743******************************************************************
   744*                                                                *
   745*                                                                *
   746*                            ERCCOMP                             *
   747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   748*                            VMOD=2.019                          *
   749*                                                                *
   750*   ONLINE CREDIT SYSTEM                                         *
   751*                                                                *
   752*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   753*                                                                *
   754*   FILE TYPE = VSAM,KSDS                                        *
   755*   RECORD SIZE = 700   RECFORM = FIXED                          *
   756*                                                                *
   757*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   758*       ALTERNATE PATH = NONE                                    *
   759*                                                                *
   760*   LOG = NO                                                     *
   761*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   762*                                                                *
   763******************************************************************
   764*                   C H A N G E   L O G
   765*
   766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   767*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  15
* SOCK00.cbl
   768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   769* EFFECTIVE    NUMBER
   770*-----------------------------------------------------------------
   771* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   772* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   773* 092205    2005050300006  PEMA  ADD LEASE FEE
   774* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   775* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   776* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   777* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   778* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   779* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   780******************************************************************
   781
   782 01  COMPENSATION-MASTER.
   783     12  CO-RECORD-ID                          PIC XX.
   784         88  VALID-CO-ID                          VALUE 'CO'.
   785
   786     12  CO-CONTROL-PRIMARY.
   787         16  CO-COMPANY-CD                     PIC X.
   788         16  CO-CONTROL.
   789             20  CO-CTL-1.
   790                 24  CO-CARR-GROUP.
   791                     28  CO-CARRIER            PIC X.
   792                     28  CO-GROUPING.
   793                         32  CO-GROUP-PREFIX   PIC XXX.
   794                         32  CO-GROUP-PRIME    PIC XXX.
   795                 24  CO-RESP-NO.
   796                     28  CO-RESP-PREFIX        PIC X(4).
   797                     28  CO-RESP-PRIME         PIC X(6).
   798             20  CO-CTL-2.
   799                 24  CO-ACCOUNT.
   800                     28  CO-ACCT-PREFIX        PIC X(4).
   801                     28  CO-ACCT-PRIME         PIC X(6).
   802         16  CO-TYPE                           PIC X.
   803             88  CO-COMPANY-TYPE                  VALUE 'C'.
   804             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   805             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   806
   807     12  CO-MAINT-INFORMATION.
   808         16  CO-LAST-MAINT-DT                  PIC XX.
   809         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   810         16  CO-LAST-MAINT-USER                PIC X(4).
   811     12  FILLER                                PIC XX.
   812     12  CO-STMT-TYPE                          PIC XXX.
   813     12  CO-COMP-TYPE                          PIC X.
   814         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   815     12  CO-STMT-OWNER                         PIC X(4).
   816     12  CO-BALANCE-CONTROL                    PIC X.
   817         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   818         88  CO-NO-BALANCE                        VALUE 'N'.
   819
   820     12  CO-INTERNAL-CONTROL-1                 PIC X.
   821         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   822         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   823         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   824
   825     12  CO-INTERNAL-CONTROL-2                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  16
* SOCK00.cbl
   826         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   827         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   828
   829     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   830     12  CO-GA-DIRECT-DEP                      PIC X.
   831     12  CO-FUTURE-SPACE                       PIC X.
   832         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   833
   834     12  CO-ACCT-NAME                          PIC X(30).
   835     12  CO-MAIL-NAME                          PIC X(30).
   836     12  CO-ADDR-1                             PIC X(30).
   837     12  CO-ADDR-2                             PIC X(30).
   838     12  CO-ADDR-3.
   839         16  CO-ADDR-CITY                      PIC X(27).
   840         16  CO-ADDR-STATE                     PIC XX.
   841     12  CO-CSO-1099                           PIC X.
   842     12  CO-ZIP.
   843         16  CO-ZIP-PRIME.
   844             20  CO-ZIP-PRI-1ST                PIC X.
   845                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   846             20  FILLER                        PIC X(4).
   847         16  CO-ZIP-PLUS4                      PIC X(4).
   848     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   849         16  CO-CAN-POSTAL-1                   PIC XXX.
   850         16  CO-CAN-POSTAL-2                   PIC XXX.
   851         16  FILLER                            PIC XXX.
   852     12  CO-SOC-SEC                            PIC X(13).
   853     12  CO-TELEPHONE.
   854         16  CO-AREA-CODE                      PIC XXX.
   855         16  CO-PREFIX                         PIC XXX.
   856         16  CO-PHONE                          PIC X(4).
   857
   858     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   859
   860     12  CO-AR-BAL-LEVEL                       PIC X.
   861         88  CO-AR-REF-LVL                        VALUE '1'.
   862         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   863         88  CO-AR-BILL-LVL                       VALUE '2'.
   864         88  CO-AR-AGT-LVL                        VALUE '3'.
   865         88  CO-AR-FR-LVL                         VALUE '4'.
   866
   867     12  CO-AR-NORMAL-PRINT                    PIC X.
   868         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   869         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   870
   871     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   872
   873     12  CO-AR-REPORTING                       PIC X.
   874         88  CO-AR-NET-REPORT                     VALUE 'N'.
   875         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   876
   877     12  CO-AR-PULL-CHECK                      PIC X.
   878         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   879         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   880
   881     12  CO-AR-BALANCE-PRINT                   PIC X.
   882         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   883
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  17
* SOCK00.cbl
   884     12  CO-AR-LAST-RUN-CODE                   PIC X.
   885         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   886         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   887         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   888
   889     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   890
   891     12  CO-USER-CODE                          PIC X.
   892     12  CO-REPORT-GROUP-ID                    PIC X(12).
   893
   894******************************************************************
   895*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   896*    THE LAST MONTH END RUN.
   897******************************************************************
   898
   899     12  CO-LAST-ACTIVITY-DATE.
   900         16  CO-ACT-YEAR                       PIC 99.
   901         16  CO-ACT-MONTH                      PIC 99.
   902         16  CO-ACT-DAY                        PIC 99.
   903
   904     12  CO-LAST-STMT-DT.
   905         16  CO-LAST-STMT-YEAR                 PIC 99.
   906         16  CO-LAST-STMT-MONTH                PIC 99.
   907         16  CO-LAST-STMT-DAY                  PIC 99.
   908
   909     12  CO-MO-END-TOTALS.
   910         16  CO-MONTHLY-TOTALS.
   911             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   912             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   913             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   914             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   915             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   916
   917         16  CO-AGING-TOTALS.
   918             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   919             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   920             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   921             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   922
   923         16  CO-YTD-TOTALS.
   924             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   925             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   926
   927         16  CO-OVER-UNDER-TOTALS.
   928             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   929             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   930
   931     12  CO-MISCELLANEOUS-TOTALS.
   932         16  CO-FICA-TOTALS.
   933             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   934             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   935
   936         16  CO-CLAIM-TOTALS.
   937             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   938             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   939
   940******************************************************************
   941*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  18
* SOCK00.cbl
   942*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   943******************************************************************
   944
   945     12  CO-CURRENT-TOTALS.
   946         16  CO-CURRENT-LAST-STMT-DT.
   947             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   948             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   949             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   950
   951         16  CO-CURRENT-MONTHLY-TOTALS.
   952             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   953             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   954             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   955             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   956             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   957
   958         16  CO-CURRENT-AGING-TOTALS.
   959             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   960             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   961             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   962             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   963
   964         16  CO-CURRENT-YTD-TOTALS.
   965             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   966             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   967
   968     12  CO-PAID-COMM-TOTALS.
   969         16  CO-YTD-PAID-COMMS.
   970             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   971             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   972
   973     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   974         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   975         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   976
   977     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   978         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   979         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   980         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   981         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   982         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   983         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   984         88  CO-FINAL-LETTER                  VALUE 'F'.
   985         88  CO-RECONCILING                   VALUE 'R'.
   986         88  CO-PHONE-CALL                    VALUE 'P'.
   987         88  CO-LEGAL                         VALUE 'L'.
   988         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   989         88  CO-WRITE-OFF                     VALUE 'W'.
   990         88  CO-NO-ACTION                     VALUE 'N' ' '.
   991
   992     12  CO-CSR-CODE                       PIC X(4).
   993
   994     12  CO-GA-STATUS-INFO.
   995         16  CO-GA-EFFECTIVE-DT            PIC XX.
   996         16  CO-GA-TERMINATION-DT          PIC XX.
   997         16  CO-GA-STATUS-CODE             PIC X.
   998             88  CO-GA-ACTIVE                 VALUE 'A'.
   999             88  CO-GA-INACTIVE               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  19
* SOCK00.cbl
  1000             88  CO-GA-PENDING                VALUE 'P'.
  1001         16  CO-GA-COMMENTS.
  1002             20  CO-GA-COMMENT-1           PIC X(40).
  1003             20  CO-GA-COMMENT-2           PIC X(40).
  1004             20  CO-GA-COMMENT-3           PIC X(40).
  1005             20  CO-GA-COMMENT-4           PIC X(40).
  1006
  1007     12  CO-RPTCD2                         PIC X(10).
  1008     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1009         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1010         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1011
  1012     12  CO-TYPE-AGENT                     PIC X(01).
  1013         88  CO-CORPORATION                   VALUE 'C'.
  1014         88  CO-PARTNERSHIP                   VALUE 'P'.
  1015         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1016         88  CO-TRUST                         VALUE 'T'.
  1017         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1018
  1019     12  CO-FAXNO.
  1020         16  CO-FAX-AREA-CODE                  PIC XXX.
  1021         16  CO-FAX-PREFIX                     PIC XXX.
  1022         16  CO-FAX-PHONE                      PIC X(4).
  1023
  1024     12  CO-BANK-INFORMATION.
  1025         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1026         16  CO-BANK-TRANSIT-NON REDEFINES
  1027             CO-BANK-TRANSIT-NO                PIC 9(8).
  1028
  1029         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1030     12  CO-MISC-DEDUCT-INFO REDEFINES
  1031                  CO-BANK-INFORMATION.
  1032         16  CO-MD-GL-ACCT                     PIC X(10).
  1033         16  CO-MD-DIV                         PIC XX.
  1034         16  CO-MD-CENTER                      PIC X(4).
  1035         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1036         16  CO-CREATE-AP-CHECK                PIC X.
  1037         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1038         16  FILLER                            PIC XXX.
  1039     12  CO-ACH-STATUS                         PIC X.
  1040         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1041         88  CO-ACH-PENDING                        VALUE 'P'.
  1042
  1043     12  CO-BILL-SW                            PIC X.
  1044     12  CO-CONTROL-NAME                       PIC X(30).
  1045     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1046     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1047     12  CO-CLP-STATE                          PIC XX.
  1048     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1049     12  CO-SPP-REFUND-EDIT                    PIC X.
  1050
  1051******************************************************************
  1052*                                 COPY ELCCNTL.
  1053******************************************************************
  1054*                                                                *
  1055*                                                                *
  1056*                            ELCCNTL.                            *
  1057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  20
* SOCK00.cbl
  1058*                            VMOD=2.059                          *
  1059*                                                                *
  1060*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1061*                                                                *
  1062*   FILE TYPE = VSAM,KSDS                                        *
  1063*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1064*                                                                *
  1065*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1066*       ALTERNATE INDEX = NONE                                   *
  1067*                                                                *
  1068*   LOG = YES                                                    *
  1069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1070******************************************************************
  1071*                   C H A N G E   L O G
  1072*
  1073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1074*-----------------------------------------------------------------
  1075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1076* EFFECTIVE    NUMBER
  1077*-----------------------------------------------------------------
  1078* 082503                   PEMA  ADD BENEFIT GROUP
  1079* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1080* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1081* 092705    2005050300006  PEMA  ADD SPP LEASES
  1082* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1083* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1084* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1085* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1086* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1087* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1088* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1089* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1090* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1091* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1092******************************************************************
  1093*
  1094 01  CONTROL-FILE.
  1095     12  CF-RECORD-ID                       PIC XX.
  1096         88  VALID-CF-ID                        VALUE 'CF'.
  1097
  1098     12  CF-CONTROL-PRIMARY.
  1099         16  CF-COMPANY-ID                  PIC XXX.
  1100         16  CF-RECORD-TYPE                 PIC X.
  1101             88  CF-COMPANY-MASTER              VALUE '1'.
  1102             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1103             88  CF-STATE-MASTER                VALUE '3'.
  1104             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1105             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1106             88  CF-CARRIER-MASTER              VALUE '6'.
  1107             88  CF-MORTALITY-MASTER            VALUE '7'.
  1108             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1109             88  CF-TERMINAL-MASTER             VALUE '9'.
  1110             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1111             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1112             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1113             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1114             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1115             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  21
* SOCK00.cbl
  1116             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1117             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1118             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1119         16  CF-ACCESS-CD-GENL              PIC X(4).
  1120         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1121             20  CF-PROCESSOR               PIC X(4).
  1122         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1123             20  CF-STATE-CODE              PIC XX.
  1124             20  FILLER                     PIC XX.
  1125         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1126             20  FILLER                     PIC XX.
  1127             20  CF-HI-BEN-IN-REC           PIC XX.
  1128         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1129             20  FILLER                     PIC XXX.
  1130             20  CF-CARRIER-CNTL            PIC X.
  1131         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1132             20  FILLER                     PIC XX.
  1133             20  CF-HI-TYPE-IN-REC          PIC 99.
  1134         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1135             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1136                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1137             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1138             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1139         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1140             20  FILLER                     PIC X.
  1141             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1142         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1143             20  FILLER                     PIC XX.
  1144             20  CF-MORTGAGE-PLAN           PIC XX.
  1145         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1146
  1147     12  CF-LAST-MAINT-DT                   PIC XX.
  1148     12  CF-LAST-MAINT-BY                   PIC X(4).
  1149     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1150
  1151     12  CF-RECORD-BODY                     PIC X(728).
  1152
  1153
  1154****************************************************************
  1155*             COMPANY MASTER RECORD                            *
  1156****************************************************************
  1157
  1158     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1159         16  CF-COMPANY-ADDRESS.
  1160             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1161             20  CF-CL-IN-CARE-OF           PIC X(30).
  1162             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1163             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1164             20  CF-CL-CITY-STATE           PIC X(30).
  1165             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1166             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1167         16  CF-COMPANY-CD                  PIC X.
  1168         16  CF-COMPANY-PASSWORD            PIC X(8).
  1169         16  CF-SECURITY-OPTION             PIC X.
  1170             88  ALL-SECURITY                   VALUE '1'.
  1171             88  COMPANY-VERIFY                 VALUE '2'.
  1172             88  PROCESSOR-VERIFY               VALUE '3'.
  1173             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  22
* SOCK00.cbl
  1174             88  ALL-BUT-TERM                   VALUE '5'.
  1175         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1176             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1177         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1178             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1179         16  CF-INFORCE-LOCATION            PIC X.
  1180             88  CERTS-ARE-ONLINE               VALUE '1'.
  1181             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1182             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1183         16  CF-LOWER-CASE-LETTERS          PIC X.
  1184         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1185             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1186             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1187             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1188             88  CF-ACCNT-CNTL                  VALUE '3'.
  1189             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1190
  1191         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1192         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1193
  1194         16  CF-LGX-CREDIT-USER             PIC X.
  1195             88  CO-IS-NOT-USER                 VALUE 'N'.
  1196             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1197
  1198         16 CF-CREDIT-CALC-CODES.
  1199             20  CF-CR-REM-TERM-CALC PIC X.
  1200               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1201               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1202               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1203               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1204               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1205               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1206               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1207             20  CF-CR-R78-METHOD           PIC X.
  1208               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1209               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1210
  1211         16  CF-CLAIM-CONTROL-COUNTS.
  1212             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1213                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1214
  1215             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1216                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1217
  1218             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1219                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1220
  1221             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1222                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1223
  1224         16  CF-CURRENT-MONTH-END           PIC XX.
  1225
  1226         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1227             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1228             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1229             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1230             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1231                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  23
* SOCK00.cbl
  1232                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1233             20  CF-CO-PREM-REJECT-SW       PIC X.
  1234                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1235                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1236             20  CF-CO-REF-REJECT-SW        PIC X.
  1237                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1238                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1239
  1240         16  CF-CO-REPORTING-DT             PIC XX.
  1241         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1242         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1243           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1244           88  CF-CO-MONTH-END                  VALUE '1'.
  1245
  1246         16  CF-LGX-CLAIM-USER              PIC X.
  1247             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1248             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1249
  1250         16  CF-CREDIT-EDIT-CONTROLS.
  1251             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1252             20  CF-MIN-AGE                 PIC 99.
  1253             20  CF-DEFAULT-AGE             PIC 99.
  1254             20  CF-MIN-TERM                PIC S999      COMP-3.
  1255             20  CF-MAX-TERM                PIC S999      COMP-3.
  1256             20  CF-DEFAULT-SEX             PIC X.
  1257             20  CF-JOINT-AGE-INPUT         PIC X.
  1258                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1259             20  CF-BIRTH-DATE-INPUT        PIC X.
  1260                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1261             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1262                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1263                 88  CF-ZERO-CARRIER            VALUE '1'.
  1264                 88  CF-ZERO-GROUPING           VALUE '2'.
  1265                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1266             20  CF-EDIT-SW                 PIC X.
  1267                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1268             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1269             20  CF-CR-PR-METHOD            PIC X.
  1270               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1271               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1272             20  FILLER                     PIC X.
  1273
  1274         16  CF-CREDIT-MISC-CONTROLS.
  1275             20  CF-REIN-TABLE-SW           PIC X.
  1276                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1277             20  CF-COMP-TABLE-SW           PIC X.
  1278                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1279             20  CF-EXPERIENCE-RETENTION-AGE
  1280                                            PIC S9        COMP-3.
  1281             20  CF-CONVERSION-DT           PIC XX.
  1282             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1283             20  CF-RUN-FREQUENCY-SW        PIC X.
  1284                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1285                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1286
  1287             20  CF-CR-CHECK-NO-CONTROL.
  1288                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1289                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  24
* SOCK00.cbl
  1290                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1291                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1292                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1293                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1294
  1295                 24  CF-CR-CHECK-COUNT       REDEFINES
  1296                     CF-CR-CHECK-COUNTER      PIC X(4).
  1297
  1298                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1299                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1300
  1301                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1302                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1303                 24  CF-MAIL-PROCESSING       PIC X.
  1304                     88  MAIL-PROCESSING          VALUE 'Y'.
  1305
  1306         16  CF-MISC-SYSTEM-CONTROL.
  1307             20  CF-SYSTEM-C                 PIC X.
  1308                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1309             20  CF-SYSTEM-D                 PIC X.
  1310                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1311             20  CF-SOC-SEC-NO-SW            PIC X.
  1312                 88  SOC-SEC-NO-USED             VALUE '1'.
  1313             20  CF-MEMBER-NO-SW             PIC X.
  1314                 88  MEMBER-NO-USED              VALUE '1'.
  1315             20  CF-TAX-ID-NUMBER            PIC X(11).
  1316             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1317             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1318                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1319                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1320                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1321                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1322             20  CF-SYSTEM-E                 PIC X.
  1323                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1324
  1325         16  CF-LGX-LIFE-USER               PIC X.
  1326             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1327             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1328
  1329         16  CF-CR-MONTH-END-DT             PIC XX.
  1330
  1331         16  CF-FILE-MAINT-DATES.
  1332             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1333                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1334             20  CF-LAST-BATCH       REDEFINES
  1335                 CF-LAST-BATCH-NO               PIC X(4).
  1336             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1337             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1338             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1339             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1340             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1341             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1342             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1343             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1344             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1345             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1346
  1347         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  25
* SOCK00.cbl
  1348         16  FILLER                         PIC X.
  1349
  1350         16  CF-ALT-MORT-CODE               PIC X(4).
  1351         16  CF-MEMBER-CAPTION              PIC X(10).
  1352
  1353         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1354             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1355             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1356             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1357             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1358             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1359
  1360         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1361
  1362         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1363         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1364         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1365         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1366
  1367         16  CF-AH-OVERRIDE-L1              PIC X.
  1368         16  CF-AH-OVERRIDE-L2              PIC XX.
  1369         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1370         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1371
  1372         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1373         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1374
  1375         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1376         16  CF-AR-LAST-EL860-DT            PIC XX.
  1377         16  CF-MP-MONTH-END-DT             PIC XX.
  1378
  1379         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1380         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1381             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1382
  1383         16  CF-AR-MONTH-END-DT             PIC XX.
  1384
  1385         16  CF-CRDTCRD-USER                PIC X.
  1386             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1387             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1388
  1389         16  CF-CC-MONTH-END-DT             PIC XX.
  1390
  1391         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1392
  1393         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1394             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1395             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1396             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1397         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1398         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1399         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1400         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1401             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1402             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1403         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1404         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1405         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  26
* SOCK00.cbl
  1406             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1407         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1408
  1409         16  CF-CL-ZIP-CODE.
  1410             20  CF-CL-ZIP-PRIME.
  1411                 24  CF-CL-ZIP-1ST          PIC X.
  1412                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1413                 24  FILLER                 PIC X(4).
  1414             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1415         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1416             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1417             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1418             20  FILLER                     PIC XXX.
  1419
  1420         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1421         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1422         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1423         16  CF-CO-OPTION-START-DATE        PIC XX.
  1424         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1425           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1426                                                      '3' '4'.
  1427           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1428           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1429           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1430           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1431           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1432           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1433
  1434         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1435
  1436         16  CF-PAYMENT-APPROVAL-LEVELS.
  1437             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1438             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1439             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1440             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1441             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1442             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1443
  1444         16  CF-END-USER-REPORTING-USER     PIC X.
  1445             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1446             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1447
  1448         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1449             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1450             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1451
  1452         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1453
  1454         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1455         16  FILLER                         PIC X.
  1456
  1457         16  CF-CREDIT-ARCHIVE-CNTL.
  1458             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1459             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1460             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1461
  1462         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1463
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  27
* SOCK00.cbl
  1464         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1465             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1466             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1467
  1468         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1469             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1470             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1471
  1472         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1473
  1474         16  CF-CO-ACH-ID-CODE              PIC  X.
  1475             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1476             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1477             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1478         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1479         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1480         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1481         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1482         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1483         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1484         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1485         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1486         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1487                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1488         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1489                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1490
  1491         16  CF-CO-OVER-SHORT.
  1492             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1493             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1494
  1495*         16  FILLER                         PIC X(102).
  1496         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1497             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1498             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1499
  1500         16  CF-AH-APPROVAL-DAYS.
  1501             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1502             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1503             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1504             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1505
  1506         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1507
  1508         16  CF-APPROV-LEV-5.
  1509             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1510             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1511             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1512
  1513         16  FILLER                         PIC X(68).
  1514****************************************************************
  1515*             PROCESSOR/USER RECORD                            *
  1516****************************************************************
  1517
  1518     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1519         16  CF-PROCESSOR-NAME              PIC X(30).
  1520         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1521         16  CF-PROCESSOR-TITLE             PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  28
* SOCK00.cbl
  1522         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1523                 88  MESSAGE-YES                VALUE 'Y'.
  1524                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1525
  1526*****************************************************
  1527****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1528****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1529****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1530****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1531*****************************************************
  1532
  1533         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1534             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1535             20  CF-APPLICATION-FORCE       PIC X.
  1536             20  CF-INDIVIDUAL-APP.
  1537                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1538                     28  CF-BROWSE-APP      PIC X.
  1539                     28  CF-UPDATE-APP      PIC X.
  1540
  1541         16  CF-CURRENT-TERM-ON             PIC X(4).
  1542         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1543             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1544             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1545             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1546             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1547             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1548             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1549             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1550         16  CF-PROCESSOR-CARRIER           PIC X.
  1551             88  NO-CARRIER-SECURITY            VALUE ' '.
  1552         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1553             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1554         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1555             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1556         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1557             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1558
  1559         16  CF-PROC-SYS-ACCESS-SW.
  1560             20  CF-PROC-CREDIT-CLAIMS-SW.
  1561                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1562                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1563                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1564                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1565             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1566                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1567                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1568             20  CF-PROC-LIFE-GNRLDGR-SW.
  1569                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1570                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1571                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1572                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1573             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1574                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1575                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1576         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1577             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1578             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1579         16  CF-PROCESSOR-PRINTER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  29
* SOCK00.cbl
  1580
  1581         16  CF-APPROVAL-LEVEL                  PIC X.
  1582             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1583             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1584             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1585             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1586             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1587
  1588         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1589
  1590         16  CF-LANGUAGE-TYPE                   PIC X.
  1591             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1592             88  CF-LANG-IS-FR                      VALUE 'F'.
  1593
  1594         16  CF-CSR-IND                         PIC X.
  1595         16  FILLER                             PIC X(239).
  1596
  1597****************************************************************
  1598*             PROCESSOR/REMINDERS RECORD                       *
  1599****************************************************************
  1600
  1601     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1602         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1603             20  CF-START-REMIND-DT         PIC XX.
  1604             20  CF-END-REMIND-DT           PIC XX.
  1605             20  CF-REMINDER-TEXT           PIC X(50).
  1606         16  FILLER                         PIC X(296).
  1607
  1608
  1609****************************************************************
  1610*             STATE MASTER RECORD                              *
  1611****************************************************************
  1612
  1613     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1614         16  CF-STATE-ABBREVIATION          PIC XX.
  1615         16  CF-STATE-NAME                  PIC X(25).
  1616         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1617         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1618             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1619             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1620             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1621             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1622                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1623                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1624             20  CF-ST-PREM-REJECT-SW       PIC X.
  1625                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1626                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1627             20  CF-ST-REF-REJECT-SW        PIC X.
  1628                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1629                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1630         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1631         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1632         16  CF-ST-REFUND-RULES.
  1633             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1634             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1635             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1636         16  CF-ST-FST-PMT-EXTENSION.
  1637             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  30
* SOCK00.cbl
  1638             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1639                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1640                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1641                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1642                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1643         16  CF-ST-STATE-CALL.
  1644             20  CF-ST-CALL-UNEARNED        PIC X.
  1645             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1646             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1647         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1648             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1649             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1650         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1651         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1652         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1653         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1654         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1655         16  FILLER                         PIC X.
  1656         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1657             20  CF-ST-BENEFIT-CD           PIC XX.
  1658             20  CF-ST-BENEFIT-KIND         PIC X.
  1659                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1660                 88  CF-ST-AH-KIND              VALUE 'A'.
  1661             20  CF-ST-REM-TERM-CALC        PIC X.
  1662                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1663                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1664                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1665                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1666                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1667                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1668                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1669                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1670
  1671             20  CF-ST-REFUND-CALC          PIC X.
  1672                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1673                 88  ST-REFD-BY-R78             VALUE '1'.
  1674                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1675                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1676                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1677                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1678                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1679                 88  ST-REFD-UTAH               VALUE '7'.
  1680                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1681                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1682                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1683
  1684             20  CF-ST-EARNING-CALC         PIC X.
  1685                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1686                 88  ST-EARN-BY-R78             VALUE '1'.
  1687                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1688                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1689                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1690                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1691                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1692                 88  ST-EARN-MEAN               VALUE '8'.
  1693                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1694
  1695             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  31
* SOCK00.cbl
  1696                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1697                 88  ST-OVRD-BY-R78             VALUE '1'.
  1698                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1699                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1700                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1701                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1702                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1703                 88  ST-OVRD-MEAN               VALUE '8'.
  1704                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1705             20  FILLER                     PIC X.
  1706
  1707         16  CF-ST-COMMISSION-CAPS.
  1708             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1709             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1710             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1711             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1712         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1713                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1714
  1715         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1716
  1717         16  CF-ST-STATUTORY-INTEREST.
  1718             20  CF-ST-STAT-DATE-FROM       PIC X.
  1719                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1720                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1721             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1722             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1723             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1724             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1725             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1726
  1727         16  CF-ST-OVER-SHORT.
  1728             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1729             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1730
  1731         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1732
  1733         16  CF-ST-RT-CALC                  PIC X.
  1734
  1735         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1736         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1737         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1738         16  CF-ST-RF-LR-CALC               PIC X.
  1739         16  CF-ST-RF-LL-CALC               PIC X.
  1740         16  CF-ST-RF-LN-CALC               PIC X.
  1741         16  CF-ST-RF-AH-CALC               PIC X.
  1742         16  CF-ST-RF-CP-CALC               PIC X.
  1743*        16  FILLER                         PIC X(206).
  1744*CIDMOD         16  FILLER                         PIC X(192).
  1745         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1746             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1747         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1748         16  CF-ST-VFY-2ND-BENE             PIC X.
  1749         16  CF-ST-CAUSAL-STATE             PIC X.
  1750         16  FILLER                         PIC X(185).
  1751
  1752****************************************************************
  1753*             BENEFIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  32
* SOCK00.cbl
  1754****************************************************************
  1755
  1756     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1757         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1758             20  CF-BENEFIT-CODE            PIC XX.
  1759             20  CF-BENEFIT-NUMERIC  REDEFINES
  1760                 CF-BENEFIT-CODE            PIC XX.
  1761             20  CF-BENEFIT-ALPHA           PIC XXX.
  1762             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1763             20  CF-BENEFIT-COMMENT         PIC X(10).
  1764
  1765             20  CF-LF-COVERAGE-TYPE        PIC X.
  1766                 88  CF-REDUCING                VALUE 'R'.
  1767                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1768
  1769             20  CF-SPECIAL-CALC-CD         PIC X.
  1770                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1771                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1772                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1773                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1774                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1775                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1776                 88  CF-FARM-PLAN               VALUE 'F'.
  1777                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1778                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1779                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1780                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1781                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1782                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1783                 88  CF-PRUDENTIAL              VALUE 'P'.
  1784                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1785                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1786                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1787                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1788                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1789                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1790
  1791             20  CF-JOINT-INDICATOR         PIC X.
  1792                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1793
  1794*            20  FILLER                     PIC X(12).
  1795             20  cf-maximum-benefits        pic s999 comp-3.
  1796             20  FILLER                     PIC X(09).
  1797             20  CF-BENEFIT-CATEGORY        PIC X.
  1798             20  CF-LOAN-TYPE               PIC X(8).
  1799
  1800             20  CF-CO-REM-TERM-CALC        PIC X.
  1801                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1802                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1803                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1804                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1805                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1806
  1807             20  CF-CO-EARNINGS-CALC        PIC X.
  1808                 88  CO-EARN-BY-R78             VALUE '1'.
  1809                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1810                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1811                 88  CO-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  33
* SOCK00.cbl
  1812                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1813                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1814                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1815                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1816
  1817             20  CF-CO-REFUND-CALC          PIC X.
  1818                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1819                 88  CO-REFD-BY-R78             VALUE '1'.
  1820                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1821                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1822                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1823                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1824                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1825                 88  CO-REFD-MEAN               VALUE '8'.
  1826                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1827                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1828                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1829
  1830             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1831                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1832                 88  CO-OVRD-BY-R78             VALUE '1'.
  1833                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1834                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1835                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1836                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1837                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1838                 88  CO-OVRD-MEAN               VALUE '8'.
  1839                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1840
  1841             20  CF-CO-BEN-I-G-CD           PIC X.
  1842                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1843                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1844                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1845
  1846         16  FILLER                         PIC X(304).
  1847
  1848
  1849****************************************************************
  1850*             CARRIER MASTER RECORD                            *
  1851****************************************************************
  1852
  1853     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1854         16  CF-ADDRESS-DATA.
  1855             20  CF-MAIL-TO-NAME            PIC X(30).
  1856             20  CF-IN-CARE-OF              PIC X(30).
  1857             20  CF-ADDRESS-LINE-1          PIC X(30).
  1858             20  CF-ADDRESS-LINE-2          PIC X(30).
  1859             20  CF-CITY-STATE              PIC X(30).
  1860             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1861             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1862
  1863         16  CF-CLAIM-NO-CONTROL.
  1864             20  CF-CLAIM-NO-METHOD         PIC X.
  1865                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1866                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1867                 88  CLAIM-NO-SEQ               VALUE '3'.
  1868                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1869             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  34
* SOCK00.cbl
  1870                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1871                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1872                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1873
  1874         16  CF-CHECK-NO-CONTROL.
  1875             20  CF-CHECK-NO-METHOD         PIC X.
  1876                 88  CHECK-NO-MANUAL            VALUE '1'.
  1877                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1878                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1879                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1880             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1881                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1882
  1883         16  CF-DOMICILE-STATE              PIC XX.
  1884
  1885         16  CF-EXPENSE-CONTROLS.
  1886             20  CF-EXPENSE-METHOD          PIC X.
  1887                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1888                 88  DOLLARS-PER-PMT            VALUE '2'.
  1889                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1890                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1891             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1892             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1893
  1894         16  CF-CORRESPONDENCE-CONTROL.
  1895             20  CF-LETTER-RESEND-OPT       PIC X.
  1896                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1897                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1898             20  FILLER                     PIC X(4).
  1899
  1900         16  CF-RESERVE-CONTROLS.
  1901             20  CF-MANUAL-SW               PIC X.
  1902                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1903             20  CF-FUTURE-SW               PIC X.
  1904                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1905             20  CF-PTC-SW                  PIC X.
  1906                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1907             20  CF-IBNR-SW                 PIC X.
  1908                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1909             20  CF-PTC-LF-SW               PIC X.
  1910                 88  CF-LF-PTC-USED             VALUE '1'.
  1911             20  CF-CDT-ACCESS-METHOD       PIC X.
  1912                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1913                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1914                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1915             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1916
  1917         16  CF-CLAIM-CALC-METHOD           PIC X.
  1918             88  360-PLUS-MONTHS                VALUE '1'.
  1919             88  365-PLUS-MONTHS                VALUE '2'.
  1920             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1921             88  360-DAILY                      VALUE '4'.
  1922             88  365-DAILY                      VALUE '5'.
  1923
  1924         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1925         16  FILLER                         PIC X(11).
  1926
  1927         16  CF-LIMIT-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  35
* SOCK00.cbl
  1928             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1929             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1930             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1931             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1932             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1933             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1934             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1935             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1936             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1937             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1938
  1939         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1940         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1941         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1942
  1943         16  CF-ZIP-CODE.
  1944             20  CF-ZIP-PRIME.
  1945                 24  CF-ZIP-1ST             PIC X.
  1946                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1947                 24  FILLER                 PIC X(4).
  1948             20  CF-ZIP-PLUS4               PIC X(4).
  1949         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1950             20  CF-CAN-POSTAL-1            PIC XXX.
  1951             20  CF-CAN-POSTAL-2            PIC XXX.
  1952             20  FILLER                     PIC XXX.
  1953
  1954         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1955         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1956         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1957
  1958         16  CF-RATING-SWITCH               PIC X.
  1959             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1960             88  CF-NO-RATING                   VALUE 'N'.
  1961
  1962         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1963
  1964         16  CF-CARRIER-OVER-SHORT.
  1965             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1966             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1967
  1968         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1969         16  CF-SECPAY-SWITCH               PIC X.
  1970             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1971             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1972         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1973         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1974         16  FILLER                         PIC X(444).
  1975*        16  FILLER                         PIC X(452).
  1976
  1977
  1978****************************************************************
  1979*             MORTALITY MASTER RECORD                          *
  1980****************************************************************
  1981
  1982     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1983         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1984                                INDEXED BY CF-MORT-NDX.
  1985             20  CF-MORT-TABLE              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  36
* SOCK00.cbl
  1986             20  CF-MORT-TABLE-TYPE         PIC X.
  1987                 88  CF-MORT-JOINT              VALUE 'J'.
  1988                 88  CF-MORT-SINGLE             VALUE 'S'.
  1989                 88  CF-MORT-COMBINED           VALUE 'C'.
  1990                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1991                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1992             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1993             20  CF-MORT-AGE-METHOD         PIC XX.
  1994                 88  CF-AGE-LAST                VALUE 'AL'.
  1995                 88  CF-AGE-NEAR                VALUE 'AN'.
  1996             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1997             20  CF-MORT-ADJUSTMENT-DIRECTION
  1998                                            PIC X.
  1999                 88  CF-MINUS                   VALUE '-'.
  2000                 88  CF-PLUS                    VALUE '+'.
  2001             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2002             20  CF-MORT-JOINT-CODE         PIC X.
  2003                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2004             20  CF-MORT-PC-Q               PIC X.
  2005                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2006             20  CF-MORT-TABLE-CODE         PIC X(4).
  2007             20  CF-MORT-COMMENTS           PIC X(15).
  2008             20  FILLER                     PIC X(14).
  2009
  2010         16  FILLER                         PIC X(251).
  2011
  2012
  2013****************************************************************
  2014*             BUSSINESS TYPE MASTER RECORD                     *
  2015****************************************************************
  2016
  2017     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2018* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2019* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2020* AND RECORD 05 IS TYPES 81-99
  2021         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2022             20  CF-BUSINESS-TITLE          PIC  X(19).
  2023             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2024                                            PIC S9V9(4) COMP-3.
  2025             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2026             20  FILLER                     PIC  X.
  2027         16  FILLER                         PIC  X(248).
  2028
  2029
  2030****************************************************************
  2031*             TERMINAL MASTER RECORD                           *
  2032****************************************************************
  2033
  2034     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2035
  2036         16  CF-COMPANY-TERMINALS.
  2037             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2038                                  PIC X(4).
  2039         16  FILLER               PIC X(248).
  2040
  2041
  2042****************************************************************
  2043*             LIFE EDIT MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  37
* SOCK00.cbl
  2044****************************************************************
  2045
  2046     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2047         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2048             20  CF-LIFE-CODE-IN            PIC XX.
  2049             20  CF-LIFE-CODE-OUT           PIC XX.
  2050         16  FILLER                         PIC X(248).
  2051
  2052
  2053****************************************************************
  2054*             AH EDIT MASTER RECORD                            *
  2055****************************************************************
  2056
  2057     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2058         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2059             20  CF-AH-CODE-IN              PIC XXX.
  2060             20  CF-AH-CODE-OUT             PIC XX.
  2061         16  FILLER                         PIC X(248).
  2062
  2063
  2064****************************************************************
  2065*             CREDIBILITY TABLES                               *
  2066****************************************************************
  2067
  2068     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2069         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2070                             INDEXED BY CF-CRDB-NDX.
  2071             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2072             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2073             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2074         16  FILLER                         PIC  X(332).
  2075
  2076
  2077****************************************************************
  2078*             REPORT CUSTOMIZATION RECORD                      *
  2079****************************************************************
  2080
  2081     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2082         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2083             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2084             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2085             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2086**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2087****       A T-TRANSFER.                                   ****
  2088             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2089
  2090         16  FILLER                         PIC XX.
  2091
  2092         16  CF-CARRIER-CNTL-OPT.
  2093             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2094                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2095                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2096             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2097                                            PIC X.
  2098         16  CF-GROUP-CNTL-OPT.
  2099             20  CF-GROUP-OPT-SEQ           PIC 9.
  2100                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2101                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  38
* SOCK00.cbl
  2102             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2103                                            PIC X(6).
  2104         16  CF-STATE-CNTL-OPT.
  2105             20  CF-STATE-OPT-SEQ           PIC 9.
  2106                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2107                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2108             20  CF-STATE-SELECT OCCURS 3 TIMES
  2109                                            PIC XX.
  2110         16  CF-ACCOUNT-CNTL-OPT.
  2111             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2112                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2113                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2114             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2115                                            PIC X(10).
  2116         16  CF-BUS-TYP-CNTL-OPT.
  2117             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2118                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2119                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2120             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2121                                            PIC XX.
  2122         16  CF-LF-TYP-CNTL-OPT.
  2123             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2124                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2125                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2126             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2127                                            PIC XX.
  2128         16  CF-AH-TYP-CNTL-OPT.
  2129             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2130                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2131                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2132             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2133                                            PIC XX.
  2134         16  CF-REPTCD1-CNTL-OPT.
  2135             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2136                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2137                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2138             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2139                                            PIC X(10).
  2140         16  CF-REPTCD2-CNTL-OPT.
  2141             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2142                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2143                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2144             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2145                                            PIC X(10).
  2146         16  CF-USER1-CNTL-OPT.
  2147             20  CF-USER1-OPT-SEQ           PIC 9.
  2148                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2149                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2150             20  CF-USER1-SELECT OCCURS 3 TIMES
  2151                                            PIC X(10).
  2152         16  CF-USER2-CNTL-OPT.
  2153             20  CF-USER2-OPT-SEQ           PIC 9.
  2154                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2155                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2156             20  CF-USER2-SELECT OCCURS 3 TIMES
  2157                                            PIC X(10).
  2158         16  CF-USER3-CNTL-OPT.
  2159             20  CF-USER3-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  39
* SOCK00.cbl
  2160                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2161                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2162             20  CF-USER3-SELECT OCCURS 3 TIMES
  2163                                            PIC X(10).
  2164         16  CF-USER4-CNTL-OPT.
  2165             20  CF-USER4-OPT-SEQ           PIC 9.
  2166                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2167                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2168             20  CF-USER4-SELECT OCCURS 3 TIMES
  2169                                            PIC X(10).
  2170         16  CF-USER5-CNTL-OPT.
  2171             20  CF-USER5-OPT-SEQ           PIC 9.
  2172                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2173                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2174             20  CF-USER5-SELECT OCCURS 3 TIMES
  2175                                            PIC X(10).
  2176         16  CF-REINS-CNTL-OPT.
  2177             20  CF-REINS-OPT-SEQ           PIC 9.
  2178                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2179                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2180             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2181                 24  CF-REINS-PRIME         PIC XXX.
  2182                 24  CF-REINS-SUB           PIC XXX.
  2183
  2184         16  CF-AGENT-CNTL-OPT.
  2185             20  CF-AGENT-OPT-SEQ           PIC 9.
  2186                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2187                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2188             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2189                                            PIC X(10).
  2190
  2191         16  FILLER                         PIC X(43).
  2192
  2193         16  CF-LOSS-RATIO-SELECT.
  2194             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2195             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2196         16  CF-ENTRY-DATE-SELECT.
  2197             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2198             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2199         16  CF-EFFECTIVE-DATE-SELECT.
  2200             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2201             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2202
  2203         16  CF-EXCEPTION-LIST-IND          PIC X.
  2204             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2205
  2206         16  FILLER                         PIC X(318).
  2207
  2208****************************************************************
  2209*                  EXCEPTION REPORTING RECORD                  *
  2210****************************************************************
  2211
  2212     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2213         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2214             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2215
  2216         16  CF-COMBINED-LIFE-AH-OPT.
  2217             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  40
* SOCK00.cbl
  2218             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2219             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2220             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2221
  2222         16  CF-LIFE-OPT.
  2223             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2224             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2225             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2226             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2227             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2228             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2229             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2230             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2231             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2232             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2233
  2234         16  CF-AH-OPT.
  2235             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2236             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2237             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2238             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2239             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2240             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2241             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2242             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2243             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2244             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2245
  2246         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2247             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2248             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2249             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2250
  2251         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2252
  2253         16  FILLER                         PIC X(673).
  2254
  2255
  2256****************************************************************
  2257*             MORTGAGE SYSTEM PLAN RECORD                      *
  2258****************************************************************
  2259
  2260     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2261         16  CF-PLAN-TYPE                   PIC X.
  2262             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2263             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2264             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2265         16  CF-PLAN-ABBREV                 PIC XXX.
  2266         16  CF-PLAN-DESCRIPT               PIC X(10).
  2267         16  CF-PLAN-NOTES                  PIC X(20).
  2268         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2269         16  CF-PLAN-UNDERWRITING.
  2270             20  CF-PLAN-TERM-DATA.
  2271                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2272                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2273             20  CF-PLAN-AGE-DATA.
  2274                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2275                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  41
* SOCK00.cbl
  2276                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2277             20  CF-PLAN-BENEFIT-DATA.
  2278                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2279                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2280                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2281                                            PIC S9(7)V99  COMP-3.
  2282         16  CF-PLAN-POLICY-FORMS.
  2283             20  CF-POLICY-FORM             PIC X(12).
  2284             20  CF-MASTER-APPLICATION      PIC X(12).
  2285             20  CF-MASTER-POLICY           PIC X(12).
  2286         16  CF-PLAN-RATING.
  2287             20  CF-RATE-CODE               PIC X(5).
  2288             20  CF-SEX-RATING              PIC X.
  2289                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2290                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2291             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2292             20  CF-SUB-STD-TYPE            PIC X.
  2293                 88  CF-PCT-OF-PREM            VALUE '1'.
  2294                 88  CF-PCT-OF-BENE            VALUE '2'.
  2295         16  CF-PLAN-PREM-TOLERANCES.
  2296             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2297             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2298         16  CF-PLAN-PYMT-TOLERANCES.
  2299             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2300             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2301         16  CF-PLAN-MISC-DATA.
  2302             20  FILLER                     PIC X.
  2303             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2304             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2305         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2306         16  CF-PLAN-IND-GRP                PIC X.
  2307             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2308                                                     '1'.
  2309             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2310                                                     '2'.
  2311         16  CF-MIB-SEARCH-SW               PIC X.
  2312             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2313             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2314             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2315             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2316         16  CF-ALPHA-SEARCH-SW             PIC X.
  2317             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2318             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2319             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2320             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2321             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2322             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2323             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2324             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2325             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2326             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2327                                                     'A' 'B' 'C'
  2328                                                     'X' 'Y' 'Z'.
  2329         16  CF-EFF-DT-RULE-SW              PIC X.
  2330             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2331             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2332             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2333             88  CF-EFF-DT-SEMI                VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  42
* SOCK00.cbl
  2334             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2335         16  FILLER                         PIC X(4).
  2336         16  CF-HEALTH-QUESTIONS            PIC X.
  2337             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2338         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2339         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2340         16  CF-PLAN-SNGL-JNT               PIC X.
  2341             88  CF-COMBINED-PLAN              VALUE 'C'.
  2342             88  CF-JNT-PLAN                   VALUE 'J'.
  2343             88  CF-SNGL-PLAN                  VALUE 'S'.
  2344         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2345         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2346         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2347         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2348         16  CF-RERATE-CNTL                 PIC  X.
  2349             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2350             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2351             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2352             88  CF-AUTO-RECALC                 VALUE '4'.
  2353         16  CF-BENEFIT-TYPE                PIC  X.
  2354             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2355             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2356         16  CF-POLICY-FEE                  PIC S999V99
  2357                                                    COMP-3.
  2358         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2359         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2360         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2361         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2362         16  FILLER                         PIC  X(32).
  2363         16  CF-TERMINATION-FORM            PIC  X(04).
  2364         16  FILLER                         PIC  X(08).
  2365         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2366                                                       COMP-3.
  2367         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2368         16  CF-ISSUE-LETTER                PIC  X(4).
  2369         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2370         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2371             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2372             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2373         16  CF-MP-REFUND-CALC              PIC X.
  2374             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2375             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2376             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2377             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2378             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2379             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2380             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2381             88  CF-MP-REFD-MEAN                VALUE '8'.
  2382         16  CF-ALT-RATE-CODE               PIC  X(5).
  2383
  2384
  2385         16  FILLER                         PIC X(498).
  2386****************************************************************
  2387*             MORTGAGE COMPANY MASTER RECORD                   *
  2388****************************************************************
  2389
  2390     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2391         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  43
* SOCK00.cbl
  2392         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2393             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2394             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2395             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2396             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2397             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2398
  2399         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2400         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2401         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2402         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2403         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2404
  2405         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2406             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2407         16  CF-MP-RECON-USE-IND            PIC X(1).
  2408             88  CF-MP-USE-RECON             VALUE 'Y'.
  2409         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2410             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2411         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2412             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2413             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2414         16  FILLER                         PIC X(1).
  2415         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2416             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2417         16  CF-MORTG-MIB-VERSION           PIC X.
  2418             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2419             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2420             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2421         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2422             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2423                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2424             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2425                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2426             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2427                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2428             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2429                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2430             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2431                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2432             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2433                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2434         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2435         16  FILLER                         PIC X(7).
  2436         16  CF-MORTG-DESTINATION-SYMBOL.
  2437             20  CF-MORTG-MIB-COMM          PIC X(5).
  2438             20  CF-MORTG-MIB-TERM          PIC X(5).
  2439         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2440             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2441         16  FILLER                         PIC X(03).
  2442         16  CF-MP-CHECK-NO-CONTROL.
  2443             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2444                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2445                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2446                                                ' ' LOW-VALUES.
  2447                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2448                                               VALUE '3'.
  2449         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  44
* SOCK00.cbl
  2450         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2451         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2452             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2453                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2454             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2455                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2456             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2457                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2458             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2459                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2460             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2461                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2462             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2463                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2464         16  CF-MORTG-BILLING-AREA.
  2465             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2466                                            PIC X.
  2467         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2468         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2469         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2470         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2471             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2472             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2473         16  FILLER                         PIC X.
  2474         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2475             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2476             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2477         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2478         16  FILLER                         PIC X(8).
  2479         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2480         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2481         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2482         16  CF-ACH-COMPANY-ID.
  2483             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2484                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2485                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2486                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2487             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2488         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2489             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2490         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2491             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2492             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2493         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2494         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2495         16  FILLER                         PIC X(536).
  2496
  2497****************************************************************
  2498*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2499****************************************************************
  2500
  2501     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2502         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2503             20  CF-FEMALE-HEIGHT.
  2504                 24  CF-FEMALE-FT           PIC 99.
  2505                 24  CF-FEMALE-IN           PIC 99.
  2506             20  CF-FEMALE-MIN-WT           PIC 999.
  2507             20  CF-FEMALE-MAX-WT           PIC 999.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  45
* SOCK00.cbl
  2508         16  FILLER                         PIC X(428).
  2509
  2510     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2511         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2512             20  CF-MALE-HEIGHT.
  2513                 24  CF-MALE-FT             PIC 99.
  2514                 24  CF-MALE-IN             PIC 99.
  2515             20  CF-MALE-MIN-WT             PIC 999.
  2516             20  CF-MALE-MAX-WT             PIC 999.
  2517         16  FILLER                         PIC X(428).
  2518******************************************************************
  2519*             AUTOMATIC ACTIVITY RECORD                          *
  2520******************************************************************
  2521     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2522         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2523             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2524             20  CF-SYS-LETTER-ID           PIC X(04).
  2525             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2526             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2527             20  CF-SYS-RESET-SW            PIC X(01).
  2528             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2529             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2530
  2531         16  FILLER                         PIC X(50).
  2532
  2533         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2534             20  CF-USER-ACTIVE-SW          PIC X(01).
  2535             20  CF-USER-LETTER-ID          PIC X(04).
  2536             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2537             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2538             20  CF-USER-RESET-SW           PIC X(01).
  2539             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2540             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2541             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2542
  2543         16  FILLER                         PIC X(246).
  2544*                                 COPY ERCCTBL.
  2545******************************************************************
  2546*                                                                *
  2547*                                                                *
  2548*                            ERCCTBL                             *
  2549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2550*                            VMOD=2.003
  2551*                                                                *
  2552*   ONLINE CREDIT SYSTEM                                         *
  2553*                                                                *
  2554*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2555*                                                                *
  2556*   FILE TYPE = VSAM,KSDS                                        *
  2557*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2558*                                                                *
  2559*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2560*       ALTERNATE PATH = NONE                                    *
  2561*                                                                *
  2562*   LOG = NO                                                     *
  2563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2564*                                                                *
  2565*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  46
* SOCK00.cbl
  2566******************************************************************
  2567
  2568 01  COMM-TABLE-RECORD.
  2569     12  CT-RECORD-ID                      PIC XX.
  2570         88  VALID-CT-ID                      VALUE 'CT'.
  2571
  2572     12  CT-CONTROL-PRIMARY.
  2573         16  CT-COMPANY-CD                 PIC X.
  2574         16  CT-TABLE                      PIC XXX.
  2575         16  CT-CNTRL-2.
  2576             20  CT-BEN-TYPE               PIC X.
  2577             20  CT-BEN-CODE               PIC XX.
  2578
  2579     12  CT-MAINT-INFORMATION.
  2580         16  CT-LAST-MAINT-DT              PIC XX.
  2581         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2582         16  CT-LAST-MAINT-USER            PIC X(4).
  2583         16  FILLER                        PIC X(31).
  2584
  2585     12  CT-LIMITS.
  2586         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2587
  2588         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2589
  2590         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2591
  2592     12  CT-RATES.
  2593         16  CT-RTX          OCCURS 27 TIMES.
  2594             20  CT-RT                     PIC SV9(5)     COMP-3.
  2595             20  CT-RT-R   REDEFINES
  2596                 CT-RT                     PIC XXX.
  2597
  2598     12  FILLER                            PIC  X(42).
  2599
  2600******************************************************************
  2601*                                 COPY ELCDATE.
  2602******************************************************************
  2603*                                                                *
  2604*                                                                *
  2605*                            ELCDATE.                            *
  2606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2607*                            VMOD=2.003
  2608*                                                                *
  2609*                                                                *
  2610*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2611*                 LENGTH = 200                                   *
  2612******************************************************************
  2613
  2614 01  DATE-CONVERSION-DATA.
  2615     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2616     12  DC-OPTION-CODE                PIC X.
  2617         88  BIN-TO-GREG                VALUE ' '.
  2618         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2619         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2620         88  YMD-GREG-TO-BIN            VALUE '3'.
  2621         88  MDY-GREG-TO-BIN            VALUE '4'.
  2622         88  JULIAN-TO-BIN              VALUE '5'.
  2623         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  47
* SOCK00.cbl
  2624         88  FIND-CENTURY               VALUE '7'.
  2625         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2626         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2627         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2628         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2629         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2630         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2631         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2632         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2633         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2634         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2635         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2636         88  BIN-3-TO-GREG              VALUE 'I'.
  2637         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2638         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2639         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2640         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2641         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2642         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2643         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2644         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2645         88  THREE-CHARACTER-BIN
  2646                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2647         88  GREGORIAN-TO-BIN
  2648                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2649         88  BIN-TO-GREGORIAN
  2650                  VALUES ' ' '1' 'I' '8' 'G'.
  2651         88  JULIAN-TO-BINARY
  2652                  VALUES '5' 'C' 'E' 'F'.
  2653     12  DC-ERROR-CODE                 PIC X.
  2654         88  NO-CONVERSION-ERROR        VALUE ' '.
  2655         88  DATE-CONVERSION-ERROR
  2656                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2657         88  DATE-IS-ZERO               VALUE '1'.
  2658         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2659         88  DATE-IS-INVALID            VALUE '3'.
  2660         88  DATE1-GREATER-DATE2        VALUE '4'.
  2661         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2662         88  DATE-INVALID-OPTION        VALUE '9'.
  2663         88  INVALID-CENTURY            VALUE 'A'.
  2664         88  ONLY-CENTURY               VALUE 'B'.
  2665         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2666         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2667     12  DC-END-OF-MONTH               PIC X.
  2668         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2669     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2670         88  USE-NORMAL-PROCESS         VALUE ' '.
  2671         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2672         88  ADJUST-UP-100-YRS          VALUE '2'.
  2673     12  FILLER                        PIC X.
  2674     12  DC-CONVERSION-DATES.
  2675         16  DC-BIN-DATE-1             PIC XX.
  2676         16  DC-BIN-DATE-2             PIC XX.
  2677         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2678         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2679                       DC-GREG-DATE-1-EDIT.
  2680             20  DC-EDIT1-MONTH        PIC 99.
  2681             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  48
* SOCK00.cbl
  2682             20  DC-EDIT1-DAY          PIC 99.
  2683             20  SLASH1-2              PIC X.
  2684             20  DC-EDIT1-YEAR         PIC 99.
  2685         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2686         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2687                     DC-GREG-DATE-2-EDIT.
  2688             20  DC-EDIT2-MONTH        PIC 99.
  2689             20  SLASH2-1              PIC X.
  2690             20  DC-EDIT2-DAY          PIC 99.
  2691             20  SLASH2-2              PIC X.
  2692             20  DC-EDIT2-YEAR         PIC 99.
  2693         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2694         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2695                     DC-GREG-DATE-1-YMD.
  2696             20  DC-YMD-YEAR           PIC 99.
  2697             20  DC-YMD-MONTH          PIC 99.
  2698             20  DC-YMD-DAY            PIC 99.
  2699         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2700         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2701                      DC-GREG-DATE-1-MDY.
  2702             20  DC-MDY-MONTH          PIC 99.
  2703             20  DC-MDY-DAY            PIC 99.
  2704             20  DC-MDY-YEAR           PIC 99.
  2705         16  DC-GREG-DATE-1-ALPHA.
  2706             20  DC-ALPHA-MONTH        PIC X(10).
  2707             20  DC-ALPHA-DAY          PIC 99.
  2708             20  FILLER                PIC XX.
  2709             20  DC-ALPHA-CENTURY.
  2710                 24 DC-ALPHA-CEN-N     PIC 99.
  2711             20  DC-ALPHA-YEAR         PIC 99.
  2712         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2713         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2714         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2715         16  DC-JULIAN-DATE            PIC 9(05).
  2716         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2717                                       PIC 9(05).
  2718         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2719             20  DC-JULIAN-YEAR        PIC 99.
  2720             20  DC-JULIAN-DAYS        PIC 999.
  2721         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2722         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2723         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2724     12  DATE-CONVERSION-VARIBLES.
  2725         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2726         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2727             20  FILLER                PIC 9(3).
  2728             20  HOLD-CEN-1-CCYY.
  2729                 24  HOLD-CEN-1-CC     PIC 99.
  2730                 24  HOLD-CEN-1-YY     PIC 99.
  2731             20  HOLD-CEN-1-MO         PIC 99.
  2732             20  HOLD-CEN-1-DA         PIC 99.
  2733         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2734             20  HOLD-CEN-1-R-MO       PIC 99.
  2735             20  HOLD-CEN-1-R-DA       PIC 99.
  2736             20  HOLD-CEN-1-R-CCYY.
  2737                 24  HOLD-CEN-1-R-CC   PIC 99.
  2738                 24  HOLD-CEN-1-R-YY   PIC 99.
  2739             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  49
* SOCK00.cbl
  2740         16  HOLD-CENTURY-1-X.
  2741             20  FILLER                PIC X(3)  VALUE SPACES.
  2742             20  HOLD-CEN-1-X-CCYY.
  2743                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2744                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2745             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2746             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2747         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2748             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2749             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2750             20  HOLD-CEN-1-R-X-CCYY.
  2751                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2752                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2753             20  FILLER                PIC XXX.
  2754         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2755         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2756         16  DC-JULIAN-DATE-1          PIC 9(07).
  2757         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2758             20  DC-JULIAN-1-CCYY.
  2759                 24  DC-JULIAN-1-CC    PIC 99.
  2760                 24  DC-JULIAN-1-YR    PIC 99.
  2761             20  DC-JULIAN-DA-1        PIC 999.
  2762         16  DC-JULIAN-DATE-2          PIC 9(07).
  2763         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2764             20  DC-JULIAN-2-CCYY.
  2765                 24  DC-JULIAN-2-CC    PIC 99.
  2766                 24  DC-JULIAN-2-YR    PIC 99.
  2767             20  DC-JULIAN-DA-2        PIC 999.
  2768         16  DC-GREG-DATE-A-EDIT.
  2769             20  DC-EDITA-MONTH        PIC 99.
  2770             20  SLASHA-1              PIC X VALUE '/'.
  2771             20  DC-EDITA-DAY          PIC 99.
  2772             20  SLASHA-2              PIC X VALUE '/'.
  2773             20  DC-EDITA-CCYY.
  2774                 24  DC-EDITA-CENT     PIC 99.
  2775                 24  DC-EDITA-YEAR     PIC 99.
  2776         16  DC-GREG-DATE-B-EDIT.
  2777             20  DC-EDITB-MONTH        PIC 99.
  2778             20  SLASHB-1              PIC X VALUE '/'.
  2779             20  DC-EDITB-DAY          PIC 99.
  2780             20  SLASHB-2              PIC X VALUE '/'.
  2781             20  DC-EDITB-CCYY.
  2782                 24  DC-EDITB-CENT     PIC 99.
  2783                 24  DC-EDITB-YEAR     PIC 99.
  2784         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2785         16  DC-GREG-DATE-CYMD-R REDEFINES
  2786                              DC-GREG-DATE-CYMD.
  2787             20  DC-CYMD-CEN           PIC 99.
  2788             20  DC-CYMD-YEAR          PIC 99.
  2789             20  DC-CYMD-MONTH         PIC 99.
  2790             20  DC-CYMD-DAY           PIC 99.
  2791         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2792         16  DC-GREG-DATE-MDCY-R REDEFINES
  2793                              DC-GREG-DATE-MDCY.
  2794             20  DC-MDCY-MONTH         PIC 99.
  2795             20  DC-MDCY-DAY           PIC 99.
  2796             20  DC-MDCY-CEN           PIC 99.
  2797             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  50
* SOCK00.cbl
  2798    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2799        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2800    12  DC-EL310-DATE                  PIC X(21).
  2801    12  FILLER                         PIC X(28).
  2802*                                 COPY ELCCALC.
  2803******************************************************************
  2804*                                                                *
  2805*                           ELCCALC.                            *
  2806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2807*                            VMOD=2.025                          *
  2808*                                                                *
  2809*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2810*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2811*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2812*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2813*                                                                *
  2814*  PASSED TO ELRTRM                                              *
  2815*  -----------------                                             *
  2816*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2817*  ORIGINAL TERM                                                 *
  2818*  BEGINNING DATE                                                *
  2819*  ENDING DATE                                                   *
  2820*  COMPANY I.D.                                                  *
  2821*  ACCOUNT MASTER USER FIELD                                     *
  2822*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2823*  FREE LOOK DAYS                                                *
  2824*                                                                *
  2825*  RETURNED FROM ELRTRM                                          *
  2826*  ---------------------                                         *
  2827*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2828*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2829*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2830*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2831*----------------------------------------------------------------*
  2832*  PASSED TO ELRAMT                                              *
  2833*  ----------------                                              *
  2834*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2835*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2836*  ORIGINAL AMOUNT                                               *
  2837*  ALTERNATE BENEFIT (BALLON)                                    *
  2838*  A.P.R. - NET PAY ONLY                                         *
  2839*  METHOD
  2840*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2841*  COMPANY I.D.                                                  *
  2842*  BENEFIT TYPE                                                  *
  2843*                                                                *
  2844*  RETURNED FROM ELRAMT                                          *
  2845*  --------------------                                          *
  2846*  REMAINING AMOUNT 1 - CURRENT                                  *
  2847*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2848*  REMAINING AMOUNT FACTOR
  2849*----------------------------------------------------------------*
  2850*  PASSED TO ELRESV                                              *
  2851*  -----------------                                             *
  2852*  CERTIFICATE EFFECTIVE DATE                                    *
  2853*  VALUATION DATE                                                *
  2854*  PAID THRU DATE                                                *
  2855*  BENEFIT                                                       *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  51
* SOCK00.cbl
  2856*  INCURRED DATE                                                 *
  2857*  REPORTED DATE                                                 *
  2858*  ISSUE AGE                                                     *
  2859*  TERM                                                          *
  2860*  CDT PERCENT                                                   *
  2861*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2862* *CLAIM TYPE (LIFE, A/H)                                        *
  2863* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2864* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2865*                                                                *
  2866*  RETURNED FROM ELRESV                                          *
  2867*  --------------------                                          *
  2868*  CDT TABLE USED                                                *
  2869*  CDT FACTOR USED                                               *
  2870*  PAY TO CURRENT RESERVE                                        *
  2871*  I.B.N.R. - A/H ONLY                                           *
  2872*  FUTURE (ACCRUED) AH ONLY                                      *
  2873*----------------------------------------------------------------*
  2874*  PASSED TO ELRATE                                              *
  2875*  ----------------                                              *
  2876*  CERT ISSUE DATE                                               *
  2877*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2878*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2879*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2880*  STATE CODE (CLIENT DEFINED)                                   *
  2881*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2882*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2883*  DEVIATION CODE                                                *
  2884*  ISSUE AGE                                                     *
  2885*  ORIGINAL BENEFIT AMOUNT                                       *
  2886*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2887*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2888*  BENEFIT KIND (LIFE OR A/H)                                    *
  2889*  A.P.R.                                                        *
  2890*  METHOD
  2891*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2892*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2893*  COMPANY I.D. (3 CHARACTER)                                    *
  2894*  BENEFIT CODE                                                  *
  2895*  BENEFIT OVERRIDE CODE                                         *
  2896*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2897*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2898*  JOINT INDICATOR (CSL ONLY)                                    *
  2899*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2900*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2901*                                                                *
  2902*  RETURNED FROM ELRATE                                          *
  2903*  --------------------                                          *
  2904*  CALCULATED PREMIUM                                            *
  2905*  PREMIUM RATE                                                  *
  2906*  MORTALITY CODE                                                *
  2907*  MAX ATTAINED AGE                                              *
  2908*  MAX AGE                                                       *
  2909*  MAX TERM                                                      *
  2910*  MAX MONTHLY BENEFIT                                           *
  2911*  MAX TOTAL BENIFIT                                             *
  2912*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2913*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  52
* SOCK00.cbl
  2914*  PASSED TO ELRFND                                              *
  2915*  ----------------                                              *
  2916*  CERT ISSUE DATE                                               *
  2917*  REFUND DATE                                                   *
  2918*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2919*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2920*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2921*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2922*  STATE CODE (CLIENT DEFINED)                                   *
  2923*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2924*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2925*  DEVIATION CODE                                                *
  2926*  ISSUE AGE                                                     *
  2927*  ORIGINAL BENEFIT AMOUNT                                       *
  2928*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2929*  PROCESS TYPE (CANCEL)                                         *
  2930*  BENEFIT KIND (LIFE OR A/H)                                    *
  2931*  A.P.R.                                                        *
  2932*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2933*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2934*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2935*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2936*  COMPANY I.D. (3 CHARACTER)                                    *
  2937*  BENEFIT CODE                                                  *
  2938*  BENEFIT OVERRIDE CODE                                         *
  2939*                                                                *
  2940*  RETURNED FROM ELRFND                                          *
  2941*  --------------------                                          *
  2942*  CALCULATED REFUND                                             *
  2943*----------------------------------------------------------------*
  2944*  PASSED TO ELEARN                                              *
  2945*  ----------------                                              *
  2946*  CERT ISSUE DATE                                               *
  2947*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2948*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2949*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2950*  STATE CODE (CLIENT DEFINED)                                   *
  2951*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2952*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2953*  DEVIATION CODE                                                *
  2954*  ISSUE AGE                                                     *
  2955*  ORIGINAL BENEFIT AMOUNT                                       *
  2956*  BENEFIT KIND (LIFE OR A/H)                                    *
  2957*  A.P.R.                                                        *
  2958*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2959*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2960*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2961*  COMPANY I.D. (3 CHARACTER)                                    *
  2962*  BENEFIT CODE                                                  *
  2963*  BENEFIT OVERRIDE CODE                                         *
  2964*                                                                *
  2965*  RETURNED FROM ELEARN                                          *
  2966*  --------------------                                          *
  2967*  INDICATED  EARNINGS                                           *
  2968*----------------------------------------------------------------*
  2969*                 LENGTH = 450                                   *
  2970*                                                                *
  2971******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  53
* SOCK00.cbl
  2972******************************************************************
  2973*                   C H A N G E   L O G
  2974*
  2975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2976*-----------------------------------------------------------------
  2977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2978* EFFECTIVE    NUMBER
  2979*-----------------------------------------------------------------
  2980* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2981* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2982* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2983* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2984* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2985* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2986* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2987* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2988* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2989******************************************************************
  2990
  2991 01  CALCULATION-PASS-AREA.
  2992     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2993                                     COMP.
  2994
  2995     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2996       88  NO-CP-ERROR                             VALUE ZERO.
  2997       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2998                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2999       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3000       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3001       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3002       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3003       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3004       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3005       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3006       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3007       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3008       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3009       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3010       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3011       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3012       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3013       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3014       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3015       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3016
  3017     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3018       88  NO-CP-ERROR-2                           VALUE ZERO.
  3019***********************  INPUT AREAS ****************************
  3020
  3021     12  CP-CALCULATION-AREA.
  3022         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3023         16  CP-CERT-EFF-DT        PIC XX.
  3024         16  CP-VALUATION-DT       PIC XX.
  3025         16  CP-PAID-THRU-DT       PIC XX.
  3026         16  CP-BENEFIT-TYPE       PIC X.
  3027           88  CP-AH                               VALUE 'A' 'D'
  3028                                                   'I' 'U'.
  3029           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  54
* SOCK00.cbl
  3030           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3031         16  CP-INCURRED-DT        PIC XX.
  3032         16  CP-REPORTED-DT        PIC XX.
  3033         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3034         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3035         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3036                                     COMP-3.
  3037         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3038                                     COMP-3.
  3039         16  CP-CDT-METHOD         PIC X.
  3040           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3041           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3042           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3043         16  CP-CLAIM-TYPE         PIC X.
  3044           88  CP-AH-CLAIM                         VALUE 'A'.
  3045           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3046         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3047                                     COMP-3.
  3048         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3049                                     COMP-3.
  3050         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3051                                     COMP-3.
  3052         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3053                                     COMP-3.
  3054         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3055                                     COMP-3.
  3056         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3057                                     COMP-3.
  3058         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3059                                     COMP-3.
  3060         16  CP-REM-TERM-METHOD    PIC X.
  3061           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3062           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3063           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3064           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3065           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3066           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3067           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3068         16  CP-EARNING-METHOD     PIC X.
  3069           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3070           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3071           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3072           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3073           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3074           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3075           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3076           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3077           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3078           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3079           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3080           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3081           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3082           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3083         16  CP-PROCESS-TYPE       PIC X.
  3084           88  CP-CLAIM                            VALUE '1'.
  3085           88  CP-CANCEL                           VALUE '2'.
  3086           88  CP-ISSUE                            VALUE '3'.
  3087         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  55
* SOCK00.cbl
  3088           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3089           88  CP-1-MTH-INTEREST               VALUE ' '.
  3090           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3091           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3092           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3093           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3094           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3095           88  CP-FARM-PLAN                    VALUE 'F'.
  3096           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3097           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3098           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3099           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3100           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3101           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3102           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3103           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3104           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3105           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3106                                                     'W' 'X'.
  3107           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3108           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3109           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3110           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3111           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3112           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3113           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3114           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3115           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3116           88  CP-CSL-METH-1                   VALUE '5'.
  3117           88  CP-CSL-METH-2                   VALUE '6'.
  3118           88  CP-CSL-METH-3                   VALUE '7'.
  3119           88  CP-CSL-METH-4                   VALUE '8'.
  3120
  3121         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3122                                     COMP-3.
  3123         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3124         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3125         16  CP-STATE              PIC XX          VALUE SPACE.
  3126         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3127         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3128           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3129               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3130         16  CP-R78-OPTION         PIC X.
  3131           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3132           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3133
  3134         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3135         16  CP-IBNR-RESERVE-SW    PIC X.
  3136         16  CP-CLAIM-STATUS       PIC X.
  3137         16  CP-RATE-FILE          PIC X.
  3138         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3139                                     COMP-3.
  3140
  3141         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3142         16  CP-AH-OVERRIDE-CODE   PIC X.
  3143
  3144         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3145                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  56
* SOCK00.cbl
  3146         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3147                                   PIC S9(5)V99 COMP-3.
  3148         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3149                                     COMP-3.
  3150         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3151                                     COMP-3.
  3152         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3153                                     COMP-3.
  3154         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3155                                  PIC S9(7)V99 COMP-3.
  3156
  3157         16  CP-PAID-FROM-DATE     PIC X(02).
  3158         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3159         16  CP-EXT-DAYS-CALC      PIC X.
  3160           88  CP-EXT-NO-CHG                   VALUE ' '.
  3161           88  CP-EXT-CHG-LF                   VALUE '1'.
  3162           88  CP-EXT-CHG-AH                   VALUE '2'.
  3163           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3164         16  CP-DOMICILE-STATE     PIC XX.
  3165         16  CP-CARRIER            PIC X.
  3166         16  CP-REIN-FLAG          PIC X.
  3167         16  CP-REM-TRM-CALC-OPTION PIC X.
  3168           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3169                      '2' '3' '4' '5'.
  3170           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3171           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3172           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3173           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3174           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3175           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3176           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3177           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3178         16  CP-SIG-SWITCH         PIC X.
  3179         16  CP-RATING-METHOD      PIC X.
  3180           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3181           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3182           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3183           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3184           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3185           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3186           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3187           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3188           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3189         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3190                                     COMP-3.
  3191         16  CP-BEN-CATEGORY       PIC X.
  3192         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3193         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3194                                   PIC S99V9(5) COMP-3.
  3195         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3196         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3197                                   PIC S99V9(5) COMP-3.
  3198         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3199         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3200         16  CP-EXPIRE-DT          PIC XX.
  3201         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3202         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3203         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  57
* SOCK00.cbl
  3204         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3205         16  CP-DDF-SPEC-CALC      PIC X.
  3206             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3207             88  CP-CALC-CLP              VALUE 'C'.
  3208         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3209         16  CP-CANCEL-REASON      PIC X.
  3210         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3211         16  CP-PMT-MODE           PIC X.
  3212         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3213         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3214         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3215         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3216         16  FILLER                PIC X.
  3217
  3218***************    OUTPUT FROM ELRESV   ************************
  3219
  3220         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3221
  3222         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3223                                     COMP-3.
  3224         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3225                                     COMP-3.
  3226         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3227                                     COMP-3.
  3228         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3229                                     COMP-3.
  3230         16  FILLER                PIC X(09).
  3231***************    OUTPUT FROM ELRTRM   *************************
  3232
  3233         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3234                                     COMP-3.
  3235         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3236                                     COMP-3.
  3237         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3238                                     COMP-3.
  3239         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3240                                     COMP-3.
  3241         16  FILLER                PIC X(12).
  3242
  3243***************    OUTPUT FROM ELRAMT   *************************
  3244
  3245         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3246                                     COMP-3.
  3247         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3248                                     COMP-3.
  3249         16  FILLER                PIC X(12).
  3250
  3251***************    OUTPUT FROM ELRATE   *************************
  3252
  3253         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3254                                     COMP-3.
  3255         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3256                                     COMP-3.
  3257         16  CP-MORTALITY-CODE     PIC X(4).
  3258         16  CP-RATE-EDIT-FLAG     PIC X.
  3259             88  CP-RATES-NEED-APR                  VALUE '1'.
  3260         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3261                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  58
* SOCK00.cbl
  3262         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3263         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3264         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3265                                   PIC S9(7)V99 COMP-3.
  3266         16  FILLER                PIC X(07).
  3267
  3268***************    OUTPUT FROM ELRFND   *************************
  3269
  3270         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3271                                     COMP-3.
  3272         16  CP-REFUND-TYPE-USED   PIC X.
  3273           88  CP-R-AS-R78                         VALUE '1'.
  3274           88  CP-R-AS-PRORATA                     VALUE '2'.
  3275           88  CP-R-AS-CALIF                       VALUE '3'.
  3276           88  CP-R-AS-TEXAS                       VALUE '4'.
  3277           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3278           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3279           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3280           88  CP-R-AS-MEAN                        VALUE '8'.
  3281           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3282           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3283           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3284           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3285           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3286           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3287         16  FILLER                PIC X(12).
  3288
  3289***************    OUTPUT FROM ELEARN   *************************
  3290
  3291         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3292                                     COMP-3.
  3293         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3294                                     COMP-3.
  3295         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3296                                     COMP-3.
  3297         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3298                                     COMP-3.
  3299         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3300                                     COMP-3.
  3301         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3302                                     COMP-3.
  3303         16  CP-EARNING-TYPE-USED  PIC X.
  3304           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3305           88  CP-E-AS-R78                         VALUE '1'.
  3306           88  CP-E-AS-PRORATA                     VALUE '2'.
  3307           88  CP-E-AS-TEXAS                       VALUE '4'.
  3308           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3309           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3310           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3311           88  CP-E-AS-MEAN                        VALUE '8'.
  3312           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3313         16  FILLER                PIC X(12).
  3314
  3315***************    OUTPUT FROM ELPMNT   *************************
  3316
  3317         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3318                                     COMP-3.
  3319         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  59
* SOCK00.cbl
  3320                                     COMP-3.
  3321         16  FILLER                PIC X(12).
  3322
  3323***************   MISC WORK AREAS    *****************************
  3324         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3325                                     COMP-3.
  3326         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3327                                     COMP-3.
  3328         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3329                                     COMP-3.
  3330         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3335                                     COMP-3.
  3336         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3337             88  OPEN-RATE-FILE                   VALUE 'O'.
  3338             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3339             88  IO-ERROR                         VALUE 'E'.
  3340
  3341         16  CP-FIRST-PAY-DATE     PIC XX.
  3342
  3343         16  CP-JOINT-INDICATOR    PIC X.
  3344
  3345         16  CP-RESERVE-REMAINING-TERM
  3346                                   PIC S9(4)V9    VALUE ZERO
  3347                                     COMP-3.
  3348
  3349         16  CP-INSURED-BIRTH-DT   PIC XX.
  3350
  3351         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3352                                     COMP-3.
  3353
  3354         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3355                                     COMP-3.
  3356
  3357         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3358                                     COMP-3.
  3359
  3360         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3361                                     COMP-3.
  3362
  3363         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3364                                     COMP-3.
  3365
  3366         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3367                                     COMP-3.
  3368
  3369         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3370                                     COMP-3.
  3371
  3372         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3373             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3374
  3375         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3376                                     COMP-3.
  3377         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  60
* SOCK00.cbl
  3378                                     COMP-3.
  3379         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3380         16  FILLER                PIC X(15).
  3381******************************************************************
  3382****************************************************************
  3383*
  3384* Copyright (c) 2007 by Clerity Solutions, Inc.
  3385* All rights reserved.
  3386*
  3387****************************************************************
  3388 01  DFHEIV.
  3389   02  DFHEIV0               PIC X(35).
  3390   02  DFHEIV1               PIC X(08).
  3391   02  DFHEIV2               PIC X(08).
  3392   02  DFHEIV3               PIC X(08).
  3393   02  DFHEIV4               PIC X(06).
  3394   02  DFHEIV5               PIC X(04).
  3395   02  DFHEIV6               PIC X(04).
  3396   02  DFHEIV7               PIC X(02).
  3397   02  DFHEIV8               PIC X(02).
  3398   02  DFHEIV9               PIC X(01).
  3399   02  DFHEIV10              PIC S9(7) COMP-3.
  3400   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3401   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3402   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3403   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3404   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3405   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3406   02  DFHEIV17              PIC X(04).
  3407   02  DFHEIV18              PIC X(04).
  3408   02  DFHEIV19              PIC X(04).
  3409   02  DFHEIV20              USAGE IS POINTER.
  3410   02  DFHEIV21              USAGE IS POINTER.
  3411   02  DFHEIV22              USAGE IS POINTER.
  3412   02  DFHEIV23              USAGE IS POINTER.
  3413   02  DFHEIV24              USAGE IS POINTER.
  3414   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3415   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3416   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3417   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3418   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3419   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3420   02  FILLER                PIC X(02).
  3421   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3422   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3423   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3424   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3425   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3426 LINKAGE  SECTION.
  3427*****************************************************************
  3428*                                                               *
  3429* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3430* All rights reserved.                                          *
  3431*                                                               *
  3432*****************************************************************
  3433 01  dfheiblk.
  3434     02  eibtime          pic s9(7) comp-3.
  3435     02  eibdate          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  61
* SOCK00.cbl
  3436     02  eibtrnid         pic x(4).
  3437     02  eibtaskn         pic s9(7) comp-3.
  3438     02  eibtrmid         pic x(4).
  3439     02  dfheigdi         pic s9(4) comp.
  3440     02  eibcposn         pic s9(4) comp.
  3441     02  eibcalen         pic s9(4) comp.
  3442     02  eibaid           pic x(1).
  3443     02  eibfiller1       pic x(1).
  3444     02  eibfn            pic x(2).
  3445     02  eibfiller2       pic x(2).
  3446     02  eibrcode         pic x(6).
  3447     02  eibfiller3       pic x(2).
  3448     02  eibds            pic x(8).
  3449     02  eibreqid         pic x(8).
  3450     02  eibrsrce         pic x(8).
  3451     02  eibsync          pic x(1).
  3452     02  eibfree          pic x(1).
  3453     02  eibrecv          pic x(1).
  3454     02  eibsend          pic x(1).
  3455     02  eibatt           pic x(1).
  3456     02  eibeoc           pic x(1).
  3457     02  eibfmh           pic x(1).
  3458     02  eibcompl         pic x(1).
  3459     02  eibsig           pic x(1).
  3460     02  eibconf          pic x(1).
  3461     02  eiberr           pic x(1).
  3462     02  eibrldbk         pic x(1).
  3463     02  eiberrcd         pic x(4).
  3464     02  eibsynrb         pic x(1).
  3465     02  eibnodat         pic x(1).
  3466     02  eibfiller5       pic x(2).
  3467     02  eibresp          pic 9(09) comp.
  3468     02  eibresp2         pic 9(09) comp.
  3469     02  dfheigdj         pic s9(4) comp.
  3470     02  dfheigdk         pic s9(4) comp.
  3471 01  DFHCOMMAREA.
  3472   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3473   05 LSTN-NAME                PIC X(8).
  3474   05 LSTN-SUBNAME             PIC X(8).
  3475   05 CLIENT-IN-DATA.
  3476      15  CLIENT-CAR           PIC X.
  3477      15  CLIENT-GRP           PIC X(6).
  3478      15  CLIENT-ST            PIC XX.
  3479      15  CLIENT-ACT           PIC X(10).
  3480      15  CLIENT-ID            PIC XXX.
  3481      15  FILLER               PIC X(14).
  3482   05 SOCKADDR-IN-PARM.
  3483     15 SIN-FAMILY             PIC 9(4) COMP.
  3484     15 SIN-PORT               PIC 9(4) COMP.
  3485     15 SIN-ADDRESS            PIC 9(8) COMP.
  3486     15 SIN-ZERO               PIC X(8).
  3487 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3488 0000-DFHEXIT SECTION.
  3489     MOVE '9#                    $   ' TO DFHEIV0.
  3490     MOVE 'SOCK00' TO DFHEIV1.
  3491     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3492*
  3493* when calling a C function the function returns its value
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  62
* SOCK00.cbl
  3494* in the system variable return code.
  3495*
  3496 start-here.
  3497*
  3498* data with transaction
  3499*
  3500     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3501     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3502     IF CLIENT-IN-DATA (1:4) = "RATE"
  3503        SET GET-RATES            TO TRUE
  3504     ELSE
  3505        IF CLIENT-IN-DATA (1:5) = "STATE"
  3506           SET GET-ACT-ACCTS     TO TRUE
  3507        END-IF
  3508     END-IF
  3509     IF CLIENT-ID = 'AHL'
  3510        MOVE X'06'               TO WS-COMP-CD
  3511        MOVE 'AHL'               TO WS-SEND-BUF (5:3)
  3512                                    WS-COMP-ID
  3513     ELSE
  3514        IF CLIENT-ID = 'DCC'
  3515           MOVE X'05'            TO WS-COMP-CD
  3516           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3517                                    WS-COMP-ID
  3518        ELSE
  3519           MOVE X'04'            TO WS-COMP-CD
  3520           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3521                                    WS-COMP-ID
  3522        END-IF
  3523     END-IF
  3524     move 'CSO'                  to ws-send-buf (1:3)
  3525     move +25                    to ws-send-msg-size
  3526* send data
  3527*
  3528     display 'SOCK00:sequence number  =', ws-seq-num.
  3529     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3530     call "send" using by value GIVE-TAKE-SOCKET,
  3531         by reference ws-send-buf,
  3532         by value ws-send-msg-size,
  3533         by value ws-flags.
  3534     if return-code <= zero
  3535         display 'SOCK00:send error ',
  3536         go to socket-error.
  3537*
  3538* set up the receive buffer
  3539*
  3540     move low-values to ws-recv-buf.
  3541     set ws-recv-total to zero.
  3542     compute ws-recv-left = ws-recv-msg-size.
  3543*
  3544* receive data
  3545*
  3546     display 'SOCK00:About to recv '
  3547     call "recv" using by value GIVE-TAKE-SOCKET,
  3548         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3549         by value ws-recv-left,
  3550         by value ws-flags.
  3551*
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  63
* SOCK00.cbl
  3552* test what was received and decide what we should do
  3553*
  3554     if return-code < zero
  3555        display 'SOCK00:recv error ',
  3556        go to socket-error.
  3557     if return-code = zero
  3558        display 'SOCK00:client disconnected',
  3559        go to socket-error.
  3560*
  3561     display 'SOCK00:Good recv  '
  3562     display 'SOCK00:return code      = ', return-code
  3563     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3564     move +4096                  to ws-send-msg-size
  3565*    move +750                   to ws-send-msg-size
  3566     if get-rates
  3567        perform 0300-get-rates   thru 0300-exit
  3568     end-if
  3569     IF GET-ACT-ACCTS
  3570        PERFORM 0400-GET-ACT-ACCTS
  3571                                 THRU 0400-EXIT
  3572     END-IF
  3573     move ws-recv-buf (1:19)     to client-in-data
  3574     IF (CLIENT-CAR NOT = ZEROS)
  3575        AND (CLIENT-ST NOT = ZEROS)
  3576        PERFORM 0500-GET-ONE-ACCT
  3577                                 THRU 0500-EXIT
  3578     END-IF
  3579     MOVE ' '                    TO WS-BUILD-SW
  3580     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3581     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3582     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3583     IF NOT RESP-NORMAL
  3584        MOVE 'BAD STARTBR ON ERACCT  '
  3585                                 TO WS-SEND-BUF
  3586        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3587        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3588        GO TO SEND-BUFFER
  3589     END-IF
  3590     PERFORM 0020-READNEXT-ERACCT
  3591                                 THRU 0020-EXIT
  3592     IF (NOT RESP-NORMAL)
  3593        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3594        MOVE 'BAD READNEXT ON ERACCT '
  3595                                 TO WS-SEND-BUF
  3596        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3597        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3598        GO TO SEND-BUFFER
  3599     ELSE
  3600        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3601     END-IF
  3602     PERFORM UNTIL
  3603        (TIME-TO-BUILD)
  3604        IF AM-ACCOUNT = CLIENT-ACT
  3605         IF (AM-STATE = CLIENT-ST)
  3606                 OR
  3607            (CLIENT-ST = 00)
  3608           IF AM-EXPIRATION-DT = HIGH-VALUES
  3609              SET TIME-TO-BUILD  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  64
* SOCK00.cbl
  3610           ELSE
  3611              MOVE ACCOUNT-MASTER
  3612                                 TO WS-SAVE-ERACCT
  3613              PERFORM 0020-READNEXT-ERACCT
  3614                                 THRU 0020-EXIT
  3615              IF NOT RESP-NORMAL
  3616                 MOVE WS-SAVE-ERACCT
  3617                                 TO ACCOUNT-MASTER
  3618                 SET TIME-TO-BUILD
  3619                                 TO TRUE
  3620              END-IF
  3621           END-IF
  3622         ELSE
  3623          PERFORM 0020-READNEXT-ERACCT
  3624                            THRU 0020-EXIT
  3625         END-IF
  3626        ELSE
  3627           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3628           SET TIME-TO-BUILD     TO TRUE
  3629        END-IF
  3630     END-PERFORM
  3631     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3632     .
  3633*
  3634* send data
  3635*
  3636 SEND-BUFFER.
  3637     display 'SOCK00:About to send      '
  3638     display 'SOCK00:sequence number  =', ws-seq-num.
  3639     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3640     call "send" using by value GIVE-TAKE-SOCKET,
  3641         by reference ws-send-buf,
  3642         by value ws-send-msg-size,
  3643         by value ws-flags.
  3644     if return-code <= zero
  3645         display 'SOCK00:send error ',
  3646         go to socket-error.
  3647     GO TO SOCKET-FIN
  3648*
  3649* set up the receive buffer
  3650*
  3651     move low-values to ws-recv-buf.
  3652     set ws-recv-total to zero.
  3653     compute ws-recv-left = ws-recv-msg-size.
  3654*
  3655* receive data
  3656*
  3657 recv-1.
  3658     call "recv" using by value GIVE-TAKE-SOCKET,
  3659         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3660         by value ws-recv-left,
  3661         by value ws-flags.
  3662*
  3663* test what was received and decide what we should do
  3664*
  3665     if return-code < zero
  3666        display 'SOCK00:recv error ',
  3667        go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  65
* SOCK00.cbl
  3668     if return-code = zero
  3669        display 'SOCK00:client disconnected',
  3670        go to socket-error.
  3671*
  3672* have we received all the data yet?
  3673*
  3674     compute ws-recv-total = ws-recv-total + return-code.
  3675     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3676*
  3677* not yet
  3678*
  3679     if ws-recv-left > 0 go to recv-1.
  3680*
  3681* received all the data
  3682*
  3683     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3684*
  3685* make sure what we received was what we sent
  3686*
  3687*    if ws-recv-buf <> ws-send-buf
  3688*        display "SOCK00:data doesn't match",
  3689*        go to socket-error.
  3690*
  3691* end of pass
  3692*
  3693*loop-end.
  3694*    if ws-seq-num = 5 go to socket-error.
  3695*    go to loop-1.
  3696*
  3697* program end
  3698*
  3699 socket-error.
  3700     if ws-seq-num <> 0
  3701         display "SOCK00:did not complete".
  3702*
  3703* flush the send buffer and deallocate
  3704*
  3705*    display 'SOCK00:closing socket'.
  3706*    call "close" using by value GIVE-TAKE-SOCKET .
  3707*
  3708* finised return to cics
  3709*
  3710 socket-fin.
  3711*    display 'SOCK00:closing socket'.
  3712*    call "close" using by value GIVE-TAKE-SOCKET .
  3713     display 'SOCK00:done'.
  3714
  3715* exec cics return end-exec.
  3716*    MOVE '.(                    ''   #00003710' TO DFHEIV0
  3717     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3719     MOVE X'2020233030303033373130' TO DFHEIV0(25:11)
  3720     CALL 'kxdfhei1' USING DFHEIV0,
  3721           DFHEIV99,
  3722           DFHEIV99,
  3723           DFHEIV99,
  3724           DFHEIV99,
  3725           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  66
* SOCK00.cbl
  3726           DFHEIV99
  3727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3728
  3729
  3730* goback.
  3731     MOVE '9%                    "   ' TO DFHEIV0
  3732     MOVE 'SOCK00' TO DFHEIV1
  3733     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3734     goback.
  3735 0010-STARTBR-ERACCT.
  3736
  3737* EXEC CICS STARTBR
  3738*         DATASET    ('ERACCT3')
  3739*         RIDFLD     (WS-AM-ALT-KEY)
  3740*         GENERIC
  3741*         GTEQ
  3742*         KEYLENGTH  (10)
  3743*         RESP       (WS-RESPONSE)
  3744*    END-EXEC
  3745     MOVE 'ERACCT3' TO DFHEIV1
  3746     MOVE 10
  3747       TO DFHEIV11
  3748     MOVE 0
  3749       TO DFHEIV12
  3750*    MOVE '&,   KG    G          &  N#00003713' TO DFHEIV0
  3751     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3752     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3753     MOVE X'204E233030303033373133' TO DFHEIV0(25:11)
  3754     CALL 'kxdfhei1' USING DFHEIV0,
  3755           DFHEIV1,
  3756           WS-AM-ALT-KEY,
  3757           DFHEIV11,
  3758           DFHEIV12,
  3759           DFHEIV99
  3760     MOVE EIBRESP  TO WS-RESPONSE
  3761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3762     .
  3763 0010-EXIT.
  3764     EXIT.
  3765 0020-READNEXT-ERACCT.
  3766
  3767* EXEC CICS READNEXT
  3768*         INTO    (ACCOUNT-MASTER)
  3769*         DATASET ('ERACCT3')
  3770*         RIDFLD  (WS-AM-ALT-KEY)
  3771*         RESP    (WS-RESPONSE)
  3772*    END-EXEC
  3773     MOVE LENGTH OF
  3774      ACCOUNT-MASTER
  3775       TO DFHEIV12
  3776     MOVE 'ERACCT3' TO DFHEIV1
  3777     MOVE 0
  3778       TO DFHEIV11
  3779*    MOVE '&.IL                  )  N#00003725' TO DFHEIV0
  3780     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3781     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3782     MOVE X'204E233030303033373235' TO DFHEIV0(25:11)
  3783     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  67
* SOCK00.cbl
  3784           DFHEIV1,
  3785           ACCOUNT-MASTER,
  3786           DFHEIV12,
  3787           WS-AM-ALT-KEY,
  3788           DFHEIV99,
  3789           DFHEIV11,
  3790           DFHEIV99,
  3791           DFHEIV99
  3792     MOVE EIBRESP  TO WS-RESPONSE
  3793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3794     .
  3795 0020-EXIT.
  3796     EXIT.
  3797 0030-BUILD-BUFFER.
  3798     PERFORM 0100-BUILD-ERACCT-STUFF
  3799                                 THRU 0100-EXIT
  3800     MOVE SPACES                 TO WS-SEND-BUF
  3801     EVALUATE AM-STATUS
  3802        WHEN '1'
  3803           MOVE 'I'              TO WS-STATUS
  3804        WHEN '2'
  3805           MOVE 'T'              TO WS-STATUS
  3806        WHEN '3'
  3807           MOVE 'C'              TO WS-STATUS
  3808        WHEN '4'
  3809           MOVE 'I'              TO WS-STATUS
  3810        WHEN '5'
  3811           MOVE 'S'              TO WS-STATUS
  3812        WHEN OTHER
  3813           MOVE 'A'              TO WS-STATUS
  3814     END-EVALUATE
  3815     IF AM-REMIT-TO NOT NUMERIC
  3816        MOVE ZEROS         TO AM-REMIT-TO
  3817     END-IF
  3818     IF AM-REMIT-TO = ZEROS
  3819        MOVE 01        TO AM-REMIT-TO
  3820     END-IF
  3821     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3822     MOVE SPACES                 TO WS-AM-CITY-STATE
  3823     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3824        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3825     END-STRING
  3826     IF NOT GET-ACT-ACCTS
  3827* this is when a single account is selected
  3828       STRING
  3829        AM-ACCOUNT      ';'
  3830        WS-LONG-ACCT-NAME    ';'
  3831        WS-CONTR-NAME   ';'
  3832        AM-ADDRS        ';'
  3833        WS-AM-CITY-STATE ';'
  3834        AM-ZIP          ';'
  3835        AM-GPCD         ';'
  3836        WS-EFF-DATE     ';'
  3837        WS-EXP-DATE     ';'
  3838        WS-POLICY-NO    ';'
  3839        WS-SL-COMM      ';'
  3840        WS-JL-COMM      ';'
  3841        WS-SAH-COMM     ';'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  68
* SOCK00.cbl
  3842        WS-JAH-COMM     ';'
  3843        WS-CID-NO       ';'
  3844        AM-STATE        ';'
  3845        WS-GA-NUM       ';'
  3846        WS-GA-PRIMARY-CONTACT ';'
  3847        WS-GA-NAME      ';'
  3848        WS-GA-MAIL-NAME ';'
  3849        WS-GA-ADDR1     ';'
  3850        WS-GA-ADDR2     ';'
  3851        WS-GA-ADDR3     ';'
  3852        WS-GA-ZIP       ';'
  3853        WS-GA-PHONE     ';'
  3854        AM-CONTROL-NAME ';'
  3855        WS-ORIG-EFF-DT  ';'
  3856        AM-COMMENT-LINE (1) ';'
  3857        AM-COMMENT-LINE (2) ';'
  3858        AM-COMMENT-LINE (3) ';'
  3859        AM-COMMENT-LINE (4) ';'
  3860        AM-COMMENT-LINE (5) ';'
  3861        AM-TEL-NO       ';'
  3862        AM-REPORT-CODE-1    ';'
  3863        AM-REPORT-CODE-2    ';'
  3864        WS-STATUS           ';'
  3865        AM-REPORT-CODE-3    ';'
  3866        AM-USER-SELECT-2    ';'
  3867        AM-CARRIER          ';'
  3868        WS-FIN-RESP         ';'
  3869        AM-USER-SELECT-3    ';'
  3870        WS-SHORT-ACCT-NAME  ';'
  3871           DELIMITED BY SIZE INTO WS-SEND-BUF
  3872       END-STRING
  3873     ELSE
  3874       STRING
  3875        AM-ACCOUNT      ';'
  3876        WS-LONG-ACCT-NAME    ';'
  3877        WS-CONTR-NAME   ';'
  3878        AM-ADDRS        ';'
  3879        WS-AM-CITY-STATE ';'
  3880        AM-ZIP          ';'
  3881        AM-GPCD         ';'
  3882        WS-EFF-DATE     ';'
  3883        WS-EXP-DATE     ';'
  3884        WS-POLICY-NO    ';'
  3885        WS-SL-COMM      ';'
  3886        WS-JL-COMM      ';'
  3887        WS-SAH-COMM     ';'
  3888        WS-JAH-COMM     ';'
  3889        WS-CID-NO       ';'
  3890        AM-STATE        ';'
  3891        WS-GA-NUM       ';'
  3892        WS-GA-PRIMARY-CONTACT ';'
  3893        WS-GA-NAME      ';'
  3894        WS-GA-MAIL-NAME ';'
  3895        WS-GA-ADDR1     ';'
  3896        WS-GA-ADDR2     ';'
  3897        WS-GA-ADDR3     ';'
  3898        WS-GA-ZIP       ';'
  3899        WS-GA-PHONE     ';'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  69
* SOCK00.cbl
  3900        AM-COMMENT-LINE (1) ';'
  3901        AM-COMMENT-LINE (2) ';'
  3902        AM-COMMENT-LINE (3) ';'
  3903        AM-COMMENT-LINE (4) ';'
  3904        AM-COMMENT-LINE (5) ';'
  3905        AM-CONTROL-NAME     ';'
  3906        WS-ORIG-EFF-DT      ';'
  3907        AM-TEL-NO           ';'
  3908        AM-REPORT-CODE-1    ';'
  3909        AM-REPORT-CODE-2    ';'
  3910        WS-STATUS           ';'
  3911        AM-REPORT-CODE-3    ';'
  3912        AM-USER-SELECT-2    ';'
  3913        AM-CARRIER          ';'
  3914        WS-FIN-RESP         ';'
  3915        AM-USER-SELECT-3    ';'
  3916        WS-SHORT-ACCT-NAME  ';'
  3917           DELIMITED BY SIZE INTO WS-SEND-BUF
  3918       END-STRING
  3919     END-IF
  3920     .
  3921 0030-EXIT.
  3922     EXIT.
  3923 0100-BUILD-ERACCT-STUFF.
  3924     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3925     MOVE ' '                    TO DC-OPTION-CODE
  3926     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3927     IF NO-CONVERSION-ERROR
  3928        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3929     ELSE
  3930        MOVE '00/00/0000'        TO WS-EFF-DATE
  3931     END-IF
  3932     IF AM-EXPIRATION-DT = HIGH-VALUES
  3933        MOVE '99/99/9999'        TO WS-EXP-DATE
  3934     ELSE
  3935        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3936        MOVE ' '                 TO DC-OPTION-CODE
  3937        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3938        IF NO-CONVERSION-ERROR
  3939           MOVE DC-GREG-DATE-A-EDIT
  3940                                 TO WS-EXP-DATE
  3941        ELSE
  3942           MOVE '00/00/0000'     TO WS-EXP-DATE
  3943        END-IF
  3944     END-IF
  3945     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3946     MOVE ' '                    TO DC-OPTION-CODE
  3947     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3948     IF NO-CONVERSION-ERROR
  3949        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3950     ELSE
  3951        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3952     END-IF
  3953     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3954     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3955        (S1 > +48)
  3956        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3957     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  70
* SOCK00.cbl
  3958     IF S1 > +48
  3959        MOVE SPACES              TO WS-CID-NO
  3960     ELSE
  3961        MOVE AM-COMMENT-LINE (2) (S1:8)
  3962                                 TO WS-CID-NO
  3963     END-IF
  3964     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3965                                    WS-LONG-ACCT-NAME
  3966     MOVE AM-PERSON              TO WS-CONTR-NAME
  3967*    IF AM-REPORT-CODE-3 = 'RLIC'
  3968        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3969        MOVE '3'                 TO WS-NT-REC-TYPE
  3970        MOVE +1                  TO WS-NT-SEQ-NO
  3971
  3972* EXEC CICS READ
  3973*          DATASET    ('ERACNT')
  3974*          RIDFLD     (WS-NT-KEY)
  3975*          INTO       (NOTE-FILE)
  3976*          RESP       (WS-RESPONSE)
  3977*       END-EXEC
  3978     MOVE LENGTH OF
  3979      NOTE-FILE
  3980       TO DFHEIV11
  3981     MOVE 'ERACNT' TO DFHEIV1
  3982*    MOVE '&"IL       E          (  N#00003908' TO DFHEIV0
  3983     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3985     MOVE X'204E233030303033393038' TO DFHEIV0(25:11)
  3986     CALL 'kxdfhei1' USING DFHEIV0,
  3987           DFHEIV1,
  3988           NOTE-FILE,
  3989           DFHEIV11,
  3990           WS-NT-KEY,
  3991           DFHEIV99,
  3992           DFHEIV99,
  3993           DFHEIV99
  3994     MOVE EIBRESP  TO WS-RESPONSE
  3995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3996        IF RESP-NORMAL
  3997           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  3998              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  3999           END-IF
  4000        END-IF
  4001        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4002        MOVE '3'                 TO WS-NT-REC-TYPE
  4003        MOVE +2                  TO WS-NT-SEQ-NO
  4004
  4005* EXEC CICS READ
  4006*          DATASET    ('ERACNT')
  4007*          RIDFLD     (WS-NT-KEY)
  4008*          INTO       (NOTE-FILE)
  4009*          RESP       (WS-RESPONSE)
  4010*       END-EXEC
  4011     MOVE LENGTH OF
  4012      NOTE-FILE
  4013       TO DFHEIV11
  4014     MOVE 'ERACNT' TO DFHEIV1
  4015*    MOVE '&"IL       E          (  N#00003922' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  71
* SOCK00.cbl
  4016     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4018     MOVE X'204E233030303033393232' TO DFHEIV0(25:11)
  4019     CALL 'kxdfhei1' USING DFHEIV0,
  4020           DFHEIV1,
  4021           NOTE-FILE,
  4022           DFHEIV11,
  4023           WS-NT-KEY,
  4024           DFHEIV99,
  4025           DFHEIV99,
  4026           DFHEIV99
  4027     MOVE EIBRESP  TO WS-RESPONSE
  4028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4029        IF RESP-NORMAL
  4030           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4031              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4032           END-IF
  4033        END-IF
  4034*    END-IF
  4035     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4036        (S1 > +10)
  4037        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4038     END-PERFORM
  4039     IF S1 > +10
  4040        CONTINUE
  4041     ELSE
  4042        PERFORM 0150-BUILD-DW-COMM
  4043                                 THRU 0150-EXIT
  4044     END-IF
  4045     MOVE SPACES                 TO WS-GA-DATA
  4046     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4047        (S1 > +10)
  4048        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K' OR 'S')
  4049     END-PERFORM
  4050     IF S1 > +10
  4051        MOVE ZEROS               TO WS-GA-NUM
  4052     ELSE
  4053        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4054     END-IF
  4055     IF WS-GA-NUM NOT = ZEROS
  4056        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4057     END-IF
  4058     .
  4059 0100-EXIT.
  4060     EXIT.
  4061 0150-BUILD-DW-COMM.
  4062     MOVE ZEROS                  TO WS-SL-COMM
  4063                                    WS-JL-COMM
  4064                                    WS-SAH-COMM
  4065                                    WS-JAH-COMM
  4066                                    WS-WORK-SAH-COMM
  4067                                    WS-WORK-JAH-COMM
  4068     IF (AM-L-COM (S1) NOT NUMERIC)
  4069        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4070        CONTINUE
  4071     ELSE
  4072        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4073     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  72
* SOCK00.cbl
  4074     IF (AM-J-COM (S1) NOT NUMERIC)
  4075        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4076        CONTINUE
  4077     ELSE
  4078        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4079     END-IF
  4080     IF (AM-A-COM (S1) NOT NUMERIC)
  4081        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4082        PERFORM 0160-ERCTBL-STARTBR
  4083                                 THRU 0160-EXIT
  4084        IF RESP-NORMAL
  4085           PERFORM 0165-ERCTBL-READNEXT
  4086                                 THRU 0165-EXIT
  4087           UNTIL
  4088           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4089            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4090                       OR
  4091            END-OF-ERCTBL
  4092            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4093            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4094        END-IF
  4095     ELSE
  4096        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4097                                    WS-JAH-COMM
  4098     END-IF
  4099     .
  4100 0150-EXIT.
  4101     EXIT.
  4102 0160-ERCTBL-STARTBR.
  4103     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4104     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4105     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4106     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4107     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4108
  4109* EXEC CICS STARTBR
  4110*         DATASET    ('ERCTBL')
  4111*         RIDFLD     (WS-CT-KEY)
  4112*         GTEQ
  4113*         RESP       (WS-RESPONSE)
  4114*    END-EXEC
  4115     MOVE 'ERCTBL' TO DFHEIV1
  4116     MOVE 0
  4117       TO DFHEIV11
  4118*    MOVE '&,         G          &  N#00004007' TO DFHEIV0
  4119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4121     MOVE X'204E233030303034303037' TO DFHEIV0(25:11)
  4122     CALL 'kxdfhei1' USING DFHEIV0,
  4123           DFHEIV1,
  4124           WS-CT-KEY,
  4125           DFHEIV99,
  4126           DFHEIV11,
  4127           DFHEIV99
  4128     MOVE EIBRESP  TO WS-RESPONSE
  4129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4130     .
  4131 0160-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  73
* SOCK00.cbl
  4132     EXIT.
  4133 0165-ERCTBL-READNEXT.
  4134
  4135* EXEC CICS READNEXT
  4136*         INTO    (COMM-TABLE-RECORD)
  4137*         DATASET ('ERCTBL')
  4138*         RIDFLD  (WS-CT-KEY)
  4139*         RESP    (WS-RESPONSE)
  4140*    END-EXEC
  4141     MOVE LENGTH OF
  4142      COMM-TABLE-RECORD
  4143       TO DFHEIV12
  4144     MOVE 'ERCTBL' TO DFHEIV1
  4145     MOVE 0
  4146       TO DFHEIV11
  4147*    MOVE '&.IL                  )  N#00004017' TO DFHEIV0
  4148     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4149     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4150     MOVE X'204E233030303034303137' TO DFHEIV0(25:11)
  4151     CALL 'kxdfhei1' USING DFHEIV0,
  4152           DFHEIV1,
  4153           COMM-TABLE-RECORD,
  4154           DFHEIV12,
  4155           WS-CT-KEY,
  4156           DFHEIV99,
  4157           DFHEIV11,
  4158           DFHEIV99,
  4159           DFHEIV99
  4160     MOVE EIBRESP  TO WS-RESPONSE
  4161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4162     IF (RESP-NORMAL)
  4163        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4164        PERFORM 0170-PROCESS-BEN-CODE
  4165                                 THRU 0170-EXIT
  4166     ELSE
  4167        SET END-OF-ERCTBL        TO TRUE
  4168     END-IF
  4169     .
  4170 0165-EXIT.
  4171     EXIT.
  4172 0170-PROCESS-BEN-CODE.
  4173     MOVE SPACES                 TO WS-CF-KEY
  4174     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4175     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4176     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4177     MOVE +0                     TO WS-CF-SEQ-NO
  4178     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4179
  4180* EXEC CICS READ
  4181*         DATASET    ('ELCNTL')
  4182*         RIDFLD     (WS-CF-KEY)
  4183*         INTO       (CONTROL-FILE)
  4184*         GTEQ
  4185*         RESP       (WS-RESPONSE)
  4186*    END-EXEC
  4187     MOVE LENGTH OF
  4188      CONTROL-FILE
  4189       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  74
* SOCK00.cbl
  4190     MOVE 'ELCNTL' TO DFHEIV1
  4191*    MOVE '&"IL       G          (  N#00004040' TO DFHEIV0
  4192     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4194     MOVE X'204E233030303034303430' TO DFHEIV0(25:11)
  4195     CALL 'kxdfhei1' USING DFHEIV0,
  4196           DFHEIV1,
  4197           CONTROL-FILE,
  4198           DFHEIV11,
  4199           WS-CF-KEY,
  4200           DFHEIV99,
  4201           DFHEIV99,
  4202           DFHEIV99
  4203     MOVE EIBRESP  TO WS-RESPONSE
  4204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4205     IF NOT RESP-NORMAL
  4206        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4207        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4208        GO TO 0170-EXIT
  4209     END-IF
  4210     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4211        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4212           (S2 > +8)
  4213           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4214        END-PERFORM
  4215        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4216           IF CF-JOINT-INDICATOR (S2) = 'J'
  4217              IF WS-WORK-JAH-COMM = ZEROS
  4218                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4219              END-IF
  4220           ELSE
  4221              IF WS-WORK-SAH-COMM = ZEROS
  4222                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4223              END-IF
  4224           END-IF
  4225        END-IF
  4226     END-IF
  4227     .
  4228 0170-EXIT.
  4229     EXIT.
  4230 0200-GET-ERCOMP.
  4231     MOVE LOW-VALUES             TO WS-CO-KEY
  4232     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4233     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4234     MOVE AM-GROUPING            TO WS-CO-GROUP
  4235     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4236     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4237     MOVE 'G'                    TO WS-CO-TYPE
  4238
  4239* EXEC CICS READ
  4240*         INTO    (COMPENSATION-MASTER)
  4241*         DATASET ('ERCOMP')
  4242*         RIDFLD  (WS-CO-KEY)
  4243*         RESP    (WS-RESPONSE)
  4244*    END-EXEC
  4245     MOVE LENGTH OF
  4246      COMPENSATION-MASTER
  4247       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  75
* SOCK00.cbl
  4248     MOVE 'ERCOMP' TO DFHEIV1
  4249*    MOVE '&"IL       E          (  N#00004080' TO DFHEIV0
  4250     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4252     MOVE X'204E233030303034303830' TO DFHEIV0(25:11)
  4253     CALL 'kxdfhei1' USING DFHEIV0,
  4254           DFHEIV1,
  4255           COMPENSATION-MASTER,
  4256           DFHEIV11,
  4257           WS-CO-KEY,
  4258           DFHEIV99,
  4259           DFHEIV99,
  4260           DFHEIV99
  4261     MOVE EIBRESP  TO WS-RESPONSE
  4262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4263     IF RESP-NORMAL
  4264        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4265        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4266        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4267        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4268        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4269*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4270        MOVE SPACES              TO WS-GA-ADDR3
  4271        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4272           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4273        END-STRING
  4274        MOVE CO-ZIP              TO WS-GA-ZIP
  4275        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4276     ELSE
  4277        MOVE SPACES              TO WS-GA-DATA
  4278        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4279     END-IF
  4280     .
  4281 0200-EXIT.
  4282     EXIT.
  4283 0300-get-rates.
  4284     move +30                    to ws-send-msg-size
  4285     move ws-recv-buf (1:31)     to ws-get-rate-data
  4286     if rate-apr not numeric
  4287        move zeros               to rate-apr
  4288     end-if
  4289     move rate-apr               to ws-work-apr
  4290     if rate-ben-amt not numeric
  4291        move zeros               to rate-ben-amt
  4292     end-if
  4293     move rate-ben-amt           to ws-work-ben
  4294     if rate-term not numeric
  4295        move zeros               to rate-term
  4296     end-if
  4297     move rate-term              to ws-work-term
  4298     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4299     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4300     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4301     move ws-work-date-num       to dc-greg-date-cymd
  4302     move 'L'                    to dc-option-code
  4303     perform 9700-date-link      thru 9700-exit
  4304     if no-conversion-error
  4305        move dc-bin-date-1       to ws-bin-eff-dt
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  76
* SOCK00.cbl
  4306     else
  4307        move 'bad eff dt convert ' to ws-send-buf
  4308        go to send-rate-buf
  4309     end-if
  4310     move +1                     to dc-elapsed-months
  4311     move +0                     to dc-elapsed-days
  4312     move '6'                    to dc-option-code
  4313     perform 9700-date-link      thru 9700-exit
  4314     if no-conversion-error
  4315        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4316     else
  4317        move 'bad 1st dt convert ' to ws-send-buf
  4318        go to send-rate-buf
  4319     end-if
  4320*    move spaces                 to calculation-pass-area
  4321     move zeros                  to cp-r-max-mon-ben
  4322                                    cp-r-max-tot-ben
  4323                                    cp-class-code
  4324                                    cp-deviation-code
  4325                                    cp-rate-dev-pct
  4326                                    cp-original-premium
  4327                                    cp-critical-months
  4328                                    cp-term-or-ext-days
  4329     move rate-state             to cp-state
  4330                                    cp-state-std-abbrv
  4331     move rate-lf-ah             to cp-benefit-type
  4332     move rate-ben-code          to cp-benefit-cd
  4333     move ws-ben-num             to cp-original-benefit
  4334                                    cp-rating-benefit-amt
  4335     move 40                     to cp-issue-age
  4336     move WS-COMP-ID             to cp-company-id
  4337     move WS-COMP-CD             to cp-company-cd
  4338     move ws-apr-num             to cp-loan-apr
  4339     move ws-term-num            to cp-original-term
  4340                                    cp-loan-term
  4341                                    cp-remaining-term
  4342     move 'L'                    to cp-life-override-code
  4343     move 'A'                    to cp-ah-override-code
  4344     move '3'                    to cp-process-type
  4345     move rate-earn-meth         to cp-earning-method
  4346                                    cp-rating-method
  4347     move 'R'                    to cp-rate-file
  4348     move ws-bin-eff-dt          to cp-cert-eff-dt
  4349     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4350     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4351     if not no-cp-error
  4352        move cp-return-code      to ws-send-buf
  4353     else
  4354        move cp-calc-premium     to ws-disp-amt
  4355        move cp-premium-rate     to ws-disp-rate
  4356        string ws-disp-amt ';' ws-disp-rate delimited
  4357           by size into ws-send-buf
  4358        end-string
  4359     end-if
  4360     .
  4361 SEND-RATE-BUF.
  4362     display 'SOCK00:About to send      '
  4363     display 'SOCK00:sequence number  =', ws-seq-num.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  77
* SOCK00.cbl
  4364     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4365     call "send" using by value GIVE-TAKE-SOCKET,
  4366         by reference ws-send-buf,
  4367         by value ws-send-msg-size,
  4368         by value ws-flags.
  4369     if return-code <= zero
  4370         display 'SOCK00:send error ',
  4371         go to socket-error.
  4372     GO TO SOCKET-FIN
  4373     .
  4374 0300-exit.
  4375     exit.
  4376 0400-GET-ACT-ACCTS.
  4377     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4378     MOVE ' '                    TO WS-BUILD-SW
  4379     MOVE LOW-VALUES             TO WS-AM-KEY
  4380     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4381     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4382     IF NOT RESP-NORMAL
  4383        MOVE 'BAD STARTBR ON ERACCT  '
  4384                                 TO WS-SEND-BUF
  4385        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4386        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4387        GO TO SEND-BUFFER
  4388     END-IF
  4389     PERFORM 0420-READNEXT-ERACCT
  4390                                 THRU 0420-EXIT
  4391     IF NOT RESP-NORMAL
  4392        MOVE 'BAD READNEXT ON ERACCT '
  4393                                 TO WS-SEND-BUF
  4394        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4395        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4396        GO TO SEND-BUFFER
  4397     ELSE
  4398        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4399        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4400     END-IF
  4401     PERFORM UNTIL END-OF-ERACCT
  4402        IF NOT (RESP-NORMAL)
  4403           OR (AM-COMPANY-CD > WS-COMP-CD)
  4404           SET END-OF-ERACCT     TO TRUE
  4405        ELSE
  4406           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4407              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4408           END-IF
  4409           IF (AM-STATE = CLIENT-ST)
  4410              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4411*             AND (AM-STATUS = '0')
  4412              PERFORM 0030-BUILD-BUFFER
  4413                                 THRU 0030-EXIT
  4414              PERFORM 0430-SEND-BUFFER
  4415                                 THRU 0430-EXIT
  4416           END-IF
  4417           PERFORM 0420-READNEXT-ERACCT
  4418                                 THRU 0420-EXIT
  4419        END-IF
  4420     END-PERFORM
  4421     GO TO SOCKET-FIN
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  78
* SOCK00.cbl
  4422     .
  4423 0400-EXIT.
  4424     EXIT.
  4425 0410-STARTBR-ERACCT.
  4426
  4427* EXEC CICS STARTBR
  4428*         DATASET    ('ERACCT')
  4429*         RIDFLD     (WS-AM-KEY)
  4430*         GTEQ
  4431*         RESP       (WS-RESPONSE)
  4432*    END-EXEC
  4433     MOVE 'ERACCT' TO DFHEIV1
  4434     MOVE 0
  4435       TO DFHEIV11
  4436*    MOVE '&,         G          &  N#00004249' TO DFHEIV0
  4437     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4439     MOVE X'204E233030303034323439' TO DFHEIV0(25:11)
  4440     CALL 'kxdfhei1' USING DFHEIV0,
  4441           DFHEIV1,
  4442           WS-AM-KEY,
  4443           DFHEIV99,
  4444           DFHEIV11,
  4445           DFHEIV99
  4446     MOVE EIBRESP  TO WS-RESPONSE
  4447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4448     .
  4449 0410-EXIT.
  4450     EXIT.
  4451 0420-READNEXT-ERACCT.
  4452
  4453* EXEC CICS READNEXT
  4454*         INTO    (ACCOUNT-MASTER)
  4455*         DATASET ('ERACCT')
  4456*         RIDFLD  (WS-AM-KEY)
  4457*         RESP    (WS-RESPONSE)
  4458*    END-EXEC
  4459     MOVE LENGTH OF
  4460      ACCOUNT-MASTER
  4461       TO DFHEIV12
  4462     MOVE 'ERACCT' TO DFHEIV1
  4463     MOVE 0
  4464       TO DFHEIV11
  4465*    MOVE '&.IL                  )  N#00004259' TO DFHEIV0
  4466     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4467     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4468     MOVE X'204E233030303034323539' TO DFHEIV0(25:11)
  4469     CALL 'kxdfhei1' USING DFHEIV0,
  4470           DFHEIV1,
  4471           ACCOUNT-MASTER,
  4472           DFHEIV12,
  4473           WS-AM-KEY,
  4474           DFHEIV99,
  4475           DFHEIV11,
  4476           DFHEIV99,
  4477           DFHEIV99
  4478     MOVE EIBRESP  TO WS-RESPONSE
  4479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  79
* SOCK00.cbl
  4480     .
  4481 0420-EXIT.
  4482     EXIT.
  4483 0430-SEND-BUFFER.
  4484     display 'SOCK00:About to send      '
  4485     display 'SOCK00:sequence number  =', ws-seq-num.
  4486     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4487     call "send" using by value GIVE-TAKE-SOCKET,
  4488         by reference ws-send-buf,
  4489         by value ws-send-msg-size,
  4490         by value ws-flags.
  4491     if return-code <= zero
  4492         display 'SOCK00:send error ',
  4493         go to socket-error.
  4494     .
  4495 0430-EXIT.
  4496     EXIT.
  4497 0500-GET-ONE-ACCT.
  4498     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4499     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4500     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4501     MOVE CLIENT-ST              TO WS-AM-STATE
  4502     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4503     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4504     MOVE '5'                    TO DC-OPTION-CODE
  4505     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4506     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4507     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4508     MOVE ' '                    TO WS-BUILD-SW
  4509    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4510     IF NOT RESP-NORMAL
  4511        MOVE 'BAD STARTBR ON ERACCT  '
  4512                                 TO WS-SEND-BUF
  4513        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4514        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4515        GO TO SEND-BUFFER
  4516     END-IF
  4517     PERFORM 0420-READNEXT-ERACCT
  4518                                 THRU 0420-EXIT
  4519     IF NOT RESP-NORMAL
  4520        MOVE 'BAD READNEXT ON ERACCT '
  4521                                 TO WS-SEND-BUF
  4522        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4523        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4524        GO TO SEND-BUFFER
  4525     ELSE
  4526        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4527        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4528     END-IF
  4529     PERFORM UNTIL
  4530        (TIME-TO-BUILD)
  4531        IF AM-ACCOUNT = CLIENT-ACT
  4532           IF AM-EXPIRATION-DT = HIGH-VALUES
  4533              SET TIME-TO-BUILD  TO TRUE
  4534           ELSE
  4535              MOVE ACCOUNT-MASTER
  4536                                 TO WS-SAVE-ERACCT
  4537              PERFORM 0420-READNEXT-ERACCT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  80
* SOCK00.cbl
  4538                                 THRU 0420-EXIT
  4539              IF NOT RESP-NORMAL
  4540                 MOVE WS-SAVE-ERACCT
  4541                                 TO ACCOUNT-MASTER
  4542                 SET TIME-TO-BUILD
  4543                                 TO TRUE
  4544              END-IF
  4545           END-IF
  4546        ELSE
  4547           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4548           SET TIME-TO-BUILD     TO TRUE
  4549        END-IF
  4550     END-PERFORM
  4551     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4552     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4553     GO TO SOCKET-FIN
  4554     .
  4555 0500-EXIT.
  4556     EXIT.
  4557 7000-GET-RATE.
  4558
  4559* EXEC CICS LINK
  4560*       PROGRAM ('ELRATE')
  4561*       COMMAREA (CALCULATION-PASS-AREA)
  4562*       LENGTH   (CP-COMM-LENGTH)
  4563*    END-EXEC
  4564     MOVE 'ELRATE' TO DFHEIV1
  4565*    MOVE '."C                   (   #00004343' TO DFHEIV0
  4566     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4568     MOVE X'2020233030303034333433' TO DFHEIV0(25:11)
  4569     CALL 'kxdfhei1' USING DFHEIV0,
  4570           DFHEIV1,
  4571           CALCULATION-PASS-AREA,
  4572           CP-COMM-LENGTH,
  4573           DFHEIV99,
  4574           DFHEIV99,
  4575           DFHEIV99,
  4576           DFHEIV99
  4577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4578     .
  4579 7000-EXIT.
  4580     EXIT.
  4581 9700-DATE-LINK.
  4582
  4583* EXEC CICS LINK
  4584*         PROGRAM  ('ELDATCV')
  4585*         COMMAREA (DATE-CONVERSION-DATA)
  4586*         LENGTH   (DC-COMM-LENGTH)
  4587*    END-EXEC.
  4588     MOVE 'ELDATCV' TO DFHEIV1
  4589*    MOVE '."C                   (   #00004352' TO DFHEIV0
  4590     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4592     MOVE X'2020233030303034333532' TO DFHEIV0(25:11)
  4593     CALL 'kxdfhei1' USING DFHEIV0,
  4594           DFHEIV1,
  4595           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  81
* SOCK00.cbl
  4596           DC-COMM-LENGTH,
  4597           DFHEIV99,
  4598           DFHEIV99,
  4599           DFHEIV99,
  4600           DFHEIV99
  4601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4602
  4603 9700-EXIT.
  4604      EXIT.
  4605
  4606 9999-DFHBACK SECTION.
  4607     MOVE '9%                    "   ' TO DFHEIV0
  4608     MOVE 'SOCK00' TO DFHEIV1
  4609     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4610     GOBACK.
  4611 9999-DFHEXIT.
  4612     IF DFHEIGDJ EQUAL 0001
  4613         NEXT SENTENCE.
  4614     MOVE '9%                    "   ' TO DFHEIV0
  4615     MOVE 'SOCK00' TO DFHEIV1
  4616     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4617     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16548     Code:        8720
