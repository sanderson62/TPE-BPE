* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   1
* EL152.cbl
* Options: int("EL152.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   2
* EL152.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36* 041513  CR2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    37* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   3
* EL152.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    48
    49*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    50*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    51*                                  USAGE POINTER.
    52 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    53 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    54                                   USAGE POINTER.
    55 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    56 77  S1                          PIC S9 VALUE +0.
    57 77  S2                          PIC S9 VALUE +0.
    58 01  P pointer.
    59 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63 01  WS-KIXSYS.
    64     05  WS-KIX-FIL1             PIC X(10).
    65     05  WS-KIX-APPS             PIC X(10).
    66     05  WS-KIX-ENV              PIC X(10).
    67     05  WS-KIX-MYENV            PIC X(10).
    68     05  WS-KIX-SYS              PIC X(10).
    69 01  WS-HOLDING-ZIPS.
    70     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    71     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    72     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    73     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    74     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    75     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    76     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    77     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    78     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    79     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    80     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    81     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    82     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    83     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    84     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    85     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    86     05  FILLER              PIC X(17)  VALUE '-----------------'.
    87
    88*                            COPY ELCSCTM.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCTM                             *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    96*                                                                *
    97******************************************************************
    98 01  SECURITY-MESSAGE.
    99     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   4
* EL152.cbl
   100            VALUE '** LOGIC SECURITY VIOLATION -'.
   101     12  SM-READ                         PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' PGM='.
   104     12  SM-PGM                          PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' OPR='.
   107     12  SM-PROCESSOR-ID                 PIC X(4).
   108     12  FILLER                          PIC X(6)
   109            VALUE ' TERM='.
   110     12  SM-TERMID                       PIC X(4).
   111     12  FILLER                          PIC XX   VALUE SPACE.
   112     12  SM-JUL-DATE                     PIC 9(5).
   113     12  FILLER                          PIC X    VALUE SPACE.
   114     12  SM-TIME                         PIC 99.99.
   115
   116
   117*                            COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140
   141 01  WS-DATE-AREA.
   142     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   143     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   144     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   145         88  W-REVERSE-DATE                   VALUE 'Y'.
   146     12  W-EDIT-DATE-1.
   147         16  W-ED1-MM            PIC XX.
   148         16  FILLER              PIC X        VALUE '/'.
   149         16  W-ED1-DD            PIC XX.
   150         16  FILLER              PIC X        VALUE '/'.
   151         16  W-ED1-YY            PIC XX.
   152     12  W-EDIT-DATE-2.
   153         16  W-ED2-DD            PIC XX.
   154         16  FILLER              PIC X        VALUE '/'.
   155         16  W-ED2-MM            PIC XX.
   156         16  FILLER              PIC X        VALUE '/'.
   157         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   5
* EL152.cbl
   158 01  FILLER.
   159     05  WS-WORK-INT-RATE        PIC 99.999.
   160     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   161                                 PIC X(6).
   162 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   163     'BEGINJOB mode=''MVS'''.
   164 01  TRAN-DATA-LINE2.
   165*     05  FILLER                  PIC X(39)    VALUE
   166*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   167     05  FILLER                  PIC X(29)    VALUE
   168     '"smtp -f EL152cl2 -t ajra -s '.
   169     05  TRAN-DETAIL.
   170         10  FILLER              PIC XX       VALUE
   171         ''' '.
   172         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   173         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   174         10  FILLER              PIC X        VALUE SPACES.
   175         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   176     05  FILLER                  PIC XX       VALUE '''"'.
   177     05  FILLER                  PIC X(30)    VALUE SPACES.
   178 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   179     'ENDJOB            '.
   180
   181 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   182 01  STANDARD-AREAS.
   183     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   184     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   185     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   186     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   187     12  MAP-NAME.
   188         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   189         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   190         16  MAP-FILLER          PIC XX      VALUE SPACES.
   191     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   192     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   193     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   194     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   195     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   196     12  PGM-NAME                PIC X(8).
   197     12  TIME-IN                 PIC S9(7).
   198     12  TIME-OUT-R  REDEFINES TIME-IN.
   199         16  FILLER              PIC X.
   200         16  TIME-OUT            PIC 99V99.
   201         16  FILLER              PIC XX.
   202     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   203     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   204     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   205     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   206     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   207     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   208     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   209     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   210     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   211     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   212     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   213     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   214     12  SUB                     PIC 99.
   215     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   6
* EL152.cbl
   216
   217     12  WS-PI-QID.
   218         16  QID-TERM            PIC X(4)    VALUE SPACES.
   219         16  FILLER              PIC X(4)    VALUE '152A'.
   220
   221     12  W-LETTER-ADDRESS-TYPE.
   222         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   223         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   224
   225     12  W-ADDRESS-SELECTION.
   226         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   227         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   228         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   229         16  W-INSURED           PIC  9 VALUE ZEROS.
   230         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   231         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   232         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   233
   234     12  W-Z-CONTROL-DATA.
   235         16  W-NUMBER-OF-COPIES  PIC  9.
   236         16  FILLER              PIC  X.
   237         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   238         16  FILLER              PIC  X.
   239         16  W-DAYS-TO-RESEND-1  PIC  999.
   240         16  FILLER              PIC  X.
   241         16  W-FORM-TO-RESEND    PIC  X(4).
   242         16  FILLER              PIC  X(1).
   243         16  W-PROMPT-LETTER     PIC  X(1).
   244         16  FILLER              PIC  X(1).
   245         16  W-ENCLOSURE-CD      PIC  X(3).
   246         16  FILLER              PIC  X(1).
   247         16  W-AUTO-CLOSE-IND    PIC  X(1).
   248         16  FILLER              PIC  X(1).
   249         16  W-LETTER-TO-BENE    PIC  X(1).
   250
   251     12  W-CREDIT-CARD-LOAN-NO.
   252         16  W-LOAN-NO           PIC  X(08).
   253         16  W-CURRENT-LOAN-NO   PIC  X(12).
   254
   255     12  W-GROUPING.
   256         16  W-GROUP-3           PIC  XXX.
   257         16  FILLER              PIC  XXX.
   258
   259     12  W-NAME.
   260         16  W-FIRST-NAME        PIC  X(12).
   261         16  W-MIDDLE-NAME       PIC  X(12).
   262         16  W-LAST-NAME         PIC  X(15).
   263
   264     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   265     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   266         16  FILLER              PIC 9.
   267         16  WSPI-AREA           PIC 9(3).
   268         16  WSPI-PFX            PIC 9(3).
   269         16  WSPI-SFX            PIC 9(4).
   270     12  WS-PHONE-OUT.
   271         16  WSPO-AREA           PIC X(3).
   272         16  FILLER              PIC X       VALUE '-'.
   273         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   7
* EL152.cbl
   274         16  FILLER              PIC X       VALUE '-'.
   275         16  WSPO-SFX            PIC X(4).
   276
   277     12  WS-ZIP-NUMERIC          PIC 9(9).
   278     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   279                                 PIC X(9).
   280
   281     12  WS-ZIP-CODE.
   282         16  WS-AM-ZIP-CODE      PIC X(5).
   283         16  WS-AM-ZIP-DASH      PIC X.
   284         16  WS-AM-ZIP-PLUS4     PIC X(4).
   285     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   286         16  WS-CAN-POSTAL-1     PIC XXX.
   287         16  FILLER              PIC X.
   288         16  WS-CAN-POSTAL-2     PIC XXX.
   289         16  FILLER              PIC XXX.
   290
   291     12  WS-LABEL-HOLD-AREA.
   292         16  WS-LABEL-LINES OCCURS 6 TIMES
   293                            INDEXED BY WS-NDX  WS-NDX2.
   294             20  WS-LABEL-ZIP.
   295                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   296                 24  FILLER            PIC X.
   297                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   298             20  FILLER                PIC X(9).
   299             20  WS-LAST-DIGIT         PIC X.
   300             20  WS-LAST-ZIP.
   301                 24  WS-LAST-1ST-ZIP   PIC X(5).
   302                 24  FILLER            PIC X.
   303                 24  WS-LAST-2ND-ZIP   PIC X(4).
   304
   305     12  WS-DATA-FOUND-SW            PIC X.
   306         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   307
   308     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   309     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   310     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   311     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   312         88  THE-REST-R-CAPS                 VALUE 'Y'.
   313     12  WS-POSITION2            PIC S9(4)   COMP.
   314     12  WS-POSITION21           PIC S9(4)   COMP.
   315     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   316
   317     12  WS-TEMP-AREA1.
   318         16  WS-TEMP-1           PIC X OCCURS 29
   319                                       INDEXED BY TA1.
   320     12  WS-TEMP-AREA2.
   321         16  WS-TEMP-2           PIC X OCCURS 30
   322                                       INDEXED BY TA2
   323                                                  TA21
   324                                                  MOVE-INDX.
   325
   326     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   327
   328     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   330     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   331     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   8
* EL152.cbl
   332     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   333     12  INDX-WORK               PIC 99.
   334     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   335
   336     12  DATE-WORK               PIC 9(7).
   337     12  DT-REDEF REDEFINES DATE-WORK.
   338         16  FILLER              PIC XX.
   339         16  DT-WORK             PIC 9(5).
   340
   341     12  BEN-HOLD                PIC XX.
   342
   343     12  BENEFIT-WORK            PIC XXX.
   344     12  BEN-R REDEFINES BENEFIT-WORK.
   345         16  ELIM-DAYS           PIC XX.
   346         16  FILLER              PIC X.
   347
   348     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   349         88  NO-GETMAIN-DONE-YET              VALUE 0.
   350         88  REFRESH-GETMAIN-AREA             VALUE 1.
   351
   352     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   353     12  CURRENT-SAVE            PIC XX.
   354     12  CURRENT-PLUS3-SAVE      PIC XX.
   355     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   356     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   357     12  SEQ-COUNTER             PIC S9(4) COMP.
   358     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   359     12  DEEDIT-FIELD            PIC X(15).
   360     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   361
   362     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   363     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   364
   365     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   366     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   367
   368     12  WS-CCN-12               PIC X(12).
   369
   370     12  WS-ADDR-TYPE-CD.
   371         16  WS-ADDR-TYPE        PIC X.
   372         16  WS-ADDR-SEQ         PIC X.
   373         16  WS-ADDR-SEQ-NUM REDEFINES
   374             WS-ADDR-SEQ         PIC 9.
   375
   376     12  WS-DMD-CERT-STATE       PIC XX.
   377     12  WS-DMD-CERT-GROUPING    PIC XX.
   378     12  WS-DMD-BEN-CODE         PIC XX.
   379     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   380     12  WS-DMD-LETTER-FORM      PIC X(4).
   381     12  WS-DMD-RES-ST           PIC XX.
   382
   383     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   384          'Central States provides plan administration for'.
   385
   386     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   387          'Central States Health and Life Co.'.
   388
   389     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page   9
* EL152.cbl
   390          'Central States Indemnity Co.'.
   391
   392* DLO023
   393 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   394 01  WS-DLO-CODES-TABLE.
   395     12  DL23-SYSTEM-ID          PIC XX.
   396     12  DL23-RECORD-TYPE        PIC XX.
   397     12  DL23-RECORD-KEY         PIC X(6).
   398     12  DL23-RETURN-CODE        PIC XX.
   399     12  DL23-CODE-DESC          PIC X(60).
   400     12  DL23-GEN-DESC-1         PIC X(20).
   401     12  DL23-GEN-DESC-2         PIC X(20).
   402     12  DL23-GEN-DESC-3         PIC X(20).
   403     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   404     12  WS-BLANK                PIC X        VALUE ' '.
   405
   406 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   407 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   408
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  10
* EL152.cbl
   410 01  ACCESS-KEYS-AND-FILE-IDS.
   411     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   412     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   413     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   414     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   415     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   416     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   417     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   418     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   419     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   420     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   421     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   422     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   423     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   424     12  ENCC-ID                  PIC X(8)    VALUE 'ELENCC'.
   425
   426     12  CNTL-KEY.
   427         16  CNTL-CO              PIC X(3).
   428         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   429         16  CNTL-GENL.
   430           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   431           18 CNTL-GEN2.
   432             20 CNTL-GEN3         PIC X       VALUE SPACES.
   433             20 CNTL-GEN4         PIC X       VALUE SPACES.
   434         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   435
   436      12  WS-ERCOMP-KEY.
   437          16  WS-ERCOMP-COMPANY-CD PIC X.
   438          16  WS-ERCOMP-CARRIER    PIC X.
   439          16  WS-ERCOMP-GROUPING   PIC X(6).
   440          16  WS-ERCOMP-RESP-NO    PIC X(10).
   441          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   442          16  WS-ERCOMP-TYPE       PIC X.
   443
   444     12  CLAM-KEY.
   445         16  CLAM-CO              PIC X.
   446         16  CLAM-CARRIER         PIC X.
   447         16  CLAM-CLAIM           PIC X(7).
   448         16  CLAM-CERT-NUM        PIC X(11).
   449
   450     12  TEXT-KEY.
   451         16  TEXT-PARTIAL-KEY.
   452             20  TEXT-CO          PIC X.
   453             20  TEXT-LETTER      PIC X(4).
   454         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   455         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   456
   457     12  ACTV-KEY.
   458         16  ACTV-PARTIAL-KEY.
   459             20  ACTV-CO          PIC X.
   460             20  ACTV-CARRIER     PIC X.
   461             20  ACTV-CLAIM       PIC X(7).
   462             20  ACTV-CERT-NUM    PIC X(11).
   463         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   464
   465     12  CERT-KEY.
   466         16  CERT-CO              PIC X.
   467         16  CERT-CARRIER         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  11
* EL152.cbl
   468         16  CERT-GROUPING        PIC X(6).
   469         16  CERT-STATE           PIC XX.
   470         16  CERT-ACCOUNT         PIC X(10).
   471         16  CERT-EFF-DT          PIC XX.
   472         16  CERT-CERT-NUM        PIC X(11).
   473
   474     12  ACCT-KEY.
   475         16  ACCT-PARTIAL-KEY.
   476             20  ACCT-CO              PIC X.
   477             20  ACCT-CARRIER         PIC X.
   478             20  ACCT-GROUPING        PIC X(6).
   479             20  ACCT-STATE           PIC XX.
   480             20  ACCT-ACCOUNT         PIC X(10).
   481         16  ACCT-EXP-DATE            PIC XX.
   482
   483     12  ARCH-KEY.
   484         16  ARCH-PARTIAL-KEY.
   485             20  ARCH-CO          PIC X.
   486             20  ARCH-NUMBER      PIC S9(8)      COMP.
   487         16  ARCH-REC-TYPE        PIC X.
   488         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   489
   490     12  BENE-KEY.
   491         16  BENE-COMP-CD         PIC X.
   492         16  BENE-REC-TYPE        PIC X.
   493         16  BENE-NUMBER.
   494             20  BENE-CREDITOR    PIC XXX.
   495             20  FILLER           PIC X(7).
   496
   497     12  PROD-KEY.
   498         16  PROD-PARTIAL-KEY.
   499             20  PROD-CO          PIC X.
   500             20  PROD-CARRIER     PIC X.
   501             20  PROD-GROUPING    PIC X(6).
   502             20  PROD-STATE       PIC XX.
   503             20  PROD-PRODUCER    PIC X(10).
   504         16  PROD-EXP-DATE        PIC XX.
   505
   506     12  PLCY-KEY.
   507         16  PLCY-CO              PIC X.
   508         16  PLCY-CARRIER         PIC X.
   509         16  PLCY-GROUPING        PIC X(06).
   510         16  PLCY-STATE           PIC XX.
   511         16  PLCY-PRODUCER        PIC X(10).
   512         16  PLCY-EFF-DT          PIC XX.
   513         16  PLCY-REFERENCE-NO    PIC X(20).
   514
   515     12  PLAN-KEY.
   516         16  PLAN-CO              PIC X.
   517         16  PLAN-CARRIER         PIC X.
   518         16  PLAN-GROUPING        PIC X(6).
   519         16  PLAN-STATE           PIC XX.
   520         16  PLAN-PRODUCER        PIC X(10).
   521         16  PLAN-CODE            PIC XX.
   522         16  PLAN-REV-NO          PIC 999.
   523
   524     12  ELENCC-KEY.
   525         16  ELENCC-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  12
* EL152.cbl
   526         16  ELENCC-REC-TYPE      PIC X.
   527         16  ELENCC-ENC-CODE      PIC X(5).
   528         16  F                    PIC X(09).
   529
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  13
* EL152.cbl
   531     12  ARCH-SAVE-KEY           PIC X(5).
   532     12  ACTV-SAVE-KEY           PIC X(20).
   533     12  ACCT-SAVE-KEY           PIC X(20).
   534     12  PROD-SAVE-KEY           PIC X(20).
   535     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   536     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   537     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   538     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   539     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   540     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   541     12  ENCC-LENGTH             PIC S9(4)  COMP  VALUE +400.
   542     12  TEXT-SAVE-KEY           PIC X(5).
   543     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   544     12  VAR-HOLD.
   545         16  V1                  PIC X.
   546         16  V2                  PIC X.
   547         16  V3                  PIC X.
   548         16  V4                  PIC X.
   549     12  V-HOLD REDEFINES VAR-HOLD.
   550         16  V-NUM               PIC 99.
   551         16  V-PERIOD            PIC X.
   552         16  V-DECIMAL           PIC 9.
   553
   554     12  MAX-LINES               PIC 999     VALUE 300.
   555     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   556     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   557     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   558     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   559     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   560     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   561     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   562     12  TS-NAME-TEXT.
   563         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   564         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   565         16  TS-TERM-TEXT.
   566          17 TS-TERM-PREFIX      PIC XX.
   567          17 FILLER              PIC XX.
   568     12  TS-NAME-SCREEN.
   569         16  FILLER              PIC X(4)    VALUE '152X'.
   570         16  TS-TERM-SCREEN      PIC X(4).
   571
   572     12  LINE-NUM.
   573         16  LINE1               PIC X.
   574         16  LINE23              PIC 99.
   575     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   576     12  TOP-FORM                PIC X(70)
   577         VALUE '*****TOP OF FORM *****'.
   578     12  SINGLE-LINE             PIC X(70).
   579     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   580         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   581                                 PIC X.
   582     12  NAPERSOFT-LETTER        PIC X(16)
   583         VALUE 'Napersoft letter'.
   584
   585     12  WS-RESPONSE             PIC S9(8)   COMP.
   586         88  RESP-NORMAL              VALUE +00.
   587         88  RESP-ERROR               VALUE +01.
   588         88  RESP-NOTFND              VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  14
* EL152.cbl
   589         88  RESP-NOTOPEN             VALUE +19.
   590         88  RESP-ENDFILE             VALUE +20.
   591
   592 01  HAN-LETTER-REASON-DATA.
   593     12  WS-REASON-TEXT.
   594         16  WS-RE-NDX           PIC 99.
   595         16  FILLER              PIC X(68).
   596
   597     12  HAN-REASON-TABLE.
   598         16  FILLER              PIC X(50) VALUE
   599           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   600         16  FILLER              PIC X(50) VALUE
   601           'CHECKING PRE-EXISTING CONDITION                   '.
   602         16  FILLER              PIC X(50) VALUE
   603           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   604         16  FILLER              PIC X(50) VALUE
   605           'LETTER TO INSURED                                 '.
   606         16  FILLER              PIC X(50) VALUE
   607           'LETTER TO CREDITOR                                '.
   608         16  FILLER              PIC X(50) VALUE
   609           'LETTER TO EMPLOYER                                '.
   610         16  FILLER              PIC X(50) VALUE
   611           'LETTER TO INSURED / 2ND REQUEST                   '.
   612         16  FILLER              PIC X(50) VALUE
   613           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   614         16  FILLER              PIC X(50) VALUE
   615           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   616         16  FILLER              PIC X(50) VALUE
   617           'AWAITING INITIAL CLAIM FORM                       '.
   618         16  FILLER              PIC X(50) VALUE
   619           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   620         16  FILLER              PIC X(50) VALUE
   621           'DENIED / PRE-EXISTING CONDITION                   '.
   622         16  FILLER              PIC X(50) VALUE
   623           'DENIED / WAITING PERIOD NOT MET                   '.
   624         16  FILLER              PIC X(50) VALUE
   625           'DENIED / NORMAL PREGNANCY                         '.
   626         16  FILLER              PIC X(50) VALUE
   627           'DENIED / ACT OF WAR                               '.
   628         16  FILLER              PIC X(50) VALUE
   629           'DENIED / NOT TOTALLY DISABLED                     '.
   630         16  FILLER              PIC X(50) VALUE
   631           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   632         16  FILLER              PIC X(50) VALUE
   633           'DENIED / NO COVERAGE INFORCE                      '.
   634         16  FILLER              PIC X(50) VALUE
   635           'DENIED / DISABLED ON DATE OF LOAN                 '.
   636         16  FILLER              PIC X(50) VALUE
   637           'DENIED / OVER MAXIMUM AGE                         '.
   638         16  FILLER              PIC X(50) VALUE
   639           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   640         16  FILLER              PIC X(50) VALUE
   641           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   642         16  FILLER              PIC X(50) VALUE
   643           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   644         16  FILLER              PIC X(50) VALUE
   645           'DENIED/SUICIDE EXCLUSION                          '.
   646         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  15
* EL152.cbl
   647           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   648         16  FILLER              PIC X(50) VALUE
   649           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   650         16  FILLER              PIC X(50) VALUE
   651           'DENIED/GROUP POLICY LAPSED                        '.
   652         16  FILLER              PIC X(50) VALUE
   653           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   654         16  FILLER              PIC X(50) VALUE
   655           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   656         16  FILLER              PIC X(50) VALUE
   657           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   658         16  FILLER              PIC X(50) VALUE
   659           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   660         16  FILLER              PIC X(50) VALUE
   661           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   662
   663     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   664         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   665             20  HAN-REASON-TEXT PIC X(50).
   666
   667 01  ERROR-MESSAGES.
   668     12  ER-0000                 PIC X(4)  VALUE '0000'.
   669     12  ER-0004                 PIC X(4)  VALUE '0004'.
   670     12  ER-0006                 PIC X(4)  VALUE '0006'.
   671     12  ER-0008                 PIC X(4)  VALUE '0008'.
   672     12  ER-0013                 PIC X(4)  VALUE '0013'.
   673     12  ER-0023                 PIC X(4)  VALUE '0023'.
   674     12  ER-0029                 PIC X(4)  VALUE '0029'.
   675     12  ER-0033                 PIC X(4)  VALUE '0033'.
   676     12  ER-0042                 PIC X(4)  VALUE '0042'.
   677     12  ER-0047                 PIC X(4)  VALUE '0047'.
   678     12  ER-0051                 PIC X(4)  VALUE '0051'.
   679     12  ER-0066                 PIC X(4)  VALUE '0066'.
   680     12  ER-0067                 PIC X(4)  VALUE '0067'.
   681     12  ER-0070                 PIC X(4)  VALUE '0070'.
   682     12  ER-0133                 PIC X(4)  VALUE '0133'.
   683     12  ER-0154                 PIC X(4)  VALUE '0154'.
   684     12  ER-0168                 PIC X(4)  VALUE '0168'.
   685     12  ER-0169                 PIC X(4)  VALUE '0169'.
   686     12  ER-0172                 PIC X(4)  VALUE '0172'.
   687     12  ER-0174                 PIC X(4)  VALUE '0174'.
   688     12  ER-0175                 PIC X(4)  VALUE '0175'.
   689     12  ER-0176                 PIC X(4)  VALUE '0176'.
   690     12  ER-0177                 PIC X(4)  VALUE '0177'.
   691     12  ER-0178                 PIC X(4)  VALUE '0178'.
   692     12  ER-0179                 PIC X(4)  VALUE '0179'.
   693     12  ER-0180                 PIC X(4)  VALUE '0180'.
   694     12  ER-0181                 PIC X(4)  VALUE '0181'.
   695     12  ER-0182                 PIC X(4)  VALUE '0182'.
   696     12  ER-0183                 PIC X(4)  VALUE '0183'.
   697     12  ER-0184                 PIC X(4)  VALUE '0184'.
   698     12  ER-0185                 PIC X(4)  VALUE '0185'.
   699     12  ER-0186                 PIC X(4)  VALUE '0186'.
   700     12  ER-0187                 PIC X(4)  VALUE '0187'.
   701     12  ER-0188                 PIC X(4)  VALUE '0188'.
   702     12  ER-0189                 PIC X(4)  VALUE '0189'.
   703     12  ER-0190                 PIC X(4)  VALUE '0190'.
   704     12  ER-0191                 PIC X(4)  VALUE '0191'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  16
* EL152.cbl
   705     12  ER-0206                 PIC X(4)  VALUE '0206'.
   706     12  ER-0211                 PIC X(4)  VALUE '0211'.
   707     12  ER-0279                 PIC X(4)  VALUE '0279'.
   708     12  ER-0280                 PIC X(4)  VALUE '0280'.
   709     12  ER-0281                 PIC X(4)  VALUE '0281'.
   710     12  ER-0332                 PIC X(4)  VALUE '0332'.
   711     12  ER-0343                 PIC X(4)  VALUE '0343'.
   712     12  ER-0373                 PIC X(4)  VALUE '0373'.
   713     12  ER-0374                 PIC X(4)  VALUE '0374'.
   714     12  ER-0412                 PIC X(4)  VALUE '0412'.
   715     12  ER-0413                 PIC X(4)  VALUE '0413'.
   716     12  ER-0533                 PIC X(4)  VALUE '0533'.
   717     12  ER-0537                 PIC X(4)  VALUE '0537'.
   718     12  ER-0716                 PIC X(4)  VALUE '0716'.
   719     12  ER-0861                 PIC X(4)  VALUE '0861'.
   720     12  ER-0894                 PIC X(4)  VALUE '0894'.
   721     12  ER-0900                 PIC X(4)  VALUE '0900'.
   722     12  ER-0909                 PIC X(4)  VALUE '0909'.
   723     12  ER-0911                 PIC X(4)  VALUE '0911'.
   724     12  ER-0912                 PIC X(4)  VALUE '0912'.
   725     12  ER-1236                 PIC X(4)  VALUE '1236'.
   726     12  ER-1560                 PIC X(4)  VALUE '1560'.
   727     12  ER-2055                 PIC X(4)  VALUE '2055'.
   728     12  ER-2397                 PIC X(4)  VALUE '2397'.
   729     12  ER-2398                 PIC X(4)  VALUE '2398'.
   730     12  ER-3547                 PIC X(4)  VALUE '3547'.
   731     12  ER-3770                 PIC X(4)  VALUE '3770'.
   732     12  ER-3771                 PIC X(4)  VALUE '3771'.
   733     12  ER-3772                 PIC X(4)  VALUE '3772'.
   734     12  ER-7675                 PIC X(4)  VALUE '7675'.
   735     12  ER-7840                 PIC X(4)  VALUE '7840'.
   736     12  ER-7842                 PIC X(4)  VALUE '7842'.
   737     12  ER-7843                 PIC X(4)  VALUE '7843'.
   738     12  ER-8158                 PIC X(4)  VALUE '8158'.
   739     12  ER-9106                 PIC X(4)  VALUE '9106'.
   740     12  ER-9483                 PIC X(4)  VALUE '9483'.
   741     12  ER-9808                 PIC X(4)  VALUE '9808'.
   742     12  ER-9883                 PIC X(4)  VALUE '9883'.
   743     12  ER-9887                 PIC X(4)  VALUE '9887'.
   744
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  17
* EL152.cbl
   746****************************************************
   747*       WHEN ADDING OR DELETING ENTRIES TO         *
   748*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   749*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   750*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   751*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   752*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   753*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   754*                                                  *
   755*   3 FIELDS TO CHANGE:                            *
   756*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   757*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   758*      3 - SYSTEM-VARIABLES......( "      "   )    *
   759****************************************************
   760
   761*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   762*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   763
   764     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   765     12  SS-COUNTER              PIC 999                   COMP-3.
   766     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   767
   768 01  VARIABLE-WORK-AREA.
   769     12  VAR-CODE                PIC X(4).
   770     12  VAR-LEN                 PIC 99.
   771     12  VAR-DATA                PIC X(100).
   772     12  VAR-DATA-R REDEFINES VAR-DATA.
   773       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   774
   775 01  SYSTEM-SUPPORTED-VARIABLES.
   776*****COMPANY NAME
   777     12  SS01                    PIC X(4)  VALUE     '01.0'.
   778     12  SS01L                   PIC 99    VALUE 36.
   779     12  SS01D                   PIC X(30) VALUE ALL '*'.
   780*****FULL COMPANY ADDRESS
   781     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   782     12  SS02-1L                 PIC 99    VALUE 36.
   783     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   784     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   785     12  SS02-2L                 PIC 99    VALUE 36.
   786     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   787     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   788     12  SS02-3L                 PIC 99    VALUE 36.
   789     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   790     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   791     12  SS02-4L                 PIC 99    VALUE 36.
   792     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   793     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   794     12  SS02-5L                 PIC 99    VALUE 36.
   795     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   796*****CARRIER NAME
   797     12  SS03                    PIC X(4)  VALUE     '03.0'.
   798     12  SS03L                   PIC 99    VALUE 36.
   799     12  SS03D                   PIC X(30) VALUE ALL '*'.
   800*****INVESTORS HERITAGE
   801* as Administrator for Investors Heritage Life Insurance Company
   802     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   803     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  18
* EL152.cbl
   804     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   805*****FULL CARRIER ADDRESS
   806     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   807     12  SS04-1L                 PIC 99    VALUE 36.
   808     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   809     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   810     12  SS04-2L                 PIC 99    VALUE 36.
   811     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   812     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   813     12  SS04-3L                 PIC 99    VALUE 36.
   814     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   815     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   816     12  SS04-4L                 PIC 99    VALUE 36.
   817     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   818     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   819     12  SS04-5L                 PIC 99    VALUE 36.
   820     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   821*****CARRIER PHONE NUMBER
   822     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   823     12  SS04-6L                 PIC 99    VALUE 18.
   824     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   825*****FULL ADDRESEE LABEL
   826     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   827     12  SS05-1L                 PIC 99    VALUE 36.
   828     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   829     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   830     12  SS05-2L                 PIC 99    VALUE 36.
   831     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   832     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   833     12  SS05-3L                 PIC 99    VALUE 36.
   834     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   835     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   836     12  SS05-4L                 PIC 99    VALUE 36.
   837     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   838     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   839     12  SS05-5L                 PIC 99    VALUE 36.
   840     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   841     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   842     12  SS05-6L                 PIC 99    VALUE 36.
   843     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   844*****ACCOUNT NAME
   845     12  SS06                    PIC X(4)  VALUE     '06.0'.
   846     12  SS06L                   PIC 99    VALUE 36.
   847     12  SS06D                   PIC X(30) VALUE ALL '*'.
   848*****FULL ACCOUNT ADDRESS
   849     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   850     12  SS07-1L                 PIC 99    VALUE 36.
   851     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   852     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   853     12  SS07-2L                 PIC 99    VALUE 36.
   854     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   855     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   856     12  SS07-3L                 PIC 99    VALUE 36.
   857     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   858     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   859     12  SS07-4L                 PIC 99    VALUE 36.
   860     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   861     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  19
* EL152.cbl
   862     12  SS07-5L                 PIC 99    VALUE 36.
   863     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   864*****ACCOUNT PHONE NUMBER
   865     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   866     12  SS07-6L                 PIC 99    VALUE 18.
   867     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   868*****EXECUTING PROCESSOR NAME
   869     12  SS08                    PIC X(4)  VALUE     '08.0'.
   870     12  SS08L                   PIC 99    VALUE 36.
   871     12  SS08D                   PIC X(30) VALUE ALL '*'.
   872*****PROCESSOR TITLE
   873     12  SS09                    PIC X(4)  VALUE     '09.0'.
   874     12  SS09L                   PIC 99    VALUE 32.
   875     12  SS09D                   PIC X(26) VALUE ALL '*'.
   876*****INSUREDS NAME
   877     12  SS10                    PIC X(4)  VALUE     '10.0'.
   878     12  SS10L                   PIC 99    VALUE 36.
   879     12  SS10D                   PIC X(30) VALUE ALL '*'.
   880*****INSUREDS ADDRESS
   881     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   882     12  SS11-1L                 PIC 99    VALUE 36.
   883     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   884     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   885     12  SS11-2L                 PIC 99    VALUE 36.
   886     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   887     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   888     12  SS11-3L                 PIC 99    VALUE 36.
   889     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   890     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   891     12  SS11-4L                 PIC 99    VALUE 36.
   892     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   893*****INSUREDS NAME FROM ADDR TRAILER
   894     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   895     12  SS11-5L                 PIC 99    VALUE 36.
   896     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   897*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   898     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   899     12  SS11-6L                 PIC 99    VALUE 18.
   900     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   901*****CLAIM TYPE NAME
   902     12  SS12                    PIC X(4)  VALUE     '12.0'.
   903     12  SS12L                   PIC 99    VALUE 12.
   904     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   905*****CLAIM INCURRED DATE
   906     12  SS13                    PIC X(4)  VALUE     '13.0'.
   907     12  SS13L                   PIC 99    VALUE 14.
   908     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   909*****CLAIM REPORTED DATE
   910     12  SS14                    PIC X(4)  VALUE     '14.0'.
   911     12  SS14L                   PIC 99    VALUE 14.
   912     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   913*****LAST PAYMENT DATE
   914     12  SS15                    PIC X(4)  VALUE     '15.0'.
   915     12  SS15L                   PIC 99    VALUE 14.
   916     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   917*****LAST PAYMENT AMOUNT
   918     12  SS16                    PIC X(4)  VALUE     '16.0'.
   919     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  20
* EL152.cbl
   920     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   921*****CLAIM INTEREST RATE
   922     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   923     12  SS16-1L                 PIC 99    VALUE 13.
   924     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   925*****CLAIM PAID THRU/TO DATE
   926     12  SS17                    PIC X(4)  VALUE     '17.0'.
   927     12  SS17L                   PIC 99    VALUE 14.
   928     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   929*****TOTAL PAID TO DATE
   930     12  SS18                    PIC X(4)  VALUE     '18.0'.
   931     12  SS18L                   PIC 99    VALUE 17.
   932     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   933*****DIAGNOSIS OR CAUSE
   934     12  SS19                    PIC X(4)  VALUE     '19.0'.
   935     12  SS19L                   PIC 99    VALUE 32.
   936     12  SS19D                   PIC X(26) VALUE ALL '*'.
   937*****CAUSE CODE
   938     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   939     12  SS19-1L                 PIC 99    VALUE 12.
   940     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   941*****CID LOAN NUMBER
   942     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   943     12  SS19-2L                 PIC 99    VALUE 31.
   944     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   945*****CURRENT DATE
   946     12  SS20                    PIC X(4)  VALUE     '20.0'.
   947     12  SS20L                   PIC 99    VALUE 14.
   948     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   949*****FULL CURRENT DATE
   950     12  SS21                    PIC X(4)  VALUE     '21.0'.
   951     12  SS21L                   PIC 99    VALUE 24.
   952     12  SS21D                   PIC X(18) VALUE ALL '*'.
   953*****BENEFIT DESCRIPTION
   954     12  SS22                    PIC X(4)  VALUE     '22.0'.
   955     12  SS22L                   PIC 99    VALUE 16.
   956     12  SS22D                   PIC X(10) VALUE ALL '*'.
   957*****CARRIER CODE IN CERT
   958     12  SS23                    PIC X(4)  VALUE     '23.0'.
   959     12  SS23L                   PIC 99    VALUE 9.
   960     12  SS23D                   PIC XXX   VALUE ALL '*'.
   961*****GROUPING CODE IN CERT
   962     12  SS24                    PIC X(4)  VALUE     '24.0'.
   963     12  SS24L                   PIC 99    VALUE 12.
   964     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   965*****ACCOUNT NUMBER IN CERT
   966     12  SS25                    PIC X(4)  VALUE     '25.0'.
   967     12  SS25L                   PIC 99    VALUE 16.
   968     12  SS25D                   PIC X(10) VALUE ALL '*'.
   969*****CERTIFICATE NUMBER
   970     12  SS26                    PIC X(4)  VALUE     '26.0'.
   971     12  SS26L                   PIC 99    VALUE 17.
   972     12  SS26D                   PIC X(11) VALUE ALL '*'.
   973*****CERT EFFECTIVE DATE
   974     12  SS27                    PIC X(4)  VALUE     '27.0'.
   975     12  SS27L                   PIC 99    VALUE 14.
   976     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   977*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  21
* EL152.cbl
   978     12  SS28                    PIC X(4)  VALUE     '28.0'.
   979     12  SS28L                   PIC 99    VALUE 14.
   980     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   981*****APPLICABLE COVERAGE TERM
   982     12  SS29                    PIC X(4)  VALUE     '29.0'.
   983     12  SS29L                   PIC 99    VALUE 9.
   984     12  SS29D                   PIC XXX   VALUE ALL '*'.
   985*****APPLICABLE COVERAGE AMOUNT
   986     12  SS30                    PIC X(4)  VALUE     '30.0'.
   987     12  SS30L                   PIC 99    VALUE 18.
   988     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   989*****APPLICABLE COVERAGE CANCEL DATE
   990     12  SS31                    PIC X(4)  VALUE     '31.0'.
   991     12  SS31L                   PIC 99    VALUE 14.
   992     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   993*****APPLICABLE COVERAGE FORM NUMBER
   994     12  SS32                    PIC X(4)  VALUE     '32.0'.
   995     12  SS32L                   PIC 99    VALUE 18.
   996     12  SS32D                   PIC X(12) VALUE ALL '*'.
   997*****INSURES AGE AT POLICY ISSUE
   998     12  SS33                    PIC X(4)  VALUE     '33.0'.
   999     12  SS33L                   PIC 99    VALUE 9.
  1000     12  SS33D                   PIC XXX   VALUE ALL '*'.
  1001*****CLAIM NUMBER
  1002     12  SS34                    PIC X(4)  VALUE     '34.0'.
  1003     12  SS34L                   PIC 99    VALUE 13.
  1004     12  SS34D                   PIC X(7)  VALUE ALL '*'.
  1005*****LAST DENIAL TEXT
  1006     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
  1007     12  SS35-1L                 PIC 99    VALUE 66.
  1008     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
  1009     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
  1010     12  SS35-2L                 PIC 99    VALUE 66.
  1011     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
  1012*****LOAN NUMBER
  1013     12  SS36                    PIC X(4)  VALUE     '36.0'.
  1014     12  SS36L                   PIC 99    VALUE 14.
  1015     12  SS36D                   PIC X(8)  VALUE ALL '*'.
  1016*****CURRENT LOAN NUMBER
  1017     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1018     12  SS36-1L                 PIC 99    VALUE 26.
  1019     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1020*****LOAN BALANCE
  1021     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1022     12  SS37L                   PIC 99    VALUE 18.
  1023     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1024*****MEMBER NUMBER
  1025     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1026     12  SS38L                   PIC 99    VALUE 18.
  1027     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1028*****INSURED NAME (FIRST M LAST)
  1029     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1030     12  SS39L                   PIC 99    VALUE 36.
  1031     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1032*****INSURED LAST NAME ONLY
  1033     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1034     12  SS40L                   PIC 99    VALUE 21.
  1035     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  22
* EL152.cbl
  1036*****TITLE (MR/MS)
  1037     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1038     12  SS41L                   PIC 99    VALUE 9.
  1039     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1040*****ELIMINATION PERIOD
  1041     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1042     12  SS42L                   PIC 99    VALUE 9.
  1043     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1044*****BENEFICIARY NAME
  1045     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1046     12  SS43L                   PIC 99    VALUE 36.
  1047     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1048*****BENEFICIARY ADDRESS
  1049     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1050     12  SS44-1L                 PIC 99    VALUE 36.
  1051     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1052     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1053     12  SS44-2L                 PIC 99    VALUE 36.
  1054     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1055     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1056     12  SS44-3L                 PIC 99    VALUE 36.
  1057     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1058     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1059     12  SS44-4L                 PIC 99    VALUE 36.
  1060     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1061     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1062     12  SS44-5L                 PIC 99    VALUE 18.
  1063     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1064     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1065     12  SS44-6L                 PIC 99    VALUE 36.
  1066     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1067*****INSUREDS DATE OF BIRTH
  1068     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1069     12  SS45L                   PIC 99    VALUE 14.
  1070     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1071*****INSUREDS SOC SEC NUMBER
  1072     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1073     12  SS46L                   PIC 99    VALUE 17.
  1074     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1075*****PHYSICIANS  NAME
  1076     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1077     12  SS47L                   PIC 99    VALUE 36.
  1078     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1079*****PHYSICIANS  ADDRESS
  1080     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1081     12  SS47-1L                 PIC 99    VALUE 36.
  1082     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1083     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1084     12  SS47-2L                 PIC 99    VALUE 36.
  1085     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1086     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1087     12  SS47-3L                 PIC 99    VALUE 36.
  1088     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1089     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1090     12  SS47-4L                 PIC 99    VALUE 36.
  1091     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1092     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1093     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  23
* EL152.cbl
  1094     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1095*****EMPLOYERS   NAME
  1096     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1097     12  SS48L                   PIC 99    VALUE 36.
  1098     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1099*****EMPLOYERS   ADDRESS
  1100     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1101     12  SS48-1L                 PIC 99    VALUE 36.
  1102     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1103     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1104     12  SS48-2L                 PIC 99    VALUE 36.
  1105     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1106     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1107     12  SS48-3L                 PIC 99    VALUE 36.
  1108     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1109     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1110     12  SS48-4L                 PIC 99    VALUE 36.
  1111     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1112     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1113     12  SS48-5L                 PIC 99    VALUE 18.
  1114     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1115*****OTHER1      NAME
  1116     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1117     12  SS49L                   PIC 99    VALUE 36.
  1118     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1119*****OTHER1      ADDRESS
  1120     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1121     12  SS49-1L                 PIC 99    VALUE 36.
  1122     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1123     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1124     12  SS49-2L                 PIC 99    VALUE 36.
  1125     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1126     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1127     12  SS49-3L                 PIC 99    VALUE 36.
  1128     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1129     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1130     12  SS49-4L                 PIC 99    VALUE 36.
  1131     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1132     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1133     12  SS49-5L                 PIC 99    VALUE 18.
  1134     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1135*****OTHER2      NAME
  1136     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1137     12  SS50L                   PIC 99    VALUE 36.
  1138     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1139*****OTHER2      ADDRESS
  1140     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1141     12  SS50-1L                 PIC 99    VALUE 36.
  1142     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1143     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1144     12  SS50-2L                 PIC 99    VALUE 36.
  1145     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1146     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1147     12  SS50-3L                 PIC 99    VALUE 36.
  1148     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1149     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1150     12  SS50-4L                 PIC 99    VALUE 36.
  1151     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  24
* EL152.cbl
  1152     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1153     12  SS50-5L                 PIC 99    VALUE 18.
  1154     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1155*****A&H TERM TIMES MON. BEN.
  1156     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1157     12  SS51L                   PIC 99    VALUE 17.
  1158     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1159*****THIRD PARTY NAME
  1160     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1161     12  SS52L                   PIC 99    VALUE 36.
  1162     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1163*****THIRD PARTY ADDRESS
  1164     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1165     12  SS53-1L                 PIC 99    VALUE 36.
  1166     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1167     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1168     12  SS53-2L                 PIC 99    VALUE 36.
  1169     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1170     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1171     12  SS53-3L                 PIC 99    VALUE 36.
  1172     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1173     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1174     12  SS53-4L                 PIC 99    VALUE 36.
  1175     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1176     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1177     12  SS53-5L                 PIC 99    VALUE 36.
  1178     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1179*****THIRD PARTY PHONE NUMBER
  1180     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1181     12  SS53-6L                 PIC 99    VALUE 18.
  1182     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1183*****CERTIFICATE SEQUENCE
  1184     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1185     12  SS54L                   PIC 99    VALUE 09.
  1186     12  SS54D                   PIC XXX VALUE ALL '*'.
  1187*****CERTIFICATE TOTAL  E
  1188     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1189     12  SS55L                   PIC 99    VALUE 09.
  1190     12  SS55D                   PIC XXX VALUE ALL '*'.
  1191*****CREDITOR ID
  1192     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1193     12  SS56L                   PIC  99 VALUE 36.
  1194     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1195*****INSUREDS NAME (CERTIFICATE)
  1196     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1197     12  SS57L                   PIC 99    VALUE 36.
  1198     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1199*****JOINT NAME (CERTIFICATE)
  1200     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1201     12  SS58L                   PIC 99    VALUE 36.
  1202     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1203*****POLICY REFERENCE NUMBER
  1204     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1205     12  SS59L                   PIC 99    VALUE 26.
  1206     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1207*****CREDIT CARD NUMBER (CLAIMS)
  1208     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1209     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  25
* EL152.cbl
  1210     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1211*****CORRESPONDENCE BENEFICIARY NAME
  1212     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1213     12  SS61L                   PIC 99    VALUE 36.
  1214     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1215*****CORRESPONDENCE BENEFICIARY ADDRESS
  1216     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1217     12  SS61-1L                 PIC 99    VALUE 36.
  1218     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1219     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1220     12  SS61-2L                 PIC 99    VALUE 36.
  1221     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1222     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1223     12  SS61-3L                 PIC 99    VALUE 36.
  1224     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1225     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1226     12  SS61-4L                 PIC 99    VALUE 36.
  1227     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1228     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1229     12  SS61-5L                 PIC 99    VALUE 36.
  1230     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1231     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1232     12  SS61-6L                 PIC 99    VALUE 18.
  1233     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1234
  1235*****DMD UNDERWRITER STATEMENT
  1236     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1237     12  SS62L                   PIC 99    VALUE 56.
  1238     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1239
  1240*****DMD UNDERWRITER NAME
  1241     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1242     12  SS63L                   PIC 99    VALUE 66.
  1243     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1244
  1245*****DMD UNDERWRITER NAME
  1246     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1247     12  SS64L                   PIC 99    VALUE 66.
  1248     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1249
  1250****************************************************
  1251*       WHEN ADDING OR DELETING ENTRIES TO         *
  1252*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1253*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1254*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1255*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1256*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1257*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1258****************************************************
  1259*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1260*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1261
  1262 01  SYSTEM-VARIABLES            PIC X(3865).
  1263 01  SYS-VAR-ENTRY.
  1264     12  SYS-VAR-CODE            PIC X(4).
  1265     12  SYS-VAR-LEN             PIC 99.
  1266     12  SYS-VAR-DATA            PIC X(100).
  1267
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  26
* EL152.cbl
  1268*                                COPY ELCDATE.
  1269******************************************************************
  1270*                                                                *
  1271*                                                                *
  1272*                            ELCDATE.                            *
  1273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1274*                            VMOD=2.003
  1275*                                                                *
  1276*                                                                *
  1277*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1278*                 LENGTH = 200                                   *
  1279******************************************************************
  1280
  1281 01  DATE-CONVERSION-DATA.
  1282     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1283     12  DC-OPTION-CODE                PIC X.
  1284         88  BIN-TO-GREG                VALUE ' '.
  1285         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1286         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1287         88  YMD-GREG-TO-BIN            VALUE '3'.
  1288         88  MDY-GREG-TO-BIN            VALUE '4'.
  1289         88  JULIAN-TO-BIN              VALUE '5'.
  1290         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1291         88  FIND-CENTURY               VALUE '7'.
  1292         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1293         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1294         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1295         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1296         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1297         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1298         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1299         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1300         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1301         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1302         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1303         88  BIN-3-TO-GREG              VALUE 'I'.
  1304         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1305         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1306         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1307         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1308         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1309         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1310         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1311         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1312         88  THREE-CHARACTER-BIN
  1313                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1314         88  GREGORIAN-TO-BIN
  1315                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1316         88  BIN-TO-GREGORIAN
  1317                  VALUES ' ' '1' 'I' '8' 'G'.
  1318         88  JULIAN-TO-BINARY
  1319                  VALUES '5' 'C' 'E' 'F'.
  1320     12  DC-ERROR-CODE                 PIC X.
  1321         88  NO-CONVERSION-ERROR        VALUE ' '.
  1322         88  DATE-CONVERSION-ERROR
  1323                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1324         88  DATE-IS-ZERO               VALUE '1'.
  1325         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  27
* EL152.cbl
  1326         88  DATE-IS-INVALID            VALUE '3'.
  1327         88  DATE1-GREATER-DATE2        VALUE '4'.
  1328         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1329         88  DATE-INVALID-OPTION        VALUE '9'.
  1330         88  INVALID-CENTURY            VALUE 'A'.
  1331         88  ONLY-CENTURY               VALUE 'B'.
  1332         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1333         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1334     12  DC-END-OF-MONTH               PIC X.
  1335         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1336     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1337         88  USE-NORMAL-PROCESS         VALUE ' '.
  1338         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1339         88  ADJUST-UP-100-YRS          VALUE '2'.
  1340     12  FILLER                        PIC X.
  1341     12  DC-CONVERSION-DATES.
  1342         16  DC-BIN-DATE-1             PIC XX.
  1343         16  DC-BIN-DATE-2             PIC XX.
  1344         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1345         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1346                       DC-GREG-DATE-1-EDIT.
  1347             20  DC-EDIT1-MONTH        PIC 99.
  1348             20  SLASH1-1              PIC X.
  1349             20  DC-EDIT1-DAY          PIC 99.
  1350             20  SLASH1-2              PIC X.
  1351             20  DC-EDIT1-YEAR         PIC 99.
  1352         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1353         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1354                     DC-GREG-DATE-2-EDIT.
  1355             20  DC-EDIT2-MONTH        PIC 99.
  1356             20  SLASH2-1              PIC X.
  1357             20  DC-EDIT2-DAY          PIC 99.
  1358             20  SLASH2-2              PIC X.
  1359             20  DC-EDIT2-YEAR         PIC 99.
  1360         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1361         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1362                     DC-GREG-DATE-1-YMD.
  1363             20  DC-YMD-YEAR           PIC 99.
  1364             20  DC-YMD-MONTH          PIC 99.
  1365             20  DC-YMD-DAY            PIC 99.
  1366         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1367         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1368                      DC-GREG-DATE-1-MDY.
  1369             20  DC-MDY-MONTH          PIC 99.
  1370             20  DC-MDY-DAY            PIC 99.
  1371             20  DC-MDY-YEAR           PIC 99.
  1372         16  DC-GREG-DATE-1-ALPHA.
  1373             20  DC-ALPHA-MONTH        PIC X(10).
  1374             20  DC-ALPHA-DAY          PIC 99.
  1375             20  FILLER                PIC XX.
  1376             20  DC-ALPHA-CENTURY.
  1377                 24 DC-ALPHA-CEN-N     PIC 99.
  1378             20  DC-ALPHA-YEAR         PIC 99.
  1379         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1380         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1381         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1382         16  DC-JULIAN-DATE            PIC 9(05).
  1383         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  28
* EL152.cbl
  1384                                       PIC 9(05).
  1385         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1386             20  DC-JULIAN-YEAR        PIC 99.
  1387             20  DC-JULIAN-DAYS        PIC 999.
  1388         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1389         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1390         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1391     12  DATE-CONVERSION-VARIBLES.
  1392         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1393         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1394             20  FILLER                PIC 9(3).
  1395             20  HOLD-CEN-1-CCYY.
  1396                 24  HOLD-CEN-1-CC     PIC 99.
  1397                 24  HOLD-CEN-1-YY     PIC 99.
  1398             20  HOLD-CEN-1-MO         PIC 99.
  1399             20  HOLD-CEN-1-DA         PIC 99.
  1400         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1401             20  HOLD-CEN-1-R-MO       PIC 99.
  1402             20  HOLD-CEN-1-R-DA       PIC 99.
  1403             20  HOLD-CEN-1-R-CCYY.
  1404                 24  HOLD-CEN-1-R-CC   PIC 99.
  1405                 24  HOLD-CEN-1-R-YY   PIC 99.
  1406             20  FILLER                PIC 9(3).
  1407         16  HOLD-CENTURY-1-X.
  1408             20  FILLER                PIC X(3)  VALUE SPACES.
  1409             20  HOLD-CEN-1-X-CCYY.
  1410                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1411                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1412             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1413             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1414         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1415             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1416             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1417             20  HOLD-CEN-1-R-X-CCYY.
  1418                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1419                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1420             20  FILLER                PIC XXX.
  1421         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1422         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1423         16  DC-JULIAN-DATE-1          PIC 9(07).
  1424         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1425             20  DC-JULIAN-1-CCYY.
  1426                 24  DC-JULIAN-1-CC    PIC 99.
  1427                 24  DC-JULIAN-1-YR    PIC 99.
  1428             20  DC-JULIAN-DA-1        PIC 999.
  1429         16  DC-JULIAN-DATE-2          PIC 9(07).
  1430         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1431             20  DC-JULIAN-2-CCYY.
  1432                 24  DC-JULIAN-2-CC    PIC 99.
  1433                 24  DC-JULIAN-2-YR    PIC 99.
  1434             20  DC-JULIAN-DA-2        PIC 999.
  1435         16  DC-GREG-DATE-A-EDIT.
  1436             20  DC-EDITA-MONTH        PIC 99.
  1437             20  SLASHA-1              PIC X VALUE '/'.
  1438             20  DC-EDITA-DAY          PIC 99.
  1439             20  SLASHA-2              PIC X VALUE '/'.
  1440             20  DC-EDITA-CCYY.
  1441                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  29
* EL152.cbl
  1442                 24  DC-EDITA-YEAR     PIC 99.
  1443         16  DC-GREG-DATE-B-EDIT.
  1444             20  DC-EDITB-MONTH        PIC 99.
  1445             20  SLASHB-1              PIC X VALUE '/'.
  1446             20  DC-EDITB-DAY          PIC 99.
  1447             20  SLASHB-2              PIC X VALUE '/'.
  1448             20  DC-EDITB-CCYY.
  1449                 24  DC-EDITB-CENT     PIC 99.
  1450                 24  DC-EDITB-YEAR     PIC 99.
  1451         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1452         16  DC-GREG-DATE-CYMD-R REDEFINES
  1453                              DC-GREG-DATE-CYMD.
  1454             20  DC-CYMD-CEN           PIC 99.
  1455             20  DC-CYMD-YEAR          PIC 99.
  1456             20  DC-CYMD-MONTH         PIC 99.
  1457             20  DC-CYMD-DAY           PIC 99.
  1458         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1459         16  DC-GREG-DATE-MDCY-R REDEFINES
  1460                              DC-GREG-DATE-MDCY.
  1461             20  DC-MDCY-MONTH         PIC 99.
  1462             20  DC-MDCY-DAY           PIC 99.
  1463             20  DC-MDCY-CEN           PIC 99.
  1464             20  DC-MDCY-YEAR          PIC 99.
  1465    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1466        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1467    12  DC-EL310-DATE                  PIC X(21).
  1468    12  FILLER                         PIC X(28).
  1469
  1470*                                COPY ELCLOGOF.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ELCLOGOF.                           *
  1475*                            VMOD=2.001                          *
  1476*                                                                *
  1477*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1478*                                                                *
  1479******************************************************************
  1480 01  CLASIC-LOGOFF.
  1481     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1482     12  LOGOFF-TEXT.
  1483         16  FILLER          PIC X(5)    VALUE SPACES.
  1484         16  LOGOFF-MSG.
  1485             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1486             20  FILLER      PIC X       VALUE SPACES.
  1487             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1488         16  FILLER          PIC X(80)
  1489           VALUE '* YOU ARE NOW LOGGED OFF'.
  1490         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1491         16  FILLER          PIC X       VALUE QUOTE.
  1492         16  LOGOFF-SYS-MSG  PIC X(17)
  1493           VALUE 'S CLAS-IC SYSTEM '.
  1494     12  TEXT-MESSAGES.
  1495         16  UNACCESS-MSG    PIC X(29)
  1496             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1497         16  PGMIDERR-MSG    PIC X(17)
  1498             VALUE 'PROGRAM NOT FOUND'.
  1499
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  30
* EL152.cbl
  1501*                                COPY ELCNWA.
  1502*****************************************************************
  1503*                                                               *
  1504*                                                               *
  1505*                            ELCNWA.                            *
  1506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1507*                            VMOD=2.003                         *
  1508*                                                               *
  1509*            M O V E   N A M E   W O R K   A R E A.             *
  1510*                                                               *
  1511*****************************************************************.
  1512
  1513 01  WS-NAME-WORK-AREA.
  1514     05  WS-INSURED-LAST-NAME        PIC X(15).
  1515     05  WS-INSURED-1ST-NAME         PIC X(12).
  1516     05  WS-INSURED-MID-INIT         PIC X.
  1517
  1518     05  WS-NAME-WORK.
  1519         10  WS-NW                   PIC X
  1520             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1521
  1522     05  WS-NAME-WORK2.
  1523         10  WS-NW2                  PIC X
  1524             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1525                                        NWA-INDEX0.
  1526
  1527     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1528                                     COMP-3.
  1529
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  31
* EL152.cbl
  1531*                                COPY ELCATTR.
  1532******************************************************************
  1533*                                                                *
  1534*                            ELCATTR.                            *
  1535*                            VMOD=2.001                          *
  1536*                                                                *
  1537*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1538*                                                                *
  1539*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1540*                                                                *
  1541*                   POS 1   P=PROTECTED                          *
  1542*                           U=UNPROTECTED                        *
  1543*                           S=ASKIP                              *
  1544*                   POS 2   A=ALPHA/NUMERIC                      *
  1545*                           N=NUMERIC                            *
  1546*                   POS 3   N=NORMAL                             *
  1547*                           B=BRIGHT                             *
  1548*                           D=DARK                               *
  1549*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1550*                           OF=MODIFIED DATA TAG OFF             *
  1551*                                                                *
  1552*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1553******************************************************************
  1554 01  ATTRIBUTE-LIST.
  1555     12  AL-PABOF            PIC X       VALUE 'Y'.
  1556     12  AL-PABON            PIC X       VALUE 'Z'.
  1557     12  AL-PADOF            PIC X       VALUE '%'.
  1558     12  AL-PADON            PIC X       VALUE '_'.
  1559     12  AL-PANOF            PIC X       VALUE '-'.
  1560     12  AL-PANON            PIC X       VALUE '/'.
  1561     12  AL-SABOF            PIC X       VALUE '8'.
  1562     12  AL-SABON            PIC X       VALUE '9'.
  1563     12  AL-SADOF            PIC X       VALUE '@'.
  1564     12  AL-SADON            PIC X       VALUE QUOTE.
  1565     12  AL-SANOF            PIC X       VALUE '0'.
  1566     12  AL-SANON            PIC X       VALUE '1'.
  1567     12  AL-UABOF            PIC X       VALUE 'H'.
  1568     12  AL-UABON            PIC X       VALUE 'I'.
  1569     12  AL-UADOF            PIC X       VALUE '<'.
  1570     12  AL-UADON            PIC X       VALUE '('.
  1571     12  AL-UANOF            PIC X       VALUE ' '.
  1572     12  AL-UANON            PIC X       VALUE 'A'.
  1573     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1574     12  AL-UNBON            PIC X       VALUE 'R'.
  1575     12  AL-UNDOF            PIC X       VALUE '*'.
  1576     12  AL-UNDON            PIC X       VALUE ')'.
  1577     12  AL-UNNOF            PIC X       VALUE '&'.
  1578     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  32
* EL152.cbl
  1580*                                COPY ELCEMIB.
  1581******************************************************************
  1582*                                                                *
  1583*                                                                *
  1584*                            ELCEMIB.                            *
  1585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1586*                            VMOD=2.005                          *
  1587*                                                                *
  1588*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1589*                                                                *
  1590******************************************************************
  1591 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1592     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1593     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1594     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1595     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1596     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1597     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1598     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1599     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1600     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1601         88  EMI-NO-ERRORS                    VALUE '1'.
  1602         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1603         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1604     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1605         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1606     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1607         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1608         88  EMI-AREA1-FULL                   VALUE '2'.
  1609     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1610         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1611         88  EMI-AREA2-FULL                   VALUE '2'.
  1612     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1613         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1614         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1615         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1616         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1617         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1618     12  EMI-ERROR-LINES.
  1619         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1620         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1621         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1622         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1623             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1624                 24  EMI-ERR-NUM         PIC X(4).
  1625                 24  EMI-FILLER          PIC X.
  1626                 24  EMI-SEV             PIC X.
  1627                 24  FILLER              PIC X.
  1628             20  FILLER                  PIC X(02).
  1629     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1630         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1631             20  EMI-ERROR-NUMBER    PIC X(4).
  1632             20  EMI-FILL            PIC X.
  1633             20  EMI-SEVERITY        PIC X.
  1634             20  FILLER              PIC X.
  1635             20  EMI-ERROR-TEXT.
  1636                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1637                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  33
* EL152.cbl
  1638     12  EMI-SEVERITY-SAVE           PIC X.
  1639         88  EMI-NOTE                    VALUE 'N'.
  1640         88  EMI-WARNING                 VALUE 'W'.
  1641         88  EMI-FORCABLE                VALUE 'F'.
  1642         88  EMI-FATAL                   VALUE 'X'.
  1643     12  EMI-MESSAGE-FLAG            PIC X.
  1644         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1645         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1646     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1647     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1648         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1649         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1650         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1651     12  emi-claim-no                pic x(7).
  1652     12  emi-claim-type              pic x(6).
  1653     12  FILLER                      PIC X(124)  VALUE SPACES.
  1654     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1655     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1656     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1657     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1658 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  34
* EL152.cbl
  1660*                                COPY ELCINTF.
  1661******************************************************************
  1662*                                                                *
  1663*                                                                *
  1664*                            ELCINTF.                            *
  1665*                            VMOD=2.017                          *
  1666*                                                                *
  1667*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1668*                                                                *
  1669*       LENGTH = 1024                                            *
  1670*                                                                *
  1671******************************************************************
  1672*                   C H A N G E   L O G
  1673*
  1674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1675*-----------------------------------------------------------------
  1676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1677* EFFECTIVE    NUMBER
  1678*-----------------------------------------------------------------
  1679* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1680******************************************************************
  1681 01  PROGRAM-INTERFACE-BLOCK.
  1682     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1683     12  PI-CALLING-PROGRAM              PIC X(8).
  1684     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1685     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1686     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1687     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1688     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1689     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1690     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1691     12  PI-COMPANY-ID                   PIC XXX.
  1692     12  PI-COMPANY-CD                   PIC X.
  1693
  1694     12  PI-COMPANY-PASSWORD             PIC X(8).
  1695
  1696     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1697
  1698     12  PI-CONTROL-IN-PROGRESS.
  1699         16  PI-CARRIER                  PIC X.
  1700         16  PI-GROUPING                 PIC X(6).
  1701         16  PI-STATE                    PIC XX.
  1702         16  PI-ACCOUNT                  PIC X(10).
  1703         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1704                                         PIC X(10).
  1705         16  PI-CLAIM-CERT-GRP.
  1706             20  PI-CLAIM-NO             PIC X(7).
  1707             20  PI-CERT-NO.
  1708                 25  PI-CERT-PRIME       PIC X(10).
  1709                 25  PI-CERT-SFX         PIC X.
  1710             20  PI-CERT-EFF-DT          PIC XX.
  1711         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1712             20  PI-PLAN-CODE            PIC X(2).
  1713             20  PI-REVISION-NUMBER      PIC X(3).
  1714             20  PI-PLAN-EFF-DT          PIC X(2).
  1715             20  PI-PLAN-EXP-DT          PIC X(2).
  1716             20  FILLER                  PIC X(11).
  1717         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  35
* EL152.cbl
  1718             20  PI-OE-REFERENCE-1.
  1719                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1720                 25  PI-OE-REF-1-SUFF    PIC XX.
  1721
  1722     12  PI-SESSION-IN-PROGRESS          PIC X.
  1723         88  CLAIM-SESSION                   VALUE '1'.
  1724         88  CREDIT-SESSION                  VALUE '2'.
  1725         88  WARRANTY-SESSION                VALUE '3'.
  1726         88  MORTGAGE-SESSION                VALUE '4'.
  1727         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1728
  1729
  1730*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1731
  1732     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1733     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1734
  1735     12  PI-CREDIT-USER                  PIC X.
  1736         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1737         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1738
  1739     12  PI-CLAIM-USER                   PIC X.
  1740         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1741         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1742
  1743     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1744         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1745         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1746         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1747         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1748         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1749
  1750     12  PI-PROCESSOR-ID                 PIC X(4).
  1751
  1752     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1753
  1754     12  PI-MEMBER-CAPTION               PIC X(10).
  1755
  1756     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1757         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1758
  1759     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1760     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1761     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1762     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1763
  1764     12  PI-AH-OVERRIDE-L1               PIC X.
  1765     12  PI-AH-OVERRIDE-L2               PIC XX.
  1766     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1767     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1768
  1769     12  PI-NEW-SYSTEM                   PIC X(2).
  1770
  1771     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1772     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1773         88  PI-USES-PAID-TO                 VALUE '1'.
  1774     12  PI-CRDTCRD-SYSTEM.
  1775         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  36
* EL152.cbl
  1776             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1777             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1778         16  PI-CC-MONTH-END-DT          PIC XX.
  1779     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1780
  1781     12  PI-OE-REFERENCE-2.
  1782         16  PI-OE-REF-2-PRIME           PIC X(10).
  1783         16  PI-OE-REF-2-SUFF            PIC X.
  1784
  1785     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1786
  1787     12  PI-LANGUAGE-TYPE                PIC X.
  1788             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1789             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1790             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1791
  1792     12  PI-POLICY-LINKAGE-IND           PIC X.
  1793         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1794         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1795                                                   LOW-VALUES.
  1796
  1797     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1798     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1799         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1800         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1801
  1802     12  PI-PROCESSOR-CSR-IND            PIC X.
  1803         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1804         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1805
  1806     12  FILLER                          PIC X(3).
  1807
  1808     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1809
  1810     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1811         PI-SYSTEM-LEVEL.
  1812
  1813         16  PI-ENTRY-CODES.
  1814             20  PI-ENTRY-CD-1           PIC X.
  1815             20  PI-ENTRY-CD-2           PIC X.
  1816
  1817         16  PI-RETURN-CODES.
  1818             20  PI-RETURN-CD-1          PIC X.
  1819             20  PI-RETURN-CD-2          PIC X.
  1820
  1821         16  PI-UPDATE-STATUS-SAVE.
  1822             20  PI-UPDATE-BY            PIC X(4).
  1823             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1824
  1825         16  PI-LOWER-CASE-LETTERS       PIC X.
  1826             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1827
  1828*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1829*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1830*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1831
  1832         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1833             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  37
* EL152.cbl
  1834             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1835             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1836             88  ACCNT-CNTL                  VALUE '3'.
  1837             88  CARR-ACCNT-CNTL             VALUE '4'.
  1838
  1839         16  PI-PROCESSOR-CAP-LIST.
  1840             20  PI-SYSTEM-CONTROLS.
  1841                24 PI-SYSTEM-DISPLAY     PIC X.
  1842                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1843                24 PI-SYSTEM-MODIFY      PIC X.
  1844                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1845             20  FILLER                  PIC XX.
  1846             20  PI-DISPLAY-CAP          PIC X.
  1847                 88  DISPLAY-CAP             VALUE 'Y'.
  1848             20  PI-MODIFY-CAP           PIC X.
  1849                 88  MODIFY-CAP              VALUE 'Y'.
  1850             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1851                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1852             20  PI-FORCE-CAP            PIC X.
  1853                 88  FORCE-CAP               VALUE 'Y'.
  1854
  1855         16  PI-PROGRAM-CONTROLS.
  1856             20  PI-PGM-PRINT-OPT        PIC X.
  1857             20  PI-PGM-FORMAT-OPT       PIC X.
  1858             20  PI-PGM-PROCESS-OPT      PIC X.
  1859             20  PI-PGM-TOTALS-OPT       PIC X.
  1860
  1861         16  PI-HELP-INTERFACE.
  1862             20  PI-LAST-ERROR-NO        PIC X(4).
  1863             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1864
  1865         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1866             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1867
  1868         16  PI-CR-CONTROL-IN-PROGRESS.
  1869             20  PI-CR-CARRIER           PIC X.
  1870             20  PI-CR-GROUPING          PIC X(6).
  1871             20  PI-CR-STATE             PIC XX.
  1872             20  PI-CR-ACCOUNT           PIC X(10).
  1873             20  PI-CR-FIN-RESP          PIC X(10).
  1874             20  PI-CR-TYPE              PIC X.
  1875
  1876         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1877
  1878         16  PI-CR-MONTH-END-DT          PIC XX.
  1879
  1880         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1881             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1882             88  PI-ZERO-CARRIER             VALUE '1'.
  1883             88  PI-ZERO-GROUPING            VALUE '2'.
  1884             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1885
  1886         16  PI-CARRIER-SECURITY         PIC X.
  1887             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1888
  1889         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1890             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1891             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  38
* EL152.cbl
  1892
  1893         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1894             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1895                                         INDEXED BY PI-ACCESS-NDX
  1896                                         PIC X.
  1897
  1898         16  PI-GA-BILLING-CONTROL       PIC X.
  1899             88  PI-GA-BILLING               VALUE '1'.
  1900
  1901         16  PI-MAIL-PROCESSING          PIC X.
  1902             88  PI-MAIL-YES                 VALUE 'Y'.
  1903
  1904         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1905
  1906         16  PI-AR-SYSTEM.
  1907             20  PI-AR-PROCESSING-CNTL   PIC X.
  1908                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1909             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1910             20  PI-AR-MONTH-END-DT      PIC XX.
  1911
  1912         16  PI-MP-SYSTEM.
  1913             20  PI-MORTGAGE-USER            PIC X.
  1914                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1915                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1916             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1917                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1918                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1919                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1920                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1921                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1922             20  PI-MP-MONTH-END-DT          PIC XX.
  1923             20  PI-MP-REFERENCE-NO.
  1924                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1925                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1926
  1927         16  PI-LABEL-CONTROL            PIC X(01).
  1928             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1929             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1930
  1931         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1932             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1933
  1934         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1935             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1936             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1937
  1938         16  FILLER                      PIC X(14).
  1939
  1940     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1941******************************************************************
  1942     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1943*        COPY ELC1042.
  1944******************************************************************
  1945*                                                                *
  1946*                                                                *
  1947*                           ELC1042                              *
  1948*                            VMOD=2.002                          *
  1949*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  39
* EL152.cbl
  1950*    NOTE                                                        *
  1951*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1952*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1953*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1954*        TO THESE PROGRAMS.                                      *
  1955*                                                                *
  1956*    NOTE                                                        *
  1957*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1958*        USE ONLY!                                               *
  1959*                                                                *
  1960******************************************************************
  1961
  1962         16  PI-1042-WA.
  1963             20  PI-ACTION       PIC  X(01).
  1964                 88 PI-SHOW-MODE           VALUE '1'.
  1965                 88 PI-CLEAR-MODE          VALUE '2'.
  1966                 88 PI-CREATE-MODE         VALUE '3'.
  1967             20  PI-COMM-CONTROL PIC  X(12).
  1968             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1969             20  PI-EOF-SW       PIC  X(01).
  1970                 88  PI-FILE-EOF           VALUE 'Y'.
  1971             20  PI-FILETYP      PIC  X(01).
  1972             20  PI-FORM-SQUEEZE-CONTROL
  1973                                 PIC  X(01).
  1974                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1975                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1976             20  PI-LAST-CONTROL PIC  X(12).
  1977             20  PI-TEMP-STOR-ITEMS
  1978                                 PIC S9(04) COMP.
  1979             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1980             20  PI-UPDATE-SW    PIC  9(01).
  1981                 88 ANY-UPDATES            VALUE 1.
  1982             20  PI-104-SCREEN-SENT-IND
  1983                                 PIC  X(01).
  1984                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1985                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1986             20  PI-1042-SCREEN-SENT-IND
  1987                                 PIC  X(01).
  1988                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1989                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1990             20  PI-1042-ARCHIVE-IND
  1991                                 PIC  X(01).
  1992                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1993             20  FILLER          PIC  X(29).
  1994**********************************************************
  1995*    NOTE                                                *
  1996*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1997*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1998*        BOTH PROGRAMS.                                  *
  1999*                                                        *
  2000**********************************************************
  2001         16  PI-EL152-WA.
  2002             20  PI-ALT-PRINTER-ID        PIC X(4).
  2003             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  2004             20  PI-FORM-NUMBER           PIC X(4).
  2005             20  PI-ADDR-TYPE             PIC XX.
  2006             20  PI-TEMP-STOR-ID          PIC X(8).
  2007             20  PI-NUM-PRINT-COPIES      PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  40
* EL152.cbl
  2008             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  2009             20  PI-PRINT-SW              PIC X.
  2010                 88 PRINT-PERFORMED  VALUE '1'.
  2011             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  2012             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  2013             20  PI-PROMPT-LETTER         PIC X.
  2014             20  PI-ENCLOSURE-CD          PIC X(3).
  2015             20  PI-AUTO-CLOSE-IND        PIC X(1).
  2016             20  PI-LETTER-TO-BENE        PIC X(1).
  2017             20  PI-FILLER                PIC X(528).
  2018             20  PI-FORCE-7840            PIC X.
  2019                 88 FORCE-7840       VALUE '1'.
  2020
  2021             20  PI-BSR-LETTER-IND        PIC XX.
  2022                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  2023             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  2024                 22  PI-ELLETR-BSR        PIC X.
  2025                 22  PI-ELBENE-BSR        PIC X.
  2026
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  41
* EL152.cbl
  2028*                            COPY DFHBMSCA.
  2029*****************************************************************
  2030*                                                               *
  2031* Copyright (c) 2007-2013 Dell Inc.                             *
  2032* All rights reserved.                                          *
  2033*                                                               *
  2034*****************************************************************
  2035 01    DFHBMSCA.
  2036*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2037*                                             DATA TAG
  2038*
  2039*        DFHBMUNP  Unprotected   Normal       Off
  2040     02  DFHBMUNP PIC X VALUE SPACE.
  2041*        DFHBMUNN  Numeric       Normal       Off
  2042     02  DFHBMUNN PIC X VALUE "&".
  2043*        DFHBMPRO  Protected     Normal       Off
  2044     02  DFHBMPRO PIC X VALUE "-".
  2045*        DFHBMASK  Autoskip      Normal       Off
  2046     02  DFHBMASK PIC X VALUE "0".
  2047*************************************************
  2048*        DFHBMBRY  Unprotected   Bright       Off
  2049     02  DFHBMBRY PIC X VALUE "H".
  2050*        DFHPROTI  Protected     Bright       Off
  2051     02  DFHPROTI PIC X VALUE "Y".
  2052*        DFHBMASB  Autoskip      Bright       Off
  2053     02  DFHBMASB PIC X VALUE "8".
  2054*************************************************
  2055*        DFHBMDAR  Unprotected   Non-Display  Off
  2056     02  DFHBMDAR PIC X VALUE "<".
  2057*        DFHPROTN  Protected     Non-Display  Off
  2058     02  DFHPROTN PIC X VALUE "%".
  2059*************************************************
  2060*        DFHBMFSE  Unprotected   Normal       On
  2061     02  DFHBMFSE PIC X VALUE "A".
  2062*        DFHBMASF  Autoskip      Normal       On
  2063     02  DFHBMASF  PIC X VALUE "1".
  2064*        DFHUNNUM  Numeric       Normal       On
  2065     02  DFHUNNUM PIC X VALUE "J".
  2066*        DFHBMPRF  Protected     Normal       On
  2067     02  DFHBMPRF PIC X VALUE "/".
  2068*************************************************
  2069*        DFHUNIMD  Unprotected   Bright       On
  2070     02  DFHUNIMD PIC X VALUE "I".
  2071*        DFHUNINT  Numeric       Bright       On
  2072     02  DFHUNINT PIC X VALUE "R".
  2073*************************************************
  2074*        DFHUNNOD  Unprotected   Non-Display  On
  2075     02  DFHUNNOD PIC X VALUE "(".
  2076*        DFHUNNON  Numeric       Non-Display  On
  2077     02  DFHUNNON PIC X VALUE ")".
  2078*************************************************
  2079*
  2080*     COLOURS
  2081*
  2082     02  DFHDFCOL PIC X VALUE X"00".
  2083     02  DFHBLUE  PIC X VALUE "1".
  2084     02  DFHRED   PIC X VALUE "2".
  2085     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  42
* EL152.cbl
  2086     02  DFHGREEN PIC X VALUE "4".
  2087     02  DFHTURQ  PIC X VALUE "5".
  2088     02  DFHYELLO PIC X VALUE "6".
  2089     02  DFHNEUTR PIC X VALUE "7".
  2090     02  DFH3270  PIC X VALUE "{".
  2091     02  DFHALL   PIC X VALUE LOW-VALUE.
  2092     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2093     02  DFHBLINK PIC X VALUE "1".
  2094     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2095     02  DFHBMEOF PIC X VALUE X"80".
  2096     02  DFHBMPEM PIC X VALUE X"19".
  2097* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2098     02  DFHBMPNL PIC X VALUE X"0A".
  2099     02  DFHCOLOR PIC X VALUE "!".
  2100     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2101     02  DFHDFT   PIC X VALUE X"FF".
  2102     02  DFHERROR PIC X VALUE X"1A".
  2103     02  DFHHLT   PIC X VALUE " ".
  2104     02  DFHMENT  PIC X VALUE X"02".
  2105     02  DFHBMCUR  PIC X VALUE X"02".
  2106     02  DFHBMFLG  PIC X.
  2107         88 DFHCURSR VALUES ARE X"02" , X"82".
  2108     02  DFHMET   PIC X VALUE X"03".
  2109     02  DFHMFE   PIC X VALUE X"06".
  2110     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2111     02  DFHMFIL  PIC X VALUE X"1C".
  2112     02  DFHMFT   PIC X VALUE X"09".
  2113     02  DFHMT    PIC X VALUE X"01".
  2114     02  DFHPS    PIC X VALUE '"'.
  2115     02  DFHREVRS PIC X VALUE "2".
  2116     02  DFHSA    PIC X VALUE X"08".
  2117     02  DFHUNDLN PIC X VALUE "4".
  2118     02  DFHVAL   PIC X VALUE "A".
  2119     02  DFHLEFT  PIC X VALUE X"97".
  2120     02  DFHOVER  PIC X VALUE X"9C".
  2121     02  DFHRIGHT PIC X VALUE X"02".
  2122     02  DFHUNDER PIC X VALUE X"01".
  2123     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2124     02  FILLER REDEFINES DFHBOX-BIN.
  2125         03  FILLER PIC X.
  2126         03  DFHBOX PIC X.
  2127     02  DFHSOSI  PIC X VALUE X"01".
  2128     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2129     02  FILLER REDEFINES DFHBMPSO-BIN.
  2130         03 DFHBMPSO  PIC X.
  2131         03 DFHBMPSI  PIC X.
  2132     02  DFHBMEC  PIC X VALUE X"82".
  2133*    02  DFHDFFR  PIC X VALUE X"00".
  2134*    02  DFHOPAQ  PIC X VALUE X"00".
  2135*    02  DFHOUTLN PIC X VALUE X"00".
  2136*    02  DFHTRANS PIC X VALUE X"00".
  2137*    02  DFHBKTRN PIC X VALUE X"00".
  2138*                            COPY ELCAID.
  2139******************************************************************
  2140*                                                                *
  2141*                            ELCAID.                             *
  2142*                            VMOD=2.001                          *
  2143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  43
* EL152.cbl
  2144*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2145*                                                                *
  2146*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2147*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2148******************************************************************
  2149
  2150 01  DFHAID.
  2151   02  DFHNULL   PIC  X  VALUE  ' '.
  2152   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2153   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2154   02  DFHPEN    PIC  X  VALUE  '='.
  2155   02  DFHOPID   PIC  X  VALUE  'W'.
  2156   02  DFHPA1    PIC  X  VALUE  '%'.
  2157   02  DFHPA2    PIC  X  VALUE  '>'.
  2158   02  DFHPA3    PIC  X  VALUE  ','.
  2159   02  DFHPF1    PIC  X  VALUE  '1'.
  2160   02  DFHPF2    PIC  X  VALUE  '2'.
  2161   02  DFHPF3    PIC  X  VALUE  '3'.
  2162   02  DFHPF4    PIC  X  VALUE  '4'.
  2163   02  DFHPF5    PIC  X  VALUE  '5'.
  2164   02  DFHPF6    PIC  X  VALUE  '6'.
  2165   02  DFHPF7    PIC  X  VALUE  '7'.
  2166   02  DFHPF8    PIC  X  VALUE  '8'.
  2167   02  DFHPF9    PIC  X  VALUE  '9'.
  2168   02  DFHPF10   PIC  X  VALUE  ':'.
  2169   02  DFHPF11   PIC  X  VALUE  '#'.
  2170   02  DFHPF12   PIC  X  VALUE  '@'.
  2171   02  DFHPF13   PIC  X  VALUE  'A'.
  2172   02  DFHPF14   PIC  X  VALUE  'B'.
  2173   02  DFHPF15   PIC  X  VALUE  'C'.
  2174   02  DFHPF16   PIC  X  VALUE  'D'.
  2175   02  DFHPF17   PIC  X  VALUE  'E'.
  2176   02  DFHPF18   PIC  X  VALUE  'F'.
  2177   02  DFHPF19   PIC  X  VALUE  'G'.
  2178   02  DFHPF20   PIC  X  VALUE  'H'.
  2179   02  DFHPF21   PIC  X  VALUE  'I'.
  2180*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2181   02  DFHPF22   PIC  X  VALUE  '['.
  2182   02  DFHPF23   PIC  X  VALUE  '.'.
  2183   02  DFHPF24   PIC  X  VALUE  '<'.
  2184   02  DFHMSRE   PIC  X  VALUE  'X'.
  2185   02  DFHSTRF   PIC  X  VALUE  'h'.
  2186   02  DFHTRIG   PIC  X  VALUE  '"'.
  2187 01  FILLER    REDEFINES DFHAID.
  2188     12  FILLER              PIC X(8).
  2189     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  44
* EL152.cbl
  2191*                            COPY EL152S.
  2192 01  EL152AI.
  2193     05  FILLER            PIC  X(0012).
  2194*    -------------------------------
  2195     05  DATEAL PIC S9(0004) COMP.
  2196     05  DATEAF PIC  X(0001).
  2197     05  FILLER REDEFINES DATEAF.
  2198         10  DATEAA PIC  X(0001).
  2199     05  DATEAI PIC  X(0008).
  2200*    -------------------------------
  2201     05  TIMEAL PIC S9(0004) COMP.
  2202     05  TIMEAF PIC  X(0001).
  2203     05  FILLER REDEFINES TIMEAF.
  2204         10  TIMEAA PIC  X(0001).
  2205     05  TIMEAI PIC  X(0005).
  2206*    -------------------------------
  2207     05  CARRL PIC S9(0004) COMP.
  2208     05  CARRF PIC  X(0001).
  2209     05  FILLER REDEFINES CARRF.
  2210         10  CARRA PIC  X(0001).
  2211     05  CARRI PIC  X(0001).
  2212*    -------------------------------
  2213     05  CLMNOL PIC S9(0004) COMP.
  2214     05  CLMNOF PIC  X(0001).
  2215     05  FILLER REDEFINES CLMNOF.
  2216         10  CLMNOA PIC  X(0001).
  2217     05  CLMNOI PIC  X(0007).
  2218*    -------------------------------
  2219     05  CRTNOL PIC S9(0004) COMP.
  2220     05  CRTNOF PIC  X(0001).
  2221     05  FILLER REDEFINES CRTNOF.
  2222         10  CRTNOA PIC  X(0001).
  2223     05  CRTNOI PIC  X(0011).
  2224*    -------------------------------
  2225     05  PROCL PIC S9(0004) COMP.
  2226     05  PROCF PIC  X(0001).
  2227     05  FILLER REDEFINES PROCF.
  2228         10  PROCA PIC  X(0001).
  2229     05  PROCI PIC  X(0004).
  2230*    -------------------------------
  2231     05  COMPIDL PIC S9(0004) COMP.
  2232     05  COMPIDF PIC  X(0001).
  2233     05  FILLER REDEFINES COMPIDF.
  2234         10  COMPIDA PIC  X(0001).
  2235     05  COMPIDI PIC  X(0003).
  2236*    -------------------------------
  2237     05  CLEANL PIC S9(0004) COMP.
  2238     05  CLEANF PIC  X(0001).
  2239     05  FILLER REDEFINES CLEANF.
  2240         10  CLEANA PIC  X(0001).
  2241     05  CLEANI PIC  X(0001).
  2242*    -------------------------------
  2243     05  SYSL PIC S9(0004) COMP.
  2244     05  SYSF PIC  X(0001).
  2245     05  FILLER REDEFINES SYSF.
  2246         10  SYSA PIC  X(0001).
  2247     05  SYSI PIC  X(0008).
  2248*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  45
* EL152.cbl
  2249     05  MAINTL PIC S9(0004) COMP.
  2250     05  MAINTF PIC  X(0001).
  2251     05  FILLER REDEFINES MAINTF.
  2252         10  MAINTA PIC  X(0001).
  2253     05  MAINTI PIC  X(0001).
  2254*    -------------------------------
  2255     05  ARCHNUML PIC S9(0004) COMP.
  2256     05  ARCHNUMF PIC  X(0001).
  2257     05  FILLER REDEFINES ARCHNUMF.
  2258         10  ARCHNUMA PIC  X(0001).
  2259     05  ARCHNUMI PIC  99999999.
  2260*    -------------------------------
  2261     05  FORML PIC S9(0004) COMP.
  2262     05  FORMF PIC  X(0001).
  2263     05  FILLER REDEFINES FORMF.
  2264         10  FORMA PIC  X(0001).
  2265     05  FORMI PIC  X(0004).
  2266*    -------------------------------
  2267     05  FOLLOWL PIC S9(0004) COMP.
  2268     05  FOLLOWF PIC  X(0001).
  2269     05  FILLER REDEFINES FOLLOWF.
  2270         10  FOLLOWA PIC  X(0001).
  2271     05  FOLLOWI PIC  X(0008).
  2272*    -------------------------------
  2273     05  RESENDL PIC S9(0004) COMP.
  2274     05  RESENDF PIC  X(0001).
  2275     05  FILLER REDEFINES RESENDF.
  2276         10  RESENDA PIC  X(0001).
  2277     05  RESENDI PIC  X(0008).
  2278*    -------------------------------
  2279     05  PRINTL PIC S9(0004) COMP.
  2280     05  PRINTF PIC  X(0001).
  2281     05  FILLER REDEFINES PRINTF.
  2282         10  PRINTA PIC  X(0001).
  2283     05  PRINTI PIC  X(0001).
  2284*    -------------------------------
  2285     05  COPIESL PIC S9(0004) COMP.
  2286     05  COPIESF PIC  X(0001).
  2287     05  FILLER REDEFINES COPIESF.
  2288         10  COPIESA PIC  X(0001).
  2289     05  COPIESI PIC  X(0001).
  2290*    -------------------------------
  2291     05  ENCL PIC S9(0004) COMP.
  2292     05  ENCF PIC  X(0001).
  2293     05  FILLER REDEFINES ENCF.
  2294         10  ENCA PIC  X(0001).
  2295     05  ENCI PIC  X(0003).
  2296*    -------------------------------
  2297     05  ADDRL PIC S9(0004) COMP.
  2298     05  ADDRF PIC  X(0001).
  2299     05  FILLER REDEFINES ADDRF.
  2300         10  ADDRA PIC  X(0001).
  2301     05  ADDRI PIC  X(0002).
  2302*    -------------------------------
  2303     05  ACTL PIC S9(0004) COMP.
  2304     05  ACTF PIC  X(0001).
  2305     05  FILLER REDEFINES ACTF.
  2306         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  46
* EL152.cbl
  2307     05  ACTI PIC  X(0001).
  2308*    -------------------------------
  2309     05  BENL PIC S9(0004) COMP.
  2310     05  BENF PIC  X(0001).
  2311     05  FILLER REDEFINES BENF.
  2312         10  BENA PIC  X(0001).
  2313     05  BENI PIC  X(0001).
  2314*    -------------------------------
  2315     05  EMPL PIC S9(0004) COMP.
  2316     05  EMPF PIC  X(0001).
  2317     05  FILLER REDEFINES EMPF.
  2318         10  EMPA PIC  X(0001).
  2319     05  EMPI PIC  X(0001).
  2320*    -------------------------------
  2321     05  INSL PIC S9(0004) COMP.
  2322     05  INSF PIC  X(0001).
  2323     05  FILLER REDEFINES INSF.
  2324         10  INSA PIC  X(0001).
  2325     05  INSI PIC  X(0001).
  2326*    -------------------------------
  2327     05  PHYSL PIC S9(0004) COMP.
  2328     05  PHYSF PIC  X(0001).
  2329     05  FILLER REDEFINES PHYSF.
  2330         10  PHYSA PIC  X(0001).
  2331     05  PHYSI PIC  X(0001).
  2332*    -------------------------------
  2333     05  OTHR1L PIC S9(0004) COMP.
  2334     05  OTHR1F PIC  X(0001).
  2335     05  FILLER REDEFINES OTHR1F.
  2336         10  OTHR1A PIC  X(0001).
  2337     05  OTHR1I PIC  X(0001).
  2338*    -------------------------------
  2339     05  OTHR2L PIC S9(0004) COMP.
  2340     05  OTHR2F PIC  X(0001).
  2341     05  FILLER REDEFINES OTHR2F.
  2342         10  OTHR2A PIC  X(0001).
  2343     05  OTHR2I PIC  X(0001).
  2344*    -------------------------------
  2345     05  REL PIC S9(0004) COMP.
  2346     05  REF PIC  X(0001).
  2347     05  FILLER REDEFINES REF.
  2348         10  REA PIC  X(0001).
  2349     05  REI PIC  X(0070).
  2350*    -------------------------------
  2351     05  L1L PIC S9(0004) COMP.
  2352     05  L1F PIC  X(0001).
  2353     05  FILLER REDEFINES L1F.
  2354         10  L1A PIC  X(0001).
  2355     05  L1I PIC  X(0003).
  2356*    -------------------------------
  2357     05  TEXT1L PIC S9(0004) COMP.
  2358     05  TEXT1F PIC  X(0001).
  2359     05  FILLER REDEFINES TEXT1F.
  2360         10  TEXT1A PIC  X(0001).
  2361     05  TEXT1I PIC  X(0070).
  2362*    -------------------------------
  2363     05  L2L PIC S9(0004) COMP.
  2364     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  47
* EL152.cbl
  2365     05  FILLER REDEFINES L2F.
  2366         10  L2A PIC  X(0001).
  2367     05  L2I PIC  X(0003).
  2368*    -------------------------------
  2369     05  TEXT2L PIC S9(0004) COMP.
  2370     05  TEXT2F PIC  X(0001).
  2371     05  FILLER REDEFINES TEXT2F.
  2372         10  TEXT2A PIC  X(0001).
  2373     05  TEXT2I PIC  X(0070).
  2374*    -------------------------------
  2375     05  L3L PIC S9(0004) COMP.
  2376     05  L3F PIC  X(0001).
  2377     05  FILLER REDEFINES L3F.
  2378         10  L3A PIC  X(0001).
  2379     05  L3I PIC  X(0003).
  2380*    -------------------------------
  2381     05  TEXT3L PIC S9(0004) COMP.
  2382     05  TEXT3F PIC  X(0001).
  2383     05  FILLER REDEFINES TEXT3F.
  2384         10  TEXT3A PIC  X(0001).
  2385     05  TEXT3I PIC  X(0070).
  2386*    -------------------------------
  2387     05  L4L PIC S9(0004) COMP.
  2388     05  L4F PIC  X(0001).
  2389     05  FILLER REDEFINES L4F.
  2390         10  L4A PIC  X(0001).
  2391     05  L4I PIC  X(0003).
  2392*    -------------------------------
  2393     05  TEXT4L PIC S9(0004) COMP.
  2394     05  TEXT4F PIC  X(0001).
  2395     05  FILLER REDEFINES TEXT4F.
  2396         10  TEXT4A PIC  X(0001).
  2397     05  TEXT4I PIC  X(0070).
  2398*    -------------------------------
  2399     05  L5L PIC S9(0004) COMP.
  2400     05  L5F PIC  X(0001).
  2401     05  FILLER REDEFINES L5F.
  2402         10  L5A PIC  X(0001).
  2403     05  L5I PIC  X(0003).
  2404*    -------------------------------
  2405     05  TEXT5L PIC S9(0004) COMP.
  2406     05  TEXT5F PIC  X(0001).
  2407     05  FILLER REDEFINES TEXT5F.
  2408         10  TEXT5A PIC  X(0001).
  2409     05  TEXT5I PIC  X(0070).
  2410*    -------------------------------
  2411     05  L6L PIC S9(0004) COMP.
  2412     05  L6F PIC  X(0001).
  2413     05  FILLER REDEFINES L6F.
  2414         10  L6A PIC  X(0001).
  2415     05  L6I PIC  X(0003).
  2416*    -------------------------------
  2417     05  TEXT6L PIC S9(0004) COMP.
  2418     05  TEXT6F PIC  X(0001).
  2419     05  FILLER REDEFINES TEXT6F.
  2420         10  TEXT6A PIC  X(0001).
  2421     05  TEXT6I PIC  X(0070).
  2422*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  48
* EL152.cbl
  2423     05  L7L PIC S9(0004) COMP.
  2424     05  L7F PIC  X(0001).
  2425     05  FILLER REDEFINES L7F.
  2426         10  L7A PIC  X(0001).
  2427     05  L7I PIC  X(0003).
  2428*    -------------------------------
  2429     05  TEXT7L PIC S9(0004) COMP.
  2430     05  TEXT7F PIC  X(0001).
  2431     05  FILLER REDEFINES TEXT7F.
  2432         10  TEXT7A PIC  X(0001).
  2433     05  TEXT7I PIC  X(0070).
  2434*    -------------------------------
  2435     05  L8L PIC S9(0004) COMP.
  2436     05  L8F PIC  X(0001).
  2437     05  FILLER REDEFINES L8F.
  2438         10  L8A PIC  X(0001).
  2439     05  L8I PIC  X(0003).
  2440*    -------------------------------
  2441     05  TEXT8L PIC S9(0004) COMP.
  2442     05  TEXT8F PIC  X(0001).
  2443     05  FILLER REDEFINES TEXT8F.
  2444         10  TEXT8A PIC  X(0001).
  2445     05  TEXT8I PIC  X(0070).
  2446*    -------------------------------
  2447     05  L9L PIC S9(0004) COMP.
  2448     05  L9F PIC  X(0001).
  2449     05  FILLER REDEFINES L9F.
  2450         10  L9A PIC  X(0001).
  2451     05  L9I PIC  X(0003).
  2452*    -------------------------------
  2453     05  TEXT9L PIC S9(0004) COMP.
  2454     05  TEXT9F PIC  X(0001).
  2455     05  FILLER REDEFINES TEXT9F.
  2456         10  TEXT9A PIC  X(0001).
  2457     05  TEXT9I PIC  X(0070).
  2458*    -------------------------------
  2459     05  L10L PIC S9(0004) COMP.
  2460     05  L10F PIC  X(0001).
  2461     05  FILLER REDEFINES L10F.
  2462         10  L10A PIC  X(0001).
  2463     05  L10I PIC  X(0003).
  2464*    -------------------------------
  2465     05  TEXT10L PIC S9(0004) COMP.
  2466     05  TEXT10F PIC  X(0001).
  2467     05  FILLER REDEFINES TEXT10F.
  2468         10  TEXT10A PIC  X(0001).
  2469     05  TEXT10I PIC  X(0070).
  2470*    -------------------------------
  2471     05  L11L PIC S9(0004) COMP.
  2472     05  L11F PIC  X(0001).
  2473     05  FILLER REDEFINES L11F.
  2474         10  L11A PIC  X(0001).
  2475     05  L11I PIC  X(0003).
  2476*    -------------------------------
  2477     05  TEXT11L PIC S9(0004) COMP.
  2478     05  TEXT11F PIC  X(0001).
  2479     05  FILLER REDEFINES TEXT11F.
  2480         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  49
* EL152.cbl
  2481     05  TEXT11I PIC  X(0070).
  2482*    -------------------------------
  2483     05  L12L PIC S9(0004) COMP.
  2484     05  L12F PIC  X(0001).
  2485     05  FILLER REDEFINES L12F.
  2486         10  L12A PIC  X(0001).
  2487     05  L12I PIC  X(0003).
  2488*    -------------------------------
  2489     05  TEXT12L PIC S9(0004) COMP.
  2490     05  TEXT12F PIC  X(0001).
  2491     05  FILLER REDEFINES TEXT12F.
  2492         10  TEXT12A PIC  X(0001).
  2493     05  TEXT12I PIC  X(0070).
  2494*    -------------------------------
  2495     05  L13L PIC S9(0004) COMP.
  2496     05  L13F PIC  X(0001).
  2497     05  FILLER REDEFINES L13F.
  2498         10  L13A PIC  X(0001).
  2499     05  L13I PIC  X(0003).
  2500*    -------------------------------
  2501     05  TEXT13L PIC S9(0004) COMP.
  2502     05  TEXT13F PIC  X(0001).
  2503     05  FILLER REDEFINES TEXT13F.
  2504         10  TEXT13A PIC  X(0001).
  2505     05  TEXT13I PIC  X(0070).
  2506*    -------------------------------
  2507     05  ERRMSGL PIC S9(0004) COMP.
  2508     05  ERRMSGF PIC  X(0001).
  2509     05  FILLER REDEFINES ERRMSGF.
  2510         10  ERRMSGA PIC  X(0001).
  2511     05  ERRMSGI PIC  X(0072).
  2512*    -------------------------------
  2513     05  ENTERPFL PIC S9(0004) COMP.
  2514     05  ENTERPFF PIC  X(0001).
  2515     05  FILLER REDEFINES ENTERPFF.
  2516         10  ENTERPFA PIC  X(0001).
  2517     05  ENTERPFI PIC  99.
  2518*    -------------------------------
  2519     05  PRINTERL PIC S9(0004) COMP.
  2520     05  PRINTERF PIC  X(0001).
  2521     05  FILLER REDEFINES PRINTERF.
  2522         10  PRINTERA PIC  X(0001).
  2523     05  PRINTERI PIC  X(0004).
  2524*    -------------------------------
  2525     05  PFKEY9L PIC S9(0004) COMP.
  2526     05  PFKEY9F PIC  X(0001).
  2527     05  FILLER REDEFINES PFKEY9F.
  2528         10  PFKEY9A PIC  X(0001).
  2529     05  PFKEY9I PIC  X(0014).
  2530 01  EL152AO REDEFINES EL152AI.
  2531     05  FILLER            PIC  X(0012).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  DATEAO PIC  X(0008).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  TIMEAO PIC  99.99.
  2538*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  50
* EL152.cbl
  2539     05  FILLER            PIC  X(0003).
  2540     05  CARRO PIC  X(0001).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  CLMNOO PIC  X(0007).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  CRTNOO PIC  X(0011).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  PROCO PIC  X(0004).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  COMPIDO PIC  X(0003).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  CLEANO PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  SYSO PIC  X(0008).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  MAINTO PIC  X(0001).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  ARCHNUMO PIC  X(0008).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  FORMO PIC  X(0004).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  FOLLOWO PIC  X(0008).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  RESENDO PIC  X(0008).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  PRINTO PIC  X(0001).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  COPIESO PIC  X(0001).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  ENCO PIC  X(0003).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  ADDRO PIC  X(0002).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  ACTO PIC  X(0001).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  BENO PIC  X(0001).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  EMPO PIC  X(0001).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  51
* EL152.cbl
  2597     05  INSO PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  PHYSO PIC  X(0001).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  OTHR1O PIC  X(0001).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  OTHR2O PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  REO PIC  X(0070).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  L1O PIC  X(0003).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  TEXT1O PIC  X(0070).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  L2O PIC  X(0003).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  TEXT2O PIC  X(0070).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  L3O PIC  X(0003).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  TEXT3O PIC  X(0070).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  L4O PIC  X(0003).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  TEXT4O PIC  X(0070).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  L5O PIC  X(0003).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  TEXT5O PIC  X(0070).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  L6O PIC  X(0003).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  TEXT6O PIC  X(0070).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  L7O PIC  X(0003).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  TEXT7O PIC  X(0070).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  52
* EL152.cbl
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  TEXT8O PIC  X(0070).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  L9O PIC  X(0003).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  TEXT9O PIC  X(0070).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  L10O PIC  X(0003).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  TEXT10O PIC  X(0070).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  L11O PIC  X(0003).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  TEXT11O PIC  X(0070).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  L12O PIC  X(0003).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  TEXT12O PIC  X(0070).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  L13O PIC  X(0003).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  TEXT13O PIC  X(0070).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  ERRMSGO PIC  X(0072).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  ENTERPFO PIC  X(0002).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  PRINTERO PIC  X(0004).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  PFKEY9O PIC  X(0014).
  2700*    -------------------------------
  2701 01  MAP-REDEF REDEFINES EL152AI.
  2702     12  FILLER              PIC X(251).
  2703*    12  FILLER              PIC X(189).
  2704     12  EL152RI.
  2705       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2706         16  SC-LINEL        PIC S9(4)  COMP.
  2707         16  SC-LINEA        PIC X.
  2708         16  SC-LINE         PIC XXX.
  2709         16  SC-TEXTL        PIC S9(4)  COMP.
  2710         16  SC-TEXTA        PIC X.
  2711         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  53
* EL152.cbl
  2713 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2714
  2715 01  REC-TABLE REDEFINES RECORD-TABLE.
  2716     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2717                             PIC X(3650).
  2718
  2719 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2720     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2721         16  REC-TEXT        PIC X(70).
  2722         16  REC-PC          PIC 99.
  2723         16  FILLER          PIC X.
  2724
  2725 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  54
* EL152.cbl
  2727****************************************************************
  2728*
  2729* Copyright (c) 2007-2013 Dell Inc.
  2730* All rights reserved.
  2731*
  2732****************************************************************
  2733 01  DFHEIV.
  2734   02  DFHEIV0               PIC X(35).
  2735   02  DFHEIV1               PIC X(08).
  2736   02  DFHEIV2               PIC X(08).
  2737   02  DFHEIV3               PIC X(08).
  2738   02  DFHEIV4               PIC X(06).
  2739   02  DFHEIV5               PIC X(04).
  2740   02  DFHEIV6               PIC X(04).
  2741   02  DFHEIV7               PIC X(02).
  2742   02  DFHEIV8               PIC X(02).
  2743   02  DFHEIV9               PIC X(01).
  2744   02  DFHEIV10              PIC S9(7) COMP-3.
  2745   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2746   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2747   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2748   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2749   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2750   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2751   02  DFHEIV17              PIC X(04).
  2752   02  DFHEIV18              PIC X(04).
  2753   02  DFHEIV19              PIC X(04).
  2754   02  DFHEIV20              USAGE IS POINTER.
  2755   02  DFHEIV21              USAGE IS POINTER.
  2756   02  DFHEIV22              USAGE IS POINTER.
  2757   02  DFHEIV23              USAGE IS POINTER.
  2758   02  DFHEIV24              USAGE IS POINTER.
  2759   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2760   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2761   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2762   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2763   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2764   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2765   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2766   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2767   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2768   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2769   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2770   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2771   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2772   02  FILLER                PIC X(02).
  2773   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2774   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2775   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2776   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2777   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2778   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2779   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2780 LINKAGE  SECTION.
  2781*****************************************************************
  2782*                                                               *
  2783* Copyright (c) 2007-2013 Dell Inc.                             *
  2784* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  55
* EL152.cbl
  2785*                                                               *
  2786*****************************************************************
  2787 01  dfheiblk.
  2788     02  eibtime          pic s9(7) comp-3.
  2789     02  eibdate          pic s9(7) comp-3.
  2790     02  eibtrnid         pic x(4).
  2791     02  eibtaskn         pic s9(7) comp-3.
  2792     02  eibtrmid         pic x(4).
  2793     02  dfheigdi         pic s9(4) comp.
  2794     02  eibcposn         pic s9(4) comp.
  2795     02  eibcalen         pic s9(4) comp.
  2796     02  eibaid           pic x(1).
  2797     02  eibfiller1       pic x(1).
  2798     02  eibfn            pic x(2).
  2799     02  eibfiller2       pic x(2).
  2800     02  eibrcode         pic x(6).
  2801     02  eibfiller3       pic x(2).
  2802     02  eibds            pic x(8).
  2803     02  eibreqid         pic x(8).
  2804     02  eibrsrce         pic x(8).
  2805     02  eibsync          pic x(1).
  2806     02  eibfree          pic x(1).
  2807     02  eibrecv          pic x(1).
  2808     02  eibsend          pic x(1).
  2809     02  eibatt           pic x(1).
  2810     02  eibeoc           pic x(1).
  2811     02  eibfmh           pic x(1).
  2812     02  eibcompl         pic x(1).
  2813     02  eibsig           pic x(1).
  2814     02  eibconf          pic x(1).
  2815     02  eiberr           pic x(1).
  2816     02  eibrldbk         pic x(1).
  2817     02  eiberrcd         pic x(4).
  2818     02  eibsynrb         pic x(1).
  2819     02  eibnodat         pic x(1).
  2820     02  eibfiller5       pic x(2).
  2821     02  eibresp          pic s9(8) comp.
  2822     02  eibresp2         pic s9(8) comp.
  2823     02  dfheigdj         pic s9(4) comp.
  2824     02  dfheigdk         pic s9(4) comp.
  2825 01  DFHCOMMAREA                 PIC X(1024).
  2826
  2827 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  56
* EL152.cbl
  2829*                                COPY ELCMSTR.
  2830******************************************************************
  2831*                                                                *
  2832*                            ELCMSTR.                            *
  2833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2834*                            VMOD=2.012                          *
  2835*                                                                *
  2836*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2837*                                                                *
  2838*   FILE TYPE = VSAM,KSDS                                        *
  2839*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2840*                                                                *
  2841*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2842*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2843*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2844*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2845*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2846*                                                 RKP=75,LEN=21  *
  2847*                                                                *
  2848*   **** NOTE ****                                               *
  2849*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2850*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2851*                                                                *
  2852*   LOG = YES                                                    *
  2853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2854******************************************************************
  2855*                   C H A N G E   L O G
  2856*
  2857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2858*-----------------------------------------------------------------
  2859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2860* EFFECTIVE    NUMBER
  2861*-----------------------------------------------------------------
  2862* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2863* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2864* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  2865* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2866* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2867******************************************************************
  2868 01  CLAIM-MASTER.
  2869     12  CL-RECORD-ID                PIC XX.
  2870         88  VALID-CL-ID         VALUE 'CL'.
  2871
  2872     12  CL-CONTROL-PRIMARY.
  2873         16  CL-COMPANY-CD           PIC X.
  2874         16  CL-CARRIER              PIC X.
  2875         16  CL-CLAIM-NO             PIC X(7).
  2876         16  CL-CERT-NO.
  2877             20  CL-CERT-PRIME       PIC X(10).
  2878             20  CL-CERT-SFX         PIC X.
  2879
  2880     12  CL-CONTROL-BY-NAME.
  2881         16  CL-COMPANY-CD-A1        PIC X.
  2882         16  CL-INSURED-LAST-NAME    PIC X(15).
  2883         16  CL-INSURED-NAME.
  2884             20  CL-INSURED-1ST-NAME PIC X(12).
  2885             20  CL-INSURED-MID-INIT PIC X.
  2886
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  57
* EL152.cbl
  2887     12  CL-CONTROL-BY-SSN.
  2888         16  CL-COMPANY-CD-A2        PIC X.
  2889         16  CL-SOC-SEC-NO.
  2890             20  CL-SSN-STATE        PIC XX.
  2891             20  CL-SSN-ACCOUNT      PIC X(6).
  2892             20  CL-SSN-LN3          PIC X(3).
  2893
  2894     12  CL-CONTROL-BY-CERT-NO.
  2895         16  CL-COMPANY-CD-A4        PIC X.
  2896         16  CL-CERT-NO-A4.
  2897             20  CL-CERT-A4-PRIME    PIC X(10).
  2898             20  CL-CERT-A4-SFX      PIC X.
  2899
  2900     12  CL-CONTROL-BY-CCN.
  2901         16  CL-COMPANY-CD-A5        PIC X.
  2902         16  CL-CCN-A5.
  2903             20  CL-CCN.
  2904                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2905                 24  CL-CCN-PRIME-A5 PIC X(12).
  2906             20  CL-CCN-FILLER-A5    PIC X(4).
  2907
  2908     12  CL-INSURED-PROFILE-DATA.
  2909         16  CL-INSURED-BIRTH-DT     PIC XX.
  2910         16  CL-INSURED-SEX-CD       PIC X.
  2911             88  INSURED-IS-MALE        VALUE 'M'.
  2912             88  INSURED-IS-FEMALE      VALUE 'F'.
  2913             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2914         16  CL-INSURED-OCC-CD       PIC X(6).
  2915         16  FILLER                  PIC X(5).
  2916
  2917     12  CL-PROCESSING-INFO.
  2918         16  CL-PROCESSOR-ID         PIC X(4).
  2919         16  CL-CLAIM-STATUS         PIC X.
  2920             88  CLAIM-IS-OPEN          VALUE 'O'.
  2921             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2922         16  CL-CLAIM-TYPE           PIC X.
  2923*            88  AH-CLAIM               VALUE 'A'.
  2924*            88  LIFE-CLAIM             VALUE 'L'.
  2925*            88  PROPERTY-CLAIM         VALUE 'P'.
  2926*            88  IUI-CLAIM              VALUE 'I'.
  2927*            88  GAP-CLAIM              VALUE 'G'.
  2928*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  2929         16  CL-CLAIM-PREM-TYPE      PIC X.
  2930             88  SINGLE-PREMIUM         VALUE '1'.
  2931             88  O-B-COVERAGE           VALUE '2'.
  2932             88  OPEN-END-COVERAGE      VALUE '3'.
  2933         16  CL-INCURRED-DT          PIC XX.
  2934         16  CL-REPORTED-DT          PIC XX.
  2935         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2936         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2937         16  CL-LAST-PMT-DT          PIC XX.
  2938         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2939         16  CL-PAID-THRU-DT         PIC XX.
  2940         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2941         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2942         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2943         16  CL-PMT-CALC-METHOD      PIC X.
  2944             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  58
* EL152.cbl
  2945             88  CL-365-DAY-YR          VALUE '2'.
  2946             88  CL-FULL-MONTHS         VALUE '3'.
  2947         16  CL-CAUSE-CD             PIC X(6).
  2948
  2949         16  CL-PRIME-CERT-NO.
  2950             20  CL-PRIME-CERT-PRIME PIC X(10).
  2951             20  CL-PRIME-CERT-SFX   PIC X.
  2952
  2953         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2954             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2955             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2956
  2957         16  CL-MICROFILM-NO         PIC X(10).
  2958         16  FILLER REDEFINES CL-MICROFILM-NO.
  2959             20  CL-BENEFIT-PERIOD   PIC 99.
  2960             20  FILLER              PIC X(8).
  2961         16  CL-PROG-FORM-TYPE       PIC X.
  2962         16  CL-LAST-ADD-ON-DT       PIC XX.
  2963
  2964         16  CL-LAST-REOPEN-DT       PIC XX.
  2965         16  CL-LAST-CLOSE-DT        PIC XX.
  2966         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2967             88  FINAL-PAID             VALUE '1'.
  2968             88  CLAIM-DENIED           VALUE '2'.
  2969             88  AUTO-CLOSE             VALUE '3'.
  2970             88  MANUAL-CLOSE           VALUE '4'.
  2971             88  BENEFITS-CHANGED       VALUE 'C'.
  2972             88  SETUP-ERRORS           VALUE 'E'.
  2973         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2974         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2975         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2976             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2977         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2978         16  FILLER                  PIC X.
  2979
  2980     12  CL-CERTIFICATE-DATA.
  2981         16  CL-CERT-ORIGIN          PIC X.
  2982             88  CERT-WAS-ONLINE        VALUE '1'.
  2983             88  CERT-WAS-CREATED       VALUE '2'.
  2984             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2985         16  CL-CERT-KEY-DATA.
  2986             20  CL-CERT-CARRIER     PIC X.
  2987             20  CL-CERT-GROUPING    PIC X(6).
  2988             20  CL-CERT-STATE       PIC XX.
  2989             20  CL-CERT-ACCOUNT.
  2990                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2991                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2992             20  CL-CERT-EFF-DT      PIC XX.
  2993
  2994     12  CL-STATUS-CONTROLS.
  2995         16  CL-PRIORITY-CD          PIC X.
  2996             88  CONFIDENTIAL-DATA      VALUE '8'.
  2997             88  HIGHEST-PRIORITY       VALUE '9'.
  2998         16  CL-SUPV-ATTN-CD         PIC X.
  2999             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3000             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3001         16  CL-PURGED-DT            PIC XX.
  3002         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  59
* EL152.cbl
  3003         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3004         16  CL-NEXT-RESEND-DT       PIC XX.
  3005         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3006         16  CL-CRITICAL-PERIOD      PIC 99.
  3007*        16  FILLER                  PIC XX.
  3008         16  CL-LAST-MAINT-DT        PIC XX.
  3009         16  CL-LAST-MAINT-USER      PIC X(4).
  3010         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3011         16  CL-LAST-MAINT-TYPE      PIC X.
  3012             88  CLAIM-SET-UP           VALUE ' '.
  3013             88  PAYMENT-MADE           VALUE '1'.
  3014             88  LETTER-SENT            VALUE '2'.
  3015             88  MASTER-WAS-ALTERED     VALUE '3'.
  3016             88  MASTER-WAS-RESTORED    VALUE '4'.
  3017             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3018             88  FILE-CONVERTED         VALUE '6'.
  3019             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3020             88  ERROR-CORRECTION       VALUE 'E'.
  3021         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3022         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3023         16  CL-BENEFICIARY          PIC X(10).
  3024         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3025         16  CL-DENIAL-TYPE          PIC X.
  3026             88  CL-TYPE-DENIAL          VALUE '1'.
  3027             88  CL-TYPE-RESCISSION      VALUE '2'.
  3028             88  CL-TYPE-REFORMATION     VALUE '3'.
  3029             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3030             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3031         16  filler                  pic x(5).
  3032*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3033*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3034*        16  CL-RTW-DT               PIC XX.
  3035
  3036     12  CL-TRAILER-CONTROLS.
  3037         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3038             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3039             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3040             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3041         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3042         16  FILLER                  PIC XX.
  3043         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3044         16  CL-ADDRESS-TRAILER-CNT.
  3045             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3046                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3047             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3048                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3049             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3050                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3051             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3052                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3053             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3054                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3055             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3056                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3057             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3058                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3059
  3060     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  60
* EL152.cbl
  3061         16  CL-CV-REFNO-PRIME       PIC X(18).
  3062         16  CL-CV-REFNO-SFX         PIC XX.
  3063
  3064     12  CL-FILE-LOCATION            PIC X(4).
  3065
  3066     12  CL-PROCESS-ERRORS.
  3067         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3068             88  NO-FATAL-ERRORS        VALUE ZERO.
  3069         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3070             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3071
  3072     12  CL-PRODUCT-CD               PIC X.
  3073
  3074     12  CL-CURRENT-KEY-DATA.
  3075         16  CL-CURRENT-CARRIER      PIC X.
  3076         16  CL-CURRENT-GROUPING     PIC X(6).
  3077         16  CL-CURRENT-STATE        PIC XX.
  3078         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3079
  3080     12  CL-ASSOCIATES               PIC X.
  3081         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3082         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3083         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3084         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3085
  3086     12  CL-ACTIVITY-CODE            PIC 99.
  3087     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3088     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3089
  3090     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3091     12  CL-LAG-REPORT-CODE          PIC 9.
  3092     12  CL-LOAN-TYPE                PIC XX.
  3093     12  CL-LEGAL-STATE              PIC XX.
  3094
  3095     12  CL-YESNOSW                  PIC X.
  3096     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3097         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3098         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3099         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3100     12  cl-insured-type             pic x.
  3101         88  cl-claim-on-primary         value 'P'.
  3102         88  cl-claim-on-co-borrower     value 'C'.
  3103     12  cl-benefit-expiration-dt    PIC XX.
  3104
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  61
* EL152.cbl
  3106*                                COPY ELCCNTL.
  3107******************************************************************
  3108*                                                                *
  3109*                                                                *
  3110*                            ELCCNTL.                            *
  3111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3112*                            VMOD=2.059                          *
  3113*                                                                *
  3114*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3115*                                                                *
  3116*   FILE TYPE = VSAM,KSDS                                        *
  3117*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3118*                                                                *
  3119*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3120*       ALTERNATE INDEX = NONE                                   *
  3121*                                                                *
  3122*   LOG = YES                                                    *
  3123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3124******************************************************************
  3125*                   C H A N G E   L O G
  3126*
  3127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3128*-----------------------------------------------------------------
  3129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3130* EFFECTIVE    NUMBER
  3131*-----------------------------------------------------------------
  3132* 082503                   PEMA  ADD BENEFIT GROUP
  3133* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3134* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3135* 092705    2005050300006  PEMA  ADD SPP LEASES
  3136* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3137* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3138* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3139* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3140* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3141* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3142* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3143* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3144* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3145* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3146******************************************************************
  3147*
  3148 01  CONTROL-FILE.
  3149     12  CF-RECORD-ID                       PIC XX.
  3150         88  VALID-CF-ID                        VALUE 'CF'.
  3151
  3152     12  CF-CONTROL-PRIMARY.
  3153         16  CF-COMPANY-ID                  PIC XXX.
  3154         16  CF-RECORD-TYPE                 PIC X.
  3155             88  CF-COMPANY-MASTER              VALUE '1'.
  3156             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3157             88  CF-STATE-MASTER                VALUE '3'.
  3158             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3159             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3160             88  CF-CARRIER-MASTER              VALUE '6'.
  3161             88  CF-MORTALITY-MASTER            VALUE '7'.
  3162             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3163             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  62
* EL152.cbl
  3164             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3165             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3166             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3167             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3168             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3169             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3170             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3171             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3172             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3173         16  CF-ACCESS-CD-GENL              PIC X(4).
  3174         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3175             20  CF-PROCESSOR               PIC X(4).
  3176         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3177             20  CF-STATE-CODE              PIC XX.
  3178             20  FILLER                     PIC XX.
  3179         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3180             20  FILLER                     PIC XX.
  3181             20  CF-HI-BEN-IN-REC           PIC XX.
  3182         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3183             20  FILLER                     PIC XXX.
  3184             20  CF-CARRIER-CNTL            PIC X.
  3185         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3186             20  FILLER                     PIC XX.
  3187             20  CF-HI-TYPE-IN-REC          PIC 99.
  3188         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3189             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3190                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3191             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3192             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3193         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3194             20  FILLER                     PIC X.
  3195             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3196         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3197             20  FILLER                     PIC XX.
  3198             20  CF-MORTGAGE-PLAN           PIC XX.
  3199         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3200
  3201     12  CF-LAST-MAINT-DT                   PIC XX.
  3202     12  CF-LAST-MAINT-BY                   PIC X(4).
  3203     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3204
  3205     12  CF-RECORD-BODY                     PIC X(728).
  3206
  3207
  3208****************************************************************
  3209*             COMPANY MASTER RECORD                            *
  3210****************************************************************
  3211
  3212     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3213         16  CF-COMPANY-ADDRESS.
  3214             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3215             20  CF-CL-IN-CARE-OF           PIC X(30).
  3216             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3217             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3218             20  CF-CL-CITY-STATE           PIC X(30).
  3219             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3220             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3221         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  63
* EL152.cbl
  3222         16  CF-COMPANY-PASSWORD            PIC X(8).
  3223         16  CF-SECURITY-OPTION             PIC X.
  3224             88  ALL-SECURITY                   VALUE '1'.
  3225             88  COMPANY-VERIFY                 VALUE '2'.
  3226             88  PROCESSOR-VERIFY               VALUE '3'.
  3227             88  NO-SECURITY                    VALUE '4'.
  3228             88  ALL-BUT-TERM                   VALUE '5'.
  3229         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3230             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3231         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3232             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3233         16  CF-INFORCE-LOCATION            PIC X.
  3234             88  CERTS-ARE-ONLINE               VALUE '1'.
  3235             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3236             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3237         16  CF-LOWER-CASE-LETTERS          PIC X.
  3238         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3239             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3240             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3241             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3242             88  CF-ACCNT-CNTL                  VALUE '3'.
  3243             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3244
  3245         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3246         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3247
  3248         16  CF-LGX-CREDIT-USER             PIC X.
  3249             88  CO-IS-NOT-USER                 VALUE 'N'.
  3250             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3251
  3252         16 CF-CREDIT-CALC-CODES.
  3253             20  CF-CR-REM-TERM-CALC PIC X.
  3254               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3255               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3256               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3257               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3258               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3259               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3260               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3261             20  CF-CR-R78-METHOD           PIC X.
  3262               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3263               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3264
  3265         16  CF-CLAIM-CONTROL-COUNTS.
  3266             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3267                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3268
  3269             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3270                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3271
  3272             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3273                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3274
  3275             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3276                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3277
  3278         16  CF-CURRENT-MONTH-END           PIC XX.
  3279
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  64
* EL152.cbl
  3280         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3281             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3282             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3283             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3284             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3285                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3286                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3287             20  CF-CO-PREM-REJECT-SW       PIC X.
  3288                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3289                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3290             20  CF-CO-REF-REJECT-SW        PIC X.
  3291                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3292                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3293
  3294         16  CF-CO-REPORTING-DT             PIC XX.
  3295         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3296         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3297           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3298           88  CF-CO-MONTH-END                  VALUE '1'.
  3299
  3300         16  CF-LGX-CLAIM-USER              PIC X.
  3301             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3302             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3303
  3304         16  CF-CREDIT-EDIT-CONTROLS.
  3305             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3306             20  CF-MIN-AGE                 PIC 99.
  3307             20  CF-DEFAULT-AGE             PIC 99.
  3308             20  CF-MIN-TERM                PIC S999      COMP-3.
  3309             20  CF-MAX-TERM                PIC S999      COMP-3.
  3310             20  CF-DEFAULT-SEX             PIC X.
  3311             20  CF-JOINT-AGE-INPUT         PIC X.
  3312                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3313             20  CF-BIRTH-DATE-INPUT        PIC X.
  3314                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3315             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3316                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3317                 88  CF-ZERO-CARRIER            VALUE '1'.
  3318                 88  CF-ZERO-GROUPING           VALUE '2'.
  3319                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3320             20  CF-EDIT-SW                 PIC X.
  3321                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3322             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3323             20  CF-CR-PR-METHOD            PIC X.
  3324               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3325               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3326             20  FILLER                     PIC X.
  3327
  3328         16  CF-CREDIT-MISC-CONTROLS.
  3329             20  CF-REIN-TABLE-SW           PIC X.
  3330                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3331             20  CF-COMP-TABLE-SW           PIC X.
  3332                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3333             20  CF-EXPERIENCE-RETENTION-AGE
  3334                                            PIC S9        COMP-3.
  3335             20  CF-CONVERSION-DT           PIC XX.
  3336             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3337             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  65
* EL152.cbl
  3338                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3339                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3340
  3341             20  CF-CR-CHECK-NO-CONTROL.
  3342                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3343                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3344                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3345                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3346                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3347                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3348
  3349                 24  CF-CR-CHECK-COUNT       REDEFINES
  3350                     CF-CR-CHECK-COUNTER      PIC X(4).
  3351
  3352                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3353                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3354
  3355                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3356                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3357                 24  CF-MAIL-PROCESSING       PIC X.
  3358                     88  MAIL-PROCESSING          VALUE 'Y'.
  3359
  3360         16  CF-MISC-SYSTEM-CONTROL.
  3361             20  CF-SYSTEM-C                 PIC X.
  3362                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3363             20  CF-SYSTEM-D                 PIC X.
  3364                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3365             20  CF-SOC-SEC-NO-SW            PIC X.
  3366                 88  SOC-SEC-NO-USED             VALUE '1'.
  3367             20  CF-MEMBER-NO-SW             PIC X.
  3368                 88  MEMBER-NO-USED              VALUE '1'.
  3369             20  CF-TAX-ID-NUMBER            PIC X(11).
  3370             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3371             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3372                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3373                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3374                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3375                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3376             20  CF-SYSTEM-E                 PIC X.
  3377                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3378
  3379         16  CF-LGX-LIFE-USER               PIC X.
  3380             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3381             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3382
  3383         16  CF-CR-MONTH-END-DT             PIC XX.
  3384
  3385         16  CF-FILE-MAINT-DATES.
  3386             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3387                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3388             20  CF-LAST-BATCH       REDEFINES
  3389                 CF-LAST-BATCH-NO               PIC X(4).
  3390             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3391             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3392             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3393             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3394             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3395             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  66
* EL152.cbl
  3396             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3397             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3398             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3399             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3400
  3401         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3402         16  FILLER                         PIC X.
  3403
  3404         16  CF-ALT-MORT-CODE               PIC X(4).
  3405         16  CF-MEMBER-CAPTION              PIC X(10).
  3406
  3407         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3408             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3409             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3410             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3411             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3412             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3413
  3414         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3415
  3416         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3417         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3418         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3419         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3420
  3421         16  CF-AH-OVERRIDE-L1              PIC X.
  3422         16  CF-AH-OVERRIDE-L2              PIC XX.
  3423         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3424         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3425
  3426         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3427         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3428
  3429         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3430         16  CF-AR-LAST-EL860-DT            PIC XX.
  3431         16  CF-MP-MONTH-END-DT             PIC XX.
  3432
  3433         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3434         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3435             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3436
  3437         16  CF-AR-MONTH-END-DT             PIC XX.
  3438
  3439         16  CF-CRDTCRD-USER                PIC X.
  3440             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3441             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3442
  3443         16  CF-CC-MONTH-END-DT             PIC XX.
  3444
  3445         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3446
  3447         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3448             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3449             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3450             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3451         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3452         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3453         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  67
* EL152.cbl
  3454         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3455             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3456             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3457         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3458         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3459         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3460             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3461         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3462
  3463         16  CF-CL-ZIP-CODE.
  3464             20  CF-CL-ZIP-PRIME.
  3465                 24  CF-CL-ZIP-1ST          PIC X.
  3466                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3467                 24  FILLER                 PIC X(4).
  3468             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3469         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3470             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3471             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3472             20  FILLER                     PIC XXX.
  3473
  3474         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3475         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3476         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3477         16  CF-CO-OPTION-START-DATE        PIC XX.
  3478         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3479           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3480                                                      '3' '4'.
  3481           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3482           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3483           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3484           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3485           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3486           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3487
  3488         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3489
  3490         16  CF-PAYMENT-APPROVAL-LEVELS.
  3491             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3492             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3493             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3494             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3495             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3496             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3497
  3498         16  CF-END-USER-REPORTING-USER     PIC X.
  3499             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3500             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3501
  3502         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3503             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3504             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3505
  3506         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3507
  3508         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3509         16  FILLER                         PIC X.
  3510
  3511         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  68
* EL152.cbl
  3512             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3513             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3514             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3515
  3516         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3517
  3518         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3519             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3520             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3521
  3522         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3523             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3524             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3525
  3526         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3527
  3528         16  CF-CO-ACH-ID-CODE              PIC  X.
  3529             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3530             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3531             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3532         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3533         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3534         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3535         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3536         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3537         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3538         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3539         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3540         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3541                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3542         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3543                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3544
  3545         16  CF-CO-OVER-SHORT.
  3546             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3547             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3548
  3549*         16  FILLER                         PIC X(102).
  3550         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3551             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3552             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3553
  3554         16  CF-AH-APPROVAL-DAYS.
  3555             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3556             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3557             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3558             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3559
  3560         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3561
  3562         16  CF-APPROV-LEV-5.
  3563             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3564             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3565             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3566
  3567         16  FILLER                         PIC X(68).
  3568****************************************************************
  3569*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  69
* EL152.cbl
  3570****************************************************************
  3571
  3572     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3573         16  CF-PROCESSOR-NAME              PIC X(30).
  3574         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3575         16  CF-PROCESSOR-TITLE             PIC X(26).
  3576         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3577                 88  MESSAGE-YES                VALUE 'Y'.
  3578                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3579
  3580*****************************************************
  3581****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3582****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3583****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3584****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3585*****************************************************
  3586
  3587         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3588             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3589             20  CF-APPLICATION-FORCE       PIC X.
  3590             20  CF-INDIVIDUAL-APP.
  3591                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3592                     28  CF-BROWSE-APP      PIC X.
  3593                     28  CF-UPDATE-APP      PIC X.
  3594
  3595         16  CF-CURRENT-TERM-ON             PIC X(4).
  3596         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3597             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3598             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3599             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3600             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3601             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3602             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3603             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3604         16  CF-PROCESSOR-CARRIER           PIC X.
  3605             88  NO-CARRIER-SECURITY            VALUE ' '.
  3606         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3607             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3608         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3609             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3610         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3611             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3612
  3613         16  CF-PROC-SYS-ACCESS-SW.
  3614             20  CF-PROC-CREDIT-CLAIMS-SW.
  3615                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3616                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3617                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3618                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3619             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3620                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3621                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3622             20  CF-PROC-LIFE-GNRLDGR-SW.
  3623                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3624                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3625                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3626                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3627             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  70
* EL152.cbl
  3628                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3629                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3630         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3631             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3632             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3633         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3634
  3635         16  CF-APPROVAL-LEVEL                  PIC X.
  3636             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3637             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3638             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3639             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3640             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3641
  3642         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3643
  3644         16  CF-LANGUAGE-TYPE                   PIC X.
  3645             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3646             88  CF-LANG-IS-FR                      VALUE 'F'.
  3647
  3648         16  CF-CSR-IND                         PIC X.
  3649         16  FILLER                             PIC X(239).
  3650
  3651****************************************************************
  3652*             PROCESSOR/REMINDERS RECORD                       *
  3653****************************************************************
  3654
  3655     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3656         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3657             20  CF-START-REMIND-DT         PIC XX.
  3658             20  CF-END-REMIND-DT           PIC XX.
  3659             20  CF-REMINDER-TEXT           PIC X(50).
  3660         16  FILLER                         PIC X(296).
  3661
  3662
  3663****************************************************************
  3664*             STATE MASTER RECORD                              *
  3665****************************************************************
  3666
  3667     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3668         16  CF-STATE-ABBREVIATION          PIC XX.
  3669         16  CF-STATE-NAME                  PIC X(25).
  3670         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3671         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3672             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3673             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3674             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3675             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3676                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3677                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3678             20  CF-ST-PREM-REJECT-SW       PIC X.
  3679                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3680                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3681             20  CF-ST-REF-REJECT-SW        PIC X.
  3682                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3683                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3684         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3685         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  71
* EL152.cbl
  3686         16  CF-ST-REFUND-RULES.
  3687             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3688             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3689             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3690         16  CF-ST-FST-PMT-EXTENSION.
  3691             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3692             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3693                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3694                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3695                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3696                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3697         16  CF-ST-STATE-CALL.
  3698             20  CF-ST-CALL-UNEARNED        PIC X.
  3699             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3700             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3701         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3702             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3703             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3704         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3705         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3706         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3707         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3708         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3709         16  FILLER                         PIC X.
  3710         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3711             20  CF-ST-BENEFIT-CD           PIC XX.
  3712             20  CF-ST-BENEFIT-KIND         PIC X.
  3713                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3714                 88  CF-ST-AH-KIND              VALUE 'A'.
  3715             20  CF-ST-REM-TERM-CALC        PIC X.
  3716                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3717                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3718                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3719                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3720                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3721                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3722                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3723                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3724
  3725             20  CF-ST-REFUND-CALC          PIC X.
  3726                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3727                 88  ST-REFD-BY-R78             VALUE '1'.
  3728                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3729                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3730                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3731                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3732                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3733                 88  ST-REFD-UTAH               VALUE '7'.
  3734                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3735                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3736                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3737
  3738             20  CF-ST-EARNING-CALC         PIC X.
  3739                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3740                 88  ST-EARN-BY-R78             VALUE '1'.
  3741                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3742                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3743                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  72
* EL152.cbl
  3744                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3745                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3746                 88  ST-EARN-MEAN               VALUE '8'.
  3747                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3748
  3749             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3750                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3751                 88  ST-OVRD-BY-R78             VALUE '1'.
  3752                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3753                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3754                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3755                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3756                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3757                 88  ST-OVRD-MEAN               VALUE '8'.
  3758                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3759             20  cf-st-extra-periods        pic 9.
  3760*            20  FILLER                     PIC X.
  3761
  3762         16  CF-ST-COMMISSION-CAPS.
  3763             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3764             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3765             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3766             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3767         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3768                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3769
  3770         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3771
  3772         16  CF-ST-STATUTORY-INTEREST.
  3773             20  CF-ST-STAT-DATE-FROM       PIC X.
  3774                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3775                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3776             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3777             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3778             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3779             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3780             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3781
  3782         16  CF-ST-OVER-SHORT.
  3783             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3784             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3785
  3786         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3787
  3788         16  CF-ST-RT-CALC                  PIC X.
  3789
  3790         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3791         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3792         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3793         16  CF-ST-RF-LR-CALC               PIC X.
  3794         16  CF-ST-RF-LL-CALC               PIC X.
  3795         16  CF-ST-RF-LN-CALC               PIC X.
  3796         16  CF-ST-RF-AH-CALC               PIC X.
  3797         16  CF-ST-RF-CP-CALC               PIC X.
  3798*        16  FILLER                         PIC X(206).
  3799*CIDMOD         16  FILLER                         PIC X(192).
  3800         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3801             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  73
* EL152.cbl
  3802         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3803         16  CF-ST-VFY-2ND-BENE             PIC X.
  3804         16  CF-ST-CAUSAL-STATE             PIC X.
  3805         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3806         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3807         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3808             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3809         16  CF-ST-NET-ONLY-STATE           PIC X.
  3810             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3811         16  FILLER                         PIC X(181).
  3812
  3813****************************************************************
  3814*             BENEFIT MASTER RECORD                            *
  3815****************************************************************
  3816
  3817     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3818         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3819             20  CF-BENEFIT-CODE            PIC XX.
  3820             20  CF-BENEFIT-NUMERIC  REDEFINES
  3821                 CF-BENEFIT-CODE            PIC XX.
  3822             20  CF-BENEFIT-ALPHA           PIC XXX.
  3823             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3824             20  CF-BENEFIT-COMMENT         PIC X(10).
  3825
  3826             20  CF-LF-COVERAGE-TYPE        PIC X.
  3827                 88  CF-REDUCING                VALUE 'R'.
  3828                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3829
  3830             20  CF-SPECIAL-CALC-CD         PIC X.
  3831                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3832                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3833                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3834                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3835                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3836                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3837                 88  CF-FARM-PLAN               VALUE 'F'.
  3838                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3839                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3840                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3841                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3842                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3843                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3844                 88  CF-PRUDENTIAL              VALUE 'P'.
  3845                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3846                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3847                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3848                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3849                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3850                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3851
  3852             20  CF-JOINT-INDICATOR         PIC X.
  3853                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3854
  3855*            20  FILLER                     PIC X(12).
  3856             20  cf-maximum-benefits        pic s999 comp-3.
  3857             20  FILLER                     PIC X(09).
  3858             20  CF-BENEFIT-CATEGORY        PIC X.
  3859             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  74
* EL152.cbl
  3860
  3861             20  CF-CO-REM-TERM-CALC        PIC X.
  3862                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3863                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3864                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3865                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3866                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3867
  3868             20  CF-CO-EARNINGS-CALC        PIC X.
  3869                 88  CO-EARN-BY-R78             VALUE '1'.
  3870                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3871                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3872                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3873                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3874                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3875                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3876                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3877
  3878             20  CF-CO-REFUND-CALC          PIC X.
  3879                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3880                 88  CO-REFD-BY-R78             VALUE '1'.
  3881                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3882                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3883                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3884                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3885                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3886                 88  CO-REFD-MEAN               VALUE '8'.
  3887                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3888                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3889                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3890
  3891             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3892                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3893                 88  CO-OVRD-BY-R78             VALUE '1'.
  3894                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3895                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3896                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3897                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3898                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3899                 88  CO-OVRD-MEAN               VALUE '8'.
  3900                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3901
  3902             20  CF-CO-BEN-I-G-CD           PIC X.
  3903                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3904                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3905                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3906
  3907         16  FILLER                         PIC X(304).
  3908
  3909
  3910****************************************************************
  3911*             CARRIER MASTER RECORD                            *
  3912****************************************************************
  3913
  3914     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3915         16  CF-ADDRESS-DATA.
  3916             20  CF-MAIL-TO-NAME            PIC X(30).
  3917             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  75
* EL152.cbl
  3918             20  CF-ADDRESS-LINE-1          PIC X(30).
  3919             20  CF-ADDRESS-LINE-2          PIC X(30).
  3920             20  CF-CITY-STATE              PIC X(30).
  3921             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3922             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3923
  3924         16  CF-CLAIM-NO-CONTROL.
  3925             20  CF-CLAIM-NO-METHOD         PIC X.
  3926                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3927                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3928                 88  CLAIM-NO-SEQ               VALUE '3'.
  3929                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3930             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3931                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3932                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3933                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3934
  3935         16  CF-CHECK-NO-CONTROL.
  3936             20  CF-CHECK-NO-METHOD         PIC X.
  3937                 88  CHECK-NO-MANUAL            VALUE '1'.
  3938                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3939                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3940                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3941             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3942                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3943
  3944         16  CF-DOMICILE-STATE              PIC XX.
  3945
  3946         16  CF-EXPENSE-CONTROLS.
  3947             20  CF-EXPENSE-METHOD          PIC X.
  3948                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3949                 88  DOLLARS-PER-PMT            VALUE '2'.
  3950                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3951                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3952             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3953             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3954
  3955         16  CF-CORRESPONDENCE-CONTROL.
  3956             20  CF-LETTER-RESEND-OPT       PIC X.
  3957                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3958                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3959             20  FILLER                     PIC X(4).
  3960
  3961         16  CF-RESERVE-CONTROLS.
  3962             20  CF-MANUAL-SW               PIC X.
  3963                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3964             20  CF-FUTURE-SW               PIC X.
  3965                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3966             20  CF-PTC-SW                  PIC X.
  3967                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3968             20  CF-IBNR-SW                 PIC X.
  3969                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3970             20  CF-PTC-LF-SW               PIC X.
  3971                 88  CF-LF-PTC-USED             VALUE '1'.
  3972             20  CF-CDT-ACCESS-METHOD       PIC X.
  3973                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3974                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3975                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  76
* EL152.cbl
  3976             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3977
  3978         16  CF-CLAIM-CALC-METHOD           PIC X.
  3979             88  360-PLUS-MONTHS                VALUE '1'.
  3980             88  365-PLUS-MONTHS                VALUE '2'.
  3981             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3982             88  360-DAILY                      VALUE '4'.
  3983             88  365-DAILY                      VALUE '5'.
  3984
  3985         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3986         16  FILLER                         PIC X(11).
  3987
  3988         16  CF-LIMIT-AMOUNTS.
  3989             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3990             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3991             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3992             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3993             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3994             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3995             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3996             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3997             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3998             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3999
  4000         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4001         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4002         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4003
  4004         16  CF-ZIP-CODE.
  4005             20  CF-ZIP-PRIME.
  4006                 24  CF-ZIP-1ST             PIC X.
  4007                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4008                 24  FILLER                 PIC X(4).
  4009             20  CF-ZIP-PLUS4               PIC X(4).
  4010         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4011             20  CF-CAN-POSTAL-1            PIC XXX.
  4012             20  CF-CAN-POSTAL-2            PIC XXX.
  4013             20  FILLER                     PIC XXX.
  4014
  4015         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4016         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4017         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4018
  4019         16  CF-RATING-SWITCH               PIC X.
  4020             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4021             88  CF-NO-RATING                   VALUE 'N'.
  4022
  4023         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4024
  4025         16  CF-CARRIER-OVER-SHORT.
  4026             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4027             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4028
  4029         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4030         16  CF-SECPAY-SWITCH               PIC X.
  4031             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4032             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4033         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  77
* EL152.cbl
  4034         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4035         16  FILLER                         PIC X(444).
  4036*        16  FILLER                         PIC X(452).
  4037
  4038
  4039****************************************************************
  4040*             MORTALITY MASTER RECORD                          *
  4041****************************************************************
  4042
  4043     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4044         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4045                                INDEXED BY CF-MORT-NDX.
  4046             20  CF-MORT-TABLE              PIC X(5).
  4047             20  CF-MORT-TABLE-TYPE         PIC X.
  4048                 88  CF-MORT-JOINT              VALUE 'J'.
  4049                 88  CF-MORT-SINGLE             VALUE 'S'.
  4050                 88  CF-MORT-COMBINED           VALUE 'C'.
  4051                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4052                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4053             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4054             20  CF-MORT-AGE-METHOD         PIC XX.
  4055                 88  CF-AGE-LAST                VALUE 'AL'.
  4056                 88  CF-AGE-NEAR                VALUE 'AN'.
  4057             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4058             20  CF-MORT-ADJUSTMENT-DIRECTION
  4059                                            PIC X.
  4060                 88  CF-MINUS                   VALUE '-'.
  4061                 88  CF-PLUS                    VALUE '+'.
  4062             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4063             20  CF-MORT-JOINT-CODE         PIC X.
  4064                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4065             20  CF-MORT-PC-Q               PIC X.
  4066                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4067             20  CF-MORT-TABLE-CODE         PIC X(4).
  4068             20  CF-MORT-COMMENTS           PIC X(15).
  4069             20  FILLER                     PIC X(14).
  4070
  4071         16  FILLER                         PIC X(251).
  4072
  4073
  4074****************************************************************
  4075*             BUSSINESS TYPE MASTER RECORD                     *
  4076****************************************************************
  4077
  4078     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4079* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4080* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4081* AND RECORD 05 IS TYPES 81-99
  4082         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4083             20  CF-BUSINESS-TITLE          PIC  X(19).
  4084             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4085                                            PIC S9V9(4) COMP-3.
  4086             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4087             20  FILLER                     PIC  X.
  4088         16  FILLER                         PIC  X(248).
  4089
  4090
  4091****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  78
* EL152.cbl
  4092*             TERMINAL MASTER RECORD                           *
  4093****************************************************************
  4094
  4095     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4096
  4097         16  CF-COMPANY-TERMINALS.
  4098             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4099                                  PIC X(4).
  4100         16  FILLER               PIC X(248).
  4101
  4102
  4103****************************************************************
  4104*             LIFE EDIT MASTER RECORD                          *
  4105****************************************************************
  4106
  4107     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4108         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4109             20  CF-LIFE-CODE-IN            PIC XX.
  4110             20  CF-LIFE-CODE-OUT           PIC XX.
  4111         16  FILLER                         PIC X(248).
  4112
  4113
  4114****************************************************************
  4115*             AH EDIT MASTER RECORD                            *
  4116****************************************************************
  4117
  4118     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4119         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4120             20  CF-AH-CODE-IN              PIC XXX.
  4121             20  CF-AH-CODE-OUT             PIC XX.
  4122         16  FILLER                         PIC X(248).
  4123
  4124
  4125****************************************************************
  4126*             CREDIBILITY TABLES                               *
  4127****************************************************************
  4128
  4129     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4130         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4131                             INDEXED BY CF-CRDB-NDX.
  4132             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4133             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4134             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4135         16  FILLER                         PIC  X(332).
  4136
  4137
  4138****************************************************************
  4139*             REPORT CUSTOMIZATION RECORD                      *
  4140****************************************************************
  4141
  4142     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4143         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4144             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4145             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4146             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4147**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4148****       A T-TRANSFER.                                   ****
  4149             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  79
* EL152.cbl
  4150
  4151         16  FILLER                         PIC XX.
  4152
  4153         16  CF-CARRIER-CNTL-OPT.
  4154             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4155                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4156                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4157             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4158                                            PIC X.
  4159         16  CF-GROUP-CNTL-OPT.
  4160             20  CF-GROUP-OPT-SEQ           PIC 9.
  4161                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4162                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4163             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4164                                            PIC X(6).
  4165         16  CF-STATE-CNTL-OPT.
  4166             20  CF-STATE-OPT-SEQ           PIC 9.
  4167                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4168                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4169             20  CF-STATE-SELECT OCCURS 3 TIMES
  4170                                            PIC XX.
  4171         16  CF-ACCOUNT-CNTL-OPT.
  4172             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4173                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4174                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4175             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4176                                            PIC X(10).
  4177         16  CF-BUS-TYP-CNTL-OPT.
  4178             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4179                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4180                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4181             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4182                                            PIC XX.
  4183         16  CF-LF-TYP-CNTL-OPT.
  4184             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4185                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4186                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4187             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4188                                            PIC XX.
  4189         16  CF-AH-TYP-CNTL-OPT.
  4190             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4191                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4192                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4193             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4194                                            PIC XX.
  4195         16  CF-REPTCD1-CNTL-OPT.
  4196             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4197                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4198                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4199             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4200                                            PIC X(10).
  4201         16  CF-REPTCD2-CNTL-OPT.
  4202             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4203                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4204                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4205             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4206                                            PIC X(10).
  4207         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  80
* EL152.cbl
  4208             20  CF-USER1-OPT-SEQ           PIC 9.
  4209                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4210                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4211             20  CF-USER1-SELECT OCCURS 3 TIMES
  4212                                            PIC X(10).
  4213         16  CF-USER2-CNTL-OPT.
  4214             20  CF-USER2-OPT-SEQ           PIC 9.
  4215                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4216                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4217             20  CF-USER2-SELECT OCCURS 3 TIMES
  4218                                            PIC X(10).
  4219         16  CF-USER3-CNTL-OPT.
  4220             20  CF-USER3-OPT-SEQ           PIC 9.
  4221                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4222                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4223             20  CF-USER3-SELECT OCCURS 3 TIMES
  4224                                            PIC X(10).
  4225         16  CF-USER4-CNTL-OPT.
  4226             20  CF-USER4-OPT-SEQ           PIC 9.
  4227                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4228                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4229             20  CF-USER4-SELECT OCCURS 3 TIMES
  4230                                            PIC X(10).
  4231         16  CF-USER5-CNTL-OPT.
  4232             20  CF-USER5-OPT-SEQ           PIC 9.
  4233                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4234                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4235             20  CF-USER5-SELECT OCCURS 3 TIMES
  4236                                            PIC X(10).
  4237         16  CF-REINS-CNTL-OPT.
  4238             20  CF-REINS-OPT-SEQ           PIC 9.
  4239                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4240                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4241             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4242                 24  CF-REINS-PRIME         PIC XXX.
  4243                 24  CF-REINS-SUB           PIC XXX.
  4244
  4245         16  CF-AGENT-CNTL-OPT.
  4246             20  CF-AGENT-OPT-SEQ           PIC 9.
  4247                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4248                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4249             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4250                                            PIC X(10).
  4251
  4252         16  FILLER                         PIC X(43).
  4253
  4254         16  CF-LOSS-RATIO-SELECT.
  4255             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4256             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4257         16  CF-ENTRY-DATE-SELECT.
  4258             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4259             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4260         16  CF-EFFECTIVE-DATE-SELECT.
  4261             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4262             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4263
  4264         16  CF-EXCEPTION-LIST-IND          PIC X.
  4265             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  81
* EL152.cbl
  4266
  4267         16  FILLER                         PIC X(318).
  4268
  4269****************************************************************
  4270*                  EXCEPTION REPORTING RECORD                  *
  4271****************************************************************
  4272
  4273     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4274         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4275             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4276
  4277         16  CF-COMBINED-LIFE-AH-OPT.
  4278             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4279             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4280             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4281             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4282
  4283         16  CF-LIFE-OPT.
  4284             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4285             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4286             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4287             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4288             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4289             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4290             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4291             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4292             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4293             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4294
  4295         16  CF-AH-OPT.
  4296             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4297             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4298             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4299             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4300             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4301             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4302             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4303             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4304             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4305             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4306
  4307         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4308             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4309             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4310             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4311
  4312         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4313
  4314         16  FILLER                         PIC X(673).
  4315
  4316
  4317****************************************************************
  4318*             MORTGAGE SYSTEM PLAN RECORD                      *
  4319****************************************************************
  4320
  4321     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4322         16  CF-PLAN-TYPE                   PIC X.
  4323             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  82
* EL152.cbl
  4324             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4325             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4326         16  CF-PLAN-ABBREV                 PIC XXX.
  4327         16  CF-PLAN-DESCRIPT               PIC X(10).
  4328         16  CF-PLAN-NOTES                  PIC X(20).
  4329         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4330         16  CF-PLAN-UNDERWRITING.
  4331             20  CF-PLAN-TERM-DATA.
  4332                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4333                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4334             20  CF-PLAN-AGE-DATA.
  4335                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4336                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4337                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4338             20  CF-PLAN-BENEFIT-DATA.
  4339                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4340                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4341                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4342                                            PIC S9(7)V99  COMP-3.
  4343         16  CF-PLAN-POLICY-FORMS.
  4344             20  CF-POLICY-FORM             PIC X(12).
  4345             20  CF-MASTER-APPLICATION      PIC X(12).
  4346             20  CF-MASTER-POLICY           PIC X(12).
  4347         16  CF-PLAN-RATING.
  4348             20  CF-RATE-CODE               PIC X(5).
  4349             20  CF-SEX-RATING              PIC X.
  4350                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4351                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4352             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4353             20  CF-SUB-STD-TYPE            PIC X.
  4354                 88  CF-PCT-OF-PREM            VALUE '1'.
  4355                 88  CF-PCT-OF-BENE            VALUE '2'.
  4356         16  CF-PLAN-PREM-TOLERANCES.
  4357             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4358             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4359         16  CF-PLAN-PYMT-TOLERANCES.
  4360             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4361             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4362         16  CF-PLAN-MISC-DATA.
  4363             20  FILLER                     PIC X.
  4364             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4365             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4366         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4367         16  CF-PLAN-IND-GRP                PIC X.
  4368             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4369                                                     '1'.
  4370             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4371                                                     '2'.
  4372         16  CF-MIB-SEARCH-SW               PIC X.
  4373             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4374             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4375             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4376             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4377         16  CF-ALPHA-SEARCH-SW             PIC X.
  4378             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4379             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4380             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4381             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  83
* EL152.cbl
  4382             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4383             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4384             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4385             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4386             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4387             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4388                                                     'A' 'B' 'C'
  4389                                                     'X' 'Y' 'Z'.
  4390         16  CF-EFF-DT-RULE-SW              PIC X.
  4391             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4392             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4393             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4394             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4395             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4396         16  FILLER                         PIC X(4).
  4397         16  CF-HEALTH-QUESTIONS            PIC X.
  4398             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4399         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4400         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4401         16  CF-PLAN-SNGL-JNT               PIC X.
  4402             88  CF-COMBINED-PLAN              VALUE 'C'.
  4403             88  CF-JNT-PLAN                   VALUE 'J'.
  4404             88  CF-SNGL-PLAN                  VALUE 'S'.
  4405         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4406         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4407         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4408         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4409         16  CF-RERATE-CNTL                 PIC  X.
  4410             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4411             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4412             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4413             88  CF-AUTO-RECALC                 VALUE '4'.
  4414         16  CF-BENEFIT-TYPE                PIC  X.
  4415             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4416             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4417         16  CF-POLICY-FEE                  PIC S999V99
  4418                                                    COMP-3.
  4419         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4420         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4421         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4422         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4423         16  FILLER                         PIC  X(32).
  4424         16  CF-TERMINATION-FORM            PIC  X(04).
  4425         16  FILLER                         PIC  X(08).
  4426         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4427                                                       COMP-3.
  4428         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4429         16  CF-ISSUE-LETTER                PIC  X(4).
  4430         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4431         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4432             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4433             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4434         16  CF-MP-REFUND-CALC              PIC X.
  4435             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4436             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4437             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4438             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4439             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  84
* EL152.cbl
  4440             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4441             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4442             88  CF-MP-REFD-MEAN                VALUE '8'.
  4443         16  CF-ALT-RATE-CODE               PIC  X(5).
  4444
  4445
  4446         16  FILLER                         PIC X(498).
  4447****************************************************************
  4448*             MORTGAGE COMPANY MASTER RECORD                   *
  4449****************************************************************
  4450
  4451     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4452         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4453         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4454             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4455             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4456             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4457             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4458             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4459
  4460         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4461         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4462         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4463         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4464         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4465
  4466         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4467             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4468         16  CF-MP-RECON-USE-IND            PIC X(1).
  4469             88  CF-MP-USE-RECON             VALUE 'Y'.
  4470         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4471             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4472         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4473             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4474             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4475         16  FILLER                         PIC X(1).
  4476         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4477             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4478         16  CF-MORTG-MIB-VERSION           PIC X.
  4479             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4480             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4481             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4482         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4483             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4484                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4485             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4486                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4487             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4488                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4489             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4490                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4491             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4492                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4493             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4494                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4495         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4496         16  FILLER                         PIC X(7).
  4497         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  85
* EL152.cbl
  4498             20  CF-MORTG-MIB-COMM          PIC X(5).
  4499             20  CF-MORTG-MIB-TERM          PIC X(5).
  4500         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4501             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4502         16  FILLER                         PIC X(03).
  4503         16  CF-MP-CHECK-NO-CONTROL.
  4504             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4505                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4506                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4507                                                ' ' LOW-VALUES.
  4508                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4509                                               VALUE '3'.
  4510         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4511         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4512         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4513             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4514                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4515             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4516                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4517             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4518                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4519             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4520                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4521             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4522                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4523             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4524                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4525         16  CF-MORTG-BILLING-AREA.
  4526             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4527                                            PIC X.
  4528         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4529         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4530         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4531         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4532             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4533             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4534         16  FILLER                         PIC X.
  4535         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4536             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4537             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4538         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4539         16  FILLER                         PIC X(8).
  4540         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4541         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4542         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4543         16  CF-ACH-COMPANY-ID.
  4544             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4545                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4546                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4547                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4548             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4549         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4550             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4551         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4552             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4553             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4554         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4555         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  86
* EL152.cbl
  4556         16  FILLER                         PIC X(536).
  4557
  4558****************************************************************
  4559*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4560****************************************************************
  4561
  4562     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4563         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4564             20  CF-FEMALE-HEIGHT.
  4565                 24  CF-FEMALE-FT           PIC 99.
  4566                 24  CF-FEMALE-IN           PIC 99.
  4567             20  CF-FEMALE-MIN-WT           PIC 999.
  4568             20  CF-FEMALE-MAX-WT           PIC 999.
  4569         16  FILLER                         PIC X(428).
  4570
  4571     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4572         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4573             20  CF-MALE-HEIGHT.
  4574                 24  CF-MALE-FT             PIC 99.
  4575                 24  CF-MALE-IN             PIC 99.
  4576             20  CF-MALE-MIN-WT             PIC 999.
  4577             20  CF-MALE-MAX-WT             PIC 999.
  4578         16  FILLER                         PIC X(428).
  4579******************************************************************
  4580*             AUTOMATIC ACTIVITY RECORD                          *
  4581******************************************************************
  4582     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4583         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4584             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4585             20  CF-SYS-LETTER-ID           PIC X(04).
  4586             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4587             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4588             20  CF-SYS-RESET-SW            PIC X(01).
  4589             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4590             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4591
  4592         16  FILLER                         PIC X(50).
  4593
  4594         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4595             20  CF-USER-ACTIVE-SW          PIC X(01).
  4596             20  CF-USER-LETTER-ID          PIC X(04).
  4597             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4598             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4599             20  CF-USER-RESET-SW           PIC X(01).
  4600             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4601             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4602             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4603
  4604         16  FILLER                         PIC X(246).
  4605
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  87
* EL152.cbl
  4607*                                COPY ELCARCH.
  4608******************************************************************
  4609*                                                                *
  4610*                            ELCARCH.                            *
  4611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4612*                            VMOD=2.007                          *
  4613*                                                                *
  4614*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4615*                                                                *
  4616*   FILE TYPE = VSAM,KSDS                                        *
  4617*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4618*                                                                *
  4619*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4620*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4621*                                                                *
  4622*   LOG = NO                                                     *
  4623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4624*                                                                *
  4625*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4626******************************************************************
  4627 01  LETTER-ARCHIVE.
  4628     12  LA-RECORD-ID                PIC XX.
  4629         88  VALID-LA-ID                VALUE 'LA'.
  4630
  4631     12  LA-CONTROL-PRIMARY.
  4632         16  LA-COMPANY-CD           PIC X.
  4633         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4634         16  LA-RECORD-TYPE          PIC X.
  4635             88  LA-HEADER-DATA         VALUE '1'.
  4636             88  LA-ADDRESS-DATA        VALUE '2'.
  4637             88  LA-TEXT-DATA           VALUE '3'.
  4638             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4639         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4640
  4641     12  LA-CONTROL-BY-TYPE.
  4642         16  LA-COMPANY-CD-A1        PIC X.
  4643         16  LA-RECORD-TYPE-A1       PIC X.
  4644         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4645         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4646
  4647     12  LA-TEXT-RECORD.
  4648         16  LA-SKIP-CONTROL         PIC XX.
  4649             88  NO-LINES-SKIPPED       VALUE SPACES.
  4650             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4651         16  LA-TEXT-LINE            PIC X(70).
  4652
  4653     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4654         16  FILLER                  PIC XX.
  4655         16  LA-ADDRESS-LINE         PIC X(30).
  4656         16  FILLER                  PIC X(40).
  4657
  4658     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4659         16  FILLER                  PIC XX.
  4660         16  LA-CARRIER              PIC X.
  4661         16  LA-CLAIM-NO             PIC X(7).
  4662         16  LA-CERT-NO.
  4663             20  LA-CERT-PRIME       PIC X(10).
  4664             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  88
* EL152.cbl
  4665         16  LA-NO-OF-COPIES         PIC S9.
  4666         16  LA-RESEND-DATE          PIC XX.
  4667         16  LA-PROCESSOR-CD         PIC X(4).
  4668         16  LA-CREATION-DT          PIC XX.
  4669         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4670         16  LA-RESEND-PRINT-DATE    PIC XX.
  4671         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4672         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4673*
  4674* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4675*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4676*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4677*   I        20  LA-DMD-RES-ST           PIC XX.
  4678*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4679*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4680*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4681*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4682*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4683*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4684*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4685*   I        20  LA-DMD-UND-CODE         PIC XX.
  4686*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4687*   V    16  FILLER                  PIC X(15).
  4688* -----
  4689*
  4690* REINSERTED  CSO  MODS
  4691*
  4692         16  FILLER.
  4693             20  FILLER                  PIC X(29).
  4694             20  LA-CSO-LETTER-STATUS    PIC X.
  4695                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4696                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4697                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4698             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4699             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4700*
  4701
  4702     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4703         16  FILLER                  PIC XX.
  4704         16  LA4-CARRIER             PIC X.
  4705         16  LA4-CLAIM-NO            PIC X(7).
  4706         16  LA4-CERT-NO.
  4707             20  LA4-CERT-PRIME      PIC X(10).
  4708             20  LA4-CERT-SFX        PIC X.
  4709         16  LA4-NO-OF-COPIES        PIC S9.
  4710         16  LA4-RESEND-DATE         PIC XX.
  4711         16  LA4-PROCESSOR-CD        PIC X(4).
  4712         16  LA4-CREATION-DT         PIC XX.
  4713         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4714         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4715         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4716         16  LA4-FORM-TYPE           PIC X.
  4717             88  LA4-INITIAL-FORM    VALUE '1'.
  4718             88  LA4-PROGRESS-FORM   VALUE '2'.
  4719         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4720         16  LA4-STATE               PIC X(02).
  4721         16  FILLER                  PIC X(31).
  4722******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  89
* EL152.cbl
  4723
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  90
* EL152.cbl
  4725*                                COPY ELCARCT.
  4726******************************************************************
  4727*                                                                *
  4728*                            ELCARCT.                            *
  4729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4730*                            VMOD=2.003                          *
  4731*                                                                *
  4732*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4733*                                                                *
  4734*   FILE TYPE = VSAM,KSDS                                        *
  4735*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4736*                                                                *
  4737*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4738*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4739*                                                                *
  4740*   LOG = NO                                                     *
  4741*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4742*                                                                *
  4743*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4744******************************************************************
  4745 01  LETTER-ARCHIVE-TEMP.
  4746     12  LT-RECORD-ID                PIC XX.
  4747         88  VALID-LT-ID                VALUE 'LT'.
  4748
  4749     12  LT-CONTROL-PRIMARY.
  4750         16  LT-COMPANY-CD           PIC X.
  4751         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4752         16  LT-RECORD-TYPE          PIC X.
  4753             88  LT-HEADER-DATA         VALUE '1'.
  4754             88  LT-ADDRESS-DATA        VALUE '2'.
  4755             88  LT-TEXT-DATA           VALUE '3'.
  4756             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4757         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4758
  4759     12  LT-CONTROL-BY-TYPE.
  4760         16  LT-COMPANY-CD-A1        PIC X.
  4761         16  LT-RECORD-TYPE-A1       PIC X.
  4762         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4763         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4764
  4765     12  LT-TEXT-RECORD.
  4766         16  LT-SKIP-CONTROL         PIC XX.
  4767         16  LT-TEXT-LINE            PIC X(70).
  4768
  4769     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4770         16  FILLER                  PIC XX.
  4771         16  LT-ADDRESS-LINE         PIC X(30).
  4772         16  FILLER                  PIC X(40).
  4773
  4774     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4775         16  FILLER                  PIC XX.
  4776         16  LT-CARRIER              PIC X.
  4777         16  LT-CLAIM-NO             PIC X(7).
  4778         16  LT-CERT-NO.
  4779             20  LT-CERT-PRIME       PIC X(10).
  4780             20  LT-CERT-SFX         PIC X.
  4781         16  LT-NO-OF-COPIES         PIC S9.
  4782         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  91
* EL152.cbl
  4783         16  LT-PROCESSOR-CD         PIC X(4).
  4784         16  LT-CREATION-DT          PIC XX.
  4785         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4786         16  LT-RESEND-PRINT-DATE    PIC XX.
  4787         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4788         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4789         16  LT-DMD-ADDITIONAL-FIELDS.
  4790             20  LT-DMD-LETTER-FORM      PIC X(4).
  4791             20  LT-DMD-PROD-CODE        PIC XX.
  4792             20  LT-DMD-RES-ST           PIC XX.
  4793             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4794             20  LT-DMD-LETTER-STATUS    PIC X.
  4795                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4796                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4797                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4798             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4799             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4800             20  LT-DMD-UND-CODE         PIC XX.
  4801             20  LT-DMD-BEN-CODE         PIC XX.
  4802         16  FILLER                  PIC X(15).
  4803
  4804     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4805         16  FILLER                  PIC XX.
  4806         16  LT4-CARRIER             PIC X.
  4807         16  LT4-CLAIM-NO            PIC X(7).
  4808         16  LT4-CERT-NO.
  4809             20  LT4-CERT-PRIME      PIC X(10).
  4810             20  LT4-CERT-SFX        PIC X.
  4811         16  LT4-NO-OF-COPIES        PIC S9.
  4812         16  LT4-RESEND-DATE         PIC XX.
  4813         16  LT4-PROCESSOR-CD        PIC X(4).
  4814         16  LT4-CREATION-DT         PIC XX.
  4815         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4816         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4817         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4818         16  LT4-FORM-TYPE           PIC X.
  4819             88  LT4-INITIAL-FORM    VALUE '1'.
  4820             88  LT4-PROGRESS-FORM   VALUE '2'.
  4821         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4822         16  LT4-STATE               PIC XX.
  4823         16  FILLER                  PIC X(31).
  4824******************************************************************
  4825
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  92
* EL152.cbl
  4827*                                COPY ELCCERT.
  4828******************************************************************
  4829*                                                                *
  4830*                            ELCCERT.                            *
  4831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4832*                            VMOD=2.013                          *
  4833*                                                                *
  4834*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4835*                                                                *
  4836*   FILE TYPE = VSAM,KSDS                                        *
  4837*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4838*                                                                *
  4839*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4840*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4841*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4842*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4843*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4844*                                                                *
  4845*   LOG = YES                                                    *
  4846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4847******************************************************************
  4848*                   C H A N G E   L O G
  4849*
  4850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4851*-----------------------------------------------------------------
  4852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4853* EFFECTIVE    NUMBER
  4854*-----------------------------------------------------------------
  4855* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4856* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4857* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4858* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4859* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4860* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4861* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4862* 032612  CR2011110200001  PEMA  AHL CHANGES
  4863* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4864* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4865******************************************************************
  4866
  4867 01  CERTIFICATE-MASTER.
  4868     12  CM-RECORD-ID                      PIC XX.
  4869         88  VALID-CM-ID                      VALUE 'CM'.
  4870
  4871     12  CM-CONTROL-PRIMARY.
  4872         16  CM-COMPANY-CD                 PIC X.
  4873         16  CM-CARRIER                    PIC X.
  4874         16  CM-GROUPING.
  4875             20  CM-GROUPING-PREFIX        PIC X(3).
  4876             20  CM-GROUPING-PRIME         PIC X(3).
  4877         16  CM-STATE                      PIC XX.
  4878         16  CM-ACCOUNT.
  4879             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4880             20  CM-ACCOUNT-PRIME          PIC X(6).
  4881         16  CM-CERT-EFF-DT                PIC XX.
  4882         16  CM-CERT-NO.
  4883             20  CM-CERT-PRIME             PIC X(10).
  4884             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  93
* EL152.cbl
  4885
  4886     12  CM-CONTROL-BY-NAME.
  4887         16  CM-COMPANY-CD-A1              PIC X.
  4888         16  CM-INSURED-LAST-NAME          PIC X(15).
  4889         16  CM-INSURED-INITIALS.
  4890             20  CM-INSURED-INITIAL1       PIC X.
  4891             20  CM-INSURED-INITIAL2       PIC X.
  4892
  4893     12  CM-CONTROL-BY-SSN.
  4894         16  CM-COMPANY-CD-A2              PIC X.
  4895         16  CM-SOC-SEC-NO.
  4896             20  CM-SSN-STATE              PIC XX.
  4897             20  CM-SSN-ACCOUNT            PIC X(6).
  4898             20  CM-SSN-LN3.
  4899                 25  CM-INSURED-INITIALS-A2.
  4900                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4901                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4902                 25 CM-PART-LAST-NAME-A2         PIC X.
  4903
  4904     12  CM-CONTROL-BY-CERT-NO.
  4905         16  CM-COMPANY-CD-A4              PIC X.
  4906         16  CM-CERT-NO-A4                 PIC X(11).
  4907
  4908     12  CM-CONTROL-BY-MEMB.
  4909         16  CM-COMPANY-CD-A5              PIC X.
  4910         16  CM-MEMBER-NO.
  4911             20  CM-MEMB-STATE             PIC XX.
  4912             20  CM-MEMB-ACCOUNT           PIC X(6).
  4913             20  CM-MEMB-LN4.
  4914                 25  CM-INSURED-INITIALS-A5.
  4915                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4916                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4917                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4918
  4919     12  CM-INSURED-PROFILE-DATA.
  4920         16  CM-INSURED-FIRST-NAME.
  4921             20  CM-INSURED-1ST-INIT       PIC X.
  4922             20  FILLER                    PIC X(9).
  4923         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4924         16  CM-INSURED-SEX                PIC X.
  4925             88  CM-SEX-MALE                  VALUE 'M'.
  4926             88  CM-SEX-FEMAL                 VALUE 'F'.
  4927         16  CM-INSURED-JOINT-AGE          PIC 99.
  4928         16  CM-JOINT-INSURED-NAME.
  4929             20  CM-JT-LAST-NAME           PIC X(15).
  4930             20  CM-JT-FIRST-NAME.
  4931                 24  CM-JT-1ST-INIT        PIC X.
  4932                 24  FILLER                PIC X(9).
  4933             20  CM-JT-INITIAL             PIC X.
  4934
  4935     12  CM-LIFE-DATA.
  4936         16  CM-LF-BENEFIT-CD              PIC XX.
  4937         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4938         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4939         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4940         16  CM-LF-DEV-CODE                PIC XXX.
  4941         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4942         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  94
* EL152.cbl
  4943         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4944         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4945         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4946         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4947         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4948         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4949         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4950         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4951         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4952         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4953         16  cm-temp-epiq                  pic xx.
  4954             88  EPIQ-CLASS                  value 'EQ'.
  4955*        16  FILLER                        PIC XX.
  4956
  4957     12  CM-AH-DATA.
  4958         16  CM-AH-BENEFIT-CD              PIC XX.
  4959         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4960         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4961         16  CM-AH-DEV-CODE                PIC XXX.
  4962         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4963         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4964         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4965         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4966         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4967         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4968         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4969         16  CM-AH-PAID-THRU-DT            PIC XX.
  4970             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4971         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4972         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4973         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4974         16  FILLER                        PIC X.
  4975
  4976     12  CM-LOAN-INFORMATION.
  4977         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4978         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4979                                           PIC S9(5)V99  COMP-3.
  4980         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4981         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4982         16  CM-PAY-FREQUENCY              PIC S99.
  4983         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4984         16  CM-RATE-CLASS                 PIC XX.
  4985         16  CM-BENEFICIARY                PIC X(25).
  4986         16  CM-POLICY-FORM-NO             PIC X(12).
  4987         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4988         16  CM-LAST-ADD-ON-DT             PIC XX.
  4989         16  CM-DEDUCTIBLE-AMOUNTS.
  4990             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4991             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4992         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4993             20  CM-RESIDENT-STATE         PIC XX.
  4994             20  CM-RATE-CODE              PIC X(4).
  4995             20  FILLER                    PIC XX.
  4996         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4997             20  CM-LOAN-OFFICER           PIC X(5).
  4998             20  FILLER                    PIC XXX.
  4999         16  CM-CSR-CODE                   PIC XXX.
  5000         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  95
* EL152.cbl
  5001             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5002         16  CM-POST-CARD-IND              PIC X.
  5003         16  CM-NH-INTERFACE-SW            PIC X.
  5004         16  CM-PREMIUM-TYPE               PIC X.
  5005             88  CM-SING-PRM                  VALUE '1'.
  5006             88  CM-O-B-COVERAGE              VALUE '2'.
  5007             88  CM-OPEN-END                  VALUE '3'.
  5008         16  CM-IND-GRP-TYPE               PIC X.
  5009             88  CM-INDIVIDUAL                VALUE 'I'.
  5010             88  CM-GROUP                     VALUE 'G'.
  5011         16  CM-SKIP-CODE                  PIC X.
  5012             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5013             88  SKIP-JULY                    VALUE '1'.
  5014             88  SKIP-AUGUST                  VALUE '2'.
  5015             88  SKIP-SEPTEMBER               VALUE '3'.
  5016             88  SKIP-JULY-AUG                VALUE '4'.
  5017             88  SKIP-AUG-SEPT                VALUE '5'.
  5018             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5019             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5020             88  SKIP-JUNE                    VALUE '8'.
  5021             88  SKIP-JUNE-JULY               VALUE '9'.
  5022             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5023             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5024         16  CM-PAYMENT-MODE               PIC X.
  5025             88  PAY-MONTHLY                  VALUE SPACE.
  5026             88  PAY-WEEKLY                   VALUE '1'.
  5027             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5028             88  PAY-BI-WEEKLY                VALUE '3'.
  5029             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5030         16  CM-LOAN-NUMBER                PIC X(8).
  5031         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5032         16  CM-OLD-LOF                    PIC XXX.
  5033*        16  CM-LOAN-OFFICER               PIC XXX.
  5034         16  CM-REIN-TABLE                 PIC XXX.
  5035         16  CM-SPECIAL-REIN-CODE          PIC X.
  5036         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5037         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5038         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5039
  5040     12  CM-STATUS-DATA.
  5041         16  CM-ENTRY-STATUS               PIC X.
  5042         16  CM-ENTRY-DT                   PIC XX.
  5043
  5044         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5045         16  CM-LF-CANCEL-DT               PIC XX.
  5046         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5047
  5048         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5049         16  CM-LF-DEATH-DT                PIC XX.
  5050         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5051
  5052         16  CM-LF-CURRENT-STATUS          PIC X.
  5053             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5054                                                'M' '4' '5' '9'.
  5055             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5056             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5057             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5058             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  96
* EL152.cbl
  5059             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5060             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5061             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5062             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5063             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5064             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5065             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5066             88  CM-LF-DECLINED               VALUE 'D'.
  5067             88  CM-LF-VOIDED                 VALUE 'V'.
  5068
  5069         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5070         16  CM-AH-CANCEL-DT               PIC XX.
  5071         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5072
  5073         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5074         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5075         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5076
  5077         16  CM-AH-CURRENT-STATUS          PIC X.
  5078             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5079                                                'M' '4' '5' '9'.
  5080             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5081             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5082             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5083             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5084             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5085             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5086             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5087             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5088             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5089             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5090             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5091             88  CM-AH-DECLINED               VALUE 'D'.
  5092             88  CM-AH-VOIDED                 VALUE 'V'.
  5093
  5094         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5095             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5096             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5097             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5098         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5099
  5100         16  CM-ENTRY-BATCH                PIC X(6).
  5101         16  CM-LF-EXIT-BATCH              PIC X(6).
  5102         16  CM-AH-EXIT-BATCH              PIC X(6).
  5103         16  CM-LAST-MONTH-END             PIC XX.
  5104
  5105     12  CM-NOTE-SW                        PIC X.
  5106         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5107         88  CERT-NOTES-PRESENT               VALUE '1'.
  5108         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5109         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5110         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5111         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5112         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5113         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5114     12  CM-COMP-EXCP-SW                   PIC X.
  5115         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5116         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  97
* EL152.cbl
  5117     12  CM-INSURED-ADDRESS-SW             PIC X.
  5118         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5119         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5120
  5121*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5122     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5123     12  FILLER                            PIC X.
  5124
  5125*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5126     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5127     12  FILLER                            PIC X.
  5128*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5129     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5130
  5131     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5132         88  CERT-ADDED-BATCH                 VALUE ' '.
  5133         88  CERT-ADDED-ONLINE                VALUE '1'.
  5134         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5135         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5136         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5137     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5138         88  CERT-AS-LOADED                   VALUE ' '.
  5139         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5140         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5141         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5142         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5143         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5144         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5145         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5146
  5147     12  CM-ACCOUNT-COMM-PCTS.
  5148         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5149         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5150
  5151     12  CM-USER-FIELD                     PIC X.
  5152     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5153     12  CM-CLP-STATE                      PIC XX.
  5154     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5155     12  CM-USER-RESERVED                  PIC XXX.
  5156     12  FILLER REDEFINES CM-USER-RESERVED.
  5157         16  CM-AH-CLASS-CD                PIC XX.
  5158         16  F                             PIC X.
  5159******************************************************************
  5160
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  98
* EL152.cbl
  5162*                                COPY ERCACCT.
  5163******************************************************************
  5164*                                                                *
  5165*                                                                *
  5166*                            ERCACCT                             *
  5167*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5168*                            VMOD=2.031                          *
  5169*                                                                *
  5170*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5171*                                                                *
  5172*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5173*   VSAM ACCOUNT MASTER FILES.                                   *
  5174*                                                                *
  5175*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5176*                                                                *
  5177*   FILE TYPE = VSAM,KSDS                                        *
  5178*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5179*                                                                *
  5180*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5181*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5182*                                                                *
  5183*   LOG = NO                                                     *
  5184*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5185*                                                                *
  5186*                                                                *
  5187******************************************************************
  5188*                   C H A N G E   L O G
  5189*
  5190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5191*-----------------------------------------------------------------
  5192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5193* EFFECTIVE    NUMBER
  5194*-----------------------------------------------------------------
  5195* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5196* 092705    2005050300006  PEMA  ADD SPP LEASES
  5197* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5198* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5199* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5200* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5201* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5202* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5203******************************************************************
  5204
  5205 01  ACCOUNT-MASTER.
  5206     12  AM-RECORD-ID                      PIC XX.
  5207         88  VALID-AM-ID                      VALUE 'AM'.
  5208
  5209     12  AM-CONTROL-PRIMARY.
  5210         16  AM-COMPANY-CD                 PIC X.
  5211         16  AM-MSTR-CNTRL.
  5212             20  AM-CONTROL-A.
  5213                 24  AM-CARRIER            PIC X.
  5214                 24  AM-GROUPING.
  5215                     28 AM-GROUPING-PREFIX PIC XXX.
  5216                     28 AM-GROUPING-PRIME  PIC XXX.
  5217                 24  AM-STATE              PIC XX.
  5218                 24  AM-ACCOUNT.
  5219                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page  99
* EL152.cbl
  5220                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5221             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5222                                           PIC X(19).
  5223             20  AM-CNTRL-B.
  5224                 24  AM-EXPIRATION-DT      PIC XX.
  5225                 24  FILLER                PIC X(4).
  5226             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5227                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5228
  5229     12  AM-CONTROL-BY-VAR-GRP.
  5230         16  AM-COMPANY-CD-A1              PIC X.
  5231         16  AM-VG-CARRIER                 PIC X.
  5232         16  AM-VG-GROUPING                PIC X(6).
  5233         16  AM-VG-STATE                   PIC XX.
  5234         16  AM-VG-ACCOUNT                 PIC X(10).
  5235         16  AM-VG-DATE.
  5236             20  AM-VG-EXPIRATION-DT       PIC XX.
  5237             20  FILLER                    PIC X(4).
  5238         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5239                                           PIC 9(11)      COMP-3.
  5240     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5241         16  FILLER                        PIC X(10).
  5242         16  AM-VG-KEY3.
  5243             20  AM-VG3-ACCOUNT            PIC X(10).
  5244             20  AM-VG3-EXP-DT             PIC XX.
  5245         16  FILLER                        PIC X(4).
  5246     12  AM-MAINT-INFORMATION.
  5247         16  AM-LAST-MAINT-DT              PIC XX.
  5248         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5249         16  AM-LAST-MAINT-USER            PIC X(4).
  5250         16  FILLER                        PIC XX.
  5251
  5252     12  AM-EFFECTIVE-DT                   PIC XX.
  5253     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5254
  5255     12  AM-PREV-DATES  COMP-3.
  5256         16  AM-PREV-EXP-DT                PIC 9(11).
  5257         16  AM-PREV-EFF-DT                PIC 9(11).
  5258
  5259     12  AM-REPORT-CODE-1                  PIC X(10).
  5260     12  AM-REPORT-CODE-2                  PIC X(10).
  5261
  5262     12  AM-CITY-CODE                      PIC X(4).
  5263     12  AM-COUNTY-PARISH                  PIC X(6).
  5264
  5265     12  AM-NAME                           PIC X(30).
  5266     12  AM-PERSON                         PIC X(30).
  5267     12  AM-ADDRS                          PIC X(30).
  5268     12  AM-CITY.
  5269         16  AM-ADDR-CITY                  PIC X(28).
  5270         16  AM-ADDR-STATE                 PIC XX.
  5271     12  AM-ZIP.
  5272         16  AM-ZIP-PRIME.
  5273             20  AM-ZIP-PRI-1ST            PIC X.
  5274                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5275             20  FILLER                    PIC X(4).
  5276         16  AM-ZIP-PLUS4                  PIC X(4).
  5277     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 100
* EL152.cbl
  5278         16  AM-CAN-POSTAL-1               PIC XXX.
  5279         16  AM-CAN-POSTAL-2               PIC XXX.
  5280         16  FILLER                        PIC XXX.
  5281     12  AM-TEL-NO.
  5282         16  AM-AREA-CODE                  PIC 999.
  5283         16  AM-TEL-PRE                    PIC 999.
  5284         16  AM-TEL-NBR                    PIC 9(4).
  5285     12  AM-TEL-LOC                        PIC X.
  5286         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5287         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5288
  5289     12  AM-COMM-STRUCTURE.
  5290         16  AM-DEFN-1.
  5291             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5292                 24  AM-AGT.
  5293                     28  AM-AGT-PREFIX     PIC X(4).
  5294                     28  AM-AGT-PRIME      PIC X(6).
  5295                 24  AM-COM-TYP            PIC X.
  5296                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5297                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5298                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5299                 24  AM-RECALC-LV-INDIC    PIC X.
  5300                 24  AM-RETRO-LV-INDIC     PIC X.
  5301                 24  AM-GL-CODES           PIC X.
  5302                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5303                 24  FILLER                PIC X(01).
  5304         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5305             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5306                 24  FILLER                PIC X(11).
  5307                 24  AM-L-COMA             PIC XXX.
  5308                 24  AM-J-COMA             PIC XXX.
  5309                 24  AM-A-COMA             PIC XXX.
  5310                 24  FILLER                PIC X(6).
  5311
  5312     12  AM-COMM-CHANGE-STATUS             PIC X.
  5313         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5314
  5315     12  AM-CSR-CODE                       PIC X(4).
  5316
  5317     12  AM-BILLING-STATUS                 PIC X.
  5318         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5319         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5320     12  AM-AUTO-REFUND-SW                 PIC X.
  5321         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5322         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5323     12  AM-GPCD                           PIC 99.
  5324     12  AM-IG                             PIC X.
  5325         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5326         88  AM-HAS-GROUP                     VALUE '2'.
  5327     12  AM-STATUS                         PIC X.
  5328         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5329         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5330         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5331         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5332         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5333         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5334         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5335         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 101
* EL152.cbl
  5336         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5337         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5338     12  AM-REMIT-TO                       PIC 99.
  5339     12  AM-ID-NO                          PIC X(11).
  5340
  5341     12  AM-CAL-TABLE                      PIC XX.
  5342     12  AM-LF-DEVIATION                   PIC XXX.
  5343     12  AM-AH-DEVIATION                   PIC XXX.
  5344     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5345     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5346     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5347     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5348     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5349     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5350
  5351     12  AM-USER-FIELDS.
  5352         16  AM-FLD-1                      PIC XX.
  5353         16  AM-FLD-2                      PIC XX.
  5354         16  AM-FLD-3                      PIC XX.
  5355         16  AM-FLD-4                      PIC XX.
  5356         16  AM-FLD-5                      PIC XX.
  5357
  5358     12  AM-1ST-PROD-DATE.
  5359         16  AM-1ST-PROD-YR                PIC XX.
  5360         16  AM-1ST-PROD-MO                PIC XX.
  5361         16  AM-1ST-PROD-DA                PIC XX.
  5362     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5363     12  AM-CERTS-PURGED-DATE.
  5364         16  AM-PUR-YR                     PIC XX.
  5365         16  AM-PUR-MO                     PIC XX.
  5366         16  AM-PUR-DA                     PIC XX.
  5367     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5368     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5369     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5370     12  AM-INACTIVE-DATE.
  5371         16  AM-INA-MO                     PIC 99.
  5372         16  AM-INA-DA                     PIC 99.
  5373         16  AM-INA-YR                     PIC 99.
  5374     12  AM-AR-HI-CERT-DATE                PIC XX.
  5375
  5376     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5377     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5378
  5379     12  AM-OB-PAYMENT-MODE                PIC X.
  5380         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5381         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5382         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5383         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5384
  5385     12  AM-AH-ONLY-INDICATOR              PIC X.
  5386         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5387         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5388
  5389     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5390
  5391     12  AM-OVER-SHORT.
  5392         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5393         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 102
* EL152.cbl
  5394
  5395     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5396     12  AM-DCC-CLP-STATE                  PIC XX.
  5397
  5398     12  AM-RECALC-COMM                    PIC X.
  5399     12  AM-RECALC-REIN                    PIC X.
  5400
  5401     12  AM-REI-TABLE                      PIC XXX.
  5402     12  AM-REI-ET-LF                      PIC X.
  5403     12  AM-REI-ET-AH                      PIC X.
  5404     12  AM-REI-PE-LF                      PIC X.
  5405     12  AM-REI-PE-AH                      PIC X.
  5406     12  AM-REI-PRT-ST                     PIC X.
  5407     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5408     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5409     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5410     12  AM-REI-GROUP-A                    PIC X(6).
  5411     12  AM-REI-MORT                       PIC X(4).
  5412     12  AM-REI-PRT-OW                     PIC X.
  5413     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5414     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5415     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5416     12  AM-REI-GROUP-B                    PIC X(6).
  5417
  5418     12  AM-TRUST-TYPE                     PIC X(2).
  5419
  5420     12  AM-EMPLOYER-STMT-USED             PIC X.
  5421     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5422
  5423     12  AM-STD-AH-TYPE                    PIC XX.
  5424     12  AM-EARN-METHODS.
  5425         16  AM-EARN-METHOD-R              PIC X.
  5426             88 AM-REF-RL-R78                 VALUE 'R'.
  5427             88 AM-REF-RL-PR                  VALUE 'P'.
  5428             88 AM-REF-RL-MEAN                VALUE 'M'.
  5429             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5430         16  AM-EARN-METHOD-L              PIC X.
  5431             88 AM-REF-LL-R78                 VALUE 'R'.
  5432             88 AM-REF-LL-PR                  VALUE 'P'.
  5433             88 AM-REF-LL-MEAN                VALUE 'M'.
  5434             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5435         16  AM-EARN-METHOD-A              PIC X.
  5436             88 AM-REF-AH-R78                 VALUE 'R'.
  5437             88 AM-REF-AH-PR                  VALUE 'P'.
  5438             88 AM-REF-AH-MEAN                VALUE 'M'.
  5439             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5440             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5441             88 AM-REF-AH-NET                 VALUE 'N'.
  5442
  5443     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5444     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5445     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5446
  5447     12  AM-RET-Y-N                        PIC X.
  5448     12  AM-RET-P-E                        PIC X.
  5449     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5450     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5451     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 103
* EL152.cbl
  5452     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5453         16  AM-POOL-PRIME                 PIC XXX.
  5454         16  AM-POOL-SUB                   PIC XXX.
  5455     12  AM-RETRO-EARNINGS.
  5456         16  AM-RET-EARN-R                 PIC X.
  5457         16  AM-RET-EARN-L                 PIC X.
  5458         16  AM-RET-EARN-A                 PIC X.
  5459     12  AM-RET-ST-TAX-USE                 PIC X.
  5460         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5461         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5462     12  AM-RETRO-BEG-EARNINGS.
  5463         16  AM-RET-BEG-EARN-R             PIC X.
  5464         16  AM-RET-BEG-EARN-L             PIC X.
  5465         16  AM-RET-BEG-EARN-A             PIC X.
  5466     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5467     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5468
  5469     12  AM-USER-SELECT-OPTIONS.
  5470         16  AM-USER-SELECT-1              PIC X(10).
  5471         16  AM-USER-SELECT-2              PIC X(10).
  5472         16  AM-USER-SELECT-3              PIC X(10).
  5473         16  AM-USER-SELECT-4              PIC X(10).
  5474         16  AM-USER-SELECT-5              PIC X(10).
  5475
  5476     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5477
  5478     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5479
  5480     12  AM-RPT045A-SWITCH                 PIC X.
  5481         88  RPT045A-OFF                   VALUE 'N'.
  5482
  5483     12  AM-INSURANCE-LIMITS.
  5484         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5485         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5486
  5487     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5488         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5489
  5490     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5491         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5492         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5493
  5494     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5495
  5496     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5497     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5498     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5499     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5500     12  AM-DCC-UEF-STATE                  PIC XX.
  5501     12  FILLER                            PIC XXX.
  5502     12  AM-REPORT-CODE-3                  PIC X(10).
  5503*    12  FILLER                            PIC X(22).
  5504
  5505     12  AM-RESERVE-DATE.
  5506         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5507         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5508         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5509
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 104
* EL152.cbl
  5510     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5511     12  AM-NOTIFICATION-TYPES.
  5512         16  AM-NOTIF-OF-LETTERS           PIC X.
  5513         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5514         16  AM-NOTIF-OF-REPORTS           PIC X.
  5515         16  AM-NOTIF-OF-STATUS            PIC X.
  5516
  5517     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5518         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5519         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5520         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5521         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5522
  5523     12  AM-BENEFIT-CONTROLS.
  5524         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5525             20  AM-BENEFIT-CODE           PIC XX.
  5526             20  AM-BENEFIT-TYPE           PIC X.
  5527             20  AM-BENEFIT-REVISION       PIC XXX.
  5528             20  AM-BENEFIT-REM-TERM       PIC X.
  5529             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5530             20  FILLER                    PIC XX.
  5531         16  FILLER                        PIC X(80).
  5532
  5533     12  AM-TRANSFER-DATA.
  5534         16  AM-TRANSFERRED-FROM.
  5535             20  AM-TRNFROM-CARRIER        PIC X.
  5536             20  AM-TRNFROM-GROUPING.
  5537                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5538                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5539             20  AM-TRNFROM-STATE          PIC XX.
  5540             20  AM-TRNFROM-ACCOUNT.
  5541                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5542                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5543             20  AM-TRNFROM-DTE            PIC XX.
  5544         16  AM-TRANSFERRED-TO.
  5545             20  AM-TRNTO-CARRIER          PIC X.
  5546             20  AM-TRNTO-GROUPING.
  5547                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5548                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5549             20  AM-TRNTO-STATE            PIC XX.
  5550             20  AM-TRNTO-ACCOUNT.
  5551                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5552                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5553             20  AM-TRNTO-DTE              PIC XX.
  5554         16  FILLER                        PIC X(10).
  5555
  5556     12  AM-SAVED-REMIT-TO                 PIC 99.
  5557
  5558     12  AM-COMM-STRUCTURE-SAVED.
  5559         16  AM-DEFN-1-SAVED.
  5560             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5561                 24  AM-AGT-SV             PIC X(10).
  5562                 24  AM-COM-TYP-SV         PIC X.
  5563                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5564                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5565                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5566                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5567                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 105
* EL152.cbl
  5568                 24  AM-GL-CODES-SV        PIC X.
  5569                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5570                 24  FILLER                PIC X.
  5571         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5572             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5573                 24  FILLER                PIC X(11).
  5574                 24  AM-L-COMA-SV          PIC XXX.
  5575                 24  AM-J-COMA-SV          PIC XXX.
  5576                 24  AM-A-COMA-SV          PIC XXX.
  5577                 24  FILLER                PIC X(6).
  5578
  5579     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5580         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5581            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5582            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5583            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5584
  5585     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5586     12  FILLER                            PIC X(120).
  5587
  5588     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5589         16  AM-CONTROL-NAME               PIC X(30).
  5590         16  AM-EXECUTIVE-ONE.
  5591             20  AM-EXEC1-NAME             PIC X(15).
  5592             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5593                                                          COMP-3.
  5594             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5595                                                          COMP-3.
  5596         16  AM-EXECUTIVE-TWO.
  5597             20  AM-EXEC2-NAME             PIC X(15).
  5598             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5599                                                          COMP-3.
  5600             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5601                                                          COMP-3.
  5602
  5603     12  AM-RETRO-ADDITIONAL-DATA.
  5604         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5605         16  AM-RETRO-PREM-P-E             PIC X.
  5606         16  AM-RETRO-CLMS-P-I             PIC X.
  5607         16  AM-RETRO-RET-BRACKET-LF.
  5608             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5609                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5610                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5611             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5612                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5613                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5614             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5615                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5616                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5617         16  AM-RETRO-RET-BRACKET-AH.
  5618             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5619                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5620                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5621                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5622             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5623                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5624                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5625             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 106
* EL152.cbl
  5626                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5627                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5628
  5629     12  AM-COMMENTS.
  5630         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5631
  5632     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5633         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5634         16  AM-FLI-BILLING-CODE           PIC X.
  5635         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5636         16  AM-FLI-UNITED-IDENT           PIC X.
  5637         16  AM-FLI-INTEREST-LOST-DATA.
  5638             20  AM-FLI-BANK-NO            PIC X(5).
  5639             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5640             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5641             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5642         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5643             20  AM-FLI-AGT                PIC X(9).
  5644             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5645             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5646         16  FILLER                        PIC X(102).
  5647
  5648     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5649         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5650             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5651             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5652             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5653             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5654             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5655         16  FILLER                          PIC X(10).
  5656******************************************************************
  5657
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 107
* EL152.cbl
  5659*                                COPY ELCTEXT.
  5660******************************************************************
  5661*                                                                *
  5662*                                                                *
  5663*                            ELCTEXT.                            *
  5664*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5665*                            VMOD=2.008                          *
  5666*                                                                *
  5667*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5668*                                     FORM LETTERS,              *
  5669*                                     CERT FORM DISPLAY.
  5670*                                                                *
  5671*   FILE TYPE = VSAM,KSDS                                        *
  5672*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5673*                                                                *
  5674*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5675*       ALTERNATE INDEX = NONE                                   *
  5676*                                                                *
  5677*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5678*       ALTERNATE INDEX = NONE                                   *
  5679*                                                                *
  5680*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5681*       ALTERNATE INDEX = NONE                                   *
  5682*                                                                *
  5683*   LOG = NO                                                     *
  5684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5685******************************************************************
  5686 01  TEXT-FILES.
  5687     12  TEXT-FILE-ID                PIC XX.
  5688         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5689         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5690         88  HELP-FILE-TEXT             VALUE 'TH'.
  5691
  5692     12  TX-CONTROL-PRIMARY.
  5693         16  TX-COMPANY-CD           PIC X.
  5694             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5695         16  TX-ACCESS-CD-GENL       PIC X(12).
  5696
  5697         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5698             20  TX-LETTER-NO        PIC X(4).
  5699             20  FILLER              PIC X(8).
  5700
  5701         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5702             20  TX-FORM-NO          PIC X(12).
  5703
  5704         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5705             20  TX-HELP-TYPE        PIC X.
  5706                 88  HELP-FOR-GENERAL   VALUE ' '.
  5707                 88  HELP-BY-SCREEN     VALUE 'S'.
  5708                 88  HELP-BY-ERROR      VALUE 'E'.
  5709             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5710                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5711             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5712                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5713             20  FILLER              PIC X(4).
  5714
  5715         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5716
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 108
* EL152.cbl
  5717     12  TX-PROCESS-CONTROL          PIC XX.
  5718         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5719
  5720     12  TX-TEXT-LINE                PIC X(70).
  5721
  5722     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5723         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5724         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5725         88  TX-VALID-FORM-SQUEEZE-VALUE
  5726                                        VALUE 'Y' ' '.
  5727
  5728     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5729         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5730         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5731         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5732         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5733         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5734         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5735         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5736                                              'K' 'N' ' '
  5737                                              'Z'.
  5738
  5739     12  TX-ARCHIVE-SW               PIC X.
  5740         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5741         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5742         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5743
  5744     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5745     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5746
  5747     12  TX-BSR-CODE                 PIC X.
  5748         88  TX-BSR-LETTER              VALUE 'B'.
  5749         88  TX-NON-BSR-LETTER          VALUE ' '.
  5750
  5751     12  FILLER                      PIC X.
  5752*****************************************************************
  5753
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 109
* EL152.cbl
  5755*                                COPY ELCTRLR.
  5756******************************************************************
  5757*                                                                *
  5758*                            ELCTRLR.                            *
  5759*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5760*                            VMOD=2.014                          *
  5761*                                                                *
  5762*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5763*                                                                *
  5764*   FILE TYPE = VSAM,KSDS                                        *
  5765*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5766*                                                                *
  5767*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5768*       ALTERNATE INDEX = NONE                                   *
  5769*                                                                *
  5770*   LOG = YES                                                    *
  5771*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5772******************************************************************
  5773*                   C H A N G E   L O G
  5774*
  5775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5776*-----------------------------------------------------------------
  5777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5778* EFFECTIVE    NUMBER
  5779*-----------------------------------------------------------------
  5780* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5781* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5782* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5783* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5784* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5785* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5786* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5787* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5788* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5789* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5790* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5791* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5792* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5793* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5794* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5795* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5796* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5797* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5798* 040814    2014030500002  AJRA  ADD ICD CODES
  5799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5800* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5801******************************************************************
  5802 01  ACTIVITY-TRAILERS.
  5803     12  AT-RECORD-ID                    PIC XX.
  5804         88  VALID-AT-ID                       VALUE 'AT'.
  5805
  5806     12  AT-CONTROL-PRIMARY.
  5807         16  AT-COMPANY-CD               PIC X.
  5808         16  AT-CARRIER                  PIC X.
  5809         16  AT-CLAIM-NO                 PIC X(7).
  5810         16  AT-CERT-NO.
  5811             20  AT-CERT-PRIME           PIC X(10).
  5812             20  AT-CERT-SFX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 110
* EL152.cbl
  5813         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5814             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5815             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5816             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5817             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5818             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5819             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5820             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5821             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5822             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5823             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5824             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5825             88  AT-BENEFICIARY-TRL           VALUE +91.
  5826             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5827             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5828             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5829             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5830
  5831     12  AT-TRAILER-TYPE                 PIC X.
  5832         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5833         88  PAYMENT-TR                       VALUE '2'.
  5834         88  AUTO-PAY-TR                      VALUE '3'.
  5835         88  CORRESPONDENCE-TR                VALUE '4'.
  5836         88  ADDRESS-TR                       VALUE '5'.
  5837         88  GENERAL-INFO-TR                  VALUE '6'.
  5838         88  AUTO-PROMPT-TR                   VALUE '7'.
  5839         88  DENIAL-TR                        VALUE '8'.
  5840         88  INCURRED-CHG-TR                  VALUE '9'.
  5841         88  FORM-CONTROL-TR                  VALUE 'A'.
  5842
  5843     12  AT-RECORDED-DT                  PIC XX.
  5844     12  AT-RECORDED-BY                  PIC X(4).
  5845     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5846
  5847     12  AT-TRAILER-BODY                 PIC X(165).
  5848
  5849     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5850         16  AT-RESERVE-CONTROLS.
  5851             20  AT-MANUAL-SW            PIC X.
  5852                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5853             20  AT-FUTURE-SW            PIC X.
  5854                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5855             20  AT-PTC-SW               PIC X.
  5856                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5857             20  AT-IBNR-SW              PIC X.
  5858                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5859             20  AT-PTC-LF-SW            PIC X.
  5860                 88  AT-LF-PTC-USED          VALUE '1'.
  5861             20  AT-CDT-ACCESS-METHOD    PIC X.
  5862                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5863                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5864                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5865             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5866         16  AT-LAST-COMPUTED-DT         PIC XX.
  5867         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5868         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5869         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5870         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 111
* EL152.cbl
  5871         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5872         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5873         16  AT-EXPENSE-CONTROLS.
  5874             20  AT-EXPENSE-METHOD       PIC X.
  5875                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5876                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5877                 88  PERCENT-OF-PMT           VALUE '3'.
  5878                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5879             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5880             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5881         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5882         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5883
  5884         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5885         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5886
  5887*        16  FILLER                      PIC X(53).
  5888         16  FILLER                      PIC X(47).
  5889
  5890         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5891         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5892
  5893         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5894             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5895             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5896*                    C = CLOSED
  5897*                    O = OPEN
  5898             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5899*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5900
  5901     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5902         16  AT-PAYMENT-TYPE             PIC X.
  5903             88  PARTIAL-PAYMENT                VALUE '1'.
  5904             88  FINAL-PAYMENT                  VALUE '2'.
  5905             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5906             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5907             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5908             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5909             88  VOIDED-PAYMENT                 VALUE '9'.
  5910             88  TRANSFER                       VALUE 'T'.
  5911             88  LIFE-INTEREST                  VALUE 'I'.
  5912
  5913         16  AT-CLAIM-TYPE               PIC X.
  5914             88  PAID-FOR-AH                    VALUE 'A'.
  5915             88  PAID-FOR-LIFE                  VALUE 'L'.
  5916             88  PAID-FOR-IUI                   VALUE 'I'.
  5917             88  PAID-FOR-GAP                   VALUE 'G'.
  5918             88  PAID-FOR-FAM                   VALUE 'F'.
  5919         16  AT-CLAIM-PREM-TYPE          PIC X.
  5920             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5921             88  AT-O-B-COVERAGE                VALUE '2'.
  5922             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5923         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5924         16  AT-CHECK-NO                 PIC X(7).
  5925         16  AT-PAID-FROM-DT             PIC XX.
  5926         16  AT-PAID-THRU-DT             PIC XX.
  5927         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5928         16  AT-ACH-PAYMENT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 112
* EL152.cbl
  5929*        16  FILLER                      PIC X.
  5930         16  AT-PAYEES-NAME              PIC X(30).
  5931         16  AT-PAYMENT-ORIGIN           PIC X.
  5932             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5933             88  ONLINE-AUTO-PMT                VALUE '2'.
  5934             88  OFFLINE-PMT                    VALUE '3'.
  5935         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5936         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5937         16  AT-VOID-DATA.
  5938             20  AT-VOID-DT              PIC XX.
  5939*00144       20  AT-VOID-REASON          PIC X(30).
  5940             20  AT-VOID-REASON          PIC X(26).
  5941         16  AT-PMT-APPROVED-BY          PIC X(04).
  5942         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5943         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5944         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5945                                         PIC S99V9(5)  COMP-3.
  5946         16  AT-CREDIT-INTERFACE.
  5947             20  AT-PMT-SELECT-DT        PIC XX.
  5948                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5949             20  AT-PMT-ACCEPT-DT        PIC XX.
  5950                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5951             20  AT-VOID-SELECT-DT       PIC XX.
  5952                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5953             20  AT-VOID-ACCEPT-DT       PIC XX.
  5954                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5955
  5956         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5957                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5958                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5959         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5960
  5961         16  AT-FORCE-CONTROL            PIC X.
  5962             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5963         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5964         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5965         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5966         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5967         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5968         16  AT-BENEFIT-TYPE             PIC X.
  5969
  5970         16  AT-EXPENSE-TYPE             PIC X.
  5971         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5972
  5973         16  AT-PAYEE-TYPE-CD.
  5974             20  AT-PAYEE-TYPE           PIC X.
  5975                 88  INSURED-PAID           VALUE 'I'.
  5976                 88  BENEFICIARY-PAID       VALUE 'B'.
  5977                 88  ACCOUNT-PAID           VALUE 'A'.
  5978                 88  OTHER-1-PAID           VALUE 'O'.
  5979                 88  OTHER-2-PAID           VALUE 'Q'.
  5980                 88  DOCTOR-PAID            VALUE 'P'.
  5981                 88  EMPLOYER-PAID          VALUE 'E'.
  5982             20  AT-PAYEE-SEQ            PIC X.
  5983
  5984         16  AT-CASH-PAYMENT             PIC X.
  5985         16  AT-GROUPED-PAYMENT          PIC X.
  5986         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 113
* EL152.cbl
  5987         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5988         16  AT-APPROVED-LEVEL           PIC X.
  5989         16  AT-VOID-TYPE                PIC X.
  5990             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5991             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5992         16  AT-AIG-UNEMP-IND            PIC X.
  5993             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5994         16  AT-ASSOCIATES               PIC X.
  5995             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5996             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5997
  5998         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5999         16  AT-CV-PMT-CODE              PIC X.
  6000             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6001             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6002             88  FULL-ADD-PAYMENT           VALUE '3'.
  6003             88  HALF-ADD-PAYMENT           VALUE '4'.
  6004             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6005             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6006             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6007             88  ADDL-PAYMENT               VALUE '8'.
  6008
  6009         16  AT-EOB-CODE1                PIC XXX.
  6010         16  AT-EOB-CODE2                PIC XXX.
  6011         16  AT-EOB-CODE3                PIC XXX.
  6012         16  FILLER REDEFINES AT-EOB-CODE3.
  6013             20  AT-PRINT-CLM-FORM       PIC X.
  6014             20  AT-PRINT-SURVEY         PIC X.
  6015             20  AT-SPECIAL-RELEASE      PIC X.
  6016         16  AT-EOB-CODE4                PIC XXX.
  6017         16  FILLER REDEFINES AT-EOB-CODE4.
  6018             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6019             20  FILLER                  PIC X.
  6020         16  AT-EOB-CODE5                PIC XXX.
  6021         16  FILLER REDEFINES AT-EOB-CODE5.
  6022             20  AT-PMT-PROOF-DT         PIC XX.
  6023             20  FILLER                  PIC X.
  6024
  6025         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6026             88  AT-PRINT-EOB            VALUE 'Y'.
  6027
  6028         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6029         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6030
  6031     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6032         16  AT-SCHEDULE-START-DT        PIC XX.
  6033         16  AT-SCHEDULE-END-DT          PIC XX.
  6034         16  AT-TERMINATED-DT            PIC XX.
  6035         16  AT-LAST-PMT-TYPE            PIC X.
  6036             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6037             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6038         16  AT-FIRST-PMT-DATA.
  6039             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6040             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6041             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6042         16  AT-REGULAR-PMT-DATA.
  6043             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6044             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 114
* EL152.cbl
  6045             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6046         16  AT-AUTO-PAYEE-CD.
  6047             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6048                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6049                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6050                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6051                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6052                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6053             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6054         16  AT-AUTO-PAY-DAY             PIC 99.
  6055         16  AT-AUTO-CASH                PIC X.
  6056             88  AT-CASH                      VALUE 'Y'.
  6057             88  AT-NON-CASH                  VALUE 'N'.
  6058*        16  FILLER                      PIC X(129).
  6059         16  AT-AUTO-END-LETTER          PIC X(4).
  6060         16  FILLER                      PIC X(125).
  6061
  6062         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6063         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6064
  6065     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6066         16  AT-LETTER-SENT-DT           PIC XX.
  6067         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6068         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6069         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6070         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6071         16  AT-LETTER-ORIGIN            PIC X.
  6072             88  ONLINE-CREATION              VALUE '1' '3'.
  6073             88  OFFLINE-CREATION             VALUE '2' '4'.
  6074             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6075             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6076         16  AT-STD-LETTER-FORM          PIC X(4).
  6077         16  AT-REASON-TEXT              PIC X(70).
  6078         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6079         16  AT-ADDRESEE-TYPE            PIC X.
  6080              88  INSURED-ADDRESEE            VALUE 'I'.
  6081              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6082              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6083              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6084              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6085              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6086              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6087         16  AT-ADDRESSEE-NAME           PIC X(30).
  6088         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6089         16  AT-RESEND-PRINT-DATE        PIC XX.
  6090         16  AT-CORR-SOL-UNSOL           PIC X.
  6091         16  AT-LETTER-PURGED-DT         PIC XX.
  6092*
  6093*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6094*
  6095         16  AT-CSO-REDEFINITION.
  6096             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6097             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6098             20  AT-LETTER-TO-BENE       PIC X(1).
  6099             20  AT-STOP-LETTER-DT       PIC X(2).
  6100             20  FILLER                  PIC X(19).
  6101*             20  FILLER                  PIC X(27).
  6102             20  AT-CSO-LETTER-STATUS    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 115
* EL152.cbl
  6103                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6104                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6105                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6106             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6107             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6108*
  6109*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6110*
  6111*        16  FILLER                      PIC X(26).
  6112*
  6113*        16  AT-DMD-BSR-CODE             PIC X.
  6114*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6115*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6116*
  6117*        16  AT-DMD-LETTER-STATUS        PIC X.
  6118*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6119*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6120*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6121*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6122*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6123
  6124         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6125         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6126
  6127     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6128         16  AT-ADDRESS-TYPE             PIC X.
  6129             88  INSURED-ADDRESS               VALUE 'I'.
  6130             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6131             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6132             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6133             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6134             88  OTHER-ADDRESS-1               VALUE 'O'.
  6135             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6136         16  AT-MAIL-TO-NAME             PIC X(30).
  6137         16  AT-ADDRESS-LINE-1           PIC X(30).
  6138         16  AT-ADDRESS-LINE-2           PIC X(30).
  6139         16  AT-CITY-STATE.
  6140             20  AT-CITY                 PIC X(28).
  6141             20  AT-STATE                PIC XX.
  6142         16  AT-ZIP.
  6143             20  AT-ZIP-CODE.
  6144                 24  AT-ZIP-1ST          PIC X.
  6145                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6146                 24  FILLER              PIC X(4).
  6147             20  AT-ZIP-PLUS4            PIC X(4).
  6148         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6149             20  AT-CAN-POSTAL-1         PIC XXX.
  6150             20  AT-CAN-POSTAL-2         PIC XXX.
  6151             20  FILLER                  PIC XXX.
  6152         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6153*         16  FILLER                      PIC X(23).
  6154         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6155         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6156         16  FILLER                      PIC X(13).
  6157         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6158         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6159
  6160     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 116
* EL152.cbl
  6161         16  AT-INFO-LINE-1              PIC X(60).
  6162         16  FILLER REDEFINES AT-INFO-LINE-1.
  6163             20  AT-NOTE-ERROR-NO OCCURS 15
  6164                                         PIC X(4).
  6165         16  AT-INFO-LINE-2              PIC X(60).
  6166         16  FILLER REDEFINES AT-INFO-LINE-2.
  6167             20  AT-ICD-CODE-1           PIC X(8).
  6168             20  AT-ICD-CODE-2           PIC X(8).
  6169             20  FILLER                  PIC X(44).
  6170         16  AT-INFO-TRAILER-TYPE        PIC X.
  6171             88  AT-ERRORS-NOTE          VALUE 'E'.
  6172             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6173             88  AT-CALL-NOTE            VALUE 'C'.
  6174             88  AT-MAINT-NOTE           VALUE 'M'.
  6175             88  AT-CERT-CHANGE          VALUE 'X'.
  6176             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6177             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6178             88  AT-CERT-CANCELLED       VALUE 'T'.
  6179         16  AT-CALL-TYPE                PIC X.
  6180             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6181             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6182         16  AT-NOTE-CONTINUATION        PIC X.
  6183             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6184         16  AT-EOB-CODES-EXIST          PIC X.
  6185             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6186         16  FILLER                      PIC X(35).
  6187         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6188         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6189
  6190     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6191         16  AT-PROMPT-LINE-1            PIC X(60).
  6192         16  AT-PROMPT-LINE-2            PIC X(60).
  6193         16  AT-PROMPT-START-DT          PIC XX.
  6194         16  AT-PROMPT-END-DT            PIC XX.
  6195         16  FILLER                      PIC X(35).
  6196         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6197         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6198
  6199     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6200         16  AT-DENIAL-INFO-1            PIC X(60).
  6201         16  AT-DENIAL-INFO-2            PIC X(60).
  6202         16  AT-DENIAL-DT                PIC XX.
  6203         16  AT-RETRACTION-DT            PIC XX.
  6204         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6205*         16  FILLER                      PIC X(31).
  6206         16  AT-DENIAL-PROOF-DT          PIC XX.
  6207         16  FILLER                      PIC X(29).
  6208         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6209         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6210
  6211     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6212         16  AT-OLD-INCURRED-DT          PIC XX.
  6213         16  AT-OLD-REPORTED-DT          PIC XX.
  6214         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6215         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6216         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6217         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6218         16  AT-OLD-PAID-THRU-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 117
* EL152.cbl
  6219         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6220         16  FILLER                      PIC X(26).
  6221         16  AT-OLD-DIAG-CODE            PIC X(6).
  6222         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6223         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6224         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6225         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6226         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6227         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6228         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6229         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6230         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6231         16  FILLER                      PIC X(9).
  6232         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6233
  6234     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6235         16  AT-FORM-SEND-ON-DT          PIC XX.
  6236         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6237         16  AT-FORM-RE-SEND-DT          PIC XX.
  6238         16  AT-FORM-ANSWERED-DT         PIC XX.
  6239         16  AT-FORM-PRINTED-DT          PIC XX.
  6240         16  AT-FORM-REPRINT-DT          PIC XX.
  6241         16  AT-FORM-TYPE                PIC X.
  6242             88  INITIAL-FORM                  VALUE '1'.
  6243             88  PROGRESS-FORM                 VALUE '2'.
  6244         16  AT-INSTRUCT-LN-1            PIC X(28).
  6245         16  AT-INSTRUCT-LN-2            PIC X(28).
  6246         16  AT-INSTRUCT-LN-3            PIC X(28).
  6247         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6248         16  AT-FORM-ADDRESS             PIC X.
  6249             88  FORM-TO-INSURED              VALUE 'I'.
  6250             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6251             88  FORM-TO-OTHER-1              VALUE 'O'.
  6252             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6253         16  AT-RELATED-1.
  6254             20 AT-REL-CARR-1            PIC X.
  6255             20 AT-REL-CLAIM-1           PIC X(7).
  6256             20 AT-REL-CERT-1            PIC X(11).
  6257         16  AT-RELATED-2.
  6258             20 AT-REL-CARR-2            PIC X.
  6259             20 AT-REL-CLAIM-2           PIC X(7).
  6260             20 AT-REL-CERT-2            PIC X(11).
  6261         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6262         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6263         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6264         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6265         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6266         16  AT-STOP-FORM-DT             PIC X(2).
  6267
  6268         16  FILLER                      PIC X(09).
  6269         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6270         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6271******************************************************************
  6272
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 118
* EL152.cbl
  6274*                                COPY ELCBENE.
  6275******************************************************************
  6276*                                                                *
  6277*                            ELCBENE.                            *
  6278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6279*                            VMOD=2.006                          *
  6280*                                                                *
  6281*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6282*                                                                *
  6283*   FILE TYPE = VSAM,KSDS                                        *
  6284*   RECORD SIZE = 500   RECFORM = FIX                            *
  6285*                                                                *
  6286*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6287*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6288*                                                                *
  6289*   LOG = YES                                                    *
  6290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6291*                                                                *
  6292*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6293******************************************************************
  6294*                   C H A N G E   L O G
  6295*
  6296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6297*-----------------------------------------------------------------
  6298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6299* EFFECTIVE    NUMBER
  6300*-----------------------------------------------------------------
  6301* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6302******************************************************************
  6303
  6304 01  BENEFICIARY-MASTER.
  6305     12  BE-RECORD-ID                PIC XX.
  6306         88  VALID-BE-ID                VALUE 'BE'.
  6307
  6308     12  BE-CONTROL-PRIMARY.
  6309         16  BE-COMPANY-CD           PIC X.
  6310         16  BE-RECORD-TYPE          PIC X.
  6311             88  BENEFICIARY-RECORD  VALUE 'B'.
  6312             88  ADJUSTOR-RECORD     VALUE 'A'.
  6313         16  BE-BENEFICIARY          PIC X(10).
  6314     12  BE-CONTROL-BY-NAME.
  6315         16  BE-COMPANY-CD-A1        PIC X.
  6316         16  BE-RECORD-TYPE-A1       PIC X.
  6317         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6318         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6319
  6320     12  BE-LAST-MAINT-DT            PIC XX.
  6321     12  BE-LAST-MAINT-BY            PIC X(4).
  6322     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6323
  6324     12  BE-ADDRESS-DATA.
  6325         16  BE-MAIL-TO-NAME         PIC X(30).
  6326         16  BE-ADDRESS-LINE-1       PIC X(30).
  6327         16  BE-ADDRESS-LINE-2       PIC X(30).
  6328         16  BE-ADDRESS-LINE-3       PIC X(30).
  6329         16  BE-CITY-STATE.
  6330             20  BE-CITY             PIC X(28).
  6331             20  BE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 119
* EL152.cbl
  6332         16  BE-ZIP-CODE.
  6333             20  BE-ZIP-PRIME.
  6334                 24  BE-ZIP-1ST      PIC X.
  6335                     88  BE-CANADIAN-POST-CODE
  6336                                         VALUE 'A' THRU 'Z'.
  6337                 24  FILLER          PIC X(4).
  6338             20  BE-ZIP-PLUS4        PIC X(4).
  6339         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6340             20  BE-CAN-POSTAL-1     PIC XXX.
  6341             20  BE-CAN-POSTAL-2     PIC XXX.
  6342             20  FILLER              PIC XXX.
  6343         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6344         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6345
  6346******************************************************************
  6347*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6348*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6349******************************************************************
  6350     12  BE-CARRIER                  PIC X.
  6351
  6352     12  BE-ADDRESS-DATA2.
  6353         16  BE-MAIL-TO-NAME2        PIC X(30).
  6354         16  BE-ADDRESS-LINE-12      PIC X(30).
  6355         16  BE-ADDRESS-LINE-22      PIC X(30).
  6356         16  BE-ADDRESS-LINE-32      PIC X(30).
  6357         16  BE-CITY-STATE2.
  6358             20  BE-CITY2            PIC X(28).
  6359             20  BE-STATE2           PIC XX.
  6360         16  BE-ZIP-CODE2.
  6361             20  BE-ZIP-PRIME2.
  6362                 24  BE-ZIP-1ST2     PIC X.
  6363                     88  BE-CANADIAN-POST-CODE2
  6364                                         VALUE 'A' THRU 'Z'.
  6365                 24  FILLER          PIC X(4).
  6366             20  BE-ZIP-PLUS42       PIC X(4).
  6367         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6368             20  BE-CAN-POSTAL-12    PIC XXX.
  6369             20  BE-CAN-POSTAL-22    PIC XXX.
  6370             20  FILLER              PIC XXX.
  6371         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6372         16  BE-ACH-DATA.
  6373             20  BE-ACH-YES-OR-NO    PIC X.
  6374                 88  BE-ON-ACH       VALUE 'Y'.
  6375                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6376             20  BE-ACH-ABA-ROUTING-NUMBER
  6377                                     PIC X(15).
  6378             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6379                                     PIC X(20).
  6380             20  FILLER              PIC X(25).
  6381         16  BE-BILLING-STMT-DATA.
  6382*            20  BE-BSR              PIC X.
  6383*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6384*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6385*            20  BE-BSR-FROM         PIC X(30).
  6386*            20  BE-BSR-DEPT         PIC X(30).
  6387             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6388             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6389             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 120
* EL152.cbl
  6390                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6391                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6392
  6393     12  FILLER                      PIC X(28).
  6394******************************************************************
  6395
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 121
* EL152.cbl
  6397*                                COPY ERCCOMP.
  6398******************************************************************
  6399*                                                                *
  6400*                                                                *
  6401*                            ERCCOMP                             *
  6402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6403*                            VMOD=2.019                          *
  6404*                                                                *
  6405*   ONLINE CREDIT SYSTEM                                         *
  6406*                                                                *
  6407*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6408*                                                                *
  6409*   FILE TYPE = VSAM,KSDS                                        *
  6410*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6411*                                                                *
  6412*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6413*       ALTERNATE PATH = NONE                                    *
  6414*                                                                *
  6415*   LOG = NO                                                     *
  6416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6417*                                                                *
  6418******************************************************************
  6419*                   C H A N G E   L O G
  6420*
  6421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6422*-----------------------------------------------------------------
  6423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6424* EFFECTIVE    NUMBER
  6425*-----------------------------------------------------------------
  6426* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6427* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6428* 092205    2005050300006  PEMA  ADD LEASE FEE
  6429* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6430* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6431* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6432* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6433* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6434* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6435******************************************************************
  6436
  6437 01  COMPENSATION-MASTER.
  6438     12  CO-RECORD-ID                          PIC XX.
  6439         88  VALID-CO-ID                          VALUE 'CO'.
  6440
  6441     12  CO-CONTROL-PRIMARY.
  6442         16  CO-COMPANY-CD                     PIC X.
  6443         16  CO-CONTROL.
  6444             20  CO-CTL-1.
  6445                 24  CO-CARR-GROUP.
  6446                     28  CO-CARRIER            PIC X.
  6447                     28  CO-GROUPING.
  6448                         32  CO-GROUP-PREFIX   PIC XXX.
  6449                         32  CO-GROUP-PRIME    PIC XXX.
  6450                 24  CO-RESP-NO.
  6451                     28  CO-RESP-PREFIX        PIC X(4).
  6452                     28  CO-RESP-PRIME         PIC X(6).
  6453             20  CO-CTL-2.
  6454                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 122
* EL152.cbl
  6455                     28  CO-ACCT-PREFIX        PIC X(4).
  6456                     28  CO-ACCT-PRIME         PIC X(6).
  6457         16  CO-TYPE                           PIC X.
  6458             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6459             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6460             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6461
  6462     12  CO-MAINT-INFORMATION.
  6463         16  CO-LAST-MAINT-DT                  PIC XX.
  6464         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6465         16  CO-LAST-MAINT-USER                PIC X(4).
  6466     12  FILLER                                PIC XX.
  6467     12  CO-STMT-TYPE                          PIC XXX.
  6468     12  CO-COMP-TYPE                          PIC X.
  6469         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6470     12  CO-STMT-OWNER                         PIC X(4).
  6471     12  CO-BALANCE-CONTROL                    PIC X.
  6472         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6473         88  CO-NO-BALANCE                        VALUE 'N'.
  6474
  6475     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6476         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6477         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6478         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6479
  6480     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6481         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6482         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6483
  6484     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6485     12  CO-GA-DIRECT-DEP                      PIC X.
  6486     12  CO-FUTURE-SPACE                       PIC X.
  6487         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6488
  6489     12  CO-ACCT-NAME                          PIC X(30).
  6490     12  CO-MAIL-NAME                          PIC X(30).
  6491     12  CO-ADDR-1                             PIC X(30).
  6492     12  CO-ADDR-2                             PIC X(30).
  6493     12  CO-ADDR-3.
  6494         16  CO-ADDR-CITY                      PIC X(27).
  6495         16  CO-ADDR-STATE                     PIC XX.
  6496     12  CO-CSO-1099                           PIC X.
  6497     12  CO-ZIP.
  6498         16  CO-ZIP-PRIME.
  6499             20  CO-ZIP-PRI-1ST                PIC X.
  6500                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6501             20  FILLER                        PIC X(4).
  6502         16  CO-ZIP-PLUS4                      PIC X(4).
  6503     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6504         16  CO-CAN-POSTAL-1                   PIC XXX.
  6505         16  CO-CAN-POSTAL-2                   PIC XXX.
  6506         16  FILLER                            PIC XXX.
  6507     12  CO-SOC-SEC                            PIC X(13).
  6508     12  CO-TELEPHONE.
  6509         16  CO-AREA-CODE                      PIC XXX.
  6510         16  CO-PREFIX                         PIC XXX.
  6511         16  CO-PHONE                          PIC X(4).
  6512
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 123
* EL152.cbl
  6513     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6514
  6515     12  CO-AR-BAL-LEVEL                       PIC X.
  6516         88  CO-AR-REF-LVL                        VALUE '1'.
  6517         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6518         88  CO-AR-BILL-LVL                       VALUE '2'.
  6519         88  CO-AR-AGT-LVL                        VALUE '3'.
  6520         88  CO-AR-FR-LVL                         VALUE '4'.
  6521
  6522     12  CO-AR-NORMAL-PRINT                    PIC X.
  6523         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6524         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6525
  6526     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6527
  6528     12  CO-AR-REPORTING                       PIC X.
  6529         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6530         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6531
  6532     12  CO-AR-PULL-CHECK                      PIC X.
  6533         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6534         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6535
  6536     12  CO-AR-BALANCE-PRINT                   PIC X.
  6537         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6538
  6539     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6540         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6541         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6542         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6543
  6544     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6545
  6546     12  CO-USER-CODE                          PIC X.
  6547     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6548
  6549******************************************************************
  6550*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6551*    THE LAST MONTH END RUN.
  6552******************************************************************
  6553
  6554     12  CO-LAST-ACTIVITY-DATE.
  6555         16  CO-ACT-YEAR                       PIC 99.
  6556         16  CO-ACT-MONTH                      PIC 99.
  6557         16  CO-ACT-DAY                        PIC 99.
  6558
  6559     12  CO-LAST-STMT-DT.
  6560         16  CO-LAST-STMT-YEAR                 PIC 99.
  6561         16  CO-LAST-STMT-MONTH                PIC 99.
  6562         16  CO-LAST-STMT-DAY                  PIC 99.
  6563
  6564     12  CO-MO-END-TOTALS.
  6565         16  CO-MONTHLY-TOTALS.
  6566             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6567             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6568             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6569             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6570             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 124
* EL152.cbl
  6571
  6572         16  CO-AGING-TOTALS.
  6573             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6574             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6575             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6576             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6577
  6578         16  CO-YTD-TOTALS.
  6579             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6580             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6581
  6582         16  CO-OVER-UNDER-TOTALS.
  6583             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6584             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6585
  6586     12  CO-MISCELLANEOUS-TOTALS.
  6587         16  CO-FICA-TOTALS.
  6588             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6589             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6590
  6591         16  CO-CLAIM-TOTALS.
  6592             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6593             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6594
  6595******************************************************************
  6596*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6597*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6598******************************************************************
  6599
  6600     12  CO-CURRENT-TOTALS.
  6601         16  CO-CURRENT-LAST-STMT-DT.
  6602             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6603             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6604             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6605
  6606         16  CO-CURRENT-MONTHLY-TOTALS.
  6607             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6608             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6609             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6610             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6611             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6612
  6613         16  CO-CURRENT-AGING-TOTALS.
  6614             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6615             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6616             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6617             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6618
  6619         16  CO-CURRENT-YTD-TOTALS.
  6620             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6621             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6622
  6623     12  CO-PAID-COMM-TOTALS.
  6624         16  CO-YTD-PAID-COMMS.
  6625             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6626             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6627
  6628     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 125
* EL152.cbl
  6629         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6630         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6631
  6632     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6633         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6634         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6635         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6636         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6637         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6638         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6639         88  CO-FINAL-LETTER                  VALUE 'F'.
  6640         88  CO-RECONCILING                   VALUE 'R'.
  6641         88  CO-PHONE-CALL                    VALUE 'P'.
  6642         88  CO-LEGAL                         VALUE 'L'.
  6643         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6644         88  CO-WRITE-OFF                     VALUE 'W'.
  6645         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6646
  6647     12  CO-CSR-CODE                       PIC X(4).
  6648
  6649     12  CO-GA-STATUS-INFO.
  6650         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6651         16  CO-GA-TERMINATION-DT          PIC XX.
  6652         16  CO-GA-STATUS-CODE             PIC X.
  6653             88  CO-GA-ACTIVE                 VALUE 'A'.
  6654             88  CO-GA-INACTIVE               VALUE 'I'.
  6655             88  CO-GA-PENDING                VALUE 'P'.
  6656         16  CO-GA-COMMENTS.
  6657             20  CO-GA-COMMENT-1           PIC X(40).
  6658             20  CO-GA-COMMENT-2           PIC X(40).
  6659             20  CO-GA-COMMENT-3           PIC X(40).
  6660             20  CO-GA-COMMENT-4           PIC X(40).
  6661
  6662     12  CO-RPTCD2                         PIC X(10).
  6663     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6664         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6665         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6666
  6667     12  CO-TYPE-AGENT                     PIC X(01).
  6668         88  CO-CORPORATION                   VALUE 'C'.
  6669         88  CO-PARTNERSHIP                   VALUE 'P'.
  6670         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6671         88  CO-TRUST                         VALUE 'T'.
  6672         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6673
  6674     12  CO-FAXNO.
  6675         16  CO-FAX-AREA-CODE                  PIC XXX.
  6676         16  CO-FAX-PREFIX                     PIC XXX.
  6677         16  CO-FAX-PHONE                      PIC X(4).
  6678
  6679     12  CO-BANK-INFORMATION.
  6680         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6681         16  CO-BANK-TRANSIT-NON REDEFINES
  6682             CO-BANK-TRANSIT-NO                PIC 9(8).
  6683
  6684         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6685     12  CO-MISC-DEDUCT-INFO REDEFINES
  6686                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 126
* EL152.cbl
  6687         16  CO-MD-GL-ACCT                     PIC X(10).
  6688         16  CO-MD-DIV                         PIC XX.
  6689         16  CO-MD-CENTER                      PIC X(4).
  6690         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6691         16  CO-CREATE-AP-CHECK                PIC X.
  6692         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6693         16  FILLER                            PIC XXX.
  6694     12  CO-ACH-STATUS                         PIC X.
  6695         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6696         88  CO-ACH-PENDING                        VALUE 'P'.
  6697
  6698     12  CO-BILL-SW                            PIC X.
  6699     12  CO-CONTROL-NAME                       PIC X(30).
  6700     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6701     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6702     12  CO-CLP-STATE                          PIC XX.
  6703     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6704     12  CO-SPP-REFUND-EDIT                    PIC X.
  6705
  6706******************************************************************
  6707
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 127
* EL152.cbl
  6709*                                COPY MPCPROD.
  6710*    EJECT
  6711*                                COPY MPCPLCY.
  6712*    EJECT
  6713*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 128
* EL152.cbl
  6715*                                COPY ELCNAPS.
  6716******************************************************************
  6717*                                                                *
  6718*                            ELCNAPS                             *
  6719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6720*                            VMOD=2.003                          *
  6721*                                                                *
  6722*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6723*                                                                *
  6724*        FILE TYPE= VSAM,KSDS                                    *
  6725*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6726*                                                                *
  6727*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6728*                                                                *
  6729*        LOG = YES                                               *
  6730*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6731*                                                                *
  6732******************************************************************
  6733*                   C H A N G E   L O G
  6734*
  6735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6736*-----------------------------------------------------------------
  6737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6738* EFFECTIVE    NUMBER
  6739*-----------------------------------------------------------------
  6740* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6741******************************************************************
  6742
  6743 01  NAPERSOFT-FILE.
  6744     12  NA-RECORD-ID                PIC  XX.
  6745         88  VALID-NA-ID                  VALUE 'NA'.
  6746
  6747     12  NA-CONTROL-PRIMARY.
  6748         16  NA-COMPANY-CD           PIC X.
  6749         16  NA-CARRIER              PIC X.
  6750         16  NA-CLAIM-NO             PIC X(7).
  6751         16  NA-CERT-NO.
  6752             20  NA-CERT-PRIME       PIC X(10).
  6753             20  NA-CERT-SFX         PIC X.
  6754         16  NA-ARCHIVE-NO           PIC 9(8).
  6755
  6756     12  NA-LETTER-INFORMATION.
  6757         16  NA-LETTER-ID            PIC X(4).
  6758         16  NA-PROCESSOR-ID         PIC X(4).
  6759         16  NA-CREATION-DT          PIC X(2).
  6760         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6761         16  NA-FOLLOW-UP-DT         PIC X(2).
  6762         16  NA-RESEND-DT            PIC X(2).
  6763         16  NA-RESEND-LETTER-ID     PIC X(4).
  6764         16  NA-NO-OF-COPIES         PIC 9(2).
  6765         16  NA-ADDRESS-TYPE         PIC X(2).
  6766         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6767         16  NA-RESEND-PRINT-DT      PIC X(2).
  6768         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6769         16  NA-NEXT-DUE-DT          PIC X(2).
  6770         16  NA-AUTOPYDT             PIC X(2).
  6771         16  NA-ENCLOSURE-CD         PIC X(3).
  6772         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 129
* EL152.cbl
  6773         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6774         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6775         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6776         16  FILLER                  PIC X(67).
  6777******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 130
* EL152.cbl
  6779*                                COPY ELCENCC.
  6780******************************************************************
  6781*                                                                *
  6782*                                                                *
  6783*                            ELCENCC                             *
  6784*                            VMOD=2.001                          *
  6785*                                                                *
  6786*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  6787*                                                                *
  6788*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  6789*   A NAPERSOFT DOCUMENT                                         *
  6790*                                                                *
  6791*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  6792*                                                                *
  6793*   FILE TYPE = VSAM,KSDS                                        *
  6794*   RECORD SIZE = 400   RECFORM = FIX                            *
  6795*                                                                *
  6796*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  6797*                                                                *
  6798*   LOG = NO                                                     *
  6799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6800*                                                                *
  6801*                                                                *
  6802******************************************************************
  6803*                   C H A N G E   L O G
  6804*
  6805* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6806*-----------------------------------------------------------------
  6807*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6808* EFFECTIVE    NUMBER
  6809*-----------------------------------------------------------------
  6810* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  6811* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  6812******************************************************************
  6813 01  ENCLOSURE-CODES.
  6814     12  NC-RECORD-ID                      PIC XX.
  6815         88  VALID-NC-ID                      VALUE 'NC'.
  6816     12  NC-CONTROL-PRIMARY.
  6817         16  NC-COMPANY-CD                 PIC X.
  6818         16  NC-REC-TYPE                   PIC X.
  6819             88  NC-CLAIMS                   VALUE '1'.
  6820             88  NC-ADMIN                    VALUE '2'.
  6821         16  NC-ENC-CODE                   PIC X(5).
  6822         16  FILLER                        PIC X(09).
  6823     12  NC-MAINT-INFORMATION.
  6824         16  NC-LAST-MAINT-DT              PIC XX.
  6825         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6826         16  NC-LAST-MAINT-USER            PIC X(4).
  6827         16  FILLER                        PIC XX.
  6828     12  NC-OUTPUT-STACK                   PIC XXX.
  6829     12  NC-ENCLOSURE-LINE                 PIC X(100).
  6830     12  NC-ATTACHMENTS                    PIC X(255).
  6831     12  NC-FUTURE                         PIC X(12).
  6832******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 131
* EL152.cbl
  6834*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6835*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6836
  6837*01  SYSTEM-VARIABLES            PIC X(3851).
  6838*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6839*    12  SYS-VAR-CODE            PIC X(4).
  6840*    12  SYS-VAR-LEN             PIC 99.
  6841*    12  SYS-VAR-DATA            PIC X(100).
  6842
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 132
* EL152.cbl
  6844 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6845                          CONTROL-FILE LETTER-ARCHIVE
  6846                          LETTER-ARCHIVE-TEMP
  6847                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6848                          TEXT-FILES ACTIVITY-TRAILERS
  6849                          BENEFICIARY-MASTER
  6850                          COMPENSATION-MASTER NAPERSOFT-FILE
  6851                          ENCLOSURE-CODES.
  6852 0000-DFHEXIT SECTION.
  6853     MOVE '9#                    $   ' TO DFHEIV0.
  6854     MOVE 'EL152' TO DFHEIV1.
  6855     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6856
  6857     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6858     MOVE '5'                   TO DC-OPTION-CODE.
  6859     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6860     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6861     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6862
  6863     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6864     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6865     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6866                                TO EMI-SAVE-AREA.
  6867
  6868     MOVE EIBTRMID              TO TS-TERM-TEXT
  6869                                   TS-TERM-SCREEN
  6870                                   QID-TERM.
  6871
  6872     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6873
  6874*    IF PI-COMPANY-ID = 'DMD'
  6875*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6876*       MOVE '6'                    TO DC-OPTION-CODE
  6877*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6878*       MOVE +0                     TO DC-ELAPSED-DAYS
  6879*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6880*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6881
  6882
  6883* EXEC CICS HANDLE CONDITION
  6884*        PGMIDERR (9600-PGMID-ERROR)
  6885*        MAPFAIL  (0325-MAPFAIL)
  6886*        ERROR    (9990-ABEND)
  6887*    END-EXEC.
  6888*    MOVE '"$L?.                 ! " #00006878' TO DFHEIV0
  6889     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6891     MOVE X'2220233030303036383738' TO DFHEIV0(25:11)
  6892     CALL 'kxdfhei1' USING DFHEIV0
  6893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6894
  6895
  6896     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6897
  6898* EXEC CICS READQ TS
  6899*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6900*            INTO    (SECURITY-CONTROL)
  6901*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 133
* EL152.cbl
  6902*            ITEM    (SC-ITEM)
  6903*        END-EXEC
  6904*    MOVE '*$II   L              ''   #00006885' TO DFHEIV0
  6905     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6907     MOVE X'2020233030303036383835' TO DFHEIV0(25:11)
  6908     CALL 'kxdfhei1' USING DFHEIV0,
  6909           PI-SECURITY-TEMP-STORE-ID,
  6910           SECURITY-CONTROL,
  6911           SC-COMM-LENGTH,
  6912           SC-ITEM,
  6913           DFHEIV99,
  6914           DFHEIV99
  6915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6916         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6917         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6918
  6919     set P to address of KIXSYS
  6920     CALL "getenv" using by value P returning var-ptr
  6921     if var-ptr = null then
  6922        display ' kixsys not set '
  6923     else
  6924        set address of var to var-ptr
  6925        move 0 to env-var-len
  6926        inspect var tallying env-var-len
  6927          for characters before X'00'
  6928        unstring var (1:env-var-len) delimited by '/'
  6929           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6930              WS-KIX-SYS
  6931        end-unstring
  6932     end-if
  6933     IF EIBCALEN = 0
  6934         GO TO 8800-UNAUTHORIZED-ACCESS.
  6935
  6936     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6937         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6938             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6939             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6940             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6941             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6942             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6943             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6944             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6945             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6946             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6947             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6948             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6949             MOVE SPACES              TO PI-WA
  6950                                         PI-FORCE-7840
  6951             MOVE ZEROS               TO PI-TOTAL-LINES
  6952                                         PI-CURRENT-LINE
  6953                                         PI-TEMP-STOR-ITEMS
  6954                                         PI-UPDATE-SW
  6955                                         PI-ADDR-SEQ
  6956             MOVE '2'                 TO PI-ACTION
  6957             MOVE LOW-VALUES          TO EL152AO
  6958                                         PI-ADDR-TYPE
  6959             GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 134
* EL152.cbl
  6960         ELSE
  6961             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6962             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6963             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6964             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6965             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6966             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6967             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6968             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6969             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6970             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6971             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6972             IF PGM-NAME = PGM-EL141
  6973                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6974                SET TB-INDX TO PI-CURRENT-LINE
  6975                PERFORM 400-SET-CODES       THRU 499-EXIT
  6976                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6977                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6978                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6979                        SC-INDX > NUM-LINES-PER-SCREEN
  6980                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6981                MOVE AL-UANON           TO PRINTERA
  6982                GO TO 8100-SEND-INITIAL-MAP
  6983             ELSE
  6984                SET TB-INDX TO PI-CURRENT-LINE
  6985                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6986                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6987                        SC-INDX > NUM-LINES-PER-SCREEN
  6988                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6989                MOVE AL-UANON           TO PRINTERA
  6990                GO TO 8100-SEND-INITIAL-MAP.
  6991
  6992*0100-PA.
  6993*    MOVE ER-0008                TO EMI-ERROR.
  6994*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6995*    MOVE -1                     TO MAINTL.
  6996*    GO TO 8200-SEND-DATAONLY.
  6997
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 135
* EL152.cbl
  6999 0200-RECEIVE.
  7000     MOVE TRANS-ID         TO EIBTRNID.
  7001     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  7002     MOVE LOW-VALUES       TO EL152AI.
  7003     MOVE '104A'           TO TS-ID-TEXT.
  7004     MOVE EIBTRMID         TO TS-TERM-TEXT
  7005                              TS-TERM-SCREEN
  7006                              QID-TERM.
  7007
  7008
  7009* EXEC CICS HANDLE AID
  7010*        CLEAR    (9400-CLEAR)
  7011*        PA1      (0100-PA)
  7012*        PA2      (0100-PA)
  7013*        PA3      (0100-PA)
  7014*    END-EXEC.
  7015*    MOVE '"&=!"#               V! # #00006983' TO DFHEIV0
  7016     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  7017     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  7018     MOVE X'2320233030303036393833' TO DFHEIV0(25:11)
  7019     CALL 'kxdfhei1' USING DFHEIV0
  7020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7021
  7022
  7023
  7024* EXEC CICS HANDLE CONDITION
  7025*        MAPFAIL  (0325-MAPFAIL)
  7026*    END-EXEC.
  7027*    MOVE '"$?                   ! $ #00006990' TO DFHEIV0
  7028     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  7029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7030     MOVE X'2420233030303036393930' TO DFHEIV0(25:11)
  7031     CALL 'kxdfhei1' USING DFHEIV0
  7032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7033
  7034
  7035
  7036* EXEC CICS SYNCPOINT
  7037*    END-EXEC.
  7038*    MOVE '6"                    !   #00006994' TO DFHEIV0
  7039     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7041     MOVE X'2020233030303036393934' TO DFHEIV0(25:11)
  7042     CALL 'kxdfhei1' USING DFHEIV0
  7043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7044
  7045
  7046     IF LOWER-CASE-LETTERS-USED
  7047
  7048* EXEC CICS RECEIVE
  7049*            MAP      (MAP-NAME)
  7050*            MAPSET   (MAPSET-NAME)
  7051*            INTO     (EL152AI)
  7052*            ASIS
  7053*       END-EXEC
  7054     MOVE LENGTH OF
  7055      EL152AI
  7056       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 136
* EL152.cbl
  7057*    MOVE '8"TAI  L              ''   #00006998' TO DFHEIV0
  7058     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7060     MOVE X'2020233030303036393938' TO DFHEIV0(25:11)
  7061     CALL 'kxdfhei1' USING DFHEIV0,
  7062           MAP-NAME,
  7063           EL152AI,
  7064           DFHEIV11,
  7065           MAPSET-NAME,
  7066           DFHEIV99,
  7067           DFHEIV99
  7068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7069      ELSE
  7070
  7071* EXEC CICS RECEIVE
  7072*            MAP      (MAP-NAME)
  7073*            MAPSET   (MAPSET-NAME)
  7074*            INTO     (EL152AI)
  7075*       END-EXEC.
  7076     MOVE LENGTH OF
  7077      EL152AI
  7078       TO DFHEIV11
  7079*    MOVE '8"T I  L              ''   #00007005' TO DFHEIV0
  7080     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7082     MOVE X'2020233030303037303035' TO DFHEIV0(25:11)
  7083     CALL 'kxdfhei1' USING DFHEIV0,
  7084           MAP-NAME,
  7085           EL152AI,
  7086           DFHEIV11,
  7087           MAPSET-NAME,
  7088           DFHEIV99,
  7089           DFHEIV99
  7090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7091
  7092
  7093     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  7094         MOVE 'READ'             TO  SM-READ
  7095         PERFORM 9995-SECURITY-VIOLATION
  7096         MOVE ER-0070            TO  EMI-ERROR
  7097         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7098         GO TO 8100-SEND-INITIAL-MAP.
  7099
  7100     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  7101     MOVE 'N'                    TO CLEANI
  7102
  7103     IF ENTERPFL = 0
  7104         GO TO 0300-CHECK-PFKEYS.
  7105     IF EIBAID NOT = DFHENTER
  7106         MOVE ER-0004            TO EMI-ERROR
  7107         GO TO 0320-INPUT-ERROR.
  7108     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7109         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7110     ELSE
  7111         MOVE ER-0029            TO EMI-ERROR
  7112         GO TO 0320-INPUT-ERROR.
  7113
  7114 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 137
* EL152.cbl
  7115     IF EIBAID = DFHPF23
  7116         GO TO 8810-PF23.
  7117     IF EIBAID = DFHPF24
  7118         GO TO 9200-RETURN-MAIN-MENU.
  7119*    IF EIBAID = DFHPF12
  7120*        GO TO 9500-PF12.
  7121     IF EIBAID = DFHPF1
  7122         MOVE 7                  TO ROLL-COUNTER
  7123         GO TO 7900-ROLL-PAGE.
  7124     IF EIBAID = DFHPF2
  7125         MOVE -7                 TO ROLL-COUNTER
  7126         GO TO 7900-ROLL-PAGE.
  7127     IF EIBAID = DFHPF3
  7128         GO TO 6100-ADDR-MAINT.
  7129     IF EIBAID = DFHPF4
  7130         IF MODIFY-CAP
  7131             GO TO 6200-EDIT-MODE
  7132         ELSE
  7133             MOVE 'UPDATE'       TO  SM-READ
  7134             PERFORM 9995-SECURITY-VIOLATION
  7135             MOVE ER-0070        TO  EMI-ERROR
  7136             GO TO 0320-INPUT-ERROR.
  7137
  7138     IF EIBAID = DFHPF5
  7139         GO TO 0330-FUNCTION-CHECK.
  7140
  7141     IF EIBAID = DFHPF6
  7142         GO TO 0330-FUNCTION-CHECK.
  7143
  7144     IF EIBAID = DFHPF7
  7145        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7146        GO TO 7900-ROLL-PAGE.
  7147
  7148     IF EIBAID = DFHPF8
  7149        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  7150        GO TO 7900-ROLL-PAGE.
  7151
  7152*    IF EIBAID = DFHPF9 AND
  7153*       PI-COMPANY-ID = 'DMD'
  7154*        MOVE '1'           TO PI-FORCE-7840
  7155*        GO TO 0330-FUNCTION-CHECK.
  7156
  7157     IF EIBAID = DFHENTER
  7158         GO TO 0330-FUNCTION-CHECK.
  7159
  7160     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7161
  7162     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  7163     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7164             VARYING SC-INDX FROM 1 BY 1
  7165             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7166
  7167     MOVE ER-0029                TO EMI-ERROR.
  7168 0320-INPUT-ERROR.
  7169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7170     MOVE AL-UNBON               TO ENTERPFA.
  7171     IF ENTERPFL = 0
  7172         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 138
* EL152.cbl
  7173     ELSE
  7174         MOVE -1                 TO ENTERPFL.
  7175
  7176     GO TO 8200-SEND-DATAONLY.
  7177
  7178 0100-PA.
  7179     MOVE ER-0008                TO EMI-ERROR.
  7180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7181     MOVE -1                     TO MAINTL.
  7182     GO TO 8200-SEND-DATAONLY.
  7183
  7184 0325-MAPFAIL.
  7185***********************************************************
  7186*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7187*      LETTERS ON A 3275 PRINTER.                         *
  7188***********************************************************
  7189
  7190     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  7191
  7192     SET TB-INDX         TO PI-CURRENT-LINE.
  7193     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  7194                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  7195                  SC-INDX > NUM-LINES-PER-SCREEN.
  7196
  7197     GO TO 8100-SEND-INITIAL-MAP.
  7198
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 139
* EL152.cbl
  7200 0330-FUNCTION-CHECK.
  7201     IF NOT MODIFY-CAP
  7202         IF MAINTI = 'S'
  7203             NEXT SENTENCE
  7204         ELSE
  7205             MOVE 'UPDATE'           TO  SM-READ
  7206             PERFORM 9995-SECURITY-VIOLATION
  7207             MOVE ER-0070            TO  EMI-ERROR
  7208             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7209             GO TO 8100-SEND-INITIAL-MAP.
  7210
  7211     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7212
  7213     IF EIBAID = DFHPF5
  7214      IF PI-PROMPT-LETTER = 'Y'
  7215         MOVE ER-0894            TO EMI-ERROR
  7216         MOVE -1             TO MAINTL
  7217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7218         MOVE AL-UABON       TO MAINTA
  7219         GO TO 8200-SEND-DATAONLY
  7220      ELSE
  7221         IF MAINTI NOT = 'C'
  7222             MOVE ER-0716        TO EMI-ERROR
  7223             MOVE -1             TO MAINTL
  7224             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7225             MOVE AL-UABON       TO MAINTA
  7226             GO TO 8200-SEND-DATAONLY
  7227         ELSE
  7228             IF MODIFY-CAP
  7229                 GO TO 6400-LETTER-RELEASE
  7230             ELSE
  7231                 IF PRINT-PERFORMED
  7232                     GO TO 6400-LETTER-RELEASE
  7233                 ELSE
  7234                     MOVE AL-UNBON TO ENTERPFA
  7235                     MOVE -1       TO ENTERPFL
  7236                     MOVE ER-2398 TO EMI-ERROR
  7237                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7238                     GO TO 8200-SEND-DATAONLY.
  7239
  7240     IF EIBAID = DFHPF6
  7241      IF PI-PROMPT-LETTER = 'Y'
  7242         MOVE ER-0894            TO EMI-ERROR
  7243         MOVE -1             TO MAINTL
  7244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7245         MOVE AL-UABON       TO MAINTA
  7246         GO TO 8200-SEND-DATAONLY
  7247      ELSE
  7248         GO TO 7800-PRINT-LETTER-NOW.
  7249
  7250     IF MAINTI = 'S'
  7251         GO TO 1000-SHOW.
  7252
  7253     IF MAINTI = 'C'
  7254         GO TO 2000-CREATE.
  7255
  7256     IF MAINTI = 'R'
  7257        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 140
* EL152.cbl
  7258           MOVE ER-0070          TO EMI-ERROR
  7259           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7260           MOVE LOW-VALUES       TO EL152AO
  7261           GO TO 8100-SEND-INITIAL-MAP
  7262          ELSE
  7263           GO TO 3000-RECORD.
  7264
  7265     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7266     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7267     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7268                                 THRU 7960-EXIT
  7269        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7270        SC-INDX > NUM-LINES-PER-SCREEN
  7271     MOVE ER-0023                TO EMI-ERROR.
  7272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7273     MOVE -1                     TO MAINTL.
  7274     MOVE AL-UABON               TO MAINTA.
  7275     GO TO 8200-SEND-DATAONLY.
  7276
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 141
* EL152.cbl
  7278 0350-EDIT-ROUTINE.
  7279     PERFORM 400-SET-CODES THRU 499-EXIT.
  7280     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7281                            ACTV-CLAIM.
  7282
  7283     IF ADDRL NOT = +0
  7284        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7285        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7286        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7287                          'O' OR 'Q' OR 'E'
  7288           MOVE AL-UANON         TO ADDRA
  7289        ELSE
  7290           MOVE -1               TO ADDRL
  7291           MOVE AL-UABON         TO ADDRA
  7292           MOVE ER-0176          TO EMI-ERROR
  7293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7294*     ELSE
  7295*       IF PI-COMPANY-ID = 'DMD'
  7296*        IF MAINTI = 'C' OR 'R'
  7297*          MOVE -1               TO ADDRL
  7298*          MOVE AL-UABON         TO ADDRA
  7299*          MOVE ER-0861          TO EMI-ERROR
  7300*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7301
  7302     IF ADDRL NOT = +0
  7303        IF WS-ADDR-SEQ NOT NUMERIC
  7304           MOVE -1               TO ADDRL
  7305           MOVE AL-UABON         TO ADDRA
  7306           MOVE ER-0176          TO EMI-ERROR
  7307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7308
  7309*    IF ADDRL NOT = +0
  7310*       IF PI-COMPANY-ID = 'DMD'
  7311*          IF WS-ADDR-TYPE = 'B' AND
  7312*             WS-ADDR-SEQ NOT = '9'
  7313*                MOVE -1               TO ADDRL
  7314*                MOVE AL-UABON         TO ADDRA
  7315*                MOVE ER-7842          TO EMI-ERROR
  7316*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7317
  7318     IF FORML NOT = ZEROS
  7319        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7320
  7321     IF MAINTI = 'C' AND FORML = ZEROS
  7322        MOVE -1                  TO FORML
  7323        MOVE ER-0177             TO EMI-ERROR
  7324        MOVE AL-UABON            TO FORMA
  7325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7326
  7327     IF FOLLOWL NOT = ZEROS
  7328        MOVE FOLLOWI             TO DEEDIT-FIELD
  7329        PERFORM 8600-DEEDIT
  7330        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7331        MOVE '4'                 TO DC-OPTION-CODE
  7332        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7333        IF DATE-CONVERSION-ERROR
  7334           MOVE ER-0182          TO EMI-ERROR
  7335           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 142
* EL152.cbl
  7336           MOVE AL-UABON         TO FOLLOWA
  7337           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7338        ELSE
  7339*          IF (PI-COMPANY-ID = 'DMD') AND
  7340*             (NOT FORCE-7840)        AND
  7341*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7342*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7343*              MOVE AL-SABON         TO PFKEY9A
  7344*              MOVE ER-7840          TO EMI-ERROR
  7345*              MOVE -1               TO FOLLOWL
  7346*              MOVE AL-UABON         TO FOLLOWA
  7347*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7348*          ELSE
  7349             MOVE SPACES                TO PFKEY9O
  7350             MOVE AL-SADON              TO PFKEY9A
  7351             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7352             MOVE AL-UANON              TO FOLLOWA
  7353             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7354     ELSE
  7355        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7356
  7357     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7358        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7359           MOVE ER-0533          TO EMI-ERROR
  7360           MOVE AL-UABON         TO FOLLOWA
  7361           MOVE -1               TO FOLLOWL
  7362           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7363
  7364     IF RESENDL NOT = ZEROS
  7365        MOVE RESENDI             TO DEEDIT-FIELD
  7366        PERFORM 8600-DEEDIT
  7367        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7368        MOVE '4'                 TO DC-OPTION-CODE
  7369        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7370        IF DATE-CONVERSION-ERROR
  7371           MOVE ER-0185          TO EMI-ERROR
  7372           MOVE -1               TO RESENDL
  7373           MOVE AL-UABON         TO RESENDA
  7374           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7375         ELSE
  7376*          IF (PI-COMPANY-ID = 'DMD') AND
  7377*             (NOT FORCE-7840)        AND
  7378*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7379*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7380*              MOVE AL-SABON         TO PFKEY9A
  7381*              MOVE ER-7840          TO EMI-ERROR
  7382*              MOVE -1               TO RESENDL
  7383*              MOVE AL-UABON         TO RESENDA
  7384*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7385*          ELSE
  7386             MOVE SPACES                 TO PFKEY9O
  7387             MOVE AL-SADON               TO PFKEY9A
  7388             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7389             MOVE AL-UANON               TO RESENDA
  7390             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7391     ELSE
  7392        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7393
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 143
* EL152.cbl
  7394     IF RESEND-SAVE NOT = LOW-VALUES
  7395        IF RESEND-SAVE NOT > CURRENT-SAVE
  7396           MOVE ER-0537          TO EMI-ERROR
  7397           MOVE AL-UABON         TO RESENDA
  7398           MOVE -1               TO RESENDL
  7399           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7400
  7401     IF PRINTL NOT = ZEROS
  7402        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7403        IF PRINTI = 'Y' OR = ' '
  7404           MOVE AL-UANON         TO PRINTA
  7405        ELSE
  7406           MOVE ER-0183          TO EMI-ERROR
  7407           MOVE -1               TO PRINTL
  7408           MOVE AL-UABON         TO PRINTA
  7409           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7410
  7411     MOVE 'Y'                    TO CLEANO
  7412     IF ENCL <= ZEROS
  7413        MOVE 'N'                 TO CLEANO
  7414     END-IF
  7415     IF ENCL > ZEROS
  7416        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7417                                          PI-ENCLOSURE-CD
  7418        MOVE SPACES             TO ELENCC-KEY
  7419        MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  7420        MOVE '1'                TO ELENCC-REC-TYPE
  7421        MOVE ENCI               TO ELENCC-ENC-CODE
  7422
  7423
  7424* EXEC CICS READ
  7425*           DATASET    (ENCC-ID)
  7426*           SET        (ADDRESS OF ENCLOSURE-CODES)
  7427*           RIDFLD     (ELENCC-KEY)
  7428*           RESP       (WS-RESPONSE)
  7429*       END-EXEC
  7430*    MOVE '&"S        E          (  N#00007341' TO DFHEIV0
  7431     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7433     MOVE X'204E233030303037333431' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0,
  7435           ENCC-ID,
  7436           DFHEIV20,
  7437           DFHEIV99,
  7438           ELENCC-KEY,
  7439           DFHEIV99,
  7440           DFHEIV99,
  7441           DFHEIV99
  7442     SET ADDRESS OF ENCLOSURE-CODES TO
  7443         DFHEIV20
  7444     MOVE EIBRESP  TO WS-RESPONSE
  7445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7446
  7447        IF RESP-NORMAL
  7448           MOVE ENCI             TO PI-ENCLOSURE-CD
  7449                                    W-ENCLOSURE-CD
  7450           MOVE AL-UANON         TO ENCA
  7451        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 144
* EL152.cbl
  7452           MOVE 'N'              TO CLEANO
  7453           MOVE ER-1560          TO EMI-ERROR
  7454           MOVE -1               TO ENCL
  7455           MOVE AL-UABON         TO ENCA
  7456           PERFORM 9900-ERROR-FORMAT
  7457                                 THRU 9900-EXIT
  7458        END-IF
  7459     END-IF
  7460     IF COPIESL NOT = ZEROS
  7461        IF COPIESI NOT NUMERIC OR
  7462           COPIESI = '0'
  7463           MOVE ER-0184          TO EMI-ERROR
  7464           MOVE -1               TO COPIESL
  7465           MOVE AL-UABON         TO COPIESA
  7466           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7467        ELSE
  7468           MOVE AL-UANON         TO COPIESA.
  7469
  7470     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7471         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7472
  7473     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7474
  7475     IF PRINTERL > ZERO
  7476        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7477        MOVE AL-UANON            TO PRINTERA
  7478        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7479                                    PI-ALT-DMD-PRT-ID
  7480     ELSE
  7481        IF (PI-NO-CARRIER-SECURITY AND
  7482            PI-NO-ACCOUNT-SECURITY) OR
  7483            PI-PROCESSOR-PRINTER NOT = SPACES
  7484             NEXT SENTENCE
  7485        ELSE
  7486            MOVE AL-UABON       TO PRINTERA
  7487            MOVE -1             TO PRINTERL
  7488            MOVE ER-2397        TO EMI-ERROR
  7489            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7490
  7491     IF ACTL NOT = +0
  7492         MOVE ZEROS              TO W-ACCOUNT
  7493         IF ACTI > SPACES
  7494             IF ACTI NUMERIC
  7495                     AND
  7496                ACTI NOT < 1
  7497                     AND
  7498                ACTI NOT > 9
  7499                 MOVE AL-UANON   TO ACTA
  7500                 MOVE ACTI       TO W-ACCOUNT
  7501                                    W-LETTER-ADDR-SEQ
  7502                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7503             ELSE
  7504                 MOVE -1         TO ACTL
  7505                 MOVE AL-UABON   TO ACTA
  7506                 MOVE ER-3547    TO EMI-ERROR
  7507                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7508
  7509     IF BENL NOT = +0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 145
* EL152.cbl
  7510         MOVE ZEROS              TO W-BENEFICIARY
  7511         IF BENI > SPACES
  7512             IF BENI NUMERIC
  7513                     AND
  7514                BENI NOT < 1
  7515                     AND
  7516                BENI NOT > 9
  7517                 MOVE AL-UANON   TO BENA
  7518                 MOVE BENI       TO W-BENEFICIARY
  7519                                    W-LETTER-ADDR-SEQ
  7520                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
  7521             ELSE
  7522                 MOVE -1         TO BENL
  7523                 MOVE AL-UABON   TO BENA
  7524                 MOVE ER-3547    TO EMI-ERROR
  7525                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7526
  7527     IF EMPL NOT = +0
  7528         MOVE ZEROS              TO W-EMPLOYER
  7529         IF EMPI > SPACES
  7530             IF EMPI NUMERIC
  7531                     AND
  7532                EMPI NOT < 1
  7533                     AND
  7534                EMPI NOT > 9
  7535                 MOVE AL-UANON   TO EMPA
  7536                 MOVE EMPI       TO W-EMPLOYER
  7537                                    W-LETTER-ADDR-SEQ
  7538                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7539             ELSE
  7540                 MOVE -1         TO EMPL
  7541                 MOVE AL-UABON   TO EMPA
  7542                 MOVE ER-3547    TO EMI-ERROR
  7543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7544
  7545     IF INSL NOT = +0
  7546         MOVE ZEROS              TO W-INSURED
  7547         IF INSI > SPACES
  7548             IF INSI NUMERIC
  7549                     AND
  7550                INSI NOT < 1
  7551                     AND
  7552                INSI NOT > 9
  7553                 MOVE AL-UANON   TO INSA
  7554                 MOVE INSI       TO W-INSURED
  7555                                    W-LETTER-ADDR-SEQ
  7556                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7557             ELSE
  7558                 MOVE -1         TO INSL
  7559                 MOVE AL-UABON   TO INSA
  7560                 MOVE ER-3547    TO EMI-ERROR
  7561                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7562
  7563     IF PHYSL NOT = +0
  7564         MOVE ZEROS              TO W-PHYSICIAN
  7565         IF PHYSI > SPACES
  7566             IF PHYSI NUMERIC
  7567                     AND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 146
* EL152.cbl
  7568                PHYSI NOT < 1
  7569                     AND
  7570                PHYSI NOT > 9
  7571                 MOVE AL-UANON   TO PHYSA
  7572                 MOVE PHYSI      TO W-PHYSICIAN
  7573                                    W-LETTER-ADDR-SEQ
  7574                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7575             ELSE
  7576                 MOVE -1         TO PHYSL
  7577                 MOVE AL-UABON   TO PHYSA
  7578                 MOVE ER-3547    TO EMI-ERROR
  7579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7580
  7581     IF OTHR1L NOT = +0
  7582         MOVE ZEROS              TO W-OTHER-1
  7583         IF OTHR1I > SPACES
  7584             IF OTHR1I NUMERIC
  7585                     AND
  7586                OTHR1I NOT < 1
  7587                     AND
  7588                OTHR1I NOT > 9
  7589                 MOVE AL-UANON   TO OTHR1A
  7590                 MOVE OTHR1I     TO W-OTHER-1
  7591                                    W-LETTER-ADDR-SEQ
  7592                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7593             ELSE
  7594                 MOVE -1         TO OTHR1L
  7595                 MOVE AL-UABON   TO OTHR1A
  7596                 MOVE ER-3547    TO EMI-ERROR
  7597                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7598
  7599     IF OTHR2L NOT = +0
  7600         MOVE ZEROS              TO W-OTHER-2
  7601         IF OTHR2I > SPACES
  7602             IF OTHR2I NUMERIC
  7603                     AND
  7604                OTHR2I NOT < 1
  7605                     AND
  7606                OTHR2I NOT > 9
  7607                 MOVE AL-UANON   TO OTHR2A
  7608                 MOVE OTHR2I     TO W-OTHER-2
  7609                                    W-LETTER-ADDR-SEQ
  7610                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7611             ELSE
  7612                 MOVE -1         TO OTHR2L
  7613                 MOVE AL-UABON   TO OTHR2A
  7614                 MOVE ER-3547    TO EMI-ERROR
  7615                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7616
  7617     IF NOT EMI-NO-ERRORS
  7618        GO TO 8200-SEND-DATAONLY.
  7619
  7620 0350-EXIT.
  7621      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 147
* EL152.cbl
  7623 400-SET-CODES.
  7624     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7625     MOVE PI-COMPANY-CD          TO CLAM-CO
  7626                                    TEXT-CO
  7627                                    ACTV-CO
  7628                                    CERT-CO
  7629                                    ACCT-CO
  7630                                    ARCH-CO
  7631                                    PROD-CO
  7632                                    PLCY-CO
  7633                                    PLAN-CO.
  7634
  7635     MOVE PI-CARRIER             TO CLAM-CARRIER
  7636                                    ACTV-CARRIER
  7637                                    CERT-CARRIER
  7638                                    ACCT-CARRIER
  7639                                    PROD-CARRIER
  7640                                    PLCY-CARRIER
  7641                                    PLAN-CARRIER.
  7642
  7643     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7644                                    ACTV-CERT-NUM
  7645                                    CERT-CERT-NUM.
  7646 499-EXIT.
  7647      EXIT.
  7648
  7649 500-RECOVER-PI-TEMP-STORAGE.
  7650
  7651
  7652* EXEC CICS HANDLE CONDITION
  7653*        QIDERR   (590-QIDERR)
  7654*    END-EXEC.
  7655*    MOVE '"$N                   ! % #00007552' TO DFHEIV0
  7656     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7658     MOVE X'2520233030303037353532' TO DFHEIV0(25:11)
  7659     CALL 'kxdfhei1' USING DFHEIV0
  7660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7661
  7662
  7663
  7664* EXEC CICS READQ TS
  7665*        QUEUE    (WS-PI-QID)
  7666*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7667*        LENGTH   (PI-COMM-LENGTH)
  7668*    END-EXEC.
  7669*    MOVE '*$I    L              ''   #00007556' TO DFHEIV0
  7670     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303037353536' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           WS-PI-QID,
  7675           PROGRAM-INTERFACE-BLOCK,
  7676           PI-COMM-LENGTH,
  7677           DFHEIV99,
  7678           DFHEIV99,
  7679           DFHEIV99
  7680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 148
* EL152.cbl
  7681
  7682
  7683     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7684
  7685     GO TO 599-EXIT.
  7686
  7687 590-QIDERR.
  7688
  7689     IF EIBTRNID = TRANS-ID
  7690         MOVE ER-0033                   TO  EMI-ERROR
  7691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7692         GO TO 8200-SEND-DATAONLY.
  7693
  7694 599-EXIT.
  7695     EXIT.
  7696
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 149
* EL152.cbl
  7698 1000-SHOW.
  7699***************************************************************
  7700*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7701*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7702*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7703*     OPERATOR.                                               *
  7704***************************************************************
  7705
  7706     MOVE SPACES                 TO RECORD-TABLE.
  7707     IF ARCHNUML = ZEROS
  7708        MOVE -1                  TO ARCHNUML
  7709        MOVE AL-UNBON            TO ARCHNUMA
  7710        MOVE ER-0174             TO EMI-ERROR
  7711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7712        GO TO 8200-SEND-DATAONLY.
  7713
  7714     IF ARCHNUMI NOT NUMERIC
  7715        MOVE -1                  TO ARCHNUML
  7716        MOVE AL-UNBON            TO ARCHNUMA
  7717        MOVE ER-0175             TO EMI-ERROR
  7718        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7719        GO TO 8200-SEND-DATAONLY.
  7720
  7721     IF PI-SHOW-MODE
  7722*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7723*          MOVE -1               TO MAINTL
  7724*          GO TO 8200-SEND-DATAONLY
  7725*       ELSE
  7726           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7727
  7728     MOVE ARCHNUMI               TO ARCH-NUMBER
  7729                                    PI-ARCHIVE-NUMBER.
  7730     MOVE ' '                    TO ARCH-REC-TYPE.
  7731     MOVE '1'                    TO PI-ACTION.
  7732     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7733     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7734     MOVE SPACES                 TO PI-PRINT-SW
  7735                                    PI-FORM-NUMBER.
  7736     SET TB-INDX TO 1.
  7737
  7738     MOVE SPACE                  TO WS-LETTER-STATUS.
  7739
  7740
  7741* EXEC CICS HANDLE CONDITION
  7742*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7743*         NOTFND     (1020-ENDBR)
  7744*         ENDFILE    (1020-ENDBR)
  7745*    END-EXEC.
  7746*    MOVE '"$JI''                 ! & #00007619' TO DFHEIV0
  7747     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7749     MOVE X'2620233030303037363139' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0
  7751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7752
  7753
  7754     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7755
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 150
* EL152.cbl
  7756
  7757* EXEC CICS STARTBR
  7758*         DATASET    (ARCH-ID)
  7759*         RIDFLD     (ARCH-KEY)
  7760*         GTEQ
  7761*    END-EXEC
  7762     MOVE 0
  7763       TO DFHEIV11
  7764*    MOVE '&,         G          &   #00007627' TO DFHEIV0
  7765     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7767     MOVE X'2020233030303037363237' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0,
  7769           ARCH-ID,
  7770           ARCH-KEY,
  7771           DFHEIV99,
  7772           DFHEIV11,
  7773           DFHEIV99
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7775
  7776     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7777
  7778 1010-READ-NEXT.
  7779
  7780* EXEC CICS READNEXT
  7781*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7782*         DATASET   (ARCH-ID)
  7783*         RIDFLD    (ARCH-KEY)
  7784*    END-EXEC.
  7785     MOVE 0
  7786       TO DFHEIV11
  7787*    MOVE '&.S                   )   #00007636' TO DFHEIV0
  7788     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7790     MOVE X'2020233030303037363336' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0,
  7792           ARCH-ID,
  7793           DFHEIV20,
  7794           DFHEIV99,
  7795           ARCH-KEY,
  7796           DFHEIV99,
  7797           DFHEIV11,
  7798           DFHEIV99,
  7799           DFHEIV99
  7800     SET ADDRESS OF LETTER-ARCHIVE TO
  7801         DFHEIV20
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7803
  7804
  7805     IF LA-FORM-CONTROL-HDR
  7806        GO TO 1020-ENDBR.
  7807
  7808
  7809     IF NOT LA-HEADER-DATA
  7810         NEXT SENTENCE
  7811     ELSE
  7812         IF NOT LA-CSO-LETTER-PURGED
  7813             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 151
* EL152.cbl
  7814         ELSE
  7815             MOVE 'P'            TO WS-LETTER-STATUS
  7816             GO TO 1020-ENDBR.
  7817
  7818     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7819        IF LA-HEADER-DATA
  7820           PERFORM 1040-FORMAT-RESEND
  7821           MOVE LA-NO-OF-COPIES    TO COPIESO
  7822           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7823           GO TO 1010-READ-NEXT
  7824        ELSE
  7825           IF LA-ADDRESS-DATA
  7826              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7827              MOVE ZEROS             TO REC-PC (TB-INDX)
  7828              SET TB-INDX UP BY 1
  7829              GO TO 1010-READ-NEXT
  7830           ELSE
  7831              PERFORM 1030-TEXT-BUILD
  7832              GO TO 1010-READ-NEXT.
  7833
  7834 1020-ENDBR.
  7835     IF ARCH-BROWSE-STARTED = 'Y'
  7836        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7837
  7838* EXEC CICS ENDBR
  7839*            DATASET   (ARCH-ID)
  7840*       END-EXEC
  7841     MOVE 0
  7842       TO DFHEIV11
  7843*    MOVE '&2                    $   #00007674' TO DFHEIV0
  7844     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7846     MOVE X'2020233030303037363734' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0,
  7848           ARCH-ID,
  7849           DFHEIV11,
  7850           DFHEIV99
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7852     END-IF.
  7853
  7854*    IF PI-COMPANY-ID = 'CID'
  7855         IF TB-INDX = 1
  7856             IF WS-LETTER-STATUS EQUAL 'P'
  7857                 MOVE 9021           TO EMI-ERROR
  7858                 MOVE -1             TO ARCHNUML
  7859                 MOVE AL-UNBON       TO ARCHNUMA
  7860                 PERFORM 9900-ERROR-FORMAT THRU
  7861                         9900-EXIT
  7862                 GO TO 8200-SEND-DATAONLY
  7863             ELSE
  7864                 MOVE ER-0006             TO EMI-ERROR
  7865                 MOVE -1                  TO ARCHNUML
  7866                 MOVE AL-UNBON            TO ARCHNUMA
  7867                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7868                 GO TO 8200-SEND-DATAONLY
  7869             END-IF
  7870         END-IF
  7871*    ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 152
* EL152.cbl
  7872*        IF TB-INDX = 1
  7873*            MOVE ER-0006             TO EMI-ERROR
  7874*            MOVE -1                  TO ARCHNUML
  7875*            MOVE AL-UNBON            TO ARCHNUMA
  7876*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7877*            GO TO 8200-SEND-DATAONLY
  7878*        END-IF
  7879*    END-IF
  7880
  7881
  7882     SET TB-INDX DOWN BY 1.
  7883     SET PI-TOTAL-LINES          TO TB-INDX.
  7884     MOVE 1                      TO PI-CURRENT-LINE.
  7885     SET TB-INDX TO 1.
  7886
  7887     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7888             VARYING SC-INDX FROM 1 BY 1
  7889               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7890
  7891     MOVE SPACES                 TO PI-ADDR-TYPE
  7892                                    MAINTI.
  7893     MOVE -1                     TO MAINTL.
  7894
  7895     GO TO 8100-SEND-INITIAL-MAP.
  7896
  7897 1030-TEXT-BUILD.
  7898***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7899***** TOP OF FORM.
  7900     IF TB-INDX < 7
  7901        SET TB-INDX   TO 7.
  7902
  7903     IF TB-INDX = 7
  7904        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7905        SET TB-INDX UP BY 1.
  7906
  7907     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7908     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7909                                    INDX-WORK.
  7910
  7911     IF INDX-WORK NOT = 99
  7912        SET TB-INDX UP BY 1
  7913        SET TB-INDX UP BY INDX-WORK
  7914     ELSE
  7915        SET TB-INDX UP BY 1
  7916        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7917        SET TB-INDX UP BY 1.
  7918
  7919 1040-FORMAT-RESEND.
  7920     IF LA-RESEND-DATE = LOW-VALUES
  7921        MOVE SPACES                 TO RESENDI
  7922       ELSE
  7923        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7924        MOVE ' '                    TO DC-OPTION-CODE
  7925        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7926        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7927
  7928 1050-GET-CORRESPOND.
  7929     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 153
* EL152.cbl
  7930     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7931     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7932     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7933
  7934
  7935* EXEC CICS READ
  7936*         DATASET     (ACTV-ID)
  7937*         RIDFLD      (ACTV-KEY)
  7938*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7939*    END-EXEC.
  7940*    MOVE '&"S        E          (   #00007759' TO DFHEIV0
  7941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7943     MOVE X'2020233030303037373539' TO DFHEIV0(25:11)
  7944     CALL 'kxdfhei1' USING DFHEIV0,
  7945           ACTV-ID,
  7946           DFHEIV20,
  7947           DFHEIV99,
  7948           ACTV-KEY,
  7949           DFHEIV99,
  7950           DFHEIV99,
  7951           DFHEIV99
  7952     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7953         DFHEIV20
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7955
  7956
  7957     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7958        MOVE SPACES                TO FOLLOWI
  7959     ELSE
  7960        MOVE SPACES                TO DC-OPTION-CODE
  7961        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7962        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7963        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7964
  7965     MOVE SPACES                 TO ADDRI
  7966     MOVE AT-STD-LETTER-FORM     TO FORMI
  7967     MOVE AT-REASON-TEXT         TO REI.
  7968
  7969 1059-EXIT.
  7970      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 154
* EL152.cbl
  7972 2000-CREATE.
  7973***************************************************************
  7974*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7975*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7976*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7977*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7978*                                                             *
  7979***************************************************************
  7980
  7981***************************************************************
  7982*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7983*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7984***************************************************************
  7985
  7986     IF PI-CREATE-MODE
  7987        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7988           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7989           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7990           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7991           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7992             VARYING SC-INDX FROM 1 BY 1
  7993             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7994           MOVE -1               TO MAINTL
  7995*          MOVE 'Y'              TO CLEANO
  7996           GO TO 8200-SEND-DATAONLY
  7997        ELSE
  7998           IF PRINT-PERFORMED AND
  7999              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  8000              FORMI NOT = 9999
  8001              MOVE ER-0279           TO EMI-ERROR
  8002              MOVE -1                TO MAINTL
  8003              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8004              GO TO 8200-SEND-DATAONLY.
  8005
  8006***************************************************************
  8007*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  8008*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  8009*   THE ADDRESS DATA.                                         *
  8010***************************************************************
  8011
  8012     IF PI-FORM-NUMBER = FORMI AND
  8013        PI-ADDR-TYPE  =  ADDRI AND
  8014        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  8015           MOVE -1                  TO MAINTL
  8016           GO TO 8200-SEND-DATAONLY.
  8017
  8018     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  8019         MOVE 0                  TO GETMAIN-SWITCH
  8020         MOVE 'N'                TO WS-ACCT-READ-SW
  8021                                    WS-PROD-READ-SW
  8022                                    WS-COMP-READ-SW.
  8023
  8024     MOVE SPACES                 TO RECORD-TABLE.
  8025
  8026     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8027
  8028     SET TB-INDX TO 1
  8029     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 155
* EL152.cbl
  8030     SET TB-INDX UP BY 1.
  8031
  8032***************************************************************
  8033*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  8034*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  8035***************************************************************
  8036
  8037     IF FORMI = '9999'
  8038        MOVE 16                  TO PI-TOTAL-LINES
  8039        MOVE 1                   TO PI-CURRENT-LINE
  8040        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  8041        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  8042        MOVE '3'                 TO PI-ACTION
  8043        MOVE FORMI               TO PI-FORM-NUMBER
  8044                                    PI-COMM-CONTROL
  8045        MOVE ZEROS               TO PI-UPDATE-SW
  8046        MOVE PGM-EL1042          TO PGM-NAME
  8047        GO TO 9300-XCTL.
  8048
  8049     MOVE FORMI                  TO TEXT-LETTER.
  8050     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  8051
  8052
  8053* EXEC CICS HANDLE CONDITION
  8054*         NOTFND     (2120-ENDBR)
  8055*         ENDFILE    (2120-ENDBR)
  8056*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  8057*    END-EXEC
  8058*    MOVE '"$I''J                 ! '' #00007860' TO DFHEIV0
  8059     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  8060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8061     MOVE X'2720233030303037383630' TO DFHEIV0(25:11)
  8062     CALL 'kxdfhei1' USING DFHEIV0
  8063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8064
  8065
  8066* EXEC CICS STARTBR
  8067*         DATASET    (TEXT-ID)
  8068*         RIDFLD     (TEXT-KEY)
  8069*         GTEQ
  8070*    END-EXEC.
  8071     MOVE 0
  8072       TO DFHEIV11
  8073*    MOVE '&,         G          &   #00007866' TO DFHEIV0
  8074     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8075     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8076     MOVE X'2020233030303037383636' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0,
  8078           TEXT-ID,
  8079           TEXT-KEY,
  8080           DFHEIV99,
  8081           DFHEIV11,
  8082           DFHEIV99
  8083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8084
  8085
  8086     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  8087
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 156
* EL152.cbl
  8088 2110-READ-NEXT.
  8089     IF TB-INDX > MAX-LINES
  8090        MOVE ER-0051             TO EMI-ERROR
  8091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8092        GO TO 2120-ENDBR.
  8093
  8094
  8095* EXEC CICS READNEXT
  8096*         DATASET    (TEXT-ID)
  8097*         SET        (ADDRESS OF TEXT-FILES)
  8098*         RIDFLD     (TEXT-KEY)
  8099*    END-EXEC.
  8100     MOVE 0
  8101       TO DFHEIV11
  8102*    MOVE '&.S                   )   #00007880' TO DFHEIV0
  8103     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8104     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8105     MOVE X'2020233030303037383830' TO DFHEIV0(25:11)
  8106     CALL 'kxdfhei1' USING DFHEIV0,
  8107           TEXT-ID,
  8108           DFHEIV20,
  8109           DFHEIV99,
  8110           TEXT-KEY,
  8111           DFHEIV99,
  8112           DFHEIV11,
  8113           DFHEIV99,
  8114           DFHEIV99
  8115     SET ADDRESS OF TEXT-FILES TO
  8116         DFHEIV20
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8118
  8119
  8120     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  8121        IF TB-INDX = +2
  8122           MOVE SPACES           TO PI-FORM-NUMBER
  8123           MOVE -1               TO FORML
  8124           MOVE AL-UABON         TO FORMA
  8125           MOVE ER-1236          TO EMI-ERROR
  8126           MOVE 'N'              TO CLEANO
  8127           PERFORM 9900-ERROR-FORMAT
  8128                                 THRU 9900-EXIT
  8129        END-IF
  8130        GO TO 2120-ENDBR
  8131     END-IF
  8132
  8133     MOVE FORMI                  TO PI-FORM-NUMBER.
  8134     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  8135         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  8136         GO TO 2110-READ-NEXT.
  8137
  8138      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  8139
  8140      IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  8141         AND (PI-CARRIER NOT = '8')
  8142         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  8143            B1 > +20
  8144            IF TX-TEXT-LINE (B1:5) = '@03.1'
  8145               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 157
* EL152.cbl
  8146            END-IF
  8147         END-PERFORM
  8148      END-IF
  8149      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  8150      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  8151                                    INDX-WORK.
  8152      SET TB-INDX UP BY 1.
  8153      IF INDX-WORK = 99
  8154         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  8155         SET TB-INDX UP BY 1
  8156         GO TO 2110-READ-NEXT
  8157      ELSE
  8158         SET TB-INDX UP BY INDX-WORK
  8159         GO TO 2110-READ-NEXT.
  8160
  8161 2120-ENDBR.
  8162     IF TEXT-BROWSE-STARTED = 'Y'
  8163        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  8164
  8165* EXEC CICS ENDBR
  8166*            DATASET     (TEXT-ID)
  8167*       END-EXEC.
  8168     MOVE 0
  8169       TO DFHEIV11
  8170*    MOVE '&2                    $   #00007930' TO DFHEIV0
  8171     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8173     MOVE X'2020233030303037393330' TO DFHEIV0(25:11)
  8174     CALL 'kxdfhei1' USING DFHEIV0,
  8175           TEXT-ID,
  8176           DFHEIV11,
  8177           DFHEIV99
  8178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8179
  8180
  8181*02160      IF TB-INDX = 8
  8182*02161         MOVE ER-0006             TO EMI-ERROR
  8183*02162         MOVE -1                  TO FORML
  8184*02163         MOVE AL-UABON            TO FORMA
  8185*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8186*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  8187
  8188     SET TB-INDX DOWN BY 1.
  8189     SET PI-TOTAL-LINES          TO TB-INDX.
  8190     MOVE 1                      TO PI-CURRENT-LINE.
  8191
  8192***************************************************************
  8193*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  8194*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  8195***************************************************************
  8196
  8197     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  8198        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  8199        MOVE SPACES              TO W-REVERSE-DATE-SW
  8200        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  8201                VARYING TB-INDX FROM 7 BY 1 UNTIL
  8202                TB-INDX > PI-TOTAL-LINES
  8203     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 158
* EL152.cbl
  8204        MOVE ER-0373             TO EMI-ERROR
  8205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8206
  8207     SET TB-INDX TO 1.
  8208     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  8209             VARYING SC-INDX FROM 1 BY 1 UNTIL
  8210             SC-INDX > NUM-LINES-PER-SCREEN.
  8211
  8212     MOVE '3'                    TO PI-ACTION.
  8213*    MOVE FORMI                  TO PI-FORM-NUMBER.
  8214     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  8215     MOVE -1                     TO MAINTL.
  8216     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 159
* EL152.cbl
  8218 2800-PROCESS-Z-CONTROLS.
  8219
  8220     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8221
  8222     IF RESEND-SAVE = LOW-VALUES
  8223         IF W-DAYS-TO-RESEND-1 NUMERIC
  8224             IF W-DAYS-TO-RESEND-1 > ZEROS
  8225                 MOVE '6'                    TO DC-OPTION-CODE
  8226                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8227                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8228                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8229                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8230                 IF NO-CONVERSION-ERROR
  8231                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8232                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8233                     MOVE AL-UANON            TO RESENDA
  8234                     MOVE +8                  TO RESENDL
  8235                 ELSE
  8236                     MOVE ER-3770             TO EMI-ERROR
  8237                     MOVE -1                  TO MAINTL
  8238                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239                     GO TO 8200-SEND-DATAONLY.
  8240
  8241     IF FOLLOW-UP-SAVE = LOW-VALUES
  8242         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8243             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8244                 MOVE '6'                 TO DC-OPTION-CODE
  8245                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8246                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8247                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8248                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8249                 IF NO-CONVERSION-ERROR
  8250                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8251                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8252                     MOVE AL-UANON            TO FOLLOWA
  8253                     MOVE +8                  TO FOLLOWL
  8254                 ELSE
  8255                     MOVE ER-3771             TO EMI-ERROR
  8256                     MOVE -1                  TO MAINTL
  8257                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8258                     GO TO 8200-SEND-DATAONLY.
  8259
  8260     IF COPIESI NOT NUMERIC
  8261         IF W-NUMBER-OF-COPIES NUMERIC
  8262             IF W-NUMBER-OF-COPIES > ZEROS
  8263                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8264                 MOVE AL-UNNON            TO COPIESA
  8265                 MOVE +1                  TO COPIESL
  8266             ELSE
  8267                 MOVE +1                  TO COPIESI
  8268                 MOVE AL-UNNON            TO COPIESA
  8269                 MOVE +1                  TO COPIESL.
  8270
  8271     IF W-FORM-TO-RESEND > SPACES
  8272         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8273     ELSE
  8274         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8275     END-IF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 160
* EL152.cbl
  8276
  8277     IF W-PROMPT-LETTER = 'Y'
  8278         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8279         MOVE ER-0894                   TO EMI-ERROR
  8280         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8281     ELSE
  8282         MOVE 'N'                       TO PI-PROMPT-LETTER
  8283     END-IF.
  8284
  8285     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8286                                           ENCO
  8287     MOVE AL-UANON                      TO ENCA
  8288     MOVE +3                            TO ENCL
  8289     MOVE 'N'                           TO CLEANO
  8290     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8291     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8292
  8293 2800-EXIT.
  8294     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 161
* EL152.cbl
  8296 3000-RECORD.
  8297***************************************************************
  8298*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8299*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8300*    THE SCREEN.                                              *
  8301***************************************************************
  8302
  8303     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8304        MOVE ER-0211             TO EMI-ERROR
  8305        MOVE -1                  TO MAINTL
  8306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8307        GO TO 8200-SEND-DATAONLY.
  8308
  8309
  8310* EXEC CICS HANDLE CONDITION
  8311*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8312*         NOTFND     (3010-NOT-FOUND)
  8313*    END-EXEC.
  8314*    MOVE '"$JI                  ! ( #00008062' TO DFHEIV0
  8315     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8317     MOVE X'2820233030303038303632' TO DFHEIV0(25:11)
  8318     CALL 'kxdfhei1' USING DFHEIV0
  8319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8320
  8321
  8322     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8323     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8324
  8325     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8326             VARYING SC-INDX FROM 1 BY 1
  8327             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8328
  8329     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8330
  8331     IF NOT EMI-NO-ERRORS
  8332        GO TO 8200-SEND-DATAONLY.
  8333
  8334     MOVE ZEROS               TO ARCH-NUMBER.
  8335     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8336     MOVE ER-0000             TO EMI-ERROR.
  8337     MOVE -1                  TO MAINTL.
  8338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8339     GO TO 8200-SEND-DATAONLY.
  8340
  8341 3010-NOT-FOUND.
  8342     MOVE ER-0133             TO EMI-ERROR.
  8343     MOVE -1                  TO MAINTL.
  8344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8345     GO TO 8200-SEND-DATAONLY.
  8346
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 162
* EL152.cbl
  8348*4000-SET-BSR. Remove as dead code
  8349*4001-READ-NEXT. Remove as dead code
  8350*4002-ENDBR. Remove as dead code
  8351*4000-EXIT. Remove as dead code
  8352
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 163
* EL152.cbl
  8354 5000-MOVE-NAME.
  8355*    COPY ELCMNS.
  8356*****************************************************************
  8357*                                                               *
  8358*                                                               *
  8359*                            ELCMNS.                            *
  8360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8361*                            VMOD=2.002                         *
  8362*                                                               *
  8363*                     M O V E   N A M E   R O U T I N E         *
  8364*                                                               *
  8365*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8366*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8367*            NO EMBEDDED BLANKS.                                *
  8368*                                                               *
  8369*                  FIELD               VALUE                    *
  8370*                                                               *
  8371*                LAST NAME (CL15)      SMITH                    *
  8372*                1ST NAME  (CL12)      JOHN                     *
  8373*                MID NAME  (CL12)      ALLEN                    *
  8374*                                                               *
  8375*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8376*                                                               *
  8377*                        SMITH, JOHN ALLEN                      *
  8378*                                                               *
  8379*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8380*            STORAGE COPYBOOK:                                  *
  8381*                                                               *
  8382*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8383*                                                               *
  8384*****************************************************************.
  8385
  8386     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8387     MOVE ZERO                   TO  WS-NAME-SW.
  8388     SET NWA-INDEX TO +1.
  8389
  8390     IF CL-INSURED-1ST-NAME = SPACES  AND
  8391        CL-INSURED-MID-INIT = SPACES
  8392         MOVE +1                 TO  WS-NAME-SW.
  8393
  8394     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8395     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8396
  8397     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8398     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8399
  8400     SET NWA-INDEX UP BY +1.
  8401     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8402     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8403
  8404 5000-EXIT.
  8405     EXIT.
  8406
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 164
* EL152.cbl
  8408 5100-MOVE-NAME SECTION.
  8409     IF WS-NAME-SW GREATER THAN +1
  8410         GO TO 5190-EXIT.
  8411
  8412     IF WS-NAME-WORK2 = SPACES
  8413         GO TO 5190-EXIT.
  8414
  8415     SET NWA-INDEX2 TO +1.
  8416     SET NWA-INDEX3 TO +2.
  8417
  8418 5110-MOVE-NAME.
  8419     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8420
  8421     IF NWA-INDEX LESS THAN +30
  8422         SET NWA-INDEX UP BY +1
  8423       ELSE
  8424         ADD +2  TO  WS-NAME-SW
  8425         GO TO 5190-EXIT.
  8426
  8427     IF NWA-INDEX2 LESS THAN +20
  8428         SET NWA-INDEX3 UP BY +1
  8429         SET NWA-INDEX2 UP BY +1.
  8430
  8431     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8432        WS-NW2 (NWA-INDEX3) = SPACES
  8433         IF WS-NAME-SW = ZERO
  8434             MOVE ','            TO  WS-NW (NWA-INDEX)
  8435             SET NWA-INDEX UP BY +2
  8436             MOVE +1             TO  WS-NAME-SW
  8437             GO TO 5190-EXIT
  8438           ELSE
  8439             GO TO 5190-EXIT.
  8440
  8441     GO TO 5110-MOVE-NAME.
  8442
  8443 5190-EXIT.
  8444     EXIT.
  8445
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 165
* EL152.cbl
  8447 5200-MOVE-NAME.
  8448*    NOTE *******************************************************
  8449*         *           M O V E   N A M E   R O U T I N E         *
  8450*         *                                                     *
  8451*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8452*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8453*         *  NO EMBEDDED BLANKS.                                *
  8454*         *                                                     *
  8455*         *        FIELD               VALUE                    *
  8456*         *                                                     *
  8457*         *      LAST NAME (CL15)      SMITH                    *
  8458*         *      1ST NAME  (CL12)      JOHN                     *
  8459*         *      MID NAME  (CL1)       A                        *
  8460*         *                                                     *
  8461*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8462*         *                                                     *
  8463*         *              JOHN A. SMITH                          *
  8464*         *                                                     *
  8465*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8466*         *  STORAGE COPYBOOK:                                  *
  8467*         *                                                     *
  8468*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8469*         *                                                     *
  8470*         *******************************************************.
  8471
  8472     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8473     MOVE ZERO                   TO  WS-NAME-SW.
  8474     SET NWA-INDEX TO +1.
  8475
  8476     IF W-FIRST-NAME = SPACES
  8477             AND
  8478        W-MIDDLE-NAME = SPACES
  8479         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8480         GO TO 5200-EXIT.
  8481
  8482     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8483     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8484
  8485     SET NWA-INDEX UP BY +1.
  8486
  8487     IF W-MIDDLE-NAME NOT = SPACES
  8488        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8489        SET NWA-INDEX UP BY +1
  8490        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8491        SET NWA-INDEX UP BY +2.
  8492
  8493     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8494     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8495
  8496 5200-EXIT.
  8497     EXIT.
  8498
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 166
* EL152.cbl
  8500 5300-MOVE-NAME.
  8501     IF WS-NAME-SW > +1
  8502         GO TO 5390-EXIT.
  8503
  8504     IF WS-NAME-WORK2 = SPACES
  8505         GO TO 5390-EXIT.
  8506
  8507     SET NWA-INDEX2 TO +1.
  8508     SET NWA-INDEX3 TO +2.
  8509
  8510 5310-MOVE-NAME.
  8511     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8512
  8513     IF NWA-INDEX < +30
  8514        SET NWA-INDEX UP BY +1
  8515     ELSE
  8516        ADD +2  TO  WS-NAME-SW
  8517        GO TO 5390-EXIT.
  8518
  8519     IF NWA-INDEX2 < +20
  8520         SET NWA-INDEX2 UP BY +1
  8521         SET NWA-INDEX3 UP BY +1.
  8522
  8523     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8524        WS-NW2 (NWA-INDEX3) = SPACES
  8525        GO TO 5390-EXIT.
  8526
  8527     GO TO 5310-MOVE-NAME.
  8528
  8529 5390-EXIT.
  8530     EXIT.
  8531
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 167
* EL152.cbl
  8533 6100-ADDR-MAINT.
  8534***************************************************************
  8535*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8536*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8537*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8538***************************************************************
  8539
  8540     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8541
  8542     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8543     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8544             VARYING SC-INDX FROM 1 BY 1
  8545             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8546
  8547     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8548        MOVE ER-0343             TO EMI-ERROR
  8549        MOVE -1                  TO MAINTL
  8550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8551        GO TO 8200-SEND-DATAONLY.
  8552
  8553*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8554*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8555*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8556*            VARYING SC-INDX FROM 1 BY 1
  8557*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8558
  8559     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8560     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8561     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8562     MOVE PGM-EL141 TO PGM-NAME.
  8563
  8564     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 168
* EL152.cbl
  8566 6200-EDIT-MODE.
  8567***************************************************************
  8568*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8569*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8570*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8571***************************************************************
  8572     IF PI-SHOW-MODE
  8573        MOVE ER-0188             TO EMI-ERROR
  8574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8575        MOVE -1                  TO MAINTL
  8576        MOVE AL-UABON            TO MAINTA
  8577        GO TO 8200-SEND-DATAONLY
  8578     END-IF
  8579
  8580*    IF PI-COMPANY-ID = 'DMD'
  8581*        IF PI-BSR-AUTOMATED
  8582*            MOVE ER-0912        TO EMI-ERROR
  8583*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8584*            MOVE -1             TO MAINTL
  8585*            MOVE AL-UABON       TO MAINTA
  8586*            GO TO 8200-SEND-DATAONLY.
  8587
  8588     IF PI-CURRENT-LINE = ZEROS
  8589        MOVE ER-0187             TO EMI-ERROR
  8590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8591        MOVE -1                  TO MAINTL
  8592        GO TO 8200-SEND-DATAONLY.
  8593
  8594     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8595     PERFORM 7750-DELETE-TEMP-STOR
  8596                                 THRU 7750-EXIT
  8597     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8598     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8599             VARYING SC-INDX FROM 1 BY 1
  8600             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8601
  8602     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8603     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8604
  8605     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8606     MOVE ZEROS                  TO PI-UPDATE-SW.
  8607     MOVE '1'                    TO PI-ENTRY-CD-1.
  8608     MOVE PGM-EL1042             TO PGM-NAME.
  8609     GO TO 9300-XCTL.
  8610
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 169
* EL152.cbl
  8612 6400-LETTER-RELEASE.
  8613***************************************************************
  8614*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8615*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8616*    THE ARCHIVE FILE.                                        *
  8617*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8618*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8619*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8620*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8621*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8622*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8623*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8624*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8625*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8626*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8627*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8628***************************************************************
  8629
  8630     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8631
  8632     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8633     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8634             VARYING SC-INDX FROM 1 BY 1
  8635             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8636
  8637     IF NOT MODIFY-CAP
  8638        MOVE ER-0070             TO EMI-ERROR
  8639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8640        MOVE -1                  TO MAINTL
  8641        GO TO 8200-SEND-DATAONLY.
  8642
  8643     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8644        MOVE ER-0211             TO EMI-ERROR
  8645        MOVE -1                  TO MAINTL
  8646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8647        GO TO 8200-SEND-DATAONLY.
  8648
  8649*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8650*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8651*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8652*            VARYING SC-INDX FROM 1 BY 1
  8653*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8654
  8655     IF PI-ADDR-TYPE  NOT =  ADDRI
  8656        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8657
  8658     IF NOT EMI-NO-ERRORS
  8659        GO TO 8200-SEND-DATAONLY.
  8660
  8661     MOVE +0                     TO TALLY.
  8662     INSPECT RECORD-TABLE TALLYING TALLY
  8663                                 FOR CHARACTERS BEFORE '@'.
  8664
  8665     IF TALLY < +21900
  8666        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8667        MOVE ZEROS               TO ROLL-COUNTER
  8668        MOVE ER-0191             TO EMI-ERROR
  8669        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 170
* EL152.cbl
  8670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8671        GO TO 7900-ROLL-PAGE.
  8672
  8673     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8674     MOVE ZEROS                  TO CNTL-SEQ.
  8675     MOVE SPACES                 TO CNTL-GENL.
  8676
  8677* EXEC CICS READ
  8678*         DATASET    (CNTL-ID)
  8679*         SET        (ADDRESS OF CONTROL-FILE)
  8680*         RIDFLD     (CNTL-KEY)
  8681*         UPDATE
  8682*    END-EXEC.
  8683*    MOVE '&"S        EU         (   #00008421' TO DFHEIV0
  8684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8685     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8686     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  8687     CALL 'kxdfhei1' USING DFHEIV0,
  8688           CNTL-ID,
  8689           DFHEIV20,
  8690           DFHEIV99,
  8691           CNTL-KEY,
  8692           DFHEIV99,
  8693           DFHEIV99,
  8694           DFHEIV99
  8695     SET ADDRESS OF CONTROL-FILE TO
  8696         DFHEIV20
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8698
  8699
  8700     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8701     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8702     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8703
  8704
  8705* EXEC CICS REWRITE
  8706*         FROM      (CONTROL-FILE)
  8707*         DATASET   (CNTL-ID)
  8708*    END-EXEC
  8709     MOVE LENGTH OF
  8710      CONTROL-FILE
  8711       TO DFHEIV11
  8712*    MOVE '&& L                  %   #00008432' TO DFHEIV0
  8713     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8714     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8715     MOVE X'2020233030303038343332' TO DFHEIV0(25:11)
  8716     CALL 'kxdfhei1' USING DFHEIV0,
  8717           CNTL-ID,
  8718           CONTROL-FILE,
  8719           DFHEIV11,
  8720           DFHEIV99
  8721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8722
  8723     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8724
  8725
  8726* EXEC CICS HANDLE CONDITION
  8727*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 171
* EL152.cbl
  8728*    END-EXEC.
  8729*    MOVE '"$J                   ! ) #00008439' TO DFHEIV0
  8730     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8732     MOVE X'2920233030303038343339' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8735
  8736
  8737
  8738* EXEC CICS GETMAIN
  8739*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8740*         LENGTH   (ARCH-LENGTH)
  8741*    END-EXEC.
  8742*    MOVE '," L                  $   #00008443' TO DFHEIV0
  8743     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8745     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0,
  8747           DFHEIV20,
  8748           ARCH-LENGTH,
  8749           DFHEIV99
  8750     SET ADDRESS OF LETTER-ARCHIVE TO
  8751         DFHEIV20
  8752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8753
  8754
  8755     MOVE SPACES                 TO LETTER-ARCHIVE.
  8756     MOVE 'LA'                   TO LA-RECORD-ID.
  8757     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8758                                    LA-ARCHIVE-NO-A1.
  8759     MOVE '1'                    TO LA-RECORD-TYPE
  8760                                    LA-RECORD-TYPE-A1.
  8761     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8762                                    LA-LINE-SEQ-NO-A1.
  8763     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8764                                    LA-COMPANY-CD-A1.
  8765     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8766     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8767     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8768
  8769*    IF PI-COMPANY-ID = 'DMD'
  8770*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8771*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8772*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8773*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8774*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8775*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8776*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8777*                                     LA-DMD-LETTER-RELOAD-DT
  8778*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8779*        EXEC CICS GETMAIN
  8780*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8781*            LENGTH (ARCT-LENGTH)
  8782*        END-EXEC.
  8783
  8784     IF COPIESL NOT = ZEROS
  8785        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 172
* EL152.cbl
  8786     ELSE
  8787        MOVE  1                  TO LA-NO-OF-COPIES.
  8788
  8789     IF RESENDL NOT = ZEROS
  8790        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8791     ELSE
  8792        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8793
  8794     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8795     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8796
  8797     IF PRINT-PERFORMED
  8798        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8799     ELSE
  8800        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8801
  8802     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8803     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8804     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8805
  8806     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8807         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8808     END-IF.
  8809
  8810     IF WS-LABELS-SW = 'N'
  8811         NEXT SENTENCE
  8812     ELSE
  8813         SET TB-INDX TO 1
  8814         MOVE ZEROS                  TO SEQ-COUNTER
  8815         PERFORM 6480-FORMAT-ADDRESS
  8816               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8817               TB-INDX > 6.
  8818
  8819     MOVE ZEROS                  TO SEQ-COUNTER.
  8820     MOVE 'N'                    TO WS-SKIP-EMAIL
  8821     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8822             VARYING TB-INDX FROM 8 BY 1
  8823             UNTIL TB-INDX > PI-TOTAL-LINES.
  8824     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8825     IF SEQ-COUNTER < +15
  8826      AND WS-SKIP-EMAIL EQUAL 'N'
  8827        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8828        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8829        MOVE SPACES              TO TRAN-DL2-CCC
  8830        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8831           DELIMITED BY SIZE
  8832           INTO TRAN-DL2-CCC
  8833        END-STRING
  8834
  8835* EXEC CICS WRITEQ TD
  8836*          QUEUE ('BTCH')
  8837*          FROM (TRAN-DATA-LINE1)
  8838*          LENGTH (80)
  8839*       END-EXEC
  8840     MOVE 80
  8841       TO DFHEIV11
  8842     MOVE 'BTCH' TO DFHEIV5
  8843*    MOVE '(" L   L              &   #00008527' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 173
* EL152.cbl
  8844     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8846     MOVE X'2020233030303038353237' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
  8848           DFHEIV5,
  8849           TRAN-DATA-LINE1,
  8850           DFHEIV11,
  8851           DFHEIV99,
  8852           DFHEIV99
  8853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8854
  8855* EXEC CICS WRITEQ TD
  8856*          QUEUE ('BTCH')
  8857*          FROM (TRAN-DATA-LINE2)
  8858*          LENGTH (80)
  8859*       END-EXEC
  8860     MOVE 80
  8861       TO DFHEIV11
  8862     MOVE 'BTCH' TO DFHEIV5
  8863*    MOVE '(" L   L              &   #00008532' TO DFHEIV0
  8864     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  8865     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8866     MOVE X'2020233030303038353332' TO DFHEIV0(25:11)
  8867     CALL 'kxdfhei1' USING DFHEIV0,
  8868           DFHEIV5,
  8869           TRAN-DATA-LINE2,
  8870           DFHEIV11,
  8871           DFHEIV99,
  8872           DFHEIV99
  8873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8874
  8875* EXEC CICS WRITEQ TD
  8876*          QUEUE ('BTCH')
  8877*          FROM (TRAN-DATA-LINE3)
  8878*          LENGTH (80)
  8879*       END-EXEC
  8880     MOVE 80
  8881       TO DFHEIV11
  8882     MOVE 'BTCH' TO DFHEIV5
  8883*    MOVE '(" L   L              &   #00008537' TO DFHEIV0
  8884     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  8885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8886     MOVE X'2020233030303038353337' TO DFHEIV0(25:11)
  8887     CALL 'kxdfhei1' USING DFHEIV0,
  8888           DFHEIV5,
  8889           TRAN-DATA-LINE3,
  8890           DFHEIV11,
  8891           DFHEIV99,
  8892           DFHEIV99
  8893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8894     END-IF
  8895     MOVE ER-0280                TO EMI-ERROR.
  8896
  8897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8898     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8899     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8900
  8901     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 174
* EL152.cbl
  8902
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 175
* EL152.cbl
  8904 6470-FORMAT-TEXT.
  8905
  8906     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8907         MOVE 'Y'                TO WS-SKIP-EMAIL
  8908     END-IF.
  8909
  8910     MOVE SPACES                 TO LETTER-ARCHIVE.
  8911     MOVE '3'                    TO LA-RECORD-TYPE
  8912                                    LA-RECORD-TYPE-A1.
  8913     MOVE 'LA'                   TO LA-RECORD-ID.
  8914     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8915                                    LA-ARCHIVE-NO-A1.
  8916     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8917                                    LA-LINE-SEQ-NO-A1.
  8918     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8919                                    LA-COMPANY-CD-A1.
  8920     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8921     SET TB-INDX1 TO TB-INDX.
  8922     SET TB-INDX1 UP BY 1.
  8923     MOVE ZEROS                  TO INDX-WORK.
  8924
  8925 6472-LOOP.
  8926     IF TB-INDX1 < PI-TOTAL-LINES AND
  8927        REC-TEXT (TB-INDX1) = SPACES
  8928           SET TB-INDX1 UP BY 1
  8929           ADD 1                 TO INDX-WORK
  8930           GO TO 6472-LOOP.
  8931
  8932     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8933        MOVE '99'                TO LA-SKIP-CONTROL
  8934        SET TB-INDX1 UP BY 1
  8935     ELSE
  8936        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8937
  8938     SET TB-INDX TO TB-INDX1.
  8939     SET TB-INDX DOWN BY 1.
  8940     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8941     ADD 1 TO SEQ-COUNTER.
  8942
  8943 6479-EXIT.
  8944      EXIT.
  8945
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 176
* EL152.cbl
  8947 6480-FORMAT-ADDRESS.
  8948     MOVE SPACES                 TO LETTER-ARCHIVE.
  8949     MOVE '2'                    TO LA-RECORD-TYPE
  8950                                    LA-RECORD-TYPE-A1.
  8951     MOVE 'LA'                   TO LA-RECORD-ID.
  8952     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8953                                    LA-ARCHIVE-NO-A1.
  8954     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8955                                    LA-LINE-SEQ-NO-A1.
  8956     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8957                                    LA-COMPANY-CD-A1.
  8958     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8959
  8960     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8961     ADD 1 TO SEQ-COUNTER.
  8962
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 177
* EL152.cbl
  8964 6490-WRITE-ARCHIVE.
  8965
  8966* EXEC CICS HANDLE CONDITION
  8967*        DUPKEY    (6499-EXIT)
  8968*    END-EXEC.
  8969*    MOVE '"$$                   ! * #00008613' TO DFHEIV0
  8970     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8972     MOVE X'2A20233030303038363133' TO DFHEIV0(25:11)
  8973     CALL 'kxdfhei1' USING DFHEIV0
  8974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8975
  8976
  8977*    IF PI-COMPANY-ID = 'DMD'
  8978*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8979*        MOVE 'LT'               TO LT-RECORD-ID
  8980*        EXEC CICS WRITE
  8981*            DATASET   (ARCT-ID)
  8982*            FROM      (LETTER-ARCHIVE-TEMP)
  8983*            RIDFLD    (LT-CONTROL-PRIMARY)
  8984*        END-EXEC.
  8985
  8986
  8987* EXEC CICS WRITE
  8988*         DATASET   (ARCH-ID)
  8989*         FROM      (LETTER-ARCHIVE)
  8990*         RIDFLD    (LA-CONTROL-PRIMARY)
  8991*    END-EXEC.
  8992     MOVE LENGTH OF
  8993      LETTER-ARCHIVE
  8994       TO DFHEIV11
  8995*    MOVE '&$ L                  ''   #00008626' TO DFHEIV0
  8996     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8998     MOVE X'2020233030303038363236' TO DFHEIV0(25:11)
  8999     CALL 'kxdfhei1' USING DFHEIV0,
  9000           ARCH-ID,
  9001           LETTER-ARCHIVE,
  9002           DFHEIV11,
  9003           LA-CONTROL-PRIMARY,
  9004           DFHEIV99,
  9005           DFHEIV99
  9006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9007
  9008
  9009 6499-EXIT.
  9010     EXIT.
  9011
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 178
* EL152.cbl
  9013 6500-BUILD-CORRESPOND.
  9014***************************************************************
  9015*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  9016*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  9017*    USING THE NEW SEQUENCE NUMBER.                           *
  9018*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  9019*    TRAILER RECORD.                                          *
  9020***************************************************************
  9021
  9022     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  9023
  9024
  9025* EXEC CICS READ
  9026*         DATASET    (CLAM-ID)
  9027*         SET        (ADDRESS OF CLAIM-MASTER)
  9028*         RIDFLD     (CLAM-KEY)
  9029*         UPDATE
  9030*    END-EXEC.
  9031*    MOVE '&"S        EU         (   #00008647' TO DFHEIV0
  9032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9033     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9034     MOVE X'2020233030303038363437' TO DFHEIV0(25:11)
  9035     CALL 'kxdfhei1' USING DFHEIV0,
  9036           CLAM-ID,
  9037           DFHEIV20,
  9038           DFHEIV99,
  9039           CLAM-KEY,
  9040           DFHEIV99,
  9041           DFHEIV99,
  9042           DFHEIV99
  9043     SET ADDRESS OF CLAIM-MASTER TO
  9044         DFHEIV20
  9045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9046
  9047
  9048     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  9049
  9050     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  9051        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  9052
  9053     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  9054        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  9055
  9056     IF MAINTI = 'C'
  9057        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  9058
  9059     IF MAINTI = 'R'
  9060        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  9061        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  9062
  9063*    IF PI-COMPANY-ID = 'DMD'
  9064*        MOVE 04                 TO CL-ACTIVITY-CODE.
  9065
  9066
  9067* EXEC CICS GETMAIN
  9068*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9069*         INITIMG   (GETMAIN-SPACE)
  9070*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 179
* EL152.cbl
  9071*    END-EXEC.
  9072*    MOVE ',"IL                  $   #00008672' TO DFHEIV0
  9073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9075     MOVE X'2020233030303038363732' TO DFHEIV0(25:11)
  9076     CALL 'kxdfhei1' USING DFHEIV0,
  9077           DFHEIV20,
  9078           ACTV-LENGTH,
  9079           GETMAIN-SPACE
  9080     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9081         DFHEIV20
  9082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9083
  9084
  9085     MOVE 'AT'                   TO AT-RECORD-ID.
  9086     MOVE  4                     TO AT-TRAILER-TYPE.
  9087     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  9088                                    CL-LAST-MAINT-DT
  9089                                    AT-CORR-LAST-MAINT-DT
  9090     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9091                                    CL-LAST-MAINT-USER
  9092                                    AT-CORR-LAST-UPDATED-BY
  9093     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  9094                                    CL-LAST-MAINT-HHMMSS.
  9095     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  9096     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  9097     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  9098                                    CORR-TRLR-SEQ.
  9099     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  9100     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  9101     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  9102     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  9103                                    AT-LETTER-PURGED-DT.
  9104     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  9105     MOVE '1'                    TO AT-LETTER-ORIGIN.
  9106     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  9107     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  9108     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  9109
  9110*    IF PI-COMPANY-ID = 'DMD'
  9111*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  9112*        IF PI-BSR-AUTOMATED
  9113*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  9114*
  9115     IF FORML  NOT = ZEROS
  9116        MOVE FORMI               TO AT-STD-LETTER-FORM
  9117     ELSE
  9118        MOVE SPACES              TO AT-STD-LETTER-FORM.
  9119
  9120     IF REL NOT = ZEROS
  9121        MOVE REI                 TO AT-REASON-TEXT
  9122     ELSE
  9123        MOVE SPACES              TO AT-REASON-TEXT.
  9124
  9125*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  9126*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  9127*        IF WS-RE-NDX NUMERIC  AND
  9128*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 180
* EL152.cbl
  9129*           WS-RE-NDX < 33
  9130*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  9131*                                TO AT-REASON-TEXT.
  9132
  9133     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  9134
  9135     IF PI-ADDR-TYPE > SPACES
  9136         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  9137         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  9138     ELSE
  9139     IF W-ACCOUNT > ZEROS
  9140         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  9141         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  9142     ELSE
  9143     IF W-BENEFICIARY > ZEROS
  9144          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  9145          IF W-BENEFICIARY = 9
  9146              MOVE SS61D            TO AT-ADDRESSEE-NAME
  9147            ELSE
  9148              MOVE SS43D            TO AT-ADDRESSEE-NAME
  9149     ELSE
  9150     IF W-EMPLOYER > ZEROS
  9151          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  9152          MOVE SS48D                TO AT-ADDRESSEE-NAME
  9153     ELSE
  9154     IF W-INSURED > ZEROS
  9155          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  9156          MOVE SS57D                TO AT-ADDRESSEE-NAME
  9157     ELSE
  9158     IF W-PHYSICIAN > ZEROS
  9159          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  9160          MOVE SS47D                TO AT-ADDRESSEE-NAME
  9161     ELSE
  9162     IF W-OTHER-1 > ZEROS
  9163          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  9164          MOVE SS49D                TO AT-ADDRESSEE-NAME
  9165     ELSE
  9166     IF W-OTHER-2 > ZEROS
  9167          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  9168          MOVE SS50D                TO AT-ADDRESSEE-NAME
  9169     ELSE
  9170          MOVE SPACES               TO AT-ADDRESEE-TYPE
  9171                                       AT-ADDRESSEE-NAME.
  9172     IF PRINT-PERFORMED
  9173        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  9174     ELSE
  9175        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  9176
  9177     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  9178
  9179*    IF PI-COMPANY-ID = 'DMD'
  9180*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  9181*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  9182*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  9183*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  9184*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  9185
  9186
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 181
* EL152.cbl
  9187* EXEC CICS WRITE
  9188*         DATASET    (ACTV-ID)
  9189*         FROM       (ACTIVITY-TRAILERS)
  9190*         RIDFLD     (AT-CONTROL-PRIMARY)
  9191*    END-EXEC.
  9192     MOVE LENGTH OF
  9193      ACTIVITY-TRAILERS
  9194       TO DFHEIV11
  9195*    MOVE '&$ L                  ''   #00008779' TO DFHEIV0
  9196     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9197     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9198     MOVE X'2020233030303038373739' TO DFHEIV0(25:11)
  9199     CALL 'kxdfhei1' USING DFHEIV0,
  9200           ACTV-ID,
  9201           ACTIVITY-TRAILERS,
  9202           DFHEIV11,
  9203           AT-CONTROL-PRIMARY,
  9204           DFHEIV99,
  9205           DFHEIV99
  9206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9207
  9208
  9209
  9210* EXEC CICS HANDLE CONDITION
  9211*        DUPKEY      (6599-EXIT)
  9212*    END-EXEC.
  9213*    MOVE '"$$                   ! + #00008785' TO DFHEIV0
  9214     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9216     MOVE X'2B20233030303038373835' TO DFHEIV0(25:11)
  9217     CALL 'kxdfhei1' USING DFHEIV0
  9218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9219
  9220
  9221
  9222* EXEC CICS REWRITE
  9223*         DATASET    (CLAM-ID)
  9224*         FROM       (CLAIM-MASTER)
  9225*    END-EXEC.
  9226     MOVE LENGTH OF
  9227      CLAIM-MASTER
  9228       TO DFHEIV11
  9229*    MOVE '&& L                  %   #00008789' TO DFHEIV0
  9230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9232     MOVE X'2020233030303038373839' TO DFHEIV0(25:11)
  9233     CALL 'kxdfhei1' USING DFHEIV0,
  9234           CLAM-ID,
  9235           CLAIM-MASTER,
  9236           DFHEIV11,
  9237           DFHEIV99
  9238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9239
  9240
  9241 6599-EXIT.
  9242      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 182
* EL152.cbl
  9244 6600-SET-ADDR-SEQ.
  9245     IF ADDRL = ZEROS
  9246        GO TO 6699-EXIT.
  9247
  9248     MOVE ADDRI                  TO PI-ADDR-TYPE
  9249                                    WS-ADDR-TYPE-CD.
  9250     IF WS-ADDR-SEQ NOT NUMERIC
  9251        GO TO 6699-EXIT.
  9252
  9253     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9254
  9255     IF WS-ADDR-TYPE = 'I'
  9256        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9257     ELSE
  9258     IF WS-ADDR-TYPE = 'A'
  9259        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9260        ADD +20                  TO ACTV-SEQ
  9261     ELSE
  9262     IF WS-ADDR-TYPE = 'B'
  9263        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9264        ADD +10                  TO ACTV-SEQ
  9265     ELSE
  9266     IF WS-ADDR-TYPE = 'P'
  9267        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9268        ADD +30                  TO ACTV-SEQ
  9269     ELSE
  9270     IF WS-ADDR-TYPE = 'E'
  9271        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9272        ADD +40                  TO ACTV-SEQ
  9273     ELSE
  9274     IF WS-ADDR-TYPE = 'O'
  9275        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9276        ADD +50                  TO ACTV-SEQ
  9277     ELSE
  9278     IF WS-ADDR-TYPE = 'Q'
  9279        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9280        ADD +60                  TO ACTV-SEQ.
  9281
  9282 6699-EXIT.
  9283      EXIT.
  9284
  9285 6700-BUILD-NAPERSOFT.
  9286
  9287
  9288* EXEC CICS GETMAIN
  9289*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9290*         LENGTH   (NAPS-LENGTH)
  9291*    END-EXEC.
  9292*    MOVE '," L                  $   #00008840' TO DFHEIV0
  9293     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9294     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9295     MOVE X'2020233030303038383430' TO DFHEIV0(25:11)
  9296     CALL 'kxdfhei1' USING DFHEIV0,
  9297           DFHEIV20,
  9298           NAPS-LENGTH,
  9299           DFHEIV99
  9300     SET ADDRESS OF NAPERSOFT-FILE TO
  9301         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 183
* EL152.cbl
  9302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9303
  9304
  9305     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9306     MOVE 'NA'                  TO  NA-RECORD-ID.
  9307     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9308     MOVE PI-CARRIER            TO  NA-CARRIER.
  9309     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9310     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9311     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9312     MOVE FORMI                 TO  NA-LETTER-ID.
  9313     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9314     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9315     IF PRINT-PERFORMED
  9316         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9317     ELSE
  9318         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9319     END-IF.
  9320     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9321     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9322     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9323     IF COPIESL NOT = ZEROS
  9324         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9325     ELSE
  9326         MOVE 1                 TO  NA-NO-OF-COPIES
  9327     END-IF.
  9328     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9329         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9330     ELSE
  9331         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9332     END-IF.
  9333     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9334     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9335
  9336
  9337* EXEC CICS WRITE
  9338*         DATASET    (NAPS-ID)
  9339*         FROM       (NAPERSOFT-FILE)
  9340*         RIDFLD     (NA-CONTROL-PRIMARY)
  9341*    END-EXEC.
  9342     MOVE LENGTH OF
  9343      NAPERSOFT-FILE
  9344       TO DFHEIV11
  9345*    MOVE '&$ L                  ''   #00008876' TO DFHEIV0
  9346     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9348     MOVE X'2020233030303038383736' TO DFHEIV0(25:11)
  9349     CALL 'kxdfhei1' USING DFHEIV0,
  9350           NAPS-ID,
  9351           NAPERSOFT-FILE,
  9352           DFHEIV11,
  9353           NA-CONTROL-PRIMARY,
  9354           DFHEIV99,
  9355           DFHEIV99
  9356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9357
  9358
  9359 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 184
* EL152.cbl
  9360      EXIT.
  9361
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 185
* EL152.cbl
  9363 7000-READ-ADDR.
  9364     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9365        IF ADDRL = ZEROS
  9366           GO TO 7099-EXIT
  9367        ELSE
  9368           MOVE ER-0374             TO EMI-ERROR
  9369           MOVE -1                  TO ADDRL
  9370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9371           GO TO 7099-EXIT.
  9372
  9373     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9374                                    ACTV-CLAIM.
  9375
  9376
  9377* EXEC CICS HANDLE CONDITION
  9378*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9379*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9380*     END-EXEC.
  9381*    MOVE '"$JI                  ! , #00008899' TO DFHEIV0
  9382     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9384     MOVE X'2C20233030303038383939' TO DFHEIV0(25:11)
  9385     CALL 'kxdfhei1' USING DFHEIV0
  9386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9387
  9388
  9389
  9390* EXEC CICS READ
  9391*         DATASET    (CLAM-ID)
  9392*         SET        (ADDRESS OF CLAIM-MASTER)
  9393*         RIDFLD     (CLAM-KEY)
  9394*    END-EXEC.
  9395*    MOVE '&"S        E          (   #00008904' TO DFHEIV0
  9396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9398     MOVE X'2020233030303038393034' TO DFHEIV0(25:11)
  9399     CALL 'kxdfhei1' USING DFHEIV0,
  9400           CLAM-ID,
  9401           DFHEIV20,
  9402           DFHEIV99,
  9403           CLAM-KEY,
  9404           DFHEIV99,
  9405           DFHEIV99,
  9406           DFHEIV99
  9407     SET ADDRESS OF CLAIM-MASTER TO
  9408         DFHEIV20
  9409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9410
  9411
  9412*    IF PI-COMPANY-ID = 'DMD'
  9413*            AND
  9414*       NOT SYSTEM-MODIFY-CAP
  9415*            AND
  9416*        HIGHEST-PRIORITY
  9417*        IF MAINTI = 'R'
  9418*            MOVE ER-0909        TO EMI-ERROR
  9419*            MOVE -1             TO ADDRL
  9420*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 186
* EL152.cbl
  9421*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9422*            GO TO 8200-SEND-DATAONLY
  9423*        ELSE
  9424*            MOVE ER-0900        TO EMI-ERROR
  9425*            MOVE -1             TO ADDRL
  9426*            MOVE AL-UABON       TO ADDRA
  9427*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9428*            GO TO 8200-SEND-DATAONLY.
  9429
  9430     IF ADDRL = ZEROS
  9431        GO TO 7099-EXIT.
  9432
  9433*    IF PI-COMPANY-ID = 'DMD'
  9434*        IF MAINTI = 'C'
  9435*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9436*                               '0000B0CAS0' OR '0000B0CA50' OR
  9437*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9438*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9439*                               '0000B0CO20' OR '0000B0MN10' OR
  9440*                               '0000B0MN20' OR '0000B0MN30' OR
  9441*                               '0000B0MN40' OR '0000B0MN50' OR
  9442*                               '0000B0MN60' OR '0000B0MN70'
  9443*           IF ADDRI(1:1) = 'B'
  9444*              MOVE ER-8158     TO EMI-ERROR
  9445*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9446*              MOVE -1          TO MAINTL
  9447*              GO TO 8200-SEND-DATAONLY.
  9448*
  9449*    IF PI-COMPANY-ID = 'DMD'
  9450*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9451*      IF PI-BSR-AUTOMATED
  9452*        IF MAINTI = 'C'
  9453*           MOVE ER-7843          TO EMI-ERROR
  9454*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9455*           MOVE -1               TO MAINTL
  9456*           GO TO 8200-SEND-DATAONLY.
  9457
  9458     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9459
  9460     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9461
  9462*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9463*        GO TO 7040-READ-PRODUCER.
  9464
  9465 7010-READ-ACCT.
  9466
  9467     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9468     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9469     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9470     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9471
  9472
  9473* EXEC CICS HANDLE CONDITION
  9474*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9475*         NOTFND     (7080-ACCT-NOT-FOUND)
  9476*    END-EXEC.
  9477*    MOVE '"$JI                  ! - #00008970' TO DFHEIV0
  9478     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 187
* EL152.cbl
  9479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9480     MOVE X'2D20233030303038393730' TO DFHEIV0(25:11)
  9481     CALL 'kxdfhei1' USING DFHEIV0
  9482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9483
  9484
  9485     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9486
  9487     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9488
  9489 7020-READNEXT.
  9490
  9491     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9492
  9493     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9494        IF WS-SAVE-ACCT-RECORD = SPACES
  9495            GO TO 7080-ACCT-NOT-FOUND
  9496        ELSE
  9497            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9498            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9499            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9500            GO TO 7030-CONTINUE-BUILD-ADDR.
  9501
  9502     IF AM-EXPIRATION-DT = HIGH-VALUES
  9503         NEXT SENTENCE
  9504     ELSE
  9505         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9506         GO TO 7020-READNEXT.
  9507
  9508     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9509     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9510
  9511 7030-CONTINUE-BUILD-ADDR.
  9512
  9513     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9514
  9515     IF WS-ADDR-TYPE-CD = 'A0'
  9516        MOVE ZEROS               TO PI-ADDR-SEQ
  9517     ELSE
  9518        GO TO 7067-CHECK-BENE-ADDR.
  9519
  9520     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9521     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9522     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9523     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9524*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9525     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9526        INTO WS-LABEL-LINES (4)
  9527     END-STRING
  9528     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9529     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9530
  9531     MOVE SPACES             TO  WS-ZIP-CODE.
  9532
  9533     IF AM-CANADIAN-POST-CODE
  9534         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9535         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9536     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 188
* EL152.cbl
  9537         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9538         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9539             MOVE '-'            TO  WS-AM-ZIP-DASH
  9540             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9541
  9542     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9543
  9544     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9545
  9546     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9547     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9548     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9549     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9550     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9551     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9552
  9553     GO TO 7099-EXIT.
  9554
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 189
* EL152.cbl
  9556*7040-READ-PRODUCER. Remove as dead code
  9557*7050-READNEXT. Remove as dead code
  9558*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9559 7067-CHECK-BENE-ADDR.
  9560
  9561*    IF PI-COMPANY-ID = 'DMD'
  9562*        IF WS-ADDR-TYPE-CD = 'B9'
  9563*            GO TO 7067-CHECK-BENE-ADDR-9.
  9564
  9565     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9566         GO TO 7068-CONTINUE-BUILD-ADDR.
  9567
  9568     IF CL-BENEFICIARY = SPACES
  9569         GO TO 7070-ACTV-NOT-FOUND.
  9570
  9571
  9572* EXEC CICS HANDLE CONDITION
  9573*         NOTFND     (7070-ACTV-NOT-FOUND)
  9574*    END-EXEC.
  9575*    MOVE '"$I                   ! . #00009061' TO DFHEIV0
  9576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9578     MOVE X'2E20233030303039303631' TO DFHEIV0(25:11)
  9579     CALL 'kxdfhei1' USING DFHEIV0
  9580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9581
  9582
  9583     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9584     MOVE 'B'                    TO BENE-REC-TYPE.
  9585     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9586
  9587
  9588* EXEC CICS READ
  9589*         DATASET    (BENE-ID)
  9590*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9591*         RIDFLD     (BENE-KEY)
  9592*    END-EXEC.
  9593*    MOVE '&"S        E          (   #00009069' TO DFHEIV0
  9594     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9595     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9596     MOVE X'2020233030303039303639' TO DFHEIV0(25:11)
  9597     CALL 'kxdfhei1' USING DFHEIV0,
  9598           BENE-ID,
  9599           DFHEIV20,
  9600           DFHEIV99,
  9601           BENE-KEY,
  9602           DFHEIV99,
  9603           DFHEIV99,
  9604           DFHEIV99
  9605     SET ADDRESS OF BENEFICIARY-MASTER TO
  9606         DFHEIV20
  9607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9608
  9609
  9610     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9611     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9612     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9613     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 190
* EL152.cbl
  9614     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9615*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9616     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9617        INTO WS-LABEL-LINES (5)
  9618     END-STRING
  9619     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9620
  9621     MOVE SPACES              TO  WS-ZIP-CODE.
  9622     IF BE-CANADIAN-POST-CODE
  9623         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9624         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9625     ELSE
  9626         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9627         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9628             MOVE '-'            TO  WS-AM-ZIP-DASH
  9629             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9630
  9631     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9632
  9633     GO TO 7069-SET-ADDR.
  9634
  9635 7067-CHECK-BENE-ADDR-9.
  9636
  9637     IF CL-BENEFICIARY = SPACES
  9638         GO TO 7070-ACTV-NOT-FOUND.
  9639
  9640
  9641* EXEC CICS HANDLE CONDITION
  9642*         NOTFND     (7070-ACTV-NOT-FOUND)
  9643*    END-EXEC.
  9644*    MOVE '"$I                   ! / #00009105' TO DFHEIV0
  9645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9647     MOVE X'2F20233030303039313035' TO DFHEIV0(25:11)
  9648     CALL 'kxdfhei1' USING DFHEIV0
  9649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9650
  9651
  9652     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9653     MOVE 'B'                    TO BENE-REC-TYPE.
  9654     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9655
  9656
  9657* EXEC CICS READ
  9658*         DATASET    (BENE-ID)
  9659*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9660*         RIDFLD     (BENE-KEY)
  9661*    END-EXEC.
  9662*    MOVE '&"S        E          (   #00009113' TO DFHEIV0
  9663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9665     MOVE X'2020233030303039313133' TO DFHEIV0(25:11)
  9666     CALL 'kxdfhei1' USING DFHEIV0,
  9667           BENE-ID,
  9668           DFHEIV20,
  9669           DFHEIV99,
  9670           BENE-KEY,
  9671           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 191
* EL152.cbl
  9672           DFHEIV99,
  9673           DFHEIV99
  9674     SET ADDRESS OF BENEFICIARY-MASTER TO
  9675         DFHEIV20
  9676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9677
  9678
  9679     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9680     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9681                                    WS-LABEL-LINES (1).
  9682     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9683                                    WS-LABEL-LINES (2).
  9684     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9685                                    WS-LABEL-LINES (3).
  9686     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9687                                    WS-LABEL-LINES (4).
  9688*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9689*                                   WS-LABEL-LINES (5).
  9690     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9691        INTO WS-LABEL-LINES (5)
  9692     END-STRING
  9693     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9694
  9695     MOVE SPACES                 TO WS-ZIP-CODE.
  9696
  9697     IF BE-CANADIAN-POST-CODE2
  9698         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9699         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9700     ELSE
  9701         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9702         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9703             MOVE '-'            TO WS-AM-ZIP-DASH
  9704             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9705
  9706     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9707                                    WS-LABEL-LINES (6).
  9708
  9709     GO TO 7069-SET-ADDR.
  9710
  9711 7068-CONTINUE-BUILD-ADDR.
  9712
  9713     IF ACTV-SEQ = ZEROS
  9714        GO TO 7070-ACTV-NOT-FOUND.
  9715
  9716     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9717
  9718
  9719* EXEC CICS HANDLE CONDITION
  9720*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9721*         NOTFND     (7070-ACTV-NOT-FOUND)
  9722*    END-EXEC.
  9723*    MOVE '"$JI                  ! 0 #00009158' TO DFHEIV0
  9724     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9726     MOVE X'3020233030303039313538' TO DFHEIV0(25:11)
  9727     CALL 'kxdfhei1' USING DFHEIV0
  9728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9729
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 192
* EL152.cbl
  9730
  9731
  9732* EXEC CICS READ
  9733*         DATASET    (ACTV-ID)
  9734*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9735*         RIDFLD     (ACTV-KEY)
  9736*    END-EXEC.
  9737*    MOVE '&"S        E          (   #00009163' TO DFHEIV0
  9738     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9740     MOVE X'2020233030303039313633' TO DFHEIV0(25:11)
  9741     CALL 'kxdfhei1' USING DFHEIV0,
  9742           ACTV-ID,
  9743           DFHEIV20,
  9744           DFHEIV99,
  9745           ACTV-KEY,
  9746           DFHEIV99,
  9747           DFHEIV99,
  9748           DFHEIV99
  9749     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9750         DFHEIV20
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9752
  9753
  9754     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9755     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9756     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9757     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9758*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9759     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9760        INTO WS-LABEL-LINES (4)
  9761     END-STRING
  9762     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9763
  9764     MOVE SPACES            TO  WS-ZIP-CODE.
  9765     IF AT-CANADIAN-POST-CODE
  9766         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9767         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9768     ELSE
  9769         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9770         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9771             MOVE '-'            TO  WS-AM-ZIP-DASH
  9772             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9773
  9774     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9775
  9776     MOVE SPACES            TO  REC-TEXT (6).
  9777
  9778 7069-SET-ADDR.
  9779     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9780
  9781     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9782     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9783     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9784     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9785     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9786     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9787
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 193
* EL152.cbl
  9788     GO TO 7099-EXIT.
  9789
  9790 7070-ACTV-NOT-FOUND.
  9791
  9792     IF ACTV-SEQ NOT = +29
  9793        GO TO 7075-CONTINUE-ACTV-ERROR.
  9794
  9795*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9796*        GO TO 7099-EXIT.
  9797
  9798     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9799        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9800        GO TO 7075-CONTINUE-ACTV-ERROR.
  9801
  9802     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9803        GO TO 7075-CONTINUE-ACTV-ERROR.
  9804
  9805     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9806     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9807     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9808     MOVE 'A'             TO WS-ERCOMP-TYPE
  9809     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9810                          TO WS-ERCOMP-RESP-NO.
  9811
  9812     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9813         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9814                                       'G' OR 'B' or 'S'
  9815             MOVE 'G'            TO WS-ERCOMP-TYPE
  9816             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9817         ELSE
  9818             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9819                                 TO WS-ERCOMP-ACCOUNT
  9820     ELSE
  9821         MOVE 'G'                TO WS-ERCOMP-TYPE
  9822         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9823
  9824     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9825        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9826
  9827     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9828        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9829
  9830
  9831* EXEC CICS HANDLE CONDITION
  9832*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9833*    END-EXEC.
  9834*    MOVE '"$I                   ! 1 #00009245' TO DFHEIV0
  9835     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9837     MOVE X'3120233030303039323435' TO DFHEIV0(25:11)
  9838     CALL 'kxdfhei1' USING DFHEIV0
  9839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9840
  9841
  9842
  9843* EXEC CICS  READ
  9844*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9845*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 194
* EL152.cbl
  9846*         RIDFLD   (WS-ERCOMP-KEY)
  9847*    END-EXEC.
  9848     MOVE 'ERCOMP' TO DFHEIV1
  9849*    MOVE '&"S        E          (   #00009249' TO DFHEIV0
  9850     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9852     MOVE X'2020233030303039323439' TO DFHEIV0(25:11)
  9853     CALL 'kxdfhei1' USING DFHEIV0,
  9854           DFHEIV1,
  9855           DFHEIV20,
  9856           DFHEIV99,
  9857           WS-ERCOMP-KEY,
  9858           DFHEIV99,
  9859           DFHEIV99,
  9860           DFHEIV99
  9861     SET ADDRESS OF COMPENSATION-MASTER TO
  9862         DFHEIV20
  9863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9864
  9865
  9866     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9867     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9868     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9869
  9870     IF CO-ACCT-NAME = SPACES
  9871        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9872
  9873     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9874     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9875     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9876
  9877     MOVE SPACES                TO  WS-ZIP-CODE.
  9878     IF CO-CANADIAN-POST-CODE
  9879         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9880         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9881     ELSE
  9882         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9883         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9884             MOVE '-'           TO  WS-AM-ZIP-DASH
  9885             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9886
  9887     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9888
  9889     MOVE ZEROS                 TO WS-PHONE-IN.
  9890     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9891     MOVE CO-PREFIX             TO WSPO-PFX.
  9892     MOVE CO-PHONE              TO WSPO-SFX.
  9893     MOVE WS-PHONE-OUT          TO SS53-6D.
  9894
  9895     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9896
  9897     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9898     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9899     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9900     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9901     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9902     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9903
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 195
* EL152.cbl
  9904     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 196
* EL152.cbl
  9906
  9907 7075-CONTINUE-ACTV-ERROR.
  9908     MOVE ER-0178                TO EMI-ERROR.
  9909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9910     MOVE -1                     TO ADDRL.
  9911     MOVE AL-UABON               TO ADDRA.
  9912     MOVE SPACES                 TO PI-ADDR-TYPE.
  9913     MOVE SPACES                 TO REC-TEXT (1)
  9914                                    REC-TEXT (2)
  9915                                    REC-TEXT (3)
  9916                                    REC-TEXT (4)
  9917                                    REC-TEXT (5)
  9918                                    REC-TEXT (6).
  9919     GO TO 7099-EXIT.
  9920
  9921 7080-ACCT-NOT-FOUND.
  9922     MOVE ER-0179                TO EMI-ERROR.
  9923     MOVE -1                     TO ADDRL.
  9924     MOVE AL-UABON               TO ADDRA.
  9925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9926     GO TO 8200-SEND-DATAONLY.
  9927
  9928 7090-CLAIM-NOT-FOUND.
  9929     MOVE ER-0186                TO EMI-ERROR.
  9930     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9931     GO TO 8200-SEND-DATAONLY.
  9932
  9933*7095-PROD-NOT-FOUND. Remove as dead code
  9934
  9935 7099-EXIT.
  9936      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 197
* EL152.cbl
  9938
  9939 7170-FORMAT-SCREEN.
  9940     IF MAINTI = 'S'
  9941        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9942       ELSE
  9943        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9944
  9945     IF TB-INDX < 7
  9946        SET LINE23 TO TB-INDX
  9947        MOVE 'A'                 TO LINE1
  9948       ELSE
  9949        IF TB-INDX = 7
  9950           MOVE ZEROS            TO LINE-NUM
  9951        ELSE
  9952           SET LIN-NUM TO TB-INDX
  9953           SUBTRACT 7            FROM LIN-NUM.
  9954
  9955     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9956     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9957     SET TB-INDX UP BY 1.
  9958
  9959 7170-EXIT.
  9960      EXIT.
  9961
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 198
* EL152.cbl
  9963 7200-RESOLVE-VARIABLES.
  9964***************************************************************
  9965*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9966*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9967*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9968*    RESOLVE ALL OF THE SYMBOLS.                              *
  9969***************************************************************
  9970
  9971*    IF PI-COMPANY-ID = 'AUK'
  9972*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9973
  9974     MOVE PI-CLAIM-NO            TO SS34D.
  9975
  9976     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9977        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9978     ELSE
  9979        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9980
  9981     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9982     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9983     MOVE CL-CAUSE-CD            TO SS19-1D.
  9984     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9985     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9986
  9987*    IF PI-COMPANY-ID NOT = 'DMD'
  9988*        GO TO 7200-CONTINUE.
  9989
  9990     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9991                           '8888' OR '9876'
  9992         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9993         MOVE WS-CCN-12          TO CL-CCN.
  9994
  9995     IF CL-CERT-STATE NOT = '08' AND '09'
  9996         MOVE SPACES             TO SS62D
  9997                                    SS63D
  9998         GO TO 7200-CONTINUE.
  9999
 10000     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
 10001
 10002     MOVE 'CL'                   TO DL23-SYSTEM-ID.
 10003     MOVE 'UN'                   TO DL23-RECORD-TYPE.
 10004     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
 10005
 10006
 10007* EXEC CICS LINK
 10008*        PROGRAM    ('DLO023')
 10009*        COMMAREA   (WS-DLO-CODES-TABLE)
 10010*        LENGTH     (DL23-COMM-LENGTH)
 10011*    END-EXEC.
 10012     MOVE 'DLO023' TO DFHEIV1
 10013*    MOVE '."C                   (   #00009395' TO DFHEIV0
 10014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10016     MOVE X'2020233030303039333935' TO DFHEIV0(25:11)
 10017     CALL 'kxdfhei1' USING DFHEIV0,
 10018           DFHEIV1,
 10019           WS-DLO-CODES-TABLE,
 10020           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 199
* EL152.cbl
 10021           DFHEIV99,
 10022           DFHEIV99,
 10023           DFHEIV99,
 10024           DFHEIV99
 10025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10026
 10027
 10028     IF DL23-RETURN-CODE = 'OK'
 10029         MOVE DL23-CODE-DESC     TO SS63D
 10030       ELSE
 10031         MOVE SPACES             TO SS63D.
 10032
 10033 7200-CONTINUE.
 10034     MOVE CL-CCN                 TO SS60D.
 10035
 10036     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 10037     MOVE SPACES                 TO DC-OPTION-CODE.
 10038     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10039     IF NO-CONVERSION-ERROR
 10040        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
 10041
 10042     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
 10043     MOVE SPACES                 TO DC-OPTION-CODE.
 10044     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10045     IF NO-CONVERSION-ERROR
 10046        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
 10047
 10048     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
 10049     MOVE SPACES                 TO DC-OPTION-CODE.
 10050     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10051     IF NO-CONVERSION-ERROR
 10052        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
 10053
 10054     IF NOT PI-USES-PAID-TO
 10055        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10056        MOVE SPACES                 TO DC-OPTION-CODE
 10057        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10058        IF NO-CONVERSION-ERROR
 10059           MOVE DC-GREG-DATE-1-EDIT TO SS17D
 10060        ELSE
 10061           MOVE SPACES TO SS17D
 10062     ELSE
 10063        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10064        MOVE '6'                    TO DC-OPTION-CODE
 10065        MOVE +1                     TO DC-ELAPSED-DAYS
 10066        MOVE +0                     TO DC-ELAPSED-MONTHS
 10067        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10068        IF NO-CONVERSION-ERROR
 10069           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
 10070
 10071     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
 10072     MOVE SPACES                 TO DC-OPTION-CODE.
 10073     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10074     IF NO-CONVERSION-ERROR
 10075        MOVE DC-GREG-DATE-1-EDIT TO SS45D
 10076     ELSE
 10077        MOVE '@@DOB'             TO SS45D.
 10078
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 200
* EL152.cbl
 10079     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 10080        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 10081             NEXT SENTENCE
 10082         ELSE
 10083             MOVE CL-SOC-SEC-NO  TO SS46D.
 10084
 10085     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 10086                                    ACCT-GROUPING
 10087                                    PROD-GROUPING
 10088                                    PLCY-GROUPING
 10089                                    PLAN-GROUPING.
 10090     MOVE CL-CERT-STATE          TO CERT-STATE
 10091                                    ACCT-STATE
 10092                                    PROD-STATE
 10093                                    PLCY-STATE
 10094                                    PLAN-STATE.
 10095     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 10096                                    ACCT-ACCOUNT
 10097                                    PROD-PRODUCER
 10098                                    PLCY-PRODUCER
 10099                                    PLAN-PRODUCER.
 10100     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
 10101                                    PLCY-EFF-DT.
 10102     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
 10103
 10104     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
 10105
 10106*    IF PI-COMPANY-ID = 'DMD'
 10107*       MOVE WS-NAME-WORK           TO SS10D
 10108*       GO TO 7200-CONTINUE-2.
 10109
 10110     IF LOWER-CASE-LETTERS-USED
 10111        MOVE 'N'                    TO WS-STATE-LINE
 10112        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10113        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10114        MOVE WS-TEMP-AREA2          TO SS10D
 10115     ELSE
 10116        MOVE WS-NAME-WORK           TO SS10D.
 10117
 10118 7200-CONTINUE-2.
 10119     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
 10120     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
 10121     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
 10122     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10123
 10124     IF LOWER-CASE-LETTERS-USED
 10125        MOVE 'N'                    TO WS-STATE-LINE
 10126        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10127        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10128        MOVE WS-TEMP-AREA2          TO SS39D
 10129     ELSE
 10130        MOVE WS-NAME-WORK           TO SS39D.
 10131
 10132     MOVE CL-INSURED-LAST-NAME   TO SS40D.
 10133
 10134     IF INSURED-IS-FEMALE
 10135        MOVE 'MS.'               TO SS41D
 10136       ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 201
* EL152.cbl
 10137        MOVE 'MR.'               TO SS41D.
 10138
 10139*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10140*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
 10141
 10142*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10143*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 202
* EL152.cbl
 10145
 10146* EXEC CICS HANDLE CONDITION
 10147*         NOTOPEN   (8900-CERT-NOT-OPEN)
 10148*         NOTFND    (8910-CERT-NOT-FOUND)
 10149*    END-EXEC.
 10150*    MOVE '"$JI                  ! 2 #00009518' TO DFHEIV0
 10151     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10153     MOVE X'3220233030303039353138' TO DFHEIV0(25:11)
 10154     CALL 'kxdfhei1' USING DFHEIV0
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158
 10159* EXEC CICS READ
 10160*         DATASET   (CERT-ID)
 10161*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10162*         RIDFLD    (CERT-KEY)
 10163*    END-EXEC.
 10164*    MOVE '&"S        E          (   #00009523' TO DFHEIV0
 10165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10167     MOVE X'2020233030303039353233' TO DFHEIV0(25:11)
 10168     CALL 'kxdfhei1' USING DFHEIV0,
 10169           CERT-ID,
 10170           DFHEIV20,
 10171           DFHEIV99,
 10172           CERT-KEY,
 10173           DFHEIV99,
 10174           DFHEIV99,
 10175           DFHEIV99
 10176     SET ADDRESS OF CERTIFICATE-MASTER TO
 10177         DFHEIV20
 10178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10179
 10180
 10181*    IF PI-COMPANY-ID = 'DMD'
 10182*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
 10183*        IF CM-POLICY-FORM-NO(6:1) = '1'
 10184*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
 10185*          ELSE
 10186*        IF CM-POLICY-FORM-NO(6:1) = '2'
 10187*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
 10188*          ELSE
 10189*            MOVE SPACES                 TO SS64D.
 10190
 10191     MOVE CM-CERT-NO             TO SS26D.
 10192     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
 10193
 10194*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10195*        MOVE CL-CURRENT-CARRIER TO SS23D
 10196*        MOVE CL-CURRENT-GROUPING
 10197*                                TO SS24D
 10198*        MOVE CL-CURRENT-ACCOUNT TO SS25D
 10199*        MOVE CM-MEMBER-NO       TO SS36D
 10200*        MOVE CM-GROUPING        TO W-GROUPING
 10201*        IF W-GROUP-3 = 'C01' OR 'C02'
 10202*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 203
* EL152.cbl
 10203*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
 10204*            MOVE W-CREDIT-CARD-LOAN-NO
 10205*                                TO SS36-1D
 10206*        ELSE
 10207*            MOVE CM-MEMBER-NO   TO SS36-1D
 10208*    ELSE
 10209         MOVE CM-CARRIER         TO SS23D.
 10210         MOVE CM-GROUPING        TO SS24D.
 10211         MOVE CM-ACCOUNT         TO SS25D.
 10212         MOVE CM-LOAN-NUMBER     TO SS36D.
 10213
 10214     MOVE CM-LOAN-BALANCE        TO SS37D.
 10215     MOVE CM-MEMBER-NO           TO SS38D.
 10216
 10217     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10218     MOVE SPACES                 TO DC-OPTION-CODE.
 10219     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10220     IF NO-CONVERSION-ERROR
 10221        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10222
 10223     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10224     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10225     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10226     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10227
 10228     IF LOWER-CASE-LETTERS-USED
 10229         MOVE 'N'                TO WS-STATE-LINE
 10230         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10231         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10232         MOVE WS-TEMP-AREA2      TO SS57D
 10233     ELSE
 10234         MOVE WS-NAME-WORK       TO SS57D.
 10235
 10236     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10237     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10238     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10239     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10240
 10241     IF LOWER-CASE-LETTERS-USED
 10242         MOVE 'N'                TO WS-STATE-LINE
 10243         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10244         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10245         MOVE WS-TEMP-AREA2      TO SS58D
 10246     ELSE
 10247         MOVE WS-NAME-WORK       TO SS58D.
 10248
 10249     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10250        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10251        MOVE CM-LF-ORIG-TERM     TO SS29D
 10252        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10253        MOVE CM-POLICY-FORM-NO   TO SS32D
 10254        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10255     ELSE
 10256        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10257        MOVE CM-AH-ORIG-TERM     TO SS29D
 10258        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10259        MOVE CM-POLICY-FORM-NO   TO SS32D
 10260        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 204
* EL152.cbl
 10261
 10262     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10263
 10264     MOVE WORK-AMOUNT            TO SS51D.
 10265
 10266     MOVE SPACES                 TO DC-OPTION-CODE.
 10267     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10268     IF NO-CONVERSION-ERROR
 10269        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10270
 10271     MOVE ' '                         TO  DC-OPTION-CODE.
 10272     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10273                                          DC-ELAPSED-DAYS.
 10274
 10275     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10276         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10277         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10278         IF NO-CONVERSION-ERROR
 10279             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10280         ELSE
 10281             NEXT SENTENCE
 10282     ELSE
 10283         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10284         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10285         IF NO-CONVERSION-ERROR
 10286             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10287
 10288*    GO TO 7200-READ-DIAGNOSIS.
 10289
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 205
* EL152.cbl
 10291*7200-READ-EMPLCY. Remove as dead code
 10292 7200-READ-DIAGNOSIS.
 10293
 10294* EXEC CICS HANDLE CONDITION
 10295*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10296*         NOTFND     (7200-READ-LOAN-NUMBER)
 10297*    END-EXEC.
 10298*    MOVE '"$JI                  ! 3 #00009641' TO DFHEIV0
 10299     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10301     MOVE X'3320233030303039363431' TO DFHEIV0(25:11)
 10302     CALL 'kxdfhei1' USING DFHEIV0
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
 10306     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10307     MOVE +90                   TO ACTV-SEQ.
 10308
 10309
 10310* EXEC CICS READ
 10311*         DATASET  (ACTV-ID)
 10312*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10313*         RIDFLD   (ACTV-KEY)
 10314*    END-EXEC.
 10315*    MOVE '&"S        E          (   #00009649' TO DFHEIV0
 10316     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10318     MOVE X'2020233030303039363439' TO DFHEIV0(25:11)
 10319     CALL 'kxdfhei1' USING DFHEIV0,
 10320           ACTV-ID,
 10321           DFHEIV20,
 10322           DFHEIV99,
 10323           ACTV-KEY,
 10324           DFHEIV99,
 10325           DFHEIV99,
 10326           DFHEIV99
 10327     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10328         DFHEIV20
 10329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10330
 10331
 10332     IF AT-TRAILER-TYPE = '6'
 10333        MOVE AT-INFO-LINE-1         TO SS19D.
 10334
 10335 7200-READ-LOAN-NUMBER.
 10336
 10337
 10338* EXEC CICS HANDLE CONDITION
 10339*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10340*         NOTFND     (7201-READ-BENEFICIARY)
 10341*    END-EXEC.
 10342*    MOVE '"$JI                  ! 4 #00009660' TO DFHEIV0
 10343     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10345     MOVE X'3420233030303039363630' TO DFHEIV0(25:11)
 10346     CALL 'kxdfhei1' USING DFHEIV0
 10347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10348
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 206
* EL152.cbl
 10349
 10350     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10351     MOVE +91                   TO ACTV-SEQ.
 10352
 10353
 10354* EXEC CICS READ
 10355*         DATASET  (ACTV-ID)
 10356*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10357*         RIDFLD   (ACTV-KEY)
 10358*    END-EXEC.
 10359*    MOVE '&"S        E          (   #00009668' TO DFHEIV0
 10360     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10362     MOVE X'2020233030303039363638' TO DFHEIV0(25:11)
 10363     CALL 'kxdfhei1' USING DFHEIV0,
 10364           ACTV-ID,
 10365           DFHEIV20,
 10366           DFHEIV99,
 10367           ACTV-KEY,
 10368           DFHEIV99,
 10369           DFHEIV99,
 10370           DFHEIV99
 10371     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10372         DFHEIV20
 10373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10374
 10375
 10376     IF AT-TRAILER-TYPE = '6'
 10377        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10378
 10379 7201-READ-BENEFICIARY.
 10380     IF CL-BENIF-ADDR-CNT = +0  AND
 10381        CL-BENEFICIARY = SPACES
 10382          GO TO 7205-READ-PHYSICIAN-ADDR.
 10383
 10384     IF W-BENEFICIARY > ZERO
 10385         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10386     ELSE
 10387         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10388         ADD +10                 TO ACTV-SEQ.
 10389
 10390
 10391* EXEC CICS HANDLE CONDITION
 10392*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10393*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10394*    END-EXEC.
 10395*    MOVE '"$JI                  ! 5 #00009688' TO DFHEIV0
 10396     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10398     MOVE X'3520233030303039363838' TO DFHEIV0(25:11)
 10399     CALL 'kxdfhei1' USING DFHEIV0
 10400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10401
 10402
 10403     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10404
 10405     IF ACTV-SEQ = +19
 10406         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 207
* EL152.cbl
 10407     ELSE
 10408         IF ACTV-SEQ NOT = +10
 10409             GO TO 7202-GET-FROM-ACTIVITY.
 10410
 10411     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10412     MOVE 'B'                  TO BENE-REC-TYPE.
 10413     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10414
 10415
 10416* EXEC CICS READ
 10417*         DATASET    (BENE-ID)
 10418*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10419*         RIDFLD     (BENE-KEY)
 10420*    END-EXEC.
 10421*    MOVE '&"S        E          (   #00009705' TO DFHEIV0
 10422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10424     MOVE X'2020233030303039373035' TO DFHEIV0(25:11)
 10425     CALL 'kxdfhei1' USING DFHEIV0,
 10426           BENE-ID,
 10427           DFHEIV20,
 10428           DFHEIV99,
 10429           BENE-KEY,
 10430           DFHEIV99,
 10431           DFHEIV99,
 10432           DFHEIV99
 10433     SET ADDRESS OF BENEFICIARY-MASTER TO
 10434         DFHEIV20
 10435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10436
 10437
 10438*    IF PI-COMPANY-ID = 'DMD'
 10439*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10440
 10441 7201-CONT.
 10442     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10443     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10444     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10445     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10446*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10447     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10448        INTO WS-LABEL-LINES (5)
 10449     END-STRING
 10450
 10451     MOVE SPACES                 TO WS-ZIP-CODE.
 10452
 10453     IF BE-CANADIAN-POST-CODE2
 10454         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10455         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10456     ELSE
 10457         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10458         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10459             MOVE '-'            TO WS-AM-ZIP-DASH
 10460             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10461
 10462     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10463
 10464     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 208
* EL152.cbl
 10465
 10466     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10467     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10468     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10469     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10470     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10471     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10472
 10473     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10474     MOVE WSPI-AREA              TO WSPO-AREA.
 10475     MOVE WSPI-PFX               TO WSPO-PFX.
 10476     MOVE WSPI-SFX               TO WSPO-SFX.
 10477     MOVE WS-PHONE-OUT           TO SS61-6D.
 10478
 10479 7201-CONT-PROCESS.
 10480     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10481     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10482     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10483     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10484*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10485     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10486        INTO WS-LABEL-LINES (5)
 10487     END-STRING
 10488
 10489     MOVE SPACES               TO  WS-ZIP-CODE.
 10490     IF BE-CANADIAN-POST-CODE
 10491         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10492         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10493     ELSE
 10494         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10495         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10496             MOVE '-'          TO  WS-AM-ZIP-DASH
 10497             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10498
 10499     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10500
 10501     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10502
 10503     GO TO 7204-SET-PHONE.
 10504
 10505 7202-GET-FROM-ACTIVITY.
 10506
 10507* EXEC CICS READ
 10508*         DATASET  (ACTV-ID)
 10509*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10510*         RIDFLD   (ACTV-KEY)
 10511*    END-EXEC.
 10512*    MOVE '&"S        E          (   #00009779' TO DFHEIV0
 10513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10515     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
 10516     CALL 'kxdfhei1' USING DFHEIV0,
 10517           ACTV-ID,
 10518           DFHEIV20,
 10519           DFHEIV99,
 10520           ACTV-KEY,
 10521           DFHEIV99,
 10522           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 209
* EL152.cbl
 10523           DFHEIV99
 10524     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10525         DFHEIV20
 10526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10527
 10528
 10529     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10530     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10531     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10532*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10533     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10534        INTO WS-LABEL-LINES (4)
 10535     END-STRING
 10536
 10537     MOVE SPACES                 TO  WS-ZIP-CODE.
 10538     IF AT-CANADIAN-POST-CODE
 10539         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10540         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10541     ELSE
 10542         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10543         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10544             MOVE '-'            TO  WS-AM-ZIP-DASH
 10545             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10546
 10547     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10548
 10549     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10550
 10551 7204-SET-PHONE.
 10552     MOVE WSPI-AREA              TO WSPO-AREA.
 10553     MOVE WSPI-PFX               TO WSPO-PFX.
 10554     MOVE WSPI-SFX               TO WSPO-SFX.
 10555     MOVE WS-PHONE-OUT           TO SS44-5D.
 10556
 10557     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10558
 10559     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10560     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10561     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10562     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10563     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10564     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10565
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 210
* EL152.cbl
 10567 7205-READ-PHYSICIAN-ADDR.
 10568     IF W-PHYSICIAN > ZERO
 10569         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10570     ELSE
 10571         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10572         ADD +30                 TO ACTV-SEQ.
 10573
 10574     IF ACTV-SEQ = +30
 10575        GO TO 7210-READ-EMPLOYER-ADDR.
 10576
 10577
 10578* EXEC CICS HANDLE CONDITION
 10579*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10580*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10581*    END-EXEC.
 10582*    MOVE '"$JI                  ! 6 #00009833' TO DFHEIV0
 10583     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10585     MOVE X'3620233030303039383333' TO DFHEIV0(25:11)
 10586     CALL 'kxdfhei1' USING DFHEIV0
 10587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10588
 10589
 10590
 10591* EXEC CICS READ
 10592*         DATASET    (ACTV-ID)
 10593*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10594*         RIDFLD     (ACTV-KEY)
 10595*    END-EXEC.
 10596*    MOVE '&"S        E          (   #00009838' TO DFHEIV0
 10597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10599     MOVE X'2020233030303039383338' TO DFHEIV0(25:11)
 10600     CALL 'kxdfhei1' USING DFHEIV0,
 10601           ACTV-ID,
 10602           DFHEIV20,
 10603           DFHEIV99,
 10604           ACTV-KEY,
 10605           DFHEIV99,
 10606           DFHEIV99,
 10607           DFHEIV99
 10608     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10609         DFHEIV20
 10610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10611
 10612
 10613     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10614     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10615     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10616     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10617*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10618     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10619        INTO WS-LABEL-LINES (4)
 10620     END-STRING
 10621
 10622     MOVE SPACES                 TO  WS-ZIP-CODE.
 10623     IF AT-CANADIAN-POST-CODE
 10624         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 211
* EL152.cbl
 10625         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10626     ELSE
 10627         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10628         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10629             MOVE '-'            TO  WS-AM-ZIP-DASH
 10630             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10631
 10632     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10633
 10634     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10635     MOVE WSPI-AREA              TO WSPO-AREA.
 10636     MOVE WSPI-PFX               TO WSPO-PFX.
 10637     MOVE WSPI-SFX               TO WSPO-SFX.
 10638     MOVE WS-PHONE-OUT           TO SS47-5D.
 10639
 10640     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10641
 10642     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10643     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10644     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10645     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10646     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10647
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 212
* EL152.cbl
 10649
 10650 7210-READ-EMPLOYER-ADDR.
 10651     IF W-EMPLOYER > ZERO
 10652         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10653     ELSE
 10654         MOVE CL-EMPLOYER-ADDR-CNT
 10655                                 TO ACTV-SEQ
 10656         ADD +40                 TO ACTV-SEQ.
 10657
 10658     IF ACTV-SEQ = +40
 10659        GO TO 7220-READ-INSURED-ADDR.
 10660
 10661
 10662* EXEC CICS HANDLE CONDITION
 10663*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10664*         NOTFND     (7220-READ-INSURED-ADDR)
 10665*    END-EXEC.
 10666*    MOVE '"$JI                  ! 7 #00009892' TO DFHEIV0
 10667     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10669     MOVE X'3720233030303039383932' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0
 10671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10672
 10673
 10674
 10675* EXEC CICS READ
 10676*         DATASET    (ACTV-ID)
 10677*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10678*         RIDFLD     (ACTV-KEY)
 10679*    END-EXEC.
 10680*    MOVE '&"S        E          (   #00009897' TO DFHEIV0
 10681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10683     MOVE X'2020233030303039383937' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0,
 10685           ACTV-ID,
 10686           DFHEIV20,
 10687           DFHEIV99,
 10688           ACTV-KEY,
 10689           DFHEIV99,
 10690           DFHEIV99,
 10691           DFHEIV99
 10692     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10693         DFHEIV20
 10694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10695
 10696
 10697     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10698     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10699     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10700     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10701*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10702     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10703        INTO WS-LABEL-LINES (4)
 10704     END-STRING
 10705
 10706     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 213
* EL152.cbl
 10707     IF AT-CANADIAN-POST-CODE
 10708         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10709         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10710     ELSE
 10711         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10712         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10713             MOVE '-'            TO  WS-AM-ZIP-DASH
 10714             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10715
 10716     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10717
 10718     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10719     MOVE WSPI-AREA              TO WSPO-AREA.
 10720     MOVE WSPI-PFX               TO WSPO-PFX.
 10721     MOVE WSPI-SFX               TO WSPO-SFX.
 10722     MOVE WS-PHONE-OUT           TO SS48-5D.
 10723
 10724     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10725
 10726     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10727     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10728     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10729     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10730     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10731
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 214
* EL152.cbl
 10733 7220-READ-INSURED-ADDR.
 10734
 10735     IF W-INSURED > ZERO
 10736         COMPUTE ACTV-SEQ = W-INSURED
 10737     ELSE
 10738         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10739
 10740     IF ACTV-SEQ = +0
 10741        GO TO 7225-READ-OTHER1-ADDR.
 10742
 10743
 10744* EXEC CICS HANDLE CONDITION
 10745*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10746*         NOTFND    (7225-READ-OTHER1-ADDR)
 10747*    END-EXEC.
 10748*    MOVE '"$JI                  ! 8 #00009949' TO DFHEIV0
 10749     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10751     MOVE X'3820233030303039393439' TO DFHEIV0(25:11)
 10752     CALL 'kxdfhei1' USING DFHEIV0
 10753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10754
 10755
 10756
 10757* EXEC CICS READ
 10758*         DATASET   (ACTV-ID)
 10759*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10760*         RIDFLD    (ACTV-KEY)
 10761*    END-EXEC.
 10762*    MOVE '&"S        E          (   #00009954' TO DFHEIV0
 10763     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10765     MOVE X'2020233030303039393534' TO DFHEIV0(25:11)
 10766     CALL 'kxdfhei1' USING DFHEIV0,
 10767           ACTV-ID,
 10768           DFHEIV20,
 10769           DFHEIV99,
 10770           ACTV-KEY,
 10771           DFHEIV99,
 10772           DFHEIV99,
 10773           DFHEIV99
 10774     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10775         DFHEIV20
 10776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10777
 10778
 10779     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10780     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10781     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10782     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10783*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10784     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10785        INTO WS-LABEL-LINES (4)
 10786     END-STRING
 10787
 10788     MOVE SPACES                 TO  WS-ZIP-CODE.
 10789     IF AT-CANADIAN-POST-CODE
 10790         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 215
* EL152.cbl
 10791         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10792     ELSE
 10793         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10794         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10795             MOVE '-'            TO  WS-AM-ZIP-DASH
 10796             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10797
 10798     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10799
 10800     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10801
 10802     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10803     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10804     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10805     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10806     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10807     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10808
 10809     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10810     MOVE WSPI-AREA              TO WSPO-AREA.
 10811     MOVE WSPI-PFX               TO WSPO-PFX.
 10812     MOVE WSPI-SFX               TO WSPO-SFX.
 10813     MOVE WS-PHONE-OUT           TO SS11-6D.
 10814
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 216
* EL152.cbl
 10816
 10817 7225-READ-OTHER1-ADDR.
 10818
 10819     IF W-OTHER-1 > ZERO
 10820         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10821     ELSE
 10822         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10823         ADD +50                  TO ACTV-SEQ.
 10824
 10825     IF ACTV-SEQ = +50
 10826        GO TO 7230-READ-OTHER2-ADDR.
 10827
 10828
 10829* EXEC CICS HANDLE CONDITION
 10830*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10831*         NOTFND     (7230-READ-OTHER2-ADDR)
 10832*    END-EXEC.
 10833*    MOVE '"$JI                  ! 9 #00010009' TO DFHEIV0
 10834     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10836     MOVE X'3920233030303130303039' TO DFHEIV0(25:11)
 10837     CALL 'kxdfhei1' USING DFHEIV0
 10838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10839
 10840
 10841
 10842* EXEC CICS READ
 10843*         DATASET    (ACTV-ID)
 10844*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10845*         RIDFLD     (ACTV-KEY)
 10846*    END-EXEC.
 10847*    MOVE '&"S        E          (   #00010014' TO DFHEIV0
 10848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10850     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 10851     CALL 'kxdfhei1' USING DFHEIV0,
 10852           ACTV-ID,
 10853           DFHEIV20,
 10854           DFHEIV99,
 10855           ACTV-KEY,
 10856           DFHEIV99,
 10857           DFHEIV99,
 10858           DFHEIV99
 10859     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10860         DFHEIV20
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
 10864     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10865     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10866     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10867     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10868*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10869     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10870        INTO WS-LABEL-LINES (4)
 10871     END-STRING
 10872
 10873     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 217
* EL152.cbl
 10874     IF AT-CANADIAN-POST-CODE
 10875         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10876         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10877     ELSE
 10878         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10879         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10880             MOVE '-'            TO  WS-AM-ZIP-DASH
 10881             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10882
 10883     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10884
 10885     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10886     MOVE WSPI-AREA              TO WSPO-AREA.
 10887     MOVE WSPI-PFX               TO WSPO-PFX.
 10888     MOVE WSPI-SFX               TO WSPO-SFX.
 10889     MOVE WS-PHONE-OUT           TO SS49-5D.
 10890
 10891     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10892
 10893     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10894     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10895     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10896     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10897     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10898
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 218
* EL152.cbl
 10900 7230-READ-OTHER2-ADDR.
 10901
 10902     IF W-OTHER-2 > ZERO
 10903         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10904     ELSE
 10905         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10906         ADD +60                  TO ACTV-SEQ.
 10907
 10908     IF ACTV-SEQ = +60
 10909        GO TO 7240-NOT-FOUND.
 10910
 10911
 10912* EXEC CICS HANDLE CONDITION
 10913*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10914*         NOTFND     (7240-NOT-FOUND)
 10915*    END-EXEC.
 10916*    MOVE '"$JI                  ! : #00010067' TO DFHEIV0
 10917     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10919     MOVE X'3A20233030303130303637' TO DFHEIV0(25:11)
 10920     CALL 'kxdfhei1' USING DFHEIV0
 10921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10922
 10923
 10924
 10925* EXEC CICS READ
 10926*         DATASET    (ACTV-ID)
 10927*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10928*         RIDFLD     (ACTV-KEY)
 10929*    END-EXEC.
 10930*    MOVE '&"S        E          (   #00010072' TO DFHEIV0
 10931     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10933     MOVE X'2020233030303130303732' TO DFHEIV0(25:11)
 10934     CALL 'kxdfhei1' USING DFHEIV0,
 10935           ACTV-ID,
 10936           DFHEIV20,
 10937           DFHEIV99,
 10938           ACTV-KEY,
 10939           DFHEIV99,
 10940           DFHEIV99,
 10941           DFHEIV99
 10942     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10943         DFHEIV20
 10944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10945
 10946
 10947     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10948     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10949     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10950     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10951*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10952     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10953        INTO WS-LABEL-LINES (4)
 10954     END-STRING
 10955
 10956     MOVE SPACES                 TO  WS-ZIP-CODE.
 10957     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 219
* EL152.cbl
 10958         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10959         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10960     ELSE
 10961         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10962         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10963             MOVE '-'            TO  WS-AM-ZIP-DASH
 10964             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10965
 10966     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10967
 10968     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10969     MOVE WSPI-AREA              TO WSPO-AREA.
 10970     MOVE WSPI-PFX               TO WSPO-PFX.
 10971     MOVE WSPI-SFX               TO WSPO-SFX.
 10972     MOVE WS-PHONE-OUT           TO SS50-5D.
 10973
 10974     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10975
 10976     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10977     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10978     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10979     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10980     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10981
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 220
* EL152.cbl
 10983 7240-NOT-FOUND.
 10984     IF ACCOUNT-IS-ONLINE
 10985        GO TO 7250-READ-ACCOUNT.
 10986
 10987     IF W-ACCOUNT > ZERO
 10988         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10989     ELSE
 10990         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10991         ADD +20                  TO ACTV-SEQ.
 10992
 10993     IF ACTV-SEQ = +20
 10994        GO TO 7250-READ-ACCOUNT.
 10995
 10996
 10997* EXEC CICS HANDLE CONDITION
 10998*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10999*         NOTFND     (7250-READ-ACCOUNT)
 11000*    END-EXEC.
 11001*    MOVE '"$JI                  ! ; #00010127' TO DFHEIV0
 11002     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11004     MOVE X'3B20233030303130313237' TO DFHEIV0(25:11)
 11005     CALL 'kxdfhei1' USING DFHEIV0
 11006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11007
 11008
 11009
 11010* EXEC CICS READ
 11011*         DATASET    (ACTV-ID)
 11012*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11013*         RIDFLD     (ACTV-KEY)
 11014*    END-EXEC.
 11015*    MOVE '&"S        E          (   #00010132' TO DFHEIV0
 11016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11018     MOVE X'2020233030303130313332' TO DFHEIV0(25:11)
 11019     CALL 'kxdfhei1' USING DFHEIV0,
 11020           ACTV-ID,
 11021           DFHEIV20,
 11022           DFHEIV99,
 11023           ACTV-KEY,
 11024           DFHEIV99,
 11025           DFHEIV99,
 11026           DFHEIV99
 11027     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11028         DFHEIV20
 11029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11030
 11031
 11032     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11033     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 11034     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 11035     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 11036*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 11037     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 11038        INTO WS-LABEL-LINES (4)
 11039     END-STRING
 11040
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 221
* EL152.cbl
 11041     MOVE SPACES                 TO  WS-ZIP-CODE.
 11042     IF AT-CANADIAN-POST-CODE
 11043         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11044         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11045     ELSE
 11046         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11047         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11048             MOVE '-'            TO  WS-AM-ZIP-DASH
 11049             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11050
 11051     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11052
 11053     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11054     MOVE WSPI-AREA              TO WSPO-AREA.
 11055     MOVE WSPI-PFX               TO WSPO-PFX.
 11056     MOVE WSPI-SFX               TO WSPO-SFX.
 11057     MOVE WS-PHONE-OUT           TO SS07-6D.
 11058
 11059*    IF PI-COMPANY-ID NOT = 'FLA'
 11060*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11061
 11062     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11063     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11064     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11065     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11066     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11067     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11068
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 222
* EL152.cbl
 11070 7250-READ-ACCOUNT.
 11071*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11072*        GO TO 7250-READ-PRODUCER.
 11073
 11074     IF WS-ACCT-READ-SW = 'Y'
 11075        GO TO 7250-BUILD-ACCT-ADDR.
 11076
 11077     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 11078
 11079
 11080* EXEC CICS HANDLE CONDITION
 11081*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 11082*         NOTFND    (7251-READ-3RD-PARTY)
 11083*    END-EXEC.
 11084*    MOVE '"$JI                  ! < #00010185' TO DFHEIV0
 11085     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11087     MOVE X'3C20233030303130313835' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0
 11089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11090
 11091
 11092 7250-STARTBR-ACCOUNT.
 11093     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 11094     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 11095
 11096 7250-READNEXT-ACCOUNT.
 11097     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 11098
 11099     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 11100         IF WS-SAVE-ACCT-RECORD = SPACES
 11101             GO TO 7251-READ-3RD-PARTY
 11102         ELSE
 11103             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 11104             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 11105             GO TO 7250-BUILD-ACCT-ADDR.
 11106
 11107     IF AM-EXPIRATION-DT = HIGH-VALUES
 11108         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 11109     ELSE
 11110         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 11111         GO TO 7250-READNEXT-ACCOUNT.
 11112
 11113 7250-BUILD-ACCT-ADDR.
 11114     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 11115
 11116     IF NOT ACCOUNT-IS-ONLINE
 11117        GO TO 7251-READ-3RD-PARTY.
 11118
 11119     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11120     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 11121     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 11122     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 11123*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 11124     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 11125        INTO WS-LABEL-LINES (4)
 11126     END-STRING
 11127
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 223
* EL152.cbl
 11128     MOVE SPACES                TO  WS-ZIP-CODE.
 11129     IF AM-CANADIAN-POST-CODE
 11130         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11131         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11132     ELSE
 11133         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11134         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11135             MOVE '-'           TO  WS-AM-ZIP-DASH
 11136             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11137
 11138     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11139
 11140     MOVE ZEROS                 TO WS-PHONE-IN.
 11141     MOVE AM-AREA-CODE          TO WSPO-AREA.
 11142     MOVE AM-TEL-PRE            TO WSPO-PFX.
 11143     MOVE AM-TEL-NBR            TO WSPO-SFX.
 11144     MOVE WS-PHONE-OUT          TO SS07-6D.
 11145
 11146*    IF PI-COMPANY-ID NOT = 'FLA'
 11147*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11148
 11149     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11150     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11151     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11152     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11153     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11154     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11155
 11156*    GO TO 7251-READ-3RD-PARTY.
 11157
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 224
* EL152.cbl
 11159*7250-READ-PRODUCER. Remove as dead code
 11160*7250-STARTBR-PRODUCER. Remove as dead code
 11161*7250-READNEXT-PRODUCER. Remove as dead code
 11162*7250-BUILD-PROD-ADDR. Remove as dead code
 11163 7251-READ-3RD-PARTY.
 11164
 11165     MOVE +29                    TO ACTV-SEQ.
 11166
 11167
 11168* EXEC CICS HANDLE CONDITION
 11169*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11170*         NOTFND     (7252-READ-COMP)
 11171*    END-EXEC.
 11172*    MOVE '"$JI                  ! = #00010265' TO DFHEIV0
 11173     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11175     MOVE X'3D20233030303130323635' TO DFHEIV0(25:11)
 11176     CALL 'kxdfhei1' USING DFHEIV0
 11177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11178
 11179
 11180
 11181* EXEC CICS READ
 11182*         DATASET    (ACTV-ID)
 11183*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11184*         RIDFLD     (ACTV-KEY)
 11185*    END-EXEC.
 11186*    MOVE '&"S        E          (   #00010270' TO DFHEIV0
 11187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11189     MOVE X'2020233030303130323730' TO DFHEIV0(25:11)
 11190     CALL 'kxdfhei1' USING DFHEIV0,
 11191           ACTV-ID,
 11192           DFHEIV20,
 11193           DFHEIV99,
 11194           ACTV-KEY,
 11195           DFHEIV99,
 11196           DFHEIV99,
 11197           DFHEIV99
 11198     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11199         DFHEIV20
 11200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11201
 11202
 11203     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11204     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 11205     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 11206     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 11207*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 11208     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 11209        INTO WS-LABEL-LINES (4)
 11210     END-STRING
 11211
 11212     MOVE SPACES                 TO  WS-ZIP-CODE.
 11213     IF AT-CANADIAN-POST-CODE
 11214         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11215         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11216     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 225
* EL152.cbl
 11217         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11218         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11219             MOVE '-'            TO  WS-AM-ZIP-DASH
 11220             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11221
 11222     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11223
 11224     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11225     MOVE WSPI-AREA              TO WSPO-AREA.
 11226     MOVE WSPI-PFX               TO WSPO-PFX.
 11227     MOVE WSPI-SFX               TO WSPO-SFX.
 11228     MOVE WS-PHONE-OUT           TO SS53-6D.
 11229
 11230     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11231
 11232     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11233     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11234     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11235     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11236     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11237     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11238
 11239     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 226
* EL152.cbl
 11241 7252-READ-COMP.
 11242
 11243     IF WS-COMP-READ-SW = 'Y'
 11244        GO TO 7255-BUILD-COMP-ADDR.
 11245
 11246     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11247        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11248        GO TO 7260-READ-DENIAL.
 11249
 11250     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11251        NEXT SENTENCE
 11252     ELSE
 11253        GO TO 7260-READ-DENIAL.
 11254
 11255     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11256        GO TO 7260-READ-DENIAL.
 11257
 11258     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11259     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11260     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11261     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11262     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11263                          TO WS-ERCOMP-RESP-NO.
 11264
 11265     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11266         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11267                                       'G' OR 'B' or 'S'
 11268             MOVE 'G'            TO WS-ERCOMP-TYPE
 11269             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11270         ELSE
 11271             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11272                                 TO WS-ERCOMP-ACCOUNT
 11273     ELSE
 11274         MOVE 'G'                TO WS-ERCOMP-TYPE
 11275         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11276
 11277     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11278        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11279
 11280     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11281        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11282
 11283
 11284* EXEC CICS HANDLE CONDITION
 11285*         NOTFND    (7260-READ-DENIAL)
 11286*    END-EXEC.
 11287*    MOVE '"$I                   ! > #00010356' TO DFHEIV0
 11288     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11290     MOVE X'3E20233030303130333536' TO DFHEIV0(25:11)
 11291     CALL 'kxdfhei1' USING DFHEIV0
 11292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11293
 11294
 11295
 11296* EXEC CICS  READ
 11297*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11298*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 227
* EL152.cbl
 11299*         RIDFLD   (WS-ERCOMP-KEY)
 11300*    END-EXEC.
 11301     MOVE 'ERCOMP' TO DFHEIV1
 11302*    MOVE '&"S        E          (   #00010360' TO DFHEIV0
 11303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11305     MOVE X'2020233030303130333630' TO DFHEIV0(25:11)
 11306     CALL 'kxdfhei1' USING DFHEIV0,
 11307           DFHEIV1,
 11308           DFHEIV20,
 11309           DFHEIV99,
 11310           WS-ERCOMP-KEY,
 11311           DFHEIV99,
 11312           DFHEIV99,
 11313           DFHEIV99
 11314     SET ADDRESS OF COMPENSATION-MASTER TO
 11315         DFHEIV20
 11316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11317
 11318
 11319 7255-BUILD-COMP-ADDR.
 11320
 11321     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11322     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11323     IF CO-ACCT-NAME = SPACES
 11324        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11325     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11326     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11327     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11328
 11329     MOVE SPACES                TO  WS-ZIP-CODE.
 11330     IF CO-CANADIAN-POST-CODE
 11331         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11332         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11333     ELSE
 11334         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11335         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11336             MOVE '-'           TO  WS-AM-ZIP-DASH
 11337             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11338
 11339     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11340
 11341     MOVE ZEROS                 TO WS-PHONE-IN.
 11342     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11343     MOVE CO-PREFIX             TO WSPO-PFX.
 11344     MOVE CO-PHONE              TO WSPO-SFX.
 11345     MOVE WS-PHONE-OUT          TO SS53-6D.
 11346
 11347     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11348
 11349     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11350     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11351     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11352     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11353     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11354     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11355
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 228
* EL152.cbl
 11357
 11358 7260-READ-DENIAL.
 11359
 11360     MOVE +93                    TO ACTV-SEQ
 11361
 11362
 11363* EXEC CICS HANDLE CONDITION
 11364*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11365*         NOTFND     (7265-READ-CNTL1)
 11366*         ENDFILE    (7265-READ-CNTL1)
 11367*    END-EXEC.
 11368*    MOVE '"$JI''                 ! ? #00010409' TO DFHEIV0
 11369     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11371     MOVE X'3F20233030303130343039' TO DFHEIV0(25:11)
 11372     CALL 'kxdfhei1' USING DFHEIV0
 11373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11374
 11375
 11376
 11377* EXEC CICS STARTBR
 11378*         DATASET    (ACTV-ID)
 11379*         RIDFLD     (ACTV-KEY)
 11380*         GTEQ
 11381*    END-EXEC.
 11382     MOVE 0
 11383       TO DFHEIV11
 11384*    MOVE '&,         G          &   #00010415' TO DFHEIV0
 11385     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11387     MOVE X'2020233030303130343135' TO DFHEIV0(25:11)
 11388     CALL 'kxdfhei1' USING DFHEIV0,
 11389           ACTV-ID,
 11390           ACTV-KEY,
 11391           DFHEIV99,
 11392           DFHEIV11,
 11393           DFHEIV99
 11394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11395
 11396
 11397     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11398     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11399
 11400 7262-READ-NEXT.
 11401
 11402
 11403* EXEC CICS READNEXT
 11404*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11405*         RIDFLD  (ACTV-KEY)
 11406*         DATASET (ACTV-ID)
 11407*    END-EXEC.
 11408     MOVE 0
 11409       TO DFHEIV11
 11410*    MOVE '&.S                   )   #00010426' TO DFHEIV0
 11411     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11412     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11413     MOVE X'2020233030303130343236' TO DFHEIV0(25:11)
 11414     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 229
* EL152.cbl
 11415           ACTV-ID,
 11416           DFHEIV20,
 11417           DFHEIV99,
 11418           ACTV-KEY,
 11419           DFHEIV99,
 11420           DFHEIV11,
 11421           DFHEIV99,
 11422           DFHEIV99
 11423     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11424         DFHEIV20
 11425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11426
 11427
 11428     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11429        GO TO 7265-READ-CNTL1.
 11430     IF AT-TRAILER-TYPE = '2'
 11431        AND AT-PAYMENT-TYPE = 'I'
 11432        AND AT-INT-RATE NUMERIC
 11433        AND AT-INT-RATE NOT = ZEROS
 11434        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11435        MOVE +1                  TO S2
 11436        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11437           (S1 > +6)
 11438           IF WS-WORK-INT (S1:1) NOT = '0'
 11439              MOVE WS-WORK-INT (S1:1)
 11440                                 TO SS16-1D (S2:1)
 11441              ADD +1             TO S2
 11442           END-IF
 11443        END-PERFORM
 11444        MOVE '%'                 TO SS16-1D (S2:1)
 11445        GO TO 7262-READ-NEXT
 11446     END-IF
 11447     IF AT-TRAILER-TYPE = '8'
 11448        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11449        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11450        IF (CL-TOTAL-INT-PAID = ZEROS)
 11451           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11452           GO TO 7265-READ-CNTL1
 11453        END-IF
 11454     END-IF
 11455     GO TO 7262-READ-NEXT
 11456     .
 11457 7265-READ-CNTL1.
 11458     IF ACTV-BROWSE-STARTED = 'Y'
 11459        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11460
 11461* EXEC CICS ENDBR
 11462*            DATASET    (ACTV-ID)
 11463*       END-EXEC.
 11464     MOVE 0
 11465       TO DFHEIV11
 11466*    MOVE '&2                    $   #00010464' TO DFHEIV0
 11467     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11469     MOVE X'2020233030303130343634' TO DFHEIV0(25:11)
 11470     CALL 'kxdfhei1' USING DFHEIV0,
 11471           ACTV-ID,
 11472           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 230
* EL152.cbl
 11473           DFHEIV99
 11474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11475
 11476
 11477     IF SS35-1D = ALL '*'
 11478         MOVE '@@DENIAL1'        TO SS35-1D.
 11479
 11480     IF SS35-2D = ALL '*'
 11481         MOVE '@@DENIAL2'        TO SS35-2D.
 11482
 11483     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11484     MOVE ZEROS                  TO CNTL-SEQ.
 11485
 11486* EXEC CICS HANDLE CONDITION
 11487*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11488*         NOTFND    (7266-READ-CNTL2)
 11489*    END-EXEC.
 11490*    MOVE '"$JI                  ! @ #00010476' TO DFHEIV0
 11491     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11493     MOVE X'4020233030303130343736' TO DFHEIV0(25:11)
 11494     CALL 'kxdfhei1' USING DFHEIV0
 11495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11496
 11497
 11498
 11499* EXEC CICS READ
 11500*         DATASET   (CNTL-ID)
 11501*         SET       (ADDRESS OF CONTROL-FILE)
 11502*         RIDFLD    (CNTL-KEY)
 11503*    END-EXEC.
 11504*    MOVE '&"S        E          (   #00010481' TO DFHEIV0
 11505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11507     MOVE X'2020233030303130343831' TO DFHEIV0(25:11)
 11508     CALL 'kxdfhei1' USING DFHEIV0,
 11509           CNTL-ID,
 11510           DFHEIV20,
 11511           DFHEIV99,
 11512           CNTL-KEY,
 11513           DFHEIV99,
 11514           DFHEIV99,
 11515           DFHEIV99
 11516     SET ADDRESS OF CONTROL-FILE TO
 11517         DFHEIV20
 11518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11519
 11520
 11521     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11522     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11523     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11524     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11525     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11526     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11527
 11528     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11529         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11530     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 231
* EL152.cbl
 11531         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11532         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11533
 11534     MOVE SPACES                 TO  WS-ZIP-CODE.
 11535     IF CF-CL-CAN-POST-CODE
 11536         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11537         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11538     ELSE
 11539         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11540         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11541             MOVE '-'              TO  WS-AM-ZIP-DASH
 11542             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11543
 11544     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11545
 11546     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11547
 11548     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11549     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11550     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11551     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11552     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11553     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11554
 11555 7266-READ-CNTL2.
 11556     IF PI-PROCESSOR-ID  =  LGXX-ID
 11557        GO TO 7267-READ-CNTL4.
 11558
 11559     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11560     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11561     MOVE ZEROS                  TO CNTL-SEQ.
 11562
 11563
 11564* EXEC CICS HANDLE CONDITION
 11565*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11566*         NOTFND     (7267-READ-CNTL4)
 11567*    END-EXEC.
 11568*    MOVE '"$JI                  ! A #00010529' TO DFHEIV0
 11569     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11571     MOVE X'4120233030303130353239' TO DFHEIV0(25:11)
 11572     CALL 'kxdfhei1' USING DFHEIV0
 11573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11574
 11575
 11576
 11577* EXEC CICS READ
 11578*         DATASET    (CNTL-ID)
 11579*         SET        (ADDRESS OF CONTROL-FILE)
 11580*         RIDFLD     (CNTL-KEY)
 11581*    END-EXEC.
 11582*    MOVE '&"S        E          (   #00010534' TO DFHEIV0
 11583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11585     MOVE X'2020233030303130353334' TO DFHEIV0(25:11)
 11586     CALL 'kxdfhei1' USING DFHEIV0,
 11587           CNTL-ID,
 11588           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 232
* EL152.cbl
 11589           DFHEIV99,
 11590           CNTL-KEY,
 11591           DFHEIV99,
 11592           DFHEIV99,
 11593           DFHEIV99
 11594     SET ADDRESS OF CONTROL-FILE TO
 11595         DFHEIV20
 11596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11597
 11598
 11599     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11600     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11601
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 233
* EL152.cbl
 11603 7267-READ-CNTL4.
 11604*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11605*        GO TO 7267-READ-EMPLAN.
 11606
 11607     IF BEN-HOLD = ZEROS
 11608        GO TO 7267-READ-CNTL6.
 11609
 11610     MOVE BEN-HOLD               TO CNTL-GEN2.
 11611     MOVE SPACES                 TO CNTL-GEN1.
 11612
 11613     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11614        MOVE '4'                 TO CNTL-RECORD-TYPE
 11615     ELSE
 11616        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11617
 11618     MOVE ZEROS                  TO CNTL-SEQ.
 11619
 11620
 11621* EXEC CICS HANDLE CONDITION
 11622*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11623*         NOTFND     (7267-READ-CNTL6)
 11624*    END-EXEC.
 11625*    MOVE '"$JI                  ! B #00010561' TO DFHEIV0
 11626     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11628     MOVE X'4220233030303130353631' TO DFHEIV0(25:11)
 11629     CALL 'kxdfhei1' USING DFHEIV0
 11630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11631
 11632
 11633
 11634* EXEC CICS READ
 11635*         DATASET    (CNTL-ID)
 11636*         SET        (ADDRESS OF CONTROL-FILE)
 11637*         RIDFLD     (CNTL-KEY)
 11638*         GTEQ
 11639*    END-EXEC.
 11640*    MOVE '&"S        G          (   #00010566' TO DFHEIV0
 11641     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11643     MOVE X'2020233030303130353636' TO DFHEIV0(25:11)
 11644     CALL 'kxdfhei1' USING DFHEIV0,
 11645           CNTL-ID,
 11646           DFHEIV20,
 11647           DFHEIV99,
 11648           CNTL-KEY,
 11649           DFHEIV99,
 11650           DFHEIV99,
 11651           DFHEIV99
 11652     SET ADDRESS OF CONTROL-FILE TO
 11653         DFHEIV20
 11654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11655
 11656
 11657     MOVE 1                      TO SUB.
 11658 7267-LOOP.
 11659     IF SUB = 9
 11660        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 234
* EL152.cbl
 11661
 11662     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11663        ADD 1 TO SUB
 11664        GO TO 7267-LOOP.
 11665
 11666     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11667        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11668        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11669           OR CL-CLAIM-TYPE = 'I'
 11670           OR CL-CLAIM-TYPE = 'G'
 11671           OR CL-CLAIM-TYPE = 'F'
 11672           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11673           MOVE ELIM-DAYS                TO SS42D.
 11674
 11675     GO TO 7267-READ-CNTL6.
 11676
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 235
* EL152.cbl
 11678*7267-READ-EMPLAN. Remove as dead code
 11679 7267-READ-CNTL6.
 11680     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11681     MOVE SPACES                 TO CNTL-GENL.
 11682
 11683*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11684*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11685*    ELSE
 11686         MOVE PI-CARRIER         TO CNTL-GEN4.
 11687
 11688     MOVE ZEROS                  TO CNTL-SEQ.
 11689
 11690
 11691* EXEC CICS HANDLE CONDITION
 11692*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11693*         NOTFND     (7268-SET-DATE)
 11694*    END-EXEC.
 11695*    MOVE '"$JI                  ! C #00010606' TO DFHEIV0
 11696     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11698     MOVE X'4320233030303130363036' TO DFHEIV0(25:11)
 11699     CALL 'kxdfhei1' USING DFHEIV0
 11700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11701
 11702
 11703
 11704* EXEC CICS READ
 11705*         DATASET    (CNTL-ID)
 11706*         SET        (ADDRESS OF CONTROL-FILE)
 11707*         RIDFLD     (CNTL-KEY)
 11708*    END-EXEC.
 11709*    MOVE '&"S        E          (   #00010611' TO DFHEIV0
 11710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11712     MOVE X'2020233030303130363131' TO DFHEIV0(25:11)
 11713     CALL 'kxdfhei1' USING DFHEIV0,
 11714           CNTL-ID,
 11715           DFHEIV20,
 11716           DFHEIV99,
 11717           CNTL-KEY,
 11718           DFHEIV99,
 11719           DFHEIV99,
 11720           DFHEIV99
 11721     SET ADDRESS OF CONTROL-FILE TO
 11722         DFHEIV20
 11723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11724
 11725
 11726     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11727     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11728     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11729     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11730     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11731     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11732
 11733     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11734         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11735     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 236
* EL152.cbl
 11736         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11737         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11738
 11739     MOVE SPACES              TO  WS-ZIP-CODE.
 11740     IF CF-CANADIAN-POST-CODE
 11741         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11742         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11743     ELSE
 11744         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11745         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11746             MOVE '-'          TO  WS-AM-ZIP-DASH
 11747             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11748
 11749     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11750
 11751     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11752     MOVE WSPI-AREA           TO WSPO-AREA.
 11753     MOVE WSPI-PFX            TO WSPO-PFX.
 11754     MOVE WSPI-SFX            TO WSPO-SFX.
 11755     MOVE WS-PHONE-OUT        TO SS04-6D.
 11756
 11757     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11758
 11759     MOVE WS-LABEL-LINES (1)  TO SS03D
 11760     IF PI-CARRIER = '8'
 11761        MOVE 'as Administrator for Investors Heritage Life Insuran
 11762-     'ce Company'               TO SS03-1D
 11763     END-IF
 11764     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11765     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11766     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11767     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11768     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11769
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 237
* EL152.cbl
 11771 7268-SET-DATE.
 11772     MOVE EIBDATE                TO DATE-WORK.
 11773     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11774     MOVE '5'                    TO DC-OPTION-CODE.
 11775     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11776     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11777     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11778
 11779     IF NOT LOWER-CASE-LETTERS-USED
 11780        GO TO 7269-EXIT.
 11781
 11782*    IF PI-COMPANY-ID = 'DMD'
 11783*        MOVE SS21D              TO WS-TEMP-AREA2
 11784*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11785*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11786*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11787*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11788*        END-IF
 11789*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11790*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11791*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11792*        END-IF
 11793*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11794*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11795*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11796*        END-IF
 11797*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11798*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11799*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11800*        END-IF
 11801*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11802*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11803*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11804*        END-IF
 11805*        MOVE WS-TEMP-AREA2      TO SS21D
 11806*        GO TO 7269-EXIT.
 11807*
 11808     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11809     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11810     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11811     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11812
 11813     MOVE 'N'                    TO WS-STATE-LINE.
 11814
 11815     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11816     MOVE SS08D                  TO WS-TEMP-AREA2.
 11817     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11818     MOVE WS-TEMP-AREA2          TO SS08D.
 11819     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11820     MOVE 'N'                    TO WS-CAPS-SW.
 11821
 11822     MOVE SS09D                  TO WS-TEMP-AREA2.
 11823     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11824     MOVE WS-TEMP-AREA2          TO SS09D.
 11825
 11826     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11827     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11828     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 238
* EL152.cbl
 11829
 11830     MOVE SS21D                  TO WS-TEMP-AREA2.
 11831     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11832     MOVE WS-TEMP-AREA2          TO SS21D.
 11833
 11834     MOVE SS40D                  TO WS-TEMP-AREA2.
 11835     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11836     MOVE WS-TEMP-AREA2          TO SS40D.
 11837
 11838     MOVE SS41D                  TO WS-TEMP-AREA2.
 11839     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11840     MOVE WS-TEMP-AREA2          TO SS41D.
 11841
 11842 7269-EXIT.
 11843     EXIT.
 11844
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 239
* EL152.cbl
 11846*            COPY ELCNAMET.
 11847*****************************************************************
 11848*                                                               *
 11849*                                                               *
 11850*                            ELCNAMET                           *
 11851*                            VMOD=2.003                         *
 11852*                                                               *
 11853*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11854*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11855*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11856*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11857*                                                               *
 11858*                                                               *
 11859*****************************************************************.
 11860*                   C H A N G E   L O G
 11861*
 11862* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11863*-----------------------------------------------------------------
 11864*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11865* EFFECTIVE    NUMBER
 11866*-----------------------------------------------------------------
 11867* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11868*                                PROCESSOR NAME LINE IN CAPS
 11869******************************************************************
 11870
 11871 7270-LABEL-MOVE.
 11872     IF WS-LABEL-HOLD-AREA = SPACES
 11873        GO TO 7279-EXIT.
 11874
 11875     IF PI-COMPANY-ID NOT = 'DMD'
 11876         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11877
 11878 7270-LABEL-MOVE-1.
 11879
 11880     IF WS-LABEL-LINES (1) = SPACES
 11881        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11882        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11883        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11884        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11885        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11886        MOVE SPACES              TO WS-LABEL-LINES (6)
 11887        GO TO 7270-LABEL-MOVE-1.
 11888
 11889     IF WS-LABEL-LINES (2) = SPACES AND
 11890        WS-LABEL-LINES (3) = SPACES AND
 11891        WS-LABEL-LINES (4) = SPACES AND
 11892        WS-LABEL-LINES (5) = SPACES AND
 11893        WS-LABEL-LINES (6) = SPACES
 11894        SET WS-NDX               TO 1
 11895        GO TO 7275-MOVE-ZIP.
 11896
 11897 7270-LABEL-MOVE-2.
 11898
 11899     IF WS-LABEL-LINES (2) = SPACES
 11900        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11901        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11902        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11903        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 240
* EL152.cbl
 11904        MOVE SPACES              TO WS-LABEL-LINES (6)
 11905        GO TO 7270-LABEL-MOVE-2.
 11906
 11907     IF WS-LABEL-LINES (3) = SPACES AND
 11908        WS-LABEL-LINES (4) = SPACES AND
 11909        WS-LABEL-LINES (5) = SPACES AND
 11910        WS-LABEL-LINES (6) = SPACES
 11911        SET WS-NDX               TO 2
 11912        GO TO 7275-MOVE-ZIP.
 11913
 11914 7270-LABEL-MOVE-3.
 11915
 11916     IF WS-LABEL-LINES (3) = SPACES
 11917        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11918        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11919        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11920        MOVE SPACES              TO WS-LABEL-LINES (6)
 11921        GO TO 7270-LABEL-MOVE-3.
 11922
 11923     IF WS-LABEL-LINES (4) = SPACES AND
 11924        WS-LABEL-LINES (5) = SPACES AND
 11925        WS-LABEL-LINES (6) = SPACES
 11926        SET WS-NDX               TO 3
 11927        GO TO 7275-MOVE-ZIP.
 11928
 11929 7270-LABEL-MOVE-4.
 11930
 11931     IF WS-LABEL-LINES (4) = SPACES
 11932        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11933        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11934        MOVE SPACES              TO WS-LABEL-LINES (6)
 11935        GO TO 7270-LABEL-MOVE-4.
 11936
 11937     IF WS-LABEL-LINES (5) = SPACES AND
 11938        WS-LABEL-LINES (6) = SPACES
 11939        SET WS-NDX               TO 4
 11940        GO TO 7275-MOVE-ZIP.
 11941
 11942 7270-LABEL-MOVE-5.
 11943
 11944     IF WS-LABEL-LINES (5) = SPACES
 11945        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11946        MOVE SPACES              TO WS-LABEL-LINES (6)
 11947        SET WS-NDX               TO 5
 11948        GO TO 7275-MOVE-ZIP
 11949
 11950     ELSE
 11951        IF WS-LABEL-LINES (6) = SPACES
 11952           SET WS-NDX            TO 5
 11953           GO TO 7275-MOVE-ZIP
 11954
 11955        ELSE
 11956           SET WS-NDX            TO 6.
 11957
 11958 7275-MOVE-ZIP.
 11959
 11960     SET WS-NDX2                 TO WS-NDX.
 11961     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 241
* EL152.cbl
 11962
 11963     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11964*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11965         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11966          IF PI-COMPANY-ID NOT = 'FLA'
 11967            MOVE WS-LABEL-ZIP (WS-NDX)
 11968                                     TO WS-LAST-ZIP (WS-NDX2)
 11969            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11970
 11971 7279-EXIT.
 11972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 242
* EL152.cbl
 11974
 11975 7280-TRANSLATE-LOWER.
 11976     IF LOWER-CASE-LETTERS-USED
 11977        MOVE 'N'                     TO WS-STATE-LINE
 11978     ELSE
 11979        GO TO 7280-EXIT.
 11980
 11981     IF WS-LABEL-LINES (1) NOT = SPACES
 11982        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11983        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11984        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11985
 11986     IF WS-LABEL-LINES (2) NOT = SPACES
 11987        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11988        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11989        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11990
 11991     IF WS-LABEL-LINES (3) NOT = SPACES
 11992        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11993        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11994        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11995
 11996*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11997*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11998
 11999
 12000     IF WS-LABEL-LINES (4) NOT = SPACES
 12001        IF (WS-LABEL-LINES (6) = SPACES  OR
 12002           WS-LABEL-LINES (5) = SPACES)
 12003           MOVE 'Y'                     TO WS-STATE-LINE
 12004           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 12005           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12006           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 12007        ELSE
 12008           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 12009           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12010           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 12011
 12012     IF WS-LABEL-LINES (5) NOT = SPACES
 12013        IF WS-LABEL-LINES (6) NOT = SPACES
 12014           MOVE 'Y'                     TO WS-STATE-LINE
 12015           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 12016           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12017           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 12018
 12019 7280-EXIT.
 12020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 243
* EL152.cbl
 12022
 12023 7281-SEARCH-AND-TRANSLATE.
 12024     SET TA1  TO +1.
 12025
 12026 7281-FIND-FIRST-NON-BLANK.
 12027     IF WS-TEMP-2 (TA1) = SPACES
 12028        SET TA1 UP BY 1
 12029        GO TO 7281-FIND-FIRST-NON-BLANK.
 12030
 12031*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 12032     SET TA2   TO TA1
 12033     SET TA2   UP BY 1
 12034     SET TA21  TO TA2
 12035     SET TA21  UP BY 1.
 12036
 12037     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 12038     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 12039
 12040 7281-EXIT.
 12041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 244
* EL152.cbl
 12043
 12044 7282-FIND-NEXT-BLANK.
 12045     IF TA21 GREATER THAN 31
 12046        GO TO 7282-EXIT.
 12047
 12048     IF TA21 EQUAL TO 31
 12049        IF NO-CHARACTERS-FOUND
 12050           GO TO 7282-EXIT
 12051           ELSE
 12052           SET TA1   TO +1
 12053           MOVE SPACES             TO WS-TEMP-AREA1
 12054           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12055                   UNTIL MOVE-INDX EQUAL TO TA21
 12056           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 12057           SET TA1   TO +1
 12058           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12059                   UNTIL MOVE-INDX EQUAL TO TA21
 12060           GO TO 7282-EXIT.
 12061
 12062     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 12063         GO TO 7282-NEXT-GROUP-SEARCH.
 12064
 12065     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 12066         IF WS-TEMP-2 (TA21)  = ','
 12067            AND WS-PROCESSOR-LINE = 'Y'
 12068             SET THE-REST-R-CAPS TO TRUE
 12069         ELSE
 12070             CONTINUE
 12071     ELSE
 12072         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 12073         SET TA21 UP BY +1
 12074         GO TO 7282-FIND-NEXT-BLANK.
 12075
 12076     SET TA1  TO +1
 12077     MOVE SPACES                   TO WS-TEMP-AREA1.
 12078     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12079             UNTIL MOVE-INDX EQUAL TO TA21
 12080     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 12081     SET TA1  TO +1
 12082     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12083             UNTIL MOVE-INDX EQUAL TO TA21
 12084     IF THE-REST-R-CAPS
 12085         GO TO 7282-EXIT.
 12086     SET TA2   TO TA21
 12087     SET TA21  UP BY 1
 12088     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 12089 7282-NEXT-GROUP-SEARCH.
 12090     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 12091        SET TA2   UP BY 1
 12092        IF TA2 = 30
 12093           GO TO 7282-EXIT
 12094           ELSE
 12095           GO TO 7282-NEXT-GROUP-SEARCH.
 12096
 12097     SET TA2    UP BY 1
 12098     SET TA21   TO TA2
 12099     SET TA21   UP BY 1
 12100     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 245
* EL152.cbl
 12101
 12102 7282-EXIT.
 12103     EXIT.
 12104
 12105
 12106 7283-MOVE.
 12107     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 12108     SET TA1 UP BY +1.
 12109
 12110
 12111 7284-MOVE-BACK.
 12112     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 12113     SET TA1 UP BY +1.
 12114
 12115 7285-TEST-AND-TRANSLATE.
 12116***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 12117     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 12118        GO TO 7285-EXIT.
 12119
 12120***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 12121***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 12122
 12123     SET WS-POSITION2   TO TA2
 12124     SET WS-POSITION21  TO TA21
 12125     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 12126     IF WS-WORD-LENGTH LESS THAN 3 AND
 12127        WS-STATE-LINE = 'Y' AND
 12128        TA2 GREATER THAN 07
 12129        GO TO 7285-EXIT.
 12130
 12131     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 12132
 12133 7285-EXIT.
 12134     EXIT.
 12135
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 246
* EL152.cbl
 12137 7290-RESOLVE-CREDITOR.
 12138
 12139
 12140* EXEC CICS HANDLE CONDITION
 12141*         NOTOPEN    (7290-BENE-NOT-OPEN)
 12142*         NOTFND     (7290-EXIT)
 12143*    END-EXEC.
 12144*    MOVE '"$JI                  ! D #00011030' TO DFHEIV0
 12145     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12147     MOVE X'4420233030303131303330' TO DFHEIV0(25:11)
 12148     CALL 'kxdfhei1' USING DFHEIV0
 12149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12150
 12151
 12152     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 12153
 12154     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12155     MOVE 'B'                    TO BENE-REC-TYPE.
 12156     MOVE SPACES                 TO BENE-NUMBER.
 12157     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 12158
 12159
 12160* EXEC CICS READ
 12161*         DATASET    (BENE-ID)
 12162*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 12163*         RIDFLD     (BENE-KEY)
 12164*    END-EXEC.
 12165*    MOVE '&"S        E          (   #00011042' TO DFHEIV0
 12166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12168     MOVE X'2020233030303131303432' TO DFHEIV0(25:11)
 12169     CALL 'kxdfhei1' USING DFHEIV0,
 12170           BENE-ID,
 12171           DFHEIV20,
 12172           DFHEIV99,
 12173           BENE-KEY,
 12174           DFHEIV99,
 12175           DFHEIV99,
 12176           DFHEIV99
 12177     SET ADDRESS OF BENEFICIARY-MASTER TO
 12178         DFHEIV20
 12179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12180
 12181
 12182     IF LOWER-CASE-LETTERS-USED
 12183         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 12184         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12185         MOVE WS-TEMP-AREA2      TO SS56D
 12186     ELSE
 12187         MOVE BE-MAIL-TO-NAME    TO SS56D.
 12188
 12189     GO TO 7290-EXIT.
 12190
 12191 7290-BENE-NOT-OPEN.
 12192
 12193     MOVE ER-7675                TO EMI-ERROR.
 12194     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 247
* EL152.cbl
 12195     MOVE -1                     TO MAINTL.
 12196     GO TO 8200-SEND-DATAONLY.
 12197
 12198 7290-EXIT.
 12199     EXIT.
 12200
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 248
* EL152.cbl
 12202 7300-VARIABLE-SEARCH.
 12203***************************************************************
 12204*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 12205*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 12206*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 12207*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 12208*                                                             *
 12209*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 12210*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 12211*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 12212***************************************************************
 12213
 12214     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 12215
 12216     SET INDX1 TO 1.
 12217 7301-LOOP.
 12218     IF INDX1 > 70
 12219        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12220        GO TO 7399-EXIT.
 12221
 12222     IF ONE-CHAR (INDX1) NOT = '@'
 12223        SET INDX1 UP BY 1
 12224        GO TO 7301-LOOP.
 12225
 12226     SET INDX2 TO INDX1.
 12227     SET INDX2 UP BY 1.
 12228
 12229     IF ONE-CHAR (INDX2) = '@'
 12230        SET INDX1 UP BY 2
 12231        GO TO 7301-LOOP.
 12232
 12233     MOVE ONE-CHAR (INDX2)       TO V1.
 12234     SET INDX2 UP BY 1.
 12235     MOVE ONE-CHAR (INDX2)       TO V2.
 12236     SET INDX2 UP BY 1.
 12237     MOVE ONE-CHAR (INDX2)       TO V3.
 12238     SET INDX2 UP BY 1.
 12239     MOVE ONE-CHAR (INDX2)       TO V4.
 12240
 12241     IF V-NUM NOT NUMERIC
 12242        GO TO 7330-VAR-ERROR.
 12243
 12244     IF V-PERIOD NOT = '.'
 12245        MOVE '.'                 TO V-PERIOD
 12246        MOVE ZERO                TO V-DECIMAL
 12247        GO TO 7340-TABLE-SEARCH.
 12248
 12249     IF V-DECIMAL NUMERIC
 12250        GO TO 7340-TABLE-SEARCH.
 12251
 12252 7330-VAR-ERROR.
 12253     MOVE ER-0180                TO EMI-ERROR.
 12254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12255     SET INDX1 UP BY 1.
 12256     GO TO 7301-LOOP.
 12257
 12258 7340-TABLE-SEARCH.
 12259
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 249
* EL152.cbl
 12260     IF REFRESH-GETMAIN-AREA
 12261*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12262*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12263         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12264         MOVE 2                          TO GETMAIN-SWITCH
 12265         MOVE 1                          TO SS-COUNTER
 12266                                            B1
 12267     ELSE
 12268         IF NO-GETMAIN-DONE-YET
 12269*            EXEC CICS GETMAIN
 12270*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12271*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12272*            END-EXEC
 12273             MOVE 2              TO GETMAIN-SWITCH
 12274*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12275*            MOVE LCP-WS-ADDR-COMP
 12276*                                TO SAVE-VARIABLE-POINTER
 12277             MOVE SYSTEM-SUPPORTED-VARIABLES
 12278                                 TO SYSTEM-VARIABLES
 12279             MOVE 1              TO SS-COUNTER
 12280                                    B1
 12281         ELSE
 12282             MOVE 1              TO SS-COUNTER
 12283                                    B1
 12284*            MOVE SAVE-VARIABLE-POINTER
 12285*                                TO LCP-WS-ADDR-COMP
 12286*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12287         END-IF
 12288     END-IF
 12289     .
 12290 7350-TABLE-LOOP.
 12291
 12292     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12293        GO TO 7330-VAR-ERROR.
 12294
 12295     MOVE SYSTEM-VARIABLES (B1:106)
 12296                                 TO SYS-VAR-ENTRY
 12297     IF SYS-VAR-CODE NOT = VAR-HOLD
 12298        ADD SYS-VAR-LEN          TO B1
 12299*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12300*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12301*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12302        ADD 1                    TO SS-COUNTER
 12303        GO TO 7350-TABLE-LOOP
 12304     END-IF
 12305
 12306     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12307     SET INDXV TO 1.
 12308     SUBTRACT 6                  FROM VAR-LEN.
 12309     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12310     GO TO 7301-LOOP.
 12311
 12312 7399-EXIT.
 12313      EXIT.
 12314
 12315 7400-MOVE-VAR-DATA.
 12316     IF INDX1 > 70
 12317        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 250
* EL152.cbl
 12318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12319        GO TO 7301-LOOP.
 12320
 12321     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12322     SET INDXV UP BY 1.
 12323     SET INDX1 UP BY 1.
 12324
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 251
* EL152.cbl
 12326 7500-READ-TS.
 12327
 12328* EXEC CICS HANDLE CONDITION
 12329*         QIDERR     (7590-TS-QIDERR)
 12330*         ITEMERR    (7585-TS-ITEMERR)
 12331*    END-EXEC.
 12332*    MOVE '"$N<                  ! E #00011193' TO DFHEIV0
 12333     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12335     MOVE X'4520233030303131313933' TO DFHEIV0(25:11)
 12336     CALL 'kxdfhei1' USING DFHEIV0
 12337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12338
 12339
 12340     SET TS-INDX TO 1.
 12341     MOVE 1                      TO TS-ITEM.
 12342
 12343 7501-LOOP.
 12344
 12345* EXEC CICS READQ TS
 12346*         INTO     (TS-WORK-AREA)
 12347*         QUEUE    (TS-NAME-TEXT)
 12348*         LENGTH   (TS-LENGTH)
 12349*         ITEM     (TS-ITEM)
 12350*    END-EXEC.
 12351*    MOVE '*$II   L              ''   #00011202' TO DFHEIV0
 12352     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12354     MOVE X'2020233030303131323032' TO DFHEIV0(25:11)
 12355     CALL 'kxdfhei1' USING DFHEIV0,
 12356           TS-NAME-TEXT,
 12357           TS-WORK-AREA,
 12358           TS-LENGTH,
 12359           TS-ITEM,
 12360           DFHEIV99,
 12361           DFHEIV99
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12363
 12364
 12365     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12366     SET TS-INDX UP BY 1.
 12367     ADD 1                       TO TS-ITEM.
 12368     GO TO 7501-LOOP.
 12369
 12370 7585-TS-ITEMERR.
 12371     IF EIBTRNID NOT = TRANS-ID
 12372        SUBTRACT 1               FROM TS-ITEM
 12373        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12374
 12375     GO TO 7599-EXIT.
 12376
 12377 7590-TS-QIDERR.
 12378     IF EIBTRNID = TRANS-ID
 12379        MOVE ER-0033             TO EMI-ERROR
 12380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12381        GO TO 8200-SEND-DATAONLY.
 12382
 12383 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 252
* EL152.cbl
 12384      EXIT.
 12385
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 253
* EL152.cbl
 12387 7600-READ-SCREEN-TS.
 12388
 12389* EXEC CICS HANDLE CONDITION
 12390*         QIDERR     (7690-TS-QIDERR)
 12391*         ITEMERR    (7685-TS-ITEMERR)
 12392*    END-EXEC.
 12393*    MOVE '"$N<                  ! F #00011232' TO DFHEIV0
 12394     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12396     MOVE X'4620233030303131323332' TO DFHEIV0(25:11)
 12397     CALL 'kxdfhei1' USING DFHEIV0
 12398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12399
 12400
 12401     MOVE 1                      TO TS-ITEM.
 12402
 12403
 12404* EXEC CICS READQ TS
 12405*         INTO    (EL152AO)
 12406*         QUEUE   (TS-NAME-SCREEN)
 12407*         LENGTH  (TS-MAP-LENGTH)
 12408*         ITEM    (TS-ITEM)
 12409*    END-EXEC.
 12410*    MOVE '*$II   L              ''   #00011239' TO DFHEIV0
 12411     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12412     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12413     MOVE X'2020233030303131323339' TO DFHEIV0(25:11)
 12414     CALL 'kxdfhei1' USING DFHEIV0,
 12415           TS-NAME-SCREEN,
 12416           EL152AO,
 12417           TS-MAP-LENGTH,
 12418           TS-ITEM,
 12419           DFHEIV99,
 12420           DFHEIV99
 12421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12422
 12423
 12424     IF MAINTL NOT = ZEROS
 12425        MOVE AL-UANON            TO MAINTA.
 12426     IF ARCHNUML NOT = ZEROS
 12427        MOVE AL-UNNON            TO ARCHNUMA.
 12428     IF FORML NOT = ZEROS
 12429        MOVE AL-UANON            TO FORMA.
 12430     IF FOLLOWL NOT = ZEROS
 12431        MOVE AL-UANON            TO FOLLOWA.
 12432     IF RESENDL NOT = ZEROS
 12433        MOVE AL-UANON            TO RESENDA.
 12434     IF PRINTL NOT = ZEROS
 12435        MOVE AL-UANON            TO PRINTA.
 12436     IF COPIESL NOT = ZEROS
 12437        MOVE AL-UNNON            TO COPIESA.
 12438     IF ADDRL NOT = ZEROS
 12439        MOVE AL-UANON            TO ADDRA.
 12440     IF REL NOT = ZEROS
 12441        MOVE AL-UANON            TO REA.
 12442
 12443     GO TO 7699-EXIT.
 12444
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 254
* EL152.cbl
 12445 7685-TS-ITEMERR.
 12446     GO TO 7699-EXIT.
 12447
 12448 7690-TS-QIDERR.
 12449     IF EIBTRNID = TRANS-ID
 12450        MOVE ER-0033             TO EMI-ERROR
 12451        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12452        GO TO 8200-SEND-DATAONLY.
 12453
 12454 7699-EXIT.
 12455      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 255
* EL152.cbl
 12457
 12458 7700-PUT-TEMP-STOR.
 12459     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12460     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12461     SET TS-INDX TO 1.
 12462     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12463     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12464             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12465             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12466
 12467 7749-EXIT.
 12468      EXIT.
 12469
 12470 7750-DELETE-TEMP-STOR.
 12471
 12472* EXEC CICS HANDLE CONDITION
 12473*         QIDERR      (7750-EXIT)
 12474*    END-EXEC.
 12475*    MOVE '"$N                   ! G #00011293' TO DFHEIV0
 12476     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12478     MOVE X'4720233030303131323933' TO DFHEIV0(25:11)
 12479     CALL 'kxdfhei1' USING DFHEIV0
 12480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12481
 12482
 12483
 12484* EXEC CICS DELETEQ TS
 12485*         QUEUE       (TS-NAME-TEXT)
 12486*    END-EXEC.
 12487*    MOVE '*&                    #   #00011297' TO DFHEIV0
 12488     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12490     MOVE X'2020233030303131323937' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0,
 12492           TS-NAME-TEXT,
 12493           DFHEIV99
 12494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12495
 12496
 12497 7750-EXIT.
 12498     EXIT.
 12499
 12500 7760-DELETE-TEMP-STOR-SCREEN.
 12501
 12502* EXEC CICS HANDLE CONDITION
 12503*         QIDERR     (7760-EXIT)
 12504*    END-EXEC.
 12505*    MOVE '"$N                   ! H #00011305' TO DFHEIV0
 12506     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12508     MOVE X'4820233030303131333035' TO DFHEIV0(25:11)
 12509     CALL 'kxdfhei1' USING DFHEIV0
 12510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12511
 12512
 12513
 12514* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 256
* EL152.cbl
 12515*         QUEUE      (TS-NAME-SCREEN)
 12516*    END-EXEC.
 12517*    MOVE '*&                    #   #00011309' TO DFHEIV0
 12518     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12519     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12520     MOVE X'2020233030303131333039' TO DFHEIV0(25:11)
 12521     CALL 'kxdfhei1' USING DFHEIV0,
 12522           TS-NAME-SCREEN,
 12523           DFHEIV99
 12524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12525
 12526
 12527 7760-EXIT.
 12528     EXIT.
 12529
 12530 7770-DELETE-TEMP-STOR-PI-AREA.
 12531
 12532* EXEC CICS HANDLE CONDITION
 12533*        QIDERR   (7770-EXIT)
 12534*    END-EXEC.
 12535*    MOVE '"$N                   ! I #00011317' TO DFHEIV0
 12536     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12538     MOVE X'4920233030303131333137' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0
 12540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12541
 12542
 12543
 12544* EXEC CICS DELETEQ TS
 12545*        QUEUE    (WS-PI-QID)
 12546*    END-EXEC.
 12547*    MOVE '*&                    #   #00011321' TO DFHEIV0
 12548     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12549     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12550     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 12551     CALL 'kxdfhei1' USING DFHEIV0,
 12552           WS-PI-QID,
 12553           DFHEIV99
 12554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12555
 12556
 12557 7770-EXIT.
 12558     EXIT.
 12559
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 257
* EL152.cbl
 12561 7780-WRITE-TS.
 12562     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12563     SET TS-INDX UP BY 1.
 12564     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12565
 12566
 12567* EXEC CICS WRITEQ TS
 12568*         FROM    (TS-WORK-AREA)
 12569*         QUEUE   (TS-NAME-TEXT)
 12570*         LENGTH  (TS-LENGTH)
 12571*         ITEM    (PI-TEMP-STOR-ITEMS)
 12572*    END-EXEC.
 12573*    MOVE '*" I   L              ''   #00011334' TO DFHEIV0
 12574     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 12575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12576     MOVE X'2020233030303131333334' TO DFHEIV0(25:11)
 12577     CALL 'kxdfhei1' USING DFHEIV0,
 12578           TS-NAME-TEXT,
 12579           TS-WORK-AREA,
 12580           TS-LENGTH,
 12581           PI-TEMP-STOR-ITEMS,
 12582           DFHEIV99,
 12583           DFHEIV99
 12584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12585
 12586
 12587 7780-EXIT.
 12588     EXIT.
 12589
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 258
* EL152.cbl
 12591 7790-WRITE-SCREEN-TS.
 12592     MOVE 1                      TO TS-ITEM.
 12593
 12594
 12595* EXEC CICS WRITEQ TS
 12596*         FROM    (EL152AI)
 12597*         QUEUE   (TS-NAME-SCREEN)
 12598*         LENGTH  (TS-MAP-LENGTH)
 12599*         ITEM    (TS-ITEM)
 12600*    END-EXEC.
 12601*    MOVE '*" I   L              ''   #00011348' TO DFHEIV0
 12602     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 12603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12604     MOVE X'2020233030303131333438' TO DFHEIV0(25:11)
 12605     CALL 'kxdfhei1' USING DFHEIV0,
 12606           TS-NAME-SCREEN,
 12607           EL152AI,
 12608           TS-MAP-LENGTH,
 12609           TS-ITEM,
 12610           DFHEIV99,
 12611           DFHEIV99
 12612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12613
 12614
 12615 7790-EXIT.
 12616     EXIT.
 12617
 12618 7795-WRITE-PI-AREA-TS.
 12619
 12620* EXEC CICS WRITEQ TS
 12621*        QUEUE    (WS-PI-QID)
 12622*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12623*        LENGTH   (PI-COMM-LENGTH)
 12624*    END-EXEC.
 12625*    MOVE '*"     L              ''   #00011359' TO DFHEIV0
 12626     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 12627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12628     MOVE X'2020233030303131333539' TO DFHEIV0(25:11)
 12629     CALL 'kxdfhei1' USING DFHEIV0,
 12630           WS-PI-QID,
 12631           PROGRAM-INTERFACE-BLOCK,
 12632           PI-COMM-LENGTH,
 12633           DFHEIV99,
 12634           DFHEIV99,
 12635           DFHEIV99
 12636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12637
 12638
 12639 7795-EXIT.
 12640     EXIT.
 12641
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 259
* EL152.cbl
 12643 7800-PRINT-LETTER-NOW.
 12644***************************************************************
 12645*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12646*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12647*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12648*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12649*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12650*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12651***************************************************************
 12652
 12653     PERFORM 400-SET-CODES THRU 499-EXIT.
 12654
 12655     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12656     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12657     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12658             VARYING SC-INDX FROM 1 BY 1
 12659             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12660
 12661     IF PI-TOTAL-LINES = 0
 12662        MOVE ER-0187             TO EMI-ERROR
 12663        MOVE -1                  TO MAINTL
 12664        MOVE AL-UABON            TO MAINTA
 12665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666        GO TO 8200-SEND-DATAONLY.
 12667
 12668     IF COPIESL NOT = ZEROS
 12669        IF COPIESI NOT NUMERIC
 12670           MOVE ER-0184          TO EMI-ERROR
 12671           MOVE -1               TO COPIESL
 12672           MOVE AL-UNBON         TO COPIESA
 12673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12674           GO TO 8200-SEND-DATAONLY
 12675         ELSE
 12676           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12677       ELSE
 12678        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12679
 12680*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12681*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12682*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12683*            VARYING SC-INDX FROM 1 BY 1
 12684*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12685
 12686     MOVE +0                     TO TALLY.
 12687     INSPECT RECORD-TABLE TALLYING TALLY
 12688                                 FOR CHARACTERS BEFORE '@'.
 12689
 12690     IF TALLY < +21900
 12691        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12692        MOVE ZEROS               TO ROLL-COUNTER
 12693        MOVE ER-0191             TO EMI-ERROR
 12694        MOVE -1                  TO MAINTL
 12695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12696        GO TO 7900-ROLL-PAGE.
 12697
 12698 7800-UPDATE-CLAIM.
 12699
 12700     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 260
* EL152.cbl
 12701         GO TO 7800-GET-PRINTER.
 12702
 12703     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12704     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12705     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12706     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12707
 12708
 12709* EXEC CICS HANDLE CONDITION
 12710*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12711*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12712*    END-EXEC.
 12713*    MOVE '"$JI                  ! J #00011434' TO DFHEIV0
 12714     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12716     MOVE X'4A20233030303131343334' TO DFHEIV0(25:11)
 12717     CALL 'kxdfhei1' USING DFHEIV0
 12718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12719
 12720
 12721
 12722* EXEC CICS READ
 12723*        DATASET   (CLAM-ID)
 12724*        RIDFLD    (CLAM-KEY)
 12725*        SET       (ADDRESS OF CLAIM-MASTER)
 12726*        UPDATE
 12727*    END-EXEC.
 12728*    MOVE '&"S        EU         (   #00011439' TO DFHEIV0
 12729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12730     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12731     MOVE X'2020233030303131343339' TO DFHEIV0(25:11)
 12732     CALL 'kxdfhei1' USING DFHEIV0,
 12733           CLAM-ID,
 12734           DFHEIV20,
 12735           DFHEIV99,
 12736           CLAM-KEY,
 12737           DFHEIV99,
 12738           DFHEIV99,
 12739           DFHEIV99
 12740     SET ADDRESS OF CLAIM-MASTER TO
 12741         DFHEIV20
 12742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12743
 12744
 12745     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12746     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12747     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12748     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12749
 12750
 12751* EXEC CICS HANDLE CONDITION
 12752*        DUPKEY    (7800-GET-PRINTER)
 12753*    END-EXEC.
 12754*    MOVE '"$$                   ! K #00011451' TO DFHEIV0
 12755     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12757     MOVE X'4B20233030303131343531' TO DFHEIV0(25:11)
 12758     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 261
* EL152.cbl
 12759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12760
 12761
 12762
 12763* EXEC CICS REWRITE
 12764*        DATASET   (CLAM-ID)
 12765*        FROM      (CLAIM-MASTER)
 12766*    END-EXEC.
 12767     MOVE LENGTH OF
 12768      CLAIM-MASTER
 12769       TO DFHEIV11
 12770*    MOVE '&& L                  %   #00011455' TO DFHEIV0
 12771     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12772     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12773     MOVE X'2020233030303131343535' TO DFHEIV0(25:11)
 12774     CALL 'kxdfhei1' USING DFHEIV0,
 12775           CLAM-ID,
 12776           CLAIM-MASTER,
 12777           DFHEIV11,
 12778           DFHEIV99
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782     GO TO 7800-GET-PRINTER.
 12783
 12784 7800-CLAIM-NOT-FOUND.
 12785
 12786     MOVE ER-0133                TO  EMI-ERROR.
 12787     MOVE -1                     TO  MAINTL.
 12788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12789     GO TO 8200-SEND-DATAONLY.
 12790
 12791 7800-GET-PRINTER.
 12792
 12793     IF PI-ALT-PRINTER-ID NOT = SPACES
 12794        GO TO 7800-CNTL-BYPASS.
 12795
 12796     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12797     MOVE SPACES                 TO CNTL-GENL.
 12798     MOVE ZEROS                  TO CNTL-SEQ.
 12799
 12800
 12801* EXEC CICS HANDLE CONDITION
 12802*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12803*         NOTFND     (7890-NOT-FOUND)
 12804*    END-EXEC.
 12805*    MOVE '"$JI                  ! L #00011478' TO DFHEIV0
 12806     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12808     MOVE X'4C20233030303131343738' TO DFHEIV0(25:11)
 12809     CALL 'kxdfhei1' USING DFHEIV0
 12810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12811
 12812
 12813
 12814* EXEC CICS READ
 12815*         DATASET    (CNTL-ID)
 12816*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 262
* EL152.cbl
 12817*         RIDFLD     (CNTL-KEY)
 12818*    END-EXEC.
 12819*    MOVE '&"S        E          (   #00011483' TO DFHEIV0
 12820     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12822     MOVE X'2020233030303131343833' TO DFHEIV0(25:11)
 12823     CALL 'kxdfhei1' USING DFHEIV0,
 12824           CNTL-ID,
 12825           DFHEIV20,
 12826           DFHEIV99,
 12827           CNTL-KEY,
 12828           DFHEIV99,
 12829           DFHEIV99,
 12830           DFHEIV99
 12831     SET ADDRESS OF CONTROL-FILE TO
 12832         DFHEIV20
 12833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12834
 12835
 12836*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12837     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12838     GO TO 7800-SET-UP-TS.
 12839
 12840 7800-CNTL-BYPASS.
 12841*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12842     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12843
 12844 7800-SET-UP-TS.
 12845
 12846***********************************************************
 12847*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12848*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12849***********************************************************
 12850
 12851     IF TS-TERM-PREFIX = 'DU'
 12852        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12853        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12854
 12855     SET TS-INDX TO 1.
 12856
 12857
 12858* EXEC CICS ASKTIME
 12859*    END-EXEC.
 12860*    MOVE '0"                    "   #00011510' TO DFHEIV0
 12861     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12862     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12863     MOVE X'2020233030303131353130' TO DFHEIV0(25:11)
 12864     CALL 'kxdfhei1' USING DFHEIV0,
 12865           DFHEIV99
 12866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12867
 12868
 12869     MOVE EIBTIME                TO TS-ID-TIME.
 12870*    MOVE '152A'                 TO TS-ID-TEXT
 12871     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12872     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12873
 12874     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 263
* EL152.cbl
 12875             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12876             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12877
 12878     IF NOT PI-SHOW-MODE
 12879        MOVE '1'                 TO PI-PRINT-SW.
 12880
 12881
 12882* EXEC CICS HANDLE CONDITION
 12883*         TERMIDERR  (8820-TERM-ERROR)
 12884*         TRANSIDERR (8830-TRAN-ERROR)
 12885*    END-EXEC.
 12886*    MOVE '"$[\                  ! M #00011525' TO DFHEIV0
 12887     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12889     MOVE X'4D20233030303131353235' TO DFHEIV0(25:11)
 12890     CALL 'kxdfhei1' USING DFHEIV0
 12891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12892
 12893
 12894*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12895*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12896*        EXEC CICS START
 12897*             INTERVAL    (0)
 12898*             TRANSID     (PRINT-TRANS)
 12899*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12900*             LENGTH      (PI-COMM-LENGTH)
 12901*             TERMID      (TS-TERM-TEXT)
 12902*        END-EXEC
 12903*    ELSE
 12904
 12905* EXEC CICS START
 12906*             INTERVAL    (0)
 12907*             TRANSID     (PRINT-TRANS)
 12908*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12909*             LENGTH      (PI-COMM-LENGTH)
 12910*             TERMID      (TS-TERM-TEXT)
 12911*             TERMID      (WS-PRINTER-ID)
 12912*        END-EXEC.
 12913     MOVE 0 TO DFHEIV10
 12914*    MOVE '0(ILFT                1   #00011540' TO DFHEIV0
 12915     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12916     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 12917     MOVE X'2020233030303131353430' TO DFHEIV0(25:11)
 12918     CALL 'kxdfhei1' USING DFHEIV0,
 12919           DFHEIV10,
 12920           PRINT-TRANS,
 12921           DFHEIV99,
 12922           PROGRAM-INTERFACE-BLOCK,
 12923           PI-COMM-LENGTH,
 12924           WS-PRINTER-ID,
 12925           DFHEIV99,
 12926           DFHEIV99,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99,
 12930           DFHEIV99,
 12931           DFHEIV99,
 12932           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 264
* EL152.cbl
 12933           DFHEIV99,
 12934           DFHEIV99
 12935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12936
 12937
 12938     MOVE '104A'                 TO TS-ID-TEXT
 12939     MOVE ER-0189                TO EMI-ERROR.
 12940     MOVE -1                     TO MAINTL.
 12941     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12942     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12943     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12944
 12945     GO TO 8200-SEND-DATAONLY.
 12946
 12947 7890-NOT-FOUND.
 12948     MOVE ER-0190                TO EMI-ERROR.
 12949     MOVE -1                     TO MAINTL.
 12950     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12951     GO TO 8200-SEND-DATAONLY.
 12952
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 265
* EL152.cbl
 12954 7900-ROLL-PAGE.
 12955     IF ENTERPFL NOT = ZEROS
 12956        MOVE -1                  TO ENTERPFL
 12957       ELSE
 12958        MOVE -1                  TO MAINTL.
 12959
 12960     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12961     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12962     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12963        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12964        SC-INDX > NUM-LINES-PER-SCREEN
 12965     IF PI-TOTAL-LINES = 0
 12966        MOVE ER-0047             TO EMI-ERROR
 12967        MOVE -1                  TO MAINTL
 12968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969        GO TO 8200-SEND-DATAONLY.
 12970
 12971     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12972
 12973     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12974        MOVE ER-0067             TO EMI-ERROR
 12975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976        MOVE 1                   TO TEMP-CURR-LINE.
 12977
 12978     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12979        MOVE ER-0066             TO EMI-ERROR
 12980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12981        COMPUTE TEMP-CURR-LINE
 12982            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12983        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12984            MOVE 1 TO TEMP-CURR-LINE.
 12985
 12986*    IF EMI-ERROR NOT = ER-0191
 12987*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12988*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12989*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12990*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12991*                SC-INDX > NUM-LINES-PER-SCREEN
 12992*    END-IF
 12993
 12994     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12995        NEXT SENTENCE
 12996     ELSE
 12997        GO TO 8200-SEND-DATAONLY.
 12998
 12999*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13000     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 13001     SET TB-INDX                 TO PI-CURRENT-LINE.
 13002     MOVE LOW-VALUES             TO EL152RI.
 13003
 13004*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 13005     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 13006             VARYING SC-INDX FROM 1 BY 1
 13007             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 13008
 13009     GO TO 8200-SEND-DATAONLY.
 13010
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 266
* EL152.cbl
 13012 7950-SET-INDX.
 13013     IF PI-CURRENT-LINE = 0
 13014        SET TB-INDX TO 1
 13015       ELSE
 13016        SET TB-INDX              TO PI-CURRENT-LINE.
 13017
 13018 7950-EXIT.
 13019      EXIT.
 13020
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 267
* EL152.cbl
 13022 7960-UPDATE-TABLE-FROM-SCREEN.
 13023     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 13024        IF TB-INDX > PI-TOTAL-LINES
 13025           IF PI-TOTAL-LINES = MAX-LINES
 13026              MOVE ER-0051       TO EMI-ERROR
 13027              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13028              GO TO 8200-SEND-DATAONLY
 13029           ELSE
 13030              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 13031              ADD 1              TO PI-TOTAL-LINES
 13032        ELSE
 13033           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 13034
 13035     SET TB-INDX UP BY 1.
 13036
 13037 7960-EXIT.
 13038      EXIT.
 13039
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 268
* EL152.cbl
 13041 8000-STARTBR-ERACCT.
 13042
 13043     IF WS-ACCT-READ-SW = 'Y'
 13044         NEXT SENTENCE
 13045     ELSE
 13046
 13047* EXEC CICS GETMAIN
 13048*             SET       (ADDRESS OF ACCOUNT-MASTER)
 13049*             LENGTH    (ACCT-LENGTH)
 13050*        END-EXEC.
 13051*    MOVE '," L                  $   #00011657' TO DFHEIV0
 13052     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303131363537' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           DFHEIV20,
 13057           ACCT-LENGTH,
 13058           DFHEIV99
 13059     SET ADDRESS OF ACCOUNT-MASTER TO
 13060         DFHEIV20
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13062
 13063
 13064
 13065* EXEC CICS STARTBR
 13066*        RIDFLD      (ACCT-KEY)
 13067*        DATASET     (ACCT-ID)
 13068*        KEYLENGTH   (20)
 13069*        GENERIC
 13070*    END-EXEC.
 13071     MOVE 20
 13072       TO DFHEIV11
 13073     MOVE 0
 13074       TO DFHEIV12
 13075*    MOVE '&,   KG    G          &   #00011662' TO DFHEIV0
 13076     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13078     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0,
 13080           ACCT-ID,
 13081           ACCT-KEY,
 13082           DFHEIV11,
 13083           DFHEIV12,
 13084           DFHEIV99
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 13089 8000-STARTBR-EXIT.
 13090     EXIT.
 13091
 13092 8000-READNEXT-ERACCT.
 13093
 13094
 13095* EXEC CICS READNEXT
 13096*        DATASET   (ACCT-ID)
 13097*        INTO      (ACCOUNT-MASTER)
 13098*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 269
* EL152.cbl
 13099*    END-EXEC.
 13100     MOVE LENGTH OF
 13101      ACCOUNT-MASTER
 13102       TO DFHEIV12
 13103     MOVE 0
 13104       TO DFHEIV11
 13105*    MOVE '&.IL                  )   #00011675' TO DFHEIV0
 13106     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13107     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13108     MOVE X'2020233030303131363735' TO DFHEIV0(25:11)
 13109     CALL 'kxdfhei1' USING DFHEIV0,
 13110           ACCT-ID,
 13111           ACCOUNT-MASTER,
 13112           DFHEIV12,
 13113           ACCT-KEY,
 13114           DFHEIV99,
 13115           DFHEIV11,
 13116           DFHEIV99,
 13117           DFHEIV99
 13118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13119
 13120
 13121 8000-READNEXT-EXIT.
 13122     EXIT.
 13123
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 270
* EL152.cbl
 13125*8050-STARTBR-EMPROD. Remove as dead code
 13126*8050-EXIT. Remove as dead code
 13127*8060-READNEXT-EMPROD. Remove as dead code
 13128*8060-EXIT. Remove as dead code
 13129
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 271
* EL152.cbl
 13131 8100-SEND-INITIAL-MAP.
 13132     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 13133     MOVE SAVE-DATE              TO DATEAO.
 13134     MOVE EIBTIME                TO TIME-IN.
 13135     MOVE TIME-OUT               TO TIMEAO.
 13136
 13137     MOVE PI-CARRIER             TO CARRO
 13138     MOVE PI-CLAIM-NO            TO CLMNOO
 13139     MOVE PI-CERT-NO             TO CRTNOO
 13140     MOVE PI-PROCESSOR-ID        TO PROCO
 13141     MOVE PI-COMPANY-ID          TO COMPIDO
 13142     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 13143                                 TO SYSO
 13144     MOVE PI-ENCLOSURE-CD        TO ENCO
 13145     IF NOT EMI-NO-ERRORS
 13146         SET EMI-INDX TO 1
 13147         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 13148     ELSE
 13149         MOVE SPACES             TO ERRMSGO.
 13150
 13151     MOVE -1                     TO MAINTL.
 13152
 13153
 13154* EXEC CICS SEND
 13155*        MAP      (MAP-NAME)
 13156*        MAPSET   (MAPSET-NAME)
 13157*        FROM     (EL152AO)
 13158*        ERASE
 13159*        CURSOR
 13160*    END-EXEC.
 13161     MOVE LENGTH OF
 13162      EL152AO
 13163       TO DFHEIV12
 13164     MOVE -1
 13165       TO DFHEIV11
 13166*    MOVE '8$     CT  E    H L F ,   #00011713' TO DFHEIV0
 13167     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13168     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13169     MOVE X'2020233030303131373133' TO DFHEIV0(25:11)
 13170     CALL 'kxdfhei1' USING DFHEIV0,
 13171           MAP-NAME,
 13172           EL152AO,
 13173           DFHEIV12,
 13174           MAPSET-NAME,
 13175           DFHEIV99,
 13176           DFHEIV99,
 13177           DFHEIV99,
 13178           DFHEIV11,
 13179           DFHEIV99,
 13180           DFHEIV99,
 13181           DFHEIV99
 13182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13183
 13184
 13185     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13186     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13187
 13188     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 272
* EL152.cbl
 13189*    GO TO 0200-RECEIVE.
 13190
 13191 8200-SEND-DATAONLY.
 13192     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13193     MOVE PI-ENCLOSURE-CD        TO ENCO
 13194     MOVE SAVE-DATE              TO DATEAO.
 13195     MOVE EIBTIME                TO TIME-IN.
 13196     MOVE TIME-OUT               TO TIMEAO.
 13197     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13198
 13199*    IF PI-COMPANY-ID = 'DMD'
 13200*       IF FORCE-7840
 13201*          MOVE '7840 FORCED' TO PFKEY9O
 13202*          MOVE AL-SABON      TO PFKEY9A.
 13203
 13204
 13205* EXEC CICS SEND
 13206*        MAP      (MAP-NAME)
 13207*        MAPSET   (MAPSET-NAME)
 13208*        FROM     (EL152AO)
 13209*        DATAONLY
 13210*        CURSOR
 13211*    END-EXEC.
 13212     MOVE LENGTH OF
 13213      EL152AO
 13214       TO DFHEIV12
 13215     MOVE -1
 13216       TO DFHEIV11
 13217*    MOVE '8$D    CT       H L F ,   #00011740' TO DFHEIV0
 13218     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13219     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13220     MOVE X'2020233030303131373430' TO DFHEIV0(25:11)
 13221     CALL 'kxdfhei1' USING DFHEIV0,
 13222           MAP-NAME,
 13223           EL152AO,
 13224           DFHEIV12,
 13225           MAPSET-NAME,
 13226           DFHEIV99,
 13227           DFHEIV99,
 13228           DFHEIV99,
 13229           DFHEIV11,
 13230           DFHEIV99,
 13231           DFHEIV99,
 13232           DFHEIV99
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13234
 13235
 13236     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13237     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13238
 13239     GO TO 9000-RETURN-TRANS.
 13240*    GO TO 0200-RECEIVE.
 13241
 13242 8200-SEND-DATAONLY-ERASEAUP.
 13243     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13244     MOVE PI-ENCLOSURE-CD        TO ENCO
 13245     MOVE SAVE-DATE              TO DATEAO.
 13246     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 273
* EL152.cbl
 13247     MOVE TIME-OUT               TO TIMEAO.
 13248     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13249
 13250* EXEC CICS SEND
 13251*        MAP      (MAP-NAME)
 13252*        MAPSET   (MAPSET-NAME)
 13253*        FROM     (EL152AO)
 13254*        DATAONLY
 13255*        ERASEAUP
 13256*        CURSOR
 13257*    END-EXEC.
 13258     MOVE LENGTH OF
 13259      EL152AO
 13260       TO DFHEIV12
 13261     MOVE -1
 13262       TO DFHEIV11
 13263*    MOVE '8$D    CT  A    H L F ,   #00011761' TO DFHEIV0
 13264     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13265     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13266     MOVE X'2020233030303131373631' TO DFHEIV0(25:11)
 13267     CALL 'kxdfhei1' USING DFHEIV0,
 13268           MAP-NAME,
 13269           EL152AO,
 13270           DFHEIV12,
 13271           MAPSET-NAME,
 13272           DFHEIV99,
 13273           DFHEIV99,
 13274           DFHEIV99,
 13275           DFHEIV11,
 13276           DFHEIV99,
 13277           DFHEIV99,
 13278           DFHEIV99
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13280
 13281
 13282     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13283     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13284
 13285     GO TO 9000-RETURN-TRANS.
 13286*    GO TO 0200-RECEIVE.
 13287
 13288 8210-ENDBR.
 13289     IF ACCT-BROWSE-STARTED = 'Y'
 13290        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13291
 13292* EXEC CICS ENDBR
 13293*            DATASET    (ACCT-ID)
 13294*       END-EXEC.
 13295     MOVE 0
 13296       TO DFHEIV11
 13297*    MOVE '&2                    $   #00011779' TO DFHEIV0
 13298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13300     MOVE X'2020233030303131373739' TO DFHEIV0(25:11)
 13301     CALL 'kxdfhei1' USING DFHEIV0,
 13302           ACCT-ID,
 13303           DFHEIV11,
 13304           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 274
* EL152.cbl
 13305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13306
 13307
 13308 8210-EXIT.
 13309     EXIT.
 13310
 13311 8220-ENDBR-EMPROD.
 13312     IF PROD-BROWSE-STARTED = 'Y'
 13313        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13314
 13315* EXEC CICS ENDBR
 13316*            DATASET    (PROD-ID)
 13317*       END-EXEC.
 13318     MOVE 0
 13319       TO DFHEIV11
 13320*    MOVE '&2                    $   #00011789' TO DFHEIV0
 13321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13323     MOVE X'2020233030303131373839' TO DFHEIV0(25:11)
 13324     CALL 'kxdfhei1' USING DFHEIV0,
 13325           PROD-ID,
 13326           DFHEIV11,
 13327           DFHEIV99
 13328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13329
 13330
 13331 8220-EXIT.
 13332     EXIT.
 13333
 13334 8300-SEND-TEXT.
 13335
 13336* EXEC CICS SEND TEXT
 13337*        FROM    (LOGOFF-TEXT)
 13338*        LENGTH  (LOGOFF-LENGTH)
 13339*        ERASE
 13340*        FREEKB
 13341*    END-EXEC.
 13342*    MOVE '8&      T  E F  H   F -   #00011797' TO DFHEIV0
 13343     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13344     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13345     MOVE X'2020233030303131373937' TO DFHEIV0(25:11)
 13346     CALL 'kxdfhei1' USING DFHEIV0,
 13347           LOGOFF-TEXT,
 13348           LOGOFF-LENGTH,
 13349           DFHEIV99,
 13350           DFHEIV99,
 13351           DFHEIV99,
 13352           DFHEIV99,
 13353           DFHEIV99,
 13354           DFHEIV99,
 13355           DFHEIV99,
 13356           DFHEIV99,
 13357           DFHEIV99,
 13358           DFHEIV99
 13359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13360
 13361
 13362
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 275
* EL152.cbl
 13363* EXEC CICS RETURN
 13364*    END-EXEC.
 13365*    MOVE '.(                    ''   #00011804' TO DFHEIV0
 13366     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13368     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 13369     CALL 'kxdfhei1' USING DFHEIV0,
 13370           DFHEIV99,
 13371           DFHEIV99,
 13372           DFHEIV99,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379 8600-DEEDIT.
 13380
 13381* EXEC CICS BIF DEEDIT
 13382*         FIELD    (DEEDIT-FIELD)
 13383*         LENGTH   (15)
 13384*    END-EXEC.
 13385     MOVE 15
 13386       TO DFHEIV11
 13387*    MOVE '@"L                   #   #00011808' TO DFHEIV0
 13388     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13389     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13390     MOVE X'2020233030303131383038' TO DFHEIV0(25:11)
 13391     CALL 'kxdfhei1' USING DFHEIV0,
 13392           DEEDIT-FIELD,
 13393           DFHEIV11
 13394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13395
 13396
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 276
* EL152.cbl
 13398 8800-UNAUTHORIZED-ACCESS.
 13399     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13400     GO TO 8300-SEND-TEXT.
 13401
 13402 8810-PF23.
 13403     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13404     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13405     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13406     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13407     MOVE XCTL-005               TO PGM-NAME.
 13408     GO TO 9300-XCTL.
 13409
 13410 8820-TERM-ERROR.
 13411     MOVE ER-0412                TO EMI-ERROR.
 13412     MOVE SPACES                 TO PI-PRINT-SW.
 13413     GO TO 8999-OPEN-ERROR.
 13414
 13415 8830-TRAN-ERROR.
 13416     MOVE ER-0413                TO EMI-ERROR.
 13417     MOVE SPACES                 TO PI-PRINT-SW.
 13418     GO TO 8999-OPEN-ERROR.
 13419
 13420 8840-CNTL-NOT-OPEN.
 13421     MOVE ER-0042                TO EMI-ERROR.
 13422     GO TO 8999-OPEN-ERROR.
 13423
 13424 8850-ARCH-NOT-OPEN.
 13425     MOVE ER-0332                TO EMI-ERROR.
 13426     GO TO 8999-OPEN-ERROR.
 13427
 13428 8860-CLAM-NOT-OPEN.
 13429     MOVE ER-0154                TO EMI-ERROR.
 13430     GO TO 8999-OPEN-ERROR.
 13431
 13432 8870-ACTV-NOT-OPEN.
 13433     MOVE ER-0172                TO EMI-ERROR.
 13434     GO TO 8999-OPEN-ERROR.
 13435
 13436 8880-ACCT-NOT-OPEN.
 13437     MOVE ER-0168                TO EMI-ERROR.
 13438     GO TO 8999-OPEN-ERROR.
 13439
 13440 8890-TEXT-NOT-OPEN.
 13441     MOVE ER-0013                TO EMI-ERROR.
 13442     GO TO 8999-OPEN-ERROR.
 13443
 13444 8900-CERT-NOT-OPEN.
 13445     MOVE ER-0169                TO EMI-ERROR.
 13446     GO TO 8999-OPEN-ERROR.
 13447
 13448 8910-CERT-NOT-FOUND.
 13449     MOVE ER-0206                TO EMI-ERROR.
 13450     GO TO 8999-OPEN-ERROR.
 13451
 13452 8915-PROD-NOT-OPEN.
 13453     MOVE ER-9106                TO EMI-ERROR.
 13454     GO TO 8999-OPEN-ERROR.
 13455
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 277
* EL152.cbl
 13456 8920-PLCY-NOT-OPEN.
 13457     MOVE ER-9883                TO EMI-ERROR.
 13458     GO TO 8999-OPEN-ERROR.
 13459
 13460 8925-PLAN-NOT-OPEN.
 13461     MOVE ER-9808                TO EMI-ERROR.
 13462     GO TO 8999-OPEN-ERROR.
 13463
 13464 8930-PLCY-NOT-FOUND.
 13465     MOVE ER-9483                TO EMI-ERROR.
 13466     GO TO 8999-OPEN-ERROR.
 13467
 13468 8999-OPEN-ERROR.
 13469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13470     MOVE -1                     TO MAINTL.
 13471     GO TO 8200-SEND-DATAONLY.
 13472
 13473 9000-RETURN-TRANS.
 13474
 13475     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13476
 13477* EXEC CICS RETURN
 13478*        TRANSID    (TRANS-ID)
 13479*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13480*        LENGTH     (PI-COMM-LENGTH)
 13481*    END-EXEC.
 13482*    MOVE '.(CT                  ''   #00011892' TO DFHEIV0
 13483     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13484     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13485     MOVE X'2020233030303131383932' TO DFHEIV0(25:11)
 13486     CALL 'kxdfhei1' USING DFHEIV0,
 13487           TRANS-ID,
 13488           PROGRAM-INTERFACE-BLOCK,
 13489           PI-COMM-LENGTH,
 13490           DFHEIV99,
 13491           DFHEIV99,
 13492           DFHEIV99
 13493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13494
 13495
 13496
 13497 9000-EXIT.
 13498     EXIT.
 13499 9200-RETURN-MAIN-MENU.
 13500     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13501
 13502     MOVE ZEROS                  TO PI-TOTAL-LINES
 13503                                    PI-CURRENT-LINE.
 13504     MOVE XCTL-126               TO PGM-NAME.
 13505
 13506     GO TO 9300-XCTL.
 13507
 13508 9300-XCTL.
 13509
 13510* EXEC CICS XCTL
 13511*        PROGRAM    (PGM-NAME)
 13512*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13513*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 278
* EL152.cbl
 13514*    END-EXEC.
 13515*    MOVE '.$C                   %   #00011911' TO DFHEIV0
 13516     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13517     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13518     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 13519     CALL 'kxdfhei1' USING DFHEIV0,
 13520           PGM-NAME,
 13521           PROGRAM-INTERFACE-BLOCK,
 13522           PI-COMM-LENGTH,
 13523           DFHEIV99
 13524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13525
 13526
 13527 9400-CLEAR.
 13528     IF PI-CLEAR-MODE
 13529         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13530         GO TO 9300-XCTL
 13531     ELSE
 13532         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13533         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13534         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13535         MOVE SPACES             TO PI-WA
 13536                                    RECORD-TABLE
 13537                                    TS-WORK-AREA
 13538         MOVE ZEROS              TO PI-TOTAL-LINES
 13539                                    PI-CURRENT-LINE
 13540                                    PI-TEMP-STOR-ITEMS
 13541                                    PI-UPDATE-SW
 13542                                    PI-ADDR-SEQ
 13543         MOVE '2'                TO PI-ACTION
 13544         MOVE LOW-VALUES         TO EL152AO
 13545                                    PI-ADDR-TYPE
 13546         SET TS-INDX
 13547             TA1
 13548             TA2
 13549             TA21
 13550             TB-INDX
 13551             TB-INDX1
 13552             MOVE-INDX
 13553             SC-INDX             TO +1
 13554         IF GETMAIN-SWITCH = '2'
 13555             MOVE 1              TO GETMAIN-SWITCH
 13556             GO TO 8100-SEND-INITIAL-MAP
 13557         ELSE
 13558             GO TO 8100-SEND-INITIAL-MAP.
 13559
 13560 9600-PGMID-ERROR.
 13561
 13562* EXEC CICS HANDLE CONDITION
 13563*        PGMIDERR    (8300-SEND-TEXT)
 13564*    END-EXEC.
 13565*    MOVE '"$L                   ! N #00011951' TO DFHEIV0
 13566     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13568     MOVE X'4E20233030303131393531' TO DFHEIV0(25:11)
 13569     CALL 'kxdfhei1' USING DFHEIV0
 13570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13571
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 279
* EL152.cbl
 13572
 13573     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 13574     MOVE ' '                    TO PI-ENTRY-CD-1.
 13575     MOVE XCTL-005               TO PGM-NAME.
 13576     MOVE PGM-NAME               TO LOGOFF-PGM.
 13577     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13578     GO TO 9300-XCTL.
 13579
 13580 9700-DATE-LINK.
 13581     MOVE LINK-ELDATCV           TO PGM-NAME.
 13582
 13583* EXEC CICS LINK
 13584*        PROGRAM   (PGM-NAME)
 13585*        COMMAREA  (DATE-CONVERSION-DATA)
 13586*        LENGTH    (DC-COMM-LENGTH)
 13587*    END-EXEC.
 13588*    MOVE '."C                   (   #00011964' TO DFHEIV0
 13589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13591     MOVE X'2020233030303131393634' TO DFHEIV0(25:11)
 13592     CALL 'kxdfhei1' USING DFHEIV0,
 13593           PGM-NAME,
 13594           DATE-CONVERSION-DATA,
 13595           DC-COMM-LENGTH,
 13596           DFHEIV99,
 13597           DFHEIV99,
 13598           DFHEIV99,
 13599           DFHEIV99
 13600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13601
 13602
 13603*    IF NO-CONVERSION-ERROR
 13604*            AND
 13605*       W-REVERSE-DATE
 13606*            AND
 13607*       PI-COMPANY-ID = 'AUK'
 13608*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13609*           MOVE W-ED1-MM            TO W-ED2-MM
 13610*           MOVE W-ED1-DD            TO W-ED2-DD
 13611*           MOVE W-ED1-YY            TO W-ED2-YY
 13612*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13613
 13614 9700-EXIT.
 13615      EXIT.
 13616
 13617 9900-ERROR-FORMAT.
 13618     IF NOT EMI-ERRORS-COMPLETE
 13619         MOVE LINK-001           TO PGM-NAME
 13620
 13621* EXEC CICS LINK
 13622*            PROGRAM   (PGM-NAME)
 13623*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13624*            LENGTH    (EMI-COMM-LENGTH)
 13625*        END-EXEC.
 13626*    MOVE '."C                   (   #00011987' TO DFHEIV0
 13627     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13629     MOVE X'2020233030303131393837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 280
* EL152.cbl
 13630     CALL 'kxdfhei1' USING DFHEIV0,
 13631           PGM-NAME,
 13632           ERROR-MESSAGE-INTERFACE-BLOCK,
 13633           EMI-COMM-LENGTH,
 13634           DFHEIV99,
 13635           DFHEIV99,
 13636           DFHEIV99,
 13637           DFHEIV99
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13639
 13640
 13641 9900-EXIT.
 13642     EXIT.
 13643
 13644 9990-ABEND.
 13645     MOVE LINK-004               TO PGM-NAME.
 13646     MOVE DFHEIBLK               TO EMI-LINE1.
 13647
 13648* EXEC CICS LINK
 13649*        PROGRAM   (PGM-NAME)
 13650*        COMMAREA  (EMI-LINE1)
 13651*        LENGTH    (72)
 13652*    END-EXEC.
 13653     MOVE 72
 13654       TO DFHEIV11
 13655*    MOVE '."C                   (   #00011999' TO DFHEIV0
 13656     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13657     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13658     MOVE X'2020233030303131393939' TO DFHEIV0(25:11)
 13659     CALL 'kxdfhei1' USING DFHEIV0,
 13660           PGM-NAME,
 13661           EMI-LINE1,
 13662           DFHEIV11,
 13663           DFHEIV99,
 13664           DFHEIV99,
 13665           DFHEIV99,
 13666           DFHEIV99
 13667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13668
 13669
 13670     GO TO 8200-SEND-DATAONLY.
 13671
 13672 9995-SECURITY-VIOLATION.
 13673*                            COPY ELCSCTP.
 13674******************************************************************
 13675*                                                                *
 13676*                            ELCSCTP                             *
 13677*                            VMOD=2.001                          *
 13678*                                                                *
 13679*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13680******************************************************************
 13681
 13682
 13683     MOVE EIBDATE          TO SM-JUL-DATE.
 13684     MOVE EIBTRMID         TO SM-TERMID.
 13685     MOVE THIS-PGM         TO SM-PGM.
 13686     MOVE EIBTIME          TO TIME-IN.
 13687     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 281
* EL152.cbl
 13688     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13689
 13690
 13691* EXEC CICS LINK
 13692*         PROGRAM  ('EL003')
 13693*         COMMAREA (SECURITY-MESSAGE)
 13694*         LENGTH   (80)
 13695*    END-EXEC.
 13696     MOVE 'EL003' TO DFHEIV1
 13697     MOVE 80
 13698       TO DFHEIV11
 13699*    MOVE '."C                   (   #00012025' TO DFHEIV0
 13700     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13701     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13702     MOVE X'2020233030303132303235' TO DFHEIV0(25:11)
 13703     CALL 'kxdfhei1' USING DFHEIV0,
 13704           DFHEIV1,
 13705           SECURITY-MESSAGE,
 13706           DFHEIV11,
 13707           DFHEIV99,
 13708           DFHEIV99,
 13709           DFHEIV99,
 13710           DFHEIV99
 13711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13712
 13713
 13714******************************************************************
 13715
 13716
 13717
 13718 9999-DFHBACK SECTION.
 13719     MOVE '9%                    "   ' TO DFHEIV0
 13720     MOVE 'EL152' TO DFHEIV1
 13721     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13722     GOBACK.
 13723 9999-DFHEXIT.
 13724     IF DFHEIGDJ EQUAL 0001
 13725         NEXT SENTENCE
 13726     ELSE IF DFHEIGDJ EQUAL 2
 13727         GO TO 9600-PGMID-ERROR,
 13728               0325-MAPFAIL,
 13729               9990-ABEND
 13730         DEPENDING ON DFHEIGDI
 13731     ELSE IF DFHEIGDJ EQUAL 3
 13732         GO TO 9400-CLEAR,
 13733               0100-PA,
 13734               0100-PA,
 13735               0100-PA
 13736         DEPENDING ON DFHEIGDI
 13737     ELSE IF DFHEIGDJ EQUAL 4
 13738         GO TO 0325-MAPFAIL
 13739         DEPENDING ON DFHEIGDI
 13740     ELSE IF DFHEIGDJ EQUAL 5
 13741         GO TO 590-QIDERR
 13742         DEPENDING ON DFHEIGDI
 13743     ELSE IF DFHEIGDJ EQUAL 6
 13744         GO TO 8850-ARCH-NOT-OPEN,
 13745               1020-ENDBR,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 282
* EL152.cbl
 13746               1020-ENDBR
 13747         DEPENDING ON DFHEIGDI
 13748     ELSE IF DFHEIGDJ EQUAL 7
 13749         GO TO 2120-ENDBR,
 13750               2120-ENDBR,
 13751               8890-TEXT-NOT-OPEN
 13752         DEPENDING ON DFHEIGDI
 13753     ELSE IF DFHEIGDJ EQUAL 8
 13754         GO TO 8860-CLAM-NOT-OPEN,
 13755               3010-NOT-FOUND
 13756         DEPENDING ON DFHEIGDI
 13757     ELSE IF DFHEIGDJ EQUAL 9
 13758         GO TO 9990-ABEND
 13759         DEPENDING ON DFHEIGDI
 13760     ELSE IF DFHEIGDJ EQUAL 10
 13761         GO TO 6499-EXIT
 13762         DEPENDING ON DFHEIGDI
 13763     ELSE IF DFHEIGDJ EQUAL 11
 13764         GO TO 6599-EXIT
 13765         DEPENDING ON DFHEIGDI
 13766     ELSE IF DFHEIGDJ EQUAL 12
 13767         GO TO 8860-CLAM-NOT-OPEN,
 13768               7090-CLAIM-NOT-FOUND
 13769         DEPENDING ON DFHEIGDI
 13770     ELSE IF DFHEIGDJ EQUAL 13
 13771         GO TO 8880-ACCT-NOT-OPEN,
 13772               7080-ACCT-NOT-FOUND
 13773         DEPENDING ON DFHEIGDI
 13774     ELSE IF DFHEIGDJ EQUAL 14
 13775         GO TO 7070-ACTV-NOT-FOUND
 13776         DEPENDING ON DFHEIGDI
 13777     ELSE IF DFHEIGDJ EQUAL 15
 13778         GO TO 7070-ACTV-NOT-FOUND
 13779         DEPENDING ON DFHEIGDI
 13780     ELSE IF DFHEIGDJ EQUAL 16
 13781         GO TO 8870-ACTV-NOT-OPEN,
 13782               7070-ACTV-NOT-FOUND
 13783         DEPENDING ON DFHEIGDI
 13784     ELSE IF DFHEIGDJ EQUAL 17
 13785         GO TO 7075-CONTINUE-ACTV-ERROR
 13786         DEPENDING ON DFHEIGDI
 13787     ELSE IF DFHEIGDJ EQUAL 18
 13788         GO TO 8900-CERT-NOT-OPEN,
 13789               8910-CERT-NOT-FOUND
 13790         DEPENDING ON DFHEIGDI
 13791     ELSE IF DFHEIGDJ EQUAL 19
 13792         GO TO 8870-ACTV-NOT-OPEN,
 13793               7200-READ-LOAN-NUMBER
 13794         DEPENDING ON DFHEIGDI
 13795     ELSE IF DFHEIGDJ EQUAL 20
 13796         GO TO 8870-ACTV-NOT-OPEN,
 13797               7201-READ-BENEFICIARY
 13798         DEPENDING ON DFHEIGDI
 13799     ELSE IF DFHEIGDJ EQUAL 21
 13800         GO TO 7290-BENE-NOT-OPEN,
 13801               7205-READ-PHYSICIAN-ADDR
 13802         DEPENDING ON DFHEIGDI
 13803     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 283
* EL152.cbl
 13804         GO TO 8870-ACTV-NOT-OPEN,
 13805               7210-READ-EMPLOYER-ADDR
 13806         DEPENDING ON DFHEIGDI
 13807     ELSE IF DFHEIGDJ EQUAL 23
 13808         GO TO 8870-ACTV-NOT-OPEN,
 13809               7220-READ-INSURED-ADDR
 13810         DEPENDING ON DFHEIGDI
 13811     ELSE IF DFHEIGDJ EQUAL 24
 13812         GO TO 8870-ACTV-NOT-OPEN,
 13813               7225-READ-OTHER1-ADDR
 13814         DEPENDING ON DFHEIGDI
 13815     ELSE IF DFHEIGDJ EQUAL 25
 13816         GO TO 8870-ACTV-NOT-OPEN,
 13817               7230-READ-OTHER2-ADDR
 13818         DEPENDING ON DFHEIGDI
 13819     ELSE IF DFHEIGDJ EQUAL 26
 13820         GO TO 8870-ACTV-NOT-OPEN,
 13821               7240-NOT-FOUND
 13822         DEPENDING ON DFHEIGDI
 13823     ELSE IF DFHEIGDJ EQUAL 27
 13824         GO TO 8870-ACTV-NOT-OPEN,
 13825               7250-READ-ACCOUNT
 13826         DEPENDING ON DFHEIGDI
 13827     ELSE IF DFHEIGDJ EQUAL 28
 13828         GO TO 8880-ACCT-NOT-OPEN,
 13829               7251-READ-3RD-PARTY
 13830         DEPENDING ON DFHEIGDI
 13831     ELSE IF DFHEIGDJ EQUAL 29
 13832         GO TO 8870-ACTV-NOT-OPEN,
 13833               7252-READ-COMP
 13834         DEPENDING ON DFHEIGDI
 13835     ELSE IF DFHEIGDJ EQUAL 30
 13836         GO TO 7260-READ-DENIAL
 13837         DEPENDING ON DFHEIGDI
 13838     ELSE IF DFHEIGDJ EQUAL 31
 13839         GO TO 8870-ACTV-NOT-OPEN,
 13840               7265-READ-CNTL1,
 13841               7265-READ-CNTL1
 13842         DEPENDING ON DFHEIGDI
 13843     ELSE IF DFHEIGDJ EQUAL 32
 13844         GO TO 8840-CNTL-NOT-OPEN,
 13845               7266-READ-CNTL2
 13846         DEPENDING ON DFHEIGDI
 13847     ELSE IF DFHEIGDJ EQUAL 33
 13848         GO TO 8840-CNTL-NOT-OPEN,
 13849               7267-READ-CNTL4
 13850         DEPENDING ON DFHEIGDI
 13851     ELSE IF DFHEIGDJ EQUAL 34
 13852         GO TO 8840-CNTL-NOT-OPEN,
 13853               7267-READ-CNTL6
 13854         DEPENDING ON DFHEIGDI
 13855     ELSE IF DFHEIGDJ EQUAL 35
 13856         GO TO 8840-CNTL-NOT-OPEN,
 13857               7268-SET-DATE
 13858         DEPENDING ON DFHEIGDI
 13859     ELSE IF DFHEIGDJ EQUAL 36
 13860         GO TO 7290-BENE-NOT-OPEN,
 13861               7290-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:11 Page 284
* EL152.cbl
 13862         DEPENDING ON DFHEIGDI
 13863     ELSE IF DFHEIGDJ EQUAL 37
 13864         GO TO 7590-TS-QIDERR,
 13865               7585-TS-ITEMERR
 13866         DEPENDING ON DFHEIGDI
 13867     ELSE IF DFHEIGDJ EQUAL 38
 13868         GO TO 7690-TS-QIDERR,
 13869               7685-TS-ITEMERR
 13870         DEPENDING ON DFHEIGDI
 13871     ELSE IF DFHEIGDJ EQUAL 39
 13872         GO TO 7750-EXIT
 13873         DEPENDING ON DFHEIGDI
 13874     ELSE IF DFHEIGDJ EQUAL 40
 13875         GO TO 7760-EXIT
 13876         DEPENDING ON DFHEIGDI
 13877     ELSE IF DFHEIGDJ EQUAL 41
 13878         GO TO 7770-EXIT
 13879         DEPENDING ON DFHEIGDI
 13880     ELSE IF DFHEIGDJ EQUAL 42
 13881         GO TO 8860-CLAM-NOT-OPEN,
 13882               7800-CLAIM-NOT-FOUND
 13883         DEPENDING ON DFHEIGDI
 13884     ELSE IF DFHEIGDJ EQUAL 43
 13885         GO TO 7800-GET-PRINTER
 13886         DEPENDING ON DFHEIGDI
 13887     ELSE IF DFHEIGDJ EQUAL 44
 13888         GO TO 8840-CNTL-NOT-OPEN,
 13889               7890-NOT-FOUND
 13890         DEPENDING ON DFHEIGDI
 13891     ELSE IF DFHEIGDJ EQUAL 45
 13892         GO TO 8820-TERM-ERROR,
 13893               8830-TRAN-ERROR
 13894         DEPENDING ON DFHEIGDI
 13895     ELSE IF DFHEIGDJ EQUAL 46
 13896         GO TO 8300-SEND-TEXT
 13897         DEPENDING ON DFHEIGDI.
 13898     MOVE '9%                    "   ' TO DFHEIV0
 13899     MOVE 'EL152' TO DFHEIV1
 13900     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13901     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       47728     Code:       43962
